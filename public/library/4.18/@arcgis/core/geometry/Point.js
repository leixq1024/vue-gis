/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../chunks/ArrayPool.js";import"../chunks/object.js";import"../chunks/deprecate.js";import"../core/lang.js";import"../config.js";import{L as t}from"../chunks/Logger.js";import"../chunks/string.js";import"../chunks/metadata.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import"../core/Accessor.js";import"../chunks/PropertyOrigin.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../chunks/Message.js";import"../core/Error.js";import{l as r}from"../chunks/ensureType.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import"../chunks/JSONSupport.js";import"../core/urlUtils.js";import{cast as o}from"../core/accessorSupport/decorators/cast.js";import{r as n}from"../chunks/reader.js";import{w as a}from"../chunks/writer.js";import"../chunks/resourceExtension.js";import l,{g as u}from"./SpatialReference.js";import c from"./Geometry.js";import"../chunks/Ellipsoid.js";import{lngLatToXY as p,xyToLngLat as h}from"./support/webMercatorUtils.js";var d;const y=[0,0];function m(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}const f=t.getLogger("esri.geometry.Point");let g=d=class extends c{constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const s=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(s)?s:s.clone())}normalizeCtorArgs(e,t,s,r,i){let o;if(Array.isArray(e))o=e,i=t,e=o[0],t=o[1],s=o[2],r=o[3];else if(e&&"object"==typeof e){if(o=e,e=null!=o.x?o.x:o.longitude,t=null!=o.y?o.y:o.latitude,s=o.z,r=o.m,(i=o.spatialReference)&&"esri.geometry.SpatialReference"!==i.declaredClass&&(i=new l(i)),null!=o.longitude||null!=o.latitude)if(null==o.longitude)f.warn(".longitude=","Latitude was defined without longitude");else if(null==o.latitude)f.warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&i&&i.isWebMercator){const s=p(o.longitude,o.latitude,y);e=s[0],t=s[1]}}else m(s)?(i=s,s=null):m(r)&&(i=r,r=null);const n={x:e,y:t};return null==n.x&&null!=n.y?f.warn(".y=","Y coordinate was defined without an X coordinate"):null==n.y&&null!=n.x&&f.warn(".x=","X coordinate was defined without a Y coordinate"),null!=i&&(n.spatialReference=i),null!=s&&(n.z=s),null!=r&&(n.m=r),n}get hasM(){return void 0!==this.m}set hasM(e){e!==this.hasM&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return void 0!==this.z}set hasZ(e){e!==this.hasZ&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const e=this._get("spatialReference");if(e){if(e.isWebMercator)return h(this.x,this.y,y)[1];if(e.isGeographic)return this._get("y")}return null}set latitude(e){const t=this._get("spatialReference");t&&(t.isWebMercator?this._set("y",p(this.x,e,y)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const e=this._get("spatialReference");if(e){if(e.isWebMercator)return h(this._get("x"),this._get("y"),y)[0];if(e.isGeographic)return this._get("x")}return null}set longitude(e){const t=this._get("spatialReference");t&&(t.isWebMercator?this._set("x",p(e,this._get("y"),y)[0]):t.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,s){t[s]=isNaN(e)?"NaN":e}readX(e){return"string"==typeof e?NaN:e}clone(){const e=new d;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return d.copy(e,this),this}equals(e){if(!e)return!1;const{x:t,y:s,z:r,m:i,spatialReference:o}=this,{z:n,m:a}=e;let{x:l,y:u,spatialReference:c}=e;if(!o.equals(c))if(o.isWebMercator&&c.isWGS84)[l,u]=p(l,u),c=o;else{if(!o.isWGS84||!c.isWebMercator)return!1;[l,u]=h(l,u),c=o}return t===l&&s===u&&r===n&&i===a&&o.wkid===c.wkid}offset(e,t,s){return function(e,t,s,r){return e.x=e.x+t,e.y=e.y+s,null!=r&&null!=e.z&&(e.z=e.z+r),e}(this,e,t,s)}normalize(){if(!this.spatialReference)return this;const e=u(this.spatialReference);if(!e)return this;let t=this.x;const[s,r]=e.valid,i=2*r;let o;return t>r?(o=Math.ceil(Math.abs(t-r)/i),t-=o*i):t<s&&(o=Math.ceil(Math.abs(t-s)/i),t+=o*i),this._set("x",t),this}distance(e){return function(e,t){const s=e.x-t.x,r=e.y-t.y,i=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(s*s+r*r+i*i)}(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write(null,e)}};e([s({dependsOn:["x","y","z","m","spatialReference"],autoTracked:!1})],g.prototype,"cache",void 0),e([s({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],g.prototype,"hasM",null),e([s({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],g.prototype,"hasZ",null),e([s({type:Number,dependsOn:["y"],autoTracked:!1})],g.prototype,"latitude",null),e([s({type:Number,dependsOn:["x"],autoTracked:!1})],g.prototype,"longitude",null),e([s({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),o((e=>isNaN(e)?e:r(e)))],g.prototype,"x",void 0),e([a("x")],g.prototype,"writeX",null),e([n("x")],g.prototype,"readX",null),e([s({type:Number,json:{write:!0}})],g.prototype,"y",void 0),e([s({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],g.prototype,"z",void 0),e([s({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],g.prototype,"m",void 0),g=d=e([i("esri.geometry.Point")],g),g.prototype.toJSON.isDefaultToJSON=!0;var j=g;export default j;
