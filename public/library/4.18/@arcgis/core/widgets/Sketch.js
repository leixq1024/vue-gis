/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import"../chunks/ArrayPool.js";import"../chunks/object.js";import"../chunks/deprecate.js";import"../core/lang.js";import"../config.js";import"../chunks/Logger.js";import"../chunks/string.js";import"../chunks/metadata.js";import{property as e}from"../core/accessorSupport/decorators/property.js";import o from"../core/Accessor.js";import"../chunks/PropertyOrigin.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../chunks/Message.js";import"../core/Error.js";import"../chunks/compilerUtils.js";import"../chunks/ensureType.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import{E as i}from"../chunks/Evented.js";import r from"../core/Collection.js";import"../chunks/collectionUtils.js";import"../chunks/JSONSupport.js";import"../chunks/Promise.js";import"../chunks/Loadable.js";import"../core/urlUtils.js";import{aliasOf as n}from"../core/accessorSupport/decorators/aliasOf.js";import{cast as l}from"../core/accessorSupport/decorators/cast.js";import"../chunks/jsonMap.js";import"../chunks/enumeration.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../chunks/resourceExtension.js";import"../chunks/persistableUrlUtils.js";import"../geometry/SpatialReference.js";import"../chunks/locale.js";import"../chunks/number.js";import{substitute as a}from"../intl.js";import"../kernel.js";import"../request.js";import"../chunks/assets.js";import"../geometry/Geometry.js";import"../geometry/Point.js";import"../chunks/Ellipsoid.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Extent.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalFolder.js";import"../portal/PortalGroup.js";import"../portal/PortalUser.js";import"../portal/Portal.js";import"../chunks/mathUtils2.js";import"../chunks/vec3f64.js";import"../chunks/common.js";import"../chunks/vec3.js";import"../chunks/mathUtils.js";import"../chunks/colorUtils.js";import"../Color.js";import"../chunks/zmUtils.js";import"../geometry/Multipoint.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../geometry.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../chunks/domains.js";import"../chunks/arcadeOnDemand.js";import"../layers/support/fieldUtils.js";import"../popup/content/Content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/CustomContent.js";import"../chunks/date.js";import"../popup/support/FieldInfoFormat.js";import"../popup/FieldInfo.js";import"../popup/content/FieldsContent.js";import"../chunks/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/MediaContent.js";import"../popup/content/TextContent.js";import"../popup/content.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/RelatedRecordsInfo.js";import"../chunks/Identifiable.js";import"../support/actions/ActionBase.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../PopupTemplate.js";import"../symbols/Symbol.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol3DLayer.js";import"../chunks/screenUtils.js";import"../chunks/opacityUtils.js";import"../chunks/materialUtils.js";import"../symbols/edges/Edges3D.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/utils.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import c from"../symbols/SimpleLineSymbol.js";import"../symbols/FillSymbol.js";import"../symbols/patterns/StylePattern3D.js";import"../symbols/FillSymbol3DLayer.js";import"../chunks/colors.js";import"../chunks/Symbol3DOutline.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/Symbol3D.js";import"../chunks/Thumbnail.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../chunks/Symbol3DVerticalOffset.js";import"../symbols/LabelSymbol3D.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../chunks/urlUtils.js";import"../symbols/PictureFillSymbol.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import p from"../symbols/SimpleFillSymbol.js";import m from"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../symbols/support/jsonUtils.js";import"../chunks/uid.js";import"../Graphic.js";import u from"../core/Handles.js";import"../layers/Layer.js";import"../chunks/unitUtils.js";import"../chunks/lengthUtils.js";import"../geometry/support/normalizeUtils.js";import"../chunks/timeUtils.js";import"../TimeExtent.js";import"../core/watchUtils.js";import"../chunks/fieldType.js";import"../chunks/mat4.js";import"../chunks/pe.js";import"../chunks/aaBoundingRect.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformationStep.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/projection.js";import"../chunks/ElevationInfo.js";import"../chunks/unitConversionUtils.js";import{HandleOwnerMixin as h}from"../core/HandleOwner.js";import"../chunks/_commonjsHelpers.js";import"../geometry/support/geodesicUtils.js";import"../geometry/Circle.js";import"../chunks/geometryEngineBase.js";import"../chunks/hydrated.js";import"../geometry/geometryEngine.js";import"../chunks/vec4f64.js";import"../chunks/quatf64.js";import"../chunks/mat3.js";import"../chunks/BufferView.js";import"../chunks/vec2.js";import"../chunks/vec4.js";import"../chunks/quat.js";import"../chunks/domUtils.js";import{i as d}from"../chunks/widgetUtils.js";import"../chunks/projector.js";import"../chunks/accessibleHandler.js";import{m as j}from"../chunks/messageBundle.js";import{r as y}from"../chunks/renderable.js";import{v}from"../chunks/vmEvent.js";import{j as k}from"../chunks/index.js";import"./support/widget.js";import b from"./Widget.js";import"../chunks/zscale.js";import"../chunks/queryZScale.js";import"../layers/support/Field.js";import"../tasks/support/FeatureSet.js";import"../chunks/BlendLayer.js";import"../chunks/ScaleRangeLayer.js";import"../chunks/DataLayerSource.js";import"../tasks/support/AttachmentQuery.js";import"../tasks/support/Query.js";import"../tasks/support/StatisticDefinition.js";import"../tasks/support/RelationshipQuery.js";import"../chunks/GraphicsCollection.js";import g from"../layers/GraphicsLayer.js";import"../tasks/Task.js";import"../chunks/OptimizedGeometry.js";import"../chunks/featureConversionUtils.js";import"../tasks/QueryTask.js";import"../chunks/pbf.js";import"../chunks/pbfQueryUtils.js";import"../chunks/query.js";import"../layers/support/AttachmentInfo.js";import"../chunks/aaBoundingBox.js";import"../chunks/Queue.js";import"../chunks/InputManager.js";import"../chunks/interactiveToolUtils.js";import"../chunks/throttle.js";import"./Attachments.js";import"./Attachments/AttachmentsViewModel.js";import"./Feature/FeatureViewModel.js";import"./Feature.js";import"../chunks/AnchorElementViewModel.js";import"./Spinner/SpinnerViewModel.js";import"./Popup.js";import"../chunks/layerViewUtils.js";import"../chunks/actions.js";import"../chunks/GoTo.js";import"./Popup/PopupViewModel.js";import"../chunks/screenUtils2.js";import"../chunks/quantizationUtils.js";import"../chunks/mat2d.js";import"../chunks/dehydratedFeatures.js";import"../chunks/ElevationProvider.js";import"../chunks/mat2df64.js";import"../chunks/vec2f64.js";import"../chunks/PointerClickHoldAndDrag.js";import"../chunks/requestImageUtils.js";import"../chunks/PiUtils.glsl.js";import"../chunks/Program.js";import"../chunks/isWebGL2Context.js";import"../chunks/glUtil.js";import"../chunks/InterleavedLayout.js";import"../chunks/mat4f32.js";import"../chunks/vec3f32.js";import"../chunks/geometryUtils.js";import"../chunks/ColorMaterial.js";import"../chunks/Util.js";import"../chunks/Geometry.js";import"../chunks/VertexArrayObject.js";import"../chunks/sdfPrimitives.js";import"../chunks/Object3D.js";import"../chunks/DefaultTextureUnits.js";import"../chunks/GLMaterialTexture.js";import"../chunks/VerticalOffset.glsl.js";import"../chunks/elevationAlignmentUtils.js";import"../chunks/RenderingContext.js";import"../chunks/CameraSpace.glsl.js";import"../chunks/Texture.js";import"../chunks/vec4f32.js";import"../views/draw/DrawAction.js";import"../chunks/Keys.js";import"../views/draw/MultipointDrawAction.js";import"../chunks/DrawTool.js";import"../chunks/elevationInfoUtils.js";import"../chunks/InteractiveToolBase.js";import"../chunks/RightAngleQuadVisualElement.js";import"../chunks/LaserLineRenderer.js";import"../views/draw/PointDrawAction.js";import"../views/draw/PolygonDrawAction.js";import"../views/draw/PolylineDrawAction.js";import"../views/draw/SegmentDrawAction.js";import"../views/draw/Draw.js";import f from"./Sketch/SketchViewModel.js";async function w(){return async function(){return import("../chunks/geometryEngineJSON.js").then((function(t){return t.g}))}().then((({contains:t,intersects:e,overlaps:o,simplify:s})=>({contains:t,intersects:e,overlaps:o,simplify:s})))}async function S(t){const{selector:e,candidates:o,currentSelection:s,options:i,view:r}=t;if(!(o&&o.length&&s&&r))return{added:[],removed:[]};const{overlaps:n,intersects:l,contains:a}=i,{spatialReference:c}=r;if(!e){return{added:[],removed:s.removeAll()}}const p=e,m=await w(),u=[],h=[];return o.forEach((t=>{const e=t.geometry,o=n&&!!m.overlaps(c,p,e),i=l&&!!m.intersects(c,p,e),r=a&&!!m.contains(c,p,e),d=s.includes(t);o||i||r?!d&&u.push(t):d&&h.push(t)})),s.removeMany(h),s.addMany(u),{added:u,removed:h}}let _=class extends i.EventedAccessor{constructor(t){super(),this._activeOptions=null,this._dashedFillSymbol=new p({color:[0,0,0,0],outline:{style:"dash",color:[12,207,255],width:2}}),this._dashedLineSymbol=new c({style:"dash",color:[12,207,255],width:2}),this._defaultOptions={tool:"rectangle",createOptions:null,selectionOptions:{overlaps:!0,intersects:!0,contains:!1}},this._completed=!1,this._handles=new u,this._sketchViewModel=new f,this._sketchGraphicsLayer=new g({listMode:"hide"}),this._transparentPointSymbol=new m({color:[0,0,0,0],outline:{style:"none",width:0}}),this.candidates=null,this.geometry=null,this.options=null,this.selection=new r,this.view=null,this.candidates=t.candidates,this.options=t.options,this.view=t.view;const{_dashedFillSymbol:e,_dashedLineSymbol:o,_sketchViewModel:s,_sketchGraphicsLayer:i,_transparentPointSymbol:n}=this;s.set({layer:i,view:this.view,activePointSymbol:n,activeLineSymbol:o,activeVertexSymbol:n,activeFillSymbol:e,pointSymbol:n,polygonSymbol:e,polylineSymbol:o,vertexSymbol:n}),this._handles.add([s.on("create",(t=>this._onSketchEvent(t))),s.on(["undo","redo"],(t=>this._onSketchEvent(t)))])}initialize(){this._load()}destroy(){this._handles.destroy(),this._handles=null}get state(){const{_completed:t,_sketchViewModel:{state:e}}=this;return t?"complete":"active"===e?"active":"disabled"}cancel(){this._sketchViewModel.cancel()}async _load(){await this.view.whenReady();const{options:t}=this,{tool:e,createOptions:o}=this._activeOptions={...this._defaultOptions,...t};this._sketchViewModel.create(e,o)}_onSketchEvent(t){const e="create"===t.type?t.graphic:t.graphics[0],o=(null==e?void 0:e.geometry)||null,s="create"===t.type&&"cancel"===t.state,i="create"===t.type&&"complete"===t.state;this._processSelectionGeometry(o,i,s)}_processSelectionGeometry(t,e,o){if(this._set("geometry",t),(e||o)&&(this._completed=!0),o)return void this._onComplete([],!0);const{_activeOptions:s,candidates:i,selection:r,view:n}=this;S({selector:t,candidates:i,currentSelection:r,options:s.selectionOptions,view:n}).then((({added:t,removed:o})=>{e?this._onComplete(this.selection.toArray(),!1):(t.length||o.length)&&this.emit("selection-change",{added:t,removed:o,type:"selection-change"})}))}_onComplete(t,e){this._handles.removeAll(),this.notifyChange("state"),this.emit("complete",{aborted:e,selection:t,type:"complete"})}};t([e()],_.prototype,"_completed",void 0),t([e()],_.prototype,"candidates",void 0),t([e({readOnly:!0})],_.prototype,"geometry",void 0),t([e()],_.prototype,"options",void 0),t([e({readOnly:!0})],_.prototype,"selection",void 0),t([e({dependsOn:["_completed","_sketchViewModel.state"],readOnly:!0})],_.prototype,"state",null),t([e({value:null})],_.prototype,"view",void 0),_=t([s("esri.widgets.support.Selector")],_);var M=_;let C=class extends(h(o)){constructor(t){super(t),this._defaultSelectionOptions={intersects:!0,overlaps:!0,contains:!0},this.candidates=null,this.options=null,this.view=null}draw(t){const{_defaultSelectionOptions:e,candidates:o,options:s,view:i}=this,r={...e,...s,...null==t?void 0:t.selectionOptions};return new M({candidates:o,options:{...t,selectionOptions:r},view:i})}async selectionFrom(t,e){const{_defaultSelectionOptions:o,candidates:s,options:i,view:n}=this,l=new r,a={...o,...i,...e};return await S({selector:t,candidates:s,currentSelection:l,options:a,view:n}),l.toArray()}};t([e()],C.prototype,"candidates",void 0),t([e()],C.prototype,"options",void 0),t([e({value:null})],C.prototype,"view",void 0),C=t([s("esri.widgets.support.Selector")],C);var T=C;const O="esri-sketch",U="esri-sketch--vertical",D="esri-sketch__panel",I="esri-sketch__info-panel",P="esri-sketch__section",L="esri-sketch__tool-section",B="esri-sketch__info-section",E="esri-sketch__info-count-section",R="esri-sketch__feature-count-badge",A="esri-sketch__feature-count-number",G="esri-sketch__button",F="esri-sketch__button--selected",V="esri-icon-map-pin",x="esri-icon-polygon",z="esri-icon-polyline",Q="esri-icon-radio-unchecked",q="esri-icon-checkbox-unchecked",H="esri-icon-cursor",W="esri-icon-trash",J="esri-icon-undo",N="esri-icon-redo",K="esri-icon-cursor-marquee",Z="esri-icon-lasso",X="esri-widget",Y="esri-icon-edit",$="esri-disabled",tt={createTools:{point:!0,polyline:!0,polygon:!0,rectangle:!0,circle:!0},selectionTools:{"rectangle-selection":!0,"lasso-selection":!0},undoRedoMenu:!0};let et=class extends b{constructor(t,e){super(t,e),this._activeCreateOptions=null,this._activeSelectionInfo=null,this._selector=new T,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.createGraphic=null,this.creationMode="continuous",this.defaultCreateOptions=null,this.defaultUpdateOptions=null,this.iconClass=Y,this.label=void 0,this.layer=null,this.messages=null,this.updateGraphics=new r,this.view=null,this.viewModel=new f,this.visibleElements={...tt},this._activateCreateTool=this._activateCreateTool.bind(this)}initialize(){const{view:t}=this;this._selector.view=t,this.own([this.viewModel.on("create",(()=>this.scheduleRender())),this.viewModel.on("update",(()=>this.scheduleRender())),this.viewModel.on("create",(t=>this._onCreateOperation(t))),this.viewModel.on("delete",(t=>this.emit("delete",t))),this.viewModel.on("undo",(()=>this.scheduleRender())),this.viewModel.on("redo",(()=>this.scheduleRender())),this.viewModel.watch("view",(t=>this._selector.set({view:t}))),this.viewModel.watch("state",(()=>this.notifyChange("state")))])}get activeTool(){var t;return(null==(t=this._activeSelectionInfo)?void 0:t.tool)||this.viewModel.activeTool}set layout(t){"vertical"!==t&&(t="horizontal"),this._set("layout",t)}get state(){return this._activeSelectionInfo?"active":this.viewModel.state}castVisibleElements(t){return{...tt,...t,createTools:{...tt.createTools,...null==t?void 0:t.createTools},selectionTools:{...tt.selectionTools,...null==t?void 0:t.selectionTools}}}create(t,e){this._activeCreateOptions=e||null,this.viewModel.create(t,e)}update(t,e){return this.viewModel.update(t,e)}complete(){}cancel(){this._cancelSelectionOperation(),this.viewModel.cancel()}undo(){}redo(){}delete(){}render(){const{label:t,layout:e,viewModel:{state:o}}=this;return k("div",{"aria-label":t,class:this.classes(O,X,{[$]:"disabled"===o,[U]:"vertical"===e})},k("div",{class:D},this.renderTopPanelContents()),k("div",{class:this.classes(D,I)},this.renderInfoPanelContents()))}renderTopPanelContents(){const t=this.classes(P,L),{availableCreateTools:e,visibleElements:o}=this;return[k("div",{key:"selection-button-container",class:t},this.renderSelectionTools()),e&&e.length?k("div",{class:t},this.renderDrawButtons()):null,o.undoRedoMenu?k("div",{key:"menu-button-container",class:t},this.renderMenuButtons()):null]}renderInfoPanelContents(){if(this.updateGraphics.length)return[k("div",{class:this.classes(P,B,E),key:"feature-count-container"},this.renderFeatureCount()),k("div",{class:this.classes(P,B),key:"delete-button-container"},this.renderDeleteButton())]}renderFeatureCount(){const{layout:t,messages:e,updateGraphics:{length:o}}=this,s=a(1===o?e.featureCount:e.featuresCount,{count:o});return k("div",{class:R,"aria-label":s},k("span",{class:A},"vertical"===t?o:s))}renderDeleteButton(){const t=this.messages.deleteFeature;return k("button",{"aria-label":t,bind:this,class:this.classes(G,W),onclick:this.delete,title:t,type:"button"})}renderSelectionTools(){return[this.renderDefaultSelectionButton(),this.renderRectangleSelectionButton(),this.renderLassoSelectionButton()]}renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return;const t=this.messages.selectFeature;return k("button",{"aria-label":t,bind:this,class:this.classes(G,H,{[F]:"ready"===this.state}),onclick:this.cancel,title:t})}renderRectangleSelectionButton(){var t,e;if("2d"!==(null==(t=this.view)?void 0:t.type)||!this.visibleElements.selectionTools["rectangle-selection"])return;const o=this.messages.selectRectangle;return k("button",{"aria-label":o,bind:this,class:this.classes(G,K,{[F]:"rectangle-selection"===(null==(e=this._activeSelectionInfo)?void 0:e.tool)}),onclick:this._activateRectangleSelectTool,title:o})}renderLassoSelectionButton(){var t,e;if("2d"!==(null==(t=this.view)?void 0:t.type)||!this.visibleElements.selectionTools["lasso-selection"])return;const o=this.messages.selectLasso;return k("button",{"aria-label":o,bind:this,class:this.classes(G,Z,{[F]:"lasso-selection"===(null==(e=this._activeSelectionInfo)?void 0:e.tool)}),onclick:this._activateLassoSelectTool,title:o})}renderDrawButtons(){const t=this.visibleElements.createTools;return this.availableCreateTools.map((e=>"point"===e&&t.point?this.renderPointButton():"polyline"===e&&t.polyline?this.renderPolylineButton():"polygon"===e&&t.polygon?this.renderPolygonButton():"rectangle"===e&&t.rectangle?this.renderRectangleButton():"circle"===e&&t.circle?this.renderCircleButton():void 0))}renderPointButton(){const t="point",e=this.messages.drawPoint,o=[G,V];return this.activeTool===t&&o.push(F),k("button",{"aria-label":e,bind:this,class:this.classes(o),"data-tool-name":t,onclick:this._activateCreateTool,title:e,type:"button"})}renderPolygonButton(){const t="polygon",e=this.messages.drawPolygon,o=[G,x];return this.activeTool===t&&o.push(F),k("button",{"aria-label":e,bind:this,class:this.classes(o),"data-tool-name":t,onclick:this._activateCreateTool,title:e,type:"button"})}renderPolylineButton(){const t="polyline",e=this.messages.drawPolyline,o=[G,z];return this.activeTool===t&&o.push(F),k("button",{"aria-label":e,bind:this,class:this.classes(o),"data-tool-name":t,onclick:this._activateCreateTool,title:e,type:"button"})}renderCircleButton(){const t="circle",e=this.messages.drawCircle,o=[G,Q];return this.activeTool===t&&o.push(F),k("button",{"aria-label":e,bind:this,class:this.classes(o),"data-tool-name":t,onclick:this._activateCreateTool,title:e,type:"button"})}renderRectangleButton(){const t="rectangle",e=this.messages.drawRectangle,o=[G,q];return this.activeTool===t&&o.push(F),k("button",{"aria-label":e,bind:this,class:this.classes(o),"data-tool-name":t,onclick:this._activateCreateTool,title:e,type:"button"})}renderMenuButtons(){return[this.renderUndoButton(),this.renderRedoButton()]}renderUndoButton(){const t=this.messages.undo,e=!this.viewModel.canUndo(),o=d()?N:J;return k("button",{"aria-label":t,bind:this,class:this.classes(G,o),disabled:e,onclick:this.undo,title:t,type:"button"})}renderRedoButton(){const t=this.messages.redo,e=!this.viewModel.canRedo(),o=d()?J:N;return k("button",{"aria-label":t,bind:this,class:this.classes(G,o),disabled:e,onclick:this.redo,title:t,type:"button"})}_cancelSelectionOperation(){var t,e;null==(t=this._activeSelectionInfo)||null==(e=t.operation)||e.cancel(),this._activeSelectionInfo=null,this._selector.candidates=null}_activateCreateTool(t){const e=t.target.getAttribute("data-tool-name");this.activeTool!==e?(this._activeSelectionInfo&&this._cancelSelectionOperation(),this.create(e)):this.cancel()}_onCreateOperation(t){if("complete"!==t.state)return;const{creationMode:e}=this,{type:o}=t;if("create"===o){const{tool:o,graphic:s}=t,i=this._activeCreateOptions;this._activeCreateOptions=null,"continuous"===e?this.create(o,i):"update"===e&&this.update([s])}}_onSelectionOperationComplete(t){const{viewModel:{defaultUpdateOptions:e}}=this,{selection:o}=t;if(this._activeSelectionInfo=null,!t.aborted&&o.length){const t=e.tool,s=o.length>1&&"reshape"===t?"transform":t;this.update(o,{...e,tool:s})}this.notifyChange("state")}_activateRectangleSelectTool(){if(this._activeSelectionInfo){const t=this._activeSelectionInfo.tool;if(this._cancelSelectionOperation(),"rectangle-selection"===t)return}else"active"===this.state&&this.cancel();this._selector.candidates=this._getSelectionCandidates();const t=this._selector.draw({tool:"rectangle"});t.once("complete",(t=>this._onSelectionOperationComplete(t))),this._activeSelectionInfo={tool:"rectangle-selection",operation:t}}_activateLassoSelectTool(){if(this._activeSelectionInfo){const t=this._activeSelectionInfo.tool;if(this._cancelSelectionOperation(),"lasso-selection"===t)return}else"active"===this.state&&this.cancel();this._selector.candidates=this._getSelectionCandidates();const t=this._selector.draw({tool:"polygon",createOptions:{mode:"freehand"}});t.once("complete",(t=>this._onSelectionOperationComplete(t))),this._activeSelectionInfo={tool:"lasso-selection",operation:t}}_getSelectionCandidates(){var t,e;return(null==(t=this.layer)||null==(e=t.graphics)?void 0:e.toArray())||[]}};t([e()],et.prototype,"_activeSelectionInfo",void 0),t([e({dependsOn:["_activeSelectionInfo","viewModel.activeTool"]})],et.prototype,"activeTool",null),t([e({cast:t=>{if(!t||!t.length)return null;const e=new Set(["point","polyline","polygon","rectangle","circle"]);return t.filter((t=>e.has(t)))}}),y()],et.prototype,"availableCreateTools",void 0),t([n("viewModel.createGraphic"),y()],et.prototype,"createGraphic",void 0),t([e()],et.prototype,"creationMode",void 0),t([n("viewModel.defaultCreateOptions"),y()],et.prototype,"defaultCreateOptions",void 0),t([n("viewModel.defaultUpdateOptions"),y()],et.prototype,"defaultUpdateOptions",void 0),t([e()],et.prototype,"iconClass",void 0),t([e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],et.prototype,"label",void 0),t([n("viewModel.layer"),y()],et.prototype,"layer",void 0),t([e({value:"horizontal"}),y()],et.prototype,"layout",null),t([e(),y(),j("esri/widgets/Sketch/t9n/Sketch")],et.prototype,"messages",void 0),t([e({dependsOn:["_activeSelectionInfo","viewModel.state"]}),y()],et.prototype,"state",null),t([n("viewModel.updateGraphics"),y(["updateGraphics","updateGraphics.length"])],et.prototype,"updateGraphics",void 0),t([n("viewModel.view"),y()],et.prototype,"view",void 0),t([e(),y("viewModel.state"),v(["create","update","undo","redo"])],et.prototype,"viewModel",void 0),t([e(),y()],et.prototype,"visibleElements",void 0),t([l("visibleElements")],et.prototype,"castVisibleElements",null),t([n("viewModel.complete")],et.prototype,"complete",null),t([n("viewModel.undo")],et.prototype,"undo",null),t([n("viewModel.redo")],et.prototype,"redo",null),t([n("viewModel.delete")],et.prototype,"delete",null),et=t([s("esri.widgets.Sketch")],et);var ot=et;export default ot;
