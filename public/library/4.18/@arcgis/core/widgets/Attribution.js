/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import"../chunks/ArrayPool.js";import"../chunks/object.js";import"../chunks/deprecate.js";import"../core/lang.js";import"../config.js";import"../chunks/Logger.js";import"../chunks/string.js";import"../chunks/metadata.js";import{property as e}from"../core/accessorSupport/decorators/property.js";import"../core/Accessor.js";import"../chunks/PropertyOrigin.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../chunks/Message.js";import"../core/Error.js";import"../chunks/ensureType.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import"../chunks/Evented.js";import"../core/Collection.js";import"../chunks/JSONSupport.js";import"../chunks/Promise.js";import"../chunks/asyncUtils.js";import"../core/urlUtils.js";import{aliasOf as r}from"../core/accessorSupport/decorators/aliasOf.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/jsonMap.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../chunks/resourceExtension.js";import"../geometry/SpatialReference.js";import"../chunks/locale.js";import"../chunks/number.js";import"../intl.js";import"../kernel.js";import"../request.js";import"../chunks/assets.js";import"../geometry/Geometry.js";import"../geometry/Point.js";import"../chunks/Ellipsoid.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Extent.js";import"../chunks/zmUtils.js";import"../geometry/Multipoint.js";import"../geometry/Polygon.js";import"../chunks/extentUtils.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../geometry.js";import"../core/Handles.js";import{on as i}from"../core/watchUtils.js";import"../core/HandleOwner.js";import"../chunks/domUtils.js";import"../chunks/widgetUtils.js";import"../chunks/projector.js";import{a as o}from"../chunks/accessibleHandler.js";import{m as n}from"../chunks/messageBundle.js";import{r as p}from"../chunks/renderable.js";import{j as c}from"../chunks/index.js";import m from"./Widget.js";import a from"./Attribution/AttributionViewModel.js";const l="esri-attribution esri-widget",u="esri-widget__anchor",h="esri-attribution__powered-by",d="esri-attribution__sources",j="esri-attribution--open",g="esri-attribution__sources--open",_="esri-attribution__link",k="esri-icon-description",b="esri-interactive";let v=class extends m{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=k,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new a}initialize(){this.own(i(this,"viewModel.items","change",(()=>this.scheduleRender())))}get attributionText(){return this.viewModel.items.reduce(((t,e)=>(-1===t.indexOf(e.text)&&t.push(e.text),t)),[]).join(this.itemDelimiter)}render(){const t={[j]:this._isOpen};return c("div",{bind:this,class:this.classes(l,t),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return c("div",{class:h},"Powered by"," ",c("a",{class:this.classes(_,u),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const t=this._isOpen,e=this._isInteractive(),s=e?0:-1,{attributionText:r}=this,i=e?"button":void 0,o={[g]:t,[b]:e};return c("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(d,o),innerHTML:r,role:i,tabIndex:s})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth}_afterSourcesNodeUpdate(t){let e=!1;const{clientHeight:s,clientWidth:r,scrollWidth:i}=t,o=i>=r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(e=!0),this._isOpen){const t=s<this._prevSourceNodeHeight;this._prevSourceNodeHeight=s,t&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive()&&(this._isOpen=!this._isOpen)}_isInteractive(){return this._isOpen||this._attributionTextOverflowed}};t([e({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0,autoTracked:!1}),p()],v.prototype,"attributionText",null),t([e()],v.prototype,"iconClass",void 0),t([e(),p()],v.prototype,"itemDelimiter",void 0),t([e({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],v.prototype,"label",void 0),t([e(),p(),n("esri/widgets/Attribution/t9n/Attribution")],v.prototype,"messages",void 0),t([r("viewModel.view")],v.prototype,"view",void 0),t([e({type:a}),p(["state","view.size"])],v.prototype,"viewModel",void 0),t([o()],v.prototype,"_toggleState",null),v=t([s("esri.widgets.Attribution")],v);var w=v;export default w;
