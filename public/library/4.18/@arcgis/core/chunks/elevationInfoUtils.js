/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{b as e,i as t,c as n}from"./Logger.js";import{g as o}from"./unitConversionUtils.js";function r(t,n){return e(n)||!n.mode?t?"absolute-height":"on-the-ground":n.mode}function s(e,n){return r(!!t(e)&&e.hasZ,n)}function i(e){const t=l(e);return s(e.geometry,t)}function a(e){const r=l(e),i=s(e.geometry,r);return{mode:i,offset:t(r)&&"on-the-ground"!==i?n(r.offset,0)*o(n(r.unit,"meters")):0}}function u(e){if("on-the-ground"===i(e))return!1;const n=l(e),o=t(n)&&n.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!o||"0"===o)}function l(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function c(n,o,r){if(e(r)||!r.mode)return;const s=n.hasZ?n.z:0,i=t(r.offset)?r.offset:0;switch(r.mode){case"absolute-height":return s-i;case"on-the-ground":return 0;case"relative-to-ground":return s-((o.elevationProvider.getElevation(n.x,n.y,n.z,n.spatialReference,"ground")||0)+i);case"relative-to-scene":return s-((o.elevationProvider.getElevation(n.x,n.y,n.z,n.spatialReference,"scene")||0)+i)}}function f(e,t,n,o=null){return v(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,o)}function g(e,t,n,o,r=null){return v(e,t[0],t[1],t.length>2?t[2]:0,n,o,r)}function v(n,o,r,s,i,a,u=null){if(e(a))return;const l=t(u)?u.mode:"absolute-height";if("on-the-ground"===l)return 0;return function(e,n,o,r,s,i,a,u){const l=t(a)&&t(a.offset)?a.offset:0;switch(u){case"absolute-height":return e-l;case"relative-to-ground":return e-((i.elevationProvider.getElevation(n,o,r,s,"ground")||0)+l);case"relative-to-scene":return e-((i.elevationProvider.getElevation(n,o,r,s,"scene")||0)+l)}}(function(e,n,o,r,s,i,a){const u=t(i.offset)?i.offset:0;switch(i.mode){case"absolute-height":return a+u;case"on-the-ground":return s.elevationProvider.getElevation(e,n,0,r,"ground")||0;case"relative-to-ground":return a+(s.elevationProvider.getElevation(e,n,o,r,"ground")||0)+u;case"relative-to-scene":return a+(s.elevationProvider.getElevation(e,n,o,r,"scene")||0)+u}}(o,r,s,i,n,a,s),o,r,s,i,n,u,l)}export{f as a,g as b,i as c,a as d,r as e,c as g,u as h};
