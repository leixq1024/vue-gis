/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{b as t}from"./Logger.js";import{P as s}from"../core/scheduling.js";class e{constructor(){this.q=new s,this._last=null}get done(){return 0===this.q.length&&(!this._last||this._last.isLeaf)}resetOne(t){this.q.clear(),this.q.push(t),this._last=null}reset(t){this.q.clear(),t&&this.q.pushArray(t),this._last=null}skipSubtree(){this._last=null}next(){return this._last&&!this._last.isLeaf&&this.q.pushArray(this._last.children),this._last=this.q.pop(),this._last}}class n{constructor(){this.q=new s}get done(){return 0===this.q.length}reset(t){if(this.q.clear(),t){this.q.pushArray(t);for(let t=0;t<this.q.length;++t){const s=this.q.data[t];s.isLeaf||this.q.pushArray(s.children)}}}next(){return this.q.pop()}}function r(t){return t?(s=t.lij)?s[0]+"/"+s[1]+"/"+s[2]:"null":"null";var s}function i(t,s){if(Array.isArray(t))for(let e=0;e<t.length;e++)l(t[e],s);else l(t,s)}function l(t,s){if(s(t),!t.isLeaf)for(const e of t.children)l(e,s)}function a(s,e,n){if(t(e))return!1;const r=e.fullExtent,i=s.extent;if(n){if(i[0]<r.xmin||i[1]<r.ymin||i[2]>r.xmax||i[3]>r.ymax)return!1}else if(r.xmin>i[2]||r.ymin>i[3]||r.xmax<i[0]||r.ymax<i[1])return!1;const l=s.surface.tilingScheme.levels[s.lij[0]].scale;return!(e.minScale>0&&l>1.00000001*e.minScale)&&!(e.maxScale>0&&l<.99999999*e.maxScale)}function o(t,s){s.sort(((s,e)=>h(s,e,t)))}function h(t,s,e){const n=t.screenDepth,r=s.screenDepth;return n<r?-e:n>r?e:0}function c(t,s){const e=new Map;t.forAll((t=>e.set(t,t.distanceToSquared(s)))),t.sort(((t,s)=>e.get(t)-e.get(s)))}function u(t,s,e){let n=1,r=0,i=0;for(;t!==s;)if(n*=.5,r*=.5,i*=.5,1&t.lij[2]&&(r+=.5),0==(1&t.lij[1])&&(i+=.5),null==(t=t.parent))throw new Error("tile was not a descendant of upsampleTile");e.init(s,r,i,n)}function f(t){for(let s=0;s<t.length;s++){const e=t[s],n=e.parent;if(n)for(let t=0;t<4;t++){const s=n.children[t];if(s&&s!==e&&s.visible)return!0}}return!1}function p(t,s){if(!t||!s||t[0]===s[0])return!1;const e=t[0]<s[0],n=e?t:s,r=e?s:t,i=1<<r[0]-n[0];return Math.floor(r[1]/i)===n[1]&&Math.floor(r[2]/i)===n[2]}export{e as I,i as a,h as b,u as c,n as d,c as e,a as f,p as g,f as h,o as s,r as t};
