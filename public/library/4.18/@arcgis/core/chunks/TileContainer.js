/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{W as e,d as s}from"./brushes.js";import{W as r}from"./enums.js";import{W as t}from"./WGLContainer.js";const n=(e,s)=>e.key.level-s.key.level!=0?e.key.level-s.key.level:e.key.row-s.key.row!=0?e.key.row-s.key.row:e.key.col-s.key.col;class i extends t{constructor(e){super(),this._tileInfoView=e}renderChildren(e){this.sortChildren(n),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:s}=e;return{...super.createRenderParams(e),requiredLevel:this._tileInfoView.getClosestInfoForScale(s.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(s.scale)}}prepareRenderPasses(t){const n=t.registerRenderPass({name:"stencil",brushes:[e],drawPhase:r.DEBUG|r.MAP|r.HIGHLIGHT,target:()=>this.getStencilTarget()}),i=t.registerRenderPass({name:"tileInfo",brushes:[s],drawPhase:r.DEBUG,target:()=>this.children,has:"esri-tiles-debug"});return[...super.prepareRenderPasses(t),n,i]}getStencilTarget(){return this.children}updateTransforms(e){for(const s of this.children){const r=this._tileInfoView.getTileResolution(s.key);s.setTransform(e,r)}}setStencilReference(){let e=1;for(const s of this.children)s.stencilRef=e++}}export{i as T};
