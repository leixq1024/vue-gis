/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import{i as r}from"./Logger.js";import{makeAbsolute as t,makeRelative as e,isAbsolute as o,normalize as s,changeDomain as l,hasSameOrigin as a,appUrl as u}from"../core/urlUtils.js";function n(r,o){const s=o&&o.url&&o.url.path;if(r&&s&&(r=t(r,s,{preserveProtocolRelative:!0}),o.portalItem&&o.readResourcePaths)){const t=e(r,o.portalItem.itemUrl);p.test(t)&&o.readResourcePaths.push(o.portalItem.resourceFromPath(t).path)}return U(r,o&&o.portal)}function i(r,a){if(!r)return r;!o(r)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(r);let u=t(r);if(a){const t=a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;if(t){const o=U(t,a.portal);u=e(U(u,a.portal),o,o),u!==r&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(u)}}return u=function(r,t){if(t&&!t.isPortal&&t.urlKey&&t.customBaseUrl)return l(r,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname);return r}(u,a&&a.portal),o(u)&&(u=s(u)),u}function c(r,t,e){return n(r,e)}function m(r,t,e,o){const s=i(r,o);void 0!==s&&(t[e]=s)}const f=/\/items\/([^\/]+)\/resources\//,p=/^\.\/resources\//;function v(t){const e=r(t)?t.match(f):null;return r(e)?e[1]:null}function U(r,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return r;const e=`${t.urlKey}.${t.customBaseUrl}`;return a(u,`${u.scheme}://${e}`)?l(r,t.portalHostname,e):l(r,e,t.portalHostname)}var h=Object.freeze({__proto__:null,fromJSON:n,toJSON:i,read:c,write:m,itemIdFromResourceUrl:v});export{n as f,v as i,h as p,c as r,i as t,m as w};
