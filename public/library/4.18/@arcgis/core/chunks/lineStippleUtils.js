/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
import"./object.js";import{i as t,b as e}from"./Logger.js";import{T as r}from"./isWebGL2Context.js";import"./RenderingContext.js";class n{constructor(){this.cache=new Map}dispose(){this.cache.forEach((e=>{t(e.texture)&&(e.texture.dispose(),e.texture=null)})),this.cache.clear()}acquire(t){if(e(t))return null;const n=this.patternId(t),s=this.cache.get(n);if(s)return s.refCount++,s.bind;const i=this.patternToTextureData(t,2),a=i.length/2,o={refCount:1,texture:null,bind:(t,n)=>(e(o.texture)&&(o.texture=new r(t,{width:i.length,height:1,internalFormat:6406,pixelFormat:6406,dataType:5121,wrapMode:33071},i)),t.bindTexture(o.texture,n),a)};return this.cache.set(n,o),o.bind}release(r){if(e(r))return;const n=this.patternId(r),s=this.cache.get(n);s&&(s.refCount--,0===s.refCount&&(t(s.texture)&&s.texture.dispose(),this.cache.delete(n)))}swap(t,e){const r=this.acquire(e);return this.release(t),r}patternId(t){return t.join(",")}patternToTextureData(t,e){const r=t.reduce(((t,e)=>t+e))*e,n=new Uint8Array(r);let s=!0,i=0;for(const r of t){for(let t=0;t<r*e;t++)n[i++]=s?255:0;s=!s}return n}}function s(t){return e(t)?t:t.slice()}function i(t){return[t,t]}export{n as S,i as a,s as c};
