// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../Logger ./utils ./extensions/serializableProperty ../Error ./PropertyOrigin ../arrayUtils ../promiseUtils".split(" "),function(l,t,k,n,u,p,v,w){function x(b,g,c,e,f){var d,a;const h={};null==(d=g.write)?void 0:null==(a=d.writer)?void 0:a.call(b,e,h,c,f);return h}function q(b,g,c,e,f,d){if(!e||!e.write)return!1;var a=b.get(c);if(!f&&e.write.overridePolicy){var h=e.write.overridePolicy.call(b,a,c,d);void 0!==h&&(f=h)}f||(f=e.write);if(!f||!1===f.enabled)return!1;if((null===a&&!f.allowNull||
void 0===a)&&f.isRequired)return(g=new u("web-document-write:property-required",`Missing value for required property '${c}' on '${b.declaredClass}'`,{propertyName:c,target:b}),d)&&d.messages?d.messages.push(g):g&&!d&&y.error(g.name,g.message),!1;if(void 0===a||null===a&&!f.allowNull)return!1;h=e.default;void 0===h?a=!1:null!=e.defaultEquals?a=e.defaultEquals(a):"function"===typeof h?Array.isArray(a)?(b=h.call(b,c,d),a=v.equals(b,a)):a=!1:a=h===a;return a?!1:void 0!==e.default?!0:!f.ignoreOrigin&&
d&&d.origin&&g.store.originOf(c)<p.nameToId(d.origin)?!1:!0}function r(b,g,c){if(b&&"function"===typeof b.toJSON&&(!b.toJSON.isDefaultToJSON||!b.write))return k.merge(g,b.toJSON());const e=k.getProperties(b),f=e.metadatas;for(const d in f){const a=n.originSpecificWritePropertyDefinition(f[d],c);if(!q(b,e,d,a,void 0,c))continue;const h=b.get(d),m=x(b,a,a.write&&"string"===typeof a.write.target?a.write.target:d,h,c);0<Object.keys(m).length&&(g=k.merge(g,m),c&&c.resources&&c.resources.pendingOperations&&
c.resources.pendingOperations.length&&w.all(c.resources.pendingOperations).then(()=>k.merge(g,m)),c&&c.writtenProperties&&c.writtenProperties.push({target:b,propName:d,oldOrigin:p.idToReadableName(e.store.originOf(d)),newOrigin:c.origin}))}return g}const y=t.getLogger("esri.core.accessorSupport.write");l.default=r;l.willPropertyWrite=function(b,g,c,e){const f=k.getProperties(b),d=n.originSpecificWritePropertyDefinition(f.metadatas[g],e);return d?q(b,f,g,d,c,e):!1};l.write=r;Object.defineProperty(l,
"__esModule",{value:!0})});