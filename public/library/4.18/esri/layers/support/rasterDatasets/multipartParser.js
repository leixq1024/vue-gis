// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports"],function(p){function q(c,d){const b=String.fromCharCode.apply(null,c.subarray(0,Math.min(300,c.length))).split("\n"),f=Math.min(b.length,7),a={};let e=0;for(let g=0;g<f;g++){var l;if(4>b[g].length)e=e+b[g].length+1;else if("content"===b[g].slice(0,7).toLowerCase()){e=e+b[g].length+1;if(-1===b[g].indexOf(":"))continue;const n=b[g].substring(0,b[g].indexOf(":")).trim(),m=b[g].substring(b[g].indexOf(":")+1).trim();switch(n.toLowerCase()){case "content-type":a.contentType=m;break;case "content-description":a.contentDescription=
m;break;case "content-transfer-encoding":a.contentTransferEncoding=m;break;case "content-id":a.contentID=m;break;case "content-disposition":a.contentDisposition=m;break;case "content-location":a.contentLocation=m}}else if(a.contentDisposition&&4<=b[g].length&&-1<(null==(l=a.contentType)?void 0:l.toLowerCase().indexOf("image"))){d=new ArrayBuffer(c.length-e);(new Uint8Array(d)).set(c.subarray(e,c.length));a.contentData=d;break}else if((""===d.start||a.contentID===d.start)&&a.contentType){if(-1<a.contentType.indexOf("text")){a.contentData=
String.fromCharCode.apply(null,c.subarray(e,c.length));break}a.contentData=c.subarray(e,c.length)}}return a}p.parse=function(c){var d;var b=null==(d=c.getHeader("Content-Type"))?void 0:d.split(";");d=null==b?void 0:b[0];if("multipart/related"!==d&&"multipart/mixed"!==d)b=null;else{d={boundary:"",start:"",type:""};for(var f=1;f<b.length;f++){var a=b[f].split("\x3d");d[a[0].trim()]=a[1].trim().slice(1,a[1].length-1)}b=d}if(!b)return{isMultipart:!1,data:null};{a=c.data;d="--"+b.boundary;c=[];for(f=0;f<
d.length;f++)c.push(d.charCodeAt(f));d=[];f="\n--"+b.boundary+"--";for(var e=0;e<f.length;e++)d.push(f.charCodeAt(e));var l=[10];const g=[13,10];f=[];const n=c.length;a=new Uint8Array(a);const m=Math.min(1E4,a.length-n);let h=e=0;for(let k=0;k<m;k++){for(h=0;h<n&&a[k+h]===c[h];h++);h===n&&(e&&f.push(q(a.subarray(e,k),b)),k+=n-1,a[k+1]===l[0]?k+=1:a[k+1]===g[0]&&a[k+2]===g[1]&&(k+=2),e=k+1)}c=d.length;for(l=a.length-c-10;l<a.length-c;l++){for(h=0;h<c&&a[l+h]===d[h];h++);if(h===c){f.push(q(a.subarray(e,
l),b));break}}b=f}return{isMultipart:!0,data:b}};Object.defineProperty(p,"__esModule",{value:!0})});