// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require exports ../chunks/_rollupPluginBabelHelpers ../core/maybe ../core/Error ../core/promiseUtils ./support/spatialReferenceUtils ./support/Ellipsoid ./Point ./Extent ./Multipoint ./Polygon ./Polyline ../core/mathUtils ../chunks/vec3f64 ../chunks/vec3 ./projectionEllipsoid ../core/unitUtils ../chunks/mat4 ../chunks/pe ./support/aaBoundingRect ./support/geodesicConstants ./support/GeographicTransformation".split(" "),function(ja,l,Ja,k,Ka,ka,x,t,la,La,Ma,Na,Oa,Q,M,N,R,Pa,O,Y,Qa,Ra,S){function ma(){return!!z&&
Y.isLoaded()}function na(a){k.isNone(T)&&(T=ka.all([Y.load(),(new Promise(function(b,c){ja(["../chunks/geometryEngineBase"],b,c)})).then(function(b){return b.geometryEngineBase}),new Promise(function(b,c){ja(["./geometryAdapters/hydrated"],b,c)})]));return T.then(([,b,{hydratedAdapter:c}])=>{ka.throwIfAborted(a);F=c;z=b.default;z._enableProjection(Y.pe)})}function Z(a,b,c,d,e=null){if(k.isNone(c)||k.isNone(d))return b;if(aa(c,d,e))return b.map(f=>Sa(f,c,d));if(k.isNone(e)){const f=S.cacheKey(c,d);
void 0!==U[f]?e=U[f]:(e=oa(c,d,null),k.isNone(e)&&(e=new S),U[f]=e)}if(k.isNone(z))throw new ba;return z._project(a,b,c,d,e)}function oa(a,b,c=null){if(k.isNone(z))throw new ba;if(k.isNone(a)||k.isNone(b))return null;a=z._getTransformation(F,a,b,c,null==c?void 0:c.spatialReference);return null!==a?S.fromGE(a):null}function aa(a,b,c){return c?!1:x.equals(a,b)?!0:x.isValid(a)&&x.isValid(b)&&!!ca(a,b,da)}function Sa(a,b,c){if(!a)return a;if("x"in a){var d=new la;return pa(a,b,d,c)?d:null}return"xmin"in
a?(d=new La,qa(a,b,d,c)?d:null):"rings"in a?(d=new Na,ra(a,b,d,c)?d:null):"paths"in a?(d=new Oa,sa(a,b,d,c)?d:null):"points"in a?(d=new Ma,ta(a,b,d,c)?d:null):null}function pa(a,b,c,d,e=0){m[0]=a.x;m[1]=a.y;const f=a.z;m[2]=void 0!==f?f:e;if(!y(m,b,0,m,d,0,1))return!1;c.x=m[0];c.y=m[1];c.spatialReference=d;void 0===f?(c.z=void 0,c.hasZ=!1):(c.z=m[2],c.hasZ=!0);void 0===a.m?(c.m=void 0,c.hasM=!1):(c.m=a.m,c.hasM=!0);return!0}function ta(a,b,c,d,e=0){const {points:f,hasZ:g,hasM:h}=a;a=[];const r=f.length,
q=[];for(var p of f)q.push(p[0],p[1],g?p[2]:e);if(!y(q,b,0,q,d,0,r))return!1;for(b=0;b<r;++b){e=3*b;p=q[e];const v=q[e+1];g&&h?a.push([p,v,q[e+2],f[b][3]]):g?a.push([p,v,q[e+2]]):h?a.push([p,v,f[b][2]]):a.push([p,v])}c.points=a;c.spatialReference=d;c.hasZ=g;c.hasM=h;return!0}function sa(a,b,c,d,e=0){const {paths:f,hasZ:g,hasM:h}=a;a=[];if(!ua(f,g,h,b,a,d,e))return!1;c.paths=a;c.spatialReference=d;c.hasZ=g;c.hasM=h;return!0}function ra(a,b,c,d,e=0){const {rings:f,hasZ:g,hasM:h}=a;a=[];if(!ua(f,g,h,
b,a,d,e))return!1;c.rings=a;c.spatialReference=d;c.hasZ=g;c.hasM=h;return!0}function qa(a,b,c,d,e=0){const {xmin:f,ymin:g,xmax:h,ymax:r,hasZ:q,hasM:p}=a;if(!ea(f,g,q?a.zmin:e,b,m,d))return!1;c.xmin=m[0];c.ymin=m[1];q&&(c.zmin=m[2]);if(!ea(h,r,q?a.zmax:e,b,m,d))return!1;c.xmax=m[0];c.ymax=m[1];q&&(c.zmax=m[2]);p&&(c.mmin=a.mmin,c.mmax=a.mmax);c.spatialReference=d;return!0}function ea(a,b,c,d,e,f){n[0]=a;n[1]=b;n[2]=c;return y(n,d,0,e,f,0,1)}function fa(a,b,c,d){if(k.isNone(b)||k.isNone(d)||2>a.length)return!1;
2===a.length&&(n[0]=a[0],n[1]=a[1],n[2]=0,a=n);return y(a,b,0,c,d,0,1)}function va(a,b,c){k.isNone(b)?a=!1:(b=C(b,V),b=D[b][6],k.isNone(b)?a=!1:(b(a,0,n,0),c!==n&&(c[0]=n[0],c[1]=n[1],2<c.length&&(c[2]=n[2])),a=!0));return a}function y(a,b,c,d,e,f,g=1){b=ca(b,e,da);if(k.isNone(b))return!1;if(b===u){if(a===d&&c===f)return!0;g=c+3*g;for(let h=c,r=f;h<g;h++,r++)d[r]=a[h];return!0}g=c+3*g;for(let h=c,r=f;h<g;h+=3,r+=3)b(a,h,d,r);return!0}function ua(a,b,c,d,e,f,g=0){const h=[];for(const r of a)for(const q of r)h.push(q[0],
q[1],b?q[2]:g);if(!y(h,d,0,h,f,0,h.length/3))return!1;d=0;e.length=0;for(const r of a){a=[];for(const q of r)b&&c?a.push([h[d++],h[d++],h[d++],q[3]]):b?a.push([h[d++],h[d++],h[d++]]):(c?a.push([h[d++],h[d++],q[2]]):a.push([h[d++],h[d++]]),d++);e.push(a)}return!0}function wa(a,b,c){const d=Math.sin(b);b=Math.cos(b);const e=Math.sin(a);a=Math.cos(a);c[0]=-d;c[4]=-e*b;c[8]=a*b;c[12]=0;c[1]=b;c[5]=-e*d;c[9]=a*d;c[13]=0;c[2]=0;c[6]=a;c[10]=e;c[14]=0;c[3]=0;c[7]=0;c[11]=0;c[15]=1;return c}function C(a,
b){if(b.spatialReference===a)return b.spatialReferenceId;b.spatialReference=a;"metersPerUnit"in b&&(b.metersPerUnit=Pa.getMetersPerUnitForSR(a,1));return a.wkt===R.SphericalECEFSpatialReference.wkt?b.spatialReferenceId=1:x.isWGS84(a)?b.spatialReferenceId=2:x.isWebMercator(a)?b.spatialReferenceId=3:a.wkt===R.WGS84ECEFSpatialReference.wkt?b.spatialReferenceId=4:4490===a.wkid?b.spatialReferenceId=5:a.wkt===R.SphericalPCPFMars.wkt?b.spatialReferenceId=7:a.wkt===R.SphericalPCPFMoon.wkt?b.spatialReferenceId=
9:x.isMars(a)?b.spatialReferenceId=8:x.isMoon(a)?b.spatialReferenceId=10:b.spatialReferenceId=0}function u(a,b,c,d){a!==c&&(c[d++]=a[b++],c[d++]=a[b++],c[d]=a[b])}function P(a,b,c,d){c[d++]=G*(a[b++]/t.earth.radius);c[d++]=G*(Math.PI/2-2*Math.atan(Math.exp(-1*a[b++]/t.earth.radius)));c[d]=a[b]}function xa(a,b,c,d){P(a,b,c,d);H(c,d,c,d)}function ya(a,b,c,d){P(a,b,c,d);I(c,d,c,d)}function J(a,b,c,d){var e=.4999999*Math.PI;e=Q.clamp(w*a[b+1],-e,e);e=Math.sin(e);c[d++]=w*a[b]*t.earth.radius;c[d++]=t.earth.halfSemiMajorAxis*
Math.log((1+e)/(1-e));c[d]=a[b+2]}function ha(a,b,c,d,e){e+=a[b+2];const f=w*a[b+1];a=w*a[b];b=Math.cos(f);c[d++]=Math.cos(a)*b*e;c[d++]=Math.sin(a)*b*e;c[d]=Math.sin(f)*e}function za(a,b,c,d){ha(a,b,c,d,t.moon.radius)}function Aa(a,b,c,d){ha(a,b,c,d,t.mars.radius)}function H(a,b,c,d){ha(a,b,c,d,t.earth.radius)}function W(a,b,c,d,e){var f=a[b];const g=a[b+1];b=a[b+2];a=Math.sqrt(f*f+g*g+b*b);b=Q.asinClamped(b/(0===a?1:a));f=Math.atan2(g,f);c[d++]=G*f;c[d++]=G*b;c[d]=a-e}function Ba(a,b,c,d){W(a,b,
c,d,t.moon.radius)}function Ca(a,b,c,d){W(a,b,c,d,t.mars.radius)}function K(a,b,c,d){W(a,b,c,d,t.earth.radius)}function Da(a,b,c,d){K(a,b,c,d);J(c,d,c,d)}function Ea(a,b,c,d){K(a,b,c,d);I(c,d,c,d)}function I(a,b,c,d){{var e=t.earth;const g=w*a[b];var f=w*a[b+1];a=a[b+2];b=Math.sin(f);f=Math.cos(f);const h=e.radius/Math.sqrt(1-e.eccentricitySquared*b*b);c[d++]=(h+a)*f*Math.cos(g);c[d++]=(h+a)*f*Math.sin(g);c[d++]=(h*(1-e.eccentricitySquared)+a)*b}}function L(a,b,c,d){var e=Ra.earthEllipsoidConstants,
f=a[b],g=a[b+1];a=a[b+2];let h;b=Math.abs(a);var r=f*f+g*g;var q=Math.sqrt(r);var p=r+a*a;var v=Math.sqrt(p);f=Math.atan2(g,f);var A=a*a/p;p=r/p;g=e.a2/v;r=e.a3-e.a4/v;.3<p?(A=b/v*(1+p*(e.a1+g+A*r)/v),v=Math.asin(A),g=A*A,p=Math.sqrt(1-g)):(p=q/v*(1-A*(e.a5-g-p*r)/v),v=Math.acos(p),g=1-p*p,A=Math.sqrt(g));h=1-t.earth.eccentricitySquared*g;g=t.earth.radius/Math.sqrt(h);e=e.a6*g;g=q-g*p;r=b-e*A;b=p*g+A*r;q=p*r-A*g;e=q/(e/h+b);v+=e;0>a&&(v=-v);c[d++]=G*f;c[d++]=G*v;c[d]=b+q*e/2}function Fa(a,b,c,d){L(a,
b,c,d);H(c,d,c,d)}function Ga(a,b,c,d){L(a,b,c,d);J(c,d,c,d)}function ca(a,b,c=ia()){return k.isNone(a)||k.isNone(b)?null:Ha(a,b,c).projector}function Ha(a,b,c){if(k.isNone(a)||k.isNone(b)||c.source.spatialReference===a&&c.dest.spatialReference===b)return c;const d=C(a,c.source),e=C(b,c.dest);0===d&&0===e?x.equals(a,b)?c.projector=u:c.projector=null:c.projector=D[d][e];return c}function ia(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,
metersPerUnit:1},projector:u}}let z=null,F=null,T=null,U={},ba=function(a){function b(){return a.call(this,"projection:not-loaded","projection engine not fully loaded yet, please call load()")||this}Ja._inheritsLoose(b,a);return b}(Ka);(function(a){a.x2lon=function(b){return b/t.earth.radius};a.y2lat=function(b){return Math.PI/2-2*Math.atan(Math.exp(-1*b/t.earth.radius))};a.lon2x=function(b){return b*t.earth.radius};a.lat2y=function(b){b=Math.sin(b);return t.earth.radius/2*Math.log((1+b)/(1-b))}})(l.webMercator||
(l.webMercator={}));const D={[2]:{[5]:null,[8]:null,[10]:null,[6]:u,[1]:H,[7]:null,[9]:null,[0]:null,[3]:J,[2]:u,[4]:I},[5]:{[5]:u,[8]:null,[10]:null,[6]:u,[1]:H,[7]:null,[9]:null,[0]:null,[3]:null,[2]:null,[4]:I},[8]:{[5]:null,[8]:u,[10]:null,[6]:null,[1]:null,[7]:Aa,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[10]:{[5]:null,[8]:null,[10]:u,[6]:null,[1]:null,[7]:null,[9]:za,[0]:null,[3]:null,[2]:null,[4]:null},[3]:{[5]:null,[8]:null,[10]:null,[6]:P,[1]:xa,[7]:null,[9]:null,[0]:null,[3]:u,[2]:P,
[4]:ya},[4]:{[5]:L,[8]:null,[10]:null,[6]:L,[1]:Fa,[7]:null,[9]:null,[0]:null,[3]:Ga,[2]:L,[4]:u},[1]:{[5]:K,[8]:null,[10]:null,[6]:K,[1]:u,[7]:null,[9]:null,[0]:null,[3]:Da,[2]:K,[4]:Ea},[7]:{[5]:null,[8]:Ca,[10]:null,[6]:null,[1]:null,[7]:u,[9]:null,[0]:null,[3]:null,[2]:null,[4]:null},[9]:{[5]:null,[8]:null,[10]:Ba,[6]:null,[1]:null,[7]:null,[9]:u,[0]:null,[3]:null,[2]:null,[4]:null},[0]:{[5]:null,[8]:null,[10]:null,[6]:null,[1]:null,[7]:null,[9]:null,[0]:u,[3]:null,[2]:null,[4]:null},[6]:{[5]:null,
[8]:null,[10]:null,[6]:u,[1]:H,[7]:null,[9]:null,[0]:null,[3]:null,[2]:u,[4]:I}},V={spatialReference:null,spatialReferenceId:0},Ia={spatialReference:null,spatialReferenceId:0},da=ia(),Ta=ia(),w=Q.deg2rad(1),G=Q.rad2deg(1),n=M.create(),B=M.create(),E=M.create(),m=M.create(),X=M.create();l.canProjectToWGS84ComparableLonLat=function(a){if(k.isNone(a))return!1;a=C(a,V);return!!D[a][6]};l.canProjectWithoutEngine=aa;l.computeLatLonToENURotation=wa;l.computeLinearTransformation=function(a,b,c,d){if(k.isNone(a)||
k.isNone(d))return!1;var e=C(a,V),f=C(d,Ia);if(e===f&&1!==f&&(0!==e||x.equals(a,d)))return O.identity(c),O.translate(c,c,b),!0;if(1===f||7===f||9===f){d=a=0;if(1===f){e=D[e][6];f=D[6][f];if(k.isNone(e)||k.isNone(f))return!1;e(b,0,B,0);f(B,0,E,0);a=w*B[0];d=w*B[1]}else if(7===f||9===f){f=D[e][f];if(k.isNone(f))return!1;f(b,0,E,0);a=w*b[0];d=w*b[1]}wa(d,a,c);c[12]=E[0];c[13]=E[1];c[14]=E[2];return!0}if(3===f&&(2===e||1===e)){f=D[e][6];if(k.isNone(f))return!1;f(b,0,B,0);b=w*B[1];J(B,0,E,0);O.identity(c);
O.translate(c,c,E);b=1/Math.cos(b);O.scale(c,c,[b,b,1]);return!0}return!1};l.getProjectorName=function(a,b){switch(ca(a,b,da)){case u:return"copy3";case H:return"wgs84ToSphericalECEF";case J:return"wgs84ToWebMercator";case I:return"wgs84ToWGS84ECEF";case P:return"webMercatorToWGS84";case xa:return"webMercatorToSphericalECEF";case ya:return"webMercatorToWGS84ECEF";case L:return"wgs84ECEFToWGS84";case Fa:return"wgs84ECEFToSphericalECEF";case Ga:return"wgs84ECEFToWebMercator";case K:return"sphericalECEFToWGS84";
case Da:return"sphericalECEFToWebMercator";case Ca:return"sphericalECEFToMars2000";case Ba:return"sphericalECEFToMoon2000";case Ea:return"sphericalECEFToWGS84ECEF";case Aa:return"mars2000ToSphericalPCPF";case za:return"moon2000ToSphericalPCPF";default:return null}};l.getTransformation=oa;l.getTransformations=function(a,b,c=null){if(k.isNone(z))throw new ba;a=z._getTransformationBySuitability(F,a,b,c,null==c?void 0:c.spatialReference);if(null!==a){b=[];for(const d of a)b.push(S.fromGE(d));return b}return[]};
l.initializeProjection=async function(a,b){if(!ma())for(const {source:c,dest:d,geographicTransformation:e}of a)if(!aa(c,d,e))return na(b)};l.isLoaded=ma;l.isSupported=function(){return!0};l.load=na;l.localLinearScaleFactors=function(a,b,c,d){if(k.isNone(b)||k.isNone(d))return!1;const e=C(b,V);var f=C(d,Ia);if(e===f&&0!==e||x.equals(b,d))return c[0]=1,c[1]=1,c[2]=1,!0;if(1===e){b=N.length(a);a=b/Math.sqrt(a[0]*a[0]+a[1]*a[1]);b/=t.earth.radius;if(3===f)return c[0]=a*b,c[1]=a*b,c[2]=1,!0;if(2===f||
5===f)return f=180/(t.earth.radius*Math.PI),c[0]=f*a*b,c[1]=f*b,c[2]=1,!0}return!1};l.lonLatToSphericalPCPF=function(a,b,c,d,e=0){d+=e;e=Math.cos(c);a[0]=Math.cos(b)*e*d;a[1]=Math.sin(b)*e*d;a[2]=Math.sin(c)*d};l.project=function(a,b,c=null){return Array.isArray(a)?0===a.length?[]:Z(F,a,a[0].spatialReference,b,c):Z(F,[a],a.spatialReference,b,c)[0]};l.projectBoundingRect=function(a,b,c,d){if(null==a)return!1;if(x.equals(b,d))return Qa.set(c,a),!0;n[0]=a[0];n[1]=a[1];n[2]=0;if(!y(n,b,0,n,d,0,1))return!1;
c[0]=n[0];c[1]=n[1];n[0]=a[2];n[1]=a[3];n[2]=0;if(!y(n,b,0,n,d,0,1))return!1;c[2]=n[0];c[3]=n[1];return!0};l.projectBoundingSphere=function(a,b,c,d){if(k.isNone(b)||k.isNone(d))return!1;b=Ha(b,d,Ta);if(b.projector===u)return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],!0;if(k.isNone(b.projector))return!1;const {source:e,dest:f}=b;if(3===f.spatialReferenceId){b=D[e.spatialReferenceId][2];if(k.isNone(b))return!1;b(a,0,B,0);b=Math.abs(w*B[1])+Math.asin(a[3]/(t.earth.radius+a[2]));J(B,0,c,0);c[3]=b>.9999*
Math.PI?Number.MAX_VALUE:1/Math.cos(b)*a[3];return!0}b.projector(a,0,c,0);c[3]=a[3]*e.metersPerUnit/f.metersPerUnit;return!0};l.projectBuffer=y;l.projectDirection=function(a,b,c,d,e){N.copy(m,a);N.add(X,a,b);fa(m,c,m,e);fa(X,c,X,e);N.subtract(d,X,m);N.normalize(d,d)};l.projectExtent=function(a,b,c=b.spatialReference,d=0){return k.isNone(c)?!1:qa(a,a.spatialReference,b,c,d)};l.projectMany=Z;l.projectMultipoint=function(a,b,c=b.spatialReference,d=0){return k.isNone(c)?!1:ta(a,a.spatialReference,b,c,
d)};l.projectPoint=function(a,b,c=b.spatialReference,d=0){return k.isNone(c)?!1:pa(a,a.spatialReference,b,c,d)};l.projectPointToVector=function(a,b,c,d=0){m[0]=a.x;m[1]=a.y;const e=a.z;m[2]=void 0!==e?e:d;return y(m,a.spatialReference,0,b,c,0,1)};l.projectPointToWGS84ComparableLonLat=function(a,b){m[0]=a.x;m[1]=a.y;const c=a.z;m[2]=void 0!==c?c:0;return va(m,a.spatialReference,b)};l.projectPolygon=function(a,b,c=b.spatialReference,d=0){return k.isNone(c)?!1:ra(a,a.spatialReference,b,c,d)};l.projectPolyline=
function(a,b,c=b.spatialReference,d=0){return k.isNone(c)?!1:sa(a,a.spatialReference,b,c,d)};l.projectVectorToDehydratedPoint=function(a,b,c,d){k.isNone(d)&&(d=c.spatialReference);return y(a,b,0,m,d,0,1)?(c.x=m[0],c.y=m[1],c.z=m[2],c.spatialReference=d,c):null};l.projectVectorToPoint=function(a,b,c,d){if(k.isNone(b)||k.isNone(c))return null;d=k.isSome(d)?d:new la({spatialReference:c});return y(a,b,0,m,c,0,1)?(d.x=m[0],d.y=m[1],d.z=m[2],d.spatialReference=c,d):null};l.projectVectorToVector=fa;l.projectVectorToWGS84ComparableLonLat=
va;l.projectXYZToVector=ea;l.sphericalECEFToSphericalPCPF=W;l.unload=function(){T=F=z=null;U={}};Object.defineProperty(l,"__esModule",{value:!0})});