// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../core/has ../../../core/maybe ../../../core/Error ../../../core/promiseUtils ../../../intl/date ../../../Color ../../../symbols/ExtrudeSymbol3DLayer ../../../symbols/SimpleLineSymbol ../../../symbols/FillSymbol3DLayer ../../../symbols/IconSymbol3DLayer ../../../symbols/LineSymbol3DLayer ../../../symbols/ObjectSymbol3DLayer ../../../symbols/PathSymbol3DLayer ../../../symbols/LineSymbol3D ../../../symbols/MeshSymbol3D ../../../symbols/PointSymbol3D ../../../symbols/PolygonSymbol3D ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleMarkerSymbol ../../../chunks/symbols ../../../renderers/support/pointCloud/PointSizeSplatAlgorithm ../../support/utils ../../../renderers/support/numberUtils ../../statistics/summaryStatistics ../../heuristics/outline ../../statistics/classBreaks ../../../views/support/colorUtils".split(" "),
function(h,Z,t,D,E,u,F,G,H,v,I,J,K,L,w,M,x,y,N,O,aa,P,l,m,Q,R,z,S){function p(a,b){return new D(a,b)}function n(a,b,c){return 0<a+b&&0>a-b&&0>c?0:a}function q(a,b,c){var d;let e,g;(b=(d={statistics:a,isDate:b},d.statistics))||(b={});if(null==b.min)if(d.isDate){var f=A();var k=f[0];f=f[1]}else k=0,f=100;else b.min===b.max&&(d.isDate?(f=A(b.min),k=f[0],f=f[1]):0>b.min?(k=2*b.min,f=0):0<b.min?(k=0,f=2*b.min):(k=0,f=100));d=null!=k?k:b.min;b=null!=f?f:b.max;(k=null!=k||null!=f)?(e=d,g=b):!c||null!=a.avg&&
a.stddev||(e=a.min,g=a.max);return null!=e?[e,g]:null}function A(a){var b=("number"===typeof a?new Date(a):new Date).getUTCFullYear();let c=Date.UTC(b,0,1,12,0,0,0);b=Date.UTC(b,11,31,12,0,0,0);"number"===typeof a&&(a<c&&(c=a),a>b&&(b=a));return[c,b]}function r(a,b,c){const d=(b-a)/(c-1),e=[a];for(let g=1;g<=c-2;g++)e.push(a+g*d);e.push(b);return m.round(e,{strictBounds:!0})}function B(a,b=!0){let c=a.avg,d=c-a.stddev,e=c+a.stddev;d<a.min&&(d=a.min);e>a.max&&(e=a.max);b&&(c=d+(e-d)/2);a=m.round([d,
e],{strictBounds:!0});d=a[0];e=a[1];a=[d,d+(c-d)/2,c,c+(e-c)/2,e];return m.round(a,{strictBounds:!0})}function T(a){const b=a.layer;return a.fields.filter(c=>!b.getField(c))}function U(a){const b=a.layer;return a.fields.filter(c=>{c=b.getFieldUsageInfo(c);return!c||!c.supportsRenderer})}const C=/^(\d+(\.\d+)?)\s*(%)$/i,V=[0,0,0,.4],W=["hours","minutes","seconds"],X=[].concat(l.defaultBasemapGroups.light).concat(l.defaultBasemapGroups.dark);h.createColors=function(a,b){const c=[],d=a.length;for(let e=
0;e<b;e++)c.push(new F(a[e%d]));return c};h.createDataValues=function(a,b,c,d=!0){const {minDataValue:e,maxDataValue:g,defaultValuesUsed:f}=a;return f||"above"===c||"below"===c||"90-10"===c?r(e,g,5):B(b,d)};h.createDefaultStopValues=r;h.createError=p;h.createStopValues=B;h.createStopValuesForAboveBelow=function(a){const {avg:b,stddev:c,min:d,max:e}=a;if(null==b||null==c)return r(d,e,5);a=n(b,c,d);const g=Math.max(e-a,a-d);return m.round([a-g,a-g/2,a,g/2+a,a+g],{strictBounds:!0})};h.createSymbol=function(a,
b){const {type:c,size:d,color:e,outline:g}=b;switch(a){case "point":case "multipoint":if("2d"===c)var f=new O({color:e,size:d,outline:{color:g.color,width:g.width}});else"3d-flat"===c?f=new x({symbolLayers:[new I({size:d,resource:{primitive:"circle"},material:{color:e},outline:{color:g.color,size:g.width}})]}):-1<c.indexOf("3d-volumetric")&&(a="3d-volumetric-uniform"===c,f=new K({height:d,resource:{primitive:a?"sphere":"cylinder"},material:{color:e}}),a||(f.width=b.widthAndDepth,f.depth=b.widthAndDepth),
f=new x({symbolLayers:[f]}));break;case "polyline":"2d"===c?f=new H({color:e,width:d}):"3d-flat"===c?f=new w({symbolLayers:[new J({size:d,material:{color:e}})]}):"3d-volumetric"===c&&(f=new w({symbolLayers:[new L({size:d,material:{color:e}})]}));break;case "polygon":"2d"===c?f=new N({color:e,outline:{color:g.color,width:g.width}}):"3d-flat"===c?f=new y({symbolLayers:[new v({material:{color:e},outline:{color:g.color,size:g.width}})]}):"3d-volumetric"===c&&(f=new y({symbolLayers:[new G({size:d,material:{color:e}})]}));
break;case "mesh":a=b.meshInfo&&b.meshInfo.edgesType,f=new M({symbolLayers:[new v({material:{color:e,colorMixMode:b.meshInfo&&b.meshInfo.colorMixMode},edges:null==a||"none"===a?null:{type:a,color:V}})]})}return f};h.formatDate=function(a,b,c){if("string"===typeof a){if((b=c.getField(a))&&"date"===b.type)return b.alias||b.name}else if("number"===typeof a||a instanceof Date)return b=-1<W.indexOf(b)?"short-date-short-time":"short-date",u.formatDate(a,u.convertDateFormatToIntlOptions(b));return a};h.getBaseValueForAboveBelow=
n;h.getBasemapInfo=async function(a,b){let c=null,d=null;if(!a&&!b)return{basemapId:c,basemapTheme:d};if(!a&&b){var e;a=b&&(null==(e=b.map)?void 0:e.basemap)}a&&(c=l.getBasemapId(a,X,!1))&&(a=l.getBasemapGroup(c),t.isSome(a)&&(d=a));c||"2d"!==(null==b?void 0:b.type)||(d=await S.getBackgroundColorTheme(b),t.isSome(d)&&(c="dark"===d?"dark-gray":"gray"));return{basemapId:c,basemapTheme:d}};h.getClassBreaks=async function(a,b){const c={layer:a.layer,view:a.view,signal:a.signal},[d,e]=await E.all([z(a),
b?R(c):null]);b=q({min:d.minValue,max:d.maxValue,avg:null,stddev:null},!1,!1);return{result:b?await z({...a,classificationMethod:"equal-interval",numClasses:1,analyzeData:!1,minValue:b[0],maxValue:b[1],normalizationTotal:b[0]+b[1]}):d,defaultValuesUsed:!!b,outlineResult:e}};h.getDataRange=function(a,b,c,d,e=!0){a="90-10"===c&&b?{min:b.classBreakInfos[0].maxValue,max:b.classBreakInfos[b.classBreakInfos.length-1].minValue,avg:null,stddev:null}:a;const {avg:g,stddev:f,min:k,max:Y}=a;e=(d=q(a,d,e))?d[0]:
k;a=d?d[1]:Y;if(d)return{minDataValue:e,maxDataValue:a,defaultValuesUsed:!0};"above"===c?e=n(g,f,k):"below"===c&&(a=n(g,f,k));return{minDataValue:e,maxDataValue:a,defaultValuesUsed:!1}};h.getDefaultDataRange=q;h.getPointSizeAlgorithm=function(a){a=a.match(C);const b=Number(a[1]);if("%"===a[3])return new P["default"]({scaleFactor:b/100})};h.getSizeRangeForAxis=function(a,b){let {minSize:c,maxSize:d}=a;"height"===b&&(c=((d-c)/2+c)/4.6,d*=2);return{minSize:c,maxSize:d}};h.getSummaryStatistics=function(a){return Q(a)};
h.getSymbolOutlineFromScheme=function(a,b,c){switch(b){case "point":case "multipoint":case "polygon":if(!("outline"in a))return null;a={color:a.outline.color,width:a.outline.width};null!=c&&a.color&&(b=a.color.clone(),b.a=c,a.color=b);return a}};h.getSymbolSizeFromScheme=function(a,b,c){switch(b){case "point":case "multipoint":return c?"noDataSize"in a?a.noDataSize:null:"size"in a?a.size:null;case "polyline":return c?"noDataWidth"in a?a.noDataWidth:null:"width"in a?a.width:null;case "polygon":return"size"in
a?a.size:null}};h.isValidPointSize=function(a){return C.test(a)};h.updateAgeRendererAuthoringInfoVV=function(a,b,c,d){a.startTime=b instanceof Date?b.getTime():b;a.endTime=c instanceof Date?c.getTime():c;a.units=d;a.field="string"===typeof b?b:"string"===typeof c?c:null};h.verifyBasicFieldValidity=function(a,b,c){const d=T({layer:a,fields:b});if(d.length)return p(c,"Unknown fields: "+d.join(", ")+". You can only use fields defined in the layer schema");a=U({layer:a,fields:b});if(a.length)return p(c,
"Unsupported fields: "+a.join(", ")+". You can only use fields that are accessible to the renderer i.e. FieldUsageInfo.supportsRenderer must be true")};Object.defineProperty(h,"__esModule",{value:!0})});