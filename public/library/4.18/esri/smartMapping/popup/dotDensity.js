// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../core/Error ../../core/promiseUtils ../../popup/FieldInfo ../../popup/ExpressionInfo ../../PopupTemplate ../../intl/messages ../statistics/support/predominanceUtils ./support/utils".split(" "),function(k,p,q,l,m,h,r,n,e){async function t(a){const {layer:b,renderer:c}=a;await b.load();a=c||b.renderer;if("dot-density"!==a.type)throw new p("dot-density-popup:invalid-parameters","renderer.type must be 'dot-density'");return{layer:b,renderer:a}}async function u(a,b){const {fieldInfos:c,
expressionInfos:d}=await e.getFieldAndExpressionInfos({renderer:a,layer:b});return new h({content:await e.getContentFromFieldInfos(b,{fieldInfos:c,expressionInfos:d}),expressionInfos:d,fieldInfos:c})}async function v(a,b,c){const {fieldInfos:d,expressionInfos:f}=await e.getFieldAndExpressionInfos({renderer:a,layer:b});b=d.filter(g=>-1===g.fieldName.indexOf(e.expressionFieldPrefix));a=new l({fieldName:"expression/dot-density-categories-list"});b=new m({name:"dot-density-categories-list",title:c.listOfCategories,
expression:n.getArcadeForOrderedFields(b,f)});a=new h({expressionInfos:[b],fieldInfos:[a],title:c.competingFields,content:`{${a.fieldName}}`});return{name:"dot-density-categories-list",title:c.orderedListOfValues,value:a}}async function w(a,b,c){const {fieldInfos:d,expressionInfos:f}=await e.getFieldAndExpressionInfos({renderer:a,layer:b});b=d.filter(g=>-1===g.fieldName.indexOf(e.expressionFieldPrefix));a=new l({fieldName:"expression/dot-density-category"});b=new m({name:"dot-density-category",title:c.predominantCategory,
expression:n.getArcadeForPredominantCategoryAlias(b,f)});a=new h({expressionInfos:[b,...f],fieldInfos:[a,...d],content:[{type:"text",text:`<div><b><font size="3">{${a.fieldName}}</font></b></div>`},{type:"media",mediaInfos:{type:"pie-chart",title:c.competingFields,value:{fields:d.map(g=>g.fieldName)}}}]});return{name:"dot-density-category-chart",title:c.predominantCategoryWithChart,value:a}}k.getTemplates=async function(a){const [{renderer:b,layer:c},d]=await q.all([t(a),r.fetchMessageBundle("esri/smartMapping/t9n/smartMapping")]);
a={name:"dot-density",title:d.dotDensity,value:await u(b,c)};const f=[await v(b,c,d),await w(b,c,d)];return{primaryTemplate:a,secondaryTemplates:f}};Object.defineProperty(k,"__esModule",{value:!0})});