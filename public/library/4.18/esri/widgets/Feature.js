// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/accessorSupport/decorators/cast ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../intl/substitute ../intl ../core/watchUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./Attachments ./Feature/FeatureContent ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureViewModel ./Feature/support/FeatureContentMixin".split(" "),
function(w,h,e,G,l,k,x,H,y,I,J,K,z,L,A,M,r,m,f,B,C,n,D,E,t,F){const u={title:!0,content:!0,lastEditedInfo:!0};e=function(v){function p(a,b){a=v.call(this,a,b)||this;a._contentWidgets=[];a.graphic=null;a.defaultPopupTemplateEnabled=!1;a.label=void 0;a.messages=null;a.messagesURIUtils=null;a.spatialReference=null;a.title=null;a.visibleElements={...u};a.map=null;a.view=null;a.viewModel=new t;return a}w._inheritsLoose(p,v);var d=p.prototype;d.initialize=function(){this.own(A.init(this,"viewModel.contentViewModels",
()=>this._setupContentWidgets()))};d.destroy=function(){this._destroyContentWidgets()};d.castVisibleElements=function(a){return{...u,...a}};d.render=function(){const {waitingForContent:a}=this.viewModel;return f.jsx("div",{class:this.classes("esri-feature","esri-widget")},f.jsx("div",{class:"esri-feature__size-container"},this.renderTitle(),a?this.renderLoading():this.renderContentContainer()))};d.setActiveMedia=function(a,b){this.viewModel.setActiveMedia(a,b)};d.nextMedia=function(a){this.viewModel.nextMedia(a)};
d.previousMedia=function(a){this.viewModel.previousMedia(a)};d.renderLoading=function(){return f.jsx("div",{key:"loading-container",class:"esri-feature__loading-container"},f.jsx("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))};d.renderContentContainer=function(){const {visibleElements:a}=this;return a.content?f.jsx("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null};d.renderTitle=function(){const {visibleElements:a,
title:b}=this;return a.title?f.jsx("h4",{class:"esri-feature__title",innerHTML:b}):null};d.renderContent=function(){var a=this.viewModel.content;return a?Array.isArray(a)?a.length?f.jsx("div",{key:"content-content-elements"},a.map(this.renderContentElement,this)):null:"string"===typeof a?(a=this._contentWidgets[0],!a||a.destroyed?null:f.jsx("div",{key:"content-content"},a.render())):this.renderNodeContent(a):null};d.renderContentElement=function(a,b){const {visibleElements:c}=this;if("boolean"!==
typeof c.content&&!c.content[a.type])return null;switch(a.type){case "attachments":return this.renderAttachments(b);case "custom":return this.renderCustom(a,b);case "fields":return this.renderFields(b);case "media":return this.renderMedia(b);case "text":return this.renderText(a,b);default:return null}};d.renderAttachments=function(a){const b=this._contentWidgets[a];if(!b||b.destroyed)return null;const {state:c,attachmentInfos:g}=b.viewModel;return"loading"===c||0<g.length?f.jsx("div",{key:this._buildKey("attachments-element",
a),class:this.classes("esri-feature__attachments","esri-feature__content-element")},f.jsx("h2",null,this.messages.attach),b.render()):null};d.renderCustom=function(a,b){({creator:a}=a);const c=this._contentWidgets[b];return!c||c.destroyed?null:a?f.jsx("div",{key:this._buildKey("custom-element",b),class:"esri-feature__content-element"},c.render()):null};d.renderFields=function(a){const b=this._contentWidgets[a];return!b||b.destroyed?null:f.jsx("div",{key:this._buildKey("fields-element",a),class:"esri-feature__content-element"},
b.render())};d.renderMedia=function(a){const b=this._contentWidgets[a];return!b||b.destroyed?null:f.jsx("div",{key:this._buildKey("media-element",a),class:"esri-feature__content-element"},b.render())};d.renderLastEditInfo=function(){const {visibleElements:a,messages:b}=this;var {lastEditInfo:c}=this.viewModel;if(!c||!a.lastEditedInfo)return null;const {date:g,user:q}=c;c=z.substitute("edit"===c.type?q?b.lastEditedByUser:b.lastEdited:q?b.lastCreatedByUser:b.lastCreated,{date:g,user:q});return f.jsx("div",
{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info","esri-feature__content-element")},c)};d.renderText=function(a,b){const c=this._contentWidgets[b];return!c||c.destroyed?null:a.text?f.jsx("div",{key:this._buildKey("text-element",b),class:this.classes("esri-feature__content-element","esri-feature__text")},c.render()):null};d._buildKey=function(a,...b){const c=this.get("viewModel.graphic.uid")||"0";b=b.join("-");return`${a}__${c}-${b}`};d._destroyContentWidgets=function(){this._contentWidgets.forEach(a=>
{a.viewModel=null;a&&!a.destroyed&&a.destroy()});this._contentWidgets=[]};d._setupContentWidgets=function(){this._destroyContentWidgets();var a=this.get("viewModel.content");const {contentViewModels:b}=this.viewModel;Array.isArray(a)?a.forEach((c,g)=>{"attachments"===c.type&&(this._contentWidgets[g]=new C({displayType:c.displayType,viewModel:b[g]}));"fields"===c.type&&(this._contentWidgets[g]=new D({viewModel:b[g]}));"media"===c.type&&(this._contentWidgets[g]=new E({viewModel:b[g]}));"text"===c.type&&
(this._contentWidgets[g]=new n({viewModel:b[g]}));"custom"===c.type&&(this._contentWidgets[g]=new n({viewModel:b[g]}))},this):(a=b[0])&&!a.destroyed&&(this._contentWidgets[0]=new n({viewModel:a}));this.scheduleRender()};return p}(F.FeatureContentMixin(B));h.__decorate([k.aliasOf("viewModel.graphic")],e.prototype,"graphic",void 0);h.__decorate([k.aliasOf("viewModel.defaultPopupTemplateEnabled")],e.prototype,"defaultPopupTemplateEnabled",void 0);h.__decorate([l.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],e.prototype,"label",void 0);h.__decorate([l.property(),m.renderable(),r.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);h.__decorate([l.property(),m.renderable(),r.messageBundle("esri/widgets/support/t9n/uriUtils")],e.prototype,"messagesURIUtils",void 0);h.__decorate([k.aliasOf("viewModel.spatialReference")],e.prototype,"spatialReference",void 0);h.__decorate([k.aliasOf("viewModel.title")],e.prototype,"title",void 0);h.__decorate([l.property(),
m.renderable()],e.prototype,"visibleElements",void 0);h.__decorate([x.cast("visibleElements")],e.prototype,"castVisibleElements",null);h.__decorate([k.aliasOf("viewModel.map")],e.prototype,"map",void 0);h.__decorate([k.aliasOf("viewModel.view")],e.prototype,"view",void 0);h.__decorate([l.property({type:t}),m.renderable(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo","viewModel.contentViewModels"])],e.prototype,"viewModel",void 0);return e=h.__decorate([y.subclass("esri.widgets.Feature")],
e)});