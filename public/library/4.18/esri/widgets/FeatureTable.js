// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/accessorSupport/decorators/cast ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/Collection ../intl/locale ../intl/substitute ../intl/messages ../intl ../core/watchUtils ../core/HandleOwner ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./FeatureTable/Grid/support/ButtonMenuItem ./FeatureTable/Grid/support/ButtonMenu ./FeatureTable/FeatureTableViewModel".split(" "),
function(y,d,c,L,p,f,z,M,A,N,O,P,B,C,D,E,Q,q,F,R,G,t,l,H,r,I,J){const v={header:!0,menu:!0,menuItems:{clearSelection:!0,refreshData:!0,toggleColumns:!0},selectionColumn:!0};c=function(w){function u(a,b){a=w.call(this,a,b)||this;a._menu=null;a.attachmentsEnabled=null;a.columns=new B;a.editingEnabled=null;a.fieldConfigs=null;a.grid=null;a.highlightOnRowSelectEnabled=!0;a.label=void 0;a.layer=null;a.messages=null;a.menuConfig=null;a.view=null;a.viewModel=new J;a.visibleElements={...v};return a}y._inheritsLoose(u,
w);var e=u.prototype;e.initialize=function(){var a,b,g;const h=async()=>this.messages=await E.fetchMessageBundle("esri/widgets/FeatureTable/t9n/FeatureTable");h();this.handles.add([C.onLocaleChange(h),q.on(this,"grid.selectedItems","change",n=>this._onSelectionChange(n)),q.watch(this,["viewModel.store.querying","viewModel.store.syncing","grid.size"],()=>this.scheduleRender()),q.on(this,"viewModel.columns","change",()=>this._updateMenuItems()),q.watch(this,"menuConfig",()=>this._updateMenuItems()),
q.watch(this,"messages",()=>{var n;this._menu.label=null==(n=this.messages)?void 0:n.options;this._updateMenuItems()})]);this._menu=new I({label:null==(a=this.messages)?void 0:a.options,iconClass:"esri-icon-handle-horizontal",...this.menuConfig});const {attachmentsEnabled:k,relatedRecordsEnabled:m}=this;null==(b=this.viewModel)?void 0:null==(g=b.store)?void 0:g.set({attachmentsEnabled:k,relatedRecordsEnabled:m})};e.destroy=function(){this.clearSelection();this.handles.removeAll()};e.castVisibleElements=
function(a){var b;a={...v,...a};null==(b=this.grid)?void 0:b.set("visibleElements",{...this.grid.visibleElements,selectionColumn:a.selectionColumn});return a};e.clearHighlights=function(){};e.clearSelection=function(){};e.deselectRows=function(){};e.hideColumn=function(a){var b;null==(b=this.grid)?void 0:b.hideColumn(a);this._updateMenuItems()};e.refresh=function(){};e.showColumn=function(a){var b;null==(b=this.grid)?void 0:b.showColumn(a);this._updateMenuItems()};e.sortColumn=function(){};e.selectRows=
function(){};e.render=function(){var a;return l.jsx("div",{bind:this,class:this.classes("esri-feature-table","esri-widget")},this.visibleElements.header?this._renderHeader():null,l.jsx("div",{class:"esri-feature-table__content"},"disabled"!==this.state&&(null==(a=this.grid)?void 0:a.render())))};e._renderHeader=function(){return l.jsx("div",{key:"header",class:"esri-feature-table__header"},this._renderLoader(),this._renderTitle(),this._renderMenu())};e._renderTitle=function(){return l.jsx("div",{class:"esri-feature-table__title",
key:"title"},this._getTitle())};e._getTitle=function(){const {grid:a,layer:{title:b},messages:g,viewModel:{size:h}}=this;return a?D.substitute(g.header,{title:b,count:h,selected:a.selectedItems.length||0}):""};e._renderLoader=function(){const {state:a,store:b}=this.viewModel;return l.jsx("div",{class:"esri-feature-table__loader-container"},"loading"===a||b.syncing||b.querying?l.jsx("div",{class:"esri-feature-table__loader",key:"loader"}):null)};e._renderMenu=function(){return l.jsx("div",{class:"esri-feature-table__menu"},
this._menu.render())};e._onSelectionChange=function(a){const {added:b,removed:g}=a;this.emit("selection-change",{added:[...b],removed:[...g]})};e._updateMenuItems=function(){var a,b;const g=null==(a=this.menuConfig)?void 0:a.items;a=this._getDefaultMenuItems();const h=[];(null==a?0:a.length)&&h.push(...a);(null==g?0:g.length)&&h.push(...g);h.length&&(null==(b=this._menu)?void 0:b.set("items",h))};e._getDefaultMenuItems=function(){var a;const {messages:b,viewModel:g,visibleElements:h}=this,{menuItems:k}=
h,m=[];(null==k?0:k.clearSelection)&&m.push(new r({selectionEnabled:!1,label:null==b?void 0:b.clearSelection,clickFunction:()=>this.clearSelection()}));(null==k?0:k.refreshData)&&m.push(new r({selectionEnabled:!1,label:null==b?void 0:b.refreshData,clickFunction:()=>this.refresh()}));(null==k?0:k.toggleColumns)&&m.push(new r({iconClass:"esri-icon-right",label:null==b?void 0:b.toggleColumns,clickFunction:this._toggleMenuItemSelectedIcon,items:null==g?void 0:null==(a=g.columns)?void 0:a.items.map(({header:n,
hidden:K,path:x})=>new r({label:n||x,selected:!K,selectionEnabled:!0,iconClass:"esri-icon-check-mark",clickFunction:()=>this._toggleColumnFromMenuItem(x)}))}));return m.length?m:null};e._toggleMenuItemSelectedIcon=function({item:a}){null==a?void 0:a.set("iconClass",null!=a&&a.selected?"esri-icon-down":"esri-icon-right")};e._toggleColumnFromMenuItem=function(a){var b;const g=null==(b=this.viewModel)?void 0:b.findColumn(a);null!=g&&g.hidden?this.showColumn(a):this.hideColumn(a)};return u}(F.HandleOwnerMixin(H));
d.__decorate([f.aliasOf("viewModel.attachmentsEnabled")],c.prototype,"attachmentsEnabled",void 0);d.__decorate([f.aliasOf("viewModel.columns")],c.prototype,"columns",void 0);d.__decorate([f.aliasOf("viewModel.editingEnabled")],c.prototype,"editingEnabled",void 0);d.__decorate([f.aliasOf("viewModel.fieldConfigs")],c.prototype,"fieldConfigs",void 0);d.__decorate([f.aliasOf("viewModel.grid")],c.prototype,"grid",void 0);d.__decorate([f.aliasOf("viewModel.highlightOnRowSelectEnabled")],c.prototype,"highlightOnRowSelectEnabled",
void 0);d.__decorate([p.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],c.prototype,"label",void 0);d.__decorate([f.aliasOf("viewModel.layer")],c.prototype,"layer",void 0);d.__decorate([p.property(),t.renderable(),G.messageBundle("esri/widgets/FeatureTable/t9n/FeatureTable")],c.prototype,"messages",void 0);d.__decorate([p.property()],c.prototype,"menuConfig",void 0);d.__decorate([f.aliasOf("viewModel.relatedRecordsEnabled")],c.prototype,"relatedRecordsEnabled",void 0);d.__decorate([f.aliasOf("viewModel.state")],
c.prototype,"state",void 0);d.__decorate([f.aliasOf("viewModel.view")],c.prototype,"view",void 0);d.__decorate([p.property(),t.renderable("viewModel.attachmentsEnabled viewModel.columns viewModel.editingEnabled viewModel.layer viewModel.relatedRecordsEnabled viewModel.state".split(" "))],c.prototype,"viewModel",void 0);d.__decorate([p.property(),t.renderable()],c.prototype,"visibleElements",void 0);d.__decorate([z.cast("visibleElements")],c.prototype,"castVisibleElements",null);d.__decorate([f.aliasOf("viewModel.clearHighlights")],
c.prototype,"clearHighlights",null);d.__decorate([f.aliasOf("viewModel.clearSelection")],c.prototype,"clearSelection",null);d.__decorate([f.aliasOf("viewModel.deselectRows")],c.prototype,"deselectRows",null);d.__decorate([f.aliasOf("viewModel.refresh")],c.prototype,"refresh",null);d.__decorate([f.aliasOf("viewModel.sortColumn")],c.prototype,"sortColumn",null);d.__decorate([f.aliasOf("viewModel.selectRows")],c.prototype,"selectRows",null);return c=d.__decorate([A.subclass("esri.widgets.FeatureTable")],
c)});