// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../geometry/Point ../../geometry/support/coordsUtils ../../geometry ../../core/Evented ../../core/Collection ../../core/screenUtils ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleMarkerSymbol ../../chunks/symbols ../../Graphic ../../core/Handles ../../geometry/projectionEllipsoid ../../core/watchUtils ../../layers/GraphicsLayer ../../views/input/InputManager ../../views/DOMContainer ../../views/support/screenUtils ../../views/interactive/snapping/SnappingOptions ../../views/draw/support/createUtils ../../views/draw/Draw ../../views/3d/interactive/editingTools/isSupportedGraphicUtils ../../views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic ../../views/3d/interactive/editingTools/transformGraphic/isSupportedGraphic ../../views/draw/support/layerUtils ./support/OperationHandle".split(" "),
function(F,S,r,q,t,ca,ra,u,sa,da,ea,ta,ua,va,K,T,wa,fa,ha,N,O,P,E,G,z,U,ia,J,ja,w,ka,Q,V,x,la,W,ma,X,na,Y,H){function R(y){return Object.freeze({__proto__:null,"default":y})}function L(y,C){const n=y.history.undo.pop().updates,a=[];C.forEach((b,c)=>{c=n[c];const d={};null!=c&&(t.isSome(c.geometry)&&(d.geometry=b.geometry,b.geometry=c.geometry),t.isSome(c.symbol)&&(d.symbol=b.symbol,b.symbol=c.symbol),a.push(d))});y.history.redo.push({updates:a})}function M(y,C){const n=y.history.redo.pop().updates,
a=[];C.forEach((b,c)=>{c=n[c];const d={};null!=c&&(t.isSome(c.geometry)&&(d.geometry=b.geometry,b.geometry=c.geometry),t.isSome(c.symbol)&&(d.symbol=b.symbol,b.symbol=c.symbol),a.push(d))});y.history.undo.push({updates:a})}function D(y){return{updates:y.map(C=>({geometry:C.geometry}))}}function Z(y){return{updates:y.map(C=>({symbol:C.symbol}))}}function A(y){return"requireError"in y&&"aborted"===y.requireError}const oa=ca.getLogger("esri.widgets.Sketch.SketchViewModel");var pa=["Backspace","Delete"];
const aa={defaultZ:0},ba={enableMidpoints:!0,enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,tool:"transform",enableZ:!0,enableMoveGraphic:!0};q=function(y){function C(a){a=y.call(this,a)||this;a._activeFillGraphic=null;a._activeLineGraphic=null;a._centerIndicatorGraphic=null;a._centerSymbol=new E({style:"cross",size:6,color:[255,255,255]});a._defaultSegmentOffset=48;a._numUpdating=0;a._handles=new U;a._internalGraphicsLayer=
new ja({listMode:"hide"});a._lineGraphic=null;a._operationHandle=null;a._vertexGraphics=[];a._viewHandles=new U;a._doUnnormalization=!1;a.activeFillSymbol=new P({style:"solid",color:[150,150,150,.2],outline:{color:[50,50,50],width:0}});a.activeLineSymbol=new O({color:[255,127,0,1],width:2});a.activeVertexSymbol=new E({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}});a.layer=null;a.pointSymbol=new E({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],
width:1}});a.polygonSymbol=new P({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});a.polylineSymbol=new O({color:[130,130,130,1],width:2});a.updateGraphics=new ha;a.updateOnGraphicClick=!0;a.updatePointSymbol=new E({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}});a.updatePolygonSymbol=new P({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}});a.updatePolylineSymbol=new O({color:[12,207,255],width:2});a.vertexSymbol=new E({style:"circle",size:6,color:[255,
255,255],outline:{color:[50,50,50],width:1}});a.snappingOptions=new V.SnappingOptions;a._originalAutoOpenEnabled=null;a.defaultCreateOptions=aa;a.defaultUpdateOptions=ba;return a}S._inheritsLoose(C,y);var n=C.prototype;n.initialize=function(){this._handles.add([J.watch(this,"layer",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:null}),J.on(this,"view.map.layers","change",a=>{0<=a.removed.indexOf(this.layer)&&this.cancel()}),J.on(this,"layer.graphics",
"change",a=>{if(t.isSome(this._operationHandle))for(const b of a.removed)this.updateGraphics.includes(b)&&(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(b):this._operationHandle.cancel())}),J.init(this,"layer.elevationInfo",()=>{this.cancel();this._internalGraphicsLayer.elevationInfo=t.isSome(this.layer)?this.layer.elevationInfo:null},!0)])};n.destroy=function(){this.cancel();this._handles.removeAll();this._handles=null;this._viewHandles.removeAll();this._viewHandles=null;
this._removeDefaultLayer();this._draw&&this._draw.destroy();this._set("view",null);this.emit("destroy")};n.cancel=function(){this._moduleLoaderAbortController&&(this._moduleLoaderAbortController.abort(),this._moduleLoaderAbortController=null);this._operationHandle&&this._operationHandle.cancel()};n.complete=function(){this._operationHandle&&this._operationHandle.complete()};n.delete=function(){const {state:a,updateGraphics:b}=this;if("active"===a&&b.length){const {activeTool:c,layer:d}=this,g=b.toArray();
d.removeMany(g);this.cancel();this._emitDeleteEvent({graphics:g,tool:c})}};n.create=async function(a,b){if("disabled"===this.state)this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel.");else if(this.cancel(),a){var c=await this._setupCreateOperation(a,b);t.isNone(c)||this.destroyed||(Y.addUniqueLayer(this.view,this._internalGraphicsLayer),c.on("complete",
()=>{if(c===this._operationHandle){const d=this.createGraphic,g=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer);c.cancelled||null==d||this.layer.add(d);this.emit("create",{graphic:d,state:g?"cancel":"complete",tool:a,toolEventInfo:null,type:"create"})}}),this._operationHandle=c,this.view.ready&&ka.isDOMContainer(this.view)&&this.view.focus())}else this._logError("sketch:missing-parameter",
"Missing parameter 'tool'.")};n.update=async function(a,b){const {layer:c,state:d,view:g}=this;if("disabled"===d)c||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),g||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel.");else{this.cancel();var e=Array.isArray(a)?a:[a];null!=a&&e&&e.length?e.some(h=>h.layer!==c?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),
!0):t.isNone(h.geometry)?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):"2d"!==g.type||g.spatialReference.equals(h.geometry.spatialReference)?!1:(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with a spatial reference different from the supplied MapView."),!0))||(a=await this._setupUpdateOperation(e,b),t.isNone(a)||A(a)||(Y.addUniqueLayer(this.view,this._internalGraphicsLayer),
this._setUpdateOperationHandle(a,b),this.emit("update",{graphics:e,state:"start",aborted:!1,tool:a.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")}};n.undo=function(){this.canUndo()&&this._operationHandle.undo()};n.redo=function(){this.canRedo()&&this._operationHandle.redo()};n.canUndo=function(){return!(!this._operationHandle||!this._operationHandle.canUndo())};n.canRedo=function(){return!(!this._operationHandle||!this._operationHandle.canRedo())};
n.toggleUpdateTool=function(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()};n._getFirstHit=async function(a){const b=[];switch(this.view.type){case "2d":var c=await this.view.hitTest(a);if(0<c.results.length&&(c=c.results[0],c.graphic)){var d,g;const e=c.graphic;"vector-tile"!==(null==(d=e.layer)?void 0:d.type)&&"imagery"!==(null==(g=e.layer)?void 0:g.type)&&b.push(c)}break;case "3d":{const e=[this.view.map.ground];this.view.map.allLayers.forEach(h=>
{"integrated-mesh"===h.type&&e.push(h)});d=await this.view.hitTest(a,{exclude:e});0<d.results.length&&(g=d.results[0],(!d.ground.mapPoint||1>this.view.map.ground.opacity||d.ground.distance-g.distance>-Math.min(3*d.ground.distance,"global"===this.view.viewingMode?ia.getReferenceEllipsoid(this.view.renderCoordsHelper.spatialReference).radius/this.view.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY))&&b.push(g))}}return{screenPoint:a,results:b}};n._generateViewHandles=function(a){return[a.on("immediate-click",
b=>{const {_operationHandle:c,defaultUpdateOptions:d,layer:g,state:e,updateGraphics:h,updateOnGraphicClick:m}=this,f="active"===e&&"create"===c.type;"disabled"!==e&&!f&&m&&(this._beginAsyncOperation(),this._getFirstHit(Q.createScreenPointFromEvent(b)).then(k=>{k=k.results;if(k.length)for(let p=0;p<k.length;++p){var l=k[p];if(l.graphic){l=l.graphic;if(-1<h.indexOf(l)||l.layer===g)return b.stopPropagation(),l;"2d"!==a.type||this._isComponentGraphic(l)||"active"!==e||this.cancel()}}else"active"===e&&
this.cancel();return null}).then(k=>t.isSome(k)&&-1===h.indexOf(k)?this.update([k],{...d}):null).then(()=>{this._endAsyncOperation()}))},w.ViewEventPriorities.WIDGET)]};n._setupCreateOperation=async function(a,b){if(!a)return null;b={hasZ:"3d"===this.view.type,...this.defaultCreateOptions,...b};let c;if("2d"===this.view.type)switch(a){case "point":c=this._setupCreatePointOperation(a,b);break;case "multipoint":c=this._setupCreateMultipointOperation(a,null);break;case "polygon":c=this._setupCreatePolyOperation(a,
b);break;case "polyline":c=this._setupCreatePolyOperation(a,b);break;case "rectangle":c=this._setupCreateRectangleOperation(a,b);break;case "circle":c=this._setupCreateCircleOperation(a,b)}else{a=await this._setupCreate3DOperation(a,this.view,b);if(t.isNone(a)||A(a))return null;c=a}return c};n._setupCreate3DOperation=async function(a,b,c){if("multipoint"===a)return null;const d={point:this.pointSymbol,multipoint:null,polyline:this.polylineSymbol,polygon:this.polygonSymbol,rectangle:this.polygonSymbol,
circle:this.polygonSymbol}[a];this._removeCreateOperationGraphics();const g="rectangle"===a?!1:!0,e="rectangle"===a?!1:!0;this.snappingOptions.selfEnabledToggled=!1;b={view:b,mode:"rectangle"===a||"circle"===a?"hybrid":"click",...c,elevationInfo:this.layer.elevationInfo,geometryType:a,createGraphicSymbol:d,snapToScene:t.isSome(this.layer.elevationInfo)?"absolute-height"===this.layer.elevationInfo.mode:!0,snappingOptions:this.snappingOptions,forceUniformSize:e,centered:g};c=await this._requireModule(new Promise(function(l,
p){F(["../../views/3d/interactive/editingTools"],l,p)}));if(A(c))return c;const h=new c.module.DrawGraphicTool(b);this.view.tools.add(h);let m=null;this.view.activeTool=h;const f=[],k=new H.OperationHandle({activeComponent:h,tool:a,type:"update",onEnd:()=>{var l;f.forEach(p=>p.remove());f.length=0;null==(l=this.view.tools)?void 0:l.remove(h);h.destroy()},undo:()=>{h.canUndo&&h.undo()},redo:()=>{h.canRedo&&h.redo()},canUndo:()=>h.canUndo,canRedo:()=>h.canRedo});f.push(this.view.on("key-down",l=>{" "===
l.key?(l.stopPropagation(),l.repeat||(h.enabled=!1)):"c"===l.key?(l.stopPropagation(),h.completeCreateOperation()):"z"===l.key?(l.stopPropagation(),k.undo()):"r"===l.key?(l.stopPropagation(),k.redo()):"Control"!==l.key||"rectangle"===a||"circle"===a||l.repeat?"Control"!==l.key||"rectangle"!==a&&"circle"!==a||l.repeat?"Alt"!==l.key||l.repeat||(h.centered=!g,l.stopPropagation()):(h.forceUniformSize=!e,l.stopPropagation()):(h.snappingOptions.selfEnabledToggled=!0,l.stopPropagation())},w.ViewEventPriorities.WIDGET),
this.view.on("key-up",l=>{" "===l.key?h.enabled=!0:"Control"===l.key&&"rectangle"!==a&&"circle"!==a?(h.snappingOptions.selfEnabledToggled=!1,l.stopPropagation()):"Control"!==l.key||"rectangle"!==a&&"circle"!==a?"Alt"===l.key&&(h.centered=g,l.stopPropagation()):(h.forceUniformSize=e,l.stopPropagation())},w.ViewEventPriorities.WIDGET),h.on("vertex-add",l=>{m=t.isNone(m)?"start":"active";switch(l.operation){case "apply":this.emit("create",{graphic:t.unwrap(h.createGraphic),state:m,tool:this.activeTool,
toolEventInfo:l,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(h.createGraphic)],tool:a});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(h.createGraphic)],tool:a})}}),h.on("cursor-update",l=>{0<h.drawOperation.numCommittedVertices&&this.emit("create",{graphic:t.unwrap(h.createGraphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:l.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),h.on("vertex-remove",l=>{switch(l.operation){case "apply":this.emit("create",
{graphic:t.unwrap(h.createGraphic),state:"active",tool:this.activeTool,toolEventInfo:l,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[t.unwrap(h.createGraphic)],tool:a});break;case "redo":this._emitRedoEvent({graphics:[t.unwrap(h.createGraphic)],tool:a})}}),h.on("complete",l=>{this._removeCreateOperationGraphics();this._set("createGraphic",t.unwrap(l.graphic));m="complete";l.aborted?k&&k.cancel():k&&k.complete()}));return k};n._setupCreatePointOperation=function(a,b){b=this._draw.create(a,
{elevationInfo:this.layer.elevationInfo,hasZ:b.hasZ,defaultZ:b.defaultZ,interactiveUndoDisabled:!0});const c=[b.on("cursor-update",e=>{t.isSome(e.vertexIndex)?this._displayCrosshairCursor():this._displayDefaultCursor()}),b.on("draw-complete",e=>{e=this.createPointFromVertex(e.vertices[0]);e=new z(e,this.pointSymbol);this._set("createGraphic",e);g&&g.complete()})],d=[this.view.on("key-down",e=>{"Escape"===e.key&&(g&&g.cancel(),e.stopPropagation())},w.ViewEventPriorities.WIDGET)],g=this._operationHandleForCreateAction(b,
[...c,...d],a);return g};n._setupCreateMultipointOperation=function(a,b){b=this._draw.create(a,{...b,undoDisabled:!0});let c=null;const d=[],g=this._operationHandleForCreateAction(b,d,a);d.push(b.on("vertex-add",e=>{const {type:h,vertexIndex:m,vertices:f}=e,k=f[m];c=e;this._drawMultipointGraphic(f,!0);this.emit("create",{graphic:this.createGraphic,state:1===f.length?"start":"active",tool:a,toolEventInfo:{added:k,vertices:[{coordinates:k,componentIndex:0,vertexIndex:m}],type:h},type:"create"})}),b.on("vertex-remove",
e=>{const {type:h,vertexIndex:m,vertices:f}=e,k=f[m];c=e;this._drawMultipointGraphic(f,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:a,toolEventInfo:{removed:k,vertices:[{coordinates:k,componentIndex:0,vertexIndex:m}],type:h},type:"create"})}),b.on("vertex-update",e=>{const {type:h,vertexIndex:m,vertices:f}=e,k=f[m];c=e;this._drawMultipointGraphic(f,!0);this.emit("create",{graphic:this.createGraphic,state:"active",tool:a,toolEventInfo:{type:h,updated:k,vertices:[{coordinates:k,
componentIndex:0,vertexIndex:m}]},type:"create"})}),b.on("cursor-update",e=>{c=e}),b.on("draw-complete",e=>{e=e.vertices.slice(0);(e=x.createMultipoint(e,this.view.spatialReference))&&this.createGraphic&&(this.createGraphic.geometry=e);g&&g.complete()}),b.on("undo",e=>{e=e.vertices;const h=c&&"cursor-update"!==c.type;this._resetCreateOperationGraphics();e.length&&this._drawMultipointGraphic(e,h)}),b.on("redo",e=>{e=e.vertices;const h=c&&"cursor-update"!==c.type;this._resetCreateOperationGraphics();
e.length&&this._drawMultipointGraphic(e,h)}));d.push(this.view.on("pointer-move",()=>this._displayCrosshairCursor(),w.ViewEventPriorities.WIDGET),this.view.on("key-down",e=>this._getCommonUpdateOperationKeyDownHandlers(g,e),w.ViewEventPriorities.WIDGET));return g};n._setupCreatePolyOperation=function(a,b){b={...b,elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0};let c=null;"polyline"===a?c=this._draw.create(a,b):"polygon"===a&&(c=this._draw.create(a,b));let d=new K,g=null,e=!1;b=
[c.on("vertex-add",f=>{const {type:k,vertexIndex:l,vertices:p}=f,v=p[l];this._snap(a,p,e);g=f;this._drawVertexGraphics(a,p,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:1===p.length?"start":"active",tool:a,toolEventInfo:{added:v,vertices:[{coordinates:v,componentIndex:0,vertexIndex:l}],type:k},type:"create"})}),c.on("vertex-remove",f=>{const {type:k,vertexIndex:l,vertices:p}=f,v=p[l];this._snap(a,p,e);g=f;this._drawVertexGraphics(a,p,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,
state:"active",tool:a,toolEventInfo:{removed:v,vertices:[{coordinates:v,componentIndex:0,vertexIndex:l}],type:k},type:"create"})}),c.on("vertex-update",f=>{const {type:k,vertexIndex:l,vertices:p}=f,v=p[l];this._snap(a,p,e);g=f;this._drawVertexGraphics(a,p,{userClicked:!0});this.emit("create",{graphic:this.createGraphic,state:"active",tool:a,toolEventInfo:{type:k,updated:v,vertices:[{coordinates:v,componentIndex:0,vertexIndex:l}]},type:"create"})}),c.on("cursor-update",f=>{const {type:k,vertices:l}=
f;f.mapPoint&&(this._snap(a,l,e),g=f,d=f.mapPoint,this._drawVertexGraphics(a,l,{userClicked:!1}),1<l.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:a,toolEventInfo:{coordinates:l[l.length-1],type:k},type:"create"}))}),c.on("draw-complete",f=>{f=f.vertices.slice(0);let k=null;"polyline"===a?k=x.createPolyline([f],this.view.spatialReference,this._doUnnormalization):"polygon"===a&&(k=x.createPolygon([f],this.view.spatialReference,this._doUnnormalization,!0));k&&(this.createGraphic.geometry=
k);m&&m.complete()}),c.on("undo",f=>{f=f.vertices;const k=g&&"cursor-update"!==g.type;this._resetCreateOperationGraphics();this._snap(a,f,e);f.length&&this._drawVertexGraphics(a,f,{userClicked:k})}),c.on("redo",f=>{f=f.vertices;const k=g&&"cursor-update"!==g.type;this._resetCreateOperationGraphics();this._snap(a,f,e);f.length&&this._drawVertexGraphics(a,f,{userClicked:k})})];const h=[this.view.on("pointer-move",f=>{this.view.toMap(N.createScreenPoint(f.x,f.y))?this._displayCrosshairCursor():this._displayDefaultCursor()},
w.ViewEventPriorities.WIDGET),this.view.on("key-down",f=>{const k=c.vertices.slice(0),l=g&&"cursor-update"!==g.type;"Control"===f.key?"2d"!==this.view.type||e||(e=!0,this._snap(a,k,!l),this._drawVertexGraphics(a,k,{userClicked:l})):"z"===f.key&&m&&m.canUndo()?(f.stopPropagation(),m.undo()):"r"===f.key&&m&&m.canRedo()?(f.stopPropagation(),m.redo()):"Escape"===f.key&&m&&m.cancel()},w.ViewEventPriorities.WIDGET),this.view.on("key-up",f=>{const k=c.vertices.slice(0),l=g&&"cursor-update"!==g.type;"Control"===
f.key&&e&&(l||(k.pop(),k.push([d.x,d.y]),this._drawVertexGraphics(a,k,{userClicked:l})),e=!1)},w.ViewEventPriorities.WIDGET)];if("polygon"===a){const f=(p,v,B)=>{if(!p||!p.layer||!p.visible)return!1;p=this.view.toScreen(p.geometry);return this._isWithinScreenDistance(p,v,B)},k=p=>{if(!(2>=this._vertexGraphics.length))return f(this._vertexGraphics[0],p,this._getVertexIntersectDistance())};let l=!1;h.push(this.view.on("pointer-move",()=>{l=!1},w.ViewEventPriorities.WIDGET),this.view.on("pointer-down",
p=>{k(p)?(l=!0,p.stopPropagation()):this._vertexGraphics.some(v=>f(v,p,this._getVertexIntersectDistance()))&&p.stopPropagation()},w.ViewEventPriorities.WIDGET),this.view.on("pointer-up",p=>{l&&(p.stopPropagation(),c.complete())}))}const m=this._operationHandleForCreateAction(c,[...b,...h],a);return m};n._setupCreateCircleOperation=function(a,b){const c=this._draw.create(a,{...b,elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});let d=!1,g=!0;b=[c.on("vertex-add",m=>{const {type:f,
vertexIndex:k,vertices:l}=m;m=l[k];this._drawSegmentGraphic(a,l,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===l.length?"start":"active",tool:a,toolEventInfo:{added:m,vertices:[{coordinates:m,componentIndex:0,vertexIndex:k}],type:f},type:"create"})}),c.on("cursor-update",m=>{const {type:f,vertices:k}=m;this._drawSegmentGraphic(a,k,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem);2===k.length&&this.emit("create",{graphic:this.createGraphic,
state:"active",tool:a,toolEventInfo:{coordinates:k[k.length-1],type:f},type:"create"})}),c.on("draw-complete",m=>{m=m.vertices.slice(0);let f=null;1===m.length?(m.push(c.viewAlignedCoordinateSystem.makeMapPoint(m[0][0]+this._defaultSegmentOffset*this.view.resolution,m[0][1])),f=x.createCircle(m,c.viewAlignedCoordinateSystem,!0,this.view.resolution)):f=d?x.createEllipse(m,c.viewAlignedCoordinateSystem,g):x.createCircle(m,c.viewAlignedCoordinateSystem,g,this.view.resolution);this.createGraphic?this.createGraphic.geometry=
f:(this._removeCreateGraphic(),this._set("createGraphic",new z(f,this.polygonSymbol)));h&&h.complete()})];const e=[this.view.on("pointer-move",m=>{t.isSome(c.getCoordsFromScreenPoint(N.createScreenPoint(m.x,m.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},w.ViewEventPriorities.WIDGET),this.view.on("key-down",m=>{"Control"===m.key?d||(d=!0,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Alt"===m.key?g&&(g=!1,this._drawSegmentGraphic(a,
c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Escape"===m.key&&h&&h.cancel()},w.ViewEventPriorities.WIDGET),this.view.on("key-up",m=>{"Control"===m.key?(d=!1,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Alt"===m.key&&(g=!0,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem))},w.ViewEventPriorities.WIDGET)],h=this._operationHandleForCreateAction(c,[...b,...e],a);return h};
n._setupCreateRectangleOperation=function(a,b){const c=this._draw.create(a,{...b,elevationInfo:this.layer.elevationInfo,interactiveUndoDisabled:!0});let d=!1,g=!1;b=[c.on("vertex-add",m=>{const {type:f,vertexIndex:k,vertices:l}=m;m=l[k];this._drawSegmentGraphic(a,l,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem);this.emit("create",{graphic:this.createGraphic,state:1===l.length?"start":"active",tool:a,toolEventInfo:{added:m,vertices:[{coordinates:m,componentIndex:0,vertexIndex:k}],type:f},
type:"create"})}),c.on("cursor-update",m=>{const {type:f,vertices:k}=m;this._drawSegmentGraphic(a,k,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem);2===k.length&&this.emit("create",{graphic:this.createGraphic,state:"active",tool:a,toolEventInfo:{coordinates:k[k.length-1],type:f},type:"create"})}),c.on("draw-complete",m=>{m=m.vertices.slice(0);let f=null;1===m.length&&(g=d=!1);f=d?x.createSquare(m,c.viewAlignedCoordinateSystem,g):x.createRectangle(m,c.viewAlignedCoordinateSystem,g);this.createGraphic?
this.createGraphic.geometry=f:(this._removeCreateGraphic(),this._set("createGraphic",new z(f,this.polygonSymbol)));h&&h.complete()})];const e=[this.view.on("pointer-move",m=>{t.isSome(c.getCoordsFromScreenPoint(N.createScreenPoint(m.x,m.y)))?this._displayCrosshairCursor():this._displayDefaultCursor()},w.ViewEventPriorities.WIDGET),this.view.on("key-down",m=>{"Control"===m.key?d||(d=!0,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Alt"===m.key?
g||(g=!0,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Escape"===m.key&&h&&h.cancel()},w.ViewEventPriorities.WIDGET),this.view.on("key-up",m=>{"Control"===m.key?(d=!1,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem)):"Alt"===m.key&&(g=!1,this._drawSegmentGraphic(a,c.vertices,{centered:g,constrainToggle:d},c.viewAlignedCoordinateSystem))},w.ViewEventPriorities.WIDGET)],h=this._operationHandleForCreateAction(c,
[...b,...e],a);return h};n._setupUpdateOperation=async function(a,b){const {_defaultUpdateTool:c,defaultUpdateOptions:d,layer:g,view:e}=this;b={...d,...b};var h=b.tool||c;for(var m of a)g.remove(m),g.add(m);if("3d"===e.type){if(0===a.length)return null;switch(h){case "move":return this._setupMove3DOperation(a,b,e,h);case "reshape":if(1<a.length)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;h=X.isSupportedGraphic(a[0]);if(0===h)return this._setupReshape3DOperation(a[0],
b,e);this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${W.isSupportedGraphicResultMessage(h)}).`);return null;case "transform":return 1===a.length&&0===na.isSupportedGraphic(a[0])?this._setupPointTransform3DOperation(a[0],b,e):this._setupMove3DOperation(a,b,e,h)}}if("move"===h)return this._setupMoveOperation(a,b,e);if(1<a.length)return"reshape"===h?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshapeOperation(a,
h,b,e);if(1===a.length){m=t.get(a[0].geometry,"type");if("point"===m||"multipoint"===m)return this._setupMoveOperation(a,b,e);if("transform"===h||"reshape"===h)return this._setupTransformOrReshapeOperation(a,h,b,e)}return null};n._setupMove3DOperation=async function(a,b,c,d,g=!1){for(var e of a){const k=ma.isSupportedGraphic(e);if(0!==k)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${W.isSupportedGraphicResultMessage(k)}).`),null}e=await this._requireModule(new Promise(function(k,
l){F(["../../views/3d/interactive/editingTools"],k,l)}));if(A(e))return e;const h=new e.module.GraphicMoveTool({view:c,enableZ:b.enableZ});this.view.tools.add(h);h.graphics.addMany(a);g||this.updateGraphics.addMany(a);const m=[],f=new H.OperationHandle({activeComponent:h,tool:d,type:"update",onEnd:()=>{var k;m.forEach(l=>l.remove());m.length=0;null==(k=this.view.tools)?void 0:k.remove(h);h.destroyed||h.destroy()},undo:()=>{L(f,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:d})},redo:()=>{M(f,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:d})},addToSelection:k=>{this.updateGraphics.push(k);h.graphics.push(k);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[k],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:k=>{const l=this.updateGraphics.indexOf(k);f.history.undo.forEach(p=>p.updates.splice(l,1));f.history.redo.forEach(p=>
p.updates.splice(l,1));this.updateGraphics.remove(k);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[k],type:"selection-change"},type:"update"});0===this.updateGraphics.length?f.complete():h.graphics.remove(k)},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==b.toggleToolOnClick&&"transform"===d){var k=this.updateGraphics.getItemAt(0);0===X.isSupportedGraphic(k)&&(k=await this._setupReshape3DOperation(k,
b,c,!0),A(k)||(f.onEnd(),f.destroy(),this._setUpdateOperationHandle(k,b)))}}});m.push(...this._getHandlesForComponent(f,b),this.view.on("immediate-click",k=>this._getCommonUpdateOperationClickHandlers(f,k),w.ViewEventPriorities.WIDGET),this.view.on("key-down",k=>this._getCommonUpdateOperationKeyDownHandlers(f,k),w.ViewEventPriorities.WIDGET));return f};n._setupPointTransform3DOperation=async function(a,b,c){const {enableRotation:d,enableScaling:g,enableZ:e}=b,h=await this._requireModule(new Promise(function(l,
p){F(["../../views/3d/interactive/editingTools"],l,p)}));if(A(h))return h;const m=new h.module.GraphicTransformTool({graphic:a,view:c,enableRotation:d,enableScaling:g,enableZ:e});this.view.tools.add(m);this.updateGraphics.add(a);const f=[],k=new H.OperationHandle({activeComponent:m,tool:"transform",type:"update",onEnd:()=>{var l;f.forEach(p=>p.remove());f.length=0;null==(l=this.view.tools)?void 0:l.remove(m);m.destroyed||m.destroy()},undo:()=>{L(k,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:"transform"})},redo:()=>{M(k,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async l=>{this.updateGraphics.add(l);l=await this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",!0);A(l)||(k.onEnd(),k.destroy(),this._setUpdateOperationHandle(l,b))}});f.push(...this._getHandlesForComponent(k,b),this.view.on("immediate-click",l=>this._getCommonUpdateOperationClickHandlers(k,l),w.ViewEventPriorities.WIDGET),
this.view.on("key-down",l=>this._getCommonUpdateOperationKeyDownHandlers(k,l),w.ViewEventPriorities.WIDGET));return k};n._setupMoveOperation=async function(a,b,c){this.updateGraphics.addMany(a);const d=this._getCloneInfos(a);for(const f of d)this._internalGraphicsLayer.add(f.clone);const g=await this._getGraphicMover(a,b,c);if(A(g))return g;const e=new H.OperationHandle({activeComponent:g,tool:"move",type:"update",onEnd:()=>{var f;this._displayDefaultCursor();m.forEach(k=>k.remove());h.forEach(k=>
k.remove());m=[];h=[];g.destroy();null==(f=this._internalGraphicsLayer)?void 0:f.removeMany([...this.updateGraphics.toArray(),...d.map(k=>k.clone)])},undo:()=>{L(e,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"move"})},redo:()=>{M(e,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"move"})},addToSelection:f=>{this.updateGraphics.push(f);g.graphics=this.updateGraphics.toArray();const k=this._createClone(f);
d.push({graphic:f,clone:k});this._internalGraphicsLayer.add(k);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:f=>{const k=this.updateGraphics.indexOf(f);e.history.undo.forEach(p=>p.updates.splice(k,1));e.history.redo.forEach(p=>p.updates.splice(k,1));var l=d.findIndex(p=>p.graphic===f);this._internalGraphicsLayer.remove(d[l].clone);this.updateGraphics.remove(f);
d.splice(l,1);l=this.updateGraphics.toArray();this.emit("update",{graphics:l,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"});0===this.updateGraphics.length?e.complete():g.graphics=l}});let h=[c.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(e,f,b),w.ViewEventPriorities.WIDGET),c.on("key-down",f=>{this._getCommonUpdateOperationKeyDownHandlers(e,f);"Control"!==f.key||f.repeat||(g.enableMoveAllGraphics=!g.enableMoveAllGraphics)},
w.ViewEventPriorities.WIDGET),c.on("key-up",f=>{"Control"===f.key&&(g.enableMoveAllGraphics=!g.enableMoveAllGraphics)},w.ViewEventPriorities.WIDGET)],m=this._getHandlesForComponent(e,b);m.push(g.on("graphic-move",f=>{d.forEach(k=>{const l=f.allGraphics.find(p=>p===k.graphic);l&&(k.clone.geometry=l.geometry)})}));return e};n._getCloneInfos=function(a){return(null==a?void 0:a.map(b=>({graphic:b,clone:this._createClone(b)})))||[]};n._createClone=function(a){const b=a.clone();b.symbol=this._getSymbolForClone(a);
return b};n._getSymbolForClone=function(a){if(t.isNone(a.symbol))return null;switch(a.symbol.type){case "cim":return new E({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case "picture-marker":{const {xoffset:b,yoffset:c,height:d,width:g}=a.symbol;return new E({xoffset:b,yoffset:c,size:d===g?g:Math.max(d,g),style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case "simple-marker":{const {xoffset:b,yoffset:c,size:d,style:g}=a.symbol;return new E({xoffset:b,
yoffset:c,style:"circle"===g?"circle":"square",size:d+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case "simple-fill":return new P({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case "simple-line":return new O({color:[255,127,0,1],style:"dash",width:1});case "text":{const {xoffset:b,yoffset:c}=a.symbol;return new E({xoffset:b,yoffset:c,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}};n._setupReshape3DOperation=async function(a,
b,c,d=!1){const g=await this._requireModule(new Promise(function(f,k){F(["../../views/3d/interactive/editingTools"],f,k)}));if(A(g))return g;this.snappingOptions.selfEnabledToggled=!1;const e=new g.module.GraphicReshapeTool({view:c,graphic:a,enableZ:b.enableZ,enableMoveGraphic:b.enableMoveGraphic,snappingOptions:this.snappingOptions});c.tools.add(e);d||this.updateGraphics.add(a);const h=[],m=new H.OperationHandle({activeComponent:e,tool:"reshape",type:"update",onEnd:()=>{var f;h.forEach(k=>k.remove());
h.length=0;null==(f=this.view.tools)?void 0:f.remove(e);e.destroyed||e.destroy()},undo:()=>{e.beforeUndo();L(m,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},redo:()=>{M(m,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"})},addToSelection:async f=>{this.updateGraphics.add(f);f=await this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",!0);A(f)||(m.onEnd(),m.destroy(),
this._setUpdateOperationHandle(f,b))},toggleTool:async()=>{if(!1!==b.toggleToolOnClick){var f=await this._setupMove3DOperation(this.updateGraphics.toArray(),b,c,"transform",!0);A(f)||(m.onEnd(),m.destroy(),this._setUpdateOperationHandle(f,b))}}});h.push(...this._getHandlesForComponent(m,b),c.on("immediate-click",f=>this._getCommonUpdateOperationClickHandlers(m,f),w.ViewEventPriorities.WIDGET),c.on("key-down",f=>{this._getCommonUpdateOperationKeyDownHandlers(m,f);"Control"===f.key&&(e.snappingOptions.selfEnabledToggled=
!0,f.stopPropagation())},w.ViewEventPriorities.WIDGET),c.on("key-up",f=>{"Control"===f.key&&(e.snappingOptions.selfEnabledToggled=!1,f.stopPropagation())},w.ViewEventPriorities.WIDGET));return m};n._setupTransformOrReshapeOperation=async function(a,b,c,d){const {multipleSelectionEnabled:g}=c;this.updateGraphics.addMany(a);b="transform"===b?await this._getBox(a,c,d):await this._getReshape(a,c,d);if(A(b))return b;const e=new H.OperationHandle({activeComponent:b,type:"update",onEnd:()=>{m.forEach(f=>
f.remove());h.forEach(f=>f.remove());m=[];h=[];e.activeComponent&&!e.activeComponent.destroyed&&e.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{L(e,this.updateGraphics.toArray());e.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:e.tool})},redo:()=>{M(e,this.updateGraphics.toArray());e.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:e.tool})},addToSelection:f=>{const k=
e.activeComponent;this.updateGraphics.add(f);k.graphics=this.updateGraphics.toArray();k.refresh();e.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[f],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:f=>{const k=e.activeComponent,l=this.updateGraphics.indexOf(f);e.history.undo.forEach(v=>v.updates.splice(l,1));e.history.redo.forEach(v=>v.updates.splice(l,1));this.updateGraphics.remove(f);
const p=this.updateGraphics.toArray();this.emit("update",{graphics:p,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[f],type:"selection-change"},type:"update"});0===this.updateGraphics.length?e.complete():k.graphics=p},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var f=null;"transform"===e.tool?f=await this._getReshape(a,c,d):"reshape"===e.tool&&(f=await this._getBox(a,c,d));A(f)||(e.activeComponent.destroy(),e.activeComponent=f,e.activeComponent&&(m.forEach(k=>
k.remove()),m=this._getHandlesForComponent(e,c)))}}});let h=[d.on("immediate-click",f=>{this._getFirstHit(Q.createScreenPointFromEvent(f)).then(k=>{var l;if(e)if(null!=(l=k.results)&&l.length){var p=e.activeComponent;k.results.some(v=>{if(v.graphic){var B;v=v.graphic;if("box"===(null==p?void 0:p.type)&&null!=(B=f.native)&&B.shiftKey&&g)return e.addToSelection(v),!0;v.layer===this.layer&&e.complete()}return!1})&&f.stopPropagation()}else e.complete()})},w.ViewEventPriorities.WIDGET),d.on("key-down",
f=>{this._getCommonUpdateOperationKeyDownHandlers(e,f);"Control"===f.key&&!f.repeat&&e&&(f=e.activeComponent)&&"box"===f.type&&(f.preserveAspectRatio=!f.preserveAspectRatio)},w.ViewEventPriorities.WIDGET),d.on("key-up",f=>{"Control"===f.key&&e&&(f=e.activeComponent)&&"box"===f.type&&(f.preserveAspectRatio=!f.preserveAspectRatio)},w.ViewEventPriorities.WIDGET)],m=this._getHandlesForComponent(e,c);return e};n._getGraphicMover=async function(a,b,c){({enableMoveAllGraphics:b}=b);const d=await this._requireModule(new Promise(function(g,
e){F(["../../views/draw/support/GraphicMover"],function(h){g(R(h))},e)}));return A(d)?d:new d.module.default({enableMoveAllGraphics:b,graphics:a,view:c,callbacks:{onGraphicMoveStart:({dx:g,dy:e,graphic:h})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:g,dy:e,mover:h,type:"move-start"},type:"update"})},onGraphicMove:({dx:g,dy:e,graphic:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:g,dy:e,mover:h,type:"move"},type:"update"}),onGraphicMoveStop:({dx:g,dy:e,graphic:h})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:g,dy:e,mover:h,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})};n._getBox=async function(a,b,c){const {enableRotation:d,
enableScaling:g,preserveAspectRatio:e}=b;b=await this._requireModule(new Promise(function(h,m){F(["../../views/draw/support/Box"],function(f){h(R(f))},m)}));return A(b)?b:new b.module.default({graphics:a,enableRotation:d,enableScaling:g,preserveAspectRatio:e,layer:this._internalGraphicsLayer,view:c,callbacks:{onMoveStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onMove:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onMoveStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onScaleStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onScale:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...h},type:"update"}),onScaleStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onRotateStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onRotate:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),
onRotateStop:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"})}})};n._getReshape=async function(a,b,c){({enableMidpoints:b=!0}=b);const d=await this._requireModule(new Promise(function(g,e){F(["../../views/draw/support/Reshape"],function(h){g(R(h))},e)}));return A(d)?d:new d.module.default({enableMidpoints:b,graphic:a[0],layer:this._internalGraphicsLayer,view:c,callbacks:{onReshapeStart:g=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...g},type:"update"}),onReshape:g=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...g},type:"update"}),onReshapeStop:({mover:g,type:e})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:g,type:e},type:"update"}),onMoveStart:({dx:g,dy:e,mover:h,type:m})=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:g,dy:e,mover:h,type:m},type:"update"}),onMove:({dx:g,dy:e,mover:h,type:m})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:g,dy:e,mover:h,type:m},type:"update"}),onMoveStop:({dx:g,dy:e,mover:h,type:m})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{dx:g,dy:e,mover:h,type:m},type:"update"}),onVertexAdd:({added:g,type:e,vertices:h})=>{g=g.map(m=>T.geometryToCoordinates(m.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:g,vertices:h,type:e},type:"update"})},onVertexRemove:({removed:g,type:e,vertices:h})=>{g=g.map(m=>T.geometryToCoordinates(m.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{removed:g,vertices:h,type:e},type:"update"})}}})};n._getHandlesForComponent=function(a,b){const c=a.activeComponent;switch(c.type){case "graphic-mover":return[c.on("graphic-click",({graphic:d,viewEvent:g})=>{var e;null!=(e=g.native)&&e.shiftKey&&(g.stopPropagation(),a.removeFromSelection(d))}),c.on("graphic-move-start",d=>a.addToHistory(D(d.allGraphics)))];case "box":return[c.on("graphic-click",d=>this._onTransformOrReshape2DGraphicClick(a,b,d)),c.on("move-start",d=>a.addToHistory(D(d.graphics))),
c.on("rotate-start",d=>a.addToHistory(D(d.graphics))),c.on("scale-start",d=>a.addToHistory(D(d.graphics)))];case "reshape":return[c.on("graphic-click",d=>this._onTransformOrReshape2DGraphicClick(a,b,d)),c.on("move-start",d=>a.addToHistory(D([d.mover]))),c.on("reshape-start",d=>a.addToHistory(D([d.graphic]))),c.on("vertex-add",d=>a.addToHistory(D([d.oldGraphic]))),c.on("vertex-remove",d=>a.addToHistory(D([d.oldGraphic])))];case "move-3d":return[c.on("graphic-move-start",d=>{a.addToHistory(D(d.allGraphics));
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<d.allGraphics.length?d.allGraphics[0]:null,type:"move-start"},type:"update"})}),c.on("graphic-move",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:d.dx,dy:d.dy,mover:0<d.allGraphics.length?d.allGraphics[0]:null,type:"move"},type:"update"})}),c.on("graphic-move-stop",d=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<d.allGraphics.length?d.allGraphics[0]:null,type:"move-stop"},type:"update"})}),c.on("immediate-click",d=>{d.shiftKey?this._toggleSelection([d.graphic],a,b):a.toggleTool()})];case "transform-3d":return[c.on("graphic-translate-start",d=>{a.addToHistory(D([d.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,
dx:d.dxScreen,dy:d.dyScreen,type:"move-start"},type:"update"})}),c.on("graphic-translate-stop",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,dx:d.dxScreen,dy:d.dyScreen,type:"move-stop"},type:"update"})}),c.on("graphic-rotate-start",d=>{a.addToHistory(Z([d.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,angle:d.angle,
type:"rotate-start"},type:"update"})}),c.on("graphic-rotate-stop",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,angle:d.angle,type:"rotate-stop"},type:"update"})}),c.on("graphic-scale-start",d=>{a.addToHistory(Z([d.graphic]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,xScale:d.scale,yScale:d.scale,type:"scale-start"},
type:"update"})}),c.on("graphic-scale-stop",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,xScale:d.scale,yScale:d.scale,type:"scale-stop"},type:"update"})}),c.on("graphic-translate",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,dx:d.dxScreen,dy:d.dyScreen,type:"move"},type:"update"})}),c.on("graphic-rotate",d=>
{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,angle:d.angle,type:"rotate"},type:"update"})}),c.on("graphic-scale",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:d.graphic,xScale:d.scale,yScale:d.scale,type:"scale"},type:"update"})})];case "reshape-3d":return[c.on("reshape",d=>{"reshape-start"===d.type&&a.addToHistory(D([d.mover]));
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:d,type:"update"})}),c.on("move",d=>{"move-start"===d.type&&a.addToHistory(D([d.mover]));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:d,type:"update"})}),c.on("vertex-add",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:d,type:"update"})}),
c.on("vertex-remove",d=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:d,type:"update"})}),c.on("immediate-click",()=>a.toggleTool())];case "draw":case "draw-3d":return null}};n._onTransformOrReshape2DGraphicClick=function(a,b,c){var d;const {graphic:g,viewEvent:e}=c;null!=(d=e.native)&&d.shiftKey?(e.stopPropagation(),a.removeFromSelection(g)):b.toggleToolOnClick&&(t.isNone(g.geometry)||"extent"!==g.geometry.type?(e.stopPropagation(),
a.toggleTool()):this._logError("sketch:reshape-extent","Reshape operation does not support graphics with geometry of type 'extent'."))};n._setUpdateOperationHandle=function(a,b){this._operationHandle=a;const c=this.view.map;this._disablePopup(b);a.on("complete",()=>{if(a===this._operationHandle){const d=this.updateGraphics.toArray(),g=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();
c&&c.remove(this._internalGraphicsLayer);this._restorePopup(b);this.emit("update",{graphics:d,state:"complete",aborted:a.cancelled,tool:g,toolEventInfo:null,type:"update"})}})};n._getCommonUpdateOperationClickHandlers=function(a,b,c){const d=Q.createScreenPointFromEvent(b);this._getFirstHit(d).then(g=>{g=g.results;g.length?b.native.shiftKey&&this._toggleSelection(g.map(e=>e.graphic),a,c)?b.stopPropagation():g.some(e=>e.graphic&&-1<this.updateGraphics.indexOf(e.graphic))?b.stopPropagation():a.complete():
a.complete()})};n._toggleSelection=function(a,b,c){const d=c?!!c.multipleSelectionEnabled:!0;return a.some(g=>null==g?!1:d&&g.layer===this.layer?(-1===this.updateGraphics.indexOf(g)?b.addToSelection(g):b.removeFromSelection(g),!0):!1)};n._getCommonUpdateOperationKeyDownHandlers=function(a,b){if(a){var c=b.key;"z"===c&&a.canUndo()?(b.stopPropagation(),a.undo()):"r"===c&&a.canRedo()?(b.stopPropagation(),a.redo()):"Escape"===c?(b.stopPropagation(),a.cancel()):0<=pa.indexOf(c)&&this._onDeleteKey(b)}};
n._onDeleteKey=function(a){if(this._operationHandle&&"update"===this._operationHandle.type){var b=this.activeComponent;t.isNone(b)||"reshape"===b.type||"reshape-3d"===b.type||(a.stopPropagation(),a=this.updateGraphics.toArray(),this.layer.removeMany(a),this._emitDeleteEvent({graphics:a,tool:this.activeTool}))}};n._drawMultipointGraphic=function(a,b){var c=null;!b&&1<a.length?(c=a.slice(0),c.pop(),c=x.createMultipoint(c,this.view.spatialReference)):c=x.createMultipoint(a,this.view.spatialReference);
this.createGraphic?this.createGraphic.geometry=c:this._set("createGraphic",new z(c,this.pointSymbol));b&&1===a.length&&this._internalGraphicsLayer.add(this.createGraphic)};n._drawVertexGraphics=function(a,b,c){if(b.length){var {_doUnnormalization:d,activeLineSymbol:g,activeVertexSymbol:e,polygonSymbol:h,polylineSymbol:m,vertexSymbol:f,view:{spatialReference:k}}=this;c=!(!c||!c.userClicked);var l="polygon"===a,p=l?h:m;if(1===b.length){this._removeLineGraphic();this._removeActiveLineGraphic();var v=
this.createPointFromVertex(b[0]);b=l?x.createPolygon([b],k,d,!0):x.createPolyline([b],k,d);this._vertexGraphics.length?this._vertexGraphics[0].geometry=v:this._vertexGraphics.push(new z(v,e));this.createGraphic?this.createGraphic.geometry=b:this._set("createGraphic",new z(b,p));c&&this._internalGraphicsLayer.add(this._vertexGraphics[0])}else if(2===b.length)a=this.createPointFromVertex(b[1]),p=x.createPolyline([b],k,d),v=l?x.createPolygon([b],k,d,!0):x.createPolyline([b],k,d),this._vertexGraphics.length||
(b=this.createPointFromVertex(b[0]),b=new z(b,f),this._vertexGraphics.push(b)),1===this._vertexGraphics.length?(b=this._vertexGraphics[0],l=new z(a,f),this._removeLineGraphic(),this._removeActiveFillGraphic(),this._vertexGraphics.push(l),this._internalGraphicsLayer.remove(b),this._internalGraphicsLayer.add(b)):this._vertexGraphics[1].geometry=a,this._showActiveLineGraphic(p),b=this._vertexGraphics[0],c&&(this._activeLineGraphic.symbol=m,b.symbol=f,this._internalGraphicsLayer.add(this._vertexGraphics[1])),
this.createGraphic?this.createGraphic.geometry=v:this._set("createGraphic",new z(v,h)),this._internalGraphicsLayer.remove(b),this._internalGraphicsLayer.add(b);else if(2<b.length){l=l?x.createPolygon([b],k,d,!0):x.createPolyline([b],k,d);"polygon"===a&&this._showFillGraphic(l);a=b.map(qa=>qa.slice());var B=a.pop(),I=[a[a.length-1],B];B=x.createPolyline([a],k,d);I=x.createPolyline([I],k,d);this._showLineGraphic(B);this._showActiveLineGraphic(I);for(B=0;B<a.length;B++)(I=this._vertexGraphics[B])?I.symbol=
c||B!==this._vertexGraphics.length-1?f:e:(I=this.createPointFromVertex(b[B]),this._showVertexGraphic(I));c?(this._activeLineGraphic.symbol=m,c=this.createPointFromVertex(b[b.length-1]),this._showVertexGraphic(c)):this._activeLineGraphic.symbol=g;this.createGraphic?this.createGraphic.geometry=l:(this._removeCreateGraphic(),this._set("createGraphic",new z(l,p)));for(v of this._vertexGraphics)this._internalGraphicsLayer.remove(v),this._internalGraphicsLayer.add(v)}}};n._drawSegmentGraphic=function(a,
b,c,d){if(b.length){var g=!(null==c||!c.centered);c=!(null==c||!c.constrainToggle);var e=null;1===b.length?this._removeCenterIndicatorGraphic():("rectangle"===a?e=c?x.createSquare(b,d,g):x.createRectangle(b,d,g):"circle"===a&&(e=c?x.createEllipse(b,d,g):x.createCircle(b,d,g,this.view.resolution)),e.extent&&e.extent.center&&this._showCenterIndicatorGraphic(e.extent.center));e?this.createGraphic?this.createGraphic.geometry=e:(this._removeCreateGraphic(),this._set("createGraphic",new z(e,this.polygonSymbol)),
this._internalGraphicsLayer.add(this.createGraphic)):this._removeCreateGraphic()}};n._showCenterIndicatorGraphic=function(a){this._centerIndicatorGraphic?this._centerIndicatorGraphic.geometry=a:(this._centerIndicatorGraphic=new z(a,this._centerSymbol),this._internalGraphicsLayer.add(this._centerIndicatorGraphic))};n._removeCenterIndicatorGraphic=function(){this._centerIndicatorGraphic&&(this._internalGraphicsLayer.remove(this._centerIndicatorGraphic),this._centerIndicatorGraphic.destroy(),this._centerIndicatorGraphic=
null)};n._showActiveLineGraphic=function(a){this._activeLineGraphic?(this._activeLineGraphic.geometry=a,this._internalGraphicsLayer.remove(this._activeLineGraphic)):this._activeLineGraphic=new z(a,this.activeLineSymbol);this._internalGraphicsLayer.add(this._activeLineGraphic)};n._showFillGraphic=function(a){this._activeFillGraphic?(this._activeFillGraphic.geometry=a,this._internalGraphicsLayer.remove(this._activeFillGraphic)):this._activeFillGraphic=new z(a,this.activeFillSymbol);this._internalGraphicsLayer.add(this._activeFillGraphic)};
n._showLineGraphic=function(a){this._lineGraphic?(this._lineGraphic.geometry=a,this._internalGraphicsLayer.remove(this._lineGraphic)):this._lineGraphic=new z(a,this.polylineSymbol);this._internalGraphicsLayer.add(this._lineGraphic)};n._showVertexGraphic=function(a,b){a=new z(a,b?this.activeVertexSymbol:this.vertexSymbol);this._vertexGraphics.push(a);this._internalGraphicsLayer.add(a)};n._resetCreateOperationGraphics=function(){this._removeActiveFillGraphic();this._removeLineGraphic();this._removeActiveLineGraphic();
this._removeVertexGraphics()};n._removeCreateGraphic=function(){this.createGraphic&&(this._internalGraphicsLayer.remove(this.createGraphic),this._set("createGraphic",null))};n._removeCreateOperationGraphics=function(){this._removeCenterIndicatorGraphic();this._removeActiveLineGraphic();this._removeActiveFillGraphic();this._removeLineGraphic();this._removeVertexGraphics()};n._removeActiveLineGraphic=function(){this._activeLineGraphic&&(this._internalGraphicsLayer.remove(this._activeLineGraphic),this._activeLineGraphic.destroy(),
this._activeLineGraphic=null)};n._removeActiveFillGraphic=function(){this._activeFillGraphic&&(this._internalGraphicsLayer.remove(this._activeFillGraphic),this._activeFillGraphic.destroy(),this._activeFillGraphic=null)};n._removeLineGraphic=function(){this._lineGraphic&&(this._internalGraphicsLayer.remove(this._lineGraphic),this._lineGraphic.destroy(),this._lineGraphic=null)};n._removeVertexGraphics=function(){this._vertexGraphics.length&&(this._internalGraphicsLayer.removeMany(this._vertexGraphics),
this._vertexGraphics.forEach(a=>a.destroy()),this._vertexGraphics=[])};n._removeDefaultLayer=function(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer.destroy(),this._internalGraphicsLayer=null)};n._operationHandleForCreateAction=function(a,b,c){return new H.OperationHandle({activeComponent:this._draw,tool:c,type:"create",onEnd:()=>{b.forEach(d=>d.remove());b.length=0;this._removeCreateOperationGraphics();this._internalGraphicsLayer&&
this._internalGraphicsLayer.remove(this.createGraphic);this._displayDefaultCursor()},undo:()=>{a.undo();this._emitUndoEvent({graphics:[this.createGraphic],tool:c})},redo:()=>{a.redo();this._emitRedoEvent({graphics:[this.createGraphic],tool:c})},canUndo:()=>a&&a.canUndo(),canRedo:()=>a&&a.canRedo()})};n._isComponentGraphic=function(a){const {activeComponent:b}=this;return!a||t.isNone(b)?!1:a.attributes&&a.attributes.esriSketchTool?!0:("box"===b.type||"reshape"===b.type)&&b.isUIGraphic(a)};n._snap=
function(a,b,c){c&&this._snapLastVertexToAxis(b);"polygon"===a&&this._snapLastPolygonVertexToFirst(b)};n._snapLastPolygonVertexToFirst=function(a){if(!(2>=a.length)){var b=a[0];a=a[a.length-1];var c=this.view.toScreen(new K(b[0],b[1],this.view.spatialReference)),d=this.view.toScreen(new K(a[0],a[1],this.view.spatialReference));this._isWithinScreenDistance(c,d,this._getVertexIntersectDistance())&&(a[0]=b[0],a[1]=b[1])}};n._getVertexIntersectDistance=function(){return this.vertexSymbol&&"simple-marker"===
this.vertexSymbol.type?N.pt2px(this.vertexSymbol.size)/2+3:3};n._isWithinScreenDistance=function(a,b,c){const d=a.x-b.x;a=a.y-b.y;return Math.sqrt(d*d+a*a)<=c};n._snapLastVertexToAxis=function(a){if(!(2>a.length)){var b=a.pop(),c=a[a.length-1],d=x.createViewAlignedCoordinateSystem(this.view,c);c=d.mapToLocal(c);b=d.mapToLocal(b);var g=Math.abs(b.x-c.x),e=Math.abs(b.y-c.y);d=d.localToMap(x.makeSurfacePoint(g>e?b.x:c.x,g>e?c.y:b.y));a.push(d)}};n._displayPointerCursor=function(){this.view&&this.view.container&&
"pointer"!==this.view.cursor&&(this.view.cursor="pointer")};n._displayGrabbingCursor=function(){this.view&&this.view.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")};n._displayCrosshairCursor=function(){this.view&&this.view.container&&"crosshair"!==this.view.cursor&&(this.view.cursor="crosshair")};n._displayDefaultCursor=function(){this.view&&this.view.container&&null!==this.view.cursor&&(this.view.cursor=null)};n._logError=function(a,b,c){oa.error(new ea(a,b,c))};n._requireModule=
async function(a){const b=new AbortController;this._moduleLoaderAbortController=b;a=await a;return this._moduleLoaderAbortController!==b||b.signal.aborted?{requireError:"aborted"}:{module:a}};n._emitUndoEvent=function(a){this.emit("undo",{...a,type:"undo"})};n._emitRedoEvent=function(a){this.emit("redo",{...a,type:"redo"})};n._emitDeleteEvent=function(a){this.emit("delete",{...a,type:"delete"})};n.createPointFromVertex=function(a){return 2<a.length?new K(a[0],a[1],a[2],this.view.spatialReference):
new K(a[0],a[1],this.view.spatialReference)};n.test=function(){return this._operationHandle};n.wait=function(){return J.whenNotOnce(this,"updating")};n._beginAsyncOperation=function(){this._numUpdating+=1;this.notifyChange("updating")};n._endAsyncOperation=function(){--this._numUpdating;this.notifyChange("updating")};n._disablePopupEnabled=function(a){var b;return"3d"!==(null==(b=this.view)?void 0:b.type)||this.updateOnGraphicClick||a.toggleToolOnClick};n._disablePopup=function(a){this._disablePopupEnabled(a)&&
(a=this.view.popup)&&t.isNone(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=a.autoOpenEnabled,a.autoOpenEnabled=!1)};n._restorePopup=function(a){this._disablePopupEnabled(a)&&(a=this.view.popup)&&t.isSome(this._originalAutoOpenEnabled)&&(a.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)};S._createClass(C,[{key:"_defaultUpdateTool",get:function(){return"3d"===this.view.type?"move":"transform"}},{key:"_draw",get:function(){return"ready"===this.state||
"active"===this.state?new la({view:this.view}):null}},{key:"updating",get:function(){return 0<this._numUpdating}},{key:"activeTool",get:function(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}},{key:"activeComponent",get:function(){return this._operationHandle?this._operationHandle.activeComponent:null}},{key:"createGraphic",get:function(){return this.view&&"3d"===this.view.type&&t.isSome(this.activeComponent)&&"draw-3d"===this.activeComponent.type?t.unwrap(this.activeComponent.createGraphic):
this._get("createGraphic")}},{key:"defaultCreateOptions",set:function(a){this._set("defaultCreateOptions",{...aa,...a})}},{key:"defaultUpdateOptions",set:function(a){this._set("defaultUpdateOptions",{...ba,...a})}},{key:"state",get:function(){var a;const b=!(null==(a=this.view)||!a.ready||!this.layer);a=this._operationHandle;return b&&a?"active":b?"ready":"disabled"}},{key:"view",get:function(){return this._get("view")},set:function(a){const b=this._get("view");if(b){const {container:c,map:d}=b;c&&
(b.cursor=null);d&&d.remove(this._internalGraphicsLayer);this._viewHandles.removeAll();this.cancel()}this._doUnnormalization=null!=a&&"3d"===a.type&&"global"===a.viewingMode;this._handles.remove("view-ready");a&&this._handles.add(J.when(a,"ready",c=>{this._viewHandles.removeAll();c&&this._viewHandles.add(this._generateViewHandles(a))},!0),"view-ready");this._set("view",a)}}]);return C}(fa.EventedAccessor);r.__decorate([u.property({dependsOn:["state"],readOnly:!0})],q.prototype,"_draw",null);r.__decorate([u.property()],
q.prototype,"updating",null);r.__decorate([u.property()],q.prototype,"_operationHandle",void 0);r.__decorate([u.property({dependsOn:["_operationHandle","_operationHandle.tool"],readOnly:!0})],q.prototype,"activeTool",null);r.__decorate([u.property()],q.prototype,"activeFillSymbol",void 0);r.__decorate([u.property()],q.prototype,"activeLineSymbol",void 0);r.__decorate([u.property()],q.prototype,"activeVertexSymbol",void 0);r.__decorate([u.property({readOnly:!0})],q.prototype,"createGraphic",null);
r.__decorate([u.property()],q.prototype,"defaultCreateOptions",null);r.__decorate([u.property()],q.prototype,"defaultUpdateOptions",null);r.__decorate([u.property()],q.prototype,"layer",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"pointSymbol",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"polygonSymbol",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"polylineSymbol",void 0);r.__decorate([u.property({dependsOn:["view.ready","layer",
"_operationHandle"],readOnly:!0})],q.prototype,"state",null);r.__decorate([u.property({readOnly:!0})],q.prototype,"updateGraphics",void 0);r.__decorate([u.property()],q.prototype,"updateOnGraphicClick",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"updatePointSymbol",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"updatePolygonSymbol",void 0);r.__decorate([u.property({types:G.symbolTypes})],q.prototype,"updatePolylineSymbol",void 0);r.__decorate([u.property({types:G.symbolTypes})],
q.prototype,"vertexSymbol",void 0);r.__decorate([u.property({value:null})],q.prototype,"view",null);r.__decorate([u.property({type:V.SnappingOptions})],q.prototype,"snappingOptions",void 0);r.__decorate([u.property()],q.prototype,"cancel",null);r.__decorate([u.property()],q.prototype,"complete",null);r.__decorate([u.property()],q.prototype,"delete",null);r.__decorate([u.property()],q.prototype,"create",null);r.__decorate([u.property()],q.prototype,"update",null);r.__decorate([u.property()],q.prototype,
"undo",null);r.__decorate([u.property()],q.prototype,"redo",null);r.__decorate([u.property()],q.prototype,"canUndo",null);r.__decorate([u.property()],q.prototype,"canRedo",null);r.__decorate([u.property()],q.prototype,"toggleUpdateTool",null);return q=r.__decorate([da.subclass("esri.widgets.Sketch.SketchViewModel")],q)});