// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/promiseUtils","../../../Color","./utils"],function(n,l,u,k,p){function q(a,d){const b=[],c=a.length-1;5===a.length?b.push(0,2,4):b.push(0,c);return a.map((e,f)=>-1<b.indexOf(f)?p.createStopLabel(e,f,c,d):null)}async function v(a,d,b=w){b=new k(b);a=(await new Promise(function(c,e){n(["../../../renderers/visualVariables/support/visualVariableUtils"],c,e)})).getOpacity(d,a);null!=a&&(b.a=a);return b}function r(a,d){const {startIndex:b,endIndex:c,weight:e}=
x(a,d);if(b===c)return d[b].color;a=k.blendColors(d[b].color,d[c].color,e);return new k(a)}function x(a,d){let b=0,c=d.length-1;d.some((e,f)=>{if(a<e.value)return c=f,!0;b=f;return!1});return{startIndex:b,endIndex:c,weight:(a-d[b].value)/(d[c].value-d[b].value)}}const w=new k([64,64,64]);l.getColorFromPointCloudStops=r;l.getRampStops=async function(a,d,b,c){let e=!1;var f=[];let g=[];a.stops&&(f=null==c?void 0:c.authoringInfo,c=a.stops,f="univariate-color-size"===(null==f?void 0:f.type)&&"above-and-below"===
(null==f?void 0:f.univariateTheme)&&"color"===a.type?p.getUnivariateAboveAndBelowStopValues(a,f):c.map(h=>h.value),(e=c.some(h=>!!h.label))&&(g=c.map(h=>h.label)));c=f[f.length-1];if(null==f[0]&&null==c)return null;const m=e?null:q(f,b);return(await u.all(f.map(async(h,t)=>{const A="opacity"===a.type?await v(h,a,d):(await new Promise(function(y,z){n(["../../../renderers/visualVariables/support/visualVariableUtils"],y,z)})).getColor(a,h);return{value:h,color:A,label:e?g[t]:m[t]}}))).reverse()};l.getRampStopsForPointCloud=
function(a){let d=!1,b=[],c=[];b=a.map(g=>g.value);(d=a.some(g=>!!g.label))&&(c=a.map(g=>g.label));const e=b[b.length-1];if(null==b[0]&&null==e)return null;const f=d?null:q(b,!1);return b.map((g,m)=>{const h=r(g,a);return{value:g,color:h,label:d?c[m]:f[m]}}).reverse()};l.getStrectchRampStops=function(a,d){let b=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(c,e){0===e?b.push({value:d.max,color:new k(c.toColor),label:"high"}):b.push({value:null,color:new k(c.toColor),label:""});
e===a.colorRamps.length-1?b.push({value:d.min,color:new k(c.fromColor),label:"low"}):b.push({value:null,color:new k(c.fromColor),label:""})});else{let c,e;a&&"algorithmic"===a.type?(c=a.fromColor,e=a.toColor):(c=[0,0,0,1],e=[255,255,255,1]);b=[{value:d.max,color:new k(e),label:"high"},{value:d.min,color:new k(c),label:"low"}]}return b};Object.defineProperty(l,"__esModule",{value:!0})});