// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../intl/number ../../../intl ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/decorators/renderable ../../../chunks/index ../../Widget ./support/utils ../support/styleUtils".split(" "),
function(C,v,t,K,L,x,M,D,N,O,P,E,Q,R,F,z,c,G,r,l){const H={display:"flex",alignItems:"flex-start"},A={marginLeft:"3px"},w={display:"table-cell",verticalAlign:"middle"};t=function(B){function y(a,b){a=B.call(this,a,b)||this;a.activeLayerInfos=null;a.messages=null;a.type="classic";return a}C._inheritsLoose(y,B);var q=y.prototype;q.render=function(){var a=this.activeLayerInfos;a=a&&a.toArray().map(b=>this._renderLegendForLayer(b)).filter(b=>!!b);return c.jsx("div",null,a&&a.length?a:c.jsx("div",{class:"esri-legend__message"},
this.messages.noLegend))};q._renderLegendForLayer=function(a){if(!a.ready)return null;var b=!!a.children.length;const f=`${"esri-legend__"}${a.layer.uid}-version-${a.version}`,e=a.title?c.jsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(b)return b=a.children.map(d=>this._renderLegendForLayer(d)).toArray(),c.jsx("div",{key:f,class:this.classes("esri-legend__service","esri-legend__group-layer")},e,b);if((b=a.legendElements)&&!b.length)return null;b=
b.map(d=>this._renderLegendForElement(d,a.layer)).filter(d=>!!d);return b.length?c.jsx("div",{key:f,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!a.parent})},e,c.jsx("div",{class:"esri-legend__layer"},b)):null};q._renderLegendForElement=function(a,b,f){var e="color-ramp"===a.type,d="opacity-ramp"===a.type;const g="size-ramp"===a.type;let h=null;if("symbol-table"===a.type||g){var k=a.infos.map(u=>this._renderLegendForElementInfo(u,b,g,a.legendType)).filter(u=>!!u);
k.length&&(h=c.jsx("div",{class:"esri-legend__layer-body"},k))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?h=this._renderLegendForRamp(a,b.opacity):"relationship-ramp"===a.type?h=r.renderRelationshipRamp(a,this.id,b.opacity):"univariate-above-and-below-ramp"===a.type&&(h=this._renderUnivariateAboveAndBelowRamp(a,b.opacity));if(!h)return null;k=a.title;var n=null;"string"===typeof k?n=k:k&&(n=l.getTitle(this.messages,k,e||d),n=l.isRendererTitle(k,
e||d)&&k.title?`${k.title} (${n})`:n);e=f?"esri-legend__layer-child-table":"esri-legend__layer-table";d=n?c.jsx("div",{class:"esri-legend__layer-caption"},n):null;return c.jsx("div",{class:this.classes(e,{["esri-legend__layer-table--size-ramp"]:g||!f})},d,h)};q._renderUnivariateAboveAndBelowRamp=function(a,b){const {sizeRampElement:f,colorRampElement:e}=r.getUnivariateAboveAndBelowRampElements(a,b);var d=r.getUnivariateAboveAndBelowColorRampSize(f,"above");a=r.getUnivariateAboveAndBelowColorRampSize(f,
"below");const g=r.getUnivariateAboveAndBelowColorRampPreview(e,{width:12,height:d,rampAlignment:"vertical",opacity:b,type:"above"});b=r.getUnivariateAboveAndBelowColorRampPreview(e,{width:12,height:a,rampAlignment:"vertical",opacity:b,type:"below"});var h=r.getUnivariateAboveAndBelowColorRampMargin(f);const k=f.infos.map(p=>p.label),n=k.map((p,m)=>{const I=2===m;return 0===m?c.jsx("div",{key:m,class:p?g?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},p):I?c.jsx("div",
null):null}),u=k.map((p,m)=>2===m||4===m?c.jsx("div",{key:m,class:p?g?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},p):null),J={display:"table-cell",verticalAlign:"middle"};h={marginTop:`${h}px`};d={height:`${d}px`};a={height:`${a}px`};return c.jsx("div",{key:"univariate-above-and-below-ramp-preview",styles:H},c.jsx("div",{class:"esri-legend__layer-body"},f.infos.map((p,m)=>c.jsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},c.jsx("div",
{class:"esri-legend__symbol",styles:J,bind:p.preview,afterCreate:l.attachToNode}),g||0!==m%2?null:c.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},k[m])))),g?c.jsx("div",{styles:h,key:"color-ramp-preview"},c.jsx("div",{styles:A},c.jsx("div",{styles:w},c.jsx("div",{class:"esri-legend__ramps",bind:g,afterCreate:l.attachToNode})),c.jsx("div",{styles:w},c.jsx("div",{class:"esri-legend__ramp-labels",styles:d},n))),c.jsx("div",{styles:A},c.jsx("div",{styles:w},c.jsx("div",{class:"esri-legend__ramps",
bind:b,afterCreate:l.attachToNode})),c.jsx("div",{styles:w},c.jsx("div",{class:"esri-legend__ramp-labels",styles:a},u)))):null)};q._renderLegendForRamp=function(a,b){const f=a.infos,e="heatmap-ramp"===a.type,d="stretch-ramp"===a.type,g=a.preview;g.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===a.type?"esri-legend__opacity-ramp":""}`;null!=b&&(g.style.opacity=b.toString());a=f.map(h=>c.jsx("div",{class:h.label?"esri-legend__ramp-label":null},e?this.messages[h.label]:d?this._getStretchStopLabel(h):
h.label));b={height:g.style.height};return c.jsx("div",{class:"esri-legend__layer-row"},c.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},c.jsx("div",{class:"esri-legend__ramps",bind:g,afterCreate:l.attachToNode})),c.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},c.jsx("div",{class:"esri-legend__ramp-labels",styles:b},a)))};q._getStretchStopLabel=function(a){return a.label?this.messages[a.label]+": "+E.formatNumber(a.value,
{style:"decimal",notation:-1<a.value.toString().indexOf("e")?"scientific":"standard"}):""};q._renderLegendForElementInfo=function(a,b,f,e){if(a.type)return this._renderLegendForElement(a,b,!0);let d=null;e=l.isImageryStretchedLegend(b,e);a.preview?d=c.jsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:l.attachToNode}):a.src&&(d=this._renderImage(a,b,e));if(!d)return null;b={["esri-legend__imagery-layer-info--stretched"]:e};return c.jsx("div",{class:"esri-legend__layer-row"},c.jsx("div",
{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:e,["esri-legend__size-ramp"]:!e&&f})},d),c.jsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},l.getTitle(this.messages,a.label,!1)||""))};q._renderImage=function(a,b,f){const {label:e,src:d,opacity:g}=a;f={["esri-legend__imagery-layer-image--stretched"]:f,["esri-legend__symbol"]:!f};b={opacity:`${null!=g?g:b.opacity}`};return c.jsx("img",
{alt:l.getTitle(this.messages,e,!1),src:d,border:0,width:a.width,height:a.height,class:this.classes(f),styles:b})};return y}(G);v.__decorate([z.renderable(),x.property()],t.prototype,"activeLayerInfos",void 0);v.__decorate([x.property(),z.renderable(),F.messageBundle("esri/widgets/Legend/t9n/Legend")],t.prototype,"messages",void 0);v.__decorate([x.property({readOnly:!0})],t.prototype,"type",void 0);return t=v.__decorate([D.subclass("esri.widgets.Legend.styles.Classic")],t)});