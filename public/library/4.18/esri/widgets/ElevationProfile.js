// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/maybe ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/promiseUtils ../core/watchUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./ElevationProfile/css ./ElevationProfile/ChartLegend ./ElevationProfile/support/constants ./ElevationProfile/ElevationProfileViewModel ./ElevationProfile/ElevationProfileVisibleElements ./ElevationProfile/SettingsButton ./ElevationProfile/Statistics ./ElevationProfile/support/chartUtils".split(" "),
function(v,f,e,l,I,J,k,m,K,z,L,M,N,A,r,O,t,h,g,B,c,C,n,w,x,D,E,F){const u=[4,0];e=function(y){function q(b,a){a=y.call(this,b,a)||this;a.viewModel=null;a.view=null;a.input=null;a.profiles=null;a.unitOptions=[];a.unit="metric";a.geodesicDistanceThreshold=1E5;a.visibleElements=new x;a.iconClass=c.CSS.widgetIcon;a.label=void 0;a.messages=null;a.messagesCommon=null;a.messagesUnits=null;a._chartContainer=null;a._chart=null;a._settingsButton=new D.SettingsButton({viewModel:a.viewModel});a._statisticsWidget=
new E.Statistics({viewModel:a.viewModel});a._legend=new C({viewModel:a.viewModel});a._resizeObserver=null;a._portrait=!1;a._chartInitTask=null;b.viewModel||(a._defaultViewModel=new w({view:b.view}),a.viewModel=a._defaultViewModel);return a}v._inheritsLoose(q,y);var d=q.prototype;d.postInitialize=function(){this.own([r.init(this,"_chartContainer",()=>{this._destroyChart();const b=this._chartContainer;l.isNone(b)||(this._chartInitTask=A.createTask(a=>this._initializeChart(b,a)))}),r.init(this,"viewModel",
b=>{this._settingsButton.viewModel=b;this._statisticsWidget.viewModel=b;this._legend.viewModel=b}),r.init(this,"_chartUpdateParams",()=>this._updateChart())])};d.destroy=function(){this._destroyChart();l.isSome(this._defaultViewModel)&&this.viewModel!==this._defaultViewModel&&this._defaultViewModel.destroy();this._statisticsWidget.destroy();this._statisticsWidget=null;this._legend.destroy();this._legend=null;this._settingsButton.destroy();this._settingsButton=null;l.isSome(this._resizeObserver)&&
(this._resizeObserver.disconnect(),this._resizeObserver=null)};d.render=function(){const {viewModel:b}=this,a=b.progress;return g.jsx("div",{key:this,class:this.classes(c.CSS.base,c.CSS.esriWidget,{[c.CSS.esriWidgetDisabled]:"disabled"===b.state,[c.CSS.portrait]:this._portrait}),"aria-label":this.messages.widgetLabel,bind:this,afterCreate:this._onAfterCreate},g.jsx("div",{key:"progress-bar",class:this.classes(c.CSS.progressBar,{[c.CSS.progressBarVisible]:1>a}),styles:{width:`${100*a}%`},role:"presentation",
"aria-hidden":"true",title:this.messagesCommon.loading}),this._renderContentForState())};d._renderContentForState=function(){switch(this.viewModel.state){case n.ElevationProfileState.Ready:return this._renderContentForReadyState();case n.ElevationProfileState.Selecting:return this._renderContentForSelectingState();case n.ElevationProfileState.Creating:return this._renderContentForCreatingState();case n.ElevationProfileState.Selected:case n.ElevationProfileState.Created:return this._renderContentForCreatedState();
case n.ElevationProfileState.Disabled:return null}};d._renderContentForReadyState=function(){return this._renderContent({prompt:this.messages.readyPrompt,statistics:!1,chart:!1,legend:!1,actions:u})};d._renderContentForSelectingState=function(){return this._renderContent({prompt:this.messages.selectingPrompt,statistics:!1,chart:!1,legend:!1,actions:[5]})};d._renderContentForCreatingState=function(){const b={statistics:!1,chart:!1,legend:!1,actions:[1,3]};switch(this.viewModel.errorState){case 0:return this._renderContent({...b,
prompt:this.messages.creatingPrompt});case 1:return this._renderContent({...b,prompt:this.messages.noMultiPathSupport});case 2:case 3:return this._renderContent({...b,prompt:this.messages.noProfile,legend:!0});case 4:return this._renderContent({statistics:!0,chart:!0,legend:!0,actions:[1,this.viewModel.canStopCreating?2:3]})}};d._renderContentForCreatedState=function(){const b={statistics:!1,chart:!1,legend:!1,actions:u};switch(this.viewModel.errorState){case 0:return this._renderContent({...b,prompt:this.messages.noProfile});
case 1:return this._renderContent({...b,prompt:this.messages.noMultiPathSupport});case 2:case 3:return this._renderContent({...b,prompt:this.messages.noProfile,legend:!0});case 4:return this._renderContent({statistics:!0,chart:!0,legend:!0,actions:u})}};d._renderContent=function({statistics:b,prompt:a,chart:p,legend:G,actions:H}){return[this._renderHeader({statistics:b}),l.isSome(a)?this._renderPrompt(a):p&&this._renderChart(),this._renderActions({legend:G,actions:H})]};d._renderHeader=function(b){const {progress:a}=
this.viewModel;b=1===a&&b.statistics&&this.visibleElements.statistics;return g.jsx("header",{key:"header",class:c.CSS.header},0<a&&1>a&&g.jsx("div",{key:"loading-message",class:c.CSS.loadingMessage},this.messages.loading),b?this._statisticsWidget.render():g.jsx("div",{key:"header-spacer",class:c.CSS.headerSpacer}),this._settingsButton.render())};d._renderPrompt=function(b){return g.jsx("div",{key:"prompt-container",bind:this,class:c.CSS.promptContainer},g.jsx("p",null,b))};d._renderChart=function(){return g.jsx("div",
{key:"chart-container",bind:this,class:c.CSS.chartContainer,afterCreate:this._onChartContainerAfterCreate,afterRemoved:this._onChartContainerRemoved})};d._renderActions=function({legend:b,actions:a}){a=a.map(p=>{switch(p){case 0:return this.visibleElements.sketchButton&&g.jsx("button",{key:"sketch",class:this.classes(c.CSS.actionButton,c.CSS.sketchButton),bind:this,onclick:this._onSketchButtonClick},this.messages.sketchButtonLabel);case 1:return this.visibleElements.sketchButton&&g.jsx("button",{key:"sketch-cancel",
class:this.classes(c.CSS.actionButton,c.CSS.sketchCancelButton),bind:this,onclick:this._onCancelButtonClick},this.messagesCommon.cancel);case 2:return this.visibleElements.sketchButton&&g.jsx("button",{key:"sketch-done",class:this.classes(c.CSS.actionButton,c.CSS.sketchDoneButton),bind:this,onclick:this._onDoneButtonClick},this.messagesCommon.done);case 3:return this.visibleElements.sketchButton&&g.jsx("button",{key:"sketch-done-disabled",class:this.classes(c.CSS.actionButton,c.CSS.sketchDoneButton,
c.CSS.buttonDisabled),bind:this,disabled:!0},this.messagesCommon.done);case 4:return this.visibleElements.selectButton&&g.jsx("button",{key:"select",class:this.classes(c.CSS.actionButton,c.CSS.selectButton),bind:this,onclick:this._onSelectButtonClick},this.messages.selectButtonLabel);case 5:return this.visibleElements.selectButton&&g.jsx("button",{key:"select-cancel",class:this.classes(c.CSS.actionButton,c.CSS.selectCancelButton),bind:this,onclick:this._onCancelButtonClick},this.messagesCommon.cancel)}});
return g.jsx("div",{class:c.CSS.footer},g.jsx("div",{class:c.CSS.legendContainer},this.visibleElements.legend&&b&&this._legend.render()),g.jsx("div",{class:c.CSS.actionsContainer},a))};d._onSketchButtonClick=function(){this.viewModel.start({mode:"sketch"})};d._onSelectButtonClick=function(){this.viewModel.start({mode:"select"})};d._onCancelButtonClick=function(){this.viewModel.cancel()};d._onDoneButtonClick=function(){this.viewModel.stop()};d._updateChart=function(){const b=this._chartUpdateParams;
b.stationary&&l.isSome(b.chart)&&b.messages&&b.chart.update(b)};d._onChartContainerAfterCreate=function(b){this._chartContainer=b};d._onChartContainerRemoved=function(){this._chartContainer=null};d._initializeChart=async function(b,a){this._chart=await F.createChart({container:b,abortOptions:{signal:a},onCursorPositionChange:p=>{this.viewModel.hoveredChartPosition=p}});this._updateChart()};d._destroyChart=function(){l.isSome(this._chartInitTask)&&(this._chartInitTask.abort(),this._chartInitTask=null);
l.isSome(this._chart)&&(this._chart.destroy(),this._chart=null)};d._onAfterCreate=function(b){const a=()=>{this._portrait=b.getBoundingClientRect().width<n.PORTRAIT_MODE_PIXEL_BREAKPOINT};a();this._resizeObserver=new ResizeObserver(()=>a());this._resizeObserver.observe(b)};v._createClass(q,[{key:"_chartUpdateParams",get:function(){return{chart:this._chart,data:this.viewModel.chartData,stationary:this.view.stationary,elevationUnitsPerPixel:this.viewModel.elevationUnitsPerPixel,messages:{...this.messagesUnits,
...this.messages}}}}]);return q}(B);f.__decorate([k.property({type:w}),h.renderable(["chartData","progress","statistics","canStopCreating"])],e.prototype,"viewModel",void 0);f.__decorate([m.aliasOf("viewModel.view"),h.renderable()],e.prototype,"view",void 0);f.__decorate([m.aliasOf("viewModel.input"),h.renderable()],e.prototype,"input",void 0);f.__decorate([m.aliasOf("viewModel.profiles"),h.renderable()],e.prototype,"profiles",void 0);f.__decorate([m.aliasOf("viewModel.unitOptions"),h.renderable()],
e.prototype,"unitOptions",void 0);f.__decorate([m.aliasOf("viewModel.unit"),h.renderable()],e.prototype,"unit",void 0);f.__decorate([m.aliasOf("viewModel.geodesicDistanceThreshold"),h.renderable()],e.prototype,"geodesicDistanceThreshold",void 0);f.__decorate([k.property({type:x}),h.renderable()],e.prototype,"visibleElements",void 0);f.__decorate([k.property(),h.renderable()],e.prototype,"iconClass",void 0);f.__decorate([m.aliasOf("messages.widgetLabel",{overridable:!0}),h.renderable()],e.prototype,
"label",void 0);f.__decorate([k.property(),h.renderable(),t.messageBundle("esri/widgets/ElevationProfile/t9n/ElevationProfile")],e.prototype,"messages",void 0);f.__decorate([k.property(),h.renderable(),t.messageBundle("esri/t9n/common")],e.prototype,"messagesCommon",void 0);f.__decorate([k.property(),h.renderable(),t.messageBundle("esri/core/t9n/Units")],e.prototype,"messagesUnits",void 0);f.__decorate([k.property()],e.prototype,"_chartContainer",void 0);f.__decorate([k.property()],e.prototype,"_chart",
void 0);f.__decorate([k.property(),h.renderable()],e.prototype,"_portrait",void 0);f.__decorate([k.property()],e.prototype,"_chartUpdateParams",null);return e=f.__decorate([z.subclass("esri.widgets.ElevationProfile")],e)});