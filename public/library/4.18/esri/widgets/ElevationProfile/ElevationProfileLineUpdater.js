// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/throttle ./support/geometryUtils ./support/constants ./support/profileUtils".split(" "),
function(u,k,b,g,D,E,n,F,x,G,H,I,p,y,z,q,A,v,l,B){b=function(w){function m(c){var a=w.call(this,c)||this;a._handles=new z;a._updateTask=null;a._lastParams=null;a._lastSamplingDistance=null;a._update=async()=>{if(a.viewModel.view.stationary){var d=a.line,e=a._generateProfileParams;if(g.isNone(e))a._abortUpdate(),d.result=null;else if(d.visible){var h=g.unwrapOr(a.viewModel.minDemResolution,l.DEFAULT_DEM_RESOLUTION);if(a._generateProfileParams!==a._lastParams||a._lastSamplingDistance!==h||1>d.progress)a._abortUpdate(),
a._updateTask=p.createTask(async f=>{const r=B.generateProfile({...e,options:{...e.options,samplingDistance:h},signal:f});for await(const C of r)p.throwIfAborted(f),d.result=C;a._lastParams=e;a._lastSamplingDistance=h})}}};a._throttledUpdate=A.throttle(()=>p.ignoreAbortErrors(a._update()),l.UPDATE_THROTTLE_MILLIS);return a}u._inheritsLoose(m,w);var t=m.prototype;t.initialize=function(){const c=this.viewModel,a=this.line;this._handles.add([this._throttledUpdate,a.attach(c),a.on("change",this._throttledUpdate),
q.init(c,["view.stationary","minDemResolution"],this._throttledUpdate),q.init(a,"visible",this._throttledUpdate),q.init(this,"_generateProfileParams",this._throttledUpdate)])};t.destroy=function(){this._handles.destroy();this._abortUpdate()};t._abortUpdate=function(){g.isSome(this._updateTask)&&(this._updateTask.abort(),this._updateTask=null)};u._createClass(m,[{key:"_generateProfileParams",get:function(){const {input:c,queue:a,view:d,tileCache:e,geodesicDistanceThreshold:h}=this.viewModel,f=g.applySome(c,
r=>r.geometry);return v.isPolyline(f)&&v.isValidInputPath(f)&&!g.isNone(a)?{view:d,path:f,provider:this.line,options:{geodesicDistanceThreshold:h,samplingDistance:l.DEFAULT_DEM_RESOLUTION,maxSamples:l.MAX_SAMPLES},queue:a,cache:e}:null}}]);return m}(y);k.__decorate([n.property({nonNullable:!0})],b.prototype,"line",void 0);k.__decorate([n.property({nonNullable:!0})],b.prototype,"viewModel",void 0);k.__decorate([n.property()],b.prototype,"_generateProfileParams",null);return b=k.__decorate([x.subclass("esri.widgets.ElevationProfile.ElevationProfileLineUpdater")],
b)});