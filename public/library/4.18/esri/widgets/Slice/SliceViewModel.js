// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/maybe ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/aliasOf ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/promiseUtils ../../core/Accessor ../../core/Collection ../../core/collectionUtils ../../core/Handles ../../chunks/boundedPlane ../support/InteractiveToolViewModel ../../views/3d/interactive/analysisTools/slice/sliceToolUtils ../../views/3d/interactive/analysisTools/slice/SliceTool ./SlicePlane".split(" "),
function(k,e,d,f,w,E,g,x,F,y,G,H,I,l,z,p,q,A,r,B,t,C,u){const D=w.getLogger("esri.widgets.Slice.SliceViewModel"),m=new Set;d=function(n){function h(a){a=n.call(this,a)||this;a.supportedViewType="3d";a.handles=new A;m.add(k._assertThisInitialized(a));return a}k._inheritsLoose(h,n);var c=h.prototype;c.destroy=function(){m.delete(this);this.handles.destroy()};c.start=function(){m.forEach(a=>{a.view===this.view&&a!==this&&a.clear()});return this.createTool()};c.clear=function(){this.removeTool();this._set("plane",
null);this._set("excludeGroundSurface",!1);this._set("excludedLayers",new p)};c.newSlice=function(){l.ignoreAbortErrors(this.start())};c.clearSlice=function(){this.clear()};c.removeSliceAndStart=function(){this.removeTool();this.plane=null;return this.start()};c.enterExcludeLayerMode=function(){this.tool&&this.tool.enterExcludeLayerMode()};c.exitExcludeLayerMode=function(){this.tool&&this.tool.exitExcludeLayerMode()};c.createTool=async function(){await this.view.whenReady();if(this._isOverridden("shape")){const a=
this.shape;this._clearOverride("shape");this.shape=a}await n.prototype.createTool.call(this)};c._updateToolOrRecreate=function(a){this.tool?a(this.tool):this.creatingTool&&l.ignoreAbortErrors(this.createTool())};c.createToolParams=function(){return{toolConstructor:C,constructorArguments:()=>({excludeGroundSurface:this.excludeGroundSurface,plane:this.plane,excludedLayers:this.excludedLayers,tiltEnabled:this.tiltEnabled})}};c.logUnsupportedError=function(){this.logError("Slice widget is not implemented for MapView")};
c.logError=function(...a){D.error(...a)};k._createClass(h,[{key:"state",get:function(){return this.isDisabled?"disabled":this.tool?this.tool.state:"ready"}},{key:"plane",get:function(){return this.tool?this.tool.plane:this._get("plane")},set:function(a){this._clearOverride("shape");this._set("plane",a);f.isSome(a)?this.tool?this.tool.plane=a:a&&l.ignoreAbortErrors(this.createTool()):this.removeTool()}},{key:"shape",get:function(){if(f.isNone(this.plane))return null;const a=this._get("shape");var b=
this.view;b=t.planeToShape(this.plane,b.renderCoordsHelper,b.spatialReference,new u);return f.isNone(b)||f.isNone(a)?b:b.heading===a.heading&&b.tilt===a.tilt&&f.isSome(b.position)&&f.isSome(a.position)&&b.position.equals(a.position)&&b.width===a.width&&b.height===a.height?a:b},set:function(a){f.isNone(this.view)||!this.view.ready?this._override("shape",a):(a=t.shapeToPlane(a,this.view.renderCoordsHelper,r.create()),f.isSome(this.plane)&&f.isSome(a)&&r.equals(this.plane,a)||(this.plane=a))}},{key:"tiltEnabled",
get:function(){var a,b,v;return null!=(a=null!=(b=null==(v=this.tool)?void 0:v.tiltEnabled)?b:this._get("tiltEnabled"))?a:!1},set:function(a){this._set("tiltEnabled",a);this._updateToolOrRecreate(b=>b.tiltEnabled=a)}},{key:"excludedLayers",get:function(){return this.tool?this.tool.excludedLayers:this._get("excludedLayers")||new p},set:function(a){this._set("excludedLayers",q.referenceSetter(a,this.excludedLayers));this._updateToolOrRecreate(b=>b.excludedLayers=a)}},{key:"excludeGroundSurface",get:function(){return this.tool?
this.tool.excludeGroundSurface:this._get("excludeGroundSurface")||!1},set:function(a){this._set("excludeGroundSurface",a);this._updateToolOrRecreate(b=>b.excludeGroundSurface=a)}}]);return h}(B.InteractiveToolViewModel);e.__decorate([g.property({dependsOn:["isDisabled","tool.attached","tool.state"],readOnly:!0})],d.prototype,"state",null);e.__decorate([g.property()],d.prototype,"tool",void 0);e.__decorate([g.property({dependsOn:["tool.plane"]})],d.prototype,"plane",null);e.__decorate([g.property({types:{key:"type",
base:z,typeMap:{plane:u},defaultKeyValue:"plane"},dependsOn:["plane"]})],d.prototype,"shape",null);e.__decorate([g.property({type:Boolean,dependsOn:["tool.tiltEnabled"]})],d.prototype,"tiltEnabled",null);e.__decorate([x.aliasOf("tool.layersMode")],d.prototype,"layersMode",void 0);e.__decorate([g.property({dependsOn:["tool.excludedLayers"],cast:q.castForReferenceSetter})],d.prototype,"excludedLayers",null);e.__decorate([g.property({dependsOn:["tool.excludeGroundSurface"],nonNullable:!0})],d.prototype,
"excludeGroundSurface",null);return d=e.__decorate([y.subclass("esri.widgets.slice.SliceViewModel")],d)});