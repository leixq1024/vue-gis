// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/Collection ../../intl/locale ../../intl ../../core/Handles ../../core/watchUtils ./support/ActiveLayerInfo".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p,J){const O=h.ofType(J),G="esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.TileLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer".split(" "),
M=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];r=function(P){function B(e){e=P.call(this,e)||this;e._handles=new E;e._layerViewByLayerId={};e._layerInfosByLayerViewId={};e._activeLayerInfosByLayerViewId={};e._activeLayerInfosWithNoParent=new h;e.activeLayerInfos=new O;e.basemapLegendVisible=!1;e.groundLegendVisible=!1;e.keepCacheOnDestroy=!1;e.respectLayerVisibility=!0;e.layerInfos=[];e.view=null;return e}D._inheritsLoose(B,
P);var c=B.prototype;c.initialize=function(){this._handles.add(p.init(this,"view",this._viewHandles),"view");this._handles.add(C.onLocaleChange(()=>this._refresh()))};c.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};c._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(p.init(this,"state",this._stateHandles),"state")};c._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
c._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};c._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};c._destroyViewActiveLayerInfo=function(e){this._handles.remove(e);const k=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e];k&&k.parent&&k.parent.children.remove(k)};c._watchPropertiesAndAllLayerViews=
function(){const {allLayerViews:e}=this.view;e.length&&this._refresh();this._handles.add(e.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(p.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};c._allLayerViewsChangeHandle=function(e){e.removed.forEach(k=>this._destroyViewActiveLayerInfo(k.uid));this._refresh()};c._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};c._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};c._sortActiveLayerInfos=function(e){if(!(2>e.length)){var k=[];e.forEach(F=>{if(!F.parent){var g=F.layer.parent;(g=(g=g&&"uid"in g&&this._layerViewByLayerId[g.uid])&&this._activeLayerInfosByLayerViewId[g.uid])&&
-1!==e.indexOf(g)&&(k.push(F),F.parent=g,g.children.add(F),this._sortActiveLayerInfos(g.children))}});e.removeMany(k);var u={};this.view.allLayerViews.forEach((F,g)=>u[F.layer.uid]=g);e.sort((F,g)=>(u[g.layer.uid]||0)-(u[F.layer.uid]||0))}};c._generateLayerViews=function(){const e=[];M.filter(this._filterLayerViews,this).map(this.get,this).filter(k=>null!=k).forEach(this._collectLayerViews("layerViews",e));return e};c._filterLayerViews=function(e){const k=!this.groundLegendVisible&&"view.groundView.layerViews"===
e;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===e||"view.basemapView.referenceLayerViews"===e))&&!k};c._collectLayerViews=function(e,k){const u=F=>{F&&F.forEach(g=>{k.push(g);u(g[e])});return k};return u};c._filterLayerViewsByLayerInfos=function(e){const k=this.layerInfos;return k&&k.length?k.some(u=>this._hasLayerInfo(u,e)):!0};c._hasLayerInfo=function(e,k){const u=this._isLayerUIDMatching(e.layer,k.layer.uid);u&&(this._layerInfosByLayerViewId[k.uid]=e);return u};c._isLayerUIDMatching=
function(e,k){return e&&(e.uid===k||this._hasLayerUID(e.layers,k))};c._hasLayerUID=function(e,k){return e&&e.some(u=>this._isLayerUIDMatching(u,k))};c._isLayerViewSupported=function(e){return-1<G.indexOf(e.layer.declaredClass)?(this._layerViewByLayerId[e.layer.uid]=e,!0):!1};c._generateActiveLayerInfo=function(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this._handles.remove(e.uid),this._handles.add(p.watch(e,"legendEnabled, layer.legendEnabled",()=>this._layerActiveHandle(e)),e.uid))};
c._layerActiveHandle=function(e){this._isLayerActive(e)&&(this._handles.remove(e.uid),this._buildActiveLayerInfo(e))};c._isLayerActive=function(e){return this.respectLayerVisibility?e.legendEnabled&&e.get("layer.legendEnabled"):!0};c._buildActiveLayerInfo=function(e){var k,u=e.layer;const F=e.uid;var g=this._layerInfosByLayerViewId[F];let H=this._activeLayerInfosByLayerViewId[F];H||(H=new J({layer:u,layerView:e,title:g&&void 0!==g.title&&g.layer.uid===u.uid?g.title:u.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,
keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:g&&g.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[F]=H);g=u.parent&&"uid"in u.parent&&this._layerViewByLayerId[null==(k=u.parent)?void 0:k.uid];H.parent=this._activeLayerInfosByLayerViewId[null==g?void 0:g.uid];if(!this._handles.has(F)){k=p.watch(u,"title",z=>this._titleHandle(z,H));g=p.watch(u,"renderer?, opacity, pointSymbol?, lineSymbol?, polygonSymbol?",()=>this._constructLegendElements(H));const b=p.whenTrue(this.view,"stationary",
()=>this._scaleHandle(H)),f=p.watch(e,"_effectiveRenderer",()=>this._constructLegendElements(H));k=[k,g,b,f];this.respectLayerVisibility&&(e=p.watch(e,"legendEnabled",z=>this._legendEnabledHandle(z,H)),u=p.watch(u,"legendEnabled",z=>this._legendEnabledHandle(z,H)),k.push(e,u));this._handles.add(k,F)}H.isScaleDriven||this._constructLegendElements(H);this._addActiveLayerInfo(H)};c._titleHandle=function(e,k){k.title=e;this._constructLegendElements(k)};c._legendEnabledHandle=function(e,k){e?this._addActiveLayerInfo(k):
this._removeActiveLayerInfo(k)};c._scaleHandle=function(e){e.isScaleDriven&&this._constructLegendElements(e)};c._addActiveLayerInfo=function(e){const {layerView:k,layer:u}=e;if(this._isLayerActive(k)&&-1===this.activeLayerInfos.indexOf(e)){var F=e.parent;if(F)-1===F.children.indexOf(e)&&F.children.push(e),this._sortActiveLayerInfos(F.children);else{var g;F=null==(g=this.layerInfos)?void 0:g.some(H=>H.layer.uid===u.uid);u.parent&&"uid"in u.parent&&!F?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),
this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const H=[];this._activeLayerInfosWithNoParent.forEach(b=>{var f=b.layer.parent;f=f&&"uid"in f&&this._layerViewByLayerId[null==f?void 0:f.uid];if(f=this._activeLayerInfosByLayerViewId[null==f?void 0:f.uid])H.push(b),b.parent=f});H.length&&(this._activeLayerInfosWithNoParent.removeMany(H),H.forEach(b=>this._addActiveLayerInfo(b)))}}};c._removeActiveLayerInfo=function(e){const k=e.parent;k?k.children.remove(e):
this.activeLayerInfos.remove(e)};c._constructLegendElements=function(e){const k=e.layer;"featureCollections"in k&&k.featureCollections?e.buildLegendElementsForFeatureCollections(k.featureCollections):"renderer"in k&&k.renderer?e.buildLegendElementsForRenderer(k.renderer):"url"in k&&k.url?e.buildLegendElementsForTools():e.children.forEach(u=>this._constructLegendElements(u))};D._createClass(B,[{key:"state",get:function(){return this.get("view.ready")?"ready":"disabled"}}]);return B}(d);N.__decorate([y.property({type:O})],
r.prototype,"activeLayerInfos",void 0);N.__decorate([y.property()],r.prototype,"basemapLegendVisible",void 0);N.__decorate([y.property()],r.prototype,"groundLegendVisible",void 0);N.__decorate([y.property()],r.prototype,"keepCacheOnDestroy",void 0);N.__decorate([y.property()],r.prototype,"respectLayerVisibility",void 0);N.__decorate([y.property()],r.prototype,"layerInfos",void 0);N.__decorate([y.property({dependsOn:["view.ready"],readOnly:!0})],r.prototype,"state",null);N.__decorate([y.property()],
r.prototype,"view",void 0);return r=N.__decorate([T.subclass("esri.widgets.Legend.LegendViewModel")],r)})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/promiseUtils ../../../core/Accessor ../../../core/Collection ../../../layers/support/fieldUtils ../../../Color ../../../core/screenUtils ../../../kernel ../../../request ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleMarkerSymbol ../../../chunks/symbols ../../../core/Handles ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ../../../renderers/support/jsonUtils ../../../core/watchUtils ../../../layers/support/ExportImageParameters ../../../symbols/support/symbolUtils ./clusterUtils ./utils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p,J,O,G,M,P,B,c,e,k,u,F,g,H,b,f,z,K,l,x,R,U){function Y(pa){return"esri.renderers.SimpleRenderer"===pa.declaredClass}function ea(pa){return"esri.renderers.ClassBreaksRenderer"===pa.declaredClass}function ca(pa){return"esri.renderers.UniqueValueRenderer"===pa.declaredClass}function ha(pa){return"esri.renderers.HeatmapRenderer"===pa.declaredClass}function Z(pa){return"esri.renderers.PointCloudClassBreaksRenderer"===pa.declaredClass}function X(pa){return"esri.renderers.PointCloudStretchRenderer"===
pa.declaredClass}function la(pa){return"esri.renderers.PointCloudUniqueValueRenderer"===pa.declaredClass}function ia(pa){return"esri.renderers.DotDensityRenderer"===pa.declaredClass}function ma(pa){return"esri.layers.BuildingSceneLayer"===pa.declaredClass}function na(pa){pa="authoringInfo"in pa&&(null==pa?void 0:pa.authoringInfo);return"univariate-color-size"===(null==pa?void 0:pa.type)&&"above-and-below"===(null==pa?void 0:pa.univariateTheme)}const qa=y.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),
oa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,wa=new S.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),xa={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4*1E39,3.4*1E39],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},ya=new B({size:6,outline:{color:[128,128,128,.5],width:.5}}),Da=new P({style:"solid"}),
Ea=new B({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let va={};v=function(pa){function za(a){a=pa.call(this,a)||this;a._handles=new e;a._hasColorRamp=!1;a._hasOpacityRamp=!1;a._hasSizeRamp=!1;a._webStyleSymbolCache=new Map;a._dotDensityUrlCache=new Map;a._scaleDrivenSizeVariable=null;a._hasClusterSizeVariable=!1;a.children=new E;a.layerView=null;a.layer=null;a.legendElements=[];a.parent=null;a.keepCacheOnDestroy=!1;a.respectLayerVisibility=!0;a.sublayerIds=
[];a.title=null;a.view=null;return a}N._inheritsLoose(za,pa);var da=za.prototype;da.initialize=function(){const a=()=>this.notifyChange("ready");this._handles.add([H.on(this,"children","change",q=>{const {added:A,removed:I}=q,Q=this._handles;A.map(W=>{const V=`activeLayerInfo-ready-watcher-${W.layer.uid}`;Q.add(H.init(W,"ready",a),V)});I.forEach(W=>Q.remove(W.layer.uid));a()})]);this.keepCacheOnDestroy||(va={})};da.destroy=function(){this._handles.destroy();this._scaleDrivenSizeVariable=this._dotDensityUrlCache=
this._webStyleSymbolCache=this._handles=null;this.keepCacheOnDestroy||(va=null)};da.buildLegendElementsForFeatureCollections=async function(a){a=a.map(q=>{if("esri.layers.FeatureLayer"===q.declaredClass)return this._getRendererLegendElements(q.renderer,{title:q.title});if(q.featureSet&&q.featureSet.features.length){var A=q.layerDefinition,I=A&&A.drawingInfo;I=I&&g.fromJSON(I.renderer);A=wa.read(A.geometryType);return I?this._getRendererLegendElements(I,{title:q.name,geometryType:A}):(qa.warn("drawingInfo not available!"),
null)}return null});try{const q=[];await C.eachAlways(a).then(A=>{A.forEach(({value:I})=>I&&q.push(...I))});this.legendElements=q;this.notifyChange("ready")}catch(q){qa.warn("error while building legend for layer!",q)}};da.buildLegendElementsForRenderer=async function(a){try{this.legendElements=await this._getRendererLegendElements(a),this.notifyChange("ready")}catch(q){qa.warn("error while building legend for layer!",q)}};da.buildLegendElementsForTools=async function(){const a=this.layer;"esri.layers.WMTSLayer"===
a.declaredClass?this._constructLegendElementsForWMTSlayer():"esri.layers.WMSLayer"===a.declaredClass?await this._constructLegendElementsForWMSSublayers():ma(a)?await this._constructLegendElementsForBuildingSceneLayer():"esri.layers.MapImageLayer"===a.declaredClass||"esri.layers.TileLayer"===a.declaredClass||ma(a)?await this._constructLegendElementsForSublayers():(this._handles.remove("imageryLayers-watcher"),await this._getLegendLayers().then(q=>{this.legendElements=[];q.forEach(A=>{if("esri.layers.ImageryLayer"===
a.declaredClass){const I=a.watch(["renderingRule","bandIds"],()=>{va["default"]=null;this.buildLegendElementsForTools()});this._handles.add(I,"imageryLayers-watcher")}(A=this._generateSymbolTableElementForLegendLayer(A))&&A.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(A.title=a.title),this.legendElements.push(A));this.notifyChange("ready")});this.notifyChange("ready")}).catch(q=>{qa.warn("Request to server for legend has failed!",q)}))};da._getParentLayerOpacity=function(a){let q=
1;const A=a.parent;A&&"uid"in A&&(q=this._getParentLayerOpacity(A));return a.opacity*q};da._isGroupActive=function(){const a=this.children;return a.length?a.some(q=>q.ready):!1};da._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;const q=a.minSize,A=a.maxSize;return"object"===typeof q&&q?this._isScaleDrivenSizeVariable(q):"object"===typeof A&&A?this._isScaleDrivenSizeVariable(A):!!a.expression||oa.test(a.valueExpression)};da._isLayerScaleDriven=function(a){if("minScale"in a&&
0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(A=>this._isLayerScaleDriven(A));const q=a.parent;if(!1===a.loaded&&q&&"esri.layers.MapImageLayer"===q.declaredClass&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const A of q.sourceJSON.layers)if(A.id===a.source.mapLayerId&&(0<A.minScale||0<A.maxScale))return!0;return!1};da._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");
const a=this.layer.activeLayer;this._handles.add(H.watch(this.layer,"activeLayer",()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");if(a.styleId&&a.styles){let q=null;a.styles.some(A=>a.styleId===A.id?(q=A.legendUrl,!0):!1);q&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:q,opacity:this.opacity}]}])}this.notifyChange("ready")};da._constructLegendElementsForWMSSublayers=async function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");
const a=this.layer;let q=null;if(a.customParameters||a.customLayerParameters)q={...a.customParameters,...a.customLayerParameters};this._handles.add(H.watch(this.layer,"sublayers",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,q);this.notifyChange("ready")};da._generateLegendElementsForWMSSublayers=async function(a,q){const A=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),
"wms-sublayers-watcher");a=a.toArray();for(const I of a)a=I.watch(["title","visible","legendEnabled"],()=>this._constructLegendElementsForWMSSublayers()),this._handles.add(a,"wms-sublayers-watcher"),I.visible&&I.legendEnabled&&(a=await this._generateSymbolTableElementForWMSSublayer(I,q))&&a.infos.length&&A.unshift(a);return A};da._generateSymbolTableElementForWMSSublayer=async function(a,q){return!a.legendUrl&&a.sublayers?(q=(await this._generateLegendElementsForWMSSublayers(a.sublayers,q)).filter(A=>
A),{type:"symbol-table",title:a.title,infos:q}):this._generateSymbolTableElementForLegendUrl(a,q)};da._generateSymbolTableElementForLegendUrl=async function(a,q){var A;let I=a.legendUrl;if(I){var Q={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};q&&(I+="?"+n.objectToQuery(q));q=null;a=null==(A=a.layer)?void 0:A.opacity;try{if(q=(await M(I,{responseType:"image"})).data)q.style.opacity=a}catch{}Q.infos.push({src:I,preview:q,opacity:a});return Q}};da._getLegendLayers=function(a){const q=
(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",A=va&&va[q];return A?C.resolve(A):this._legendRequest(a).then(I=>{I=I.layers;return va[q]=I})};da._legendRequest=function(a){var q=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===q.declaredClass){var A=q.exportImageServiceParameters.renderingRule;A&&(a.renderingRule=JSON.stringify(A.toJSON()));q.bandIds&&(a.bandIds=q.bandIds.join());if(q.raster||q.viewId){const {raster:I,viewId:Q}=q;a={raster:I,viewId:Q,...a}}}A=q.url.replace(/(\/)+$/,
"");"version"in q&&10.01<=q.version?(q=A.indexOf("?"),A=-1<q?A.substring(0,q)+"/legend"+A.substring(q):A+"/legend"):(q=A.toLowerCase().indexOf("/rest/"),q=A.substring(0,q)+A.substring(q+5,A.length),A="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(q)+"\x26returnbytes\x3dtrue");return M(A,{query:a}).then(I=>I.data)};da._constructLegendElementsForBuildingSceneLayer=async function(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(H.watch(a,
"sublayers",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(q){qa.warn("Request to server for legend has failed!",q)}};da._generateLegendElementsForBuildingSublayers=async function(a,q){let A=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const Q of a)if(a=
Q.watch(["renderer","opacity","title","visible"],()=>this._constructLegendElementsForBuildingSceneLayer()),this._handles.add(a,"sublayers-watcher"),Q.visible){a=Q&&null!=Q.opacity?Q.opacity:null;var I=null!=a?a*q:q;"building-group"===Q.type?(a={type:"symbol-table",title:Q.title,infos:[]},I=await this._generateLegendElementsForBuildingSublayers(Q.sublayers,I),a.infos.push(...I),A=[a,...A]):Q.renderer&&(A=[...await this._getRendererLegendElements(Q.renderer,{title:Q.title,opacity:I,sublayer:Q}),...A])}return A.filter(Q=>
!!Q&&("infos"in Q?0<Q.infos.length:!0))};da._constructLegendElementsForSublayers=async function(){this.legendElements=[];this._handles.remove("sublayers-watcher");const a=this.layer;this._handles.add(H.watch(a,"sublayers",()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(q){qa.warn("Request to server for legend has failed!",q)}};da._generateLegendElementsForSublayers=
async function(a,q,A){let I=[];this._handles.add(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();if(!A&&this.sublayerIds&&this.sublayerIds.length){const V=this.layer;a=this.sublayerIds.map(ba=>V.findSublayerById(ba)).filter(Boolean)}const Q=new b.ExportImageParameters({layer:this.layer}),W=Q.hasDynamicLayers&&Q.dynamicLayers||"default";Q.destroy();for(const V of a)if(a=V.watch("renderer, opacity, title, visible, legendEnabled",(ba,fa,ua)=>{var aa;
(ba=va&&va[W])&&!A&&(A=new Map,ba.forEach(ja=>A.set(ja.layerId,ja)));ba=null==(aa=A)?void 0:aa.get(V.id);("renderer"!==ua||2<V.originIdOf("renderer")||!ba)&&this._constructLegendElementsForSublayers()}),this._handles.add(a,"sublayers-watcher"),V.visible&&V.legendEnabled)if(a=V&&null!=V.opacity?V.opacity:null,a=null!=a?a*q:q,V.renderer&&!V.sublayers&&2<V.originIdOf("renderer")){if(!this.respectLayerVisibility||this._isSublayerInScale(V))await V.load(),I=[...await this._getRendererLegendElements(V.renderer,
{title:V.title,opacity:a,sublayer:V}),...I]}else(a=await this._generateSymbolTableElementForSublayer(V,a,A))&&I.unshift(a);return I.filter(V=>!!V&&("infos"in V?0<V.infos.length:!0))};da._generateSymbolTableElementForSublayer=async function(a,q,A){if(!A){A=new Map;var I=new b.ExportImageParameters({layer:this.layer});try{(await this._getLegendLayers(I)).forEach(Q=>A.set(Q.layerId,Q))}finally{I.destroy()}}I=A.get(a.id);return!I&&a.sublayers?(q=await this._generateLegendElementsForSublayers(a.sublayers,
q,A),{type:"symbol-table",title:a.title,infos:q}):this._generateSymbolTableElementForLegendLayer(I,a,q)};da._generateSymbolTableElementForLegendLayer=function(a,q,A){if(!a||!a.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,q))return null;var I=q&&q.renderer,Q=q&&q.title||a.layerName;I&&(I=q&&q.title||this._getRendererTitle(I,q))&&(Q&&"string"!==typeof I&&"title"in I&&(I.title=Q),Q=I);Q={type:"symbol-table",title:Q,infos:[]};a.legendType&&(Q.legendType=a.legendType);q=q?this._sanitizeLegendForSublayer(a.legend.slice(),
q):a.legend;Q.infos=q.map(W=>{let V=W.url;if(W.imageData&&0<W.imageData.length)V=`data:image/png;base64,${W.imageData}`;else if(0!==V.indexOf("http"))V=G.addTokenParameter(`${this.layer.url}/${a.layerId}/images/${V}`);else return null;return{label:W.label,src:V,opacity:null==A?this.opacity:A,width:W.width,height:W.height}}).filter(W=>!!W);return Q.infos.length?Q:null};da._isSublayerInScale=function(a){const q=a.minScale||0;a=a.maxScale||0;return 0<q&&q<this.scale||a>this.scale?!1:!0};da._isLegendLayerInScale=
function(a,q){q=q||this.layer;let A=null,I=null,Q=!0;!q.minScale&&0!==q.minScale||!q.maxScale&&0!==q.maxScale?(0===a.minScale&&q.tileInfo&&(A=q.tileInfo.lods[0].scale),0===a.maxScale&&q.tileInfo&&(I=q.tileInfo.lods[q.tileInfo.lods.length-1].scale)):(A=Math.min(q.minScale,a.minScale)||q.minScale||a.minScale,I=Math.max(q.maxScale,a.maxScale));if(0<A&&A<this.scale||I>this.scale)Q=!1;return Q};da._sanitizeLegendForSublayer=function(a,q){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;
q=q.renderer;let A=null,I=null;a.some(Q=>Q.values)&&a.some((Q,W)=>{Q.values||(A=W,I=Q,I.label||(I.label="others"));return null!=I});q?"unique-value"===q.type?I&&(a.splice(A,1),a.push(I)):"class-breaks"===q.type&&(I&&a.splice(A,1),a.reverse(),I&&a.push(I)):I&&(a.splice(A,1),a.push(I));return a};da._getRendererLegendElements=async function(a,q={}){return Y(a)||ea(a)||ca(a)||"raster-stretch"===a.type||"raster-colormap"===a.type||ha(a)||Z(a)||X(a)||la(a)||ia(a)||"vector-field"===a.type||"raster-shaded-relief"===
a.type?Z(a)||X(a)||la(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass?this._constructPointCloudRendererLegendElements(a,q):ia(a)?this._constructDotDensityRendererLegendElements(a):this._constructRendererLegendElements(a,q):(qa.warn("Renderer not supported!"),[])};da._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};da._constructPointCloudRendererLegendElements=function(a,q={}){q=q.title;const A=[];let I=null;var Q=null;if(Z(a))I={type:"symbol-table",
title:q||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(W=>{I.infos.unshift({label:W.label||W.minValue+" - "+W.maxValue,value:[W.minValue,W.maxValue],symbol:this._getAppliedCloneSymbol(ya,W.color)})});else if(X(a)){Q=a.stops;let W=null;if(Q.length&&(1===Q.length&&(W=Q[0].color),!W)){const V=Q[0].value,ba=Q[Q.length-1].value;null!=V&&null!=ba&&(W=l.getColorFromPointCloudStops(V+(ba-V)/2,Q))}I={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(ya,
W||ya.color)}]};Q=l.getRampStopsForPointCloud(a.stops);Q={type:"color-ramp",title:q||this._getPointCloudRendererTitle(a),infos:Q,preview:f.renderColorRampPreviewHTML(Q.map(V=>V.color))}}else la(a)&&(I={type:"symbol-table",title:q||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(W=>{I.infos.push({label:W.label||W.values.join(", "),value:W.values.join(", "),symbol:this._getAppliedCloneSymbol(ya,W.color)})}));I&&I.infos.length&&A.push(I);Q&&Q.infos.length&&A.push(Q);q=A.reduce((W,
V)=>W.concat(V.infos),[]).filter(W=>!!W.symbol).map(W=>this._getSymbolPreview(W,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));return C.eachAlways(q).then(()=>A)};da._getElementInfoForDotDensity=function(a,q){const {backgroundColor:A,outline:I,dotSize:Q}=a,W=Q+"-"+q+"-"+A+"-"+(I&&JSON.stringify(I.toJSON())),V=this._dotDensityUrlCache;a=V.has(W)?V.get(W):f.renderDotDensityPreviewHTML(a,q);V.set(W,a);return{opacity:1,src:a.src,preview:a,width:a.width,height:a.height}};da._constructDotDensityRendererLegendElements=
function(a){const q=a.calculateDotValue(this.view.scale),A={type:"symbol-table",title:{value:q&&Math.round(q),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(I=>{const Q=this._getElementInfoForDotDensity(a,I.color);Q.label=I.label||I.valueExpressionTitle||I.field;A.infos.push(Q)});return C.resolve([A])};da._constructRendererLegendElements=async function(a,q={}){const {title:A,sublayer:I}=q,Q=I||this.layer;a=await this._loadRenderer(a);this._hasSizeRamp=this._hasOpacityRamp=
this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const W=await this._getVisualVariableLegendElements(a,Q)||[],V={type:"symbol-table",title:A||this._getRendererTitle(a,Q),infos:[]};let ba=null,fa=!1;const ua=new Set;if(na(a)){var aa={type:"univariate-above-and-below-ramp",title:A,infos:[]},ja=W.findIndex(ka=>"color-ramp"===ka.type);ja=W.splice(ja,1)[0];var sa=W.findIndex(ka=>"size-ramp"===ka.type);sa=W.splice(sa,1)[0];ja&&(aa.title=ja.title,aa.infos.push(ja));sa&&(aa.title=sa.title,aa.infos.push(sa));
W.push(aa)}else if(ha(a))aa=x.getHeatmapRampStops(a),W.push({type:"heatmap-ramp",title:A,infos:aa,preview:f.renderColorRampPreviewHTML(aa.map(ka=>ka.color))});else if(ca(a)){if((ja=a&&a.authoringInfo)&&"relationship"===ja.type){const {focus:ka,numClasses:ta,field1:Aa,field2:Ba}=ja;if(ta&&Aa&&Ba){sa=[Aa,Ba];ja=R.getRotationAngleForFocus(ka)||0;for(aa of sa){const {field:Fa,normalizationField:Ca,label:Ga}=aa;sa=Ga||{field:this._getFieldAlias(Fa,Q),normField:Ca&&this._getFieldAlias(Ca,Q)};var ra=Ea.clone();
ra.angle=ja;V.infos.push({label:sa,symbol:ra});ua.add(ra);ja+=90}aa=R.getRelationshipRampElement({focus:ka,numClasses:ta,infos:a.uniqueValueInfos});W.unshift(aa)}}else{const ka=a.field;a.uniqueValueInfos.forEach(ta=>{ta.symbol&&V.infos.push({label:ta.label||this._getDomainName(ka,ta.value,Q)||ta.value,value:ta.value,symbol:ta.symbol})})}a.defaultSymbol&&(V.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),fa=!0)}else if(ea(a))ba=this._isUnclassedRenderer(a),ba&&this._hasSizeRamp||
(a.classBreakInfos.forEach(ka=>{ka.symbol&&V.infos.unshift({label:ka.label||(ba?null:ka.minValue+" - "+ka.maxValue),value:[ka.minValue,ka.maxValue],symbol:ka.symbol})}),ba&&(V.title=null),this._updateInfosforClassedSizeRenderer(a,V.infos)),a.defaultSymbol&&!ba&&(V.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),fa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)aa=this._constructTileImageryStretchRendererElements(a),
"stretch-ramp"===aa.type?W.push(aa):V.infos=aa;else{aa=this.layer;a.statistics&&a.statistics.length&&(ja=a.statistics[0].min||a.statistics[0][0],sa=a.statistics[0].max||a.statistics[0][1]);ra=[];ra=t.unwrap(aa.renderingRule?await aa.generateRasterInfo(aa.renderingRule):aa.serviceRasterInfo);const ka=ra.keyProperties.BandProperties;1===ra.bandCount?(ja=ja||ra.statistics&&ra.statistics[0].min,sa=sa||ra.statistics&&ra.statistics[0].max,ja||sa?W.push(this._getStretchLegendElements(a,{min:ja,max:sa})):
this.buildLegendElementsForTools()):aa.bandIds&&1===aa.bandIds.length?(ja=ja||ra.statistics&&ra.statistics[aa.bandIds[0]].min,sa=sa||ra.statistics&&ra.statistics[aa.bandIds[0]].max,ja||sa?W.push(this._getStretchLegendElements(a,{min:ja,max:sa})):this.buildLegendElementsForTools()):3<=ra.bandCount?ka&&ka.length>=ra.bandCount?aa.bandIds&&3===aa.bandIds.length?(ra=aa.bandIds.map(ta=>ka[ta].BandName),V.infos=this._createSymbolTableElementMultiBand(ra)):"lerc"===aa.format?(ra=[0,1,2].map(ta=>ka[ta].BandName),
V.infos=this._createSymbolTableElementMultiBand(ra)):this.buildLegendElementsForTools():"lerc"===aa.format?(ra=["band1","band2","band3"],V.infos=this._createSymbolTableElementMultiBand(ra)):this.buildLegendElementsForTools():this.buildLegendElementsForTools()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ka=>{V.infos.push({label:ka.label,value:ka.value,symbol:this._getAppliedCloneSymbol(Da,ka.color)})});else if(Y(a)){aa=a.symbol;switch(q.geometryType){case "point":aa="pointSymbol"in Q&&
Q.pointSymbol;break;case "polyline":aa="lineSymbol"in Q&&Q.lineSymbol;break;case "polygon":aa="polygonSymbol"in Q&&Q.polygonSymbol}a.symbol&&!this._hasSizeRamp&&V.infos.push({label:a.label,symbol:aa})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),V.title=a.attributeField,aa=a.getClassBreakInfos(),null!=aa&&aa.length?aa.forEach(ka=>{V.infos.push({label:ka.minValue+" - "+ka.maxValue,symbol:ka.symbol})}):V.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):
"raster-shaded-relief"===a.type&&W.push(this._getStretchLegendElements(a,{min:0,max:255}));aa=a.defaultSymbol;!aa||fa||Y(a)||ba&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||W.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:aa}]});V.infos.length&&W.unshift(V);const Ha=null==q.opacity?this.opacity:q.opacity,Ia=this._isTallSymbol("visualVariables"in a&&a.visualVariables),Ja="esri.layers.ImageryLayer"===this.layer.declaredClass;q=W.reduce((ka,ta)=>ka.concat(this._getAllInfos(ta)),
[]).filter(ka=>!(!ka||!ka.symbol)).map(ka=>this._getSymbolPreview(ka,Ha,{applyScaleDrivenSize:!ua.has(ka.symbol),symbolConfig:{isTall:Ia,isSquareFill:Ja}}));a=null;await C.eachAlways(q);return W};da._getAllInfos=function(a){const q=null==a?void 0:a.infos;return q?q.reduce((A,I)=>A.concat(this._getAllInfos(I)),[]):[a]};da._constructTileImageryStretchRendererElements=function(a){function q(fa){var ua;const aa=((null==A?void 0:null==(ua=A.bandIds)?void 0:ua.length)===I.bandCount?A.bandIds:Array.from(Array(Math.min(I.bandCount,
3)).keys())).map(ja=>fa&&fa[ja]&&fa[ja].BandName||"band"+(ja+1));3>aa.length?aa.push(aa[1]):3<aa.length&&aa.splice(3);return aa}const A=this.layer,I=A.rasterInfo,Q=I.bandCount||a.statistics.length;let W;var V=[];V=I.keyProperties&&I.keyProperties.BandProperties;if(a.statistics&&a.statistics.length){W=void 0!==a.statistics[0].min?a.statistics[0].min:a.statistics[0][0];var ba=a.statistics[0].max||a.statistics[0][1]}else"esri.layers.WCSLayer"===A.declaredClass&&(ba=xa[A.rasterInfo.pixelType.toLowerCase()],
W=ba[0],ba=ba[1]);if(1===I.bandCount)return this._getStretchLegendElements(a,{min:W,max:ba});V=V&&V.length>=Q?q(V):q();return this._createSymbolTableElementMultiBand(V)};da._getStretchLegendElements=function(a,q){a=l.getStrectchRampStops(a.colorRamp,q);return{type:"stretch-ramp",title:"",infos:a,preview:f.renderColorRampPreviewHTML(a.map(A=>A.color))}};da._createSymbolTableElementMultiBand=function(a){const q=[],A=["red","green","blue"];a.forEach((I,Q)=>{q.push({label:{colorName:A[Q],bandName:I},
src:K.RGB_IMG_SOURCE[Q],opacity:1})});return q};da._updateInfosforClassedSizeRenderer=function(a,q){const A=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,I=a.classBreakInfos.some(Q=>F.isVolumetricSymbol(Q.symbol));if(A&&I){const Q=U.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;const W=(Q-U.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);q.forEach((V,ba)=>{V.size=Q-W*ba})}};da._isTallSymbol=function(a){let q=!1,A=!1;if(a)for(let I=0;I<a.length&&(!q||!A);I++){const Q=a[I];"size"===Q.type&&("height"===
Q.axis&&(q=!0),"width-and-depth"===Q.axis&&(A=!0))}return q&&A};da._getSymbolPreview=async function(a,q,A){var I=null==a.size&&this._hasSizeRamp?O.px2pt(22):a.size;this._scaleDrivenSizeVariable&&null!=A&&A.applyScaleDrivenSize&&({getSize:I}=await new Promise(function(Q,W){D(["../../../renderers/visualVariables/support/visualVariableUtils"],Q,W)}),I=I(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return f.renderPreviewHTML(a.symbol,
{size:I,opacity:q,scale:!1,symbolConfig:null==A?void 0:A.symbolConfig,rotation:a.symbol.angle}).then(Q=>{a.preview=Q;return a}).catch(()=>{a.preview=null;return a})};da._loadRenderer=async function(a){var q,A;const I=[];var Q=this.layer;a=a.clone();this._hasClusterSizeVariable=!1;const W="visualVariables"in a&&(null==(q=a.visualVariables)?void 0:q.some(ba=>"size"===ba.type&&"outline"!==ba.target&&!oa.test(ba.valueExpression)));if(a&&"visualVariables"in a&&!W&&"featureReduction"in Q&&"cluster"===(null==
(A=Q.featureReduction)?void 0:A.type)&&(q=t.unwrap(z.getClusterSizeVariable(this.layerView._effectiveRenderer,this.view)))){Q=Q.featureReduction;if("clusterMinSize"in Q&&"clusterMaxSize"in Q){const {clusterMinSize:ba,clusterMaxSize:fa}=Q;q.legendOptions=new k({showLegend:ba!==fa})}a.visualVariables=(a.visualVariables||[]).concat([q]);this._hasClusterSizeVariable=!0}const V=await this._getMedianColor(a);if(ea(a)||ca(a))Q=(a.classBreakInfos||a.uniqueValueInfos).map(ba=>this._fetchSymbol(ba.symbol,V).then(fa=>
{ba.symbol=fa}).catch(()=>{ba.symbol=null})),Array.prototype.push.apply(I,Q);I.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:V).then(ba=>{this._applySymbolToRenderer(a,ba,Y(a))}).catch(()=>{this._applySymbolToRenderer(a,null,Y(a))}));return C.eachAlways(I).then(()=>a)};da._applySymbolToRenderer=function(a,q,A){A?a.symbol=q:a.defaultSymbol=q};da._getMedianColor=async function(a){if(!("visualVariables"in a&&a.visualVariables))return null;a=a.visualVariables.find(I=>"color"===
I.type);if(!a)return null;var q=null,A=null;if(a.stops){if(1===a.stops.length)return a.stops[0].color;q=a.stops[0].value;A=a.stops[a.stops.length-1].value}q+=(A-q)/2;({getColor:A}=await new Promise(function(I,Q){D(["../../../renderers/visualVariables/support/visualVariableUtils"],I,Q)}));return A(a,q)};da._fetchSymbol=function(a,q){if(!a)return C.reject();if("web-style"===a.type){var A=a.portal;A=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(A&&A.url)+"-"+(A&&A.user&&A.user.username);const I=this._webStyleSymbolCache;
I.has(A)||("2d"===this.view.type?I.set(A,a.fetchCIMSymbol()):I.set(A,a.fetchSymbol()));return I.get(A).then(Q=>this._getAppliedCloneSymbol(Q,q)).catch(()=>{qa.warn("Fetching web-style failed!");return C.reject()})}return C.resolve(this._getAppliedCloneSymbol(a,q))};da._getAppliedCloneSymbol=function(a,q){if(!a||!q)return a;a=a.clone();const A=q&&q.toRgba();-1<a.type.indexOf("3d")?this._applyColorTo3dSymbol(a,A):"cim"===a.type?u.applyCIMSymbolColor(a,q):a.color&&(a.color=new J(A||a.color));return a};
da._applyColorTo3dSymbol=function(a,q){q&&a.symbolLayers.forEach(A=>{A&&(A.material||(A.material={}),A.material.color=new J(q))})};da._getVisualVariableLegendElements=async function(a,q){if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var A=a.visualVariables,I=[];const Q=[],W=[];for(const fa of A)"color"===fa.type?I.push(fa):"size"===fa.type?Q.push(fa):"opacity"===fa.type&&W.push(fa);A=[...I,...Q,...W];let V;if(0===I.length&&ea(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ba=
(ba=a.classBreakInfos[0])&&ba.symbol;0===I.length&&Y(a)&&(ba=a.symbol);ba&&(-1<ba.type.indexOf("3d")?(I=ba.symbolLayers.getItemAt(0),"water"===I.type?t.isSome(I.color)&&(V=I.color):t.isSome(I.material)&&t.isSome(I.material.color)&&(V=I.material.color)):ba.url||(V=ba.color));return(await C.all(A.map(async fa=>{if(!fa.legendOptions||!1!==fa.legendOptions.showLegend){const aa=this._getRampTitle(fa,q);let ja=null;var ua="getField"in q&&q.getField&&q.getField(fa.field);ua=ua&&p.isDateField(ua);"color"===
fa.type?(fa=await l.getRampStops(fa,null,ua,a),ja={type:"color-ramp",title:aa,infos:fa,preview:f.renderColorRampPreviewHTML(fa.map(sa=>sa.color))},this._hasColorRamp||(this._hasColorRamp=!(null==ja.infos||!ja.infos.length))):"size"===fa.type&&"outline"!==fa.target?oa.test(fa.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=fa):(ja={type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(fa):aa,infos:await U.getRampStops(a,fa,await this._getMedianColor(a),
this.scale,this.view.type,ua)},this._hasSizeRamp||(this._hasSizeRamp=!(null==ja.infos||!ja.infos.length))):"opacity"===fa.type&&(fa=await l.getRampStops(fa,V,ua),ja={type:"opacity-ramp",title:aa,infos:fa,preview:f.renderColorRampPreviewHTML(fa.map(sa=>sa.color))},this._hasOpacityRamp||(this._hasOpacityRamp=!(null==ja.infos||!ja.infos.length)));return ja&&ja.infos?ja:null}}))).filter(fa=>!!fa)};da._getDomainName=function(a,q,A){return a&&"function"!==typeof a?(A=(a="getField"in A&&A.getField&&A.getField(a))&&
"getFieldDomain"in A&&A.getFieldDomain?A.getFieldDomain(a.name):null)&&"coded-value"===A.type?A.getName(q):null:null};da._getClusterTitle=function(a){var q=this.layer;a=a.field;if("featureReduction"in q&&q.featureReduction&&"cluster"===q.featureReduction.type&&(q=q.featureReduction,q=(q="popupTemplate"in q&&q.popupTemplate)&&q.fieldInfos))for(const A of q)if(A.fieldName===a)return"cluster_count"===a?A.label||{showCount:!0}:A.label;return{showCount:!0}};da._getRampTitle=function(a,q){let A=a.field,
I=a.normalizationField,Q=!1,W=!1,V=!1;var ba=null;A="function"===typeof A?null:A;I="function"===typeof I?null:I;ba=a.legendOptions&&a.legendOptions.title;if(null==ba)if(a.valueExpressionTitle)ba=a.valueExpressionTitle;else{if("renderer"in q&&q.renderer&&"authoringInfo"in q.renderer&&q.renderer.authoringInfo&&q.renderer.authoringInfo.visualVariables)for(a=q.renderer.authoringInfo.visualVariables,ba=0;ba<a.length;ba++){const fa=a[ba];if("color"===fa.type){if("ratio"===fa.style){Q=!0;break}if("percent"===
fa.style){W=!0;break}if("percent-of-total"===fa.style){V=!0;break}}}ba={field:A&&this._getFieldAlias(A,q),normField:I&&this._getFieldAlias(I,q),ratio:Q,ratioPercent:W,ratioPercentTotal:V}}return ba};da._getRendererTitle=function(a,q){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;let A=a.field,I=null,Q=null;ea(a)&&(I=a.normalizationField,Q="percent-of-total"===a.normalizationType);A="function"===typeof A?null:A;I="function"===
typeof I?null:I;a=null;if(A||I)a={field:A&&this._getFieldAlias(A,q),normField:I&&this._getFieldAlias(I,q),normByPct:Q};return a};da._getFieldAlias=function(a,q){var A="popupTemplate"in q&&q.popupTemplate;A=A&&A.fieldInfos;let I=null;A&&A.some(W=>a===W.fieldName?(I=W,!0):!1);A=null;"getField"in q&&q.getField?A=q.getField(a):"fieldsIndex"in q&&q.fieldsIndex&&(A=q.fieldsIndex.get(a));q=I||A;let Q=null;q&&(Q=I&&I.label||A&&A.alias||"name"in q&&q.name||"fieldName"in q&&q.fieldName);return Q};da._isUnclassedRenderer=
function(a){const q=a.visualVariables;let A=!1;ea(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&q&&(A=a.field?q.some(I=>!(!I||a.field!==I.field||(a.normalizationField||I.normalizationField)&&a.normalizationField!==I.normalizationField)):!!q.length);return A};N._createClass(za,[{key:"opacity",get:function(){var a;const q=this.layer.opacity,A=null==(a=this.parent)?void 0:a.opacity;a=(a=this.layer.parent)&&"uid"in a?this._getParentLayerOpacity(a):null;return null!=A?A*q:null!=a?a*q:q}},{key:"ready",
get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}},{key:"scale",get:function(){return this.view&&this.view.scale}},{key:"isScaleDriven",get:function(){var a=this.layer;if(null===a)return!1;if("featureReduction"in a&&a.featureReduction&&"cluster"===a.featureReduction.type)return!0;if("renderer"in a&&a.renderer){if("dot-density"===a.renderer.type)return!0;const q=a.get("renderer.valueExpression");if(oa.test(q))return!0;if(a=a.get("renderer.visualVariables"))return a.some(A=>
this._isScaleDrivenSizeVariable(A))}return this._isLayerScaleDriven(this.layer)}},{key:"version",get:function(){return this._get("version")+1}}]);return za}(w);r.__decorate([T.property()],v.prototype,"children",void 0);r.__decorate([T.property()],v.prototype,"layerView",void 0);r.__decorate([T.property()],v.prototype,"layer",void 0);r.__decorate([T.property()],v.prototype,"legendElements",void 0);r.__decorate([T.property({dependsOn:["parent","parent.opacity","layer","layer.opacity"],readOnly:!0})],
v.prototype,"opacity",null);r.__decorate([T.property()],v.prototype,"parent",void 0);r.__decorate([T.property({readOnly:!0,dependsOn:[],autoTracked:!1})],v.prototype,"ready",null);r.__decorate([T.property()],v.prototype,"keepCacheOnDestroy",void 0);r.__decorate([T.property()],v.prototype,"respectLayerVisibility",void 0);r.__decorate([T.property({dependsOn:["view.scale"],readOnly:!0})],v.prototype,"scale",null);r.__decorate([T.property()],v.prototype,"sublayerIds",void 0);r.__decorate([T.property({dependsOn:["layer.renderer?.valueExpression?",
"layer.renderer?.visualVariables?","layer.featureReduction?","scale"],readOnly:!0})],v.prototype,"isScaleDriven",null);r.__decorate([T.property()],v.prototype,"title",void 0);r.__decorate([T.property({readOnly:!0,dependsOn:["ready"],autoTracked:!1,value:0})],v.prototype,"version",null);r.__decorate([T.property()],v.prototype,"view",void 0);return v=r.__decorate([m.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],v)})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color",
"../cim/utils"],function(D,N,r){function v(d){d=r.toCIMSymbolJSON(d);if("CIMTextSymbol"===d.type)return d.height;let h=0;if(d.symbolLayers)for(const C of d.symbolLayers)r.isCIMMarker(C)&&C.size>h?h=C.size:r.isCIMStroke(C)&&C.width>h?h=C.width:r.isCIMFill(C);return h}function t(d,h,C,w){if("CIMTextSymbol"===d.type)d.height*=h;else{if(C&&d.effects)for(const E of d.effects)T(E,h);if(d.symbolLayers)for(const E of d.symbolLayers)switch(E.type){case "CIMPictureMarker":case "CIMVectorMarker":y(E,h,w);break;
case "CIMPictureStroke":case "CIMSolidStroke":null!=w&&w.preserveOutlineWidth||(E.width*=h);break;case "CIMPictureFill":E.height*=h;E.offsetX*=h;E.offsetY*=h;break;case "CIMHatchFill":t(E.lineSymbol,h,!0,{...w,preserveOutlineWidth:!1}),E.offsetX*=h,E.offsetY*=h,E.separation*=h}}}function y(d,h,C){d.markerPlacement&&L(d.markerPlacement,h);d.offsetX*=h;d.offsetY*=h;d.anchorPoint&&"Absolute"===d.anchorPointUnits&&(d.anchorPoint={x:d.anchorPoint.x*h,y:d.anchorPoint.y*h});d.size*=h;if("CIMVectorMarker"===
d.type&&d.markerGraphics)for(const w of d.markerGraphics)d.scaleSymbolsProportionally||t(w.symbol,h,!0,C)}function L(d,h){r.isCIMMarkerStrokePlacement(d)&&(d.offset*=h);switch(d.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":d.customEndingOffset*=h;d.offsetAlongLine*=h;if(d.placementTemplate&&d.placementTemplate.length){var C=d.placementTemplate.map(w=>w*h);d.placementTemplate=C}break;case "CIMMarkerPlacementAlongLineVariableSize":d.maxRandomOffset*=
h;d.placementTemplate&&d.placementTemplate.length&&(C=d.placementTemplate.map(w=>w*h),d.placementTemplate=C);break;case "CIMMarkerPlacementOnLine":d.startPointOffset*=h;break;case "CIMMarkerPlacementAtExtremities":d.offsetAlongLine*=h;break;case "CIMMarkerPlacementAtRatioPositions":d.beginPosition*=h;d.endPosition*=h;break;case "CIMMarkerPlacementPolygonCenter":d.offsetX*=h;d.offsetY*=h;break;case "CIMMarkerPlacementInsidePolygon":d.offsetX*=h,d.offsetY*=h,d.stepX*=h,d.stepY*=h}}function T(d,h){switch(d.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":d.width*=
h;break;case "CIMGeometricEffectBuffer":d.size*=h;break;case "CIMGeometricEffectCut":d.beginCut*=h;d.endCut*=h;d.middleCut*=h;break;case "CIMGeometricEffectDashes":d.customEndingOffset*=h;d.offsetAlongLine*=h;if(d.dashTemplate&&d.dashTemplate.length){const C=d.dashTemplate.map(w=>w*h);d.dashTemplate=C}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":d.length*=h;break;case "CIMGeometricEffectMove":d.offsetX*=h;d.offsetY*=h;break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":d.offset*=
h;break;case "CIMGeometricEffectRegularPolygon":d.radius*=h;break;case "CIMGeometricEffectTaperedPolygon":d.fromWidth*=h;d.length*=h;d.toWidth*=h;break;case "CIMGeometricEffectWave":d.amplitude*=h,d.period*=h}}function S(d,h){let C;C="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type;if(C.symbolLayers)for(const w of C.symbolLayers)if(!(w.colorLocked||d&&(r.isCIMStroke(w)||r.isCIMMarker(w)&&w.markerPlacement&&r.isCIMMarkerStrokePlacement(w.markerPlacement))))switch(w.type){case "CIMVectorMarker":w.markerGraphics.forEach(E=>
{S(E.symbol,h)});break;case "CIMSolidStroke":case "CIMSolidFill":m(h,w.color);break;case "CIMHatchFill":S(w.lineSymbol,h)}}function m(d,h){for(const C of d)if(C.join(".")===h.join("."))return;d.push(h)}function n(d,h){var C="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type?!0:!1;if(C.symbolLayers)for(const w of C.symbolLayers)if(!(w.colorLocked||d&&(r.isCIMStroke(w)||r.isCIMMarker(w)&&w.markerPlacement&&r.isCIMMarkerStrokePlacement(w.markerPlacement))))switch(C=h.toArray(0),w.type){case "CIMVectorMarker":w.markerGraphics.forEach(E=>
{n(E.symbol,h)});break;case "CIMSolidStroke":case "CIMSolidFill":w.color=C;break;case "CIMHatchFill":n(w.lineSymbol,h)}}D.applyCIMSymbolColor=function(d,h){h instanceof N||(h=new N(h));d=r.toCIMSymbolJSON(d);n(d,h)};D.applyCIMSymbolRotation=function(d,h){d=r.toCIMSymbolJSON(d);if("CIMTextSymbol"===d.type)d.angle=h;else if("CIMPointSymbol"===d.type&&d.symbolLayers){const C=h-(d.angle||0);for(const w of d.symbolLayers){if(r.isCIMMarker(w)){let E=w.rotation||0;E=w.rotateClockwise?E-C:E+C;w.rotation=
E}d.angle=h}}};D.getCIMSymbolColor=function(d){d=r.toCIMSymbolJSON(d);const h=[];S(d,h);return h.length?new N(r.fromCIMColor(h[0])):null};D.getCIMSymbolRotation=function(d){d=r.toCIMSymbolJSON(d);return"CIMTextSymbol"===d.type||"CIMPointSymbol"===d.type?d.angle||0:0};D.getCIMSymbolSize=v;D.scaleCIMMarker=y;D.scaleCIMSymbolTo=function(d,h,C){const w=r.toCIMSymbolJSON(d);d=v(d);if(0===d)if("CIMTextSymbol"===w.type)w.height=h;else{if(w.symbolLayers)for(const E of w.symbolLayers)switch(E.type){case "CIMPictureMarker":case "CIMVectorMarker":E.size=
h;break;case "CIMPictureStroke":case "CIMSolidStroke":E.width=h}}else t(w,h/d,!1,C)};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/cim/utils":function(){define(["exports"],function(D){function N(r,v){"string"!==typeof r&&(r=String(r));switch(v){case "LowerCase":return r.toLowerCase();case "Allcaps":return r.toUpperCase();default:return r}}D._adjustTextCase=N;D.colorToArray=function(r){return[r.r,r.g,r.b,r.a]};D.createLabelOverrideFunction=function(r,v,t){const y=m=>{let n=m.length;
for(;n--;)if(-1===" /-,\n".indexOf(m.charAt(n)))return!1;return!0},L=[];var T=0;let S=-1;do S=v.indexOf("[",T),S>=T&&(S>T&&(T=v.substr(T,S-T),L.push([T,null,y(T)])),T=S+1,S=v.indexOf("]",T),S>=T&&(S>T&&(T=v.substr(T,S-T),(T=r[T])&&L.push([null,T,!1])),T=S+1));while(-1!==S);T<v.length-1&&(r=v.substr(T),L.push([r,null,y(r)]));return m=>{let n="",d=null;for(const h of L){const [C,w,E]=h;if(C)E?d=C:(d&&(n+=d,d=null),n+=C);else{const p=m.attributes[w];p&&(d&&(n+=d,d=null),n+=p)}}return N(n,t)}};D.evaluateValueOrFunction=
function(r,v,t,y){return"function"===typeof r?r(v,t,y):r};D.fromCIMColor=function(r){return r?{r:r[0],g:r[1],b:r[2],a:r[3]/255}:{r:0,g:0,b:0,a:0}};D.isCIMFill=function(r){return"CIMGradientFill"===r.type||"CIMHatchFill"===r.type||"CIMPictureFill"===r.type||"CIMSolidFill"===r.type||"CIMWaterFill"===r.type};D.isCIMMarker=function(r){return"CIMVectorMarker"===r.type||"CIMPictureMarker"===r.type||"CIMBarChartMarker"===r.type||"CIMCharacterMarker"===r.type||"CIMPieChartMarker"===r.type||"CIMStackedBarChartMarker"===
r.type};D.isCIMMarkerStrokePlacement=function(r){return"CIMMarkerPlacementAlongLineRandomSize"===r.type||"CIMMarkerPlacementAlongLineSameSize"===r.type||"CIMMarkerPlacementAlongLineVariableSize"===r.type||"CIMMarkerPlacementAtExtremities"===r.type||"CIMMarkerPlacementAtMeasuredUnits"===r.type||"CIMMarkerPlacementAtRatioPositions"===r.type||"CIMMarkerPlacementOnLine"===r.type||"CIMMarkerPlacementOnVertices"===r.type};D.isCIMStroke=function(r){return"CIMGradientStroke"===r.type||"CIMPictureStroke"===
r.type||"CIMSolidStroke"===r.type};D.resampleHermite=function(r,v,t,y,L,T,S=!0){const m=v/L;t/=T;const n=Math.ceil(m/2),d=Math.ceil(t/2);for(let w=0;w<T;w++)for(let E=0;E<L;E++){const p=4*(E+(S?T-w-1:w)*L);var h=0;let J=0,O=0,G=0,M=0,P=0,B=0;const c=(w+.5)*t;for(let e=Math.floor(w*t);e<(w+1)*t;e++){var C=Math.abs(c-(e+.5))/d;const k=(E+.5)*m;C*=C;for(let u=Math.floor(E*m);u<(E+1)*m;u++){let F=Math.abs(k-(u+.5))/n;h=Math.sqrt(C+F*F);-1<=h&&1>=h&&(h=2*h*h*h-3*h*h+1,0<h&&(F=4*(u+e*v),B+=h*r[F+3],O+=
h,255>r[F+3]&&(h=h*r[F+3]/250),G+=h*r[F],M+=h*r[F+1],P+=h*r[F+2],J+=h))}}y[p]=G/J;y[p+1]=M/J;y[p+2]=P/J;y[p+3]=B/O}};D.toCIMSymbolJSON=function(r){var v;return null==(v=r.data)?void 0:v.symbol};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/utils":function(){define("require exports ../../core/has ../../core/maybe ../../Color ../../core/screenUtils ./Symbol3DMaterial ../../chunks/symbols ../../core/asyncUtils ../../chunks/vec3f64 ./gfxUtils".split(" "),function(D,N,r,v,t,
y,L,T,S,m,n){function d(B,c){if(null==c)return B;B=B.toRgba();B[3]*=c;return new t(B)}function h(B,c,e){if(B=B.symbolLayers){var k=u=>{u=v.isSome(u)?u:null;c=c||u||null!=e&&P;return d(c,e)};B.forEach(u=>{if("object"!==u.type||null==u.resource.href||c)if("water"===u.type)u.color=k(u.color);else{var F=v.isSome(u.material)?u.material.color:null;F=k(F);v.isNone(u.material)?u.material=new L["default"]({color:F}):u.material.color=F;null!=e&&"outline"in u&&v.isSome(u.outline)&&v.isSome(u.outline.color)&&
(u.outline.color=d(u.outline.color,e))}})}}async function C(B,c){(B=B.symbolLayers)&&await S.forEach(B,async e=>w(e,c))}async function w(B,c){switch(B.type){case "extrude":B.size="number"===typeof c[2]?c[2]:0;break;case "icon":case "line":case "text":c=E(c);v.isSome(c)&&(B.size=c);break;case "path":{const e=J(c,m.ONES,[B.width,void 0,B.height]);B.width=G(c[0],B.width,1,e);B.height=G(c[2],B.height,1,e)}break;case "object":await p(B,c)}}function E(B){for(const c of B)if("number"===typeof c)return c;
return null}async function p(B,c){const {resourceSize:e,symbolSize:k}=await O(B),u=J(c,e,k);B.width=G(c[0],k[0],e[0],u);B.depth=G(c[1],k[1],e[1],u);B.height=G(c[2],k[2],e[2],u)}function J(B,c,e){for(let k=0;3>k;k++){const u=B[k];switch(u){case "symbol-value":return null!=e[k]?e[k]/c[k]:1;case "proportional":break;default:if(u&&c[k])return u/c[k]}}return 1}async function O(B){const c=await (await new Promise(function(H,b){D(["./symbolLayerUtils"],H,b)})).computeObjectLayerResourceSize(B,10),{width:e,
height:k,depth:u}=B;B=[e,u,k];let F=1;for(var g=0;3>g;g++)if(null!=B[g]){F=B[g]/c[g];break}for(g=0;3>g;g++)null==B[g]&&(B[g]=c[g]*F);return{resourceSize:c,symbolSize:B}}function G(B,c,e,k){switch(B){case "proportional":return e*k;case "symbol-value":return null!=c?c:e;default:return B}}const M=/\/resource\/(.*?)\.svg$/,P=new t("white");N.applyColorToSymbol=function(B,c,e){if(B&&(c||null!=e))if(c&&(c=new t(c)),T.isSymbol3D(B))h(B,c,e);else if(T.isSymbol2D(B)){if(c=c||B.color)B.color=d(c,e);null!=e&&
"outline"in B&&B.outline&&B.outline.color&&(B.outline.color=d(B.outline.color,e))}};N.applyOpacityToColor=d;N.applyRotationToSymbol=function(B,c,e){B&&null!=c&&(T.isSymbol3D(B)?(B=B.symbolLayers)&&B.forEach(k=>{if(k&&"object"===k.type)switch(e){case "tilt":k.tilt=c;break;case "roll":k.roll=c;break;default:k.heading=c}}):!T.isSymbol2D(B)||"simple-marker"!==B.type&&"picture-marker"!==B.type&&"text"!==B.type||(B.angle=c))};N.applySizesToSymbol=async function(B,c){if(B&&c){if(T.isSymbol3D(B))return C(B,
c);if(T.isSymbol2D(B)&&(c=E(c),!v.isNone(c)))switch(B.type){case "simple-marker":B.size=c;break;case "picture-marker":{const e=B.width/B.height;1<e?(B.width=c,B.height=c*e):(B.width=c*e,B.height=c);break}case "simple-line":B.width=c;break;case "text":B.font.size=c}}};N.getIconHref=function(B,c){c=c.resource.href;return!r("esri-canvas-svg-support")&&B.styleOrigin&&M.test(c)?c.replace(M,"/resource/png/$1.png"):c};N.getSymbolOutlineSize=function(B){if(!B)return 0;if(T.isSymbol3D(B)){{const c=B.symbolLayers&&
B.symbolLayers.length;c?(B=B.symbolLayers.getItemAt(c-1),B="outline"in B?v.get(B,"outline","size"):void 0):B=void 0}return v.isSome(B)?B:0}return(B=n.getStroke(B))&&y.px2pt(B.width)||0};N.isVolumetricSymbol=function(B){if(!B||!B.symbolLayers)return!1;switch(B.type){case "point-3d":return B.symbolLayers.some(c=>"object"===c.type);case "line-3d":return B.symbolLayers.some(c=>"path"===c.type);case "polygon-3d":return B.symbolLayers.some(c=>"object"===c.type||"extrude"===c.type);default:return!1}};Object.defineProperty(N,
"__esModule",{value:!0})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../core/promiseUtils ../../Color ../../core/screenUtils ../../request ../../assets ../../core/ItemCache ./cimSymbolUtils".split(" "),function(D,N,r,v,t,y,L,T){function S(w){if(!w)return null;let E;switch(w.type){case "simple-fill":case "picture-fill":case "simple-marker":E=S(w.outline);break;case "simple-line":{const p=v.pt2px(w.width);"none"!==w.style&&0!==p&&(E={color:w.color,style:C(w.style),width:p,cap:w.cap,
join:"miter"===w.join?v.pt2px(w.miterLimit):w.join});break}default:E=null}return E}const m=y.getAssetUrl("esri/symbols/patterns/"),n={left:"start",center:"middle",right:"end",justify:"start"},d={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},h=new L(1E3),C=function(){const w={};return function(E){if(w[E])return w[E];const p=E.replace(/-/g,"");return w[E]=p}}();r=new r([128,128,128]);D.defaultThematicColor=r;D.getFill=function(w){const E=w.style;let p=null;
if(w)switch(w.type){case "simple-marker":"cross"!==E&&"x"!==E&&(p=w.color);break;case "simple-fill":"solid"===E?p=w.color:"none"!==E&&(p={type:"pattern",x:0,y:0,src:m+E+".png",width:5,height:5});break;case "picture-fill":p={type:"pattern",src:w.url,width:v.pt2px(w.width)*w.xscale,height:v.pt2px(w.height)*w.yscale,x:v.pt2px(w.xoffset),y:v.pt2px(w.yoffset)};break;case "text":p=w.color;break;case "cim":p=T.getCIMSymbolColor(w)}return p};D.getPatternUrlWithColor=function(w,E){const p=w+"-"+E;return void 0!==
h.get(p)?N.resolve(h.get(p)):t(w,{responseType:"image"}).then(J=>{J=J.data;const O=J.naturalWidth,G=J.naturalHeight,M=document.createElement("canvas");M.width=O;M.height=G;const P=M.getContext("2d");P.fillStyle=E;P.fillRect(0,0,O,G);P.globalCompositeOperation="destination-in";P.drawImage(J,0,0);J=M.toDataURL();h.put(p,J);return J})};D.getSVGAlign=function(w){return w=(w=w.horizontalAlignment)&&n[w.toLowerCase()]||"middle"};D.getSVGBaseline=function(w){return(w=w.verticalAlignment)&&d[w.toLowerCase()]||
"alphabetic"};D.getSVGBaselineShift=function(w){return"bottom"===w.verticalAlignment?"super":null};D.getStroke=S;Object.defineProperty(D,"__esModule",{value:!0})})},"esri/core/ItemCache":function(){define(["./MemCache"],function(D){return function(){function N(v,t){this._storage=new D.MemCacheStorage;this._storage.maxSize=v;t&&this._storage.registerRemoveFunc("",t)}var r=N.prototype;r.put=function(v,t){this._storage.put(v,t,1,1)};r.pop=function(v){return this._storage.pop(v)};r.get=function(v){return this._storage.get(v)};
r.clear=function(){this._storage.clearAll()};r.destroy=function(){this._storage.clearAll()};return N}()})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ./commonProperties ../../core/HandleOwner ./sublayerUtils ../../views/View".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p){const J={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};D.ExportImageParameters=function(O){function G(){var P=O.apply(this,arguments)||this;P._scale=null;P.view=null;return P}N._inheritsLoose(G,O);var M=G.prototype;M.destroy=function(){this.layer=
this.view=null};M.toJSON=function(){var P=this.layer;P={dpi:P.dpi,format:P.imageFormat,transparent:P.imageTransparency,gdbVersion:P.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?P.dynamicLayers=this.dynamicLayers:P={...P,layers:this.layers,layerDefs:this.layerDefs};return P};N._createClass(G,[{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;const P=this.visibleSublayers.map(B=>B.toExportImageJSON());return P.length?JSON.stringify(P):null}},{key:"hasDynamicLayers",
get:function(){return this.layer&&E.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(P){this._get("layer")!==P&&(this._set("layer",P),this.handles.remove("layer"),P&&this.handles.add([P.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),P.on("sublayer-update",B=>this.notifyChange(J[B.propertyName]))],"layer"))}},{key:"layers",get:function(){const P=this.visibleSublayers;return P?P.length?"show:"+P.map(B=>B.id).join(","):"show:-1":
null}},{key:"layerDefs",get:function(){const P=this.visibleSublayers.filter(B=>null!=B.definitionExpression);return P.length?JSON.stringify(P.reduce((B,c)=>{B[c.id]=c.definitionExpression;return B},{})):null}},{key:"scale",get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(P){this.view||(this._scale=P,this.notifyChange("scale"))}},{key:"version",get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;const P=this.layer;P&&(P.dpi,P.imageFormat,
P.imageTransparency,P.gdbVersion);return(this._get("version")||0)+1},set:function(P){this._set("version",P)}},{key:"visibleSublayers",get:function(){const P=[];if(!this.layer)return P;var B=this.layer.sublayers;const c=e=>{const k=this.scale,u=0===e.minScale||k<=e.minScale,F=0===e.maxScale||k>=e.maxScale;e.visible&&(0===k||u&&F)&&(e.sublayers?e.sublayers.forEach(c):P.unshift(e))};B&&B.forEach(c);B=this._get("visibleSublayers");return!B||B.length!==P.length||B.some((e,k)=>P[k]!==e)?P:B}}]);return G}(w.HandleOwnerMixin(h));
r.__decorate([L.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],D.ExportImageParameters.prototype,"dynamicLayers",null);r.__decorate([L.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],D.ExportImageParameters.prototype,"hasDynamicLayers",null);r.__decorate([L.property()],D.ExportImageParameters.prototype,"layer",null);r.__decorate([L.property({readOnly:!0,dependsOn:["visibleSublayers"]})],D.ExportImageParameters.prototype,
"layers",null);r.__decorate([L.property({readOnly:!0,dependsOn:["visibleSublayers"]})],D.ExportImageParameters.prototype,"layerDefs",null);r.__decorate([L.property({type:Number,dependsOn:["view.scale"]})],D.ExportImageParameters.prototype,"scale",null);r.__decorate([L.property(C.combinedViewLayerTimeExtentProperty)],D.ExportImageParameters.prototype,"timeExtent",void 0);r.__decorate([L.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],
D.ExportImageParameters.prototype,"version",null);r.__decorate([L.property({type:p})],D.ExportImageParameters.prototype,"view",void 0);r.__decorate([L.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],D.ExportImageParameters.prototype,"visibleSublayers",null);D.ExportImageParameters=r.__decorate([S.subclass("esri.layers.mixins.ExportImageParameters")],D.ExportImageParameters);Object.defineProperty(D,"__esModule",{value:!0})})},"esri/layers/support/sublayerUtils":function(){define(["exports"],
function(D){function N(r,v){if(!r||!r.length)return!0;v=v.slice().reverse().flatten(({sublayers:L})=>L&&L.toArray().reverse()).map(L=>L.id).toArray();if(r.length>v.length)return!1;let t=0;const y=v.length;for(const {id:L}of r){for(;t<y&&v[t]!==L;)t++;if(t>=y)return!1}return!0}D.isExportDynamic=function(r,v,t){return r.some(y=>{const L=y.source;return!(!L||"map-layer"===L.type&&L.mapLayerId===y.id&&(!L.gdbVersion||L.gdbVersion===t.gdbVersion))||2<y.originIdOf("renderer")||2<y.originIdOf("labelingInfo")||
2<y.originIdOf("opacity")||2<y.originIdOf("labelsVisible")})?!0:!N(r,v)};D.isSublayerOverhaul=function(r){return!!r&&r.some(v=>null!=v.minScale||v.layerDefinition&&null!=v.layerDefinition.minScale)};D.shouldWriteSublayerStructure=function(r,v,t){return v.flatten(({sublayers:y})=>y).length!==r.length||r.some(y=>y.originIdOf("minScale")>t||y.originIdOf("maxScale")>t||y.originIdOf("renderer")>t||y.originIdOf("labelingInfo")>t||y.originIdOf("opacity")>t||y.originIdOf("labelsVisible")>t||y.originIdOf("source")>
t)?!0:!N(r,v)};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../core/maybe ../../support/arcadeOnDemand ./utils".split(" "),function(D,N,r,v,t,y){async function L(m,n){switch(m.type){case "web-style":var {previewWebStyleSymbol:d}=await new Promise(function(h,C){D(["./previewWebStyleSymbol"],h,C)});return d(m,L,n);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:d}=
await new Promise(function(h,C){D(["./previewSymbol3D"],h,C)}),d(m,n);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:d}=await new Promise(function(h,C){D(["./previewSymbol2D"],h,C)}),d(m,n);case "cim":return{previewCIMSymbol:d}=await new Promise(function(h,C){D(["./previewCIMSymbol"],h,C)}),d(m,n)}}function T(m){return m&&"opacity"in m?m.opacity*T(m.parent):1}let S=null;N.getDisplayedSymbol=async function(m,n){if(m){var d=
T(m.layer||m.sourceLayer);if(v.isSome(m.symbol)&&(!v.isSome(n)||!0!==n.ignoreGraphicSymbol))return m="web-style"===m.symbol.type?await m.symbol.fetchSymbol(v.isSome(n)?n.abortOptions:null):m.symbol.clone(),y.applyColorToSymbol(m,null,d),m;var h=v.isSome(n)&&n.renderer||m.get("layer.renderer")||m.get("sourceLayer.renderer"),C=await h.getSymbolAsync(m);if(C){C="web-style"===C.type?await C.fetchSymbol(v.isSome(n)?n.abortOptions:null):C.clone();if(!("visualVariables"in h)||"visualVariables"in h&&!h.visualVariables||
"visualVariables"in h&&h.visualVariables&&!h.visualVariables.length)return C;h.arcadeRequiredForVisualVariables&&(v.isNone(n)||v.isNone(n.arcade))&&(n={...v.unwrap(n)},n.arcade=await t.loadArcade());var w=await new Promise(function(G,M){D(["../../renderers/visualVariables/support/visualVariableUtils"],G,M)}),E=[],p=[],J=[],O=[];for(const G of h.visualVariables)switch(G.type){case "color":E.push(G);break;case "opacity":p.push(G);break;case "rotation":O.push(G);break;case "size":G.target||J.push(G)}h=
(h=!!E.length&&E[E.length-1])?w.getColor(h,m,n):null;p=(p=!!p.length&&p[p.length-1])?w.getOpacity(p,m,n):null;null!=d&&(p=null!=p?p*d:d);y.applyColorToSymbol(C,h,p);J.length&&(d=w.getAllSizes(J,m,n),await y.applySizesToSymbol(C,d));for(const G of O)y.applyRotationToSymbol(C,w.getRotationAngle(G,m,n),G.axis);return C}}};N.renderColorRampPreviewHTML=function(m,n={}){const d="horizontal"===n.align,{width:h=d?75:24,height:C=d?24:75,gradient:w=!0}=n;n=window.devicePixelRatio;var E=h*n,p=C*n;n=document.createElement("canvas");
n.width=E;n.height=p;n.style.width=`${h}px`;n.style.height=`${C}px`;const J=n.getContext("2d");var O=d?E:0,G=d?0:p;if(w){const M=J.createLinearGradient(0,0,O,G),P=1/(m.length-1);m.forEach((B,c)=>M.addColorStop(c*P,B.toString()));J.fillStyle=M;J.fillRect(0,0,E,p)}else{E=d?E/m.length:E;p=d?p:p/m.length;G=O=0;for(const M of m)J.fillStyle=M.toString(),J.fillRect(O,G,E,p),O=d?O+E:0,G=d?0:G+p}m=document.createElement("div");m.style.width=`${h}px`;m.style.height=`${C}px`;m.appendChild(n);return m};N.renderDotDensityPreviewHTML=
function(m,n,d){const {backgroundColor:h,outline:C,dotSize:w}=m;d=d&&d.swatchSize||22;const E=Math.round(d*d/Math.pow(w,2)*.8),p=window.devicePixelRatio;m=document.createElement("canvas");const J=d*p;m.width=J;m.height=J;m.style.width=`${m.width/p}px`;m.style.height=`${m.height/p}px`;const O=m.getContext("2d");h&&(O.fillStyle=h.toCss(!0),O.fillRect(0,0,J,J),O.fill());O.fillStyle=n.toCss(!0);if(S&&S.length/2===E)for(n=0;n<2*E;n+=2)O.fillRect(S[n],S[n+1],w*p,w*p),O.fill();else for(S=[],n=0;n<2*E;n+=
2){const G=Math.floor(Math.random()*(J-0+1)),M=Math.floor(Math.random()*(J-0+1));S.push(G,M);O.fillRect(G,M,w*p,w*p);O.fill()}C&&(C.color&&(O.strokeStyle=C.color.toCss(!0)),O.lineWidth=C.width,O.strokeRect(0,0,J,J));d=new Image(d,d);d.src=m.toDataURL();return d};N.renderPreviewHTML=L;Object.defineProperty(N,"__esModule",{value:!0})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(D,N){const r=(v,t)=>{v=v.featuresTilingScheme.getClosestInfoForScale(v.scale).level;
return t.levels?t.levels[v]:null};D.getClusterSizeVariable=function(v,t){if(!(v&&"visualVariables"in v&&v.visualVariables))return null;v=v.visualVariables.find(y=>"size"===y.type);return(t=r(t,v))?new N({field:v.field,minSize:t[2].size,minDataValue:t[2].value,maxSize:t[3].size,maxDataValue:t[3].value}):null};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/widgets/Legend/support/utils":function(){define(["exports","../../../intl/date","../../../renderers/support/numberUtils"],function(D,
N,r){const v=N.convertDateFormatToIntlOptions("short-date");D.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
D.createStopLabel=function(t,y,L,T){let S="";0===y?S="\x3c ":y===L&&(S="\x3e ");y=null;y=T?N.formatDate(t,v):r.format(t);return S+y};D.getUnivariateAboveAndBelowStopValues=function(t,y){const {min:L,max:T}=(null==y?void 0:y.statistics)||{};var S=t.stops.map(E=>E.value);const [m,n,d,h,C]=S;t=null!=L?m<L:!1;y=null!=T?C>T:!1;if(null==L||null==T||!t&&!y)return S;S=t?L:m;const w=y?T:C;return r.round([S,t?S+(d-S)/2:n,d,y?d+(w-d)/2:h,w],{strictBounds:!0})};Object.defineProperty(D,"__esModule",{value:!0})})},
"esri/renderers/support/numberUtils":function(){define(["exports","../../intl/number","../../intl"],function(D,N,r){function v(n,d){return n-d}function t(n,d){let h;h=Number(n.toFixed(d));h<n?n=h+1/Math.pow(10,d):(n=h,h-=1/Math.pow(10,d));h=Number(h.toFixed(d));n=Number(n.toFixed(d));return[h,n]}function y(n,d,h,C,w){n=T(n,d,h,C);d=null==n.next||n.next<=w;return(null==n.previous||n.previous<=w)&&d||n.previous+n.next<=2*w}function L(n){n=String(n);var d=n.match(S);if(d&&d[1])return{integer:d[1].split("").length,
fractional:d[3]?d[3].split("").length:0};if(-1<n.toLowerCase().indexOf("e")&&(d=n.split("e"),n=d[0],d=d[1],n&&d)){n=Number(n);d=Number(d);const h=0<d;h||(d=Math.abs(d));n=L(n);h?(n.integer+=d,n.fractional=d>n.fractional?0:n.fractional-d):(n.fractional+=d,n.integer=d>n.integer?1:n.integer-d);return n}return{integer:0,fractional:0}}function T(n,d,h,C){const w={previous:null,next:null};if(null!=h){const E=n-h;w.previous=Math.floor(Math.abs(100*(d-h-E)/E))}null!=C&&(n=C-n,w.next=Math.floor(Math.abs(100*
(C-d-n)/n)));return w}const S=/^-?(\d+)(\.(\d+))?$/i,m={maximumFractionDigits:20};D.format=function(n){return N.formatNumber(n,m)};D.numDigits=L;D.percentChange=T;D.round=function(n,d={}){n=n.slice(0);const {tolerance:h=2,strictBounds:C=!1,indexes:w=n.map((p,J)=>J)}=d;w.sort(v);for(d=0;d<w.length;d++){const p=w[d],J=n[p],O=0===p?null:n[p-1],G=p===n.length-1?null:n[p+1],M=L(J).fractional;if(M){let P=0,B=!1;for(var E=void 0;P<=M&&!B;)E=t(J,P),E=C&&0===d?E[1]:E[0],B=y(J,E,O,G,h),P++;B&&(n[p]=E)}}return n};
Object.defineProperty(D,"__esModule",{value:!0})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../core/promiseUtils","../../../Color","./utils"],function(D,N,r,v,t){function y(n,d){const h=[],C=n.length-1;5===n.length?h.push(0,2,4):h.push(0,C);return n.map((w,E)=>-1<h.indexOf(E)?t.createStopLabel(w,E,C,d):null)}async function L(n,d,h=m){h=new v(h);n=(await new Promise(function(C,w){D(["../../../renderers/visualVariables/support/visualVariableUtils"],
C,w)})).getOpacity(d,n);null!=n&&(h.a=n);return h}function T(n,d){const {startIndex:h,endIndex:C,weight:w}=S(n,d);if(h===C)return d[h].color;n=v.blendColors(d[h].color,d[C].color,w);return new v(n)}function S(n,d){let h=0,C=d.length-1;d.some((w,E)=>{if(n<w.value)return C=E,!0;h=E;return!1});return{startIndex:h,endIndex:C,weight:(n-d[h].value)/(d[C].value-d[h].value)}}const m=new v([64,64,64]);N.getColorFromPointCloudStops=T;N.getRampStops=async function(n,d,h,C){let w=!1;var E=[];let p=[];n.stops&&
(E=null==C?void 0:C.authoringInfo,C=n.stops,E="univariate-color-size"===(null==E?void 0:E.type)&&"above-and-below"===(null==E?void 0:E.univariateTheme)&&"color"===n.type?t.getUnivariateAboveAndBelowStopValues(n,E):C.map(O=>O.value),(w=C.some(O=>!!O.label))&&(p=C.map(O=>O.label)));C=E[E.length-1];if(null==E[0]&&null==C)return null;const J=w?null:y(E,h);return(await r.all(E.map(async(O,G)=>{const M="opacity"===n.type?await L(O,n,d):(await new Promise(function(P,B){D(["../../../renderers/visualVariables/support/visualVariableUtils"],
P,B)})).getColor(n,O);return{value:O,color:M,label:w?p[G]:J[G]}}))).reverse()};N.getRampStopsForPointCloud=function(n){let d=!1,h=[],C=[];h=n.map(p=>p.value);(d=n.some(p=>!!p.label))&&(C=n.map(p=>p.label));const w=h[h.length-1];if(null==h[0]&&null==w)return null;const E=d?null:y(h,!1);return h.map((p,J)=>{const O=T(p,n);return{value:p,color:O,label:d?C[J]:E[J]}}).reverse()};N.getStrectchRampStops=function(n,d){let h=[];if(n&&"multipart"===n.type)n.colorRamps.reverse().forEach(function(C,w){0===w?
h.push({value:d.max,color:new v(C.toColor),label:"high"}):h.push({value:null,color:new v(C.toColor),label:""});w===n.colorRamps.length-1?h.push({value:d.min,color:new v(C.fromColor),label:"low"}):h.push({value:null,color:new v(C.fromColor),label:""})});else{let C,w;n&&"algorithmic"===n.type?(C=n.fromColor,w=n.toColor):(C=[0,0,0,1],w=[255,255,255,1]);h=[{value:d.max,color:new v(w),label:"high"},{value:d.min,color:new v(C),label:"low"}]}return h};Object.defineProperty(N,"__esModule",{value:!0})})},
"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(D,N){D.getHeatmapRampStops=function(r){r=r.colorStops;let v=r.length-1;if(r&&r[0]){const t=r[v];t&&1!==t.ratio&&(r=r.slice(0),r.push(new N({ratio:1,color:t.color})),v++)}return r.map((t,y)=>{let L="";0===y?L="low":y===v&&(L="high");return{color:t.color,label:L,ratio:t.ratio}}).reverse()};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports",
"../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(D,N,r){function v(S){if(S){var {type:m}=S;return-1<m.indexOf("3d")?r.getSymbolLayerFill(S.symbolLayers.getItemAt(0)):"simple-line"===m||"simple-marker"===S.type&&("x"===S.style||"cross"===S.style)?(S=N.getStroke(S))&&S.color:N.getFill(S)}}function t(S,m){const n=m.HH.label,d=m.LL.label,h=m.HL.label;m=m.LH.label;switch(S){case "HH":return{top:n,bottom:d,left:h,right:m};case "HL":return{top:h,bottom:m,left:d,right:n};
case "LL":return{top:d,bottom:n,left:m,right:h};case "LH":return{top:m,bottom:h,left:n,right:d};default:return{top:n,bottom:d,left:h,right:m}}}function y(S){let m=L[S];S&&null==m&&(m=L.HH);return m||0}const L={HH:315,HL:45,LL:135,LH:225},T={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};D.getRelationshipRampElement=function(S){const {focus:m,infos:n,numClasses:d}=
S;var h=T[d];const C={};n.forEach(w=>{C[w.value]={label:w.label,fill:v(w.symbol)}});S=[];for(let w=0;w<d;w++){const E=[];for(let p=0;p<d;p++)E.push(C[h[w][p]].fill);S.push(E)}h=t(m,C);return{type:"relationship-ramp",numClasses:d,focus:m,colors:S,labels:h,rotation:y(m)}};D.getRotationAngleForFocus=y;Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../core/has ../../core/maybe ../../core/Logger ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./IconSymbol3DLayerResource ../../assets ./ObjectSymbol3DLayerResource ../../core/colorUtils ./styleUtils ./gfxUtils ./utils ./previewUtils ./renderUtils".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E){function p(l){const x=l.outline;var R=r.isSome(l.material)?l.material.color:null;R=r.isSome(R)?R.toRgba().toString():null;if(r.isNone(x))return"fill"===l.type&&"255,255,255,1"===R?{color:"#bdc3c7",width:.75}:null;l=L.pt2px(x.size)||0;return{color:"rgba("+(r.isSome(x.color)?x.color.toRgba():"255,255,255,1")+")",width:Math.min(l,80)}}function J(l,x){var R=x&&x.resource;R=R&&R.href;return l.thumbnail&&l.thumbnail.url?y.resolve(l.thumbnail.url):R&&"object"!==
x.type?y.resolve(C.getIconHref(l,x)):l.styleOrigin&&(l.styleOrigin.styleName||l.styleOrigin.styleUrl)?d.resolveWebStyleSymbol(l.styleOrigin,{portal:l.styleOrigin.portal},"webRef").catch(U=>U).then(U=>U&&U.thumbnail&&U.thumbnail.url||z):y.resolve(z)}function O(l,x=1){const R=l.a;l=n.toHSV(l);const {r:U,g:Y,b:ea}=n.toRGB({h:l.h,s:l.s/x,v:100-(100-l.v)/x});return[U,Y,ea,R]}function G(l){return"water"===l.type?r.isNone(l.color)?null:l.color:r.isNone(l.material)||r.isNone(l.material.color)?null:l.material.color}
function M(l,x=0){l=G(l);if(!l)return x=w.adjustColorComponentBrightness(h.defaultThematicColor.r,x),[x,x,x,100];l=l.toRgba();for(let R=0;3>R;R++)l[R]=w.adjustColorComponentBrightness(l[R],x);return l}async function P(l,x){l=l.style;return"none"===l?null:{type:"pattern",x:0,y:0,src:await h.getPatternUrlWithColor(`${f}${l}.png`,x.toCss(!0)),width:5,height:5}}function B(l){return l.outline?p(l):{color:"rgba(0, 0, 0, 1)",width:1.5}}function c(l,x){l=G(l);if(!l)return null;let R;R="rgba("+(w.adjustColorComponentBrightness(l.r,
x)+",");R+=w.adjustColorComponentBrightness(l.g,x)+",";R+=w.adjustColorComponentBrightness(l.b,x)+",";return R+l.a+");"}function e(l,x){x=c(l,x);if(!x)return{};l=Math.min(l.size?L.pt2px(l.size):.75,80);return{color:x,width:l}}function k(l,x,R){R*=.75;return{type:"linear",x1:R?.25*R:0,y1:R?.5*R:0,x2:R||4,y2:R?.5*R:4,colors:[{color:l,offset:0},{color:x,offset:1}]}}function u(l){const x=l.depth,R=l.height;return(l=l.width)&&x&&R&&l===x&&l<R}function F(l,x,R){const U=[];if(!l)return U;switch(l.type){case "icon":switch(l.resource&&
l.resource.primitive||T.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*x},fill:M(l,0),stroke:p(l)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[0,0]},{command:"L",values:[x,0]},{command:"L",values:[x,x]},{command:"Z",values:[]}]},fill:M(l,0),stroke:p(l)});break;case "triangle":U.push({shape:{type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[.5*x,0]},{command:"L",values:[x,x]},{command:"Z",values:[]}]},
fill:M(l,0),stroke:p(l)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*x,0]},{command:"L",values:[.5*x,x]},{command:"M",values:[0,.5*x]},{command:"L",values:[x,.5*x]}]},stroke:B(l)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[x,x]},{command:"M",values:[x,0]},{command:"L",values:[0,x]}]},stroke:B(l)});break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*x,0]},{command:"L",
values:[x,.5*x]},{command:"L",values:[.5*x,x]},{command:"Z",values:[]}]},fill:M(l,0),stroke:p(l)})}break;case "object":switch(l.resource&&l.resource.primitive||m.defaultPrimitive){case "cone":var Y=M(l,0);l=M(l,-.6);l=k(Y,l,R?20:x);x=w.getConeShapes(x,R);U.push({shape:x[0],fill:l});U.push({shape:x[1],fill:l});break;case "inverted-cone":R=M(l,0);l=M(l,-.6);l=k(R,l,x);x=w.getInvertedConeShapes(x);U.push({shape:x[0],fill:l});U.push({shape:x[1],fill:R});break;case "cube":x=w.getCubeShapes(x,R);U.push({shape:x[0],
fill:M(l,0)});U.push({shape:x[1],fill:M(l,-.3)});U.push({shape:x[2],fill:M(l,-.5)});break;case "cylinder":{Y=M(l,0);const ea=M(l,-.6);Y=k(Y,ea,R?20:x);x=w.getCylinderShapes(x,R);U.push({shape:x[0],fill:Y});U.push({shape:x[1],fill:Y});U.push({shape:x[2],fill:M(l,0)});break}case "diamond":x=w.getDiamondShapes(x);U.push({shape:x[0],fill:M(l,-.3)});U.push({shape:x[1],fill:M(l,0)});U.push({shape:x[2],fill:M(l,-.3)});U.push({shape:x[3],fill:M(l,-.7)});break;case "sphere":R=M(l,0);l=M(l,-.6);l=k(R,l);l.x1=
0;l.y1=0;l.x2=.25*x;l.y2=.25*x;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*x},fill:l});break;case "tetrahedron":x=w.getTetrahedronShapes(x),U.push({shape:x[0],fill:M(l,-.3)}),U.push({shape:x[1],fill:M(l,0)}),U.push({shape:x[2],fill:M(l,-.6)})}}return U}function g(l,x){const R=x&&x.size?L.pt2px(x.size):null,U=x&&x.maxSize?L.pt2px(x.maxSize):null,Y=x&&x.disableUpsampling,ea=l.symbolLayers,ca=[];let ha=0,Z=0;const X=ea.getItemAt(ea.length-1);let la;X&&"icon"===X.type&&(la=X.size&&L.pt2px(X.size));ea.forEach(ia=>
{if("icon"===ia.type||"object"===ia.type){var ma="icon"===ia.type?ia.size&&L.pt2px(ia.size):0,na=R||ma?Math.ceil(Math.min(R||ma,U||120)):22;if(ia&&ia.resource&&ia.resource.href){var qa=J(l,ia).then(function(oa){const wa=ia.get("material.color");var xa="icon"===ia.type?"multiply":"tint";return E.tintImageWithColor(oa,na,wa,xa,Y)}).then(function(oa){const wa=oa.width,xa=oa.height;ha=Math.max(ha,wa);Z=Math.max(Z,xa);return[{shape:{type:"image",x:0,y:0,width:wa,height:xa,src:oa.url},fill:null,stroke:null}]});
ca.push(qa)}else{let oa=na;"icon"===ia.type&&la&&R&&(oa=ma/la*na);ma="tall"===(null==x?void 0:x.symbolConfig)||(null==x?void 0:null==(qa=x.symbolConfig)?void 0:qa.isTall)||("object"===ia.type?u(ia):!1);ha=Math.max(ha,ma?20:oa);Z=Math.max(Z,oa);ca.push(y.resolve(F(ia,oa,ma)))}}});return y.eachAlways(ca).then(function(ia){const ma=[];ia.forEach(function(na){na.value?ma.push(na.value):na.error&&K.warn("error while building swatchInfo!",na.error)});return E.renderSymbol(ma,[ha,Z],{node:x&&x.node,scale:!1,
opacity:x&&x.opacity})})}function H(l,x){const R=l.symbolLayers,U=[];l=C.isVolumetricSymbol(l);const Y=x&&x.size?L.pt2px(x.size):null,ea=(x&&x.maxSize?L.pt2px(x.maxSize):null)||80;let ca=0,ha=0,Z;R.forEach((X,la)=>{if(X&&("line"===X.type||"path"===X.type)){var ia=[];switch(X.type){case "line":var ma=e(X,0),na=ma&&ma.width||0;0===la&&(Z=na);X=Math.min(Y||na,ea);la=0===la?X:Y?na/Z*X:X;na=20<la?2*la:40;ha=Math.max(ha,la);ca=Math.max(ca,na);ma.width=la;ia.push({shape:{type:"path",path:[{command:"M",values:[0,
.5*ha]},{command:"L",values:[ca,.5*ha]}]},stroke:ma});break;case "path":ma=Math.min(Y||22,ea);la=M(X,0);na=M(X,-.2);var qa=c(X,-.4);qa=qa?{color:qa,width:1}:{};if("quad"===X.profile){const oa=X.width||X.size;X=X.height||X.size;X=w.getPathSymbolShapes(oa&&X?oa/X:1);qa={...qa,join:"bevel"};ia.push({shape:X[0],fill:na,stroke:qa});ia.push({shape:X[1],fill:na,stroke:qa});ia.push({shape:X[2],fill:la,stroke:qa})}else ia.push({shape:w.shapes.pathSymbol3DLayer[0],fill:na,stroke:qa}),ia.push({shape:w.shapes.pathSymbol3DLayer[1],
fill:la,stroke:qa});ca=ha=Math.max(ha,ma)}U.push(ia)}});return y.resolve(E.renderSymbol(U,[ca,ha],{node:x&&x.node,scale:l,opacity:x&&x.opacity}))}async function b(l,x){const R="mesh-3d"===l.type;l=l.symbolLayers;var U=x&&x.size?L.pt2px(x.size):null;const Y=x&&x.maxSize?L.pt2px(x.maxSize):null;U=U||22;const ea=[];let ca=0,ha=0;var Z=!1;for(let qa=0;qa<l.length;qa++){var X=l.getItemAt(qa);const oa=[];if(!R||"fill"===X.type){var la=w.shapes.fill[0];switch(X.type){case "fill":var ia=p(X);Z=Math.min(U,
Y||120);ca=Math.max(ca,Z);ha=Math.max(ha,Z);Z=!0;var ma=M(X,0),na="pattern"in X&&X.pattern;X=G(X);!R&&r.isSome(na)&&"style"===na.type&&"solid"!==na.style&&X&&(ma=await P(na,X));oa.push({shape:la,fill:ma,stroke:ia});break;case "line":X={stroke:e(X,0),shape:la};ca=Math.max(ca,22);ha=Math.max(ha,22);oa.push(X);break;case "extrude":la={join:"round",...e(X,-.4)};ia=M(X,0);X=M(X,-.2);ma=Math.min(U,Y||120);na=w.getExtrudeSymbolShapes(ma);la.width=1;oa.push({shape:na[0],fill:X,stroke:la});oa.push({shape:na[1],
fill:X,stroke:la});oa.push({shape:na[2],fill:ia,stroke:la});X=22*.7+.5*ma;ca=Math.max(ca,22);ha=Math.max(ha,X);break;case "water":Z=G(X),X=O(Z),la=O(Z,2),ia=O(Z,3),ma=w.getWaterSymbolShapes(),Z=!0,oa.push({shape:ma[0],fill:X}),oa.push({shape:ma[1],fill:la}),oa.push({shape:ma[2],fill:ia}),X=Math.min(U,Y||120),ca=Math.max(ca,X),ha=Math.max(ha,X)}ea.push(oa)}}return y.resolve(E.renderSymbol(ea,[ca,ha],{node:x&&x.node,scale:Z,opacity:x&&x.opacity}))}const f=S.getAssetUrl("esri/symbols/patterns/"),z=S.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png"),
K=v.getLogger("esri.symbols.support.previewSymbol3D");D.getPatternDescriptor=P;D.getSymbolLayerFill=M;D.previewSymbol3D=function(l,x){if(0===l.symbolLayers.length)return y.reject(new t("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));let R=null;switch(l.type){case "point-3d":R=g(l,x);break;case "line-3d":R=H(l,x);break;case "polygon-3d":case "mesh-3d":R=b(l,x)}return R?R:y.reject(new t("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(D,"__esModule",
{value:!0})})},"esri/core/colorUtils":function(){define(["exports"],function(D){function N(m,n){const d=[];let h,C;if(m[0].length!==n.length)throw"dimensions do not match";const w=m.length,E=m[0].length;let p=0;for(h=0;h<w;h++){for(C=p=0;C<E;C++)p+=m[h][C]*n[C];d.push(p)}return d}function r(m){m=[m.r/255,m.g/255,m.b/255].map(n=>.04045>=n?n/12.92:Math.pow((n+.055)/1.055,2.4));m=N(T,m);return{x:100*m[0],y:100*m[1],z:100*m[2]}}function v(m){m=N(S,[m.x/100,m.y/100,m.z/100]).map(n=>Math.min(1,Math.max(.0031308>=
n?12.92*n:1.055*Math.pow(n,1/2.4)-.055,0)));return{r:Math.round(255*m[0]),g:Math.round(255*m[1]),b:Math.round(255*m[2])}}function t(m){m=[m.x/95.047,m.y/100,m.z/108.883].map(n=>n>Math.pow(6/29,3)?Math.pow(n,1/3):1/3*Math.pow(29/6,2)*n+4/29);return{l:116*m[1]-16,a:500*(m[0]-m[1]),b:200*(m[1]-m[2])}}function y(m){const n=m.l;m=[(n+16)/116+m.a/500,(n+16)/116,(n+16)/116-m.b/200].map(d=>d>6/29?Math.pow(d,3):3*Math.pow(6/29,2)*(d-4/29));return{x:95.047*m[0],y:100*m[1],z:108.883*m[2]}}function L(m){if("r"in
m&&"g"in m&&"b"in m)return m;if("l"in m&&"c"in m&&"h"in m){var n=m.c;var d=m.h;n={l:m.l,a:n*Math.cos(d),b:n*Math.sin(d)};return v(y(n))}if("l"in m&&"a"in m&&"b"in m)return v(y(m));if("x"in m&&"y"in m&&"z"in m)return v(m);if("h"in m&&"s"in m&&"v"in m){{d=(m.h+360)%360/60;n=m.v/100*255;m=m.s/100*n;const h=m*(1-Math.abs(d%2-1));switch(Math.floor(d)){case 0:d={r:m,g:h,b:0};break;case 1:d={r:h,g:m,b:0};break;case 2:d={r:0,g:m,b:h};break;case 3:d={r:0,g:h,b:m};break;case 4:d={r:h,g:0,b:m};break;case 5:case 6:d=
{r:m,g:0,b:h};break;default:d={r:0,g:0,b:0}}d.r=Math.round(d.r+n-m);d.g=Math.round(d.g+n-m);d.b=Math.round(d.b+n-m);n=d}return n}return m}const T=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],S=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];D.darken=function(m,n){m=t(r(m));m.l*=1-n;return v(y(m))};D.toHSV=function(m){if("h"in m&&"s"in m&&"v"in m)return m;var n=L(m);{m=n.r;const d=n.g,h=n.b;n=Math.max(m,d,h);const C=n-Math.min(m,d,h);m=0===C?0:n===m?(d-h)/C%6:n===
d?(h-m)/C+2:(m-d)/C+4;0>m&&(m+=6);m={h:60*m,s:100*(0===C?0:C/n),v:100/255*n}}return m};D.toLAB=function(m){return"l"in m&&"a"in m&&"b"in m?m:t(r(L(m)))};D.toLCH=function(m){if(!("l"in m&&"c"in m&&"h"in m)){{var n=t(r(L(m)));m=n.l;var d=n.a;const h=n.b;n=Math.sqrt(d*d+h*h);d=Math.atan2(h,d);d=0<d?d:d+2*Math.PI;m={l:m,c:n,h:d}}}return m};D.toRGB=L;D.toXYZ=function(m){return"x"in m&&"y"in m&&"z"in m?m:r(L(m))};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/previewUtils":function(){define(["exports",
"../../Color"],function(D,N){function r(v,t){return Math.round(Math.min(Math.max(v+191.25*t,0),255))}D.adjustColorBrightness=function(v,t){if("type"in v&&("linear"===v.type||"pattern"===v.type))return v;v=new N(v);return new N([r(v.r,t),r(v.g,t),r(v.b,t),v.a])};D.adjustColorComponentBrightness=r;D.getConeShapes=function(v,t){let y=t?20:v;t=t?4:6;y=22>=y?y-.5*t:y-t;t=.15*y;const L=y;v-=t;return[{type:"ellipse",cx:.5*y,cy:v,rx:.5*y,ry:t},{type:"path",path:[{command:"M",values:[.5*L,0]},{command:"L",
values:[L,v]},{command:"L",values:[0,v]},{command:"Z",values:[]}]}]};D.getCubeShapes=function(v,t){let y=t?20:v;var L=t?4:6;L=y=22>=y?y-.5*L:y-L;t=t?.35*y:.5*y;return[{type:"path",path:[{command:"M",values:[.5*L,0]},{command:"L",values:[L,.5*t]},{command:"L",values:[.5*L,t]},{command:"L",values:[0,.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*t]},{command:"L",values:[.5*L,t]},{command:"L",values:[.5*L,v]},{command:"L",values:[0,v-.5*t]},{command:"Z",values:[]}]},{type:"path",
path:[{command:"M",values:[.5*L,t]},{command:"L",values:[.5*L,v]},{command:"L",values:[L,v-.5*t]},{command:"L",values:[L,.5*t]},{command:"Z",values:[]}]}]};D.getCylinderShapes=function(v,t){var y=t?20:v;t=t?4:6;y=22>=y?y-.5*t:y-t;t=.5*y;const L=.15*y;v-=L;return[{type:"ellipse",cx:.5*y,cy:v,rx:t,ry:L},{type:"path",path:[{command:"M",values:[0,L]},{command:"L",values:[0,v]},{command:"L",values:[y,v]},{command:"L",values:[y,L]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*y,cy:L,rx:t,ry:L}]};D.getDiamondShapes=
function(v){var t=v;t=22>t?t-2:t-4;const y=Math.floor(v/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[t,.5*v-y]},{command:"L",values:[.45*t-y,.5*v+y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[.45*t-y,.5*v+y]},{command:"L",values:[0,.5*v-y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*v-y]},{command:"L",values:[.45*t-y,.5*v+y]},{command:"L",values:[.45*t,v]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.45*t,v]},{command:"L",values:[t,.5*v-y]},{command:"L",values:[.45*t-y,.5*v+y]},{command:"Z",values:[]}]}]};D.getExtrudeSymbolShapes=function(v){v*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+v]},{command:"L",values:[0,22*.7+v-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+v]},{command:"L",values:[22,v]},{command:"L",
values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};D.getInvertedConeShapes=function(v){let t=v;t=22>t?t-3:t-6;const y=.15*t,L=t;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[L,0]},{command:"L",values:[.5*L,v-y]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:0,rx:.5*t,ry:y}]};D.getPathSymbolShapes=function(v){let t=
22,y=22;1>v?t*=.75:1<v&&(y*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,y-11]},{command:"L",values:[t-11,y-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[t-11,22]},{command:"L",values:[t-11,y-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[t-11,y-11]},{command:"L",values:[0,y-11]},{command:"L",values:[0,22]},{command:"L",values:[t-
11,22]},{command:"Z",values:[]}]}]};D.getTetrahedronShapes=function(v){var t=v;t=22>t?t-1:t-2;return[{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[v,t]},{command:"L",values:[.45*v,.6*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[.45*v,.6*t]},{command:"L",values:[0,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[.45*v,.6*t]},{command:"L",values:[v,t]},{command:"Z",values:[]}]}]};
D.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
D.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],
cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],
tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",
path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/renderUtils":function(){define("exports ../../core/has ../../core/Error ../../core/promiseUtils ../../kernel ../../request ../../core/colorUtils ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils".split(" "),
function(D,N,r,v,t,y,L,T,S,m){function n(h,C,w){return h?y(h,{responseType:"image"}).then(E=>{E=E.data;const p=E.width,J=E.height,O=p/J;let G=C;w&&(G=Math.min(G,Math.max(p,J)));return{image:E,width:1>=O?Math.ceil(G*O):G,height:1>=O?G:Math.ceil(G/O)}}):v.reject(new r("renderUtils: imageDataSize","href not provided."))}const d=S.createProjector();D.renderSymbol=function(h,C,w){const E=Math.ceil(C[0]);C=Math.ceil(C[1]);if(!h.some(J=>!!J.length))return null;const p=w&&w.node||document.createElement("div");
null!=w.opacity&&(p.style.opacity=w.opacity.toString());d.append(p,m.renderSVG.bind(null,h,E,C,w));return p};D.tintImageWithColor=function(h,C,w,E,p){return n(h,C,p).then(J=>{const O=J.width?J.width:C,G=J.height?J.height:C;var M;if(M=J.image)M=w&&"ignore"!==E?"multiply"===E&&255===w.r&&255===w.g&&255===w.b&&1===w.a?!1:!0:!1;if(M){var P=J.image.width,B=J.image.height;(N("edge")||N("ie"))&&/\.svg$/i.test(h)&&(--P,--B);M=Math.ceil(O);var c=Math.ceil(G);var e=document.createElement("canvas");e.width=
M;e.height=c;e.style.width=M+"px";e.style.height=c+"px";e=e.getContext("2d");e.clearRect(0,0,M,c);M=e;M.drawImage(J.image,0,0,P,B,0,0,O,G);c=M.getImageData(0,0,O,G);e=[w.r/255,w.g/255,w.b/255,w.a];const u=L.toHSV(w);for(let F=0;F<c.data.length;F+=4){J=c.data;P=F;B=e;var k=u;switch(E){case "multiply":J[P+0]*=B[0];J[P+1]*=B[1];J[P+2]*=B[2];J[P+3]*=B[3];break;default:{const g=L.toHSV({r:J[P+0],g:J[P+1],b:J[P+2]});g.h=k.h;g.s=k.s;g.v=g.v/100*k.v;k=L.toRGB(g);J[P+0]=k.r;J[P+1]=k.g;J[P+2]=k.b;J[P+3]*=B[3]}}}M.putImageData(c,
0,0);h=M.canvas.toDataURL("image/png")}else(M=t.id&&t.id.findCredential(h))&&M.token&&(J=-1===h.indexOf("?")?"?":"\x26",h=`${h}${J}token=${M.token}`);return{url:h,width:O,height:G}}).catch(function(){return{url:h,width:C,height:C}})};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/symbols/support/svgUtils":function(){define("exports ../../core/has ../../Color ../../widgets/support/widgetUtils ../../chunks/index ../../chunks/mat2d ../../chunks/mat2df32".split(" "),function(D,N,r,v,t,y,L){function T(b){return b.map(f=>
`${f.command} ${f.values.join(" ")}`).join(" ").trim()}function S(b,f,z,K){if(b){if("circle"===b.type)return t.jsx("circle",{fill:f,"fill-rule":"evenodd",stroke:z.color,"stroke-width":z.width,"stroke-linecap":z.cap,"stroke-linejoin":z.join,"stroke-dasharray":z.dashArray,"stroke-miterlimit":"4",cx:b.cx,cy:b.cy,r:b.r});if("ellipse"===b.type)return t.jsx("ellipse",{fill:f,"fill-rule":"evenodd",stroke:z.color,"stroke-width":z.width,"stroke-linecap":z.cap,"stroke-linejoin":z.join,"stroke-dasharray":z.dashArray,
"stroke-miterlimit":"4",cx:b.cx,cy:b.cy,rx:b.rx,ry:b.ry});if("rect"===b.type)return t.jsx("rect",{fill:f,"fill-rule":"evenodd",stroke:z.color,"stroke-width":z.width,"stroke-linecap":z.cap,"stroke-linejoin":z.join,"stroke-dasharray":z.dashArray,"stroke-miterlimit":"4",x:b.x,y:b.y,width:b.width,height:b.height});if("image"===b.type)return t.jsx("image",{href:b.src,x:b.x,y:b.y,width:b.width,height:b.height,preserveAspectRatio:"none"});if("path"===b.type)return b="string"!==typeof b.path?T(b.path):b.path,
t.jsx("path",{fill:f,"fill-rule":"evenodd",stroke:z.color,"stroke-width":z.width,"stroke-linecap":z.cap,"stroke-linejoin":z.join,"stroke-dasharray":z.dashArray,"stroke-miterlimit":"4",d:b});if("text"===b.type)return t.jsx("text",{fill:f,"fill-rule":"evenodd",stroke:z.color,"stroke-width":z.width,"stroke-linecap":z.cap,"stroke-linejoin":z.join,"stroke-dasharray":z.dashArray,"stroke-miterlimit":"4","text-anchor":K.align,"text-decoration":K.decoration,kerning:K.kerning,rotate:K.rotate,"text-rendering":e,
"font-style":K.font.style,"font-variant":K.font.variant,"font-weight":K.font.weight,"font-size":K.font.size,"font-family":K.font.family,x:b.x,y:b.y},b.text)}return null}function m(b){const f={fill:"none",pattern:null,linearGradient:null};if(b)if("type"in b&&"pattern"===b.type){var z=`patternId-${++B}`;f.fill=`url(#${z})`;f.pattern={id:z,x:b.x,y:b.y,width:b.width,height:b.height,image:{x:0,y:0,width:b.width,height:b.height,href:b.src}}}else"type"in b&&"linear"===b.type?(z=`linearGradientId-${++c}`,
f.fill=`url(#${z})`,f.linearGradient={id:z,x1:b.x1,y1:b.y1,x2:b.x2,y2:b.y2,stops:b.colors.map(K=>({offset:K.offset,color:K.color&&(new r(K.color)).toString()}))}):b&&(b=new r(b),f.fill=b.toString());return f}function n(b){const f={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(b&&(null!=b.width&&(f.width=b.width),b.cap&&(f.cap=b.cap),b.join&&(f.join=b.join.toString()),b.color&&(f.color=(new r(b.color)).toString()),b.style)){let K=null;b.style in H&&(K=H[b.style]);if(Array.isArray(K)){K=
K.slice(0);for(var z=0;z<K.length;++z)K[z]*=b.width;if("butt"!==b.cap){for(z=0;z<K.length;z+=2)K[z]-=b.width,1>K[z]&&(K[z]=1);for(z=1;z<K.length;z+=2)K[z]+=b.width}K=K.join(",")}f.dashArray=K}return f}function d(b,f){const z={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};b&&(z.align=b.align,z.decoration=b.decoration,z.kerning=b.kerning?"auto":"0",z.rotate=b.rotated?"90":"0",z.font.style=f.style||"normal",z.font.variant=f.variant||
"normal",z.font.weight=f.weight||"normal",z.font.size=f.size&&f.size.toString()||"10pt",z.font.family=f.family||"serif");return z}function h(b){const {pattern:f,linearGradient:z}=b;return f?t.jsx("pattern",{id:f.id,patternUnits:"userSpaceOnUse",x:f.x,y:f.y,width:f.width,height:f.height},t.jsx("image",{x:f.image.x,y:f.image.y,width:f.image.width,height:f.image.height,href:f.image.href})):z?(b=z.stops.map((K,l)=>t.jsx("stop",{key:`${l}-stop`,offset:K.offset,"stop-color":K.color})),t.jsx("linearGradient",
{id:z.id,gradientUnits:"userSpaceOnUse",x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2},b)):null}function C(b,f,z){return y.translate(b,y.identity(b),[f,z])}function w(b,f,z,K,l){y.scale(b,y.identity(b),[f,z]);b[4]=b[4]*f-K*f+K;b[5]=b[5]*z-l*z+l;return b}function E(b,f,z,K){var l=f%360*Math.PI/180;y.rotate(b,y.identity(b),l);f=Math.cos(l);l=Math.sin(l);const x=b[4],R=b[5];b[4]=x*f-R*l+K*l-z*f+z;b[5]=R*f+x*l-z*l-K*f+K;return b}function p(b,f){F&&"left"in F?(F.left>b&&(F.left=b),F.right<b&&(F.right=b),F.top>f&&(F.top=
f),F.bottom<f&&(F.bottom=f)):F={left:b,bottom:f,right:b,top:f}}function J(b){const f=b.args,z=f.length;switch(b.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<z;b+=2)p(f[b],f[b+1]);g.x=f[z-2];g.y=f[z-1];break;case "H":for(b=0;b<z;++b)p(f[b],g.y);g.x=f[z-1];break;case "V":for(b=0;b<z;++b)p(g.x,f[b]);g.y=f[z-1];break;case "m":b=0;"x"in g||(p(g.x=f[0],g.y=f[1]),b=2);for(;b<z;b+=2)p(g.x+=f[b],g.y+=f[b+1]);break;case "l":case "t":for(b=0;b<z;b+=2)p(g.x+=f[b],g.y+=f[b+1]);break;
case "h":for(b=0;b<z;++b)p(g.x+=f[b],g.y);break;case "v":for(b=0;b<z;++b)p(g.x,g.y+=f[b]);break;case "c":for(b=0;b<z;b+=6)p(g.x+f[b],g.y+f[b+1]),p(g.x+f[b+2],g.y+f[b+3]),p(g.x+=f[b+4],g.y+=f[b+5]);break;case "s":case "q":for(b=0;b<z;b+=4)p(g.x+f[b],g.y+f[b+1]),p(g.x+=f[b+2],g.y+=f[b+3]);break;case "A":for(b=0;b<z;b+=7)p(f[b+5],f[b+6]);g.x=f[z-2];g.y=f[z-1];break;case "a":for(b=0;b<z;b+=7)p(g.x+=f[b+5],g.y+=f[b+6])}}function O(b,f,z){const K=k[b.toLowerCase()];"number"===typeof K&&(K?f.length>=K&&
(b={action:b,args:f.slice(0,f.length-f.length%K)},z.push(b),J(b)):(b={action:b,args:[]},z.push(b),J(b)))}function G(b){const f={x:0,y:0,width:0,height:0};if("circle"===b.type)f.x=b.cx-b.r,f.y=b.cy-b.r,f.width=2*b.r,f.height=2*b.r;else if("ellipse"===b.type)f.x=b.cx-b.rx,f.y=b.cy-b.ry,f.width=2*b.rx,f.height=2*b.ry;else if("image"===b.type||"rect"===b.type)f.x=b.x,f.y=b.y,f.width=b.width,f.height=b.height;else if("path"===b.type){{const l=("string"!==typeof b.path?T(b.path):b.path).match(u),x=[];F=
{};g={};if(l){b="";var z=[],K=l.length;for(let R=0;R<K;++R){const U=l[R],Y=parseFloat(U);isNaN(Y)?(b&&O(b,z,x),z=[],b=U):z.push(Y)}O(b,z,x);b={x:0,y:0,width:0,height:0};F&&"left"in F&&(b.x=F.left,b.y=F.top,b.width=F.right-F.left,b.height=F.bottom-F.top)}else b=null}f.x=b.x;f.y=b.y;f.width=b.width;f.height=b.height}return f}function M(b){const f={x:0,y:0,width:0,height:0};let z=null,K=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(const x of b)z?(z.x=Math.min(z.x,x.x),z.y=Math.min(z.y,x.y),
K=Math.max(K,x.x+x.width),l=Math.max(l,x.y+x.height)):(z=f,z.x=x.x,z.y=x.y,K=x.x+x.width,l=x.y+x.height);z&&(z.width=K-z.x,z.height=l-z.y);return z}function P(b,f,z,K,l,x,R){var U=f/2;const Y=z/2,ea=b.width+K,ca=b.height+K,ha=L.create(),Z=L.create();var X=!1;if(l&&0!==ea&&0!==ca){l=ea/ca;X=f>z?f:z;let la=1,ia=1;isNaN(X)||(1<l?(la=X/ea,ia=X/l/ca):(ia=X/ca,la=X*l/ea));y.multiply(Z,Z,w(ha,la,ia,U,Y));X=!0}l=b.x+(ea-K)/2;b=b.y+(ca-K)/2;y.multiply(Z,Z,C(ha,U-l,Y-b));!X&&(ea>f||ca>z)&&(U=ea/f>ca/z,f=(U?
f:z)/(U?ea:ca),y.multiply(Z,Z,w(ha,f,f,l,b)));x&&y.multiply(Z,Z,E(ha,x,l,b));R&&y.multiply(Z,Z,C(ha,R[0],R[1]));return`matrix(${Z[0]},${Z[1]},${Z[2]},${Z[3]},${Z[4]},${Z[5]})`}let B=0,c=0;v=N("android");const e=N("chrome")||v&&4<=v?"auto":"optimizeLegibility",k={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},u=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let F={},g={};const H={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],
longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};D.computeBBox=M;D.generateFillAttributes=m;D.generateStrokeAttributes=n;D.generateTextAttributes=d;D.getBoundingBox=G;D.getTransformMatrix=P;D.renderDef=h;D.renderSVG=function(b,f,z,K){const l=[],x=[];for(const U of b){b=[];var R=[];let Y=0,ea=0,ca=0;for(const ha of U){const {shape:Z,fill:X,stroke:la,font:ia,offset:ma}=ha;Y+=la&&la.width||0;const na=m(X),qa=n(la),oa="text"===Z.type?d(Z,ia):null;l.push(h(na));b.push(S(Z,
na.fill,qa,oa));R.push(G(Z));ma&&(ea+=ma[0],ca+=ma[1])}R=P(M(R),f,z,Y,K&&K.scale,K&&K.rotation,[ea,ca]);x.push(t.jsx("g",{transform:R},b))}return t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:f,height:z},t.jsx("defs",null,l),x)};D.renderShape=S;Object.defineProperty(D,"__esModule",{value:!0})})},"esri/chunks/mat2d":function(){define(["exports","./common"],function(D,N){function r(c,e){c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];c[4]=e[4];c[5]=e[5];return c}function v(c){c[0]=1;c[1]=0;c[2]=0;c[3]=
1;c[4]=0;c[5]=0;return c}function t(c,e,k,u,F,g,H){c[0]=e;c[1]=k;c[2]=u;c[3]=F;c[4]=g;c[5]=H;return c}function y(c,e){const k=e[0],u=e[1],F=e[2],g=e[3],H=e[4];e=e[5];let b=k*g-u*F;if(!b)return null;b=1/b;c[0]=g*b;c[1]=-u*b;c[2]=-F*b;c[3]=k*b;c[4]=(F*e-g*H)*b;c[5]=(u*H-k*e)*b;return c}function L(c){return c[0]*c[3]-c[1]*c[2]}function T(c,e,k){const u=e[0],F=e[1],g=e[2],H=e[3],b=e[4];e=e[5];const f=k[0],z=k[1],K=k[2],l=k[3],x=k[4];k=k[5];c[0]=u*f+g*z;c[1]=F*f+H*z;c[2]=u*K+g*l;c[3]=F*K+H*l;c[4]=u*x+
g*k+b;c[5]=F*x+H*k+e;return c}function S(c,e,k){const u=e[0],F=e[1],g=e[2],H=e[3],b=e[4];e=e[5];const f=Math.sin(k);k=Math.cos(k);c[0]=u*k+g*f;c[1]=F*k+H*f;c[2]=u*-f+g*k;c[3]=F*-f+H*k;c[4]=b;c[5]=e;return c}function m(c,e,k){const u=e[1],F=e[2],g=e[3],H=e[4],b=e[5],f=k[0];k=k[1];c[0]=e[0]*f;c[1]=u*f;c[2]=F*k;c[3]=g*k;c[4]=H;c[5]=b;return c}function n(c,e,k){const u=e[0],F=e[1],g=e[2],H=e[3],b=e[4];e=e[5];const f=k[0];k=k[1];c[0]=u;c[1]=F;c[2]=g;c[3]=H;c[4]=u*f+g*k+b;c[5]=F*f+H*k+e;return c}function d(c,
e){const k=Math.sin(e);e=Math.cos(e);c[0]=e;c[1]=k;c[2]=-k;c[3]=e;c[4]=0;c[5]=0;return c}function h(c,e){c[0]=e[0];c[1]=0;c[2]=0;c[3]=e[1];c[4]=0;c[5]=0;return c}function C(c,e){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=e[0];c[5]=e[1];return c}function w(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"}function E(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)}function p(c,e,k){c[0]=e[0]+k[0];c[1]=e[1]+
k[1];c[2]=e[2]+k[2];c[3]=e[3]+k[3];c[4]=e[4]+k[4];c[5]=e[5]+k[5];return c}function J(c,e,k){c[0]=e[0]-k[0];c[1]=e[1]-k[1];c[2]=e[2]-k[2];c[3]=e[3]-k[3];c[4]=e[4]-k[4];c[5]=e[5]-k[5];return c}function O(c,e,k){c[0]=e[0]*k;c[1]=e[1]*k;c[2]=e[2]*k;c[3]=e[3]*k;c[4]=e[4]*k;c[5]=e[5]*k;return c}function G(c,e,k,u){c[0]=e[0]+k[0]*u;c[1]=e[1]+k[1]*u;c[2]=e[2]+k[2]*u;c[3]=e[3]+k[3]*u;c[4]=e[4]+k[4]*u;c[5]=e[5]+k[5]*u;return c}function M(c,e){return c[0]===e[0]&&c[1]===e[1]&&c[2]===e[2]&&c[3]===e[3]&&c[4]===
e[4]&&c[5]===e[5]}function P(c,e){const k=c[0],u=c[1],F=c[2],g=c[3],H=c[4];c=c[5];const b=e[0],f=e[1],z=e[2],K=e[3],l=e[4];e=e[5];return Math.abs(k-b)<=N.EPSILON*Math.max(1,Math.abs(k),Math.abs(b))&&Math.abs(u-f)<=N.EPSILON*Math.max(1,Math.abs(u),Math.abs(f))&&Math.abs(F-z)<=N.EPSILON*Math.max(1,Math.abs(F),Math.abs(z))&&Math.abs(g-K)<=N.EPSILON*Math.max(1,Math.abs(g),Math.abs(K))&&Math.abs(H-l)<=N.EPSILON*Math.max(1,Math.abs(H),Math.abs(l))&&Math.abs(c-e)<=N.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))}
var B=Object.freeze({__proto__:null,copy:r,identity:v,set:t,invert:y,determinant:L,multiply:T,rotate:S,scale:m,translate:n,fromRotation:d,fromScaling:h,fromTranslation:C,str:w,frob:E,add:p,subtract:J,multiplyScalar:O,multiplyScalarAndAdd:G,exactEquals:M,equals:P,mul:T,sub:J});D.add=p;D.copy=r;D.determinant=L;D.equals=P;D.exactEquals=M;D.frob=E;D.fromRotation=d;D.fromScaling=h;D.fromTranslation=C;D.identity=v;D.invert=y;D.mat2d=B;D.mul=T;D.multiply=T;D.multiplyScalar=O;D.multiplyScalarAndAdd=G;D.rotate=
S;D.scale=m;D.set=t;D.str=w;D.sub=J;D.subtract=J;D.translate=n})},"esri/chunks/mat2df32":function(){define(["exports"],function(D){function N(){const S=new Float32Array(6);S[0]=1;S[3]=1;return S}function r(S){const m=new Float32Array(6);m[0]=S[0];m[1]=S[1];m[2]=S[2];m[3]=S[3];m[4]=S[4];m[5]=S[5];return m}function v(S,m,n,d,h,C){const w=new Float32Array(6);w[0]=S;w[1]=m;w[2]=n;w[3]=d;w[4]=h;w[5]=C;return w}function t(S,m){return new Float32Array(S,m,6)}function y(S,m,n,d){const h=m[d];m=m[d+1];S[d]=
n[0]*h+n[2]*m+n[4];S[d+1]=n[1]*h+n[3]*m+n[5]}function L(S,m,n,d=0,h=0,C=2){for(h=h||m.length/C;d<h;d++)y(S,m,n,d*C)}var T=Object.freeze({__proto__:null,create:N,clone:r,fromValues:v,createView:t,transform:y,transformMany:L});D.clone=r;D.create=N;D.createView=t;D.fromValues=v;D.mat2df32=T;D.transform=y;D.transformMany=L})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/promiseUtils ../../../Color ../../../chunks/symbols ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ../../../renderers/support/numberUtils ./utils".split(" "),
function(D,N,r,v,t,y,L,T,S){function m(c,e){const k=c.length-1;return c.map((u,F)=>S.createStopLabel(u,F,k,e))}function n(c,e){const k=c.classBreakInfos,u=k.length;e=2>u||!(2<=e)?k[0].symbol.clone():k[u-1].symbol.clone();c.visualVariables.some(F=>"color"===F.type)&&(-1<e.type.indexOf("3d")?C(e):w(e));return e}function d(c,e){let k=null,u=null;"simple"===c.type?k=c.symbol:"class-breaks"===c.type?(k=(c=c.classBreakInfos)&&c[0]&&c[0].symbol,u=1<c.length):"unique-value"===c.type&&(k=(c=c.uniqueValueInfos)&&
c[0]&&c[0].symbol,u=1<c.length);if(!k||h(k))return null;k=k.clone();if(e||u)-1<k.type.indexOf("3d")?C(k):w(k);return k}function h(c){return c?t.isSymbol3D(c)?c.symbolLayers?c.symbolLayers.some(e=>e&&"fill"===e.type):!1:-1!==c.type.indexOf("fill"):!1}function C(c){L.isVolumetricSymbol(c)||("line-3d"===c.type?c.symbolLayers.forEach(e=>{e.material={color:B}}):c.symbolLayers.forEach(e=>{"icon"!==e.type||e.resource&&e.resource.href?e.material={color:P}:(e.material={color:M},e.outline={color:B,size:1.5})}))}
function w(c){"cim"===c.type?y.applyCIMSymbolColor(c,new v(P)):-1!==c.type.indexOf("line")?c.color=B:(c.color=M,"simple-marker"===c.type&&(c.outline={color:B,width:1.5}))}async function E(c,e,k,u){const F=(await new Promise(function(b,f){D(["../../../renderers/visualVariables/support/visualVariableUtils"],b,f)})).getSizeRangeAtScale(c,k,u),g=F&&p(F);if(F||g){var H=g.map(b=>{{const f=F.minSize,z=F.maxSize,K=c.minDataValue,l=c.maxDataValue;let x=null;b=x=b<=f?K:b>=z?l:(b-f)/(z-f)*(l-K)+K}return b});
H=T.round(H);for(let b=1;b<H.length-1;b++){const f=await J(c,e,H[b],H[b-1],k,u);f&&(H[b]=f[0],g[b]=f[1])}return H}}function p(c){const e=c.minSize;c=(c.maxSize-e)/4;const k=[];for(let u=0;5>u;u++)k.push(e+c*u);return k}async function J(c,e,k,u,F,g){const H=await O(c,e,k,F,g);u=await O(c,e,u,F,g);var b=T.numDigits(k),f=b.fractional,z=b.integer;let K=b=null;0<k&&1>k&&(b=Math.pow(10,f),k*=b,z=T.numDigits(k).integer);for(f=z-1;0<=f;f--){var l=Math.pow(10,f);z=Math.floor(k/l)*l;l*=Math.ceil(k/l);null!=
b&&(z/=b,l/=b);let x=(z+l)/2;[,x]=T.round([z,x,l],{indexes:[1]});const R=await O(c,e,z,F,g),U=await O(c,e,l,F,g),Y=await O(c,e,x,F,g),ea=T.percentChange(H,R,u,null),ca=T.percentChange(H,U,u,null),ha=T.percentChange(H,Y,u,null);let Z=20>=ea.previous,X=20>=ca.previous;Z&&X&&(ea.previous<=ca.previous?(Z=!0,X=!1):(X=!0,Z=!1));Z?K=[z,R]:X?K=[l,U]:20>=ha.previous&&(K=[x,Y]);if(K)break}return K}async function O(c,e,k,u,F){const {getSize:g}=await new Promise(function(H,b){D(["../../../renderers/visualVariables/support/visualVariableUtils"],
H,b)});return g(c,k,{scale:u,view:F,shape:"simple-marker"===e.type?e.style:null})}function G(c,e){c=c.clone();if(t.isSymbol3D(c))L.isVolumetricSymbol(c)||c.symbolLayers.forEach(k=>{"fill"!==k.type&&(k.size=e)});else if("esri.symbols.SimpleMarkerSymbol"===c.declaredClass)c.size=e;else if("esri.symbols.PictureMarkerSymbol"===c.declaredClass){const k=c.width,u=c.height;c.height=e;c.width=k/u*e}else"esri.symbols.SimpleLineSymbol"===c.declaredClass?c.width=e:"esri.symbols.TextSymbol"===c.declaredClass&&
c.font&&(c.font.size=e);return c}const M=[255,255,255],P=[200,200,200],B=[128,128,128];N.REAL_WORLD_MAX_SIZE=30;N.REAL_WORLD_MIN_SIZE=12;N.getRampStops=async function(c,e,k,u,F,g){var H=e.legendOptions;H=H&&H.customValues;const b=d(c,k);var f=null!=e.minSize&&null!=e.maxSize;k=e.stops&&1<e.stops.length;const z=!!e.target;if(b&&(H||f||k&&!z)){var K=L.isVolumetricSymbol(b),l=null,x=f=null;f=K&&!k?T.round([e.minDataValue,e.maxDataValue]):H||await E(e,b,u,F);H=null==c?void 0:c.authoringInfo;var R="univariate-color-size"===
(null==H?void 0:H.type)&&"above-and-below"===(null==H?void 0:H.univariateTheme);!f&&k&&(f=R?S.getUnivariateAboveAndBelowStopValues(e,H):e.stops.map(ca=>ca.value),(l=e.stops.some(ca=>!!ca.label))&&(x=e.stops.map(ca=>ca.label)));K&&f&&2<f.length&&(f=[f[0],f[f.length-1]]);if(!f)return null;var U=[12,30],Y=L.getSymbolOutlineSize(b),ea=l?null:m(f,g);return(await r.all(f.map(async(ca,ha)=>{const Z=K?U[ha]:await O(e,b,ca,u,F),X=G(R&&"class-breaks"===c.type?n(c,ha):b,Z);return{value:ca,symbol:X,label:l?x[ha]:
ea[ha],size:Z,outlineSize:Y}}))).reverse()}};Object.defineProperty(N,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/screenUtils ../../../intl/substitute ../../../intl ../../../core/Handles ../../support/widgetUtils ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/decorators/renderable ../../../chunks/index ../../Widget ../../../symbols/support/svgUtils ./support/utils ../support/styleUtils".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p,J,O,G,M,P,B,c){const e=window.devicePixelRatio;r=function(k){function u(g,H){g=k.call(this,g,H)||this;g._handles=new w;g._hasIndicators=!1;g._selectedSectionName=null;g._sectionNames=[];g._sectionMap=new Map;g.activeLayerInfos=null;g.layout="stack";g.messages=null;g.messagesCommon=null;g.type="card";g.view=null;return g}D._inheritsLoose(u,k);var F=u.prototype;F.initialize=function(){this.own([this.watch("activeLayerInfos",g=>{this._handles.removeAll();this._watchForSectionChanges(g)})])};
F.destroy=function(){this._handles.destroy();this._handles=null};F.render=function(){this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var g=this.activeLayerInfos;g=g&&g.toArray().map(f=>this._renderLegendForLayer(f)).filter(f=>!!f);this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const H=
this._sectionNames.length;var b=this._sectionNames.map((f,z)=>{z=h.substitute(this.messagesCommon.pagination.pageText,{index:z+1,total:H});return G.jsx("div",{key:f,"aria-label":z,title:z,tabIndex:0,onclick:this._selectSection,onkeydown:this._selectSection,bind:this,class:this.classes("esri-legend--card__carousel-indicator",{["esri-legend--card__carousel-indicator--activated"]:this._selectedSectionName===f}),"data-section-name":f})});b=this._hasIndicators&&1<H?G.jsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},b):null;g=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):g&&g.length?g:null;return G.jsx("div",{class:this.classes("esri-legend--card",{["esri-legend--stacked"]:this._hasIndicators})},b,g?g:G.jsx("div",{class:"esri-legend--card__message"},this.messages.noLegend))};F._selectSection=function(g){if(g=g.target.getAttribute("data-section-name"))this._selectedSectionName=g};F._watchForSectionChanges=function(g){this._generateSectionNames();g&&(g.forEach(H=>
{const b=`activeLayerInfo-${H.layer.uid}-version-change`;this._handles.remove(b);this._watchForSectionChanges(H.children);this._handles.add(H.watch("version",()=>this._generateSectionNames()),b)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(g.on("change",()=>this._watchForSectionChanges(g)),"activeLayerInfos-collection-change"))};F._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};F._generateSectionNamesForActiveLayerInfo=function(g){g.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);g.legendElements&&g.legendElements.forEach((H,b)=>{this._sectionNames.push(`${"esri-legend--card__"}${g.layer.uid}-type-${H.type}-${b}`)})};F._renderLegendForLayer=function(g){if(!g.ready)return null;if(g.children.length){var H=g.children.map(b=>this._renderLegendForLayer(b)).toArray();return G.jsx("div",{key:g.layer.uid,class:this.classes("esri-legend--card__service",
"esri-legend--card__group-layer")},G.jsx("div",{class:"esri-legend--card__service-caption-container"},g.title),H)}{if((H=g.legendElements)&&!H.length)return null;const b=H.some(f=>"relationship-ramp"===f.type);H=H.map((f,z)=>this._renderLegendForElement(f,g,z,b)).filter(f=>!!f);return H.length?G.jsx("div",{key:g.layer.uid,class:this.classes("esri-legend--card__service",{["esri-legend--card__group-layer-child"]:!!g.parent})},G.jsx("div",{class:"esri-legend--card__service-caption-container"},G.jsx("div",
{class:"esri-legend--card__service-caption-text"},g.title)),G.jsx("div",{class:"esri-legend--card__service-content"},H)):null}};F._renderLegendForElement=function(g,H,b,f=!1){const z="color-ramp"===g.type,K="opacity-ramp"===g.type;var l="size-ramp"===g.type;const x=H.layer;var R=g.title,U=null;"string"===typeof R?U=R:R&&(U=c.getTitle(this.messages,R,z||K),U=R.title?`${R.title} (${U})`:U);b=`${"esri-legend--card__"}${x.uid}-type-${g.type}-${b}`;R=this._hasIndicators?G.jsx("div",null,G.jsx("h3",{class:this.classes("esri-widget__heading",
"esri-legend--card__carousel-title")},H.title),G.jsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},U)):U?G.jsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},U):null;U=null;"symbol-table"===g.type?(l=g.infos.map((Y,ea)=>this._renderLegendForElementInfo(Y,H,g.legendType,ea)).filter(Y=>!!Y),l.length&&(U=G.jsx("div",{key:b,class:"esri-legend--card__section"},R,G.jsx("div",{class:this.classes({["esri-legend--card__label-container"]:!(l[0].properties.classes&&
l[0].properties.classes["esri-legend--card__symbol-row"])&&!f,["esri-legend--card__relationship-label-container"]:f})},l)))):"color-ramp"===g.type||"opacity-ramp"===g.type||"heatmap-ramp"===g.type?U=G.jsx("div",{key:b,class:"esri-legend--card__section"},R,this._renderLegendForRamp(g,x.opacity)):l?U=G.jsx("div",{key:b,class:"esri-legend--card__section"},R,this._renderSizeRamp(g,x.opacity)):"relationship-ramp"===g.type?U=G.jsx("div",{key:b,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},
R,B.renderRelationshipRamp(g,this.id,x.opacity)):"univariate-above-and-below-ramp"===g.type&&(U=G.jsx("div",{key:b,class:"esri-legend--card__section"},R,this._renderUnivariateAboveAndBelowRamp(g,x.opacity)));if(!U)return null;this._sectionMap.set(b,U);return U};F._renderUnivariateAboveAndBelowRamp=function(g,H){const {sizeRampElement:b,colorRampElement:f}=B.getUnivariateAboveAndBelowRampElements(g,H,"horizontal");g=B.getUnivariateAboveAndBelowSizeRampSize(b,"full","horizontal");var z=B.getUnivariateAboveAndBelowColorRampSize(b,
"above","horizontal"),K=B.getUnivariateAboveAndBelowColorRampSize(b,"below","horizontal");z=B.getUnivariateAboveAndBelowColorRampPreview(f,{width:z,height:12,rampAlignment:"horizontal",opacity:H,type:"above"});H=B.getUnivariateAboveAndBelowColorRampPreview(f,{width:K,height:12,rampAlignment:"horizontal",opacity:H,type:"below"});var l=B.getUnivariateAboveAndBelowColorRampMargin(b,"card");K=b.infos.map(x=>x.label).map((x,R)=>0===R||4===R?G.jsx("div",{key:R},x):null);l={marginTop:"3px",marginLeft:`${l}px`,
display:"flex"};g={width:`${g}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return G.jsx("div",{class:"esri-legend--card__layer-row",key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},G.jsx("div",{class:this.classes("esri-legend--card__symbol-container","esri-legend__size-ramp--horizontal"),styles:{display:"flex",flexDirection:"row"}},b.infos.map((x,R)=>G.jsx("div",{key:R,class:"esri-legend--card__symbol",bind:x.preview,afterCreate:c.attachToNode}))),
z?G.jsx("div",{class:"esri-univariate-above-and-below-ramp__color--card",styles:l,key:"color-ramp-preview"},G.jsx("div",{bind:z,afterCreate:c.attachToNode}),G.jsx("div",{bind:H,afterCreate:c.attachToNode})):null,G.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},G.jsx("div",{class:"esri-legend__ramp-labels",styles:g},K)))};F._renderLegendForElementInfo=function(g,H,b,f){var z=H.layer;if(g.type)return this._renderLegendForElement(g,H,f);H=c.isImageryStretchedLegend(z,b);if(g.preview){var K;
if(-1===g.symbol.type.indexOf("simple-fill")){if(!g.label)return G.jsx("div",{key:f,bind:g.preview,afterCreate:c.attachToNode});var l={["esri-legend--card__symbol-cell"]:this._hasIndicators};return G.jsx("div",{key:f,class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__symbol-row"]:this._hasIndicators})},G.jsx("div",{class:this.classes(l),bind:g.preview,afterCreate:c.attachToNode}),G.jsx("div",{class:this.classes("esri-legend--card__image-label",{["esri-legend--card__label-cell"]:this._hasIndicators})},
c.getTitle(this.messages,g.label,!1)||""))}let x=b=H=255,R=0,U=255,Y=255,ea=255,ca=0;const ha=g.symbol.color&&g.symbol.color.a,Z=g.symbol.outline&&g.symbol.outline.color&&g.symbol.outline.color.a;ha&&(H=g.symbol.color.r,b=g.symbol.color.g,x=g.symbol.color.b,R=g.symbol.color.a*z.opacity);Z&&(U=g.symbol.outline.color.r,Y=g.symbol.outline.color.g,ea=g.symbol.outline.color.b,ca=g.symbol.outline.color.a*z.opacity);l=(z=null!=(l=null==(K=g.symbol.color)?void 0:K.isBright)?l:!0)?"rgba(255, 255, 255, .6)":
"rgba(0, 0, 0, .6)";return G.jsx("div",{key:f,class:"esri-legend--card__layer-row"},G.jsx("div",{class:"esri-legend--card__label-element",styles:{background:ha?`rgba(${H}, ${b}, ${x}, ${R})`:"none",color:z?"black":"white",textShadow:`-1px -1px 0 ${l},
                                              1px -1px 0 ${l},
                                              -1px 1px 0 ${l},
                                              1px 1px 0 ${l}`,border:Z?`1px solid rgba(${U}, ${Y}, ${ea}, ${ca})`:"none"}}," ",g.label," "))}if(g.src)return l=this._renderImage(g,z,H),G.jsx("div",{key:f,class:"esri-legend--card__layer-row"},l,G.jsx("div",{class:"esri-legend--card__image-label"},g.label||""))};F._renderImage=function(g,H,b){const {label:f,src:z,opacity:K}=g;b={["esri-legend--card__imagery-layer-image--stretched"]:b,["esri-legend--card__symbol"]:!b};H={opacity:`${null!=K?K:H.opacity}`};
return G.jsx("img",{alt:c.getTitle(this.messages,f,!1),src:z,border:0,width:g.width,height:g.height,class:this.classes(b),styles:H})};F._renderSizeRampLines=function(g){g=g.infos;var H=g[0],b=g[g.length-1],f=H.symbol;g=this._hasIndicators;H=d.pt2px(H.size+H.outlineSize)*e;b=d.pt2px(b.size+b.outlineSize)*e;const z=g?H:H+50*e,K=g?H/2+50*e:H;var l;f?-1<f.type.indexOf("3d")?(l=f.symbolLayers&&f.symbolLayers.length)?(l=f.symbolLayers.getItemAt(l-1).get("resource.primitive"),l="triangle"===l||"cone"===
l||"tetrahedron"===l):l=void 0:l="triangle"===f.style:l=void 0;if(f)if(-1<f.type.indexOf("3d")){var x=f.symbolLayers&&f.symbolLayers.length;x?(f=f.symbolLayers.getItemAt(x-1),f=f.resource&&f.resource.primitive,f="circle"===f||"cross"===f||"kite"===f||"sphere"===f||"cube"===f||"diamond"===f):f=void 0}else f=f.style,f="circle"===f||"diamond"===f||"cross"===f;else f=void 0;x=document.createElement("canvas");x.width=z;x.height=K;x.style.width=`${x.width/e}px`;x.style.height=`${x.height/e}px`;const R=
x.getContext("2d");if(g){R.beginPath();var U=z/2-b/2;R.moveTo(0,0);R.lineTo(U,K);U=z/2+b/2;R.moveTo(z,0);R.lineTo(U,K)}else R.beginPath(),R.moveTo(0,K/2-b/2),R.lineTo(z,0),R.moveTo(0,K/2+b/2),R.lineTo(z,K);R.strokeStyle="#ddd";R.stroke();return G.jsx("div",{bind:x,afterCreate:c.attachToNode,styles:g?{display:"flex",marginTop:`-${l?0:f?H/2:0}px`,marginBottom:`-${l?b:f?b/2:0}px`}:{display:"flex",marginRight:`-${l?0:f?H/2:0}px`,marginLeft:`-${l?0:f?b/2:0}px`}})};F._renderSizeRamp=function(g,H){var b=
g.infos;const f=b[0].label,z=b[b.length-1].label;let K=b[0].preview;b=b[b.length-1].preview;const l=this._hasIndicators,x={"flex-direction":l?"column":"row-reverse"};K&&(K=K.cloneNode(!0),K.style.display="flex");b&&(b=b.cloneNode(!0),b.style.display="flex");H={opacity:null!=H?`${H}`:""};return G.jsx("div",{class:this.classes("esri-legend--card__layer-row",{["esri-legend--card__size-ramp-row"]:l})},G.jsx("div",{class:"esri-legend--card__ramp-label"},l?f:z),G.jsx("div",{class:"esri-legend--card__size-ramp-container",
styles:x},G.jsx("div",{bind:K,afterCreate:c.attachToNode,class:"esri-legend--card__size-ramp-preview",styles:H}),this._renderSizeRampLines(g),G.jsx("div",{bind:b,afterCreate:c.attachToNode,class:"esri-legend--card__size-ramp-container",styles:H})),G.jsx("div",{class:"esri-legend--card__ramp-label"},l?z:f))};F._renderLegendForRamp=function(g,H){var b=g.infos;const f="heatmap-ramp"===g.type,z=b.length-1;var K=2<z&&!f?25*z:100;const l=K+20,x=b.slice(0).reverse();x.forEach((ea,ca)=>{ea.offset=f?ea.ratio:
ca/z});const R=x.length-1;g=(g=0!==x.length%2&&x[x.length/2|0])&&G.jsx("div",{class:"esri-legend--card__interval-separators-container"},G.jsx("div",{class:"esri-legend--card__interval-separator"},"|"),G.jsx("div",{class:"esri-legend--card__ramp-label"},g.label));const U=b[b.length-1].label;b=b[0].label;let Y=null;null!=H&&(Y=`opacity: ${H}`);H=P.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:x[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:K,height:25},fill:{type:"linear",
x1:10,y1:0,x2:K+10,y2:0,colors:x},stroke:{width:0}},{shape:{type:"path",path:`M${K+10} 0 L${l} ${12.5} L${K+10} ${25} Z`},fill:x[R].color,stroke:{width:0}}]],l,25);({messages:K}=this);return G.jsx("div",{class:"esri-legend--card__layer-row"},G.jsx("div",{class:"esri-legend--card__ramp-label"},f?K[U]:U),G.jsx("div",{class:"esri-legend--card__symbol-container"},G.jsx("div",{style:Y},H),g),G.jsx("div",{class:"esri-legend--card__ramp-label"},f?K[b]:b))};return u}(M);N.__decorate([O.renderable(),y.property()],
r.prototype,"activeLayerInfos",void 0);N.__decorate([y.property()],r.prototype,"layout",void 0);N.__decorate([y.property(),O.renderable(),J.messageBundle("esri/widgets/Legend/t9n/Legend")],r.prototype,"messages",void 0);N.__decorate([y.property(),O.renderable(),J.messageBundle("esri/t9n/common")],r.prototype,"messagesCommon",void 0);N.__decorate([y.property({readOnly:!0})],r.prototype,"type",void 0);N.__decorate([y.property()],r.prototype,"view",void 0);N.__decorate([p.accessibleHandler()],r.prototype,
"_selectSection",null);return r=N.__decorate([T.subclass("esri.widgets.Legend.styles.Card")],r)})},"esri/widgets/Legend/styles/support/utils":function(){define("exports ../../../../core/screenUtils ../../../support/widgetUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../chunks/index ../../../../symbols/support/symbolUtils ../../../../symbols/support/svgUtils".split(" "),function(D,N,r,v,t,y,L,T){function S(p,J,O){const G=`${O}_arrowStart`;O=`${O}_arrowEnd`;
p="left"===p;const M={markerStart:null,markerEnd:null};switch(J){case "HL":p?M.markerStart=`url(#${O})`:M.markerEnd=`url(#${G})`;break;case "LL":M.markerStart=`url(#${O})`;break;case "LH":p?M.markerEnd=`url(#${G})`:M.markerStart=`url(#${O})`;break;default:M.markerEnd=`url(#${G})`}return M}function m(p,J,O,G=60){const {focus:M,numClasses:P,colors:B,rotation:c}=p;p=!!M;const e=Math.sqrt(Math.pow(G,2)+Math.pow(G,2))+(p?0:5);let k=null;null!=O&&(k=`opacity: ${O}`);O=[];const u=[];var F=[],g=(G||75)/P;
for(var H=0;H<P;H++){var b=H*g;for(var f=0;f<P;f++){var z=f*g;const K=T.generateFillAttributes(B[H][f]),l=T.generateStrokeAttributes(null);z={type:"rect",x:z,y:b,width:g,height:g};O.push(T.renderDef(K));u.push(T.renderShape(z,K.fill,l,null));F.push(T.getBoundingBox(z))}}g=null;p||(g="margin: -15px -15px -18px -15px");H=S("left",M,J);b=S("right",M,J);f=T.computeBBox(F);F=T.getTransformMatrix(f,e,e,0,!1,c);f=T.getTransformMatrix(f,e,e,0,!1,p?-45:null);return y.jsx("div",{style:k,class:p?E.diamondMidColRamp:
E.squareTableCell},y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,style:g},y.jsx("defs",null,y.jsx("marker",{id:`${J}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},y.jsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),y.jsx("marker",{id:`${J}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},y.jsx("polyline",{points:"5,0 0,5 5,10",
fill:"none",stroke:"#555555","stroke-width":"1"})),O),y.jsx("g",{transform:F},u),y.jsx("g",{transform:f},y.jsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":H.markerStart,"marker-end":H.markerEnd,x1:-10,y1:G-15,x2:-10,y2:15}),y.jsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":b.markerStart,"marker-end":b.markerEnd,x1:15,y1:G+10,x2:G-15,y2:G+10}))))}function n(p="vertical"){return"vertical"===p?y.jsx("svg",{height:"4",width:"10"},y.jsx("line",{x1:"0",
y1:"2",x2:"10",y2:"2",style:"stroke:rgb(200, 200, 200);stroke-width:1"})):y.jsx("svg",{height:"10",width:"10"},y.jsx("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:"stroke:rgb(200, 200, 200);stroke-width:1"}))}function d(p,J="vertical"){const O=document.createElement("div");O.style.height="20px";O.className=E.univariateAboveAndBelowSymbol;null!=p&&(O.style.opacity=p.toString());w.append(O,n.bind(null,J));return O}function h(p,J,O="vertical"){p.infos.forEach((G,M)=>{if(2===M)G.preview=d(J,O);else{M=N.pt2px(G.size)+
("horizontal"===O?20:10);const P="div"===G.preview.tagName.toLowerCase(),B=P?G.preview:document.createElement("div");B.className=E.univariateAboveAndBelowSymbol;"horizontal"===O?B.style.width=`${M}px`:B.style.height=`${M}px`;P||B.appendChild(G.preview);G.preview=B}})}function C(p,J,O="vertical"){let G=0;p=p.infos;var M="full"===J||"above"===J?0:2;for(J="full"===J||"below"===J?4:2;M<=J;M++)if(2===M)G+="horizontal"===O?10:20;else{const P=N.pt2px(p[M].size)+("horizontal"===O?20:10);G+=P}return G}const w=
t.createProjector(),E={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",
squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",
colorRamp:"esri-legend__color-ramp"};D.getUnivariateAboveAndBelowColorRampMargin=function(p,J="classic"){p=p.infos;return"classic"===J?(N.pt2px(p[0].size)+10)/2:(p[0].size-p[p.length-1].size)/2};D.getUnivariateAboveAndBelowColorRampPreview=function(p,J){if(!p)return null;p=p.infos.map(O=>O.color);p=L.renderColorRampPreviewHTML("full"===J.type?p:"above"===J.type?p.slice(0,3):p.slice(2,5),{width:J.width,height:J.height,align:J.rampAlignment});p.className=E.colorRamp;null!=J.opacity&&(p.style.opacity=
J.opacity.toString());return p};D.getUnivariateAboveAndBelowColorRampSize=function(p,J,O="vertical"){O=C(p,J,O);p=p.infos;const G="full"===J||"above"===J?0:2,M="full"===J||"below"===J?4:2;return O-(N.pt2px(("full"===J?p[G].size+p[M].size:"above"===J?p[G].size:p[M].size)/2)+15)};D.getUnivariateAboveAndBelowRampElements=function(p,J,O="vertical"){var G=p.infos;p=G.filter(({type:P})=>"size-ramp"===P)[0];G=G.filter(({type:P})=>"color-ramp"===P)[0];p&&(p={...p},p.infos=[...p.infos]);G&&(G={...G},G.infos=
[...G.infos]);h(p,J,O);if("horizontal"===O){var M;p.infos.reverse();null==(M=G)?void 0:M.infos.reverse()}return{sizeRampElement:p,colorRampElement:G}};D.getUnivariateAboveAndBelowSizeRampSize=C;D.renderRelationshipRamp=function(p,J,O){const {focus:G,labels:M}=p,P=!!G;p=m(p,J,O);return P?y.jsx("div",{class:E.diamondContainer},y.jsx("div",{class:E.diamondLeftCol},M.left),y.jsx("div",{class:E.diamondMidCol},y.jsx("div",{class:E.diamondMidColLabel},M.top),p,y.jsx("div",{class:E.diamondMidColLabel},M.bottom)),
y.jsx("div",{class:E.diamondRightCol},M.right)):y.jsx("div",{class:E.squareTable},y.jsx("div",{class:E.squareTableRow},y.jsx("div",{class:r.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelRightBottom)},M.left),y.jsx("div",{class:E.squareTableCell}),y.jsx("div",{class:r.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelLeftBottom)},M.top)),y.jsx("div",{class:E.squareTableRow},y.jsx("div",{class:E.squareTableCell}),p,y.jsx("div",{class:E.squareTableCell})),y.jsx("div",{class:E.squareTableRow},
y.jsx("div",{class:r.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelRightTop)},M.bottom),y.jsx("div",{class:E.squareTableCell}),y.jsx("div",{class:r.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelLeftTop)},M.right)))};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl/substitute","../../../intl"],function(D,N,r){D.attachToNode=function(v){v.appendChild(this)};D.getTitle=function(v,
t,y){if(t){if("string"===typeof t||"number"===typeof t)return t;if("value"in t||"unit"in t)return N.substitute(v.dotValue,t);if("colorName"in t||"bandName"in t)return v[t.colorName]+": "+(v[t.bandName]||t.bandName);if("showCount"in t)return t.showCount?v.clusterCountTitle:null;var L=null;y?L=t.ratioPercentTotal?"showRatioPercentTotal":t.ratioPercent?"showRatioPercent":t.ratio?"showRatio":t.normField?"showNormField":t.field?"showField":null:y||(L=t.normField?"showNormField":t.normByPct?"showNormPct":
t.field?"showField":null);return L?N.substitute("showField"===L?"{field}":v[L],{field:t.field,normField:t.normField}):null}};D.isImageryStretchedLegend=function(v,t){return!!(t&&"Stretched"===t&&10.3<=v.version&&"esri.layers.ImageryLayer"===v.declaredClass)};D.isRendererTitle=function(v,t){return!t};Object.defineProperty(D,"__esModule",{value:!0})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../intl/number ../../../intl ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/decorators/renderable ../../../chunks/index ../../Widget ./support/utils ../support/styleUtils".split(" "),
function(D,N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p,J,O,G){const M={display:"flex",alignItems:"flex-start"},P={marginLeft:"3px"},B={display:"table-cell",verticalAlign:"middle"};r=function(c){function e(u,F){u=c.call(this,u,F)||this;u.activeLayerInfos=null;u.messages=null;u.type="classic";return u}D._inheritsLoose(e,c);var k=e.prototype;k.render=function(){var u=this.activeLayerInfos;u=u&&u.toArray().map(F=>this._renderLegendForLayer(F)).filter(F=>!!F);return p.jsx("div",null,u&&u.length?u:p.jsx("div",{class:"esri-legend__message"},
this.messages.noLegend))};k._renderLegendForLayer=function(u){if(!u.ready)return null;var F=!!u.children.length;const g=`${"esri-legend__"}${u.layer.uid}-version-${u.version}`,H=u.title?p.jsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},u.title):null;if(F)return F=u.children.map(b=>this._renderLegendForLayer(b)).toArray(),p.jsx("div",{key:g,class:this.classes("esri-legend__service","esri-legend__group-layer")},H,F);if((F=u.legendElements)&&!F.length)return null;F=
F.map(b=>this._renderLegendForElement(b,u.layer)).filter(b=>!!b);return F.length?p.jsx("div",{key:g,class:this.classes("esri-legend__service",{["esri-legend__group-layer-child"]:!!u.parent})},H,p.jsx("div",{class:"esri-legend__layer"},F)):null};k._renderLegendForElement=function(u,F,g){var H="color-ramp"===u.type,b="opacity-ramp"===u.type;const f="size-ramp"===u.type;let z=null;if("symbol-table"===u.type||f){var K=u.infos.map(x=>this._renderLegendForElementInfo(x,F,f,u.legendType)).filter(x=>!!x);
K.length&&(z=p.jsx("div",{class:"esri-legend__layer-body"},K))}else"color-ramp"===u.type||"opacity-ramp"===u.type||"heatmap-ramp"===u.type||"stretch-ramp"===u.type?z=this._renderLegendForRamp(u,F.opacity):"relationship-ramp"===u.type?z=O.renderRelationshipRamp(u,this.id,F.opacity):"univariate-above-and-below-ramp"===u.type&&(z=this._renderUnivariateAboveAndBelowRamp(u,F.opacity));if(!z)return null;K=u.title;var l=null;"string"===typeof K?l=K:K&&(l=G.getTitle(this.messages,K,H||b),l=G.isRendererTitle(K,
H||b)&&K.title?`${K.title} (${l})`:l);H=g?"esri-legend__layer-child-table":"esri-legend__layer-table";b=l?p.jsx("div",{class:"esri-legend__layer-caption"},l):null;return p.jsx("div",{class:this.classes(H,{["esri-legend__layer-table--size-ramp"]:f||!g})},b,z)};k._renderUnivariateAboveAndBelowRamp=function(u,F){const {sizeRampElement:g,colorRampElement:H}=O.getUnivariateAboveAndBelowRampElements(u,F);var b=O.getUnivariateAboveAndBelowColorRampSize(g,"above");u=O.getUnivariateAboveAndBelowColorRampSize(g,
"below");const f=O.getUnivariateAboveAndBelowColorRampPreview(H,{width:12,height:b,rampAlignment:"vertical",opacity:F,type:"above"});F=O.getUnivariateAboveAndBelowColorRampPreview(H,{width:12,height:u,rampAlignment:"vertical",opacity:F,type:"below"});var z=O.getUnivariateAboveAndBelowColorRampMargin(g);const K=g.infos.map(U=>U.label),l=K.map((U,Y)=>{const ea=2===Y;return 0===Y?p.jsx("div",{key:Y,class:U?f?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},U):ea?p.jsx("div",
null):null}),x=K.map((U,Y)=>2===Y||4===Y?p.jsx("div",{key:Y,class:U?f?"esri-univariate-above-and-below-ramp__label":"esri-legend__ramp-label":null},U):null),R={display:"table-cell",verticalAlign:"middle"};z={marginTop:`${z}px`};b={height:`${b}px`};u={height:`${u}px`};return p.jsx("div",{key:"univariate-above-and-below-ramp-preview",styles:M},p.jsx("div",{class:"esri-legend__layer-body"},g.infos.map((U,Y)=>p.jsx("div",{class:this.classes("esri-legend__layer-row","esri-legend__size-ramp")},p.jsx("div",
{class:"esri-legend__symbol",styles:R,bind:U.preview,afterCreate:G.attachToNode}),f||0!==Y%2?null:p.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},K[Y])))),f?p.jsx("div",{styles:z,key:"color-ramp-preview"},p.jsx("div",{styles:P},p.jsx("div",{styles:B},p.jsx("div",{class:"esri-legend__ramps",bind:f,afterCreate:G.attachToNode})),p.jsx("div",{styles:B},p.jsx("div",{class:"esri-legend__ramp-labels",styles:b},l))),p.jsx("div",{styles:P},p.jsx("div",{styles:B},p.jsx("div",{class:"esri-legend__ramps",
bind:F,afterCreate:G.attachToNode})),p.jsx("div",{styles:B},p.jsx("div",{class:"esri-legend__ramp-labels",styles:u},x)))):null)};k._renderLegendForRamp=function(u,F){const g=u.infos,H="heatmap-ramp"===u.type,b="stretch-ramp"===u.type,f=u.preview;f.className=`${"esri-legend__color-ramp"} ${"opacity-ramp"===u.type?"esri-legend__opacity-ramp":""}`;null!=F&&(f.style.opacity=F.toString());u=g.map(z=>p.jsx("div",{class:z.label?"esri-legend__ramp-label":null},H?this.messages[z.label]:b?this._getStretchStopLabel(z):
z.label));F={height:f.style.height};return p.jsx("div",{class:"esri-legend__layer-row"},p.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},p.jsx("div",{class:"esri-legend__ramps",bind:f,afterCreate:G.attachToNode})),p.jsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},p.jsx("div",{class:"esri-legend__ramp-labels",styles:F},u)))};k._getStretchStopLabel=function(u){return u.label?this.messages[u.label]+": "+d.formatNumber(u.value,
{style:"decimal",notation:-1<u.value.toString().indexOf("e")?"scientific":"standard"}):""};k._renderLegendForElementInfo=function(u,F,g,H){if(u.type)return this._renderLegendForElement(u,F,!0);let b=null;H=G.isImageryStretchedLegend(F,H);u.preview?b=p.jsx("div",{class:"esri-legend__symbol",bind:u.preview,afterCreate:G.attachToNode}):u.src&&(b=this._renderImage(u,F,H));if(!b)return null;F={["esri-legend__imagery-layer-info--stretched"]:H};return p.jsx("div",{class:"esri-legend__layer-row"},p.jsx("div",
{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",{["esri-legend__imagery-layer-info--stretched"]:H,["esri-legend__size-ramp"]:!H&&g})},b),p.jsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",F)},G.getTitle(this.messages,u.label,!1)||""))};k._renderImage=function(u,F,g){const {label:H,src:b,opacity:f}=u;g={["esri-legend__imagery-layer-image--stretched"]:g,["esri-legend__symbol"]:!g};F={opacity:`${null!=f?f:F.opacity}`};return p.jsx("img",
{alt:G.getTitle(this.messages,H,!1),src:b,border:0,width:u.width,height:u.height,class:this.classes(g),styles:F})};return e}(J);N.__decorate([E.renderable(),y.property()],r.prototype,"activeLayerInfos",void 0);N.__decorate([y.property(),E.renderable(),w.messageBundle("esri/widgets/Legend/t9n/Legend")],r.prototype,"messages",void 0);N.__decorate([y.property({readOnly:!0})],r.prototype,"type",void 0);return r=N.__decorate([T.subclass("esri.widgets.Legend.styles.Classic")],r)})},"*noref":1}});
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/accessorSupport/decorators/cast ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/Handles ../core/watchUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic".split(" "),function(D,
N,r,v,t,y,L,T,S,m,n,d,h,C,w,E,p,J,O,G,M,P){r=function(B){function c(k,u){k=B.call(this,k,u)||this;k._handles=new h;k.activeLayerInfos=null;k.basemapLegendVisible=!1;k.groundLegendVisible=!1;k.keepCacheOnDestroy=!1;k.respectLayerVisibility=!0;k.iconClass="esri-icon-layer-list";k.label=void 0;k.layerInfos=null;k.messages=null;k.style=new P;k.view=null;k.viewModel=new G;return k}D._inheritsLoose(c,B);var e=c.prototype;e.initialize=function(){this.own(C.on(this,"activeLayerInfos","change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),
C.init(this,"style",(k,u)=>{u&&k!==u&&u.destroy();k&&(k.activeLayerInfos=this.activeLayerInfos,"card"===k.type&&(k.view=this.view))}))};e.destroy=function(){this._handles.destroy();this._handles=null};e.castStyle=function(k){if(k instanceof M||k instanceof P)return k;if("string"===typeof k)return"card"===k?new M:new P;if(k&&"string"===typeof k.type){const u={...k};delete u.type;return new ("card"===k.type?M:P)(u)}return new P};e.render=function(){return J.jsx("div",{class:this.classes("esri-legend",
"esri-widget",this.style instanceof P?"esri-widget--panel":null)},this.style.render())};e._refreshActiveLayerInfos=function(k){this._handles.removeAll();k.forEach(u=>this._renderOnActiveLayerInfoChange(u));this.scheduleRender()};e._renderOnActiveLayerInfoChange=function(k){var u=C.init(k,"version",()=>this.scheduleRender());this._handles.add(u,`version_${k.layer.uid}`);u=C.on(k,"children","change",()=>{k.children.forEach(F=>this._renderOnActiveLayerInfoChange(F))});this._handles.add(u,`children_${k.layer.uid}`);
k.children.forEach(F=>this._renderOnActiveLayerInfoChange(F))};return c}(O);N.__decorate([y.aliasOf("viewModel.activeLayerInfos"),p.renderable()],r.prototype,"activeLayerInfos",void 0);N.__decorate([y.aliasOf("viewModel.basemapLegendVisible"),p.renderable()],r.prototype,"basemapLegendVisible",void 0);N.__decorate([y.aliasOf("viewModel.groundLegendVisible"),p.renderable()],r.prototype,"groundLegendVisible",void 0);N.__decorate([y.aliasOf("viewModel.keepCacheOnDestroy")],r.prototype,"keepCacheOnDestroy",
void 0);N.__decorate([y.aliasOf("viewModel.respectLayerVisibility"),p.renderable()],r.prototype,"respectLayerVisibility",void 0);N.__decorate([t.property()],r.prototype,"iconClass",void 0);N.__decorate([t.property({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],r.prototype,"label",void 0);N.__decorate([y.aliasOf("viewModel.layerInfos"),p.renderable()],r.prototype,"layerInfos",void 0);N.__decorate([t.property(),p.renderable(),E.messageBundle("esri/widgets/Legend/t9n/Legend")],r.prototype,
"messages",void 0);N.__decorate([t.property(),p.renderable()],r.prototype,"style",void 0);N.__decorate([L.cast("style")],r.prototype,"castStyle",null);N.__decorate([y.aliasOf("viewModel.view"),p.renderable()],r.prototype,"view",void 0);N.__decorate([t.property(),p.renderable(["view.size"])],r.prototype,"viewModel",void 0);return r=N.__decorate([S.subclass("esri.widgets.Legend")],r)});