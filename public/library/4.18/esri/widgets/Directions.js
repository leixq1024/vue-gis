// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../chunks/_rollupPluginBabelHelpers ../chunks/tslib.es6 ../core/has ../core/Logger ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/aliasOf ../core/jsonMap ../core/accessorSupport/decorators/subclass ../core/urlUtils ../core/uuid ../portal/support/resourceExtension ../core/events ../core/Collection ../intl/date ../intl/number ../intl/substitute ../assets ../intl ../core/Handles ../core/watchUtils ../intl/moment ./support/widgetUtils ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/decorators/renderable ../chunks/index ./Widget ../chunks/sortable.esm ./support/DatePicker ./Search ./Directions/support/directionsUtils ./Directions/DirectionsViewModel ./Directions/support/CostSummary ./Directions/support/maneuverUtils ./Directions/support/RouteSections ./support/TimePicker".split(" "),
function(N,m,k,ka,la,w,r,ma,O,na,oa,pa,z,P,Q,H,F,R,qa,S,t,T,ra,x,G,D,d,U,V,W,X,B,I,Y,Z,aa,ba){function ca(q){q=q.getTimezoneOffset();const y=Math.abs(Math.floor(q)%60);return`GMT${0<q?"-":"+"}${H.formatNumber(Math.abs(Math.floor(q/60)),J)}${H.formatNumber(y,J)}`}function K(q){return!(null==q.composedPath||!q.composedPath().find(y=>{var e;return null==(e=y.classList)?void 0:e.contains("esri-search__suggestions-list")}))}const da=R.getAssetUrl("esri/themes/base/images/maneuvers/"),ea={hour:"numeric",
minute:"numeric"},J={minimumIntegerDigits:2};k=function(q){function y(a,c){var b=q.call(this,a,c)||this;b._autoStopRemovalDelay=100;b._costSummary=new Y;b._departureTime="now";b._datePicker=new W;b._handles=new S;b._newPlaceholderStop=null;b._pointerPressedSearchSuggestionStop=null;b._routeSections=new aa;b._stops=new P([{},{}]);b._stopsToSearches=new Map;b._timePicker=new ba;b.goToOverride=null;b.iconClass="esri-icon-directions";b.label=void 0;b.lastRoute=null;b.maxStops=null;b.messages=null;b.messagesCommon=
null;b.messagesUnits=null;b.routeServiceUrl=null;b.routeSymbol=null;b.searchProperties=null;b.stopSymbols=null;b.view=null;b.viewModel=new I;b._setUpDragAndDropStops=f=>{b._sortable=V.Sortable.create(f,{draggable:".esri-directions__stop-row--valid",ghostClass:"esri-directions__stop-row-ghost",handle:".esri-directions__stop-handle",onEnd:b._handleStopInputDragEnd})};b._handleDragHandlePointerDown=()=>b._stops.forEach(f=>b._acquireSearch(f).activeMenu="none");b._handleStopInputDragEnd=({oldIndex:f,
newIndex:g,target:n})=>{if(f!==g){var {children:l}=n,h=l[f];n.insertBefore(l[g],0>g-f?h.nextElementSibling:h);n=b._stops;n.reorder(n.getItemAt(f),g);b._processStops()}};return b}N._inheritsLoose(y,q);var e=y.prototype;e.loadLocale=async function(){this._moment=await T.loadMoment()};e.initialize=function(){this.own([t.init(this,"viewModel.lastRoute",()=>{this._routeSections.routePath=this.get("viewModel.directionLines");this._focusedManeuver=this._activeManeuver=null;this.scheduleRender()}),t.init(this,
"viewModel.selectedTravelMode, viewModel.departureTime",()=>{1<this.get("viewModel.stops.length")&&this.getDirections()}),t.when(this,"view",(a,c)=>{c&&(this._viewClickHandle=null,this._handles.remove(c));if(a){c=this._prepPointerDownUpClick();const b=this._prepViewClick();c.pause();b.pause();this._handles.add([z.on(a.surface,"mousedown",()=>this._autoStopRemovalDelay=500),z.on(a.surface,"mouseup",()=>this._autoStopRemovalDelay=100),c,b],this.view.surface);this._pointerDownUpHandle=c;this._viewClickHandle=
b}}),t.whenOnce(this,"routeServiceUrl",()=>this.viewModel.load()),t.watch(this,"viewModel.stops.length",a=>{0===a&&(this._stops.toArray().forEach(c=>this._removeStop(c,!0)),this._stops.addMany([{},{}]),this.scheduleRender())})])};e.destroy=function(){this._datePicker.destroy();this._timePicker.destroy();this._stopsToSearches.forEach(a=>a.destroy());this._sortable&&this._sortable.destroy()};e.getDirections=function(){return null};e.zoomToRoute=function(){};e.render=function(){return d.jsx("div",{class:this.classes("esri-directions esri-widget esri-widget--panel",
"esri-directions__scroller")},this._renderPanelContent())};e._renderPanelContent=function(){var {viewModel:{state:a}}=this,c="initializing"===a;const b="error"===a&&!this.viewModel.serviceDescription,f="unauthenticated"===a;a={["esri-directions__panel-content--loading"]:c,["esri-directions__panel-content--error"]:b,["esri-directions__panel-content--sign-in"]:f};const g=c?"presentation":"group";c=f?this._renderSignIn():b?this._renderMessage(this._getErrorMessage()):c?this._renderLoader():this._renderReadyContent();
return d.jsx("div",{class:this.classes("esri-directions__panel-content",a),role:g},c)};e._renderReadyContent=function(){return[this._renderStopsContainer(),this._renderTravelModeOptions(),this._renderDepartureTimeControls(),this._renderSectionSplitter(),this._renderDirectionsContainer(),this._renderDisclaimer()]};e._renderSignIn=function(){return d.jsx("div",{key:"sign-in",class:"esri-directions__sign-in-content"},d.jsx("h2",{class:this.classes("esri-widget__heading","esri-directions__content-title")},
this.messages.widgetLabel),this._renderPlaceholder(),d.jsx("h3",{class:"esri-widget__heading"},this.messages.signInRequired),d.jsx("button",{class:this.classes("esri-button","esri-button--secondary","esri-directions__sign-in-button"),tabIndex:0,onclick:this._handleSignInClick,bind:this,type:"button"},this.messagesCommon.auth.signIn))};e._handleSignInClick=function(){this.viewModel.load().catch(()=>{})};e._renderTravelModeOptions=function(){const {travelModes:a}=this.viewModel;if(0===a.length)return null;
const {selectedTravelMode:c}=this.viewModel,b=c.name||this.messages.travelMode;return d.jsx("select",{"aria-label":b,bind:this,class:this.classes("esri-directions__travel-modes-select","esri-select"),key:"esri-directions__travel-mode-options",onchange:this._handleTravelModeChange,title:b},a.map(f=>d.jsx("option",{key:f,"data-mode":f,selected:f.id===c.id,value:f.id},f.name)))};e._handleTravelModeChange=function(a){a=a.currentTarget;a=a.item(a.selectedIndex);this.viewModel.selectedTravelMode=a["data-mode"]};
e._renderStopsContainer=function(){return d.jsx("div",{class:"esri-directions__section",key:"esri-directions__stops-container",role:"group"},this._renderStops())};e._renderDepartureTimeControls=function(){const a="now"===this._departureTime,{messages:c}=this,b=c.departureTime;return d.jsx("div",{class:"esri-directions__departure-time",key:"esri-directions__departure-time-controls",role:"group"},d.jsx("select",{"aria-label":b,bind:this,class:this.classes("esri-directions__departure-time-select","esri-select"),
onchange:this._handleDepartureOptionChange,title:b},d.jsx("option",{value:"now",selected:a},c.leaveNow),d.jsx("option",{value:"depart-by",selected:!a},c.departBy)),a?null:this._renderTimeControls())};e._renderStops=function(){const a=this._stops;let c=0;a.forEach(l=>{"none"!==this._acquireSearch(l).activeMenu&&(c+=1)});const b=a.toArray().map((l,h)=>{var p=a.length,u=1<h&&!l.result;const fa={["esri-icon-radio-unchecked"]:0<=h&&h<p-1,["esri-icon-radio-checked"]:h===p-1},ha={["esri-directions__stop-icon-container--last"]:h===
p-1},ia={["esri-directions__stop-row--valid"]:!u};var v=a.getItemAt(p-1),A=v&&v.result;v=(v=a.getItemAt(h+1))&&v.result;var C=h===p-1,E=h===p-2;v=2===p&&0===h||2<p&&!C&&!E||2<p&&E&&v||2<p&&C&&!l.result;p=2===p||3===p&&!A||u;u=this._acquireSearch(l);({messages:A}=this);const {removeStop:L,reverseStops:M,unlocated:ja}=A;A=F.substitute(A.stopLabelTemplate,{number:h+1,label:l.result?l.result.name:ja});C=`${this.id}__stop--${h}`;l=!!u.searchTerm&&!!u.selectedResult&&!!l.result&&u.selectedResult===l.result;
E={zIndex:"none"!==u.activeMenu?`${c--}`:""};return d.jsx("li",{"aria-label":A,afterCreate:this._handleStopFieldCreation,bind:this,class:this.classes("esri-directions__stop-row",ia),id:C,key:h,"data-stop-index":h,styles:E},d.jsx("div",{class:"esri-directions__stop-handle"},d.jsx("span",{"aria-hidden":"true",class:this.classes("esri-directions__stop-icon","esri-icon-handle-vertical","esri-directions__stop-handle-icon","esri-directions__stop-icon--interactive"),onpointerdown:this._handleDragHandlePointerDown}),
d.jsx("div",{bind:this,"aria-labelledby":C,class:this.classes("esri-directions__stop-icon-container",ha),"data-stop-index":h,onclick:this._handleStopIconClick,onkeydown:this._handleStopIconClick,role:"button"},d.jsx("span",{class:this.classes("esri-directions__stop-icon",fa),tabindex:l?"0":null}))),d.jsx("div",{class:"esri-directions__stop-input"},u.render()),d.jsx("div",{class:"esri-directions__stop-options",role:"group"},d.jsx("div",{"aria-label":L,class:"esri-directions__remove-stop",bind:this,
"data-stop-index":h,hidden:p,onkeydown:this._handleRemoveStop,onclick:this._handleRemoveStop,role:"button",tabIndex:0,title:L},d.jsx("span",{"aria-hidden":"true",class:this.classes("esri-directions__stop-icon","esri-directions__remove-stop-icon","esri-icon-trash","esri-directions__stop-icon--interactive")}),d.jsx("span",{class:"esri-icon-font-fallback-text"},"removeStopTitle")),d.jsx("div",{"aria-label":M,class:"esri-directions__reverse-stops",bind:this,hidden:v,onkeydown:this._handleReverseStops,
onclick:this._handleReverseStops,role:"button",tabIndex:0,title:M},d.jsx("span",{"aria-hidden":"true",class:this.classes("esri-directions__stop-icon","esri-icon-up-down-arrows","esri-directions__stop-icon--interactive")}),d.jsx("span",{class:"esri-icon-font-fallback-text"},"removeStopTitle"))))});var f=a.every(l=>{const h=this._stopsToSearches.get(l);return l.result&&h.selectedResult===l.result});const g=this._stops.length>=this.maxStops,n=this.messages.addStop;f=2<=a.length&&f&&!g?d.jsx("div",{"aria-label":n,
bind:this,class:"esri-directions__add-stop",key:"esri-directions__add-stop",onfocus:this._handleAddStopFocus,tabIndex:0},d.jsx("span",{"aria-hidden":"true",class:this.classes("esri-icon-plus","esri-directions__stop-icon","esri-directions__stop-icon--interactive")}),d.jsx("div",{"aria-hidden":"true",class:"esri-directions__add-stop-text"},n)):null;return d.jsx("div",null,d.jsx("ol",{class:"esri-directions__stops",role:"group",afterCreate:this._setUpDragAndDropStops},b),f)};e._handleStopIconClick=function(a){(a=
this._stops.getItemAt(a.currentTarget["data-stop-index"]))&&a.result&&this._centerAtStop(a)};e._handleClearRouteClick=function(){this.viewModel.reset()};e._centerAtStop=function(a){this.viewModel.centerAt(a.result.feature)};e._handleStopFieldCreation=function(a){const c=this._newPlaceholderStop;if(c){a=this._stops.getItemAt(a["data-stop-index"]);if(c===a){const b=this._acquireSearch(a);b.when(()=>{this.renderNow();b.focus()})}this._newPlaceholderStop=null}};e._handleStopInputBlur=function(a,c){this._handles.remove("awaiting-view-click-stop");
this.view.cursor=this._previousCursor;a.selectedResult&&c.result&&a.selectedResult===c.result?this._pointerDownUpHandle.pause():"none"!==a.activeMenu||!a.searchTerm||a.selectedResult===c.result&&(a.selectedResult||c.result)?a.searchTerm||(this._viewClickHandle.resume(),clearTimeout(this._autoStopRemovalTimeoutId),this._autoStopRemovalTimeoutId=setTimeout(()=>{this.destroyed||(this._viewClickHandle.pause(),"searching"===a.viewModel.state?this._pointerDownUpHandle.pause():this._pointerPressedSearchSuggestionStop||
(this._removeStop(c),c.result&&(c.result=null,this._processStops()),this.scheduleRender()))},this._autoStopRemovalDelay)):(a.search(),this._pointerDownUpHandle.pause())};e._handleStopInputFocus=function(a,c){this._pointerDownUpHandle.resume();if(!this._handles.has("awaiting-view-click-stop")){var {view:b,view:{cursor:f}}=this;this._previousCursor=f;this._handles.add(t.init(a,"searchTerm",g=>{b.cursor=0===g.length?"copy":f}),"awaiting-view-click-stop");this._activeStop=c}};e._prepViewClick=function(){const a=
this.get("viewModel.view"),c=z.pausable(a,"click",this._handleViewClick.bind(this)),b=z.pausable(a.surface,"click",()=>{clearTimeout(this._autoStopRemovalTimeoutId);b.pause()});return{remove(){b.remove();c.remove()},pause(){b.pause();c.pause()},resume(){b.resume();c.resume()}}};e._prepPointerDownUpClick=function(){const a=z.pausable(document,"pointerdown",b=>{this._pointerPressedSearchSuggestionStop=K(b)?this._activeStop:null}),c=z.pausable(document,"pointerup",b=>{this._pointerDownUpHandle.pause();
b=K(b);const f=this._activeStop;b||f!==this._pointerPressedSearchSuggestionStop||this._removeStop(f);this.scheduleRender();this._pointerPressedSearchSuggestionStop=b?this._activeStop:null});return{remove(){c.remove();a.remove()},pause(){c.pause();a.pause()},resume(){a.resume()}}};e._handleViewClick=function(a){const c=this._stopsToSearches.get(this._activeStop);c&&!c.searchTerm&&(c.search(a.mapPoint).then(b=>{b=b.results[0].results[0];const f=this._activeStop;f.result=b;f.result.feature.attributes.Name=
b.name;c.searchTerm=b.name}),this.scheduleRender());this._viewClickHandle.pause();clearTimeout(this._autoStopRemovalTimeoutId)};e._handleAddStopFocus=function(){this._addNewPlaceholder()};e._addNewPlaceholder=function(){this._pointerDownUpHandle.pause();if(!this._newPlaceholderStop){var a={};this._stops.add(a);this._newPlaceholderStop=a}};e._handleReverseStops=function(){this._reverseStops()};e._reverseStops=function(){this._stops.reverse();this._processStops()};e._handleRemoveStop=function(a){this._removeStop(this._stops.getItemAt(a.currentTarget["data-stop-index"]));
this._processStops()};e._removeStop=function(a,c=!1){2>=this._stops.length&&!c||(this._disposeSearch(a),this._stops.remove(a))};e._handleDepartureOptionChange=function(){var a=event.currentTarget;a=a.item(a.selectedIndex);"now"===a.value?(this._departureTime="now",this.viewModel.departureTime="now",this._handles.remove("departure-time-controls")):"depart-by"===a.value&&(this._departureTime="depart-by",this._handles.add([t.init(this._datePicker,"value",()=>this._updateDepartureTime()),t.init(this._timePicker,
"value",()=>this._updateDepartureTime())],"departure-time-controls"))};e._updateDepartureTime=function(){var a=this._moment(this._datePicker.value);const c=this._moment(this._timePicker.value);a=this._moment({date:a.date(),month:a.month(),year:a.year(),hour:c.hour(),minute:c.minute()});this.viewModel.departureTime=a.toDate()};e._renderTimeControls=function(){return d.jsx("div",{class:"esri-directions__departure-time-controls",key:"esri-directions__time-controls",role:"group"},this._datePicker.render(),
this._timePicker.render())};e._renderSectionSplitter=function(){return d.jsx("div",{class:"esri-directions__section-splitter"})};e._renderDisclaimer=function(){var {messages:a}=this;a=F.substitute(a.disclaimer,{esriTerms:`<a class="${"esri-widget__anchor"}" href="http://www.esri.com/legal/software-license" rel="noreferrer" target="_blank">${a.esriTerms}</a>`});return d.jsx("div",{class:"esri-directions__disclaimer",innerHTML:a,key:"esri-directions__disclaimer"})};e._renderDirectionsContainer=function(){return d.jsx("div",
{class:this.classes("esri-directions__directions-section","esri-directions__section"),key:"esri-directions__container"},this._renderDirectionsContainerContent())};e._renderLoader=function(){return d.jsx("div",{class:"esri-directions__loader",key:"loader"})};e._renderWarningCard=function(){return d.jsx("div",{class:"esri-directions__warning-card",role:"alert"},d.jsx("div",{class:"esri-directions__warning-header"},d.jsx("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),d.jsx("div",{class:this.classes("esri-widget__heading",
"esri-directions__warning-heading")},this.messagesCommon.warning)),d.jsx("div",{class:"esri-directions__warning-message"},this._getErrorMessage()))};e._renderDirectionsContainerContent=function(){const {lastRoute:a,state:c}=this.viewModel,b="routing"===c;return"error"===c?this._renderWarningCard():b?this._renderLoader():a?d.jsx("div",{class:"esri-directions__summary",key:"esri-directions__summary",role:"group"},this._renderCosts(),this._renderRouteActions(),this._renderManeuverSections()):d.jsx("div",
{key:"esri-directions__placeholder",class:"esri-widget__content--empty"},this._renderPlaceholder(),d.jsx("h3",{class:this.classes("esri-directions__message","esri-widget__heading")},this.messages.directionsPlaceholder))};e._renderPlaceholder=function(){return d.jsx("svg",{class:"esri-widget__content-illustration--empty",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256"},d.jsx("path",{fill:"currentcolor",d:"M192 36c-15.477 0-24 6.034-24 16.99v45.822l24 24 24-24v-45.82C216 42.033 207.477 36 192 36zm20 61.155l-20 20-20-20V52.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM192 52a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zM92 140.99C92 130.035 83.477 124 68 124s-24 6.034-24 16.99v45.822l24 24 24-24zm-4 44.165l-20 20-20-20V140.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM68 140a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zm84-44h16v4h-16zm-24 80h4v12h-12v-4h8zm0-28h4v16h-4zm0-52h12v4h-8v8h-4zm0 24h4v16h-4zm-36 64h16v4H92z"}))};
e._renderMessage=function(a){return d.jsx("h3",null,a)};e._renderRouteActions=function(){return d.jsx("div",{class:"esri-directions__route-actions"},d.jsx("button",{"aria-label":this.messages.clearRoute,class:this.classes("esri-directions__clear-route-button","esri-button","esri-button--tertiary"),tabIndex:0,onclick:this._handleClearRouteClick,bind:this,type:"button"},this.messages.clearRoute))};e._renderManeuverSections=function(){const {sections:a}=this._routeSections;return d.jsx("div",{class:"esri-directions__maneuvers",
role:"group"},a.map((c,b)=>{const {open:f}=c;let g;0<c.maneuvers.length&&f&&(g=d.jsx("ol",{class:"esri-directions__maneuver-list"},c.maneuvers.map(p=>this._renderManeuver(p))));var n=2<a.length;const l=b===a.length-1;b={["esri-directions__maneuver-section--collapsible"]:n};const h={["esri-icon-down"]:!f,["esri-icon-up"]:f};n&&!l?(n=f?this.messagesCommon.open:this.messagesCommon.close,c=d.jsx("header",{class:this.classes("esri-directions__maneuver-section-header","esri-directions__maneuver-section-toggle"),
key:"esri-directions__maneuver-section-header"},d.jsx("div",{"aria-expanded":f,"aria-label":n,bind:this,class:"esri-directions__maneuver-section-header-toggle-button","data-maneuver-section":c,onkeydown:this._handleSectionToggle,onclick:this._handleSectionToggle,role:"button",tabIndex:0,title:n},d.jsx("h2",{class:this.classes("esri-widget__heading","esri-directions__maneuver-section-title")},c.name),d.jsx("span",{"aria-hidden":"true",class:this.classes(h)})))):c=d.jsx("header",{class:"esri-directions__maneuver-section-header",
key:"esri-directions__maneuver-section-header"},d.jsx("h2",{class:this.classes("esri-widget__heading","esri-directions__maneuver-section-title")},c.name));return d.jsx("section",{class:this.classes("esri-directions__maneuver-section",b)},c,g)}))};e._handleSectionToggle=function(a){a=a.currentTarget["data-maneuver-section"];a.open=!a.open};e._renderCosts=function(){var a=this.get("viewModel.directionLines"),c=new Date(a[a.length-1].attributes.arriveTimeUTC);a=this._costSummary.set({directionsViewModel:this.viewModel,
messages:this.messages,messagesUnits:this.messagesUnits});var {messages:b}=this;const f=b.zoomToRoute;var g=Q.formatDate(c,ea);c=F.substitute(b.etaTemplate,{time:`<strong>${g}</strong>`,gmt:`${ca(c)}`});g=b.primaryCosts;const n=b.secondaryCosts;b=b.eta;return d.jsx("div",{"aria-label":f,bind:this,class:"esri-directions__costs",onkeydown:this._handleSummaryInteraction,onclick:this._handleSummaryInteraction,role:"button",tabIndex:0,title:f},d.jsx("div",{class:"esri-directions__costs-details",role:"group"},
d.jsx("div",{"aria-label":g,class:"esri-directions__costs-value",title:g},a.primary),d.jsx("div",{class:"esri-directions__vertical-splitter"}),d.jsx("div",{"aria-label":n,class:"esri-directions__other-costs-total",title:n},a.secondary)),d.jsx("div",{"aria-label":b,innerHTML:c,title:b}))};e._handleSummaryInteraction=function(){this._focusedManeuver=this._activeManeuver=null;this.viewModel.clearHighlights();this.zoomToRoute()};e._getErrorMessage=function(){const {messages:a}=this,{error:c}=this.viewModel;
return"directions-view-model:unable-to-route"===c.name?a.errors.unableToRoute:"directions-view-model:service-metadata-unavailable"===c.name?a.errors.unableToLoadServiceMetadata:a.errors.unknownError};e._normalizeSearchSources=function(a){this._overrideDefaultSources(a);this._ensureLocationTypeOnLocatorSources(a)};e._overrideDefaultSources=function(a){a.viewModel.defaultSources.forEach(c=>{c.autoNavigate=!1})};e._ensureLocationTypeOnLocatorSources=function({allSources:a}){0!==a.length&&a.forEach(c=>
{"locator"in c&&c.locator&&null===c.locationType&&(c.locationType="street")})};e._acquireSearch=function(a){const c=this.get("viewModel.view");if(this._stopsToSearches.has(a)){const f=this._stopsToSearches.get(a);f.view=c;this._overrideDefaultSources(f);return f}const b=new X({view:c,resultGraphicEnabled:!1,popupEnabled:!1,...this.searchProperties});this._normalizeSearchSources(b);this._handles.add([t.on(b,"allSources","change",()=>this._normalizeSearchSources(b)),b.on("select-result",()=>{a.result=
b.selectedResult;a.result.feature.attributes.Name=b.selectedResult.name;this._processStops();this.scheduleRender()}),b.on("search-focus",()=>this._handleStopInputFocus(b,a)),b.on("search-blur",()=>this._handleStopInputBlur(b,a))],b);this._stopsToSearches.set(a,b);return b};e._disposeSearch=function(a){this._stopsToSearches.get(a).destroy();this._stopsToSearches.delete(a)};e._processStops=function(){const a=this.viewModel;a.stops.removeAll();a.stops.addMany(this._stops.filter(c=>!!c.result).map(c=>
c.result.feature));1<a.stops.length&&a.getDirections()};e._renderManeuver=function(a){let c;var {attributes:b}=a,f=this.get("viewModel.routeParameters.directionsLengthUnits");const {messages:g,messagesUnits:n}=this;f=B.formatDistance(g,n,b.length,{toUnits:f});var l=B.formatTime(b.time),h=B.getAssociatedStop(a);B.useSpatiallyLocalTime(a,this.get("viewModel.routeParameters.startTime"))?c=B.toSpatiallyLocalTimeString(g,b.arriveTimeUTC,b.ETA,"now"===this._departureTime):f&&(c=l?`${f}&nbsp;&middot;&nbsp;${l}`:
f);f=this._getFormattedManeuverText(a);b=this._getIconPath(b.maneuverType);if(h)return d.jsx("li",{class:"esri-directions__maneuver",key:a},d.jsx("header",null,h.attributes.Name));h=`esri-directions__maneuver-${a.uid}`;l=`esri-directions__cumulative-costs-${a.uid}`;const p=`esri-directions__intermediate-costs-${a.uid}`;return d.jsx("li",{"aria-labelledby":`${h} ${l} ${p}`,bind:this,class:this.classes("esri-directions__maneuver",{["esri-directions__maneuver--active"]:this._activeManeuver===a}),"data-maneuver":a,
key:a,onclick:this._handleManeuverClick,onkeydown:this._handleManeuverClick,onfocus:this._handleManeuverFocus,onmouseover:this._handleManeuverMouseOver,onmouseout:this._handleManeuverMouseOut,onblur:this._handleManeuverBlur,tabIndex:0},d.jsx("img",{alt:"",class:"esri-directions__maneuver-icon",src:b}),d.jsx("div",{class:"esri-directions__maneuver-costs-container"},d.jsx("span",{id:h,innerHTML:f}),d.jsx("div",{class:"esri-directions__maneuver-costs"},d.jsx("div",{class:"esri-directions__horizontal-splitter"}),
d.jsx("div",{id:l,"aria-label":g.cumulativeCosts,class:"esri-directions__cost--cumulative",innerHTML:"",title:g.cumulativeCosts}),d.jsx("div",{id:p,"aria-label":g.intermediateCosts,class:"esri-directions__cost--intermediate",innerHTML:c,title:g.intermediateCosts}))))};e._getIconPath=function(a){a=Z.toIconName(a);return`${da}${a}${2===window.devicePixelRatio?"@2x":""}.png`};e._handleManeuverClick=function(a){a=a.currentTarget["data-maneuver"];this._activeManeuver===a?(this._activeManeuver=null,this.zoomToRoute()):
(this._activeManeuver=a,this.viewModel.centerAt(a),this.viewModel.highlightSegment(a))};e._handleManeuverMouseOver=function(a){this._activeManeuver||this._focusedManeuver||this.viewModel.highlightSegment(a.currentTarget["data-maneuver"])};e._handleManeuverMouseOut=function(){this._activeManeuver||this._focusedManeuver||this.viewModel.clearHighlights()};e._handleManeuverBlur=function(){this._activeManeuver||(this._focusedManeuver=null,this.viewModel.clearHighlights())};e._handleManeuverFocus=function(a){this._activeManeuver||
(this._focusedManeuver=a=a.currentTarget["data-maneuver"],this.viewModel.highlightSegment(a))};e._getFormattedManeuverText=function(a){const {attributes:{text:c},strings:b}=a;if(!b)return c;let f=c;b.forEach(g=>{f=f.replace(g.string,`<strong>${g.string}</strong>`)});return f};return y}(U);m.__decorate([r.aliasOf("viewModel.goToOverride")],k.prototype,"goToOverride",void 0);m.__decorate([w.property()],k.prototype,"iconClass",void 0);m.__decorate([w.property({aliasOf:{source:"messages.widgetLabel",
overridable:!0}})],k.prototype,"label",void 0);m.__decorate([r.aliasOf("viewModel.lastRoute")],k.prototype,"lastRoute",void 0);m.__decorate([r.aliasOf("viewModel.maxStops")],k.prototype,"maxStops",void 0);m.__decorate([w.property(),D.renderable(),G.messageBundle("esri/widgets/Directions/t9n/Directions")],k.prototype,"messages",void 0);m.__decorate([w.property(),D.renderable(),G.messageBundle("esri/t9n/common")],k.prototype,"messagesCommon",void 0);m.__decorate([w.property(),D.renderable(),G.messageBundle("esri/core/t9n/Units")],
k.prototype,"messagesUnits",void 0);m.__decorate([r.aliasOf("viewModel.routeServiceUrl")],k.prototype,"routeServiceUrl",void 0);m.__decorate([r.aliasOf("viewModel.routeSymbol")],k.prototype,"routeSymbol",void 0);m.__decorate([w.property()],k.prototype,"searchProperties",void 0);m.__decorate([r.aliasOf("viewModel.stopSymbols")],k.prototype,"stopSymbols",void 0);m.__decorate([r.aliasOf("viewModel.view")],k.prototype,"view",void 0);m.__decorate([D.renderable(["lastRoute","state","travelModes"]),w.property({type:I})],
k.prototype,"viewModel",void 0);m.__decorate([r.aliasOf("viewModel.getDirections")],k.prototype,"getDirections",null);m.__decorate([r.aliasOf("viewModel.zoomToRoute")],k.prototype,"zoomToRoute",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleStopIconClick",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleClearRouteClick",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleReverseStops",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleRemoveStop",
null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleSectionToggle",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleSummaryInteraction",null);m.__decorate([x.accessibleHandler()],k.prototype,"_handleManeuverClick",null);return k=m.__decorate([O.subclass("esri.widgets.Directions")],k)});