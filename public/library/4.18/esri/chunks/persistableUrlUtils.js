// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports","../core/maybe","../core/urlUtils"],function(f,l,d){function g(b,a){var c=a&&a.url&&a.url.path;b&&c&&(b=d.makeAbsolute(b,c,{preserveProtocolRelative:!0}),a.portalItem&&a.readResourcePaths&&(c=d.makeRelative(b,a.portalItem.itemUrl),q.test(c)&&a.readResourcePaths.push(a.portalItem.resourceFromPath(c).path)));return h(b,a&&a.portal)}function k(b,a){if(!b)return b;!d.isAbsolute(b)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(b);let c=d.makeAbsolute(b);if(a){var e=a.verifyItemRelativeUrls&&
a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;e&&(e=h(e,a.portal),c=d.makeRelative(h(c,a.portal),e,e),c!==b&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(c))}b=c;c=(a=a&&a.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?d.changeDomain(b,`${a.urlKey}.${a.customBaseUrl}`,a.portalHostname):b;d.isAbsolute(c)&&(c=d.normalize(c));return c}function m(b,a,c){return g(b,c)}function n(b,a,c,e){b=k(b,e);void 0!==b&&(a[c]=b)}function p(b){b=l.isSome(b)?b.match(r):null;return l.isSome(b)?
b[1]:null}function h(b,a){if(!a||a.isPortal||!a.urlKey||!a.customBaseUrl)return b;const c=`${a.urlKey}.${a.customBaseUrl}`;return d.hasSameOrigin(d.appUrl,`${d.appUrl.scheme}://${c}`)?d.changeDomain(b,a.portalHostname,c):d.changeDomain(b,c,a.portalHostname)}const r=/\/items\/([^\/]+)\/resources\//,q=/^\.\/resources\//;var t=Object.freeze({__proto__:null,fromJSON:g,toJSON:k,read:m,write:n,itemIdFromResourceUrl:p});f.fromJSON=g;f.itemIdFromResourceUrl=p;f.persistableUrlUtils=t;f.read=m;f.toJSON=k;f.write=
n});