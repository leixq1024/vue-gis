// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define(["exports","../../../chunks/_rollupPluginBabelHelpers","./terrainUtils","./tileUtils","./TileAgent"],function(f,g,h,k,l){let m=function(){function d(a,b){this._pool=b;this.waitingAgents=[];this.requestAbort=this.requestPromise=this.loadingAgent=this._upsampleInfo=this.data=null;this.pendingUpdates=0;this.elevationBounds=void 0;this.init(a)}var c=d.prototype;c.init=function(a){this.waitingAgents.length=0;this.data=null;this.dataInvalidated=this.dataMissing=!1;this._unsetUpsampleInfo();this.requestAbort=
this.requestPromise=this.loadingAgent=null;this.pendingUpdates=0;0===a&&(this.elevationBounds=null)};c.invalidateSourceData=function(){this.dataInvalidated=!0;this.dataMissing=!1;this._unsetUpsampleInfo()};c.abortRequest=function(){this.requestPromise&&(this.requestAbort.abort(),this.requestAbort=this.requestPromise=null)};c.dispose=function(){this.loadingAgent&&this.loadingAgent!==l.TILE_AGENT_DONE&&this.loadingAgent.dispose();this.loadingAgent=null;this.abortRequest();this._unsetUpsampleInfo();
this.pendingUpdates=0;this.disposeData()};c.disposeData=function(){this.data=h.releaseTileData(this.data)};c._unsetUpsampleInfo=function(){this._upsampleInfo&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)};c.setUpsampleInfo=function(a,b){if(a===b||null==b)this._unsetUpsampleInfo();else{if(null==this._upsampleInfo)this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===b)return;this._upsampleInfo.tile.unrefMapData()}b.refMapData();
k.computeUpsampleInfo(a,b,this._upsampleInfo)}};d.makeEmptyLayerInfo=function(a,b,e){return e?(e.init(a),e):new d(a,b)};g._createClass(d,[{key:"upsampleInfo",get:function(){return this._upsampleInfo}}]);return d}();f.TilePerLayerInfo=m;Object.defineProperty(f,"__esModule",{value:!0})});