// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../symbols/FillSymbol3DLayer ../../../../symbols/PolygonSymbol3D ../../../../chunks/symbols ../../../../Graphic ../../../../core/watchUtils ../../../../geometry/support/aaBoundingRect ../../../../core/HandleOwner ../../support/debugFlags ../tileUtils".split(" "),
function(g,q,n,D,E,F,r,G,t,H,I,J,u,v,K,w,x,y,z,A,B){g.TerrainDebugPopupOpener=function(p){function l(){return p.apply(this,arguments)||this}q._inheritsLoose(l,p);var e=l.prototype;e.initialize=function(){this.handles.add(this.surface.view.on("click",this._clickEvent.bind(this)));A.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!0;this.surface.view.popup.autoOpenEnabled=!1;x.whenFalse(this.surface.view.popup,"visible",()=>{this._removeTileBoundaryGraphic()})};e.destroy=function(){this.surface.view.popup.autoOpenEnabled=
!0};e._clickEvent=function(b){this.surface.view.hitTest(b).then(a=>{a=a.intersector.results.min;if("TerrainRenderer"===a.intersector){const d=this.surface.getTile(a.name);this.surface.view.popup.actions.removeAll();this.surface.view.popup.open({title:`Tile ${a.name}`,location:b.mapPoint,content:this._createTileDataTable(d)});this._removeTileBoundaryGraphic();this.tileBoundaryGraphic=this._createTileBoundaryGraphic(d);this.surface.view.graphics.add(this.tileBoundaryGraphic)}})};e._createTileDataTable=
function(b){var a=this.surface.test.getTiles(),d=a.indexOf(b);const m=document.createElement("table");m.innerHTML=`<tr><th>Position</th><th>${d} of ${a.length}</th></tr>
      <tr>
        <th style='text-align:center;font-weight:bold'>type&nbsp;&nbsp;&nbsp;</th>
        <th style='text-align:center;font-weight:bold'>layer&nbsp;&nbsp;&nbsp;</th>
        <th style='text-align:center;font-weight:bold'>data from tile&nbsp;&nbsp;&nbsp;</th>
      </tr>`;for(a=0;a<b.layerInfo.length;a++){d=b.layerInfo[a];for(let h=0;h<d.length;h++){var f=d[h];const k=document.createElement("tr");let c;c=document.createElement("td");c.textContent=0===h?C[a]:"";k.appendChild(c);c=document.createElement("td");c.textContent=h.toString();k.appendChild(c);f=f.data?b:f.upsampleInfo?f.upsampleInfo.tile:null;c=document.createElement("td");c.textContent=f?B.tile2str(f):"no data";k.appendChild(c);m.appendChild(k)}}return m};e._removeTileBoundaryGraphic=function(){this.tileBoundaryGraphic&&
(this.surface.view.graphics.remove(this.tileBoundaryGraphic),this.tileBoundaryGraphic=null)};e._createTileBoundaryGraphic=function(b){b=y.toExtent(b.extent,this.surface.spatialReference);const a=new v({symbolLayers:[new u({material:{color:"rgba(0, 0, 0, 0)"},outline:{size:"3px",color:"red"}})]});return new w({geometry:b,symbol:a})};return l}(z.HandleOwner);n.__decorate([r.property({constructOnly:!0})],g.TerrainDebugPopupOpener.prototype,"surface",void 0);g.TerrainDebugPopupOpener=n.__decorate([t.subclass("esri.views.3d.terrain.support.TerrainDebugPopupOpener")],
g.TerrainDebugPopupOpener);const C=["elev","map"];Object.defineProperty(g,"__esModule",{value:!0})});