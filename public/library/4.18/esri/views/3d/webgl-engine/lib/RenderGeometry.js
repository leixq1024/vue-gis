// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../support/mathUtils ../../../../chunks/mat4 ../../../../chunks/mat4f64 ./geometryDataUtils ./Util ./Object3DStateSet ../materials/renderers/utils".split(" "),function(n,e,p,f,q,r,g,t,k,u,l){return function(){function h(a,b,d,m,v,w,x){this.uniqueName=null;this.shaderTransformationDirty=!0;this.data=a.toRenderData();this.boundingInfo=b;this.material=d;this.origin=null;this.center=
p.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=v;m&&this.updateTransformation(m,w);this.castShadow=x;this.instanceParameters={highlights:null,occludees:null,visible:!0}}var c=h.prototype;c.updateTransformation=function(a,b){this.transformation=a;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(a,b,this.center)};c.shaderTransformationChanged=function(){this.shaderTransformationDirty=!0};c.getBoundingSphere=function(a,b,d){b=b||q.maxScale(a);
f.transformMat4(d,this.boundingInfo.getCenter(),a);return this.boundingInfo.getBSRadius()*b};c.getShaderTransformation=function(){if(!this.calculateShaderTransformation)return e.unwrapOr(this.transformation,g.IDENTITY);this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=g.create()),r.copy(this.shaderTransformation,this.calculateShaderTransformation(e.unwrapOr(this.transformation,g.IDENTITY))),this.shaderTransformationDirty=!1);return this.shaderTransformation};c.computeAttachmentOrigin=
function(a){if(this.material.computeAttachmentOrigin)return this.material.computeAttachmentOrigin(this,a)?(e.isSome(this.transformation)&&f.transformMat4(a,a,this.transformation),!0):!1;const b=this.getIndices(k.VertexAttrConstants.POSITION),d=this.getAttribute(k.VertexAttrConstants.POSITION);return t.computeAttachmentOriginTriangles(d,b,a)?(e.isSome(this.transformation)&&f.transformMat4(a,a,this.transformation),!0):!1};c.getIndices=function(a){return"indices"in this.data?this.data.indices[a]:null};
c.getAttribute=function(a){return"vertexAttr"in this.data?this.data.vertexAttr[a]:null};c.addHighlight=function(){const a=u.generateObject3DStateId(0),b=this.instanceParameters;b.highlights=l.addObject3DStateID(b.highlights,a);return a};c.removeHighlight=function(a){const b=this.instanceParameters;b.highlights=l.removeObject3DStateID(b.highlights,a)};n._createClass(h,[{key:"hasShaderTransformation",get:function(){return!!this.calculateShaderTransformation}}]);return h}()});