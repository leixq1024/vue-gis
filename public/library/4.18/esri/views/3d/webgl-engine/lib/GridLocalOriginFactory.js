// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../../core/maybe ../../../../geometry/SpatialReference ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../geometry/projection ../../../../chunks/mat4f64 ./Util ./GeometryData ./Object3D ./Geometry ./localOrigin ./Layer ../materials/RibbonLineMaterial".split(" "),function(t,u,v,w,x,y,q,z,A,B,n,C,D){let E=0,p=function(){function m(){this.ROOT_ORIGIN_ID="rg_root_"+E++;this._origins=new Map;this._gridSize=42E5}var r=m.prototype;r.getOrigin=function(b){var e=this._origins.get(this.ROOT_ORIGIN_ID);
if(null==e){if(t.isSome(m.testOrigin)){var a=m.testOrigin;this._origins.set(this.ROOT_ORIGIN_ID,n.fromValues(a[0],a[1],a[2],this.ROOT_ORIGIN_ID));return this.getOrigin(b)}a=n.fromValues(b[0]+Math.random()-.5,b[1]+Math.random()-.5,b[2]+Math.random()-.5,this.ROOT_ORIGIN_ID);this._origins.set(this.ROOT_ORIGIN_ID,a);return a}w.subtract(f,b,e.vec3);f[0]=Math.abs(f[0]);f[1]=Math.abs(f[1]);f[2]=Math.abs(f[2]);a=this._gridSize;if(f[0]<a&&f[1]<a&&f[2]<a)return e;e=Math.round(b[0]/a);const c=Math.round(b[1]/
a);b=Math.round(b[2]/a);const k=`${"rg_"}${e}/${c}/${b}`;let g=this._origins.get(k);g||(g=n.fromValues(e*a,c*a,b*a,k),this._origins.set(k,g));return g};r._drawOriginBox=function(b){var e=window.view;const a=e._stage;if(null==this._object){this._material=new D.RibbonLineMaterial({width:2,color:[0,1,0,1]},"GridLocalOriginMaterial");a.add(3,this._material);var c=new C("GridLocalOrigin",{isPickable:!1});a.add(0,c);this._object=new A({idHint:"GridLocalOrigin",castShadow:!1});a.add(1,this._object);c.addObject(this._object);
a.addToViewContent([c.id])}const k=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],g=k.length;var h=new Float32Array(3*g);c=new Uint32Array(2*(g-1));const l=.5*this._gridSize;for(let d=0;d<g;d++)h[3*d]=b[0]+(k[d]&1?l:-l),h[3*d+1]=b[1]+(k[d]&2?l:-l),h[3*d+2]=b[2]+(k[d]&4?l:-l),0<d&&(c[2*d]=d-1,c[2*d+1]=d);x.projectBuffer(h,u.WebMercator,0,h,e.spatialReference,0,g);e={};e[q.VertexAttrConstants.POSITION]={size:3,data:h};h={};h[q.VertexAttrConstants.POSITION]=c;c=new z.GeometryData(e,h,"line");c=new B(c,"GridLocalOriginBox");
a.add(2,c);this._object.addGeometry(c,this._material,y.IDENTITY);console.log(this._origins.size,b)};return m}();const f=v.create();(p||(p={})).testOrigin=null;return p});