// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/DefaultVertexAttributeLocations ../../../webgl/Program ../../../webgl/renderState ../core/shaderLibrary/util/View.glsl ../lib/DefaultTextureUnits ../core/shaderLibrary/Slice.glsl ../core/shaderLibrary/output/OutputHighlight.glsl ../lib/OrderIndependentTransparency ../core/shaderLibrary/shading/ReadShadowMap.glsl ../core/shaderLibrary/shading/ScreenSpaceReflections.glsl ../core/shaderLibrary/shading/WaterDistortion.glsl ../../../../chunks/WaterSurface.glsl".split(" "),
function(t,n,r,g,e,m,f,u,v,p,q,w,x,y,l,z,A,B,C){m=function(k){function h(a,b){b=k.call(this,a,b)||this;b.waterTextureRepository=a.waterTextureRepository;return b}r._inheritsLoose(h,k);var c=h.prototype;c.initializeProgram=function(a){var b=h.shader.get();const d=this.configuration;b=b.build({OITEnabled:0===d.transparencyPassType,output:d.output,viewingMode:a.viewingMode,slicePlaneEnabled:d.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,receiveShadows:d.receiveShadows,
pbrMode:3,useCustomDTRExponentForWater:!0,ssrEnabled:d.useSSR,highStepCount:!0});return new v(a.rctx,b.generateSource("vertex"),b.generateSource("fragment"),u.Default3D)};c.ensureResource=function(a){this.waterTextureRepository.ready||this.waterTextureRepository.updating||this.waterTextureRepository.loadTextures(a);return this.waterTextureRepository.ready?2:1};c.bindPass=function(a,b,d){q.View.bindProjectionMatrix(this.program,d.camera.projectionMatrix);0===this.configuration.output&&(d.lighting.setUniforms(this.program,
!1),A.ScreenSpaceReflections.bindUniforms(this.program,a,d));if(0===this.configuration.output||2===this.configuration.output)B.WaterDistortion.bindUniforms(this.program,b),this.waterTextureRepository.bindRepo(a);this.program.setUniform4fv("waterColor",b.color);4===this.configuration.output&&y.OutputHighlight.bindOutputHighlight(a,this.program,d)};c.bindDraw=function(a){q.View.bindView(this.program,a);0!==this.configuration.output&&7!==this.configuration.output||q.View.bindCamPosition(this.program,
a.origin,a.camera.viewInverseTransposeMatrix);0===this.configuration.output&&z.ReadShadowMap.bindUniforms(this.program,a,w.DefaultTextureUnits.SHADOW_MAP);0!==this.configuration.output&&7!==this.configuration.output&&4!==this.configuration.output||x.Slice.bindUniformsWithOrigin(this.program,this.configuration,a)};c.setPipelineState=function(a){const b=this.configuration,d=3===a,D=2===a;return p.makePipelineState({blending:2!==b.output&&4!==b.output&&b.transparent?d?l.blendingDefault:l.OITBlending(a):
null,depthTest:{func:l.OITDepthTest(a)},depthWrite:d?b.writeDepth&&p.defaultDepthWriteParams:l.OITDepthWrite(a),colorWrite:p.defaultColorWriteParams,polygonOffset:d||D?null:l.getOITPolygonOffset(b.enableOffset)})};c.initializePipeline=function(){return this.setPipelineState(this.configuration.transparencyPassType)};return h}(m.ShaderTechnique);m.shader=new e.ReloadableShaderModule(C.WaterSurface,()=>new Promise(function(k,h){t(["../shaders/WaterSurface.glsl"],k,h)}));e=function(k){function h(){var c=
k.apply(this,arguments)||this;c.output=0;c.receiveShadows=!1;c.slicePlaneEnabled=!1;c.transparent=!1;c.enableOffset=!0;c.writeDepth=!1;c.useSSR=!1;c.isDraped=!1;c.transparencyPassType=3;return c}r._inheritsLoose(h,k);return h}(f.ShaderTechniqueConfiguration);g.__decorate([f.parameter({count:8})],e.prototype,"output",void 0);g.__decorate([f.parameter()],e.prototype,"receiveShadows",void 0);g.__decorate([f.parameter()],e.prototype,"slicePlaneEnabled",void 0);g.__decorate([f.parameter()],e.prototype,
"transparent",void 0);g.__decorate([f.parameter()],e.prototype,"enableOffset",void 0);g.__decorate([f.parameter()],e.prototype,"writeDepth",void 0);g.__decorate([f.parameter()],e.prototype,"useSSR",void 0);g.__decorate([f.parameter()],e.prototype,"isDraped",void 0);g.__decorate([f.parameter({count:4})],e.prototype,"transparencyPassType",void 0);n.WaterTechnique=m;n.WaterTechniqueConfiguration=e;Object.defineProperty(n,"__esModule",{value:!0})});