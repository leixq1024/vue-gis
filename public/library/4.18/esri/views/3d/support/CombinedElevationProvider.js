// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/maybe ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/promiseUtils ../../../core/Accessor ../../../core/Evented ../layers/graphics/ElevationQuery".split(" "),
function(l,r,q,B,t,C,D,u,E,w,F,G,H,v,x,y,z){function n(h,d,k,a,b,c,g){for(const e of d)d=e.getElevation(k,a,b,c,g),null!=d&&(h=null!=h?Math.max(d,h):d);return h}l.CombinedElevationProvider=function(h){function d(a){a=h.call(this,a)||this;a.im=[];a.ground=[];a.scene=[];a.handles=new Map;return a}r._inheritsLoose(d,h);var k=d.prototype;k.destroy=function(){this._elevationQuery=t.destroyMaybe(this._elevationQuery)};k.getElevation=function(a,b,c,g,e){let f;f=n(null,this.im,a,b,c,g,e);null==f&&(f=n(f,
this.ground,a,b,c,g,e));"scene"===e&&(f=n(f,this.scene,a,b,c,g,e));return f};k.queryElevation=function(a,b,c,g,e,f=null,A=0){const p=v.createResolver();this.elevationQuery.queryElevation(a,b,f,A).then(m=>{"scene"===e&&(m=n(m,this.scene,a,b,c,g,e));p.resolve(m)}).catch(m=>{v.isAbortError(m)?p.reject(m):p.resolve(this.getElevation(a,b,c,g,e))});return p.promise};k.register=function(a,b){this.handles.set(b,b.on("elevation-change",c=>this.emit("elevation-change",c)));this[a].push(b)};k.unregister=function(a){this.handles.has(a)&&
(this.handles.get(a).remove(),this.handles.delete(a));for(const b of[this.im,this.ground,this.scene]){const c=b.indexOf(a);-1<c&&b.splice(c,1)}};r._createClass(d,[{key:"elevationQuery",get:function(){t.isNone(this._elevationQuery)&&(this._elevationQuery=new z.ElevationQuery(this.view.resourceController.scheduler,this.view.spatialReference,()=>this.view.map&&this.view.map.ground,{maximumAutoTileRequests:4}));return this._elevationQuery}}]);return d}(y.EventedMixin(x));q.__decorate([u.property({constructOnly:!0})],
l.CombinedElevationProvider.prototype,"view",void 0);q.__decorate([u.property({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],l.CombinedElevationProvider.prototype,"spatialReference",void 0);l.CombinedElevationProvider=q.__decorate([w.subclass("esri.views.3d.support.CombinedElevationProvider")],l.CombinedElevationProvider);Object.defineProperty(l,"__esModule",{value:!0})});