// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../chunks/vec4 ../../webgl-engine/lib/GeometryUtil ../../layers/graphics/ElevationContext ../../webgl-engine/lib/Geometry ../../layers/graphics/pointUtils ./Object3DVisualElement ../../webgl-engine/shaders/ShadedColorMaterialTechnique ../../webgl-engine/materials/ShadedColorMaterial ../editingTools/settings".split(" "),function(p,q,v,w,x,k,y,z,r,A,l,m,t,e){function u(c,
f,d,a){c=y.createSphereGeometry(c,f,d,{attributes:{position:m.ShadedColorMaterialVertexAttrConstants.OFFSET,uv:null}});c.indices[m.ShadedColorMaterialVertexAttrConstants.POSITION]=new Uint32Array(c.indexCount);c.vertexAttributes[m.ShadedColorMaterialVertexAttrConstants.POSITION]={size:3,data:Float64Array.from(a),offsetIdx:0,strideIdx:3};return c}l=function(c){function f(a){var b=c.call(this,a)||this;b.view=null;b._renderOccluded=4;b._vertices=null;b._spatialReference=null;b._color=e.settings.colorToVec4(e.settings.reshapeManipulators.vertex.color);
b._size=e.settings.reshapeManipulators.vertex.size;b._outlineColor=e.settings.colorToVec4(e.settings.reshapeManipulators.vertex.outlineColor);b._outlineSize=e.settings.reshapeManipulators.vertex.outlineSize;b._elevationInfo=null;b.applyProps(a);return b}q._inheritsLoose(f,c);var d=f.prototype;d.updateMaterial=function(){this.attached&&this.vertexMaterial.setParameterValues(this.vertexMaterialParameters)};d.updateOutlineMaterial=function(){this.attached&&this.vertexOutlineMaterial.setParameterValues(this.vertexOutlineMaterialParameters)};
d.createRenderGeometries=function(){var a=this.vertices;if(v.isNone(a)||0===a.length)return[];var b=A.geometryToRenderInfo(a,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,z.ElevationContext.fromElevationInfo(this.elevationInfo));a=[];const n=b.numVertices;b=b.position;for(let h=0;h<n;++h){var g=x.set(B,b[3*h],b[3*h+1],b[3*h+2]);const C=new r(u(.5,16,16,g),"VerticesVisualElement-vertex");g=new r(u(.5,16,16,g),"VerticesVisualElement-vertexOutline");a.push({vertexGeometry:C,
vertexOutlineGeometry:g})}return a};d.createGeometries=function(a){const b=this.createRenderGeometries();for(const {vertexGeometry:n,vertexOutlineGeometry:g}of b)a.addGeometry(n,this.vertexMaterial),a.addGeometry(g,this.vertexOutlineMaterial)};d.createExternalResources=function(){this.vertexMaterial=new t.ShadedColorMaterial({...this.vertexMaterialParameters,writeDepth:!0,cullFace:2,screenSizeEnabled:!0},"manipulator");this.vertexOutlineMaterial=new t.ShadedColorMaterial({...this.vertexOutlineMaterialParameters,
transparent:!0,writeDepth:!0,cullFace:1,screenSizeEnabled:!0,shadingEnabled:!1},"manipulator-outline")};d.destroyExternalResources=function(){this.vertexOutlineMaterial=this.vertexMaterial=null};d.forEachExternalResource=function(a){a(this.vertexMaterial);a(this.vertexOutlineMaterial)};q._createClass(f,[{key:"renderOccluded",get:function(){return this._renderOccluded},set:function(a){a!==this._renderOccluded&&(this._renderOccluded=a,this.updateMaterial(),this.updateOutlineMaterial())}},{key:"vertices",
get:function(){return this._vertices},set:function(a){this._vertices=a;this.recreateGeometry()}},{key:"spatialReference",get:function(){return this._spatialReference},set:function(a){this._spatialReference=a;this.recreateGeometry()}},{key:"color",get:function(){return this._color},set:function(a){k.exactEquals(a,this._color)||(k.copy(this._color,a),this.updateMaterial())}},{key:"size",get:function(){return this._size},set:function(a){a!==this._size&&(this._size=a,this.updateMaterial())}},{key:"outlineColor",
get:function(){return this._outlineColor},set:function(a){k.exactEquals(a,this._outlineColor)||(k.copy(this._outlineColor,a),this.updateOutlineMaterial())}},{key:"outlineSize",get:function(){return this._outlineSize},set:function(a){a!==this._outlineSize&&(this._outlineSize=a,this.updateOutlineMaterial())}},{key:"elevationInfo",get:function(){return this._elevationInfo},set:function(a){this._elevationInfo=a;this.recreateGeometry()}},{key:"vertexMaterialParameters",get:function(){return{color:this._color,
transparent:1>this._color[3],screenSize:this.size,renderOccluded:this._renderOccluded}}},{key:"vertexOutlineMaterialParameters",get:function(){return{color:this._outlineColor,transparent:1>this._outlineColor[3],screenSize:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}}]);return f}(l.Object3DVisualElement);const B=w.create();p.VerticesVisualElement=l;Object.defineProperty(p,"__esModule",{value:!0})});