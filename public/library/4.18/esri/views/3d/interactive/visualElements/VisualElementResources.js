// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/watchUtils ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/Layer ../../webgl-engine/lib/Texture".split(" "),function(h,m,e,n,p,k,q,r){let u=function(){function g(a){this.resourceFactory=a;this._resources=null;this._visible=!0;this._attached=!1}var d=g.prototype;d.destroy=function(){this._destroyResources()};d.recreate=function(){this.attached&&this._createResources()};
d.recreateGeometry=function(){if(this.resourceFactory.recreateGeometry){var a=this.resourceFactory.view._stage;if(!e.isNone(this._resources)&&a){var b=this._resources.object;this._resources.external.forEach(c=>{c instanceof k&&a.remove(2,c.id)});b.removeAllGeometries();b=this.resourceFactory.recreateGeometry(this._resources.external,b,this._resources.layer);for(const c of b)a.add(2,c)}}else this.recreate()};d._createOrDestroyResources=function(){this._attached?this._resources||this._createResources():
this._destroyResources()};d._createResources=function(){this._destroyResources();const a=this.resourceFactory.view._stage;if(a){var b=new q("element",{isPickable:!1});a.add(0,b);a.addToViewContent([b.id]);var c=new p({idHint:"element",castShadow:!1}),l=this.resourceFactory.createResources(c,b);l.forEach(f=>{a.add(this._contentTypeFromResource(f),f)});a.add(1,c);b.addObject(c);c.setVisible(this._visible);var t=this.resourceFactory.cameraChanged?n.init(this.resourceFactory.view.state,"camera",f=>this.resourceFactory.cameraChanged(f)):
null;this._resources={layer:b,object:c,external:l,cameraHandle:t}}};d._contentTypeFromResource=function(a){return a instanceof k?2:a instanceof r?4:3};d._destroyResources=function(){if(!e.isNone(this._resources)){var a=this.resourceFactory.view._stage;null==a?void 0:a.remove(1,this._resources.object.id);null==a?void 0:a.remove(0,this._resources.layer.id);this._resources.external.forEach(b=>{null==a?void 0:a.remove(this._contentTypeFromResource(b),b.id);"dispose"in b&&b.dispose()});this._resources.object.dispose();
this._resources.cameraHandle&&this._resources.cameraHandle.remove();this._resources=null}};d._syncVisible=function(){e.isNone(this._resources)||this._resources.object.setVisible(this._visible)};m._createClass(g,[{key:"object",get:function(){return e.isSome(this._resources)?this._resources.object:null}},{key:"resources",get:function(){return e.isSome(this._resources)?this._resources.external:null}},{key:"visible",get:function(){return this._visible},set:function(a){a!==this._visible&&(this._visible=
a,this._syncVisible())}},{key:"attached",get:function(){return this._attached},set:function(a){a!==this._attached&&(this._attached=a,this._createOrDestroyResources())}}]);return g}();h.VisualElementResources=u;Object.defineProperty(h,"__esModule",{value:!0})});