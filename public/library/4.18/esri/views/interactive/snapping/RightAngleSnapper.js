// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/mathUtils ../../../chunks/vec2f64 ../../../chunks/vec2 ./Settings ./snappingUtils ./SnappingAlgorithm ./SnappingConstraint ./RightAngleSnappingCandidate".split(" "),function(v,x,y,z,p,l,q,m,r,A,B){r=function(w){function t({enabled:d=q.defaults.lineSnapper.enabled,proximityThreshold:a=q.defaults.lineProximityThreshold,shortLineThreshold:c=q.defaults.shortLineThreshold}={}){d=w.call(this,{enabled:d,proximityThreshold:a,
shortLineThreshold:c})||this;d._tmp=p.create();return d}x._inheritsLoose(t,w);var u=t.prototype;u.snapNewVertex=function(d,a){var c=a.geometry.data.components[0],b=c.vertices.length;const e=[];if(2>b)return e;const g=a.geometry.data.coordinateHelper;var f=g.fromPoint(d);f=m.anyMapPointToScreenPoint(f,a.geometry.data.coordinateHelper,a.elevationInfo,a.view);b=c.vertices[b-1];this._checkForSnappingCandidate(e,b.left,b.pos,g.fromPoint(d),b.left.left.pos,b.pos,a,d,f);c=c.vertices[0];this._checkForSnappingCandidate(e,
c.right,c.pos,g.fromPoint(d),c.right.right.pos,c.pos,a,d,f);return e};u.snapExistingVertex=function(d,a){const c=[];var b=y.unwrap(a.vertexHandle),e=b.component;const g=e.vertices.length;if(3>g)return c;const f=a.geometry.data.coordinateHelper.fromPoint(d),k=m.anyMapPointToScreenPoint(f,a.geometry.data.coordinateHelper,a.elevationInfo,a.view);var h=b.left;b=b.right;const n=e.vertices[0];e=e.vertices[g-1];if(!h)return this._checkForSnappingCandidate(c,n.right.right.right,n.right.right.pos,f,n.right.right.right.right.pos,
n.right.right.pos,a,d,k),c;if(!b)return this._checkForSnappingCandidate(c,e.left.left.left,e.left.left.pos,f,e.left.left.left.left.pos,e.left.left.pos,a,d,k),c;h&&h.left.left&&(e=h.left.left,this._checkForSnappingCandidate(c,e,h.left.pos,f,e.left.pos,h.left.pos,a,d,k));b&&b.right.right&&(h=b.right.right,this._checkForSnappingCandidate(c,h,b.right.pos,f,h.right.pos,b.right.pos,a,d,k));return c};u._checkForSnappingCandidate=function(d,a,c,b,e,g,f,k,h){this.edgeExceedsShortLineThreshold(a,f)&&(l.subtract(this._tmp,
a.right.pos,a.left.pos),a=p.fromValues(this._tmp[1],-this._tmp[0]),c=l.dot(a,l.subtract(this._tmp,b,c))/l.squaredLength(a),b=f.geometry.data.coordinateHelper,k=b.fromXYZ(l.scaleAndAdd(p.create(),g,a,c),k.hasZ?k.z:0),m.squareDistance(h,m.anyMapPointToScreenPoint(k,b,f.elevationInfo,f.view))<this.squaredProximityTreshold(f.pointer)&&d.push(new B.RightAngleSnappingCandidate({coordinateHelper:b,targetPoint:k,constraint:new A.RayConstraint(g,l.scaleAndAdd(b.createNew(),g,a,z.sign(c))),previousVertex:e,
centerVertex:g})))};return t}(r.SnappingAlgorithm);v.RightAngleSnapper=r;Object.defineProperty(v,"__esModule",{value:!0})});