// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../definitions ../../number ../../enums ../../materialKey/MaterialKey ../../TileClipper ../../TurboLine".split(" "),function(C,L,A,f,D,E,F,w){const x=A.TILE_SIZE+16,B=1/3.8,v=new F.TileClipper(0,0,0,1,16);v.setExtent(A.TILE_SIZE);const q=new Uint32Array(9),c=new Uint32Array(36),y=new Uint32Array(3),t=new Uint32Array(6),G=a=>b=>{var l=Math.ceil(1024*a._halfWidth);const h=Math.ceil(1024*a._halfReferenceWidth);b.entry0=
a.offset+a.vertexCount++;var d=f.i1616to32(b.distance,l),e=f.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),0,-31),g=f.i8888to32(0,0,0,a._bitset);c[0]=f.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);c[1]=a.id;c[2]=a._fillColor;c[3]=e;c[4]=d;c[5]=a._tl;c[6]=a._br;c[7]=g;c[8]=f.i1616to32(h,0);b.entry2=a.offset+a.vertexCount++;d=f.i1616to32(b.distance,l);e=f.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),0,31);g=f.i8888to32(0,0,0,a._bitset);c[9]=f.i1616to32(8*
b.currentVertex.x,8*b.currentVertex.y);c[10]=a.id;c[11]=a._fillColor;c[12]=e;c[13]=d;c[14]=a._tl;c[15]=a._br;c[16]=g;c[17]=f.i1616to32(h,0);b.exit0=a.offset+a.vertexCount++;d=f.i1616to32(b.distance,l);e=f.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),0,-31);g=f.i8888to32(0,0,0,a._bitset);c[18]=f.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);c[19]=a.id;c[20]=a._fillColor;c[21]=e;c[22]=d;c[23]=a._tl;c[24]=a._br;c[25]=g;c[26]=f.i1616to32(h,0);b.exit2=a.offset+a.vertexCount++;
l=f.i1616to32(b.distance,l);d=f.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),0,31);e=f.i8888to32(0,0,0,a._bitset);c[27]=f.i1616to32(8*b.currentVertex.x,8*b.currentVertex.y);c[28]=a.id;c[29]=a._fillColor;c[30]=d;c[31]=l;c[32]=a._tl;c[33]=a._br;c[34]=e;c[35]=f.i1616to32(h,0);a.geometryBuf.writeRegion(c)},H=a=>b=>{t[0]=b.leftExit0;t[1]=b.rightEntry0;t[2]=b.leftExit2;t[3]=b.rightEntry0;t[4]=b.rightEntry2;t[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(t)},I=a=>(b,l,
h,d,e,g,k,r,m)=>{m=f.i1616to32(m,Math.ceil(1024*a._halfWidth));e=f.i8888to32(Math.round(31*e),Math.round(31*g),Math.round(31*k),Math.round(31*r));h=f.i8888to32(31*h,31*d,0,a._bitset);q[0]=f.i1616to32(8*b,8*l);q[1]=a.id;q[2]=a._fillColor;q[3]=e;q[4]=m;q[5]=a._tl;q[6]=a._br;q[7]=h;q[8]=f.i1616to32(Math.ceil(1024*a._halfReferenceWidth),0);a.geometryBuf.writeRegion(q);return a.offset+a.vertexCount++},J=a=>(b,l,h)=>{y[0]=b;y[1]=l;y[2]=h;a.indexCount+=3;a.indexBuf.writeRegion(y)};return a=>function(b){function l(...d){d=
b.call(this,...d)||this;d.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};d._tessellationOptions={};d.geometryType=D.WGLGeometryType.LINE;return d}C._inheritsLoose(l,b);var h=l.prototype;h.writeMeshWithGeometry=function(d,e,g,k,r,m){const n=e.indexVector,p=e.get("geometry");e=e.getVector("geometry").vertexCount;const z=n.length;if(g=null!=m?m:g.readLegacyGeometry()){switch(k){case "esriGeometryPolyline":k=
this._clipLines(g.paths);if(0===k.length)return;this._write(n,p,e,r,k);break;case "esriGeometryPolygon":k=this._clipLines(g.rings);if(0===k.length)return;this._write(n,p,e,r,k)}d.writeDisplayRecord(this.geometryType,this._materialKey,e,this.tessellationProperties.vertexCount,z,this.tessellationProperties.indexCount)}};h._clipLines=function(d){const e=[];var g=!1;let k=0;for(;k<d.length;){const r=[],m=d[k];v.reset(2);let [n,p]=m[0];if(g)v.moveTo(n,p);else{if(-16>n||n>x||-16>p||p>x){g=!0;continue}r.push({x:n,
y:p})}let z=!1;const K=m.length;for(let u=1;u<K;++u)if(n+=m[u][0],p+=m[u][1],g)v.lineTo(n,p);else{if(-16>n||n>x||-16>p||p>x){z=!0;break}r.push({x:n,y:p})}if(z)g=!0;else{if(g){if(g=v.resultWithStarts())for(const u of g)e.push(u)}else e.push({line:r,start:0});k++;g=!1}}return e};h._write=function(d,e,g,k,r){this.tessellationProperties.id=k;this.tessellationProperties.indexBuf=d;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=e;this.tessellationProperties.vertexCount=
0;this.tessellationProperties.offset=g;for(const m of r)d=m.line,2>d.length||(this._tessellationOptions.initialDistance=m.start%65535,this._tessellationCallbacks instanceof w.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),w.tessellate(d,this._tessellationOptions,this._tessellationCallbacks),w.cleanup())};h._initializeTessellator=function(d){const e=E.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=
this._isDashed||this._hasPattern;this._tessellationOptions.thin=!d&&this.tessellationProperties._halfWidth<A.THIN_LINE_THRESHOLD/2&&!(e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=B;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=B;this._tessellationOptions.enableInnerBisectorSplit=
this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:G(this.tessellationProperties),bridge:H(this.tessellationProperties)}:(d=new w.StandardTessellationCallbacks(I(this.tessellationProperties),J(this.tessellationProperties)),d.miterLimitCosine=this._miterLimitCosine,d.textured=this._isDashed||this._hasPattern,d.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=d)};return l}(a)});