// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../chunks/vec2 ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../enums ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper".split(" "),function(B,v,C,w,g,q,D,x,n,E,F){const y=3.14159265359/180;return G=>function(z){function r(...a){a=
z.call(this,...a)||this;a.angle=0;a.xOffset=0;a.yOffset=0;a.width=0;a.height=0;a.boundsType="square";a._anchorX=0;a._anchorY=0;a._computedWidth=0;a._computedHeight=0;a.geometryType=E.WGLGeometryType.MARKER;return a}B._inheritsLoose(r,z);var l=r.prototype;l.writeMeshWithGeometry=function(a,b,c,h,d,f){const k=b.indexVector,m=b.get("geometry"),e=b.getVector("geometry"),p=e.vertexCount,A=k.length;if(v.isSome(this._markerPlacement))c=null!=f?f:c.readLegacyGeometry(),this._writePlacedMarkers(m,k,p,d,c);
else{c=f?w.deltaDecodeGeometry(w.convertFromGeometry(f),2):"esriGeometryPolygon"===h?c.readCentroid():c.readUnquantizedGeometry();if(!c)return;if(c.isPoint){const [t,u]=c.coords;this._writeVertices(m,d,this._getPos(t,u));this._writeIndices(k,p)}else c.forEachVertex((t,u)=>{const H=e.vertexCount;this._writeVertices(m,d,this._getPos(t,u));this._writeIndices(k,H)})}b=b.getVector("geometry").vertexCount-p;a.writeDisplayRecord(this.geometryType,this._materialKey,p,b,A,k.length-A)};l._applyTransformation=
function(a,b,c=0){q.identity(a);q.translate(a,a,x.fromValues(this.xOffset,-this.yOffset));0!==this.angle+c&&q.rotate(a,a,y*(this.angle+c));c=this._computedWidth;const h=this._computedHeight,d=(this._anchorX-.5)*c,f=(this._anchorY-.5)*h;g.set(b,d,f);g.transformMat2d(b,b,a);this._offsetUpperLeft=n.i1616to32(16*b[0],16*b[1]);g.set(b,d+c,f);g.transformMat2d(b,b,a);this._offsetUpperRight=n.i1616to32(16*b[0],16*b[1]);g.set(b,d,f+h);g.transformMat2d(b,b,a);this._offsetBottomLeft=n.i1616to32(16*b[0],16*b[1]);
g.set(b,d+c,f+h);g.transformMat2d(b,b,a);this._offsetBottomRight=n.i1616to32(16*b[0],16*b[1])};l._writePlacedMarkers=function(a,b,c,h,d){if(d=F.CIMMarkerPlacementHelper.getPlacement(d,v.unwrap(this._markerPlacement),C.pt2px(1)))for(var f=x.create(),k=D.create(),m=0,e=d.next();null!=e;)-128<=e.tx&&640>=e.tx&&-128<=e.ty&&640>=e.ty&&(this._applyTransformation(k,f,e.getAngle()/y),this._writeVertices(a,h,this._getPos(e.tx,e.ty)),this._writeIndices(b,c+m),m+=4),e=d.next()};l._getPos=function(a,b){return n.i1616to32(Math.round(8*
a),Math.round(8*b))};l._writeVertices=function(a,b,c){a.push(c);a.push(this._offsetUpperLeft);a.push(this._texUpperLeft);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetUpperRight);a.push(this._texUpperRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomLeft);a.push(this._texBottomLeft);
a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth);a.push(c);a.push(this._offsetBottomRight);a.push(this._texBottomRight);a.push(this._bitestAndDistRatio);a.push(b);a.push(this._fillColor);a.push(this._outlineColor);a.push(this._sizeOutlineWidth)};l._writeIndices=function(a,b){a.push(b+0);a.push(b+1);a.push(b+2);a.push(b+1);a.push(b+3);a.push(b+2)};return r}(G)});