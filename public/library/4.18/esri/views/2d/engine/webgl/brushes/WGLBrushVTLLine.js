// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../../../../../chunks/vec4f32 ../number ../enums ./WGLBrush".split(" "),function(m,z,A,u,B,C,D,E,n){const F=Math.PI/180,G=[1,1,1,1];n=function(v){function p(){var c=v.apply(this,arguments)||this;c._color=C.create();c._dashArray=B.create();c._programOptions={id:!1,dd:!1,pattern:!1};return c}z._inheritsLoose(p,v);var w=p.prototype;w.dispose=function(){};w.drawMany=function(c,
g){const {context:h,displayLevel:f,state:q,drawPhase:H,styleLayerUID:r}=c,d=c.styleLayer,x=c.painter.getVectorTileProgramCache(),I=d.getPaintValue("line-translate",f),J=d.getPaintValue("line-translate-anchor",f);var b=d.getPaintValue("line-pattern",f);const t=void 0!==b,K=1/c.pixelRatio,L=d.getPaintValue("line-blur",f);var a=d.hasDataDrivenColor?G:d.getPaintValue("line-color",f),e=d.hasDataDrivenOpacity?1:d.getPaintValue("line-opacity",f);const M=d.hasDataDrivenWidth?1:d.getPaintValue("line-width",
f);e*=a[3];this._color[0]=e*a[0];this._color[1]=e*a[1];this._color[2]=e*a[2];this._color[3]=e;a=d.hasDataDrivenLine;e=H===E.WGLDrawPhase.HITTEST;let y;e&&(y=D.u32to4Xu8(r+1));const l=this._programOptions;l.id=e;l.dd=a;l.pattern=t;a=x.getProgram(3,(e?1:0)<<2|(a?1:0)<<1|(t?1:0),l);h.bindProgram(a);a.setUniformMatrix3fv("u_displayViewMat3",q.displayViewMat3);a.setUniformMatrix3fv("u_displayMat3",1===J?q.displayMat3:q.displayViewMat3);a.setUniform2fv("u_lineTranslation",I);a.setUniform1f("u_depth",d.z);
a.setUniform1f("u_blur",L);a.setUniform1f("u_antialiasing",K);a.setUniform4fv("u_color",this._color);a.setUniform1f("u_width",M);e&&a.setUniform4fv("u_id",y);if(t){if(c=c.spriteMosaic,b=c.getMosaicItemPosition(b,!0))c.bind(h,9729,b.page,u.VTL_TEXTURE_BINDING_UNIT_SPRITES),a.setUniform2f("u_pattern_tl",b.tl[0],b.br[1]),a.setUniform2f("u_pattern_br",b.br[0],b.tl[1]),a.setUniform2f("u_spriteSize",8*b.size[0],b.size[1]),a.setUniform1i("u_texture",u.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else b=d.getPaintValue("line-dasharray",
f),2>b.length&&(b=[1,-1]),this._dashArray[0]=8*b[0],this._dashArray[1]=8*b[1],a.setUniform2fv("u_dasharray",this._dashArray);for(const k of g)k.layerData.has(r)&&(g=k.layerData.get(r),g.prepareForRendering(h,x),b=g.lineVertexArrayObject,A.isNone(b)||(h.bindVAO(b),a.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs),h.setStencilFunction(514,k.stencilRef,255),h.drawElements(4,g.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*g.lineIndexStart),k.triangleCount+=g.lineIndexCount/3))};return p}(n);m.C_DEG_TO_RAD=
F;m.WGLBrushVTLLine=n;Object.defineProperty(m,"__esModule",{value:!0})});