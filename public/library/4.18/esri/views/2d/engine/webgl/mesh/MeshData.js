// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../WGLDisplayRecord ../util/serializationUtils ../collisions/Metric ../WGLDisplayObject ../util/Reader ../util/Writer".split(" "),function(r,v,w,m,x,y,n,p){let B=function(){function g(a,b){this.vertexVectorsMap=a;this._currentIndex=-1;this._currentMetricOffset=this._currentRecordOffset=0;this._currentMetrics=[];a=4*(8*b.records+1);const d=4*(20*b.metrics+1);this._bufDisplayObjects=new p(Uint32Array,4*(4*b.features+1)+4);this._bufDisplayRecords=
new p(Uint32Array,a+4);this._bufMetrics=new p(Uint32Array,d+4);this._bufDisplayObjects.push(0);this._bufDisplayRecords.push(0);this._bufMetrics.push(0)}var c=g.prototype;c.get=function(a){return this.vertexVectorsMap[a]};c.currentDisplayRecordCount=function(){return this._bufDisplayRecords[this._currentRecordOffset]};c.writeDisplayObject=function(a,b){this._bufDisplayObjects.incr(0);this._currentIndex=this._bufDisplayObjects.push(a);this._bufDisplayObjects.push(b);this._bufDisplayObjects.push(0);
this._bufDisplayObjects.push(0);this._currentMetricOffset=this._currentRecordOffset=0;this._currentMetrics=[]};c.hasDisplayRecords=function(){return 0!==this._currentRecordOffset};c.endDisplayObject=function(){this.hasDisplayRecords()?this._currentMetrics&&(0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length),m.serializeList(this._bufMetrics,this._currentMetrics)):this._rollbackDisplayObject()};
c.writeDisplayRecord=function(a,b,d,e,f,h,k=0,q=0){0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset));this._bufDisplayRecords.incr(this._currentRecordOffset);this._bufDisplayRecords.push(a);this._bufDisplayRecords.push(b);this._bufDisplayRecords.push(d);this._bufDisplayRecords.push(e);this._bufDisplayRecords.push(f);this._bufDisplayRecords.push(h);this._bufDisplayRecords.push(k);
this._bufDisplayRecords.push(q)};c.writeMetrics=function(a){a&&this._currentMetrics.push(...a)};g.deserializeDisplayObjects=function(a){const {bufDisplayObjects:b,bufMetrics:d,bufRecords:e}=a;a=new n(b);const f=new n(e),h=new n(d),k=[];let q=a.readInt32();f.readInt32();for(h.readInt32();q--;){const t=a.readInt32(),u=a.readInt32(),z=a.readInt32(),A=a.readInt32(),l=new y(t);0!==u&&(l.insertAfter=u);0!==z&&(l.displayRecords=m.deserializeList(f,w,{id:t}));0!==A&&(l.metrics=m.deserializeList(h,x));k.push(l)}return k};
c.encode=function(a,b){const d={};for(let e=0;e<this.vertexVectorsMap.length;e++){const f=this.vertexVectorsMap[e];d[e]={};f.transfer(d[e],b)}a.bufDisplayObjects=this._bufDisplayObjects.buffer();a.bufRecords=this._bufDisplayRecords.buffer();a.bufMetrics=this._bufMetrics.buffer();b.push(a.bufDisplayObjects);b.push(a.bufMetrics);b.push(a.bufRecords);a.vertexBuffersMap=d;this.destroy()};c.destroy=function(){this._bufMetrics=this._bufDisplayRecords=this._bufDisplayObjects=this.vertexVectorsMap=null};
c._rollbackDisplayObject=function(){this._bufDisplayObjects.decr(0);this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4);this._currentIndex=this._bufDisplayObjects.length};v._createClass(g,[{key:"vertexBuffersMap",get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(let a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap}}]);return g}();r.MeshData=B;Object.defineProperty(r,
"__esModule",{value:!0})});