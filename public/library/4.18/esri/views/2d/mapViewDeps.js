// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/LabelManager":function(){define("../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/Error ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Accessor ../../core/HandleOwner ../../core/throttle ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u){const t=C.getLogger("esri.views.2d.layers.labels.LabelManager");D=function(k){function v(r){r=k.call(this,r)||this;r._applyVisibilityPassThrottled=h.throttle(r._applyVisibilityPass,64,z._assertThisInitialized(r));r.lastUpdateId=-1;r.updateRequested=!1;r.view=null;return r}z._inheritsLoose(v,k);var p=v.prototype;p.initialize=function(){this.collisionEngine=new n.CollisionEngine(this.view.featuresTilingScheme);this._layerViewSorter=new u.LayerViewSorter((r,
w)=>{this.collisionEngine.registerLayerView(r,w);(w=r.tileRenderer)&&w.forEachTile(l=>{l.isDirty=!0;this.addTile(r,l)});this.requestUpdate()},r=>{this.collisionEngine.unregisterLayerView(r);this.requestUpdate()});this.handles.add(this.view.allLayerViews.on("change",r=>{this._layerViewSorter.update(r)}))};p.destroy=function(){this._layerViewSorter.destroy();this.collisionEngine=this._layerViewSorter=null;this._applyVisibilityPassThrottled.remove();this._applyVisibilityPassThrottled=null};p.update=
function(r){this._applyVisibilityPassThrottled(r)};p.viewChange=function(){this.requestUpdate()};p.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())};p.processUpdate=function(r){this._set("updateParameters",r);this.updateRequested&&(this.updateRequested=!1,this.update(r))};p.addTile=function(r,w){this.collisionEngine.addTile(r,w)};p.removeTile=function(r,w){this.collisionEngine.removeTile(r,w)};p._applyVisibilityPass=function(r){try{const w=this.view.featuresTilingScheme.getClosestInfoForScale(r.state.scale).level;
this.collisionEngine.run(r,w)}catch(w){t.error(new d("mapview-labeling","Encountered an error during label decluttering",w))}};z._createClass(v,[{key:"updating",get:function(){return this.updateRequested}}]);return v}(q.HandleOwnerMixin(g));E.__decorate([m.property()],D.prototype,"updateRequested",void 0);E.__decorate([m.property({readOnly:!0})],D.prototype,"updateParameters",void 0);E.__decorate([m.property({dependsOn:["updateRequested"]})],D.prototype,"updating",null);E.__decorate([m.property()],
D.prototype,"view",void 0);return D=E.__decorate([b.subclass("esri.views.2d.layers.labels.LabelManager")],D)})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/Error ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(z,E,D,C,A,m,c,b){const d=m.TILE_SIZE/m.COLLISION_BUCKET_SIZE,a=D.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
D=function(){function e(g){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=g}var f=e.prototype;f.registerLayerView=function(g,q){if(!this._layers.has(g)){var h=b["default"].create(g,q,this.collisionInfos,this._tilingScheme);this._layers.set(g,h);this._collisionBuckets.forEach(n=>n.onRegisterLayer(h.index))}};f.unregisterLayerView=function(g){if(this._layers.has(g)){var q=this._layers.get(g);b["default"].delete(q.index,this.collisionInfos);this._layers.delete(g);
this._collisionBuckets.forEach((h,n)=>{const u=h.getTile(q.index);u&&(h.onUnregisterLayer(q.index),h.canDelete()&&this._collisionBuckets.delete(n),u.reference&&(u.reference.isDirty=!1))})}};f.addTile=function(g,q){const h=q.key.id;this._layers.has(g)&&(this._collisionBuckets.has(h)||this._collisionBuckets.set(h,new c(q.key,this._layers.size)),g=this._getIndex(g),this._collisionBuckets.get(h).getTile(g).reference=q)};f.removeTile=function(g,q){this._layers.has(g)&&this._collisionBuckets.has(q)&&(g=
this._getIndex(g),q=this._collisionBuckets.get(q).getTile(g),q.dirty=!1,q.reference=null)};f.run=function(g,q){const h=Array.from(this._collisionBuckets.values()).sort((k,v)=>k.key.compareRowMajor(v.key));let n=!0;const u=g.renderingOptions.labelCollisionsEnabled&&!this._didError,t=this.collisionInfos;try{for(const k of h){n=n||k.isDirty;k.computeNeighbors(this._collisionBuckets);for(let v=0;v<this._layers.size;v++){const p=b["default"].find(v,t);k.reset(g,n,p)}}for(g=0;g<this._layers.size;g++){const k=
b["default"].find(g,t);for(const v of h)this._run(u,v,k,q)}}catch(k){a.error(new C("mapview-labeling","Encountered an error during decluttering. Disabling collisions",k)),this._didError=!0}for(const k of h)k.ready()};f._run=function(g,q,h,n){const u=q.getReference(h.index);u&&u.hasData&&(u.key.level!==n?this._resetLabelsMinZoom(q,h):this._runVisibility(g,q,u,h,n))};f._resetLabelsMinZoom=function(g,q){if(g&&"polyline"!==q.geometryType&&(g=g.getReference(q.index))&&g.hasData){q=q.layerView.tileRenderer.featuresView.attributeView;
g=g.displayObjects;for(const h of g)q.setLabelMinZoom(h.id,255)}};f._checkLabelsVisible=function(g,q){const h=!q.effect||q.effect.excludedLabelsVisible||!!(g&m.EFFECT_FLAG_0);return(!q.filter||!!(g&m.FILTER_FLAG_0))&&h};f._runVisibility=function(g,q,h,n,u){const t=n.layerView.tileRenderer.featuresView.attributeView;var k=h.displayObjects.sort((r,w)=>{r=t.getLabelMinZoom(r.id);w=t.getLabelMinZoom(w.id);return r-w});h=n.zoomRanges.some(r=>"none"===r.deconflictionStrategy);for(const r of k)if(r.metrics.length){k=
"polyline"===n.geometryType?0:10*(u-1);var v=t.getFilterFlags(r.id);v=this._checkLabelsVisible(v,n.layerView);if(g&&!h)for(let w=0;w<r.metrics.length;w++){var p=r.metrics[w];p=v?-1!==p.minZoom?p.minZoom:this._computeLabelVisibility(r,p,n.index,q,p.baseZoom,u):255;k=Math.max(p,k)}k=Math.max(k,0);t.setLabelMinZoom(r.id,k);for(const w of r.metrics)w.minZoom=k}};f._computeLabelVisibility=function(g,q,h,n,u,t){const {xBucket:k,yBucket:v,xOverflow:p,yOverflow:r}=q,w=k-p,l=k+p+1;var x=v-r;const y=v+r+1;
for(;x<y;x++)for(let F=w;F<l;F++)if(!(F<-d||x<-d||F>d||x>d))for(let G=0;G<=h;G++){var B=this._getRelativeSubBucket(G,n,F,x);if(B)for(const J of B)if(G!==h||J.id!==g.id)B=this._compareLabels(q,J,u,t),u=Math.max(B,u)}return u};f._compareLabels=function(g,q,h,n){if(-1===q.minZoom||q.minZoom>10*(n+1))return h;g=g.findCollisionDelta(q);n=A.clamp(Math.ceil(10*(g+n)),0,255);return q.minZoom>=n?h:Math.max(h,n)};f._getNeighboringTile=function(g,q,h,n){return(q=q.neighbors[3*(1+n)+(1+h)])&&q.getTile(g)};f._getRelativeSubBucket=
function(g,q,h,n){const u=A.sign(Math.floor(h/4)),t=A.sign(Math.floor(n/4));return(g=this._getNeighboringTile(g,q,u,t))&&g.reference&&g.index&&g.reference.hasData?g.index[n-4*t][h-4*u]:null};f._getIndex=function(g){return this._layers.get(g).index};E._createClass(e,[{key:"collisionInfos",get:function(){return Array.from(this._layers.values())}}]);return e}();z.CollisionEngine=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/definitions":function(){define(["exports"],
function(z){z.ANGLE_FACTOR_256=256/360;z.ATTRIBUTE_DATA_ANIMATION=1;z.ATTRIBUTE_DATA_DD0=3;z.ATTRIBUTE_DATA_DD1=3;z.ATTRIBUTE_DATA_FILTER_FLAGS=0;z.ATTRIBUTE_DATA_VV=2;z.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;z.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};z.COLLISION_BOX_PADDING=16;z.COLLISION_BUCKET_SIZE=128;z.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;z.COLLISION_MAX_ZOOM_DELTA=1;z.COLLISION_PLACEMENT_PADDING=8;z.COLLISION_TILE_BOX_SIZE=4;z.DEBUG_LABELS=!1;z.DOT_DENSITY_MAX_FIELDS=
8;z.EFFECT_FLAG_0=4;z.EXTRUDE_SCALE=64;z.FILTER_FLAG_0=2;z.GLYPH_SIZE=24;z.HEURISTIC_GLYPHS_PER_FEATURE=10;z.HEURISTIC_GLYPHS_PER_LINE=50;z.HIGHLIGHT_FLAG=1;z.HITTEST_SEARCH_SIZE=6;z.MAGIC_LABEL_LINE_HEIGHT=29;z.MAX_FILTERS=2;z.MAX_GPU_UPLOADS_PER_FRAME=2;z.NAN_MAGIC_NUMBER=1E-30;z.PICTURE_FILL_COLOR=4294967295;z.RASTER_TILE_SIZE=256;z.SPRITE_PADDING=2;z.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;z.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;z.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;z.TEXTURE_BINDING_ATTRIBUTE_DATA_3=
4;z.TEXTURE_BINDING_BITMAP=0;z.TEXTURE_BINDING_GLYPH_ATLAS=0;z.TEXTURE_BINDING_HIGHLIGHT_0=5;z.TEXTURE_BINDING_HIGHLIGHT_1=6;z.TEXTURE_BINDING_RENDERER_0=5;z.TEXTURE_BINDING_RENDERER_1=6;z.TEXTURE_BINDING_SPRITE_ATLAS=0;z.TEXT_PLACEMENT_PADDING=8;z.THIN_LINE_THRESHOLD=2.5;z.TILE_SIZE=512;z.VTL_HIGH_RES_CUTOFF=1.15;z.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;z.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;z.WEBGL_MAX_INNER_STOPS=6;z.WEBGL_MAX_STOPS=8;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../tiling/TileKey ../../../tiling/PagedTileQueue ../../../tiling/TileInfoView ../../../tiling/TileQueue ../../../tiling/TileStrategy ./CollisionBucketEntry".split(" "),
function(z,E,D,C,A,m,c){return function(){function b(a,e){this.neighbors=Array(9);this._tiles=Array(e);for(let f=0;f<e;f++)this._tiles[f]=new c;this.key=a}var d=b.prototype;d.getTile=function(a){return this._tiles[a]};d.getReference=function(a){return(a=this._tiles[a])&&a.reference};d.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};d.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};d.onLabelsRendered=function(){};d.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=
!0};d.add=function(a){this._add(a)};d.remove=function(a){this._remove(a)};d.canDelete=function(){return 0===this._tiles.length};d.ready=function(){for(const a of this._tiles)a.dirty=!1};d.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,
1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};d.reset=function(a,e,f){const g=this._tiles[f.index];g&&g.reset(a,e,f)};d._add=function(a){const e=[];if(a>=this._tiles.length)this._tiles.push(new c);else{for(let f=0;f<this._tiles.length;f++)f===a&&e.push(new c),e.push(this._tiles[f]);this._tiles=e}};d._remove=function(a){const e=[];for(let f=0;f<this._tiles.length;f++)f!==a&&e.push(this._tiles[f]);this._tiles=e};d._getNeighbor=function(a,e,f){const g=this.key;
e=E.getId(g.level,g.row+f,g.col+e,g.world);return a.has(e)?a.get(e):null};z._createClass(b,[{key:"isDirty",get:function(){for(const a of this._tiles)if(a.dirty)return!0;return!1}},{key:"size",get:function(){return this._tiles.length}}]);return b}()})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../chunks/vec2"],function(z,E){return function(){function D(){this._reference=null}D.prototype.reset=function(C,
A,m){({state:C}=C);const c=m.layerView.tileRenderer,b=this.reference;if(!b||!b.hasData)return!1;A&&(b.isDirty=!0);A=b.transforms.labelMat2d;const d=A[4],a=A[5];for(const g of b.displayObjects){var e=c.featuresView.attributeView;e=m.hasVV()?e.getVVSize(g.id):0;for(const q of g.metrics){m.hasVV()&&q.computeVVOffset(e,m.vvEval);var f=q.bounds.center;const h=q.bounds.centerT;b.isDirty&&(q.minZoom=-1);const n=E.copy(h,q.anchor);C.rotation?E.transformMat2d(n,n,A):(h[0]=n[0]+d,h[1]=n[1]+a);E.add(h,n,f);
h[0]+=q.offsetX;h[1]+=q.offsetY;if(q.boxes)for(const u of q.boxes)f=u.centerT,E.add(f,q.anchor,u.center),C.rotation?E.transformMat2d(f,f,A):(f[0]+=d,f[1]+=a)}}return!0};z._createClass(D,[{key:"dirty",get:function(){return this.reference&&this.reference.isDirty},set:function(C){this.reference&&this.reference.hasData&&(C||this.reference.isDirty)&&(this.reference.isDirty=C)}},{key:"index",get:function(){return this._reference&&this._reference.labelIndex}},{key:"reference",get:function(){return this._reference},
set:function(C){this._reference=C}}]);return D}()})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define(["exports","../../../../../core/Logger","../../../../../core/mathUtils","../../../../../core/screenUtils","./visualVariableSimpleUtils"],function(z,E,D,C,A){function m(f,g){const q=!!f.maxScale,h=!!f.minScale&&g.scaleToZoom(f.minScale)||0;g=q&&g.scaleToZoom(f.maxScale)||255;return{deconflictionStrategy:f.deconflictionStrategy,minZoom:D.clamp(Math.floor(10*h),0,255),maxZoom:D.clamp(Math.floor(10*
g),0,255)}}function c(f){return g=>C.pt2px(A.getSizeForValueSimple(g,f))}function b(f){if(!f)return null;for(const g of f)if("size"===g.type)return c(g);return null}const d=(f,g)=>f.order-g.order,a=(f,g)=>f.index-g.index,e=E.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");E=function(){function f(q,h,n,u){this._vvHandle=null;var t=q.layer;const {geometryType:k,labelingInfo:v,renderer:p}=t;p&&(this.vvEval=b("visualVariables"in p&&p.visualVariables));this._vvHandle=t.watch("renderer",
w=>{w&&(this.vvEval=b("visualVariables"in w&&w.visualVariables))});var r=(t=t.featureReduction)&&"cluster"===t.type&&t.labelingInfo;t=(v||[]).map(w=>m(w,u));r=(r||[]).map(w=>m(w,u));this.layerView=q;this.geometryType=k;this.index=h;this.order=n;this.zoomRanges=[...t,...r];this.layerView=q}var g=f.prototype;g.hasVV=function(){return!!this.vvEval};g.allOrNothing=function(){return"polyline"!==this.geometryType};g.destroy=function(){this._vvHandle.remove()};f.create=function(q,h,n,u){n=n.sort(d);let t=
!1,k=-1;for(const v of n)!t&&v.order>h&&(k=v.index,t=!0),t&&v.index++;t||(k=n.length);return new f(q,k,h,u)};f.delete=function(q,h){const n=h.sort(a);for(let u=q+1;u<n.length;u++)h[u].index--;h[q].destroy();h.splice(q,1)};f.find=function(q,h){for(const n of h)if(n.index===q)return n;e.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return f}();z.createLabelVVEvaluator=b;z.default=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["exports",
"../../../../../core/mathUtils","../../../../../renderers/support/lengthUtils"],function(z,E,D){function C(b,d){switch(d.transformationType){case "additive":var a=A(d.minSize,b);return b+=a||d.minDataValue;case "constant":return a=(a=d.stops)&&a.length&&a[0].size,null==a&&(a=d.minSize),b=A(a,b);case "clamped-linear":a=(b-d.minDataValue)/(d.maxDataValue-d.minDataValue);var e=A(d.minSize,b),f=A(d.maxSize,b);b=b<=d.minDataValue?e:b>=d.maxDataValue?f:e+a*(f-e);return b;case "proportional":return a=b/
d.minDataValue,e=A(d.minSize,b),b=A(d.maxSize,b),b=E.clamp(a*e,e,b);case "stops":{const [g,q,h]=m(b,d.cache.ipData);g===q?b=A(d.stops[g].size,b):(a=A(d.stops[g].size,b),b=A(d.stops[q].size,b),b=a+(b-a)*h)}return b;case "real-world-size":{a=D.meterIn[d.valueUnit];e=A(d.minSize,b);f=A(d.maxSize,b);({valueRepresentation:d}=d);let g=null;g="area"===d?2*Math.sqrt(b/c)/a:"radius"===d||"distance"===d?2*b/a:b/a;b=E.clamp(g,e,f)}return b;case "identity":return b;case "unknown":return null}}function A(b,d){return"number"===
typeof b?b:C(d,b)}function m(b,d){if(d){var a=0,e=d.length-1;d.some((f,g)=>{if(b<f)return e=g,!0;a=g;return!1});return[a,e,(b-d[a])/(d[e]-d[a])]}}const c=Math.PI;z.getSizeForValueSimple=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["exports","../../../../../core/Logger","../../../../../core/Error"],function(z,E,D){function C(m){return"esri.views.2d.layers.FeatureLayerView2D"===m.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===
m.declaredClass}const A=E.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");E=function(){function m(b,d){this.registerLayer=b;this.unregisterLayer=d;this._layerViewState=new Map}var c=m.prototype;c.findIndex=function(b){return b.view.allLayerViews.findIndex(d=>d.uid===b.uid)};c.update=function(b){const {added:d,removed:a}=b;for(const e of a)C(e)&&this._layerViewState.has(e)&&this._deleteState(e);for(const e of d){if(b=C(e))a:if(e.layer&&e.layer.renderer)switch(e.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":case "dot-density":b=
!0;break a;default:A.error(new D("mapview-labeling",`Renderer of type ${e.layer.renderer.type} does not currently support labeling`)),b=!1}else b=!1;b&&!this._layerViewState.has(e)&&this._createState(e)}this._recomputeOrder()};c.destroy=function(){this._layerViewState.forEach(b=>b.handles.forEach(d=>d.remove()))};c._createState=function(b){const d={priority:-1,handles:null};d.handles=[b.layer.watch("visible",this._recomputeOrder.bind(this)),b.layer.watch("labelsVisible",this._recomputeOrder.bind(this)),
b.layer.watch("labelingInfo",this._recomputeOrder.bind(this)),b.layer.watch("featureReduction",this._recomputeOrder.bind(this))];this._layerViewState.set(b,d);return d};c._deleteState=function(b){if(this._layerViewState.has(b)){var d=this._layerViewState.get(b);d.handles.forEach(a=>a.remove());-1!==d.priority&&this.unregisterLayer(b);this._layerViewState.delete(b)}};c._recomputeOrder=function(){this._layerViewState.forEach((b,d)=>{var a=d.view.map.allLayers.findIndex(g=>g.uid===d.layer.uid);const e=
d.layer;var f=e.featureReduction;f=f&&"cluster"===f.type&&f.labelsVisible&&f.labelingInfo&&f.labelingInfo.length;f=e.labelsVisible&&e.labelingInfo&&e.labelingInfo.length||f;a=e.visible&&f?4294967295-a:-1;a!==b.priority&&(b.priority=a,this.unregisterLayer(d),-1!==a&&this.registerLayer(d,a))})};return m}();z.LayerViewSorter=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/Stage":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/has ../../../core/Error ../../../core/events ../../../core/scheduling ../../../chunks/common ../../../core/watchUtils ../../../chunks/vec2f64 ../../support/screenshotUtils ../../../chunks/vec2 ../../webgl/context-util ../../../chunks/mat2d ../../../chunks/mat2df64 ../support/Timeline ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/programUtils ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ./webgl/enums ./Container ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v,p,r,w,l,x,y,B,F,G,J,K){n=function(M){function R(I,H){var Q=M.call(this)||this;Q._trash=new Set;Q._clipData=new Float32Array(8);Q._upperLeft=d.create();Q._upperRight=d.create();Q._lowerLeft=d.create();Q._lowerRight=d.create();Q._mat2=q.create();Q._clipRendererInitialized=!1;Q._supersampleScreenshots=!0;Q.renderRequested=!1;Q.stage=E._assertThisInitialized(Q);Q._stationary=!0;const {canvas:W=document.createElement("canvas"),alpha:aa=!0,stencil:da=!0,
renderContext:S="webgl",supersampleScreenshots:U=!0,contextOptions:X={}}=H;Q._canvas=W;const ba=f.createContextOrErrorHTML(W,{alpha:aa,antialias:!1,depth:!0,stencil:da},S);Q.context=new l(ba,X);Q.painter=new F(Q.context,E._assertThisInitialized(Q));D("esri-2d-profiler")&&(Q._debugOutput=document.createElement("div"),Q._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),I.appendChild(Q._debugOutput));Q._renderParameters={drawPhase:0,state:Q.state,pixelRatio:window.devicePixelRatio,
stationary:!1,globalOpacity:1,blendMode:null,deltaTime:-1,time:0,inFadeTransition:!1,effects:null,context:Q.context,painter:Q.painter,timeline:H.timeline||new h.Timeline,renderingOptions:H.renderingOptions,driverTestResult:J.testWebGLDriver(Q.context),profiler:new G.Profiler(Q.context,Q._debugOutput),dataUploadCounter:0};Q._taskHandle=m.addFrameTask({render:Z=>Q.renderFrame(Z)});Q._taskHandle.pause();Q._supersampleScreenshots=U;Q._lostWebGLContextHandle=A.on(W,"webglcontextlost",()=>{Q.emit("webgl-error",
{error:new C("webgl-context-lost")})});W.setAttribute("style","width: 100%; height:100%; display:block;");I.appendChild(W);return Q}E._inheritsLoose(R,M);var N=R.prototype;N.destroy=function(){this.removeAllChildren();this._emptyTrash();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&(this._clipStencilProgram.dispose(),this._clipStencilProgram=
null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.highlightOptions=null;this.painter.dispose();this.context.dispose();this._canvas=null};N.trashDisplayObject=function(I){this._trash.add(I);this.requestRender()};N.untrashDisplayObject=function(I){return this._trash.delete(I)};
N.requestRender=function(){this._lastRenderRequestTime=performance.now();this.renderRequested||(this.renderRequested=!0,this.emit("will-render"),this._taskHandle.resume())};N.renderFrame=function(I){2E3<=I.time-this._lastRenderRequestTime&&this._taskHandle.pause();this.renderRequested=!1;this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this._renderParameters.time=
I.time;this._renderParameters.deltaTime=I.deltaTime;this._renderParameters.effects=null;this.processRender(this._renderParameters);this._emptyTrash();this.emit("post-render")};N.renderChildren=function(I){for(const H of this.children)H.beforeRender(I);this._renderChildren(this.children,I);for(const H of this.children)H.afterRender(I)};N._renderChildren=function(I,H){const Q=this.context;H.profiler.recordStart("drawLayers");H.dataUploadCounter=0;this._beforeRenderChildren(H);H.drawPhase=y.WGLDrawPhase.MAP;
this.painter.beforeRenderLayers(Q,this.background);for(const W of I)W.processRender(H);this.painter.renderLayers(Q);H.drawPhase=y.WGLDrawPhase.HIGHLIGHT;this.painter.beforeRenderLayers(Q);for(const W of I)W.processRender(H);this.painter.renderLayers(Q);if(this._isLabelDrawPhaseRequired(I)){H.drawPhase=y.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(Q);for(const W of I)W.processRender(H);this.painter.renderLayers(Q)}if(D("esri-tiles-debug")){H.drawPhase=y.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(Q);
for(const W of I)W.processRender(H);this.painter.renderLayers(Q)}H.profiler.recordEnd("drawLayers");this._afterRenderChildren()};N._beforeRenderChildren=function(I){const {context:H}=this,{state:Q,pixelRatio:W}=I;H.enforceState();const {size:aa,rotation:da}=Q;var S=Math.round(aa[0]*W);I=Math.round(aa[1]*W);this._boundFBO=H.getBoundFramebufferObject();if(Q.spatialReference&&(Q.spatialReference._isWrappable?Q.spatialReference._isWrappable():Q.spatialReference.isWrappable)){var U=c.toRadian(da),X=Math.abs(Math.cos(U)),
ba=Math.abs(Math.sin(U)),Z=Math.round(Q.worldScreenWidth);if(Math.round(S*X+I*ba)<=Z)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===S&&this._clipFBO.height===I||(this._clipFBO=new p(H,{colorTarget:0,depthStencilTarget:3,width:S,height:I}));var P=(this.state.padding.left-this.state.padding.right)/2,L=(this.state.padding.bottom-this.state.padding.top)/2,O=.5*S,T=.5*I,ea=1/S,fa=1/I;Z=.5*Z*W;var ha=.5*(S*ba+I*X);S=this._upperLeft;X=this._upperRight;ba=this._lowerLeft;var ia=this._lowerRight;
e.set(S,-Z,-ha);e.set(X,Z,-ha);e.set(ba,-Z,ha);e.set(ia,Z,ha);g.identity(this._mat2);g.translate(this._mat2,this._mat2,[O+P,T+L]);0!==da&&g.rotate(this._mat2,this._mat2,U);e.transformMat2d(S,S,this._mat2);e.transformMat2d(X,X,this._mat2);e.transformMat2d(ba,ba,this._mat2);e.transformMat2d(ia,ia,this._mat2);U=this._clipData;U.set([2*ba[0]*ea-1,2*(I-ba[1])*fa-1,2*ia[0]*ea-1,2*(I-ia[1])*fa-1,2*S[0]*ea-1,2*(I-S[1])*fa-1,2*X[0]*ea-1,2*(I-X[1])*fa-1]);this._clipRendererInitialized||this._initializeClipRenderer(H);
this._clipVBO.setData(U);this._boundFBO=H.getBoundFramebufferObject();H.bindFramebuffer(this._clipFBO);H.setDepthWriteEnabled(!0);H.setStencilWriteMask(255);H.setClearColor(0,0,0,0);H.setClearDepth(1);H.setClearStencil(0);H.clear(H.gl.COLOR_BUFFER_BIT|H.gl.DEPTH_BUFFER_BIT|H.gl.STENCIL_BUFFER_BIT);H.setDepthWriteEnabled(!1);this._clipFrame=!0}}else this._clipFrame=!1};N._afterRenderChildren=function(){const I=this.context;I.logIno();if(this._clipFrame&&this._clipRendererInitialized){I.bindFramebuffer(this._boundFBO);
this._boundFBO=null;I.bindVAO(this._clipVAO);I.bindProgram(this._clipStencilProgram);I.setDepthWriteEnabled(!1);I.setDepthTestEnabled(!1);I.setStencilTestEnabled(!0);I.setBlendingEnabled(!1);I.setColorMask(!1,!1,!1,!1);I.setStencilOp(7680,7680,7681);I.setStencilWriteMask(255);I.setStencilFunction(519,1,255);I.drawElements(4,6,5123,0);I.bindVAO();I.setColorMask(!0,!0,!0,!0);if(null!=this.background){const {r:H,g:Q,b:W,a:aa}=this.background.color;I.setClearColor(aa*H/255,aa*Q/255,aa*W/255,aa)}else I.setClearColor(0,
0,0,0);I.clear(I.gl.COLOR_BUFFER_BIT);I.setBlendingEnabled(!0);I.setStencilFunction(514,1,255);this.painter.blitTexture(I,this._clipFBO.colorTexture,9728,1);I.setStencilTestEnabled(!1)}};N.doRender=function(I){const H=this.context,{state:Q,pixelRatio:W}=I;this._resizeCanvas(I);this.context.enforceState();H.setViewport(0,0,W*Q.size[0],W*Q.size[1]);H.setDepthWriteEnabled(!0);H.setStencilWriteMask(255);M.prototype.doRender.call(this,I)};N.takeScreenshot=async function(I,H){var Q=a.screenshotSuperSampleSettings(I,
this._supersampleScreenshots,this._state.padding);const {framebufferWidth:W,framebufferHeight:aa}=Q;var da=this.context,S=I.layers;let U=this.children;const X={...this._renderParameters,drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),pixelRatio:Q.pixelRatio,time:Date.now(),deltaTime:0,blendMode:null,effects:null,inFadeTransition:!1};if(null!=I.rotation){var ba=X.state.viewpoint;ba.rotation=I.rotation;X.state.viewpoint=ba}0<S.length&&(U=[],S.forEach(P=>{const L=
H.find(O=>O.layer.id===P.id);L&&"container"in L&&L.container&&U.push(L.container)}));const Z=new p(da,{colorTarget:0,depthStencilTarget:3,width:W,height:aa});S=da.getBoundFramebufferObject();ba=da.getViewport();da.bindFramebuffer(Z);da.setViewport(0,0,W,aa);this._renderChildren(U,X);Q=this._readbackScreenshot(Q);da.bindFramebuffer(S);da.setViewport(ba.x,ba.y,ba.width,ba.height);this.requestRender();da=this._ensureScreenshotEncodeCanvas();return a.encodeResult(Q,I,da,{flipY:!0,premultipliedAlpha:!0})};
N._ensureScreenshotEncodeCanvas=function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};N._readbackScreenshot=function(I){const {framebufferWidth:H,framebufferHeight:Q,region:W,resample:aa}=I;I=this.context.gl;if(aa){var da=a.createEmptyImageData(H,Q,this._ensureScreenshotEncodeCanvas());I.readPixels(0,0,H,Q,6408,5121,new Uint8Array(da.data.buffer));I=a.createEmptyImageData(W.width,W.height,this._ensureScreenshotEncodeCanvas());
return a.resampleHermite(da,I,!0,aa.region.x,Q-(aa.region.y+aa.region.height),aa.region.width,aa.region.height)}da=a.createEmptyImageData(W.width,W.height,this._ensureScreenshotEncodeCanvas());I.readPixels(W.x,Q-(W.y+W.height),W.width,W.height,6408,5121,new Uint8Array(da.data.buffer));return da};N._resizeCanvas=function(I){const H=this._canvas,Q=H.style,{state:{size:W},pixelRatio:aa}=I;I=W[0];const da=W[1],S=Math.round(I*aa),U=Math.round(da*aa);if(H.width!==S||H.height!==U)H.width=S,H.height=U;Q.width=
I+"px";Q.height=da+"px"};N._initializeClipRenderer=function(I){if(this._clipRendererInitialized)return!0;const H=K.stencil.attributes,Q=r.createProgram(I,K.stencil);if(!Q)return!1;const W=u.createVertex(I,35040,32);var aa=new Uint16Array([0,1,2,2,1,3]);aa=u.createIndex(I,35044,aa);I=new k(I,H,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:W},aa);this._clipStencilProgram=Q;this._clipVBO=W;this._clipVAO=I;return this._clipRendererInitialized=!0};N._emptyTrash=
function(){for(;0<this._trash.size;){const I=Array.from(this._trash);this._trash.clear();for(const H of I)H.processDetach()}};N._isLabelDrawPhaseRequired=function(I){let H=!1;for(const Q of I){if(!(Q instanceof B.Container)){H=H||!1;break}if(Q.hasLabels)return!0;H=H||this._isLabelDrawPhaseRequired(Q.children)}return H};E._createClass(R,[{key:"background",get:function(){return this._background},set:function(I){this._background=I;this.requestRender()}},{key:"highlightOptions",get:function(){return this._highlightOptions},
set:function(I){this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=I)this._highlightOptionsHandle=b.init(this._highlightOptions,"version",()=>{this.painter.setHighlightOptions(I);this.requestRender()})}},{key:"renderingOptions",get:function(){return this._renderingOptions},set:function(I){this._renderingOptions=I;this.requestRender()}},{key:"state",get:function(){return this._state},set:function(I){this._state=I;this.requestRender()}},
{key:"stationary",get:function(){return this._stationary},set:function(I){this._stationary!==I&&(this._stationary=I,this.requestRender())}}]);return R}(B.Container);z.EXTRA_RENDER_TIME=2E3;z.Stage=n;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/enums":function(){define(["exports"],function(z){(function(E){E[E.FILL=0]="FILL";E[E.LINE=1]="LINE";E[E.MARKER=2]="MARKER";E[E.TEXT=3]="TEXT";E[E.LABEL=4]="LABEL"})(z.WGLGeometryType||(z.WGLGeometryType={}));(function(E){E[E.SUCCEEDED=
0]="SUCCEEDED";E[E.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(z.WGLGeometryTransactionStatus||(z.WGLGeometryTransactionStatus={}));(function(E){E[E.NONE=0]="NONE";E[E.MAP=1]="MAP";E[E.LABEL=2]="LABEL";E[E.LABEL_ALPHA=4]="LABEL_ALPHA";E[E.HITTEST=8]="HITTEST";E[E.HIGHLIGHT=16]="HIGHLIGHT";E[E.CLIP=32]="CLIP";E[E.DEBUG=64]="DEBUG";E[E.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(z.WGLDrawPhase||(z.WGLDrawPhase={}));(function(E){E[E.SIZE=0]="SIZE";E[E.COLOR=1]="COLOR";E[E.OPACITY=2]="OPACITY";E[E.ROTATION=
3]="ROTATION"})(z.VVType||(z.VVType={}));(function(E){E[E.NONE=0]="NONE";E[E.OPACITY=1]="OPACITY";E[E.COLOR=2]="COLOR";E[E.ROTATION=4]="ROTATION";E[E.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";E[E.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";E[E.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";E[E.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(z.WGLVVFlag||(z.WGLVVFlag={}));(function(E){E[E.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";E[E.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";E[E.FIELD_TARGETS_OUTLINE=
512]="FIELD_TARGETS_OUTLINE";E[E.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(z.WGLVVTarget||(z.WGLVVTarget={}));(function(E){E[E.SPRITE=0]="SPRITE";E[E.GLYPH=1]="GLYPH"})(z.MosaicType||(z.MosaicType={}));Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/Container":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/has","./DisplayObject","../../layers/effects/EffectList"],function(z,E,D,C,A){const m=D("mapview-transitions-duration");
D=function(c){function b(){var a=c.apply(this,arguments)||this;a._childrenSet=new Set;a.children=[];a._effectList=null;return a}E._inheritsLoose(b,c);var d=b.prototype;d.updateTransitionProperties=function(a,e){c.prototype.updateTransitionProperties.call(this,a,e);this._effectList&&(this._effectList.transitionStep(a,e),this._effectList.transitioning&&this.requestRender())};d.doRender=function(a){a=this.createRenderParams(a);this.renderChildren(a)};d.addChild=function(a){return this.addChildAt(a,this.children.length)};
d.addChildAt=function(a,e=this.children.length){if(!a||this.contains(a))return a;const f=a.parent;f&&f!==this&&f.removeChild(a);e>=this.children.length?this.children.push(a):this.children.splice(e,0,a);this._childrenSet.add(a);a.parent=this;a.stage=this.stage;this!==this.stage&&(a.clips=this.clips);this.requestRender();return a};d.contains=function(a){return this._childrenSet.has(a)};d.removeAllChildren=function(){this._childrenSet.clear();for(const a of this.children)this!==this.stage&&(a.clips=
null),a.stage=null,a.parent=null;this.children.length=0};d.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.children.indexOf(a)):a};d.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet.delete(a);this!==this.stage&&(a.clips=null);a.stage=null;a.parent=null;return a};d.sortChildren=function(a){return this.children.sort(a)};d.onAttach=function(){c.prototype.onAttach.call(this);const a=this.stage;for(const e of this.children)e.stage=
a};d.onDetach=function(){c.prototype.onDetach.call(this);for(const a of this.children)a.stage=null};d.renderChildren=function(a){for(const e of this.children)e.beforeRender(a);for(const e of this.children)e.processRender(a);for(const e of this.children)e.afterRender(a)};d.createRenderParams=function(a){return{...a,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:a.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}};E._createClass(b,[{key:"blendMode",get:function(){return this._blendMode},
set:function(a){this._blendMode=a;this.requestRender()}},{key:"clips",get:function(){return this._clips},set:function(a){this._clips=a;this.children.forEach(e=>e.clips=a)}},{key:"computedEffects",get:function(){var a,e;return null!=(a=null==(e=this._effectList)?void 0:e.effects)?a:null}},{key:"effect",get:function(){var a,e;return null!=(a=null==(e=this._effectList)?void 0:e.effect)?a:""},set:function(a){if(this._effectList||a)this._effectList||(this._effectList=new A["default"](m)),this._effectList.effect=
a,this.requestRender()}}]);return b}(C.DisplayObject);z.Container=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/DisplayObject":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../../../core/has","../../../core/promiseUtils","../../../core/Evented"],function(z,E,D,C,A){const m=1/D("mapview-transitions-duration");D=function(c){function b(){var a=c.apply(this,arguments)||this;a._fadeOutResolver=null;a._fadeInResolver=null;a._clips=null;a.computedVisible=
!0;a.computedOpacity=1;a.fadeTransitionEnabled=!1;a.inFadeTransition=!1;a._isReady=!1;a._opacity=1;a._stage=null;a._visible=!0;return a}E._inheritsLoose(b,c);var d=b.prototype;d.fadeIn=function(){if(this._fadeInResolver)return this._fadeInResolver.promise;this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null);this.computedOpacity=0;this.fadeTransitionEnabled=!0;this._fadeInResolver=C.createResolver();this.requestRender();return this._fadeInResolver.promise};d.fadeOut=function(){if(this._fadeOutResolver)return this._fadeOutResolver.promise;
this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null);this.fadeTransitionEnabled=!0;this._fadeOutResolver=C.createResolver();this.requestRender();return this._fadeOutResolver.promise};d.beforeRender=function(a){this.updateTransitionProperties(a.deltaTime,a.state.scale)};d.afterRender=function(a){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=
null)};d.setTransform=function(a){};d.processRender=function(a){this.stage&&this.computedVisible&&this.doRender(a)};d.requestRender=function(){this.stage&&this.stage.requestRender()};d.processDetach=function(){this.onDetach();this.emit("detach")};d.updateTransitionProperties=function(a,e){if(this.fadeTransitionEnabled){e=this._fadeOutResolver||!this.visible?0:this.opacity;const f=this.computedOpacity;f===e?this.computedVisible=this.visible:(a*=m,this.computedOpacity=f>e?Math.max(e,f-a):Math.min(e,
f+a),this.computedVisible=0<this.computedOpacity,a=e===this.computedOpacity,this.inFadeTransition=!a,a||this.requestRender())}else this.computedOpacity=this.opacity,this.computedVisible=this.visible};d.onAttach=function(){};d.onDetach=function(){};d.doRender=function(a){};d.ready=function(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())};E._createClass(b,[{key:"clips",get:function(){return this._clips},set:function(a){this._clips=a;this.requestRender()}},{key:"isReady",
get:function(){return this._isReady}},{key:"opacity",get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=Math.min(1,Math.max(a,0)),this.requestRender())}},{key:"stage",get:function(){return this._stage},set:function(a){if(this._stage!==a){var e=this._stage;(this._stage=a)?this._stage.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):e.trashDisplayObject(this)}}},{key:"visible",get:function(){return this._visible},set:function(a){this._visible!==a&&
(this._visible=a,this.requestRender())}}]);return b}(A);z.DisplayObject=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/layers/effects/EffectList":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/lang ../../../core/Logger ../../../core/Error ../../../colorUtils ./effects ./parser".split(" "),function(z,E,D,C,A,m,c,b){function d(n){if(!n)return[];if("string"===typeof n){var u=b.parse(n);return u.error?u.error:[{scale:-1,effects:u.effects}]}u=[];for(var t of n){if(!isFinite(t.scale)||
0>=t.scale)return new A("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});n=b.parse(t.value);if(n.error)return n.error;u.push({scale:t.scale,effects:n.effects})}u.sort((k,v)=>v.effects.length-k.effects.length);for(t=0;t<u.length-1;t++){if(!e(u[t].effects,u[t+1].effects))return new A("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:u[t].effects,b:u[t+1].effects});f(u[t].effects,u[t+1].effects)}u.sort((k,v)=>v.scale-k.scale);
return u}function a(n){switch(n.type){case "grayscale":case "sepia":case "invert":return new c.ColorMatrixEffect(n.type,0);case "saturate":case "brightness":case "contrast":return new c.ColorMatrixEffect(n.type,1);case "opacity":return new c.OpacityEffect(1);case "hue-rotate":return new c.HueRotateEffect(0);case "blur":return new c.BlurEffect(0);case "drop-shadow":return new c.DropShadowEffect(0,0,0,[...m.getNamedColor("transparent")]);case "bloom":return new c.BloomEffect(0,0,0)}}function e(n,u){const t=
n.length>u.length?n:u;return(n.length>u.length?u:n).every((k,v)=>k.type===t[v].type)}function f(n,u){const t=n.length>u.length?n:u;n=n.length>u.length?u:n;for(u=n.length;u<t.length;u++)n.push(a(t[u]))}function g(n,u,t){var k,v,p,r;return null!=(k=n[0])&&k.effects&&null!=(v=u[0])&&v.effects?(-1===(null==(p=n[0])?void 0:p.scale)||-1===(null==(r=u[0])?void 0:r.scale))&&(1<n.length||1<u.length)&&0>=t?!1:e(n[0].effects,u[0].effects):!0}function q(n,u,t){var k,v;const p=n.length>u.length?n:u;n=n.length>
u.length?u:n;const r=n[n.length-1];u=null!=(k=null==r?void 0:r.scale)?k:t;k=null!=(v=null==r?void 0:r.effects)?v:[];for(v=n.length;v<p.length;v++)n.push({scale:u,effects:[...k]});for(v=0;v<p.length;v++)n[v].scale=-1===n[v].scale?t:n[v].scale,p[v].scale=-1===p[v].scale?t:p[v].scale,f(n[v].effects,p[v].effects)}let h=function(){function n(t=200){this.duration=t;this._final=this._to=this._from=null;this._current=[];this._time=0;this._effect="";this._effects=[];this._scale=0}var u=n.prototype;u.transitionStep=
function(t,k){this._applyTimeTransition(t);this._updateForScale(k)};u._transitionTo=function(t){0<this.scale&&g(this._current,t,this.scale)?(this._final=t,this._to=D.clone(t),q(this._current,this._to,this.scale),this._from=D.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=t);this._effects=this._current[0]?D.clone(this._current[0].effects):[]};u._applyTimeTransition=function(t){if(this._to){this._time+=t;t=Math.min(1,this._time/this.duration);for(let v=0;v<this._current.length;v++){const p=
this._current[v],r=this._from[v],w=this._to[v];var k=r.scale;p.scale=k+(w.scale-k)*t;for(k=0;k<p.effects.length;k++)p.effects[k].interpolate(r.effects[k],w.effects[k],t)}1===t&&(this._current=this._final,this._effects=this._current[0]?D.clone(this._current[0].effects):[],this._from=this._to=this._final=null)}};u._updateForScale=function(t){if(0!==this._current.length){this._scale=t;var k=this._current,v=this._current.length-1,p,r=1;if(1===k.length||t>=k[0].scale)var w=p=k[0].effects;else if(t<=k[v].scale)w=
p=k[v].effects;else for(let l=0;l<v;l++){const x=k[l],y=k[l+1];if(x.scale>=t&&y.scale<=t){r=(t-x.scale)/(y.scale-x.scale);p=x.effects;w=y.effects;break}}for(t=0;t<this._effects.length;t++)this._effects[t].interpolate(p[t],w[t],r)}};E._createClass(n,[{key:"effect",get:function(){return this._effect},set:function(t){t=t||"";if(this._effect!==t){this._effect=t;var k=d(t);Array.isArray(k)?this._transitionTo(k):(this._transitionTo([]),C.getLogger("esri.views.layers.effects.EffectList").warn("Invalid Effect",
{effect:t,error:k}))}}},{key:"hasEffects",get:function(){return this.transitioning||!!this._effects.length}},{key:"effects",get:function(){return this._effects}},{key:"scale",get:function(){return this._scale}},{key:"transitioning",get:function(){return null!==this._to}}]);return n}();z.canInterpolateEffectStops=g;z.canInterpolateEffects=e;z.convertEffectToStops=d;z.default=h;z.normalizeEffectStops=q;z.normalizeEffects=f;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/layers/effects/effects":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../../../chunks/mat4f32","./colorMatrixFunctions"],function(z,E,D,C){function A(f,g,q){return f+(g-f)*q}let m=function(){function f(q,h,n){this.strength=q;this.radius=h;this.threshold=n;this.type="bloom"}var g=f.prototype;g.interpolate=function(q,h,n){this.strength=A(q.strength,h.strength,n);this.radius=A(q.radius,h.radius,n);this.threshold=A(q.threshold,h.threshold,n)};g.clone=function(){return new f(this.strength,this.radius,this.threshold)};return f}(),
c=function(){function f(q){this.radius=q;this.type="blur"}var g=f.prototype;g.interpolate=function(q,h,n){this.radius=Math.round(A(q.radius,h.radius,n))};g.clone=function(){return new f(this.radius)};return f}(),b=function(){function f(q,h){this.type=q;this.amount=h;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}var g=f.prototype;g.interpolate=function(q,h,n){this.amount=A(q.amount,h.amount,n);this._updateMatrix()};g.clone=function(){return new f(this.type,
this.amount)};g._updateMatrix=function(){const q=this._colorMatrix||D.create();switch(this.type){case "brightness":this._colorMatrix=C.brightness(q,this.amount);break;case "contrast":this._colorMatrix=C.contrast(q,this.amount);break;case "grayscale":this._colorMatrix=C.grayscale(q,this.amount);break;case "invert":this._colorMatrix=C.invert(q,this.amount);break;case "saturate":this._colorMatrix=C.saturate(q,this.amount);break;case "sepia":this._colorMatrix=C.sepia(q,this.amount)}};E._createClass(f,
[{key:"colorMatrix",get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}}]);return f}(),d=function(){function f(q,h,n,u){this.offsetX=q;this.offsetY=h;this.blurRadius=n;this.color=u;this.type="drop-shadow"}var g=f.prototype;g.interpolate=function(q,h,n){this.offsetX=A(q.offsetX,h.offsetX,n);this.offsetY=A(q.offsetY,h.offsetY,n);this.blurRadius=A(q.blurRadius,h.blurRadius,n);this.color[0]=Math.round(A(q.color[0],h.color[0],n));this.color[1]=Math.round(A(q.color[1],h.color[1],
n));this.color[2]=Math.round(A(q.color[2],h.color[2],n));this.color[3]=A(q.color[3],h.color[3],n)};g.clone=function(){return new f(this.offsetX,this.offsetY,this.blurRadius,[...this.color])};return f}(),a=function(){function f(q){this.angle=q;this.type="hue-rotate"}var g=f.prototype;g.interpolate=function(q,h,n){this.angle=A(q.angle,h.angle,n);this._updateMatrix()};g.clone=function(){return new f(this.angle)};g._updateMatrix=function(){const q=this._colorMatrix||D.create();this._colorMatrix=C.rotateHue(q,
this.angle)};E._createClass(f,[{key:"colorMatrix",get:function(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}}]);return f}(),e=function(){function f(q){this.amount=q;this.type="opacity";this.amount=Math.min(this.amount,1)}var g=f.prototype;g.interpolate=function(q,h,n){this.amount=A(q.amount,h.amount,n)};g.clone=function(){return new f(this.amount)};return f}();z.BloomEffect=m;z.BlurEffect=c;z.ColorMatrixEffect=b;z.DropShadowEffect=d;z.HueRotateEffect=a;z.OpacityEffect=e;z.isColorMatrixEffect=
function(f){return"colorMatrix"in f};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/chunks/mat4f32":function(){define(["exports"],function(z){function E(){const b=new Float32Array(16);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}function D(b){const d=new Float32Array(16);d[0]=b[0];d[1]=b[1];d[2]=b[2];d[3]=b[3];d[4]=b[4];d[5]=b[5];d[6]=b[6];d[7]=b[7];d[8]=b[8];d[9]=b[9];d[10]=b[10];d[11]=b[11];d[12]=b[12];d[13]=b[13];d[14]=b[14];d[15]=b[15];return d}function C(b,d,a,e,f,g,q,h,n,u,t,k,v,p,r,w){const l=
new Float32Array(16);l[0]=b;l[1]=d;l[2]=a;l[3]=e;l[4]=f;l[5]=g;l[6]=q;l[7]=h;l[8]=n;l[9]=u;l[10]=t;l[11]=k;l[12]=v;l[13]=p;l[14]=r;l[15]=w;return l}function A(b,d){return new Float32Array(b,d,16)}const m=E();var c=Object.freeze({__proto__:null,create:E,clone:D,fromValues:C,createView:A,IDENTITY:m});z.IDENTITY=m;z.clone=D;z.create=E;z.createView=A;z.fromValues=C;z.mat4f32=c})},"esri/views/layers/effects/colorMatrixFunctions":function(){define(["exports","../../../chunks/mat4"],function(z,E){z.brightness=
(D,C)=>{D=E.set(D,C,0,0,0,0,C,0,0,0,0,C,0,0,0,0,1);return E.transpose(D,D)};z.contrast=(D,C)=>{D=E.set(D,C,0,0,.5-.5*C,0,C,0,.5-.5*C,0,0,C,.5-.5*C,0,0,0,1);return E.transpose(D,D)};z.grayscale=(D,C)=>{C=1-C;D=E.set(D,.2126+.7874*C,.7152-.7152*C,.0722-.0722*C,0,.2126-.2126*C,.7152+.2848*C,.0722-.0722*C,0,.2126-.2126*C,.7152-.7152*C,.0722+.9278*C,0,0,0,0,1);return E.transpose(D,D)};z.invert=(D,C)=>{const A=1-2*C;D=E.set(D,A,0,0,C,0,A,0,C,0,0,A,C,0,0,0,1);return E.transpose(D,D)};z.rotateHue=(D,C)=>
{const A=Math.sin(C*Math.PI/180);C=Math.cos(C*Math.PI/180);D=E.set(D,.213+.787*C-.213*A,.715-.715*C-.715*A,.072-.072*C+.928*A,0,.213-.213*C+.143*A,.715+.285*C+.14*A,.072-.072*C-.283*A,0,.213-.213*C-.787*A,.715-.715*C+.715*A,.072+.928*C+.072*A,0,0,0,0,1);return E.transpose(D,D)};z.saturate=(D,C)=>{D=E.set(D,.213+.787*C,.715-.715*C,.072-.072*C,0,.213-.213*C,.715+.285*C,.072-.072*C,0,.213-.213*C,.715-.715*C,.072+.928*C,0,0,0,0,1);return E.transpose(D,D)};z.sepia=(D,C)=>{C=1-C;D=E.set(D,.393+.607*C,.769-
.769*C,.189-.189*C,0,.349-.349*C,.686+.314*C,.168-.168*C,0,.272-.272*C,.534-.534*C,.131+.869*C,0,0,0,0,1);return E.transpose(D,D)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/layers/effects/parser":function(){define(["exports","../../../core/Error","../../../colorUtils","../../../chunks/_commonjsHelpers","./effects"],function(z,E,D,C,A){function m(k){try{switch(k.name){case "grayscale":case "sepia":case "saturate":case "invert":case "brightness":case "contrast":var v,p=1;c(k.parameters,
1);1===k.parameters.length&&(p=a(k.parameters[0]));return v=new A.ColorMatrixEffect(k.name,p);case "opacity":var r;p=1;c(k.parameters,1);1===k.parameters.length&&(p=a(k.parameters[0]));return r=new A.OpacityEffect(p);case "hue-rotate":var w;p=0;c(k.parameters,1);if(1===k.parameters.length){var l=k.parameters[0];if("quantity"!==l.type||(0!==l.value||null!==l.unit)&&null==h[l.unit])throw new E("effect:type-error",`Expected <angle>, Actual: ${b(l)}`,{term:l});p=l.value*h[l.unit]||0}return w=new A.HueRotateEffect(p);
case "blur":var x;p=0;c(k.parameters,1);1===k.parameters.length&&(p=f(k.parameters[0]),d(p,k.parameters[0]));return x=new A.BlurEffect(p);case "drop-shadow":r=[];for(const G of k.parameters)if("color"===G.type){r.length&&Object.freeze(r);if(B)throw new E("effect:type-error","Accepts only one color",{});a:{var y=void 0;v=G;switch(v.colorType){case "hex":var B=D.hex2rgba(v.value);break a;case "named":B=g(v.value);break a;case "function":var F=v.value;c(F.parameters,4);if(u.test(F.name))y=[a(F.parameters[0]),
a(F.parameters[1]),a(F.parameters[2]),F.parameters[3]?a(F.parameters[3]):1];else if(t.test(F.name))y=D.hsla2rgba(e(F.parameters[0]),a(F.parameters[1]),a(F.parameters[2]),F.parameters[3]?a(F.parameters[3]):1);else throw new E("effect:syntax-error",`Invalid color function '${F.name}'`,{colorFunction:F});B=y;break a}B=void 0}}else{const J=f(G);if(Object.isFrozen(r))throw new E("effect:type-error","\x3clength\x3e parameters not consecutive",{lengths:r});r.push(J);3===r.length&&d(J,G)}if(2>r.length||3<
r.length)throw new E("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${r.length}}`,{lengths:r});return p=new A.DropShadowEffect(r[0],r[1],r[2]||0,B||g("black"));case "bloom":return p=1,B=F=0,c(k.parameters,3),k.parameters[0]&&(p=a(k.parameters[0])),k.parameters[1]&&(F=f(k.parameters[1]),d(F,k.parameters[1])),k.parameters[2]&&(B=a(k.parameters[2])),y=new A.BloomEffect(p,F,B)}}catch(G){throw G.details.filter=k,G;}throw new E("effect:unknown-effect",`Effect '${k.name}' is not supported`,
{effect:k});}function c(k,v){if(k.length>v)throw new E("effect:type-error",`Function supports up to ${v} parameters, Actual: ${k.length}`,{parameters:k});}function b(k){return"color"===k.type?"\x3ccolor\x3e":n[k.unit]?"\x3clength\x3e":h[k.unit]?"\x3cangle\x3e":"%"===k.unit?"\x3cpercentage\x3e":"\x3cdouble\x3e"}function d(k,v){if(0>k)throw new E("effect:type-error",`Negative values are not allowed, Actual: ${k}`,{term:v});}function a(k){if("quantity"!==k.type||null!==k.unit&&"%"!==k.unit)throw new E("effect:type-error",
`Expected <double> or <percentage>, Actual: ${b(k)}`,{term:k});const v=k.value;d(v,k);return"%"===k.unit?.01*v:v}function e(k){if("quantity"!==k.type||null!==k.unit)throw new E("effect:type-error",`Expected <double>, Actual: ${b(k)}`,{term:k});d(k.value,k);return k.value}function f(k){if("quantity"!==k.type||(0!==k.value||null!==k.unit)&&null==n[k.unit])throw new E("effect:type-error",`Expected <length>, Actual: ${b(k)}`,{term:k});return k.value*n[k.unit]||0}function g(k){const v=D.getNamedColorCopy(k);
if(!v)throw new E("effect:unknown-color",`color '${k}' isn't valid`,{namedColor:k});return v}var q=C.createCommonjsModule(function(k){(function(v,p){k.exports&&(k.exports=p())})(C.commonjsGlobal,function(){function v(p,r,w,l){this.message=p;this.expected=r;this.found=w;this.location=l;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,v)}(function(p,r){function w(){this.constructor=p}w.prototype=r.prototype;p.prototype=new w})(v,Error);v.buildMessage=
function(p,r){function w(B){return B.charCodeAt(0).toString(16).toUpperCase()}function l(B){return B.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(F){return"\\x0"+w(F)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(F){return"\\x"+w(F)})}function x(B){return B.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(F){return"\\x0"+w(F)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(F){return"\\x"+w(F)})}var y={literal:function(B){return'"'+l(B.text)+'"'},"class":function(B){var F="",G;for(G=0;G<B.parts.length;G++)F+=B.parts[G]instanceof Array?x(B.parts[G][0])+"-"+x(B.parts[G][1]):x(B.parts[G]);return"["+(B.inverted?"^":"")+F+"]"},any:function(B){return"any character"},end:function(B){return"end of input"},other:function(B){return B.description}};return"Expected "+
function(B){var F=Array(B.length),G;for(G=0;G<B.length;G++){var J=G;var K=B[G];K=y[K.type](K);F[J]=K}F.sort();if(0<F.length){for(B=G=1;G<F.length;G++)F[G-1]!==F[G]&&(F[B]=F[G],B++);F.length=B}switch(F.length){case 1:return F[0];case 2:return F[0]+" or "+F[1];default:return F.slice(0,-1).join(", ")+", or "+F[F.length-1]}}(p)+" but "+(r?'"'+l(r)+'"':"end of input")+" found."};return{SyntaxError:v,parse:function(p,r){function w(ja,V){return{type:"literal",text:ja,ignoreCase:V}}function l(ja,V,ca){return{type:"class",
parts:ja,inverted:V,ignoreCase:ca}}function x(ja){return{type:"other",description:ja}}function y(ja){var V=Ga[ja],ca;if(!V){for(ca=ja-1;!Ga[ca];)ca--;V=Ga[ca];for(V={line:V.line,column:V.column};ca<ja;)10===p.charCodeAt(ca)?(V.line++,V.column=1):V.column++,ca++;Ga[ja]=V}return V}function B(ja,V){var ca=y(ja),ka=y(V);return{start:{offset:ja,line:ca.line,column:ca.column},end:{offset:V,line:ka.line,column:ka.column}}}function F(ja){Y<ya||(Y>ya&&(ya=Y,Ia=[]),Ia.push(ja))}function G(){ma++;var ja=Y;var V=
M();V!==H?(p.substr(Y,4)===da?(V=da,Y+=4):(V=H,0===ma&&F(S)),V!==H?(V=M(),V!==H?(sa=ja,ja=V=[]):(Y=ja,ja=H)):(Y=ja,ja=H)):(Y=ja,ja=H);ma--;ja===H&&(V=H,0===ma&&F(aa));if(ja===H)if(ja=[],V=J(),V!==H)for(;V!==H;)ja.push(V),V=J();else ja=H;return ja}function J(){var ja=Y;var V=M();if(V!==H){ma++;V=Y;var ca=R();if(ca!==H){if(40===p.charCodeAt(Y)){var ka=ea;Y++}else ka=H,0===ma&&F(fa);ka!==H?(sa=V,V=ca):(Y=V,V=H)}else Y=V,V=H;ma--;V===H&&(ca=H,0===ma&&F(T));if(V!==H)if(ca=M(),ca!==H){ka=Y;var ua=K();if(ua!==
H){ca=[];var pa=Y;var Ca=M();if(Ca!==H){if(44===p.charCodeAt(Y)){var xa=ba;Y++}else xa=H,0===ma&&F(Z);xa===H&&(xa=null);if(xa!==H){var Da=M();if(Da!==H){var Ea=K();Ea!==H?pa=Ca=[Ca,xa,Da,Ea]:(Y=pa,pa=H)}else Y=pa,pa=H}else Y=pa,pa=H}else Y=pa,pa=H;for(;pa!==H;)ca.push(pa),pa=Y,Ca=M(),Ca!==H?(44===p.charCodeAt(Y)?(xa=ba,Y++):(xa=H,0===ma&&F(Z)),xa===H&&(xa=null),xa!==H?(Da=M(),Da!==H?(Ea=K(),Ea!==H?pa=Ca=[Ca,xa,Da,Ea]:(Y=pa,pa=H)):(Y=pa,pa=H)):(Y=pa,pa=H)):(Y=pa,pa=H);ca!==H?(sa=ka,ka=ua,ka=ua=0<ca.length?
[ka].concat(I(ca,3)):[ka]):(Y=ka,ka=H)}else Y=ka,ka=H;ca=ka;ca===H&&(ca=null);ca!==H?(ka=M(),ka!==H?(41===p.charCodeAt(Y)?(ka=U,Y++):(ka=H,0===ma&&F(X)),ka!==H?(ka=M(),ka!==H?(sa=ja,ja=V={type:"function",name:V,parameters:ca||[]}):(Y=ja,ja=H)):(Y=ja,ja=H)):(Y=ja,ja=H)):(Y=ja,ja=H)}else Y=ja,ja=H;else Y=ja,ja=H}else Y=ja,ja=H;return ja}function K(){var ja=Y;ma++;var V=Y;var ca=M();if(ca!==H)if(ca=N(),ca!==H){if(37===p.charCodeAt(Y)){var ka=oa;Y++}else ka=H,0===ma&&F(ra);ka!==H?(sa=V,V=ca={value:ca,
unit:"%"}):(Y=V,V=H)}else Y=V,V=H;else Y=V,V=H;ma--;V===H&&(ca=H,0===ma&&F(qa));V===H&&(ma++,V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===ta?(ka=ta,Y+=2):(ka=H,0===ma&&F(va)),ka!==H?(sa=V,V=ca={value:ca,unit:"px"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===wa?(ka=wa,Y+=2):(ka=H,0===ma&&F(Ha)),ka!==H?(sa=V,V=ca={value:ca,unit:"cm"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===Fa?(ka=Fa,Y+=2):(ka=H,0===
ma&&F(za)),ka!==H?(sa=V,V=ca={value:ca,unit:"mm"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===Ja?(ka=Ja,Y+=2):(ka=H,0===ma&&F(Ua)),ka!==H?(sa=V,V=ca={value:ca,unit:"in"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===Ka?(ka=Ka,Y+=2):(ka=H,0===ma&&F(Va)),ka!==H?(sa=V,V=ca={value:ca,unit:"pt"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(p.substr(Y,2)===La?(ka=La,Y+=2):(ka=H,0===
ma&&F(Wa)),ka!==H?(sa=V,V=ca={value:ca,unit:"pc"}):(Y=V,V=H)):(Y=V,V=H)):(Y=V,V=H)))))),ma--,V===H&&(ca=H,0===ma&&F(na)),V===H&&(ma++,V=Y,ca=N(),ca!==H?(p.substr(Y,3)===Ma?(ka=Ma,Y+=3):(ka=H,0===ma&&F(Xa)),ka!==H?(sa=V,V=ca={value:ca,unit:"deg"}):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=N(),ca!==H?(p.substr(Y,3)===Na?(ka=Na,Y+=3):(ka=H,0===ma&&F(Ya)),ka!==H?(sa=V,V=ca={value:ca,unit:"rad"}):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=N(),ca!==H?(p.substr(Y,4)===Oa?(ka=Oa,Y+=4):(ka=H,0===ma&&F(Za)),ka!==H?(sa=
V,V=ca={value:ca,unit:"grad"}):(Y=V,V=H)):(Y=V,V=H),V===H&&(V=Y,ca=N(),ca!==H?(p.substr(Y,4)===Pa?(ka=Pa,Y+=4):(ka=H,0===ma&&F($a)),ka!==H?(sa=V,V=ca={value:ca,unit:"turn"}):(Y=V,V=H)):(Y=V,V=H)))),ma--,V===H&&(ca=H,0===ma&&F(ab)),V===H&&(ma++,V=Y,ca=M(),ca!==H?(ca=N(),ca!==H?(sa=V,V=ca={value:ca,unit:null}):(Y=V,V=H)):(Y=V,V=H),ma--,V===H&&(ca=H,0===ma&&F(bb)))));V!==H&&(sa=ja,V={type:"quantity",value:V.value,unit:V.unit});ja=V;if(ja===H){ja=Y;ma++;V=Y;35===p.charCodeAt(Y)?(ca=cb,Y++):(ca=H,0===
ma&&F(db));if(ca!==H){ca=[];Qa.test(p.charAt(Y))?(ka=p.charAt(Y),Y++):(ka=H,0===ma&&F(Ra));if(ka!==H)for(;ka!==H;)ca.push(ka),Qa.test(p.charAt(Y))?(ka=p.charAt(Y),Y++):(ka=H,0===ma&&F(Ra));else ca=H;ca!==H?(sa=V,V=ca={type:"hex",value:p.substring(sa,Y)}):(Y=V,V=H)}else Y=V,V=H;V===H&&(V=Y,ca=J(),ca!==H&&(sa=V,ca={type:"function",value:ca}),V=ca,V===H&&(V=Y,ca=R(),ca!==H&&(sa=V,ca={type:"named",value:p.substring(sa,Y)}),V=ca));ma--;V===H&&(ca=H,0===ma&&F(eb));V!==H&&(sa=ja,V={type:"color",colorType:V.type,
value:V.value});ja=V}return ja}function M(){ma++;var ja=[];if(L.test(p.charAt(Y))){var V=p.charAt(Y);Y++}else V=H,0===ma&&F(O);for(;V!==H;)ja.push(V),L.test(p.charAt(Y))?(V=p.charAt(Y),Y++):(V=H,0===ma&&F(O));ma--;ja===H&&(V=H,0===ma&&F(P));return ja}function R(){ma++;var ja=Y;var V=[];if(ia.test(p.charAt(Y))){var ca=p.charAt(Y);Y++}else ca=H,0===ma&&F(la);if(ca!==H)for(;ca!==H;)V.push(ca),ia.test(p.charAt(Y))?(ca=p.charAt(Y),Y++):(ca=H,0===ma&&F(la));else V=H;V!==H&&(sa=ja,V=p.substring(sa,Y));ja=
V;ma--;ja===H&&(V=H,0===ma&&F(ha));return ja}function N(){var ja=Y;if(Sa.test(p.charAt(Y))){var V=p.charAt(Y);Y++}else V=H,0===ma&&F(Ta);V===H&&(V=null);if(V!==H){var ca=Y;V=[];if(Aa.test(p.charAt(Y))){var ka=p.charAt(Y);Y++}else ka=H,0===ma&&F(Ba);for(;ka!==H;)V.push(ka),Aa.test(p.charAt(Y))?(ka=p.charAt(Y),Y++):(ka=H,0===ma&&F(Ba));if(V!==H)if(46===p.charCodeAt(Y)?(ka=fb,Y++):(ka=H,0===ma&&F(gb)),ka!==H){var ua=[];if(Aa.test(p.charAt(Y))){var pa=p.charAt(Y);Y++}else pa=H,0===ma&&F(Ba);if(pa!==H)for(;pa!==
H;)ua.push(pa),Aa.test(p.charAt(Y))?(pa=p.charAt(Y),Y++):(pa=H,0===ma&&F(Ba));else ua=H;ua!==H?ca=V=[V,ka,ua]:(Y=ca,ca=H)}else Y=ca,ca=H;else Y=ca,ca=H;if(ca===H)if(ca=[],Aa.test(p.charAt(Y))?(V=p.charAt(Y),Y++):(V=H,0===ma&&F(Ba)),V!==H)for(;V!==H;)ca.push(V),Aa.test(p.charAt(Y))?(V=p.charAt(Y),Y++):(V=H,0===ma&&F(Ba));else ca=H;if(ca!==H){V=Y;101===p.charCodeAt(Y)?(ka=hb,Y++):(ka=H,0===ma&&F(ib));if(ka!==H)if(Sa.test(p.charAt(Y))?(ua=p.charAt(Y),Y++):(ua=H,0===ma&&F(Ta)),ua===H&&(ua=null),ua!==
H){pa=[];Aa.test(p.charAt(Y))?(ca=p.charAt(Y),Y++):(ca=H,0===ma&&F(Ba));if(ca!==H)for(;ca!==H;)pa.push(ca),Aa.test(p.charAt(Y))?(ca=p.charAt(Y),Y++):(ca=H,0===ma&&F(Ba));else pa=H;pa!==H?V=ka=[ka,ua,pa]:(Y=V,V=H)}else Y=V,V=H;else Y=V,V=H;V===H&&(V=null);V!==H?(sa=ja,ja=V=parseFloat(p.substring(sa,Y))):(Y=ja,ja=H)}else Y=ja,ja=H}else Y=ja,ja=H;return ja}function I(ja,V){return ja.map(function(ca){return ca[V]})}r=void 0!==r?r:{};var H={},Q={start:G},W=G,aa=x("none"),da="none",S=w("none",!1),U=")",
X=w(")",!1),ba=",",Z=w(",",!1),P=x("whitespace"),L=/^[ \t\n\r]/,O=l([" ","\t","\n","\r"],!1,!1),T=x("function"),ea="(",fa=w("(",!1),ha=x("identifier"),ia=/^[a-z\-]/,la=l([["a","z"],"-"],!1,!1),qa=x("percentage"),oa="%",ra=w("%",!1),na=x("length"),ta="px",va=w("px",!1),wa="cm",Ha=w("cm",!1),Fa="mm",za=w("mm",!1),Ja="in",Ua=w("in",!1),Ka="pt",Va=w("pt",!1),La="pc",Wa=w("pc",!1),ab=x("angle"),Ma="deg",Xa=w("deg",!1),Na="rad",Ya=w("rad",!1),Oa="grad",Za=w("grad",!1),Pa="turn",$a=w("turn",!1),bb=x("number"),
eb=x("color"),cb="#",db=w("#",!1),Qa=/^[0-9a-fA-F]/,Ra=l([["0","9"],["a","f"],["A","F"]],!1,!1),Sa=/^[+\-]/,Ta=l(["+","-"],!1,!1),Aa=/^[0-9]/,Ba=l([["0","9"]],!1,!1),fb=".",gb=w(".",!1),hb="e",ib=w("e",!1),Y=0,sa=0,Ga=[{line:1,column:1}],ya=0,Ia=[],ma=0;if("startRule"in r){if(!(r.startRule in Q))throw Error("Can't start parsing from rule \""+r.startRule+'".');W=Q[r.startRule]}r=W();if(r!==H&&Y===p.length)return r;r!==H&&Y<p.length&&F({type:"end"});throw function(ja,V,ca){return new v(v.buildMessage(ja,
V),ja,V,ca)}(Ia,ya<p.length?p.charAt(ya):null,ya<p.length?B(ya,ya+1):B(ya,ya));}}})});const h={deg:1,grad:.9,rad:180/Math.PI,turn:360},n={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/73},u=/^rgba?/i,t=/^hsla?/i;z.parse=function(k){let v;try{v=k?q.parse(k):[]}catch(p){return{input:k,parsedFunctions:[],effects:[],error:new E("effect:invalid-syntax","Invalid effect syntax",{input:k,error:p})}}k={input:k,parsedFunctions:v,effects:[],error:null};try{for(const p of v)k.effects.push(m(p))}catch(p){k.effects.length=
0,k.error=p}return k};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Painter":function(){define("../../../../core/maybe ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ../brushes ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/BlendEffect ./effects/FeatureEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/post-processing/EffectManager ./painter/RenderPass".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v,p,r,w){function l(x,y,B){return 1!==B||z.isSome(x)&&"normal"!==x||z.isSome(y)&&0<y.length}return function(){function x(B,F){this.context=B;this._blitRenderer=new q.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this._blendEffect=new t.BlendEffect;this.effects={highlight:new v,hittest:new p.HittestEffect,integrate:new u.AnimationEffect,insideEffect:new k.FeatureEffect("inside"),outsideEffect:new k.FeatureEffect("outside")};this.materialManager=
new h(B);this._vtlProgramCache=new g(B);this.textureManager=new n(F);this._effectsManager=new r.EffectManager(F)}var y=x.prototype;y.getRenderTarget=function(){return this._renderTarget};y.setRenderTarget=function(B){this._renderTarget=B};y.getFbos=function(B,F){if(B!==this._lastWidth||F!==this._lastHeight){this._lastWidth=B;this._lastHeight=F;if(this._fbos){for(var G in this._fbos)this._fbos[G].resize(B,F);return this._fbos}G={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,
width:B,height:F};const J={colorTarget:0,depthStencilTarget:3};this._stencilBuf=B=new m(this.context,{width:B,height:F,internalFormat:34041});this._fbos={output:new c(this.context,J,G,B),blend:new c(this.context,J,G,B),effect0:new c(this.context,J,G,B)}}return this._fbos};y.getSharedStencilBuffer=function(){return this._stencilBuf};y.beforeRenderLayers=function(B,F=null){const {width:G,height:J}=B.getViewport();this._prevFBO=B.getBoundFramebufferObject();const K=this.getFbos(G,J);B.bindFramebuffer(K.output);
B.setColorMask(!0,!0,!0,!0);B.setDepthWriteEnabled(!0);if(z.isSome(F)){const {r:M,g:R,b:N,a:I}=F.color;B.setClearColor(I*M/255,I*R/255,I*N/255,I)}else B.setClearColor(0,0,0,0);B.setClearDepth(1);B.clear(B.gl.COLOR_BUFFER_BIT|B.gl.DEPTH_BUFFER_BIT);B.setDepthWriteEnabled(!1)};y.beforeRenderLayer=function(B,F,G){const {context:J,blendMode:K,effects:M}=B;l(K,M,G)?(J.bindFramebuffer(this._fbos.blend),J.setColorMask(!0,!0,!0,!0),J.setClearColor(0,0,0,0),J.clear(J.gl.COLOR_BUFFER_BIT)):(B=this._getOutputFBO(),
J.bindFramebuffer(B));J.setDepthWriteEnabled(!1);J.setDepthTestEnabled(!1);J.setStencilTestEnabled(!0);J.setClearStencil(F);J.setStencilWriteMask(255);J.clear(J.gl.STENCIL_BUFFER_BIT)};y.compositeLayer=function(B,F){const {context:G,blendMode:J,effects:K}=B;if(l(J,K,F)){z.isSome(K)&&0<K.length&&B.drawPhase===e.WGLDrawPhase.MAP&&this._applyEffects(B,K);var M=this._getOutputFBO();G.bindFramebuffer(M);G.setStencilTestEnabled(!1);G.setStencilWriteMask(0);G.setBlendingEnabled(!0);G.setBlendFunctionSeparate(1,
771,1,771);G.setColorMask(!0,!0,!0,!0);M=z.isSome(J)?J:"normal";this._blendEffect.draw(B,this._fbos.blend.colorTexture,9728,M,F)}};y.renderLayers=function(B){B.bindFramebuffer(this._prevFBO);if(this._fbos){var F=this._getOutputFBO();B.setStencilTestEnabled(!1);B.setStencilWriteMask(0);this.blitTexture(B,F.colorTexture,9728)}};y.dispose=function(){this.materialManager.dispose();this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&
(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(B=>B.dispose()),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(const B in this._fbos)this._fbos[B]&&this._fbos[B].dispose();if(this.effects)for(const B in this.effects)this.effects[B]&&this.effects[B].dispose();this._prevFBO=null};y.getGeometryBrush=function(B){B={[e.WGLGeometryType.FILL]:f.brushes.fill,[e.WGLGeometryType.LINE]:f.brushes.line,[e.WGLGeometryType.MARKER]:f.brushes.marker,
[e.WGLGeometryType.TEXT]:f.brushes.text}[B];let F=this._brushCache.get(B);void 0===F&&(F=new B,this._brushCache.set(B,F));return this._brushCache.get(B)};y.renderObject=function(B,F,G,J){G=f.brushes[G];if(!G)return null;let K=this._brushCache.get(G);void 0===K&&(K=new G,this._brushCache.set(G,K));K.prepareState(B,F,J);K.draw(B,F,J)};y.renderObjects=function(B,F,G,J){G=f.brushes[G];if(!G)return null;let K=this._brushCache.get(G);void 0===K&&(K=new G,this._brushCache.set(G,K));K.drawMany(B,F,J)};y.getVectorTileProgramCache=
function(){return this._vtlProgramCache};y.registerRenderPass=function(B){const F=B.brushes.map(G=>{this._brushCache.has(G)||this._brushCache.set(G,new G);return this._brushCache.get(G)});return new w(F,B)};y.setHighlightOptions=function(B){this.effects.highlight.setHighlightOptions(B)};y.blitTexture=function(B,F,G,J=1){B.setBlendingEnabled(!0);B.setBlendFunctionSeparate(1,771,1,771);B.setColorMask(!0,!0,!0,!0);this._blitRenderer.render(B,F,G,J)};y.getPostProcessingEffects=function(B){return this._effectsManager.getPostProcessingEffects(B)};
y._getOutputFBO=function(){return null!=this._renderTarget?this._renderTarget:this._fbos.output};y._applyEffects=function(B,F){const {context:G}=B;F=this._effectsManager.getPostProcessingEffects(F);for(const {postProcessingEffect:J,effect:K}of F)G.bindFramebuffer(this._fbos.blend),J.draw(B,this._fbos.blend,K)};return x}()})},"esri/views/2d/engine/brushes":function(){define("exports ./webgl/brushes/BrushBitmap ./webgl/brushes/BrushClip ./webgl/brushes/WGLBrushInfo ./webgl/brushes/WGLBrushStencil ./webgl/brushes/WGLBrushVTLBackground ./webgl/brushes/WGLBrushVTLCircle ./webgl/brushes/WGLBrushVTLFill ./webgl/brushes/WGLBrushVTLLine ./webgl/brushes/WGLBrushVTLSymbol ./webgl/brushes/WGLGeometryBrushFill ./webgl/brushes/WGLGeometryBrushLabel ./webgl/brushes/WGLGeometryBrushLine ./webgl/brushes/WGLGeometryBrushMarker ./webgl/brushes/WGLGeometryBrushText ./webgl/brushes/raster/BrushRasterBitmap".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){const u={vtlBackground:m.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:d.WGLBrushVTLLine,vtlCircle:c.WGLBrushVTLCircle,vtlSymbol:a.WGLBrushVTLSymbol};z.brushes={marker:q,line:g,fill:e,text:h,label:f,clip:D,stencil:A,bitmap:E,raster:n,tileInfo:C,vtlBackground:m.WGLBrushVTLBackground,vtlFill:b.WGLBrushVTLFill,vtlLine:d.WGLBrushVTLLine,vtlCircle:c.WGLBrushVTLCircle,vtlSymbol:a.WGLBrushVTLSymbol};z.vtlBrushes=u;Object.defineProperty(z,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../definitions","../VertexStream","./WGLBrush"],function(z,E,D,C){const A={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};return function(m){function c(){var d=m.apply(this,arguments)||this;d._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",
attributes:{a_position:0,a_texcoord:1}};return d}z._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){this._quad&&this._quad.dispose()};b.prepareState=function({context:d},a){d.setBlendingEnabled(!0);d.setBlendFunctionSeparate(1,771,1,771);d.setColorMask(!0,!0,!0,!0);d.setStencilWriteMask(0);d.setStencilTestEnabled(!0);d.setStencilFunction(514,a.stencilRef,255)};b.draw=function(d,a){const {context:e,renderingOptions:f,painter:g}=d;if(a.source){d.timeline.begin(this.name);this._quad||(this._quad=
new D(e,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode){({state:n}=d);var q=a.resolution/a.pixelRatio/n.resolution,h=Math.round(d.pixelRatio)!==d.pixelRatio;q=1.05<q||.95>q;var n=n.rotation||q||h||a.isSourceScaled||a.rotation?A.bilinear:A.nearest}else n=A[f.samplingMode];h=g.materialManager.getProgram(d,this._desc,n.defines);var {coordScale:u,computedOpacity:t,transforms:k}=a;a.setSamplingProfile(n);a.bind(d,E.TEXTURE_BINDING_BITMAP);e.bindProgram(h);h.setUniformMatrix3fv("u_dvsMat3",k.dvs);h.setUniform1i("u_texture",
E.TEXTURE_BINDING_BITMAP);h.setUniform2fv("u_coordScale",u);h.setUniform1f("u_opacity",t);this._quad.draw();d.timeline.end(this.name)}};return c}(C)})},"esri/views/2d/engine/webgl/VertexStream":function(){define("../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler".split(" "),function(z,E,D,C,A,
m,c,b,d){return function(){function a(f,g){this.rctx=f;this._vertexBuffer=E.createVertex(f,35044,new Uint16Array(g));this._vao=new C(f,{a_position:0},{geometry:[{name:"a_position",count:2,type:5122,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}var e=a.prototype;e.bind=function(){this._vao.bind()};e.unbind=function(){this._vao.unbind()};e.dispose=function(){this._vao.dispose(!1);this._vertexBuffer.dispose()};e.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,
0,4)};return a}()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(function(){return function(){function z(){this.name=this.constructor.name||"UnnamedBrush"}var E=z.prototype;E.prepareState=function(D,C,A){};E.draw=function(D,C,A){};E.drawMany=function(D,C,A){for(const m of C)this.draw(D,m,A)};return z}()})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../webgl/programUtils ../../../../../chunks/vec4f32 ./WGLBrush ../Utils ../shaders/BackgroundPrograms".split(" "),
function(z,E,D,C,A,m){return function(c){function b(){var a=c.apply(this,arguments)||this;a._color=D.fromValues(0,1,0,1);return a}z._inheritsLoose(b,c);var d=b.prototype;d.dispose=function(){this._program&&this._program.dispose()};d.prepareState=function({context:a}){a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,0,255)};d.draw=function(a,e){const {context:f,
state:g}=a;this._program||(this._program=E.createProgram(f,m.background));a=this._program;const q=A.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});e=e.getVAO(f,g,q.attributes,q.bufferLayouts);f.bindProgram(this._program);a.setUniform2fv("u_coord_range",[1,1]);a.setUniform4fv("u_color",this._color);a.setUniformMatrix3fv("u_dvsMat3",g.displayMat3);f.bindVAO(e);f.drawElements(4,e.indexBuffer.size,5125,0);f.bindVAO()};return b}(C)})},"esri/chunks/vec4f32":function(){define(["exports"],
function(z){function E(){return new Float32Array(4)}function D(k){const v=new Float32Array(4);v[0]=k[0];v[1]=k[1];v[2]=k[2];v[3]=k[3];return v}function C(k,v,p,r){const w=new Float32Array(4);w[0]=k;w[1]=v;w[2]=p;w[3]=r;return w}function A(k,v){return new Float32Array(k,v,4)}function m(){return E()}function c(){return C(1,1,1,1)}function b(){return C(1,0,0,0)}function d(){return C(0,1,0,0)}function a(){return C(0,0,1,0)}function e(){return C(0,0,0,1)}const f=E(),g=c(),q=b(),h=d(),n=a(),u=e();var t=
Object.freeze({__proto__:null,create:E,clone:D,fromValues:C,createView:A,zeros:m,ones:c,unitX:b,unitY:d,unitZ:a,unitW:e,ZEROS:f,ONES:g,UNIT_X:q,UNIT_Y:h,UNIT_Z:n,UNIT_W:u});z.ONES=g;z.UNIT_W=u;z.UNIT_X=q;z.UNIT_Y=h;z.UNIT_Z=n;z.ZEROS=f;z.clone=D;z.create=E;z.createView=A;z.fromValues=C;z.ones=c;z.unitW=e;z.unitX=b;z.unitY=d;z.unitZ=a;z.vec4f32=t;z.zeros=m})},"esri/views/2d/engine/webgl/Utils":function(){define("exports ../../../../core/Logger ../../../../core/Error ../../../../core/mathUtils ../../../../core/screenUtils ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ./color ./SymbolProperties".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u){function t(H){const Q={};for(const W of H)Q[W.name]=W.strideInBytes;return Q}function k(H){switch(H){case h.WGLGeometryType.MARKER:return J;case h.WGLGeometryType.FILL:return K;case h.WGLGeometryType.LINE:return M;case h.WGLGeometryType.TEXT:return R;case h.WGLGeometryType.LABEL:return N}}function v(H){switch(H%4){case 0:case 2:return 4;case 1:case 3:return 1}}function p(H){switch(H){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}
function r(H){const Q={};for(const W in H){let aa=0;Q[W]=H[W].map(da=>{const S={...da,normalized:da.normalized||!1,divisor:da.divisor||0,offset:aa,stride:0};aa+=da.count*p(da.type);return S});Q[W].forEach(da=>da.stride=aa)}return Q}const w=E.getLogger("esri.views.2d.engine.webgl.Utils");E=[{name:"geometry",strideInBytes:32,divisor:0}];m=[{name:"geometry",strideInBytes:32,divisor:0}];c=[{name:"geometry",strideInBytes:12,divisor:0}];d=[{name:"geometry",strideInBytes:36,divisor:0}];a=[{name:"geometry",
strideInBytes:32,divisor:0}];e=[{name:"geometry",strideInBytes:36,divisor:0}];const l=t(E),x=t(m),y=t(c),B=t(d),F=t(a),G=t(e),J=["geometry"],K=["geometry"],M=["geometry"],R=["geometry"],N=["geometry"],I=new Map;z.C_FILL_STRIDE_SPEC=x;z.C_FILL_STRIDE_SPEC_DD=y;z.C_FILL_VERTEX_DEF=m;z.C_FILL_VERTEX_DEF_DD=c;z.C_ICON_STRIDE_SPEC=l;z.C_ICON_VERTEX_DEF=E;z.C_LABEL_STRIDE_SPEC=G;z.C_LABEL_VERTEX_DEF=e;z.C_LINE_STRIDE_SPEC=B;z.C_LINE_VERTEX_DEF=d;z.C_TEXT_STRIDE_SPEC=F;z.C_TEXT_VERTEX_DEF=a;z.C_VBO_GEOMETRY=
"geometry";z.C_VBO_INFO={["geometry"]:35044};z.C_VBO_PERINSTANCE="per_instance";z.C_VBO_PERINSTANCE_VV="per_instance_vv";z.allocateTypedArrayBuffer=function(H,Q){switch(Q%4){case 0:case 2:return new Uint32Array(Math.floor(H*Q/4));case 1:case 3:return new Uint8Array(H*Q)}};z.allocateTypedArrayBufferwithData=function(H,Q){switch(Q%4){case 0:case 2:return new Uint32Array(H);case 1:case 3:return new Uint8Array(H)}};z.copyMeshData=function(H,Q,W,aa,da,S,U){for(const Z in S){var X=S[Z].stride,ba=v(X);const P=
S[Z].data,L=W[Z].data,O=X*da.vertexCount/ba,T=X*H/ba;X=X*da.vertexFrom/ba;for(ba=0;ba<O;++ba)L[ba+T]=P[ba+X]}W=da.indexCount;for(S=0;S<W;++S)aa[S+Q]=U[S+da.indexFrom]-da.vertexFrom+H};z.createGeometryData=function(H,Q){const W=[];for(let aa=0;5>aa;++aa){const da=k(aa),S={};for(const U of da)S[U]={data:Q(aa,U)};W.push({data:H(aa),buffers:S})}return W};z.createProgramDescriptor=(H,Q)=>{if(!I.has(H)){const da=r(Q);var W=da;var aa={};for(const S in W){const U=W[S];aa[S]=U.length?U[0].stride:0}W=aa;aa=
{};for(const S in Q)for(const U of Q[S])aa[U.name]=U.location;Q=aa;I.set(H,{strides:W,bufferLayouts:da,attributes:Q})}return I.get(H)};z.createTextureFromTexelData=function(H,Q){let W,aa;C.isPowerOfTwo(Q.width)&&C.isPowerOfTwo(Q.height)?(W=!0,aa=9987):(W=!1,aa=9729);return new b(H,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:W,samplingMode:aa,wrapMode:33071,flipped:!0},Q)};z.geometryToMappedGeometry=function(H){return{vertexFrom:void 0,vertexTo:void 0,geometry:H}};z.getBytes=
p;z.getCapType=function(H,Q){switch(H){case "butt":return 0;case "round":return Q?2:1;case "square":return 2;default:return w.error(new D("mapview-invalid-type",`Cap type ${H} is not a valid option. Defaulting to round`)),1}};z.getJoinType=function(H){switch(H){case "miter":return 2;case "bevel":return 0;case "round":return 1;default:return w.error(new D("mapview-invalid-type",`Join type ${H} is not a valid option. Defaulting to round`)),1}};z.getNamedBuffers=k;z.getPixelArrayCtor=function(H){switch(H){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:w.error(new D("webgl-utils",`Unable to handle type ${H}`))}};z.getPixelBytes=function(H){switch(H){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:w.error(new D("webgl-utils",`Unable to handle type ${H}`))}};z.getStrides=function(H,Q){switch(H){case h.WGLGeometryType.MARKER:return l;case h.WGLGeometryType.FILL:return Q?y:x;case h.WGLGeometryType.LINE:return B;case h.WGLGeometryType.TEXT:return F;case h.WGLGeometryType.LABEL:return G}};
z.getTextProperties=function(H){return u.TextProperties.pool.acquire(H.color?n.copyAndPremultiply(H.color):[255,255,255,255],H.haloColor?n.copyAndPremultiply(H.haloColor):[255,255,255,255],A.pt2px(H.haloSize),A.pt2px(H.font.size),H.angle*Math.PI/180,H.xoffset/H.font.size,H.yoffset/H.font.size,"left"===H.horizontalAlignment?0:"right"===H.horizontalAlignment?1:.5,"top"===H.verticalAlignment?0:"bottom"===H.verticalAlignment?1:.5)};z.getTransformParams=function(H){const {transform:Q,hasZ:W,hasM:aa}=H;
return{transform:Q,hasZ:W,hasM:aa}};z.getVVType=function(H){switch(H){case "opacity":return h.VVType.OPACITY;case "color":return h.VVType.COLOR;case "rotation":return h.VVType.ROTATION;case "size":return h.VVType.SIZE;default:return w.error(`Cannot interpret unknown vv: ${H}`),null}};z.isDefined=function(H){return null!=H};z.isNumber=function(H){return"number"===typeof H};z.strideToPackingFactor=v;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/color":function(){define(["exports",
"./number"],function(z,E){function D(m,c){Array.isArray(c)?(m[0]=c[0],m[1]=c[1],m[2]=c[2],m[3]=c[3]):(m[0]=c.r,m[1]=c.g,m[2]=c.b,m[3]=c.a);return m}function C(m,c=0,b=!1){const d=m[c+3];m[c+0]*=d;m[c+1]*=d;m[c+2]*=d;b||(m[c+3]*=255);return m}const A=[0,0,0,0];z.copyAndPremultiply=function(m){return C(D([],m))};z.premultiplyAlpha=C;z.premultiplyAlphaRGBA=function(m){if(!m)return 0;const {r:c,g:b,b:d,a}=m;return E.i8888to32(c*a,b*a,d*a,255*a)};z.premultiplyAlphaRGBAArray=function(m){if(!m)return 0;
const [c,b,d,a]=m;return E.i8888to32(a/255*c,a/255*b,a/255*d,a)};z.premultiplyAlphaUint32=function(m){C(D(A,m));return E.i8888to32(A[0],A[1],A[2],A[3])};z.white=[255,255,255,1];Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/number":function(){define(["exports"],function(z){function E(A,m,c){return Math.round(Math.max(Math.min(A,c),m))}const D=new Float32Array(1),C=new Uint32Array(D.buffer);z.i16=function(A){return E(A,-32768,32767)};z.i1616to32=function(A,m){return 65535&
A|m<<16};z.i32=function(A){return E(A,-2147483648,2147483647)};z.i8=function(A){return E(A,-128,127)};z.i8816to32=function(A,m,c){return A&255|(m&255)<<8|c<<16};z.i8888to32=function(A,m,c,b){return A&255|(m&255)<<8|(c&255)<<16|b<<24};z.numTo32=function(A){return A|0};z.toFloat32=function(A){C[0]=A;return D[0]};z.toUint32=function(A){D[0]=A;return C[0]};z.u16=function(A){return E(A,0,65535)};z.u32=function(A){return E(A,0,4294967295)};z.u32to4Xu8=function(A){return[A&255,(A&65280)>>>8,(A&16711680)>>>
16,(A&4278190080)>>>24]};z.u8=function(A){return E(A,0,255)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["exports","../../../../core/ObjectPool"],function(z,E){let D=function(){function C(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}var A=C.prototype;A.acquire=function(m,c,b,d,a,e,f,g,q){this.color=m;this.haloColor=c;this.haloSize=
b;this.size=d;this.angle=a;this.offsetX=e;this.offsetY=f;this.hAnchor=g;this.vAnchor=q};A.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};return C}();D.pool=new E(D);z.TextProperties=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["exports",
"./sources/resolver"],function(z,E){E={name:"background",shaders:{vertexShader:E.resolveIncludes("background/background.vert"),fragmentShader:E.resolveIncludes("background/background.frag")},attributes:{a_pos:0}};z.background=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define("exports ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./shaderRepository".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){const f=new a(function(g){let q=e;g.split("/").forEach(h=>{q&&(q=q[h])});return q});z.resolveIncludes=function(g){return f.resolveIncludes(g)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\n  return max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\n  float vIn \x3d rgb2v(Cb);\n  vec3 hsvTint \x3d rgb2hsv(Cs);\n  vec3 hsvOut \x3d vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\n  return hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\n  return (Cb \x3d\x3d 0.0) ? 0.0 : (Cs \x3d\x3d 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\n return (Cb \x3d\x3d 1.0) ? 1.0 : (Cs \x3d\x3d 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\n\treturn (Cs \x3d\x3d 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\n  if (Cs \x3c\x3d 0.5) {\n    return Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n  }\n  if (Cb \x3c\x3d 0.25) {\n    return Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n  }\n  return Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\n  return (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\n  return min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\n  return max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\n  return dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\n  return maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\n  float lum \x3d lumv3(color);\n  float mincol \x3d minv3(color);\n  float maxcol \x3d maxv3(color);\n  if (mincol \x3c 0.0) {\n    color \x3d lum + ((color - lum) * lum) / (lum - mincol);\n  }\n  if (maxcol \x3e 1.0) {\n    color \x3d lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n  }\n  return color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\n  float lbase \x3d lumv3(cbase);\n  float llum \x3d lumv3(clum);\n  float ldiff \x3d llum - lbase;\n  vec3 color \x3d cbase + vec3(ldiff);\n  return clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\n  float minbase \x3d minv3(cbase);\n  float sbase \x3d satv3(cbase);\n  float ssat \x3d satv3(csat);\n  vec3 color;\n  if (sbase \x3e 0.0) {\n    color \x3d (cbase - minbase) * ssat / sbase;\n  } else {\n    color \x3d vec3(0.0);\n  }\n  return setLum(color, clum);\n}\nvoid main() {\n  vec4 src \x3d texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\n  gl_FragColor \x3d src *  u_opacity;\n#else\n  vec4 dst \x3d texture2D(u_backbufferTexture, v_uv);\n  vec3 Cs \x3d src.a \x3d\x3d 0.0 ? src.rgb : vec3(src.rgb / src.a);\n  vec3 Cb \x3d dst.a \x3d\x3d 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\n  float as \x3d u_opacity * src.a;\n  float ab \x3d dst.a;\n  #ifdef DESTINATION_OVER\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n  #endif\n  #ifdef SOURCE_IN\n    vec4 color \x3d vec4(as * Cs * ab, as * ab);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef DESTINATION_IN\n    vec4 color \x3d vec4(ab * Cb * as, ab * as);\n    vec4 fadeColor \x3d (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\n    gl_FragColor \x3d color + fadeColor;\n  #endif\n  #ifdef SOURCE_OUT\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n  #endif\n  #ifdef DESTINATION_OUT\n    gl_FragColor \x3d vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n  #endif\n  #ifdef SOURCE_ATOP\n    gl_FragColor \x3d vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n  #endif\n  #ifdef DESTINATION_ATOP\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n  #endif\n  #ifdef XOR\n    gl_FragColor \x3d vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\n                        as * (1.0 - ab) + ab * (1.0 - as));\n  #endif\n  #ifdef MULTIPLY\n    gl_FragColor \x3d vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SCREEN\n    gl_FragColor \x3d vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef OVERLAY\n    vec3 f \x3d vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DARKEN\n    gl_FragColor \x3d vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LIGHTER\n    gl_FragColor \x3d vec4(as * Cs + ab * Cb, as + ab);\n  #endif\n  #ifdef LIGHTEN\n    gl_FragColor \x3d vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_DODGE\n    vec3 f \x3d vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR_BURN\n    vec3 f \x3d vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HARD_LIGHT\n    vec3 f \x3d vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SOFT_LIGHT\n    vec3 f \x3d vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef DIFFERENCE\n    gl_FragColor \x3d vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef EXCLUSION\n     vec3 f \x3d Cs + Cb - 2.0 * Cs * Cb;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef INVERT\n    gl_FragColor \x3d vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n  #endif\n  #ifdef VIVID_LIGHT\n    vec3 f \x3d vec3(vividLight(Cb.r, Cs.r),\n                  vividLight(Cb.g, Cs.g),\n                  vividLight(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef HUE\n    vec3 f \x3d setLumSat(Cs,Cb,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef SATURATION\n    vec3 f \x3d setLumSat(Cb,Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef COLOR\n    vec3 f \x3d setLum(Cs,Cb);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef LUMINOSITY\n    vec3 f \x3d setLum(Cb,Cs);\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef PLUS\n    gl_FragColor \x3d clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n  #endif\n  #ifdef MINUS\n     gl_FragColor \x3d vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n  #endif\n  #ifdef AVERAGE\n     vec3 f \x3d (Cb + Cs) / 2.0;\n     gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n  #ifdef REFLECT\n    vec3 f \x3d vec3(reflectBlend(Cb.r, Cs.r),\n                  reflectBlend(Cb.g, Cs.g),\n                  reflectBlend(Cb.b, Cs.b));\n    gl_FragColor \x3d vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\n                        as + ab * (1.0 - as));\n  #endif\n#endif\n}",
"blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position , 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor \x3d 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\n  lowp vec2 uvn \x3d uv * 2.0 - 1.0;\n  if (uvn.x \x3d\x3d 0.0 \x26\x26 uvn.y \x3d\x3d 0.0) {\n    return vec2(0.5, 0.5);\n  }\n  lowp float theta \x3d atan(uvn.y, uvn.x);\n  lowp float r \x3d pow(length(uvn), barrelFactor);\n  return r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, barrel(v_texCoord));\n  color \x3d (color + (1.0 - color.a) * u_background);\n  lowp float mask \x3d u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\n  color *\x3d mask;\n  lowp vec4 overlayColor \x3d u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\n  overlayColor.rgb *\x3d overlayColor.a;\n  gl_FragColor \x3d overlayColor + (1.0 - overlayColor.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  gl_Position \x3d vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackDisplayIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float POSITION_PRECISION \x3d 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION \x3d 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING \x3d 1.0 / 4.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d preEffectColor;\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity();\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  float width \x3d u_zoomFactor * a_aux1.x * aux2.x;\n  float height \x3d u_zoomFactor * a_aux1.y * aux2.y;\n  float angle \x3d C_256_TO_RAD * a_aux3.z;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  mat3 patternMatrix \x3d mat3(cosA / width, sinA / height, 0,\n                           -sinA / width, cosA / height, 0,\n                            0,            0,             1);\n  vec2 symbolOffset \x3d (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED) / vec2(width, height);\n  v_tileTextureCoord \x3d (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity();\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d a_outlineColor;\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include \x3cmaterials/text/text.frag\x3e","label.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nuniform float u_zoomLevel;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_glyphData.x;\n  float glyphMaxZoom    \x3d a_glyphData.y;\n  float glyphAngle      \x3d a_glyphData.z;\n  float a_minZoom          \x3d max(groupMinZoom, glyphMinZoom);\n  float a_placementPadding \x3d a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\n  vec2  a_placementDir     \x3d unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\n  float a_refSymbolSize    \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize           \x3d a_texAndSize.z;\n  float haloSize           \x3d a_texAndSize.w * OUTLINE_SCALE;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float z            \x3d getZ(a_minZoom, glyphMaxZoom, glyphAngle);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  float animation    \x3d pow(getAnimationState(), vec4(2.0)).r;\n  v_color     \x3d animation * ((1.0 - u_isHalo) * a_color + (u_isHalo * a_haloColor));\n  v_opacity   \x3d 1.0;\n  v_tex       \x3d a_texCoords / u_mosaicSize;\n  v_edgeDistanceOffset \x3d u_isHalo * haloSize / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + a_placementPadding);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d v_lineHalfWidth;\n  mediump float adjustedPatternWidth \x3d v_patternSize.x * 2.0 * lineHalfWidth / v_patternSize.y;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / adjustedPatternWidth, 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexY, relativeTexX));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nconst float WIDTH_SCALE \x3d 1.0 / 1024.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * WIDTH_SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * WIDTH_SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity();\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  float SDF_CUTOFF \x3d (2.0 / 8.0);\n  float SDF_BASE_EDGE_DIST \x3d 1.0 - SDF_CUTOFF;\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float edge \x3d SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\n  edge /\x3d 2.0;\n#endif\n  lowp float aa \x3d v_antialiasingWidth;\n  lowp float alpha \x3d smoothstep(edge - aa, edge + aa, dist);\n  gl_FragColor \x3d alpha * v_color * v_opacity;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHalo;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet      \x3d a_aux.w;\n  float a_fontSize    \x3d a_texFontSize.z;\n  vec2  a_offset      \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  in_pos        \x3d vec3(a_pos * POSITION_PRECISION, 1.0);\n  float fontSize      \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor   \x3d fontSize / a_fontSize;\n  float fontScale     \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset        \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  mat3  extrudeMatrix \x3d getBit(a_bitSet, 0) \x3d\x3d 1.0 ? u_displayViewMat3 : u_displayMat3;\n  v_color   \x3d u_isHalo * a_haloColor + (1.0 - u_isHalo) * getColor(a_color, a_bitSet, 1);\n  v_opacity \x3d getOpacity();\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texCoords / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + extrudeMatrix * offset;\n  v_edgeDistanceOffset \x3d u_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackDisplayIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\n  return (bytes - 127.0) / 127.0;\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\n  pos.z +\x3d 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifndef OUTSIDE_LABELS_VISIBLE\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#endif\n  return pos;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue) {\n  if (isNan(opacityValue)) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  gl_FragColor \x3d texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\n  float mirrorFactor \x3d 1.2 - factor;\n  return mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\n  gl_FragColor \x3d u_bloomStrength * (\n    lerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\n    lerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\n    lerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\n    lerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\n    lerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n  );\n}"},
gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d float(SIGMA);\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 texel \x3d texture2D(u_texture, v_uv);\n  vec3 luma \x3d vec3(0.299, 0.587, 0.114);\n  float v \x3d dot(texel.xyz, luma);\n  vec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\n  float alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\n  gl_FragColor \x3d mix(outputColor, texel, alpha);\n}"}},
blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\n  vec2 invSize \x3d 1.0 / u_texSize;\n  float fSigma \x3d u_sigma;\n  float weightSum \x3d gaussianPdf(0.0, fSigma);\n  vec4 pixelColorSum \x3d texture2D(u_colorTexture, v_uv) * weightSum;\n  for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n    float x \x3d float(i);\n    float w \x3d gaussianPdf(x, fSigma);\n    vec2 uvOffset \x3d u_direction * invSize * x;\n    vec4 sample1 \x3d texture2D(u_colorTexture, v_uv + uvOffset);\n    vec4 sample2 \x3d texture2D(u_colorTexture, v_uv - uvOffset);\n    pixelColorSum +\x3d (sample1 + sample2) * w;\n    weightSum +\x3d 2.0 * w;\n  }\n  gl_FragColor \x3d pixelColorSum /weightSum;\n}"},
"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist \x3d 1.0;\nconst float sampleStrength \x3d 2.2;\nvoid main(void) {\n    float samples[10];\n    samples[0] \x3d -0.08;\n    samples[1] \x3d -0.05;\n    samples[2] \x3d -0.03;\n    samples[3] \x3d -0.02;\n    samples[4] \x3d -0.01;\n    samples[5] \x3d  0.01;\n    samples[6] \x3d  0.02;\n    samples[7] \x3d  0.03;\n    samples[8] \x3d  0.05;\n    samples[9] \x3d  0.08;\n    vec2 dir \x3d 0.5 - v_uv;\n    float dist \x3d sqrt(dir.x * dir.x + dir.y * dir.y);\n    dir \x3d dir / dist;\n    vec4 color \x3d texture2D(u_colorTexture,v_uv);\n    vec4 sum \x3d color;\n    for (int i \x3d 0; i \x3c 10; i++) {\n      sum +\x3d texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n    }\n    sum *\x3d 1.0 / 11.0;\n    float t \x3d dist * sampleStrength;\n    t \x3d clamp(t, 0.0, 1.0);\n    gl_FragColor \x3d mix(color, sum, t);\n}"}},
dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 minColor \x3d texture2D(u_minColor, vec2(0.5));\n  vec4 maxColor \x3d texture2D(u_maxColor, vec2(0.5));\n  vec4 color \x3d texture2D(u_texture, v_uv);\n  vec3 minColorUnpremultiply \x3d minColor.rgb / minColor.a;\n  vec3 maxColorUnpremultiply \x3d maxColor.rgb / maxColor.a;\n  vec3 colorUnpremultiply \x3d color.rgb / color.a;\n  vec3 range \x3d maxColorUnpremultiply - minColorUnpremultiply;\n  gl_FragColor \x3d vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}",
"min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\n  vec2 srcPixel \x3d floor(gl_FragCoord.xy) * float(CELL_SIZE);\n  vec2 onePixel \x3d vec2(1.0) / u_srcResolution;\n  vec2 uv \x3d (srcPixel + 0.5) / u_srcResolution;\n  vec4 minColor \x3d vec4(1.0);\n  vec4 maxColor \x3d vec4(0.0);\n  for (int y \x3d 0; y \x3c CELL_SIZE; ++y) {\n    for (int x \x3d 0; x \x3c CELL_SIZE; ++x) {\n      vec2 offset \x3d uv + vec2(x, y) * onePixel;\n      minColor \x3d min(minColor, texture2D(u_minTexture, offset));\n      maxColor \x3d max(maxColor, texture2D(u_maxTexture, offset));\n    }\n  }\n  gl_FragData[0] \x3d minColor;\n  gl_FragData[1] \x3d maxColor;\n}"}},
"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 layerColor \x3d texture2D(u_layerFBOTexture, v_uv);\n  vec4 blurColor \x3d texture2D(u_blurTexture, v_uv);\n  gl_FragColor \x3d ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"},"drop-shadow.vert":"precision mediump float;\nattribute vec2 a_position;\nuniform highp mat3 u_displayViewMat3;\nuniform highp vec2 u_offset;\nvarying vec2 v_uv;\nvoid main() {\n  vec3 offset \x3d u_displayViewMat3 * vec3(u_offset, 0.0);\n  gl_Position \x3d vec4(a_position, 0.0, 1.0) + vec4(offset, 0.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"},
"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 \x3d mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 \x3d mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 \x3d mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 \x3d mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 \x3d mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 \x3d mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 \x3d mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 \x3d mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 \x3d mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\n  G[0] \x3d g0,\n  G[1] \x3d g1,\n  G[2] \x3d g2,\n  G[3] \x3d g3,\n  G[4] \x3d g4,\n  G[5] \x3d g5,\n  G[6] \x3d g6,\n  G[7] \x3d g7,\n  G[8] \x3d g8;\n  mat3 I;\n  float cnv[9];\n  vec3 sample;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 9; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  float M \x3d (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\n  float S \x3d (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\n  gl_FragColor \x3d vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},
sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  gl_FragColor \x3d vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},
"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel \x3d vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 \x3d mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 \x3d mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\n  mat3 I;\n  float cnv[2];\n  vec3 sample;\n  G[0] \x3d g0;\n  G[1] \x3d g1;\n  for (float i \x3d 0.0; i \x3c 3.0; i++) {\n    for (float j \x3d 0.0; j \x3c 3.0; j++) {\n      sample \x3d texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\n      I[int(i)][int(j)] \x3d length(sample);\n    }\n  }\n  for (int i \x3d 0; i \x3c 2; i++) {\n    float dp3 \x3d dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\n    cnv[i] \x3d dp3 * dp3;\n  }\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  gl_FragColor \x3d vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},
filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\n  vec4 color \x3d texture2D(u_colorTexture, v_uv);\n  vec4 rgbw \x3d u_coefficients * vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  gl_FragColor \x3d vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_uv \x3d (a_position + 1.0) / 2.0;\n}"}},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  float alpha \x3d u_opacity * color.a;\n  gl_FragColor \x3d vec4(alpha * color.rgb, alpha);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include \x3craster/common/projection.glsl\x3e\n#endif\n#ifdef BICUBIC\n#include \x3cfiltering/bicubic.glsl\x3e\n#endif\n#ifdef BILINEAR\n#include \x3cfiltering/bilinear.glsl\x3e\n#endif\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\n  targetLocation \x3d projectPixelLocation(targetLocation);\n#endif\n  return targetLocation;\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\n  vec4 color \x3d sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\n  vec4 color \x3d texture2D(u_image, pixelLocation);\n#endif\n  return color;\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvec3 rgb2hsv(vec3 c) {\n  vec4 K \x3d vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n  vec4 p \x3d c.g \x3c c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n  vec4 q \x3d c.r \x3c p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n  float d \x3d q.x - min(q.w, q.y);\n  float e \x3d 1.0e-10;\n  return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\n  vec4 K \x3d vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p \x3d abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\n  val \x3d clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\n  vec4 rgb \x3d colorize(vec4(val, val, val, 1.0), 255.0);\n  vec3 hsv \x3d rgb2hsv(rgb.xyz);\n  hsv.z \x3d hillshade;\n  return vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float dzd \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\n     float z \x3d (u_cosZs[0] + cosDelta) / dzd;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / dzd;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n#ifdef APPLY_COLORMAP\n  gl_FragColor \x3d overlay(ve.r, u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\n  gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\n  float clrIndex \x3d clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\n  vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n  vec4 color \x3d texture2D(u_colormap, clrPosition);\n  vec4 result \x3d vec4(color.rgb, color.a * currentPixel.a);\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  vec4 result \x3d colorize(currentPixel, 1.0);\n  gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * u_opacity;\n}",
"lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n#ifdef NOOP\n  gl_FragColor \x3d vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n  return;\n#endif\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\n      vec4 result \x3d colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\n      gl_FragColor \x3d vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos * u_scale + u_offset;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},
tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../../chunks/vec4f32 ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h){return function(n){function u(){var k=n.apply(this,arguments)||this;k._color=f.fromValues(1,0,0,1);return k}z._inheritsLoose(u,n);var t=u.prototype;t.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&
(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};t.prepareState=function({context:k}){k.setBlendingEnabled(!0);k.setBlendFunctionSeparate(1,771,1,771);k.setColorMask(!0,!0,!0,!0);k.setStencilWriteMask(0);k.setStencilTestEnabled(!1)};t.draw=function(k,v){({context:k}=k);if(v.isReady){this._loadWGLResources(k);k.bindVAO(this._outlineVertexArrayObject);k.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",v.transforms.dvs);
this._outlineProgram.setUniform2f("u_coord_range",v.coordRange[0],v.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);k.drawArrays(3,0,4);k.bindVAO();var p=this._getTexture(k,v);p&&(k.bindVAO(this._tileInfoVertexArrayObject),k.bindProgram(this._tileInfoProgram),k.bindTexture(p,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",v.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
v.coordRange[0]/v.size[0],v.coordRange[1]/v.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",p.descriptor.width,p.descriptor.height),k.drawArrays(5,0,4),k.bindVAO())}};t._loadWGLResources=function(k){if(!this._outlineProgram||!this._tileInfoProgram){var v=b.createProgram(k,q.background),p=b.createProgram(k,h.tileInfo),r={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},w=new Int8Array([0,0,1,0,1,1,0,
1]);w=D.createVertex(k,35044,w);w=new A(k,q.background.attributes,r,{geometry:w});var l=new Int8Array([0,0,1,0,0,1,1,1]);l=D.createVertex(k,35044,l);k=new A(k,h.tileInfo.attributes,r,{geometry:l});this._outlineProgram=v;this._tileInfoProgram=p;this._outlineVertexArrayObject=w;this._tileInfoVertexArrayObject=k}};t._getTexture=function(k,v){if(v.texture&&v.triangleCountReportedInDebug===v.triangleCount)return v.texture;v.triangleCountReportedInDebug=v.triangleCount;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const p=v.triangleCount;let r=v.key.id;0<v.triangleCount&&(r+=`, ${p}`);const w=this._canvas,l=w.getContext("2d");l.font="24px sans-serif";l.textAlign="left";l.textBaseline="top";l.clearRect(0,0,300,32);1E5<p?(l.fillStyle="red",l.fillRect(0,0,300,32),l.fillStyle="black"):(l.clearRect(0,0,300,32),l.fillStyle="blue");l.fillText(r,
0,0);v.texture=new C(k,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},w);return v.texture};return u}(g)})},"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["exports","./sources/resolver"],function(z,E){E={name:"tileInfo",shaders:{vertexShader:E.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:E.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}};z.tileInfo=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../../chunks/vec4f32 ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q){return function(h){function n(){var t=h.apply(this,arguments)||this;t._color=f.fromValues(1,0,0,1);t._initialized=!1;return t}z._inheritsLoose(n,h);var u=n.prototype;u.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};u.prepareState=function({context:t},k){t.setDepthWriteEnabled(!1);t.setDepthTestEnabled(!1);t.setStencilTestEnabled(!0);
t.setBlendingEnabled(!1);t.setColorMask(!1,!1,!1,!1);t.setStencilOp(7680,7680,7681);t.setStencilWriteMask(255);t.setStencilFunctionSeparate(1032,516,k.stencilRef,255)};u.draw=function(t,k){({context:t}=t);this._initialized||this._initialize(t);t.bindVAO(this._solidVertexArrayObject);t.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",k.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",k.coordRange);this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",
this._color);t.drawArrays(5,0,4);t.bindVAO()};u._initialize=function(t){if(this._initialized)return!0;const k=b.createProgram(t,q.background);if(!k)return!1;var v=new Int8Array([0,0,1,0,0,1,1,1]);v=D.createVertex(t,35044,v);t=new A(t,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:v});this._solidProgram=k;this._solidVertexArrayObject=t;return this._initialized=!0};return n}(g)})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../definitions ../../../../../chunks/mat3f32 ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../../../../../chunks/vec4f32 ../number ../enums ./WGLBrush ../../vectorTiles/shaders/Programs".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k){A=function(v){function p(){var w=v.apply(this,arguments)||this;w._color=h.fromValues(1,0,0,1);w._patternMatrix=C.create();w._programOptions={id:!1,pattern:!1};return w}E._inheritsLoose(p,v);var r=p.prototype;r.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};r.drawMany=function(w,l){const {context:x,styleLayerUID:y}=w;this._loadWGLResources(x);const B=w.displayLevel;var F=
w.styleLayer,G=w.painter.getVectorTileProgramCache();const J=F.getPaintValue("background-color",B),K=F.getPaintValue("background-opacity",B),M=F.getPaintValue("background-pattern",B),R=void 0!==M,N=J[3]*K,I=w.spriteMosaic;let H;const Q=(window.devicePixelRatio|1)>D.VTL_HIGH_RES_CUTOFF?2:1;w=w.drawPhase===u.WGLDrawPhase.HITTEST;const W=this._programOptions;W.id=w;W.pattern=R;G=G.getProgram(0,(w?1:0)<<1|(R?1:0),W);x.bindVAO(this._vao);x.bindProgram(G);if(R){H=I.getMosaicItemPosition(M,!0);if(!H)return;
G.setUniform1f("u_opacity",K);G.setUniform2f("u_pattern_tl",H.tl[0],H.tl[1]);G.setUniform2f("u_pattern_br",H.br[0],H.br[1]);G.setUniform1i("u_texture",D.VTL_TEXTURE_BINDING_UNIT_SPRITES);I.bind(x,9729,H.page,D.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=N*J[0],this._color[1]=N*J[1],this._color[2]=N*J[2],this._color[3]=N,G.setUniform4fv("u_color",this._color);G.setUniform1f("u_depth",F.z||0);w&&(F=n.u32to4Xu8(y+1),G.setUniform4fv("u_id",F));for(const aa of l)G.setUniform1f("u_coord_range",
aa.coordRange[0]),G.setUniformMatrix3fv("u_dvsMat3",aa.transforms.dvs),R&&(l=Q*aa.size[0]*Math.max(Math.pow(2,Math.round(B)-aa.key.level),1),F=l/H.size[1],this._patternMatrix[0]=l/H.size[0],this._patternMatrix[4]=F,G.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),x.setStencilFunction(514,aa.stencilRef,255),x.drawArrays(5,0,4)};r._loadWGLResources=function(w){if(!this._program||!this._vao){var l=e.createProgram(w,k.background);if(l){var x=new Int8Array([0,0,1,0,0,1,1,1]);x=m.createVertex(w,
35044,x);w=new b(w,k.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:x});this._program=l;this._vao=w}}};return p}(t);z.WGLBrushVTLBackground=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f){z.background={name:"background",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,PATTERN:g.pattern})+f.resolveIncludes("background/background.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,PATTERN:g.pattern})+f.resolveIncludes("background/background.frag")}),attributes:{a_pos:0}};z.circle={name:"circle",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id})+f.resolveIncludes("circle/circle.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id})+f.resolveIncludes("circle/circle.frag")}),
attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};z.fill={name:"fill",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,DD:g.dd,PATTERN:g.pattern})+f.resolveIncludes("fill/fill.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,DD:g.dd,PATTERN:g.pattern})+f.resolveIncludes("fill/fill.frag")}),attributes:{a_pos:0,a_color:1}};z.icon={name:"icon",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,DD:g.dd,SDF:g.sdf})+f.resolveIncludes("icon/icon.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,
DD:g.dd,SDF:g.sdf})+f.resolveIncludes("icon/icon.frag")}),attributes:{a_pos:0,a_vertexOffset:1,a_texAngleRange:2,a_levelInfo:3,a_color:4,a_size:5,a_opacityInfo:6}};z.line={name:"line",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,DD:g.dd,PATTERN:g.pattern})+f.resolveIncludes("line/line.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,DD:g.dd,PATTERN:g.pattern})+f.resolveIncludes("line/line.frag")}),attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};z.outline=
{name:"outline",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,DD:g.dd})+f.resolveIncludes("outline/outline.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,DD:g.dd})+f.resolveIncludes("outline/outline.frag")}),attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};z.text={name:"text",shaders:g=>({vertexShader:b.glslifyDefineMap({ID:g.id,DD:g.dd})+f.resolveIncludes("text/text.vert"),fragmentShader:b.glslifyDefineMap({ID:g.id,DD:g.dd})+f.resolveIncludes("text/text.frag")}),attributes:{a_pos:0,
a_vertexOffset:1,a_texAngleRange:2,a_levelInfo:3,a_color:4,a_size:5,a_opacityInfo:6}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define("exports ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./shaderRepository".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){const f=new a(function(g){let q=e;g.split("/").forEach(h=>{q&&(q=q[h])});return q});z.resolveIncludes=function(g){return f.resolveIncludes(g)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(function(){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_opacity * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_opacity;\nuniform mediump float u_fadeDuration;\nvarying mediump vec2 v_tex;\nvarying lowp float v_opacity;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nuniform highp float u_time;\nvoid main()\n{\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_opacity \x3d u_opacity * interpolatedOpacity;\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump vec2 a_tex            \x3d a_texAngleRange.xy;\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_opacity, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_opacity *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAngleRange;\nattribute vec4 a_levelInfo;\nattribute float a_opacityInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_opacity;\nuniform mediump float u_fadeDuration;\nvarying lowp vec2 v_tex;\nvarying lowp float v_opacity;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nuniform highp float u_time;\nvoid main()\n{\n  float modded \x3d mod(a_opacityInfo, 128.0);\n  float targetOpacity \x3d (a_opacityInfo - modded) / 128.0;\n  float startOpacity \x3d modded / 127.0;\n  float interpolatedOpacity \x3d clamp(startOpacity + 2.0 * (targetOpacity - 0.5) * u_time / u_fadeDuration, 0.0, 1.0);\n  v_opacity \x3d u_opacity * interpolatedOpacity;\n  mediump float a_angle       \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump vec2 a_tex           \x3d a_texAngleRange.xy;\n  mediump float a_visMinAngle    \x3d a_texAngleRange.z;\n  mediump float a_visMaxAngle    \x3d a_texAngleRange.w;\n  mediump float delta_z \x3d 0.0;\n  mediump float angle \x3d mod(a_angle + u_mapRotation, 256.0);\n  if (a_visMinAngle \x3c a_visMaxAngle)\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) + (1.0 - step(a_visMinAngle, angle)));\n  }\n  else\n  {\n    delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * (step(a_visMaxAngle, angle) * (1.0 - step(a_visMinAngle, angle)));\n  }\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  delta_z +\x3d step(v_opacity, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../../../../../chunks/vec4f32 ../number ../enums ./WGLBrush".split(" "),
function(z,E,D,C,A,m,c){const b=[1,1,1,1];c=function(d){function a(){var f=d.apply(this,arguments)||this;f._color=C.create();f._strokeColor=C.create();f._programOptions={id:!1};return f}E._inheritsLoose(a,d);var e=a.prototype;e.dispose=function(){};e.drawMany=function(f,g){const {context:q,state:h,drawPhase:n,styleLayerUID:u}=f;var t=f.displayLevel,k=f.styleLayer;f=f.painter.getVectorTileProgramCache();const v=k.hasDataDrivenRadius?1:k.getPaintValue("circle-radius",t);var p=k.hasDataDrivenColor?b:
k.getPaintValue("circle-color",t),r=k.hasDataDrivenOpacity?1:k.getPaintValue("circle-opacity",t);const w=k.hasDataDrivenStrokeWidth?1:k.getPaintValue("circle-stroke-width",t);var l=k.hasDataDrivenStrokeColor?b:k.getPaintValue("circle-stroke-color",t),x=k.hasDataDrivenStrokeOpacity?1:k.getPaintValue("circle-stroke-opacity",t);const y=k.hasDataDrivenBlur?0:k.getPaintValue("circle-blur",t);r*=p[3];this._color[0]=r*p[0];this._color[1]=r*p[1];this._color[2]=r*p[2];this._color[3]=r;r=x*l[3];this._strokeColor[0]=
r*l[0];this._strokeColor[1]=r*l[1];this._strokeColor[2]=r*l[2];this._strokeColor[3]=r;p=k.getPaintValue("circle-translate",t);l=k.getPaintValue("circle-translate-anchor",t);x=n===m.WGLDrawPhase.HITTEST;t=this._programOptions;t.id=x;t=f.getProgram(5,x?1:0,t);q.bindProgram(t);t.setUniformMatrix3fv("u_displayMat3",1===l?h.displayMat3:h.displayViewMat3);t.setUniform2fv("u_circleTranslation",p);t.setUniform1f("u_depth",k.z);t.setUniform1f("u_radius",v);t.setUniform4fv("u_color",this._color);t.setUniform1f("u_blur",
y);t.setUniform1f("u_stroke_width",w);t.setUniform4fv("u_stroke_color",this._strokeColor);t.setUniform1f("u_antialiasingWidth",1.2);x&&(k=A.u32to4Xu8(u+1),t.setUniform4fv("u_id",k));for(const B of g)B.layerData.has(u)&&(g=B.layerData.get(u),g.prepareForRendering(q,f),k=g.circleVertexArrayObject,D.isNone(k)||(q.bindVAO(k),t.setUniformMatrix3fv("u_dvsMat3",B.transforms.dvs),q.setStencilFunction(514,B.stencilRef,255),q.drawElements(4,g.circleIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*g.circleIndexStart),
B.triangleCount+=g.circleIndexCount/3))};return a}(c);z.WGLBrushVTLCircle=c;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/mat3f32 ../../../../../chunks/vec4f32 ../number ../enums ./WGLBrush".split(" "),function(z,E,D,C,A,m,c,b,d){const a=1/65536,e=[1,1,1,1];d=function(f){function g(){var h=f.apply(this,
arguments)||this;h._color=m.create();h._outlineColor=m.create();h._fillProgramOptions={id:!1,dd:!1,pattern:!1};h._outlineProgramOptions={id:!1,dd:!1};h._patternMatrix=A.create();return h}E._inheritsLoose(g,f);var q=g.prototype;q.dispose=function(){};q.drawMany=function(h,n){const {displayLevel:u,drawPhase:t,renderPass:k,styleLayerUID:v}=h,p=h.styleLayer,r=p.getPaintValue("fill-pattern",u);var w=p.hasDataDrivenColor?e:p.getPaintValue("fill-color",u);const l=p.hasDataDrivenOpacity?1:p.getPaintValue("fill-opacity",
u);var x=l*w[3];const y=void 0!==r||1>x||p.hasDataDrivenFill;if(!y||"opaque"!==k){this._color[0]=x*w[0];this._color[1]=x*w[1];this._color[2]=x*w[2];this._color[3]=x;var B;t===b.WGLDrawPhase.HITTEST&&(B=c.u32to4Xu8(v+1));w=p.getPaintValue("fill-translate",u);x=p.getPaintValue("fill-translate-anchor",u);this._drawFill(h,v,p,n,w,x,r,y,B);this._drawOutline(h,v,p,n,w,x,r,B,l)}};q._drawFill=function(h,n,u,t,k,v,p,r,w){const {context:l,displayLevel:x,drawPhase:y,pixelRatio:B,renderPass:F,spriteMosaic:G,
state:J}=h;if(r||"translucent"!==F){r=void 0!==p;var K=B>C.VTL_HIGH_RES_CUTOFF?2:1,M=u.hasDataDrivenFill;h=h.painter.getVectorTileProgramCache();var R=y===b.WGLDrawPhase.HITTEST,N=this._fillProgramOptions;N.id=R;N.dd=M;N.pattern=r;M=h.getProgram(1,(R?1:0)<<2|(M?1:0)<<1|(r?1:0),N);l.bindProgram(M);if(r){var I=G.getMosaicItemPosition(p,!0);if(!I){l.bindProgram();return}M.setUniform2f("u_pattern_tl",I.tl[0],I.tl[1]);M.setUniform2f("u_pattern_br",I.br[0],I.br[1]);M.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES);
G.bind(l,9729,I.page,C.VTL_TEXTURE_BINDING_UNIT_SPRITES)}M.setUniformMatrix3fv("u_displayMat3",1===v?J.displayMat3:J.displayViewMat3);M.setUniform2fv("u_fillTranslation",k);M.setUniform1f("u_depth",u.z+a);M.setUniform4fv("u_color",this._color);R&&M.setUniform4fv("u_id",w);for(const H of t)H.layerData.has(n)&&(u=H.layerData.get(n),u.prepareForRendering(l,h),t=u.fillVertexArrayObject,D.isNone(t)||(l.bindVAO(t),M.setUniformMatrix3fv("u_dvsMat3",H.transforms.dvs),r&&(t=H.coordRange[0]/(K*H.size[0]*Math.max(Math.pow(2,
Math.round(x)-H.key.level),1)),k=1/(I.size[1]*t),this._patternMatrix[0]=1/(I.size[0]*t),this._patternMatrix[4]=k,M.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),l.setStencilFunction(514,H.stencilRef,255),l.drawElements(4,u.fillIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*u.fillIndexStart),H.triangleCount+=u.fillIndexCount/3))}};q._drawOutline=function(h,n,u,t,k,v,p,r,w){const {context:l,displayLevel:x,drawPhase:y,renderPass:B,pixelRatio:F,state:G}=h;if("opaque"!==B&&(p=void 0!==p,
u.getPaintValue("fill-antialias",x)&&!p||u.hasDataDrivenOutlineColor)){h=h.painter.getVectorTileProgramCache();p=u.hasDataDrivenOutline;if(u.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else{var J=u.hasDataDrivenOutlineColor?e:u.getPaintValue("fill-outline-color",x);w*=J[3];this._outlineColor[0]=w*J[0];this._outlineColor[1]=w*J[1];this._outlineColor[2]=
w*J[2];this._outlineColor[3]=w}w=.75/F;J=y===b.WGLDrawPhase.HITTEST;var K=this._outlineProgramOptions;K.id=J;K.dd=p;p=h.getProgram(2,(J?1:0)<<1|(p?1:0),K);l.bindProgram(p);p.setUniformMatrix3fv("u_displayMat3",1===v?G.displayMat3:G.displayViewMat3);p.setUniform2fv("u_fillTranslation",k);p.setUniform1f("u_depth",u.z+a);p.setUniform1f("u_outline_width",w);p.setUniform4fv("u_color",this._outlineColor);J&&p.setUniform4fv("u_id",r);for(const M of t)M.layerData.has(n)&&(u=M.layerData.get(n),u.prepareForRendering(l,
h),t=u.outlineVertexArrayObject,D.isNone(t)||(l.bindVAO(t),p.setUniformMatrix3fv("u_dvsMat3",M.transforms.dvs),l.setStencilFunction(514,M.stencilRef,255),l.drawElements(4,u.outlineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*u.outlineIndexStart),M.triangleCount+=u.outlineIndexCount/3))}};return g}(d);z.WGLBrushVTLFill=d;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../../../../../chunks/vec4f32 ../number ../enums ./WGLBrush".split(" "),
function(z,E,D,C,A,m,c,b,d){const a=Math.PI/180,e=[1,1,1,1];d=function(f){function g(){var h=f.apply(this,arguments)||this;h._color=m.create();h._dashArray=A.create();h._programOptions={id:!1,dd:!1,pattern:!1};return h}E._inheritsLoose(g,f);var q=g.prototype;q.dispose=function(){};q.drawMany=function(h,n){const {context:u,displayLevel:t,state:k,drawPhase:v,styleLayerUID:p}=h,r=h.styleLayer,w=h.painter.getVectorTileProgramCache(),l=r.getPaintValue("line-translate",t),x=r.getPaintValue("line-translate-anchor",
t);var y=r.getPaintValue("line-pattern",t);const B=void 0!==y,F=1/h.pixelRatio,G=r.getPaintValue("line-blur",t);var J=r.hasDataDrivenColor?e:r.getPaintValue("line-color",t),K=r.hasDataDrivenOpacity?1:r.getPaintValue("line-opacity",t);const M=r.hasDataDrivenWidth?1:r.getPaintValue("line-width",t);K*=J[3];this._color[0]=K*J[0];this._color[1]=K*J[1];this._color[2]=K*J[2];this._color[3]=K;J=r.hasDataDrivenLine;K=v===b.WGLDrawPhase.HITTEST;let R;K&&(R=c.u32to4Xu8(p+1));const N=this._programOptions;N.id=
K;N.dd=J;N.pattern=B;J=w.getProgram(3,(K?1:0)<<2|(J?1:0)<<1|(B?1:0),N);u.bindProgram(J);J.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);J.setUniformMatrix3fv("u_displayMat3",1===x?k.displayMat3:k.displayViewMat3);J.setUniform2fv("u_lineTranslation",l);J.setUniform1f("u_depth",r.z);J.setUniform1f("u_blur",G);J.setUniform1f("u_antialiasing",F);J.setUniform4fv("u_color",this._color);J.setUniform1f("u_width",M);K&&J.setUniform4fv("u_id",R);if(B){if(h=h.spriteMosaic,y=h.getMosaicItemPosition(y,
!0))h.bind(u,9729,y.page,C.VTL_TEXTURE_BINDING_UNIT_SPRITES),J.setUniform2f("u_pattern_tl",y.tl[0],y.br[1]),J.setUniform2f("u_pattern_br",y.br[0],y.tl[1]),J.setUniform2f("u_spriteSize",8*y.size[0],y.size[1]),J.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else y=r.getPaintValue("line-dasharray",t),2>y.length&&(y=[1,-1]),this._dashArray[0]=8*y[0],this._dashArray[1]=8*y[1],J.setUniform2fv("u_dasharray",this._dashArray);for(const I of n)I.layerData.has(p)&&(n=I.layerData.get(p),n.prepareForRendering(u,
w),y=n.lineVertexArrayObject,D.isNone(y)||(u.bindVAO(y),J.setUniformMatrix3fv("u_dvsMat3",I.transforms.dvs),u.setStencilFunction(514,I.stencilRef,255),u.drawElements(4,n.lineIndexCount,5125,Uint32Array.BYTES_PER_ELEMENT*n.lineIndexStart),I.triangleCount+=n.lineIndexCount/3))};return g}(d);z.C_DEG_TO_RAD=a;z.WGLBrushVTLLine=d;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../../../../../chunks/vec2f32 ../../../../../chunks/vec4f32 ../../vectorTiles/decluttering/config ../number ../enums ./WGLBrush ../GeometryUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){const f=1/65536,g=[1,1,1,1];a=function(q){function h(){var u=q.apply(this,arguments)||this;u._iconProgramOptions={id:!1,dd:!1,sdf:!1};u._sdfProgramOptions={id:!1,dd:!1};u._spritesTextureSize=A.create();u._haloColor=m.create();u._sdfColor=m.create();u._color=m.create();return u}E._inheritsLoose(h,q);var n=h.prototype;n.dispose=function(){};n.drawMany=function(u,t){const {drawPhase:k,styleLayerUID:v}=u,p=u.styleLayer;let r;k===d.WGLDrawPhase.HITTEST&&(r=b.u32to4Xu8(v+
1));this._drawIcons(u,p,t,r);this._drawText(u,p,t,r)};n._drawIcons=function(u,t,k,v){const {context:p,displayLevel:r,drawPhase:w,painter:l,state:x,styleLayerUID:y}=u;var B=!1;for(var F of k)if(F.layerData.has(y)){var G=F.layerData.get(y);if(0<G.iconPerPageElementsMap.size){B=!0;break}}if(B){F=t.hasDataDrivenIconSize?1:t.getLayoutValue("icon-size",r);var J=t.hasDataDrivenIconColor?g:t.getPaintValue("icon-color",r),K=t.hasDataDrivenIconOpacity?1:t.getPaintValue("icon-opacity",r),M=t.getPaintValue("icon-translate",
r),R=t.getPaintValue("icon-translate-anchor",r);B=l.getVectorTileProgramCache();K*=J[3];this._color[0]=K*J[0];this._color[1]=K*J[1];this._color[2]=K*J[2];this._color[3]=K;J=t.getLayoutValue("icon-rotation-alignment",r);2===J&&(J=0===t.getLayoutValue("symbol-placement",r)?1:0);K=0===J;K=t.getLayoutValue("icon-keep-upright",r)&&K;var N=G.isIconSDF,I=t.hasDataDrivenIcon;G=w===d.WGLDrawPhase.HITTEST;var H=this._iconProgramOptions;H.id=G;H.dd=I;H.sdf=N;I=B.getProgram(4,(G?1:0)<<2|(I?1:0)<<1|(N?1:0),H);
p.bindProgram(I);N&&(N=t.getPaintValue("icon-halo-color",r),H=t.getPaintValue("icon-halo-width",r),I.setUniform4f("u_outlineColor",N[0],N[1],N[2],N[3]),I.setUniform1f("u_outlineSize",H));I.setUniformMatrix3fv("u_displayViewMat3",0===J?x.displayViewMat3:x.displayMat3);I.setUniformMatrix3fv("u_displayMat3",1===R?x.displayMat3:x.displayViewMat3);I.setUniform2fv("u_iconTranslation",M);I.setUniform1f("u_depth",t.z);I.setUniform1f("u_mapRotation",e.degToByte(x.rotation));I.setUniform1f("u_keepUpright",
K?1:0);I.setUniform1f("u_level",10*r);I.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_SPRITES);I.setUniform1f("u_size",F);I.setUniform4fv("u_color",this._color);I.setUniform1f("u_opacity",1);I.setUniform1f("u_fadeDuration",c.FADE_DURATION/1E3);G&&I.setUniform4fv("u_id",v);for(const Q of k)if(Q.layerData.has(y)&&(G=Q.layerData.get(y),0!==G.iconPerPageElementsMap.size&&(G.prepareForRendering(p,B),G.updateOpacityInfo(),t=G.iconVertexArrayObject,!D.isNone(t)))){p.bindVAO(t);I.setUniformMatrix3fv("u_dvsMat3",
Q.transforms.dvs);I.setUniform1f("u_time",(performance.now()-G.lastOpacityUpdate)/1E3);for(const [W,aa]of G.iconPerPageElementsMap)this._renderIconRange(u,I,aa,W,Q)}}};n._renderIconRange=function(u,t,k,v,p){const {context:r,spriteMosaic:w}=u;this._spritesTextureSize[0]=w.getWidth(v)/4;this._spritesTextureSize[1]=w.getHeight(v)/4;t.setUniform2fv("u_mosaicSize",this._spritesTextureSize);w.bind(r,9729,v,C.VTL_TEXTURE_BINDING_UNIT_SPRITES);r.setStencilTestEnabled(!0);r.setStencilFunction(516,255,255);
r.setStencilWriteMask(0);r.drawElements(4,k[1],5125,Uint32Array.BYTES_PER_ELEMENT*k[0]);p.triangleCount+=k[1]/3};n._drawText=function(u,t,k,v){const {context:p,displayLevel:r,drawPhase:w,glyphMosaic:l,painter:x,pixelRatio:y,state:B,styleLayerUID:F}=u;var G=!1;for(var J of k)if(J.layerData.has(F)&&(u=J.layerData.get(F),0<u.glyphPerPageElementsMap.size)){G=!0;break}if(G){u=t.getLayoutValue("text-rotation-alignment",r);2===u&&(u=0===t.getLayoutValue("symbol-placement",r)?1:0);J=0===u;G=t.getLayoutValue("text-keep-upright",
r)&&J;var K=w===d.WGLDrawPhase.HITTEST,M=.8*3/y,R=t.hasDataDrivenTextSize?1:t.getLayoutValue("text-size",r),N=t.hasDataDrivenTextColor?g:t.getPaintValue("text-color",r),I=t.hasDataDrivenTextOpacity?1:t.getPaintValue("text-opacity",r),H=t.getPaintValue("text-halo-color",r),Q=t.getPaintValue("text-halo-width",r),W=3*t.getPaintValue("text-halo-blur",r),aa=3*Q;J=x.getVectorTileProgramCache();var da=N[3]*I;this._sdfColor[0]=da*N[0];this._sdfColor[1]=da*N[1];this._sdfColor[2]=da*N[2];this._sdfColor[3]=
da;N=H[3]*I;this._haloColor[0]=N*H[0];this._haloColor[1]=N*H[1];this._haloColor[2]=N*H[2];this._haloColor[3]=N;this._glyphTextureSize||(this._glyphTextureSize=A.fromValues(l.width/4,l.height/4));N=t.getPaintValue("text-translate",r);I=t.getPaintValue("text-translate-anchor",r);da=t.hasDataDrivenText;var S=this._sdfProgramOptions;S.id=K;S.dd=da;var U=J.getProgram(6,(K?1:0)<<1|(da?1:0),S);p.bindProgram(U);U.setUniformMatrix3fv("u_displayViewMat3",0===u?B.displayViewMat3:B.displayMat3);U.setUniformMatrix3fv("u_displayMat3",
1===I?B.displayMat3:B.displayViewMat3);U.setUniform2fv("u_textTranslation",N);U.setUniform1f("u_depth",t.z+f);U.setUniform2fv("u_mosaicSize",this._glyphTextureSize);U.setUniform1f("u_mapRotation",e.degToByte(B.rotation));U.setUniform1f("u_keepUpright",G?1:0);U.setUniform1f("u_level",10*r);U.setUniform1i("u_texture",C.VTL_TEXTURE_BINDING_UNIT_GLYPHS);U.setUniform1f("u_size",R);U.setUniform1f("u_antialiasingWidth",M);U.setUniform1f("u_opacity",1);U.setUniform1f("u_fadeDuration",c.FADE_DURATION/1E3);
K&&U.setUniform4fv("u_id",v);for(const X of k)X.layerData.has(F)&&(u=X.layerData.get(F),0!==u.glyphPerPageElementsMap.size&&(u.prepareForRendering(p,J),u.updateOpacityInfo(),t=u.textVertexArrayObject,D.isNone(t)||(p.bindVAO(t),U.setUniformMatrix3fv("u_dvsMat3",X.transforms.dvs),p.setStencilTestEnabled(!0),p.setStencilFunction(516,255,255),p.setStencilWriteMask(0),t=(performance.now()-u.lastOpacityUpdate)/1E3,U.setUniform1f("u_time",t),u.glyphPerPageElementsMap.forEach((ba,Z)=>{this._renderGlyphRange(p,
ba,Z,l,U,H[3],Q,W,aa,X)}))))}};n._renderGlyphRange=function(u,t,k,v,p,r,w,l,x,y){v.bind(u,9729,k,C.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<r&&0<w&&(p.setUniform4fv("u_color",this._haloColor),p.setUniform1f("u_halo",1),p.setUniform1f("u_edgeDistance",x),p.setUniform1f("u_edgeBlur",l),u.drawElements(4,t[1],5125,Uint32Array.BYTES_PER_ELEMENT*t[0]),y.triangleCount+=t[1]/3);0<this._sdfColor[3]&&(p.setUniform4fv("u_color",this._sdfColor),p.setUniform1f("u_halo",0),p.setUniform1f("u_edgeDistance",0),p.setUniform1f("u_edgeBlur",
0),u.drawElements(4,t[1],5125,Uint32Array.BYTES_PER_ELEMENT*t[0]),y.triangleCount+=t[1]/3)};return h}(a);z.WGLBrushVTLSymbol=a;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/decluttering/config":function(){define(["exports"],function(z){z.COLLISION_GRID_CELL_SIZE=32;z.DECLUTTER_BUDGET=1.5;z.DECLUTTER_TILES=!0;z.FADE_DURATION=200;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["exports"],function(z){function E(b,
d){b%=d;return 0<=b?b:b+d}const D=Number.POSITIVE_INFINITY,C=Math.PI,A=128/C,m=256/360,c=1/Math.LN2;z.C_256_TO_RAD=C/128;z.C_2PI=2*C;z.C_DEG_TO_256=m;z.C_DEG_TO_RAD=C/180;z.C_INFINITY=D;z.C_PI=C;z.C_PI_BY_2=C/2;z.C_RAD_TO_256=A;z.C_SQRT2=1.414213562;z.C_SQRT2_INV=1/1.414213562;z.between=function(b,d,a){return b>=d&&b<=a||b>=a&&b<=d};z.degToByte=function(b){return E(b*m,256)};z.interpolate=function(b,d,a){return b*(1-a)+d*a};z.log2=function(b){return Math.log(b)*c};z.positiveMod=E;z.radToByte=function(b){return E(b*
A,256)};z.sqr=function(b){return b*b};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/RandomLCG ../definitions ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../enums ../materialKey/MaterialKey ../Utils ./WGLGeometryBrush".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){return function(u){function t(){var v=u.apply(this,arguments)||this;v._dotTextureSize=0;v._dotTextures=null;v._dotSamplers=new Int32Array([D.TEXTURE_BINDING_RENDERER_0,D.TEXTURE_BINDING_RENDERER_1]);return v}z._inheritsLoose(t,u);var k=t.prototype;k.dispose=function(){this._disposeTextures()};k.getGeometryType=function(){return g.WGLGeometryType.FILL};k.drawGeometry=function(v,p,r,w,l){const {context:x,painter:y,rendererInfo:B,requiredLevel:F}=v,{indexCount:G,
indexFrom:J,materialKey:K}=r;r=q.FillMaterialKey.load(K);const {bufferLayouts:M,attributes:R}=h.createProgramDescriptor(r.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},...r.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],...r.dotDensity?
[{location:2,name:"a_inverseArea",count:1,type:5126}]:[]]});l=y.materialManager.getMaterialProgram(v,r,"materials/fill",R,l);w=this._getVAO(x,M,R,w);x.bindProgram(l);x.bindVAO(w);this._setSharedUniforms(l,v,p);r.textureBinding&&(y.textureManager.bindTextures(x,l,r),l.setUniform1f("u_zoomFactor",1/Math.pow(2,F-p.key.level)/v.pixelRatio));r.vvColor&&(l.setUniform1fv("u_vvColorValues",B.vvColorValues),l.setUniform4fv("u_vvColors",B.vvColors));r.vvOpacity&&(l.setUniform1fv("u_vvOpacityValues",B.vvOpacityValues),
l.setUniform1fv("u_vvOpacities",B.vvOpacities));if(r.dotDensity){w=D.TILE_SIZE/B.ddDotSize;r=w*window.devicePixelRatio*w*window.devicePixelRatio;p=1/Math.pow(2,F-p.key.level);const N=1/p*(1/p);v=B.ddDotScale?v.state.scale/B.ddDotScale:1;l.setUniform1f("u_tileZoomFactor",p);l.setUniform1f("u_tileDotsOverArea",r/(D.TILE_SIZE*window.devicePixelRatio*D.TILE_SIZE*window.devicePixelRatio));l.setUniformMatrix4fv("u_dotColors",B.ddColors);l.setUniform4fv("u_isActive",B.ddActiveDots);l.setUniform4fv("u_dotBackgroundColor",
B.ddBackgroundColor);l.setUniform1f("u_dotValue",Math.max(1,B.ddDotValue*v*N));this._bindDotDensityTextures(x,l,B,w)}x.drawElements(4,G,5125,Uint32Array.BYTES_PER_ELEMENT*J);x.bindVAO(null)};k._disposeTextures=function(){if(this._dotTextures){for(let v=0;v<this._dotTextures.length;v++)this._dotTextures[v].dispose();this._dotTextures=null}};k._bindDotDensityTextures=function(v,p,r,w){r=this._createDotDensityTextures(v,w,r.ddSeed);p.setUniform1iv("u_dotTextures",this._dotSamplers);for(p=0;p<r.length;p++)v.bindTexture(r[p],
this._dotSamplers[p])};k._createDotDensityTextures=function(v,p,r){if(this._dotTextureSize!==p||this._seed!==r)this._disposeTextures(),this._dotTextureSize=p,this._seed=r;null===this._dotTextures&&(r=new E(r),this._dotTextures=[this._allocDotDensityTexture(v,p,r),this._allocDotDensityTexture(v,p,r)]);return this._dotTextures};k._allocDotDensityTexture=function(v,p,r){const w=new Float32Array(p*p*4);for(let l=0;l<w.length;l++)w[l]=r.getFloat();return new m(v,{wrapMode:10497,pixelFormat:6408,dataType:5126,
samplingMode:9728,width:p,height:p},w)};return t}(n)})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/Error","../enums","../mesh/templates/meshUtils"],function(z,E,D,C,A){function m(t,k=!1){const v=C.WGLVVFlag.SIZE_FIELD_STOPS|C.WGLVVFlag.SIZE_MINMAX_VALUE|C.WGLVVFlag.SIZE_SCALE_STOPS|C.WGLVVFlag.SIZE_UNIT_VALUE;t=(t&(C.WGLVVTarget.FIELD_TARGETS_OUTLINE|C.WGLVVTarget.MINMAX_TARGETS_OUTLINE|C.WGLVVTarget.SCALE_TARGETS_OUTLINE|
C.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return k?v&t:v&~t}function c(t){const k=m(t,!1);return t&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY|C.WGLVVFlag.ROTATION|k)}let b=function(){function t(v){this._data=0;this._data=v}t.load=function(v){const p=this.shared;p.data=v;return p};var k=t.prototype;k.setBit=function(v,p){v=1<<v;this._data=p?this._data|v:this._data&~v};k.bit=function(v){return(this._data&1<<v)>>v};k.setBits=function(v,p,r){for(let w=p,l=0;w<r;w++,l++)this.setBit(w,0!==(v&1<<l))};k.bits=
function(v,p){let r=0;for(let w=v,l=0;w<p;w++,l++)r|=this.bit(w)<<l;return r};k.hasVV=function(){return!1};k.setVV=function(v,p){};k.getVariation=function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}};k.getVariationHash=function(){return this._data&~(7&this.textureBinding)};E._createClass(t,[{key:"data",set:function(v){this._data=v},get:function(){return this._data}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(v){this.setBits(v,8,11)}},{key:"mapAligned",
get:function(){return!!this.bit(20)},set:function(v){this.setBit(20,v)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(v){this.setBit(11,v)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(v){this.setBit(12,v)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(v){this.setBits(v,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case C.WGLGeometryType.FILL:return"fill";case C.WGLGeometryType.MARKER:return"marker";case C.WGLGeometryType.LINE:return"line";
case C.WGLGeometryType.TEXT:return"text";case C.WGLGeometryType.LABEL:return"label";default:throw new D(`Unable to handle unknown geometryType: ${this.geometryType}`);}}}]);return t}();b.shared=new b(0);const d=t=>function(k){function v(){return k.apply(this,arguments)||this}E._inheritsLoose(v,k);var p=v.prototype;p.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};p.setVV=function(r,w){k.prototype.setVV.call(this,
r,w);r&=m(r,w);this.vvSizeMinMaxValue=!!(r&C.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(r&C.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(r&C.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(r&C.WGLVVFlag.SIZE_SCALE_STOPS)};E._createClass(v,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(r){this.setBit(16,r)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(r){this.setBit(17,r)}},{key:"vvSizeFieldStops",get:function(){return 0!==
this.bit(18)},set:function(r){this.setBit(18,r)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(r){this.setBit(19,r)}}]);return v}(t),a=t=>function(k){function v(){return k.apply(this,arguments)||this}E._inheritsLoose(v,k);var p=v.prototype;p.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvRotation};p.setVV=function(r,w){k.prototype.setVV.call(this,r,w);this.vvRotation=!w&&!!(r&C.WGLVVFlag.ROTATION)};E._createClass(v,[{key:"vvRotation",get:function(){return 0!==
this.bit(15)},set:function(r){this.setBit(15,r)}}]);return v}(t),e=t=>function(k){function v(){return k.apply(this,arguments)||this}E._inheritsLoose(v,k);var p=v.prototype;p.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvColor};p.setVV=function(r,w){k.prototype.setVV.call(this,r,w);this.vvColor=!w&&!!(r&C.WGLVVFlag.COLOR)};E._createClass(v,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(r){this.setBit(13,r)}}]);return v}(t),f=t=>function(k){function v(){return k.apply(this,
arguments)||this}E._inheritsLoose(v,k);var p=v.prototype;p.hasVV=function(){return k.prototype.hasVV.call(this)||this.vvOpacity};p.setVV=function(r,w){k.prototype.setVV.call(this,r,w);this.vvOpacity=!w&&!!(r&C.WGLVVFlag.OPACITY)};E._createClass(v,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(r){this.setBit(14,r)}}]);return v}(t);let g=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,t);k.load=function(v){const p=this.shared;p.data=v;return p};
k.from=function(v,p){const r=this.load(0);r.geometryType=C.WGLGeometryType.FILL;p?r.dotDensity=!0:r.setVV(v,!1);return r.data};k.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity}};E._createClass(k,[{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(v){this.setBit(15,v)}}]);return k}(e(f(b)));g.shared=new g(0);let q=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,
t);k.load=function(v){const p=this.shared;p.data=v;return p};k.from=function(v){const p=this.load(0);p.geometryType=C.WGLGeometryType.MARKER;p.setVV(v,!1);return p.data};k.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(e(f(a(d(b)))));
q.shared=new q(0);let h=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,t);k.load=function(v){const p=this.shared;p.data=v;return p};k.from=function(v,p){const r=this.load(0);r.geometryType=C.WGLGeometryType.LINE;r.setVV(v,p);return r.data};k.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,
vvSizeUnitValue:this.vvSizeUnitValue}};return k}(e(f(d(b))));h.shared=new h(0);let n=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,t);k.load=function(v){const p=this.shared;p.data=v;return p};k.from=function(v){const p=this.load(v);p.geometryType=C.WGLGeometryType.TEXT;p.setVV(v,!1);return p.data};k.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,
vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(e(f(a(d(b)))));n.shared=new n(0);let u=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,t);k.load=function(v){const p=this.shared;p.data=v;return p};k.from=function(v,p){const r=this.load(0);r.geometryType=C.WGLGeometryType.LABEL;r.setVV(v,!1);r.mapAligned=!!A.isMapAligned(p);return r.data};k.prototype.getVariation=function(){return{...t.prototype.getVariation.call(this),
vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}};return k}(d(b));u.shared=new u(0);z.FillMaterialKey=g;z.LabelMaterialKey=u;z.LineMaterialKey=h;z.MarkerMaterialKey=q;z.MaterialKeyBase=b;z.TextMaterialKey=n;z.createMaterialKey=function(t,k,v,p,r){switch(t){case C.WGLGeometryType.FILL:return g.from(k,p);case C.WGLGeometryType.LINE:return h.from(k,v);case C.WGLGeometryType.MARKER:return q.from(k);
case C.WGLGeometryType.TEXT:return n.from(k);case C.WGLGeometryType.LABEL:return u.from(k,r);default:throw Error(`Unable to createMaterialKey for unknown geometryType ${t}`);}};z.getFillVVFlags=function(t){return t&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY)};z.getLabelVVFlags=function(t){const k=m(t,!1);return t&k};z.getLineVVFlags=function(t,k){if(k)return k=m(t,!0),t&k;k=m(t,!1);return t&(C.WGLVVFlag.COLOR|C.WGLVVFlag.OPACITY|k)};z.getMarkerVVFlags=c;z.getSizeFlagsMask=m;z.getTextVVFlags=function(t){return c(t)};
z.hydrateMaterialKey=function(t){switch(b.load(t).geometryType){case C.WGLGeometryType.MARKER:return new q(t);case C.WGLGeometryType.FILL:return new g(t);case C.WGLGeometryType.LINE:return new h(t);case C.WGLGeometryType.TEXT:return new n(t);case C.WGLGeometryType.LABEL:return new u(t)}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/meshUtils":function(){define(["exports"],function(z){z.isMapAligned=function(E){switch(E){case "above-along":case "below-along":case "center-along":return 1;
default:return 0}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../definitions ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./WGLBrush".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f){return function(g){function q(){return g.apply(this,arguments)||this}z._inheritsLoose(q,g);var h=q.prototype;h.prepareState=function({context:n},u,t){t=t&&-1!==t.indexOf("id");n.setBlendingEnabled(!t);n.setBlendFunctionSeparate(1,771,1,771);n.setColorMask(!0,!0,!0,!0);n.setStencilWriteMask(0);n.setStencilTestEnabled(!0);n.setStencilFunction(514,u.stencilRef,255)};h.draw=function(n,u,t){u.commitChanges(n);if(u.visible){var k=this.getGeometryType(),v=u.getDisplayList(),
p=u.getGeometry(k);p&&v&&(n.timeline.begin(this.name),n.attributeView.bindTextures(n.context),v.byType(k,r=>{this.drawGeometry(n,u,r,p,t)}),n.timeline.end(this.name))}};h._getVAO=function(n,u,t,k){k.vao||(k.vao=new m(n,t,u,k.vertexBufferMap,k.indexBuffer));return k.vao};h._setSharedUniforms=function(n,u,t){n.setUniform1f("u_pixelRatio",u.pixelRatio);n.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs);n.setUniformMatrix3fv("u_displayViewMat3",u.state.displayViewMat3);n.setUniform1i("u_attributeTextureSize",
u.attributeView.size);n.setUniform1i("u_attributeData0",E.TEXTURE_BINDING_ATTRIBUTE_DATA_0);n.setUniform1i("u_attributeData1",E.TEXTURE_BINDING_ATTRIBUTE_DATA_1);n.setUniform1i("u_attributeData2",E.TEXTURE_BINDING_ATTRIBUTE_DATA_2);n.setUniform1i("u_attributeData3",E.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return q}(f)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],
function(z,E,D,C,A){return function(m){function c(){return m.apply(this,arguments)||this}z._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return E.WGLGeometryType.LABEL};b.drawGeometry=function(d,a,e,f,g){const {context:q,painter:h,state:n,rendererInfo:u}=d,{indexCount:t,indexFrom:k,materialKey:v}=e;e=D.LabelMaterialKey.load(v);const p=e.mapAligned?1:0;if(p||!(1<=Math.abs(a.key.level-Math.round(100*d.displayLevel)/100))){var {bufferLayouts:r,attributes:w}=
C.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_glyphData",count:4,type:5121},{location:7,name:"a_vertexOffset",count:2,type:5122},{location:8,name:"a_texCoords",
count:2,type:5123}]});g=h.materialManager.getMaterialProgram(d,e,"materials/label",w,g);f=this._getVAO(q,r,w,f);d.context.setStencilFunction(514,0,255);q.bindProgram(g);q.bindVAO(f);this._setSharedUniforms(g,d,a);h.textureManager.bindTextures(q,g,e);f=1===p?n.displayViewMat3:n.displayMat3;e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",u.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",u.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a=u.getSizeVVFieldStops(a.key.level),
g.setUniform1fv("u_vvSizeFieldStopsValues",a.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",u.vvSizeUnitValueToPixelsRatio);g.setUniform1f("u_mapRotation",Math.floor(n.rotation/360*254));g.setUniform1f("u_mapAligned",p);g.setUniformMatrix3fv("u_displayMat3",f);g.setUniform1f("u_opacity",1);g.setUniform1f("u_zoomLevel",Math.round(10*d.displayLevel));g.setUniform2fv("u_screenSize",d.state.size);g.setUniform1f("u_isHalo",
1);q.drawElements(4,t,5125,Uint32Array.BYTES_PER_ELEMENT*k);g.setUniform1f("u_isHalo",0);q.drawElements(4,t,5125,Uint32Array.BYTES_PER_ELEMENT*k);q.bindVAO(null);q.setStencilTestEnabled(!0);q.setBlendingEnabled(!0)}};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(z,E,D,C,A){return function(m){function c(){return m.apply(this,
arguments)||this}z._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return E.WGLGeometryType.LINE};b.drawGeometry=function(d,a,e,f,g){const {context:q,painter:h,rendererInfo:n,requiredLevel:u}=d,{indexFrom:t,indexCount:k,materialKey:v}=e;e=D.LineMaterialKey.load(v);const {bufferLayouts:p,attributes:r}=C.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",
count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]});g=h.materialManager.getMaterialProgram(d,e,"materials/line",r,g);f=this._getVAO(q,p,r,f);const w=1/d.pixelRatio;q.bindProgram(g);q.bindVAO(f);this._setSharedUniforms(g,d,a);e.textureBinding&&
h.textureManager.bindTextures(q,g,e);g.setUniform1f("u_zoomFactor",Math.pow(2,u-a.key.level)/d.pixelRatio);g.setUniform1f("u_blur",0+w);g.setUniform1f("u_antialiasing",w);e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(d=n.getSizeVVFieldStops(a.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",d.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",d.sizes));e.vvSizeUnitValue&&
g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);e.vvColor&&(g.setUniform1fv("u_vvColorValues",n.vvColorValues),g.setUniform4fv("u_vvColors",n.vvColors));e.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),g.setUniform1fv("u_vvOpacities",n.vvOpacities));q.setFaceCullingEnabled(!0);q.setFrontFace(2305);q.setCullFace(1029);q.drawElements(4,k,5125,Uint32Array.BYTES_PER_ELEMENT*t);q.setFaceCullingEnabled(!1);q.bindVAO(null)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers",
"../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(z,E,D,C,A){return function(m){function c(){return m.apply(this,arguments)||this}z._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return E.WGLGeometryType.MARKER};b.drawGeometry=function(d,a,e,f,g){const {context:q,painter:h,rendererInfo:n,state:u}=d,{indexCount:t,indexFrom:k,materialKey:v}=e;e=D.MarkerMaterialKey.load(v);const {bufferLayouts:p,attributes:r}=C.createProgramDescriptor(e.data,
{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]});g=h.materialManager.getMaterialProgram(d,e,"materials/icon",
r,g);f=this._getVAO(q,p,r,f);q.bindProgram(g);q.bindVAO(f);e.textureBinding&&h.textureManager.bindTextures(q,g,e,!0);this._setSharedUniforms(g,d,a);g.setUniformMatrix3fv("u_displayMat3",e.vvRotation?u.displayViewMat3:u.displayMat3);e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(d=n.getSizeVVFieldStops(a.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",d.values),
g.setUniform1fv("u_vvSizeFieldStopsSizes",d.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);e.vvColor&&(g.setUniform1fv("u_vvColorValues",n.vvColorValues),g.setUniform4fv("u_vvColors",n.vvColors));e.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),g.setUniform1fv("u_vvOpacities",n.vvOpacities));e.vvRotation&&g.setUniform1f("u_vvRotationType","geographic"===n.vvMaterialParameters.vvRotationType?0:1);q.drawElements(4,
t,5125,Uint32Array.BYTES_PER_ELEMENT*k);q.bindVAO(null)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../enums","../materialKey/MaterialKey","../Utils","./WGLGeometryBrush"],function(z,E,D,C,A){return function(m){function c(){return m.apply(this,arguments)||this}z._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){};b.getGeometryType=function(){return E.WGLGeometryType.TEXT};b.drawGeometry=function(d,
a,e,f,g){const {context:q,painter:h,rendererInfo:n,state:u}=d,{indexCount:t,indexFrom:k,materialKey:v}=e;e=D.TextMaterialKey.load(v);const {bufferLayouts:p,attributes:r}=C.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_haloColor",count:4,type:5121,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:5121},{location:5,name:"a_aux",
count:4,type:5120},{location:6,name:"a_vertexOffset",count:2,type:5122},{location:7,name:"a_texCoords",count:2,type:5123}]});g=h.materialManager.getMaterialProgram(d,e,"materials/text",r,g);f=this._getVAO(q,p,r,f);q.bindProgram(g);q.bindVAO(f);this._setSharedUniforms(g,d,a);h.textureManager.bindTextures(q,g,e);g.setUniformMatrix3fv("u_displayMat3",u.displayMat3);g.setUniformMatrix3fv("u_displayViewMat3",u.displayViewMat3);e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);
e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(d=n.getSizeVVFieldStops(a.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",d.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",d.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);e.vvColor&&(g.setUniform1fv("u_vvColorValues",n.vvColorValues),g.setUniform4fv("u_vvColors",n.vvColors));e.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",
n.vvOpacityValues),g.setUniform1fv("u_vvOpacities",n.vvOpacities));e.vvRotation&&g.setUniform1f("u_vvRotationType","geographic"===n.vvMaterialParameters.vvRotationType?0:1);g.setUniform1f("u_isHalo",1);q.drawElements(4,t,5125,Uint32Array.BYTES_PER_ELEMENT*k);g.setUniform1f("u_isHalo",0);q.drawElements(4,t,5125,Uint32Array.BYTES_PER_ELEMENT*k);q.bindVAO(null)};return c}(A)})},"esri/views/2d/engine/webgl/brushes/raster/BrushRasterBitmap":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../webgl/rasterUtils","../../VertexStream","../WGLBrush"],function(z,E,D,C){return function(A){function m(){var b=A.apply(this,arguments)||this;b._desc={lut:{vsPath:"raster/lut",fsPath:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{vsPath:"raster/stretch",fsPath:"raster/stretch",attributes:{a_position:0,a_texcoord:1}},hillshade:{vsPath:"raster/hillshade",fsPath:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};b._rendererUniformInfos=new Map;return b}z._inheritsLoose(m,
A);var c=m.prototype;c.dispose=function(){this._quad&&this._quad.dispose()};c.prepareState=function({context:b},d){b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!0);b.setStencilFunction(514,d.stencilRef,255)};c.draw=function(b,d){var a;if(d.source&&!d.suspended){b.timeline.begin(this.name);var e=!(null!=(a=b.context.capabilities.textureFloat)&&a.textureFloatLinear);d.updateTexture(b);a=this.getShaderVariations(d,
e);a=b.painter.materialManager.getProgram(b,this._desc[d.symbolizerParameters.type],a);this.drawWithProgram(b.context,a,d);b.timeline.end(this.name)}};c.drawWithProgram=function(b,d,a,e=1,f=[0,0],g=!1){this._quad||(this._quad=new D(b,[0,0,1,0,0,1,1,1]));const {symbolizerParameters:q,transformGrid:h,width:n,height:u,opacity:t}=a;var k=q.type;b.bindProgram(d);const v=this.getShaderVariations(a);k=this.getUniformInfos(k,b,d,v);const {names:p,textures:r}=a.getTextures();E.setTextures(b,d,p,r);b=E.getBasicGridUniforms(e,
f);g=E.getCommonUniforms(h,[n,u],[a.source.width,a.source.height],t,g);E.setUniforms(d,k,{u_coordScale:a.coordScale,u_dvsMat3:a.transforms.dvs,...b,...g});if(q.colormap){const {colormap:w,colormapOffset:l}=q;a=E.getColormapUniforms(w,l);E.setUniforms(d,k,a)}"stretch"===q.type?(a=E.getStretchUniforms(q),E.setUniforms(d,k,a)):"hillshade"===q.type&&(a=E.getShadedReliefUniforms(q),E.setUniforms(d,k,a));this._quad.draw()};c.getUniformInfos=function(b,d,a,e){b=0<e.length?b+"-"+e.join("-"):b;if(this._rendererUniformInfos.has(b))return this._rendererUniformInfos.get(b);
d=E.getUniformLocationInfos(d,a);this._rendererUniformInfos.set(b,d);return d};c.getShaderVariations=function(b,d=!1){const a=[];"cubic"===b.interpolation?a.push("bicubic"):d&&"bilinear"===b.interpolation&&a.push("bilinear");b.isRendereredSource?a.push("noop"):b.symbolizerParameters.colormap&&a.push("applyColormap");b.transformGrid&&a.push("applyProjection");return a};return m}(C)})},"esri/views/webgl/rasterUtils":function(){define("exports ./Program ./BufferObject ./Texture ./VertexArrayObject ./Renderbuffer ./FramebufferObject ./ProgramCache ./RenderingContext ./ShaderCompiler".split(" "),
function(z,E,D,C,A,m,c,b,d,a){z.createColormapTexture=function(e,f){return new C(e,{width:f.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},f)};z.createFrameBuffer=function(e,f,g,q){q=new C(e,{width:f,height:g,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:q?5121:5126,wrapMode:33071,flipped:!1});return new c(e,{colorTarget:0,depthStencilTarget:3,width:f,height:g},q)};z.createRasterTexture=function(e,
f,g="nearest",q=!1){var h,n=!(q&&"u8"===f.pixelType);q=n?5126:5121;n=null==f.pixels||0===f.pixels.length?null:n?f.getAsRGBAFloat():f.getAsRGBA();const u=null==(h=e.capabilities.textureFloat)?void 0:h.textureFloatLinear;return new C(e,{width:f.width,height:f.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:!u||"bilinear"!==g&&"cubic"!==g?9728:9729,dataType:q,wrapMode:33071,flipped:!1},n)};z.createTransformTexture=function(e,f){var g=4*f.size[0],q=f.size[1];const h={width:g,height:q,
target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,wrapMode:33071,flipped:!1};g=new Float32Array(g*q*4);q=0;for(let n=0;n<f.coefficients.length;n++)g[q++]=f.coefficients[n],2===n%3&&(g[q++]=1);return new C(e,h,g)};z.getBasicGridUniforms=function(e,f){return{u_scale:e,u_offset:f}};z.getColormapUniforms=function(e,f){return{u_colormapOffset:f||0,u_colormapMaxIndex:e?e.length/4-1:null}};z.getCommonUniforms=function(e,f,g,q=1,h=!0,n=!1){return{u_flipY:h,u_isFloatTexture:n,
u_applyTransform:e?!0:!1,u_opacity:q,u_transformSpacing:e?e.spacing:null,u_transformGridSize:e?e.size:null,u_targetImageSize:f,u_srcImageSize:g}};z.getShadedReliefUniforms=function(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}};z.getStretchUniforms=function(e){return{u_bandCount:e.bandCount,u_minOutput:e.outMin,u_maxOutput:e.outMax,u_minCutOff:e.minCutOff,
u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}};z.getUniformLocationInfos=function(e,f){e=e.gl;f=f.glName;const g=e.getProgramParameter(f,e.ACTIVE_UNIFORMS),q=new Map;let h;for(let n=0;n<g;n++)(h=e.getActiveUniform(f,n))&&q.set(h.name,{location:e.getUniformLocation(f,h.name),info:h});return q};z.setTextures=function(e,f,g,q){g.length===q.length&&(q.some(h=>null==h)||g.some(h=>null==h)||g.forEach((h,n)=>{f.setUniform1i(h,n);e.bindTexture(q[n],
n)}))};z.setUniforms=function(e,f,g){Object.keys(g).forEach(q=>{var h=f.get(q)||f.get(q+"[0]");if(h){var n=g[q];if(null!==h&&null!=n)switch({info:h}=h,h.type){case 5126:1<h.size?e.setUniform1fv(q,n):e.setUniform1f(q,n);break;case 35664:e.setUniform2fv(q,n);break;case 35665:e.setUniform3fv(q,n);break;case 35666:e.setUniform4fv(q,n);break;case 35675:e.setUniformMatrix3fv(q,n);break;case 35676:e.setUniformMatrix4fv(q,n);break;case 5124:1<h.size?e.setUniform1iv(q,n):e.setUniform1i(q,n);break;case 35670:e.setUniform1i(q,
n?1:0);break;case 35667:case 35671:e.setUniform2iv(q,n);break;case 35668:case 35672:e.setUniform3iv(q,n);break;case 35669:case 35673:e.setUniform4iv(q,n)}}})};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define("../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./Programs".split(" "),
function(z,E,D,C,A,m,c,b,d,a){return function(){function e(g){this._cache=Array(8);for(let q=0;8>q;q++)this._cache[q]={};this._programRepo=new c(g)}var f=e.prototype;f.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};f.getProgram=function(g,q,h){const n=this._cache[g];n[q]||(g=this._programRepo.getProgram(this._getProgramTemplate(g),h),n[q]=g);return n[q]};f.getProgramAttributes=function(g){switch(g){case 0:return a.background.attributes;case 5:return a.circle.attributes;
case 1:return a.fill.attributes;case 4:return a.icon.attributes;case 3:return a.line.attributes;case 2:return a.outline.attributes;case 6:return a.text.attributes;default:return null}};f._getProgramTemplate=function(g){switch(g){case 0:return a.background;case 5:return a.circle;case 1:return a.fill;case 4:return a.icon;case 3:return a.line;case 2:return a.outline;case 6:return a.text;default:return null}};return e}()})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define("exports ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/programUtils ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./shaders/BitBlitPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f){E=function(){function g(){this._initialized=!1}var q=g.prototype;q.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};q.render=function(h,n,u,t){h&&(this._initialized||this._initialize(h),h.setBlendFunctionSeparate(1,771,1,771),h.bindVAO(this._vertexArrayObject),h.bindProgram(this._program),n.setSamplingMode(u),h.bindTexture(n,0),this._program.setUniform1i("u_tex",
0),this._program.setUniform1f("u_opacity",t),h.drawArrays(5,0,4),h.bindTexture(null,0),h.bindVAO())};q._initialize=function(h){if(this._initialized)return!0;const n=f.bitBlit.attributes,u=b.createProgram(h,f.bitBlit);if(!u)return!1;const t=new Int8Array(16);t[0]=-1;t[1]=-1;t[2]=0;t[3]=0;t[4]=1;t[5]=-1;t[6]=1;t[7]=0;t[8]=-1;t[9]=1;t[10]=0;t[11]=1;t[12]=1;t[13]=1;t[14]=1;t[15]=1;h=new A(h,n,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,
offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:D.createVertex(h,35044,t)});this._program=u;this._vertexArrayObject=h;return this._initialized=!0};return g}();z.BitBlitRenderer=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["exports","./sources/resolver"],function(z,E){E={name:"bitBlit",shaders:{vertexShader:E.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:E.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,
a_tex:1}};z.bitBlit=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("../../../../core/maybe ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./enums ./shaders/MaterialPrograms".split(" "),function(z,E,D,C,A,m,c,b,d,a,e,f){const g=
n=>n===e.WGLDrawPhase.HITTEST||n===e.WGLDrawPhase.LABEL_ALPHA,q=({rendererInfo:n,drawPhase:u},t,k,v)=>{t=t.getVariationHash();v=v.join(".");u=(g(u)?1:0)|(u===e.WGLDrawPhase.HIGHLIGHT?2:0);return`${t}-${v}-${u}-${n.getVariationHash()}-${z.isSome(k)&&k.join(".")}`},h=(n,u,t,k)=>{k=k.reduce((v,p)=>({...v,[p]:n.driverTestResult[p]}),{});u={...u.getVariation(),...n.rendererInfo.getVariation(),highlight:n.drawPhase===e.WGLDrawPhase.HIGHLIGHT,id:g(n.drawPhase),...k};if(z.isSome(t))for(const v of t)u[v]=
!0;return u};return function(){function n(t){this._programByKey=new Map;this._programCache=new b(t)}var u=n.prototype;u.dispose=function(){this._programCache&&this._programCache.dispose()};u.getProgram=function(t,k,v=[],p=[]){const r=k.vsPath+"."+k.fsPath+JSON.stringify(v)+p.join(".");if(this._programByKey.has(r))return this._programByKey.get(r);p=p.reduce((y,B)=>({...y,[B]:t.driverTestResult[B]}),{});v={...v.map(y=>"string"===typeof y?{name:y,value:!0}:y).reduce((y,B)=>({...y,[B.name]:B.value}),
{}),...p};const {vsPath:w,fsPath:l,attributes:x}=k;k=this._programCache.getProgram(f.createProgramTemplate(w,l,x),v);if(!k)throw Error("Unable to get program for key: ${key}");this._programByKey.set(r,k);return k};u.getMaterialProgram=function(t,k,v,p,r,w=["ignoresSamplerPrecision"]){const l=q(t,k,r,w);if(this._programByKey.has(l))return this._programByKey.get(l);t=h(t,k,r,w);v=this._programCache.getProgram(f.createProgramTemplate(v,v,p),t);if(!v)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(l,v);return v};return n}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),function(z,E,D,C,A,m,
c,b,d,a,e,f){const g=q=>{const h={};for(const u in q){{let t=void 0;var n=u;t=""+n[0].toUpperCase();for(let k=1;k<n.length;k++){const v=n[k];v===v.toUpperCase()?(t+="_",t+=v):t+=v.toUpperCase()}n=t}h[n]=q[u]}return b.glslifyDefineMap(h)};z.createProgramTemplate=(q,h,n)=>{const u=q+q.substring(q.lastIndexOf("/")),t=h+h.substring(h.lastIndexOf("/"));return{name,attributes:n,shaders:k=>({vertexShader:g(k)+f.resolveIncludes(`${u}.vert`),fragmentShader:g(k)+f.resolveIncludes(`${t}.frag`)})}};Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TextureManager":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../config ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../request ../../../../chunks/vec2 ./definitions ../../../../chunks/vec2f32 ./util/BidiText ../../../../symbols/cim/Rasterizer ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v,p,r,w){function l(M){switch(M.type){case "CIMSolidStroke":case "CIMSolidFill":return!0;case "esriSFS":return"esriSFSSolid"===M.style||"esriSFSNull"===M.style;case "esriSLS":return"esriSLSSolid"===M.style||"esriSLSNull"===M.style;default:return!1}}function x(M){switch(M.type){case "esriSMS":case "esriPMS":case "CIMPointSymbol":case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!1;default:return!0}}async function y(M){M=window.URL.createObjectURL(M);
try{const {data:R}=await b(M,{responseType:"image"});window.URL.revokeObjectURL(M);return R}catch(R){return window.URL.revokeObjectURL(M),new A("mapview-invalid-resource",`Could not fetch requested resource at ${M}`)}}async function B(M,R){M=M.imageData?`data:${M.contentType};base64,${M.imageData}`:M.url;var N;if(-1!==M.indexOf(";base64,")){R=M.indexOf(";base64,")+8;R=M.substring(R);R=atob(R);M=new Uint8Array(R.length);for(N=0;N<R.length;N++)M[N]=R.charCodeAt(N);N=M.buffer}else try{const {data:I}=
await b(M,{responseType:"array-buffer",...R});N=I}catch(I){if(!m.isAbortError(I))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${M}`)}return N}function F(M,R){R=Math.round(c.pt2px(R)*window.devicePixelRatio);return Math.min(M,R*(128<=R?2:4))}const G=e.create(),J=C.getLogger("esri.views.2d.engine.webgl.TextureManager");let K=function(){function M(R,N,I){this.mosaicType=R;this.page=N;this.sdf=I}M.fromMosaic=function(R,N){return new M(R,N.page,N.sdf)};return M}();return function(){function M(N){this._invalidFontsMap=
new Map;this._sdfConverter=new t(126);this._bindingInfos=[];this._hashToBindingIndex=new Map;this._rasterizer=new g;this._ongoingRasterizations=new Map;this._spriteMosaic=new k(N,2048,2048,500);this._glyphSource=new u(`${E.fontsUrl}/{fontstack}/{range}.pbf`);this._glyphMosaic=new n(1024,1024,this._glyphSource)}var R=M.prototype;R.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();this._rasterizer.dispose();this._sdfConverter.dispose();this._sdfConverter=this._rasterizer=this._glyphMosaic=
this._spriteMosaic=null;this._hashToBindingIndex.clear();this._bindingInfos=this._hashToBindingIndex=null;this._ongoingRasterizations.clear();this._ongoingRasterizations=null};R.rasterizeItem=async function(N,I,H,Q){if(D.isNone(N))return J.error(new A("mapview-null-resource","Unable to rasterize null resource",void 0)),null;switch(N.type){case "CIMTextSymbol":case "esriTS":return N=await this._rasterizeText(N,H,Q),N.forEach(W=>this._setTextureBinding(q.MosaicType.GLYPH,W)),{glyphMosaicItems:N};default:if(N.type&&
-1!==N.type.toLowerCase().indexOf("3d"))return J.error(new A("mapview-invalid-type",`MapView does not support symbol type: ${N.type}`,N)),null;N=await this._rasterizeSpriteSymbol(N,I,Q);r.ok(N)&&N&&this._setTextureBinding(q.MosaicType.SPRITE,N);return{spriteMosaicItem:N}}};R.bindTextures=function(N,I,H,Q=!1){if(0!==H.textureBinding){var W=this._bindingInfos[H.textureBinding-1];H=W.page;Q=Q?9987:9729;switch(W.mosaicType){case q.MosaicType.SPRITE:{W=this.sprites.getWidth(H);const aa=this.sprites.getHeight(H);
W=d.set(G,W,aa);this._spriteMosaic.bind(N,Q,H,a.TEXTURE_BINDING_SPRITE_ATLAS);I.setUniform1i("u_texture",a.TEXTURE_BINDING_SPRITE_ATLAS);I.setUniform2fv("u_mosaicSize",W);break}case q.MosaicType.GLYPH:W=d.set(G,this.glyphs.width,this.glyphs.height);this._glyphMosaic.bind(N,Q,H,a.TEXTURE_BINDING_GLYPH_ATLAS);I.setUniform1i("u_texture",a.TEXTURE_BINDING_GLYPH_ATLAS);I.setUniform2fv("u_mosaicSize",W);break;default:J.error("mapview-texture-manager",`Cannot handle unknown type ${W.mosaicType}`)}}};R._hashMosaic=
function(N,I){return 1|N<<1|(I.sdf?1:0)<<2|I.page<<3};R._setTextureBinding=function(N,I){const H=this._hashMosaic(N,I);this._hashToBindingIndex.has(H)||(N=K.fromMosaic(N,I),this._hashToBindingIndex.set(H,this._bindingInfos.length+1),this._bindingInfos.push(N));I.textureBinding=this._hashToBindingIndex.get(H)};R._rasterizeText=async function(N,I,H){const Q=h.getFullyQualifiedFontName(N.font),W=this._invalidFontsMap.has(Q);if(I)N=I;else{N=f.bidiText(N.text)[0];I=[];for(let aa=0;aa<N.length;aa++)I.push(N.charCodeAt(aa));
N=I}try{return await this._glyphMosaic.getGlyphItems(W?"arial-unicode-ms-regular":Q,N,H)}catch(aa){return J.error(new A("mapview-invalid-resource",`Couldn't find font ${Q}. Falling back to Arial Unicode MS Regular`,void 0)),this._invalidFontsMap.set(Q,!0),this._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",N,H)}};R._rasterizeSpriteSymbol=async function(N,I,H){if(l(N))return null;const Q=w.keyFromSymbol(N);if(this._spriteMosaic.has(Q))return this._spriteMosaic.getSpriteItem(Q);if("esriSMS"===
N.type&&N.path||N.url||N.imageData)return this._handleAsyncResource(Q,N,H);if(I=this._rasterizer.rasterizeJSONResource(N,I)){const {size:W,image:aa,sdf:da,simplePattern:S}=I;return this._addItemToMosaic(Q,W,{type:"static",data:aa},x(N),da,S)}return new A("TextureManager","unrecognized or null rasterized image")};R._handleAsyncResource=async function(N,I,H){if(this._ongoingRasterizations.has(N))return this._ongoingRasterizations.get(N);I="esriSMS"===I.type&&I.path?this._handleSVG(I,N,H):this._handleImage(I,
N,H);this._ongoingRasterizations.set(N,I);try{await I,this._ongoingRasterizations.delete(N)}catch{this._ongoingRasterizations.delete(N)}return I};R._handleSVG=async function(N,I,H){N=await this._sdfConverter.draw(N.path,H);return this._addItemToMosaic(I,[126,126],{type:"static",data:new Uint32Array(N.buffer)},!1,!0,!0)};R._handleGIFOrPNG=async function(N,I,H){var Q=await B(N,H);if(r.ok(Q)){var W=p.isGIF(Q);const aa=v.isPNG(Q);if(!W&&!aa)return new A("mapview-invalid-resource","Image data is neither GIF nor PNG!");
let da;try{W&&p.isAnimatedGIF(Q)?da=await p["default"].create(Q,H):aa&&v.isAnimatedPNG(Q)&&(da=await v["default"].create(Q,H))}catch(S){if(!m.isAbortError(S))return new A("mapview-invalid-resource","Could not fetch requested resource!")}if(da&&r.ok(da))return this._addItemToMosaic(I,[da.width,da.height],{type:"animated",data:da},x(N),!1,!1);H=new Blob([Q],{type:W?"image/gif":"image/png"});if((H=await y(H))&&H instanceof HTMLImageElement){Q=H.width;W=H.height;"esriPMS"===N.type&&(Q=Math.round(F(H.width,
N.width)),W=Math.round(Q/H.width*H.height));const {size:S,sdf:U,image:X}=this._rasterizer.rasterizeImageResource(Q,W,H,N.colorSubstitutions);return this._addItemToMosaic(I,S,{type:"static",data:X},x(N),U,!1)}}return new A("mapview-invalid-resource","Could not handle resource!")};R._handleImage=async function(N,I,H){var Q;(Q=N.url&&-1!==N.url.indexOf(".gif")||N.contentType&&"image/gif"===N.contentType||N.imageData&&-1!==N.imageData.indexOf("data:image/gif"))||(Q=N.url&&-1!==N.url.indexOf(".png")||
N.contentType&&"image/png"===N.contentType||N.imageData&&-1!==N.imageData.indexOf("data:image/png"));if(Q)return this._handleGIFOrPNG(N,I,H);Q=N.imageData?`data:${N.contentType};base64,${N.imageData}`:N.url;try{const {data:W}=await b(Q,{responseType:"image",...H});-1!==Q.indexOf("data:image/svg+xml")&&(W.width=c.pt2px(N.width),W.height=c.pt2px(N.height));let aa=W.width,da=W.height;"esriPMS"===N.type&&(aa=Math.round(F(W.width,N.width)),da=Math.round(aa/W.width*W.height));const {size:S,sdf:U,image:X}=
this._rasterizer.rasterizeImageResource(aa,da,W,N.colorSubstitutions);return this._addItemToMosaic(I,S,{type:"static",data:X},x(N),U,!1)}catch(W){if(!m.isAbortError(W))return new A("mapview-invalid-resource",`Could not fetch requested resource at ${Q}`)}};R._addItemToMosaic=function(N,I,H,Q,W,aa){return this._spriteMosaic.addSpriteItem(N,I,H,Q,W,aa)};z._createClass(M,[{key:"sprites",get:function(){return this._spriteMosaic}},{key:"glyphs",get:function(){return this._glyphMosaic}}]);return M}()})},
"esri/views/2d/engine/webgl/util/BidiText":function(){define(["exports","../../../../../core/BidiEngine"],function(z,E){const D=new E;z.bidiText=function(C){if(!D.hasBidiChar(C))return[C,!1];let A;A="rtl"===D.checkContextual(C)?"IDNNN":"ICNNN";return[D.bidiTransform(C,A,"VLYSN"),!0]};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/BidiEngine":function(){define(["./bidiEngineTables"],function(z){function E(r,w,l,x,y){var B=r;void 0===w&&(w=y.defInFormat);void 0===l&&(l=y.defOutFormat);
void 0===x&&(x=y.defSwap);if(w!==l){var F=w.substring(0,1),G=l.substring(0,1);var J=w.substring(1,4);var K=l.substring(1,4);"C"===J.charAt(0)&&(J=D(B),J="ltr"===J||"rtl"===J?J.toUpperCase():"L"===w.charAt(2)?"LTR":"RTL",w=F+J);"C"===K.charAt(0)&&(J=D(B),"rtl"===J?K="RTL":"ltr"===J?(B=B.split(""),B.reverse(),J=D(B.join("")),K=J.toUpperCase()):K="L"===l.charAt(2)?"LTR":"RTL",l=G+K)}if(w===l)return r;G=w.substring(0,1);B=w.substring(1,4);F=l.substring(0,1);K=l.substring(1,4);y.inFormat=w;y.outFormat=
l;y.swap=x;if("L"===G&&"VLTR"===l){if("LTR"===B)return y.dir=0,C(r,y);if("RTL"===B)return y.dir=1,C(r,y)}if("V"===G&&"V"===F)return y.dir="RTL"===B?1:0,m(r,y);if("L"===G&&"VRTL"===l)return y.dir="LTR"===B?0:1,r=C(r,y),m(r);if("VLTR"===w&&"LLTR"===l)return y.dir=0,C(r,y);if("V"===G&&"L"===F&&B!==K)return r=m(r),"RTL"===B?E(r,"LLTR","VLTR",x,y):E(r,"LRTL","VRTL",x,y);if("VRTL"===w&&"LRTL"===l)return E(r,"LRTL","VRTL",x,y);"L"===G&&"L"===F&&(w=y.swap,y.swap=w.substr(0,1)+"N","RTL"===B?(y.dir=1,r=C(r,
y),y.swap="N"+w.substr(1,2),y.dir=0,r=C(r,y)):(y.dir=0,r=C(r,y),y.swap="N"+w.substr(1,2),r=E(r,"VLTR","LRTL",y.swap,y)));return r}function D(r){return(r=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(r))?"z">=r[0]?"ltr":"rtl":""}function C(r,w){r=r.split("");const l=[];A(r,l,w);if(0!==w.hiLevel&&w.swap.substr(0,1)!==w.swap.substr(1,2))for(let B=0;B<r.length;B++)if(1===l[B]){var x=B;b:{let F=void 0;var y=r[B];let G=0,J=z.SwapTable.length-1;for(;G<=J;)if(F=Math.floor((G+
J)/2),y<z.SwapTable[F][0])J=F-1;else if(y>z.SwapTable[F][0])G=F+1;else{y=z.SwapTable[F][1];break b}}r[x]=y}d(2,r,l,w);d(1,r,l,w);t=l;return r.join("")}function A(r,w,l){const x=r.length;var y=l.dir?z.impTabRtl:z.impTabLtr,B=0,F=-1;const G=[],J=[];l.hiLevel=l.dir;l.lastArabic=!1;l.hasUbatAl=!1;l.hasUbatB=!1;l.hasUbatS=!1;for(var K=0;K<x;K++){var M=K;{var R=r[K].charCodeAt(0);const N=z.PrimaryTable[R>>8];R=N<z.TBBASE?N:z.UnicodeTable[N-z.TBBASE][R&255]}G[M]=R}for(M=0;M<x;M++){K=a(r,G,J,M,l);J[M]=K;
B=y[B][K];R=B&240;B&=15;K=y[B][5];w[M]=K;if(0<R){if(16===R)for(;F<M;F++)w[F]=1;F=-1}if(y[B][6])-1===F&&(F=M);else if(-1<F){for(;F<M;F++)w[F]=K;F=-1}G[M]===z.UBAT_B&&(w[M]=0);l.hiLevel|=K}if(l.hasUbatS)for(r=0;r<x;r++)if(G[r]===z.UBAT_S)for(w[r]=l.dir,y=r-1;0<=y;y--)if(G[y]===z.UBAT_WS)w[y]=l.dir;else break}function m(r,w){r=r.split("");if(w){const l=[];A(r,l,w);t=l}r.reverse();n.reverse();return r.join("")}function c(r){for(let w=0;w<z.ArabicAlefBetIntervalsBegine.length;w++)if(r>=z.ArabicAlefBetIntervalsBegine[w]&&
r<=z.ArabicAlefBetIntervalsEnd[w])return!0;return!1}function b(r,w,l,x){for(;w*l<x&&f(r[w]);)w+=l;return w*l<x&&c(r[w])?!0:!1}function d(r,w,l,x){if(!(x.hiLevel<r))if(1!==r||1!==x.dir||x.hasUbatB){x=w.length;for(var y=0,B,F,G;y<x;){if(l[y]>=r){for(B=y+1;B<x&&l[B]>=r;)B++;for(F=B-1;y<F;y++,F--)G=w[y],w[y]=w[F],w[F]=G,G=n[y],n[y]=n[F],n[F]=G;y=B}y++}}else w.reverse(),n.reverse()}function a(r,w,l,x,y){return{UBAT_L:()=>{y.lastArabic=!1;return z.UBAT_L},UBAT_R:()=>{y.lastArabic=!1;return z.UBAT_R},UBAT_ON:()=>
z.UBAT_ON,UBAT_AN:()=>z.UBAT_AN,UBAT_EN:()=>y.lastArabic?z.UBAT_AN:z.UBAT_EN,UBAT_AL:()=>{y.lastArabic=!0;y.hasUbatAl=!0;return z.UBAT_R},UBAT_WS:()=>z.UBAT_ON,UBAT_CS:()=>{let B,F;if(1>x||x+1>=w.length||(B=l[x-1])!==z.UBAT_EN&&B!==z.UBAT_AN||(F=w[x+1])!==z.UBAT_EN&&F!==z.UBAT_AN)return z.UBAT_ON;y.lastArabic&&(F=z.UBAT_AN);return F===B?F:z.UBAT_ON},UBAT_ES:()=>(0<x?l[x-1]:z.UBAT_B)===z.UBAT_EN&&x+1<w.length&&w[x+1]===z.UBAT_EN?z.UBAT_EN:z.UBAT_ON,UBAT_ET:()=>{if(0<x&&l[x-1]===z.UBAT_EN)return z.UBAT_EN;
if(y.lastArabic)return z.UBAT_ON;let B=x+1;const F=w.length;for(;B<F&&w[B]===z.UBAT_ET;)B++;return B<F&&w[B]===z.UBAT_EN?z.UBAT_EN:z.UBAT_ON},UBAT_NSM:()=>{if("VLTR"===y.inFormat){for(var B=w.length,F=x+1;F<B&&w[F]===z.UBAT_NSM;)F++;if(F<B&&(B=r[x].charCodeAt[0],F=w[F],(1425<=B&&2303>=B||64286===B)&&(F===z.UBAT_R||F===z.UBAT_AL)))return z.UBAT_R}return 1>x||w[x-1]===z.UBAT_B?z.UBAT_ON:l[x-1]},UBAT_B:()=>{y.lastArabic=!0;y.hasUbatB=!0;return y.dir},UBAT_S:()=>{y.hasUbatS=!0;return z.UBAT_ON},UBAT_LRE:()=>
{y.lastArabic=!1;return z.UBAT_ON},UBAT_RLE:()=>{y.lastArabic=!1;return z.UBAT_ON},UBAT_LRO:()=>{y.lastArabic=!1;return z.UBAT_ON},UBAT_RLO:()=>{y.lastArabic=!1;return z.UBAT_ON},UBAT_PDF:()=>{y.lastArabic=!1;return z.UBAT_ON},UBAT_BN:()=>z.UBAT_ON}[z.TYPES_NAMES[w[x]]]()}function e(r,w){for(let l=0;l<z.BaseForm.length;l++)if(r===z.BaseForm[l])return w[l];return r}function f(r){return"\u064b"<=r&&"\u0655">=r?!0:!1}function g(r){return"L"===r?"LTR":"R"===r?"RTL":"C"===r?"CLR":"D"===r?"CRL":""}function q(r,
w){for(let l=0;l<z.AlefTable.length;l++)if(r===z.AlefTable[l])return w[l];return r}function h(r,w,l,x){for(let y=0;y<r.length;y++)if(r[y]>w||!l&&r[y]===w)r[y]+=x}let n=[],u=[],t=[];const k={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},v=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,p=/[\u0591-\u06ff\ufb1d-\ufefc]/;return function(){function r(){this.inputFormat="ILYNN";
this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}var w=r.prototype;w.bidiTransform=function(l,x,y){this.sourceToTarget=[];this.targetToSource=[];if(!l)return"";var B=this.sourceToTarget,F=this.targetToSource,G=l.length;n=[];t=[];for(var J=0;J<G;J++)B[J]=J,F[J]=J,n[J]=J;if(!this.checkParameters(x,y))return l;x=this.inputFormat;y=this.outputFormat;B=l;G=g(x.charAt(1));B=g(y.charAt(1));J="I"===x.charAt(0)?"L":x.charAt(0);F="I"===y.charAt(0)?"L":y.charAt(0);G=J+G;
B=F+B;F=x.charAt(2)+y.charAt(2);k.defInFormat=G;k.defOutFormat=B;k.defSwap=F;l=E(l,G,B,F,k);B=!1;if("R"===y.charAt(1))B=!0;else if("C"===y.charAt(1)||"D"===y.charAt(1))B="rtl"===this.checkContextual(l);F=this.sourceToTarget=n;G=Array(F.length);for(J=0;J<F.length;J++)G[F[J]]=J;u=this.targetToSource=F=G;if(x.charAt(3)===y.charAt(3))B=l;else if("S"===y.charAt(3))if(x=B,y=!0,0===l.length)B="";else{void 0===x&&(x=!0);void 0===y&&(y=!0);l=String(l);l=l.split("");G=0;B=1;F=l.length;x||(G=l.length-1,B=-1,
F=1);var K=G;G=y;var M=0;J=[];for(var R=0;K*B<F;K+=B)if(c(l[K])||f(l[K])){var N;if(N="\u0644"===l[K])b:{for(var I=l,H=K+B,Q=B,W=F;H*Q<W&&f(I[H]);)H+=Q;N=" ";if(H*Q<W)for(N=I[H],I=0;I<z.AlefTable.length;I++)if(z.AlefTable[I]===N){N=!0;break b}N=!1}if(N){l[K]=0===M?q(l[K+B],z.LamAlefInialTableFE):q(l[K+B],z.LamAlefMedialTableFE);K+=B;M=l;N=K;I=B;for(H=F;N*I<H&&f(M[N]);)N+=I;N*I<H&&(M[N]=" ");G&&(J[R]=K,R++);M=0}else{N=l[K];if(1===M){I=K;if(b(l,K+B,B,F))b:for(H=l[K],Q=0;Q<z.BaseForm.length;Q++){if(H===
z.BaseForm[Q]){H=z.MedialForm[Q];break b}}else H=e(l[K],z.FinalForm);l[I]=H}else!0===b(l,K+B,B,F)?l[K]=e(l[K],z.InitialForm):l[K]=e(l[K],z.IsolatedForm);f(N)||(M=1);b:{for(I=0;I<z.StandAlonForm.length;I++)if(z.StandAlonForm[I]===N){N=!0;break b}N=!1}!0===N&&(M=0)}}else M=0;B=J;F="";for(G=0;G<l.length;G++){if(J=y){b:{for(J=0;J<B.length;J++)if(B[J]===G)break b;J=-1}J=-1<J}J?(h(u,G,!x,-1),n.splice(G,1)):F+=l[G]}B=F}else if(x=l,y=B,l=!0,0===x.length)B="";else for(void 0===l&&(l=!0),void 0===y&&(y=!0),
x=String(x),B="",F=x.split(""),G=0;G<x.length;G++)J=!1,"\ufe70"<=F[G]&&"\ufeff">F[G]?(R=x.charCodeAt(G),"\ufef5"<=F[G]&&"\ufefc">=F[G]?(y?(0<G&&l&&" "===F[G-1]?B=B.substring(0,B.length-1)+"\u0644":(B+="\u0644",J=!0),B+=z.AlefTable[(R-65269)/2]):(B+=z.AlefTable[(R-65269)/2],B+="\u0644",G+1<x.length&&l&&" "===F[G+1]?G++:J=!0),J&&(h(u,G,!0,1),n.splice(G,0,n[G]))):B+=z.FETo06Table[R-65136]):B+=F[G];this.sourceToTarget=n;this.targetToSource=u;this.levels=t;return B};w._inputFormatSetter=function(l){if(!v.test(l))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");
this.inputFormat=l};w._outputFormatSetter=function(l){if(!v.test(l))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=l};w.checkParameters=function(l,x){l?this._inputFormatSetter(l):l=this.inputFormat;x?this._outputFormatSetter(x):x=this.outputFormat;return l===x?!1:!0};w.checkContextual=function(l){l=D(l);if("ltr"!==l&&"rtl"!==l){try{l=document.dir.toLowerCase()}catch(x){}"ltr"!==l&&"rtl"!==l&&(l="ltr")}return l};w.hasBidiChar=function(l){return p.test(l)};
return r}()})},"esri/core/bidiEngineTables":function(){define(["exports"],function(z){z.AlefTable=["\u0622","\u0623","\u0625","\u0627"];z.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];z.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];z.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
z.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
z.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");z.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
z.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");z.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];z.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];z.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");
z.PrimaryTable=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107];z.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");z.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59",
"\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];z.TBBASE=100;z.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");z.UBAT_AL=7;z.UBAT_AN=3;z.UBAT_B=5;z.UBAT_BN=18;z.UBAT_CS=9;z.UBAT_EN=2;z.UBAT_ES=10;z.UBAT_ET=11;z.UBAT_L=0;z.UBAT_LRE=13;z.UBAT_LRO=16;z.UBAT_NSM=12;z.UBAT_ON=
4;z.UBAT_PDF=15;z.UBAT_R=1;z.UBAT_RLE=14;z.UBAT_RLO=17;z.UBAT_S=6;z.UBAT_WS=8;z.UnicodeTable=[[18,18,18,18,18,18,18,18,18,6,5,6,8,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,5,5,5,6,8,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,18,18,18,18,18,18,5,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,9,4,11,11,11,11,4,4,4,4,0,
4,4,18,4,4,11,11,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,12,1,12,12,1,12,12,1,12,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,11,11,7,9,7,4,4,12,12,12,12,12,12,12,12,12,12,12,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,3,3,3,3,3,3,3,3,3,3,11,3,3,7,7,7,12,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,3,4,12,12,12,12,12,12,7,7,12,12,4,12,12,12,12,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,12,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,7,7,7,7,7,7,
7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,12,12,12,12,12,12,12,12,12,12,12,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,12,12,12,12,12,12,12,12,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,18,18,18,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,11,11,11,11,11,4,4,4,4,4,4,4,
4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,18,18,18,18,18,4,4,4,4,4,18,18,18,18,18,18,2,0,4,4,2,2,2,2,2,2,10,10,4,4,4,0,2,2,2,2,2,2,2,2,2,2,10,10,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,
4,4,0,0,0,0,0,4,4,4,4,4,1,12,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[12,12,12,12,12,12,12,
12,12,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,12,12,12,12,12,12,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,11,4,4,10,10,4,4,4,4,4,11,11,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
7,7,7,7,7,7,4,4,18],[4,4,4,11,11,11,4,4,4,4,4,10,9,10,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,11,11,4,4,4,11,11,4,4,4,4,4,
4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];z.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];z.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/Rasterizer":function(){define(["./utils","./Rect","./CIMSymbolHelper","./SDFHelper"],function(z,E,D,C){return function(){function A(){}var m=A.prototype;m.dispose=function(){this._rasterizationCanvas=
null};m.rasterizeJSONResource=function(c,b,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===c.type||"esriSFS"===c.type){const [u,t,k]=D.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,c.style,b);return{size:[t,k],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0}}if("simple-line"===c.type||"esriSLS"===c.type){const [u,t,k]=D.SymbolHelper.rasterizeSimpleLine(c.style,c.cap);return{size:[t,k],image:new Uint32Array(u.buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let a,e;"simple-marker"===c.type||"esriSMS"===c.type||"line-marker"===c.type?(c=D.CIMSymbolHelper.fromSimpleMarker(c),e=C.getSDFInfo(c)):"CIMHatchFill"===c.type?(c=D.CIMSymbolHelper.fromCIMHatchFill(c),a=new E(c.frame.xmin,-c.frame.ymax,c.frame.xmax-c.frame.xmin,c.frame.ymax-c.frame.ymin)):c.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===c.markerPlacement.type?(c=D.CIMSymbolHelper.fromCIMInsidePolygon(c),a=new E(c.frame.xmin,-c.frame.ymax,c.frame.xmax-
c.frame.xmin,c.frame.ymax-c.frame.ymin)):e=C.getSDFInfo(c);if(e&&!d){const [u,t,k]=C.buildSDF(e);return u?{size:[t,k],image:new Uint32Array(u.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null}const [f,g,q,h,n]=D.CIMSymbolHelper.rasterize(this._rasterizationCanvas,c,a,!d);return f?{size:[g,q],image:new Uint32Array(f.buffer),sdf:!1,simplePattern:!1,anchorX:h,anchorY:n}:null};m.rasterizeImageResource=function(c,b,d,a){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));
this._rasterizationCanvas.width=c;this._rasterizationCanvas.height=b;var e=this._rasterizationCanvas.getContext("2d");d instanceof ImageData?e.putImageData(d,0,0):(d.setAttribute("width",`${c}px`),d.setAttribute("height",`${b}px`),e.drawImage(d,0,0,c,b));d=e.getImageData(0,0,c,b);d=new Uint8Array(d.data);if(a)for(var f of a)if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){const [g,q,h,n]=f.oldColor,[u,t,k,v]=f.newColor;if(g!==u||q!==t||h!==k||n!==v)for(a=0;a<d.length;a+=
4)g===d[a]&&q===d[a+1]&&h===d[a+2]&&n===d[a+3]&&(d[a]=u,d[a+1]=t,d[a+2]=k,d[a+3]=v)}for(a=0;a<d.length;a+=4)f=d[a+3]/255,d[a]*=f,d[a+1]*=f,d[a+2]*=f;e=d;f=c;a=b;if(512<=f||512<=a){e=f/a;1<e?(f=512,a=Math.round(512/e)):(a=512,f=Math.round(512*e));e=new Uint8Array(4*f*a);const g=new Uint8ClampedArray(e.buffer);z.resampleHermite(d,c,b,g,f,a,!1)}return{size:[c,b],image:new Uint32Array(e.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return A}()})},"esri/symbols/cim/utils":function(){define(["exports"],
function(z){function E(D,C){"string"!==typeof D&&(D=String(D));switch(C){case "LowerCase":return D.toLowerCase();case "Allcaps":return D.toUpperCase();default:return D}}z._adjustTextCase=E;z.colorToArray=function(D){return[D.r,D.g,D.b,D.a]};z.createLabelOverrideFunction=function(D,C,A){const m=a=>{let e=a.length;for(;e--;)if(-1===" /-,\n".indexOf(a.charAt(e)))return!1;return!0},c=[];var b=0;let d=-1;do d=C.indexOf("[",b),d>=b&&(d>b&&(b=C.substr(b,d-b),c.push([b,null,m(b)])),b=d+1,d=C.indexOf("]",
b),d>=b&&(d>b&&(b=C.substr(b,d-b),(b=D[b])&&c.push([null,b,!1])),b=d+1));while(-1!==d);b<C.length-1&&(D=C.substr(b),c.push([D,null,m(D)]));return a=>{let e="",f=null;for(const g of c){const [q,h,n]=g;if(q)n?f=q:(f&&(e+=f,f=null),e+=q);else{const u=a.attributes[h];u&&(f&&(e+=f,f=null),e+=u)}}return E(e,A)}};z.evaluateValueOrFunction=function(D,C,A,m){return"function"===typeof D?D(C,A,m):D};z.fromCIMColor=function(D){return D?{r:D[0],g:D[1],b:D[2],a:D[3]/255}:{r:0,g:0,b:0,a:0}};z.isCIMFill=function(D){return"CIMGradientFill"===
D.type||"CIMHatchFill"===D.type||"CIMPictureFill"===D.type||"CIMSolidFill"===D.type||"CIMWaterFill"===D.type};z.isCIMMarker=function(D){return"CIMVectorMarker"===D.type||"CIMPictureMarker"===D.type||"CIMBarChartMarker"===D.type||"CIMCharacterMarker"===D.type||"CIMPieChartMarker"===D.type||"CIMStackedBarChartMarker"===D.type};z.isCIMMarkerStrokePlacement=function(D){return"CIMMarkerPlacementAlongLineRandomSize"===D.type||"CIMMarkerPlacementAlongLineSameSize"===D.type||"CIMMarkerPlacementAlongLineVariableSize"===
D.type||"CIMMarkerPlacementAtExtremities"===D.type||"CIMMarkerPlacementAtMeasuredUnits"===D.type||"CIMMarkerPlacementAtRatioPositions"===D.type||"CIMMarkerPlacementOnLine"===D.type||"CIMMarkerPlacementOnVertices"===D.type};z.isCIMStroke=function(D){return"CIMGradientStroke"===D.type||"CIMPictureStroke"===D.type||"CIMSolidStroke"===D.type};z.resampleHermite=function(D,C,A,m,c,b,d=!0){const a=C/c;A/=b;const e=Math.ceil(a/2),f=Math.ceil(A/2);for(let h=0;h<b;h++)for(let n=0;n<c;n++){const u=4*(n+(d?b-
h-1:h)*c);var g=0;let t=0,k=0,v=0,p=0,r=0,w=0;const l=(h+.5)*A;for(let x=Math.floor(h*A);x<(h+1)*A;x++){var q=Math.abs(l-(x+.5))/f;const y=(n+.5)*a;q*=q;for(let B=Math.floor(n*a);B<(n+1)*a;B++){let F=Math.abs(y-(B+.5))/e;g=Math.sqrt(q+F*F);-1<=g&&1>=g&&(g=2*g*g*g-3*g*g+1,0<g&&(F=4*(B+x*C),w+=g*D[F+3],k+=g,255>D[F+3]&&(g=g*D[F+3]/250),v+=g*D[F],p+=g*D[F+1],r+=g*D[F+2],t+=g))}}m[u]=v/t;m[u+1]=p/t;m[u+2]=r/t;m[u+3]=w/k}};z.toCIMSymbolJSON=function(D){var C;return null==(C=D.data)?void 0:C.symbol};Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/symbols/cim/Rect":function(){define(["../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function E(D=0,C=0,A=0,m=0){this.x=D;this.y=C;this.width=A;this.height=m}E.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};z._createClass(E,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return E}()})},"esri/symbols/cim/CIMSymbolHelper":function(){define("exports ../../core/Logger ../../core/mathUtils ../../Color ./CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),
function(z,E,D,C,A,m,c){function b(q,h){switch(h.type){case "CIMSymbolReference":q.drawSymbol(h.symbol,{type:"point",x:0,y:0});break;case "CIMPointSymbol":q.drawSymbol(h,{type:"point",x:0,y:0});break;case "CIMVectorMarker":{const n=new A.Placement;q.drawMarker(h,n)}}return q.envelope()}const d=Math.PI,a=d/2,e=E.getLogger("esri.symbols.cim.CIMSymbolHelper");E=function(){function q(){}q.getEnvelope=function(h){const n=new m.EnvDrawHelper;if(Array.isArray(h)){let u;for(const t of h)u?u.union(b(n,t)):
u=b(n,t);return u}return b(n,h)};q.getTextureAnchor=function(h){h=this.getEnvelope(h);if(!h||0>=h.width||0>=h.height)return[0,0,0];const n=96/72,u=h.height*n+2;return[(h.x+.5*h.width)*n/(h.width*n+2),-(h.y+.5*h.height)*n/u,u]};q.rasterize=function(h,n,u,t=!0){var k=u||this.getEnvelope(n);if(!k||0>=k.width||0>=k.height)return[null,0,0,0,0];var v=96/72;const p=(k.x+.5*k.width)*v,r=(k.y+.5*k.height)*v;h.width=k.width*v;h.height=k.height*v;u||(h.width+=2,h.height+=2);u=h.getContext("2d");v=m.Transformation.createScale(v,
-v);v.translate(.5*h.width-p,.5*h.height+r);v=new m.CanvasDrawHelper(u,v);switch(n.type){case "CIMPointSymbol":v.drawSymbol(n,{type:"point",x:0,y:0});break;case "CIMVectorMarker":k=new A.Placement,v.drawMarker(n,k)}n=u.getImageData(0,0,h.width,h.height);n=new Uint8Array(n.data);if(t)for(u=0;u<n.length;u+=4)t=n[u+3]/255,n[u]*=t,n[u+1]*=t,n[u+2]*=t;return[n,h.width,h.height,-p/h.width,-r/h.height]};q.fromSimpleMarker=function(h){var n=h.style;if("circle"===n||"esriSMSCircle"===n){var u=Math.acos(.995);
var t=Math.ceil(d/u/4);0===t&&(t=1);u=a/t;t*=4;n=[];n.push([50,0]);for(let v=1;v<t;v++)n.push([50*Math.cos(v*u),-50*Math.sin(v*u)]);n.push([50,0]);u={rings:[n]};t={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===n||"esriSMSCross"===n)u={rings:[[[0,50],[0,0],[50,0],[50,-0],[0,-0],[0,-50],[-0,-50],[-0,-0],[-50,-0],[-50,0],[-0,0],[-0,50],[0,50]]]},t={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===n||"esriSMSDiamond"===n)u={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},t={xmin:-50,ymin:-50,
xmax:50,ymax:50};else if("square"===n||"esriSMSSquare"===n)u={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},t={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===n||"esriSMSX"===n)u={rings:[[[0,0],[50,50],[50,50],[0,0],[50,-50],[50,-50],[0,-0],[-50,-50],[-50,-50],[-0,0],[-50,50],[-50,50],[0,0]]]},t={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===n||"esriSMSTriangle"===n)t=2/3*100,n=t-100,u={rings:[[[-57.735026918962575,n],[0,t],[57.735026918962575,n],[-57.735026918962575,n]]]},t=
{xmin:-57.735026918962575,ymin:n,xmax:57.735026918962575,ymax:t};else if("arrow"===n||"esriSMSArrow"===n)u={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},t={xmin:-50,ymin:-50,xmax:50,ymax:50};if(u&&t){var k=[{type:"CIMSolidFill",enable:!0,color:h.color}];h.outline&&k.push({type:"CIMSolidStroke",enable:!0,width:h.outline.width,color:h.outline.color});k={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:h.angle,size:h.size,offsetX:h.xoffset,offsetY:h.yoffset,
frame:t,markerGraphics:[{type:"CIMMarkerGraphic",geometry:u,symbol:{type:"CIMPolygonSymbol",symbolLayers:k}}]}]}}return k};q.fromCIMHatchFill=function(h){const n=void 0!==h.separation?h.separation:4,u=n/2;for(var t=this._getLineSymbolPeriod(h.lineSymbol)||4;4>t;)t*=2;t/=2;return{type:"CIMVectorMarker",frame:{xmin:-t,xmax:t,ymin:-u,ymax:u},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-t,0],[t,0]]]},symbol:h.lineSymbol}],size:n}};q._getLineSymbolPeriod=function(h){if(h){const n=this._getEffectsRepeat(h.effects);
if(n)return n;if(h.symbolLayers)for(const u of h.symbolLayers)if((h=this._getEffectsRepeat(u.effects))||u&&(h=this._getPlacementRepeat(u.markerPlacement)))return h}return 0};q._getEffectsRepeat=function(h){if(h)for(var n of h)if(n)switch(n.type){case "CIMGeometricEffectDashes":if((h=n.dashTemplate)&&h.length){n=0;for(const u of h)n+=u;h.length&1&&(n*=2);return n}break;case "CIMGeometricEffectWave":return n.period;default:e.error(`unsupported geometric effect type ${n.type}`)}return 0};q._getPlacementRepeat=
function(h){if(h)switch(h.type){case "CIMMarkerPlacementAlongLineSameSize":case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineVariableSize":if((h=h.placementTemplate)&&h.length){let n=0;for(const u of h)n+=u;h.length&1&&(n*=2);return n}}return 0};q.fromCIMInsidePolygon=function(h){const n=h.markerPlacement,u=n.stepX/2,t=n.stepY/2;return{type:"CIMVectorMarker",frame:{xmin:-u,xmax:u,ymin:-t,ymax:t},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMPointSymbol",
symbolLayers:[{type:h.type,...h,markerPlacement:null,anchorPoint:null}]}}],size:n.stepY}};q.getFillColor=function(h){if(!h)return null;switch(h.type){case "CIMPolygonSymbol":if(h.symbolLayers)for(const n of h.symbolLayers)if(h=q.getFillColor(n),null!=h)return h;break;case "CIMTextSymbol":return q.getFillColor(h.symbol);case "CIMSolidFill":return h.color}};q.getStrokeColor=function(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const n of h.symbolLayers)if(h=
q.getStrokeColor(n),void 0!==h)return h;break;case "CIMTextSymbol":return q.getStrokeColor(h.symbol);case "CIMSolidStroke":return h.color}};q.getStrokeWidth=function(h){if(h)switch(h.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(h.symbolLayers)for(const n of h.symbolLayers)if(h=q.getStrokeWidth(n),void 0!==h)return h;break;case "CIMTextSymbol":return q.getStrokeWidth(h.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return h.width}};q.getSize=function(h){if(h)switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":{let n=
0;if(h.symbolLayers)for(const u of h.symbolLayers)h=q.getSize(u),h>n&&(n=h);return n}case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return h.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return h.size}};q.getMarkerScaleRatio=function(h){if(h)switch(h.type){case "CIMVectorMarker":if(!1!==h.scaleSymbolsProportionally&&h.frame)return h.size/(h.frame.ymax-h.frame.ymin)}return 1};return q}();let f=function(){function q(){}q.rasterizeSimpleFill=function(h,
n,u){"solid"!==n&&"none"!==n&&"esriSFSSolid"!==n&&"esriSFSNull"!==n||console.error("Unexpected: style does not require rasterization");u=D.nextPowerOfTwo(Math.ceil(u));var t=this._isHorizontalOrVertical(n)?8*u:16*u;const k=2*u;h.width=t;h.height=t;const v=h.getContext("2d");v.strokeStyle="#FFFFFF";v.lineWidth=u;v.beginPath();if("vertical"===n||"cross"===n||"esriSFSCross"===n||"esriSFSVertical"===n)v.moveTo(t/2,-k),v.lineTo(t/2,t+k);if("horizontal"===n||"cross"===n||"esriSFSCross"===n||"esriSFSHorizontal"===
n)v.moveTo(-k,t/2),v.lineTo(t+k,t/2);if("forward-diagonal"===n||"diagonal-cross"===n||"esriSFSDiagonalCross"===n||"esriSFSForwardDiagonal"===n)v.moveTo(-k,-k),v.lineTo(t+k,t+k),v.moveTo(t-k,-k),v.lineTo(t+k,k),v.moveTo(-k,t-k),v.lineTo(k,t+k);if("backward-diagonal"===n||"diagonal-cross"===n||"esriSFSBackwardDiagonal"===n||"esriSFSDiagonalCross"===n)v.moveTo(t+k,-k),v.lineTo(-k,t+k),v.moveTo(k,-k),v.lineTo(-k,k),v.moveTo(t+k,t-k),v.lineTo(t-k,t+k);v.stroke();n=v.getImageData(0,0,h.width,h.height);
n=new Uint8Array(n.data);for(t=0;t<n.length;t+=4)u=n[t+3]/255,n[t]*=u,n[t+1]*=u,n[t+2]*=u;return[n,h.width,h.height]};q.rasterizeSimpleLine=function(h,n){switch(n){case "butt":n="Butt";break;case "square":n="Square";break;default:n="Round"}const u="Butt"===n;switch(h){case "dash":case "esriSLSDash":h=u?[4,3]:[3,4];break;case "dash-dot":case "esriSLSDashDot":h=u?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":h=u?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":h=u?[8,3]:[7,4];break;
case "long-dash-dot":case "esriSLSLongDashDot":h=u?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":h=u?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":h=u?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":h=u?[4,1,1,1]:[3,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":h=u?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":h=u?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":e.error("Unexpected: style does not require rasterization");
h=[0,0];break;default:e.error(`Tried to rasterize SLS, but found an unexpected style: ${h}!`),h=[0,0]}return this.rasterizeDash(h,n)};q.rasterizeDash=function(h,n){var u="Butt"===n,t="Square"===n;n=!u&&!t;var k=0;for(var v of h)k+=v;v=15*k;var p=31*v;k=new Float32Array(p);var r=n?225:15;for(var w=0;w<p;++w)k[w]=r;r=p=0;w=!0;for(var l of h){p=r;r+=15*l;for(h=p;h<r;){let x=0;for(;31>x;){const y=n?(x-15)*(x-15):Math.abs(x-15);k[x*v+h]=w?u?Math.max(Math.max(p+7.5-h,y),Math.max(h-r+7.5,y)):y:n?Math.min((h-
p)*(h-p)+y,(h-r)*(h-r)+y):t?Math.min(Math.max(h-p,y),Math.max(r-h,y)):Math.min(Math.max(h-p+7.5,y),Math.max(r+7.5-h,y));x++}h++}w=!w}u=k.length;l=new Uint8Array(4*u);for(t=0;t<u;++t)c.packFloatRGBA((n?Math.sqrt(k[t]):k[t])/15,l,4*t);return[l,v,31]};q._isHorizontalOrVertical=function(h){return"vertical"===h||"horizontal"===h||"cross"===h||"esriSFSCross"===h||"esriSFSVertical"===h||"esriSFSHorizontal"===h};return q}(),g=function(){function q(){}q.findApplicableOverrides=function(h,n,u){if(n){if(h.primitiveName){let t=
!1;for(const k of u)if(k.primitiveName===h.primitiveName){t=!0;break}if(!t)for(const k of n)k.primitiveName===h.primitiveName&&u.push(k)}switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(h.effects)for(const t of h.effects)q.findApplicableOverrides(t,n,u);if(h.symbolLayers)for(const t of h.symbolLayers)q.findApplicableOverrides(t,n,u);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(h.effects)for(const t of h.effects)q.findApplicableOverrides(t,
n,u);h.markerPlacement&&q.findApplicableOverrides(h.markerPlacement,n,u);if("CIMVectorMarker"===h.type){if(h.markerGraphics)for(const t of h.markerGraphics)q.findApplicableOverrides(t,n,u),q.findApplicableOverrides(t.symbol,n,u)}else"CIMCharacterMarker"===h.type?q.findApplicableOverrides(h.symbol,n,u):"CIMHatchFill"===h.type&&q.findApplicableOverrides(h.lineSymbol,n,u)}}};q.applyOverrides=function(h,n,u,t){if(n){if(h.primitiveName)for(const v of n)if(v.primitiveName===h.primitiveName){var k=(k=v.propertyName)?
k.charAt(0).toLowerCase()+k.substr(1):k;t&&t.push({cim:h,nocapPropertyName:k,value:h[k]});v.expression&&(v.value=q.toValue(v.propertyName,v.expression));if(u){let p=!1;for(const r of u)r.primitiveName===h.primitiveName&&(p=!0);p||u.push(v)}h[k]=v.value}switch(h.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(h.effects)for(const v of h.effects)q.applyOverrides(v,n,u,t);if(h.symbolLayers)for(const v of h.symbolLayers)q.applyOverrides(v,n,u,t);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(h.effects)for(const v of h.effects)q.applyOverrides(v,
n,u,t);if("CIMVectorMarker"===h.type&&h.markerGraphics)for(const v of h.markerGraphics)q.applyOverrides(v,n,u,t),q.applyOverrides(v.symbol,n,u,t)}}};q.restoreOverrides=function(h){for(const n of h)n.cim[n.nocapPropertyName]=n.value};q.buildOverrideKey=function(h){let n="";for(const u of h)void 0!==u.value&&(n+=`${u.primitiveName}${u.propertyName}${JSON.stringify(u.value)}`);return n};q.toValue=function(h,n){return"DashTemplate"===h?n.split(" ").map(u=>Number(u)):"Color"===h?(h=(new C(n)).toRgba(),
h[3]*=255,h):n};return q}();z.CIMSymbolHelper=E;z.OverrideHelper=g;z.SymbolHelper=f;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/CIMPlacements":function(){define(["exports"],function(z){let E=function(){function C(){this.setIdentity()}var A=C.prototype;A.getAngle=function(){if(null==this.rz||0===this.rz&&1!==this.rz_c&&0!==this.rz_s)this.rz=Math.atan2(this.rz_s,this.rz_c);return this.rz};A.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;
this.rz_c=1;this.rz_s=0};A.setTranslate=function(m,c){this.tx=m;this.ty=c};A.setTranslateZ=function(m){this.tz=m};A.setRotateCS=function(m,c){this.rz=void 0;this.rz_c=m;this.rz_s=c};A.setRotate=function(m){this.rz=m;this.rz_s=this.rz_c=void 0};A.setRotateY=function(m){this.ry=m};A.setScale=function(m){this.s=m};A.setMeasure=function(m){this.m=m};return C}(),D=function(){function C(){}C.prototype.next=function(){return null};return C}();z.EmptyPlacementCursor=D;z.Placement=E;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../core/Logger ../../geometry/support/boundsUtils ../../geometry/support/jsonUtils ../../geometry/support/aaBoundingRect ./CIMPlacements ./CIMEffects ./CIMOperators ./Rect".split(" "),function(z,E,D,C,A,m,c,b,d,a){const e=Math.PI/180,f=D.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");let g=function(){function n(t){this._t=t}n.createIdentity=function(){return new n([1,
0,0,0,1,0])};var u=n.prototype;u.clone=function(){return new n(this._t.slice())};u.transform=function(t){const k=this._t;return[k[0]*t[0]+k[1]*t[1]+k[2],k[3]*t[0]+k[4]*t[1]+k[5]]};n.createScale=function(t,k){return new n([t,0,0,0,k,0])};u.scale=function(t,k){const v=this._t;v[0]*=t;v[1]*=t;v[2]*=t;v[3]*=k;v[4]*=k;v[5]*=k;return this};u.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};n.createTranslate=function(t,k){return new n([0,0,t,0,0,k])};u.translate=function(t,
k){const v=this._t;v[2]+=t;v[5]+=k;return this};n.createRotate=function(t){const k=Math.cos(t);t=Math.sin(t);return new n([k,-t,0,t,k,0])};u.rotate=function(t){return this.multiply(n.createRotate(t))};u.multiply=function(t){const k=this._t;t=t._t;const v=k[1]*t[0]+k[4]*t[1],p=k[2]*t[0]+k[5]*t[1]+t[2],r=k[0]*t[3]+k[3]*t[4],w=k[1]*t[3]+k[4]*t[4],l=k[2]*t[3]+k[5]*t[4]+t[5];k[0]=k[0]*t[0]+k[3]*t[1];k[1]=v;k[2]=p;k[3]=r;k[4]=w;k[5]=l;return this};return n}();D=function(){function n(t){this._transfos=[];
this._sizeTransfos=[];this._transfos.push(t||g.createIdentity());this._sizeTransfos.push(t?t.scaleRatio():1)}var u=n.prototype;u.transformPt=function(t){return this._transfos[this._transfos.length-1].transform(t)};u.transformSize=function(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]};u.back=function(){return this._transfos[this._transfos.length-1]};u.push=function(t,k){k=k?t.scaleRatio():1;t.multiply(this.back());this._transfos.push(t);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-
1]*k)};u.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};u.drawSymbol=function(t,k){if(t)switch(t.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(t,k)}};u.drawMultiLayerSymbol=function(t,k){if(t){var v=t.symbolLayers;if(v)if(t=t.effects){if(k=this.executeEffects(t,k))for(t=k.next();t;)this.drawSymbolLayers(v,t),t=k.next()}else this.drawSymbolLayers(v,k)}};u.executeEffects=function(t,k){k=new b.SimpleGeometryCursor(k);for(const v of t)(t=
d.getEffectOperator(v))&&(k=t.execute(k,v,1));return k};u.drawSymbolLayers=function(t,k){let v=t.length;for(;v--;){const r=t[v];if(r&&!1!==r.enable){var p=r.effects;if(p){if(p=this.executeEffects(p,k)){let w=p.next();for(;w;)this.drawSymbolLayer(r,w),w=p.next()}}else this.drawSymbolLayer(r,k)}}};u.drawSymbolLayer=function(t,k){switch(t.type){case "CIMSolidFill":this.drawSolidFill(k,t.color);break;case "CIMHatchFill":this.drawHatchFill(t,k);break;case "CIMSolidStroke":this.drawSolidStroke(k,t.color,
t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(t,k)}};u.drawHatchFill=function(t,k){const v=this._buildHatchPolyline(t,k,1);v&&(this.pushClipPath(k),this.drawMultiLayerSymbol(t.lineSymbol,v),this.popClipPath())};u.drawMarkerLayer=function(t,k){var v=t.markerPlacement;if(v){const r=d.getPlacementOperator(v);if(r){var p="CIMMarkerPlacementInsidePolygon"===v.type;p&&this.pushClipPath(k);if(k=r.execute(k,
v,1))for(v=k.next();v;)this.drawMarker(t,v),v=k.next();p&&this.popClipPath()}}else p=new c.Placement,p.tx=k.x,p.ty=k.y,this.drawMarker(t,p)};u.drawMarker=function(t,k){switch(t.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(t,k);break;case "CIMVectorMarker":this.drawVectorMarker(t,k)}};u.drawPictureMarker=function(t,k){};u.drawVectorMarker=function(t,k){if(t){var v=t.markerGraphics;if(v){var p=t.size,r=t.frame,w=r?r.ymax-r.ymin:0;p=p&&w?p/w:1;w=g.createIdentity();r&&
w.translate(.5*-(r.xmax+r.xmin),.5*-(r.ymax+r.ymin));var l=t.anchorPoint;if(l){let x=l.x;l=l.y;"Absolute"!==t.anchorPointUnits&&r&&(x*=r.xmax-r.xmin,l*=r.ymax-r.ymin);w.translate(-x,-l)}1!==p&&w.scale(p,p);t.rotation&&w.rotate(t.rotation*e);w.translate(t.offsetX||0,t.offsetY||0);w.translate(k.tx,k.ty);this.push(w,t.scaleSymbolsProportionally);for(const x of v)x&&x.symbol&&x.geometry||f.error("Invalid marker graphic",x),this.drawSymbol(x.symbol,x.geometry);this.pop()}}};u._buildHatchPolyline=function(t,
k,v){var p=(void 0!==t.separation?t.separation:4)*v,r=void 0!==t.rotation?t.rotation:0;if(0===p)return null;0>p&&(p=-p);for(var w=0,l=.5*p;w>l;)w-=p;for(;w<-l;)w+=p;w=m.create();C.getBoundsXY(w,k);w[0]-=l;w[1]-=l;w[2]+=l;w[3]+=l;for(var x=[[w[0],w[1]],[w[0],w[3]],[w[2],w[3]],[w[2],w[1]]];180<r;)r-=180;for(;0>r;)r+=180;l=Math.cos(r*e);var y=Math.sin(r*e);r=-p*y;k=p*l;w=(void 0!==t.offsetX?t.offsetX*v:0)*y-(void 0!==t.offsetY?t.offsetY*v:0)*l;let B;var F=t=Number.MAX_VALUE;B=v=-Number.MAX_VALUE;for(var G of x){var J=
G[0];const K=G[1];x=l*J+y*K;J=-y*J+l*K;F=Math.min(F,x);t=Math.min(t,J);B=Math.max(B,x);v=Math.max(v,J)}t=Math.floor(t/p)*p;G=l*F-y*t-r*w/p;F=y*F+l*t-k*w/p;x=l*B-y*t-r*w/p;w=y*B+l*t-k*w/p;p=1+Math.round((v-t)/p);l=[];for(y=0;y<p;y++)G+=r,F+=k,x+=r,w+=k,l.push([[G,F],[x,w]]);return{paths:l}};return n}();let q=function(n){function u(){var k=n.call(this)||this;k.reset();return k}E._inheritsLoose(u,n);var t=u.prototype;t.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity;this._clipCount=
0};t.envelope=function(){return new a(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};t.drawSolidFill=function(k){!k||0<this._clipCount||(A.isPolygon(k)?this._processPath(k.rings,0):A.isPolyline(k)&&this._processPath(k.paths,0))};t.drawSolidStroke=function(k,v,p){!k||0<this._clipCount||(v=.5*this.transformSize(p),A.isPolygon(k)?this._processPath(k.rings,v):A.isPolyline(k)&&this._processPath(k.paths,v))};t.pushClipPath=function(k){this.drawSolidFill(k);++this._clipCount};t.popClipPath=
function(){--this._clipCount};t._processPath=function(k,v){if(k)for(const p of k)if(k=p?p.length:0,1<k){this._merge(this.transformPt(p[0]),v);for(let r=1;r<k;++r)this._merge(this.transformPt(p[r]),v)}};t._merge=function(k,v){k[0]-v<this._xmin&&(this._xmin=k[0]-v);k[0]+v>this._xmax&&(this._xmax=k[0]+v);k[1]-v<this._ymin&&(this._ymin=k[1]-v);k[1]+v>this._ymax&&(this._ymax=k[1]+v)};return u}(D),h=function(n){function u(k,v){v=n.call(this,v)||this;v._ctx=k;return v}E._inheritsLoose(u,n);var t=u.prototype;
t.drawSolidFill=function(k,v){if(k){if(A.isPolygon(k))this._buildPath(k.rings,!0);else if(A.isPolyline(k))this._buildPath(k.paths,!0);else return;k=this._ctx;k.fillStyle="string"===typeof v?v:"rgba("+Math.round(v[0])+","+Math.round(v[1])+","+Math.round(v[2])+","+v[3]/255+")";k.fill("evenodd")}};t.drawSolidStroke=function(k,v,p,r,w,l){if(k&&v&&0!==p){if(A.isPolygon(k))this._buildPath(k.rings,!0);else if(A.isPolyline(k))this._buildPath(k.paths,!1);else return;k=this._ctx;k.strokeStyle="string"===typeof v?
v:"rgba("+Math.round(v[0])+","+Math.round(v[1])+","+Math.round(v[2])+","+v[3]/255+")";k.lineWidth=this.transformSize(p)+.5;this._setCapStyle(r);this._setJoinStyle(w);k.miterLimit=l;k.stroke()}};t.pushClipPath=function(k){this._ctx.save();A.isPolygon(k)?this._buildPath(k.rings,!0):A.isPolyline(k)&&this._buildPath(k.paths,!0);this._ctx.clip("evenodd")};t.popClipPath=function(){this._ctx.restore()};t._buildPath=function(k,v){const p=this._ctx;p.beginPath();if(k)for(const r of k)if(k=r?r.length:0,1<k){let w=
this.transformPt(r[0]);p.moveTo(w[0],w[1]);for(let l=1;l<k;++l)w=this.transformPt(r[l]),p.lineTo(w[0],w[1]);v&&p.closePath()}};t._setCapStyle=function(k){switch(k){case "Butt":this._ctx.lineCap="butt";break;case "Round":this._ctx.lineCap="round";break;case "Square":this._ctx.lineCap="square"}};t._setJoinStyle=function(k){switch(k){case "Bevel":this._ctx.lineJoin="bevel";break;case "Round":this._ctx.lineJoin="round";break;case "Miter":this._ctx.lineJoin="miter"}};return u}(D);z.CIMSymbolDrawHelper=
D;z.C_DEG_TO_RAD=e;z.CanvasDrawHelper=h;z.EnvDrawHelper=q;z.Transformation=g;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/CIMEffects":function(){define(["exports","../../core/lang"],function(z,E){let D=function(){function C(A){this._geometry=A}C.prototype.next=function(){const A=this._geometry;this._geometry=null;return A};return C}();z.SimpleGeometryCursor=D;z.clone=function(C){return E.clone(C)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/CIMOperators":function(){define("exports ./effects/EffectAddControlPoints ./effects/EffectArrow ./effects/EffectBuffer ./effects/EffectCut ./effects/EffectDashes ./effects/EffectDonut ./effects/EffectJog ./effects/EffectMove ./effects/EffectOffset ./effects/EffectReverse ./effects/EffectRotate ./effects/EffectScale ./effects/EffectWave ./placements/PlacementAlongLineSameSize ./placements/PlacementAtExtremities ./placements/PlacementAtRatioPositions ./placements/PlacementInsidePolygon ./placements/PlacementOnLine ./placements/PlacementOnVertices ./placements/PlacementPolygonCenter".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v,p){z.getEffectOperator=function(r){if(!r)return null;switch(r.type){case "CIMGeometricEffectAddControlPoints":return E.EffectAddControlPoints.local();case "CIMGeometricEffectArrow":return D.EffectArrow.local();case "CIMGeometricEffectBuffer":return C.EffectBuffer.local();case "CIMGeometricEffectCut":return A.EffectCut.local();case "CIMGeometricEffectDashes":return m.EffectDashes.local();case "CIMGeometricEffectDonut":return c.EffectDonut.local();case "CIMGeometricEffectJog":return b.EffectJog.local();
case "CIMGeometricEffectMove":return d.EffectMove.local();case "CIMGeometricEffectOffset":return a.EffectOffset.local();case "CIMGeometricEffectReverse":return e.EffectReverse.local();case "CIMGeometricEffectRotate":return f.EffectRotate.local();case "CIMGeometricEffectScale":return g.EffectScale.local();case "CIMGeometricEffectWave":return q.EffectWave.local()}return null};z.getPlacementOperator=function(r){if(!r)return null;switch(r.type){case "CIMMarkerPlacementAlongLineSameSize":return h.PlacementAlongLineSameSize.local();
case "CIMMarkerPlacementAtExtremities":return n.PlacementAtExtremities.local();case "CIMMarkerPlacementAtRatioPositions":return u.PlacementAtRatioPositions.local();case "CIMMarkerPlacementInsidePolygon":return t.PlacementInsidePolygon.local();case "CIMMarkerPlacementOnLine":return k.PlacementOnLine.local();case "CIMMarkerPlacementOnVertices":return v.PlacementOnVertices.local();case "CIMMarkerPlacementPolygonCenter":return p.PlacementPolygonCenter.local()}return null};Object.defineProperty(z,"__esModule",
{value:!0})})},"esri/symbols/cim/effects/EffectAddControlPoints":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(){function c(d,a,e){this._inputGeometries=d;this._angleTolerance=void 0!==a.angleTolerance?a.angleTolerance:
120;this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}var b=c.prototype;b.next=function(){for(var d=this._inputGeometries.next();d;){if(D.isPolygon(d))return this._isClosed=!0,d=E.clone(d),this._processMultipath(d.rings),d;if(D.isPolyline(d))return this._isClosed=!1,d=E.clone(d),this._processMultipath(d.paths),d;if(D.isExtent(d)){if(this._maxCosAngle)return d;this._isClosed=!0;d=[[d.xmin,d.ymin],[d.xmin,d.ymax],[d.xmax,d.ymax],[d.xmax,d.ymin],[d.xmin,d.ymin]];this._processPath(d);
return{rings:[d]}}d=this._inputGeometries.next()}return null};b._processMultipath=function(d){if(d)for(const a of d)this._processPath(a)};b._processPath=function(d){if(d){let a=d.length,e=d[0],f,g,q,h,n,u;this._isClosed&&++a;for(let t=1;t<a;++t){let k;k=this._isClosed&&t===a-1?d[0]:d[t];const v=k[0]-e[0],p=k[1]-e[1],r=Math.sqrt(v*v+p*p);1<t&&0<r&&0<q&&(f*v+g*p)/r/q<=this._maxCosAngle&&C.setId(e,1);1===t&&(h=v,n=p,u=r);0<r&&(e=k,f=v,g=p,q=r)}this._isClosed&&0<q&&0<u&&(f*h+g*n)/u/q<=this._maxCosAngle&&
C.setId(d[0],1)}};return c}();z.EffectAddControlPoints=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/CIMCursor":function(){define(["exports","../../core/lang","../../geometry/support/jsonUtils","./CIMPlacements"],function(z,E,D,C){function A(q){if(q){var h=q.length;for(--h;0<h;--h)q[h][0]-=q[h-1][0],q[h][1]-=q[h-1][1]}}function m(q){if(q)for(const h of q)A(h)}function c(q){if(q){const h=q.length;for(let n=1;n<h;++n)q[n][0]+=q[n-1][0],q[n][1]+=q[n-1][1]}}function b(q){if(q)for(const h of q)c(h)}
function d(q){q&&(D.isPolygon(q)?b(q.rings):D.isPolyline(q)?b(q.paths):D.isMultipoint(q)&&c(q.points))}function a(q){q&&q.reverse()}function e(q){return{rings:[[[q.xmin,q.ymin],[q.xmin,q.ymax],[q.xmax,q.ymax],[q.xmax,q.ymin],[q.xmin,q.ymin]]]}}let f=function(){function q(h,n,u,t){this.acceptPolygon=n;this.acceptPolyline=u;this.geomUnitsPerPoint=t;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;h&&(D.isPolygon(h)?n&&(this.multiPath=h.rings,this.isClosed=!0):D.isPolyline(h)?u&&(this.multiPath=
h.paths,this.isClosed=!1):D.isExtent(h)&&n&&(this.multiPath=e(h).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new C.Placement}q.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const h=this.processPath(this.multiPath[this.pathIndex]);if(h)return h}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return q}(),g=function(){function q(h,
n,u,t){this.inputGeometries=h;this.acceptPolygon=n;this.acceptPolyline=u;this.geomUnitsPerPoint=t;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}q.prototype.next=function(){for(;;){if(!this.multiPath){for(var h=this.inputGeometries.next();h;)if(D.isPolygon(h)?this.acceptPolygon&&(this.multiPath=h.rings,this.isClosed=!0):D.isPolyline(h)?this.acceptPolyline&&(this.multiPath=h.paths,this.isClosed=!1):D.isExtent(h)&&this.acceptPolygon&&(this.multiPath=e(h).rings,this.isClosed=!0),this.multiPath){this.pathCount=
this.multiPath.length;this.pathIndex=-1;break}else h=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,h=this.processPath(this.multiPath[this.pathIndex]))return h;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return q}();z.PathGeometryCursor=g;z.PathTransformationCursor=f;z.cloneAndDecodeGeometry=function(q){q=E.clone(q);d(q);return q};z.deltaDecodeGeometry=d;z.deltaEncodeGeometry=function(q){q&&
(D.isPolygon(q)?m(q.rings):D.isPolyline(q)?m(q.paths):D.isMultipoint(q)&&A(q.points))};z.getCoord2D=function(q,h,n){return[q[0]+(h[0]-q[0])*n,q[1]+(h[1]-q[1])*n]};z.getId=function(q){return q[4]};z.isClosedPath=function(q){return q&&0!==q.length?q[0][0]===q[q.length-1][0]&&q[0][1]===q[q.length-1][1]:!1};z.reverseMultipath=function(q){if(q)for(const h of q)a(h)};z.reversePath=a;z.setId=function(q,h){q[4]=h};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectArrow":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(c){function b(a,e,f){a=c.call(this,a,!1,!0)||this;a._curveHelper=new C.CurveHelper;a._width=(void 0!==e.width?e.width:5)*f;a._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:
"OpenEnded";a._offsetFlattenError=C.PIXEL_TOLERANCE*f;return a}E._inheritsLoose(b,c);var d=b.prototype;d.processPath=function(a){switch(this._arrowType){default:return this._constructSimpleArrow(a,!0);case "Block":return this._constructSimpleArrow(a,!1);case "Crossed":return this._constructCrossedArrow(a)}};d._constructSimpleArrow=function(a,e){var f=this._curveHelper.calculatePathLength(a),g=this._width;f<2*g&&(g=f/2);f=this._curveHelper.getSubCurve(a,0,f-g);if(!f)return null;var q=g/2;if(this._curveHelper.isEmpty(f,
!1))return null;g=this._constructOffset(f,-q);if(!g)return null;f=this._constructOffset(f,q);if(!f)return null;const h=this._constructArrowBasePoint(g,-q/2);if(!h)return null;q=this._constructArrowBasePoint(f,q/2);if(!q)return null;a=a[a.length-1];e||(this._makeControlPoint(f,!0),this._makeControlPoint(g,!0));const n=new C.PathHelper;n.addPath(f,!0);n.lineTo(q);this._makeControlPoint(n.path());n.lineTo(a);this._makeControlPoint(n.path());n.lineTo(h);this._makeControlPoint(n.path());n.addPath(g,!1);
return e?{paths:[n.path()]}:(n.close(),{rings:[n.path()]})};d._constructCrossedArrow=function(a){var e=this._curveHelper.calculatePathLength(a),f=this._width;e<3.732050807568877*f&&(f=e/3.732050807568877);var g=this._curveHelper.getSubCurve(a,0,e-2.732050807568877*f);if(!g)return null;var q=f/2;if(this._curveHelper.isEmpty(g,!1))return null;const h=this._constructOffset(g,q);if(!h)return null;g=this._constructOffset(g,-q);if(!g)return null;e=this._curveHelper.getSubCurve(a,0,e-f);if(!e||this._curveHelper.isEmpty(e,
!1))return null;f=this._constructOffset(e,q);if(!f)return null;var n=this._constructOffset(e,-q);if(!n)return null;e=f[f.length-1];f=this._constructArrowBasePoint(f,q/2);if(!f)return null;const u=n[n.length-1];q=this._constructArrowBasePoint(n,-q/2);if(!q)return null;a=a[a.length-1];this._makeControlPoint(h,!1);this._makeControlPoint(g,!1);n=new C.PathHelper;n.addPath(h,!0);this._makeControlPoint(n.path());n.lineTo(u);n.lineTo(q);this._makeControlPoint(n.path());n.lineTo(a);this._makeControlPoint(n.path());
n.lineTo(f);this._makeControlPoint(n.path());n.lineTo(e);this._makeControlPoint(n.path());n.addPath(g,!1);return{paths:[n.path()]}};d._constructOffset=function(a,e){return this._curveHelper.offset(a,e,"Rounded",4,this._offsetFlattenError)};d._constructArrowBasePoint=function(a,e){if(!a||2>a.length)return null;var f=a[a.length-2];a=a[a.length-1];f=[a[0]-f[0],a[1]-f[1]];this._curveHelper.normalize(f);return[a[0]+f[1]*e,a[1]-f[0]*e]};d._makeControlPoint=function(a,e=!1){e?D.setId(a[0],1):D.setId(a[a.length-
1],1)};return b}(D.PathGeometryCursor);z.EffectArrow=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/CurveHelper":function(){define(["exports"],function(z){let E=function(){function C(){this._path=[]}var A=C.prototype;A.path=function(){return this._path};A.addPath=function(m,c){c||m.reverse();Array.prototype.push.apply(this._path,m);c||m.reverse()};C.mergePath=function(m,c){c&&Array.prototype.push.apply(m,c)};A.startPath=function(m){this._path.push(m)};A.lineTo=function(m){this._path.push(m)};
A.close=function(){const m=this._path;1<m.length&&(m[0][0]!==m[m.length-1][0]||m[0][1]!==m[m.length-1][1])&&m.push([m[0][0],m[0][1]])};return C}(),D=function(){function C(m,c){}var A=C.prototype;A.normalize=function(m){const c=Math.sqrt(m[0]*m[0]+m[1]*m[1]);m[0]/=c;m[1]/=c};A.calculateLength=function(m,c){const b=c[0]-m[0];m=c[1]-m[1];return Math.sqrt(b*b+m*m)};A.calculateSegLength=function(m,c){return this.calculateLength(m[c],m[c+1])};A.calculatePathLength=function(m){let c=0;const b=m?m.length:
0;for(let d=0;d<b-1;++d)c+=this.calculateSegLength(m,d);return c};A.calculatePathArea=function(m){let c=0;const b=m?m.length:0;for(let d=0;d<b-1;++d)c+=(m[d+1][0]-m[d][0])*(m[d+1][1]+m[d][1]);return c/2};A.getCoord2D=function(m,c,b){return[m[0]+(c[0]-m[0])*b,m[1]+(c[1]-m[1])*b]};A.getSegCoord2D=function(m,c,b){return this.getCoord2D(m[c],m[c+1],b)};A.getAngle=function(m,c,b){return Math.atan2(c[1]-m[1],c[0]-m[0])};A.getSegAngle=function(m,c,b){return this.getAngle(m[c],m[c+1],b)};A.getAngleCS=function(m,
c,b){b=c[0]-m[0];m=c[1]-m[1];c=Math.sqrt(b*b+m*m);return 0<c?[b/c,m/c]:[1,0]};A.getSegAngleCS=function(m,c,b){return this.getAngleCS(m[c],m[c+1],b)};A.cut=function(m,c,b,d){b=0>=b?m[c]:this.getSegCoord2D(m,c,b);m=1<=d?m[c+1]:this.getSegCoord2D(m,c,d);return[b,m]};A.addSegment=function(m,c,b){b&&m.push(c[0]);m.push(c[1])};A.getSubCurve=function(m,c,b){const d=[];return this.appendSubCurve(d,m,c,b)?d:null};A.appendSubCurve=function(m,c,b,d){const a=c?c.length-1:0;let e=0,f=!0,g=0;for(;g<a;){const h=
this.calculateSegLength(c,g);if(0!==h){if(f){if(e+h>b){var q=(b-e)/h;let n=1,u=!1;e+h>=d&&(n=(d-e)/h,u=!0);(q=this.cut(c,g,q,n))&&this.addSegment(m,q,f);if(u)break;f=!1}}else{if(e+h>d){(c=this.cut(c,g,0,(d-e)/h))&&this.addSegment(m,c,f);break}this.addSegment(m,[c[g],c[g+1]],f)}e+=h}++g}return!0};A.getCIMPointAlong=function(m,c){const b=m?m.length-1:0;let d=0,a=-1;for(;a<b;){++a;const e=this.calculateSegLength(m,a);if(0!==e){if(d+e>c)return this.getCoord2D(m[a],m[a+1],(c-d)/e);d+=e}}return null};A.isEmpty=
function(m,c){if(!m||1>=m.length)return!0;const b=m?m.length-1:0;let d=-1;for(;d<b;)if(++d,m[d+1][0]!==m[d][0]||m[d+1][1]!==m[d][1]||c&&m[d+1][2]!==m[d][2])return!1;return!0};A.offset=function(m,c,b,d,a){if(!m||2>m.length)return null;a=m.length;const e=m[0][0]===m[a-1][0]&&m[0][1]===m[a-1][1];if(e){if(3>m.length)return null;--a}const f=[];var g=e?m[a-1]:null;let q=m[0];for(let t=0;t<a;t++){const k=t===a-1?e?m[0]:null:m[t+1];if(g)if(k){var h=[k[0]-q[0],k[1]-q[1]];this.normalize(h);g=[q[0]-g[0],q[1]-
g[1]];this.normalize(g);var n=g[0]*h[1]-g[1]*h[0],u=g[0]*h[0]+g[1]*h[1];if(0<=n===0>=c)h=[h[0]-g[0],h[1]-g[1]],this.normalize(h),g=-Math.abs(c)/Math.sqrt((1+u)/2),f.push([q[0]-h[0]*g,q[1]-h[1]*g]);else switch(b){case "Mitered":if(u=Math.sqrt((1+u)/2),0<u&&1/u<d){h=[h[0]-g[0],h[1]-g[1]];this.normalize(h);g=Math.abs(c)/u;f.push([q[0]-h[0]*g,q[1]-h[1]*g]);break}case "Bevelled":f.push([q[0]+g[1]*c,q[1]-g[0]*c]);f.push([q[0]+h[1]*c,q[1]-h[0]*c]);break;case "Rounded":f.push([q[0]+g[1]*c,q[1]-g[0]*c]);u=
.2;for(n=1;5>n;n++,u+=.2){const v=[g[1]*(1-u)+h[1]*u,-g[0]*(1-u)-h[0]*u];this.normalize(v);f.push([q[0]+v[0]*c,q[1]+v[1]*c])}f.push([q[0]+h[1]*c,q[1]-h[0]*c]);break;default:0>n?(f.push([q[0]+(g[1]+g[0])*c,q[1]+(g[1]-g[0])*c]),f.push([q[0]+(h[1]-h[0])*c,q[1]-(h[0]+h[1])*c])):(u=Math.sqrt((1+Math.abs(u))/2),h=[h[0]-g[0],h[1]-g[1]],this.normalize(h),g=c/u,f.push([q[0]-h[0]*g,q[1]-h[1]*g]))}}else h=[q[0]-g[0],q[1]-g[1]],this.normalize(h),f.push([q[0]+h[1]*c,q[1]-h[0]*c]);else h=[k[0]-q[0],k[1]-q[1]],
this.normalize(h),f.push([q[0]+h[1]*c,q[1]-h[0]*c]);g=q;q=k}e&&f.push([f[0][0],f[0][1]]);return f};return C}();z.CurveHelper=D;z.PIXEL_TOLERANCE=.03;z.PathHelper=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectBuffer":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(z,E,D){let C=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(c,b,d){return new A(c,
b,d)};return m}();C.instance=null;let A=function(){function m(c,b,d){this._inputGeometries=c;this._curveHelper=new D.CurveHelper;this._size=(void 0!==b.size?b.size:1)*d;this._offsetFlattenError=D.PIXEL_TOLERANCE*d}m.prototype.next=function(){let c=this._inputGeometries.next();for(;c;){if(E.isExtent(c))if(0<this._size){var b=this._curveHelper.offset([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]],this._size,"Rounded",4,this._offsetFlattenError);if(b)return{rings:[b]}}else if(0>
this._size){if(0<Math.min(c.xmax-c.xmin,c.ymax-c.ymin)+2*this._size)return{xmin:c.xmin-this._size,xmax:c.xmax+this._size,ymin:c.ymin-this._size,ymax:c.ymax+this._size}}else return c;if(E.isPolygon(c)){if(0===this._size)return c;b=[];for(const a of c.rings){var d=this._curveHelper.offset(a,this._size,"Rounded",4,this._offsetFlattenError);d&&b.push(d)}if(b.length)return{rings:b}}if(E.isPolyline(c)&&0<this._size){b=[];for(const a of c.paths)if(a&&1<a.length){d=this._curveHelper.offset(a,this._size,"Rounded",
4,this._offsetFlattenError);const e=this._curveHelper.offset(a,-this._size,"Rounded",4,this._offsetFlattenError);if(d&&e){for(let f=e.length-1;0<=f;f--)d.push(e[f]);d.push([d[0][0],d[0][1]]);b.push(d)}}if(b.length)return{rings:b}}E.isPoint(c);c=this._inputGeometries.next()}return null};return m}();z.EffectBuffer=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectCut":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],
function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(c){function b(d,a,e){d=c.call(this,d,!0,!0)||this;d._curveHelper=new C.CurveHelper;d._beginCut=(void 0!==a.beginCut?a.beginCut:1)*e;d._endCut=(void 0!==a.endCut?a.endCut:1)*e;d._middleCut=(void 0!==a.middleCut?a.middleCut:0)*e;d._invert=void 0!==a.invert?a.invert:!1;0>d._beginCut&&
(d._beginCut=0);0>d._endCut&&(d._endCut=0);0>d._middleCut&&(d._middleCut=0);return d}E._inheritsLoose(b,c);b.prototype.processPath=function(d){var a=this._beginCut;const e=this._endCut,f=this._middleCut,g=this._curveHelper.calculatePathLength(d),q=[];if(!this._invert)0===a&&0===e&&0===f?q.push(d):a+e+f>=g||(0===f?(d=this._curveHelper.getSubCurve(d,a,g-e))&&q.push(d):((a=this._curveHelper.getSubCurve(d,a,.5*(g-f)))&&q.push(a),(a=this._curveHelper.getSubCurve(d,.5*(g+f),g-e))&&q.push(a)));else if(0!==
a||0!==e||0!==f)a+e+f>=g?q.push(d):((a=this._curveHelper.getSubCurve(d,0,a))&&q.push(a),(a=this._curveHelper.getSubCurve(d,.5*(g-f),.5*(g+f)))&&q.push(a),(a=this._curveHelper.getSubCurve(d,g-e,e))&&q.push(a));return 0===q.length?null:{paths:q}};return b}(D.PathGeometryCursor);z.EffectCut=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDashes":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper","../GeometryWalker"],
function(z,E,D,C,A){let m=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,e){return new c(d,a,e)};return b}();m.instance=null;let c=function(b){function d(a,e,f){a=b.call(this,a,!0,!0)||this;a._walker=new A.GeometryWalker;a._walker.updateTolerance(f);a._endings=e.lineDashEnding;a._customDashPos=void 0!==e.offsetAlongLine?e.offsetAlongLine*f:0;a._offsetAtEnd=void 0!==e.customEndingOffset?e.customEndingOffset*f:0;
a._pattern=new A.DashPattern;a._pattern.init(e.dashTemplate,!0);a._pattern.scale(f);return a}E._inheritsLoose(d,b);d.prototype.processPath=function(a){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[a]};if(!this.iteratePath){var e=!0;switch(this._endings){default:this._pattern.extPtGap=0;break;case "FullPattern":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case "FullGap":this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case "NoConstraint":this.isClosed||
(e=!1);break;case "Custom":this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}var f=this._walker.calculatePathLength(a);if(this._pattern.isEmpty()||f<.1*this._pattern.length()||!this._walker.init(a,this._pattern,e))return{paths:[a]}}if(this.iteratePath)a=this._pattern.nextValue();else{switch(this._endings){default:e=.5*this._pattern.firstValue();break;case "HalfGap":e=.5*-this._pattern.lastValue();break;case "FullGap":e=-this._pattern.lastValue();break;case "FullPattern":e=0;break;case "NoConstraint":case "Custom":e=
-this._customDashPos}a=e/this._pattern.length();a-=Math.floor(a);e=a*this._pattern.length();this._pattern.reset();a=this._pattern.nextValue();for(f=!1;e>=a;)e-=a,a=this._pattern.nextValue(),f=!f;a-=e;f?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue())}(e=this._walker.nextCurve(a))?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,
1),C.PathHelper.mergePath(e,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null);return{paths:[e]}};return d}(D.PathGeometryCursor);z.EffectDashes=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/GeometryWalker":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./CIMCursor","./CurveHelper"],function(z,E,D,C){let A=function(){function b(){this._values=[];this._currentValue=this._length=this.ctrlPtGap=this.extPtGap=0}var d=b.prototype;d.isEmpty=function(){return 0===this._values.length};d.size=function(){return this._values.length};d.init=function(a,e,f=!0){this._setEmpty();if(!a||0===a.length)return!1;for(let g=0;g<a.length;g++){let q=Math.abs(a[g]);f&&1E-7>q&&(q=1E-7);this._values.push(q);this._length+=q}e&&a.length&
1&&(this._length*=2);if(0===this._length)return!1;this.ctrlPtGap=this.extPtGap=0;this._currentValue=-1;return!0};d.scale=function(a){const e=this._values?this._values.length:0;for(let f=0;f<e;++f)this._values[f]*=a;this._length*=a;this.extPtGap*=a;this.ctrlPtGap*=a};d.addValue=function(a){this._length+=a;this._values.push(a)};d.firstValue=function(){return this._values[0]};d.lastValue=function(){return this._values[this._values.length-1]};d.nextValue=function(){this._currentValue++;this._currentValue===
this._values.length&&(this._currentValue=0);return this._values[this._currentValue]};d.reset=function(){this._currentValue=-1};d.length=function(){return this._length};d._setEmpty=function(){this.extPtGap=this.ctrlPtGap=this._length=0;this._currentValue=-1;this._values.length=0};return b}(),m=function(){function b(){this.reset()}var d=b.prototype;d.reset=function(){this.segment=-1;this.abscissa=this.segmentLength=0;this.isPartEnd=this.isPathEnd=!1};d.isValid=function(){return-1!==this.segment};d.copyTo=
function(a){a.segment=this.segment;a.segmentLength=this.segmentLength;a.abscissa=this.abscissa;a.isPathEnd=this.isPathEnd;a.isPartEnd=this.isPartEnd};return b}(),c=function(b){function d(e=0,f=!1){e=b.call(this,e,f)||this;e._tolerance=C.PIXEL_TOLERANCE;e._currentPosition=new m;return e}E._inheritsLoose(d,b);var a=d.prototype;a.updateTolerance=function(e){this._tolerance=C.PIXEL_TOLERANCE*e};a.init=function(e,f,g=!0){g?(this._patternLength=f.length(),this._partExtPtGap=f.extPtGap,this._partCtrlPtGap=
f.ctrlPtGap):this._partCtrlPtGap=this._partExtPtGap=this._patternLength=0;this._currentPosition.reset();this._partSegCount=0;this._path=e;this._seg=-1;return this.setPosAtNextPart()};a.curPositionIsValid=function(){return this._currentPosition.isValid()};a.nextPosition=function(e,f=0){const g=new m;if(!this._nextPosition(e,g,null,f))return!1;g.copyTo(this._currentPosition);return!0};a.curPointAndAngle=function(e){e.pt=this._getPoint(this._currentPosition);const [f,g]=this._getAngle(this._currentPosition);
e.ca=f;e.sa=g};a.nextPointAndAngle=function(e,f,g=0){const q=new m;if(!this._nextPosition(e,q,null,g))return!1;q.copyTo(this._currentPosition);f.pt=this._getPoint(q);const [h,n]=this._getAngle(q);f.ca=h;f.sa=n;return!0};a.nextCurve=function(e){if(0===e)return null;const f=[],g=new m;if(!this._nextPosition(e,g,f,1))return null;g.copyTo(this._currentPosition);return f};a.isPathEnd=function(){return this._currentPosition.isPathEnd};a.getPathEnd=function(){if(-1===this._currentPosition.segment)throw Error("missing segment");
return this._path[this._currentPosition.segment+1]};a._nextPosition=function(e,f,g,q){if(this._currentPosition.isPathEnd)return!1;var h=this._currentPosition.abscissa;0<this._currentPosition.segmentLength&&(h/=this._currentPosition.segmentLength);for(this._currentPosition.copyTo(f);f.abscissa+e*this._partLengthRatio>f.segmentLength+this._tolerance;)if(g&&(0===g.length&&(0===h?(h=this._path[f.segment],g.push([h[0],h[1]])):g.push(this.getSegCoord2D(this._path,f.segment,h))),h=this._path[f.segment+1],
g.push([h[0],h[1]])),h=0,e-=(f.segmentLength-f.abscissa)/this._partLengthRatio,this._partSegCount)f.segment=this.nextSegment(),f.segmentLength=this.calculateSegLength(this._path,f.segment),f.abscissa=0,this._partSegCount--;else{if(!this.setPosAtNextPart()){if(0===q)return!1;f.segmentLength=this.calculateSegLength(this._path,f.segment);f.isPartEnd=!0;1===q?(f.abscissa=f.segmentLength,f.isPathEnd=!0):f.abscissa=f.segmentLength+e;return!0}this._currentPosition.copyTo(f)}f.abscissa+=e*this._partLengthRatio;
g&&(0===g.length&&(0===h?(e=this._path[f.segment],g.push([e[0],e[1]])):g.push(this.getSegCoord2D(this._path,f.segment,h))),e=f.abscissa/f.segmentLength,1===e?(e=this._path[f.segment+1],g.push([e[0],e[1]])):g.push(this.getSegCoord2D(this._path,f.segment,e)));!this._partSegCount&&Math.abs(f.abscissa-f.segmentLength)<this._tolerance&&(f.isPathEnd=this._partIsLast,f.isPartEnd=!0);return!0};a._getPoint=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegCoord2D(this._path,e.segment,
0>=e.segmentLength?0:e.abscissa/e.segmentLength)};a._getAngle=function(e){if(-1===e.segment)throw Error("missing segment");return this.getSegAngleCS(this._path,e.segment,0>=e.segmentLength?0:e.abscissa/e.segmentLength)};a.setPosAtNextPart=function(){for(;this._partSegCount;)this.hasNextSegment()&&this.nextSegment(),this._partSegCount--;if(!this.hasNextSegment())return!1;this._partLength=0;this._partIsLast=!0;for(this._partSegCount=0;this.hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,
this.nextSegment()),this._partSegCount++,1===D.getId(this._path[this.getEndPointIndex()])){this._partIsLast=!this.hasNextSegment();break}for(var e=this._partSegCount;e;)this.previousSegment(),--e;this._currentPosition.segment=this.nextSegment();this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment);this._currentPosition.abscissa=0;this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1;--this._partSegCount;e=this.getStartPointIndex();this._ctrlPtBegin=
1===D.getId(this._path[e]);e=e+this._partSegCount+1;e>=this._path.length&&(e=0);this._ctrlPtEnd=1===D.getId(this._path[e]);if(0<this._patternLength){e=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap;const f=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let g=Math.round((this._partLength-(e+f))/this._patternLength);0>=g&&(g=0<e+f?0:1);this._partLengthRatio=this._partLength/(e+f+g*this._patternLength);.01>this._partLengthRatio&&(this._partLengthRatio=1)}else this._partLengthRatio=
1;return!0};a.hasNextSegment=function(){return this._seg<this._path.length-2};a.previousSegment=function(){return--this._seg};a.nextSegment=function(){return++this._seg};a.getStartPointIndex=function(){return this._seg};a.getEndPointIndex=function(){return this._seg+1};return d}(C.CurveHelper);z.DashPattern=A;z.GeometryWalker=c;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectDonut":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],
function(z,E,D){let C=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(c,b,d){return new A(c,b,d)};return m}();C.instance=null;let A=function(){function m(c,b,d){this._inputGeometries=c;this._curveHelper=new D.CurveHelper;this._width=(void 0!==b.width?b.width:2)*d;switch(b.method){default:this._method="Mitered";break;case "Bevelled":this._method="Bevelled";break;case "Rounded":case "TrueBuffer":this._method="Rounded";
break;case "Square":this._method="Square"}this._option=b.option;this._offsetFlattenError=D.PIXEL_TOLERANCE*d;this._option}m.prototype.next=function(){for(var c=this._inputGeometries.next();c;){if(E.isExtent(c)&&0<this._width){if(0>Math.min(c.xmax-c.xmin,c.ymax-c.ymin)-2*this._width)return c;var b=[];b.push([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]);b.push([[c.xmin+this._width,c.ymin+this._width],[c.xmax-this._width,c.ymin+this._width],[c.xmax-this._width,c.ymax-
this._width],[c.xmin+this._width,c.ymax-this._width],[c.xmin+this._width,c.ymin+this._width]]);return{rings:b}}if(E.isPolygon(c)&&0<this._width){b=[];for(const d of c.rings){c=this._curveHelper.calculatePathLength(d);const a=this._curveHelper.offset(d,this._width,this._method,4,this._offsetFlattenError);a&&(0>c&&a.reverse(),b.push(a))}if(b.length)return{rings:b}}c=this._inputGeometries.next()}return null};return m}();z.EffectDonut=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectJog":function(){define(["exports",
"../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(c){function b(d,a,e){d=c.call(this,d,!1,!0)||this;d._curveHelper=new C.CurveHelper;d._length=(void 0!==a.length?a.length:20)*e;d._angle=void 0!==a.angle?a.angle:225;d._position=void 0!==a.position?a.position:
50;0>d._length&&(d._length=-d._length);20>d._position&&(d._position=20);80<d._position&&(d._position=80);d._mirror=!1;return d}E._inheritsLoose(b,c);b.prototype.processPath=function(d){if(this._curveHelper.isEmpty(d,!1))return null;const a=d[0];d=d[d.length-1];this._curveHelper.normalize([d[0]-a[0],d[1]-a[1]]);const e=[a[0]+(d[0]-a[0])*this._position/100,a[1]+(d[1]-a[1])*this._position/100],f=Math.cos((90-this._angle)/180*Math.PI);let g=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(g=-g);
this._mirror=!this._mirror;return{paths:[[a,[e[0]-this._length/2*f,e[1]-this._length/2*g],[e[0]+this._length/2*f,e[1]+this._length/2*g],d]]}};return b}(D.PathGeometryCursor);z.EffectJog=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectMove":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils"],function(z,E,D){let C=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=
function(c,b,d){return new A(c,b,d)};return m}();C.instance=null;let A=function(){function m(b,d,a){this._inputGeometries=b;this._offsetX=void 0!==d.offsetX?d.offsetX*a:0;this._offsetY=void 0!==d.offsetY?-d.offsetY*a:0}var c=m.prototype;c.next=function(){for(var b=this._inputGeometries.next();b;){if(D.isExtent(b))return{xmin:b.xmin+this._offsetX,xmax:b.xmax+this._offsetX,ymin:b.ymin+this._offsetY,ymax:b.ymax+this._offsetY};if(D.isPolygon(b))return b=E.clone(b),this._moveMultipath(b.rings,this._offsetX,
this._offsetY),b;if(D.isPolyline(b))return b=E.clone(b),this._moveMultipath(b.paths,this._offsetX,this._offsetY),b;if(D.isMultipoint(b))return b=E.clone(b),this._movePath(b.points,this._offsetX,this._offsetY),b;if(D.isPoint(b))return{x:b.x+this._offsetX,y:b.y+this._offsetY};b=this._inputGeometries.next()}return null};c._moveMultipath=function(b,d,a){if(b)for(const e of b)this._movePath(e,d,a)};c._movePath=function(b,d,a){if(b)for(const e of b)e[0]+=d,e[1]+=a};return m}();z.EffectMove=C;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectOffset":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper"],function(z,E,D){let C=function(){function m(){}m.local=function(){null===m.instance&&(m.instance=new m);return m.instance};m.prototype.execute=function(c,b,d){return new A(c,b,d)};return m}();C.instance=null;let A=function(){function m(c,b,d){this._inputGeometries=c;this._curveHelper=new D.CurveHelper;this._offset=(void 0!==b.offset?b.offset:1)*d;
this._method=b.method;this._option=b.option;this._offsetFlattenError=D.PIXEL_TOLERANCE*d;this._option}m.prototype.next=function(){for(var c=this._inputGeometries.next();c;){if(0===this._offset)return c;if(E.isExtent(c)){if("Rounded"===this._method&&0<this._offset){var b=this._curveHelper.offset([[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]],this._offset,this._method,4,this._offsetFlattenError);return b?{rings:[b]}:null}if(0<Math.min(c.xmax-c.xmin,c.ymax-c.ymin)+
2*this._offset)return{xmin:c.xmin-this._offset,xmax:c.xmax+this._offset,ymin:c.ymin-this._offset,ymax:c.ymax+this._offset}}if(E.isPolygon(c)){var d=[];for(b of c.rings){const a=this._curveHelper.offset(b,this._offset,this._method,4,this._offsetFlattenError);a&&d.push(a)}if(d.length)return{rings:d}}if(E.isPolyline(c)){d=[];for(const a of c.paths)(c=this._curveHelper.offset(a,this._offset,this._method,4,this._offsetFlattenError))&&d.push(c);if(d.length)return{paths:d}}c=this._inputGeometries.next()}return null};
return m}();z.EffectOffset=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectReverse":function(){define(["exports","../../../core/lang","../../../geometry/support/jsonUtils","../CIMCursor"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(){function c(b,d,a){this._inputGeometries=b;this._reverse=
void 0!==d.reverse?d.reverse:!0}c.prototype.next=function(){for(var b=this._inputGeometries.next();b;){if(!this._reverse)return b;if(D.isPolyline(b))return b=E.clone(b),C.reverseMultipath(b.paths),b;b=this._inputGeometries.next()}return null};return c}();z.EffectReverse=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectRotate":function(){define(["exports","../../../core/lang","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils","../../../geometry/support/aaBoundingRect"],
function(z,E,D,C,A){let m=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,e){return new c(d,a,e)};return b}();m.instance=null;let c=function(){function b(a,e,f){this._inputGeometries=a;this._rotateAngle=void 0!==e.angle?-e.angle*Math.PI/180:0}var d=b.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(0===this._rotateAngle)return a;var e=A.create();D.getBoundsXY(e,a);const f=(e[2]+e[0])/2;e=
(e[3]+e[1])/2;if(C.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._rotateMultipath(a.rings,f,e),a;if(C.isPolygon(a))return a=E.clone(a),this._rotateMultipath(a.rings,f,e),a;if(C.isPolyline(a))return a=E.clone(a),this._rotateMultipath(a.paths,f,e),a;if(C.isMultipoint(a))return a=E.clone(a),this._rotatePath(a.points,f,e),a;if(C.isPoint(a))return a;a=this._inputGeometries.next()}return null};d._rotateMultipath=function(a,e,f){if(a)for(const g of a)this._rotatePath(g,
e,f)};d._rotatePath=function(a,e,f){if(a){const g=Math.cos(this._rotateAngle),q=Math.sin(this._rotateAngle);for(const h of a){a=h[0]-e;const n=h[1]-f;h[0]=e+a*g-n*q;h[1]=f+a*q+n*g}}};return b}();z.EffectRotate=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectScale":function(){define(["exports","../../../core/lang","../../../geometry/support/boundsUtils","../../../geometry/support/jsonUtils","../../../geometry/support/aaBoundingRect"],function(z,E,D,C,A){let m=
function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,e){return new c(d,a,e)};return b}();m.instance=null;let c=function(){function b(a,e,f){this._inputGeometries=a;this._xFactor=void 0!==e.xScaleFactor?e.xScaleFactor:1.15;this._yFactor=void 0!==e.yScaleFactor?e.yScaleFactor:1.15}var d=b.prototype;d.next=function(){for(var a=this._inputGeometries.next();a;){if(1===this._xFactor&&1===this._yFactor)return a;var e=A.create();
D.getBoundsXY(e,a);const f=(e[2]+e[0])/2;e=(e[3]+e[1])/2;if(C.isExtent(a))return a={rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]]},this._scaleMultipath(a.rings,f,e),a;if(C.isPolygon(a))return a=E.clone(a),this._scaleMultipath(a.rings,f,e),a;if(C.isPolyline(a))return a=E.clone(a),this._scaleMultipath(a.paths,f,e),a;if(C.isMultipoint(a))return a=E.clone(a),this._scalePath(a.points,f,e),a;if(C.isPoint(a))return a;a=this._inputGeometries.next()}return null};
d._scaleMultipath=function(a,e,f){if(a)for(const g of a)this._scalePath(g,e,f)};d._scalePath=function(a,e,f){if(a)for(const g of a)a=(g[1]-f)*this._yFactor,g[0]=e+(g[0]-e)*this._xFactor,g[1]=f+a};return b}();z.EffectScale=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/effects/EffectWave":function(){define(["exports","../../../geometry/support/jsonUtils","../CurveHelper","../GeometryWalker"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&
(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(){function c(d,a,e){this._inputGeometries=d;this._height=(void 0!==a.amplitude?a.amplitude:2)*e;this._period=(void 0!==a.period?a.period:3)*e;this._style=a.waveform;0>=this._height&&(this._height=Math.abs(this._height));0>=this._period&&(this._period=Math.abs(this._period));this._pattern=new C.DashPattern;this._pattern.addValue(this._period);this._pattern.addValue(this._period);
this._walker=new C.GeometryWalker;this._walker.updateTolerance(e)}var b=c.prototype;b.next=function(){for(var d=this._inputGeometries.next();d;){if(0===this._height||0===this._period)return d;if(E.isPolyline(d)){const a=this._processGeom(d.paths);if(a.length)return{paths:a}}if(E.isPolygon(d)&&(d=this._processGeom(d.rings),d.length))return{rings:d};d=this._inputGeometries.next()}return null};b._processGeom=function(d){const a=[];for(const e of d)if(this._walker.init(e,this._pattern))switch(this._style){default:a.push(this._constructCurve(e,
!1));break;case "Square":a.push(this._constructSquare(e));break;case "Triangle":a.push(this._constructTriangle(e));break;case "Random":a.push(this._constructCurve(e,!0))}else a.push(e);return a};b._constructCurve=function(d,a){const e=new D.PathHelper;var f=this._walker.calculatePathLength(d),g=Math.round(f/this._period);0===g&&(g=1);const q=this._period/16,h=1/(16*g+1);f=2*Math.PI*f/(f/g);g=2*Math.PI*Math.random();const n=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),t=.75-Math.random()/2,k=
.75-Math.random()/2,v={};this._walker.curPointAndAngle(v);e.startPath(v.pt);let p=0;for(;;)if(this._walker.nextPointAndAngle(q,v)){const r=p;p+=h;let w;if(a){const l=this._height/2*(1+.3*Math.sin(t*f*r+g));w=l*Math.sin(f*r+n);w+=l*Math.sin(k*f*r+u);w/=2}else w=.5*this._height*Math.sin(.5*f*r);e.lineTo([v.pt[0]-w*v.sa,v.pt[1]+w*v.ca])}else{e.lineTo(d[d.length-1]);break}return e.path()};b._constructSquare=function(d){const a=new D.PathHelper;d=this._walker.calculatePathLength(d);d=Math.round(d/this._period);
0===d&&(d=1);for(d=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const g={};if(this._walker.nextPointAndAngle(this._period,g)){const q={};this._walker.nextPointAndAngle(this._period,q)&&(d?(a.startPath(f.pt),d=!1):a.lineTo(f.pt),a.lineTo([f.pt[0]-this._height/2*f.sa,f.pt[1]+this._height/2*f.ca]),a.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),a.lineTo([g.pt[0]+this._height/2*g.sa,g.pt[1]-this._height/2*g.ca]),a.lineTo([q.pt[0]+
this._height/2*q.sa,q.pt[1]-this._height/2*q.ca]),e=!0)}}if(!e){a.lineTo(this._walker.getPathEnd());break}}return a.path()};b._constructTriangle=function(d){const a=new D.PathHelper;d=this._walker.calculatePathLength(d);d=Math.round(d/this._period);0===d&&(d=1);for(d=!0;;){let e=!1;if(this._walker.curPositionIsValid()){const f={};this._walker.curPointAndAngle(f);const g={};if(this._walker.nextPointAndAngle(this._period/2,g)){const q={};this._walker.nextPointAndAngle(this._period,q)&&(this._walker.nextPosition(this._period/
2)&&(d?(a.startPath(f.pt),d=!1):a.lineTo(f.pt),a.lineTo([g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca]),a.lineTo([q.pt[0]+this._height/2*q.sa,q.pt[1]-this._height/2*q.ca])),e=!0)}}if(!e){a.lineTo(this._walker.getPathEnd());break}}return a.path()};return c}();z.EffectWave=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAlongLineSameSize":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker",
"../enums"],function(z,E,D,C,A){let m=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,e){return new c(d,a,e)};return b}();m.instance=null;let c=function(b){function d(e,f,g){e=b.call(this,e,!0,!0)||this;e._grometryWalker=new C.GeometryWalker;e._grometryWalker.updateTolerance(g);e._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;e._offset=void 0!==f.offset?f.offset*g:0;e._originalEndings=f.endings;e._offsetAtEnd=
void 0!==f.customEndingOffset?f.customEndingOffset*g:0;e._position=void 0!==f.offsetAlongLine?f.offsetAlongLine*g:0;e._pattern=new C.DashPattern;e._pattern.init(f.placementTemplate,!1);e._pattern.scale(g);e._endings=e._originalEndings;return e}E._inheritsLoose(d,b);var a=d.prototype;a.processPath=function(e){if(this._pattern.isEmpty())return null;if(this.iteratePath)var f=this._pattern.nextValue();else{this._endings=this._originalEndings===A.PlacementEndings.WithFullGap&&this.isClosed?A.PlacementEndings.WithMarkers:
this._originalEndings;this._pattern.extPtGap=0;let g=!0;switch(this._endings){case A.PlacementEndings.NoConstraint:f=-this._position;f=this._adjustPosition(f);g=!1;break;default:f=-this._pattern.lastValue()/2;break;case A.PlacementEndings.WithFullGap:f=-this._pattern.lastValue();this._pattern.extPtGap=this._pattern.lastValue();break;case A.PlacementEndings.WithMarkers:f=0;break;case A.PlacementEndings.Custom:f=-this._position,f=this._adjustPosition(f),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._grometryWalker.init(e,
this._pattern,g))return null;this._pattern.reset();for(e=0;f>e;)f-=e,e=this._pattern.nextValue();f=e-=f;this.iteratePath=!0}e={};if(!this._grometryWalker.nextPointAndAngle(f,e)||this._endings===A.PlacementEndings.WithFullGap&&this._grometryWalker.isPathEnd())return this.iteratePath=!1,null;if(this._endings===A.PlacementEndings.WithMarkers&&this._grometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed))return null;this.internalPlacement.setTranslate(e.pt[0]+this._offset*e.sa,e.pt[1]-this._offset*
e.ca);this._angleToLine&&this.internalPlacement.setRotateCS(e.ca,e.sa);return this.internalPlacement};a._adjustPosition=function(e){e/=this._pattern.length();e-=Math.floor(e);return e*this._pattern.length()};return d}(D.PathTransformationCursor);z.PlacementAlongLineSameSize=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/enums":function(){define(["exports"],function(z){var E=z.PlacementEndings||(z.PlacementEndings={});E.NoConstraint="NoConstraint";E.WithMarkers="WithMarkers";
E.WithFullGap="WithFullGap";E.WithHalfGap="WithHalfGap";E.Custom="Custom";Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtExtremities":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=
function(c){function b(a,e,f){a=c.call(this,a,!1,!0)||this;a._curveHelper=new C.CurveHelper;a._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;a._offset=void 0!==e.offset?e.offset*f:0;a._type=e.extremityPlacement;a._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*f:0;a._beginProcessed=!1;return a}E._inheritsLoose(b,c);var d=b.prototype;d.processPath=function(a){let e;switch(this._type){default:this._beginProcessed?(e=this._atExtremities(a,this._position,!1),this.iteratePath=this._beginProcessed=
!1):(e=this._atExtremities(a,this._position,!0),this.iteratePath=this._beginProcessed=!0);break;case "JustBegin":e=this._atExtremities(a,this._position,!0);break;case "JustEnd":e=this._atExtremities(a,this._position,!1);case "None":}return e};d._atExtremities=function(a,e,f){var g=a.length;if(2>g)return null;var q=f?1:g-2;const h=f?g:-1,n=f?1:-1;let u=0;f=f?a[0]:a[g-1];for(g=q;g!==h;g+=n){q=f;f=a[g];const t=this._curveHelper.calculateLength(q,f);if(u+t>e){a=(e-u)/t;const [k,v]=this._curveHelper.getAngleCS(q,
f,a);a=D.getCoord2D(q,f,a);this.internalPlacement.setTranslate(a[0]-this._offset*v,a[1]+this._offset*k);this._angleToLine&&this.internalPlacement.setRotateCS(-k,-v);return this.internalPlacement}u+=t}return null};return b}(D.PathTransformationCursor);z.PlacementAtExtremities=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementAtRatioPositions":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../GeometryWalker"],function(z,
E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(c){function b(d,a,e){d=c.call(this,d,!0,!0)||this;d._walker=new C.GeometryWalker;d._walker.updateTolerance(e);d._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;d._offset=void 0!==a.offset?a.offset*e:0;d._beginGap=void 0!==a.beginPosition?a.beginPosition*e:0;d._endGap=void 0!==a.endPosition?
a.endPosition*e:0;d._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;d._pattern=new C.DashPattern;d._pattern.init(a.positionArray,!1,!1);d._subPathLen=0;d._posCount=d._pattern.size();d._isFirst=!0;d._prevPos=0;return d}E._inheritsLoose(b,c);b.prototype.processPath=function(d){if(this._pattern.isEmpty())return null;if(this.iteratePath){d=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=
0;this._subPathLen=this._walker.calculatePathLength(d)-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(d,this._pattern,!1))return null;this._pattern.reset();d=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+d;d=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a={};if(!this._walker.nextPointAndAngle(d,a,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]+this._offset*a.sa,a.pt[1]-this._offset*a.ca);d=
this._isFirst&&this._flipFirst;let e;this._angleToLine?(e=a.ca,a=a.sa):(e=1,a=0);d&&(e=-e,a=-a);this.internalPlacement.setRotateCS(e,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement};return b}(D.PathTransformationCursor);z.PlacementAtRatioPositions=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementInsidePolygon":function(){define(["exports","../CIMPlacements"],function(z,E){let D=function(){function A(){}
A.local=function(){null===A.instance&&(A.instance=new A);return A.instance};A.prototype.execute=function(m,c,b){return new C(m,c,b)};return A}();D.instance=null;let C=function(){function A(c,b,d){this._currentY=this._currentX=this._yMax=this._yMin=this._xMax=this._xMin=0;this._stepX=(void 0!==b.stepX?Math.abs(b.stepX):16)*d;this._stepY=(void 0!==b.stepY?Math.abs(b.stepY):16)*d;if(0!==this._stepX&&0!==this._stepY&&c&&void 0!==c.rings&&c.rings){this._gridType=void 0!==b.gridType?b.gridType:"Fixed";
if("Random"===this._gridType)this._randomness=void 0!==b.randomness?b.randomness/100:1,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._offsetY=this._offsetX=this._sinAngle=0;else{this._randomness=0;this._gridAngle=void 0!==b.gridAngle?b.gridAngle:0;this._shiftOddRows=void 0!==b.shiftOddRows?b.shiftOddRows:!1;this._offsetX=void 0!==b.offsetX?b.offsetX*d:0;this._offsetY=void 0!==b.offsetY?b.offsetY*d:0;this._cosAngle=Math.cos(this._gridAngle/180*Math.PI);this._sinAngle=-Math.sin(this._gridAngle/
180*Math.PI);if(this._stepX)if(0>this._offsetX)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(0>this._offsetY)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}this._graphicOriginY=this._graphicOriginX=0;this._internalPlacement=new E.Placement;this._calculateMinMax(c);this._geometry=c}}var m=A.prototype;m.next=function(){return this._geometry?
this._nextInside():null};m._calculateMinMax=function(c){this._yMax=this._yMin=this._xMax=this._xMin=0;let b,d,a,e,f;d=a=Number.MAX_VALUE;e=f=-Number.MAX_VALUE;for(const q of c.rings){const h=q?q.length:0;for(let n=0;n<h;++n){var g=q[n][0]-this._graphicOriginX-this._offsetX;b=q[n][1]-this._graphicOriginY-this._offsetY;c=this._cosAngle*g-this._sinAngle*b;g=this._sinAngle*g+this._cosAngle*b;d=Math.min(d,c);e=Math.max(e,c);a=Math.min(a,g);f=Math.max(f,g)}}d+=this._graphicOriginX;e+=this._graphicOriginX;
a+=this._graphicOriginY;f+=this._graphicOriginY;this._xMin=Math.round(d/this._stepX);this._xMax=Math.round(e/this._stepX);this._yMin=Math.round(a/this._stepY);this._yMax=Math.round(f/this._stepY);this._currentX=this._xMax+1;this._currentY=this._yMin-1};m._nextInside=function(){for(;;){if(this._currentX>this._xMax){this._currentY++;if(this._currentY>this._yMax)return null;this._currentX=this._xMin;this._shiftOddRows&&this._currentY%2&&this._currentX--}var c=this._currentX*this._stepX+this._offsetX;
this._shiftOddRows&&this._currentY%2&&(c+=.5*this._stepX);const b=this._currentY*this._stepY+this._offsetY;this._currentX++;let d;"Random"===this._gridType?(d=this._graphicOriginX+c+this._stepX*this._randomness*(.5-Math.random())*2/3,c=this._graphicOriginY+b+this._stepY*this._randomness*(.5-Math.random())*2/3):(d=this._graphicOriginX+this._cosAngle*c+this._sinAngle*b,c=this._graphicOriginY-this._sinAngle*c+this._cosAngle*b);this._internalPlacement.setTranslate(d,c);return this._internalPlacement}};
return A}();z.PlacementInsidePolygon=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnLine":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(c){function b(a,e,f){a=c.call(this,
a,!0,!0)||this;a._curveHelper=new C.CurveHelper;a._angleToLine=void 0!==e.angleToLine?e.angleToLine:!0;a._offset=void 0!==e.offset?e.offset*f:0;a._relativeTo=e.relativeTo;a._position=void 0!==e.startPointOffset?e.startPointOffset*f:0;a._epsilon=.001*f;return a}E._inheritsLoose(b,c);var d=b.prototype;d.processPath=function(a){var e=this._position;if("SegmentMidpoint"===this._relativeTo){this.iteratePath||(this._segmentCount=a.length,this._curSegment=1,this.iteratePath=!0);for(;this._curSegment<this._segmentCount;){var f=
this._curSegment;this._curSegment++;e=a[f-1];f=a[f];const g=this._curveHelper.calculateLength(e,f);if(g<this._epsilon)continue;a=.5+this._position/g;const [q,h]=this._curveHelper.getAngleCS(e,f,a);a=D.getCoord2D(e,f,a);this.internalPlacement.setTranslate(a[0]-this._offset*h,a[1]+this._offset*q);this._angleToLine&&this.internalPlacement.setRotateCS(q,h);return this.internalPlacement}this.iteratePath=!1;return null}"LineEnd"===this._relativeTo&&D.reversePath(a);e=this.onLine(a,e);"LineEnd"===this._relativeTo&&
D.reversePath(a);return e};d.onLine=function(a,e){let f,g=!1;switch(this._relativeTo){default:f=this._curveHelper.calculatePathLength(a)/2+e;break;case "LineBeginning":f=e;break;case "LineEnd":f=e,g=!0}const q=a.length;let h=0,n=a[0];for(let u=1;u<q;++u){e=n;n=a[u];const t=this._curveHelper.calculateLength(e,n);if(h+t>f){a=(f-h)/t;const [k,v]=this._curveHelper.getAngleCS(e,n,a);a=D.getCoord2D(e,n,a);e=g?this._offset:-this._offset;this.internalPlacement.setTranslate(a[0]-e*v,a[1]+e*k);this._angleToLine&&
(g?this.internalPlacement.setRotateCS(-k,-v):this.internalPlacement.setRotateCS(k,v));return this.internalPlacement}h+=t}return null};return b}(D.PathTransformationCursor);z.PlacementOnLine=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementOnVertices":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","../CIMCursor","../CurveHelper"],function(z,E,D,C){function A(b,d){const a=Math.PI;for(;Math.abs(d-b)>a+2E-15;)d=d-b>a?d-2*a:d+2*a;return(b+
d)/2}let m=function(){function b(){}b.local=function(){null===b.instance&&(b.instance=new b);return b.instance};b.prototype.execute=function(d,a,e){return new c(d,a,e)};return b}();m.instance=null;let c=function(b){function d(e,f,g){e=b.call(this,e,!0,!0)||this;e._curveHelper=new C.CurveHelper;e._angleToLine=void 0!==f.angleToLine?f.angleToLine:!0;e._offset=void 0!==f.offset?f.offset*g:0;e._endPoints=void 0!==f.placeOnEndPoints?f.placeOnEndPoints:!0;e._controlPoints=void 0!==f.placeOnControlPoints?
f.placeOnControlPoints:!0;e._regularVertices=void 0!==f.placeOnRegularVertices?f.placeOnRegularVertices:!0;e._tags=[];e._tagIterator=0;return e}E._inheritsLoose(d,b);var a=d.prototype;a.processPath=function(e){this.iteratePath||(this._preparePath(e),this.iteratePath=!0);if(this._tagIterator>=this._tags.length)return this._tagIterator=this._tags.length=0,this.iteratePath=!1,null;e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);let f=e[0],g=e[1];if(0!==this._offset){const q=
Math.cos(e[2]);f-=this._offset*Math.sin(e[2]);g+=this._offset*q}this.internalPlacement.setTranslate(f,g);this._tagIterator++;return this.internalPlacement};a._preparePath=function(e){this._tagIterator=this._tags.length=0;const f=D.isClosedPath(e),g=e.length-1;let q=0,h=0,n=0,u=0,t=0,k,v;for(;q<g;){q++;k=e[q-1];v=e[q];const p=D.getId(k),r=D.getId(v);if(this._angleToLine||0!==this._offset)u=this._curveHelper.getAngle(k,v,0);1===q?f?(h=u,n=p):this._endPoints&&this._tags.push([k[0],k[1],u]):1===p?this._controlPoints&&
this._tags.push([k[0],k[1],A(t,u)]):this._regularVertices&&this._tags.push([k[0],k[1],A(t,u)]);if(this._angleToLine||0!==this._offset)t=this._curveHelper.getAngle(k,v,1);q===g&&(f?1===r||1===n?this._controlPoints&&this._tags.push([v[0],v[1],A(t,h)]):this._regularVertices&&this._tags.push([v[0],v[1],A(t,h)]):this._endPoints&&this._tags.push([v[0],v[1],t]))}this._tagIterator=0};return d}(D.PathTransformationCursor);z.PlacementOnVertices=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/placements/PlacementPolygonCenter":function(){define(["exports",
"../../../geometry/support/boundsUtils","../../../geometry/support/aaBoundingRect","../CIMPlacements"],function(z,E,D,C){let A=function(){function c(){}c.local=function(){null===c.instance&&(c.instance=new c);return c.instance};c.prototype.execute=function(b,d,a){return new m(b,d,a)};return c}();A.instance=null;let m=function(){function c(d,a,e){this._geometry=d;this._offsetX=void 0!==a.offsetX?a.offsetX*e:0;this._offsetY=void 0!==a.offsetY?a.offsetY*e:0;this._method=void 0!==a.method?a.method:"OnPolygon";
this._internalPlacement=new C.Placement}var b=c.prototype;b.next=function(){const d=this._geometry;this._geometry=null;return d&&void 0!==d.rings?this._polygonCenter(d):null};b._polygonCenter=function(d){switch(this._method){default:case "CenterOfMass":case "BoundingBoxCenter":{const a=D.create();E.getBoundsXY(a,d);this._internalPlacement.setTranslate((a[2]+a[0])/2+this._offsetX,(a[3]+a[1])/2-this._offsetY)}}return this._internalPlacement};return c}();z.PlacementPolygonCenter=A;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/symbols/cim/packingUtils":function(){define(["exports"],function(z){function E(c,b=0){let d=0;for(let a=0;4>a;a++)d+=c[b+a]*A[a];return d}function D(c){return c-Math.floor(c)}const C=[1,256,65536,16777216],A=[1/256,1/65536,1/16777216,1/4294967296],m=E(new Uint8ClampedArray([255,255,255,255]));z.packFloatRGBA=function(c,b,d=0){c=0>c?0:c>m?m:c;for(let a=0;4>a;a++)b[d+a]=Math.floor(256*D(c*C[a]))};z.unpackFloatRGBA=E;Object.defineProperty(z,"__esModule",{value:!0})})},
"esri/symbols/cim/SDFHelper":function(){define(["exports","../../geometry/support/jsonUtils","./Rect","./packingUtils"],function(z,E,D,C){function A(c){if(!c)return null;switch(c.type){case "CIMPointSymbol":c=c.symbolLayers;if(!c||1!==c.length)break;return A(c[0]);case "CIMVectorMarker":c=c.markerGraphics;if(!c||1!==c.length)break;var b=c[0];if(!b)break;c=b.geometry;if(!c)break;b=b.symbol;if(!b||"CIMPolygonSymbol"!==b.type&&"CIMLineSymbol"!==b.type)break;return{geom:c,asFill:"CIMPolygonSymbol"===
b.type};case "sdf":return{geom:c.geom,asFill:c.asFill}}return null}function m(c){let b=Infinity,d=-Infinity,a=Infinity,e=-Infinity;for(const f of c)for(const g of f)g[0]<b&&(b=g[0]),g[0]>d&&(d=g[0]),g[1]<a&&(a=g[1]),g[1]>e&&(e=g[1]);return[b,a,d,e]}z.buildSDF=function(c){var b=c.geom;var d=b?b.rings?b.rings:b.paths?b.paths:void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]:null:null;b=Infinity;var a=
-Infinity;var e=Infinity,f=-Infinity;for(var g of d)for(var q of g)q[0]<b&&(b=q[0]),q[0]>a&&(a=q[0]),q[1]<e&&(e=q[1]),q[1]>f&&(f=q[1]);a=new D(b,e,a-b,f-e);e=64/Math.max(a.width,a.height);g=Math.round(a.width*e)+62;q=Math.round(a.height*e)+62;b=[];for(var h of d)if(h&&1<h.length){d=[];for(var n of h){let [y,B]=n;y-=a.x;B-=a.y;y*=e;B*=e;y+=30.5;B+=30.5;d.push([y,B])}c.asFill&&(f=d.length-1,d[0][0]===d[f][0]&&d[0][1]===d[f][1]||d.push(d[0]));b.push(d)}var u;h=g*q;n=Array(h);for(d=0;d<h;++d)n[d]=962;
for(u of b)for(d=u.length,a=1;a<d;++a){e=u[a-1];f=u[a];var t=void 0,k=void 0;e[0]<f[0]?(t=e[0],k=f[0]):(t=f[0],k=e[0]);var v=void 0,p=void 0;e[1]<f[1]?(v=e[1],p=f[1]):(v=f[1],p=e[1]);var r=Math.floor(t)-31;k=Math.floor(k)+31;v=Math.floor(v)-31;p=Math.floor(p)+31;0>r&&(r=0);k>g&&(k=g);0>v&&(v=0);p>q&&(p=q);t=f[0]-e[0];const y=f[1]-e[1],B=t*t+y*y;for(;r<k;r++)for(let F=v;F<p;F++){var w=(r-e[0])*t+(F-e[1])*y,l=void 0;0>w?(l=e[0],w=e[1]):w>B?(l=f[0],w=f[1]):(w/=B,l=e[0]+w*t,w=e[1]+w*y);l=(r-l)*(r-l)+
(F-w)*(F-w);w=(q-F-1)*g+r;l<n[w]&&(n[w]=l)}}for(u=0;u<h;++u)n[u]=Math.sqrt(n[u]);u=n;if(c.asFill)for(var x of b)for(c=x.length,b=1;b<c;++b)for(h=x[b-1],n=x[b],h[0]<n[0]?(d=h[0],a=n[0]):(d=n[0],a=h[0]),h[1]<n[1]?(f=h[1],e=n[1]):(f=n[1],e=h[1]),d=Math.floor(d),a=Math.floor(a)+1,f=Math.floor(f),e=Math.floor(e)+1,31>d&&(d=31),a>g-31&&(a=g-31),31>f&&(f=31),e>q-31&&(e=q-31);f<e;++f)if(h[1]>f!==n[1]>f){k=(q-f-1)*g;for(v=d;v<a;++v)v<(n[0]-h[0])*(f-h[1])/(n[1]-h[1])+h[0]&&(u[k+v]=-u[k+v]);for(v=31;v<d;++v)u[k+
v]=-u[k+v]}x=u.length;c=new Uint8Array(4*x);for(b=0;b<x;++b)C.packFloatRGBA(.5-u[b]/62,c,4*b);x=c;return[x,g,q]};z.getExtent=function(c){return c?c.rings?m(c.rings):c.paths?m(c.paths):E.isExtent(c)?[c.xmin,c.ymin,c.xmax,c.ymax]:null:null};z.getSDFInfo=A;z.getSDFMetrics=function(c,b,d,a,e){const [f,g,q,h]=c;if(q<f||h<g)return[0,0,0];var n=q-f,u=h-g;c=64/Math.max(n,u);n=Math.round(n*c);u=Math.round(u*c)+62;let t=1;b&&(t=u/c/(b.ymax-b.ymin));let k=0,v=0;a&&(e?b&&d&&0<b.ymax-b.ymin&&(k=a.x/((b.xmax-b.xmin)/
(b.ymax-b.ymin)*d),v=a.y/d):(k=a.x,v=a.y));k=.5*(b.xmax+b.xmin)+k*(b.xmax-b.xmin);v=.5*(b.ymax+b.ymin)+v*(b.ymax-b.ymin);k=(k-f)*c+31;v=(v-g)*c+31;return[t,k/(n+62)-.5,-(v/u-.5)]};z.getSDFSymbol=function(c){c=c.markerGraphics;if(!c||1!==c.length)return null;c=c[0];if(!c)return null;c=c.symbol;return!c||"CIMPolygonSymbol"!==c.type&&"CIMLineSymbol"!==c.type?null:c};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["exports"],function(z){function E(D){D=
D.toLowerCase().split(" ").join("-");switch(D){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return D}}z.getFontDecorationTop=function(D){switch(D){case "underline":return-26;case "line-through":return-18}return NaN};z.getFullyQualifiedFontName=function(D){a:{if(D.weight)switch(D.weight.toLowerCase()){case "bold":case "bolder":var C="-bold";break a}C=""}a:{if(D.style)switch(D.style.toLowerCase()){case "italic":case "oblic":var A=
"-italic";break a}A=""}C+=A;return E(D.family)+(0<C.length?C:"-regular")};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("../../../../core/has ../../../../core/promiseUtils ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Rect ./RectangleBinPack".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g){function q(n){const u=new Set;for(const t of n)u.add(Math.floor(t/256));return u}function h(n,u,t){n.has(u)||n.set(u,t().then(()=>{n.delete(u)}).catch(k=>{n.delete(u);E.throwIfNotAbortError(k)}));return n.get(u)}return function(){function n(t,k,v){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphCache={};this._textures=[];this._rangePromises=new Map;this.width=t;this.height=k;this._glyphSource=v;this._binPack=new g(t-4,
k-4);this._glyphData.push(new Uint8Array(t*k));this._dirties.push(!0);this._textures.push(null);this._initDecorationGlyph()}var u=n.prototype;u.dispose=function(){this._binPack=null;for(const t of this._textures)t&&t.dispose();this._textures.length=0;this._glyphData.length=0};u._initDecorationGlyph=function(){var t=[117,149,181,207,207,181,149,117];const k=[];for(let v=0;v<t.length;v++){const p=t[v];for(let r=0;11>r;r++)k.push(p)}t={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(k)};
this._recordGlyph(t)};u.getGlyphItems=async function(t,k,v){const p=this._getGlyphCache(t);await this._fetchRanges(t,k,v);return k.map(r=>this._getMosaicItem(p,t,r))};u.bind=function(t,k,v,p){const r=this._getTexture(t,v);r.setSamplingMode(k);this._dirties[v]&&(r.setData(this._glyphData[v]),this._dirties[v]=!1);t.bindTexture(r,p)};u._getGlyphCache=function(t){this._glyphCache[t]||(this._glyphCache[t]={});return this._glyphCache[t]};u._getTexture=function(t,k){this._textures[k]||(this._textures[k]=
new A(t,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));return this._textures[k]};u._invalidate=function(){this._dirties[this._currentPage]=!0};u._fetchRanges=async function(t,k,v){const p=[];q(k).forEach(r=>{p.push(this._fetchRange(t,r,v))});await E.all(p)};u._fetchRange=async function(t,k,v){return 256<k?null:h(this._rangePromises,t+k,()=>this._glyphSource.getRange(t,k,v))};u._getMosaicItem=function(t,k,v){if(!t[v]){k=this._glyphSource.getGlyph(k,
v);if(!k||!k.metrics)return{rect:new f(0,0,0,0),page:0,metrics:{left:0,width:0,height:0,advance:0,top:0},code:v,sdf:!0};const p=this._recordGlyph(k);t[v]={rect:p,page:this._currentPage,metrics:k.metrics,code:v,sdf:!0};this._invalidate()}return t[v]};u._getMosaicItemsStable=function(t,k,v){const p=[],r=v.map(w=>w);v.map(w=>w).sort().map(w=>this._getMosaicItem(t,k,w)).forEach(w=>{const l=r.indexOf(w.code);p[l]=w;r[l]=null});return p};u._recordGlyph=function(t){var k=t.metrics;if(0===k.width)k=new f(0,
0,0,0);else{const v=k.width+6,p=k.height+6;k=this._binPack.allocate(v,p);k.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(null),this._initDecorationGlyph(),this._binPack=new g(this.width-4,this.height-4),k=this._binPack.allocate(v,p));const r=this._glyphData[this._currentPage];t=t.bitmap;let w,l;if(t)for(let x=0;x<p;x++){w=
v*x;l=this.width*(k.y+x)+k.x;for(let y=0;y<v;y++)r[l+y]=t[w+y]}z("esri-glyph-debug")&&this._showDebugPage(r)}return k};u._showDebugPage=function(t){const k=document.createElement("canvas"),v=k.getContext("2d"),p=new ImageData(this.width,this.height),r=p.data;k.width=this.width;k.height=this.height;k.style.border="1px solid black";for(let w=0;w<t.length;++w)r[4*w]=t[w],r[4*w+1]=0,r[4*w+2]=0,r[4*w+3]=255;v.putImageData(p,0,0);document.body.appendChild(k)};return n}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(z){return function(){function E(D=0,C=0,A=0,m=0){this.x=D;this.y=C;this.width=A;this.height=m}E.prototype.union=function(D){this.x=Math.min(this.x,D.x);this.y=Math.min(this.y,D.y);this.width=Math.max(this.width,D.width);this.height=Math.max(this.height,D.height)};z._createClass(E,[{key:"isEmpty",get:function(){return 0>=this.width||0>=this.height}}]);return E}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Rect"],function(z,
E){return function(){function D(A,m){this._height=this._width=0;this._free=[];this._width=A;this._height=m;this._free.push(new E(0,0,A,m))}var C=D.prototype;C.allocate=function(A,m){if(A>this._width||m>this._height)return new E;let c=null,b=-1;for(let d=0;d<this._free.length;++d){const a=this._free[d];A<=a.width&&m<=a.height&&(null===c||a.y<=c.y&&a.x<=c.x)&&(c=a,b=d)}if(null===c)return new E;this._free.splice(b,1);c.width<c.height?(c.width>A&&this._free.push(new E(c.x+A,c.y,c.width-A,m)),c.height>
m&&this._free.push(new E(c.x,c.y+m,c.width,c.height-m))):(c.width>A&&this._free.push(new E(c.x+A,c.y,c.width-A,c.height)),c.height>m&&this._free.push(new E(c.x,c.y+m,A,c.height-m)));return new E(c.x,c.y,A,m)};C.release=function(A){for(let m=0;m<this._free.length;++m){const c=this._free[m];if(c.y===A.y&&c.height===A.height&&c.x+c.width===A.x)c.width+=A.width;else if(c.x===A.x&&c.width===A.width&&c.y+c.height===A.y)c.height+=A.height;else if(A.y===c.y&&A.height===c.height&&A.x+A.width===c.x)c.x=A.x,
c.width+=A.width;else if(A.x===c.x&&A.width===c.width&&A.y+A.height===c.y)c.y=A.y,c.height+=A.height;else continue;this._free.splice(m,1);this.release(A)}this._free.push(A)};z._createClass(D,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]);return D}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define(["../../../../core/promiseUtils","../../../../request","../../../../core/pbf"],function(z,E,D){let C=function(){function m(b){this._metrics=
[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:{const d=b.getMessage();for(;d.next();)switch(d.tag()){case 3:{const a=d.getMessage();let e,f,g,q,h,n,u;for(;a.next();)switch(a.tag()){case 1:e=a.getUInt32();break;case 2:f=a.getBytes();break;case 3:g=a.getUInt32();break;case 4:q=a.getUInt32();break;case 5:h=a.getSInt32();break;case 6:n=a.getSInt32();break;case 7:u=a.getUInt32();break;default:a.skip()}a.release();e&&(this._metrics[e]={width:g,height:q,left:h,top:n,advance:u},this._bitmaps[e]=
f);break}default:d.skip()}d.release();break}default:b.skip()}}var c=m.prototype;c.getMetrics=function(b){return this._metrics[b]};c.getBitmap=function(b){return this._bitmaps[b]};return m}(),A=function(){function m(){this._ranges=[]}var c=m.prototype;c.getRange=function(b){return this._ranges[b]};c.addRange=function(b,d){this._ranges[b]=d};return m}();return function(){function m(b){this._glyphInfo={};this._baseURL=b}var c=m.prototype;c.getRange=function(b,d,a){const e=this._getFontStack(b);if(e.getRange(d))return z.resolve();
const f=256*d,g=f+255;b=this._baseURL.replace("{fontstack}",b).replace("{range}",f+"-"+g);return E(b,{responseType:"array-buffer",...a}).then(q=>{e.addRange(d,new C(new D(new Uint8Array(q.data),new DataView(q.data))))})};c.getGlyph=function(b,d){if(b=this._getFontStack(b)){var a=Math.floor(d/256);if(!(256<a)&&(b=b.getRange(a)))return{metrics:b.getMetrics(d),bitmap:b.getBitmap(d)}}};c._getFontStack=function(b){let d=this._glyphInfo[b];d||(d=this._glyphInfo[b]=new A);return d};return m}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["../../../../core/promiseUtils",
"./packingUtils"],function(z,E){return function(){function D(A){this.size=A;const m=document.createElement("canvas");m.width=m.height=A;this._context=m.getContext("2d");this._gridOuter=new Float64Array(A*A);this._gridInner=new Float64Array(A*A);this._f=new Float64Array(A);this._d=new Float64Array(A);this._z=new Float64Array(A+1);this._v=new Int16Array(A)}var C=D.prototype;C.dispose=function(){this._context=this._gridOuter=this._gridInner=this._f=this._d=this._z=this._v=null;this._svg&&(document.body.removeChild(this._svg),
this._svg=null)};C.draw=function(A,m,c=31){this._initSVG();const b=this._createSVGString(A);return z.create((d,a)=>{const e=new Image;e.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(b);e.onload=()=>{e.onload=null;this._context.clearRect(0,0,this.size,this.size);this._context.drawImage(e,0,0,this.size,this.size);var g=this._context.getImageData(0,0,this.size,this.size);const q=new Uint8Array(this.size*this.size*4);for(let h=0;h<this.size*this.size;h++){const n=g.data[4*h+3]/255;this._gridOuter[h]=
1===n?0:0===n?1E20:Math.pow(Math.max(0,.5-n),2);this._gridInner[h]=1===n?1E20:0===n?0:Math.pow(Math.max(0,n-.5),2)}this._edt(this._gridOuter,this.size,this.size);this._edt(this._gridInner,this.size,this.size);for(g=0;g<this.size*this.size;g++)E.packFloatRGBA(.5-(this._gridOuter[g]-this._gridInner[g])/(2*c),q,4*g);d(q)};const f=m&&m.signal;if(f)z.onAbort(f,()=>a(z.createAbortError()))})};C._initSVG=function(){if(!this._svg){const A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttribute("style",
"position: absolute;");A.setAttribute("width","0");A.setAttribute("height","0");A.setAttribute("aria-hidden","true");A.setAttribute("role","presentation");document.body.appendChild(A);this._svg=A}};C._createSVGString=function(A){const m=document.createElementNS("http://www.w3.org/2000/svg","path");m.setAttribute("d",A);this._svg.appendChild(m);A=m.getBBox();var c=A.width/A.height;const b=this.size/2;let d,a,e;1<c?(a=d=b/A.width,e=this.size/4,c=b-1/c*b/2):(d=a=b/A.height,e=b-b*c/2,c=this.size/4);m.setAttribute("style",
`transform: matrix(${d}, 0, 0, ${a}, ${-A.x*d+e}, ${-A.y*a+c})`);A=`<svg style="fill:red;" height="${this.size}" width="${this.size}" xmlns="http://www.w3.org/2000/svg">${this._svg.innerHTML}</svg>`;this._svg.removeChild(m);return A};C._edt=function(A,m,c){const b=this._f,d=this._d,a=this._v,e=this._z;for(var f=0;f<m;f++){for(var g=0;g<c;g++)b[g]=A[g*m+f];this._edt1d(b,d,a,e,c);for(g=0;g<c;g++)A[g*m+f]=d[g]}for(f=0;f<c;f++){for(g=0;g<m;g++)b[g]=A[f*m+g];this._edt1d(b,d,a,e,m);for(g=0;g<m;g++)A[f*
m+g]=Math.sqrt(d[g])}};C._edt1d=function(A,m,c,b,d){c[0]=0;b[0]=-1E20;b[1]=1E20;for(let a=1,e=0;a<d;a++){let f=(A[a]+a*a-(A[c[e]]+c[e]*c[e]))/(2*a-2*c[e]);for(;f<=b[e];)e--,f=(A[a]+a*a-(A[c[e]]+c[e]*c[e]))/(2*a-2*c[e]);e++;c[e]=a;b[e]=f;b[e+1]=1E20}for(let a=0,e=0;a<d;a++){for(;b[e+1]<a;)e++;m[a]=(a-c[e])*(a-c[e])+A[c[e]]}};return D}()})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["exports"],function(z){function E(m){return m-Math.floor(m)}const D=[1,256,65536,16777216],C=[1/256,
1/65536,1/16777216,1/4294967296],A=function(m,c=0){let b=0;for(let d=0;4>d;d++)b+=m[c+d]*C[d];return b}(new Uint8ClampedArray([255,255,255,255]));z.packFloatRGBA=function(m,c,b=0){m=0>m?0:m>A?A:m;for(let d=0;4>d;d++)c[b+d]=Math.floor(256*E(m*D[d]))};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/Error ./definitions ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Rect ./GeometryUtils ./RectangleBinPack".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u){function t(k){return k&&"static"===k.type}return function(){function k(p,r,w,l=0){this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=E("fix-sprite-locations");this._testId=E("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=r||0>=w)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=r;this._pageHeight=
w;this._requestRender=p;0<l&&(this._maxItemSize=l);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){p=[];for(const x in this._fixSpriteLocationsTable[this._testId])r=this._fixSpriteLocationsTable[this._testId][x],p[r.page]=r.pageSize;for(const x of p)this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(x[0]*x[1])},size:[x[0],x[1]],dirty:!0,texture:void 0})}this._binPack=new u(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",
data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}var v=k.prototype;v.getWidth=function(p){return p>=this._mosaicPages.length?-1:this._mosaicPages[p].size[0]};v.getHeight=function(p){return p>=this._mosaicPages.length?-1:this._mosaicPages[p].size[1]};v.getPageTexture=function(p){return p<this._mosaicPages.length?this._mosaicPages[p].texture:null};v.has=function(p){return this._mosaicRects.has(p)};v.getSpriteItem=
function(p){return this._mosaicRects.get(p)};v.addSpriteItem=function(p,r,w,l,x,y){if(this._mosaicRects.has(p))return this._mosaicRects.get(p);let B,F;if(t(w))if(this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][p]){var G=this._fixSpriteLocationsTable[this._testId][p];B=G.rect;F=G.page;G=G.pageSize}else[B,F,G]=this._allocateImage(r[0],r[1]);else B=new h(0,0,r[0],r[1]),F=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:w,
size:r,dirty:!0,texture:void 0});if(0>=B.width||0>=B.height)return null;y={rect:B,width:r[0],height:r[1],sdf:x,simplePattern:y,pixelRatio:1,page:F};this._mosaicRects.set(p,y);t(w)&&this._copy({rect:B,spriteSize:r,spriteData:w.data,page:F,pageSize:G,repeat:l,sdf:x});return y};v.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};v.processNextItem=function(){const p=this._spriteCopyQueue.pop();p&&this._copy(p)};v.getSpriteItems=function(p){const r={};for(const w of p)r[w]=this.getSpriteItem(w);
return r};v.getMosaicItemPosition=function(p){const r=(p=this.getSpriteItem(p))&&p.rect;if(!r)return null;r.width=p.width;r.height=p.height;const w=A.SPRITE_PADDING,l=this._mosaicPages[p.page];return{size:[p.width,p.height],tl:[(r.x+w)/l[0],(r.y+w)/l[1]],br:[(r.x+w+p.width)/l[0],(r.y+w+p.height)/l[1]],page:p.page}};v.bind=function(p,r,w=0,l=0){w=this._mosaicPages[w];var x=w.mosaicsData,y=w.texture;y||(y=w.size,y=t(x)?new b(p,{pixelFormat:6408,dataType:5121,width:y[0],height:y[1]},new Uint8Array(x.data.buffer)):
new b(p,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:y[0],height:y[1]},null),w.texture=y);y.setSamplingMode(r);t(x)?(p.bindTexture(y,l),w.dirty&&(y.setData(new Uint8Array(x.data.buffer)),y.generateMipmap())):(r=x.data,x=r.bindFrame(p,y,l),D.isSome(this._requestRender)&&x&&0<r.frameCount&&this._requestRender.requestRender(),r.bindFrame(p,y,l));w.dirty=!1};k._copyBits=function(p,r,w,l,x,y,B,F,G,J,K){let M=l*r+w;B=F*y+B;if(K)for(B-=y,K=-1;K<=J;K++,M=((K+J)%J+l)*r+w,B+=y)for(F=
-1;F<=G;F++)x[B+F]=p[M+(F+G)%G];else for(w=0;w<J;w++){for(l=0;l<G;l++)x[B+l]=p[M+l];M+=r;B+=y}};v._copy=function(p){if(!(p.page>=this._mosaicPages.length)){var r=this._mosaicPages[p.page],w=r.mosaicsData;if(!t(r.mosaicsData))throw new C("mapview-invalid-resource","unsuitable data type!");var l=p.spriteData;(w=w.data)&&l||console.error("Source or target images are uninitialized!");k._copyBits(l,p.spriteSize[0],0,0,w,p.pageSize[0],p.rect.x+A.SPRITE_PADDING,p.rect.y+A.SPRITE_PADDING,p.spriteSize[0],
p.spriteSize[1],p.repeat);r.dirty=!0}};v._allocateImage=function(p,r){p+=2*A.SPRITE_PADDING;r+=2*A.SPRITE_PADDING;var w=Math.max(p,r);if(this._maxItemSize&&this._maxItemSize<w){w=Math.pow(2,Math.ceil(n.log2(p)));const l=Math.pow(2,Math.ceil(n.log2(r)));p=new h(0,0,p,r);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(w*l)},size:[w,l],dirty:!0,texture:void 0});return[p,this._mosaicPages.length-1,[w,l]]}w=this._binPack.allocate(p,r);return 0>=w.width?(w=this._mosaicPages[this._currentPage],
!w.dirty&&t(w.mosaicsData)&&(w.mosaicsData.data=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new u(this._pageWidth,this._pageHeight),this._allocateImage(p,r)):[w,this._currentPage,[this._pageWidth,this._pageHeight]]};v.dispose=function(){this._binPack=null;for(const r of this._mosaicPages){var p=r.texture;p&&
p.dispose();p=r.mosaicsData;t(p)||p.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};z._createClass(k,[{key:"itemCount",get:function(){return this._mosaicRects.size}}]);return k}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define(["exports","../../../../../core/Error","../../../../../core/promiseUtils"],function(z,E,D){function C(t,k=0,v=t.length-k){let p=-1;for(let r=k,w=k+v;r<w;r++)p=p>>>8^f[(p^t[r])&255];return p^-1}function A(t){const k=t.constructor===Uint8Array?
t:new Uint8Array(t);return n.some((v,p)=>v!==k[p])?!1:!0}function m(t,k){const v=new Uint8Array(k);if(n.some((G,J)=>G!==v[J]))return q;let p=!1;c(v,G=>!(p="acTL"===G));if(!p)return h;const r=[],w=[];let l=null,x=null,y=0;c(v,(G,J,K,M)=>{const R=new DataView(J.buffer);switch(G){case "IHDR":l=J.subarray(K+8,K+8+M);t.width=R.getUint32(K+8);t.height=R.getUint32(K+12);break;case "acTL":t.numPlays=R.getUint32(K+8+4);break;case "fcTL":x&&(t.frames.push(x),y++);x=new u;x.width=R.getUint32(K+8+4);x.height=
R.getUint32(K+8+8);x.left=R.getUint32(K+8+12);x.top=R.getUint32(K+8+16);G=R.getUint16(K+8+20);J=R.getUint16(K+8+22);0===J&&(J=100);x.delay=1E3*G/J;10>=x.delay&&(x.delay=100);t.playTime+=x.delay;x.disposeOp=R.getUint8(K+8+24);x.blendOp=R.getUint8(K+8+25);x.dataParts=[];0===y&&2===x.disposeOp&&(x.disposeOp=1);break;case "fdAT":x&&x.dataParts.push(J.subarray(K+8+4,K+8+M));break;case "IDAT":x&&x.dataParts.push(J.subarray(K+8,K+8+M));break;case "IEND":w.push(d(J,K,12+M));break;default:r.push(d(J,K,12+
M))}});if(0===t.frames.length)return h;t.frameCount=t.frames.length;const B=new Blob(r),F=new Blob(w);t.frames.forEach(G=>{let J=[];J.push(n);l.set(e(G.width),0);l.set(e(G.height),4);J.push(a("IHDR",l));J.push(B);G.dataParts.forEach(K=>J.push(a("IDAT",K)));J.push(F);G.data=new Blob(J,{type:"image/png"});delete G.dataParts;J=null});return t}function c(t,k){const v=new DataView(t.buffer);let p=8;let r,w;do{r=v.getUint32(p);var l=p+4;l=Array.prototype.slice.call(t.subarray(l,l+4));l=String.fromCharCode.apply(String,
l);w=k(l,t,p,r);p+=12+r}while(!1!==w&&"IEND"!==l&&p<t.length)}function b(t){const k=new Uint8Array(t.length);for(let v=0;v<t.length;v++)k[v]=t.charCodeAt(v);return k}function d(t,k,v){const p=new Uint8Array(v);p.set(t.subarray(k,k+v));return p}function a(t,k){const v=t.length+k.length,p=new Uint8Array(v+8),r=new DataView(p.buffer);r.setUint32(0,k.length);p.set(b(t),4);p.set(k,8);t=C(p,4,v);r.setUint32(v+4,t);return p}function e(t){return new Uint8Array([t>>>24&255,t>>>16&255,t>>>8&255,t&255])}const f=
new Uint32Array(256);for(var g=0;256>g;g++){let t=g;for(let k=0;8>k;k++)t=0!==(t&1)?3988292384^t>>>1:t>>>1;f[g]=t}const q=new E("Not a PNG"),h=new E("Not an animated PNG"),n=new Uint8Array([137,80,78,71,13,10,26,10]);g=function(){function t(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}t.create=async function(v,p){const r=new t;try{await r._load(v,p)}catch(w){if(!D.isAbortError(w))return new E("invalid-resource",
`Could not load PNG: ${w.message}`)}return r};var k=t.prototype;k.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};k.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};k.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};k.bindFrame=function(v,p,r){v.bindTexture(p,r);v=this.frameChanged();if(!v)return!1;r=this.currentFrame;const w=r.frameData,l=p.descriptor;(r.left||r.top||r.width!==l.width||r.height!==l.height)&&p.setData(null);
p.updateData(0,r.left,r.top,r.width,r.height,w);this.updateUsedFrame();return v};k.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};k.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};k._load=async function(v,p){try{const r=m(this,v);if(r!==this)return r;this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;await D.all(this.frames.map(w=>w.createImage(this._resizeCanvas)))}catch(r){if(!D.isAbortError(r))return new E("invalid-resource",
"Could not parse PNG")}this.play()};k._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var v=this.currentFrameNumber;--v;0>v&&(v=this.frames.length-1);v=-this.frames[v].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,v=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;var p=this.frames[this.currentFrameNumber];this.currentFrame=
{frameData:p.imageData,top:p.top,left:p.left,width:p.width,height:p.height};this.timerID=window.setTimeout(()=>this._play(),v)}};return t}();let u=function(){function t(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}t.prototype.createImage=async function(k){if(null===this.imageData)return D.create((v,p)=>{const r=URL.createObjectURL(this.data),w=document.createElement("img");w.onload=()=>{URL.revokeObjectURL(r);{k.width=w.width;k.height=
w.height;var l=k.getContext("2d");l.drawImage(w,0,0,w.width,w.height);l=l.getImageData(0,0,w.width,w.height);l=new Uint8Array(l.data);let x;for(let y=0;y<l.length;y+=4)x=l[y+3]/255,l[y]*=x,l[y+1]*=x,l[y+2]*=x;l=new ImageData(new Uint8ClampedArray(l.buffer),w.width,w.height)}this.imageData=l;v()};w.onerror=()=>{URL.revokeObjectURL(r);this.imageData=null;p(Error("Image creation error"))};w.src=r})};return t}();z.default=g;z.getPNGSize=function(t){t=new Uint8Array(t);let k,v;c(t,(p,r,w)=>{r=new DataView(r.buffer);
"IHDR"===p&&(k=r.getUint32(w+8),v=r.getUint32(w+12))});return[k,v]};z.isAnimatedPNG=function(t){t=new Uint8Array(t);if(!A(t))return!1;let k=!1;c(t,v=>!(k="acTL"===v));return k};z.isPNG=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define(["exports","../../../../../core/Error","../../../../../core/promiseUtils"],function(z,E,D){function C(c){if(!c||0===c.byteLength)return!1;c=c.constructor===Uint8Array?c:new Uint8Array(c);return 71===
c[0]&&73===c[1]&&70===c[2]&&56===c[3]}let A=function(){function c(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}c.create=async function(d,a){const e=new c;try{await e._load(d,a)}catch(f){if(!D.isAbortError(f))return new E("invalid-resource",
`Could not load PNG: ${f.message}`)}return e};var b=c.prototype;b.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};b.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};b.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};b.bindFrame=function(d,a,e){d.bindTexture(a,e);if(d=this.frameChanged())e=this.currentFrame,a.updateData(0,0,0,e.width,e.height,e.frameData),this.updateUsedFrame();return d};b.seekFrame=function(d){clearTimeout(this.timerID);
this.currentFrameNumber=d%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.seek=function(d){clearTimeout(this.timerID);0>d&&(d=0);d=1E3*d%this.length;let a=0;for(;d>this.frames[a].time+this.frames[a].delay&&a<this.frames.length;)a+=1;this.currentFrameNumber=a;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};b.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};b.updateUsedFrame=function(){this._lastUsedFrame=
this.currentFrameNumber};b._load=async function(d,a){try{this.loading=!0,await this._parse(d,a),this.loading=!1,this.play()}catch(e){if(!D.isAbortError(e))return new E("invalid-resource","Could not parse gif!")}};b._parse=function(d,a){const e=new m(d);e.pos+=6;this.width=e.data[e.pos++]+(e.data[e.pos++]<<8);this.height=e.data[e.pos++]+(e.data[e.pos++]<<8);d=e.data[e.pos++];this.globalColourCount=1<<(d&7)+1;e.pos++;e.pos++;d&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,
e));return D.create((f,g)=>{setTimeout(()=>this._parseBlock(e,f,g,a),0)})};b._parseBlock=async function(d,a,e,f){if(f&&f.signal&&D.isAborted(f.signal))e(D.createAbortError());else{var g=d.data[d.pos++];if(44===g){if(this._parseImg(d),this.firstFrameOnly){this._finishedLoading();a();return}}else{if(59===g){this._finishedLoading();a();return}this._parseExt(d)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:d.pos,totalBytes:d.data.length,frame:this.frames.length});setTimeout(()=>this._parseBlock(d,
a,e,f),0)}};b._parseColourTable=function(d,a){const e=[];for(let f=0;f<d;f++)e.push([a.data[a.pos++],a.data[a.pos++],a.data[a.pos++]]);return e};b._parseImg=function(d){const a=g=>{const q=this.pixelBufSize/g;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);let h=0;for(let n=0;4>n;n++)for(let u=this.interlaceOffsets[n];u<q;u+=this.interlaceSteps[n])this.deinterlaceBuf.set(this.pixelBuf.subarray(h,h+g),u*g),
h+=g},e={};this.frames.push(e);e.disposalMethod=this.disposalMethod;e.time=this.length;e.delay=10*this.delayTime;this.length+=e.delay;e.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;e.leftPos=d.data[d.pos++]+(d.data[d.pos++]<<8);e.topPos=d.data[d.pos++]+(d.data[d.pos++]<<8);e.width=d.data[d.pos++]+(d.data[d.pos++]<<8);e.height=d.data[d.pos++]+(d.data[d.pos++]<<8);const f=d.data[d.pos++];e.localColourTableFlag=f&128?!0:!1;e.localColourTableFlag&&(e.localColourTable=this._parseColourTable(1<<
(f&7)+1,d));this.pixelBufSize!==e.width*e.height&&(this.pixelBuf=new Uint8Array(e.width*e.height),this.pixelBufSize=e.width*e.height);this._lzwDecode(d.data[d.pos++],d.readSubBlocksB());f&64?(e.interlaced=!0,a(e.width)):e.interlaced=!1;this._processFrame(e)};b._lzwDecode=function(d,a){let e,f,g,q,h,n,u;let t,k;g=f=0;let v=[];q=1<<d;h=q+1;n=d+1;for(k=!1;!k;){var p=u;for(e=u=0;e<n;e++)a[g>>3]&1<<(g&7)&&(u|=1<<e),g++;if(u===q){v=[];n=d+1;for(e=0;e<q;e++)v[e]=[e];v[q]=[];v[h]=null}else{if(u===h){k=!0;
break}u>=v.length?v.push(v[p].concat(v[p][0])):p!==q&&v.push(v[p].concat(v[u][0]));p=v[u];t=p.length;for(e=0;e<t;e++)this.pixelBuf[f++]=p[e];v.length===1<<n&&12>n&&n++}}};b._processFrame=function(d){d.image=document.createElement("canvas");d.image.width=this.width;d.image.height=this.height;d.ctx=d.image.getContext("2d");const a=d.localColourTableFlag?d.localColourTable:this.globalColourTable;null===this.lastFrame&&(this.lastFrame=d);const e=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?
!0:!1;e||d.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);const f=d.ctx.getImageData(d.leftPos,d.topPos,d.width,d.height),g=d.transparencyIndex,q=f.data,h=d.interlaced?this.deinterlaceBuf:this.pixelBuf,n=h.length;let u=0,t,k;for(let v=0;v<n;v++)t=h[v],k=a[t],g!==t?(q[u++]=k[0],q[u++]=k[1],q[u++]=k[2],q[u++]=255):(e&&(q[u+3]=0),u+=4);d.ctx.putImageData(f,d.leftPos,d.topPos);this.lastFrame=d};b._parseExt=function(d){const a=d.data[d.pos++];249===a?this._parseGCExt(d):254===a?this.comment+=
d.readSubBlocks():255===a?this._parseAppExt(d):(1===a&&(d.pos+=13),d.readSubBlocks())};b._parseAppExt=function(d){d.pos+=1;"NETSCAPE"===d.getString(8)?d.pos+=8:(d.pos+=3,d.readSubBlocks())};b._parseGCExt=function(d){let a;d.pos++;a=d.data[d.pos++];this.disposalMethod=(a&28)>>2;this.transparencyGiven=a&1?!0:!1;this.delayTime=d.data[d.pos++]+(d.data[d.pos++]<<8);this.transparencyIndex=d.data[d.pos++];d.pos++};b._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=
null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};b._play=function(){if(0===this.playSpeed)this.pause();else{if(0>this.playSpeed){--this.currentFrameNumber;0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1);var d=this.currentFrameNumber;
--d;0>d&&(d=this.frames.length-1);d=-this.frames[d].delay/this.playSpeed}else this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,d=1*this.frames[this.currentFrameNumber].delay/this.playSpeed;this._setCurrentFrame(this.currentFrameNumber);this.timerID=window.setTimeout(()=>this._play(),d)}};b._setCurrentFrame=function(d){this.currentFrame={frameData:this.frames[d].image,top:0,left:0,width:this.width,height:this.height}};return c}(),m=function(){function c(d){this.pos=0;this.data=
new Uint8ClampedArray(d);this.len=this.data.length}var b=c.prototype;b.getString=function(d){let a="";for(;d--;)a+=String.fromCharCode(this.data[this.pos++]);return a};b.readSubBlocks=function(){let d,a,e="";do for(a=d=this.data[this.pos++];a--;)e+=String.fromCharCode(this.data[this.pos++]);while(0!==d&&this.pos<this.len);return e};b.readSubBlocksB=function(){let d,a;const e=[];do for(a=d=this.data[this.pos++];a--;)e.push(this.data[this.pos++]);while(0!==d&&this.pos<this.len);return e};return c}();
z.default=A;z.getGIFSize=function(c){var b=new Uint8ClampedArray(c);let d=6;c=b[d++]+(b[d++]<<8);b=b[d++]+(b[d++]<<8);return[c,b]};z.isAnimatedGIF=function(c){if(!c||0===c.byteLength)return!1;c=new Uint8Array(c);if(!C(c))return!1;let b=0;for(let d=0,a=c.length-9;d<a&&(0!==c[d]||33!==c[d+1]||249!==c[d+2]||4!==c[d+3]||0!==c[d+8]||44!==c[d+9]&&33!==c[d+9]||(b++,!(1<b)));++d);return 1<b};z.isGIF=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Result":function(){define(["exports",
"../../../../../core/Error"],function(z,E){z.ok=function(D,C){return D&&"name"in D?(C&&C.error(new E(D.name,D.message,D.details)),!1):!0};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["exports"],function(z){z.keyFromSymbol=function(E){switch(E.type){case "esriSMS":return`${E.style}.${E.path}`;case "esriSLS":return`${E.style}.${E.cap}`;case "esriSFS":return`${E.style}`;case "esriPFS":case "esriPMS":return E.imageData?`${E.imageData}${E.width}${E.height}`:
`${E.url}${E.width}${E.height}`;default:return E.mosaicHash?E.mosaicHash:JSON.stringify(E)}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(z,E,D,C,A,m){m=function(c){function b(){var a=c.apply(this,arguments)||this;a.defines=[];a._desc={vsPath:"fx/integrate",fsPath:"fx/integrate",
attributes:{a_position:0}};return a}E._inheritsLoose(b,c);var d=b.prototype;d.dispose=function(){this._quad&&this._quad.dispose()};d.bind=function(){};d.unbind=function(){};d.draw=function(a,e){if(e.size){var {context:f,renderingOptions:g}=a;this._quad||(this._quad=new A(f,[0,0,1,0,0,1,1,1]));var q=f.getBoundFramebufferObject(),{x:h,y:n,width:u,height:t}=f.getViewport();e.bindTextures(f);var k=e.getBlock(C.ATTRIBUTE_DATA_ANIMATION);if(!D.isNone(k)){var v=k.getFBO(f);k=k.getFBO(f,1);f.setViewport(0,
0,e.size,e.size);this._computeDelta(a,k,g.labelsAnimationTime);this._updateAnimationState(a,k,v);f.bindFramebuffer(q);f.setViewport(h,n,u,t)}}};d._computeDelta=function(a,e,f){const {context:g,painter:q,displayLevel:h}=a,n=q.materialManager.getProgram(a,this._desc,["delta"]);g.bindFramebuffer(e);g.setClearColor(0,0,0,0);g.clear(g.gl.COLOR_BUFFER_BIT);g.bindProgram(n);n.setUniform1i("u_maskTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_0);n.setUniform1i("u_sourceTexture",C.TEXTURE_BINDING_ATTRIBUTE_DATA_1);
n.setUniform1f("u_timeDelta",a.deltaTime);n.setUniform1f("u_animationTime",f);n.setUniform1f("u_zoomLevel",Math.round(10*h));this._quad.draw()};d._updateAnimationState=function(a,e,f){const {context:g,painter:q}=a;a=q.materialManager.getProgram(a,this._desc,["update"]);g.bindTexture(e.colorTexture,1);g.bindProgram(a);a.setUniform1i("u_sourceTexture",1);g.bindFramebuffer(f);g.setClearColor(0,0,0,0);g.clear(g.gl.COLOR_BUFFER_BIT);this._quad.draw()};return b}(m.Effect);z.AnimationEffect=m;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["exports"],function(z){z.Effect=function(){this.name=this.constructor.name};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/BlendEffect":function(){define("exports ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/Error ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ../enums ../VertexStream ../shaders/BlendPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){const u=D.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffect");D=function(){function t(){this._size=[0,0]}var k=t.prototype;k.dispose=function(v){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._programCache&&(this._programCache.dispose(),this._programCache=null);this._quad&&(this._quad.dispose(),this._quad=null)};k.draw=function(v,p,r,w,l){const {context:x,drawPhase:y}=v;this._setupShader(x);
w&&"normal"!==w&&y!==q.WGLDrawPhase.LABEL?this._drawBlended(v,p,r,w,l):(v=this._programCache.getProgram(n.blend,"normal"))?(x.bindProgram(v),p.setSamplingMode(r),x.bindTexture(p,0),v.setUniform1i("u_layerTexture",0),v.setUniform1f("u_opacity",l),x.setBlendingEnabled(!0),x.setBlendFunction(1,771),p=this._quad,p.draw(),p.unbind()):u.error(new C("mapview-BlendEffect",'Error creating shader program for blend mode "normal"'))};k._drawBlended=function(v,p,r,w,l){const {context:x,state:y,pixelRatio:B,inFadeTransition:F}=
v;var {size:G}=y,J=x.getBoundFramebufferObject();let K;E.isSome(J)?(G=J.descriptor,K=G.width,G=G.height):(K=Math.round(B*G[0]),G=Math.round(B*G[1]));this._createOrResizeTexture(v,K,G);v=this._backBufferTexture;J.copyToTexture(0,0,K,G,0,0,v);x.setStencilTestEnabled(!1);x.setStencilWriteMask(0);x.setBlendingEnabled(!0);x.setDepthTestEnabled(!1);x.setDepthWriteEnabled(!1);(J=this._programCache.getProgram(n.blend,w))?(x.bindProgram(J),v.setSamplingMode(r),x.bindTexture(v,0),J.setUniform1i("u_backbufferTexture",
0),p.setSamplingMode(r),x.bindTexture(p,1),J.setUniform1i("u_layerTexture",1),J.setUniform1f("u_opacity",l),J.setUniform1f("u_inFadeOpacity",F?1:0),x.setBlendFunction(1,0),p=this._quad,p.draw(),p.unbind(),x.setBlendFunction(1,771)):u.error(new C("mapview-BlendEffect",`Error creating shader program for blend mode ${w}`))};k._setupShader=function(v){this._programCache||(this._programCache=new e(v),this._quad||(this._quad=new h(v,[-1,-1,1,-1,-1,1,1,1])))};k._createOrResizeTexture=function(v,p,r){({context:v}=
v);if(null===this._backBufferTexture||p!==this._size[0]||r!==this._size[1])this._backBufferTexture?this._backBufferTexture.resize(p,r):this._backBufferTexture=new c(v,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:p,height:r}),this._size[0]=p,this._size[1]=r};return t}();z.BlendEffect=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/BlendPrograms":function(){define(["exports","./sources/resolver"],
function(z,E){z.blend={name:"blend",attributes:{a_pos:0,a_tex:1},shaders:D=>({vertexShader:`#define ${D.replace("-","_").toUpperCase()}\n`+E.resolveIncludes("blend/blend.vert"),fragmentShader:`#define ${D.replace("-","_").toUpperCase()}\n`+E.resolveIncludes("blend/blend.frag")})};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/FeatureEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","./Effect"],function(z,E,D){D=function(C){function A(c){var b=
C.call(this)||this;b.name=b.constructor.name;b.defines=[c];return b}E._inheritsLoose(A,C);var m=A.prototype;m.dispose=function(){};m.bind=function({context:c,painter:b}){this._prev=c.getBoundFramebufferObject();const {width:d,height:a}=c.getViewport();b=b.getFbos(d,a).effect0;c.bindFramebuffer(b);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};m.unbind=function(){};m.draw=function(c,b){const {context:d,painter:a,state:e,deltaTime:f}=c,g=a.getPostProcessingEffects(b.effects),q=d.getBoundFramebufferObject();
g.length&&b.transitionStep(f,e.scale);for(const {postProcessingEffect:h,effect:n}of g)h.draw(c,q,n);d.bindFramebuffer(this._prev);d.setStencilTestEnabled(!1);a.blitTexture(d,q.colorTexture,9728);d.setStencilTestEnabled(!0)};return A}(D.Effect);z.FeatureEffect=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../BitBlitRenderer ./Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(z,E,D,C,A,m,c){return function(b){function d(){var e=b.apply(this,arguments)||this;e.defines=["highlight"];e._hlRenderer=new m;e._hlGradient=new A;e._width=void 0;e._height=void 0;e._hlSurfaces=new c;e._adjustedWidth=void 0;e._adjustedHeight=void 0;e._blitRenderer=new D.BitBlitRenderer;return e}z._inheritsLoose(d,b);var a=d.prototype;a.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();
this._boundFBO=null};a.bind=function(e){const {context:f,painter:g}=e,{width:q,height:h}=f.getViewport(),n=g.getFbos(q,h).effect0;this.setup(e,q,h);f.bindFramebuffer(n);f.setColorMask(!0,!0,!0,!0);f.setClearColor(0,0,0,0);f.clear(f.gl.COLOR_BUFFER_BIT)};a.unbind=function(){};a.setup=function({context:e},f,g){this._width=f;this._height=g;const q=f%4,h=g%4;f+=2>q?-q:4-q;g+=2>h?-h:4-h;this._adjustedWidth=f;this._adjustedHeight=g;this._boundFBO=e.getBoundFramebufferObject();f=Math.round(.75*f);g=Math.round(.75*
g);this._hlRenderer.setup(e,f,g);this._hlSurfaces.setup(e,f,g)};a.draw=function({context:e}){const f=e.getBoundFramebufferObject();e.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setStencilTestEnabled(!1);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(e,f.colorTexture,9728,1);e.setStencilTestEnabled(!1);e.setBlendingEnabled(!1);e.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);e.setClearColor(0,
0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(e,this._hlSurfaces.sharedBlur1Tex);e.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);e.setClearColor(0,0,0,0);e.clear(e.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(e,this._hlSurfaces.sharedBlur2Tex);e.bindFramebuffer(this._boundFBO);e.setBlendingEnabled(!0);e.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(e,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};a.setHighlightOptions=function(e){this._hlGradient.setHighlightOptions(e)};
return d}(C.Effect)})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("../../../../../../core/Logger ../../definitions ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./parameters".split(" "),function(z,
E,D,C,A,m,c,b,d,a,e,f){function g(n,u){u.fillColor[0]=n.color.r/255;u.fillColor[1]=n.color.g/255;u.fillColor[2]=n.color.b/255;u.fillColor[3]=n.color.a;n.haloColor?(u.outlineColor[0]=n.haloColor.r/255,u.outlineColor[1]=n.haloColor.g/255,u.outlineColor[2]=n.haloColor.b/255,u.outlineColor[3]=n.haloColor.a):(u.outlineColor[0]=u.fillColor[0],u.outlineColor[1]=u.fillColor[1],u.outlineColor[2]=u.fillColor[2],u.outlineColor[3]=u.fillColor[3]);u.fillColor[3]*=n.fillOpacity;u.outlineColor[3]*=n.haloOpacity;
u.fillColor[0]*=u.fillColor[3];u.fillColor[1]*=u.fillColor[3];u.fillColor[2]*=u.fillColor[3];u.outlineColor[0]*=u.outlineColor[3];u.outlineColor[1]*=u.outlineColor[3];u.outlineColor[2]*=u.outlineColor[3];u.outlineWidth=f.HIGHLIGHT_SIZING.outlineWidth;u.outerHaloWidth=f.HIGHLIGHT_SIZING.outerHaloWidth;u.innerHaloWidth=f.HIGHLIGHT_SIZING.innerHaloWidth;u.outlinePosition=f.HIGHLIGHT_SIZING.outlinePosition}const q=z.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),h=[0,0,0,
0];return function(){function n(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:f.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:f.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:f.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:f.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*f.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}var u=n.prototype;u.setHighlightOptions=function(t){function k(B,F,G){y[0]=
(1-G)*B[0]+G*F[0];y[1]=(1-G)*B[1]+G*F[1];y[2]=(1-G)*B[2]+G*F[2];y[3]=(1-G)*B[3]+G*F[3]}const v=this._convertedHighlightOptions;g(t,v);t=v.outlinePosition-v.outlineWidth/2-v.outerHaloWidth;const p=v.outlinePosition-v.outlineWidth/2,r=v.outlinePosition+v.outlineWidth/2,w=v.outlinePosition+v.outlineWidth/2+v.innerHaloWidth;var l=Math.sqrt(Math.PI/2)*f.SIGMAS[3],x=Math.abs(t)>l?Math.round(10*(Math.abs(t)-l))/10:0;l=Math.abs(w)>l?Math.round(10*(Math.abs(w)-l))/10:0;x&&!l?q.error("The outer rim of the highlight is "+
x+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!x&&l?q.error("The inner rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):x&&l&&q.error("The highlight is "+Math.max(x,l)+"px away from the edge of the feature; consider reducing some width values.");const y=[void 0,void 0,void 0,
void 0];({texelData:l}=this);for(let B=0;B<f.SHADE_TEXTURE_SIZE;++B)x=t+B/(f.SHADE_TEXTURE_SIZE-1)*(w-t),x<t?(y[4*B]=0,y[4*B+1]=0,y[4*B+2]=0,y[4*B+3]=0):x<p?k(h,v.outlineColor,(x-t)/(p-t)):x<r?[y[0],y[1],y[2],y[3]]=v.outlineColor:x<w?k(v.outlineColor,v.fillColor,(x-r)/(w-r)):[y[4*B],y[4*B+1],y[4*B+2],y[4*B+3]]=v.fillColor,l[4*B]=255*y[0],l[4*B+1]=255*y[1],l[4*B+2]=255*y[2],l[4*B+3]=255*y[3];this.minMaxDistance[0]=t;this.minMaxDistance[1]=w;this.shadeTexChanged=!0};u.applyHighlightOptions=function(t,
k){this.shadeTex||(this.shadeTex=new A(t,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,f.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);t.bindTexture(this.shadeTex,E.TEXTURE_BINDING_HIGHLIGHT_1);k.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};u.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return n}()})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["exports"],
function(z){z.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];z.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0};z.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];z.SHADE_TEXTURE_SIZE=256;z.SIGMAS=[void 0,void 0,void 0,1];Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("../../definitions ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/programUtils ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler ./parameters ../../shaders/HighlightPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g){return function(){function q(){this._height=this._width=void 0;this._resources=null}var h=q.prototype;h.dispose=function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};h.preBlur=function(n,u){n.bindTexture(u,z.TEXTURE_BINDING_HIGHLIGHT_0);n.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",
[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);n.bindVAO(this._resources.quadVAO);n.drawArrays(5,0,4);n.bindVAO()};h.finalBlur=function(n,u){n.bindTexture(u,z.TEXTURE_BINDING_HIGHLIGHT_0);n.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",f.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
n.bindVAO(this._resources.quadVAO);n.drawArrays(5,0,4);n.bindVAO()};h.renderHighlight=function(n,u,t){n.bindTexture(u,z.TEXTURE_BINDING_HIGHLIGHT_0);n.bindProgram(this._resources.highlightProgram);t.applyHighlightOptions(n,this._resources.highlightProgram);n.bindVAO(this._resources.quadVAO);n.setBlendingEnabled(!0);n.setBlendFunction(1,771);n.drawArrays(5,0,4);n.bindVAO()};h._initialize=function(n,u,t){this._width=u;this._height=t;u=new D(n,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,
1,1,1,1])).buffer);t=new A(n,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:u});const k=b.createProgram(n,g.highlight);n=b.createProgram(n,g.blur);k.setUniform1i("u_texture",z.TEXTURE_BINDING_HIGHLIGHT_0);k.setUniform1i("u_shade",z.TEXTURE_BINDING_HIGHLIGHT_1);k.setUniform4fv("u_sigmas",f.SIGMAS);n.setUniform1i("u_texture",z.TEXTURE_BINDING_HIGHLIGHT_0);n.setUniform4fv("u_sigmas",
f.SIGMAS);this._resources={quadGeometry:u,quadVAO:t,highlightProgram:k,blurProgram:n}};h.setup=function(n,u,t){this._resources?(this._width=u,this._height=t):this._initialize(n,u,t)};return q}()})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["exports","./sources/resolver"],function(z,E){const D={name:"highlight",shaders:{vertexShader:E.resolveIncludes("highlight/textured.vert"),fragmentShader:E.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,a_texcoord:1}};
E={name:"blur",shaders:{vertexShader:E.resolveIncludes("highlight/textured.vert"),fragmentShader:E.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}};z.blur=E;z.highlight=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../webgl/Program ../../../../../webgl/BufferObject ../../../../../webgl/Texture ../../../../../webgl/VertexArrayObject ../../../../../webgl/Renderbuffer ../../../../../webgl/FramebufferObject ../../../../../webgl/ProgramCache ../../../../../webgl/RenderingContext ../../../../../webgl/ShaderCompiler".split(" "),
function(z,E,D,C,A,m,c,b,d,a){function e(f,g,q){g=new C(f,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:g,height:q,samplingMode:9729});f=new c(f,{colorTarget:0,depthStencilTarget:2},g);return[g,f]}return function(){function f(){this._height=this._width=void 0;this._resources=null}var g=f.prototype;g.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),
this._resources=null)};g._initialize=function(q,h,n){this._width=h;this._height=n;const [u,t]=e(q,h,n),[k,v]=e(q,h,n);this._resources={sharedBlur1Tex:u,sharedBlur1Fbo:t,sharedBlur2Tex:k,sharedBlur2Fbo:v}};g.setup=function(q,h,n){!this._resources||this._width===h&&this._height===n||this.dispose();this._resources||this._initialize(q,h,n)};z._createClass(f,[{key:"sharedBlur1Tex",get:function(){return this._resources.sharedBlur1Tex}},{key:"sharedBlur1Fbo",get:function(){return this._resources.sharedBlur1Fbo}},
{key:"sharedBlur2Tex",get:function(){return this._resources.sharedBlur2Tex}},{key:"sharedBlur2Fbo",get:function(){return this._resources.sharedBlur2Fbo}}]);return f}()})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/maybe","../definitions","./Effect"],function(z,E,D,C,A){A=function(m){function c(){var d=m.apply(this,arguments)||this;d.name=d.constructor.name;d.defines=["id"];d._lastSize=0;return d}
E._inheritsLoose(c,m);var b=c.prototype;b.dispose=function(){D.isSome(this._fbo)&&this._fbo.dispose()};b.bind=function({context:d,painter:a}){const {width:e,height:f}=d.getViewport();a=a.getFbos(e,f).effect0;d.bindFramebuffer(a);d.setClearColor(0,0,0,0);d.clear(d.gl.COLOR_BUFFER_BIT)};b.unbind=function(){};b.draw=function({context:d,state:a,pixelRatio:e},f,g=C.HITTEST_SEARCH_SIZE){const q=d.getBoundFramebufferObject(),h=a.size[1]*e,n=Math.round(g*e),u=n/2,t=n/2;this._ensureBuffer(n);f.forEach((k,
v)=>{var p=new Map;q.readPixels(Math.floor(v[0]*e-n/2),Math.floor(h-v[1]*e-n/2),n,n,6408,5121,this._buf);for(let l=0;l<this._buf32.length;l++){const x=this._buf32[l];if(4294967295!==x&&0!==x){var r=l%n,w=n-Math.floor(l/n);r=(u-r)*(u-r)+(t-w)*(t-w);w=p.has(x)?p.get(x):4294967295;p.set(x,Math.min(r,w))}}p=Array.from(p).sort((l,x)=>l[1]-x[1]).map(l=>l[0]);k.resolve(p);f.delete(v)})};b._ensureBuffer=function(d){this._lastSize!==d&&(this._lastSize=d,this._buf=new Uint8Array(4*d*d),this._buf32=new Uint32Array(this._buf.buffer))};
return c}(A.Effect);z.HittestEffect=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/effects/post-processing/EffectManager":function(){define(["require","exports"],function(z,E){const D={colorize:async()=>new (await new Promise(function(A,m){z(["./Colorize"],A,m)})).Colorize,blur:async()=>new (await new Promise(function(A,m){z(["./Blur"],A,m)})).Blur,bloom:async()=>new (await new Promise(function(A,m){z(["./Bloom"],A,m)})).Bloom,opacity:async()=>new (await new Promise(function(A,
m){z(["./Opacity"],A,m)})).Opacity,"drop-shadow":async()=>new (await new Promise(function(A,m){z(["./DropShadow"],A,m)})).DropShadow};let C=function(){function A(c){this._requestRender=c;this._effectMap=new Map;this._effectPromiseMap=new Map}var m=A.prototype;m.dispose=function(){this._requestRender&&(this._requestRender=null);this._effectMap.forEach(c=>c.dispose());this._effectMap.clear();this._effectPromiseMap.clear()};m.getPostProcessingEffects=function(c){if(!c||0===c.length)return[];const b=
[];for(const d of c){a:switch(c=d.type,c){case "bloom":case "blur":case "opacity":case "drop-shadow":break a;default:c="colorize"}const a=this._effectMap.get(c);a?b.push({postProcessingEffect:a,effect:d}):this._enablePostProcessingEffect(c)}return b};m._enablePostProcessingEffect=async function(c){const b=await this._loadPostProcessingEffect(c);this._requestRender&&(this._effectMap.set(c,b),this._requestRender.requestRender())};m._loadPostProcessingEffect=async function(c){this._effectPromiseMap.has(c)||
this._effectPromiseMap.set(c,D[c]());return this._effectPromiseMap.get(c)};return A}();E.EffectManager=C;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define(["../../../../../core/has","../../../../../core/maybe","../../../../../core/arrayUtils","../enums"],function(z,E,D,C){return function(){function A(c,b){var d;this.brushes=c;this.name=b.name;this.drawPhase=b.drawPhase||C.WGLDrawPhase.MAP;this._targetFn=b.target;this.effects=b.effects||
[];this.enableDefaultDraw=null!=(d=b.enableDefaultDraw)?d:()=>!0;this.has=b.has}var m=A.prototype;m.render=function(c){const {context:b,profiler:d}=c,a=this._targetFn();var e=this.drawPhase&c.drawPhase;d.recordPassStart(this.name);if(e&&(!this.has||z(this.has))){this.enableDefaultDraw()&&this._doRender(c,a);d.recordPassEnd();for(const f of this.effects){if(!f.enable())continue;e=f.apply;d.recordPassStart(this.name+"."+e.name);d.recordBrushStart(e.name);const g=f.args&&f.args(),{x:q,y:h,width:n,height:u}=
b.getViewport(),t=b.getBoundFramebufferObject();e.bind(c,g);this._doRender(c,a,e.defines);e.draw(c,g);e.unbind(c,g);b.bindFramebuffer(t);b.setViewport(q,h,n,u);d.recordBrushEnd();d.recordPassEnd()}}};m._doRender=function(c,b,d){if(!E.isNone(b))if(D.isArrayLike(b))for(const a of b){if(a.visible)for(const e of this.brushes)c.profiler.recordBrushStart(e.name),e.prepareState(c,a,d),e.draw(c,a,d),c.profiler.recordBrushEnd()}else for(const a of this.brushes)c.profiler.recordBrushStart(a.name),a.prepareState(c,
b,d),a.draw(c,b,d),c.profiler.recordBrushEnd()};return A}()})},"esri/views/2d/engine/webgl/Profiler":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/Evented ../../../../core/CircularArray ../../../webgl/capabilities/DisjointTimerQuery".split(" "),function(z,E,D,C,A,m,c){const b=D("esri-2d-profiler");D=function(){function d(e,f){this._events=new A;this._entries=new Map;this._timings=new m(10);if(b){this._ext=c.createDisjointTimerQuery(e.gl,
{});this._debugOutput=f;var g=e.gl;if(this.enableCommandLogging)for(const q in g)if("function"===typeof g[q]){const h=g[q],n=-1!==q.indexOf("draw");g[q]=(...u)=>{this._events.emit("command",{container:this._currentContainer,pass:this._currentPass,brush:this._currentBrush,method:q,args:u,isDrawCommand:n});this._currentSummary&&(this._currentSummary.commands++,n&&this._currentSummary.drawCommands++);return h.apply(g,u)}}}}var a=d.prototype;a.recordContainerStart=function(e){b&&(this._currentContainer=
e)};a.recordContainerEnd=function(){b&&(this._currentContainer=null)};a.recordPassStart=function(e){b&&(this._currentPass=e,this._initSummary())};a.recordPassEnd=function(){b&&(this._currentPass=null,this._emitSummary())};a.recordBrushStart=function(e){b&&(this._currentBrush=e)};a.recordBrushEnd=function(){b&&(this._currentBrush=null)};a.recordStart=function(e){if(b&&C.isSome(this._ext)){if(this._entries.has(e)){const n=this._entries.get(e);var f=this._ext.resultAvailable(n.query),g=this._ext.disjoint();
if(f&&!g){f=this._ext.getResult(n.query)/1E6;g=0;if(C.isSome(this._timings.enqueue(f))){g=this._timings.entries;const u=g.length;let t=0;for(var q of g)t+=q;g=t/u}q=f.toFixed(2);f=g?g.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed(`Frame report for ${e}, ${q} ms (${f} last 10 avg)
${n.commandsLen} Commands (${n.drawCommands} draw)`),console.log("RenderPass breakdown: "),console.table(n.summaries),console.log("Commands: ",n.commands),console.groupEnd()):console.log(`Frame report for ${e}, ${q} ms (${f} last 10 avg)`);this._debugOutput.innerHTML=`${q} (${f})`}for(const u of n.handles)u.remove();this._entries.delete(e)}const h={name:e,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(h.handles.push(this._events.on("command",
n=>{h.commandsLen++;h.commands.push(n);n.isDrawCommand&&h.drawCommands++})),h.handles.push(this._events.on("summary",n=>{h.summaries.push(n)})));this._ext.beginTimeElapsed(h.query);this._entries.set(e,h)}};a.recordEnd=function(e){b&&C.isSome(this._ext)&&this._entries.has(e)&&this._ext.endTimeElapsed()};a._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a._emitSummary=function(){this.enableCommandLogging&&
this._events.emit("summary",this._currentSummary)};E._createClass(d,[{key:"enableCommandLogging",get:function(){return!("object"===typeof b&&b.disableCommands)}}]);return d}();z.Profiler=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/CircularArray":function(){define(["../chunks/_rollupPluginBabelHelpers","./maybe"],function(z,E){return function(){function D(A=Number.POSITIVE_INFINITY){this._start=this.size=0;this.maxSize=A;this._buffer=isFinite(A)?Array(A):[]}var C=D.prototype;C.enqueue=
function(A){if(this.size===this.maxSize){const m=this._buffer[this._start];this._buffer[this._start]=A;this._start=(this._start+1)%this.maxSize;return m}isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=A:this._buffer[this._start+this.size++]=A;return null};C.dequeue=function(){if(0===this.size)return null;const A=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return A};C.clear=function(){for(;E.isSome(this.dequeue()););
};z._createClass(D,[{key:"entries",get:function(){return this._buffer}}]);return D}()})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./VertexStream".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q){const h=C.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest");let n=function(){function t(k){this._ignoresSamplerPrecision=null;this._context=k}E._createClass(t,[{key:"ignoresSamplerPrecision",get:function(){D.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=u(this._context));return this._ignoresSamplerPrecision}}]);return t}();const u=t=>{var k=new a(t,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,
dataType:5121,samplingMode:9728,width:1,height:1});const v=new Uint8Array(4),p=new q(t,[0,0,1,0,0,1,1,1]),r=new A(t,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0});var w=new c(t,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));r.setUniform1i("u_texture",0);t.bindTexture(w,0);w=t.getBoundFramebufferObject();t.bindFramebuffer(k);t.bindProgram(r);const {x:l,y:x,width:y,height:B}=t.getViewport();t.setViewport(0,0,1,1);p.draw();t.setViewport(l,x,y,B);k.readPixels(0,0,1,1,6408,
5121,v);r.dispose();p.dispose();k.dispose();(k=255!==v[0]||255!==v[1]||255!==v[2]||255!==v[3])&&h.warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${v[0]}.${v[1]}.${v[2]}.${v[3]}]`);t.bindFramebuffer(w);return k};z.testSamplerPrecision=u;z.testWebGLDriver=
t=>new n(t);Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["exports","./sources/resolver"],function(z,E){E={name:"stencil",shaders:{vertexShader:E.resolveIncludes("stencil/stencil.vert"),fragmentShader:E.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}};z.stencil=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicsView2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/promiseUtils ../../../../core/Accessor ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/SpatialReference ../../../../geometry/support/coordsUtils ../../../../geometry/Polygon ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../geometry/support/aaBoundingRect ../../../../symbols/support/defaults ../../../../core/HandleOwner ../../../../layers/graphics/data/projectionSupport ../../engine/webgl/definitions ../../../webgl/capabilities ../../engine/webgl/util/BidiText ../../../../symbols/cim/cimSymbolUtils ../../engine/webgl/TileData ../../engine/webgl/WGLTile ../features/schemaUtils ../../engine/webgl/mesh/factories/matcherUtils ../../engine/webgl/mesh/templates/WGLTemplateStore ../../engine/webgl/mesh/factories/WGLMeshFactory ../features/support/AttributeStore ../features/support/ComputedAttributeStorage ../features/support/GraphicsReader ../features/support/TileStore ./GraphicContainer ./graphicsUtils ./GraphicStore ../../../layers/GraphicsView".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v,p,r,w,l,x,y,B,F,G,J,K,M,R,N,I,H,Q,W,aa,da,S,U){function X(ba,Z,P){if(P.has(ba))return P.get(ba);Z={tile:Z,addedOrModified:[],removed:[]};P.set(ba,Z);return Z}D=function(ba){function Z(L){L=ba.call(this,L)||this;L._storage=new H.ComputedAttributeStorage;L._displayIds=new Map;L._tiles=new Map;L._graphicStoreUpdate=!1;L._graphicsSet=new Set;L._matcher=g.resolve(null);L._tileUpdateSet=new Set;L._tilesToUpdate=new Map;L._graphicIdToAbortController=new Map;
L._attached=!1;L._highlightIds=new Map;L._updatingGraphicsTimer=null;L._processing=!1;L._needsProcessing=!1;L._pendingUpdate={added:new Set,updated:new Set,removed:new Set};L.lastUpdateId=-1;L.updateRequested=!1;L.graphicUpdateHandler=L.graphicUpdateHandler.bind(z._assertThisInitialized(L));L._processAnalyzedGraphics=L._processAnalyzedGraphics.bind(z._assertThisInitialized(L));L._graphicsChangeHandler=L._graphicsChangeHandler.bind(z._assertThisInitialized(L));return L}z._inheritsLoose(Z,ba);var P=
Z.prototype;P._createMatcher=function(L,O){L&&(L=K.createMatcherSchema({indexCount:0,fields:{}},"feature",L),this._matcher=M.createMatcher(L,O,null))};P._createDisplayId=function(L){this._displayIds.has(L)||this._displayIds.set(L,this._storage.createDisplayId());return this._displayIds.get(L)};P.initialize=function(){this._tileStore=new W(this.view.featuresTilingScheme);this.container=new aa(this.view.featuresTilingScheme);this._attributeStore=new I["default"]({type:"local",initialize:O=>g.resolve(this.container.attributeView.initialize(O)),
update:O=>this.container.attributeView.requestUpdate(O),render:()=>this.container.requestRender()},y());this._graphicStore=new S(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,O=>{this._createDisplayId(O.uid);this._setFilterState(O.uid,O.visible)},O=>{const T=this._displayIds.get(O.uid);this._displayIds.delete(O.uid);this._storage.releaseDisplayId(T)});const L=new R.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0);this._createMatcher(this.renderer,
L);this._meshFactory=new N.WGLMeshFactory(null,this.uid,L);this._templateStore=L;this.watch("renderer",O=>{this._createMatcher(O,L);for(const T of this.graphics)this._pendingUpdate.updated.add(T);this.requestUpdate()});this._tileStore.on("update",this._onTileUpdate.bind(this));this.container.on("attach",()=>{0<this.graphics.items.length&&this._graphicsChangeHandler({target:this.graphics,added:this.graphics.items,removed:[],moved:[]});this.handles.add(this.graphics.on("change",this._graphicsChangeHandler),
"graphics");this._attached=!0;this.notifyChange("updating")})};P.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating"));this.container.destroy();this._set("graphics",null);this._graphicStore.clear();this._tileStore.destroy();this._attributeStore=null};P.hitTest=function(L,O){if(!this.view||!this.view.position)return g.resolve();L=this.view.toMap(v.createScreenPoint(L,O));return this.searchFeatures(L).then(T=>
T&&T.length?T[0]:null)};P.searchFeatures=async function(L,O=2){return this._graphicStore.hitTest(L.x,L.y,O,this.view.state.resolution,this.view.state.rotation)};P.update=function(L){L=L.state;const O=this.view.featuresTilingScheme.getClosestInfoForScale(L.scale).level;this._graphicStore.updateLevel(O);this._tileStore.setViewState(L);this._graphicStoreUpdate=!0;this.updateRequested=!1;0<this._pendingUpdate.updated.size&&(this._processing?this._needsProcessing=!0:this._updateGraphics())};P.viewChange=
function(){this.requestUpdate()};P.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.requestUpdateCallback())};P.processUpdate=function(L){this.updateRequested&&(this.updateRequested=!1,this.update(L))};P.graphicUpdateHandler=function(L){const {graphic:O,property:T,newValue:ea}=L;switch(T){case "geometry":case "symbol":this._pendingUpdate.updated.add(O);this.requestUpdate();break;case "visible":this._setFilterState(O.uid,ea),this._attributeStore.sendUpdates()}};P.addHighlight=
function(L){for(const O of L)this._highlightIds.has(O)?(L=this._highlightIds.get(O),this._highlightIds.set(O,L+1)):this._highlightIds.set(O,1);this._updateHighlight()};P.removeHighlight=function(L){for(const O of L)this._highlightIds.has(O)&&(L=this._highlightIds.get(O)-1,0===L?this._highlightIds.delete(O):this._highlightIds.set(O,L));this._updateHighlight()};P._updateHighlight=function(){const L=Array.from(this._highlightIds.keys()),O=L.map(T=>this._displayIds.get(T));this._attributeStore.setHighlight(L,
O)};P._getIntersectingTiles=function(L){return(L=this._graphicStore.getBounds(L))&&0!==p.width(L)&&0!==p.height(L)?this._tileStore.boundsIntersections(L):[]};P._updateTile=function(L){const O=L.tile,T=this._getGraphicsData(this._templateStore,O,L.addedOrModified);return this._processGraphics(T).then(ea=>{this._patchTile(O.key,{type:"update",addOrUpdate:ea,remove:L.removed,end:!0});return ea})};P._patchTile=function(L,O){this._tiles.has(L)&&(L=this._tiles.get(L),this.container.onTileData(L,O),this.container.requestRender())};
P._graphicsChangeHandler=function(L){for(const O of L.added)this._pendingUpdate.added.add(O);for(const O of L.moved)this._pendingUpdate.added.add(O);for(const O of L.removed)this._pendingUpdate.added.has(O)?this._pendingUpdate.added.delete(O):this._pendingUpdate.removed.add(O);this._processing?this._needsProcessing=!0:this._updateGraphics()};P._getGraphicsToUpdate=function(){const L={added:[],removed:[],updated:[]},O=this._pendingUpdate;for(const T of this.graphics.items)O.added.has(T)?L.added.push(T):
O.updated.has(T)&&L.updated.push(T);for(const T of O.removed)this._graphicStore.has(T)&&L.removed.push(T);O.added.clear();O.removed.clear();O.updated.clear();return L};P._updateGraphics=async function(){this._processing=!0;const {added:L,removed:O,updated:T}=this._getGraphicsToUpdate(),ea=this._tilesToUpdate;try{if(!this._graphicStoreUpdate){var fa=this.view.state,ha=this.view.featuresTilingScheme.getClosestInfoForScale(fa.scale).level;this._graphicStore.updateLevel(ha);this._tileStore.setViewState(fa)}fa=
[];const oa=Array(L.length+O.length);for(ha=0;ha<T.length;ha++){var ia=T[ha];const na=this._getIntersectingTiles(ia);for(const ta of na){var la=ta.id;X(la,ta,ea).removed.push(this._displayIds.get(ia.uid))}fa.push(this._updateGraphic(ia,null));oa[ha]=ia}var qa=T.length;for(ia=0;ia<L.length;ia++){const na=L[ia];oa[qa+ia]=na;this._graphicsSet.add(na);fa.push(this.addGraphic(na))}for(const na of O){this._abortProcessingGraphic(na.uid);const ta=this._getIntersectingTiles(na);for(const va of ta)la=va.id,
X(la,va,ea).removed.push(this._displayIds.get(na.uid));this._graphicsSet.delete(na);this._graphicStore.remove(na)}this._flipUpdatingGraphics();await g.all(fa);let ra;for(qa=0;qa<oa.length;qa++){ra=oa[qa];const na=this._getIntersectingTiles(ra);for(const ta of na)la=ta.id,X(la,ta,ea).addedOrModified.push(ra)}this._graphicStore.updateZ();la=[];for(const [,na]of ea)la.push(this._updateTile(na));await g.all(la)}catch(oa){}ea.clear();this.notifyChange("updating");this._processing=!1;this._needsProcessing&&
(this._needsProcessing=!1,this._updateGraphics())};P._getArcadeInfo=function(L){const O=(L.attributes?Object.keys(L.attributes):[]).map(T=>({name:T,alias:T,type:"string"===typeof L.attributes[T]?"esriFieldTypeString":"esriFieldTypeDouble"}));return C.isNone(L.geometry)?null:{geometryType:k.getJsonType(L.geometry),spatialReference:n.fromJSON(L.geometry.spatialReference),fields:O}};P._getSymbolForGraphic=async function(L,O){return C.isSome(L.symbol)?L.symbol:C.isSome(this.renderer)?this.renderer.getSymbolAsync(L,
{scale:this.view.scale,abortOptions:O}):this._getNullSymbol(L)};P._getSymbolResources=async function(L,O){if(!this.container.stage)return g.resolve(null);var T=this._getArcadeInfo(L);L=await this._getSymbolForGraphic(L,O);L=K.createSymbolSchema(L);O=await F.expandSymbol(L,T,O);if("esriTS"===O.type){T=[];[L]=B.bidiText(O.text);for(let ea=0;ea<L.length;ea++)T.push(L.charCodeAt(ea));[{mosaicItem:T}]=await this.container.getMaterialItems([{symbol:O,id:0,glyphIds:T}]);return{symbol:O,mosaicItem:T}}return{symbol:O,
mosaicItem:null}};P._projectAndNormalizeGeometry=async function(L){if(C.isNone(L.geometry))return g.resolve(null);let O=L.geometry;k.isPolygon(O)?O.rings=O.rings:k.isPolyline(O)?O.paths=O.paths:k.isExtent(O)&&(O=t.fromExtent(O));return l.checkProjectionSupport(O.spatialReference,this.view.spatialReference).then(()=>{var T=da.normalizeCentralMeridian(O);T=l.project(T,O.spatialReference,this.view.spatialReference);u.closeRingsAndFixWinding(T);return T})};P._onTileUpdate=function(L){const O=h.getInfo(this.view.spatialReference);
if(L.added&&0<L.added.length)for(const T of L.added)this._addNewTile(T,O);if(L.removed&&0<L.removed.length)for(const T of L.removed)this._removeTile(T.key)};P.addGraphic=function(L){this._abortProcessingGraphic(L.uid);const O=g.createAbortController();this._graphicIdToAbortController.set(L.uid,O);return this._addOrUpdateGraphic(L,{signal:O.signal}).then(()=>{this._graphicIdToAbortController.delete(L.uid)}).catch(T=>{this._graphicIdToAbortController.delete(L.uid);if(!g.isAbortError(T))throw T;})};
P._updateGraphic=async function(L,O){const T=this._projectAndNormalizeGeometry(L);O=this._getSymbolResources(L,O);const [ea,fa]=await g.all([T,O]);this._graphicStore.addOrModify(L,fa,ea)};P._addOrUpdateGraphic=async function(L,O){const T=this._projectAndNormalizeGeometry(L);O=this._getSymbolResources(L,O);try{const [ea,fa]=await g.all([T,O]);this._addProjectedGraphic(L,fa,ea)}catch(ea){if(!g.isAbortError(ea))throw ea;}};P._addProjectedGraphic=function(L,O,T){this._graphicsSet.has(L)&&this._graphicStore.addOrModify(L,
O,T)};P._addTile=function(L){var O=p.create();this.view.featuresTilingScheme.getTileBounds(O,L);O=new J.WGLTile(L,O,!0);this._tiles.set(L,O);this.container.addChild(O);return O};P._addNewTile=function(L,O){const T=this._addTile(L.key),ea=this._graphicStore.queryTileData(this._templateStore,L);if(O){O=Math.round((O.valid[1]-O.valid[0])/L.resolution);for(const ha of ea)ha.geometry&&k.isPoint(ha.geometry)&&this._wrapPoints(ha,O)}const fa=L.key;this._tileUpdateSet.add(L.key);this.notifyChange("updating");
this._processGraphics(ea).then(ha=>{T.setData({type:"update",clear:!0,addOrUpdate:ha,remove:[],end:!0});this._tileUpdateSet.delete(fa);this.notifyChange("updating")}).catch(ha=>{this._tileUpdateSet.delete(fa);this.notifyChange("updating");if(!g.isAbortError(ha))throw ha;})};P._removeTile=function(L){if(this._tiles.has(L)){var O=this._tiles.get(L);this.container.removeChild(O);O.destroy();this._tiles.delete(L)}};P._setFilterState=function(L,O){const T=this._displayIds.get(L);L=this._attributeStore.getHighlightFlag(L);
this._attributeStore.setData(T,0,0,L|(O?x.FILTER_FLAG_0:0))};P._getGraphicsData=function(L,O,T){const ea=h.getInfo(this.view.spatialReference);L=this._graphicStore.getGraphicsData(L,O,T);if(ea){O=Math.round((ea.valid[1]-ea.valid[0])/O.resolution);for(const fa of L)fa.geometry&&k.isPoint(fa.geometry)&&this._wrapPoints(fa,O)}return L};P._wrapPoints=function(L,O){const T=L.geometry;512===O?20>T.x?L.geometry={points:[[T.x,T.y],[O,0]]}:492<T.x&&(L.geometry={points:[[T.x,T.y],[-O,0]]}):-20>T.x?L.geometry=
{points:[[T.x,T.y],[O,0]]}:532<T.x&&(L.geometry={points:[[T.x,T.y],[-O,0]]})};P._processGraphics=async function(L,O){if(!L||!L.length||!this._meshFactory)return null;L=Q.GraphicsReader.from(L);await this._meshFactory.analyzeGraphics(L,await this._matcher,null,null,O);this._attributeStore.sendUpdates();return this._processAnalyzedGraphics(L)};P._processAnalyzedGraphics=function(L){var O=this._meshFactory;const T=O.createMeshData(L.getApproximateSize());for(L=L.getCursor();L.next();){const ea=L.readGraphic();
ea.insertAfter=-1===ea.insertAfter?-1:this._displayIds.get(ea.insertAfter);ea.displayId=this._displayIds.get(ea.attributes[this.uid]);O.writeGraphic(T,L)}O={};T.encode(O,[]);return G.TileData.decode(O)};P._abortProcessingGraphic=function(L){this._graphicIdToAbortController.has(L)&&this._graphicIdToAbortController.get(L).abort()};P._getNullSymbol=function(L){L=L.geometry;return k.isPolyline(L)?r.errorPolylineSymbol2D:k.isPolygon(L)||k.isExtent(L)?r.errorPolygonSymbol2D:r.errorPointSymbol2D};P._flipUpdatingGraphics=
function(){this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer);this._updatingGraphicsTimer=setTimeout(()=>{this._updatingGraphicsTimer=null;this.notifyChange("updating")},160);this.notifyChange("updating")};z._createClass(Z,[{key:"updating",get:function(){return!this._attached||null!==this._updatingGraphicsTimer||0<this._tileUpdateSet.size||0<this._tilesToUpdate.size}}]);return Z}(U.GraphicsView(w.HandleOwnerMixin(q)));E.__decorate([c.property({constructOnly:!0})],D.prototype,"requestUpdateCallback",
void 0);E.__decorate([c.property({constructOnly:!0})],D.prototype,"graphics",void 0);E.__decorate([c.property()],D.prototype,"updating",null);E.__decorate([c.property()],D.prototype,"view",void 0);E.__decorate([c.property()],D.prototype,"updateRequested",void 0);return D=E.__decorate([d.subclass("esri.views.2d.layers.support.GraphicsView2D")],D)})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/promiseUtils ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json".split(" "),
function(z,E,D,C,A,m){function c(q,h){if(!h)return null;if("x"in h){var n={x:0,y:0};[n.x,n.y]=q(h.x,h.y,a);null!=h.z&&(n.z=h.z);null!=h.m&&(n.m=h.m);return n}if("xmin"in h)return n={xmin:0,ymin:0,xmax:0,ymax:0},[n.xmin,n.ymin]=q(h.xmin,h.ymin,a),[n.xmax,n.ymax]=q(h.xmax,h.ymax,a),h.hasZ&&(n.zmin=h.zmin,n.zmax=h.zmax,n.hasZ=!0),h.hasM&&(n.mmin=h.mmin,n.mmax=h.mmax,n.hasM=!0),n;if("rings"in h)return{rings:b(h.rings,q),hasM:h.hasM,hasZ:h.hasZ};if("paths"in h)return{paths:b(h.paths,q),hasM:h.hasM,hasZ:h.hasZ};
if("points"in h)return{points:d(h.points,q),hasM:h.hasM,hasZ:h.hasZ}}function b(q,h){const n=[];for(const u of q)n.push(d(u,h));return n}function d(q,h){const n=[];for(const u of q)q=h(u[0],u[1],[0,0]),n.push(q),2<u.length&&q.push(u[2]),3<u.length&&q.push(u[3]);return n}const a=[0,0],e=c.bind(null,C.lngLatToXY),f=c.bind(null,C.xyToLngLat),g=new (function(){function q(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}var h=q.prototype;h.push=async function(n,u,t){n&&n.length&&
u&&t&&D.equals(u,t);const k={geometries:n,inSpatialReference:u,outSpatialReference:t,resolve:null};this._jobs.push(k);return E.create(v=>{k.resolve=v;null===this._timer&&(this._timer=setTimeout(this._process,10))})};h._process=function(){this._timer=null;const n=this._jobs.shift();if(n){var {geometries:u,inSpatialReference:t,outSpatialReference:k,resolve:v}=n;C.canProject(t,k)?D.isWebMercator(k)?v(u.map(e)):v(u.map(f)):v(A.projectMany(m.jsonAdapter,u,t,k,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}};return q}());z.checkProjectionSupport=async function(q,h){h&&(q=Array.isArray(q)?q.map(n=>{var u;return null==(u=n.geometry)?void 0:u.spatialReference}):[q],await A.initializeProjection(q.map(n=>({source:n,dest:h}))))};z.project=function(q,h,n){if(!q)return q;n||(n=h,h=q.spatialReference);return D.isValid(h)&&D.isValid(n)&&!D.equals(h,n)?C.canProject(h,n)?D.isWebMercator(n)?e(q):f(q):A.projectMany(m.jsonAdapter,[q],h,n,null)[0]:q};z.projectMany=async function(q,h,n){return g.push(q,h,n)};Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(z){let E=function(c,b,d){this.x=c;this.y=b;this.spatialReference=d;this.m=this.z=void 0},D=function(c,b,d,a){this.rings=c;this.spatialReference=b;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},C=function(c,b,d,a){this.paths=c;this.spatialReference=b;this.hasM=this.hasZ=void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},A=function(c,b,d,a){this.points=c;this.spatialReference=b;this.hasM=this.hasZ=
void 0;d&&(this.hasZ=d);a&&(this.hasM=a)},m=function(c,b,d,a,e){this.xmin=c;this.ymin=b;this.xmax=d;this.ymax=a;this.spatialReference=e;this.mmax=this.mmin=this.zmax=this.zmin=void 0};z.jsonAdapter={convertToGEGeometry:function(c,b){return null==b?null:c.convertJSONToGeometry(b)},exportPoint:function(c,b,d){d=new E(c.getPointX(b),c.getPointY(b),d);const a=c.hasZ(b),e=c.hasM(b);a&&(d.z=c.getPointZ(b));e&&(d.m=c.getPointM(b));return d},exportPolygon:function(c,b,d){return new D(c.exportPaths(b),d,c.hasZ(b),
c.hasM(b))},exportPolyline:function(c,b,d){return new C(c.exportPaths(b),d,c.hasZ(b),c.hasM(b))},exportMultipoint:function(c,b,d){return new A(c.exportPoints(b),d,c.hasZ(b),c.hasM(b))},exportExtent:function(c,b,d){var a=c.hasZ(b);const e=c.hasM(b);d=new m(c.getXMin(b),c.getYMin(b),c.getXMax(b),c.getYMax(b),d);a&&(a=c.getZExtent(b),d.zmin=a.vmin,d.zmax=a.vmax);e&&(c=c.getMExtent(b),d.mmin=c.vmin,d.mmax=c.vmax);return d}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/cimSymbolUtils":function(){define("exports ../../core/promiseUtils ../WebStyleSymbol ../../chunks/symbols ./cimAnalyzer ./ExpandedCIM".split(" "),
function(z,E,D,C,A,m){const c=async(d,a)=>new m.ExpandedCIM(await A.analyzeCIMSymbol(d.data,a),d.data,d.rendererKey),b=async(d,a,e)=>d?"cim"===d.type?c(d,a):"web-style"===d.type?(d={type:"cim",data:(await D.fromJSON(d).fetchCIMSymbol(e)).data,rendererKey:d.rendererKey},c(d,a)):d:null;z.expandSymbol=b;z.expandSymbols=async(d,a,e)=>E.all(d.map(f=>b(f,a,e)));Object.defineProperty(z,"__esModule",{value:!0})})},"esri/symbols/cim/cimAnalyzer":function(){define("exports ../../core/string ../../core/Logger ../../core/promiseUtils ../../support/arcadeOnDemand ../../Color ../../core/screenUtils ./utils ../../views/2d/arcade/callExpressionWithFeature ./CIMSymbolHelper ./SDFHelper".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){function f(I){switch(I){case "Butt":return 0;case "Square":return 2;default:return 1}}function g(I){switch(I){case "Bevel":return 0;case "Miter":return 2;default:return 1}}function q(I){switch(I){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function h(I){switch(I){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function n(I){let H="normal",
Q="normal";I&&(I=I.toLowerCase(),-1!==I.indexOf("italic")?H="italic":-1!==I.indexOf("oblique")&&(H="oblique"),-1!==I.indexOf("bold")?Q="bold":-1!==I.indexOf("light")&&(Q="lighter"));return{style:H,weight:Q}}function u(I,H,Q,W){let aa;I[H]?aa=I[H]:(aa={},I[H]=aa);aa[Q]=W}function t(I){return(I=I.markerPlacement)&&I.angleToLine?1:0}function k(I,H,Q,W,aa,da){if(I){var S=I.symbolLayers;if(S){var U,X=a.CIMSymbolHelper.getSize(I);"CIMPointSymbol"===I.type&&"Map"===I.angleAlignment&&(U=1);for(var ba=S.length;ba--;){var Z=
S[ba];if(Z&&!1!==Z.enable){var P=[];a.OverrideHelper.findApplicableOverrides(Z,H,P);switch(Z.type){case "CIMSolidFill":v(Z,Q,P,W,aa);break;case "CIMPictureFill":p(Z,Q,P,W,aa);break;case "CIMHatchFill":r(Z,Q,P,W,aa);break;case "CIMGradientFill":var L=Q,O=W,T=aa,ea=E.numericHash(JSON.stringify(Z)).toString();T.push({type:"fill",templateHash:ea,materialHash:0===P.length?ea:R(ea,L,P,O),cim:Z,materialOverrides:null,colorLocked:Z.colorLocked,effects:Z.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,
offsetX:0,offsetY:0,scaleX:1});break;case "CIMSolidStroke":w(Z,Q,P,W,aa,"CIMPolygonSymbol"===I.type,X);break;case "CIMPictureStroke":l(Z,Q,P,W,aa,"CIMPolygonSymbol"===I.type,X);break;case "CIMGradientStroke":{L=Q;O=W;T=aa;ea="CIMPolygonSymbol"===I.type;var fa=X,ha=Z.primitiveName,ia=void 0!==Z.width?Z.width:4,la=f(Z.capStyle),qa=g(Z.joinStyle);const oa=Z.miterLimit,ra=E.numericHash(JSON.stringify(Z)).toString();T.push({type:"line",templateHash:ra,materialHash:0===P.length?ra:R(ra,L,P,O),cim:Z,materialOverrides:null,
isOutline:ea,colorLocked:Z.colorLocked,effects:Z.effects,color:{r:128,g:128,b:128,a:1},width:M(ha,L,"Width",O,ia),cap:M(ha,L,"CapStyle",O,la),join:M(ha,L,"JoinStyle",O,qa),miterLimit:M(ha,L,"MiterLimit",O,oa),referenceWidth:fa,zOrder:J(Z.name),isDashed:!1})}break;case "CIMCharacterMarker":x(Z,Q,P,W,aa);break;case "CIMPictureMarker":if(x(Z,Q,P,W,aa))break;"CIMLineSymbol"===I.type&&(U=t(Z));y(Z,Q,P,W,aa,U,X);break;case "CIMVectorMarker":if(x(Z,Q,P,W,aa))break;"CIMLineSymbol"===I.type&&(U=t(Z));L=Q;
O=W;T=aa;ea=U;fa=X;ha=da;if(la=Z.markerGraphics){ia=0;Z.scaleSymbolsProportionally&&(qa=Z.frame)&&(ia=qa.ymax-qa.ymin);for(const oa of la)if(oa&&(la=oa.symbol))switch(la.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":F(Z,oa,P,L,O,T,ea,fa,ia,ha);break;case "CIMTextSymbol":B(Z,oa,L,P,O,T,ea,fa,ia)}}break;default:N.error("Cannot analyze CIM layer",Z.type)}}}}}}function v(I,H,Q,W,aa){const da=I.primitiveName,S=b.fromCIMColor(I.color),U=E.numericHash(JSON.stringify(I)).toString();
aa.push({type:"fill",templateHash:U,materialHash:0===Q.length?U:()=>U,cim:I,materialOverrides:null,colorLocked:I.colorLocked,color:M(da,H,"Color",W,S,K),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:I.effects})}function p(I,H,Q,W,aa){const da=I.primitiveName,S=I.tintColor?b.fromCIMColor(I.tintColor):{r:255,g:255,b:255,a:1},U=E.numericHash(JSON.stringify(I)).toString(),X=E.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();aa.push({type:"fill",templateHash:U,materialHash:0===
Q.length?X:()=>X,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,color:M(da,H,"TintColor",W,S,K),height:M(da,H,"Height",W,I.height),scaleX:M(da,H,"ScaleX",W,I.scaleX),angle:M(da,H,"Rotation",W,I.rotation),offsetX:M(da,H,"OffsetX",W,I.offsetX),offsetY:M(da,H,"OffsetY",W,I.offsetY)})}function r(I,H,Q,W,aa){const da=["Rotation","OffsetX","OffsetY"],S=Q.filter(Z=>Z.primitiveName!==I.primitiveName&&-1===da.indexOf(Z.propertyName)),U=I.primitiveName,X=E.numericHash(JSON.stringify(I)).toString(),
ba=E.numericHash(`${I.separation}${JSON.stringify(I.lineSymbol)}`).toString();aa.push({type:"fill",templateHash:X,materialHash:0===Q.length?ba:R(ba,H,S,W),cim:I,materialOverrides:S,colorLocked:I.colorLocked,effects:I.effects,color:{r:255,g:255,b:255,a:1},height:M(U,H,"Separation",W,I.separation),scaleX:1,angle:M(U,H,"Rotation",W,I.rotation),offsetX:M(U,H,"OffsetX",W,I.offsetX),offsetY:M(U,H,"OffsetY",W,I.offsetY)})}function w(I,H,Q,W,aa,da,S){const U=E.numericHash(JSON.stringify(I)).toString(),X=
I.primitiveName,ba=b.fromCIMColor(I.color),Z=void 0!==I.width?I.width:4,P=f(I.capStyle),L=g(I.joinStyle),O=I.miterLimit;aa.push({type:"line",templateHash:U,materialHash:0===Q.length?U:()=>U,cim:I,materialOverrides:null,isOutline:da,colorLocked:I.colorLocked,effects:I.effects,color:M(X,H,"Color",W,ba,K),width:M(X,H,"Width",W,Z),cap:M(X,H,"CapStyle",W,P),join:M(X,H,"JoinStyle",W,L),miterLimit:M(X,H,"MiterLimit",W,O),referenceWidth:S,zOrder:J(I.name),isDashed:!1})}function l(I,H,Q,W,aa,da,S){const U=
E.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString(),X=I.primitiveName,ba=b.fromCIMColor(I.tintColor),Z=void 0!==I.width?I.width:4,P=f(I.capStyle),L=g(I.joinStyle),O=I.miterLimit,T=E.numericHash(JSON.stringify(I)).toString();aa.push({type:"line",templateHash:T,materialHash:0===Q.length?U:()=>U,cim:I,materialOverrides:null,isOutline:da,colorLocked:I.colorLocked,effects:I.effects,color:M(X,H,"TintColor",W,ba,K),width:M(X,H,"Width",W,Z),cap:M(X,H,"CapStyle",W,P),join:M(X,H,"JoinStyle",
W,L),miterLimit:M(X,H,"MiterLimit",W,O),referenceWidth:S,zOrder:J(I.name),isDashed:!1})}function x(I,H,Q,W,aa){const da=I.markerPlacement;if(!da||"CIMMarkerPlacementInsidePolygon"!==da.type)return!1;const S=["Rotation","OffsetX","OffsetY"],U=Q.filter(ba=>ba.primitiveName!==I.primitiveName&&-1===S.indexOf(ba.propertyName)),X=E.numericHash(JSON.stringify(I)).toString();aa.push({type:"fill",templateHash:X,materialHash:0===Q.length?X:R(X,H,U,W),cim:I,materialOverrides:U,colorLocked:I.colorLocked,effects:I.effects,
color:{r:255,g:255,b:255,a:1},height:M(da.primitiveName,H,"StepY",W,da.stepY),scaleX:1,angle:M(da.primitiveName,H,"GridAngle",W,da.gridAngle),offsetX:M(da.primitiveName,H,"OffsetX",W,da.offsetX),offsetY:M(da.primitiveName,H,"OffsetY",W,da.offsetY)});return!0}function y(I,H,Q,W,aa,da,S){const U=I.primitiveName,X=I.size,ba=I.scaleX,Z=I.rotation,P=I.offsetX,L=I.offsetY,O=b.fromCIMColor(I.tintColor),T=E.numericHash(`${I.url}${JSON.stringify(I.colorSubstitutions)}`).toString();let ea=!1,fa="";for(const ha of Q)ha.primitiveName===
U&&(void 0!==ha.value?fa+=`-${ha.primitiveName}-${ha.propertyName}-${JSON.stringify(ha.value)}`:ha.valueExpressionInfo&&(ea=!0));aa.push({type:"marker",templateHash:E.numericHash(JSON.stringify(I)+fa).toString(),materialHash:ea?()=>T:T,cim:I,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:!1,alignment:da,size:M(U,H,"Size",W,X),scaleX:M(U,H,"ScaleX",W,ba),rotation:M(U,H,"Rotation",W,Z),offsetX:M(U,H,"OffsetX",W,P),offsetY:M(U,H,"OffsetY",W,L),color:M(U,
H,"TintColor",W,O,K),anchorPoint:I.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:I.rotateClockwise,referenceSize:S,sizeRatio:1,markerPlacement:I.markerPlacement})}function B(I,H,Q,W,aa,da,S,U,X){a.OverrideHelper.findApplicableOverrides(H,W,[]);var ba=H.geometry;if("x"in ba&&"y"in ba){var Z=H.symbol;var P=Z.underline?"underline":Z.strikethrough?"line-through":"none";var L=n(Z.fontStyleName);Z.font={family:Z.fontFamilyName,
decoration:P,...L};var O=I.frame,T=I.size/X;X=I.primitiveName;P=(Z.height||0)*T;L=Z.angle||0;var ea=((Z.offsetX||0)+(ba.x-.5*(O.xmin+O.xmax)))*T;ba=((Z.offsetY||0)+(ba.y-.5*(O.ymin+O.ymax)))*T;O=b.fromCIMColor(a.CIMSymbolHelper.getFillColor(Z));var fa=b.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(Z)),ha=a.CIMSymbolHelper.getStrokeWidth(Z);ha||(fa=b.fromCIMColor(a.CIMSymbolHelper.getFillColor(Z.haloSymbol)),ha=Z.haloSize*T);T="";for(const ia of W)ia.primitiveName===X&&void 0!==ia.value&&(T+=`-${ia.primitiveName}-${ia.propertyName}-${JSON.stringify(ia.value)}`);
W=JSON.stringify(I.effects)+Number(I.colorLocked)+JSON.stringify(I.anchorPoint)+I.anchorPointUnits+JSON.stringify(I.markerPlacement);W=E.numericHash(JSON.stringify(H)+W+T).toString();da.push({type:"text",templateHash:W,materialHash:()=>E.numericHash(JSON.stringify(Z.font)).toString(),cim:Z,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,alignment:S,anchorPoint:{x:I.anchorPoint?I.anchorPoint.x:0,y:I.anchorPoint?I.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==I.anchorPointUnits,
fontName:Z.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:M(X,Q,"Size",aa,P),angle:M(X,Q,"Rotation",aa,L),offsetX:M(X,Q,"OffsetX",aa,ea),offsetY:M(X,Q,"OffsetY",aa,ba),horizontalAlignment:q(Z.horizontalAlignment),verticalAlignment:h(Z.verticalAlignment),text:M(H.primitiveName,Q,"TextString",aa,H.textString,b._adjustTextCase,Z.textCase),color:O,outlineColor:fa,outlineSize:ha,referenceSize:U,sizeRatio:1,markerPlacement:I.markerPlacement})}}function F(I,H,Q,W,aa,da,S,U,X,ba){const Z=
H.geometry;if(Z){var P=H.symbol.symbolLayers;if(P)if(ba)G(I,H,W,Q,aa,da,S,U,X);else for(ba=P.length;ba--;){var L=P[ba];if(L&&!1!==L.enable)switch(L.type){case "CIMSolidFill":case "CIMSolidStroke":{var O=e.getExtent(Z);if(!O)continue;const [fa,ha,ia]=e.getSDFMetrics(O,I.frame,I.size,I.anchorPoint,"Relative"!==I.anchorPointUnits);var T="CIMSolidFill"===L.type;O={type:"sdf",geom:Z,asFill:T};var ea=I.primitiveName;const la=I.size,qa=I.rotation||0,oa=I.offsetX,ra=I.offsetY,na=L.primitiveName,ta=T?b.fromCIMColor(a.CIMSymbolHelper.getFillColor(L)):
b.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(L)),va=T?{r:0,g:0,b:0,a:0}:b.fromCIMColor(a.CIMSymbolHelper.getStrokeColor(L)),wa=a.CIMSymbolHelper.getStrokeWidth(L);if(!T&&!wa)break;T=!1;let Ha="";for(const za of Q)if(za.primitiveName===na||za.primitiveName===ea)void 0!==za.value?Ha+=`-${za.primitiveName}-${za.propertyName}-${JSON.stringify(za.value)}`:za.valueExpressionInfo&&(T=!0);ea=JSON.stringify({...I,markerGraphics:null});const Fa=E.numericHash(JSON.stringify(O)).toString();L={type:"marker",
templateHash:E.numericHash(JSON.stringify(H)+JSON.stringify(L)+ea+Ha).toString(),materialHash:T?()=>Fa:Fa,cim:O,materialOverrides:null,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:S,anchorPoint:{x:ha,y:ia},isAbsoluteAnchorPoint:!1,size:M(I.primitiveName,W,"Size",aa,la),rotation:M(I.primitiveName,W,"Rotation",aa,qa),offsetX:M(I.primitiveName,W,"OffsetX",aa,oa),offsetY:M(I.primitiveName,W,"OffsetY",aa,ra),scaleX:1,frameHeight:X,rotateClockwise:I.rotateClockwise,
referenceSize:U,sizeRatio:fa,color:M(na,W,"Color",aa,ta,K),outlineColor:M(na,W,"Color",aa,va,K),outlineWidth:M(na,W,"Width",aa,wa),markerPlacement:I.markerPlacement};da.push(L);break}default:G(I,H,W,Q,aa,da,S,U,X)}}}}function G(I,H,Q,W,aa,da,S,U,X){H={type:I.type,enable:!0,name:I.name,colorLocked:I.colorLocked,primitiveName:I.primitiveName,anchorPoint:I.anchorPoint,anchorPointUnits:I.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:I.rotateClockwise,rotation:0,size:I.size,billboardMode3D:I.billboardMode3D,
depth3D:I.depth3D,frame:I.frame,markerGraphics:[H],scaleSymbolsProportionally:I.scaleSymbolsProportionally,respectFrame:I.respectFrame,clippingPath:I.clippingPath,effects:I.effects};let ba=[];const Z=["Rotation","OffsetX","OffsetY"];ba=W.filter(ia=>ia.primitiveName!==I.primitiveName||-1===Z.indexOf(ia.propertyName));var P="";for(var L of W)void 0!==L.value&&(P+=`-${L.primitiveName}-${L.propertyName}-${JSON.stringify(L.value)}`);const [O,T,ea]=a.CIMSymbolHelper.getTextureAnchor(H);W=I.primitiveName;
L=I.rotation||0;const fa=I.offsetX||0,ha=I.offsetY||0;P=E.numericHash(JSON.stringify(H)+P).toString();Q={type:"marker",templateHash:P,materialHash:0===ba.length?P:R(P,Q,ba,aa),cim:H,materialOverrides:ba,colorLocked:I.colorLocked,effects:I.effects,scaleSymbolsProportionally:I.scaleSymbolsProportionally,alignment:S,anchorPoint:{x:O,y:T},isAbsoluteAnchorPoint:!1,size:I.size,rotation:M(W,Q,"Rotation",aa,L),offsetX:M(W,Q,"OffsetX",aa,fa),offsetY:M(W,Q,"OffsetY",aa,ha),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:X,rotateClockwise:I.rotateClockwise,referenceSize:U,sizeRatio:ea/c.pt2px(I.size),markerPlacement:I.markerPlacement};da.push(Q)}function J(I){return I&&0===I.indexOf("Level_")?parseInt(I.substr(6),10):0}function K(I){if(!I||0===I.length)return null;I=(new m(I)).toRgba();return{r:I[0],g:I[1],b:I[2],a:I[3]}}function M(I,H,Q,W,aa,da,S){if(I=H[I]){const U=I[Q];if("string"===typeof U||"number"===typeof U||U instanceof Array)return da?da.call(null,U,S):U;
if(null!=U&&U instanceof A.ArcadeExpression)return(X,ba,Z)=>{X=d(U,X,{$view:Z},W.geometryType,ba);null!==X&&da&&(X=da.call(null,X,S));return null!==X?X:aa}}return aa}function R(I,H,Q,W){for(const aa of Q)if(aa.valueExpressionInfo){const da=H[aa.primitiveName]&&H[aa.primitiveName][aa.propertyName];da instanceof A.ArcadeExpression&&(aa.fn=(S,U,X)=>d(da,S,{$view:X},W.geometryType,U))}return(aa,da,S)=>{for(const U of Q)U.fn&&(U.value=U.fn(aa,da,S));return E.numericHash(I+a.OverrideHelper.buildOverrideKey(Q)).toString()}}
const N=D.getLogger("esri.symbols.cim.cimAnalyzer");z.analyzeCIMResource=function(I,H){if(!H||0===H.length)return I;I=JSON.parse(JSON.stringify(I));a.OverrideHelper.applyOverrides(I,H);return I};z.analyzeCIMSymbol=async function(I,H,Q,W){Q=Q?Q:[];if(!I)return Q;let aa;const da={};if("CIMSymbolReference"===I.type){if(aa=I.symbol,I=I.primitiveOverrides){const U=[];for(const X of I){var S=X.valueExpressionInfo;S&&H?(S=A.createRendererExpression(S.expression,H.spatialReference,H.fields).then(ba=>{ba&&
u(da,X.primitiveName,X.propertyName,ba)}),U.push(S)):null!=X.value&&u(da,X.primitiveName,X.propertyName,X.value)}await C.all(U)}}else return N.error("Expect cim type to be 'CIMSymbolReference'"),Q;switch(aa.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":k(aa,I,da,H,Q,W)}return Q};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/arcade/callExpressionWithFeature":function(){define(["../../../core/Logger","../../../core/Error","../../../geometry/support/quantizationUtils"],
function(z,E,D){function C(m){const c={};switch(m){case "esriGeometryPoint":return(b,d,a,e)=>D.unquantizePoint(d,c,b,a,e);case "esriGeometryPolygon":return(b,d,a,e)=>D.unquantizePolygon(d,c,b,a,e);case "esriGeometryPolyline":return(b,d,a,e)=>D.unquantizePolyline(d,c,b,a,e);case "esriGeometryMultipoint":return(b,d,a,e)=>D.unquantizeMultipoint(d,c,b,a,e);default:return z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new E("mapview-arcade",`Unable to handle geometryType: ${m}`)),b=>b}}const A=
new Map;return function(m,c,b,d,a){if(m.referencesGeometry()&&a){{const {transform:e,hasZ:f,hasM:g}=a;A.has(d)||A.set(d,C(d));d=A.get(d)(c.geometry,e,f,g);c={...c,geometry:d}}}c=m.repurposeFeature(c);try{return m.evaluate({...b,$feature:c})}catch(e){return z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(z,E){function D({scale:y,translate:B},F){return Math.round((F-
B[0])/y[0])}function C({scale:y,translate:B},F){return Math.round((B[1]-F)/y[1])}function A(y,B,F){const G=[];let J,K,M,R;for(let N=0;N<F.length;N++){const I=F[N];if(0<N){if(M=D(y,I[0]),R=C(y,I[1]),M!==J||R!==K)G.push(B(I,M-J,R-K)),J=M,K=R}else J=D(y,I[0]),K=C(y,I[1]),G.push(B(I,J,K))}return 0<G.length?G:null}function m(y,B,F,G){return A(y,F?G?x:l:G?l:w,B)}function c(y,B,F,G){const J=[];F=F?G?x:l:G?l:w;for(G=0;G<B.length;G++){const K=A(y,F,B[G]);K&&3<=K.length&&J.push(K)}return J.length?J:null}function b(y,
B,F,G){const J=[];F=F?G?x:l:G?l:w;for(G=0;G<B.length;G++){const K=A(y,F,B[G]);K&&2<=K.length&&J.push(K)}return J.length?J:null}function d({scale:y,translate:B},F){return F*y[0]+B[0]}function a({scale:y,translate:B},F){return B[1]-F*y[1]}function e(y,B,F){const G=Array(F.length);if(!F.length)return G;const [J,K]=y.scale;let M=d(y,F[0][0]);y=a(y,F[0][1]);G[0]=B(F[0],M,y);for(let R=1;R<F.length;R++){const N=F[R];M+=N[0]*J;y-=N[1]*K;G[R]=B(N,M,y)}return G}function f(y,B,F){const G=Array(F.length);for(let J=
0;J<F.length;J++)G[J]=e(y,B,F[J]);return G}function g(y,B,F,G){return e(y,F?G?x:l:G?l:w,B)}function q(y,B,F,G){return f(y,F?G?x:l:G?l:w,B)}function h(y,B,F,G){return f(y,F?G?x:l:G?l:w,B)}function n(y,B,F){let [G,J]=F[0],K=Math.min(G,B[0]),M=Math.min(J,B[1]),R=Math.max(G,B[2]);B=Math.max(J,B[3]);for(let N=1;N<F.length;N++){const [I,H]=F[N];G+=I;J+=H;0>I&&(K=Math.min(K,G));0<I&&(R=Math.max(R,G));0>H?M=Math.min(M,J):0<H&&(B=Math.max(B,J))}y[0]=K;y[1]=M;y[2]=R;y[3]=B;return y}function u(y,B){if(!B.length)return null;
y[0]=y[1]=Number.POSITIVE_INFINITY;y[2]=y[3]=Number.NEGATIVE_INFINITY;for(let F=0;F<B.length;F++)n(y,y,B[F]);return y}function t(y,B,F,G,J){B.xmin=D(y,F.xmin);B.ymin=C(y,F.ymin);B.xmax=D(y,F.xmax);B.ymax=C(y,F.ymax);B!==F&&(G&&(B.zmin=F.zmin,B.zmax=F.zmax),J&&(B.mmin=F.mmin,B.mmax=F.mmax));return B}function k(y,B,F,G,J){B.points=m(y,F.points,G,J);return B}function v(y,B,F,G,J){B.x=D(y,F.x);B.y=C(y,F.y);B!==F&&(G&&(B.z=F.z),J&&(B.m=F.m));return B}function p(y,B,F,G,J){y=c(y,F.rings,G,J);if(!y)return null;
B.rings=y;return B}function r(y,B,F,G,J){y=b(y,F.paths,G,J);if(!y)return null;B.paths=y;return B}const w=(y,B,F)=>[B,F],l=(y,B,F)=>[B,F,y[2]],x=(y,B,F)=>[B,F,y[2],y[3]];z.equals=function(y,B){if(y===B||null==y&&null==B)return!0;if(null==y||null==B)return!1;let F,G,J,K;y&&"upperLeft"===y.originPosition?(F=y.translate[0],G=y.translate[1],y=y.scale[0]):(F=y.extent.xmin,G=y.extent.ymax,y=y.tolerance);B&&"upperLeft"===B.originPosition?(J=B.translate[0],K=B.translate[1],B=B.scale[0]):(J=B.extent.xmin,K=
B.extent.ymax,B=B.tolerance);return F===J&&G===K&&y===B};z.getQuantizedBoundsCoordsArray=n;z.getQuantizedBoundsCoordsArrayArray=u;z.getQuantizedBoundsPaths=function(y){return u([0,0,0,0],y)};z.getQuantizedBoundsPoints=function(y){const B=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return n(B,B,y)};z.getQuantizedBoundsRings=function(y){return u([0,0,0,0],y)};z.quantizeBounds=function(y,B,F){B[0]=D(y,F[0]);B[3]=C(y,F[1]);B[2]=D(y,F[2]);B[1]=
C(y,F[3]);return B};z.quantizeExtent=t;z.quantizeGeometry=function(y,B){return y&&B?E.isPoint(B)?v(y,{},B,!1,!1):E.isPolyline(B)?r(y,{},B,!1,!1):E.isPolygon(B)?p(y,{},B,!1,!1):E.isMultipoint(B)?k(y,{},B,!1,!1):E.isExtent(B)?t(y,{},B,!1,!1):null:null};z.quantizeMultipoint=k;z.quantizePaths=b;z.quantizePoint=v;z.quantizePoints=m;z.quantizePolygon=p;z.quantizePolyline=r;z.quantizeRings=c;z.quantizeX=D;z.quantizeY=C;z.toQuantizationTransform=function(y){return y?{originPosition:"upper-left"===y.originPosition?
"upperLeft":"lower-left"===y.originPosition?"lowerLeft":y.originPosition,scale:[y.tolerance,y.tolerance],translate:[y.extent.xmin,y.extent.ymax]}:null};z.unquantizeBounds=function(y,B,F){return F?(B[0]=d(y,F[0]),B[1]=a(y,F[3]),B[2]=d(y,F[2]),B[3]=a(y,F[1]),B):[d(y,B[0]),a(y,B[3]),d(y,B[2]),a(y,B[1])]};z.unquantizeCoordsArray=e;z.unquantizeCoordsArrayArray=f;z.unquantizeExtent=function(y,B,F,G,J){B.xmin=d(y,F.xmin);B.ymin=a(y,F.ymin);B.xmax=d(y,F.xmax);B.ymax=a(y,F.ymax);B!==F&&(G&&(B.zmin=F.zmin,
B.zmax=F.zmax),J&&(B.mmin=F.mmin,B.mmax=F.mmax));return B};z.unquantizeMultipoint=function(y,B,F,G,J){B.points=g(y,F.points,G,J);return B};z.unquantizePaths=q;z.unquantizePoint=function(y,B,F,G,J){B.x=d(y,F.x);B.y=a(y,F.y);B!==F&&(G&&(B.z=F.z),J&&(B.m=F.m));return B};z.unquantizePoints=g;z.unquantizePolygon=function(y,B,F,G,J){B.rings=h(y,F.rings,G,J);return B};z.unquantizePolyline=function(y,B,F,G,J){B.paths=q(y,F.paths,G,J);return B};z.unquantizeRings=h;z.unquantizeX=d;z.unquantizeY=a;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/symbols/cim/ExpandedCIM":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","../../views/2d/engine/webgl/enums","../../views/2d/engine/webgl/materialKey/MaterialKey"],function(z,E,D,C){const A={marker:D.WGLGeometryType.MARKER,fill:D.WGLGeometryType.FILL,line:D.WGLGeometryType.LINE,text:D.WGLGeometryType.TEXT};D=function(){function m(c,b,d){this.layers=c;this.data=b;this.hash=this._createHash();this.rendererKey=d;for(const a of c)a.materialKey=C.createMaterialKey(A[a.type],
this.rendererKey,!1,!1)}m.prototype._createHash=function(){let c="";for(const b of this.layers)c+=b.templateHash;return c};E._createClass(m,[{key:"type",get:function(){return"expanded-cim"}}]);return m}();z.ExpandedCIM=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileData":function(){define("exports ./enums ./Utils ./MemoryRequirements ./TileBufferData ./WGLDisplayRecord ./TileDisplayData ./util/Writer ./mesh/MeshData ./mesh/VertexBuffer".split(" "),function(z,
E,D,C,A,m,c,b,d,a){const e=new C,f=new C;C=function(){function g(){this.tileBufferData=this.tileDisplayData=null}var q=g.prototype;q.reshuffle=function(){e.reset();const h=c.groupRecordsByGeometryType(this.tileDisplayData.displayObjects);for(var n of h)for(var u of n)u&&e.needMore(u.geometryType,u.meshData?u.meshData.vertexCount:u.vertexCount,u.meshData?u.meshData.indexData.length:u.indexCount);n=h.length;u=new A;for(var t=0;t<n;++t){u.geometries[t].indexBuffer=new Uint32Array(Math.round(1.5*e.indicesFor(t)));
var k=[];for(var v in this.tileBufferData.geometries[t].vertexBuffer)k.push(this.tileBufferData.geometries[t].vertexBuffer[v].stride);k=g._computeVertexAlignment(k);var p=Math.round(1.5*e.verticesFor(t));k=g._align(p,k);for(var r in this.tileBufferData.geometries[t].vertexBuffer)p=this.tileBufferData.geometries[t].vertexBuffer[r].stride,u.geometries[t].vertexBuffer[r]={stride:p,data:D.allocateTypedArrayBuffer(k,p)}}f.reset();this.tileDisplayData.displayList.clear();for(v=0;v<n;++v){r=h[v];for(const w of r){if(w.meshData)w.writeMeshDataToBuffers(f.verticesFor(v),
u.geometries[v].vertexBuffer,f.indicesFor(v),u.geometries[v].indexBuffer),w.meshData=null;else{t=this.tileBufferData.geometries[v].vertexBuffer;k=this.tileBufferData.geometries[v].indexBuffer;p=u.geometries[v].vertexBuffer;const l=u.geometries[v].indexBuffer,x=f.verticesFor(v),y=f.indicesFor(v);D.copyMeshData(x,y,p,l,w,t,k);w.vertexFrom=x;w.indexFrom=y}f.needMore(v,w.vertexCount,w.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(r)}if(this.tileDisplayData.displayList.unified)for(const w of this.tileDisplayData.displayObjects)this.tileDisplayData.displayList.addToList(w.displayRecords);
this.tileBufferData=u};q.reshuffleBulkAdd=function(h,n,u){const t=h.addOrUpdate.tileDisplayData.displayObjects;var k=this.tileDisplayData.displayObjects;e.reset();for(var v=0;v<k.length;v++){var p=k[v];for(var r=0;r<p.displayRecords.length;r++){var w=p.displayRecords[r];e.needMore(w.geometryType,w.vertexCount,w.indexCount)}}for(v=n;v<t.length;v++)for(p=t[v],r=v===n?u:0;r<p.displayRecords.length;r++)w=p.displayRecords[r],e.needMore(w.geometryType,w.vertexCount,w.indexCount);v=new A;for(p=0;5>p;p++){v.geometries[p].indexBuffer=
new Uint32Array(Math.round(1.5*e.indicesFor(p)));w=[];r=this.tileBufferData.geometries[p].vertexBuffer;for(var l in r)w.push(r[l].stride);w=g._computeVertexAlignment(w);var x=Math.round(1.5*e.verticesFor(p));w=g._align(x,w);for(var y in r){x=r[y].stride;var B=D.allocateTypedArrayBuffer(w,x);v.geometries[p].vertexBuffer[y]={stride:x,data:B}}}f.reset();this.tileDisplayData.displayList.clear();for(l=0;l<k.length;l++)for(y=k[l],p=0;p<y.displayRecords.length;p++){r=y.displayRecords[p];w=r.geometryType;
x=this.tileBufferData.geometries[w].vertexBuffer;B=this.tileBufferData.geometries[w].indexBuffer;var F=v.geometries[w].vertexBuffer,G=v.geometries[w].indexBuffer,J=f.verticesFor(w),K=f.indicesFor(w);D.copyMeshData(J,K,F,G,r,x,B);r.vertexFrom=J;r.indexFrom=K;f.needMore(w,r.vertexCount,r.indexCount);this.tileDisplayData.displayList.addToList(r)}k=this.tileDisplayData.displayObjectRegistry;if(0!==u)for(l=t[n],y=0;y<u;y++)p=l.displayRecords[y],k.get(l.id)&&p.geometryType!==E.WGLGeometryType.FILL&&p.geometryType!==
E.WGLGeometryType.LINE||(r=p.geometryType,w=this.tileBufferData.geometries[r].vertexBuffer,x=this.tileBufferData.geometries[r].indexBuffer,B=v.geometries[r].vertexBuffer,F=v.geometries[r].indexBuffer,G=f.verticesFor(r),J=f.indicesFor(r),D.copyMeshData(G,J,B,F,p,w,x),p.vertexFrom=G,p.indexFrom=J,f.needMore(r,p.vertexCount,p.indexCount),this.tileDisplayData.displayList.addToList(p));for(l=n;l<t.length;l++){y=t[l];r=l===n?u:0;for(p=k.get(y.id);r<y.displayRecords.length;r++){w=y.displayRecords[r];if(p){if(w.geometryType!==
E.WGLGeometryType.FILL&&w.geometryType!==E.WGLGeometryType.LINE)continue;p.displayRecords.push(w)}x=w.geometryType;F=h.addOrUpdate.tileBufferData.geometries[x];B=F.vertexBuffer;F=F.indexBuffer;G=v.geometries[x].vertexBuffer;J=v.geometries[x].indexBuffer;K=f.verticesFor(x);const M=f.indicesFor(x);D.copyMeshData(K,M,G,J,w,B,F);w.vertexFrom=K;w.indexFrom=M;f.needMore(x,w.vertexCount,w.indexCount);this.tileDisplayData.displayList.addToList(w)}p||(k.set(y.id,y),this.tileDisplayData.displayObjects.push(y))}this.tileBufferData=
v};q.getStrides=function(){const h=[];for(let n=0;n<this.tileBufferData.geometries.length;++n){const u=this.tileBufferData.geometries[n];h[n]={};for(const t in u.vertexBuffer)h[n][t]=u.vertexBuffer[t].stride}return h};q.clone=function(){const h=new g;h.tileBufferData=this.tileBufferData.clone();h.tileDisplayData=this.tileDisplayData.clone();return h};q._guessSize=function(){const {displayObjects:h}=this.tileDisplayData,n=Math.min(h.length,4);let u=0;for(let t=0;t<n;t++)u=Math.max(u,h[t].displayRecords.length);
return 2*(12*h.length+h.length*u*40)};q.serialize=function(){const h=this.tileBufferData.serialize(),n=this.tileBufferData.getBuffers(),u=this.tileDisplayData.serialize(new b(Int32Array,this._guessSize())).buffer();n.push(u);return{result:{displayData:u,bufferData:h},transferList:n}};g.decode=function(h){const n=d.MeshData.deserializeDisplayObjects(h),u={};for(const t in h.vertexBuffersMap)u[t]=a.VertexBuffers.decode(h.vertexBuffersMap[t]);return g.fromMeshData({displayObjects:n,vertexBuffersMap:u})};
g.fromMeshData=function(h){const n=new g,u=new c["default"],t=new A;u.displayObjects=h.displayObjects;for(const k in h.vertexBuffersMap){const v=h.vertexBuffersMap[k];t.geometries[k].indexBuffer=v.indexBuffer;t.geometries[k].vertexBuffer=v.namedBuffers}n.tileDisplayData=u;n.tileBufferData=t;return n};g.bind=function(h,n){const u=new g;u.tileDisplayData=h;u.tileBufferData=n;return u};g.create=function(h,n){const u=new g;u.tileDisplayData=new c["default"];u.tileDisplayData.displayObjects=h;const t=
[0,0,0,0,0],k=[0,0,0,0,0],v=[[],[],[],[],[]];for(var p of h)for(var r of p.displayRecords)v[r.geometryType].push(r),t[r.geometryType]+=r.meshData.vertexCount,k[r.geometryType]+=r.meshData.indexData.length;h=new A;n=[n.fill||{},n.line||{},n.icon||{},n.text||{},n.label||{}];for(p=0;5>p;p++){r=new Uint32Array(k[p]);{var w=n[p];var l=t[p];const x={};for(const y in w){const B={data:D.allocateTypedArrayBuffer(l,w[y]),stride:w[y]};x[y]=B}w=x}m.writeAllMeshDataToBuffers(v[p],w,r);h.geometries[p]={indexBuffer:r,
vertexBuffer:w}}u.tileBufferData=h;return u};g._align=function(h,n){const u=h%n;return 0===u?h:h+(n-u)};g._computeVertexAlignment=function(h){let n=!1,u=!1;for(const t of h)2===t%4?n=!0:0!==t%4&&(u=!0);return u?4:n?2:1};return g}();z.TileData=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function E(){this._byGeometryType=null}var D=E.prototype;D.reset=
function(){this._byGeometryType=null};D.verticesFor=function(C){return this._byGeometryType?this._byGeometryType[C].vertices:0};D.indicesFor=function(C){return this._byGeometryType?this._byGeometryType[C].indices:0};D.needMore=function(C,A,m){if(A||m)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),C=this._byGeometryType[C],C.vertices+=A,C.indices+=m};z._createClass(E,[{key:"satisfied",
get:function(){return!this._byGeometryType}}]);return E}()})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["./Utils"],function(z){return function(){function E(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}var D=E.prototype;D.clone=function(){const C=new E;for(let A=0;A<this.geometries.length;A++){const m=this.geometries[A],
c=C.geometries[A];c.indexBuffer=m.indexBuffer.slice();c.vertexBuffer={};for(const b in m.vertexBuffer){const {data:d,stride:a}=m.vertexBuffer[b];c.vertexBuffer[b]={data:d.slice(),stride:a}}}return C};E.deserialize=function(C){const A=new E;for(let m=0;5>m;++m){A.geometries[m].indexBuffer=new Uint32Array(C.geometries[m].indexBuffer);A.geometries[m].vertexBuffer={};for(const c in C.geometries[m].vertexBuffer)A.geometries[m].vertexBuffer[c]={data:z.allocateTypedArrayBufferwithData(C.geometries[m].vertexBuffer[c].data,
C.geometries[m].vertexBuffer[c].stride),stride:C.geometries[m].vertexBuffer[c].stride}}return A};D.serialize=function(){const C={geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]};for(let A=0;5>A;++A)for(const m in this.geometries[A].vertexBuffer)C.geometries[A].vertexBuffer[m]=
{data:this.geometries[A].vertexBuffer[m].data.buffer,stride:this.geometries[A].vertexBuffer[m].stride};return C};D.getBuffers=function(){const C=[];for(let A=0;5>A;++A){C.push(this.geometries[A].indexBuffer.buffer);for(const m in this.geometries[A].vertexBuffer)C.push(this.geometries[A].vertexBuffer[m].data.buffer)}return C};return E}()})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","./Utils","./MeshData"],function(z,E,D){return function(){function C(m,
c,b,d=0,a=0){this.id=m;this.geometryType=c;this.materialKey=b;this.minZoom=d;this.maxZoom=a;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}var A=C.prototype;A.clone=function(){return this.copy()};A.copy=function(){const m=new C(this.id,this.geometryType,this.materialKey);m.vertexFrom=this.vertexFrom;m.vertexCount=this.vertexCount;m.indexFrom=this.indexFrom;m.indexCount=this.indexCount;m.zOrder=this.zOrder;m.symbolLevel=this.symbolLevel;
m.meshData=this.meshData;m.minZoom=this.minZoom;m.maxZoom=this.maxZoom;return m};A.setMeshDataFromBuffers=function(m,c,b){const d=new D;for(const a in c){const e=c[a].stride,f=c[a].data,g=[],q=E.strideToPackingFactor(e);for(let h=0;h<e*m.vertexCount/q;++h)g[h]=f[h+e*m.vertexFrom/q];d.vertexData.set(a,g)}d.indexData.length=0;for(c=0;c<m.indexCount;++c)d.indexData[c]=b[c+m.indexFrom]-m.vertexFrom;d.vertexCount=m.vertexCount;this.meshData=d};A.readMeshDataFromBuffers=function(m,c){this.meshData?this.meshData.clear():
this.meshData=new D;for(const b in m){const d=m[b].stride,a=m[b].data,e=[],f=E.strideToPackingFactor(d);for(let g=0;g<d*this.vertexCount/f;++g)e[g]=a[g+d*this.vertexFrom/f];this.meshData.vertexData.set(b,e)}this.meshData.indexData.length=0;for(m=0;m<this.indexCount;++m)this.meshData.indexData[m]=c[m+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};A.writeMeshDataToBuffers=function(m,c,b,d){for(const a in c){const e=c[a].stride,f=this.meshData.vertexData.get(a),g=c[a].data,
q=E.strideToPackingFactor(e);for(let h=0;h<e*this.meshData.vertexCount/q;++h)g[h+e*m/q]=f[h]}for(c=0;c<this.meshData.indexData.length;++c)d[c+b]=this.meshData.indexData[c]+m;this.vertexFrom=m;this.vertexCount=this.meshData.vertexCount;this.indexFrom=b;this.indexCount=this.meshData.indexData.length};C.writeAllMeshDataToBuffers=function(m,c,b){let d=0,a=0;for(const e of m)e.writeMeshDataToBuffers(d,c,a,b),d+=e.vertexCount,a+=e.indexCount};A._computeSortKey=function(){this._sortKey=(this.symbolLevel&
31)<<12|(this.zOrder&127)<<4|this.geometryType&7};A.serialize=function(m){m.push(this.geometryType);m.push(this.materialKey);m.push(this.vertexFrom);m.push(this.vertexCount);m.push(this.indexFrom);m.push(this.indexCount);m.push(this.minZoom);m.push(this.maxZoom);return m};C.deserialize=function(m,c){const b=m.readInt32(),d=m.readInt32();c=new C(c.id,b,d);c.vertexFrom=m.readInt32();c.vertexCount=m.readInt32();c.indexFrom=m.readInt32();c.indexCount=m.readInt32();c.minZoom=m.readInt32();c.maxZoom=m.readInt32();
return c};z._createClass(C,[{key:"sortKey",get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey}}]);return C}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(function(){return function(){function z(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}var E=z.prototype;E.clear=function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};E.update=function(D,C,A){for(const m in D)this.vertexData.set(m,D[m]);for(const m in this.vertexData)null===
D[m]&&this.vertexData.delete(m);this.vertexCount=C;this.indexData=A};return z}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./WGLDisplayList","./util/serializationUtils","./WGLDisplayObject"],function(z,E,D,C,A){function m(b){const d=[[],[],[],[],[]];for(const a of b)for(const e of a.displayRecords)d[e.geometryType].push(e);return d}let c=function(){function b(){}var d=b.prototype;d.computeDisplayList=function(a){this._displayList=
new D(a);if(a)for(var e of this.displayObjects)for(var f of e.displayRecords)this._displayList.addToList(f);else for(a=m(this.displayObjects),e=a.length,f=0;f<e;++f)this._displayList.addToList(a[f])};d.clone=function(){const a=new b;this.displayObjects&&(a.displayObjects=this.displayObjects.map(e=>e.clone()));return a};d.serialize=function(a){C.serializeList(a,this.displayObjects);return a};d._deserializeObjects=function(a){var e=a.readInt32();e=Array(e);const f=new Map;for(let g=0;g<e.length;++g){const q=
A.deserialize(a);e[g]=q;f.set(q.id,q)}this.displayObjects=e;this._displayList=null;this._displayObjectRegistry=f};b.deserialize=function(a){const e=new b;e._deserializeObjects(a);return e};E._createClass(b,[{key:"displayObjectRegistry",get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(const a of this.displayObjects)this._displayObjectRegistry.set(a.id,a)}return this._displayObjectRegistry}},{key:"displayList",get:function(){return this._displayList}}]);return b}();
z.default=c;z.groupRecordsByGeometryType=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../../../core/Logger","./enums"],function(z,E,D){function C(a,e,f,...g){e<a.length?a.splice(e,f,...g):a.push(...g)}const A=E.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");E=new Map;E.set(D.WGLDrawPhase.MAP,[D.WGLGeometryType.FILL,D.WGLGeometryType.LINE,D.WGLGeometryType.MARKER,D.WGLGeometryType.TEXT]);
E.set(D.WGLDrawPhase.LABEL,[D.WGLGeometryType.LABEL]);E.set(D.WGLDrawPhase.LABEL_ALPHA,[D.WGLGeometryType.LABEL]);E=function(){function a(f=!1){this.symbolLevels=[];this.unified=f}var e=a.prototype;e.replay=function(f,g,q){if(this.unified)for(const n of this.symbolLevels)for(const u of n.zLevels){var h=u.geometryDPInfo.unified;if(h)for(const t of h){h=f.painter.getGeometryBrush(t.geometryType);const k=g.getGeometry(t.geometryType);h.prepareState(f,g);h.drawGeometry(f,g,t,k,q)}}};e.clear=function(){this.symbolLevels.length=
0};e.addToList=function(f,g){if(Array.isArray(f))for(const q of f)this._addToList(q,g);else this._addToList(f,g)};e.removeFromList=function(f){Array.isArray(f)||(f=[f]);let g=null;for(const q of f)g=this._removeFromList(q);return g};e.byType=function(f,g){for(const q of this.symbolLevels)for(const h of q.zLevels){const n=h.geometryDPInfo,u=this.getDPInfoType(f);if(n[u])for(const t of n[u])g(t)}};e.clone=function(){const f=new a(this.unified);for(const g of this.symbolLevels)f.symbolLevels.push(g.clone());
return f};e.splitAfter=function(f){const g=this._getDisplayList(f.symbolLevel,f.zOrder,f.geometryType),q=g.length,h=f.indexFrom+f.indexCount;for(let n=0;n<q;++n){const u=g[n];if(u.geometryType===f.geometryType&&h>u.indexFrom&&h<=u.indexFrom+u.indexCount)return h<u.indexFrom+u.indexCount&&(f=new m,f.geometryType=u.geometryType,f.materialKey=u.materialKey,f.indexFrom=h,f.indexCount=u.indexFrom+u.indexCount-h,g.splice(n+1,0,f),u.indexCount=h-u.indexFrom),n}};e._addToList=function(f,g){const q=this._getDisplayList(f.symbolLevel,
f.zOrder,f.geometryType);g=null!=g?g:q.length-1;var h=0<=g&&g<q.length?q[g]:null;null===h||h.materialKey!==f.materialKey||h.indexFrom+h.indexCount!==f.indexFrom||this.unified&&h.geometryType!==f.geometryType?(h=new m,h.indexFrom=f.indexFrom,h.indexCount=f.indexCount,h.materialKey=f.materialKey,h.geometryType=f.geometryType,C(q,g+1,0,h)):h.indexCount+=f.indexCount};e._removeFromList=function(f){const g=this._getDisplayList(f.symbolLevel,f.zOrder,f.geometryType);var q=g.length;let h=void 0;for(var n=
0;n<q;++n){var u=g[n];if(f.indexFrom+f.indexCount>u.indexFrom&&f.indexFrom<u.indexFrom+u.indexCount&&(!this.unified||u.geometryType===f.geometryType)){h=n;break}}if(void 0!==h){q=g[h];if(f.indexFrom===q.indexFrom)return q.indexCount-=f.indexCount,q.indexFrom+=f.indexCount,0===q.indexCount&&C(g,h,1),h-1;if(f.indexFrom+f.indexCount===q.indexFrom+q.indexCount)return q.indexCount-=f.indexCount,0===q.indexCount?(C(g,h,1),h-1):h;{n=q.indexFrom;u=f.indexFrom-q.indexFrom;const t=f.indexCount;f=q.indexFrom+
q.indexCount-(f.indexFrom+f.indexCount);q.indexCount=u;const k=new m;k.geometryType=q.geometryType;k.materialKey=q.materialKey;k.indexFrom=n+u+t;k.indexCount=f;C(g,h+1,0,k);return h}}return null};e._getDisplayList=function(f,g,q){let h;var n=this.symbolLevels.length;for(let k=0;k<n;k++)if(this.symbolLevels[k].symbolLevel===f){h=this.symbolLevels[k];break}h||(h=new d,h.symbolLevel=f,this.symbolLevels.push(h));let u;f=h.zLevels.length;for(n=0;n<f;n++)if(h.zLevels[n].zLevel===g){u=h.zLevels[n];break}u||
(u=new b,u.geometryDPInfo=new c,u.zLevel=g,h.zLevels.push(u));let t;if(this.unified)u.geometryDPInfo.unified||(u.geometryDPInfo.unified=[]),t=u.geometryDPInfo.unified;else switch(q){case D.WGLGeometryType.FILL:u.geometryDPInfo.fill||(u.geometryDPInfo.fill=[]);t=u.geometryDPInfo.fill;break;case D.WGLGeometryType.LINE:u.geometryDPInfo.line||(u.geometryDPInfo.line=[]);t=u.geometryDPInfo.line;break;case D.WGLGeometryType.MARKER:u.geometryDPInfo.marker||(u.geometryDPInfo.marker=[]);t=u.geometryDPInfo.marker;
break;case D.WGLGeometryType.TEXT:u.geometryDPInfo.text||(u.geometryDPInfo.text=[]);t=u.geometryDPInfo.text;break;case D.WGLGeometryType.LABEL:u.geometryDPInfo.label||(u.geometryDPInfo.label=[]);t=u.geometryDPInfo.label;break;default:console.error("Trying to add a record with geometry type '"+q+"'.")}return t};e.getDPInfoType=function(f){if(this.unified)return"unified";switch(f){case D.WGLGeometryType.FILL:return"fill";case D.WGLGeometryType.LINE:return"line";case D.WGLGeometryType.MARKER:return"marker";
case D.WGLGeometryType.TEXT:return"text";case D.WGLGeometryType.LABEL:return"label";default:A.error(`DisplayList: Tried to convert unknown geometryType: ${f}`)}};z._createClass(a,[{key:"empty",get:function(){return!this.symbolLevels||0===this.symbolLevels.length}}]);return a}();let m=function(){function a(){this.materialKey=null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){const e=new a;e.geometryType=this.geometryType;e.materialKey=this.materialKey;e.indexFrom=this.indexFrom;e.indexCount=
this.indexCount;return e};return a}(),c=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){const e=new a;e.fill=this.fill&&this.fill.map(f=>f.clone());e.line=this.line&&this.line.map(f=>f.clone());e.marker=this.marker&&this.marker.map(f=>f.clone());e.text=this.text&&this.text.map(f=>f.clone());e.label=this.label&&this.label.map(f=>f.clone());e.unified=this.unified&&this.unified.map(f=>f.clone());return e};return a}(),b=function(){function a(){this.geometryDPInfo=
new c}a.prototype.clone=function(){const e=new a;e.zLevel=this.zLevel;e.geometryDPInfo=this.geometryDPInfo.clone();return e};return a}(),d=function(){function a(){this.zLevels=[]}a.prototype.clone=function(){const e=new a;e.symbolLevel=this.symbolLevel;for(const f of this.zLevels)e.zLevels.push(f.clone());return e};return a}();return E})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["exports"],function(z){z.deserializeList=function(E,D,C){var A=E.readInt32();A=Array(A);
for(let m=0;m<A.length;m++)A[m]=D.deserialize(E,C);return A};z.serializeList=function(E,D){if(null===D)E.push(0);else{E.push(D.length);for(const C of D)C.serialize(E);return E}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["./WGLDisplayRecord","./util/serializationUtils","./collisions/Metric"],function(z,E,D){return function(){function C(m){this.insertAfter=null;this.id=m;this.displayRecords=[];this.metrics=[]}var A=C.prototype;
A.copy=function(){const m=new C(this.id);m.set(this);return m};A.clone=function(){const m=new C(this.id);m.displayRecords=this.displayRecords.map(c=>c.clone());m.metrics=this.metrics.map(c=>c.clone());m.insertAfter=this.insertAfter;return m};A.set=function(m){this.id=m.id;this.displayRecords=m.displayRecords;this.metrics=m.metrics;this.insertAfter=m.insertAfter};A.serialize=function(m){m.push(this.id);E.serializeList(m,this.metrics);E.serializeList(m,this.displayRecords);return m};C.deserialize=function(m){var c=
m.readInt32();const b=new C(c);c={id:c};const d=E.deserializeList(m,D);d.length&&(b.metrics=d);b.displayRecords=E.deserializeList(m,z,c);return b};return C}()})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define(["../../../../../core/Logger","../definitions","../../../../../chunks/vec2f32","./BoundingBox","../util/serializationUtils"],function(z,E,D,C,A){const m=z.getLogger("esri/views/2d/engine/webgl/collisions/Metric");return function(){function c(d,a,e,f,g){this.id=d;this.range=
a;this.boxes=null;this.minZoom=-1;this.placementPadding=this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=D.fromValues(e,f);this.baseZoom=g}var b=c.prototype;b.add=function(d,a,e){d.x+=a;d.y+=e;this.bounds?(this.boxes?this.boxes.push(d):(this.boxes=[this.bounds,d],this.bounds=this.bounds.clone()),this.bounds.extend(d)):this.bounds=d};b.computeIndex=function(){var d=Math.floor(this.anchor[1]/E.COLLISION_BUCKET_SIZE);this.xBucket=Math.floor(this.anchor[0]/E.COLLISION_BUCKET_SIZE);
this.yBucket=d;d=E.TILE_SIZE/E.COLLISION_BUCKET_SIZE;this.hasVV?this.yOverflow=this.xOverflow=d:(this.xOverflow=Math.min(d,Math.ceil(2*this.bounds.width/E.COLLISION_BUCKET_SIZE)),this.yOverflow=Math.min(d,Math.ceil(2*this.bounds.height/E.COLLISION_BUCKET_SIZE)))};b.findCollisionDelta=function(d){const a=this.bounds.findCollisionDelta(d.bounds),e=this.boxes&&this.boxes.length,f=d.boxes&&d.boxes.length;return Math.abs(a)>E.COLLISION_MAX_ZOOM_DELTA||!e&&!f?a:e&&f?this._boxesToBoxes(d):e?this._boxesToBox(d):
this._boxToBoxes(d)};b.computeVVOffset=function(d,a){a||m.error("mapview-labeling",`Unable to compute label offset. Expected an evaluator function but found ${a}`);let e=this.size;this.hasVV&&(d=a(d),e=isNaN(d)||null==d||Infinity===d?this.size:d);this._computeOffset(e)};b.setPlacementOffset=function(d,a,e,f,g){this.hasVV=d;this.size=a;this.placementPadding=Math.round(e);this.directionX=f;this.directionY=g};b.clone=function(){const d=new c(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);
d.minZoom=this.minZoom;this.bounds&&(d.bounds=this.bounds.clone());this.boxes&&(d.boxes=this.boxes.map(a=>a.clone()));d.xBucket=this.xBucket;d.yBucket=this.yBucket;d.xOverflow=this.xOverflow;d.yOverflow=this.yOverflow;d.hasVV=this.hasVV;d.size=this.size;d.directionX=this.directionX;d.directionY=this.directionY;d.offsetX=this.offsetX;d.offsetY=this.offsetY;return d};b._boxToBoxes=function(d){let a=-Infinity;for(const e of d.boxes)d=this.bounds.findCollisionDelta(e),a=Math.max(d,a);return a};b._boxesToBox=
function(d){let a=this.boxes[0].findCollisionDelta(d.bounds);for(let e=1;e<this.boxes.length;e++){const f=this.boxes[e].findCollisionDelta(d.bounds);a=Math.max(f,a)}return a};b._boxesToBoxes=function(d){let a=-Infinity;for(let e=0;e<this.boxes.length;e++){const f=this.boxes[e];for(const g of d.boxes){const q=f.findCollisionDelta(g);a=Math.max(q,a)}}return a};b._computeOffset=function(d){this.offsetX=this.directionX*(d/2+this.placementPadding);this.offsetY=this.directionY*(d/2+this.placementPadding)};
b.serialize=function(d){d.push(this.id);this.bounds.serialize(d);d.push(this.range.from);d.push(this.range.count);d.push(this.anchor[0]);d.push(this.anchor[1]);d.push(this.baseZoom);d.push(this.hasVV?1:0);d.push(this.size);d.writeF32(this.directionX);d.writeF32(this.directionY);d.push(this.offsetX);d.push(this.offsetY);d.push(this.placementPadding);A.serializeList(d,this.boxes);return d};c.deserialize=function(d){var a=d.readInt32();const e=C.deserialize(d);var f=d.readInt32(),g=d.readInt32();const q=
{from:f,count:g},h=d.readInt32(),n=d.readInt32(),u=d.readInt32();f=d.readInt32();g=d.readInt32();const t=d.readF32(),k=d.readF32(),v=d.readInt32(),p=d.readInt32(),r=d.readInt32();d=A.deserializeList(d,C);a=new c(a,q,h,n,u);a.bounds=e;a.boxes=d;a.setPlacementOffset(!!f,g,r,t,k);a.offsetX=v;a.offsetY=p;a.computeIndex();f||a._computeOffset(g);return a};return c}()})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers","../../../../../core/mathUtils",
"../../../../../chunks/vec2f32"],function(z,E,D){return function(){function C(m,c,b,d){this.center=D.fromValues(m,c);this.centerT=D.create();this.halfWidth=b/2;this.halfHeight=d/2;this.width=b;this.height=d}var A=C.prototype;A.clone=function(){return new C(this.x,this.y,this.width,this.height)};A.serialize=function(m){m.writeF32(this.center[0]);m.writeF32(this.center[1]);m.push(this.width);m.push(this.height);return m};A.findCollisionDelta=function(m,c=4){return E.log2(Math.min((m.halfWidth+this.halfWidth+
c)/Math.abs(m.centerT[0]-this.centerT[0]),(m.halfHeight+this.halfHeight+c)/Math.abs(m.centerT[1]-this.centerT[1])))};A.extend=function(m){const c=Math.min(this.xmin,m.xmin),b=Math.min(this.ymin,m.ymin),d=Math.max(this.xmax,m.xmax)-c;m=Math.max(this.ymax,m.ymax)-b;this.width=d;this.height=m;this.halfWidth=d/2;this.halfHeight=m/2;this.x=c+d/2;this.y=b+m/2};C.deserialize=function(m){const c=m.readF32(),b=m.readF32(),d=m.readInt32();m=m.readInt32();return new C(c,b,d,m)};z._createClass(C,[{key:"x",get:function(){return this.center[0]},
set:function(m){this.center[0]=m}},{key:"y",get:function(){return this.center[1]},set:function(m){this.center[1]=m}},{key:"blX",get:function(){return this.center[0]+this.halfWidth}},{key:"blY",get:function(){return this.center[1]+this.halfHeight}},{key:"trX",get:function(){return this.center[0]-this.halfWidth}},{key:"trY",get:function(){return this.center[1]-this.halfHeight}},{key:"xmin",get:function(){return this.x-this.halfWidth}},{key:"xmax",get:function(){return this.x+this.halfWidth}},{key:"ymin",
get:function(){return this.y-this.halfHeight}},{key:"ymax",get:function(){return this.y+this.halfHeight}}]);return C}()})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["../../../../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function E(C,A){this._pos=0;A=A?this._roundToNearest(A,C.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(A);this._buffer=new C(this._array);this._ctor=C}var D=E.prototype;D._roundToNearest=function(C,A){C=Math.round(C);return C+(A-C%A)};
D._ensureSize=function(C){if(this._pos+C>=this._buffer.length){C=this._roundToNearest(1.5*(this._array.byteLength+C*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);C=new ArrayBuffer(C);const A=new this._ctor(C);A.set(this._buffer,0);this._array=C;this._buffer=A}};D.writeF32=function(C){this._ensureSize(1);const A=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=C;this._pos++;return A};D.push=function(C){this._ensureSize(1);const A=this._pos;this._buffer[this._pos++]=C;return A};
D.writeFixed=function(C){this._buffer[this._pos++]=C};D.setValue=function(C,A){this._buffer[C]=A};D.getValue=function(C){return this._buffer[C]};D.incr=function(C){this._buffer[C]++};D.decr=function(C){this._buffer[C]--};D.writeRegion=function(C){this._ensureSize(C.length);const A=this._pos;this._buffer.set(C,this._pos);this._pos+=C.length;return A};D.buffer=function(){const C=this._array.slice(0,4*this._pos);this.destroy();return C};D.toArray=function(){const C=this._array,A=[];for(let m=0;m<C.byteLength/
4;m++)A.push(C[m]);return A};D.seek=function(C){this._pos=C};D.destroy=function(){this._buffer=this._array=null};z._createClass(E,[{key:"length",get:function(){return this._pos}}]);return E}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../WGLDisplayRecord ../util/serializationUtils ../collisions/Metric ../WGLDisplayObject ../util/Reader ../util/Writer".split(" "),function(z,E,D,C,A,m,c,b){let d=function(){function a(f,g){this.vertexVectorsMap=
f;this._currentIndex=-1;this._currentMetricOffset=this._currentRecordOffset=0;this._currentMetrics=[];f=4*(8*g.records+1);const q=4*(20*g.metrics+1);this._bufDisplayObjects=new b(Uint32Array,4*(4*g.features+1)+4);this._bufDisplayRecords=new b(Uint32Array,f+4);this._bufMetrics=new b(Uint32Array,q+4);this._bufDisplayObjects.push(0);this._bufDisplayRecords.push(0);this._bufMetrics.push(0)}var e=a.prototype;e.get=function(f){return this.vertexVectorsMap[f]};e.currentDisplayRecordCount=function(){return this._bufDisplayRecords[this._currentRecordOffset]};
e.writeDisplayObject=function(f,g){this._bufDisplayObjects.incr(0);this._currentIndex=this._bufDisplayObjects.push(f);this._bufDisplayObjects.push(g);this._bufDisplayObjects.push(0);this._bufDisplayObjects.push(0);this._currentMetricOffset=this._currentRecordOffset=0;this._currentMetrics=[]};e.hasDisplayRecords=function(){return 0!==this._currentRecordOffset};e.endDisplayObject=function(){this.hasDisplayRecords()?this._currentMetrics&&(0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+
3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length),C.serializeList(this._bufMetrics,this._currentMetrics)):this._rollbackDisplayObject()};e.writeDisplayRecord=function(f,g,q,h,n,u,t=0,k=0){0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset));this._bufDisplayRecords.incr(this._currentRecordOffset);this._bufDisplayRecords.push(f);this._bufDisplayRecords.push(g);
this._bufDisplayRecords.push(q);this._bufDisplayRecords.push(h);this._bufDisplayRecords.push(n);this._bufDisplayRecords.push(u);this._bufDisplayRecords.push(t);this._bufDisplayRecords.push(k)};e.writeMetrics=function(f){f&&this._currentMetrics.push(...f)};a.deserializeDisplayObjects=function(f){const {bufDisplayObjects:g,bufMetrics:q,bufRecords:h}=f;f=new c(g);const n=new c(h),u=new c(q),t=[];let k=f.readInt32();n.readInt32();for(u.readInt32();k--;){const v=f.readInt32(),p=f.readInt32(),r=f.readInt32(),
w=f.readInt32(),l=new m(v);0!==p&&(l.insertAfter=p);0!==r&&(l.displayRecords=C.deserializeList(n,D,{id:v}));0!==w&&(l.metrics=C.deserializeList(u,A));t.push(l)}return t};e.encode=function(f,g){const q={};for(let h=0;h<this.vertexVectorsMap.length;h++){const n=this.vertexVectorsMap[h];q[h]={};n.transfer(q[h],g)}f.bufDisplayObjects=this._bufDisplayObjects.buffer();f.bufRecords=this._bufDisplayRecords.buffer();f.bufMetrics=this._bufMetrics.buffer();g.push(f.bufDisplayObjects);g.push(f.bufMetrics);g.push(f.bufRecords);
f.vertexBuffersMap=q;this.destroy()};e.destroy=function(){this._bufMetrics=this._bufDisplayRecords=this._bufDisplayObjects=this.vertexVectorsMap=null};e._rollbackDisplayObject=function(){this._bufDisplayObjects.decr(0);this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4);this._currentIndex=this._bufDisplayObjects.length};E._createClass(a,[{key:"vertexBuffersMap",get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(let f=0;f<this.vertexVectorsMap.length;f++)this._vertexBuffersMap[f]=
this.vertexVectorsMap[f].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap}}]);return a}();z.MeshData=d;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Reader":function(){define(function(){return function(){function z(D){this._pos=0;this._buffer=D;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}var E=z.prototype;E.readInt32=function(){return this._i32View[this._pos++]};E.readF32=function(){return this._f32View[this._pos++]};
return z}()})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["exports","../Utils"],function(z,E){let D=function(){function A(m,c,b){this.data=m;this.stride=c;this.vertexCount=b}A.decode=function(m){const c=E.allocateTypedArrayBufferwithData(m.data,m.stride);return new A(c,m.stride,m.vertexCount)};A.fromVertexVector=function(m){const c=E.allocateTypedArrayBufferwithData(m.data.buffer(),m.stride);return new A(c,m.stride,m.vertexCount)};return A}(),C=function(){function A(m,c,b){this.geometryType=
m;this.indexBuffer=new Uint32Array(c);this.namedBuffers=b}A.decode=function(m){const c=m.geometryType,b=m.indexBuffer,d={};for(const a in m.namedBuffers)d[a]=D.decode(m.namedBuffers[a]);return new A(c,b,d)};A.fromVertexVectors=function(m){const c=m.geometryType,b=m.indexVector.buffer(),d={};for(const a in m.namedVectors)d[a]=D.fromVertexVector(m.namedVectors[a]);return new A(c,b,d)};return A}();z.VertexBuffers=C;z.default=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLTile":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/CircularArray ../../../../chunks/vec2 ./definitions ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/vec2f32 ./TiledDisplayObject ./enums ./DirtyMap ./DisplayRecordStore ./Fader ./WGLBuffers".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){const u=new Set;D=function(t){function k(p,r,w=!1){p=t.call(this,p,r,[c.TILE_SIZE,c.TILE_SIZE])||this;p._data=null;p._displayList=null;p._wglBuffers=null;p._deferPatches=!1;p._dirtyMap=new g;p._labelIndex=null;p._lastCommitTime=0;p._patchQueue=new A(100);p.fader=new h;p._dirty=!0;p._replaceBuffers=!1;p._uploadsLocked=!1;p._hasData=!1;p._invalidated=!1;p.transforms.labelMat2d=d.create();p._ensureCorrectZOrder=w;p._deferPatches=!w;return p}E._inheritsLoose(k,
t);var v=k.prototype;v.destroy=function(){t.prototype.destroy.call(this);this.clear()};v.getGeometry=function(p){return this._wglBuffers&&this._wglBuffers.has(p)?this._wglBuffers.get(p):null};v.getDisplayList=function(){return this._displayList};v.setTransform=function(p,r){t.prototype.setTransform.call(this,p,r);const w=this.transforms.labelMat2d;r=p.getScreenTransform(w,r);const l=a.create();m.transformMat2d(l,this.coords,r);b.identity(w);b.translate(w,w,l);b.multiply(w,p.viewMat2d,w)};v.setData=
function(p){const r=p.addOrUpdate,w=p.remove;p.clear&&(this.clear(),this._patchQueue.clear(),this._hasData=!1);"replace"===p.type&&(this._replaceBuffers=!0,this._patchQueue.clear(),this._data=null);!this._data&&r&&r.tileDisplayData.displayObjects.length?(r.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new g,this._dispRecStore=q.fromTileData(r,this._dirtyMap),this._data=r,this._dirtyMap.markAllDirty(),this._hasData=!0,p.end&&this.ready()):this._data?r&&r.tileDisplayData.displayObjects.length||
w.length?this._deferPatches?this._patchQueue.enqueue(p):this._doPatchData(p):p.end&&this.ready():p.end&&this.ready();p.end&&!this._data&&this.clear();this.requestRender();this.emit("change")};v.lockUploads=function(){this._uploadsLocked=!0};v.unlockUploads=function(){this._uploadsLocked=!1;this.requestRender()};v.commitChanges=function(p){if(!p.time||p.time!==this._lastCommitTime){this._lastCommitTime=p.time;this.fader.step()||this.requestRender();if(this._patchQueue.size){var r=this._patchQueue.dequeue();
C.isSome(r)&&(r.end&&this.ready(),this._doPatchData(r),this.requestRender(),this._hasData=!0)}if(this._uploadsLocked)this.requestRender();else if(this.visible&&this._data){if(this._replaceBuffers)for(this._wglBuffers&&this._wglBuffers.dispose(),this._wglBuffers=null,this._replaceBuffers=!1;this._patchQueue.size;)r=this._patchQueue.dequeue(),C.isSome(r)&&(r.end&&this.ready(),this._doPatchData(r),this._hasData=!0);this._wglBuffers||(this._wglBuffers=new n(p.context));if(this._dirtyMap.hasDirty()||this._invalidated)this._invalidated=
!1,this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap),this._displayList=this._data.tileDisplayData.displayList.clone(),this._displayObjects=this._data.tileDisplayData.displayObjects.slice(),this._rebuildLabelIndex(),this._dirtyMap.markAllClean()}}};v.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};v._doPatchData=function(p){try{if("new"===p.type){if(!p.addOrUpdate)return;this._invalidated=!0;
const r=this._bulkAddFeatures(p);r&&(this._dirtyMap.markAllDirty(),this._data.reshuffleBulkAdd(p,r.objectIndex,r.recordIndex),this._dispRecStore=q.fromTileData(this._data,this._dirtyMap))}else this._invalidated=!0,this._patchData(p)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=q.fromTileData(this._data,this._dirtyMap))}catch(r){}this.requestRender()};v._rebuildLabelIndex=function(){var p,r;if(null!=(p=this._data)&&null!=(r=p.tileBufferData.geometries[f.WGLGeometryType.LABEL])&&
r.indexBuffer.length){this.isDirty=!0;this._labelIndex=this._initLabelIndex();for(const w of this.displayObjects)for(const l of w.metrics)this._insertIntoLabelIndex(l)}};v._insertIntoLabelIndex=function(p){0>p.xBucket||0>p.yBucket||3<p.yBucket||3<p.xBucket||this.labelIndex[p.yBucket][p.xBucket].push(p)};v._initLabelIndex=function(){const p=[];for(let r=0;r<c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;r++){p.push([]);for(let w=0;w<c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;w++)p[r].push([])}return p};v._bulkAddFeatures=
function(p){const r=p.addOrUpdate.tileDisplayData.displayObjects,w=this._data.tileDisplayData.displayObjects,l=this._data.tileDisplayData.displayObjectRegistry;for(let x=0;x<r.length;x++){const y=r[x],B=l.get(y.id);for(let F=0;F<y.displayRecords.length;++F){const G=y.displayRecords[F];if(B){if(G.geometryType!==f.WGLGeometryType.FILL&&G.geometryType!==f.WGLGeometryType.LINE)continue;B.displayRecords.push(G)}if(!this._dispRecStore.tryAddMeshData(G,p.addOrUpdate.tileBufferData.geometries[G.geometryType]))return{objectIndex:x,
recordIndex:F}}B||(l.set(y.id,y),w.push(y))}return null};v._patchData=function(p){let r=!0;var w=p.addOrUpdate&&p.addOrUpdate.tileDisplayData&&p.addOrUpdate.tileDisplayData.displayObjects||[],l=(p.remove||[]).slice();for(var x of w)null!=x.insertAfter&&l.push(x.id);for(var y of l)if(l=this._data.tileDisplayData.displayObjectRegistry.get(y)){this._data.tileDisplayData.displayList.removeFromList(l.displayRecords);for(var B of l.displayRecords)this._dispRecStore.delete(B);this._data.tileDisplayData.displayObjectRegistry.delete(y);
l=this._data.tileDisplayData.displayObjects.indexOf(l);this._data.tileDisplayData.displayObjects.splice(l,1)}for(const K of w){w=this._data.tileDisplayData.displayObjectRegistry.get(K.id);let M;if(w){y=w.displayRecords;w.set(K);w.displayRecords=y;y=w.displayRecords.length;for(B=0;B<y;++B)if(l=w.displayRecords[B],x=K.displayRecords[B],B>=K.displayRecords.length||l.geometryType!==x.geometryType||l.symbolLevel!==x.symbolLevel||l.zOrder!==x.zOrder||l.materialKey!==x.materialKey)this._dispRecStore.delete(w.displayRecords[B]),
B<K.displayRecords.length&&(w.displayRecords[B]=void 0);w.displayRecords.length=K.displayRecords.length;w.metrics=K.metrics}else if(w=K.copy(),w.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(K.id,w),y=this._data.tileDisplayData.displayObjects,null!=w.insertAfter?(M={},0<=w.insertAfter?(B=this._data.tileDisplayData.displayObjectRegistry.get(w.insertAfter))?(x=y.indexOf(B)+1,x<y.length?y.splice(x,0,w):(y.push(w),x=y.length)):(y.push(w),x=y.length):(y.unshift(w),x=0)):(y.push(w),
x=y.length),M){if(this._data.tileDisplayData.displayList.unified)B=0<K.displayRecords.length?1:0;else{u.clear();for(const R of K.displayRecords)B=this._data.tileDisplayData.displayList.getDPInfoType(R.geometryType),u.add(B);B=u.size}l=0;for(--x;0<=x&&l<B;--x)for(var F=y[x].displayRecords.length-1;0<=F&&l<B;--F){var G=y[x].displayRecords[F],J=this._data.tileDisplayData.displayList.getDPInfoType(G.geometryType);M[J]||(M[J]=G,++l)}}y=K.displayRecords.length;for(B=0;B<y;++B){l=K.displayRecords[B];(x=
w.displayRecords[B])?(x.meshData=l.meshData,x.materialKey=l.materialKey):(x=l.copy(),x.vertexFrom=void 0,x.indexFrom=void 0,w.displayRecords[B]=x);G=l.geometryType;F=this._data.tileDisplayData.displayList.getDPInfoType(G);J=p.addOrUpdate.tileBufferData.geometries[G];G=J.vertexBuffer;J=J.indexBuffer;let R=void 0;M&&(R=M[F]?this._data.tileDisplayData.displayList.splitAfter(M[F]):-1);r=this._dispRecStore.setMeshData(x,l,G,J,R)&&r;M&&null!=x.indexFrom&&null!=x.indexFrom&&(M[F]=x)}}return r};E._createClass(k,
[{key:"displayObjects",get:function(){var p;return null!=(p=this._displayObjects)?p:[]}},{key:"isDirty",get:function(){return this._dirty},set:function(p){this._dirty=p;this.requestRender()}},{key:"hasData",get:function(){return!!this._hasData}},{key:"labelIndex",get:function(){return this._labelIndex}}]);return k}(e.TiledDisplayObject);z.WGLTile=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../chunks/mat3 ../../tiling/TileKey ../../../../chunks/mat3f32 ../DisplayObject".split(" "),
function(z,E,D,C,A,m,c){D=function(b){function d(e,f,g,q=g){var h=b.call(this)||this;h.triangleCountReportedInDebug=0;h.transforms={dvs:m.create(),tileMat3:m.create()};h.triangleCount=0;h.key=new A(e);h.bounds=f;h.size=g;h.coordRange=q;return h}E._inheritsLoose(d,b);var a=d.prototype;a.destroy=function(){this.texture&&(this.texture.dispose(),this.texture=null)};a.setTransform=function(e,f){f/=e.resolution*e.pixelRatio;const g=this.transforms.tileMat3,[q,h]=e.toScreenNoRotation([0,0],this.coords);
C.set(g,this.size[0]/this.coordRange[0]*f,0,0,0,this.size[1]/this.coordRange[1]*f,0,q,h,1);C.multiply(this.transforms.dvs,e.displayViewMat3,g)};E._createClass(d,[{key:"coords",get:function(){return this._coords}},{key:"bounds",get:function(){return this._bounds},set:function(e){this._coords=[e[0],e[3]];this._bounds=e}}]);return d}(c.DisplayObject);z.TiledDisplayObject=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["./Utils"],function(z){function E(D,
C,A){if(!D.allDirty)if(null!=D.from&&null!=D.count){const m=Math.min(D.from,C);C=Math.max(D.from+D.count,C+A)-m;D.from=m;D.count=C}else D.from=C,D.count=A}return function(){function D(){this._dirties=z.createGeometryData(()=>({indices:{from:null,count:null,allDirty:!1}}),()=>({vertices:{from:null,count:null,allDirty:!1}}))}var C=D.prototype;C.hasDirty=function(){for(const A of this._dirties)if(null!==A.data.indices.count||A.data.indices.allDirty)return!0;return!1};C.markAllClean=function(){for(const A of this._dirties){A.data.indices.from=
null;A.data.indices.count=null;A.data.indices.allDirty=!1;for(const m in A.buffers)A.buffers[m].data.vertices.from=null,A.buffers[m].data.vertices.count=null,A.buffers[m].data.vertices.allDirty=!1}};C.markAllDirty=function(){for(const A of this._dirties){A.data.indices.allDirty=!0;for(const m in A.buffers)A.buffers[m].data.vertices.allDirty=!0}};C.forEach=function(A){for(let b=0;b<this._dirties.length;++b){var m=this._dirties[b],c={};for(const d in m.buffers){const a=m.buffers[d].data.vertices;if(a.allDirty||
null!=a.from&&null!=a.count&&0<a.count)c[d]=a}m=m.data.indices;c=m.allDirty||null!=m.from&&null!=m.count&&0<m.count?{indices:m,vertices:c}:{indices:null,vertices:c};(c.indices||0<Object.keys(c).length)&&A(c,b)}};C.markDirtyIndices=function(A,m,c){E(this._dirties[A].data.indices,m,c)};C.markDirtyVertices=function(A,m,c,b){E(this._dirties[A].buffers[m].data.vertices,c,b)};return D}()})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["../../../../core/has","./Utils","./FreeList"],
function(z,E,D){const C=["FILL","LINE","MARKER","TEXT","LABEL"];return function(){function A(c,b,d,a){this._strides=c;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=d;for(const e in c){this._freeListsAndStorage[e]={vtxFreeList:a?new D.FreeList(a):null,idxFreeList:a?new D.FreeList(a):null,vertexBuffers:{},indexBuffer:a?new Uint32Array(a):null};for(const f in c[e])this._freeListsAndStorage[e].vertexBuffers[f]={data:a?E.allocateTypedArrayBuffer(a,c[e][f]):null,stride:c[e][f]}}}
A.fromTileData=function(c,b){var d,a=c.getStrides(),e={};for(d=0;d<a.length;d++)e[C[d]]=a[d];d=e;a=[0,0,0,0,0];e=[0,0,0,0,0];var f=c.tileDisplayData.displayObjects;for(var g of f)for(var q of g.displayRecords)a[q.geometryType]=Math.max(a[q.geometryType],q.vertexFrom+q.vertexCount),e[q.geometryType]=Math.max(e[q.geometryType],q.indexFrom+q.indexCount);b=new A(d,c.tileDisplayData.displayList,b,null);for(g=0;g<c.tileBufferData.geometries.length;++g){q=a[g];f=e[g];var h=c.tileBufferData.geometries[g];
d=b._storageFor(C[g]);const n=c.tileBufferData.geometries[g].indexBuffer;d.indexBuffer=n;d.idxFreeList=new D.FreeList(n.length);d.idxFreeList.allocate(f);let u;for(const t in h.vertexBuffer)f=c.tileBufferData.geometries[g].vertexBuffer[t],d.vertexBuffers[t].data=f.data,d.vertexBuffers[t].stride=f.stride,h=E.strideToPackingFactor(f.stride),f=f.data.length*h/f.stride,u||(u=f);d.vtxFreeList=new D.FreeList(u);d.vtxFreeList.allocate(q)}return b};var m=A.prototype;m.delete=function(c){const b=C[c.geometryType];
this._freeVertices(b,c.vertexFrom,c.vertexCount);this._freeIndices(b,c.indexFrom,c.indexCount);this._displayList.removeFromList(c);c.vertexFrom=void 0;c.indexFrom=void 0};m.setMeshData=function(c,b,d,a,e){const f=C[c.geometryType];c.meshData=null;let g=void 0,q=void 0;void 0===c.vertexFrom?(q=b.vertexCount,g=this._allocateVertices(f,q)):b.vertexCount>c.vertexCount?(this._freeVertices(f,c.vertexFrom,c.vertexCount),q=b.vertexCount,g=this._allocateVertices(f,q)):b.vertexCount===c.vertexCount?(g=c.vertexFrom,
q=c.vertexCount):(this._freeVertices(f,c.vertexFrom+b.vertexCount,c.vertexCount-b.vertexCount),g=c.vertexFrom,q=b.vertexCount);let h=!0,n=void 0,u=void 0,t=void 0;void 0===c.indexFrom?(n=e,t=b.indexCount,u=this._allocateIndices(f,t)):b.indexCount>c.indexCount?(n=this._displayList.removeFromList(c),this._freeIndices(f,c.indexFrom,c.indexCount),t=b.indexCount,u=this._allocateIndices(f,t)):b.indexCount===c.indexCount?(h=!1,u=c.indexFrom,t=c.indexCount):(n=this._displayList.removeFromList(c),this._freeIndices(f,
c.indexFrom+b.indexCount,c.indexCount-b.indexCount),u=c.indexFrom,t=b.indexCount);if(-1!==g&&-1!==u){e=this._storageFor(f);E.copyMeshData(g,u,e.vertexBuffers,e.indexBuffer,b,d,a);c.vertexFrom=g;c.indexFrom=u;c.vertexCount=b.vertexCount;c.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(c.geometryType,c.indexFrom,c.indexCount);for(const k in d)this._dirtyMap.markDirtyVertices(c.geometryType,k,c.vertexFrom,c.vertexCount)}h&&this._displayList.addToList(c,n);return!0}-1!==g&&
this._freeVertices(f,g,q);-1!==u&&this._freeIndices(f,u,t);c.setMeshDataFromBuffers(b,d,a);c.vertexFrom=void 0;c.vertexCount=0;c.indexFrom=void 0;c.indexCount=0;return!1};m.tryAddMeshData=function(c,b){const d=b.vertexBuffer;b=b.indexBuffer;var a=C[c.geometryType];const e=this._allocateVertices(a,c.vertexCount);if(-1===e)return this._freeVertices(a,e,c.vertexCount),!1;const f=this._allocateIndices(a,c.indexCount);if(-1===f)return this._freeVertices(a,e,c.vertexCount),this._freeIndices(a,f,c.indexCount),
!1;a=this._storageFor(a);E.copyMeshData(e,f,a.vertexBuffers,a.indexBuffer,c,d,b);c.vertexFrom=e;c.indexFrom=f;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(c.geometryType,c.indexFrom,c.indexCount);for(const g in d)this._dirtyMap.markDirtyVertices(c.geometryType,g,e,c.vertexCount)}this._displayList.addToList(c);return!0};m._allocateVertices=function(c,b){c=this._storageFor(c);b=c.vtxFreeList.allocate(b);return-1===b||.5<c.vtxFreeList.fragmentation?-1:b};m._freeVertices=function(c,b,d){this._storageFor(c).vtxFreeList.free(b,
d)};m._freeIndices=function(c,b,d){this._storageFor(c).idxFreeList.free(b,d)};m._allocateIndices=function(c,b){c=this._storageFor(c);b=c.idxFreeList.allocate(b);return-1===b||.5<c.idxFreeList.fragmentation?-1:b};m._storageFor=function(c){return this._freeListsAndStorage[c]};m._stridesFor=function(c,b){return this._strides[c][b]};return A}()})},"esri/views/2d/engine/webgl/FreeList":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers"],function(z,E){let D=function(){function A(c){this._largestRange=
null;this._parent=c;this._updateLargestRange()}var m=A.prototype;m.rangeCreated=function(c){if(!this._largestRange||c.count>this._largestRange.count)this._largestRange=c};m.rangeResized=function(c,b){if(c===this._largestRange)c.count<b&&this._updateLargestRange();else if(!this._largestRange||c.count>this._largestRange.count)this._largestRange=c};m.findBestRange=function(c){let b=this._parent._freeHead,d=null;for(;null!==b;)b.count>=c&&(!d||b.count-c<d.count-c)&&(d=b),b=b.next;return d};m.findAdjacentRanges=
function(c,b){let d=!0,a=!1,e=null,f=this._parent._freeHead;for(;d&&!a;){const g=null!==f?f.from:this._parent._size;c>=(null!==e?e.from+e.count:0)&&c+b<=g?(d=!1,a=!0):null!==f?(e=f,f=f.next):d=!1}return[e,f]};m._updateLargestRange=function(){let c=null,b=this._parent._freeHead;for(;null!==b;){if(!c||b.count>c.count)c=b;b=b.next}this._largestRange=c};E._createClass(A,[{key:"largestRange",get:function(){return this._largestRange}}]);return A}(),C=function(){function A(c,b){this._allocated=0;this._size=
c;this._freeHead=0<c?{from:0,count:c,prev:null,next:null}:null;this._bookKeeper=b||new D(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}var m=A.prototype;m.allocate=function(c){const b=this._bookKeeper.findBestRange(c);if(null===b)return-1;const d=b.from,a=b.count;b.from+=c;b.count-=c;this._bookKeeper.rangeResized(b,d,a);this._allocated+=c;0===b.count&&(c=null!==b.prev?this._freeHead:b.next,A._removeRange(b),this._freeHead=c);return d};m.free=function(c,b){const [d,a]=this._bookKeeper.findAdjacentRanges(c,
b);c={from:c,count:b,prev:d,next:a};null!==d&&(d.next=c);null!==a&&(a.prev=c);this._bookKeeper.rangeCreated(c);this._allocated-=b;if(null!==a&&c.from+c.count===a.from){b=c.from;var e=c.count;A._fuse(c,a);A._removeRange(a);this._bookKeeper.rangeResized(c,b,e);this._bookKeeper.rangeResized(a,void 0,0)}null!==d&&d.from+d.count===c.from&&(b=d.from,e=d.count,A._fuse(d,c),A._removeRange(c),this._bookKeeper.rangeResized(d,b,e),this._bookKeeper.rangeResized(c,void 0,0));this._freeHead=null!==c.prev?this._freeHead:
c};A._removeRange=function(c){null!==c.prev?null!==c.next?(c.prev.next=c.next,c.next.prev=c.prev):c.prev.next=null:null!==c.next&&(c.next.prev=null)};A._fuse=function(c,b){c.count+=b.count;c.next=b.next;b.from+=b.count;b.count=0;null!==b.next&&(b.next.prev=c)};E._createClass(A,[{key:"fragmentation",get:function(){const c=this._size-this._allocated;return 0===c?0:1-this._bookKeeper.largestRange.count/c}}]);return A}();z.FreeList=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Fader":function(){define(["../../../../chunks/_rollupPluginBabelHelpers"],
function(z){return function(){function E(C=400){this.duration=C;this._value=this._elapsed=this._lastTime=0;this._finished=!1}var D=E.prototype;D.reset=function(){this._value=this._elapsed=this._lastTime=0};D.step=function(){const C=performance.now();if(0===this._lastTime)return this._lastTime=C,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=C-this._lastTime;this._lastTime=C;this._value=Math.min(this._elapsed/this.duration,1);return!1};z._createClass(E,[{key:"value",get:function(){return this._value}}]);
return E}()})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define("../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Utils".split(" "),function(z,E,D,C,A,m,c,b,d,a){return function(){function e(g){this.geometryMap=a.createGeometryData(()=>({indexBuffer:E.createIndex(g,35044),vao:null}),
(q,h)=>({vertexBuffer:E.createVertex(g,a.C_VBO_INFO[h])}))}var f=e.prototype;f.dispose=function(){for(let g=0;5>g;g++){const q=this.geometryMap[g];if(q){q.data.vao&&q.data.vao.dispose(!1);q.data.indexBuffer&&q.data.indexBuffer.dispose();for(const h in q.buffers)q.buffers[h]&&q.buffers[h].data.vertexBuffer.dispose()}}};f.get=function(g){const q=this.geometryMap[g];g={};for(const h in q.buffers)g[h]=q.buffers[h].data.vertexBuffer;return{indexBuffer:q.data.indexBuffer,get vao(){return q.data.vao},set vao(h){q.data.vao=
h},vertexBufferMap:g}};f.has=function(g){return null!=this.geometryMap[g]};f.upload=function(g,q){q.forEach((h,n)=>{this._upload(h,n,g)})};f._upload=function(g,q,h){g.indices&&(g.indices.allDirty?this._uploadIndices(h,q):null!=g.indices.from&&null!=g.indices.count&&this._uploadIndices(h,q,g.indices.from,g.indices.count));if(g.vertices){g=g.vertices;for(const n in g){const u=g[n];u.allDirty?this._uploadVertices(h,q,n):null!=u.from&&null!=u.count&&this._uploadVertices(h,q,n,u.from,u.count)}}};f._uploadVertices=
function(g,q,h,n,u){const t=this.geometryMap[q];t&&(q=g.geometries[q].vertexBuffer[h])&&(g=q.stride,q=q.data.buffer,t.buffers[h]&&0<q.byteLength&&(null!=n&&null!=u?t.buffers[h].data.vertexBuffer.setSubData(q,n*g,n*g,(n+u)*g):t.buffers[h].data.vertexBuffer.setData(q)))};f._uploadIndices=function(g,q,h,n){const u=this.geometryMap[q];u&&(g=g.geometries[q].indexBuffer.buffer,u.data.indexBuffer&&0<g.byteLength&&(null!=h&&null!=n?u.data.indexBuffer.setSubData(g,4*h,4*h,4*(h+n)):u.data.indexBuffer.setData(g)))};
return e}()})},"esri/views/2d/layers/features/schemaUtils":function(){define("exports ../../../../core/has ../../../../core/lang ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/screenUtils ../../../../chunks/symbols ../support/clusterUtils ../../engine/webgl/enums ../../engine/webgl/materialKey/MaterialKey ../../engine/webgl/Utils ../../engine/webgl/util/vvFlagUtils ./support/rendererUtils ../support/util".split(" "),function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h){function n(S){switch(S.type){case "line-marker":var U;
return{type:"line-marker",color:null==(U=S.color)?void 0:U.toJSON(),placement:S.placement,style:S.style};default:return b.fromJSON(S.toJSON()).toJSON()}}function u(S,U,X){if(!S)return null;let ba=0,Z=!1;C.isSome(U)&&"visualVariables"in U&&(ba=g.getVVFlags(U.visualVariables||[]),Z="dot-density"===U.type);switch(S.type){case "simple-fill":case "picture-fill":return t(S,ba,Z,X);case "simple-marker":case "picture-marker":return U=e.createMaterialKey(a.WGLGeometryType.MARKER,ba,!1,!1),X=X?e.hydrateMaterialKey(U):
U,U=n(S),S={materialKey:X,hash:S.hash(),...U,angle:S.angle};case "simple-line":return k(S,ba,X);case "text":return U=e.createMaterialKey(a.WGLGeometryType.TEXT,ba,!1,!1),X=X?e.hydrateMaterialKey(U):U,U=n(S),S={materialKey:X,hash:S.hash(),...U,angle:S.angle};case "label":return U=e.createMaterialKey(a.WGLGeometryType.LABEL,ba,!1,!1,S.labelPlacement),S={materialKey:X?e.hydrateMaterialKey(U):U,hash:S.hash(),...S.toJSON(),labelPlacement:S.labelPlacement};case "cim":return{type:"cim",rendererKey:ba,data:S.data};
case "web-style":return{...n(S),type:"web-style",hash:S.hash(),rendererKey:ba};default:throw Error(`symbol not supported ${S.type}`);}}function t(S,U,X,ba){X=e.createMaterialKey(a.WGLGeometryType.FILL,U,!1,X);var Z=ba?e.hydrateMaterialKey(X):X;const P=S.clone();X=P.outline;P.outline=null;S=[];Z={materialKey:Z,hash:P.hash(),...n(P)};S.push(Z);X&&(U=e.createMaterialKey(a.WGLGeometryType.LINE,U,!0,!1),ba={materialKey:ba?e.hydrateMaterialKey(U):U,hash:X.hash(),...n(X)},S.push(ba));return{type:"composite-symbol",
layers:S,hash:S.reduce((L,O)=>O.hash+L,"")}}function k(S,U,X){var ba=e.createMaterialKey(a.WGLGeometryType.LINE,U,!1,!1);const Z=X?e.hydrateMaterialKey(ba):ba;S=S.clone();ba=S.marker;S.marker=null;const P=[];P.push({materialKey:Z,hash:S.hash(),...n(S)});if(ba){var L;U=e.createMaterialKey(a.WGLGeometryType.MARKER,U,!1,!1);X=X?e.hydrateMaterialKey(U):U;ba.color=null!=(L=ba.color)?L:S.color;P.push({materialKey:X,hash:ba.hash(),lineWidth:S.width,...n(ba)})}return{type:"composite-symbol",layers:P,hash:P.reduce((O,
T)=>T.hash+O,"")}}function v(S,U){const X=S.labelPlacement;var ba=da[U];if(!S.symbol)return aa.warn("No LabelClass symbol specified."),!0;if(!ba)return aa.error(new m("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${U} is not supported`)),!0;ba.some(Z=>Z===X)||(ba=ba[0],X&&aa.warn(`Found invalid label placement type ${X} for ${U}. Defaulting to ${ba}`),S.labelPlacement=ba);return!1}function p(S,U){S=D.clone(S);return S.some(X=>v(X,U))?[]:S}function r(S,U=
!1){try{var X,ba;const Z=F(S,U),P={};Z.map(L=>{a:{switch(L.target){case "feature":x(P,l(S),L);L=void 0;break a;case "aggregate":var O=S.featureReduction;if("selection"===O.type)throw new m("ValidationError","Mapview does not support `selection` reduction type",O);x(P,l(S),L);P.aggregate||(P.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:c.pt2px(O.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(c.pt2px(O.clusterMaxSize)/64),fields:L.aggregateFields}});
w(P.aggregate,L.attributes.fields);L=void 0;break a}L=void 0}return L});return{source:{definitionExpression:S.definitionExpression,fields:S.fields.map(L=>L.toJSON()),gdbVersion:S.gdbVersion,historicMoment:null==(X=S.historicMoment)?void 0:X.getTime(),outFields:S.availableFields,pixelBuffer:S.pixelBuffer,spatialReference:S.spatialReference.toJSON(),timeExtent:null==(ba=S.timeExtent)?void 0:ba.toJSON()},attributes:{fields:{},indexCount:0},processors:Z,targets:P}}catch(Z){if("ValidationError"===Z.fieldName)return aa.error(Z),
null;throw Z;}}function w(S,U){for(const X in U){const ba=U[X];if(ba.target!==S.name)continue;const Z=S.attributes[X];Z?(Z.context.mesh=Z.context.mesh||ba.context.mesh,Z.context.storage=Z.context.storage||ba.context.storage):S.attributes[X]=ba}return S}function l(S){var U,X,ba,Z,P;return[null!=(U=null==(X=S.filter)?void 0:X.toJSON())?U:null,null!=(ba=null==(Z=S.effect)?void 0:null==(P=Z.filter)?void 0:P.toJSON())?ba:null]}function x(S,U,X){S.feature||(S.feature={name:"feature",input:"source",filters:U,
attributes:{}});w(S.feature,X.attributes.fields);return S}function y(S,U){return U.field?B(S,{...U,type:"field",field:U.field}):U.valueExpression?B(S,{...U,type:"expression",valueExpression:U.valueExpression}):{field:null,fieldIndex:null}}function B(S,U){switch(U.type){case "expression":var X=U.valueExpression;if(!S.fields[X]){var ba=S.indexCount++;S.fields[X]={...U,name:X,fieldIndex:ba}}return{fieldIndex:S.fields[X].fieldIndex};case "label-expression":return X=JSON.stringify(U.label),S.fields[X]||
(ba=S.indexCount++,S.fields[X]={...U,name:X,fieldIndex:ba}),{fieldIndex:S.fields[X].fieldIndex};case "field":X=U.field;if("aggregate"===U.target&&S.fields[X])return{field:X};S.fields[X]={...U,name:X};return{field:X};case "statistic":return S.fields[U.name]={...U},{field:U.name}}}function F(S,U=!1){const X=[];let ba=0;X.push(J(S,ba++,U));return X}function G(S,U,X,ba,Z,P=!1){U=B(U,{type:"label-expression",target:ba,context:{mesh:!0},resultType:"string",label:{labelExpression:X.labelExpression,labelExpressionInfo:X.labelExpressionInfo?
{expression:X.labelExpressionInfo.expression}:null,symbol:!!X.symbol,where:X.where}});({fieldIndex:U}=U);return{...u(X,S,P),fieldIndex:U,target:ba,index:Z}}function J(S,U,X=!1){const ba={indexCount:0,fields:{}};var Z="featureReduction"in S&&S.featureReduction;U=Z?"aggregate":"feature";switch(S.renderer.type){case "heatmap":{const {blurRadius:P,fieldOffset:L,field:O}=S.renderer;return{type:"heatmap",aggregateFields:[],attributes:ba,target:U,storage:null,mesh:{blurRadius:P,fieldOffset:L,field:y(ba,
{target:U,field:O,resultType:"numeric"}).field}}}default:{const P=[],L="aggregate"===U?d.createClusterRenderer(P,S.renderer,Z,null):S.renderer;K(ba,P);const O=I(ba,U,L,X),T=M(ba,U,L),ea=h.toJSONGeometryType(S.geometryType);S=S.labelsVisible&&S.labelingInfo||[];let fa=[];if(Z){if("selection"===Z.type)throw new m("ValidationError","Mapview does not support `selection` reduction type",Z);fa=Z&&Z.labelsVisible&&Z.labelingInfo||[]}S=p(S,ea);fa=p(fa,ea);let ha=0;Z=[...S.map(ia=>G(L,ba,ia,"feature",ha++,
X)),...fa.map(ia=>G(L,ba,ia,"aggregate",ha++,X))];return{type:"symbol",target:U,attributes:ba,aggregateFields:P,storage:T,mesh:{matcher:O,labels:Z}}}}}function K(S,U){const X={mesh:!0,storage:!0};for(const ba of U){const {name:Z,outStatistic:P}=ba,{statisticType:L,onStatisticField:O}=P;let T=U=null,ea=null;"onStatisticValueExpression"in P?T=B(S,{type:"expression",target:"feature",valueExpression:P.onStatisticValueExpression,resultType:"numeric"}).fieldIndex:"onStatisticNormalizationField"in P?(U=
B(S,{type:"field",target:"feature",field:O,resultType:"numeric"}).field,ea=P.onStatisticNormalizationField):U=B(S,{type:"field",target:"feature",field:O,resultType:"numeric"}).field;B(S,{type:"statistic",target:"aggregate",name:Z,context:X,inField:U,inNormalizationField:ea,inFieldIndex:T,statisticType:L})}}function M(S,U,X){switch(X.type){case "dot-density":return R(S,U,X.attributes);case "simple":case "class-breaks":case "unique-value":return N(S,U,X.visualVariables);case "heatmap":case "dictionary":return null}}
function R(S,U,X){return X&&X.length?{type:"dot-density",mapping:X.map((ba,Z)=>{const {field:P,fieldIndex:L}=y(S,{valueExpression:ba.valueExpression,field:ba.field,resultType:"numeric",target:U});return{binding:Z,field:P,fieldIndex:L}}),target:U}:{type:"dot-density",mapping:[],target:U}}function N(S,U,X){if(!X||!X.length)return{type:"visual-variable",mapping:[],target:U};const ba={storage:!0};return{type:"visual-variable",mapping:q.simplifyVisualVariables(X).map(Z=>{var P;const L=f.getVVType(Z.type),
{field:O,fieldIndex:T}=y(S,{target:U,valueExpression:Z.valueExpression,field:Z.field,context:ba,resultType:"numeric"});switch(Z.type){case "size":return"$view.scale"===Z.valueExpression?null:{type:"size",binding:L,field:O,fieldIndex:T,normalizationField:y(S,{target:U,field:Z.normalizationField,context:ba,resultType:"numeric"}).field,valueRepresentation:null!=(P=Z.valueRepresentation)?P:null};case "color":return{type:"color",binding:L,field:O,fieldIndex:T,normalizationField:y(S,{target:U,field:Z.normalizationField,
context:ba,resultType:"numeric"}).field};case "opacity":return{type:"opacity",binding:L,field:O,fieldIndex:T,normalizationField:y(S,{target:U,field:Z.normalizationField,context:ba,resultType:"numeric"}).field};case "rotation":return{type:"rotation",binding:L,field:O,fieldIndex:T}}}).filter(Z=>Z),target:U}}function I(S,U,X,ba=!1){S=C.unwrapOr(S,{indexCount:0,fields:{}});switch(X.type){case "simple":case "dot-density":return H(S,X,"dot-density"===X.type,ba);case "class-breaks":return Q(S,U,X,ba);case "unique-value":return W(S,
U,X,ba);case "dictionary":return{type:"dictionary",renderer:X.toJSON()}}}function H(S,U,X,ba=!1){S=U.getSymbols();return{type:"simple",symbol:u(S.length?S[0]:null,U,ba),isDotDensity:X}}function Q(S,U,X,ba=!1){const Z=X.backgroundFillSymbol,{field:P,fieldIndex:L}=y(S,{target:U,field:X.field,valueExpression:X.valueExpression,resultType:"numeric",context:{mesh:!0,use:"renderer.field"}});U=X.normalizationType;U="log"===U?"esriNormalizeByLog":"percent-of-total"===U?"esriNormalizeByPercentOfTotal":"field"===
U?"esriNormalizeByField":null;const O=X.classBreakInfos.map(T=>({symbol:u(T.symbol,X,ba),min:T.minValue,max:T.maxValue})).sort((T,ea)=>T.min-ea.min);return{type:"interval",attributes:S.fields,field:P,fieldIndex:L,backgroundFillSymbol:u(Z,X,ba),defaultSymbol:u(X.defaultSymbol,X,ba),intervals:O,normalizationField:X.normalizationField,normalizationTotal:X.normalizationTotal,normalizationType:U,isMaxInclusive:X.isMaxInclusive}}function W(S,U,X,ba=!1){const Z=[],P=X.backgroundFillSymbol;U={target:U,context:{mesh:!0},
resultType:"string"};if(X.field&&"string"!==typeof X.field)throw new m("ValidationError","Expected renderer.field to be a string",X);const {field:L,fieldIndex:O}=y(S,{...U,field:X.field,valueExpression:X.valueExpression});for(const T of X.uniqueValueInfos)Z.push({value:""+T.value,symbol:u(T.symbol,X,ba)});return{type:"map",attributes:S.fields,field:L,fieldIndex:O,field2:y(S,{...U,field:X.field2}).field,field3:y(S,{...U,field:X.field3}).field,fieldDelimiter:X.fieldDelimiter,backgroundFillSymbol:u(P,
X),defaultSymbol:u(X.defaultSymbol,X),map:Z}}const aa=A.getLogger("esri.views.2d.layers.features.schemaUtils"),da={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};z.addAggregateFields=K;z.createMatcherSchema=I;z.createSchema=function(S){E("esri-2d-update-debug")&&console.debug("Created new schema",
r(S,!0));return r(S)};z.createSymbolSchema=u;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/support/clusterUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../renderers/visualVariables/support/SizeStop ../../../../renderers/visualVariables/SizeVariable ../../../../core/MD5 ../../engine/LevelDependentSizeVariable".split(" "),function(z,E,D,C,A,m,c,b,d){function a(v,p,r){switch(v){case "avg":case "avg_angle":return`cluster_avg_${p}`;
case "mode":return`cluster_type_${p}`;case "norm":return v=p.toLowerCase()+",norm:field,"+r.toLowerCase(),"cluster_avg_"+b.createMD5Hash(v)}}function e(v,p){const {name:r,outStatistic:w}=p,{onStatisticField:l,onStatisticValueExpression:x,statisticType:y}=w;x?(p=b.createMD5Hash(x.toLowerCase()),v.push({name:r,outStatistic:{onStatisticField:p,onStatisticValueExpression:x,statisticType:y}})):l?v.push({name:r,outStatistic:{onStatisticField:l,statisticType:y}}):q.error(new A("mapview-unsupported-field",
"Unable to handle field",{field:p}))}function f(v,p,r){const w=b.createMD5Hash(p),l="mode"===r?`cluster_type_${w}`:`cluster_avg_${w}`;v.some(x=>x.name===l)||v.push({name:l,outStatistic:{onStatisticField:w,onStatisticValueExpression:p,statisticType:r}});return l}function g(v,p,r,w){if("cluster_count"===p||v.some(x=>x.name===p))return p;const l=a(r,p,w);v.some(x=>x.name===l)||("norm"===r?v.push({name:l,outStatistic:{onStatisticField:p,onStatisticNormalizationField:w,statisticType:r}}):v.push({name:l,
outStatistic:{onStatisticField:p,statisticType:r}}));return l}const q=C.getLogger("esri.views.2d.layers.support.clusterUtils");E.add("esri-cluster-arcade-enabled",1);const h=E("esri-cluster-arcade-enabled"),n=v=>{for(const p of v)if("size"===p.type)return p;return null},u=v=>{for(const p of v)if("cluster_count"===p.field)return!0;return!1},t=(v,p)=>{const r=[new m({value:0,size:0}),new m({value:1})];if(D.isNone(p))return new c({field:"cluster_count",stops:[...r,new m({value:2,size:0})]});const w=
Object.keys(p).reduce((l,x)=>({...l,[x]:[...r,new m({value:Math.max(2,p[x].minValue),size:v.clusterMinSize}),new m({value:Math.max(3,p[x].maxValue),size:v.clusterMaxSize})]}),{});return new d.LevelDependentSizeVariable({field:"cluster_count",levels:w})},k=v=>{const p=r=>q.error(new A("Unsupported-renderer",r,{renderer:v}));if("unique-value"===v.type){if(v.field2||v.field3)return p("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===v.type){if(v.normalizationField){const r=
v.normalizationType;if("field"!==r)return p(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}}else if("simple"!==v.type)return p(`FeatureReductionCluster does not support renderers of type ${v.type}`),!1;if(!h){if("valueExpression"in v&&v.valueExpression)return p("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in v&&v.visualVariables||[]).some(r=>!!("valueExpression"in r&&r.valueExpression)))return p("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),
!1}return!0};z.createClusterCountSizeVariable=t;z.createClusterRenderer=(v,p,r,w)=>{p=p.clone();if(!k(p))return p;if(r.fields)for(var l of r.fields)e(v,l);if("visualVariables"in p){l=(p.visualVariables||[]).filter(y=>"$view.scale"!==y.valueExpression);const x=n(l);l.forEach(y=>{"rotation"===y.type?y.field?y.field=g(v,y.field,"avg_angle"):y.valueExpression&&(y.field=f(v,y.valueExpression,"avg_angle"),y.valueExpression=null):y.normalizationField?(y.field=g(v,y.field,"norm",y.normalizationField),y.normalizationField=
null):y.field?y.field=g(v,y.field,"avg"):(y.field=f(v,y.valueExpression,"avg"),y.valueExpression=null)});D.isNone(x)&&!u(l)&&(l.push(t(r,w)),p.dynamicClusterSize=!0);p.visualVariables=l}switch(p.type){case "unique-value":p.field?p.field=g(v,p.field,"mode"):p.valueExpression&&(p.field=f(v,p.valueExpression,"mode"),p.valueExpression=null);break;case "class-breaks":p.normalizationField?(p.field=g(v,p.field,"norm",p.normalizationField),p.normalizationField=null):p.field?p.field=g(v,p.field,"avg"):(p.field=
f(v,p.valueExpression,"avg"),p.valueExpression=null)}return p};z.findSizeVV=n;z.hasClusterCountVV=u;z.isClusterCompatibleRenderer=k;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/MD5":function(){define(["exports"],function(z){function E(b,d){const a=(b&65535)+(d&65535);return(b>>16)+(d>>16)+(a>>16)<<16|a&65535}function D(b,d,a,e,f,g){b=E(E(d,b),E(e,g));return E(b<<f|b>>>32-f,a)}function C(b,d,a,e,f,g,q){return D(d&a|~d&e,b,d,f,g,q)}function A(b,d,a,e,f,g,q){return D(d&e|a&~e,b,d,f,
g,q)}function m(b,d,a,e,f,g,q){return D(a^(d|~e),b,d,f,g,q)}const c={Base64:0,Hex:1,String:2,Raw:3};z.createMD5Hash=function(b,d=c.Hex){d=d||c.Base64;var a=[];for(let f=0,g=8*b.length;f<g;f+=8)a[f>>5]|=(b.charCodeAt(f/8)&255)<<f%32;{b=8*b.length;a[b>>5]|=128<<b%32;a[(b+64>>>9<<4)+14]=b;b=1732584193;var e=-271733879;let f=-1732584194,g=271733878;for(let q=0;q<a.length;q+=16){const h=b,n=e,u=f,t=g;b=C(b,e,f,g,a[q+0],7,-680876936);g=C(g,b,e,f,a[q+1],12,-389564586);f=C(f,g,b,e,a[q+2],17,606105819);e=
C(e,f,g,b,a[q+3],22,-1044525330);b=C(b,e,f,g,a[q+4],7,-176418897);g=C(g,b,e,f,a[q+5],12,1200080426);f=C(f,g,b,e,a[q+6],17,-1473231341);e=C(e,f,g,b,a[q+7],22,-45705983);b=C(b,e,f,g,a[q+8],7,1770035416);g=C(g,b,e,f,a[q+9],12,-1958414417);f=C(f,g,b,e,a[q+10],17,-42063);e=C(e,f,g,b,a[q+11],22,-1990404162);b=C(b,e,f,g,a[q+12],7,1804603682);g=C(g,b,e,f,a[q+13],12,-40341101);f=C(f,g,b,e,a[q+14],17,-1502002290);e=C(e,f,g,b,a[q+15],22,1236535329);b=A(b,e,f,g,a[q+1],5,-165796510);g=A(g,b,e,f,a[q+6],9,-1069501632);
f=A(f,g,b,e,a[q+11],14,643717713);e=A(e,f,g,b,a[q+0],20,-373897302);b=A(b,e,f,g,a[q+5],5,-701558691);g=A(g,b,e,f,a[q+10],9,38016083);f=A(f,g,b,e,a[q+15],14,-660478335);e=A(e,f,g,b,a[q+4],20,-405537848);b=A(b,e,f,g,a[q+9],5,568446438);g=A(g,b,e,f,a[q+14],9,-1019803690);f=A(f,g,b,e,a[q+3],14,-187363961);e=A(e,f,g,b,a[q+8],20,1163531501);b=A(b,e,f,g,a[q+13],5,-1444681467);g=A(g,b,e,f,a[q+2],9,-51403784);f=A(f,g,b,e,a[q+7],14,1735328473);e=A(e,f,g,b,a[q+12],20,-1926607734);b=D(e^f^g,b,e,a[q+5],4,-378558);
g=D(b^e^f,g,b,a[q+8],11,-2022574463);f=D(g^b^e,f,g,a[q+11],16,1839030562);e=D(f^g^b,e,f,a[q+14],23,-35309556);b=D(e^f^g,b,e,a[q+1],4,-1530992060);g=D(b^e^f,g,b,a[q+4],11,1272893353);f=D(g^b^e,f,g,a[q+7],16,-155497632);e=D(f^g^b,e,f,a[q+10],23,-1094730640);b=D(e^f^g,b,e,a[q+13],4,681279174);g=D(b^e^f,g,b,a[q+0],11,-358537222);f=D(g^b^e,f,g,a[q+3],16,-722521979);e=D(f^g^b,e,f,a[q+6],23,76029189);b=D(e^f^g,b,e,a[q+9],4,-640364487);g=D(b^e^f,g,b,a[q+12],11,-421815835);f=D(g^b^e,f,g,a[q+15],16,530742520);
e=D(f^g^b,e,f,a[q+2],23,-995338651);b=m(b,e,f,g,a[q+0],6,-198630844);g=m(g,b,e,f,a[q+7],10,1126891415);f=m(f,g,b,e,a[q+14],15,-1416354905);e=m(e,f,g,b,a[q+5],21,-57434055);b=m(b,e,f,g,a[q+12],6,1700485571);g=m(g,b,e,f,a[q+3],10,-1894986606);f=m(f,g,b,e,a[q+10],15,-1051523);e=m(e,f,g,b,a[q+1],21,-2054922799);b=m(b,e,f,g,a[q+8],6,1873313359);g=m(g,b,e,f,a[q+15],10,-30611744);f=m(f,g,b,e,a[q+6],15,-1560198380);e=m(e,f,g,b,a[q+13],21,1309151649);b=m(b,e,f,g,a[q+4],6,-145523070);g=m(g,b,e,f,a[q+11],10,
-1120210379);f=m(f,g,b,e,a[q+2],15,718787259);e=m(e,f,g,b,a[q+9],21,-343485551);b=E(b,h);e=E(e,n);f=E(f,u);g=E(g,t)}a=[b,e,f,g]}switch(d){case c.Raw:return a;case c.Hex:d=[];for(let f=0,g=4*a.length;f<g;f++)d.push("0123456789abcdef".charAt(a[f>>2]>>f%4*8+4&15)+"0123456789abcdef".charAt(a[f>>2]>>f%4*8&15));return d=d.join("");case c.String:d=[];for(let f=0,g=32*a.length;f<g;f+=8)d.push(String.fromCharCode(a[f>>5]>>>f%32&255));return d=d.join("");case c.Base64:d=[];for(let f=0,g=4*a.length;f<g;f+=3)for(b=
(a[f>>2]>>f%4*8&255)<<16|(a[f+1>>2]>>(f+1)%4*8&255)<<8|a[f+2>>2]>>(f+2)%4*8&255,e=0;4>e;e++)8*f+6*e>32*a.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b>>6*(3-e)&63));return d=d.join("")}};z.outputTypes=c;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/lang ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../renderers/visualVariables/support/sizeVariableUtils ../../../renderers/visualVariables/SizeVariable".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){var u;z.LevelDependentSizeVariable=u=function(t){function k(){return t.apply(this,arguments)||this}E._inheritsLoose(k,t);var v=k.prototype;v.writeLevels=function(p,r,w){for(const l in p){r.stops=this.levels[l];break}};v.clone=function(){return new u({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:h.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:h.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(p=>p.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:A.clone(this.levels)})};return k}(n);D.__decorate([b.property()],z.LevelDependentSizeVariable.prototype,"levels",void 0);
D.__decorate([e.writer("levels")],z.LevelDependentSizeVariable.prototype,"writeLevels",null);z.LevelDependentSizeVariable=u=D.__decorate([a.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],z.LevelDependentSizeVariable);Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["exports","../enums","../visualVariablesUtils"],function(z,E,D){z.getVVFlags=function(C){if(!C)return E.WGLVVFlag.NONE;let A=0;for(const m of C)"size"===
m.type?(C=D.getTypeOfSizeVisualVariable(m),A|=C,"outline"===m.target&&(A|=C<<4)):"color"===m.type?A|=E.WGLVVFlag.COLOR:"opacity"===m.type?A|=E.WGLVVFlag.OPACITY:"rotation"===m.type&&(A|=E.WGLVVFlag.ROTATION);return A};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define(["exports","../../../../core/Logger","../../../../core/Error","./enums","./Utils"],function(z,E,D,C,A){const m=E.getLogger("esri.views.2d.engine.webgl");z.getTypeOfSizeVisualVariable=
function(c){if(A.isNumber(c.minDataValue)&&A.isNumber(c.maxDataValue)&&null!=c.minSize&&null!=c.maxSize)return C.WGLVVFlag.SIZE_MINMAX_VALUE;if((c.expression&&"view.scale"===c.expression||c.valueExpression&&"$view.scale"===c.valueExpression)&&Array.isArray(c.stops))return C.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=c.field||c.expression&&"view.scale"!==c.expression||c.valueExpression&&"$view.scale"!==c.valueExpression)&&(Array.isArray(c.stops)||"levels"in c&&c.levels))return C.WGLVVFlag.SIZE_FIELD_STOPS;
if((null!=c.field||c.expression&&"view.scale"!==c.expression||c.valueExpression&&"$view.scale"!==c.valueExpression)&&null!=c.valueUnit)return C.WGLVVFlag.SIZE_UNIT_VALUE;m.error(new D("mapview-bad-type","Found invalid size VisualVariable",c));return C.WGLVVFlag.NONE};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["exports","../../../../../core/Logger","../../../../../core/screenUtils"],function(z,E,D){function C(c){return("size"===
c.type||"color"===c.type||"opacity"===c.type)&&null!=c.stops}function A(c){var b=c.type;var d=c.stops;if(8>=d.length)b=d;else if(m.warn(`Found ${d.length} Visual Variable stops, but MapView only supports ${8}. Displayed stops will be simplified.`),16<d.length){{const [t,...k]=d;var a=k.pop(),e=k[0].value,f=k[k.length-1].value,g=(f-e)/6;const v=[];for(;e<f;e+=g){for(var q=0;e>=k[q].value;)q++;var h=k[q],n=d[q-1],u=e-n.value;h=h.value===n.value?1:u/(h.value-n.value);"color"===b?(n=k[q],q=d[q-1],u=n.color.clone(),
u.r=(1-h)*q.color.r+h*u.r,u.g=(1-h)*q.color.g+h*u.g,u.b=(1-h)*q.color.b+h*u.b,u.a=(1-h)*q.color.a+h*u.a,v.push({value:e,color:u,label:n.label})):"size"===b?(n=k[q],u=d[q-1],q=D.toPt(n.size),u=D.toPt(u.size),v.push({value:e,size:(1-h)*u+h*q,label:n.label})):(n=k[q],v.push({value:e,opacity:(1-h)*d[q-1].opacity+h*n.opacity,label:n.label}))}b=[t,...v,a]}}else{{const [t,...k]=d;for(b=k.pop();6<k.length;){a=d=0;for(f=1;f<k.length;f++)g=Math.abs(k[f].value-k[f-1].value),g>a&&(a=g,d=f);k.splice(d,1)}b=[t,
...k,b]}}c.stops=b;return c}const m=E.getLogger("esri.renderers.visualVariables.support.utils");z.simplifyVVRenderer=c=>{if(!("visualVariables"in c&&c.visualVariables&&c.visualVariables.length))return c;c=c.clone();const b=c.visualVariables.map(d=>C(d)?A(d):d);c.visualVariables=b;return c};z.simplifyVisualVariables=function(c){return c.map(b=>C(b)?A(b.clone()):b)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/support/util":function(){define(["exports","../../../../core/jsonMap"],
function(z,E){const D=new E.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});z.analyzeRings=function(C,A,m){const c=[],b=[];let d=0,a=0;for(const e of C){C=a;let f=e[0][0],g=e[0][1];c[a++]=f;c[a++]=g;let q=0;for(let h=1;h<e.length;++h){const n=f,u=g;f=e[h][0];g=e[h][1];q+=g*n-f*u;c[a++]=f;c[a++]=g}A(q/2);0<q?(0<C-d&&(m(d,C,c,b),d=C),b.length=0):0>q?0<C-d?b.push(.5*
(C-d)):a=C:a=C}0<a-d&&m(d,a,c,b)};z.toJSONGeometryType=function(C){return D.toJSON(C)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define(["exports","../../../../../../core/Logger","../../../../../../core/Error","../../util/Matcher"],function(z,E,D,C){const A=E.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");z.createMatcher=async function(m,c,b){switch(m.type){case "simple":return C.FeatureMatcher.fromBasicRenderer(m,
c,b);case "map":return C.MapMatcher.fromUVRenderer(m,c,b);case "interval":return C.IntervalMatcher.fromCBRenderer(m,c,b);case "dictionary":return C.DictionaryMatcher.fromDictionaryRenderer(m,c,b);default:return A.error(new D("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/Logger ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/cim/utils ../../../../../core/LRUCache ../../../arcade/callExpressionWithFeature ../../../../../symbols/cim/cimSymbolUtils ../../../layers/features/schemaUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f){async function g(t,k){const v=t||1;if("number"===typeof v)return(r,w,l)=>v;const p=await c.createRendererExpression(v,k.spatialReference,k.fields);return(r,w,l)=>a(p,r,{$view:l},k.geometryType,w)||1}const q=C.getLogger("esri/views/2d/engine/webgl/util/Matcher");C=function(){function t(){this.type="feature";this._defaultResult=null}t.fromBasicRenderer=async function(v,p,r){const w=new t;v.symbol&&(v=await e.expandSymbol(v.symbol,r),p=p.createTemplateGroup(v,null),
w.setDefault(p));return w};var k=t.prototype;k.size=function(){return 1};k.getDefault=function(){return this._defaultResult};k.setDefault=function(v){this._defaultResult=v};k.match=function(v,p,r,w,l){return this.getDefault()};k.analyze=async function(v,p,r,w,l){return null};return t}();let h=function(t){function k(p,r,w,l){var x=t.call(this)||this;x.type="interval";x._intervals=[];x._isMaxInclusive=r;x._fieldIndex=l;x._field=p;x._normalizationInfo=w;return x}D._inheritsLoose(k,t);k.fromCBRenderer=
async function(p,r,w){const {isMaxInclusive:l,normalizationField:x,normalizationTotal:y,normalizationType:B}=p,F=new k(p.field,l,{normalizationField:x,normalizationTotal:y,normalizationType:B},p.fieldIndex),G=await e.expandSymbol(p.backgroundFillSymbol,w);await m.all(p.intervals.map(async J=>{var K=await e.expandSymbol(J.symbol,w);K=await r.createTemplateGroup(K,G);F.add({min:J.min,max:J.max},K)}));if(p=await e.expandSymbol(p.defaultSymbol,w))p=await r.createTemplateGroup(p,G),F.setDefault(p);return F};
var v=k.prototype;v.add=function(p,r){this._intervals.push({interval:p,result:r});this._intervals.sort((w,l)=>w.interval.min-l.interval.min)};v.size=function(){return t.prototype.size.call(this)+this._intervals.length};v.match=function(p,r,w,l,x){if(null==this._fieldIndex&&!this._field)return this.getDefault();p=null!=this._fieldIndex?r.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(r);if(!p&&(null===p||void 0===p||isNaN(p)))return this.getDefault();for(r=0;r<this._intervals.length;r++){const {interval:y,
result:B}=this._intervals[r];w=this._isMaxInclusive?p<=y.max:p<y.max;if(p>=y.min&&w)return B}return this.getDefault()};v._needsNormalization=function(){const p=this._normalizationInfo;return p&&(p.normalizationField||p.normalizationTotal||p.normalizationType)};v._getValueFromField=function(p){const r=p.readAttribute(this._field);if(!this._needsNormalization())return r;const {normalizationField:w,normalizationTotal:l,normalizationType:x}=this._normalizationInfo;p=!!w&&p.readAttribute(w);if(x)switch(x){case "esriNormalizeByField":return(p||
void 0)&&r/p;case "esriNormalizeByLog":return Math.log(r)*Math.LOG10E;case "esriNormalizeByPercentOfTotal":return r/l*100;default:q.error(`Found unknown normalization type: ${x}`)}else q.error("Normalization is required, but no type was set!")};return k}(C),n=function(t){function k(p,r,w){var l=t.call(this)||this;l.type="map";l._nullResult=null;l._resultsMap=new Map;l._fieldsIndex=w;l._fields=p;l._seperator=r||"";return l}D._inheritsLoose(k,t);k.fromUVRenderer=async function(p,r,w){const l=p.fieldDelimiter,
x=[p.field];p.field2&&x.push(p.field2);p.field3&&x.push(p.field3);const y=await e.expandSymbol(p.backgroundFillSymbol,w),B=new k(x,l,p.fieldIndex);await m.all(p.map.map(async F=>{var G=await e.expandSymbol(F.symbol,w);G=await r.createTemplateGroup(G,y);"\x3cNull\x3e"===F.value?B.setNullResult(G):B.add(F.value,G)}));if(p=await e.expandSymbol(p.defaultSymbol,w))p=await r.createTemplateGroup(p,y),B.setDefault(p);return B};var v=k.prototype;v.setNullResult=function(p){this._nullResult=p};v.add=function(p,
r){this._resultsMap.set(p.toString(),r)};v.size=function(){return t.prototype.size.call(this)+this._resultsMap.size};v.match=function(p,r,w,l,x){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();p=null!=this._fieldsIndex?r.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(r);if(null!==this._nullResult&&(null==p||""===p||"\x3cNull\x3e"===p))return this._nullResult;if(!p&&null==p)return this.getDefault();p=p.toString();return this._resultsMap.has(p)?this._resultsMap.get(p):
this.getDefault()};v._getValueFromFields=function(p){const r=[];for(const w of this._fields){const l=p.readAttribute(w);r.push(l)}return r.join(this._seperator)};return k}(C),u=function(t){function k(p,r,w,l){var x=t.call(this)||this;x.type="dictionary";x._groupIdCache=new d(100);x._renderer=p;x._fieldMap=p.fieldMap;x._symbolFields=p.getSymbolFields();x._templates=r;x._info=w;x._scaleFn=l;return x}D._inheritsLoose(k,t);k.fromDictionaryRenderer=async function(p,r,w){p=(await new Promise(function(x,
y){z(["../../../../../renderers/DictionaryRenderer"],function(B){x(Object.freeze({__proto__:null,"default":B}))},y)})).default.fromJSON(p.renderer);await p.fetchResources({spatialReference:w.spatialReference,fields:w.fields});const l=await g(p.scaleExpression,w);return new k(p,r,w,l)};var v=k.prototype;v._analyzeFeature=async function(p,r,w,l){p=p.readLegacyFeature();const x=this._scaleFn(p,r,w);r=this._attributeHash(p)+"-"+x;const y=this._groupIdCache.get(r);if(y)return y;w=await this._renderer.getSymbolAsync(p,
{...w,spatialReference:this._info.spatialReference,abortOptions:l,fields:this._info.fields});w=f.createSymbolSchema(w,this._renderer);l=e.expandSymbol(w,this._info,l).then(B=>{if("expanded-cim"!==B.type)return q.error(new A("mapview-bad-type",`Found unexpected type ${B.type} in dictionary response`)),null;B.hash+="-"+x;for(const F of B.layers)F.scaleFactor=x,F.templateHash+="-"+x,"text"===F.type&&"string"===typeof F.text&&-1<F.text.indexOf("[")&&(F.text=b.createLabelOverrideFunction(this._fieldMap,
F.text,F.cim.textCase));return this._templates.createTemplateGroup(B,null)});this._groupIdCache.put(r,l,1);return l};v.analyze=async function(p,r,w,l,x){p=r.getCursor();for(r=[];p.next();)r.push(this._analyzeFeature(p,w,l,x));return m.all(r)};v.match=function(p,r,w,l,x){return null};v._attributeHash=function(p){let r="";for(const w of this._symbolFields){const l=this._fieldMap[w];l&&(r+=p.attributes[l]+"-")}return r};return k}(C);E.DictionaryMatcher=u;E.FeatureMatcher=C;E.IntervalMatcher=h;E.MapMatcher=
n;Object.defineProperty(E,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ../../util/Result ../../../../layers/features/schemaUtils ./WGLTextTemplate ./WGLMarkerTemplate ./WGLDynamicFillTemplate ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ../../../../layers/features/textUtils ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ../../util/Lock".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t){function k(w,l){const x=w.length;w.push(null);l.then(y=>w[x]=y);return w}function v(w){return!!(w&1)}const p=D.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),r=[];D=function(){function w(x,y){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=new Map;this._cimAnalyses=[];this._lock=new t["default"];this._fetchResource=
x;this._joinOnUTurn=y}var l=w.prototype;l.createTemplateGroup=function(x,y){this._initErrorTemplates();const B=x.hash;if(this._symbolToTemplate.has(B))return this._symbolToTemplate.get(B);const F=[];y&&this._createMeshTemplates(F,y,!0);this._createMeshTemplates(F,x,!1);x=this._createGroupId("expanded-cim"===x.type);this._idToTemplateGroup.set(x,F);this._symbolToTemplate.set(B,x);return x};l.getTemplateGroup=function(x){return this._idToTemplateGroup.has(x)?this._idToTemplateGroup.get(x):r};l.getDynamicTemplateGroup=
function(x){if(!this._idToTemplateGroup.has(x))return r;v(x)||p.error("mapview-template-store",`Id ${x} does not refer to a dynamic template`);return this._idToTemplateGroup.get(x)};l.getMosaicItem=function(x,y){const B=this._createTemplateId(),F=A.create(G=>this._idToResolver.set(B,G));this._fetchQueue.push({symbol:x,id:B,glyphIds:y});return F};l.finalize=function(x){return this._fetchQueue.length||this._lock.isHeld()?t.withLock(this._lock,this._fetchAllQueuedResources.bind(this),x):A.resolve()};
l._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],b.createSymbolSchema(m.errorPolygonSymbol2D),!1),marker:this._createMeshTemplates([],b.createSymbolSchema(m.errorPointSymbol2D),!1),line:this._createMeshTemplates([],b.createSymbolSchema(m.errorPolylineSymbol2D),!1)})};l._fetchAllQueuedResources=function(x){if(!this._fetchQueue.length)return A.resolve();const y=this._fetchQueue,B=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];
return A.all(B).then(()=>this._fetchResource(y,x).then(F=>{for(const {id:G,mosaicItem:J}of F)this._idToResolver.get(G)(J),this._idToResolver.delete(G)})).catch(F=>{A.isAbortError(F)?this._fetchQueue=this._fetchQueue.concat(y):"worker:port-closed"!==F.name&&p.error(new C("mapview-template-store","Unable to fetch requested texture resources",F))})};l._createGroupId=function(x){return this._idCounter++<<1|(x?1:0)};l._createTemplateId=function(){return this._templateIdCounter++};l._createSMS=async function(x){const {spriteMosaicItem:y}=
await this.getMosaicItem(x);return c.ok(y,p)?a.fromSimpleMarker(x,y):this._markerError};l._createPMS=async function(x){const {spriteMosaicItem:y}=await this.getMosaicItem(x);return c.ok(y,p)?a.fromPictureMarker(x,y):this._markerError};l._createSFS=async function(x,y){const {spriteMosaicItem:B}=await this.getMosaicItem(x);return c.ok(B,p)?n.fromSimpleFill(x,B,y):this._fillError};l._createPFS=async function(x,y){const {spriteMosaicItem:B}=await this.getMosaicItem(x);return c.ok(B,p)?n.fromPictureFill(x,
B,y):this._fillError};l._createSLS=async function(x,y){({spriteMosaicItem:y}=await this.getMosaicItem(x));return c.ok(y,p)?u.fromSimpleLine(x,y,this._joinOnUTurn):this._lineError};l._createLMS=async function(x){const {spriteMosaicItem:y}=await this.getMosaicItem(x);return c.ok(y,p)?a.fromLineSymbolMarker(x,y):this._markerError};l._createTS=async function(x){const {glyphMosaicItems:y}=await this.getMosaicItem(x);return d.fromText(x,y)};l._createCIMText=async function(x){const {glyphMosaicItems:y}=
await this.getMosaicItem(x.cim,q.codepoints(x.text));x.cim.mosaicHash=x.materialHash;return c.ok(y,p)?d.fromCIMText(x,y):this._textError};l._createCIMFill=async function(x){x.cim.mosaicHash=x.materialHash;const {spriteMosaicItem:y}=await this.getMosaicItem(x.cim);return c.ok(y,p)?n.fromCIMFill(x,y):this._fillError};l._createCIMLine=async function(x){x.cim.mosaicHash=x.materialHash;const {spriteMosaicItem:y}=await this.getMosaicItem(x.cim);return c.ok(y,p)?u.fromCIMLine(x,y,this._joinOnUTurn):this._lineError};
l._createCIMMarker=async function(x){x.cim.mosaicHash=x.materialHash;const {spriteMosaicItem:y}=await this.getMosaicItem(x.cim);return c.ok(y,p)?a.fromCIMMarker(x,y):this._markerError};l._createCIM=async function(x){const y=x.templateHash;if(this._cimTemplateCache.has(y))return this._cimTemplateCache.get(y);let B;switch(x.type){case "marker":B=this._createCIMMarker(x);break;case "line":B=this._createCIMLine(x);break;case "fill":B=this._createCIMFill(x);break;case "text":B=this._createCIMText(x)}B.then(F=>
this._cimTemplateCache.set(y,F));return B};l._createDynamicCIM=function(x){const y=x.templateHash;if(this._cimTemplateCache.has(y))return this._cimTemplateCache.get(y);let B;switch(x.type){case "marker":B=g.fromCIMMarker(x);break;case "line":B=f.fromCIMLine(x);break;case "fill":B=e.fromCIMFill(x);break;case "text":B=h.fromCIMText(x)}this._cimTemplateCache.set(y,B);return B};l._createPrimitiveMeshTemplates=function(x,y,B){switch(y.type){case "esriSMS":return k(x,this._createSMS(y));case "esriPMS":return k(x,
this._createPMS(y));case "esriSFS":return k(x,this._createSFS(y,B));case "line-marker":return k(x,this._createLMS(y));case "esriPFS":return k(x,this._createPFS(y,B));case "esriSLS":return k(x,this._createSLS(y,!1));case "esriTS":return k(x,this._createTS(y));default:return p.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),x}};l._createMeshTemplates=function(x,y,B){if(-1!==y.type.indexOf("3d"))return p.error("3D symbols are not supported with MapView"),x;if("expanded-cim"===
y.type){for(const F of y.layers)"function"===typeof F.materialHash?x.push(this._createDynamicCIM(F)):k(x,this._createCIM(F));return x}if("composite-symbol"===y.type){for(const F of y.layers)this._createPrimitiveMeshTemplates(x,F,B);return x}return"cim"===y.type||"label"===y.type||"web-style"===y.type?x:this._createPrimitiveMeshTemplates(x,y,B)};E._createClass(w,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},
{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}}]);return w}();z.WGLTemplateStore=D;z.isDynamicId=v;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../util/BidiText ../../materialKey/MaterialKey ../../color ./WGLBaseTextTemplate ./WGLMeshTemplate".split(" "),
function(z,E,D,C,A,m,c,b){return function(d){function a(e,f,g,q,h,n,u,t,k,v,p,r,w,l,x,y,B,F=!1){var G=d.call(this)||this;G._xOffset=E.pt2px(r);G._yOffset=E.pt2px(w);G._decoration=k||"none";G._color=q;G._haloColor=h;G._haloSize=Math.min(Math.floor(5*E.pt2px(E.toPt(g))),127);G._size=Math.min(Math.round(E.pt2px(f)),127);f=Math.min(Math.round(E.pt2px(f)),127);G._referenceSize=Math.round(Math.sqrt(256*f));G._scale=G._size/24;G._angle=p;G._justify=D.getJustification(n||"center");G._xAlignD=D.getXAnchorDirection(n||
"center");G._yAlignD=D.getYAnchorDirection(u||"baseline");G._baseline="baseline"===(u||"baseline");G._bitset=(1===t?1:0)|(v?1:0)<<1;e=A.MaterialKeyBase.load(e);e.sdf=!0;G._materialKey=e.data;G._lineWidth=E.pt2px(l)||512;G._lineHeight=x||1;G._textPlacement=y;G.effects=B;G._isCIM=F;return G}z._inheritsLoose(a,d);a.fromText=function(e,f){const g=new a(e.materialKey,e.font.size,e.haloSize||0,e.color&&m.premultiplyAlphaRGBAArray(e.color)||0,e.haloColor&&m.premultiplyAlphaRGBAArray(e.haloColor)||0,e.horizontalAlignment,
e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1);[,e]=C.bidiText(e.text);g.bindTextInfo(f,e);return g};a.fromCIMText=function(e,f){var g=e.scaleFactor||1;g=new a(e.materialKey,e.size*e.sizeRatio*g,e.outlineSize*e.sizeRatio,m.premultiplyAlphaRGBA(e.color),m.premultiplyAlphaRGBA(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*g,e.offsetY*e.sizeRatio*g,512,1,
e.markerPlacement,e.effects,!0);[,e]=C.bidiText(e.text);g.bindTextInfo(f,e);return g};return a}(c(b))})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["exports"],function(z){(function(E){E[E.Left=-1]="Left";E[E.Center=0]="Center";E[E.Right=1]="Right"})(z.HAlign||(z.HAlign={}));(function(E){E[E.Top=1]="Top";E[E.Center=0]="Center";E[E.Bottom=-1]="Bottom";E[E.Baseline=2]="Baseline"})(z.VAlign||(z.VAlign={}));z.getAlignmentFromPlacement=function(E){switch(E){case "above-left":return[z.HAlign.Right,
z.VAlign.Bottom];case "above-center":case "above-along":return[z.HAlign.Center,z.VAlign.Bottom];case "above-right":return[z.HAlign.Left,z.VAlign.Bottom];case "center-left":return[z.HAlign.Right,z.VAlign.Center];case "center-center":case "center-along":return[z.HAlign.Center,z.VAlign.Center];case "center-right":return[z.HAlign.Left,z.VAlign.Center];case "below-left":return[z.HAlign.Right,z.VAlign.Top];case "below-center":case "below-along":return[z.HAlign.Center,z.VAlign.Top];case "below-right":return[z.HAlign.Left,
z.VAlign.Top];case "always-horizontal":return[z.HAlign.Center,z.VAlign.Baseline];default:return console.debug(`Found invalid placement type ${E}`),[z.HAlign.Center,z.VAlign.Center]}};z.getJustification=function(E){switch(E){case "left":return z.HAlign.Left;case "right":return z.HAlign.Right;case "center":case "justify":return z.HAlign.Center}};z.getXAnchorDirection=function(E){switch(E){case "left":return z.HAlign.Left;case "right":return z.HAlign.Right;case "center":case "justify":return z.HAlign.Center}};
z.getXDirection=function(E){switch(E){case z.HAlign.Right:return-1;case z.HAlign.Center:return 0;case z.HAlign.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${E}`),0}};z.getYAnchorDirection=function(E){switch(E){case "top":return z.VAlign.Top;case "middle":return z.VAlign.Center;case "baseline":return z.VAlign.Baseline;case "bottom":return z.VAlign.Bottom}};z.getYDirection=function(E){switch(E){case z.VAlign.Top:return 1;case z.VAlign.Center:return 0;case z.VAlign.Bottom:case z.VAlign.Baseline:return-1;
default:return console.debug(`Found invalid vertical alignment ${E}`),0}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../definitions ../../number ./shapingUtils ../../enums ../../materialKey/MaterialKey ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper".split(" "),
function(z,E,D,C,A,m,c,b,d,a){return e=>function(f){function g(...h){h=f.call(this,...h)||this;h._isCIM=!1;h.geometryType=b.WGLGeometryType.TEXT;h._aux=m.i8888to32(0,0,h._referenceSize,h._bitset);return h}z._inheritsLoose(g,f);var q=g.prototype;q.bindTextInfo=function(h,n){this._shapingInfo=h&&h.length?E.andThen(h,u=>c.shapeGlyphs(u,n,{scale:this._scale,angle:this._angle,xOffset:this._xOffset,yOffset:this._yOffset,hAlign:this._xAlignD,vAlign:this._yAlignD,maxLineWidth:Math.max(32,Math.min(this._lineWidth,
512)),lineHeight:A.MAGIC_LABEL_LINE_HEIGHT*Math.max(.25,Math.min(this._lineHeight,4)),decoration:this._decoration,isCIM:this._isCIM})):null};q.writeMeshWithGeometry=function(h,n,u,t,k,v){if(E.isSome(this._textPlacement))return u=null!=v?v:u.readLegacyGeometry(),this._writePlacedText(h,n,k,u);if(u=v?C.deltaDecodeGeometry(C.convertFromGeometry(v),2):"esriGeometryPolygon"===t?u.readCentroid():u.readUnquantizedGeometry()){if(u.isPoint){const [p,r]=u.coords;return this._writeGlyphs(h,n,k,{x:p,y:r})}u.forEachVertex((p,
r)=>this._writeGlyphs(h,n,k,{x:p,y:r}))}};q._writePlacedText=function(h,n,u,t){const k=this._shapingInfo;if(!E.isNone(k)){var v=d.MaterialKeyBase.load(this._materialKey),p=E.unwrap(this._textPlacement);if(t=a.CIMMarkerPlacementHelper.getPlacement(t,p,D.pt2px(1))){var r;for(r=t.next();null!=r;){p=m.i1616to32(Math.round(8*r.tx),Math.round(8*r.ty));r=r.getAngle();k.setRotation(r);for(const w of k.glyphs){v.textureBinding=w.textureBinding;const l=n.getVector("geometry").vertexCount,x=n.indexVector.length,
y=this._writeIndices(n),B=this._writeVertex(n,u,p,w);h.writeDisplayRecord(this.geometryType,v.data,l,B,x,y)}k.setRotation(-r);r=t.next()}}}};q._writeGlyphs=function(h,n,u,t){var k=this._shapingInfo;if(!E.isNone(k)){var v=d.MaterialKeyBase.load(this._materialKey);t=m.i1616to32(Math.round(8*t.x),Math.round(8*t.y));for(const p of k.glyphs){v.textureBinding=p.textureBinding;k=n.getVector("geometry").vertexCount;const r=n.indexVector.length,w=this._writeIndices(n),l=this._writeVertex(n,u,t,p);h.writeDisplayRecord(this.geometryType,
v.data,k,l,r,w)}}};q._writeVertexCommon=function(h,n,u,t){t=this._color;const k=this._haloColor,v=m.i8888to32(0,0,this._referenceSize,this._bitset),p=m.i8888to32(0,0,this._size,this._haloSize);h.push(u);h.push(n);h.push(t);h.push(k);h.push(p);h.push(v)};q._writeVertex=function(h,n,u,t){h=h.get("geometry");this._writeVertexCommon(h,n,u,t);h.push(t.offsets.upperLeft);h.push(t.texcoords.upperLeft);this._writeVertexCommon(h,n,u,t);h.push(t.offsets.upperRight);h.push(t.texcoords.upperRight);this._writeVertexCommon(h,
n,u,t);h.push(t.offsets.lowerLeft);h.push(t.texcoords.lowerLeft);this._writeVertexCommon(h,n,u,t);h.push(t.offsets.lowerRight);h.push(t.texcoords.lowerRight);return 4};q._writeIndices=function(h){const n=h.getVector("geometry").vertexCount;h=h.indexVector;h.push(n+0);h.push(n+1);h.push(n+2);h.push(n+1);h.push(n+3);h.push(n+2);return 6};return g}(e)})},"esri/views/2d/engine/webgl/mesh/templates/shapingUtils":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../chunks/vec2 ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../alignmentUtils ../../number ../../Rect ../../collisions/BoundingBox".split(" "),
function(z,E,D,C,A,m,c,b,d,a){const e=Math.PI/180;let f=function(){function n(t,k,v,p){this._rotationT=A.create();this.minZoom=this._yBounds=this._xBounds=0;this.maxZoom=255;const r=v.rect,w=new Float32Array(8);t*=p;k*=p;const l=v.code?r.width*p:v.metrics.width,x=v.code?r.height*p:v.metrics.height;w[0]=t;w[1]=k;w[2]=t+l;w[3]=k;w[4]=t;w[5]=k+x;w[6]=t+l;w[7]=k+x;this._data=w;this._setTextureCoords(r);this._scale=p;this._mosaic=v;this.x=t;this.y=k}var u=n.prototype;u.setTransform=function(t){this._T=
t;this._offsets=null};u._setOffsets=function(t){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const k=this._offsets,v=new Float32Array(8),p=C.multiply(A.create(),this._rotationT,this._T);A.transformMany(v,t,p);k.upperLeft=b.i1616to32(8*v[0],8*v[1]);k.upperRight=b.i1616to32(8*v[2],8*v[3]);k.lowerLeft=b.i1616to32(8*v[4],8*v[5]);k.lowerRight=b.i1616to32(8*v[6],8*v[7])};u._setTextureCoords=function({x:t,y:k,width:v,height:p}){this._texcoords={upperLeft:b.i1616to32(t,
k),upperRight:b.i1616to32(t+v,k),lowerLeft:b.i1616to32(t,k+p),lowerRight:b.i1616to32(t+v,k+p)}};E._createClass(n,[{key:"width",get:function(){return this._mosaic.metrics.width*this._scale}},{key:"mosaic",get:function(){return this._mosaic}},{key:"angle",set:function(t){this._angle=t;C.identity(this._rotationT);C.rotate(this._rotationT,this._rotationT,-t);this._setOffsets(this._data)},get:function(){return this._angle}},{key:"xTopLeft",get:function(){return this._data[0]}},{key:"yTopLeft",get:function(){return this._data[1]}},
{key:"xBottomRight",get:function(){return this._data[6]}},{key:"yBottomRight",get:function(){return this._data[7]}},{key:"texcoords",get:function(){return this._texcoords}},{key:"textureBinding",get:function(){return this._mosaic.textureBinding}},{key:"offsets",get:function(){this._offsets||this._setOffsets(this._data);return this._offsets}},{key:"char",get:function(){return String.fromCharCode(this._mosaic.code)}},{key:"code",get:function(){return this._mosaic.code}},{key:"bounds",get:function(){const {height:t,
width:k}=this._mosaic.metrics;var v=k*this._scale,p=Math.abs(t)*this._scale,r=new Float32Array(8);r[0]=this.x;r[1]=this.y;r[2]=this.x+v;r[3]=this.y;r[4]=this.x;r[5]=this.y+p;r[6]=this.x+v;r[7]=this.y+p;v=C.multiply(A.create(),this._rotationT,this._T);A.transformMany(r,r,v);p=v=Infinity;let w=0;var l=0;for(let x=0;4>x;x++){const y=r[2*x],B=r[2*x+1];v=Math.min(v,y);p=Math.min(p,B);w=Math.max(w,y);l=Math.max(l,B)}r=w-v;l-=p;return new a(v+r/2,p+l/2,r,l)}}]);return n}();const g=(n,u)=>({code:0,page:0,
sdf:!0,rect:new d(0,0,11,8),textureBinding:u,metrics:{advance:0,height:4,width:n,left:0,top:0}});let q=function(){function n(t,k,v){this._rotation=0;this._decorate(t,k,v);this.glyphs=t;this.bounds=this._createBounds(t);this.isMultiline=1<k.length;this._hasRotation=0!==v.angle;this._T=this._createGlyphTransform(this.bounds,v);for(const p of t)p.setTransform(this._T)}var u=n.prototype;u.setRotation=function(t){if(0!==t||0!==this._rotation){this._rotation=t;var k=this._T;t=C.fromRotation(A.create(),
t);C.multiply(k,t,k);for(const v of this.glyphs)v.setTransform(this._T)}};u._decorate=function(t,k,v){if(v.decoration&&"none"!==v.decoration&&t.length){var p=v.scale;v="underline"===v.decoration?30:20;var r=t[0].textureBinding;for(const w of k)t.push(new f(w.startX*p,w.startY*p+v*p,g((w.width+w.glyphWidthEnd)*p,r),1))}};u._createBounds=function(t){let k=Infinity,v=Infinity,p=0;var r=0;for(const w of t)k=Math.min(k,w.xTopLeft),v=Math.min(v,w.yTopLeft),p=Math.max(p,w.xTopLeft+w.width),r=Math.max(r,
w.yBottomRight);t=p-k;r-=v;return new a(k+t/2,v+r/2,t,r)};u._createGlyphTransform=function(t,k){const v=e*k.angle,p=A.create(),r=m.create();C.translate(p,p,D.set(r,k.xOffset,-k.yOffset));k.isCIM?C.rotate(p,p,v):(C.translate(p,p,D.set(r,t.x,t.y)),C.rotate(p,p,v),C.translate(p,p,D.set(r,-t.x,-t.y)));return p};E._createClass(n,[{key:"boundsT",get:function(){var t=this.bounds;const k=D.set(m.create(),t.x,t.y);D.transformMat2d(k,k,this._T);return this._hasRotation?(t=Math.max(t.width,t.height),new a(k[0],
k[1],t,t)):new a(k[0],k[1],t.width,t.height)}}]);return n}(),h=function(n,u,t,k,v,p){this.startY=this.startX=this.glyphWidthEnd=0;this.start=Math.max(0,Math.min(u,t));this.end=Math.max(0,Math.max(u,t));this.end<n.length&&(this.glyphWidthEnd=n[this.end].metrics.width);this.width=k;this.yMin=v;this.yMax=p};z.ShapedGlyph=f;z.ShapingInfo=q;z.shapeGlyphs=function(n,u,t){const k=t.scale,v=[];{var p=[];var r=1/t.scale*t.maxLineWidth;var w=u?n.length-1:0;var l=u?-1:n.length;u=u?-1:1;var x=w,y=0,B=0;let K=
x,M=K,R=0,N=Infinity,I=0;for(;x!==l;){const {code:H,metrics:Q}=n[x];var F=Math.abs(Q.top);10!==H&&32!==H&&(N=Math.min(N,F),I=Math.max(I,F+Q.height));10===H?(x!==w&&(p.push(new h(n,K,x-u,y,N,I)),N=Infinity,I=0),y=0,K=x+u,M=x+u,B=0):32===H?(M=x+u,B=0,R=Q.advance,y+=Q.advance):(y>r&&(M!==K?(F=M-2*u,y-=R,p.push(new h(n,K,F,y-B,N,I)),N=Infinity,I=0,K=M,y=B):(p.push(new h(n,K,x-u,y,N,I)),N=Infinity,I=0,M=K=x,y=0)),y+=Q.advance,B+=Q.advance);x+=u}r=new h(n,K,x-u,y,N,I);0<=r.start&&r.end<n.length&&p.push(r)}for(r=
0;r<p.length;r++);r=w=p[0].yMin;w=p[p.length-1].yMax+t.lineHeight*(p.length-1)+("underline"===t.decoration?4:0)-w;const {vAlign:G,hAlign:J}=t;l=G===c.VAlign.Baseline?1:0;r=(1-l)*-r+w/2*(l?0:G-1)+-26*(l?1:0);for(w=0;w<p.length;w++){const {start:K,end:M,width:R}=p[w];l=R/2*(J+1)*-1-3;u=w*t.lineHeight+r-3;p[w].startX=l;p[w].startY=u;for(x=K;x<=M;x++)y=n[x],10!==y.code&&(B=new f(l+y.metrics.left,u-y.metrics.top,y,k),l+=y.metrics.advance,v.push(B))}return new q(v,p,t)};Object.defineProperty(z,"__esModule",
{value:!0})})},"esri/symbols/cim/placements/CIMMarkerPlacementHelper":function(){define(["exports","../CIMCursor","../CIMOperators"],function(z,E,D){let C=function(){function A(){}A.getPlacement=function(m,c,b){const d=D.getPlacementOperator(c);if(!d)return null;m=E.cloneAndDecodeGeometry(m);return d.execute(m,c,b)};return A}();z.CIMMarkerPlacementHelper=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers",
"../../../../../../core/maybe","../../../../../../geometry/support/jsonUtils","../../enums","../../../../../../symbols/cim/effects/CIMEffectHelper"],function(z,E,D,C,A){return function(){function m(){}var c=m.prototype;c.writeMesh=function(b,d,a,e,f){if(E.isNone(this.effects))return this.writeMeshWithGeometry(b,d,a,e,f);e=A.CIMEffectHelper.executeEffects(this.effects,a.readLegacyGeometry());let g=A.CIMEffectHelper.next(e);for(;g;)this.writeMeshWithGeometry(b,d,a,D.getJsonType(g),f,g),g=A.CIMEffectHelper.next(e)};
c.writeMeshWithGeometry=function(b,d,a,e,f,g){};c.bindFeature=function(b,d,a){};z._createClass(m,[{key:"needsPixelBuffer",get:function(){return!!this.effects||this.geometryType===C.WGLGeometryType.MARKER||this.geometryType===C.WGLGeometryType.TEXT||this.geometryType===C.WGLGeometryType.LABEL}}]);return m}()})},"esri/symbols/cim/effects/CIMEffectHelper":function(){define(["exports","../CIMEffects","../CIMCursor","../CIMOperators"],function(z,E,D,C){const A=96/72;let m=function(){function c(){}c.executeEffects=
function(b,d){d=D.cloneAndDecodeGeometry(d);d=new E.SimpleGeometryCursor(d);for(const a of b)(b=C.getEffectOperator(a))&&(d=b.execute(d,a,A));return d};c.next=function(b){b=b.next();D.deltaEncodeGeometry(b);return b};return c}();z.CIMEffectHelper=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../definitions ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../materialKey/MaterialKey ../../color ./WGLMeshTemplate ./WGLBaseMarkerTemplate".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){return function(f){function g(q,h,n,u,t,k,v,p,r,w,l,x,y,B,F,G,J,K,M,R,N){var I=f.call(this)||this;I.angle=u;I.height=v;I.width=k;I.xOffset=h*M;I.yOffset=n*M;I._markerPlacement=R;I.effects=N;I._anchorX=.5-(.5+G)*F.width/F.width;I._anchorY=.5-(.5+J)*F.height/F.height;h=(1===B?1:0)|(l?1:0)<<1|(y?1:0)<<2|(x?1:0)<<3;n=F&&F.sdf;q=b.MarkerMaterialKey.load(q);q.sdf=n;q.pattern=!0;q.textureBinding=F.textureBinding;I._materialKey=q.data;I._fillColor=t;I._outlineColor=r;I._sizeOutlineWidth=
c.i8888to32(Math.round(Math.min(Math.sqrt(128*k),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*w),255)),Math.round(Math.min(Math.sqrt(128*p),255)));t=F.rect.x+C.SPRITE_PADDING;p=F.rect.y+C.SPRITE_PADDING;r=t+F.width;F=p+F.height;I._texUpperLeft=c.i1616to32(t,p);I._texUpperRight=c.i1616to32(r,p);I._texBottomLeft=c.i1616to32(t,F);I._texBottomRight=c.i1616to32(r,F);k=k*K*M;v=v*K*M;I._bitestAndDistRatio=c.i8888to32(0,0,h,Math.round(Math.min(64*K,255)));I._computedWidth=
k;I._computedHeight=v;k=m.create();v=A.create();I._applyTransformation(v,k);return I}z._inheritsLoose(g,f);g.fromCIMMarker=function(q,h){const n=q.size,u=(h&&h.width||1)/(h&&h.height||1)*q.scaleX;var t=q.scaleSymbolsProportionally&&q.frameHeight?n/q.frameHeight:1;const k=d.premultiplyAlphaRGBA(q.color),v=d.premultiplyAlphaRGBA(q.outlineColor),p=D.pt2px(n),r=p*u,w=D.pt2px(q.offsetX||0),l=D.pt2px(q.offsetY||0);t*=D.pt2px(q.outlineWidth||0);const x=q.alignment||0,y=D.pt2px(q.referenceSize);let B=q.rotation||
0;q.rotateClockwise||(B=-B);let F=0,G=0;const J=q.anchorPoint;J&&(q.isAbsoluteAnchorPoint?n&&(F=-J.x/(n*u),G=J.y/n):(F=J.x,G=J.y));return new g(q.materialKey,w,l,B,k,r,p,y,v,t,q.colorLocked,q.scaleSymbolsProportionally,!1,x,h,F,G,q.sizeRatio,E.unwrapOr(q.scaleFactor,1),q.markerPlacement,q.effects)};g.fromPictureMarker=function(q,h){const n=Math.round(D.pt2px(q.width)),u=Math.round(D.pt2px(q.height)),t=C.PICTURE_FILL_COLOR,k=Math.round(D.pt2px(q.xoffset||0)),v=Math.round(D.pt2px(q.yoffset||0));return new g(q.materialKey,
k,v,q.angle,t,n,u,u,0,0,!1,!1,!1,0,h,0,0,1,1,null,null)};g.fromSimpleMarker=function(q,h){const n=d.premultiplyAlphaRGBAArray(q.color),u=Math.round(D.pt2px(q.size)),t=Math.round(D.pt2px(q.xoffset||0)),k=Math.round(D.pt2px(q.yoffset||0)),v=q.style;var p=q.outline;const r=(p&&p.color&&d.premultiplyAlphaRGBAArray(p.color))|0;p=(p&&p.width&&Math.round(D.pt2px(p.width)))|0;q=new g(q.materialKey,t,k,q.angle,n,u,u,u,r,p,!1,!1,"esriSMSCross"===v||"esriSMSX"===v,0,h,0,0,1.96875,1,null,null);q.boundsType="esriSMSCircle"===
v?"circle":"square";return q};g.fromLineSymbolMarker=function(q,h){const n=d.premultiplyAlphaRGBAArray(q.color),u=Math.round(D.pt2px(6*q.lineWidth)),t="cross"===q.style||"x"===q.style;switch(q.placement){case "begin-end":var k="Both";break;case "begin":k="JustBegin";break;case "end":k="JustEnd";break;default:k="None"}k={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:k,offsetAlongLine:0};h=new g(q.materialKey,0,0,0,n,u,u,u/6,n,t?Math.round(D.pt2px(q.lineWidth)):0,
!1,!1,t,1,h,0,0,1.96875,1,k,null);h.boundsType="circle"===q.style?"circle":"square";return h};return g}(e(a))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../layers/graphics/featureConversionUtils ../../../../../../chunks/vec2 ../../../../../../chunks/mat2d ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../enums ../../../../../../symbols/cim/placements/CIMMarkerPlacementHelper".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){const f=3.14159265359/180;return g=>function(q){function h(...u){u=q.call(this,...u)||this;u.angle=0;u.xOffset=0;u.yOffset=0;u.width=0;u.height=0;u.boundsType="square";u._anchorX=0;u._anchorY=0;u._computedWidth=0;u._computedHeight=0;u.geometryType=a.WGLGeometryType.MARKER;return u}z._inheritsLoose(h,q);var n=h.prototype;n.writeMeshWithGeometry=function(u,t,k,v,p,r){const w=t.indexVector,l=t.get("geometry"),x=t.getVector("geometry"),y=x.vertexCount,B=w.length;if(E.isSome(this._markerPlacement))k=
null!=r?r:k.readLegacyGeometry(),this._writePlacedMarkers(l,w,y,p,k);else{k=r?C.deltaDecodeGeometry(C.convertFromGeometry(r),2):"esriGeometryPolygon"===v?k.readCentroid():k.readUnquantizedGeometry();if(!k)return;if(k.isPoint){const [F,G]=k.coords;this._writeVertices(l,p,this._getPos(F,G));this._writeIndices(w,y)}else k.forEachVertex((F,G)=>{const J=x.vertexCount;this._writeVertices(l,p,this._getPos(F,G));this._writeIndices(w,J)})}t=t.getVector("geometry").vertexCount-y;u.writeDisplayRecord(this.geometryType,
this._materialKey,y,t,B,w.length-B)};n._applyTransformation=function(u,t,k=0){m.identity(u);m.translate(u,u,b.fromValues(this.xOffset,-this.yOffset));0!==this.angle+k&&m.rotate(u,u,f*(this.angle+k));k=this._computedWidth;const v=this._computedHeight,p=(this._anchorX-.5)*k,r=(this._anchorY-.5)*v;A.set(t,p,r);A.transformMat2d(t,t,u);this._offsetUpperLeft=d.i1616to32(16*t[0],16*t[1]);A.set(t,p+k,r);A.transformMat2d(t,t,u);this._offsetUpperRight=d.i1616to32(16*t[0],16*t[1]);A.set(t,p,r+v);A.transformMat2d(t,
t,u);this._offsetBottomLeft=d.i1616to32(16*t[0],16*t[1]);A.set(t,p+k,r+v);A.transformMat2d(t,t,u);this._offsetBottomRight=d.i1616to32(16*t[0],16*t[1])};n._writePlacedMarkers=function(u,t,k,v,p){if(p=e.CIMMarkerPlacementHelper.getPlacement(p,E.unwrap(this._markerPlacement),D.pt2px(1)))for(var r=b.create(),w=c.create(),l=0,x=p.next();null!=x;)-128<=x.tx&&640>=x.tx&&-128<=x.ty&&640>=x.ty&&(this._applyTransformation(w,r,x.getAngle()/f),this._writeVertices(u,v,this._getPos(x.tx,x.ty)),this._writeIndices(t,
k+l),l+=4),x=p.next()};n._getPos=function(u,t){return d.i1616to32(Math.round(8*u),Math.round(8*t))};n._writeVertices=function(u,t,k){u.push(k);u.push(this._offsetUpperLeft);u.push(this._texUpperLeft);u.push(this._bitestAndDistRatio);u.push(t);u.push(this._fillColor);u.push(this._outlineColor);u.push(this._sizeOutlineWidth);u.push(k);u.push(this._offsetUpperRight);u.push(this._texUpperRight);u.push(this._bitestAndDistRatio);u.push(t);u.push(this._fillColor);u.push(this._outlineColor);u.push(this._sizeOutlineWidth);
u.push(k);u.push(this._offsetBottomLeft);u.push(this._texBottomLeft);u.push(this._bitestAndDistRatio);u.push(t);u.push(this._fillColor);u.push(this._outlineColor);u.push(this._sizeOutlineWidth);u.push(k);u.push(this._offsetBottomRight);u.push(this._texBottomRight);u.push(this._bitestAndDistRatio);u.push(t);u.push(this._fillColor);u.push(this._outlineColor);u.push(this._sizeOutlineWidth)};n._writeIndices=function(u,t){u.push(t+0);u.push(t+1);u.push(t+2);u.push(t+1);u.push(t+3);u.push(t+2)};return h}(g)})},
"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../GeometryUtils ../../util/Result ./util ./WGLBaseFillTemplate ./WGLDynamicMeshTemplate".split(" "),function(z,E,D,C,A,m,c,b,d,a,e,f){return function(g){function q(h){var n=g.call(this,h)||this;if(a.isFunction(h.color))n._dynamicPropertyMap.set("_fillColor",
(r,w,l)=>(r=h.color(r,w,l))&&c.premultiplyAlphaRGBA(r)||0);else{const r=h.color;n.fillColor=r&&c.premultiplyAlphaRGBA(r)||0}let u=0;a.isFunction(h.height)||(u=h.height||0);n._dynamicPropertyMap.set("_height",(r,w,l)=>a.isFunction(h.height)?h.height(r,w,l):u);let t=0;a.isFunction(h.offsetX)||(t=D.pt2px(h.offsetX||0)+128,255<t&&(t=255));n._dynamicPropertyMap.set("_offsetX",(r,w,l)=>a.isFunction(h.offsetX)?(r=D.pt2px(h.offsetX(r,w,l))+128,255<r&&(r=255),r):t);let k=1;a.isFunction(h.scaleX)||(k=h.scaleX||
1);n._dynamicPropertyMap.set("_scaleX",(r,w,l)=>a.isFunction(h.scaleX)?h.scaleX(r,w,l):k);let v=0;a.isFunction(h.offsetY)||(v=D.pt2px(-h.offsetY||0)+128,255<v&&(v=255));n._dynamicPropertyMap.set("_offsetY",(r,w,l)=>a.isFunction(h.offsetY)?(r=D.pt2px(-h.offsetY(r,w,l))+128,255<r&&(r=255),r):v);let p=0;a.isFunction(h.angle)||(p=b.radToByte(h.angle)||0);n._dynamicPropertyMap.set("_angle",(r,w,l)=>a.isFunction(h.angle)?b.radToByte(h.angle(r,w,l)):p);n.effects=h.effects;n._cimFillLayer=h;n._fillMaterialKey=
m.FillMaterialKey.load(h.materialKey);return n}z._inheritsLoose(q,g);q.fromCIMFill=function(h){return new q(h)};q.prototype.bindFeature=function(h,n,u){const t=h.readLegacyFeature();this._dynamicPropertyMap.forEach((p,r)=>{this[r]=p(t,n,u)});h=this._fillMaterialKey;var k=this._materialCache,v=this._cimFillLayer;this.aux3=A.i8888to32(0,0,this._angle,v.colorLocked?1:0);v=v.materialHash;v=v(t,n,u);v=k.get(v);k=null;v&&d.ok(v.spriteMosaicItem)&&(k=v.spriteMosaicItem);if(k){const {rect:p,width:r,height:w}=
k;v=p.x+C.SPRITE_PADDING;const l=p.y+C.SPRITE_PADDING,x=v+r,y=l+w;let B=E.nextHighestPowerOfTwo(D.pt2px(this._height));255<B?B=255:0>=B&&(B=E.nextHighestPowerOfTwo(y-l));let F=E.nextHighestPowerOfTwo(D.pt2px(this._height/w*r||0));255<F?F=255:0>=F&&(F=E.nextHighestPowerOfTwo(x-v));const G=this._scaleX;this.tl=A.i1616to32(v,l);this.br=A.i1616to32(x,y);this.aux1=A.i8888to32(F,B,this._offsetX,this._offsetY);this.aux2=A.i1616to32(128*G,128);h.sdf=k.sdf;h.pattern=!0;h.textureBinding=k.textureBinding}else this.aux2=
this.aux1=this.br=this.tl=0,h.sdf=!1,h.pattern=!1,h.textureBinding=0;this._materialKey=h.data};return q}(e(f))})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["exports"],function(z){function E(D,C){return Math.sqrt(D*D+C*C)}z.dist=function(D,C){return E(D[0]-C[0],D[1]-C[1])};z.getLimitCosine=function(D){return 1/Math.max(D,1)};z.isExtent=function(D){return void 0!==D.xmin&&void 0!==D.ymin&&void 0!==D.xmax&&void 0!==D.ymax};z.isFunction=function(D){return"function"===typeof D};
z.isMultipoint=function(D){return void 0!==D.points};z.isPoint=function(D){return void 0!==D.x&&void 0!==D.y};z.isPolygon=function(D){return void 0!==D.rings};z.isPolyline=function(D){return void 0!==D.paths};z.len=E;z.normalize=function(D){const C=E(D[0],D[1]);D[0]/=C;D[1]/=C};z.sub=function(D,C,A){D[0]=C[0]-A[0];D[1]=C[1]-A[1];return D};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../layers/graphics/featureConversionUtils ../../number ../../enums ../../materialKey/MaterialKey ./templateUtils".split(" "),
function(z,E,D,C,A,m){return c=>function(b){function d(...e){e=b.call(this,...e)||this;e.forceLibtess=!1;e.geometryType=C.WGLGeometryType.FILL;return e}z._inheritsLoose(d,b);var a=d.prototype;a.writeMeshWithGeometry=function(e,f,g,q,h,n){q=A.FillMaterialKey.load(this._materialKey);const u=f.indexVector;f=f.getVector("geometry");const t=f.vertexCount,k=u.length;if(n=n?E.deltaDecodeGeometry(E.convertFromGeometry(n),2):g.readUnquantizedGeometry())if(n=m.clipMarshall(n)){var v=n.coords;if(this.forceLibtess||
!m.triangulate(u,n,t))v=[],m.triangulateLibtess(v,u,n,t);this._write(f,g,h,v,q);e.writeDisplayRecord(this.geometryType,this._materialKey,t,f.vertexCount-t,k,u.length-k)}};a._write=function(e,f,g,q,h){for(let n=0;n<q.length;n+=2){const u=D.i1616to32(1*q[n],1*q[n+1]);e.data.push(u);e.data.push(g);h.dotDensity?e.data.writeF32(1/Math.abs(f.readGeometryArea())):(e.data.push(this.fillColor),e.data.push(this.tl),e.data.push(this.br),e.data.push(this.aux1),e.data.push(this.aux2),e.data.push(this.aux3))}};
return d}(c)})},"esri/views/2d/engine/webgl/mesh/templates/templateUtils":function(){define("exports ../../../../../../layers/graphics/OptimizedGeometry ../../../../../../core/libs/earcut/earcut ../../definitions ../../TileClipper ../bufcut ../Tesselator".split(" "),function(z,E,D,C,A,m,c){function b(g,q,h){let n=0;for(let u=1;u<h;u++)n+=(g[2*(q+u)]-g[2*(q+u-1)])*(g[2*(q+u)+1]+g[2*(q+u-1)+1]);return n}function d(g,q,h,n,u){let t=0;for(;h<n;h+=3){const k=2*(g.getValue(h)-u),v=2*(g.getValue(h+1)-u),
p=2*(g.getValue(h+2)-u);t+=Math.abs((q[k]-q[p])*(q[v+1]-q[k+1])-(q[k]-q[v])*(q[p+1]-q[k+1]))}return t}function a(g,q,h,n,u,t,k,v){u=((g-u)*(t-v)-(q-v)*(u-k))/((g-h)*(t-v)-(q-n)*(u-k));return 0>u||1<u?null:{x:Math.round(g+u*(h-g)),y:Math.round(q+u*(n-q))}}const e=new c,f=new A.TileClipper(0,0,0,1,128);f.setExtent(C.TILE_SIZE);z.area=b;z.clip=function(g,q,h=0){const n=-h;q+=h;let u=h=0,t=0;for(let v=0;v<g.lengths.length;v++){const p=g.lengths[v],r=t+p;let w=0,l=null;for(;h!==r;){let x=g.coords[2*h],
y=g.coords[2*h++ +1],B=x<n||x>=q||y<n||y>=q;for(var k=B;h!==r&&B===k;)B||(g.coords[2*u]=x,g.coords[2*u++ +1]=y,w++),x=g.coords[2*h],y=g.coords[2*h++ +1],B=x<n||x>=q||y<n||y>=q;if(h===r){B?l&&(g.coords[2*u]=l.x,g.coords[2*u++ +1]=l.y,w++):(g.coords[2*u]=x,g.coords[2*u++ +1]=y,w++);continue}k=g.coords[2*(h-2)];const F=g.coords[2*(h-2)+1];if(k=a(k,F,x,y,n,n,q,n)||a(k,F,x,y,q,n,q,q)||a(k,F,x,y,q,q,n,q)||a(k,F,x,y,n,n,n,q))g.coords[2*u]=k.x,g.coords[2*u++ +1]=k.y,w++,l||(l=k);B||(g.coords[2*u]=x,g.coords[2*
u++ +1]=y,w++)}g.lengths[v]=w;t+=p}};z.clipMarshall=function(g){a:{var q=C.TILE_SIZE+128;var h=0;for(var n=0;n<g.lengths.length;n++){var u=g.lengths[n];for(var t=0;t<u;t++){var k=g.coords[2*(t+h)];const v=g.coords[2*(t+h)+1];if(-128>k||k>q||-128>v||v>q){q=!0;break a}}h+=u}q=!1}if(!q)return g;f.reset(3);q=0;for(h=0;h<g.lengths.length;h++){n=g.lengths[h];u=g.coords[2*(0+q)];t=g.coords[2*(0+q)+1];f.moveTo(u,t);for(k=1;k<n;k++)u=g.coords[2*(k+q)],t=g.coords[2*(k+q)+1],f.lineTo(u,t);f.close();q+=n}h=f.result(!1);
if(!h)return null;g=[];q=[];for(const v of h){h=0;for(const p of v)q.push(p.x),q.push(p.y),h++;g.push(h)}return new E(g,q)};z.triangleArea=d;z.triangulate=function(g,q,h){const {coords:n,lengths:u,hasIndeterminateRingOrder:t}=q;if(t)return!1;q=g.length;let k=0;for(var v=0;v<u.length;){let w=v,l=u[v];v=b(n,k,l);for(var p=[];++w<u.length;){var r=u[w];const x=b(n,k+l,r);if(!(0<x))break;v+=x;p.push(k+l);l+=r}r=g.length;m.bufcut(g,n,k,k+l,p,2,h);p=d(g,n,r,g.length,h);v=Math.abs(v);if(1E-5<Math.abs((p-
v)/Math.max(1E-7,v)))return g.seek(q),!1;v=w;k+=l}return!0};z.triangulateEarcut=function(g,q,h){const {coords:n,lengths:u,hasIndeterminateRingOrder:t}=q;if(t)return!1;let k=0;for(var v=0;v<u.length;){let r=v,w=u[v];for(v=[];++r<u.length;){var p=u[r];if(!(0<b(n,k+w,p)))break;v.push(k+w-k);w+=p}p=q.coords.slice(2*k,2*(k+w));v=D.earcut(p,v,2);for(const l of v)g.push(l+h+k);v=r;k+=w}return!0};z.triangulateLibtess=function(g,q,h,n){const u=[],{coords:t,lengths:k}=h;e.beginPolygon(g,u);g=0;for(let v=0;v<
k.length;v++){const p=h.lengths[v];e.beginContour();for(let r=0;r<p;r++){const w=[t[2*(g+r)],t[2*(g+r)+1],0];e.addVertex(w,w)}e.endContour();g+=p}e.endPolygon();for(h=0;h<u.length;h++)q.push(u[h]+n)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/libs/earcut/earcut":function(){define(["exports"],function(z){function E(p,r,w,l,x){let y;if(x===0<g(p,r,w,l))for(;r<w;r+=l)y=m(r,p[r],p[r+1],y);else for(w-=l;w>=r;w-=l)y=m(w,p[w],p[w+1],y);y&&u(y,y.next)&&(c(y),y=y.next);return y}function D(p,
r=p){if(!p)return p;let w;do if(w=!1,p.steiner||!u(p,p.next)&&0!==e(p.prev,p,p.next))p=p.next;else{c(p);p=r=p.prev;if(p===p.next)break;w=!0}while(w||p!==r);return r}function C(p,r,w,l,x,y,B=0){if(p){!B&&y&&(p=a(p,l,x,y));for(var F=p;p.prev!==p.next;){var G=p.prev,J=p.next;if(y)var K=A(p,l,x,y);else a:{K=p;var M=K.prev,R=K;const N=K.next;if(0<=e(M,R,N)){K=!1;break a}let I=K.next.next;const H=I;let Q=0;for(;I!==K.prev&&(0===Q||I!==H);){Q++;if(q(M.x,M.y,R.x,R.y,N.x,N.y,I.x,I.y)&&0<=e(I.prev,I,I.next)){K=
!1;break a}I=I.next}K=!0}if(K)r.push(G.index/w),r.push(p.index/w),r.push(J.index/w),c(p),F=p=J.next;else if(p=J,p===F){if(!B)C(D(p),r,w,l,x,y,1);else if(1===B){B=r;F=w;G=p;do J=G.prev,K=G.next.next,!u(J,K)&&f(J,G,G.next,K)&&h(J,K)&&h(K,J)&&(B.push(J.index/F),B.push(G.index/F),B.push(K.index/F),c(G),c(G.next),G=p=K),G=G.next;while(G!==p);p=G;C(p,r,w,l,x,y,2)}else if(2===B)a:{B=p;do{for(F=B.next.next;F!==B.prev;){if(G=B.index!==F.index){K=K=K=void 0;G=B;J=F;if(K=G.next.index!==J.index&&G.prev.index!==
J.index){b:{K=G;do{if(K.index!==G.index&&K.next.index!==G.index&&K.index!==J.index&&K.next.index!==J.index&&f(K,K.next,G,J)){K=!0;break b}K=K.next}while(K!==G);K=!1}K=!K}if(K=K&&h(G,J)&&h(J,G)){K=G;M=!1;R=(G.x+J.x)/2;J=(G.y+J.y)/2;do K.y>J!==K.next.y>J&&K.next.y!==K.y&&R<(K.next.x-K.x)*(J-K.y)/(K.next.y-K.y)+K.x&&(M=!M),K=K.next;while(K!==G);K=M}G=K}if(G){p=k(B,F);B=D(B,B.next);p=D(p,p.next);C(B,r,w,l,x,y);C(p,r,w,l,x,y);break a}F=F.next}B=B.next}while(B!==p)}break}}}}function A(p,r,w,l){const x=
p.prev,y=p.next;if(0<=e(x,p,y))return!1;const B=x.x>p.x?x.x>y.x?x.x:y.x:p.x>y.x?p.x:y.x,F=x.y>p.y?x.y>y.y?x.y:y.y:p.y>y.y?p.y:y.y,G=n(x.x<p.x?x.x<y.x?x.x:y.x:p.x<y.x?p.x:y.x,x.y<p.y?x.y<y.y?x.y:y.y:p.y<y.y?p.y:y.y,r,w,l);r=n(B,F,r,w,l);w=p.prevZ;for(l=p.nextZ;w&&w.z>=G&&l&&l.z<=r;){if(w!==p.prev&&w!==p.next&&q(x.x,x.y,p.x,p.y,y.x,y.y,w.x,w.y)&&0<=e(w.prev,w,w.next))return!1;w=w.prevZ;if(l!==p.prev&&l!==p.next&&q(x.x,x.y,p.x,p.y,y.x,y.y,l.x,l.y)&&0<=e(l.prev,l,l.next))return!1;l=l.nextZ}for(;w&&w.z>=
G;){if(w!==p.prev&&w!==p.next&&q(x.x,x.y,p.x,p.y,y.x,y.y,w.x,w.y)&&0<=e(w.prev,w,w.next))return!1;w=w.prevZ}for(;l&&l.z<=r;){if(l!==p.prev&&l!==p.next&&q(x.x,x.y,p.x,p.y,y.x,y.y,l.x,l.y)&&0<=e(l.prev,l,l.next))return!1;l=l.nextZ}return!0}function m(p,r,w,l){p=new v(p,r,w);l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p);return p}function c(p){p.next.prev=p.prev;p.prev.next=p.next;p.prevZ&&(p.prevZ.nextZ=p.nextZ);p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function b(p){let r=p,w=p;do{if(r.x<
w.x||r.x===w.x&&r.y<w.y)w=r;r=r.next}while(r!==p);return w}function d(p,r){let w=r;const l=p.x,x=p.y;let y=-Infinity,B;do{if(x<=w.y&&x>=w.next.y&&w.next.y!==w.y){var F=w.x+(x-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(F<=l&&F>y){y=F;if(F===l){if(x===w.y)return w;if(x===w.next.y)return w.next}B=w.x<w.next.x?w:w.next}}w=w.next}while(w!==r);if(!B)return null;if(l===y)return B.prev;r=B;F=B.x;const G=B.y;let J=Infinity,K;for(w=B.next;w!==r;)l>=w.x&&w.x>=F&&l!==w.x&&q(x<G?l:y,x,F,G,x<G?y:l,x,w.x,w.y)&&(K=Math.abs(x-
w.y)/(l-w.x),(K<J||K===J&&w.x>B.x)&&h(w,p)&&(B=w,J=K)),w=w.next;return B}function a(p,r,w,l){for(var x;x!==p;x=x.next){x=x||p;null===x.z&&(x.z=n(x.x,x.y,r,w,l));if(x.prev.next!==x||x.next.prev!==x)return x.prev.next=x,x.next.prev=x,a(p,r,w,l);x.prevZ=x.prev;x.nextZ=x.next}p.prevZ.nextZ=null;p.prevZ=null;a:for(w=1;;){l=p;r=p=null;let y=0;for(;l;){y++;x=l;let B=0;for(;B<w&&x;B++)x=x.nextZ;let F=w;for(;0<B||0<F&&x;){let G;0===B?(G=x,x=x.nextZ,F--):0!==F&&x?l.z<=x.z?(G=l,l=l.nextZ,B--):(G=x,x=x.nextZ,
F--):(G=l,l=l.nextZ,B--);r?r.nextZ=G:p=G;G.prevZ=r;r=G}l=x}r.nextZ=null;w*=2;if(2>y)break a}return p}function e(p,r,w){return(r.y-p.y)*(w.x-r.x)-(r.x-p.x)*(w.y-r.y)}function f(p,r,w,l){return u(p,r)&&u(w,l)||u(p,l)&&u(w,r)?!0:0<e(p,r,w)!==0<e(p,r,l)&&0<e(w,l,p)!==0<e(w,l,r)}function g(p,r,w,l){let x=0;for(let y=r,B=w-l;y<w;y+=l)x+=(p[B]-p[y])*(p[y+1]+p[B+1]),B=y;return x}function q(p,r,w,l,x,y,B,F){return 0<=(x-B)*(r-F)-(p-B)*(y-F)&&0<=(p-B)*(l-F)-(w-B)*(r-F)&&0<=(w-B)*(y-F)-(x-B)*(l-F)}function h(p,
r){return 0>e(p.prev,p,p.next)?0<=e(p,r,p.next)&&0<=e(p,p.prev,r):0>e(p,r,p.prev)||0>e(p,p.next,r)}function n(p,r,w,l,x){p=32767*(p-w)*x;r=32767*(r-l)*x;p=(p|p<<8)&16711935;p=(p|p<<4)&252645135;p=(p|p<<2)&858993459;r=(r|r<<8)&16711935;r=(r|r<<4)&252645135;r=(r|r<<2)&858993459;return(p|p<<1)&1431655765|((r|r<<1)&1431655765)<<1}function u(p,r){return p.x===r.x&&p.y===r.y}function t(p,r){return p.x-r.x}function k(p,r){const w=new v(p.index,p.x,p.y),l=new v(r.index,r.x,r.y),x=p.next,y=r.prev;p.next=r;
r.prev=p;w.next=x;x.prev=w;l.next=w;w.prev=l;y.next=l;l.prev=y;return l}let v=function(p,r,w){this.index=p;this.x=r;this.y=w;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1};z.deviation=function(p,r,w,l){var x=r&&r.length;let y=Math.abs(g(p,0,x?r[0]*w:p.length,w));if(x)for(let B=0,F=r.length;B<F;B++)y-=Math.abs(g(p,r[B]*w,B<F-1?r[B+1]*w:p.length,w));r=0;for(x=0;x<l.length;x+=3){const B=l[x]*w,F=l[x+1]*w,G=l[x+2]*w;r+=Math.abs((p[B]-p[G])*(p[F+1]-p[B+1])-(p[B]-p[F])*(p[G+1]-p[B+
1]))}return 0===y&&0===r?0:Math.abs((r-y)/y)};z.earcut=function(p,r,w){var l=r&&r.length;const x=l?r[0]*w:p.length;var y=E(p,0,x,w,!0);const B=[];if(!y||y.next===y.prev)return B;let F,G;var J,K;if(l){l=[];for(let R=0,N=r.length;R<N;R++){var M=E(p,r[R]*w,R<N-1?r[R+1]*w:p.length,w,!1);M===M.next&&(M.steiner=!0);l.push(b(M))}l.sort(t);for(K of l){r=K;l=y;if(l=d(r,l))r=k(l,r),D(r,r.next);y=D(y,y.next)}}if(p.length>80*w){F=J=p[0];G=K=p[1];for(r=w;r<x;r+=w)l=p[r],M=p[r+1],F=Math.min(F,l),G=Math.min(G,M),
J=Math.max(J,l),K=Math.max(K,M);J=Math.max(J-F,K-G);J=0!==J?1/J:0}C(y,B,w,F,G,J);return B};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["exports","../../../../chunks/_rollupPluginBabelHelpers","./definitions","./GeometryUtils","./Geometry"],function(z,E,D,C,A){let m=function(a,e,f){this.ratio=a;this.x=e;this.y=f},c=function(){function a(f,g,q,h=8,n=8){this.lines=[];this.starts=[];this.validateTessellation=!0;this.pixelRatio=h;this.pixelMargin=
n;this.tileSize=D.TILE_SIZE*h;this.dz=f;this.yPos=g;this.xPos=q}var e=a.prototype;e.setExtent=function(f){this.finalRatio=this.tileSize/f*(1<<this.dz);let g=this.pixelRatio*this.pixelMargin;g/=this.finalRatio;f>>=this.dz;g>f&&(g=f);this.margin=g;this.xmin=f*this.xPos-g;this.ymin=f*this.yPos-g;this.xmax=this.xmin+f+2*g;this.ymax=this.ymin+f+2*g};e.reset=function(f){this.type=f;this.lines=[];this.starts=[];this.line=null;this.start=0};e.moveTo=function(f,g){this._pushLine();this._prevIsIn=this._isIn(f,
g);this._moveTo(f,g,this._prevIsIn);this._prevPt=new A.Point(f,g);this._firstPt=new A.Point(f,g);this._dist=0};e.lineTo=function(f,g){const q=this._isIn(f,g),h=new A.Point(f,g),n=A.Point.distance(this._prevPt,h);if(q)if(this._prevIsIn)this._lineTo(f,g,!0);else{var u=this._prevPt;var t=h;f=this._intersect(t,u);this.start=this._dist+n*(1-this._r);this._lineTo(f.x,f.y,!0);this._lineTo(t.x,t.y,!0)}else if(this._prevIsIn)t=this._prevPt,u=h,f=this._intersect(t,u),this._lineTo(f.x,f.y,!0),this._lineTo(u.x,
u.y,!1);else{const v=this._prevPt;if(!(v.x<=this.xmin&&h.x<=this.xmin||v.x>=this.xmax&&h.x>=this.xmax||v.y<=this.ymin&&h.y<=this.ymin||v.y>=this.ymax&&h.y>=this.ymax)){f=[];if(v.x<this.xmin&&h.x>this.xmin||v.x>this.xmin&&h.x<this.xmin){g=(this.xmin-v.x)/(h.x-v.x);var k=v.y+g*(h.y-v.y);k<=this.ymin?t=!1:k>=this.ymax?t=!0:f.push(new m(g,this.xmin,k))}if(v.x<this.xmax&&h.x>this.xmax||v.x>this.xmax&&h.x<this.xmax)g=(this.xmax-v.x)/(h.x-v.x),k=v.y+g*(h.y-v.y),k<=this.ymin?t=!1:k>=this.ymax?t=!0:f.push(new m(g,
this.xmax,k));if(v.y<this.ymin&&h.y>this.ymin||v.y>this.ymin&&h.y<this.ymin)g=(this.ymin-v.y)/(h.y-v.y),k=v.x+g*(h.x-v.x),k<=this.xmin?u=!1:k>=this.xmax?u=!0:f.push(new m(g,k,this.ymin));if(v.y<this.ymax&&h.y>this.ymax||v.y>this.ymax&&h.y<this.ymax)g=(this.ymax-v.y)/(h.y-v.y),k=v.x+g*(h.x-v.x),k<=this.xmin?u=!1:k>=this.xmax?u=!0:f.push(new m(g,k,this.ymax));if(0===f.length)u?t?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):t?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,
this.ymin,!0);else if(1<f.length&&f[0].ratio>f[1].ratio)this.start=this._dist+n*f[1].ratio,this._lineTo(f[1].x,f[1].y,!0),this._lineTo(f[0].x,f[0].y,!0);else for(this.start=this._dist+n*f[0].ratio,u=0;u<f.length;u++)this._lineTo(f[u].x,f[u].y,!0)}this._lineTo(h.x,h.y,!1)}this._dist+=n;this._prevIsIn=q;this._prevPt=h};e.close=function(){if(2<this.line.length){var f=this._firstPt,g=this._prevPt;f.x===g.x&&f.y===g.y||this.lineTo(f.x,f.y);f=this.line;for(g=f.length;4<=g;)if(f[0].x===f[1].x&&f[0].x===
f[g-2].x||f[0].y===f[1].y&&f[0].y===f[g-2].y)f.pop(),f[0].x=f[g-2].x,f[0].y=f[g-2].y,--g;else break}};e.result=function(f=!0){this._pushLine();if(0===this.lines.length)return null;3===this.type&&f&&d.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};e.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();const f=this.lines,g=f.length;if(0===g)return null;const q=[];for(let h=0;h<g;h++)q.push({line:f[h],start:this.starts[h]||
0});return q};e._isIn=function(f,g){return f>=this.xmin&&f<=this.xmax&&g>=this.ymin&&g<=this.ymax};e._intersect=function(f,g){let q,h,n;if(g.x>=this.xmin&&g.x<=this.xmax)h=g.y<=this.ymin?this.ymin:this.ymax,n=(h-f.y)/(g.y-f.y),q=f.x+n*(g.x-f.x);else if(g.y>=this.ymin&&g.y<=this.ymax)q=g.x<=this.xmin?this.xmin:this.xmax,n=(q-f.x)/(g.x-f.x),h=f.y+n*(g.y-f.y);else{h=g.y<=this.ymin?this.ymin:this.ymax;q=g.x<=this.xmin?this.xmin:this.xmax;const u=(q-f.x)/(g.x-f.x),t=(h-f.y)/(g.y-f.y);u<t?(n=u,h=f.y+u*
(g.y-f.y)):(n=t,q=f.x+t*(g.x-f.x))}this._r=n;return new A.Point(q,h)};e._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};e._moveTo=function(f,g,q){3!==this.type?q&&(f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),
g=Math.round((g-(this.ymin+this.margin))*this.finalRatio),this.line.push(new A.Point(f,g))):(q||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),g<this.ymin&&(g=this.ymin),g>this.ymax&&(g=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),g=Math.round((g-(this.ymin+this.margin))*this.finalRatio),this.line.push(new A.Point(f,g)),this._is_v=this._is_h=!1)};e._lineTo=function(f,g,q){if(3!==this.type)if(q){f=Math.round((f-(this.xmin+this.margin))*this.finalRatio);g=Math.round((g-
(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(q=this.line[this.line.length-1],q.equals(f,g)))return;this.line.push(new A.Point(f,g))}else this.line&&0<this.line.length&&this._pushLine();else if(q||(f<this.xmin&&(f=this.xmin),f>this.xmax&&(f=this.xmax),g<this.ymin&&(g=this.ymin),g>this.ymax&&(g=this.ymax)),f=Math.round((f-(this.xmin+this.margin))*this.finalRatio),g=Math.round((g-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){q=this.line[this.line.length-
1];const h=q.x===f,n=q.y===g;h&&n||(this._is_h&&h?(q.x=f,q.y=g,q=this.line[this.line.length-2],q.x===f&&q.y===g?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(q=this.line[this.line.length-2],this._is_h=q.x===f,this._is_v=q.y===g)):(this._is_h=q.x===f,this._is_v=q.y===g)):this._is_v&&n?(q.x=f,q.y=g,q=this.line[this.line.length-2],q.x===f&&q.y===g?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(q=this.line[this.line.length-2],this._is_h=q.x===f,this._is_v=q.y===g)):(this._is_h=
q.x===f,this._is_v=q.y===g)):(this.line.push(new A.Point(f,g)),this._is_h=h,this._is_v=n))}else this.line.push(new A.Point(f,g))};return a}(),b=function(){function a(){}var e=a.prototype;e.setExtent=function(f){this._ratio=4096===f?1:4096/f};e.reset=function(f){this.lines=[];this.line=null};e.moveTo=function(f,g){this.line&&this.lines.push(this.line);this.line=[];const q=this._ratio;this.line.push(new A.Point(f*q,g*q))};e.lineTo=function(f,g){const q=this._ratio;this.line.push(new A.Point(f*q,g*q))};
e.close=function(){const f=this.line;f&&!f[0].isEqual(f[f.length-1])&&f.push(f[0])};e.result=function(){this.line&&this.lines.push(this.line);return 0===this.lines.length?null:this.lines};E._createClass(a,[{key:"validateTessellation",get:function(){return 1>this._ratio}}]);return a}(),d=function(){function a(){}a.simplify=function(e,f,g){if(g){var q=-f,h=e+f,n=-f,u=e+f;e=[];f=[];var t=g.length;for(let k=0;k<t;++k){const v=g[k];if(!v||2>v.length)continue;let p=v[0],r;const w=v.length;for(let l=1;l<
w;++l)r=v[l],p.x===r.x&&(p.x<=q&&(p.y>r.y?(e.push(k),e.push(l),e.push(0),e.push(-1)):(f.push(k),f.push(l),f.push(0),f.push(-1))),p.x>=h&&(p.y<r.y?(e.push(k),e.push(l),e.push(1),e.push(-1)):(f.push(k),f.push(l),f.push(1),f.push(-1)))),p.y===r.y&&(p.y<=n&&(p.x<r.x?(e.push(k),e.push(l),e.push(2),e.push(-1)):(f.push(k),f.push(l),f.push(2),f.push(-1))),p.y>=u&&(p.x>r.x?(e.push(k),e.push(l),e.push(3),e.push(-1)):(f.push(k),f.push(l),f.push(3),f.push(-1)))),p=r}0!==e.length&&0!==f.length&&(a.fillParent(g,
f,e),a.fillParent(g,e,f),q=[],a.calcDeltas(q,f,e),a.calcDeltas(q,e,f),a.addDeltas(q,g))}};a.fillParent=function(e,f,g){const q=g.length,h=f.length;for(let v=0;v<h;v+=4){var n=f[v],u=f[v+1];const p=f[v+2],r=e[n][u-1];n=e[n][u];u=8092;let w=-1;for(let l=0;l<q;l+=4){if(g[l+2]!==p)continue;var t=g[l];const x=g[l+1];var k=e[t][x-1];t=e[t][x];switch(p){case 0:case 1:C.between(r.y,k.y,t.y)&&C.between(n.y,k.y,t.y)&&(k=Math.abs(t.y-k.y),k<u&&(u=k,w=l));break;case 2:case 3:C.between(r.x,k.x,t.x)&&C.between(n.x,
k.x,t.x)&&(k=Math.abs(t.x-k.x),k<u&&(u=k,w=l))}}f[v+3]=w}};a.calcDeltas=function(e,f,g){const q=f.length;for(let h=0;h<q;h+=4){const n=a.calcDelta(h,f,g,[]);e.push(f[h]);e.push(f[h+1]);e.push(f[h+2]);e.push(n)}};a.calcDelta=function(e,f,g,q){e=f[e+3];if(-1===e)return 0;const h=q.length;if(1<h&&q[h-2]===e)return 0;q.push(e);return a.calcDelta(e,g,f,q)+1};a.addDeltas=function(e,f){const g=e.length;let q=0;for(var h=0;h<g;h+=4){var n=e[h+3];n>q&&(q=n)}for(h=0;h<g;h+=4){n=f[e[h]];const u=e[h+1],t=q-e[h+
3];switch(e[h+2]){case 0:n[u-1].x-=t;n[u].x-=t;1===u&&(n[n.length-1].x-=t);u===n.length-1&&(n[0].x-=t);break;case 1:n[u-1].x+=t;n[u].x+=t;1===u&&(n[n.length-1].x+=t);u===n.length-1&&(n[0].x+=t);break;case 2:n[u-1].y-=t;n[u].y-=t;1===u&&(n[n.length-1].y-=t);u===n.length-1&&(n[0].y-=t);break;case 3:n[u-1].y+=t,n[u].y+=t,1===u&&(n[n.length-1].y+=t),u===n.length-1&&(n[0].y+=t)}}};return a}();z.SimpleBuilder=b;z.TileClipper=c;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/Geometry":function(){define(["exports"],
function(z){let E=function(){function D(A,m){this.x=A;this.y=m}var C=D.prototype;C.clone=function(){return new D(this.x,this.y)};C.equals=function(A,m){return A===this.x&&m===this.y};C.isEqual=function(A){return A.x===this.x&&A.y===this.y};C.setCoords=function(A,m){this.x=A;this.y=m};C.normalize=function(){var A=this.x;const m=this.y;A=Math.sqrt(A*A+m*m);this.x/=A;this.y/=A};C.rightPerpendicular=function(){const A=this.x;this.x=this.y;this.y=-A};C.move=function(A,m){this.x+=A;this.y+=m};C.assign=
function(A){this.x=A.x;this.y=A.y};C.assignAdd=function(A,m){this.x=A.x+m.x;this.y=A.y+m.y};C.assignSub=function(A,m){this.x=A.x-m.x;this.y=A.y-m.y};C.rotate=function(A,m){const c=this.x,b=this.y;this.x=c*A-b*m;this.y=c*m+b*A};C.scale=function(A){this.x*=A;this.y*=A};C.length=function(){const A=this.x,m=this.y;return Math.sqrt(A*A+m*m)};D.distance=function(A,m){const c=m.x-A.x;A=m.y-A.y;return Math.sqrt(c*c+A*A)};D.add=function(A,m){return new D(A.x+m.x,A.y+m.y)};D.sub=function(A,m){return new D(A.x-
m.x,A.y-m.y)};return D}();z.Point=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/bufcut":function(){define(["exports"],function(z){function E(r,w,l,x,y,B,F){let G;l=0;for(let J=x,K=y-B;J<y;J+=B)l+=(r[K+w*B]-r[J+w*B])*(r[J+1+w*B]+r[K+1+w*B]),K=J;if(F===0<l)for(;x<y;x+=B)G=m(x+w*B,r[x+w*B],r[x+1+w*B],G);else for(y-=B;y>=x;y-=B)G=m(y+w*B,r[y+w*B],r[y+1+w*B],G);G&&n(G,G.next)&&(c(G),G=G.next);return G}function D(r,w=r){if(!r)return r;let l;do if(l=!1,r.steiner||
!n(r,r.next)&&0!==e(r.prev,r,r.next))r=r.next;else{c(r);r=w=r.prev;if(r===r.next)break;l=!0}while(l||r!==w);return w}function C(r,w,l,x,y,B,F,G){if(r){!G&&B&&(r=a(r,x,y,B));for(var J=r;r.prev!==r.next;){var K=r.prev,M=r.next;if(B)var R=A(r,x,y,B);else a:{R=r;var N=R.prev,I=R;const H=R.next;if(0<=e(N,I,H)){R=!1;break a}let Q=R.next.next;const W=Q;let aa=0;for(;Q!==R.prev&&(0===aa||Q!==W);){aa++;if(g(N.x,N.y,I.x,I.y,H.x,H.y,Q.x,Q.y)&&0<=e(Q.prev,Q,Q.next)){R=!1;break a}Q=Q.next}R=!0}if(R)w.push(K.index/
l+F),w.push(r.index/l+F),w.push(M.index/l+F),c(r),J=r=M.next;else if(r=M,r===J){if(!G)C(D(r),w,l,x,y,B,F,1);else if(1===G){G=w;J=l;K=F;M=r;do R=M.prev,N=M.next.next,!n(R,N)&&f(R,M,M.next,N)&&q(R,N)&&q(N,R)&&(G.push(R.index/J+K),G.push(M.index/J+K),G.push(N.index/J+K),c(M),c(M.next),M=r=N),M=M.next;while(M!==r);r=M;C(r,w,l,x,y,B,F,2)}else if(2===G)a:{G=r;do{for(J=G.next.next;J!==G.prev;){if(K=G.index!==J.index){R=R=R=void 0;K=G;M=J;if(R=K.next.index!==M.index&&K.prev.index!==M.index){b:{R=K;do{if(R.index!==
K.index&&R.next.index!==K.index&&R.index!==M.index&&R.next.index!==M.index&&f(R,R.next,K,M)){R=!0;break b}R=R.next}while(R!==K);R=!1}R=!R}if(R=R&&q(K,M)&&q(M,K)){R=K;N=!1;I=(K.x+M.x)/2;M=(K.y+M.y)/2;do R.y>M!==R.next.y>M&&R.next.y!==R.y&&I<(R.next.x-R.x)*(M-R.y)/(R.next.y-R.y)+R.x&&(N=!N),R=R.next;while(R!==K);R=N}K=R}if(K){r=t(G,J);G=D(G,G.next);r=D(r,r.next);C(G,w,l,x,y,B,F,0);C(r,w,l,x,y,B,F,0);break a}J=J.next}G=G.next}while(G!==r)}break}}}}function A(r,w,l,x){const y=r.prev,B=r.next;if(0<=e(y,
r,B))return!1;const F=y.x>r.x?y.x>B.x?y.x:B.x:r.x>B.x?r.x:B.x,G=y.y>r.y?y.y>B.y?y.y:B.y:r.y>B.y?r.y:B.y,J=h(y.x<r.x?y.x<B.x?y.x:B.x:r.x<B.x?r.x:B.x,y.y<r.y?y.y<B.y?y.y:B.y:r.y<B.y?r.y:B.y,w,l,x);w=h(F,G,w,l,x);l=r.prevZ;for(x=r.nextZ;l&&l.z>=J&&x&&x.z<=w;){if(l!==r.prev&&l!==r.next&&g(y.x,y.y,r.x,r.y,B.x,B.y,l.x,l.y)&&0<=e(l.prev,l,l.next))return!1;l=l.prevZ;if(x!==r.prev&&x!==r.next&&g(y.x,y.y,r.x,r.y,B.x,B.y,x.x,x.y)&&0<=e(x.prev,x,x.next))return!1;x=x.nextZ}for(;l&&l.z>=J;){if(l!==r.prev&&l!==
r.next&&g(y.x,y.y,r.x,r.y,B.x,B.y,l.x,l.y)&&0<=e(l.prev,l,l.next))return!1;l=l.prevZ}for(;x&&x.z<=w;){if(x!==r.prev&&x!==r.next&&g(y.x,y.y,r.x,r.y,B.x,B.y,x.x,x.y)&&0<=e(x.prev,x,x.next))return!1;x=x.nextZ}return!0}function m(r,w,l,x){r=k.create(r,w,l);x?(r.next=x.next,r.prev=x,x.next.prev=r,x.next=r):(r.prev=r,r.next=r);return r}function c(r){r.next.prev=r.prev;r.prev.next=r.next;r.prevZ&&(r.prevZ.nextZ=r.nextZ);r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function b(r){let w=r,l=r;do{if(w.x<l.x||w.x===l.x&&
w.y<l.y)l=w;w=w.next}while(w!==r);return l}function d(r,w){let l=w;const x=r.x,y=r.y;let B=-Infinity,F;do{if(y<=l.y&&y>=l.next.y&&l.next.y!==l.y){var G=l.x+(y-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(G<=x&&G>B){B=G;if(G===x){if(y===l.y)return l;if(y===l.next.y)return l.next}F=l.x<l.next.x?l:l.next}}l=l.next}while(l!==w);if(!F)return null;if(x===B)return F.prev;w=F;G=F.x;const J=F.y;let K=Infinity,M;for(l=F.next;l!==w;)x>=l.x&&l.x>=G&&x!==l.x&&g(y<J?x:B,y,G,J,y<J?B:x,y,l.x,l.y)&&(M=Math.abs(y-l.y)/(x-
l.x),(M<K||M===K&&l.x>F.x)&&q(l,r)&&(F=l,K=M)),l=l.next;return F}function a(r,w,l,x){for(var y;y!==r;y=y.next){y=y||r;null===y.z&&(y.z=h(y.x,y.y,w,l,x));if(y.prev.next!==y||y.next.prev!==y)return y.prev.next=y,y.next.prev=y,a(r,w,l,x);y.prevZ=y.prev;y.nextZ=y.next}r.prevZ.nextZ=null;r.prevZ=null;a:for(l=1;;){x=r;w=r=null;let B=0;for(;x;){B++;y=x;let F=0;for(;F<l&&y;F++)y=y.nextZ;let G=l;for(;0<F||0<G&&y;){let J;0===F?(J=y,y=y.nextZ,G--):0!==G&&y?x.z<=y.z?(J=x,x=x.nextZ,F--):(J=y,y=y.nextZ,G--):(J=
x,x=x.nextZ,F--);w?w.nextZ=J:r=J;J.prevZ=w;w=J}x=y}w.nextZ=null;l*=2;if(2>B)break a}return r}function e(r,w,l){return(w.y-r.y)*(l.x-w.x)-(w.x-r.x)*(l.y-w.y)}function f(r,w,l,x){return n(r,w)&&n(l,x)||n(r,x)&&n(l,w)?!0:0<e(r,w,l)!==0<e(r,w,x)&&0<e(l,x,r)!==0<e(l,x,w)}function g(r,w,l,x,y,B,F,G){return 0<=(y-F)*(w-G)-(r-F)*(B-G)&&0<=(r-F)*(x-G)-(l-F)*(w-G)&&0<=(l-F)*(B-G)-(y-F)*(x-G)}function q(r,w){return 0>e(r.prev,r,r.next)?0<=e(r,w,r.next)&&0<=e(r,r.prev,w):0>e(r,w,r.prev)||0>e(r,r.next,w)}function h(r,
w,l,x,y){r=32767*(r-l)*y;w=32767*(w-x)*y;r=(r|r<<8)&16711935;r=(r|r<<4)&252645135;r=(r|r<<2)&858993459;w=(w|w<<8)&16711935;w=(w|w<<4)&252645135;w=(w|w<<2)&858993459;return(r|r<<1)&1431655765|((w|w<<1)&1431655765)<<1}function n(r,w){return r.x===w.x&&r.y===w.y}function u(r,w){return r.x-w.x}function t(r,w){const l=k.create(r.index,r.x,r.y),x=k.create(w.index,w.x,w.y),y=r.next,B=w.prev;r.next=w;w.prev=r;l.next=y;y.prev=l;x.next=l;l.prev=x;B.next=x;x.prev=B;return x}let k=function(){function r(){this.y=
this.x=this.index=0;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}r.create=function(w,l,x){const y=v[p++];y.index=w;y.x=l;y.y=x;y.prev=null;y.next=null;y.z=null;y.prevZ=null;y.nextZ=null;y.steiner=!1;return y};return r}();const v=[];let p=0;for(let r=0;8096>r;r++)v.push(new k);z.bufcut=function(r,w,l,x,y,B,F){p=0;var G=(x-l)*B,J=y&&y.length;const K=J?(y[0]-l)*B:G;var M=E(w,l,x,0,K,B,!0);if(M&&M.next!==M.prev){var R;if(J){J=[];for(let Q=0,W=y.length;Q<W;Q++){const aa=E(w,l,
x,y[Q]*B,Q<W-1?y[Q+1]*B:x*B,B,!1);aa===aa.next&&(aa.steiner=!0);J.push(b(aa))}J.sort(u);for(var N of J){x=N;y=M;if(y=d(x,y))x=t(y,x),D(x,x.next);M=D(M,M.next)}}if(G>80*B){var I=G=w[l*B];var H=R=w[1+l*B];for(N=B;N<K;N+=B)x=w[N+l*B],y=w[N+1+l*B],I=Math.min(I,x),H=Math.min(H,y),G=Math.max(G,x),R=Math.max(R,y);R=Math.max(G-I,R-H);R=0!==R?1/R:0}C(M,r,B,I,H,R,F,0)}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["../../../../../core/Logger",
"../../../../../chunks/_commonjsHelpers"],function(z,E){var D=E.createCommonjsModule(function(A){(function(m){m=m();void 0!==m&&(A.exports=m)})(function(){var m={DEBUG:!1,assert:function(c,b){if(m.DEBUG&&!c)throw Error("Assertion failed"+(b?": "+b:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},
primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,
GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},geom:{}};m.geom.vertEq=function(c,b){return c.s===b.s&&c.t===b.t};m.geom.vertLeq=function(c,b){return c.s<b.s||c.s===b.s&&c.t<=b.t};m.geom.edgeEval=function(c,b,d){m.assert(m.geom.vertLeq(c,b)&&m.geom.vertLeq(b,d));var a=b.s-c.s,e=d.s-
b.s;return 0<a+e?a<e?b.t-c.t+a/(a+e)*(c.t-d.t):b.t-d.t+e/(a+e)*(d.t-c.t):0};m.geom.edgeSign=function(c,b,d){m.assert(m.geom.vertLeq(c,b)&&m.geom.vertLeq(b,d));var a=b.s-c.s,e=d.s-b.s;return 0<a+e?(b.t-d.t)*a+(b.t-c.t)*e:0};m.geom.transLeq=function(c,b){return c.t<b.t||c.t===b.t&&c.s<=b.s};m.geom.transEval=function(c,b,d){m.assert(m.geom.transLeq(c,b)&&m.geom.transLeq(b,d));var a=b.t-c.t,e=d.t-b.t;return 0<a+e?a<e?b.s-c.s+a/(a+e)*(c.s-d.s):b.s-d.s+e/(a+e)*(d.s-c.s):0};m.geom.transSign=function(c,b,
d){m.assert(m.geom.transLeq(c,b)&&m.geom.transLeq(b,d));var a=b.t-c.t,e=d.t-b.t;return 0<a+e?(b.s-d.s)*a+(b.s-c.s)*e:0};m.geom.edgeGoesLeft=function(c){return m.geom.vertLeq(c.dst(),c.org)};m.geom.edgeGoesRight=function(c){return m.geom.vertLeq(c.org,c.dst())};m.geom.vertL1dist=function(c,b){return Math.abs(c.s-b.s)+Math.abs(c.t-b.t)};m.geom.vertCCW=function(c,b,d){return 0<=c.s*(b.t-d.t)+b.s*(d.t-c.t)+d.s*(c.t-b.t)};m.geom.interpolate_=function(c,b,d,a){c=0>c?0:c;d=0>d?0:d;return c<=d?0===d?(b+a)/
2:b+c/(c+d)*(a-b):a+d/(c+d)*(b-a)};m.geom.edgeIntersect=function(c,b,d,a,e){if(!m.geom.vertLeq(c,b)){var f=c;c=b;b=f}m.geom.vertLeq(d,a)||(f=d,d=a,a=f);m.geom.vertLeq(c,d)||(f=c,c=d,d=f,f=b,b=a,a=f);if(m.geom.vertLeq(d,b))if(m.geom.vertLeq(b,a)){f=m.geom.edgeEval(c,d,b);var g=m.geom.edgeEval(d,b,a);0>f+g&&(f=-f,g=-g);e.s=m.geom.interpolate_(f,d.s,g,b.s)}else f=m.geom.edgeSign(c,d,b),g=-m.geom.edgeSign(c,a,b),0>f+g&&(f=-f,g=-g),e.s=m.geom.interpolate_(f,d.s,g,a.s);else e.s=(d.s+b.s)/2;m.geom.transLeq(c,
b)||(f=c,c=b,b=f);m.geom.transLeq(d,a)||(f=d,d=a,a=f);m.geom.transLeq(c,d)||(f=c,c=d,d=f,f=b,b=a,a=f);m.geom.transLeq(d,b)?m.geom.transLeq(b,a)?(f=m.geom.transEval(c,d,b),g=m.geom.transEval(d,b,a),0>f+g&&(f=-f,g=-g),e.t=m.geom.interpolate_(f,d.t,g,b.t)):(f=m.geom.transSign(c,d,b),g=-m.geom.transSign(c,a,b),0>f+g&&(f=-f,g=-g),e.t=m.geom.interpolate_(f,d.t,g,a.t)):e.t=(d.t+b.t)/2};m.mesh={};m.mesh.makeEdge=function(c){var b=m.mesh.makeEdgePair_(c.eHead);m.mesh.makeVertex_(b,c.vHead);m.mesh.makeVertex_(b.sym,
c.vHead);m.mesh.makeFace_(b,c.fHead);return b};m.mesh.meshSplice=function(c,b){var d=!1,a=!1;c!==b&&(b.org!==c.org&&(a=!0,m.mesh.killVertex_(b.org,c.org)),b.lFace!==c.lFace&&(d=!0,m.mesh.killFace_(b.lFace,c.lFace)),m.mesh.splice_(b,c),a||(m.mesh.makeVertex_(b,c.org),c.org.anEdge=c),d||(m.mesh.makeFace_(b,c.lFace),c.lFace.anEdge=c))};m.mesh.deleteEdge=function(c){var b=c.sym,d=!1;c.lFace!==c.rFace()&&(d=!0,m.mesh.killFace_(c.lFace,c.rFace()));c.oNext===c?m.mesh.killVertex_(c.org,null):(c.rFace().anEdge=
c.oPrev(),c.org.anEdge=c.oNext,m.mesh.splice_(c,c.oPrev()),d||m.mesh.makeFace_(c,c.lFace));b.oNext===b?(m.mesh.killVertex_(b.org,null),m.mesh.killFace_(b.lFace,null)):(c.lFace.anEdge=b.oPrev(),b.org.anEdge=b.oNext,m.mesh.splice_(b,b.oPrev()));m.mesh.killEdge_(c)};m.mesh.addEdgeVertex=function(c){var b=m.mesh.makeEdgePair_(c),d=b.sym;m.mesh.splice_(b,c.lNext);b.org=c.dst();m.mesh.makeVertex_(d,b.org);b.lFace=d.lFace=c.lFace;return b};m.mesh.splitEdge=function(c){var b=m.mesh.addEdgeVertex(c).sym;m.mesh.splice_(c.sym,
c.sym.oPrev());m.mesh.splice_(c.sym,b);c.sym.org=b.org;b.dst().anEdge=b.sym;b.sym.lFace=c.rFace();b.winding=c.winding;b.sym.winding=c.sym.winding;return b};m.mesh.connect=function(c,b){var d=!1,a=m.mesh.makeEdgePair_(c),e=a.sym;b.lFace!==c.lFace&&(d=!0,m.mesh.killFace_(b.lFace,c.lFace));m.mesh.splice_(a,c.lNext);m.mesh.splice_(e,b);a.org=c.dst();e.org=b.org;a.lFace=e.lFace=c.lFace;c.lFace.anEdge=e;d||m.mesh.makeFace_(a,c.lFace);return a};m.mesh.zapFace=function(c){var b=c.anEdge,d=b.lNext;do{var a=
d;d=a.lNext;a.lFace=null;if(null===a.rFace()){a.oNext===a?m.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,m.mesh.splice_(a,a.oPrev()));var e=a.sym;e.oNext===e?m.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,m.mesh.splice_(e,e.oPrev()));m.mesh.killEdge_(a)}}while(a!==b);b=c.prev;c=c.next;c.prev=b;b.next=c};m.mesh.meshUnion=function(c,b){var d=c.fHead,a=c.vHead,e=c.eHead,f=b.fHead,g=b.vHead;b=b.eHead;f.next!==f&&(d.prev.next=f.next,f.next.prev=d.prev,f.prev.next=d,d.prev=f.prev);g.next!==
g&&(a.prev.next=g.next,g.next.prev=a.prev,g.prev.next=a,a.prev=g.prev);b.next!==b&&(e.sym.next.sym.next=b.next,b.next.sym.next=e.sym.next,b.sym.next.sym.next=e,e.sym.next=b.sym.next);return c};m.mesh.deleteMesh=function(c){};m.mesh.makeEdgePair_=function(c){var b=new m.GluHalfEdge,d=new m.GluHalfEdge,a=c.sym.next;d.next=a;a.sym.next=b;b.next=c;c.sym.next=d;b.sym=d;b.oNext=b;b.lNext=d;d.sym=b;d.oNext=d;return d.lNext=b};m.mesh.splice_=function(c,b){var d=c.oNext,a=b.oNext;d.sym.lNext=b;a.sym.lNext=
c;c.oNext=a;b.oNext=d};m.mesh.makeVertex_=function(c,b){var d=b.prev,a=new m.GluVertex(b,d);d.next=a;b.prev=a;b=a.anEdge=c;do b.org=a,b=b.oNext;while(b!==c)};m.mesh.makeFace_=function(c,b){var d=b.prev,a=new m.GluFace(b,d);d.next=a;b.prev=a;a.anEdge=c;a.inside=b.inside;b=c;do b.lFace=a,b=b.lNext;while(b!==c)};m.mesh.killEdge_=function(c){var b=c.next;c=c.sym.next;b.sym.next=c;c.sym.next=b};m.mesh.killVertex_=function(c,b){var d=c.anEdge,a=d;do a.org=b,a=a.oNext;while(a!==d);b=c.prev;c=c.next;c.prev=
b;b.next=c};m.mesh.killFace_=function(c,b){var d=c.anEdge,a=d;do a.lFace=b,a=a.lNext;while(a!==d);b=c.prev;c=c.next;c.prev=b;b.next=c};m.normal={};m.normal.S_UNIT_X_=1;m.normal.S_UNIT_Y_=0;m.normal.projectPolygon=function(c,b,d,a){var e=!1,f=[b,d,a];0===b&&0===d&&0===a&&(m.normal.computeNormal_(c,f),e=!0);d=m.normal.longAxis_(f);b=c.mesh.vHead;if(m.TRUE_PROJECT){m.normal.normalize_(f);a=[0,0,0];var g=[0,0,0];a[d]=0;a[(d+1)%3]=m.normal.S_UNIT_X_;a[(d+2)%3]=m.normal.S_UNIT_Y_;d=m.normal.dot_(a,f);a[0]-=
d*f[0];a[1]-=d*f[1];a[2]-=d*f[2];m.normal.normalize_(a);g[0]=f[1]*a[2]-f[2]*a[1];g[1]=f[2]*a[0]-f[0]*a[2];g[2]=f[0]*a[1]-f[1]*a[0];m.normal.normalize_(g);for(f=b.next;f!==b;f=f.next)f.s=m.normal.dot_(f.coords,a),f.t=m.normal.dot_(f.coords,g)}else for(a=(d+1)%3,g=(d+2)%3,d=0<f[d]?1:-1,f=b.next;f!==b;f=f.next)f.s=f.coords[a],f.t=d*f.coords[g];e&&m.normal.checkOrientation_(c)};m.normal.dot_=function(c,b){return c[0]*b[0]+c[1]*b[1]+c[2]*b[2]};m.normal.normalize_=function(c){var b=c[0]*c[0]+c[1]*c[1]+
c[2]*c[2];m.assert(0<b);b=Math.sqrt(b);c[0]/=b;c[1]/=b;c[2]/=b};m.normal.longAxis_=function(c){var b=0;Math.abs(c[1])>Math.abs(c[0])&&(b=1);Math.abs(c[2])>Math.abs(c[b])&&(b=2);return b};m.normal.computeNormal_=function(c,b){var d=[-2*m.GLU_TESS_MAX_COORD,-2*m.GLU_TESS_MAX_COORD,-2*m.GLU_TESS_MAX_COORD],a=[2*m.GLU_TESS_MAX_COORD,2*m.GLU_TESS_MAX_COORD,2*m.GLU_TESS_MAX_COORD],e=[],f=[],g;c=c.mesh.vHead;for(g=c.next;g!==c;g=g.next)for(var q=0;3>q;++q){var h=g.coords[q];h<a[q]&&(a[q]=h,f[q]=g);h>d[q]&&
(d[q]=h,e[q]=g)}g=0;d[1]-a[1]>d[0]-a[0]&&(g=1);d[2]-a[2]>d[g]-a[g]&&(g=2);if(a[g]>=d[g])b[0]=0,b[1]=0,b[2]=1;else{d=0;a=f[g];e=e[g];f=[0,0,0];a=[a.coords[0]-e.coords[0],a.coords[1]-e.coords[1],a.coords[2]-e.coords[2]];q=[0,0,0];for(g=c.next;g!==c;g=g.next)q[0]=g.coords[0]-e.coords[0],q[1]=g.coords[1]-e.coords[1],q[2]=g.coords[2]-e.coords[2],f[0]=a[1]*q[2]-a[2]*q[1],f[1]=a[2]*q[0]-a[0]*q[2],f[2]=a[0]*q[1]-a[1]*q[0],h=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],h>d&&(d=h,b[0]=f[0],b[1]=f[1],b[2]=f[2]);0>=d&&(b[0]=
b[1]=b[2]=0,b[m.normal.longAxis_(a)]=1)}};m.normal.checkOrientation_=function(c){for(var b=0,d=c.mesh.fHead,a=d.next;a!==d;a=a.next){var e=a.anEdge;if(!(0>=e.winding)){do b+=(e.org.s-e.dst().s)*(e.org.t+e.dst().t),e=e.lNext;while(e!==a.anEdge)}}if(0>b)for(c=c.mesh.vHead,b=c.next;b!==c;b=b.next)b.t=-b.t};m.render={};m.render.renderMesh=function(c,b,d){for(var a=!1,e=-1,f=b.fHead.prev;f!==b.fHead;f=f.prev)if(f.inside){a||(c.callBeginCallback(m.primitiveType.GL_TRIANGLES),a=!0);var g=f.anEdge;m.assert(g.lNext.lNext.lNext===
g,"renderMesh called with non-triangulated mesh");do{if(d){var q=g.rFace().inside?0:1;e!==q&&(e=q,c.callEdgeFlagCallback(!!e))}c.callVertexCallback(g.org.data);g=g.lNext}while(g!==f.anEdge)}a&&c.callEndCallback()};m.render.renderBoundary=function(c,b){for(var d=b.fHead.next;d!==b.fHead;d=d.next)if(d.inside){c.callBeginCallback(m.primitiveType.GL_LINE_LOOP);var a=d.anEdge;do c.callVertexCallback(a.org.data),a=a.lNext;while(a!==d.anEdge);c.callEndCallback()}};m.sweep={};m.sweep.SENTINEL_COORD_=4*m.GLU_TESS_MAX_COORD;
m.sweep.TOLERANCE_NONZERO_=!1;m.sweep.computeInterior=function(c){c.fatalError=!1;m.sweep.removeDegenerateEdges_(c);m.sweep.initPriorityQ_(c);m.sweep.initEdgeDict_(c);for(var b;null!==(b=c.pq.extractMin());){for(;;){var d=c.pq.minimum();if(null===d||!m.geom.vertEq(d,b))break;d=c.pq.extractMin();m.sweep.spliceMergeVertices_(c,b.anEdge,d.anEdge)}m.sweep.sweepEvent_(c,b)}b=c.dict.getMin().getKey();c.event=b.eUp.org;m.sweep.doneEdgeDict_(c);m.sweep.donePriorityQ_(c);m.sweep.removeDegenerateFaces_(c.mesh);
c.mesh.checkMesh()};m.sweep.addWinding_=function(c,b){c.winding+=b.winding;c.sym.winding+=b.sym.winding};m.sweep.edgeLeq_=function(c,b,d){c=c.event;b=b.eUp;d=d.eUp;if(b.dst()===c)return d.dst()===c?m.geom.vertLeq(b.org,d.org)?0>=m.geom.edgeSign(d.dst(),b.org,d.org):0<=m.geom.edgeSign(b.dst(),d.org,b.org):0>=m.geom.edgeSign(d.dst(),c,d.org);if(d.dst()===c)return 0<=m.geom.edgeSign(b.dst(),c,b.org);b=m.geom.edgeEval(b.dst(),c,b.org);c=m.geom.edgeEval(d.dst(),c,d.org);return b>=c};m.sweep.deleteRegion_=
function(c,b){b.fixUpperEdge&&m.assert(0===b.eUp.winding);b.eUp.activeRegion=null;c.dict.deleteNode(b.nodeUp);b.nodeUp=null};m.sweep.fixUpperEdge_=function(c,b){m.assert(c.fixUpperEdge);m.mesh.deleteEdge(c.eUp);c.fixUpperEdge=!1;c.eUp=b;b.activeRegion=c};m.sweep.topLeftRegion_=function(c){var b=c.eUp.org;do c=c.regionAbove();while(c.eUp.org===b);c.fixUpperEdge&&(b=m.mesh.connect(c.regionBelow().eUp.sym,c.eUp.lNext),m.sweep.fixUpperEdge_(c,b),c=c.regionAbove());return c};m.sweep.topRightRegion_=function(c){var b=
c.eUp.dst();do c=c.regionAbove();while(c.eUp.dst()===b);return c};m.sweep.addRegionBelow_=function(c,b,d){var a=new m.ActiveRegion;a.eUp=d;a.nodeUp=c.dict.insertBefore(b.nodeUp,a);return d.activeRegion=a};m.sweep.isWindingInside_=function(c,b){switch(c.windingRule){case m.windingRule.GLU_TESS_WINDING_ODD:return 0!==(b&1);case m.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==b;case m.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<b;case m.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>b;case m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=
b||-2>=b}m.assert(!1);return!1};m.sweep.computeWinding_=function(c,b){b.windingNumber=b.regionAbove().windingNumber+b.eUp.winding;b.inside=m.sweep.isWindingInside_(c,b.windingNumber)};m.sweep.finishRegion_=function(c,b){var d=b.eUp,a=d.lFace;a.inside=b.inside;a.anEdge=d;m.sweep.deleteRegion_(c,b)};m.sweep.finishLeftRegions_=function(c,b,d){var a=b;for(b=b.eUp;a!==d;){a.fixUpperEdge=!1;var e=a.regionBelow(),f=e.eUp;if(f.org!==b.org){if(!e.fixUpperEdge){m.sweep.finishRegion_(c,a);break}f=m.mesh.connect(b.lPrev(),
f.sym);m.sweep.fixUpperEdge_(e,f)}b.oNext!==f&&(m.mesh.meshSplice(f.oPrev(),f),m.mesh.meshSplice(b,f));m.sweep.finishRegion_(c,a);b=e.eUp;a=e}return b};m.sweep.addRightEdges_=function(c,b,d,a,e,f){var g=!0;do m.assert(m.geom.vertLeq(d.org,d.dst())),m.sweep.addRegionBelow_(c,b,d.sym),d=d.oNext;while(d!==a);for(null===e&&(e=b.regionBelow().eUp.rPrev());;){a=b.regionBelow();d=a.eUp.sym;if(d.org!==e.org)break;d.oNext!==e&&(m.mesh.meshSplice(d.oPrev(),d),m.mesh.meshSplice(e.oPrev(),d));a.windingNumber=
b.windingNumber-d.winding;a.inside=m.sweep.isWindingInside_(c,a.windingNumber);b.dirty=!0;!g&&m.sweep.checkForRightSplice_(c,b)&&(m.sweep.addWinding_(d,e),m.sweep.deleteRegion_(c,b),m.mesh.deleteEdge(e));g=!1;b=a;e=d}b.dirty=!0;m.assert(b.windingNumber-d.winding===a.windingNumber);f&&m.sweep.walkDirtyRegions_(c,b)};m.sweep.callCombine_=function(c,b,d,a,e){var f=[b.coords[0],b.coords[1],b.coords[2]];b.data=null;b.data=c.callCombineCallback(f,d,a);null===b.data&&(e?c.fatalError||(c.callErrorCallback(m.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),
c.fatalError=!0):b.data=d[0])};m.sweep.spliceMergeVertices_=function(c,b,d){var a=[null,null,null,null];a[0]=b.org.data;a[1]=d.org.data;m.sweep.callCombine_(c,b.org,a,[.5,.5,0,0],!1);m.mesh.meshSplice(b,d)};m.sweep.vertexWeights_=function(c,b,d,a,e){var f=m.geom.vertL1dist(b,c),g=m.geom.vertL1dist(d,c),q=e+1;a[e]=.5*g/(f+g);a[q]=.5*f/(f+g);c.coords[0]+=a[e]*b.coords[0]+a[q]*d.coords[0];c.coords[1]+=a[e]*b.coords[1]+a[q]*d.coords[1];c.coords[2]+=a[e]*b.coords[2]+a[q]*d.coords[2]};m.sweep.getIntersectData_=
function(c,b,d,a,e,f){var g=[0,0,0,0],q=[d.data,a.data,e.data,f.data];b.coords[0]=b.coords[1]=b.coords[2]=0;m.sweep.vertexWeights_(b,d,a,g,0);m.sweep.vertexWeights_(b,e,f,g,2);m.sweep.callCombine_(c,b,q,g,!0)};m.sweep.checkForRightSplice_=function(c,b){var d=b.regionBelow(),a=b.eUp,e=d.eUp;if(m.geom.vertLeq(a.org,e.org)){if(0<m.geom.edgeSign(e.dst(),a.org,e.org))return!1;m.geom.vertEq(a.org,e.org)?a.org!==e.org&&(c.pq.remove(a.org.pqHandle),m.sweep.spliceMergeVertices_(c,e.oPrev(),a)):(m.mesh.splitEdge(e.sym),
m.mesh.meshSplice(a,e.oPrev()),b.dirty=d.dirty=!0)}else{if(0>m.geom.edgeSign(a.dst(),e.org,a.org))return!1;b.regionAbove().dirty=b.dirty=!0;m.mesh.splitEdge(a.sym);m.mesh.meshSplice(e.oPrev(),a)}return!0};m.sweep.checkForLeftSplice_=function(c,b){var d=b.regionBelow();c=b.eUp;var a=d.eUp;m.assert(!m.geom.vertEq(c.dst(),a.dst()));if(m.geom.vertLeq(c.dst(),a.dst())){if(0>m.geom.edgeSign(c.dst(),a.dst(),c.org))return!1;b.regionAbove().dirty=b.dirty=!0;d=m.mesh.splitEdge(c);m.mesh.meshSplice(a.sym,d);
d.lFace.inside=b.inside}else{if(0<m.geom.edgeSign(a.dst(),c.dst(),a.org))return!1;b.dirty=d.dirty=!0;d=m.mesh.splitEdge(a);m.mesh.meshSplice(c.lNext,a.sym);d.rFace().inside=b.inside}return!0};m.sweep.checkForIntersect_=function(c,b){var d=b.regionBelow(),a=b.eUp,e=d.eUp,f=a.org,g=e.org,q=a.dst(),h=e.dst(),n=new m.GluVertex;m.assert(!m.geom.vertEq(h,q));m.assert(0>=m.geom.edgeSign(q,c.event,f));m.assert(0<=m.geom.edgeSign(h,c.event,g));m.assert(f!==c.event&&g!==c.event);m.assert(!b.fixUpperEdge&&!d.fixUpperEdge);
if(f===g||Math.min(f.t,q.t)>Math.max(g.t,h.t))return!1;if(m.geom.vertLeq(f,g)){if(0<m.geom.edgeSign(h,f,g))return!1}else if(0>m.geom.edgeSign(q,g,f))return!1;m.geom.edgeIntersect(q,f,h,g,n);m.assert(Math.min(f.t,q.t)<=n.t);m.assert(n.t<=Math.max(g.t,h.t));m.assert(Math.min(h.s,q.s)<=n.s);m.assert(n.s<=Math.max(g.s,f.s));m.geom.vertLeq(n,c.event)&&(n.s=c.event.s,n.t=c.event.t);var u=m.geom.vertLeq(f,g)?f:g;m.geom.vertLeq(u,n)&&(n.s=u.s,n.t=u.t);if(m.geom.vertEq(n,f)||m.geom.vertEq(n,g))return m.sweep.checkForRightSplice_(c,
b),!1;if(!m.geom.vertEq(q,c.event)&&0<=m.geom.edgeSign(q,c.event,n)||!m.geom.vertEq(h,c.event)&&0>=m.geom.edgeSign(h,c.event,n)){if(h===c.event)return m.mesh.splitEdge(a.sym),m.mesh.meshSplice(e.sym,a),b=m.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,m.sweep.finishLeftRegions_(c,b.regionBelow(),d),m.sweep.addRightEdges_(c,b,a.oPrev(),a,a,!0),!0;if(q===c.event)return m.mesh.splitEdge(e.sym),m.mesh.meshSplice(a.lNext,e.oPrev()),d=b,b=m.sweep.topRightRegion_(b),f=b.regionBelow().eUp.rPrev(),d.eUp=e.oPrev(),
e=m.sweep.finishLeftRegions_(c,d,null),m.sweep.addRightEdges_(c,b,e.oNext,a.rPrev(),f,!0),!0;0<=m.geom.edgeSign(q,c.event,n)&&(b.regionAbove().dirty=b.dirty=!0,m.mesh.splitEdge(a.sym),a.org.s=c.event.s,a.org.t=c.event.t);0>=m.geom.edgeSign(h,c.event,n)&&(b.dirty=d.dirty=!0,m.mesh.splitEdge(e.sym),e.org.s=c.event.s,e.org.t=c.event.t);return!1}m.mesh.splitEdge(a.sym);m.mesh.splitEdge(e.sym);m.mesh.meshSplice(e.oPrev(),a);a.org.s=n.s;a.org.t=n.t;a.org.pqHandle=c.pq.insert(a.org);m.sweep.getIntersectData_(c,
a.org,f,q,g,h);b.regionAbove().dirty=b.dirty=d.dirty=!0;return!1};m.sweep.walkDirtyRegions_=function(c,b){for(var d=b.regionBelow();;){for(;d.dirty;)b=d,d=d.regionBelow();if(!b.dirty&&(d=b,b=b.regionAbove(),null===b||!b.dirty))break;b.dirty=!1;var a=b.eUp,e=d.eUp;a.dst()!==e.dst()&&m.sweep.checkForLeftSplice_(c,b)&&(d.fixUpperEdge?(m.sweep.deleteRegion_(c,d),m.mesh.deleteEdge(e),d=b.regionBelow(),e=d.eUp):b.fixUpperEdge&&(m.sweep.deleteRegion_(c,b),m.mesh.deleteEdge(a),b=d.regionAbove(),a=b.eUp));
if(a.org!==e.org)if(a.dst()===e.dst()||b.fixUpperEdge||d.fixUpperEdge||a.dst()!==c.event&&e.dst()!==c.event)m.sweep.checkForRightSplice_(c,b);else if(m.sweep.checkForIntersect_(c,b))break;a.org===e.org&&a.dst()===e.dst()&&(m.sweep.addWinding_(e,a),m.sweep.deleteRegion_(c,b),m.mesh.deleteEdge(a),b=d.regionAbove())}};m.sweep.connectRightVertex_=function(c,b,d){var a=d.oNext,e=b.regionBelow(),f=b.eUp,g=e.eUp,q=!1;f.dst()!==g.dst()&&m.sweep.checkForIntersect_(c,b);m.geom.vertEq(f.org,c.event)&&(m.mesh.meshSplice(a.oPrev(),
f),b=m.sweep.topLeftRegion_(b),a=b.regionBelow().eUp,m.sweep.finishLeftRegions_(c,b.regionBelow(),e),q=!0);m.geom.vertEq(g.org,c.event)&&(m.mesh.meshSplice(d,g.oPrev()),d=m.sweep.finishLeftRegions_(c,e,null),q=!0);q?m.sweep.addRightEdges_(c,b,d.oNext,a,a,!0):(a=m.geom.vertLeq(g.org,f.org)?g.oPrev():f,a=m.mesh.connect(d.lPrev(),a),m.sweep.addRightEdges_(c,b,a,a.oNext,a.oNext,!1),a.sym.activeRegion.fixUpperEdge=!0,m.sweep.walkDirtyRegions_(c,b))};m.sweep.connectLeftDegenerate_=function(c,b,d){var a=
b.eUp;if(m.geom.vertEq(a.org,d))m.assert(m.sweep.TOLERANCE_NONZERO_),m.sweep.TOLERANCE_NONZERO_&&m.sweep.spliceMergeVertices_(c,a,d.anEdge);else if(m.geom.vertEq(a.dst(),d)){if(m.assert(m.sweep.TOLERANCE_NONZERO_),m.sweep.TOLERANCE_NONZERO_){b=m.sweep.topRightRegion_(b);a=b.regionBelow();var e=a.eUp.sym,f=e.oNext,g=f;a.fixUpperEdge&&(m.assert(f!==e),m.sweep.deleteRegion_(c,a),m.mesh.deleteEdge(e),e=f.oPrev());m.mesh.meshSplice(d.anEdge,e);m.geom.edgeGoesLeft(f)||(f=null);m.sweep.addRightEdges_(c,
b,e.oNext,g,f,!0)}}else m.mesh.splitEdge(a.sym),b.fixUpperEdge&&(m.mesh.deleteEdge(a.oNext),b.fixUpperEdge=!1),m.mesh.meshSplice(d.anEdge,a),m.sweep.sweepEvent_(c,d)};m.sweep.connectLeftVertex_=function(c,b){var d=new m.ActiveRegion;d.eUp=b.anEdge.sym;d=c.dict.search(d).getKey();var a=d.regionBelow(),e=d.eUp,f=a.eUp;0===m.geom.edgeSign(e.dst(),b,e.org)?m.sweep.connectLeftDegenerate_(c,d,b):(a=m.geom.vertLeq(f.dst(),e.dst())?d:a,d.inside||a.fixUpperEdge?(e=a===d?m.mesh.connect(b.anEdge.sym,e.lNext):
m.mesh.connect(f.dNext(),b.anEdge).sym,a.fixUpperEdge?m.sweep.fixUpperEdge_(a,e):m.sweep.computeWinding_(c,m.sweep.addRegionBelow_(c,d,e)),m.sweep.sweepEvent_(c,b)):m.sweep.addRightEdges_(c,d,b.anEdge,b.anEdge,null,!0))};m.sweep.sweepEvent_=function(c,b){c.event=b;for(var d=b.anEdge;null===d.activeRegion;)if(d=d.oNext,d===b.anEdge){m.sweep.connectLeftVertex_(c,b);return}b=m.sweep.topLeftRegion_(d.activeRegion);var a=b.regionBelow();d=a.eUp;a=m.sweep.finishLeftRegions_(c,a,null);a.oNext===d?m.sweep.connectRightVertex_(c,
b,a):m.sweep.addRightEdges_(c,b,a.oNext,d,d,!0)};m.sweep.addSentinel_=function(c,b){var d=new m.ActiveRegion,a=m.mesh.makeEdge(c.mesh);a.org.s=m.sweep.SENTINEL_COORD_;a.org.t=b;a.dst().s=-m.sweep.SENTINEL_COORD_;a.dst().t=b;c.event=a.dst();d.eUp=a;d.windingNumber=0;d.inside=!1;d.fixUpperEdge=!1;d.sentinel=!0;d.dirty=!1;d.nodeUp=c.dict.insert(d)};m.sweep.initEdgeDict_=function(c){c.dict=new m.Dict(c,m.sweep.edgeLeq_);m.sweep.addSentinel_(c,-m.sweep.SENTINEL_COORD_);m.sweep.addSentinel_(c,m.sweep.SENTINEL_COORD_)};
m.sweep.doneEdgeDict_=function(c){for(var b=0,d;null!==(d=c.dict.getMin().getKey());)d.sentinel||(m.assert(d.fixUpperEdge),m.assert(1===++b)),m.assert(0===d.windingNumber),m.sweep.deleteRegion_(c,d);c.dict=null};m.sweep.removeDegenerateEdges_=function(c){for(var b=c.mesh.eHead,d,a=b.next;a!==b;a=d){d=a.next;var e=a.lNext;m.geom.vertEq(a.org,a.dst())&&a.lNext.lNext!==a&&(m.sweep.spliceMergeVertices_(c,e,a),m.mesh.deleteEdge(a),a=e,e=a.lNext);if(e.lNext===a){if(e!==a){if(e===d||e===d.sym)d=d.next;m.mesh.deleteEdge(e)}if(a===
d||a===d.sym)d=d.next;m.mesh.deleteEdge(a)}}};m.sweep.initPriorityQ_=function(c){var b=new m.PriorityQ;c.pq=b;c=c.mesh.vHead;var d;for(d=c.next;d!==c;d=d.next)d.pqHandle=b.insert(d);b.init()};m.sweep.donePriorityQ_=function(c){c.pq.deleteQ();c.pq=null};m.sweep.removeDegenerateFaces_=function(c){for(var b,d=c.fHead.next;d!==c.fHead;d=b)b=d.next,d=d.anEdge,m.assert(d.lNext!==d),d.lNext.lNext===d&&(m.sweep.addWinding_(d.oNext,d),m.mesh.deleteEdge(d))};m.tessmono={};m.tessmono.tessellateMonoRegion_=function(c){c=
c.anEdge;for(m.assert(c.lNext!==c&&c.lNext.lNext!==c);m.geom.vertLeq(c.dst(),c.org);c=c.lPrev());for(;m.geom.vertLeq(c.org,c.dst());c=c.lNext);for(var b=c.lPrev(),d;c.lNext!==b;)if(m.geom.vertLeq(c.dst(),b.org)){for(;b.lNext!==c&&(m.geom.edgeGoesLeft(b.lNext)||0>=m.geom.edgeSign(b.org,b.dst(),b.lNext.dst()));)d=m.mesh.connect(b.lNext,b),b=d.sym;b=b.lPrev()}else{for(;b.lNext!==c&&(m.geom.edgeGoesRight(c.lPrev())||0<=m.geom.edgeSign(c.dst(),c.org,c.lPrev().org));)d=m.mesh.connect(c,c.lPrev()),c=d.sym;
c=c.lNext}for(m.assert(b.lNext!==c);b.lNext.lNext!==c;)d=m.mesh.connect(b.lNext,b),b=d.sym};m.tessmono.tessellateInterior=function(c){for(var b,d=c.fHead.next;d!==c.fHead;d=b)b=d.next,d.inside&&m.tessmono.tessellateMonoRegion_(d)};m.tessmono.discardExterior=function(c){for(var b,d=c.fHead.next;d!==c.fHead;d=b)b=d.next,d.inside||m.mesh.zapFace(d)};m.tessmono.setWindingNumber=function(c,b,d){for(var a,e=c.eHead.next;e!==c.eHead;e=a)a=e.next,e.rFace().inside!==e.lFace.inside?e.winding=e.lFace.inside?
b:-b:d?m.mesh.deleteEdge(e):e.winding=0};m.Dict=function(c,b){this.head_=new m.DictNode;this.frame_=c;this.leq_=b};m.Dict.prototype.deleteDict_=function(){};m.Dict.prototype.insertBefore=function(c,b){do c=c.prev;while(null!==c.key&&!this.leq_(this.frame_,c.key,b));b=new m.DictNode(b,c.next,c);c.next.prev=b;return c.next=b};m.Dict.prototype.insert=function(c){return this.insertBefore(this.head_,c)};m.Dict.prototype.deleteNode=function(c){c.next.prev=c.prev;c.prev.next=c.next};m.Dict.prototype.search=
function(c){var b=this.head_;do b=b.next;while(null!==b.key&&!this.leq_(this.frame_,c,b.key));return b};m.Dict.prototype.getMin=function(){return this.head_.next};m.Dict.prototype.getMax=function(){return this.head_.prev};m.DictNode=function(c,b,d){this.key=c||null;this.next=b||this;this.prev=d||this};m.DictNode.prototype.getKey=function(){return this.key};m.DictNode.prototype.getSuccessor=function(){return this.next};m.DictNode.prototype.getPredecessor=function(){return this.prev};m.GluTesselator=
function(){this.state_=m.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=m.windingRule.GLU_TESS_WINDING_ODD;this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};m.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};m.GluTesselator.prototype.gluDeleteTess=
function(){this.requireState_(m.GluTesselator.tessState_.T_DORMANT)};m.GluTesselator.prototype.gluTessProperty=function(c,b){switch(c){case m.gluEnum.GLU_TESS_TOLERANCE:return;case m.gluEnum.GLU_TESS_WINDING_RULE:switch(b){case m.windingRule.GLU_TESS_WINDING_ODD:case m.windingRule.GLU_TESS_WINDING_NONZERO:case m.windingRule.GLU_TESS_WINDING_POSITIVE:case m.windingRule.GLU_TESS_WINDING_NEGATIVE:case m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=b;return}break;case m.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=
!!b;return;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(m.gluEnum.GLU_INVALID_VALUE)};m.GluTesselator.prototype.gluGetTessProperty=function(c){switch(c){case m.gluEnum.GLU_TESS_TOLERANCE:return 0;case m.gluEnum.GLU_TESS_WINDING_RULE:return c=this.windingRule,m.assert(c===m.windingRule.GLU_TESS_WINDING_ODD||c===m.windingRule.GLU_TESS_WINDING_NONZERO||c===m.windingRule.GLU_TESS_WINDING_POSITIVE||c===m.windingRule.GLU_TESS_WINDING_NEGATIVE||c===m.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),
c;case m.gluEnum.GLU_TESS_BOUNDARY_ONLY:return m.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM)}return!1};m.GluTesselator.prototype.gluTessNormal=function(c,b,d){this.normal_[0]=c;this.normal_[1]=b;this.normal_[2]=d};m.GluTesselator.prototype.gluTessCallback=function(c,b){b=b?b:null;switch(c){case m.gluEnum.GLU_TESS_BEGIN:case m.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=b;break;case m.gluEnum.GLU_TESS_EDGE_FLAG:case m.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=
b;break;case m.gluEnum.GLU_TESS_VERTEX:case m.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=b;break;case m.gluEnum.GLU_TESS_END:case m.gluEnum.GLU_TESS_END_DATA:this.endCallback_=b;break;case m.gluEnum.GLU_TESS_ERROR:case m.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=b;break;case m.gluEnum.GLU_TESS_COMBINE:case m.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=b;break;case m.gluEnum.GLU_TESS_MESH:this.meshCallback_=b;break;default:this.callErrorCallback(m.gluEnum.GLU_INVALID_ENUM)}};m.GluTesselator.prototype.gluTessVertex=
function(c,b){var d=!1,a=[0,0,0];this.requireState_(m.GluTesselator.tessState_.T_IN_CONTOUR);for(var e=0;3>e;++e){var f=c[e];f<-m.GLU_TESS_MAX_COORD&&(f=-m.GLU_TESS_MAX_COORD,d=!0);f>m.GLU_TESS_MAX_COORD&&(f=m.GLU_TESS_MAX_COORD,d=!0);a[e]=f}d&&this.callErrorCallback(m.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(a,b)};m.GluTesselator.prototype.gluTessBeginPolygon=function(c){this.requireState_(m.GluTesselator.tessState_.T_DORMANT);this.state_=m.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=
new m.GluMesh;this.polygonData_=c};m.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_POLYGON);this.state_=m.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};m.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=m.GluTesselator.tessState_.T_IN_POLYGON};m.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(m.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=m.GluTesselator.tessState_.T_DORMANT;m.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);m.sweep.computeInterior(this);if(!this.fatalError){var c=this.mesh;this.boundaryOnly_?m.tessmono.setWindingNumber(c,1,!0):m.tessmono.tessellateInterior(c);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?m.render.renderBoundary(this,this.mesh):m.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);
if(this.meshCallback_){m.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}m.mesh.deleteMesh(this.mesh);this.mesh=this.polygonData_=null};m.GluTesselator.prototype.requireState_=function(c){this.state_!==c&&this.gotoState_(c)};m.GluTesselator.prototype.gotoState_=function(c){for(;this.state_!==c;)if(this.state_<c)switch(this.state_){case m.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);
this.gluTessBeginPolygon(null);break;case m.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case m.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_END_CONTOUR);this.gluTessEndContour();break;case m.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(m.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};m.GluTesselator.prototype.addVertex_=
function(c,b){var d=this.lastEdge_;null===d?(d=m.mesh.makeEdge(this.mesh),m.mesh.meshSplice(d,d.sym)):(m.mesh.splitEdge(d),d=d.lNext);d.org.data=b;d.org.coords[0]=c[0];d.org.coords[1]=c[1];d.org.coords[2]=c[2];d.winding=1;d.sym.winding=-1;this.lastEdge_=d};m.GluTesselator.prototype.callBeginCallback=function(c){this.beginCallback_&&this.beginCallback_(c,this.polygonData_)};m.GluTesselator.prototype.callVertexCallback=function(c){this.vertexCallback_&&this.vertexCallback_(c,this.polygonData_)};m.GluTesselator.prototype.callEdgeFlagCallback=
function(c){this.edgeFlagCallback_&&this.edgeFlagCallback_(c,this.polygonData_)};m.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};m.GluTesselator.prototype.callCombineCallback=function(c,b,d){return this.combineCallback_?this.combineCallback_(c,b,d,this.polygonData_)||null:null};m.GluTesselator.prototype.callErrorCallback=function(c){this.errorCallback_&&this.errorCallback_(c,this.polygonData_)};m.GluFace=function(c,b){this.next=c||this;
this.prev=b||this;this.anEdge=null;this.inside=!1};m.GluHalfEdge=function(c){this.next=c||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};m.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};m.GluHalfEdge.prototype.dst=function(){return this.sym.org};m.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};m.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};m.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};
m.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};m.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};m.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};m.GluMesh=function(){this.vHead=new m.GluVertex;this.fHead=new m.GluFace;this.eHead=new m.GluHalfEdge;this.eHeadSym=new m.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};m.GluMesh.prototype.checkMesh=function(){if(m.DEBUG){var c=this.fHead,b=this.vHead,d=this.eHead,a,e;for(a=a=c;(e=
a.next)!==c;a=e){m.assert(e.prev===a);a=e.anEdge;do m.assert(a.sym!==a),m.assert(a.sym.sym===a),m.assert(a.lNext.oNext.sym===a),m.assert(a.oNext.sym.lNext===a),m.assert(a.lFace===e),a=a.lNext;while(a!==e.anEdge)}m.assert(e.prev===a&&null===e.anEdge);for(a=a=b;(c=a.next)!==b;a=c){m.assert(c.prev===a);a=c.anEdge;do m.assert(a.sym!==a),m.assert(a.sym.sym===a),m.assert(a.lNext.oNext.sym===a),m.assert(a.oNext.sym.lNext===a),m.assert(a.org===c),a=a.oNext;while(a!==c.anEdge)}m.assert(c.prev===a&&null===
c.anEdge&&null===c.data);for(b=b=d;(a=b.next)!==d;b=a)m.assert(a.sym.next===b.sym),m.assert(a.sym!==a),m.assert(a.sym.sym===a),m.assert(null!==a.org),m.assert(null!==a.dst()),m.assert(a.lNext.oNext.sym===a),m.assert(a.oNext.sym.lNext===a);m.assert(a.sym.next===b.sym&&a.sym===this.eHeadSym&&a.sym.sym===a&&null===a.org&&null===a.dst()&&null===a.lFace&&null===a.rFace())}};m.GluVertex=function(c,b){this.next=c||this;this.prev=b||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=
this.s=0};m.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new m.PriorityQHeap};m.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};m.PriorityQ.prototype.init=function(){this.order_=[];for(var c=0;c<this.size_;c++)this.order_[c]=c;c=function(d){return function(a,e){return m.geom.vertLeq(d[a],d[e])?1:-1}}(this.verts_);this.order_.sort(c);this.initialized_=!0;this.heap_.init();if(m.DEBUG){var b=0+this.size_-1;for(c=0;c<
b;++c)m.assert(m.geom.vertLeq(this.verts_[this.order_[c+1]],this.verts_[this.order_[c]]))}};m.PriorityQ.prototype.insert=function(c){if(this.initialized_)return this.heap_.insert(c);var b=this.size_++;this.verts_[b]=c;return-(b+1)};m.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(m.geom.vertLeq(b,c))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&
null===this.verts_[this.order_[this.size_-1]]);return c};m.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var c=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var b=this.heap_.minimum();if(m.geom.vertLeq(b,c))return b}return c};m.PriorityQ.prototype.remove=function(c){if(0<=c)this.heap_.remove(c);else for(c=-(c+1),m.assert(c<this.verts_.length&&null!==this.verts_[c]),this.verts_[c]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-
1]];)--this.size_};m.PriorityQHeap=function(){this.heap_=m.PriorityQHeap.reallocNumeric_([0],m.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=m.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};m.PriorityQHeap.INIT_SIZE_=32;m.PriorityQHeap.reallocNumeric_=function(c,b){for(var d=Array(b),a=0;a<c.length;a++)d[a]=c[a];for(;a<b;a++)d[a]=0;return d};m.PriorityQHeap.prototype.init=function(){for(var c=this.size_;1<=c;--c)this.floatDown_(c);
this.initialized_=!0};m.PriorityQHeap.prototype.insert=function(c){var b=++this.size_;2*b>this.max_&&(this.max_*=2,this.handles_=m.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));if(0===this.freeList_)var d=b;else d=this.freeList_,this.freeList_=this.handles_[this.freeList_];this.verts_[d]=c;this.handles_[d]=b;this.heap_[b]=d;this.initialized_&&this.floatUp_(b);return d};m.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};m.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};
m.PriorityQHeap.prototype.extractMin=function(){var c=this.heap_,b=this.verts_,d=this.handles_,a=c[1],e=b[a];0<this.size_&&(c[1]=c[this.size_],d[c[1]]=1,b[a]=null,d[a]=this.freeList_,this.freeList_=a,0<--this.size_&&this.floatDown_(1));return e};m.PriorityQHeap.prototype.remove=function(c){var b=this.heap_,d=this.verts_,a=this.handles_;m.assert(1<=c&&c<=this.max_&&null!==d[c]);var e=a[c];b[e]=b[this.size_];a[b[e]]=e;e<=--this.size_&&(1>=e?this.floatDown_(e):m.geom.vertLeq(d[b[e>>1]],d[b[e]])?this.floatDown_(e):
this.floatUp_(e));d[c]=null;a[c]=this.freeList_;this.freeList_=c};m.PriorityQHeap.prototype.floatDown_=function(c){for(var b=this.heap_,d=this.verts_,a=this.handles_,e=b[c];;){var f=c<<1;f<this.size_&&m.geom.vertLeq(d[b[f+1]],d[b[f]])&&(f+=1);m.assert(f<=this.max_);var g=b[f];if(f>this.size_||m.geom.vertLeq(d[e],d[g])){b[c]=e;a[e]=c;break}b[c]=g;a[g]=c;c=f}};m.PriorityQHeap.prototype.floatUp_=function(c){for(var b=this.heap_,d=this.verts_,a=this.handles_,e=b[c];;){var f=c>>1,g=b[f];if(0===f||m.geom.vertLeq(d[g],
d[e])){b[c]=e;a[e]=c;break}b[c]=g;a[g]=c;c=f}};m.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};m.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};m.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return m})});const C=z.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");return function(){function A(){this._indexCounter=
this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new D.GluTesselator;this.glu.gluTessCallback(D.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(D.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(D.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(D.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(D.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));
this.glu.gluTessCallback(D.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));this.glu.gluTessProperty(D.gluEnum.GLU_TESS_WINDING_RULE,D.windingRule.GLU_TESS_WINDING_ODD)}var m=A.prototype;m.beginPolygon=function(c,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(c);this._indices=b};m.endPolygon=function(){this.glu.gluTessEndPolygon()};m.beginContour=function(){this.glu.gluTessBeginContour()};
m.endContour=function(){this.glu.gluTessEndContour()};m.addVertex=function(c,b){this.glu.gluTessVertex(c,b)};m._vertexCallback=function(c,b){b[b.length]=c[0];b[b.length]=c[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(c=0;3>c;c++)-1===this._triangleIndices[c]&&(this._triangleIndices[c]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[c];this._currentVertexIndex=0}else this._currentVertexIndex++};m._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};m._endcallback=function(){this._currentVertexIndex=0};m._errorcallback=function(c){C.error(`Encountered error during tesselation: ${c}`)};m._combinecallback=function(c){return[c[0],c[1],c[2]]};m._edgeCallback=function(){};return A}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define(["../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/Logger","../../../../../../core/promiseUtils",
"../../../../../../symbols/cim/cimAnalyzer","./WGLMeshTemplate"],function(z,E,D,C,A){const m=E.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");return function(c){function b(d){var a=c.call(this)||this;a._ongoingMaterialRequestMap=new Map;a._materialCache=new Map;a._dynamicPropertyMap=new Map;a._cimLayer=d;return a}z._inheritsLoose(b,c);b.prototype.analyze=function(d,a,e,f){a=a.readLegacyFeature();const g=this._materialCache,q=this._cimLayer.materialHash;if(!q)return m.error("A Dynamic mesh template must have a material hash value or function!"),
D.reject(null);const h="function"===typeof q?q(a,e,f):q;if(g.has(h))return d=g.get(h),D.resolve(d);if(this._ongoingMaterialRequestMap.has(h))return this._ongoingMaterialRequestMap.get(h);e=C.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);e.mosaicHash=h;d=d.getMosaicItem(e).then(n=>{this._ongoingMaterialRequestMap.delete(h);g.set(h,n);return n}).catch(n=>{this._ongoingMaterialRequestMap.delete(h);m.error(".analyze()",n.message);return null});this._ongoingMaterialRequestMap.set(h,
d);return d};return b}(A)})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../util/Result ./util ./WGLDynamicMeshTemplate ./WGLBaseLineTemplate".split(" "),function(z,E,D,C,A,m,c,b,d,a){return function(e){function f(g){var q=e.call(this,g)||this;q._cimLineLayer=g;let h=0;b.isFunction(g.width)||(h=.5*
E.pt2px(g.width));q._dynamicPropertyMap.set("_halfWidth",(n,u,t)=>b.isFunction(g.width)?.5*E.pt2px(g.width(n,u,t)):h);b.isFunction(g.cap)?q._dynamicPropertyMap.set("_capType",g.cap):q._capType=g.cap;b.isFunction(g.join)?q._dynamicPropertyMap.set("_joinType",g.join):q._joinType=g.join;if(b.isFunction(g.color))q._dynamicPropertyMap.set("_fillColor",(n,u,t)=>(n=g.color(n,u,t))&&m.premultiplyAlphaRGBA(n)||0);else{const n=g.color;q._fillColor=n&&m.premultiplyAlphaRGBA(n)||0}b.isFunction(g.miterLimit)?
q._dynamicPropertyMap.set("_miterLimitCosine",(n,u,t)=>b.getLimitCosine(g.miterLimit(n,u,t))):q._miterLimitCosine=b.getLimitCosine(g.miterLimit);q._scaleFactor=g.scaleFactor||1;q._isDashed=g.isDashed;q.effects=g.effects;q.tessellationProperties._bitset=g.colorLocked?1:0;q._materialKey=g.materialKey;q._initializeTessellator(!0);return q}z._inheritsLoose(f,e);f.fromCIMLine=function(g){return new f(g)};f.prototype.bindFeature=function(g,q,h){const n=g.readLegacyFeature();this._dynamicPropertyMap.forEach((t,
k)=>{this[k]=t(n,q,h)});this._halfWidth*=this._scaleFactor;g=this._materialCache;var u=this._cimLineLayer.materialHash;u=u(n,q,h);u=g.get(u);g=null;u&&c.ok(u.spriteMosaicItem)&&(g=u.spriteMosaicItem);if(g){this._hasPattern=!0;const {rect:t,width:k,height:v}=g;u=t.x+D.SPRITE_PADDING;const p=t.y+D.SPRITE_PADDING,r=u+k,w=p+v;this.tessellationProperties._tl=C.i1616to32(u,p);this.tessellationProperties._br=C.i1616to32(r,w)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=
0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;u=A.LineMaterialKey.load(this._materialKey);g&&(u.sdf=g.sdf,u.pattern=!0,u.textureBinding=g.textureBinding);this._materialKey=u.data};return f}(a(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../definitions ../../number ../../enums ../../materialKey/MaterialKey ../../TileClipper ../../TurboLine".split(" "),
function(z,E,D,C,A,m,c,b){const d=D.TILE_SIZE+16,a=1/3.8,e=new c.TileClipper(0,0,0,1,16);e.setExtent(D.TILE_SIZE);const f=new Uint32Array(9),g=new Uint32Array(36),q=new Uint32Array(3),h=new Uint32Array(6),n=v=>p=>{var r=Math.ceil(1024*v._halfWidth);const w=Math.ceil(1024*v._halfReferenceWidth);p.entry0=v.offset+v.vertexCount++;var l=C.i1616to32(p.distance,r),x=C.i8888to32(Math.round(31*p.prevNormal.x),Math.round(31*p.prevNormal.y),0,-31),y=C.i8888to32(0,0,0,v._bitset);g[0]=C.i1616to32(8*p.currentVertex.x,
8*p.currentVertex.y);g[1]=v.id;g[2]=v._fillColor;g[3]=x;g[4]=l;g[5]=v._tl;g[6]=v._br;g[7]=y;g[8]=C.i1616to32(w,0);p.entry2=v.offset+v.vertexCount++;l=C.i1616to32(p.distance,r);x=C.i8888to32(Math.round(31*-p.prevNormal.x),Math.round(31*-p.prevNormal.y),0,31);y=C.i8888to32(0,0,0,v._bitset);g[9]=C.i1616to32(8*p.currentVertex.x,8*p.currentVertex.y);g[10]=v.id;g[11]=v._fillColor;g[12]=x;g[13]=l;g[14]=v._tl;g[15]=v._br;g[16]=y;g[17]=C.i1616to32(w,0);p.exit0=v.offset+v.vertexCount++;l=C.i1616to32(p.distance,
r);x=C.i8888to32(Math.round(31*p.nextNormal.x),Math.round(31*p.nextNormal.y),0,-31);y=C.i8888to32(0,0,0,v._bitset);g[18]=C.i1616to32(8*p.currentVertex.x,8*p.currentVertex.y);g[19]=v.id;g[20]=v._fillColor;g[21]=x;g[22]=l;g[23]=v._tl;g[24]=v._br;g[25]=y;g[26]=C.i1616to32(w,0);p.exit2=v.offset+v.vertexCount++;r=C.i1616to32(p.distance,r);l=C.i8888to32(Math.round(31*-p.nextNormal.x),Math.round(31*-p.nextNormal.y),0,31);x=C.i8888to32(0,0,0,v._bitset);g[27]=C.i1616to32(8*p.currentVertex.x,8*p.currentVertex.y);
g[28]=v.id;g[29]=v._fillColor;g[30]=l;g[31]=r;g[32]=v._tl;g[33]=v._br;g[34]=x;g[35]=C.i1616to32(w,0);v.geometryBuf.writeRegion(g)},u=v=>p=>{h[0]=p.leftExit0;h[1]=p.rightEntry0;h[2]=p.leftExit2;h[3]=p.rightEntry0;h[4]=p.rightEntry2;h[5]=p.leftExit2;v.indexCount+=6;v.indexBuf.writeRegion(h)},t=v=>(p,r,w,l,x,y,B,F,G)=>{G=C.i1616to32(G,Math.ceil(1024*v._halfWidth));x=C.i8888to32(Math.round(31*x),Math.round(31*y),Math.round(31*B),Math.round(31*F));w=C.i8888to32(31*w,31*l,0,v._bitset);f[0]=C.i1616to32(8*
p,8*r);f[1]=v.id;f[2]=v._fillColor;f[3]=x;f[4]=G;f[5]=v._tl;f[6]=v._br;f[7]=w;f[8]=C.i1616to32(Math.ceil(1024*v._halfReferenceWidth),0);v.geometryBuf.writeRegion(f);return v.offset+v.vertexCount++},k=v=>(p,r,w)=>{q[0]=p;q[1]=r;q[2]=w;v.indexCount+=3;v.indexBuf.writeRegion(q)};return v=>function(p){function r(...l){l=p.call(this,...l)||this;l.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,
vertexCount:null,offset:null};l._tessellationOptions={};l.geometryType=A.WGLGeometryType.LINE;return l}z._inheritsLoose(r,p);var w=r.prototype;w.writeMeshWithGeometry=function(l,x,y,B,F,G){const J=x.indexVector,K=x.get("geometry");x=x.getVector("geometry").vertexCount;const M=J.length;if(y=null!=G?G:y.readLegacyGeometry()){switch(B){case "esriGeometryPolyline":B=this._clipLines(y.paths);if(0===B.length)return;this._write(J,K,x,F,B);break;case "esriGeometryPolygon":B=this._clipLines(y.rings);if(0===
B.length)return;this._write(J,K,x,F,B)}l.writeDisplayRecord(this.geometryType,this._materialKey,x,this.tessellationProperties.vertexCount,M,this.tessellationProperties.indexCount)}};w._clipLines=function(l){const x=[];var y=!1;let B=0;for(;B<l.length;){const F=[],G=l[B];e.reset(2);let [J,K]=G[0];if(y)e.moveTo(J,K);else{if(-16>J||J>d||-16>K||K>d){y=!0;continue}F.push({x:J,y:K})}let M=!1;const R=G.length;for(let N=1;N<R;++N)if(J+=G[N][0],K+=G[N][1],y)e.lineTo(J,K);else{if(-16>J||J>d||-16>K||K>d){M=
!0;break}F.push({x:J,y:K})}if(M)y=!0;else{if(y){if(y=e.resultWithStarts())for(const N of y)x.push(N)}else x.push({line:F,start:0});B++;y=!1}}return x};w._write=function(l,x,y,B,F){this.tessellationProperties.id=B;this.tessellationProperties.indexBuf=l;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=x;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=y;for(const G of F)l=G.line,2>l.length||(this._tessellationOptions.initialDistance=G.start%
65535,this._tessellationCallbacks instanceof b.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),b.tessellate(l,this._tessellationOptions,this._tessellationCallbacks),b.cleanup())};w._initializeTessellator=function(l){const x=m.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!l&&this.tessellationProperties._halfWidth<D.THIN_LINE_THRESHOLD/
2&&!(x.vvSizeFieldStops||x.vvSizeMinMaxValue||x.vvSizeScaleStops||x.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=a;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=a;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:n(this.tessellationProperties),
bridge:u(this.tessellationProperties)}:(l=new b.StandardTessellationCallbacks(t(this.tessellationProperties),k(this.tessellationProperties)),l.miterLimitCosine=this._miterLimitCosine,l.textured=this._isDashed||this._hasPattern,l.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=l)};return r}(v)})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["exports","./mesh/templates/util"],function(z,E){function D(){if(k.cosine<e.innerBisectorAutoSplitThreshold){k.splitInner=!0;k.gapInner=
!0;var r=Math.max(e.innerBisectorAutoSplitThreshold,k.cosine);r=Math.sqrt(1-r*r)/r;k.leftInner.x=k.nextNormal.x+k.sign*r*k.outbound.x;k.leftInner.y=k.nextNormal.y+k.sign*r*k.outbound.y;k.rightInner.x=k.prevNormal.x-k.sign*r*k.inbound.x;k.rightInner.y=k.prevNormal.y-k.sign*r*k.inbound.y}else e.enableInnerBisectorSplit&&(k.splitInner=!0,k.gapInner=!1,k.leftInner.x=k.rightInner.x=k.bisector.x/k.cosine,k.leftInner.y=k.rightInner.y=k.bisector.y/k.cosine);k.cosine<e.outerBisectorAutoSplitThreshold?(k.splitOuter=
!0,k.gapOuter=!0,r=Math.max(e.outerBisectorAutoSplitThreshold,k.cosine),r=Math.sqrt(1-r*r)/r,k.leftOuter.x=k.prevNormal.x-k.sign*r*k.inbound.x,k.leftOuter.y=k.prevNormal.y-k.sign*r*k.inbound.y,k.rightOuter.x=k.nextNormal.x+k.sign*r*k.outbound.x,k.rightOuter.y=k.nextNormal.y+k.sign*r*k.outbound.y):e.enableOuterBisectorSplit&&(k.splitOuter=!0,k.gapOuter=!1,k.leftOuter.x=k.rightOuter.x=k.bisector.x/k.cosine,k.leftOuter.y=k.rightOuter.y=k.bisector.y/k.cosine)}function C(){if(n)k.distance=0,n=k.isCap=
k.isFirstVertex=k.isLastVertex=!1;else{if(0===q)if(k.isFirstVertex=0===g,t=a[g],0===g){if(q=0,k.closed){k.inbound.x=t.x-a[a.length-2].x;k.inbound.y=t.y-a[a.length-2].y;var r=Math.sqrt(k.inbound.x*k.inbound.x+k.inbound.y*k.inbound.y);k.inbound.x/=r;k.inbound.y/=r}}else k.inbound.x=t.x-u.x,k.inbound.y=t.y-u.y,q=Math.sqrt(k.inbound.x*k.inbound.x+k.inbound.y*k.inbound.y),k.inbound.x/=q,k.inbound.y/=q;k.distance+q-h<=e.wrapDistance?(g<a.length-1?(k.outbound.x=a[g+1].x-t.x,k.outbound.y=a[g+1].y-t.y,r=Math.sqrt(k.outbound.x*
k.outbound.x+k.outbound.y*k.outbound.y),k.outbound.x/=r,k.outbound.y/=r):k.closed?(k.outbound.x=a[1].x-t.x,k.outbound.y=a[1].y-t.y,r=Math.sqrt(k.outbound.x*k.outbound.x+k.outbound.y*k.outbound.y),k.outbound.x/=r,k.outbound.y/=r):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y),0!==g||k.closed||(k.inbound.x=k.outbound.x,k.inbound.y=k.outbound.y),++g,k.isLastVertex=g===a.length,k.isCap=!k.closed&&(k.isFirstVertex||k.isLastVertex),k.distance+=q-h,h=q=0,n=k.distance+q-h===e.wrapDistance,k.currentVertex.x=
t.x,k.currentVertex.y=t.y,u=t,t=null):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y,h+=e.wrapDistance-k.distance,k.distance=e.wrapDistance,n=!0,r=h/q,k.currentVertex.x=(1-r)*u.x+r*t.x,k.currentVertex.y=(1-r)*u.y+r*t.y)}}function A(){k.prevNormal.x=-k.inbound.y;k.prevNormal.y=k.inbound.x;k.nextNormal.x=-k.outbound.y;k.nextNormal.y=k.outbound.x}function m(){A();k.bisector.x=k.prevNormal.x+k.nextNormal.x;k.bisector.y=k.prevNormal.y+k.nextNormal.y;const r=Math.sqrt(k.bisector.x*k.bisector.x+k.bisector.y*
k.bisector.y);.001>r?(k.bisector.x=void 0,k.bisector.y=void 0,k.cosine=0,k.sign=void 0):(k.bisector.x/=r,k.bisector.y/=r,k.cosine=k.bisector.x*k.nextNormal.x+k.bisector.y*k.nextNormal.y,k.sign=0<=k.prevNormal.x*k.nextNormal.y-k.prevNormal.y*k.nextNormal.x?1:-1)}function c(r){f.vertex(k);1===r?(k.leftEntry0=k.entry0,k.leftEntry1=k.entry1,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit1=k.exit1,k.leftExit2=k.exit2):2===r&&(k.rightEntry0=k.entry0,k.rightEntry1=k.entry1,k.rightEntry2=k.entry2,k.rightExit0=
k.exit0,k.rightExit1=k.exit1,k.rightExit2=k.exit2)}function b(r){f.vertex(k);1===r?(k.leftEntry0=k.entry0,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit2=k.exit2):2===r&&(k.rightEntry0=k.entry0,k.rightEntry2=k.entry2,k.rightExit0=k.exit0,k.rightExit2=k.exit2)}let d=function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal=
{x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}},a;const e={};let f,g=void 0,q,h,n,u,t;const k=new d;let v=function(){function r(l,x){this.writeVertex=l;this.writeTriangle=x;this.capType=0;this.joinType=2;this.miterLimitCosine=E.getLimitCosine(2);this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=
this.textured=!1}var w=r.prototype;w.vertex=function(l){var x=2===this.joinType?this.miterLimitCosine:this.roundLimitCosine,y=l.isCap&&0!==this.capType,B=!1;l.cosine>this.almostParallelCosine?(l.exit0=l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.bisector.x/l.cosine,l.bisector.y/l.cosine,0,-1,l.distance),l.exit2=l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.bisector.x/l.cosine,-l.bisector.y/l.cosine,0,1,l.distance)):l.cosine<1-this.almostParallelCosine?
(B=!l.isCap&&this.joinOnUTurn,l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x,l.prevNormal.y,0,-1,l.distance),l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.prevNormal.x,-l.prevNormal.y,0,1,l.distance),l.exit0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.nextNormal.x,l.nextNormal.y,0,-1,l.distance),l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.nextNormal.x,-l.nextNormal.y,0,1,l.distance)):l.canSplit?(D(),0<
l.sign?(l.splitInner?(l.exit0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.outbound.x,l.outbound.y,l.leftInner.x,l.leftInner.y,0,-1,l.distance),l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,l.rightInner.x,l.rightInner.y,0,-1,l.distance)):l.exit0=l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,l.bisector.x/l.cosine,l.bisector.y/l.cosine,0,-1,l.distance),l.cosine<x?(B=!l.isCap,l.entry2=this.writeVertex(l.currentVertex.x,
l.currentVertex.y,0,0,-l.prevNormal.x,-l.prevNormal.y,0,1,l.distance),l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.nextNormal.x,-l.nextNormal.y,0,1,l.distance)):l.splitOuter?(B=B||l.gapOuter,l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,-l.leftOuter.x,-l.leftOuter.y,0,1,l.distance),l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.outbound.x,l.outbound.y,-l.rightOuter.x,-l.rightOuter.y,0,1,l.distance)):l.entry2=l.exit2=this.writeVertex(l.currentVertex.x,
l.currentVertex.y,0,0,-l.bisector.x/l.cosine,-l.bisector.y/l.cosine,0,1,l.distance)):(l.splitInner?(l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.outbound.x,l.outbound.y,-l.leftInner.x,-l.leftInner.y,0,1,l.distance),l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,-l.rightInner.x,-l.rightInner.y,0,1,l.distance)):l.exit2=l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.bisector.x/l.cosine,-l.bisector.y/l.cosine,0,1,l.distance),
l.cosine<x?(B=!l.isCap,l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x,l.prevNormal.y,0,-1,l.distance),l.exit0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.nextNormal.x,l.nextNormal.y,0,-1,l.distance)):l.splitOuter?(B=B||l.gapOuter,l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,l.leftOuter.x,l.leftOuter.y,0,-1,l.distance),l.exit0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.outbound.x,l.outbound.y,l.rightOuter.x,
l.rightOuter.y,0,-1,l.distance)):l.exit0=l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.bisector.x/l.cosine,l.bisector.y/l.cosine,0,-1,l.distance))):0<l.sign?(l.exit0=l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,l.inbound.x,l.inbound.y,l.bisector.x/l.cosine,l.bisector.y/l.cosine,0,-1,l.distance),l.cosine<x?(B=!l.isCap,l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.prevNormal.x,-l.prevNormal.y,0,1,l.distance),l.exit2=this.writeVertex(l.currentVertex.x,
l.currentVertex.y,0,0,-l.nextNormal.x,-l.nextNormal.y,0,1,l.distance)):l.entry2=l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.bisector.x/l.cosine,-l.bisector.y/l.cosine,0,1,l.distance)):(l.exit2=l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.bisector.x/l.cosine,-l.bisector.y/l.cosine,0,1,l.distance),l.cosine<x?(B=!l.isCap,l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x,l.prevNormal.y,0,-1,l.distance),l.exit0=this.writeVertex(l.currentVertex.x,
l.currentVertex.y,0,0,l.nextNormal.x,l.nextNormal.y,0,-1,l.distance)):l.exit0=l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.bisector.x/l.cosine,l.bisector.y/l.cosine,0,-1,l.distance));x=l.canSplit&&(l.splitInner||l.splitOuter)||B||y?l.entry1=l.exit1=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,0,0,0,0,l.distance):l.entry1=l.exit1=null;if(B&&1!==this.joinType)this.writeTriangle(x,0<l.sign?l.exit2:l.entry0,0<l.sign?l.entry2:l.exit0);else if(y&&1===this.capType||B&&
1===this.joinType){let N,I;if(l.isCap){B=Math.PI;y=Math.ceil(B/this.radsPerSlice);var F=B/y;if(l.isFirstVertex){var G=l.prevNormal.x;var J=l.prevNormal.y;N=l.entry0;I=l.entry2}else l.isLastVertex&&(G=-l.nextNormal.x,J=-l.nextNormal.y,N=l.exit2,I=l.exit0)}else G=2*Math.acos(l.cosine),y=Math.ceil(G/this.radsPerSlice),F=G/y,G=0<l.sign?-l.prevNormal.x:l.nextNormal.x,J=0<l.sign?-l.prevNormal.y:l.nextNormal.y,N=0<l.sign?l.entry2:l.exit0,I=0<l.sign?l.exit2:l.entry0;B=Math.cos(F);F=Math.sin(F);var K=F*G+
B*J;G=B*G-F*J;J=K;var M;for(K=0;K<y;++K){var R=M;K<y-1&&(M=l.isCap?this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,G,J,l.isFirstVertex?-1:1,0,l.distance):this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,G,J,0,l.sign,l.distance));this.writeTriangle(0===K?N:R,x,K===y-1?I:M);R=F*G+B*J;G=B*G-F*J;J=R}}else y&&2===this.capType&&(M=l.isFirstVertex?1:-1,this.textured?(G=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x-M*l.inbound.x,l.prevNormal.y-M*l.inbound.y,-M,-1,
l.distance),J=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.prevNormal.x-M*l.inbound.x,-l.prevNormal.y-M*l.inbound.y,-M,1,l.distance)):(G=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x-M*l.inbound.x,l.prevNormal.y-M*l.inbound.y,0,-1,l.distance),J=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.prevNormal.x-M*l.inbound.x,-l.prevNormal.y-M*l.inbound.y,0,1,l.distance)),0<M?(this.writeTriangle(x,l.entry2,J),this.writeTriangle(x,J,G),this.writeTriangle(x,
G,l.entry0)):(this.writeTriangle(x,J,l.exit2),this.writeTriangle(x,G,J),this.writeTriangle(x,l.exit0,G)))};w.bridge=function(l){this.writeTriangle(l.leftExit0,l.rightEntry0,null!=l.leftExit1?l.leftExit1:l.leftExit2);this.writeTriangle(l.rightEntry0,null!=l.rightEntry1?l.rightEntry1:l.rightEntry2,null!=l.leftExit1?l.leftExit1:l.leftExit2);null!=l.leftExit1&&null!=l.rightEntry1?(this.writeTriangle(l.leftExit1,l.rightEntry1,l.leftExit2),this.writeTriangle(l.rightEntry1,l.rightEntry2,l.leftExit2)):null!=
l.leftExit1?this.writeTriangle(l.leftExit1,l.rightEntry2,l.leftExit2):null!=l.rightEntry1&&this.writeTriangle(l.rightEntry1,l.rightEntry2,l.leftExit2)};return r}(),p=function(){function r(l,x){this.writeVertex=l;this.writeTriangle=x}var w=r.prototype;w.vertex=function(l){l.entry0=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.prevNormal.x,l.prevNormal.y,0,-1,l.distance);l.entry2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.prevNormal.x,-l.prevNormal.y,0,1,l.distance);l.exit0=
this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,l.nextNormal.x,l.nextNormal.y,0,-1,l.distance);l.exit2=this.writeVertex(l.currentVertex.x,l.currentVertex.y,0,0,-l.nextNormal.x,-l.nextNormal.y,0,1,l.distance)};w.bridge=function(l){this.writeTriangle(l.leftExit0,l.rightEntry0,l.leftExit2);this.writeTriangle(l.rightEntry0,l.rightEntry2,l.leftExit2)};return r}();z.StandardTessellationCallbacks=v;z.TessellationState=d;z.ThinTessellationCallbacks=p;z.cleanup=function(){f=a=null};z.splitVertex=
D;z.tessellate=function(r,w,l){e.trackDistance=null!=w.trackDistance?w.trackDistance:!1;e.wrapDistance=null!=w.wrapDistance?w.wrapDistance:65535;e.thin=null!=w.thin?w.thin:!1;e.initialDistance=null!=w.initialDistance?w.initialDistance:0;e.enableOuterBisectorSplit=null!=w.enableOuterBisectorSplit?w.enableOuterBisectorSplit:!1;e.outerBisectorAutoSplitThreshold=null!=w.outerBisectorAutoSplitThreshold?w.outerBisectorAutoSplitThreshold:0;e.enableInnerBisectorSplit=null!=w.enableOuterBisectorSplit?w.enableOuterBisectorSplit:
!1;e.innerBisectorAutoSplitThreshold=null!=w.innerBisectorAutoSplitThreshold?w.innerBisectorAutoSplitThreshold:0;a=r;f=l;h=q=g=0;n=!1;t=u=null;k.currentVertex.x=null;k.currentVertex.y=null;k.distance=e.initialDistance;r=a[0];w=a[a.length-1];k.canSplit=!1;k.closed=r.x===w.x&&r.y===w.y;if(!(2>a.length||2===a.length&&k.closed))if(e.thin)if(e.trackDistance)for(C(),A(),b(1);q-h>e.wrapDistance||g<a.length;)C(),A(),b(2),f.bridge(k),k.leftExit0=k.rightExit0,k.leftExit2=k.rightExit2;else for(;g<a.length;)0<
g&&(k.inbound.x=k.outbound.x,k.inbound.y=k.outbound.y),g<a.length-1?(k.outbound.x=a[g+1].x-a[g].x,k.outbound.y=a[g+1].y-a[g].y,r=Math.sqrt(k.outbound.x*k.outbound.x+k.outbound.y*k.outbound.y),k.distance+=r,k.outbound.x/=r,k.outbound.y/=r):(k.outbound.x=k.inbound.x,k.outbound.y=k.inbound.y),0===g&&(k.inbound.x=k.outbound.x,k.inbound.y=k.outbound.y),k.currentVertex.x=a[g].x,k.currentVertex.y=a[g].y,k.prevNormal.x=-k.inbound.y,k.prevNormal.y=k.inbound.x,k.nextNormal.x=-k.outbound.y,k.nextNormal.y=k.outbound.x,
0===g?(f.vertex(k),k.leftEntry0=k.entry0,k.leftEntry2=k.entry2,k.leftExit0=k.exit0,k.leftExit2=k.exit2):(f.vertex(k),k.rightEntry0=k.entry0,k.rightEntry2=k.entry2,k.rightExit0=k.exit0,k.rightExit2=k.exit2,f.bridge(k),k.leftExit0=k.rightExit0,k.leftExit2=k.rightExit2),++g;else{if(e.enableOuterBisectorSplit||0<e.outerBisectorAutoSplitThreshold||e.enableInnerBisectorSplit||0<e.innerBisectorAutoSplitThreshold)for(k.canSplit=!0,C(),m(),k.splitInner=k.gapInner=k.splitOuter=k.gapOuter=!1,c(1),k.closure0=
k.leftEntry0,k.closure1=k.leftEntry1,k.closure2=k.leftEntry2;q-h>e.wrapDistance||g<a.length-1||g<a.length&&(!k.closed||e.trackDistance);)C(),m(),k.splitInner=k.gapInner=k.splitOuter=k.gapOuter=!1,c(2),f.bridge(k),k.leftExit0=k.rightExit0,k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2;else for(C(),m(),c(1),k.closure0=k.leftEntry0,k.closure1=k.leftEntry1,k.closure2=k.leftEntry2;q-h>e.wrapDistance||g<a.length-1||g<a.length&&(!k.closed||e.trackDistance);)C(),m(),c(2),f.bridge(k),k.leftExit0=k.rightExit0,
k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2;k.closed&&!e.trackDistance&&(k.rightEntry0=k.closure0,k.rightEntry1=k.closure1,k.rightEntry2=k.closure2,f.bridge(k),k.leftExit0=k.rightExit0,k.leftExit1=k.rightExit1,k.leftExit2=k.rightExit2)}};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/screenUtils ../../definitions ../../../../../../chunks/mat2df32 ../../../../../../chunks/vec2f32 ../../number ../../materialKey/MaterialKey ../../color ../../util/Result ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h){const n=b.create(),u=c.create(),t=D.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");return function(k){function v(p){var r=k.call(this,p)||this;r._cimMarkerLayer=p;g.isFunction(p.color)?r._dynamicPropertyMap.set("_fillColor",(w,l,x)=>e.premultiplyAlphaRGBA(p.color(w,l,x))):r._fillColor=e.premultiplyAlphaRGBA(p.color);g.isFunction(p.outlineColor)?r._dynamicPropertyMap.set("_outlineColor",(w,l,x)=>e.premultiplyAlphaRGBA(p.outlineColor(w,l,x))):
r._outlineColor=e.premultiplyAlphaRGBA(p.outlineColor);g.isFunction(p.size)?r._dynamicPropertyMap.set("_size",(w,l,x)=>A.pt2px(p.size(w,l,x))):r._size=A.pt2px(p.size);g.isFunction(p.scaleX)?r._dynamicPropertyMap.set("_scaleX",p.scaleX):r._scaleX=p.scaleX;g.isFunction(p.offsetX)?r._dynamicPropertyMap.set("xOffset",(w,l,x)=>A.pt2px(p.offsetX(w,l,x))):r.xOffset=A.pt2px(p.offsetX);g.isFunction(p.offsetY)?r._dynamicPropertyMap.set("yOffset",(w,l,x)=>A.pt2px(p.offsetY(w,l,x))):r.yOffset=A.pt2px(p.offsetY);
g.isFunction(p.outlineWidth)?r._dynamicPropertyMap.set("_outlineWidth",(w,l,x)=>A.pt2px(p.outlineWidth(w,l,x))):r._outlineWidth=A.pt2px(p.outlineWidth);g.isFunction(p.rotation)?r._dynamicPropertyMap.set("_angle",p.rotation):r._angle=p.rotation;r._scaleFactor=E.unwrapOr(p.scaleFactor,1);r._markerPlacement=p.markerPlacement;r.effects=p.effects;r._bitSet=(1===p.alignment?1:0)|(p.colorLocked?1:0)<<1|(p.scaleSymbolsProportionally?1:0)<<3;r._materialKey=p.materialKey;return r}z._inheritsLoose(v,k);v.fromCIMMarker=
function(p){return new v(p)};v.prototype.bindFeature=function(p,r,w){const l=p.readLegacyFeature();this._dynamicPropertyMap.forEach((Q,W)=>{this[W]=Q(l,r,w)});p=this._cimMarkerLayer.materialHash;p="function"===typeof p?p(l,r,w):p;if((p=this._materialCache.get(p))&&f.ok(p.spriteMosaicItem)&&p.spriteMosaicItem){p=p.spriteMosaicItem;var x=this._cimMarkerLayer.sizeRatio,y=p.width/p.height*this._scaleX,B=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,F=this._size,G=F*y,J=this.xOffset,K=
this.yOffset;this.xOffset*=this._scaleFactor;this.yOffset*=this._scaleFactor;var M=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/A.pt2px(this._cimMarkerLayer.frameHeight):1,R=this._outlineWidth*M,N=A.pt2px(this._cimMarkerLayer.referenceSize),I=M=0,H=this._cimMarkerLayer.anchorPoint;H&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(M=-H.x/(this._size*y),I=H.y/this._size):(M=H.x,I=H.y));this._sizeOutlineWidth=d.i8888to32(Math.round(Math.min(Math.sqrt(128*
G),255)),Math.round(Math.min(Math.sqrt(128*F),255)),Math.round(Math.min(Math.sqrt(128*R),255)),Math.round(Math.min(Math.sqrt(128*N),255)));this.angle=B;this._bitestAndDistRatio=d.i8888to32(0,0,this._bitSet,Math.round(Math.min(64*x,255)));y=p.rect.x+m.SPRITE_PADDING;B=p.rect.y+m.SPRITE_PADDING;R=y+p.width;N=B+p.height;this._texUpperLeft=d.i1616to32(y,B);this._texUpperRight=d.i1616to32(R,B);this._texBottomLeft=d.i1616to32(y,N);this._texBottomRight=d.i1616to32(R,N);y=a.MarkerMaterialKey.load(this._materialKey);
y.sdf=p.sdf;y.pattern=!0;y.textureBinding=p.textureBinding;this._materialKey=y.data;this._anchorX=.5-(.5+M)*p.width/p.width;this._anchorY=.5-(.5+I)*p.height/p.height;G=G*x*this._scaleFactor;F=F*x*this._scaleFactor;G*=p.rect.width/p.width;F*=p.rect.height/p.height;this._computedWidth=G;this._computedHeight=F;this._applyTransformation(u,n);this.xOffset=J;this.yOffset=K}else t.error(new C("mapview-cim","Encountered an error when binding feature"))};return v}(q(h))})},"esri/views/2d/layers/features/textUtils":function(){define(["exports"],
function(z){z.codepoints=function(E){const D=Array(E.length);for(let C=0;C<E.length;C++)D[C]=E.charCodeAt(C);return D};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/screenUtils ../../alignmentUtils ../../materialKey/MaterialKey ../../color ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../../../layers/features/textUtils".split(" "),
function(z,E,D,C,A,m,c,b,d){return function(a){function e(g){var q=a.call(this,g)||this;q._horizontalAlignment="center";q._verticalAlignment="middle";q._textToGlyphs=new Map;var h=g.scaleFactor||1;q._cimTextLayer=g;m.isFunction(g.color)?q._dynamicPropertyMap.set("_color",(k,v,p)=>A.premultiplyAlphaRGBA(g.color(k,v,p))):q._color=A.premultiplyAlphaRGBA(g.color);m.isFunction(g.color)?q._dynamicPropertyMap.set("_haloColor",(k,v,p)=>A.premultiplyAlphaRGBA(g.outlineColor(k,v,p))):q._haloColor=A.premultiplyAlphaRGBA(g.outlineColor);
let n;m.isFunction(g.size)||(n=Math.min(Math.round(E.pt2px(g.size*g.sizeRatio)),127));q._dynamicPropertyMap.set("_size",(k,v,p)=>m.isFunction(g.size)?Math.min(Math.round(E.pt2px(g.size(k,v,p)*g.sizeRatio)),127):n);m.isFunction(g.outlineSize)?q._dynamicPropertyMap.set("_haloSize",(k,v,p)=>Math.min(Math.floor(5*E.pt2px(g.outlineSize(k,v,p)*g.sizeRatio)),127)):q._haloSize=Math.min(Math.floor(5*E.pt2px(g.outlineSize*g.sizeRatio)),127);let u;m.isFunction(g.offsetX)||(u=Math.round(E.pt2px(g.offsetX*g.sizeRatio)));
q._dynamicPropertyMap.set("_xOffset",(k,v,p)=>m.isFunction(g.offsetX)?Math.round(E.pt2px(g.offsetX(k,v,p)*g.sizeRatio)):u);let t;m.isFunction(g.offsetY)||(t=Math.round(E.pt2px(g.offsetY*g.sizeRatio)));q._dynamicPropertyMap.set("_yOffset",(k,v,p)=>m.isFunction(g.offsetY)?Math.round(E.pt2px(g.offsetY(k,v,p)*g.sizeRatio)):t);m.isFunction(g.angle)?q._dynamicPropertyMap.set("_angle",g.angle):q._angle=g.angle;m.isFunction(g.horizontalAlignment)?q._dynamicPropertyMap.set("_horizontalAlignment",g.horizontalAlignment):
q._horizontalAlignment=g.horizontalAlignment;m.isFunction(g.verticalAlignment)?q._dynamicPropertyMap.set("_verticalAlignment",g.verticalAlignment):q._verticalAlignment=g.verticalAlignment;q._scaleFactor=h;m.isFunction(g.text)?q._dynamicPropertyMap.set("_text",g.text):q._text=g.text;h=Math.min(Math.round(E.pt2px(g.referenceSize*g.sizeRatio)),127);q._referenceSize=Math.round(Math.sqrt(256*h));q._materialKey=g.materialKey;h=C.TextMaterialKey.load(q._materialKey);h.sdf=!0;q._bitset=(1===g.alignment?1:
0)|(g.colorLocked?1:0)<<1;q._materialKey=h.data;q._decoration="none";q._lineHeight=1;q._lineWidth=512;q._textPlacement=g.markerPlacement;q.effects=g.effects;q._isCIM=!0;return q}z._inheritsLoose(e,a);e.fromCIMText=function(g){return new e(g)};var f=e.prototype;f.analyze=async function(g,q,h,n){q=q.readLegacyFeature();var u=this._cimTextLayer;h="string"===typeof u.text?u.text:"function"===typeof u.text?u.text(q,h,n):"";g=await g.getMosaicItem(this._cimTextLayer.cim,d.codepoints(h));this._textToGlyphs.set(h,
g.glyphMosaicItems);return g};f.bindFeature=function(g,q,h){const n=g.readLegacyFeature();this._dynamicPropertyMap.forEach((u,t)=>{this[t]=u(n,q,h)});this._text&&0!==this._text.length?(this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=D.getXAnchorDirection(this._horizontalAlignment||"center"),this._yAlignD=D.getYAnchorDirection(this._verticalAlignment||"baseline"),g=this._textToGlyphs.get(this._text),this.bindTextInfo(g,
!1)):this._shapingInfo=null};return e}(c(b))})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../GeometryUtils ./WGLMeshTemplate ./WGLBaseFillTemplate".split(" "),function(z,E,D,C,A,m,c,b,d,a){return function(e){function f(g,q,h,n,u,t,k,v,p){var r=e.call(this)||this;r.effects=
p;g=m.FillMaterialKey.load(g);q&&(g.sdf=q.sdf,g.pattern=!0,g.textureBinding=q.textureBinding);r.fillColor=h;r.tl=n;r.br=u;r.aux1=t;r.aux2=k;r.aux3=v;r._materialKey=g.data;return r}z._inheritsLoose(f,e);f.fromCIMFill=function(g,q){var h=g.color;h=h&&c.premultiplyAlphaRGBA(h)||0;const n=g.materialKey;if(!q)return q=A.i8888to32(0,0,0,g.colorLocked?1:0),new f(n,null,h,0,0,0,0,q,g.effects);const {rect:u,width:t,height:k}=q;var v=u.x+C.SPRITE_PADDING;const p=u.y+C.SPRITE_PADDING;var r=v+t;const w=p+k;var l=
E.nextHighestPowerOfTwo(D.pt2px(g.height||0));255<l?l=255:0>=l&&(l=E.nextHighestPowerOfTwo(w-p));var x=E.nextHighestPowerOfTwo(D.pt2px(g.height/k*t||0));255<x?x=255:0>=x&&(x=E.nextHighestPowerOfTwo(r-v));let y=D.pt2px(g.offsetX||0)+128;255<y&&(y=255);let B=D.pt2px(-g.offsetY||0)+128;255<B&&(B=255);var F=g.scaleX||1;v=A.i1616to32(v,p);r=A.i1616to32(r,w);l=A.i8888to32(x,l,y,B);F=A.i1616to32(128*F,128);x=A.i8888to32(0,0,b.degToByte(g.angle),g.colorLocked?1:0);return new f(n,q,h,v,r,l,F,x,g.effects)};
f.fromSimpleFill=function(g,q,h=!1){var {color:n}=g;n=n&&"esriSFSNull"!==g.style&&c.premultiplyAlphaRGBAArray(n)||0;h=A.i8888to32(0,0,0,h?255:0);g=g.materialKey;if(!q)return new f(g,null,n,0,0,0,0,h,null);const {rect:u,width:t,height:k}=q;var v=u.x+C.SPRITE_PADDING,p=u.y+C.SPRITE_PADDING;const r=v+t,w=p+k,l=A.i1616to32(v,p),x=A.i1616to32(r,w);v=A.i8888to32(E.nextHighestPowerOfTwo(r-v),E.nextHighestPowerOfTwo(w-p),0,0);p=A.i1616to32(128,128);return new f(g,q,n,l,x,v,p,h,null)};f.fromPictureFill=function(g,
q,h=!1){const n=C.PICTURE_FILL_COLOR,{rect:u,width:t,height:k}=q;var v=u.x+C.SPRITE_PADDING,p=u.y+C.SPRITE_PADDING,r=v+t,w=p+k;v=A.i1616to32(v,p);r=A.i1616to32(r,w);w=E.nextHighestPowerOfTwo(D.pt2px(g.width));255<w&&(w=255);p=E.nextHighestPowerOfTwo(D.pt2px(g.height));255<p&&(p=255);let l=D.pt2px(g.xoffset)+128;255<l&&(l=255);let x=D.pt2px(-g.yoffset)+128;255<x&&(x=255);w=A.i8888to32(w,p,l,x);p=A.i1616to32(128*g.xscale,128*g.yscale);h=A.i8888to32(0,0,0,h?255:0);return new f(g.materialKey,q,n,v,r,
w,p,h,null)};return f}(a(d))})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/Logger ../../../../../../core/screenUtils ../../definitions ../../number ../../materialKey/MaterialKey ../../color ../../Utils ./util ./WGLMeshTemplate ./WGLBaseLineTemplate".split(" "),function(z,E,D,C,A,m,c,b,d,a,e){const f=E.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");return function(g){function q(h,
n,u,t,k,v,p,r,w,l,x,y,B,F,G,J){var K=g.call(this)||this;h=m.LineMaterialKey.load(h);n&&(h.sdf=n.sdf,h.pattern=!0,h.textureBinding=n.textureBinding);K._capType=t;K._joinType=k;K._miterLimitCosine=d.getLimitCosine(v);K.tessellationProperties._fillColor=p;K.tessellationProperties._tl=r;K.tessellationProperties._br=w;K._hasPattern=l;K._isDashed=x;K._joinOnUTurn=G;K._isColorLocked=y;K._zOrder=F;K.effects=J;K._materialKey=h.data;K.tessellationProperties._bitset=y?1:0;K.tessellationProperties._halfWidth=
.5*u;K.tessellationProperties._halfReferenceWidth=.5*B;K._initializeTessellator(!1);return K}z._inheritsLoose(q,g);q.fromCIMLine=function(h,n,u){var t=h.color,k=h.scaleFactor||1;const v=h.isDashed;let p=h.cap;v&&1===p&&(p=2);const r=h.join;k*=D.pt2px(h.width);const w=D.pt2px(h.referenceWidth),l=D.pt2px(h.miterLimit);t=t&&c.premultiplyAlphaRGBA(t)||0;if(!n)return new q(h.materialKey,n,k,p,r,l,t,0,0,!1,v,h.colorLocked,w,h.zOrder,u,h.effects);const {rect:x,width:y,height:B}=n;var F=x.x+C.SPRITE_PADDING;
const G=x.y+C.SPRITE_PADDING;var J=F+y;const K=G+B;F=A.i1616to32(F,G);J=A.i1616to32(J,K);return new q(h.materialKey,n,k,p,r,l,t,F,J,!0,v,h.colorLocked,w,h.zOrder,u,h.effects)};q.fromSimpleLine=function(h,n,u){var {color:t}=h;const k="esriSLSSolid"!==h.style&&"esriSLSNull"!==h.style,v=b.getCapType(h.cap||"round",k),p=b.getJoinType(h.join||"round");t=t&&"esriSLSNull"!==h.style&&c.premultiplyAlphaRGBAArray(t)||0;"esriSLSNull"===h.style&&(t=0);const r=D.pt2px(h.width),w=h.miterLimit;if(!n)return new q(h.materialKey,
n,r,v,p,w,t,0,0,!1,k,!1,r,0,u,null);const {rect:l,width:x,height:y}=n;var B=l.x+C.SPRITE_PADDING;const F=l.y+C.SPRITE_PADDING;var G=B+x;const J=F+y;B=A.i1616to32(B,F);G=A.i1616to32(G,J);return new q(h.materialKey,n,r,v,p,w,t,B,G,!0,k,!1,r,0,u,null)};q.fromPictureLineSymbol=function(h,n,u,t){f.error("PictureLineSymbol support does not exist!");return null};return q}(e(a))})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["exports","../../../../../core/promiseUtils"],function(z,E){let D=
function(){function C(){this._resolver=null}var A=C.prototype;A.isHeld=function(){return!!this._resolver};A.acquire=function(){return this._resolver?this._resolver.promise.then(()=>this.acquire()):(this._resolver=E.createResolver(),E.resolve())};A.release=function(){const m=this._resolver;this._resolver=null;m.resolve()};return C}();z.default=D;z.withLock=function(C,A,m){return C.acquire().then(()=>A(m)).then(()=>C.release()).catch(c=>{C.release();throw c;})};Object.defineProperty(z,"__esModule",
{value:!0})})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("exports ../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/has ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../definitions ../../enums ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),function(z,E,D,C,A,m,c,b,d,a,e,f){D=function(){function g(h,n,u){this._isDD=!1;this._geometryType=
h;this._idField=n;this._templateStore=u}var q=g.prototype;q.update=function(h,n){this._isDD="simple"===h.mesh.matcher.type&&h.mesh.matcher.isDotDensity;C.isSome(h.mesh.labels)&&this._setLabelTemplates(h.mesh.labels,n)};q._setLabelTemplates=function(h,n){this._labelTemplates=h.map(u=>a.fromLabelClass(u,n))};q.createMeshData=function(h){const n=Array(5),u=this._labelTemplates&&0<this._labelTemplates.length,t="esriGeometryPolyline"===this._geometryType?m.HEURISTIC_GLYPHS_PER_LINE:m.HEURISTIC_GLYPHS_PER_FEATURE;
n[c.WGLGeometryType.MARKER]=new d.VertexVectors(c.WGLGeometryType.MARKER,4*h);n[c.WGLGeometryType.FILL]=new d.VertexVectors(c.WGLGeometryType.FILL,h,this._isDD);n[c.WGLGeometryType.LINE]=new d.VertexVectors(c.WGLGeometryType.LINE,h);n[c.WGLGeometryType.TEXT]=new d.VertexVectors(c.WGLGeometryType.TEXT,4*h);n[c.WGLGeometryType.LABEL]=new d.VertexVectors(c.WGLGeometryType.LABEL,u?4*t:0);return new b.MeshData(n,{features:h,records:h,metrics:0})};q.analyze=async function(h,n,u,t,k){if(!A.isAborted(k)){var v;
"dictionary"===n.type&&(v=await n.analyze(this._idField,h.copy(),u,t,k));for(var p=0;h.next();){var r=void 0;r=v?v[p++]:n.match(this._idField,h,this._geometryType,u,t);h.setGroupId(r);if(f.isDynamicId(r)){r=this._templateStore.getDynamicTemplateGroup(r);for(const w of r)w&&w.analyze&&w.analyze(this._templateStore,h,u,t)}}return this._templateStore.finalize(k)}};q.analyzeGraphics=async function(h,n,u,t,k){if(!A.isAborted(k)){h=h.getCursor();for(n&&await n.analyze(this._idField,h.copy(),u,t,k);h.next();){let v=
h.getGroupId();if(null==v||-1===v)v=n.match(this._idField,h,h.geometryType,u,t),h.setGroupId(v);if(f.isDynamicId(v)){const p=this._templateStore.getDynamicTemplateGroup(v);for(const r of p)r&&r.analyze&&r.analyze(this._templateStore,h,u,t)}h.setGroupId(v)}return this._templateStore.finalize(k)}};q.writeGraphic=function(h,n){var u=n.getGroupId();const t=n.getDisplayId(),k=this._templateStore.getTemplateGroup(u),v=n.geometryType;if(null!=t){if(f.isDynamicId(u))for(const p of k)p.bindFeature(n,null,
null);if(k){h.writeDisplayObject(t,n.readGraphic().insertAfter);for(const p of k)p&&(u=h.get(p.geometryType),p.writeMesh(h,u,n,v,t))}}};q.writeCursor=function(h,n,u,t,k,v){const p=n.getGroupId(),r=n.getDisplayId();var w=this._templateStore.getTemplateGroup(p);if(null!=r&&w){h.writeDisplayObject(r,0);if(f.isDynamicId(p))for(const x of w)x.bindFeature(n,u,t);for(var l of w)u=h.get(l.geometryType),!l.needsPixelBuffer&&n.hasFilter()||l.writeMesh(h,u,n,this._geometryType,r);l=h.hasDisplayRecords();C.isSome(v)&&
l&&(w=v&&this._findLabelRef(w),this._writeLabels(h,n,r,v,w,k));h.endDisplayObject()}};q._findLabelRef=function(h){for(const n of h)if(n instanceof e)return n;return null};q._writeLabels=function(h,n,u,t,k,v){for(const p of t)if(C.isSome(p)&&p){const {glyphs:r,rtl:w,index:l}=p;t=this._labelTemplates[l];const x=h.get(t.geometryType);t.bindReferenceTemplate(k);t.bindTextInfo(r,w);t.writeMesh(h,x,n,this._geometryType,u,v)}};E._createClass(g,[{key:"templates",get:function(){return this._templateStore}}]);
return g}();z.WGLMeshFactory=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../Utils","../util/Writer","./VertexBuffer"],function(z,E,D,C,A){let m=function(){function b(d,a){this.data=d;this.stride=a}b.prototype.transfer=function(d,a){const e=this.data.buffer();d.vertexCount=this.vertexCount;d.data=e;d.stride=this.stride;a.push(e)};E._createClass(b,[{key:"vertexCount",
get:function(){const d=this.data.length/(this.stride/4);d!==(d|0)&&console.debug("Corrupted stride");return d}}]);return b}(),c=function(){function b(a,e,f=!1){this.geometryType=a;this.indexVector=new C(Uint32Array,6*e);this.namedVectors={};a=D.getStrides(a,f);for(const g in a){f=a[g];let q;switch(f%4){case 0:case 2:q=new C(Uint32Array,f*e);break;case 1:case 3:q=new C(Uint8Array,f*e)}this.namedVectors[g]=new m(q,f)}}var d=b.prototype;d.get=function(a){return this.namedVectors[a].data};d.getVector=
function(a){return this.namedVectors[a]};d.transfer=function(a,e){const f=this.indexVector.buffer(),g={};e.push(f);for(const q in this.namedVectors){const h=this.namedVectors[q];g[q]={};h.transfer(g[q],e)}a.geometryType=this.geometryType;a.indexBuffer=f;a.namedBuffers=g;this.destroy()};d.intoBuffers=function(){const a=A.VertexBuffers.fromVertexVectors(this);this.destroy();return a};d.destroy=function(){this.namedVectors=this.indexVector=null};return b}();z.VertexVectors=c;z.default=m;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("../../../../../../chunks/_rollupPluginBabelHelpers ../../../../../../core/maybe ../../../../../../core/Logger ../../../../../../core/Error ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../definitions ../../alignmentUtils ../../number ../../enums ./meshUtils ../../materialKey/MaterialKey ../../color ../../collisions/Metric ./segmentUtils ./WGLTextTemplate".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){const u=D.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),t=(v,p="mapview-labeling")=>u.error(new C(p,v)),k=function(v){const p=new Map;return r=>{p.has(r)||p.set(r,v(r));return p.get(r)}}(v=>{let p=0;if(0===v)return Infinity;for(;!(v%2);)p++,v/=2;return p});return function(v){function p(w,l,x,y){var B=v.call(this,w,x.font.size,x.haloSize||0,x.color&&g.premultiplyAlphaRGBAArray(x.color)||0,x.haloColor&&g.premultiplyAlphaRGBAArray(x.haloColor)||0,
x.horizontalAlignment,x.verticalAlignment,e.isMapAligned(l.labelPlacement)?1:0,x.font.decoration,!1,x.angle||0,x.xoffset,x.yoffset,x.lineWidth,x.lineHeight,null,null)||this;B._outLineLabelAngle=0;B._refPlacementPadding=0;B._refPlacementDirX=0;B._refPlacementDirY=0;B._refOffsetX=0;B._refOffsetY=0;B.geometryType=a.WGLGeometryType.LABEL;var F=!!l.minScale&&y.scaleToZoom(l.minScale)||0;F=A.clamp(F,0,25.5);y=!!l.maxScale&&y.scaleToZoom(l.maxScale)||255;y=A.clamp(y,0,25.5);const [G,J]=b.getAlignmentFromPlacement(l.labelPlacement);
B._xAlignD=G;B._yAlignD=J;B._minZoom=F;B._maxZoom=y;B._refPlacementPadding=m.pt2px(x.haloSize)+c.TEXT_PLACEMENT_PADDING;w=f.LabelMaterialKey.load(w);w.sdf=!0;B._materialKey=w.data;return B}z._inheritsLoose(p,v);p.fromLabelClass=function(w,l){if("center-along"===w.labelPlacement){const x=w.symbol;x.xoffset=0;x.yoffset=0;x.angle=0;x.font.decoration="none"}return new p(w.materialKey,w,w.symbol,l)};var r=p.prototype;r.bindReferenceTemplate=function(w){let l=b.getXDirection(this._xAlignD),x=b.getYDirection(this._yAlignD);
this._refOffsetY=this._refOffsetX=0;if(E.isNone(w))this._refSymbolAndPlacementOffset=d.i8888to32(0,0,Math.floor(127*l+127),Math.floor(127*x+127));else{if("circle"===w.boundsType&&(l||x)){var y=Math.sqrt(l*l+x*x);l/=y;x/=y}y=Math.max(w.height,w.width);this._refSymbolAndPlacementOffset=d.i8888to32(4*this._refPlacementPadding,y,Math.floor(127*l+127),Math.floor(127*x+127));this._referenceSize=y;this._refPlacementDirX=l;this._refPlacementDirY=x;this._refOffsetX=w.xOffset;this._refOffsetY=w.yOffset}};r.writeMesh=
function(w,l,x,y,B,F){if(!E.isNone(this._shapingInfo)){var G=[],J=this._shapingInfo;if(x="esriGeometryPolygon"===x.geometryType?x.readLegacyCentroid():x.readLegacyGeometry()){this.current={out:w,outVecs:l,outMetrics:G,inId:B,inShaping:J,zoomLevel:F};switch(y){case "esriGeometryPolyline":this._placeLineLabels(x);break;case "esriGeometryPoint":case "esriGeometryPolygon":this._placePointLabels(x);break;default:t("mapview-labeling",`Geometry of type ${y} is not supported`)}w.writeMetrics(this.current.outMetrics)}}};
r._isVisible=function(w,l){const x=Math.floor(10*this.current.zoomLevel);return Math.floor(10*w)<=x&&x<=Math.floor(10*l)};r._placePointLabels=function(w){const {out:l,outVecs:x,outMetrics:y,inId:B}=this.current;this._writeGlyphs(l,x,B,w,y)};r._placeLineLabels=function(w){w=h.smoothPaths(w.paths,this.current.inShaping.bounds.width);const l=this._placeSubdivGlyphs.bind(this),x=(this._shapedBox.width+128)/4;for(const y of w)h.pathDivide(y,x,l)};r._placeSubdivGlyphs=function(w,l,x,y){var B=k(l);x=A.log2(Math.min(x,
y-x)/(4+this._shapedBox.width/4/2));B=Math.max(this._minZoom,this.current.zoomLevel+2-(0===l?x:Math.min(B,x)));x=this._shapedBox.width/2*Math.pow(2,this.current.zoomLevel-B);this.current.inShaping.isMultiline?0===l&&this._placeStraight(w,B):this._placeCurved(w,B,x)};r._placeStraight=function(w,l){const {out:x,outVecs:y,outMetrics:B,inId:F}=this.current;this._writeGlyphs(x,y,F,w,B,l)};r._placeCurved=function(w,l,x){var y={from:this.current.out.currentDisplayRecordCount(),count:-1};y=new q(this.current.inId,
y,w.x,w.y,l);const B=w.clone(),F=(180/Math.PI*w.angle+180)%360;this._outLineLabelAngle=Math.round(180/Math.PI*w.angle%360*(254/360));this._placeFirst(B,y,l,1);this._placeBack(w,B,y,l,x,1);this._placeForward(w,B,y,l,x,1);this._outLineLabelAngle=Math.round(254/360*F);this._placeFirst(B,y,l,0);this._placeBack(w,B,y,l,x,0);this._placeForward(w,B,y,l,x,0);y.range.count=this.current.out.currentDisplayRecordCount()-y.range.from;y.bounds&&this.current.outMetrics.push(y)};r._placeBack=function(w,l,x,y,B,F){const G=
w.clone();for(w=w.backwardLength+0;G.prev()&&!(w>=B);)this._placeOnSegment(G,l,x,w,y,-1,F),w+=G.length+0};r._placeForward=function(w,l,x,y,B,F){const G=w.clone();for(w=w.remainingLength+0;G.next()&&!(w>=B);)this._placeOnSegment(G,l,x,w,y,1,F),w+=G.length+0};r._placeFirst=function(w,l,x,y){const B=this.current.inShaping;var F=B.glyphs;const G=this.current.zoomLevel,{out:J,outVecs:K,inId:M}=this.current,R=d.i1616to32(Math.round(8*w.x),Math.round(8*w.y));for(const N of F)F=N.x>B.bounds.x?y:1-y,F=Math.max(0,
G+A.log2(Math.abs(N.x+N.width/2-B.bounds.x)/(F*w.remainingLength+(1-F)*w.backwardLength))),F=Math.max(x,F),N.maxZoom=25,N.angle=w.angle+(1-y)*Math.PI,N.minZoom=F,this._writeGlyph(J,K,N,M,R),y&&this._isVisible(N.minZoom,N.maxZoom)&&l.add(N.bounds,0,0)};r._placeOnSegment=function(w,l,x,y,B,F,G){var J=this.current.inShaping.glyphs;const {out:K,outVecs:M,inId:R}=this.current,N=this.current.inShaping,I=this.current.zoomLevel,H=d.i1616to32(Math.round(8*(w.x+w.dx/w.length*-F*y)),Math.round(8*(w.y+w.dy/w.length*
-F*y)));for(const W of J)if((J=W.x>N.bounds.x?G:1-G)&&1===F||!J&&-1===F){var Q=Math.abs(W.x+W.width/2-N.bounds.x);J=Math.max(0,I+A.log2(Q/y)-.1);Q=Math.max(B,I+A.log2(Q/(y+w.length+0)));0!==J&&(W.angle=w.angle+(1-G)*Math.PI,W.minZoom=Q,W.maxZoom=J,this._writeGlyph(K,M,W,R,H),G&&this._isVisible(W.minZoom,W.maxZoom)&&x.add(W.bounds,w.x-l.x,w.y-l.y))}};r._writeGlyphs=function(w,l,x,y,B,F=this._minZoom){const G=this._shapingInfo;if(!(E.isNone(G)||0>y.x||512<=y.x||0>y.y||512<=y.y)){var J=w.currentDisplayRecordCount(),
K=d.i1616to32(Math.round(8*(y.x+this._refOffsetX)),Math.round(8*(y.y-this._refOffsetY)));y=new q(x,{from:J,count:-1},y.x+this._refOffsetX,y.y-this._refOffsetY,F);for(const M of G.glyphs)M.minZoom=F,M.maxZoom=this._maxZoom,this._writeGlyph(w,l,M,x,K);y.range.count=w.currentDisplayRecordCount()-y.range.from;y.bounds=G.boundsT;w=f.LabelMaterialKey.load(this._materialKey);y.setPlacementOffset(w.vvSizeFieldStops||w.vvSizeMinMaxValue||w.vvSizeScaleStops||w.vvSizeUnitValue,this._referenceSize,this._refPlacementPadding,
this._refPlacementDirX,this._refPlacementDirY);B.push(y)}};r._writeGlyph=function(w,l,x,y,B){const F=f.MaterialKeyBase.load(this._materialKey);F.textureBinding=x.textureBinding;const G=l.indexVector.length,J=l.getVector("geometry").vertexCount,K=this._writeIndices(l);l=this._writeVertex(l,y,B,x);w.writeDisplayRecord(this.geometryType,F.data,J,l,G,K)};r._writeVertexCommon=function(w,l,x,y){const B=this._color,F=this._haloColor,G=d.i8888to32(0,0,this._size,this._haloSize);y=d.i8888to32(Math.floor(10*
Math.max(y.minZoom,this._minZoom)),Math.floor(10*Math.min(y.maxZoom,this._maxZoom)),this._outLineLabelAngle,0);w.push(x);w.push(l);w.push(B);w.push(F);w.push(G);w.push(this._refSymbolAndPlacementOffset);w.push(y)};z._createClass(p,[{key:"_shapedBox",get:function(){return E.unwrap(this._shapingInfo).bounds}}]);return p}(n)})},"esri/views/2d/engine/webgl/mesh/templates/segmentUtils":function(){define(["exports","../../../../../../chunks/_rollupPluginBabelHelpers","../../../../../../core/maybe","./util"],
function(z,E,D,C){function A(a){return a.length-1}function m(a){let e=0;for(let f=0;f<A(a);f++)e+=c(a,f);return e}function c(a,e,f=1){const [g,q]=a[e+1];return Math.sqrt(g*g+q*q)*f}function b(a,e,f,g,q){if(!(f<e)){var h=g.clone().seek(f/2);D.isNone(h)||(a(h.clone(),f,q),f=(f-e)/2,h=D.unwrap(h.seek(e/2)),b(a,e,f,g,q+1),b(a,e,f,h,q+1))}}let d=function(){function a(f,g,q,h,n){this._segments=f;this._index=g;this._distance=q;this._xStart=h;this._yStart=n;this._done=!1}a.create=function(f){return new a(f,
0,0,f[0][0],f[0][1])};var e=a.prototype;e.clone=function(){return new a(this._segments,this._index,this._distance,this.xStart,this.yStart)};e.equals=function(f){return this._index===f._index||f._index===this._index-1&&(0===this._distance||1===f._distance)||f._index===this._index+1&&(1===this._distance||0===f._distance)};e.leq=function(f){return this._index<f._index||this._index===f._index&&this._distance<=f._distance};e.geq=function(f){return this._index>f._index||this._index===f._index&&this._distance>=
f._distance};e.hasPrev=function(){return 0<=this._index-1};e.hasNext=function(){return this._index+1<A(this._segments)};e.next=function(){if(!this.hasNext())return null;this._xStart+=this.dx;this._yStart+=this.dy;this._distance=0;this._index+=1;return this};e.prev=function(){if(!this.hasPrev())return this._done=!0,null;--this._index;this._xStart-=this.dx;this._yStart-=this.dy;this._distance=1;return this};e._seekBackwards=function(f,g){var q=this.backwardLength;if(f<=q)return this._distance=(q-f)/
this.length,this;for(q=this.backwardLength;this.prev();){if(q+this.length>f)return this._seekBackwards(f-q);q+=this.length}this._distance=0;return g?this:null};e.seek=function(f,g=!1){if(0>f)return this._seekBackwards(Math.abs(f),g);if(f<=this.remainingLength)return this._distance=(this.backwardLength+f)/this.length,this;let q=this.remainingLength;for(;this.next();){if(q+this.length>f)return this.seek(f-q,g);q+=this.length}this._distance=1;return g?this:null};E._createClass(a,[{key:"_segment",get:function(){return this._segments[this._index+
1]}},{key:"angle",get:function(){const f=this.dy;let g=Math.acos((0*f+-1*-this.dx)/(1*this.length));0<f&&(g=2*Math.PI-g);return g}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+
.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){const {dx:f,dy:g}=this;return Math.sqrt(f*f+g*g)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}}]);
return a}();z.SegmentCursor=d;z.pathDivide=function(a,e,f){const g=m(a);a=d.create(a);const q=g/2,h=Math.floor((g-e)/2/e);a.seek(q-h*e);for(let n=-h;n<=h;n++)512>a.x&&0<=a.x&&512>a.y&&0<=a.y&&f(a.clone(),n,q+n*e,g),a.seek(e)};z.pathLength=m;z.pathSubdivide=function(a,e,f){b(f,e,m(a),d.create(a),0)};z.segmentAt=function(a,e){return a[e+1]};z.segmentCount=A;z.segmentLength=c;z.smoothPaths=function(a,e){for(let B=0;B<a.length;B++){var f=a[B];const F=[];F.push(f[0]);for(var g=1;g<f.length;g++){let [G,
J]=F[g-1];G+=f[g][0];J+=f[g][1];F.push([G,J])}a:{f=F;g=e;if(0>=g)break a;const G=f.length;if(3>G)break a;const J=[];var q=0;J.push(0);for(var h=1;h<G;h++)q+=C.dist(f[h],f[h-1]),J.push(q);g=Math.min(g,.2*q);q=[];q.push(f[0][0]);q.push(f[0][1]);h=f[G-1][0];const K=f[G-1][1];var n=C.sub([0,0],f[0],f[1]);C.normalize(n);f[0][0]+=g*n[0];f[0][1]+=g*n[1];C.sub(n,f[G-1],f[G-2]);C.normalize(n);f[G-1][0]+=g*n[0];f[G-1][1]+=g*n[1];for(n=1;n<G;n++)J[n]+=g;J[G-1]+=g;n=.5*g;for(let M=1;M<G-1;M++){let R=0,N=0,I=
0;for(var u=M-1;0<=u&&!(J[u+1]<J[M]-n);u--){var t=n+J[u+1]-J[M],k=J[u+1]-J[u],v=J[M]-J[u]<n?1:t/k;if(1E-6>Math.abs(v))break;var p=v*v,r=v*t-.5*p*k,w=v*k/g,l=f[u+1],x=f[u][0]-l[0],y=f[u][1]-l[1];R+=w/r*(l[0]*v*t+.5*p*(t*x-k*l[0])-p*v*k*x/3);N+=w/r*(l[1]*v*t+.5*p*(t*y-k*l[1])-p*v*k*y/3);I+=w}for(u=M+1;u<G&&!(J[u-1]>J[M]+n);u++){t=n-J[u-1]+J[M];k=J[u]-J[u-1];v=J[u]-J[M]<n?1:t/k;if(1E-6>Math.abs(v))break;p=v*v;r=v*t-.5*p*k;w=v*k/g;l=f[u-1];x=f[u][0]-l[0];y=f[u][1]-l[1];R+=w/r*(l[0]*v*t+.5*p*(t*x-k*l[0])-
p*v*k*x/3);N+=w/r*(l[1]*v*t+.5*p*(t*y-k*l[1])-p*v*k*y/3);I+=w}q.push(R/I);q.push(N/I)}q.push(h);q.push(K);for(let M=0,R=0;M<G;M++)f[M][0]=q[R++],f[M][1]=q[R++]}f=[];f.push(F[0]);for(g=1;g<F.length;g++){const [G,J]=F[g-1],[K,M]=F[g];f.push([Math.round(K-G),Math.round(M-J)])}a[B]=f}return a};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/maybe ../../../../../core/Logger ../../../../../core/Error ../../../../../core/promiseUtils ../../../../../core/mathUtils ../../../../../core/accessorSupport/diffUtils ../../../../../layers/support/FieldsIndex ../../../engine/webgl/definitions ../../../engine/webgl/Utils ../../../engine/webgl/util/debug ../tileRenderers/support/visualVariablesUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h){function n(r,w){return l=>w(r(l))}const u=m.getLogger("esri.views.layers.2d.features.support.AttributeStore"),t=q.createDebugLogger(q.DEBUG_ATTR_UPDATES,u);var k=C("esri-shared-array-buffer"),v=C("esri-atomics");let p=function(){function r(l,x,y,B){this.size=0;this.texelSize=4;const {pixelType:F,layout:G,textureOnly:J}=B;this.textureOnly=J||!1;this.pixelType=F;this._ctype=x;this.layout=G;this._resetRange();this._shared=l;this.size=y;J||(this.data=this._initData(F,
y,l,x))}var w=r.prototype;w.unsetComponentAllTexels=function(l,x){const y=A.unwrap(this.data);for(let B=0;B<this.size*this.size;B++)y[B*this.texelSize+l]&=~x;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponentAllTexels=function(l,x){const y=A.unwrap(this.data);for(let B=0;B<this.size*this.size;B++)y[B*this.texelSize+l]|=255&x;this.dirtyStart=0;this.dirtyEnd=this.size*this.size-1};w.setComponent=function(l,x,y){const B=A.unwrap(this.data);for(const F of y)B[F*this.texelSize+l]|=x,
this.dirtyStart=Math.min(this.dirtyStart,F),this.dirtyEnd=Math.max(this.dirtyEnd,F)};w.setComponentTexel=function(l,x,y){A.unwrap(this.data)[y*this.texelSize+l]|=x;this.dirtyStart=Math.min(this.dirtyStart,y);this.dirtyEnd=Math.max(this.dirtyEnd,y)};w.unsetComponentTexel=function(l,x,y){A.unwrap(this.data)[y*this.texelSize+l]&=~x;this.dirtyStart=Math.min(this.dirtyStart,y);this.dirtyEnd=Math.max(this.dirtyEnd,y)};w.getData=function(l,x){l&=2147483647;return A.unwrap(this.data)[l*this.texelSize+x]};
w.setData=function(l,x,y){l&=2147483647;0===(this.layout&1<<x)?u.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[l*this.texelSize+x]=y,this.dirtyStart=Math.min(this.dirtyStart,l),this.dirtyEnd=Math.max(this.dirtyEnd,l))};w.lock=function(){5121===this.pixelType&&this._shared&&v&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};w.unlock=function(){5121===this.pixelType&&this._shared&&v&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};w.expand=
function(l){this.size=l;if(!this.textureOnly){l=this._initData(this.pixelType,l,this._shared,this._ctype);const x=A.unwrap(this.data);l.set(x);this.data=l}};w.toMessage=function(){const l=this.dirtyStart,x=this.dirtyEnd;var y=this.texelSize;if(l>x)return null;this._resetRange();const B=!this._shared&&"local"!==this._ctype,F=this.pixelType,G=this.layout,J=A.unwrap(this.data);if(!J.slice){if(!B)return{start:l,end:x,data:null,pixelType:F,layout:G};y=new (g.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,
l*y,(x+1)*y));return{start:l,end:x,data:y,pixelType:F,layout:G}}y=B&&J.slice(l*y,(x+1)*y)||null;return{start:l,end:x,data:y,pixelType:F,layout:G}};w._initData=function(l,x,y,B){y=y&&"local"!==B?SharedArrayBuffer:ArrayBuffer;l=g.getPixelArrayCtor(l);x=new l(new y(x*x*4*l.BYTES_PER_ELEMENT));for(l=0;l<x.length;l+=4)x[l+1]=255;return x};w._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};D._createClass(r,[{key:"buffer",get:function(){return A.andThen(this.data,l=>l.buffer)}}]);return r}();
m=function(){function r(l,x){this._client=l;this.config=x;this._attributeComputeMap=new Map;this._blocks=[];this._filters=Array(f.MAX_FILTERS);this._targetType=0;this._abortController=b.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idsToHighlight=new Set;l=x.supportsTextureFloat?5126:5121;t(`Creating AttributeStore ${k?"with":"without"} shared memory`);this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:l,layout:15},{pixelType:l,
layout:15}];this._blocks=this._blockDescriptors.map(()=>null)}var w=r.prototype;w.destroy=function(){this._abortController.abort()};w.update=function(l,x){this.config=x;x=x.schema.processors[0].storage;const y=a.diff(this._schema,x);if(l.targets.feature||l.targets.aggregate)l.storage.data=!0;if(y&&(C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",y),l.storage.data=!0,this._schema=x,this._attributeComputeMap.clear(),!A.isNone(x))){switch(x.target){case "feature":this._targetType=
0;break;case "aggregate":this._targetType=1}for(const B of x.mapping)this._bindAttribute(B)}};w.onTileData=function(l,x){if(!A.isNone(x.addOrUpdate))for(l=x.addOrUpdate.getCursor();l.next();)x=l.getDisplayId(),this.setAttributeData(x,l)};w.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=b.createAbortController()};w.setHighlight=async function(l,x){const y=this._getBlock(0);x=x.map(B=>B&2147483647);y.lock();y.unsetComponentAllTexels(0,
1);y.setComponent(0,1,x);y.unlock();this._idsToHighlight.clear();for(const B of l)this._idsToHighlight.add(B);await this.sendUpdates()};w.updateFilters=async function(l,x){const {config:y,service:B,spatialReference:F}=x;({filters:x}=y);x=x.map((G,J)=>this._updateFilter(G,J,B,F));(await b.all(x)).some(G=>G)&&(l.storage.filters=!0,C("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))};w.setData=function(l,x,y,B){this._ensureSizeForTexel(l&2147483647);this._getBlock(x).setData(l,
y,B)};w.getData=function(l,x,y){return this._getBlock(x).getData(l,y)};w.getHighlightFlag=function(l){return this._idsToHighlight.has(l)?f.HIGHLIGHT_FLAG:0};w.unsetAttributeData=function(l){l&=2147483647;this._getBlock(0).setData(l,0,0)};w.setAttributeData=function(l,x){const y=l&2147483647;this._ensureSizeForTexel(y);this._getBlock(0).setData(y,0,this.getFilterFlags(x));if(this._targetType===(l&2147483648)>>>31){l=this._attributeComputeMap;var B=this.config.supportsTextureFloat?1:2;l.size&&l.forEach((F,
G)=>{const J=G*B%4;G=this._getBlock(Math.floor(G*B/4)+f.ATTRIBUTE_DATA_VV);F=F(x);if(this.config.supportsTextureFloat)G.setData(y,J,F);else if(F===f.NAN_MAGIC_NUMBER)G.setData(y,J,255),G.setData(y,J+1,255);else{F=d.clamp(Math.round(F),-32767,32766)+32768;const K=(F&65280)>>8;G.setData(y,J,F&255);G.setData(y,J+1,K)}})}};w.sendUpdates=function(){if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=b.createResolver(),this._nextUpdate.promise;const l={blocks:this._blocks.map(x=>
A.isSome(x)?x.toMessage():null)};return this._currUpdate=this._createResources().then(()=>{var x=()=>{this._currUpdate=null;if(this._nextUpdate){const y=this._nextUpdate;this._nextUpdate=null;this.sendUpdates().then(()=>y.resolve())}};x=this._client.update(l,this._signal).then(x).catch(x);this._client.render(this._signal);return x}).catch(x=>{if(b.isAbortError(x))return this._createResourcesPromise=null,this._createResources();u.error(new c("mapview-attribute-store","Encountered an error during client update",
x));return b.resolve()})};w._ensureSizeForTexel=function(l){for(;l>=this._size*this._size&&!this._expand(););};w._bindAttribute=function(l){function x(){return l.normalizationField?F=>{const G=F.readAttribute(l.normalizationField);return G?F.readAttribute(l.field)/G:null}:F=>F.readAttribute(l.field)}function y(){l.normalizationField&&u.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported.");return F=>F.getComputedNumericAtIndex(l.fieldIndex)}
let B;if(null!=l.fieldIndex)B=y();else if(l.field)B=x();else return;l.valueRepresentation&&(B=n(B,F=>h.getVisualVariableSizeValueRepresentationRatio(F,l.valueRepresentation)));this._attributeComputeMap.set(l.binding,n(B,F=>null===F||isNaN(F)||Infinity===F?f.NAN_MAGIC_NUMBER:F))};w._createResources=function(){if(A.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(f.ATTRIBUTE_DATA_ANIMATION);t("Initializing AttributeStore");var l={shared:k&&"local"!==this._client.type,
size:this._size,blocks:A.mapMany(this._blocks,x=>({textureOnly:x.textureOnly,buffer:x.buffer,pixelType:x.pixelType}))};this._createResourcesPromise=l=this._client.initialize(l,this._signal).catch(x=>{b.isAbortError(x)?this._createResourcesPromise=null:u.error(new c("mapview-attribute-store","Encountered an error during client initialization",x))});l.then(()=>A.isNone(this._createResourcesPromise)?this._createResources():void 0);return l};w._getBlock=function(l){var x=this._blocks[l];if(A.isSome(x))return x;
t(`Initializing AttributeBlock at index ${l}`);x=new p(k,this._client.type,this._size,this._blockDescriptors[l]);this._blocks[l]=x;this._createResourcesPromise=null;return x};w._expand=function(){if(this._size<this.config.maxTextureSize){const l=this._size<<=1;t("Expanding block size to",l,this._blocks);A.forEachSome(this._blocks,x=>x.expand(l));this._createResourcesPromise=null;this._size=l;return 0}u.error(new c("mapview-limitations","Maximum number of onscreen features exceeded."));return-1};w._updateFilter=
async function(l,x,y,B){const F=this._filters[x],G=A.isSome(F)&&F.hash;if(!F&&!l||G===JSON.stringify(l))return!1;if(A.isNone(l))return l=1<<x+1,y=this._getBlock(0),this._filters[x]=null,y.setComponentAllTexels(0,l),this.sendUpdates(),!0;await (await this._getFilter(x,y)).update(l,B);return!0};w._getFilter=async function(l,x){var y=this._filters[l];if(A.isSome(y))return y;({default:y}=await new Promise(function(B,F){z(["../../../../../layers/graphics/data/FeatureFilter"],function(G){B(Object.freeze({__proto__:null,
"default":G}))},F)}));x=new y({geometryType:x.geometryType,hasM:!1,hasZ:!1,timeInfo:x.timeInfo,fieldsIndex:new e(x.fields)});return this._filters[l]=x};w.isVisible=function(l){return!!(this._getBlock(0).getData(l,0)&2)};w.getFilterFlags=function(l){let x=0;var y=1===(l.getDisplayId()&2147483648)>>>31?254:255;for(let F=0;F<this._filters.length;F++){var B=this._filters[F];B=!(y&1<<F)||A.isNone(B)||B.check(l);x|=(B?1:0)<<F}y=0;this._idsToHighlight.size&&(l=l.getObjectId(),y=this.getHighlightFlag(l));
return x<<1|y};D._createClass(r,[{key:"hasScaleExpr",get:function(){return this._hasScaleExpr}},{key:"_signal",get:function(){return this._abortController.signal}}]);return r}();E.DISPLAY_ID_TYPE_AGGREGATE=1;E.DISPLAY_ID_TYPE_FEATURE=0;E.default=m;E.isAggregateId=function(r){return 1===(r&2147483648)>>>31};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/util/debug":function(){define(["exports"],function(z){z.DEBUG_ATTR_UPDATES=!1;z.createDebugLogger=(E,D)=>E&&((...C)=>
D.warn("DEBUG:",...C))||(()=>null);Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("exports ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../engine/webgl/definitions ../../../../engine/webgl/enums ../../../../engine/webgl/color ../../../../engine/webgl/visualVariablesUtils".split(" "),function(z,E,D,C,A,m,c){function b(h){return{value:h.value,size:D.toPt(h.size)}}function d(h){return h.map(n=>
b(n))}function a(h){return"string"===typeof h||"number"===typeof h?D.toPt(h):{type:"size",expression:h.expression,stops:d(h.stops)}}function e(h){const n={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"===typeof h.field)if(h.stops){if(8<h.stops.length)return null;h=h.stops;for(var u=0;8>u;++u){const t=h[Math.min(u,h.length-1)];n.values[u]=t.value;n.opacities[u]=t.opacity}}else return null;else if(h.stops&&0<=h.stops.length)for(h=h.stops&&0<=h.stops.length&&h.stops[0].opacity,u=0;8>
u;u++)n.values[u]=Infinity,n.opacities[u]=h;else return null;return n}function f(h,n,u){h[4*n]=u.r/255;h[4*n+1]=u.g/255;h[4*n+2]=u.b/255;h[4*n+3]=u.a}function g(h){if(E.isNone(h)||h.normalizationField)return null;const n={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"===typeof h.field)if(h.stops){if(8<h.stops.length)return null;n.field=h.field;h=h.stops;for(var u=0;8>u;++u){const t=h[Math.min(u,h.length-1)];n.values[u]=t.value;
f(n.colors,u,t.color)}}else return null;else if(h.stops&&0<=h.stops.length)for(h=h.stops&&0<=h.stops.length&&h.stops[0].color,u=0;8>u;u++)n.values[u]=Infinity,f(n.colors,u,h);else return null;for(h=0;32>h;h+=4)m.premultiplyAlpha(n.colors,h,!0);return n}const q=h=>{const n=[],u=[];h=d(h);const t=h.length;for(let k=0;6>k;k++){const v=h[Math.min(k,t-1)];n.push(v.value);u.push(null==v.size?C.NAN_MAGIC_NUMBER:D.pt2px(v.size))}return{values:new Float32Array(n),sizes:new Float32Array(u)}};z.convertColorVariable=
g;z.convertVisualVariables=function(h){const n=h&&0<h.length?{}:null,u=n?{}:null;if(!n)return{vvFields:n,vvRanges:u};for(const t of h)if(t.field&&(n[t.type]=t.field),"size"===t.type)switch(u.size||(u.size={}),h=t,c.getTypeOfSizeVisualVariable(h)){case A.WGLVVFlag.SIZE_MINMAX_VALUE:u.size.minMaxValue={minDataValue:h.minDataValue,maxDataValue:h.maxDataValue,minSize:a(h.minSize),maxSize:a(h.maxSize)};break;case A.WGLVVFlag.SIZE_SCALE_STOPS:u.size.scaleStops={stops:d(h.stops)};break;case A.WGLVVFlag.SIZE_FIELD_STOPS:if(h.levels){const k=
{};for(const v in h.levels)k[v]=q(h.levels[v]);u.size.fieldStops={type:"level-dependent",levels:k}}else u.size.fieldStops={type:"static",...q(h.stops)};break;case A.WGLVVFlag.SIZE_UNIT_VALUE:u.size.unitValue={unit:h.valueUnit,valueRepresentation:h.valueRepresentation}}else"color"===t.type?u.color=g(t):"opacity"===t.type?u.opacity=e(t):"rotation"===t.type&&(u.rotation={type:t.rotationType});return{vvFields:n,vvRanges:u}};z.getVisualVariableSizeValueRepresentationRatio=function(h,n){if(!h||!n)return h;
switch(n){case "radius":case "distance":return 2*h;case "area":return Math.sqrt(h)}return h};z.getVisualVariablesFields=function(h){const n=h&&0<h.length?{}:null;n&&h.forEach(u=>{const t=u.type;u.field&&(n[t]=u.field)});return n};z.normalizeSizeElement=a;z.normalizeSizeStops=d;z.stopToSizeStop=b;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/ComputedAttributeStorage":function(){define(["exports","./displayIdUtils","./StaticBitSet"],function(z,E,D){function C(m,
c,b){if(!(m.length>c))for(;m.length<=c;)m.push(b)}let A=function(){function m(){this._numerics=[];this._strings=[];this._idGenerator=new E.DisplayIdGenerator;this._allocatedSize=256;this._bitsets=[];this._instanceIds=[];this._bounds=[]}var c=m.prototype;c.createBitset=function(){const b=this._bitsets.length;this._bitsets.push(D.StaticBitSet.create(this._allocatedSize,2147483647));return b+1};c.getBitset=function(b){return this._bitsets[b-1]};c._expand=function(){this._allocatedSize<<=1;for(const b of this._bitsets)b.resize(this._allocatedSize)};
c._ensureNumeric=function(b,d){this._numerics[b]||(this._numerics[b]=[]);C(this._numerics[b],d,0)};c._ensureInstanceId=function(b){C(this._instanceIds,b,0)};c._ensureString=function(b,d){this._strings[b]||(this._strings[b]=[]);C(this._strings[b],d,null)};c.createDisplayId=function(b=!1){const d=this._idGenerator.createId();d>this._allocatedSize&&this._expand();return((b?2147483648:0)|d)>>>0};c.releaseDisplayId=function(b){for(const d of this._bitsets)d.unset(b);return this._idGenerator.releaseId(b&
2147483647)};c.getComputedNumeric=function(b,d){return this.getComputedNumericAtIndex(b&2147483647,0)};c.setComputedNumeric=function(b,d,a){return this.setComputedNumericAtIndex(b&2147483647,a,0)};c.getComputedString=function(b,d){return this.getComputedStringAtIndex(b&2147483647,0)};c.setComputedString=function(b,d,a){return this.setComputedStringAtIndex(b&2147483647,0,a)};c.getComputedNumericAtIndex=function(b,d){b&=2147483647;this._ensureNumeric(d,b);return this._numerics[d][b]};c.setComputedNumericAtIndex=
function(b,d,a){b&=2147483647;this._ensureNumeric(d,b);this._numerics[d][b]=a};c.getInstanceId=function(b){b&=2147483647;this._ensureInstanceId(b);return this._instanceIds[b]};c.setInstanceId=function(b,d){b&=2147483647;this._ensureInstanceId(b);this._instanceIds[b]=d};c.getComputedStringAtIndex=function(b,d){b&=2147483647;this._ensureString(d,b);return this._strings[d][b]};c.setComputedStringAtIndex=function(b,d,a){b&=2147483647;this._ensureString(d,b);this._strings[d][b]=a};c.getXMin=function(b){return this._bounds[4*
(b&2147483647)]};c.getYMin=function(b){return this._bounds[4*(b&2147483647)+1]};c.getXMax=function(b){return this._bounds[4*(b&2147483647)+2]};c.getYMax=function(b){return this._bounds[4*(b&2147483647)+3]};c.setBounds=function(b,d){d=d.readHydratedGeometry();if(!d||!d.coords.length)return!1;let a=Infinity,e=Infinity,f=-Infinity,g=-Infinity;d.forEachVertex((q,h)=>{a=Math.min(a,q);e=Math.min(e,h);f=Math.max(f,q);g=Math.max(g,h)});b&=2147483647;C(this._bounds,4*b+4,0);this._bounds[4*b]=a;this._bounds[4*
b+1]=e;this._bounds[4*b+2]=f;this._bounds[4*b+3]=g;return!0};return m}();z.ComputedAttributeStorage=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/displayIdUtils":function(){define(["exports"],function(z){let E=function(){function D(){this._freeIds=[];this._idCounter=1}var C=D.prototype;C.createId=function(A=!1){var m=this._getFreeId();return((A?2147483648:0)|m)>>>0};C.releaseId=function(A){this._freeIds.push(A)};C._getFreeId=function(){return this._freeIds.length?
this._freeIds.pop():this._idCounter++};return D}();z.DISPLAY_ID_TYPE_AGGREGATE=1;z.DISPLAY_ID_TYPE_FEATURE=0;z.DisplayIdGenerator=E;z.getDisplayIdIndex=function(D){return D&2147483647};z.getDisplayIdType=function(D){return(D&2147483648)>>>31};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/StaticBitSet":function(){define(["exports"],function(z){let E=function(){function D(A,m){this._mask=0;this._buf=A;this._mask=m}D.fromBuffer=function(A,m){return new D(A,
m)};D.create=function(A,m=4294967295){A=new Uint32Array(Math.ceil(A/32));return new D(A,m)};var C=D.prototype;C._getIndex=function(A){return Math.floor(A/32)};C.has=function(A){A&=this._mask;return!!(this._buf[this._getIndex(A)]&1<<A%32)};C.set=function(A){A&=this._mask;const m=this._getIndex(A);this._buf[m]|=1<<A%32};C.unset=function(A){A&=this._mask;const m=this._getIndex(A);this._buf[m]&=4294967295^1<<A%32};C.resize=function(A){const m=this._buf;A=new Uint32Array(Math.ceil(A/32));A.set(m);this._buf=
A};C.or=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]|=A._buf[m];return this};C.and=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]&=A._buf[m];return this};C.xor=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]^=A._buf[m];return this};C.ior=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]|=~A._buf[m];return this};C.iand=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]&=~A._buf[m];return this};C.ixor=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]^=
~A._buf[m];return this};C.any=function(){for(let A=0;A<this._buf.length;A++)if(this._buf[A])return!0;return!1};C.copy=function(A){for(let m=0;m<this._buf.length;m++)this._buf[m]=A._buf[m];return this};C.clone=function(){return new D(this._buf.slice(),this._mask)};C.clear=function(){for(let A=0;A<this._buf.length;A++)this._buf[A]=0};C.forEachSet=function(A){for(let m=0;m<this._buf.length;m++){let c=this._buf[m],b=32*m;if(c)for(;c;)c&1&&A(b),c>>>=1,b++}};C.countSet=function(){let A=0;this.forEachSet(m=>
{A++});return A};return D}();z.StaticBitSet=E;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/GraphicsReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ./FeatureSetReader ./FeatureSetReaderJSON".split(" "),function(z,E,D,C,A,m){m=function(c){function b(a,e){return c.call(this,a,e,null)||this}E._inheritsLoose(b,c);b.from=function(a){const e=
A.FeatureSetReader.createInstance(),f=[];a=a.filter(g=>!!g.geometry);for(const g of a)a=D.getJsonType(g.geometry),C.convertFromGraphics(f,[g],a,!1,!1,"uid");return new b(e,f)};var d=b.prototype;d.readGraphic=function(){return this._current};d.getCursor=function(){return this.copy()};d.copy=function(){const a=new b(this.instance,this._features);this.copyInto(a);return a};E._createClass(b,[{key:"geometryType",get:function(){const a=this._current;return a?a.geometryType:null}}]);return b}(m.FeatureSetReaderJSON);
z.GraphicsReader=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReader":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../geometry/support/jsonUtils ../../../../../geometry ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/centroid".split(" "),function(z,E,D,C,A,m,c){let b=0;C=function(){function d(e){this.type="FeatureSetReader";
this.seen=!1;this._ty=this._tx=this.instance=0;this._xmin=-1;this._ymax=this._ymin=this._xmax=0;this._joined=[];this.instance=e}d.createInstance=function(){b++;return b=65535<b?0:b};var a=d.prototype;a.getQuantizationTransform=function(){throw Error("Unable to find transform for featureSet");};a.getStorage=function(){return this._storage};a.getComputedNumeric=function(e){return this.getComputedNumericAtIndex(0)};a.setComputedNumeric=function(e,f){return this.setComputedNumericAtIndex(f,0)};a.getComputedString=
function(e){return this.getComputedStringAtIndex(0)};a.setComputedString=function(e,f){return this.setComputedStringAtIndex(0,f)};a.getComputedNumericAtIndex=function(e){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),e)};a.setComputedNumericAtIndex=function(e,f){this._storage.setComputedNumericAtIndex(this.getDisplayId(),e,f)};a.getComputedStringAtIndex=function(e){return this._storage.getComputedStringAtIndex(this.getDisplayId(),e)};a.setComputedStringAtIndex=function(e,f){return this._storage.setComputedStringAtIndex(this.getDisplayId(),
e,f)};a.transform=function(e,f){const g=this.copy();g._tx=e;g._ty=f;return g};a.extent=function(e,f,g,q){const h=this.copy();h._xmin=e;h._xmax=g;h._ymin=f;h._ymax=q;return h};a.hasFilter=function(){return this._hasFilter};a.readAttribute=function(e,f=!1){var g=this._readAttribute(e,f);if(void 0!==g)return g;for(const q of this._joined)if(q.setIndex(this.getIndex()),g=q._readAttribute(e,f),void 0!==g)return g};a.readAttributes=function(){return this._readAttributes()};a.joinAttributes=function(e){this._joined.push(e)};
a.readArcadeFeature=function(){return this};a.geometry=function(){var e=this.readHydratedGeometry();e=m.convertToGeometry(e,this.geometryType,this.hasZ,this.hasM);e=D.fromJSON(e);e.spatialReference=this._arcadeSpatialReference;return e};a.field=function(e){return this.readAttribute(e,!0)};a.hasField=function(e){return!0};a.setField=function(e,f){};a.keys=function(){return[]};a.castToText=function(){return""};a._computeCentroid=function(){if("esriGeometryPolygon"!==this.geometryType)return null;const e=
this.readUnquantizedGeometry();if(!e||e.hasIndeterminateRingOrder)return null;const f=this.getQuantizationTransform();return c.getCentroidOptimizedGeometry(new A,e,this.hasM,this.hasZ,f)};a.copyInto=function(e){e.seen=this.seen;e._storage=this._storage;e._arcadeSpatialReference=this._arcadeSpatialReference;e._joined=this._joined;e._tx=this._tx;e._ty=this._ty;e._xmin=this._xmin;e._xmax=this._xmax;e._ymin=this._ymin;e._ymax=this._ymax};E._createClass(d,[{key:"_hasFilter",get:function(){return-1!==this._xmin}}]);
return d}();z.FeatureSetReader=C;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(z){function E(C,A,m,c,b,d,a=1){d=b?d?4:3:d?3:2;let e=m,f=m+d,g=0,q=0,h=m=0,n=0;for(let u=0,t=c-1;u<t;u++,e+=d,f+=d){c=A[e];const k=A[e+1],v=A[e+2],p=A[f],r=A[f+1],w=A[f+2];let l=c*r-p*k;h+=l;g+=(c+p)*l;q+=(k+r)*l;b&&(l=c*w-p*v,m+=(v+w)*l,n+=l);c<C[0]&&(C[0]=c);c>C[1]&&(C[1]=c);k<C[2]&&(C[2]=k);k>C[3]&&(C[3]=k);b&&(v<C[4]&&(C[4]=v),v>C[5]&&(C[5]=
v))}0<h*a&&(h*=-1);0<n*a&&(n*=-1);if(!h)return null;C=[g,q,.5*h];b&&(C[3]=m,C[4]=.5*n);return C}function D(C,A,m,c,b){b=c?b?4:3:b?3:2;let d=A,a=A+b,e=0,f=0,g=0,q=0;for(let t=0,k=m-1;t<k;t++,d+=b,a+=b){var h=C[d];const v=C[d+1],p=C[d+2],r=C[a],w=C[a+1],l=C[a+2];if(c){{var n=r-h;var u=w-v;const x=l-p;n=Math.sqrt(n*n+u*u+x*x)}}else n=r-h,u=w-v,n=Math.sqrt(n*n+u*u);n&&(e+=n,c?(h=[h+.5*(r-h),v+.5*(w-v),p+.5*(l-p)],f+=n*h[0],g+=n*h[1],q+=n*h[2]):(h=[h+.5*(r-h),v+.5*(w-v)],f+=n*h[0],g+=n*h[1]))}return 0<
e?c?[f/e,g/e,q/e]:[f/e,g/e]:0<m?c?[C[A],C[A+1],C[A+2]]:[C[A],C[A+1]]:null}z.getCentroidOptimizedGeometry=function(C,A,m,c,b){if(!A||!A.lengths.length)return null;const d="upperLeft"===(null==b?void 0:b.originPosition)?-1:1;C.lengths.length&&(C.lengths.length=0);C.coords.length&&(C.coords.length=0);b=C.coords;const a=[],e=m?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:g}=A,q=m?c?4:3:c?3:2;let h=0;for(var n of f){const u=E(e,g,h,n,m,c,d);u&&a.push(u);h+=n*q}a.sort((u,t)=>{let k=d*u[2]-d*t[2];0===k&&m&&(k=u[4]-t[4]);return k});a.length&&(n=6*a[0][2],b[0]=a[0][0]/n,b[1]=a[0][1]/n,m&&(n=6*a[0][4],b[2]=0!==n?a[0][3]/n:0),b[0]<e[0]||b[0]>e[1]||b[1]<e[2]||b[1]>e[3]||m&&(b[2]<e[4]||b[2]>e[5]))&&(b.length=0);if(!b.length)if(A=A.lengths[0]?D(g,0,f[0],m,c):null)b[0]=A[0],b[1]=A[1],
m&&2<A.length&&(b[2]=A[2]);else return null;return C};z.lineCentroid=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/FeatureSetReaderJSON":function(){define(["exports","../../../../../chunks/_rollupPluginBabelHelpers","../../../../../layers/graphics/featureConversionUtils","./FeatureSetReader"],function(z,E,D,C){function A({coords:c,lengths:b}){let d=0;for(const a of b){for(b=1;b<a;b++)c[2*(d+b)]+=c[2*(d+b)-2],c[2*(d+b)+1]+=c[2*(d+b)-1];d+=a}}let m=function(c){function b(a,
e,f){a=c.call(this,a)||this;a._featureIndex=-1;a._dateFields=new Set;a._geometryType=f;a._features=e;return a}E._inheritsLoose(b,c);b.fromFeatures=function(a,e,f){f=D.convertFromFeatures([],a,e,!1,!1,f);for(let g=0;g<f.length;g++)f[g].displayId=a[g].displayId;return b.fromOptimizedFeatures(f,e)};b.fromFeatureSet=function(a,e){a=D.convertFromFeatureSet(a,e);return b.fromOptimizedFeatureSet(a)};b.fromOptimizedFeatureSet=function(a){const {features:e,geometryType:f}=a,g=b.fromOptimizedFeatures(e,f);
g._exceededTransferLimit=a.exceededTransferLimit;g._transform=a.transform;for(const q of a.fields)"esriFieldTypeDate"===q.type&&g._dateFields.add(q.name);return g};b.fromOptimizedFeatures=function(a,e,f){const g=C.FeatureSetReader.createInstance();a=new b(g,a,e);a._transform=f;return a};var d=b.prototype;d.getApproximateSize=function(){return this._features.length};d.getCursor=function(){return this.copy()};d.getQuantizationTransform=function(){return this._transform};d.getAttributeHash=function(){let a=
"";for(const e in this._current.attributes)a+=this._current.attributes[e];return a};d.getIndex=function(){return this._featureIndex};d.setIndex=function(a){this._featureIndex=a};d.getObjectId=function(){return this._current.objectId};d.getDisplayId=function(){return this._current.displayId};d.setDisplayId=function(a){this._current.displayId=a};d.getGroupId=function(){return this._current.groupId};d.setGroupId=function(a){this._current.groupId=a};d.copy=function(){const a=new b(this.instance,this._features,
this.geometryType);this.copyInto(a);return a};d.next=function(){if(!this._hasFilter)return++this._featureIndex<this._features.length;for(;++this._featureIndex<this._features.length&&!this._passesFilter(););return this._featureIndex<this._features.length};d.readLegacyFeature=function(){return D.convertToFeature(this._current,this.geometryType,this.hasZ,this.hasM)};d.readOptimizedFeature=function(){return this._current};d.readLegacyPointGeometry=function(){const a=this.readGeometry();return a?{x:a.coords[0],
y:a.coords[1]}:null};d.readLegacyGeometry=function(){const a=this.readGeometry();return D.convertToGeometry(a,this.geometryType,this.hasZ,this.hasM)};d.readLegacyCentroid=function(){const a=this.readCentroid();return a?{x:a.coords[0],y:a.coords[1]}:null};d.readGeometryArea=function(){return D.getQuantizedArea(this._current.geometry,2)};d.readUnquantizedGeometry=function(){var a=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!a)return a;a=a.clone();A(a);return a};d.readHydratedGeometry=
function(){var a=this._current.geometry;if(!a)return null;a=a.clone();D.unquantizeOptimizedGeometry(a,a,this.hasZ,this.hasM,this._transform);return a};d.getXHydrate=function(){const a=this._current.geometry.coords[0]+this._tx,e=this.getQuantizationTransform();return a*e.scale[0]+e.translate[0]};d.getYHydrate=function(){const a=this._current.geometry.coords[1]+this._ty,e=this.getQuantizationTransform();return e.translate[1]-a*e.scale[1]};d.readGeometry=function(){if(!this._current.hasGeometry)return null;
const a=this._current.geometry.clone();if(a.isPoint)return a.coords[0]+=this._tx,a.coords[1]+=this._ty,a;let e=0;for(const f of a.lengths)a.coords[2*e]+=this._tx,a.coords[2*e+1]+=this._ty,e+=f;return a};d.readCentroid=function(){if(!this._current.hasGeometry)return null;if(!this._current.centroid){var a=this._computeCentroid();if(!a)return null;a.coords[0]-=this._tx;a.coords[1]-=this._ty;this._current.centroid=a}a=this._current.centroid.clone();a.coords[0]+=this._tx;a.coords[1]+=this._ty;return a};
d._readAttribute=function(a,e){const f=this._current.attributes[a];if(void 0!==f)return e&&this._dateFields.has(a)?new Date(f):f;e=this.readAttributes();a=a.toLocaleLowerCase().trim();for(const g in e)if(g.toLocaleLowerCase().trim()===a)return a=this._current.attributes[g],this._dateFields.has(g)?new Date(a):a};d.copyInto=function(a){c.prototype.copyInto.call(this,a);a._featureIndex=this._featureIndex;a._transform=this._transform;a._dateFields=this._dateFields};d._readAttributes=function(){return this._current.attributes};
d._passesFilter=function(){if(!this._hasFilter)return!0;var a=0;let e=0;switch(this.geometryType){case "esriGeometryPoint":a=this._current.geometry;if(!a)return!1;[a,e]=a.coords;break;case "esriGeometryPolygon":a=this.readCentroid();if(!a)return!1;[a,e]=a.coords;a-=this._tx;e-=this._ty;break;default:return!1}return a>=this._xmin&&a<=this._xmax&&e>=this._ymin&&e<=this._ymax?!0:!1};E._createClass(b,[{key:"_current",get:function(){return this._features[this._featureIndex]}},{key:"geometryType",get:function(){return this._geometryType}},
{key:"hasFeatures",get:function(){return!!this._features.length}},{key:"hasNext",get:function(){return this._featureIndex+1<this._features.length}},{key:"exceededTransferLimit",get:function(){return this._exceededTransferLimit}},{key:"hasZ",get:function(){return!1}},{key:"hasM",get:function(){return!1}}]);return b}(C.FeatureSetReader);z.FeatureSetReaderJSON=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/features/support/TileStore":function(){define("../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/has ../../../../../core/Evented ../../../tiling/TileKey ../../../tiling/TileCoverage ../../../../../chunks/rbush ./Tile".split(" "),
function(z,E,D,C,A,m,c){const b={added:[],removed:[]},d=new Set,a=new C(0,0,0,0);return function(e){function f(q){var h=e.call(this)||this;h._tiles=new Map;h._index=m.rbush(9,E("csp-restrictions")?n=>({minX:n.bounds[0],minY:n.bounds[1],maxX:n.bounds[2],maxY:n.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);h.tiles=[];h.tileScheme=q;return h}z._inheritsLoose(f,e);var g=f.prototype;g.destroy=function(){this.clear()};g.clear=function(){this.tiles.length=0;this._tiles.clear();this._index.clear()};
g.has=function(q){return this._tiles.has(q)};g.get=function(q){return this._tiles.get(q)};g.findByKey=function(q){return this._tiles.get(q.id)};g.intersections=function(q,h){var n="string"===typeof q?this.get(q):q;if(!n)return[];var u=h*n.resolution;h=n.bounds[0]-u;q=n.bounds[1]-u;const t=n.bounds[2]+u;n=n.bounds[3]+u;u=[];for(const k of this._index.search({minX:h,minY:q,maxX:t,maxY:n})){const v=k.bounds.slice();v[0]=Math.max(v[0],h);v[1]=Math.max(v[1],q);v[2]=Math.min(v[2],t);v[3]=Math.min(v[3],
n);0<v[2]-v[0]&&0<v[3]-v[1]&&u.push({bounds:v,tile:k})}return u};g.boundsIntersections=function(q){return this._index.search({minX:q[0],minY:q[1],maxX:q[2],maxY:q[3]})};g.updateTiles=function(q){const h={added:[],removed:[]};for(const n of q.added)if(!this.has(n)){const u=new c.Tile(this.tileScheme,n);this._tiles.set(n,u);this._index.insert(u);h.added.push(u)}for(const n of q.removed)this.has(n)&&(q=this.get(n),this._tiles.delete(n),this._index.remove(q),h.removed.push(q));this.tiles.length=0;this._tiles.forEach(n=>
this.tiles.push(n));(h.added.length||h.removed.length)&&this.emit("update",h)};g.setViewState=function(q){if(q=this.tileScheme.getTileCoverage(q,0)){var {spans:h,lodInfo:n}=q,{level:u}=n;if(0<h.length)for(const {row:k,colFrom:v,colTo:p}of h)for(var t=v;t<=p;t++){const r=a.set(u,k,n.normalizeCol(t),n.getWorldForColumn(t)).id;d.add(r);if(!this.has(r)){const w=new c.Tile(this.tileScheme,r);this._tiles.set(r,w);this._index.insert(w);this.tiles.push(w);b.added.push(w)}}for(u=this.tiles.length-1;0<=u;u--)t=
this.tiles[u],d.has(t.id)||(this._tiles.delete(t.id),this.tiles.splice(u,1),this._index.remove(t),b.removed.push(t));(b.added.length||b.removed.length)&&this.emit("update",b);A.pool.release(q);d.clear();b.added.length=0;b.removed.length=0}};return f}(D)})},"esri/chunks/rbush":function(){define(["exports","./quickselect"],function(z,E){function D(h,n){if(!(this instanceof D))return new D(h,n);this._maxEntries=Math.max(4,h||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));n&&("function"===
typeof n?this.toBBox=n:this._initFormat(n));this.clear()}function C(h,n){A(h,0,h.children.length,n,h)}function A(h,n,u,t,k){k||(k=g(null));k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;for(var v;n<u;n++)v=h.children[n],m(k,h.leaf?t(v):v);return k}function m(h,n){h.minX=Math.min(h.minX,n.minX);h.minY=Math.min(h.minY,n.minY);h.maxX=Math.max(h.maxX,n.maxX);h.maxY=Math.max(h.maxY,n.maxY);return h}function c(h,n){return h.minX-n.minX}function b(h,n){return h.minY-n.minY}function d(h){return(h.maxX-
h.minX)*(h.maxY-h.minY)}function a(h){return h.maxX-h.minX+(h.maxY-h.minY)}function e(h,n){return h.minX<=n.minX&&h.minY<=n.minY&&n.maxX<=h.maxX&&n.maxY<=h.maxY}function f(h,n){return n.minX<=h.maxX&&n.minY<=h.maxY&&n.maxX>=h.minX&&n.maxY>=h.minY}function g(h){return{children:h,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function q(h,n,u,t,k){for(var v=[n,u],p;v.length;)u=v.pop(),n=v.pop(),u-n<=t||(p=n+Math.ceil((u-n)/t/2)*t,E.quickselect(h,p,n,u,k),v.push(n,p,p,u))}
D.prototype={all:function(){return this._all(this.data,[])},search:function(h){var n=this.data,u=[],t=this.toBBox;if(!f(h,n))return u;for(var k=[],v,p,r,w;n;){v=0;for(p=n.children.length;v<p;v++)r=n.children[v],w=n.leaf?t(r):r,f(h,w)&&(n.leaf?u.push(r):e(h,w)?this._all(r,u):k.push(r));n=k.pop()}return u},collides:function(h){var n=this.data,u=this.toBBox;if(!f(h,n))return!1;for(var t=[],k,v,p,r;n;){k=0;for(v=n.children.length;k<v;k++)if(p=n.children[k],r=n.leaf?u(p):p,f(h,r)){if(n.leaf||e(h,r))return!0;
t.push(p)}n=t.pop()}return!1},load:function(h){if(!h||!h.length)return this;if(h.length<this._minEntries){for(var n=0,u=h.length;n<u;n++)this.insert(h[n]);return this}h=this._build(h.slice(),0,h.length-1,0);this.data.children.length?this.data.height===h.height?this._splitRoot(this.data,h):(this.data.height<h.height&&(n=this.data,this.data=h,h=n),this._insert(h,this.data.height-h.height-1,!0)):this.data=h;return this},insert:function(h){h&&this._insert(h,this.data.height-1);return this},clear:function(){this.data=
g([]);return this},remove:function(h,n){if(!h)return this;for(var u=this.data,t=this.toBBox(h),k=[],v=[],p,r,w,l;u||k.length;){u||(u=k.pop(),r=k[k.length-1],p=v.pop(),l=!0);if(u.leaf){a:{w=h;var x=u.children,y=n;if(y){for(var B=0;B<x.length;B++)if(y(w,x[B])){w=B;break a}w=-1}else w=x.indexOf(w)}if(-1!==w){u.children.splice(w,1);k.push(u);this._condense(k);break}}l||u.leaf||!e(u,t)?r?(p++,u=r.children[p],l=!1):u=null:(k.push(u),v.push(p),p=0,r=u,u=u.children[0])}return this},toBBox:function(h){return h},
compareMinX:c,compareMinY:b,toJSON:function(){return this.data},fromJSON:function(h){this.data=h;return this},_all:function(h,n){for(var u=[];h;)h.leaf?n.push.apply(n,h.children):u.push.apply(u,h.children),h=u.pop();return n},_build:function(h,n,u,t){var k=u-n+1,v=this._maxEntries;if(k<=v){var p=g(h.slice(n,u+1));C(p,this.toBBox);return p}t||(t=Math.ceil(Math.log(k)/Math.log(v)),v=Math.ceil(k/Math.pow(v,t-1)));p=g([]);p.leaf=!1;p.height=t;k=Math.ceil(k/v);v=k*Math.ceil(Math.sqrt(v));var r;for(q(h,
n,u,v,this.compareMinX);n<=u;n+=v){var w=Math.min(n+v-1,u);q(h,n,w,k,this.compareMinY);for(r=n;r<=w;r+=k){var l=Math.min(r+k-1,w);p.children.push(this._build(h,r,l,t-1))}}C(p,this.toBBox);return p},_chooseSubtree:function(h,n,u,t){for(var k,v,p,r,w,l,x,y;;){t.push(n);if(n.leaf||t.length-1===u)break;x=y=Infinity;k=0;for(v=n.children.length;k<v;k++)p=n.children[k],w=d(p),l=(Math.max(p.maxX,h.maxX)-Math.min(p.minX,h.minX))*(Math.max(p.maxY,h.maxY)-Math.min(p.minY,h.minY))-w,l<y?(y=l,x=w<x?w:x,r=p):l===
y&&w<x&&(x=w,r=p);n=r||n.children[0]}return n},_insert:function(h,n,u){var t=this.toBBox;u=u?h:t(h);t=[];var k=this._chooseSubtree(u,this.data,n,t);k.children.push(h);for(m(k,u);0<=n;)if(t[n].children.length>this._maxEntries)this._split(t,n),n--;else break;this._adjustParentBBoxes(u,t,n)},_split:function(h,n){var u=h[n],t=u.children.length,k=this._minEntries;this._chooseSplitAxis(u,k,t);t=this._chooseSplitIndex(u,k,t);t=g(u.children.splice(t,u.children.length-t));t.height=u.height;t.leaf=u.leaf;C(u,
this.toBBox);C(t,this.toBBox);n?h[n-1].children.push(t):this._splitRoot(u,t)},_splitRoot:function(h,n){this.data=g([h,n]);this.data.height=h.height+1;this.data.leaf=!1;C(this.data,this.toBBox)},_chooseSplitIndex:function(h,n,u){var t,k;var v=k=Infinity;for(t=n;t<=u-n;t++){var p=A(h,0,t,this.toBBox);var r=A(h,t,u,this.toBBox);var w=Math.max(0,Math.min(p.maxX,r.maxX)-Math.max(p.minX,r.minX))*Math.max(0,Math.min(p.maxY,r.maxY)-Math.max(p.minY,r.minY));p=d(p)+d(r);if(w<v){v=w;var l=t;k=p<k?p:k}else w===
v&&p<k&&(k=p,l=t)}return l},_chooseSplitAxis:function(h,n,u){var t=h.leaf?this.compareMinX:c,k=h.leaf?this.compareMinY:b,v=this._allDistMargin(h,n,u,t);n=this._allDistMargin(h,n,u,k);v<n&&h.children.sort(t)},_allDistMargin:function(h,n,u,t){h.children.sort(t);t=this.toBBox;var k=A(h,0,n,t),v=A(h,u-n,u,t),p=a(k)+a(v),r;for(r=n;r<u-n;r++){var w=h.children[r];m(k,h.leaf?t(w):w);p+=a(k)}for(r=u-n-1;r>=n;r--)w=h.children[r],m(v,h.leaf?t(w):w),p+=a(v);return p},_adjustParentBBoxes:function(h,n,u){for(;0<=
u;u--)m(n[u],h)},_condense:function(h){for(var n=h.length-1,u;0<=n;n--)0===h[n].children.length?0<n?(u=h[n-1].children,u.splice(u.indexOf(h[n]),1)):this.clear():C(h[n],this.toBBox)},_initFormat:function(h){var n=["return a"," - b",";"];this.compareMinX=new Function("a","b",n.join(h[0]));this.compareMinY=new Function("a","b",n.join(h[1]));this.toBBox=new Function("a","return {minX: a"+h[0]+", minY: a"+h[1]+", maxX: a"+h[2]+", maxY: a"+h[3]+"};")}};z.rbush=D})},"esri/chunks/quickselect":function(){define(["exports",
"./_commonjsHelpers"],function(z,E){E=E.createCommonjsModule(function(D){(function(C){C=C();void 0!==C&&(D.exports=C)})(function(){function C(c,b,d,a,e){for(;a>d;){if(600<a-d){var f=a-d+1,g=b-d+1,q=Math.log(f),h=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*h*(f-h)/f)*(0>g-f/2?-1:1);C(c,b,Math.max(d,Math.floor(b-g*h/f+q)),Math.min(a,Math.floor(b+(f-g)*h/f+q)),e)}f=c[b];g=d;h=a;A(c,d,b);for(0<e(c[a],f)&&A(c,d,a);g<h;){A(c,g,h);g++;for(h--;0>e(c[g],f);)g++;for(;0<e(c[h],f);)h--}0===e(c[d],f)?A(c,d,h):(h++,A(c,
h,a));h<=b&&(d=h+1);b<=h&&(a=h-1)}}function A(c,b,d){var a=c[b];c[b]=c[d];c[d]=a}function m(c,b){return c<b?-1:c>b?1:0}return function(c,b,d,a,e){C(c,b,d||0,a||c.length-1,e||m)}})});z.quickselect=E})},"esri/views/2d/layers/features/support/Tile":function(){define("exports ../../../../../chunks/_rollupPluginBabelHelpers ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),
function(z,E,D,C,A,m,c){function b(a,e){const f=a.bounds,g=e.bounds;return a.key.id!==e.key.id&&a.key.world===e.key.world&&f[0]<=g[0]&&f[1]<=g[1]&&f[2]>=g[2]&&f[3]>=g[3]}let d=function(){function a(f,g){this.key=new c(0,0,0,0);this.bounds=A.create();this.objectIds=new Set;this.key.set(g);g=f.getLODInfoAt(this.key);this.tileInfoView=f;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=g.resolution;this.scale=g.scale;this.level=g.level;this.needsClear=!0}var e=a.prototype;e.clone=
function(){return new a(this.tileInfoView,this.key)};e.createChildTiles=function(){const f=this.key.getChildKeys(),g=D.acquire();for(let q=0;q<f.length;q++)g[q]=new a(this.tileInfoView,f[q]);return g};e.getQuantizationParameters=function(){return m.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};E._createClass(a,[{key:"id",
get:function(){return this.key.id}},{key:"extent",get:function(){return C.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}},{key:"transform",get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}},{key:"bbox",get:function(){const f=this.bounds;return{minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}}}]);return a}();z.Tile=d;z.default=d;z.isChildOf=function(a,e){return b(e,a)};z.isParentOf=b;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicContainer":function(){define(["../../../../chunks/_rollupPluginBabelHelpers","../../engine/webgl/enums","../../engine/FeatureContainer"],function(z,E,D){return function(C){function A(){return C.apply(this,arguments)||this}z._inheritsLoose(A,C);var m=A.prototype;m.renderChildren=function(c){this.attributeView.bindTextures(c.context);this.children.some(b=>b.hasData)&&(C.prototype.renderChildren.call(this,c),c.drawPhase===E.WGLDrawPhase.MAP&&
this._renderChildren(c),c.drawPhase===E.WGLDrawPhase.HIGHLIGHT&&this._renderHighlight(c))};m._renderChildren=function(c,b){for(const d of this.children)d.isReady&&d.hasData&&(d.commitChanges(c),c.context.setStencilFunction(514,d.stencilRef,255),d._displayList.replay(c,d,b))};m._renderHighlight=function(c){var {painter:b}=c;b=b.effects.highlight;b.bind(c);this._renderChildren(c,b.defines);b.draw(c);b.unbind()};z._createClass(A,[{key:"hasLabels",get:function(){return!1}},{key:"labelsVisible",get:function(){return!1}}]);
return A}(D.FeatureContainer)})},"esri/views/2d/engine/FeatureContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../core/promiseUtils ../../../geometry/support/aaBoundingRect ../../../core/Queue ./webgl/TileData ./webgl/WGLTile ./webgl/AttributeStoreView ./webgl/TileContainer ./webgl/WGLRendererInfo".split(" "),function(z,E,D,C,A,m,c,b,d,a){d=function(e){function f(q){q=e.call(this,q)||this;q._rendererInfo=new a.WGLRendererInfo;q._materialItemsRequestQueue=new A;
q.attributeView=new b.AttributeStoreView;return q}E._inheritsLoose(f,e);var g=f.prototype;g.destroy=function(){this.removeAllChildren();this.children.forEach(q=>q.destroy());this.attributeView.destroy();this._materialItemsRequestQueue.clear()};g.setRendererInfo=function(q,h,n){this._rendererInfo.setInfo(q,h,n);this.requestRender()};g.getMaterialItems=async function(q,h){if(!q||0===q.length)return null;const n=D.createResolver();this._materialItemsRequestQueue.push({items:q,abortOptions:h,resolver:n});
this.requestRender();return n.promise};g.onTileData=function(q,h){if(h.addOrUpdate&&"tileDisplayData"in h.addOrUpdate)q.setData(h);else{const n=h.addOrUpdate&&m.TileData.decode(h.addOrUpdate);q.setData({...h,addOrUpdate:n})}this.contains(q)||this.addChild(q);this.requestRender()};g.onTileError=function(q){q.clear();this.contains(q)||this.addChild(q)};g.doRender=function(q){q.context.capabilities.textureFloat;q.context.capabilities.vao;if(0<this._materialItemsRequestQueue.length){let h=this._materialItemsRequestQueue.pop();
for(;h;)this._processMaterialItemRequest(q,h),h=this._materialItemsRequestQueue.pop()}e.prototype.doRender.call(this,q)};g.renderChildren=function(q){for(const h of this.children)h.commitChanges(q);this._rendererInfo.update(q.state);e.prototype.renderChildren.call(this,q)};g.createTile=function(q){const h=this._tileInfoView.getTileBounds(C.create(),q);return new c.WGLTile(q,h)};g.destroyTile=function(q){this.removeChild(q);q.destroy()};g.createRenderParams=function(q){return{...e.prototype.createRenderParams.call(this,
q),rendererInfo:this._rendererInfo,attributeView:this.attributeView}};g._processMaterialItemRequest=function(q,{items:h,abortOptions:n,resolver:u}){const {painter:t,pixelRatio:k}=q;q=h.map(v=>t.textureManager.rasterizeItem(v.symbol,k,v.glyphIds,n));D.all(q).then(v=>{this.stage?(v=v.map((p,r)=>({id:h[r].id,mosaicItem:p})),u.resolve(v)):u.reject()},u.reject)};return f}(d["default"]);z.FeatureContainer=d;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../core/promiseUtils ./definitions ../../../webgl/Program ../../../webgl/BufferObject ../../../webgl/Texture ../../../webgl/VertexArrayObject ../../../webgl/Renderbuffer ../../../webgl/FramebufferObject ../../../webgl/ProgramCache ../../../webgl/RenderingContext ../../../webgl/ShaderCompiler ./Utils ./util/debug".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k){const v=A.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),p=k.createDebugLogger(k.DEBUG_ATTR_UPDATES,v);let r=function(){function w(x,y,B){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;const {buffer:F,pixelType:G,textureOnly:J}=x;x=t.getPixelArrayCtor(G);this.shared=B;this.pixelType=G;this.size=y;this.textureOnly=J;J||(this.data=new x(C.unwrap(F)));this._resetRange()}var l=w.prototype;l.destroy=function(){C.andThen(this._texture,
x=>x.dispose());for(const x in this._fbos)C.andThen(this._fbos[x],y=>{"0"===x&&y.detachColorTexture();y.dispose()}),this._fbos[x]=null;this._texture=null};l.setData=function(x,y,B){x&=2147483647;const F=C.unwrap(this.data);y=x*this.texelSize+y;!F||y>=F.length||(F[y]=B,this.dirtyStart=Math.min(this.dirtyStart,x),this.dirtyEnd=Math.max(this.dirtyEnd,x))};l.getData=function(x,y){if(C.isNone(this.data))return null;x=(x&2147483647)*this.texelSize+y;return!this.data||x>=this.data.length?null:this.data[x]};
l.getTexture=function(x){return C.unwrapOr(this._texture,()=>this._initTexture(x))};l.getFBO=function(x,y=0){if(C.isNone(this._fbos[y])){const B=0===y?this.getTexture(x):this._textureDesc;this._fbos[y]=new q(x,{colorTarget:0,depthStencilTarget:0},B)}return this._fbos[y]};l.updateTexture=function(x){if(!this.locked)try{const H=this.dirtyStart,Q=this.dirtyEnd;if(!(H>Q)){this._resetRange();var y=C.unwrap(this.data).buffer,B=this.getTexture(x),F=(H-H%this.size)/this.size,G=(Q-Q%this.size)/this.size,J=
F*this.size*4,K=4*(this.size+G*this.size)-J,M=t.getPixelArrayCtor(this.pixelType),R=M.BYTES_PER_ELEMENT;try{new M(y,J*R,K)}catch(W){console.debug(W)}var N=new M(y,J*R,K),I=this.size;x=G-F+1;x>this.size?v.error(new m("mapview-webgl","Out-of-bounds index when updating AttributeData")):B.updateData(0,0,F,I,x,N)}}catch(H){console.debug(H)}};l.update=function(x){const {data:y,start:B,end:F}=x;if(C.isSome(y)){const G=this.data,J=B*this.texelSize;for(let K=0;K<y.length;K++)x.layout&1<<K%this.texelSize&&
(G[J+K]=y[K])}this.dirtyStart=Math.min(this.dirtyStart,B);this.dirtyEnd=Math.max(this.dirtyEnd,F)};l.resize=function(x,y){const B=this.size;this.size=y;this.textureOnly?B!==this.size&&(this._lastTexture=this._texture,this._texture=null):(y=t.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new y(C.unwrap(x.buffer)))};l._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};l._initTexture=function(x){const y=new e(x,this._textureDesc,C.unwrapOr(this.data,void 0));if(C.isSome(this._lastTexture)&&
this._fbos[0]){const G=this._lastTexture.descriptor.width,J=this._lastTexture.descriptor.height,K=this._lastTexture.descriptor.dataType,M=this._lastTexture.descriptor.pixelFormat,R=this.getFBO(x);var B=t.getPixelBytes(K),F=t.getPixelArrayCtor(K);B=new ArrayBuffer(G*J*B*this.texelSize);F=new F(B);B=x.getBoundFramebufferObject();const {x:N,y:I,width:H,height:Q}=x.getViewport();x.bindFramebuffer(R);R.readPixels(0,0,G,J,M,K,F);y.updateData(0,0,0,2*G,J/2,F);x.setViewport(N,I,H,Q);x.bindFramebuffer(B)}this.destroy();
return this._texture=y};E._createClass(w,[{key:"_textureDesc",get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}}},{key:"locked",get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&D("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1}}]);return w}();A=function(){function w(){this._locked=this._forceNextUpload=this._initialized=!1}var l=w.prototype;l.initialize=function(x){const {blocks:y,
shared:B,size:F}=x;this.shared=B;this.size=F;p("Initializing AttributeStoreView",x);if(C.isNone(this._data))this._data=C.mapMany(y,G=>new r(G,F,B));else for(x=0;x<this._data.length;x++){const G=this._data[x],J=y[x];C.isSome(J)&&(C.isNone(G)?this._data[x]=new r(J,F,B):G.resize(J,F))}this._initialized=!0};l.destroy=function(){C.andThen(this._data,x=>C.mapMany(x,y=>y.destroy()));C.andThen(this._defaultTexture,x=>x.dispose())};l.getBlock=function(x){return C.isNone(this._data)?null:this._data[x]};l.setLabelMinZoom=
function(x,y){this.setData(x,0,1,y)};l.getLabelMinZoom=function(x){return this.getData(x,0,1,255)};l.getFilterFlags=function(x){return this.getData(x,0,0,0)};l.getVVSize=function(x){return this.getData(x,b.ATTRIBUTE_DATA_VV,0,0)};l.getData=function(x,y,B,F){if(!this._data)return 0;y=C.unwrap(this._data)[y];if(C.isNone(y))return 0;x=y.getData(x,B);return C.isSome(x)?x:F};l.setData=function(x,y,B,F){y=C.unwrap(this._data)[y];C.unwrap(y).setData(x,B,F)};l.lockTextureUpload=function(){this._locked=!0};
l.unlockTextureUpload=function(){this._locked=!1};l.forceTextureUpload=function(){this._forceNextUpload=!0};l.requestUpdate=async function(x){if(this._pendingAttributeUpdate)v.error(new m("mapview-webgl","Tried to update attribute data with a pending update"));else{var y=c.createResolver();p("AttributeStoreView Update Requested",x);this._pendingAttributeUpdate={data:x,resolver:y};return y.promise}};l.update=function(){if(this._initialized&&C.isSome(this._pendingAttributeUpdate)){const {data:x,resolver:y}=
this._pendingAttributeUpdate,B=C.unwrap(this._data);for(let F=0;F<x.blocks.length;F++){const G=x.blocks[F];C.andThen(B[F],J=>C.andThen(G,K=>{p(`Updating block ${F}`,K);J.update(K)}))}this._pendingAttributeUpdate=null;y()}};l.bindTextures=function(x){this.update();const y=this._getDefaultTexture(x);if(this._initialized){var B=C.unwrap(this._data);if(!this._locked||this._forceNextUpload)C.forEachSome(B,F=>F.updateTexture(x)),this._forceNextUpload=!1;x.bindTexture(C.mapOr(B[0],y,F=>F.getTexture(x)),
b.TEXTURE_BINDING_ATTRIBUTE_DATA_0);x.bindTexture(C.mapOr(B[1],y,F=>F.getTexture(x)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_1);x.bindTexture(C.mapOr(B[2],y,F=>F.getTexture(x)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_2);x.bindTexture(C.mapOr(B[3],y,F=>F.getTexture(x)),b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else x.bindTexture(y,b.TEXTURE_BINDING_ATTRIBUTE_DATA_0),x.bindTexture(y,b.TEXTURE_BINDING_ATTRIBUTE_DATA_1),x.bindTexture(y,b.TEXTURE_BINDING_ATTRIBUTE_DATA_2),x.bindTexture(y,b.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};
l._getDefaultTexture=function(x){C.isNone(this._defaultTexture)&&(this._defaultTexture=new e(x,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return w}();z.AttributeStoreView=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/TileContainer":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ./enums ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil ./WGLContainer".split(" "),
function(z,E,D,C,A,m){const c=(b,d)=>0!==b.key.level-d.key.level?b.key.level-d.key.level:0!==b.key.row-d.key.row?b.key.row-d.key.row:b.key.col-d.key.col;m=function(b){function d(e){var f=b.call(this)||this;f._tileInfoView=e;return f}E._inheritsLoose(d,b);var a=d.prototype;a.renderChildren=function(e){this.sortChildren(c);this.setStencilReference();b.prototype.renderChildren.call(this,e)};a.createRenderParams=function(e){const {state:f}=e;return{...b.prototype.createRenderParams.call(this,e),requiredLevel:this._tileInfoView.getClosestInfoForScale(f.scale).level,
displayLevel:this._tileInfoView.tileInfo.scaleToZoom(f.scale)}};a.prepareRenderPasses=function(e){const f=e.registerRenderPass({name:"stencil",brushes:[A],drawPhase:D.WGLDrawPhase.DEBUG|D.WGLDrawPhase.MAP|D.WGLDrawPhase.HIGHLIGHT,target:()=>this.getStencilTarget()}),g=e.registerRenderPass({name:"tileInfo",brushes:[C],drawPhase:D.WGLDrawPhase.DEBUG,target:()=>this.children,has:"esri-tiles-debug"});return[...b.prototype.prepareRenderPasses.call(this,e),f,g]};a.getStencilTarget=function(){return this.children};
a.updateTransforms=function(e){for(const f of this.children){const g=this._tileInfoView.getTileResolution(f.key);f.setTransform(e,g)}};a.setStencilReference=function(){let e=1;for(const f of this.children)f.stencilRef=e++};return d}(m);z.default=m;z.sortByLevel=c;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/has ../../../../core/maybe ./enums ../Container ../brushes ./ClippingInfo".split(" "),
function(z,E,D,C,A,m,c){return function(b){function d(){var e=b.apply(this,arguments)||this;e.name=e.constructor.name;return e}z._inheritsLoose(d,b);var a=d.prototype;a.doRender=function(e){const f=this.createRenderParams(e),{painter:g,globalOpacity:q,profiler:h,drawPhase:n}=f,u=n===C.WGLDrawPhase.LABEL?1:q*this.computedOpacity;h.recordContainerStart(this.name);g.beforeRenderLayer(f,this._clippingInfos?255:0,u);this.updateTransforms(e.state);this.renderChildren(f);g.compositeLayer(f,u);h.recordContainerEnd()};
a.renderChildren=function(e){D.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const f of this.children)f.beforeRender(e);for(const f of this._renderPasses)try{f.render(e)}catch(g){}for(const f of this.children)f.afterRender(e)};a.createRenderParams=function(e){return e};a.prepareRenderPasses=function(e){return[e.registerRenderPass({name:"clip",brushes:[m.brushes.clip],target:()=>this._clippingInfos,drawPhase:C.WGLDrawPhase.MAP|C.WGLDrawPhase.LABEL|C.WGLDrawPhase.LABEL_ALPHA|
C.WGLDrawPhase.DEBUG|C.WGLDrawPhase.HIGHLIGHT})]};a.updateTransforms=function(e){for(const f of this.children)f.setTransform(e)};a.onAttach=function(){b.prototype.onAttach.call(this);this._updateClippingInfo()};a.onDetach=function(){b.prototype.onDetach.call(this);this._updateClippingInfo()};a._updateClippingInfo=function(){D.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(f=>f.destroy()),this._clippingInfos=null);if(this.stage){var e=this._clips;D.isSome(e)&&e.length&&(this._clippingInfos=
e.items.map(f=>c.fromClipArea(this.stage,f)));this.requestRender()}};z._createClass(d,[{key:"clips",set:function(e){this._clips=e;this.children.forEach(f=>f.clips=e);this._updateClippingInfo()}}]);return d}(A.Container)})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../webgl/VertexArrayObject ../DisplayObject ./Mesh2D".split(" "),function(z,E,D,C,A,m,c){const b=
D.getLogger("esri.views.2d.engine.webgl.ClippingInfo");return function(d){function a(f,g){var q=d.call(this)||this;q._clip=g;q._cache={};q.stage=f;q._handle=g.watch("version",()=>q._invalidate());q.ready();return q}z._inheritsLoose(a,d);a.fromClipArea=function(f,g){return new a(f,g)};var e=a.prototype;e._destroyGL=function(){E.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);E.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};e.destroy=function(){this._destroyGL();
this._handle.remove()};e.getVAO=function(f,g,q,h){const [n,u]=g.size;if("geometry"===this._clip.type||this._lastWidth!==n||this._lastHeight!==u)this._lastWidth=n,this._lastHeight=u,this._destroyGL();if(E.isNone(this._cache.vao)){g=this._createMesh(g,this._clip);const t=g.getIndexBuffer(f),k=g.getVertexBuffers(f);this._cache.mesh=g;this._cache.vao=new A(f,q,h,k,t)}return this._cache.vao};e._invalidate=function(){this._destroyGL();this.requestRender()};e._createScreenRect=function(f,g){const [q,h]=
f.size;f="string"===typeof g.left?parseFloat(g.left)/100*q:g.left;const n="string"===typeof g.right?parseFloat(g.right)/100*q:g.right,u="string"===typeof g.top?parseFloat(g.top)/100*h:g.top;g="string"===typeof g.bottom?parseFloat(g.bottom)/100*h:g.bottom;return{x:f,y:u,width:Math.max(q-n-f,0),height:Math.max(h-g-u,0)}};e._createMesh=function(f,g){switch(g.type){case "rect":return c.fromRect(this._createScreenRect(f,g));case "path":return c.fromPath(g);case "geometry":return c.fromGeometry(f,g);default:return b.error(new C("mapview-bad-type",
"Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),c.fromRect({x:0,y:0,width:1,height:1})}};return a}(m.DisplayObject)})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../core/Logger ../../../../core/Error ../../../../layers/graphics/OptimizedGeometry ../../../../layers/graphics/featureConversionUtils ../../../../chunks/vec2f64 ../../../../core/libs/earcut/earcut ../../../../chunks/vec2 ../../../webgl/BufferObject ./number".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){const f=D.getLogger("esri.views.2d.engine.webgl.Mesh2D"),g=({coords:q,lengths:h},n)=>{const u=[];for(let v=0,p=0;v<h.length;p+=h[v],v+=1){const r=p;for(var t=[];v<h.length-1;v+=1,p+=h[v]){{var k=p+h[v];let w=0;for(let l=1;l<h[v+1];l++)w+=(q[2*(k+l)]-q[2*(k+l-1)])*(q[2*(k+l)+1]+q[2*(k+l-1)+1]);k=n?0<w:0>w}if(!k)break;t.push(p+h[v]-r)}k=q.slice(2*r,2*(p+h[v]));t=b.earcut(k,t,2);for(const w of t)u.push(w+r)}return u};return function(){function q(n,u,t,k=!1){this._cache=
{};this.vertices=n;this.indices=u;this.primitiveType=t;this.isMapSpace=k}q.fromRect=function({x:n,y:u,width:t,height:k}){return q.fromScreenExtent({xmin:n,ymin:u,xmax:n+t,ymax:u+k})};q.fromPath=function(n){var u=m.convertFromNestedArray(new A,n.path,!1,!1);n=u.coords;u=new Uint32Array(g(u,!0));const t=new Uint32Array(n.length/2);for(let k=0;k<t.length;k++)t[k]=e.i1616to32(Math.floor(n[2*k]),Math.floor(n[2*k+1]));return new q({geometry:t},u,4)};q.fromGeometry=function(n,u){const t=u.geometry.type;
switch(t){case "polygon":return q.fromPolygon(n,u.geometry);case "extent":return q.fromMapExtent(n,u.geometry);default:return f.error(new C("mapview-bad-type",`Unable to create a mesh from type ${t}`,u)),q.fromRect({x:0,y:0,width:1,height:1})}};q.fromPolygon=function(n,u){var t=m.convertFromPolygon(new A,u,!1,!1);u=t.coords;t=new Uint32Array(g(t,!1));const k=new Uint32Array(u.length/2),v=c.create(),p=c.create();for(let r=0;r<k.length;r++)d.set(v,u[2*r],u[2*r+1]),n.toScreen(p,v),k[r]=e.i1616to32(Math.floor(p[0]),
Math.floor(p[1]));return new q({geometry:k},t,4,!0)};q.fromScreenExtent=function({xmin:n,xmax:u,ymin:t,ymax:k}){n={geometry:new Uint32Array([e.i1616to32(n,t),e.i1616to32(u,t),e.i1616to32(n,k),e.i1616to32(n,k),e.i1616to32(u,t),e.i1616to32(u,k)])};u=new Uint32Array([0,1,2,3,4,5]);return new q(n,u,4)};q.fromMapExtent=function(n,u){const [t,k]=n.toScreen([0,0],[u.xmin,u.ymin]),[v,p]=n.toScreen([0,0],[u.xmax,u.ymax]);n={geometry:new Uint32Array([e.i1616to32(t,k),e.i1616to32(v,k),e.i1616to32(t,p),e.i1616to32(t,
p),e.i1616to32(v,k),e.i1616to32(v,p)])};u=new Uint32Array([0,1,2,3,4,5]);return new q(n,u,4)};var h=q.prototype;h.destroy=function(){E.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(const n in this._cache.vertexBuffers)E.isSome(this._cache.vertexBuffers[n])&&this._cache.vertexBuffers[n].dispose()};h.getIndexBuffer=function(n,u=35044){this._cache.indexBuffer||(this._cache.indexBuffer=a.createIndex(n,u,this.indices));return this._cache.indexBuffer};h.getVertexBuffers=function(n,
u=35044){this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce((t,k)=>({...t,[k]:a.createVertex(n,u,this.vertices[k])}),{}));return this._cache.vertexBuffers};z._createClass(q,[{key:"elementType",get:function(){a:switch(this.indices.BYTES_PER_ELEMENT){case 1:var n=5121;break a;case 2:n=5123;break a;case 4:n=5125;break a;default:throw new C("Cannot get DataType of array");}return n}}]);return q}()})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("exports ../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../Color ../../../../core/screenUtils ../../../../core/unitUtils ../../../../renderers/support/lengthUtils ./definitions ../../../webgl/capabilities ./Utils".split(" "),
function(z,E,D,C,A,m,c,b,d,a){function e(q,h){const n=h.length;if(q<h[0].value||1===n)return h[0].size;for(let u=1;u<n;u++)if(q<h[u].value)return h[u-1].size+(q-h[u-1].value)/(h[u].value-h[u-1].value)*(h[u].size-h[u-1].size);return h[n-1].size}function f(q,h,n=0){if(D.isNone(h))q[n+0]=0,q[n+1]=0,q[n+2]=0,q[n+3]=0;else{var {r:u,g:t,b:k,a:v}=h;q[n+0]=u*v/255;q[n+1]=t*v/255;q[n+2]=k*v/255;q[n+3]=v}}let g=function(){function q(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=
new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1}}var h=q.prototype;h.getSizeVVFieldStops=function(n){const u=this._vvSizeFieldStops;switch(u.type){case "static":return u;
case "level-dependent":return D.unwrapOr(u.levels[n],()=>{var t=Infinity,k=0;for(var v in u.levels){const p=parseFloat(v),r=Math.abs(n-p);r<t&&(t=r,k=p)}if(Infinity===t)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};t=Math.pow(2,(n-k)/2);k=D.unwrap(u.levels[k]);v=new Float32Array(k.values);v[2]*=t;v[3]*=t;return{sizes:D.unwrap(k.sizes),values:v}})}};h.update=function(n){D.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,n)};h.setInfo=function(n,
u,t){D.isSome(t)&&t.forEach(k=>this._updateEffects(k));this._vvInfo=u;switch(n.type){case "dot-density":this._updateDotDensityInfo(n)}};h.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,oesTextureFloat:d().supportsTextureFloat}};h.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1};h._updateEffects=function(n){D.isSome(n)&&n.filter&&n.filter.enabled&&(this.outsideLabelsVisible=n.excludedLabelsVisible)};
h._updateVisualVariables=function(n,u){const t=this._vvMaterialParameters;t.vvOpacityEnabled=!1;t.vvSizeEnabled=!1;t.vvColorEnabled=!1;t.vvRotationEnabled=!1;if(n){var k=n.size;if(k){t.vvSizeEnabled=!0;if(k.minMaxValue){const p=k.minMaxValue;let r;if(a.isDefined(p.minSize)&&a.isDefined(p.maxSize))if(a.isNumber(p.minSize)&&a.isNumber(p.maxSize)){r=A.pt2px(p.minSize);var v=A.pt2px(p.maxSize)}else v=u.scale,r=A.pt2px(e(v,p.minSize.stops)),v=A.pt2px(e(v,p.maxSize.stops));this.vvSizeMinMaxValue.set([p.minDataValue,
p.maxDataValue,r,v])}k.scaleStops&&(this.vvSizeScaleStopsValue=A.pt2px(e(u.scale,k.scaleStops.stops)));k.unitValue&&(this.vvSizeUnitValueToPixelsRatio=m.getMetersPerUnitForSR(u.spatialReference)/c.meterIn[k.unitValue.unit]/u.resolution);k.fieldStops&&(this._vvSizeFieldStops=k.fieldStops)}if(u=n.color)t.vvColorEnabled=!0,this.vvColorValues.set(u.values),this.vvColors.set(u.colors);if(u=n.opacity)t.vvOpacityEnabled=!0,this.vvOpacityValues.set(u.values),this.vvOpacities.set(u.opacities);if(n=n.rotation)t.vvRotationEnabled=
!0,t.vvRotationType=n.type}};h._updateDotDensityInfo=function(n){var u=n.attributes;this.ddDotValue=n.dotValue;this.ddDotScale=n.referenceScale;this.ddDotSize=n.dotSize;this.ddDotBlending=n.dotBlendingEnabled;this.ddSeed=n.seed;for(let t=0;t<b.DOT_DENSITY_MAX_FIELDS;t++){const k=t>=u.length?new C([0,0,0,0]):u[t].color;f(this.ddColors,k,4*t)}for(u=0;8>u;u++)this.ddActiveDots[u]=u<n.attributes.length?1:0;f(this.ddBackgroundColor,n.backgroundColor)};E._createClass(q,[{key:"vvMaterialParameters",get:function(){return this._vvMaterialParameters}}]);
return q}();z.WGLRendererInfo=g;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("exports ../../../../core/has ../../../../core/maybe ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/SpatialReference ../../../../geometry/support/intersects ../../../../geometry/support/boundsUtils ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/aaBoundingRect ../../../../chunks/vec2 ../../../../chunks/mat2d ../../../../chunks/mat2df32 ../../../../chunks/vec2f32 ../../engine/webgl/alignmentUtils ../../engine/webgl/mesh/templates/shapingUtils ../../engine/webgl/util/BidiText ../../../../symbols/cim/CIMSymbolHelper".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k){function v(P,L,O,T,ea,fa){let ha,ia;var la=d.pt2px(O.xoffset);const qa=d.pt2px(O.yoffset),oa=R*O.angle;fa*=R;switch(O.type){case "esriSMS":ha=ia=d.pt2px(O.size);break;case "esriPMS":ha=d.pt2px(O.width),ia=d.pt2px(O.height)}.04>ea&&(T=.04*T/ea);O=g.identity(N);g.translate(O,O,f.set(I,P,L));g.rotate(O,O,fa-oa);g.scale(O,O,f.set(I,T,-T));g.translate(O,O,f.set(I,la,-qa));P=[0,0];f.transformMat2d(P,f.set(I,-.5*ha,-.5*ia),O);L=[0,0];f.transformMat2d(L,f.set(I,
-.5*ha,.5*ia),O);T=[0,0];f.transformMat2d(T,f.set(I,.5*ha,-.5*ia),O);la=[0,0];f.transformMat2d(la,f.set(I,.5*ha,.5*ia),O);return{rings:[[P,T,la,L,P]]}}function p(P,L,O,T,ea,fa){var ha=k.CIMSymbolHelper.getEnvelope(O.data);if(!ha)return null;.04>ea&&(T=.04*T/ea);ea=d.pt2px(ha.width);var ia=d.pt2px(ha.height);O=d.pt2px(ha.x);ha=d.pt2px(ha.y);const la=0*R,qa=R*fa;fa=g.identity(N);g.translate(fa,fa,f.set(I,P,L));g.rotate(fa,fa,qa-la);g.scale(fa,fa,f.set(I,T,T));P=[0,0];f.transformMat2d(P,f.set(I,O,ha+
ia),fa);L=[0,0];f.transformMat2d(L,f.set(I,O,ha),fa);T=[0,0];f.transformMat2d(T,f.set(I,O+ea,ha+ia),fa);ia=[0,0];f.transformMat2d(ia,f.set(I,O+ea,ha),fa);return{rings:[[P,T,ia,L,P]]}}function r(P,L,O,T,ea,fa){var ha=d.pt2px(O.xoffset),ia=d.pt2px(O.yoffset);O=R*O.angle;const la=R*fa;fa=g.identity(N);g.translate(fa,fa,f.set(I,P,L));g.rotate(fa,fa,la);g.scale(fa,fa,f.set(I,ea,-ea));P=T[0]+T[2]/2;L=T[1]+T[3]/2;g.translate(fa,fa,f.set(I,ha,-ia));g.translate(fa,fa,f.set(I,P,L));g.rotate(fa,fa,O);g.translate(fa,
fa,f.set(I,-P,-L));ha=[0,0];f.transformMat2d(ha,f.set(I,T[0],T[1]),fa);ia=[0,0];f.transformMat2d(ia,f.set(I,T[0],T[1]+T[3]),fa);O=[0,0];f.transformMat2d(O,f.set(I,T[0]+T[2],T[1]),fa);P=[0,0];f.transformMat2d(P,f.set(I,T[0]+T[2],T[1]+T[3]),fa);return{rings:[[ha,O,P,ia,ha]]}}function w(P){switch(P.symbol.type){case "esriSFS":case "esriPFS":return(P=P.symbol.outline)?P.width:0;case "esriSLS":return d.pt2px(P.symbol.width);case "esriSMS":return d.pt2px(P.symbol.size);case "esriPMS":return d.pt2px(Math.max(P.symbol.width,
P.symbol.height));case "esriTS":{const L=[0,0,0,0];l(L,P.symbol,P.mosaicItem);return Math.max(L[2],L[3])+Math.max(Math.abs(L[0]),Math.abs(L[1]))}case "expanded-cim":return P=k.CIMSymbolHelper.getEnvelope(P.symbol.data),d.pt2px(Math.sqrt(P.width*P.width+P.height*P.height));case "composite-symbol":return P.symbol.layers.length?w({symbol:P.symbol.layers[P.symbol.layers.length-1],mosaicItem:null}):0;default:return 0}}function l(P,L,O){if(!O||0===O.glyphMosaicItems.length)return P;const T=t.bidiText(L.text)[1];
L=u.shapeGlyphs(O.glyphMosaicItems,T,{scale:d.pt2px(L.font.size)/24,angle:L.angle,xOffset:L.xoffset,yOffset:L.yoffset,hAlign:n.getXAnchorDirection(L.horizontalAlignment||"center"),vAlign:n.getYAnchorDirection(L.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(L.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(L.lineHeight||1,4)),decoration:L.font.decoration||"none",isCIM:!1}).bounds;P[0]=d.pt2px(L.x-L.halfWidth);P[1]=d.pt2px(L.y-L.halfHeight);P[2]=d.pt2px(L.width);P[3]=d.pt2px(L.height);
return P}function x(P,L){return Math.ceil((P-L)/(2*L))}function y(P,L){var O=b.isPolygon(P)?P.rings:P.paths;for(const T of O)for(const ea of T)ea[0]+=L;return P}function B(P,L){if(!L)return P;const O=F(P,L).map(T=>T.extent);return 2>O.length?O[0]||P:2<O.length?(P.xmin=L.valid[0],P.xmax=L.valid[1],P):{rings:O.map(T=>[[T.xmin,T.ymin],[T.xmin,T.ymax],[T.xmax,T.ymax],[T.xmax,T.ymin],[T.xmin,T.ymin]])}}function F(P,L){const O=[],{ymin:T,ymax:ea}=P;var fa=P.xmax-P.xmin,ha=P.xmin,ia=P.xmax;const [la,qa]=
L.valid;var oa=G(P.xmin,L);var ra=oa.x;const na=oa.frameId;oa=G(P.xmax,L);P=oa.x;oa=oa.frameId;L=ra===P&&0<fa;if(fa>2*qa){fa={xmin:ha<ia?ra:P,ymin:T,xmax:qa,ymax:ea};ha={xmin:la,ymin:T,xmax:ha<ia?P:ra,ymax:ea};ia={xmin:0,ymin:T,xmax:qa,ymax:ea};ra={xmin:la,ymin:T,xmax:0,ymax:ea};P=[];L=[];J(fa,ia)&&P.push(na);J(fa,ra)&&L.push(na);J(ha,ia)&&P.push(oa);J(ha,ra)&&L.push(oa);for(let ta=na+1;ta<oa;ta++)P.push(ta),L.push(ta);O.push({extent:fa,frameIds:[na]},{extent:ha,frameIds:[oa]},{extent:ia,frameIds:P},
{extent:ra,frameIds:L})}else ra>P||L?O.push({extent:{xmin:ra,ymin:T,xmax:qa,ymax:ea},frameIds:[na]},{extent:{xmin:la,ymin:T,xmax:P,ymax:ea},frameIds:[oa]}):O.push({extent:{xmin:ra,ymin:T,xmax:P,ymax:ea},frameIds:[na]});return O}function G(P,L){const [O,T]=L.valid;L=2*T;var ea=0;P>T?(ea=Math.ceil(Math.abs(P-T)/L),P-=ea*L):P<O&&(ea=Math.ceil(Math.abs(P-O)/L),P+=ea*L,ea=-ea);return{x:P,frameId:ea}}function J(P,L){const {xmin:O,ymin:T,xmax:ea,ymax:fa}=L;return K(P,O,T)&&K(P,O,fa)&&K(P,ea,fa)&&K(P,ea,
T)}function K(P,L,O){return L>=P.xmin&&L<=P.xmax&&O>=P.ymin&&O<=P.ymax?!0:!1}function M(P,L,O){if(Array.isArray(P)){var T=P[0];T>L?(O=x(T,L),P[0]=T+-2*O*L):T<O&&(L=x(T,O),P[0]=T+-2*L*O)}else T=P.x,T>L?(O=x(T,L),P.x+=-2*O*L):T<O&&(L=x(T,O),P.x+=-2*L*O);return P}const R=Math.PI/180,N=q.create(),I=h.create(),H=e.create(),Q=h.create(),W=h.create(),aa=h.create(),da=h.create(),S=h.create(),U=h.create(),X=h.create(),ba={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,
-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:A.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:A.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:A.WGS84}}};let Z=function(){function P(){}P.prototype.cut=function(L,O){let T;if(L.rings)this.closed=
!0,T=L.rings,this.minPts=4;else if(L.paths)this.closed=!1,T=L.paths,this.minPts=2;else return null;const ea=T.length;O*=-2;for(let fa=0;fa<ea;fa++){const ha=T[fa];if(ha&&ha.length>=this.minPts){const ia=[];for(const la of ha)ia.push([la[0]+O,la[1]]);T.push(ia)}}this.closed?L.rings=T:L.paths=T;return L};return P}();z.getBounds=function(P,L,O,T,ea,fa,ha){if(!T||!O.symbol)return P[0]=P[1]=P[2]=P[3]=0,L[0]=L[1]=L[2]=L[3]=0,P;if(b.isPoint(T)){var ia=T.x;const qa=T.y;"esriTS"===O.symbol.type&&0===L[2]&&
0===L[3]&&l(L,O.symbol,O.mosaicItem);T=ia;ia=qa;O=O.symbol;switch(O.type){case "esriSMS":case "esriPMS":var la=v(T,ia,O,ea,fa,0);break;case "esriTS":la=r(T,ia,O,L,ea,0);break;case "cim":case "CIMSymbolReference":case "expanded-cim":la=p(T,ia,O,ea,fa,0)}L=0;for(ea=0;ea<la.rings[0].length-1;ea++)O=la.rings[0][ea],O=(T-O[0])*(T-O[0])+(ia-O[1])*(ia-O[1]),L=Math.max(L,O);L=Math.sqrt(L);la=a.normalizeMapX(T-L,ha);T=a.normalizeMapX(T+L,ha);if(la>T&&(ha=C.getInfo(ha))){const [oa,ra]=ha.valid;la=oa;T=ra}P[0]=
la;P[1]=ia-L;P[2]=T;P[3]=ia+L}else c.getBoundsXY(P,T),ha=L[0],0===ha&&(ha=w(O),L[0]=ha),ha=ea*ha/2,P[0]-=ha,P[1]-=ha,P[2]+=ha,P[3]+=ha;return P};z.getCIMMarkerBounds=p;z.getMarkerSymbolBounds=v;z.getTextSymbolBounds=r;z.getTextSymbolSize=l;z.graphicGeometryToNumber=function(P){switch(D.unwrap(P.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};z.isMarkerSymbol=function(P){return"simple-marker"===P||"picture-marker"===P||"text"===P};z.isPointOnPolyline=function(P,
L,O,T){f.set(aa,L,O);P=P.paths;let ea,fa,ha,ia,la,qa,oa,ra=Infinity;for(let ta=0;ta<P.length;ta++){const va=P[ta];if(!(2>va.length))for(let wa=1;wa<va.length;wa++){var na=va[wa-1][0];fa=va[wa-1][1];ea=va[wa][0];ha=va[wa][1];ia=Math.min(na,ea)-T;la=Math.min(fa,ha)-T;qa=Math.max(na,ea)+T;oa=Math.max(fa,ha)+T;L<ia||L>qa||O<la||O>oa||(f.set(Q,na,fa),f.set(W,ea,ha),f.subtract(da,W,Q),f.subtract(S,Q,aa),f.scale(U,da,f.dot(da,S)/f.dot(da,da)),f.subtract(X,S,U),na=f.dot(X,X),ra>na&&(ra=na))}}return Math.sqrt(ra)<=
T};z.normalizeCentralMeridian=function(P){let L,O;let T=null;if(!P)return null;if("mesh"===P.type)return P.toJSON();var ea=P.spatialReference;var fa=C.getInfo(ea);if(!fa)return P.toJSON();var ha=ea.isWebMercator?102100:4326;L=ba[ha].maxX;O=ba[ha].minX;ea=ba[ha].plus180Line;ha=ba[ha].minus180Line;let ia;var la=P.toJSON();b.isPoint(la)?ia=M(la,L,O):b.isMultipoint(la)?(la.points=la.points.map(qa=>M(qa,L,O)),ia=la):b.isExtent(la)?ia=B(la,fa):b.isPolygon(la)||b.isPolyline(la)?(c.getBoundsXY(H,la),P={xmin:H[0],
ymin:H[1],xmax:H[2],ymax:H[3]},fa=2*x(P.xmin,O)*L,la=0===fa?la:y(la,fa),P.xmin+=fa,P.xmax+=fa,m.extentIntersectsPolyline(P,ea)&&P.xmax!==L?T=la:m.extentIntersectsPolyline(P,ha)&&P.xmin!==O?T=la:ia=la):ia=P.clone();return null!==T?(new Z).cut(T,L):ia};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/layers/graphics/GraphicStore":function(){define("../../../../core/has ../../../../geometry/support/contains ../../../../geometry/support/extentUtils ../../../../geometry/support/jsonUtils ../../../../core/screenUtils ../../../../core/unitUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/aaBoundingRect ../../../../chunks/rbush ./graphicsUtils ./GraphicStoreItem".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e){function f(n,u,t,k,v){g.minX=u;g.minY=t;g.maxX=k;g.maxY=v;return n.search(g)}const g={minX:0,minY:0,maxX:0,maxY:0},q=b.create(),h=[];return function(){function n(t,k,v,p,r,w){this._graphics=p;this._onAdd=r;this._onRemove=w;this._index=d.rbush(9,z("csp-restrictions")?l=>({minX:l.bounds[0],minY:l.bounds[1],maxX:l.bounds[2],maxY:l.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);this._itemByGraphic=new Map;this._currentLevel=-Infinity;this._tileInfoView=
t;this._uidFieldName=v;if(k=t.getClosestInfoForScale(k))this._currentLevel=k.level,this._resolution=this._tileInfoView.getTileResolution(k.level);this._metersPerUnit=m.getMetersPerUnit(t.spatialReference)}var u=n.prototype;u.hitTest=function(t,k,v,p,r){t=c.normalizeMapX(t,this._tileInfoView.spatialReference);var w=.5*p*v;q[0]=t-w;q[1]=k-w;q[2]=t+w;q[3]=k+w;v=.5*p*(v+50);var l=f(this._index,t-v,k-v,t+v,k+v);if(!l||0===l.length)return[];v={x:t,y:k};w=[];for(const y of l)if(y.graphic.visible)switch(C.getJsonType(y.geometry)){case "esriGeometryPoint":{l=
y.symbol;if(!l)continue;const {x:B,y:F}=y.geometry;var x=p*this._metersPerUnit;let G;switch(l.type){case "esriTS":G=a.getTextSymbolBounds(B,F,l,y.size,p,r);break;case "expanded-cim":G=a.getCIMMarkerBounds(B,F,l,p,x,r);break;case "esriSMS":case "esriPMS":G=a.getMarkerSymbolBounds(B,F,l,p,x,r)}E.polygonContainsPoint(G,v)&&w.push(y)}break;case "esriGeometryPolyline":(l=y.symbol)&&l.layers.length&&(l=1.5*p*window.devicePixelRatio*A.pt2px(l.layers[0].width),a.isPointOnPolyline(y.geometry,t,k,l)&&w.push(y));
break;case "esriGeometryEnvelope":l=y.geometry;l=b.fromValues(l.xmin,l.ymin,l.xmax,l.ymax);b.intersects(l,q)&&w.push(y);break;case "esriGeometryPolygon":if(E.polygonContainsPoint(y.geometry,v)){w.push(y);break}l=D.getPolygonExtent(y.geometry);if(Math.abs(l.ymax-l.ymin)<5*p||Math.abs(l.xmax-l.xmin)<5*p)l=b.fromValues(l.xmin,l.ymin,l.xmax,l.ymax),b.intersects(l,q)&&w.push(y);break;case "esriGeometryMultipoint":{l=y.symbol;if(!l)continue;x=y.geometry.points;let B;for(let F=0;F<x.length;F++)if(B="esriTS"===
l.type?a.getTextSymbolBounds(x[F][0],x[F][1],l,y.size,p,r):a.getMarkerSymbolBounds(x[F][0],x[F][1],l,p,p*this._metersPerUnit,r),E.polygonContainsPoint(B,v)){w.push(y);break}}}w.sort((y,B)=>{const F=a.graphicGeometryToNumber(y.graphic),G=a.graphicGeometryToNumber(B.graphic);return F===G?B.zorder-y.zorder:F-G});return w.map(y=>y.graphic)};u.getGraphicsData=function(t,k,v){const p=f(this._index,k.bounds[0],k.bounds[1],k.bounds[2],k.bounds[3]);if(0===p.length||0===v.length)return[];p.sort((y,B)=>y.zorder-
B.zorder);p[0].insertAfter=-1;for(var r=1;r<p.length;r++)p[r].insertAfter=p[r-1].graphic.uid;p.sort((y,B)=>y.graphic.uid-B.graphic.uid);v.sort((y,B)=>y.uid-B.uid);let w=r=0,l;const x=[];k={originPosition:"upperLeft",scale:[k.resolution,k.resolution],translate:[k.bounds[0],k.bounds[3]]};for(const y of v){for(w=-2;r<p.length;)if(l=p[r],r++,y.uid===l.graphic.uid){w=l.insertAfter;break}if(!l.geometry||-2===w)continue;v=l.getGeometryQuantized(k);const B={...l.graphic.attributes};B[this._uidFieldName]=
y.uid;null==l.groupId&&(l.groupId=t.createTemplateGroup(l.symbol,null));x.push({centroid:e.getCentroidQuantized(l,k),geometry:v,attributes:B,symbol:l.symbol,groupId:l.groupId,insertAfter:w,zorder:l.zorder})}x.sort((y,B)=>y.zorder-B.zorder);return x};u.queryTileData=function(t,k){var v=b.pad(k.bounds,50*k.resolution,b.create());v=f(this._index,v[0],v[1],v[2],v[3]);const p=[];this._createTileGraphics(p,t,v,{originPosition:"upperLeft",scale:[k.resolution,k.resolution],translate:[k.bounds[0],k.bounds[3]]});
return p};u.has=function(t){return this._itemByGraphic.has(t)};u.getBounds=function(t){return this._itemByGraphic.has(t)?this._itemByGraphic.get(t).bounds:null};u.addOrModify=function(t,k,v){if(t)return this.has(t)&&this.remove(t),this._onAdd(t),k=e.acquire(t,k,v,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference),this._itemByGraphic.set(t,k),v&&this._index.insert(k),k.bounds};u.remove=function(t){if(this._itemByGraphic.has(t)){this._onRemove(t);var k=this._itemByGraphic.get(t);
this._index.remove(k);this._itemByGraphic.delete(t)}};u.updateZ=function(){const t=this._graphics.items;for(let v=0;v<t.length;v++){var k=t[v];if(k=this._itemByGraphic.get(k))k.zorder=v}};u.update=function(t,k,v){const p=this._itemByGraphic.get(t);p.groupId=null;const r=b.clone(p.bounds);p.size[0]=p.size[1]=0;this._index.remove(p);p.set(t,k,v,this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);v&&this._index.insert(p);return{oldBounds:r,newBounds:p.bounds}};
u.updateLevel=function(t){this._currentLevel!==t&&(this._currentLevel=t,this._resolution=this._tileInfoView.getTileResolution(t),this._index.clear(),h.length=0,this._itemByGraphic.forEach(k=>{k.updateBounds(this._resolution,this._resolution*this._metersPerUnit,this._tileInfoView.spatialReference);k.geometry&&h.push(k)}),this._index.load(h))};u.clear=function(){this._itemByGraphic.clear();this._index.clear()};u._createTileGraphics=function(t,k,v,p){const r=this._uidFieldName;v.sort((B,F)=>B.zorder-
F.zorder);let w,l,x,y;for(let B=0;B<v.length;B++){x=v[B];w=x.graphic;l=x.getGeometryQuantized(p);y=0===B?-1:v[B-1].graphic.uid;const F={...x.graphic.attributes};F[r]=w.uid;null==x.groupId&&(x.groupId=k.createTemplateGroup(x.symbol,null));t.push({centroid:e.getCentroidQuantized(x,p),geometry:l,attributes:F,symbol:x.symbol,groupId:x.groupId,insertAfter:y,zorder:x.zorder})}};return n}()})},"esri/views/2d/layers/graphics/GraphicStoreItem":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../core/maybe ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/aaBoundingRect ../../../../layers/graphics/OptimizedGeometry ../../../../layers/graphics/featureConversionUtils ../../../../geometry/support/quantizationUtils ./graphicsUtils".split(" "),
function(z,E,D,C,A,m,c,b,d){const a=new m,e=new m;m=function(){function f(){this.bounds=A.create();this.graphic=null;this.size=[0,0,0,0]}f.acquire=function(q=null,h,n,u,t,k){let v;0===f._pool.length?v=new f:(v=f._pool.pop(),this._set.delete(v));v.acquire(q,h,n,u,t,k);return v};f.release=function(q){q&&!this._set.has(q)&&(q.release(),this._pool.push(q),this._set.add(q))};f.getCentroidQuantized=function(q,h){if(C.isPolygon(q.geometry)){const n=q.symbol;if(E.isNone(n))return null;if(d.isMarkerSymbol(n.type))return q=
D.polygonCentroid(q.geometry),b.quantizePoint(h,{},{x:q[0],y:q[1]},!1,!1)}return null};var g=f.prototype;g.acquire=function(q=null,h,n,u,t,k){q&&this.set(q,h,n,u,t,k)};g.release=function(){this.geometry=this.symbolResource=this.graphic=null};g.set=function(q,h,n,u,t,k){this.graphic=q;this.geometry=n;this.symbolResource=h;this.updateBounds(u,t,k)};g.updateBounds=function(q,h,n){d.getBounds(this.bounds,this.size,this.symbolResource,this.geometry,q,h,n)};g.getGeometryQuantized=function(q){if(C.isPolygon(this.geometry)){const h=
this.geometry.rings;if(1===h.length&&2===h[0].length)return b.quantizeGeometry(q,{paths:[[h[0][0],h[0][1]]]})}else if(C.isPolyline(this.geometry))return a.coords.length=0,a.lengths.length=0,e.coords.length=0,e.lengths.length=0,c.convertFromPolyline(a,this.geometry),c.generalizeOptimizedGeometry(e,a,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",q.scale[0]),c.quantizeOptimizedGeometry(a,e,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",q),c.convertToPolyline(a,this.geometry.hasZ,
this.geometry.hasM);return b.quantizeGeometry(q,this.geometry)};z._createClass(f,[{key:"symbol",get:function(){return this.symbolResource.symbol}}]);return f}();m._pool=[];m._set=new Set;return m})},"esri/views/layers/GraphicsView":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/tslib.es6 ../../core/has ../../core/Logger ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/property ../../core/jsonMap ../../core/accessorSupport/decorators/subclass ../../core/urlUtils ../../core/uuid ../../portal/support/resourceExtension ../../core/Identifiable".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g){z.GraphicsView=q=>{q=function(h){function n(){var u=h.apply(this,arguments)||this;u.graphics=null;u.renderer=null;u.view=null;return u}E._inheritsLoose(n,h);return n}(g.IdentifiableMixin(q));D.__decorate([c.property()],q.prototype,"graphics",void 0);D.__decorate([c.property()],q.prototype,"renderer",void 0);D.__decorate([c.property()],q.prototype,"updating",void 0);D.__decorate([c.property()],q.prototype,"view",void 0);return q=D.__decorate([d.subclass("esri.views.layers.GraphicsView")],
q)};Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/navigation/MapViewNavigation":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../geometry/Point ../../../Viewpoint ../viewpointUtils ./ZoomBox ./actions/Pan ./actions/Pinch ./actions/Rotate".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k){const v=new q({targetGeometry:new g}),p=[0,0];D=function(r){function w(x){x=r.call(this,x)||this;x._endTimer=null;x.animationManager=null;return x}z._inheritsLoose(w,r);var l=w.prototype;l.initialize=function(){this.pan=new u({navigation:this});this.rotate=new k({navigation:this});this.pinch=new t({navigation:this});this.zoomBox=new n({view:this.view,navigation:this})};l.destroy=function(){this.zoomBox.destroy();this.animationManager=this.zoomBox=null};
l.begin=function(){this._set("interacting",!0)};l.end=function(){this._lastEventTimestamp=performance.now();this._startTimer(250)};l.zoom=async function(x,y=this._getDefaultAnchor()){this.stop();this.begin();if(this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs)return 1>x?this.zoomIn(y):this.zoomOut(y);this.setViewpoint(y,x,0,[0,0])};l.zoomIn=async function(x){var y=this.view;y=y.constraints.snapToNextScale(y.scale);return this._zoomToScale(y,x)};l.zoomOut=async function(x){var y=
this.view;y=y.constraints.snapToPreviousScale(y.scale);return this._zoomToScale(y,x)};l.setViewpoint=function(x,y,B,F){this.begin();this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,x,y,B,F);this.end()};l.setViewpointImmediate=function(x,y=0,B=[0,0],F=this._getDefaultAnchor()){this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,F,x,y,B)};l.continousRotateClockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,
y=>{h.rotateBy(y,y,-1)})};l.continousRotateCounterclockwise=function(){const x=this.get("view.viewpoint");this.animationManager.animateContinous(x,y=>{h.rotateBy(y,y,1)})};l.resetRotation=function(){this.view.rotation=0};l.continousPanLeft=function(){this._continuousPan([-10,0])};l.continousPanRight=function(){this._continuousPan([10,0])};l.continousPanUp=function(){this._continuousPan([0,10])};l.continousPanDown=function(){this._continuousPan([0,-10])};l.stop=function(){this.pan.stopMomentumNavigation();
this.animationManager.stop();this.end();null!==this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null,this._set("interacting",!1))};l._continuousPan=function(x){const y=this.get("view.viewpoint");this.animationManager.animateContinous(y,B=>{h.translateBy(B,B,x);this.view.constraints.constrainByGeometry(B)})};l._startTimer=function(x){return null!==this._endTimer?this._endTimer:this._endTimer=setTimeout(()=>{this._endTimer=null;const y=performance.now()-this._lastEventTimestamp;250>y?this._endTimer=
this._startTimer(y):this._set("interacting",!1)},x)};l._getDefaultAnchor=function(){const {size:x,padding:{left:y,right:B,top:F,bottom:G}}=this.view;p[0]=.5*(x[0]-B+y);p[1]=.5*(x[1]-G+F);return p};l._zoomToScale=async function(x,y=this._getDefaultAnchor()){const {view:B}=this,{constraints:F,scale:G,viewpoint:J,size:K,padding:M}=B,R=F.canZoomInTo(x),N=F.canZoomOutTo(x);if(!(x<G&&!R||x>G&&!N))return h.padAndScaleAndRotateBy(v,J,x/G,0,y,K,M),F.constrainByGeometry(v),B.goTo(v,{animate:!0})};l._scaleRotateTranslateViewpoint=
function(x,y,B,F,G){var {view:J}=this;const {size:K,padding:M,constraints:R,scale:N,viewpoint:I}=J;var H=N*B;J=R.canZoomInTo(H);H=R.canZoomOutTo(H);if(1>B&&!J||1<B&&!H)B=1;h.translateBy(I,I,G);h.padAndScaleAndRotateBy(x,I,B,F,y,K,M);return R.constrainByGeometry(x)};return w}(f);E.__decorate([m.property()],D.prototype,"animationManager",void 0);E.__decorate([m.property({type:Boolean,readOnly:!0})],D.prototype,"interacting",void 0);E.__decorate([m.property()],D.prototype,"pan",void 0);E.__decorate([m.property()],
D.prototype,"pinch",void 0);E.__decorate([m.property()],D.prototype,"rotate",void 0);E.__decorate([m.property()],D.prototype,"view",void 0);E.__decorate([m.property()],D.prototype,"zoomBox",void 0);return D=E.__decorate([b.subclass("esri.views.2d.navigation.MapViewNavigation")],D)})},"esri/views/2d/navigation/ZoomBox":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/Accessor ../../../core/screenUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g){D=function(q){function h(u){u=q.call(this,u)||this;u._container=null;u._overlay=null;u._backgroundShape=null;u._boxShape=null;u._box={x:0,y:0,width:0,height:0};u._redraw=u._redraw.bind(z._assertThisInitialized(u));return u}z._inheritsLoose(h,q);var n=h.prototype;n.destroy=function(){this.view=null};n._start=function(){this._createContainer();this._createOverlay();this.navigation.begin()};n._update=function(u,t,k,v){this._box.x=u;this._box.y=t;this._box.width=k;
this._box.height=v;this._rafId||(this._rafId=requestAnimationFrame(this._redraw))};n._end=function(u,t,k,v,p){const r=this.view;u=r.toMap(g.createScreenPoint(u+.5*k,t+.5*v));k=Math.max(k/r.width,v/r.height);-1===p&&(k=1/k);this._destroyOverlay();this.navigation.end();r.goTo({center:u,scale:r.scale*k})};n._updateBox=function(u,t,k,v){const p=this._boxShape;p.setAttributeNS(null,"x",""+u);p.setAttributeNS(null,"y",""+t);p.setAttributeNS(null,"width",""+k);p.setAttributeNS(null,"height",""+v);p.setAttributeNS(null,
"class","esri-zoom-box__outline")};n._updateBackground=function(u,t,k,v){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(u,t,k,v,this.view.width,this.view.height))};n._createContainer=function(){const u=document.createElement("div");u.className="esri-zoom-box__container";this.view.root.appendChild(u);this._container=u};n._createOverlay=function(){var u=this.view.width,t=this.view.height;const k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M 0 0 L "+
u+" 0 L "+u+" "+t+" L 0 "+t+" Z");k.setAttributeNS(null,"class","esri-zoom-box__overlay-background");u=document.createElementNS("http://www.w3.org/2000/svg","rect");t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");t.setAttributeNS(null,"class","esri-zoom-box__overlay");t.appendChild(k);t.appendChild(u);this._container.appendChild(t);this._backgroundShape=k;this._boxShape=u;this._overlay=t};
n._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container=this._backgroundShape=this._boxShape=this._overlay=null};n._toSVGPath=function(u,t,k,v,p,r){k=u+k;v=t+v;return"M 0 0 L "+p+" 0 L "+p+" "+r+" L 0 "+r+" ZM "+u+" "+t+" L "+u+" "+v+" L "+k+" "+v+" L "+k+" "+t+" Z"};n._handleDrag=function(u,t){var k=u.x,v=u.y,p=u.origin.x;const r=u.origin.y;let w;k>p?(w=p,p=k-p):(w=k,p-=k);v>r?(k=r,v-=r):(k=v,v=r-v);switch(u.action){case "start":this._start();
break;case "update":this._update(w,k,p,v);break;case "end":this._end(w,k,p,v,t)}u.stopPropagation()};n._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var {x:u,y:t,width:k,height:v}=this._box;this._updateBox(u,t,k,v);this._updateBackground(u,t,k,v);this._rafId=requestAnimationFrame(this._redraw)}};z._createClass(h,[{key:"view",set:function(u){this._handles&&this._handles.forEach(t=>{t.remove()});this._handles=null;this._destroyOverlay();this._set("view",u);u&&(u.on("drag",["Shift"],
t=>this._handleDrag(t,1)),u.on("drag",["Shift","Ctrl"],t=>this._handleDrag(t,-1)))}}]);return h}(f);E.__decorate([m.property()],D.prototype,"navigation",void 0);E.__decorate([m.property()],D.prototype,"view",null);return D=E.__decorate([b.subclass("esri.views.2d.navigation.ZoomBox")],D)})},"esri/views/2d/navigation/actions/Pan":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../core/screenUtils ../../../../chunks/vec3f64 ../../../../chunks/vec3 ../../../../Viewpoint ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v){D=function(p){function r(l){var x=p.call(this,l)||this;x.animationTime=0;x.momentumEstimator=new v.PanPlanarMomentumEstimator(500,6,.92);x.momentum=null;x.tmpMomentum=n.create();x.momentumFinished=!1;x.viewpoint=new t({targetGeometry:new g,scale:0,rotation:0});x.watch("momentumFinished",y=>{y&&x.navigation.stop()});return x}z._inheritsLoose(r,p);var w=r.prototype;w.begin=function(l,x){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(x);
this.previousDrag=x};w.update=function(l,x){this.addToEstimator(x);let y=x.center.x,B=x.center.y;const F=this.previousDrag;y=F?F.center.x-y:-y;B=F?B-F.center.y:B;l.viewpoint=k.translateBy(this.viewpoint,l.viewpoint,[y||0,B||0]);this.previousDrag=x};w.end=function(l,x){this.addToEstimator(x);this.momentum=l.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(l);this.previousDrag=null;this.navigation.end()};w.addToEstimator=
function(l){var x=l.center.x;const y=l.center.y,B=h.createScreenPointArray(-x,y);x=n.fromValues(-x,y,0);this.momentumEstimator.add(B,x,.001*l.timestamp)};w.onAnimationUpdate=function(l){this.navigation.animationManager.animateContinous(l.viewpoint,(x,y)=>{this.momentumFinished=!this.momentum||this.momentum.isFinished(this.animationTime);y*=.001;if(!this.momentumFinished){const B=this.momentum.valueDelta(this.animationTime,y);u.scale(this.tmpMomentum,this.momentum.direction,B);k.translateBy(x,x,this.tmpMomentum);
l.constraints.constrainByGeometry(x)}this.animationTime+=y})};w.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())};return r}(f);E.__decorate([m.property()],D.prototype,"momentumFinished",void 0);E.__decorate([m.property()],D.prototype,"viewpoint",void 0);E.__decorate([m.property()],D.prototype,"navigation",void 0);return D=E.__decorate([b.subclass("esri.views.2d.navigation.actions.Pan")],D)})},"esri/views/navigation/PanPlanarMomentumEstimator":function(){define("exports ../../chunks/_rollupPluginBabelHelpers ../../chunks/vec3f64 ../../chunks/vec3 ./FilteredFiniteDifference ./Momentum".split(" "),
function(z,E,D,C,A,m){let c=function(b){function d(a,e,f,g,q){a=b.call(this,a,e,f)||this;a.sceneVelocity=g;a.direction=q;return a}E._inheritsLoose(d,b);d.prototype.value=function(a){return b.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,a)};return d}(m.Momentum);m=function(){function b(a=300,e=12,f=.84){this.minimumInitialVelocity=a;this.stopVelocity=e;this.friction=f;this.enabled=!0;this.time=new A.FilteredFiniteDifference(.6);this.screen=[new A.FilteredFiniteDifference(.4),new A.FilteredFiniteDifference(.4)];
this.scene=[new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6),new A.FilteredFiniteDifference(.6)];this.tmpDirection=D.create()}var d=b.prototype;d.add=function(a,e,f){!this.enabled||this.time.hasLastValue&&.015>this.time.computeDelta(f)||(this.screen[0].update(a[0]),this.screen[1].update(a[1]),this.scene[0].update(e[0]),this.scene[1].update(e[1]),this.scene[2].update(e[2]),this.time.update(f))};d.reset=function(){this.screen[0].reset();this.screen[1].reset();this.scene[0].reset();
this.scene[1].reset();this.scene[2].reset();this.time.reset()};d.evaluateMomentum=function(){if(!this.enabled||!this.screen[0].hasFilteredDelta)return null;var a=this.screen[0].filteredDelta;const e=this.screen[1].filteredDelta;a=Math.sqrt(a*a+e*e)/this.time.filteredDelta;return Math.abs(a)<this.minimumInitialVelocity?null:this.createMomentum(a,this.stopVelocity,this.friction)};d.createMomentum=function(a,e,f){C.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);
const g=C.length(this.tmpDirection);0<g&&C.scale(this.tmpDirection,this.tmpDirection,1/g);return new c(a,e,f,g/this.time.filteredDelta,this.tmpDirection)};return b}();z.PanPlanarMomentum=c;z.PanPlanarMomentumEstimator=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/navigation/FilteredFiniteDifference":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(z,E){let D=function(){function C(m){this.gain=m}var A=C.prototype;A.update=function(m){if(this.hasLastValue){const c=
this.computeDelta(m);this.updateDelta(c)}this.lastValue=m};A.reset=function(){this.filteredDelta=this.lastValue=void 0};A.computeDelta=function(m){return m-this.lastValue};A.updateDelta=function(m){this.filteredDelta=this.hasFilteredDelta?(1-this.gain)*this.filteredDelta+this.gain*m:m};E._createClass(C,[{key:"hasLastValue",get:function(){return void 0!==this.lastValue}},{key:"hasFilteredDelta",get:function(){return void 0!==this.filteredDelta}}]);return C}();z.FilteredFiniteDifference=D;Object.defineProperty(z,
"__esModule",{value:!0})})},"esri/views/navigation/Momentum":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers"],function(z,E){let D=function(){function C(m,c,b){this._initialVelocity=m;this._stopVelocity=c;this._friction=b;this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}var A=C.prototype;A.isFinished=function(m){return m>this.duration};A.value=function(m){return this.valueFromInitialVelocity(this._initialVelocity,
m)};A.valueDelta=function(m,c){const b=this.value(m);return this.value(m+c)-b};A.valueFromInitialVelocity=function(m,c){c=Math.min(c,this.duration);const b=1-this.friction;return m*(Math.pow(b,c)-1)/Math.log(b)};E._createClass(C,[{key:"duration",get:function(){return this._duration}},{key:"friction",get:function(){return this._friction}}]);return C}();z.Momentum=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Pinch":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../Viewpoint ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../../viewpointUtils ../../../navigation/RotationMomentumEstimator ../../../navigation/ZoomMomentumEstimator".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v){D=function(p){function r(l){var x=p.call(this,l)||this;x._animationTime=0;x._momentumFinished=!1;x._rotationMomentumEstimator=new k.RotationMomentumEstimator(.6,.15,.95);x._rotationDirection=1;x._zoomDirection=1;x._zoomMomentumEstimator=new v.ZoomMomentumEstimator;x._zoomOnly=null;x.zoomMomentum=null;x.rotateMomentum=null;x.viewpoint=new h({targetGeometry:new g,scale:0,rotation:0});x.watch("_momentumFinished",y=>{y&&x.navigation.stop()});return x}
z._inheritsLoose(r,p);var w=r.prototype;w.begin=function(l,x){this.navigation.begin();this._rotationMomentumEstimator.reset();this._zoomMomentumEstimator.reset();this._zoomOnly=null;this._previousAngle=this._startAngle=x.angle;this._previousRadius=this._startRadius=x.radius;this._previousCenter=x.center;this._updateTimestamp=null;l.constraints.rotationEnabled&&this.addToRotateEstimator(0,x.timestamp);this.addToZoomEstimator(x,1)};w.update=function(l,x){null===this._updateTimestamp&&(this._updateTimestamp=
x.timestamp);const y=x.angle,B=x.radius,F=x.center,G=Math.abs(180*(y-this._startAngle)/Math.PI),J=Math.abs(B-this._startRadius),K=this._startRadius/B;if(this._previousRadius){const M=B/this._previousRadius;let R=180*(y-this._previousAngle)/Math.PI;this._rotationDirection=0<=R?1:-1;this._zoomDirection=1<=M?1:-1;l.constraints.rotationEnabled?(null===this._zoomOnly&&200<x.timestamp-this._updateTimestamp&&(this._zoomOnly=0<J-G),null===this._zoomOnly||this._zoomOnly?R=0:this.addToRotateEstimator(y-this._startAngle,
x.timestamp)):R=0;this.addToZoomEstimator(x,K);this.navigation.setViewpoint([F.x,F.y],1/M,R,[this._previousCenter.x-F.x,F.y-this._previousCenter.y])}this._previousAngle=y;this._previousRadius=B;this._previousCenter=F};w.end=function(l){this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum();this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum();this._animationTime=0;if(this.rotateMomentum||this.zoomMomentum)this.onAnimationUpdate(l);this.navigation.end()};w.addToRotateEstimator=
function(l,x){this._rotationMomentumEstimator.add(l,.001*x)};w.addToZoomEstimator=function(l,x){this._zoomMomentumEstimator.add(x,.001*l.timestamp)};w.canZoomIn=function(l){const x=l.scale;l=l.constraints.effectiveMaxScale;return 0===l||x>l};w.canZoomOut=function(l){const x=l.scale;l=l.constraints.effectiveMinScale;return 0===l||x<l};w.onAnimationUpdate=function(l){this.navigation.animationManager.animateContinous(l.viewpoint,(x,y)=>{var B=!this.canZoomIn(l)&&1<this._zoomDirection||!this.canZoomOut(l)&&
1>this._zoomDirection,F=!this.rotateMomentum||this.rotateMomentum.isFinished(this._animationTime);B=B||!this.zoomMomentum||this.zoomMomentum.isFinished(this._animationTime);y*=.001;this._momentumFinished=F&&B;if(!this._momentumFinished){F=this.rotateMomentum?Math.abs(this.rotateMomentum.valueDelta(this._animationTime,y))*this._rotationDirection*180/Math.PI:0;B=this.zoomMomentum?Math.abs(this.zoomMomentum.valueDelta(this._animationTime,y)):1;const J=n.create();var G=n.create();if(this._previousCenter){u.set(J,
this._previousCenter.x,this._previousCenter.y);t.getPaddingScreenTranslation(G,l.size,l.padding);u.add(J,J,G);const {constraints:K,scale:M}=l;G=M*B;1>B&&!K.canZoomInTo(G)?(B=M/K.effectiveMaxScale,this.rotateMomentum=this.zoomMomentum=null):1<B&&!K.canZoomOutTo(G)&&(B=M/K.effectiveMinScale,this.rotateMomentum=this.zoomMomentum=null);t.scaleAndRotateBy(x,l.viewpoint,B,F,J,l.size);l.constraints.constrainByGeometry(x)}}this._animationTime+=y})};w.stopMomentumNavigation=function(){if(this.rotateMomentum||
this.zoomMomentum)this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop()};return r}(f);E.__decorate([m.property()],D.prototype,"_momentumFinished",void 0);E.__decorate([m.property()],D.prototype,"viewpoint",void 0);E.__decorate([m.property()],D.prototype,"navigation",void 0);return D=E.__decorate([b.subclass("esri.views.2d.navigation.actions.Pinch")],D)})},"esri/views/navigation/RotationMomentumEstimator":function(){define(["exports",
"../../chunks/_rollupPluginBabelHelpers","./MomentumEstimator"],function(z,E,D){D=function(C){function A(m=3,c=.01,b=.95,d=12){return C.call(this,m,c,b,d)||this}E._inheritsLoose(A,C);A.prototype.add=function(m,c){if(this.value.hasLastValue){const b=this.value.lastValue;for(m-=b;m>Math.PI;)m-=2*Math.PI;for(;m<-Math.PI;)m+=2*Math.PI;m=b+m}C.prototype.add.call(this,m,c)};return A}(D.MomentumEstimator);z.RotationMomentumEstimator=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/navigation/MomentumEstimator":function(){define(["exports",
"../../core/mathUtils","./FilteredFiniteDifference","./Momentum"],function(z,E,D,C){let A=function(){function m(b=2.5,d=.01,a=.95,e=12){this.minimumInitialVelocity=b;this.stopVelocity=d;this.friction=a;this.maxVelocity=e;this.enabled=!0;this.value=new D.FilteredFiniteDifference(.8);this.time=new D.FilteredFiniteDifference(.3)}var c=m.prototype;c.add=function(b,d){if(this.enabled){if(this.time.hasLastValue){if(.01>this.time.computeDelta(d))return;if(this.value.hasFilteredDelta){const a=this.value.computeDelta(b);
0>this.value.filteredDelta*a&&this.value.reset()}}this.time.update(d);this.value.update(b)}};c.reset=function(){this.value.reset();this.time.reset()};c.evaluateMomentum=function(){if(!this.enabled||!this.value.hasFilteredDelta)return null;let b=this.value.filteredDelta/this.time.filteredDelta;b=E.clamp(b,-this.maxVelocity,this.maxVelocity);return Math.abs(b)<this.minimumInitialVelocity?null:this.createMomentum(b,this.stopVelocity,this.friction)};c.createMomentum=function(b,d,a){return new C.Momentum(b,
d,a)};return m}();z.MomentumEstimator=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/navigation/ZoomMomentumEstimator":function(){define(["exports","../../chunks/_rollupPluginBabelHelpers","./Momentum","./MomentumEstimator"],function(z,E,D,C){let A=function(m){function c(d,a,e){return m.call(this,d,a,e)||this}E._inheritsLoose(c,m);var b=c.prototype;b.value=function(d){d=m.prototype.value.call(this,d);return Math.exp(d)};b.valueDelta=function(d,a){const e=m.prototype.value.call(this,
d);d=m.prototype.value.call(this,d+a);return Math.exp(d-e)};return c}(D.Momentum);D=function(m){function c(d=2.5,a=.01,e=.95,f=12){return m.call(this,d,a,e,f)||this}E._inheritsLoose(c,m);var b=c.prototype;b.add=function(d,a){m.prototype.add.call(this,Math.log(d),a)};b.createMomentum=function(d,a,e){return new A(d,a,e)};return c}(C.MomentumEstimator);z.ZoomMomentum=A;z.ZoomMomentumEstimator=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/navigation/actions/Rotate":function(){define("../../../../chunks/_rollupPluginBabelHelpers ../../../../chunks/tslib.es6 ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/ensureType ../../../../core/accessorSupport/decorators/property ../../../../core/jsonMap ../../../../core/accessorSupport/decorators/subclass ../../../../core/urlUtils ../../../../core/uuid ../../../../portal/support/resourceExtension ../../../../core/Accessor ../../../../geometry/Point ../../../../geometry ../../../../Viewpoint ../../../../chunks/vec2f64 ../../../../chunks/vec2 ../../viewpointUtils".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t){const k=n.create(),v=n.create();D=function(p){function r(l){l=p.call(this,l)||this;l._previousCenter=n.create();l.viewpoint=new h({targetGeometry:new g,scale:0,rotation:0});return l}z._inheritsLoose(r,p);var w=r.prototype;w.begin=function(l,x){this.navigation.begin();u.set(this._previousCenter,x.center.x,x.center.y)};w.update=function(l,x){const {state:{size:y,padding:B}}=l;u.set(k,x.center.x,x.center.y);t.getAnchor(v,y,B);l.viewpoint=t.rotateBy(this.viewpoint,
l.state.paddedViewState.viewpoint,t.angleBetween(v,this._previousCenter,k));u.copy(this._previousCenter,k)};w.end=function(){this.navigation.end()};return r}(f);E.__decorate([m.property()],D.prototype,"viewpoint",void 0);E.__decorate([m.property()],D.prototype,"navigation",void 0);return D=E.__decorate([b.subclass("esri.views.2d.actions.Rotate")],D)})},"esri/views/2d/magnifier/MagnifierView2D":function(){define("../../../chunks/_rollupPluginBabelHelpers ../../../core/maybe ../../../core/promiseUtils ../../../core/mathUtils ../../../request ../../../core/Handles ../../../core/watchUtils ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ../engine/DisplayObject ../../magnifier/resources ../engine/webgl/enums ../engine/webgl/shaders/MagnifierPrograms".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n,u,t,k,v){return function(p){function r(){var l=p.call(this)||this;l._handles=new m;l._resourcePixelRatio=1;l.visible=!1;return l}z._inheritsLoose(r,p);var w=r.prototype;w.destroy=function(){this._handles.destroy();this._handles=null;this._disposeRenderResources();this._resourcesTask&&(this._resourcesTask.abort(),this._resourcesTask=null)};w.doRender=function(l){const x=l.context;if(!this._resourcesTask)this._reloadResources();else if(l.drawPhase===k.WGLDrawPhase.MAP&&
this._canRender()){this._updateResources(l);var y=this._magnifier;if(!E.isNone(y.position)){var B=l.pixelRatio,F=y.size*B,G=Math.ceil(1/y.factor*F);this._readbackTexture.resize(G,G);var {size:J}=l.state;l=B*J[0];J=B*J[1];var K=.5*G,M=.5*G,R=C.clamp(B*y.position.x,K,l-K-1),N=C.clamp(J-B*y.position.y,M,J-M-1);K=R-K;M=N-M;var I=this._readbackTexture;x.bindTexture(I,0);x.gl.copyTexImage2D(I.descriptor.target,0,I.descriptor.pixelFormat,K,M,G,G,0);var H=(G=null==(H=this.background)?void 0:H.color)?[G.a*
G.r/255,G.a*G.g/255,G.a*G.b/255,G.a]:[1,1,1,1];G=-1+(R+y.offsetX*B)/l*2;B=-1+(N-y.offsetY*B)/J*2;l=F/l*2;F=F/J*2;J=this._program;x.bindVAO(this._vertexArrayObject);x.bindTexture(this._overlayTexture,6);x.bindTexture(this._maskTexture,7);x.bindProgram(J);J.setUniform4fv("u_background",H);J.setUniform1i("u_readbackTexture",0);J.setUniform1i("u_overlayTexture",6);J.setUniform1i("u_maskTexture",7);J.setUniform4f("u_drawPos",G,B,l,F);J.setUniform1i("u_maskEnabled",y.maskEnabled?1:0);J.setUniform1i("u_overlayEnabled",
y.overlayEnabled?1:0);x.setStencilTestEnabled(!1);x.drawArrays(5,0,4);x.bindVAO()}}};w._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier};w._reloadResources=function(){this._resourcesTask&&this._resourcesTask.abort();const l=E.isSome(this._magnifier)?this._magnifier.mask:null,x=E.isSome(this._magnifier)?this._magnifier.overlay:null;this._resourcesTask=D.createTask(async y=>{const B=E.isNone(l)||E.isNone(x)?t.loadMagnifierResources(y):null,F=E.isSome(l)?A(l,{responseType:"image",
signal:y}).then(K=>K.data):B.then(K=>K.mask);y=E.isSome(x)?A(x,{responseType:"image",signal:y}).then(K=>K.data):B.then(K=>K.overlay);const [G,J]=await D.all([F,y]);this.mask=G;this.overlay=J;this._disposeRenderResources();this.requestRender()})};w._disposeRenderResources=function(){this._readbackTexture=E.disposeMaybe(this._readbackTexture);this._overlayTexture=E.disposeMaybe(this._overlayTexture);this._maskTexture=E.disposeMaybe(this._maskTexture);this._vertexArrayObject=E.disposeMaybe(this._vertexArrayObject);
this._program=E.disposeMaybe(this._program)};w._updateResources=function(l){l.pixelRatio!==this._resourcePixelRatio&&this._disposeRenderResources();if(!this._readbackTexture){var x=l.context;this._resourcePixelRatio=l.pixelRatio;l=Math.ceil(this._magnifier.size*l.pixelRatio);this._program=v.createMagnifierProgram(x);var y=new Uint16Array([0,1,0,0,1,1,1,0]);this._vertexArrayObject=new e(x,v.magnifierProgramTemplate.attributes,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,
divisor:0}]},{geometry:d.createVertex(x,35044,y)});this.overlay.width=l;this.overlay.height=l;this._overlayTexture=new a(x,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay);this.mask.width=l;this.mask.height=l;this._maskTexture=new a(x,{target:3553,pixelFormat:6406,internalFormat:6406,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask);y=1/this._magnifier.factor;this._readbackTexture=new a(x,{target:3553,pixelFormat:6408,
internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:Math.ceil(y*l),height:Math.ceil(y*l)})}};z._createClass(r,[{key:"background",get:function(){return this._background},set:function(l){this._background=l;this.requestRender()}},{key:"magnifier",get:function(){return this._magnifier},set:function(l){this._magnifier=l;this._handles.removeAll();this._handles.add([c.init(l,"version",()=>{this.visible=l.visible&&E.isSome(l.position)&&0<l.size;this.requestRender()}),l.watch(["mask",
"overlay"],()=>this._reloadResources()),l.watch("size",()=>{this._disposeRenderResources();this.requestRender()})])}}]);return r}(u.DisplayObject)})},"esri/views/magnifier/resources":function(){define(["require","exports","../../core/promiseUtils","../../support/requestImageUtils"],function(z,E,D,C){E.loadMagnifierResources=async function(A){var m=new Promise(function(b,d){z(["./mask-svg"],function(a){b(Object.freeze({__proto__:null,"default":a}))},d)}),c=new Promise(function(b,d){z(["./overlay-svg"],
function(a){b(Object.freeze({__proto__:null,"default":a}))},d)});m=C.requestImage((await m).default,{signal:A});c=C.requestImage((await c).default,{signal:A});c={mask:await m,overlay:await c};D.throwIfAborted(A);return c};Object.defineProperty(E,"__esModule",{value:!0})})},"esri/support/requestImageUtils":function(){define(["exports","../request"],function(z,E){z.requestImage=async function(D,C){({data:D}=await E(D,{responseType:"image",...C}));return D};Object.defineProperty(z,"__esModule",{value:!0})})},
"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define("exports ../../../../webgl/Program ../../../../webgl/BufferObject ../../../../webgl/Texture ../../../../webgl/VertexArrayObject ../../../../webgl/Renderbuffer ../../../../webgl/FramebufferObject ../../../../webgl/programUtils ../../../../webgl/ProgramCache ../../../../webgl/RenderingContext ../../../../webgl/ShaderCompiler ./sources/resolver".split(" "),function(z,E,D,C,A,m,c,b,d,a,e,f){const g={name:"magnifier",shaders:{vertexShader:f.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:f.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};z.createMagnifierProgram=function(q){return b.createProgram(q,g)};z.magnifierProgramTemplate=g;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["exports","../../../chunks/mat4"],function(z,E){z.mat4=E.mat4;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["exports","../../../chunks/mat4f32"],function(z,
E){z.mat4f32=E.mat4f32;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["exports","../../../chunks/vec3f32"],function(z,E){z.vec3f32=E.vec3f32;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/chunks/vec3f32":function(){define(["exports"],function(z){function E(){return new Float32Array(3)}function D(u){const t=new Float32Array(3);t[0]=u[0];t[1]=u[1];t[2]=u[2];return t}function C(u,t,k){const v=new Float32Array(3);v[0]=u;v[1]=t;v[2]=
k;return v}function A(u,t){return new Float32Array(u,t,3)}function m(){return E()}function c(){return C(1,1,1)}function b(){return C(1,0,0)}function d(){return C(0,1,0)}function a(){return C(0,0,1)}const e=E(),f=c(),g=b(),q=d(),h=a();var n=Object.freeze({__proto__:null,create:E,clone:D,fromValues:C,createView:A,zeros:m,ones:c,unitX:b,unitY:d,unitZ:a,ZEROS:e,ONES:f,UNIT_X:g,UNIT_Y:q,UNIT_Z:h});z.ONES=f;z.UNIT_X=g;z.UNIT_Y=q;z.UNIT_Z=h;z.ZEROS=e;z.clone=D;z.create=E;z.createView=A;z.fromValues=C;z.ones=
c;z.unitX=b;z.unitY=d;z.unitZ=a;z.vec3f32=n;z.zeros=m})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["exports","../../../chunks/vec4f32"],function(z,E){z.vec4f32=E.vec4f32;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/Bitmap":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../chunks/mat3 ../../../chunks/mat3f32 ../../../chunks/vec2f32 ../../webgl/Program ../../webgl/BufferObject ../../webgl/Texture ../../webgl/VertexArrayObject ../../webgl/Renderbuffer ../../webgl/FramebufferObject ../../webgl/ProgramCache ../../webgl/RenderingContext ../../webgl/ShaderCompiler ./DisplayObject ./ImageryBitmapSource".split(" "),
function(z,E,D,C,A,m,c,b,d,a,e,f,g,q,h,n){function u(k){const v=document.createElement("canvas");v.width=k.width;v.height=k.height;k.render(v.getContext("2d"));return v}function t(k,v,p){const r={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};v&&p&&(r.width=v,r.height=p);return new b(k,r)}m=function(k){function v(r=null,w=!0){var l=k.call(this)||this;l.requestRenderOnSourceChangedEnabled=w;l._textureInvalidated=!0;l.stencilRef=0;l.coordScale=[1,1];l._height=void 0;
l.pixelRatio=1;l.resolution=0;l.rotation=0;l._source=null;l._width=void 0;l.x=0;l.y=0;l.transforms={dvs:C.create()};l.source=r;l.requestRender=l.requestRender.bind(E._assertThisInitialized(l));return l}E._inheritsLoose(v,k);var p=v.prototype;p.destroy=function(){this._texture&&(this._texture.dispose(),this._texture=null)};p.beforeRender=function(r){k.prototype.beforeRender.call(this,r);this.updateTexture(r)};p.invalidateTexture=function(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&
this.requestRender())};p.setTransform=function(r){const w=D.identity(this.transforms.dvs),[l,x]=r.toScreenNoRotation([0,0],this.x,this.y);var y=this.resolution/this.pixelRatio/r.resolution;const B=y*this.width;y*=this.height;const F=Math.PI*this.rotation/180;D.translate(w,w,A.fromValues(l,x));D.translate(w,w,A.fromValues(B/2,y/2));D.rotate(w,w,-F);D.translate(w,w,A.fromValues(-B/2,-y/2));D.scaleByVec2(w,w,A.fromValues(B,y));D.multiply(this.transforms.dvs,r.displayViewMat3,w)};p.setSamplingProfile=
function(r){this._texture&&(r.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(r.samplingMode))};p.bind=function({context:r},w){this._texture&&r.bindTexture(this._texture,w)};p.updateTexture=function({context:r}){if(this.stage)this._textureInvalidated&&(this._textureInvalidated=!1,this._texture||(this._texture=this.source?t(r,this.sourceWidth,this.sourceHeight):t(r)),(r=this.source)?(this._texture.resize(this.sourceWidth,this.sourceHeight),r&&
"render"in r?r instanceof n?(r=r.getRenderedRasterPixels(),this._texture.setData(r.renderedRasterPixels)):this._texture.setData(u(r)):!r||"render"in r||this._texture.setData(r),this.ready()):this._texture.setData(null));else{var w;null==(w=this._texture)?void 0:w.dispose();this._texture=null}};p.onAttach=function(){this.invalidateTexture()};p.onDetach=function(){this.invalidateTexture()};E._createClass(v,[{key:"isSourceScaled",get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}},
{key:"height",get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(r){this._height=r}},{key:"source",get:function(){return this._source},set:function(r){this._source=r;this.invalidateTexture()}},{key:"sourceHeight",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}},{key:"sourceWidth",get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}},{key:"width",
get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(r){this._width=r}}]);return v}(h.DisplayObject);z.Bitmap=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["../../../chunks/_rollupPluginBabelHelpers"],function(z){return function(){function E(C,A,m){this.pixelBlock=C;this.extent=A;this.originalPixelBlock=m}var D=E.prototype;D.render=function(C){var A=this.pixelBlock;if(A){var m=this.filter({pixelBlock:A});
A=m.pixelBlock.getAsRGBA();m=C.createImageData(m.pixelBlock.width,m.pixelBlock.height);m.data.set(A);C.putImageData(m,0,0)}};D.getRenderedRasterPixels=function(){const C=this.filter({pixelBlock:this.pixelBlock});return{width:C.pixelBlock.width,height:C.pixelBlock.height,renderedRasterPixels:new Uint8Array(C.pixelBlock.getAsRGBA().buffer)}};z._createClass(E,[{key:"width",get:function(){return this.pixelBlock?this.pixelBlock.width:0}},{key:"height",get:function(){return this.pixelBlock?this.pixelBlock.height:
0}}]);return E}()})},"esri/views/2d/engine/BitmapContainer":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./webgl/enums","./brushes","./webgl/WGLContainer"],function(z,E,D,C,A){A=function(m){function c(){return m.apply(this,arguments)||this}E._inheritsLoose(c,m);c.prototype.prepareRenderPasses=function(b){const d=b.registerRenderPass({name:"bitmap",brushes:[C.brushes.bitmap],target:()=>this.children,drawPhase:D.WGLDrawPhase.MAP});return[...m.prototype.prepareRenderPasses.call(this,
b),d]};return c}(A);z.BitmapContainer=A;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTile":function(){define(["exports","../../../chunks/_rollupPluginBabelHelpers","./webgl/TiledDisplayObject","./Bitmap"],function(z,E,D,C){D=function(A){function m(b,d,a,e=null){var f=A.call(this,b,d,a,a)||this;f.bitmap=new C.Bitmap(e);f.bitmap.coordScale=a;f.bitmap.once("isReady",()=>f.ready());return f}E._inheritsLoose(m,A);var c=m.prototype;c.destroy=function(){A.prototype.destroy.call(this);
this.bitmap.destroy()};c.beforeRender=function(b){A.prototype.beforeRender.call(this,b);this.bitmap.beforeRender(b)};c.afterRender=function(b){A.prototype.afterRender.call(this,b);this.bitmap.afterRender(b)};c.setTransform=function(b,d){A.prototype.setTransform.call(this,b,d);this.bitmap.transforms.dvs=this.transforms.dvs};c.onAttach=function(){this.bitmap.stage=this.stage};c.onDetach=function(){this.bitmap.stage=null};E._createClass(m,[{key:"stencilRef",set:function(b){this.bitmap.stencilRef=b},
get:function(){return this.bitmap.stencilRef}}]);return m}(D.TiledDisplayObject);z.BitmapTile=D;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/BitmapTileContainer":function(){define("exports ../../../chunks/_rollupPluginBabelHelpers ../../../geometry/support/aaBoundingRect ./webgl/enums ./brushes ./webgl/TileContainer ./BitmapTile".split(" "),function(z,E,D,C,A,m,c){m=function(b){function d(){return b.apply(this,arguments)||this}E._inheritsLoose(d,b);var a=d.prototype;a.createTile=
function(e){const f=this._tileInfoView.getTileBounds(D.create(),e);return new c.BitmapTile(e,f,this._tileInfoView.tileInfo.size)};a.destroyTile=function(){};a.prepareRenderPasses=function(e){const f=e.registerRenderPass({name:"bitmap (tile)",brushes:[A.brushes.bitmap],target:()=>this.children.map(g=>g.bitmap),drawPhase:C.WGLDrawPhase.MAP});return[...b.prototype.prepareRenderPasses.call(this,e),f]};a.doRender=function(e){this.visible&&e.drawPhase===C.WGLDrawPhase.MAP&&b.prototype.doRender.call(this,
e)};return d}(m["default"]);z.BitmapTileContainer=m;Object.defineProperty(z,"__esModule",{value:!0})})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["exports","../definitions"],function(z,E){let D=function(){function C(m,c=2){this._bucketSize=m;this._rowsLength=E.TILE_SIZE/m;this._colsLength=E.TILE_SIZE/m;this._elementsPerBucket=c;this._grid=this._initGrid()}var A=C.prototype;A.checkOverlap=function(m,c){m=Math.floor(m/this._bucketSize);c=Math.floor(c/this._bucketSize);
return 0>m||m>=this._rowsLength||0>c||c>=this._colsLength?!0:this._grid[c*this._colsLength+m]>=this._elementsPerBucket};A.markUsed=function(m,c){this._grid[Math.floor(c/this._bucketSize)*this._colsLength+Math.floor(m/this._bucketSize)]+=1};A.reset=function(){this._grid=this._initGrid()};A._initGrid=function(){return new Uint8Array(this._rowsLength*this._colsLength)};return C}();z.CollisionGrid=D;Object.defineProperty(z,"__esModule",{value:!0})})},"*noref":1}});
define("exports ./LabelManager ./engine/Stage ./layers/graphics/GraphicsView2D ./navigation/MapViewNavigation ./magnifier/MagnifierView2D".split(" "),function(z,E,D,C,A,m){z.LabelManager=E;z.Stage=D.Stage;z.GraphicsView2D=C;z.MapViewNavigation=A;z.MagnifierView2D=m;Object.defineProperty(z,"__esModule",{value:!0})});