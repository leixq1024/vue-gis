// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("../../../chunks/_rollupPluginBabelHelpers ../../../chunks/tslib.es6 ../../../core/has ../../../core/Logger ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/decorators/property ../../../core/jsonMap ../../../core/accessorSupport/decorators/subclass ../../../core/urlUtils ../../../core/uuid ../../../portal/support/resourceExtension ../../../core/promiseUtils ../../../core/watchUtils ../../layers/RefreshableLayerView ../../../layers/support/ExportImageParameters ../../layers/LayerView ../../support/drapedUtils ../../layers/MapImageLayerView ../engine/BitmapContainer ./LayerView2D ./support/ExportStrategy".split(" "),
function(n,f,d,p,E,k,F,q,G,H,I,r,t,u,v,w,x,y,z,A,B){const C=p.getLogger("esri.views.2d.layers.MapImageLayerView2D");d=function(l){function g(){var b=l.apply(this,arguments)||this;b._exportImageVersion=-1;return b}n._inheritsLoose(g,l);var a=g.prototype;a.hitTest=function(){return null};a.update=function(b){this.strategy.update(b).catch(c=>{r.isAbortError(c)||C.error(c)})};a.attach=function(){const {imageMaxWidth:b,imageMaxHeight:c,version:e}=this.layer,h=10.3<=e,D=10<=e;this._bitmapContainer=new z.BitmapContainer;
this.container.addChild(this._bitmapContainer);this.strategy=new B({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:b,imageMaxHeight:c,imageRotationSupported:h,imageNormalizationSupported:D,hidpi:!0});this.imageParameters=new v.ExportImageParameters({view:this.view,layer:this.layer});this.handles.add(t.init(this.imageParameters,"version",m=>{this._exportImageVersion!==m&&(this._exportImageVersion=m,this.requestUpdate())}),
"mapimagelayerview-update")};a.detach=function(){this.strategy.destroy();this.handles.remove("mapimagelayerview-update");this.imageParameters.destroy();this.imageParameters=null;this._exportImageVersion=-1;this.container.removeChild(this._bitmapContainer);this._bitmapContainer.removeAllChildren()};a.moveStart=function(){};a.viewChange=function(){};a.moveEnd=function(){this.requestUpdate()};a.createFetchPopupFeaturesQueryGeometry=function(b,c){return x.createQueryGeometry(b,c,this.view)};a.doRefresh=
async function(){this.requestUpdate()};a.isUpdating=function(){return this.strategy.updating||this.updateRequested};a.fetchImage=function(b,c,e,h){return this.layer.fetchImage(b,c,e,{timeExtent:this.imageParameters.timeExtent,timestamp:this.refreshTimestamp,...h})};return g}(y.MapImageLayerView(u.RefreshableLayerView(A.LayerView2DMixin(w))));f.__decorate([k.property()],d.prototype,"strategy",void 0);f.__decorate([k.property({dependsOn:["strategy.updating"]})],d.prototype,"updating",void 0);return d=
f.__decorate([q.subclass("esri.views.2d.layers.MapImageLayerView2D")],d)});