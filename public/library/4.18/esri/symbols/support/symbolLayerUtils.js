// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.18/esri/copyright.txt for details.
//>>built
define("require exports ../../core/maybe ../../core/Error ../../core/promiseUtils ../../request ../../core/ItemCache ../../geometry/support/aaBoundingBox ./symbolLayerUtils3D".split(" "),function(q,d,l,e,f,r,m,n,p){async function g(a,b){if(a.resource.href)return t(a.resource.href).then(c=>[c.width,c.height]);if(a.resource.primitive)return l.isSome(b)?[b,b]:[256,256];throw new e("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource");}function u(a,
b){return g(a,b).then(c=>{if(null==a.size)return c;c=c[0]/c[1];return 1<c?[a.size,a.size/c]:[a.size*c,a.size]})}function t(a){return r(a,{responseType:"image"}).then(b=>b.data)}function h(a,b){return v(a,b).then(c=>n.size(c))}async function w(a,b){b=await h(a,b);return p.objectSymbolLayerSizeWithResourceSize(b,a)}async function v(a,b){if(!a.isPrimitive){b=a.resource.href;var c=k.get(b);if(void 0!==c)return f.resolve(c);c=await (await new Promise(function(x,y){q(["../../views/3d/layers/graphics/objectResourceUtils"],
x,y)})).fetch(b,{disableTextures:!0});k.put(b,c.referenceBoundingBox);return c.referenceBoundingBox}c=null;if(a.resource&&a.resource.primitive&&(c=n.create(p.objectSymbolLayerPrimitiveBoundingBox(a.resource.primitive)),l.isSome(b)))for(a=0;a<c.length;a++)c[a]*=b;return c?f.resolve(c):f.reject(new e("symbol:invalid-resource","The symbol does not have a valid resource"))}let k=new m(50);d.clearBoundingBoxCache=function(){k=new m(50)};d.computeIconLayerResourceSize=g;d.computeLayerResourceSize=function(a,
b){if("icon"===a.type)return g(a,b);if("object"===a.type)return h(a,b);throw new e("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");};d.computeLayerSize=async function(a,b){if("icon"===a.type)return u(a,b);if("object"===a.type)return w(a,b);throw new e("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object");};d.computeObjectLayerResourceSize=h;Object.defineProperty(d,"__esModule",{value:!0})});