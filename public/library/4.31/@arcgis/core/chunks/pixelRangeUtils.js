/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const t={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function n(n){return t[n]??[-34028234663852886e22,34028234663852886e22]}function e(t,n){return null==t||null==n?"s32":t<0?t>=-128&&n<128?"s8":t>=-32768&&n<32768?"s16":"s32":n<256?"u8":n<65536?"u16":"u32"}function s(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function u(t,e,u,o){let[i,l]=n(u);const a=s(u);return a&&(i-=1e-5,l+=1e-5),a?u.startsWith("u")?function(t,n,e,s){const[u,o]=s;for(let s=0;s<n.length;s++)if(n[s]){const i=t[s];i<u||i>o?n[s]=0:e[s]=i+.5|0}}(t,e,o,[i,l]):function(t,n,e,s){const[u,o]=s;for(let s=0;s<n.length;s++)if(n[s]){const i=t[s];i<u||i>o?n[s]=0:e[s]=i+(i>0?.5:-.5)|0}}(t,e,o,[i,l]):function(t,n,e,s){const[u,o]=s;for(let s=0;s<n.length;s++)if(n[s]){const i=t[s];i<u||i>o?n[s]=0:e[s]=i}}(t,e,o,[i,l])}function o(t,n){for(let e=0;e<n.length;e++)n[e]&&isNaN(t[e])&&(n[e]=0,t[e]=0)}function i(t,e,s){if(t.depthCount&&t.depthCount>1)return;const{pixels:u,statistics:o,pixelType:i}=t,l=u[0].length,a=t.bandMasks??[],c=t.mask??new Uint8Array(l).fill(255),f="f32"===i||"f64"===i,r=n(i);let h=!1;for(let t=0;t<u.length;t++){const n="number"==typeof e?e:e[t];if(null==n)continue;const l=o?.[t]?.minValue??r[0],b=o?.[t]?.maxValue??r[1];if(l>n+Number.EPSILON||b<n-Number.EPSILON)continue;const m=a[t]||c.slice(),d=u[t],g=s?.customFloatTolerance;if(f&&0!==g){let t=g;t||(t=Math.abs(n)>=9999999e31?2e-7*Math.abs(n):"f32"===i?2**-23:Number.EPSILON);for(let e=0;e<d.length;e++)m[e]&&Math.abs(d[e]-n)<t&&(d[e]=0,m[e]=0,c[e]=0,h=!0)}else for(let t=0;t<d.length;t++)m[t]&&d[t]===n&&(d[t]=0,m[t]=0,c[t]=0,h=!0);a[t]=m}h&&(t.bandMasks=t.bandMasks||t.pixels.length>1?a:null,t.mask=c),h&&"updateStatistics"in t&&t.updateStatistics()}export{e as a,u as b,i as c,o as f,n as g,s as i};
