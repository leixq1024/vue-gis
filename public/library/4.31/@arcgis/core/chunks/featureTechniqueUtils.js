/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{g as t}from"./unitUtils.js";import{m as e,a as i}from"./definitions.js";import{f as n,g as s}from"./enums.js";var o,a,E,T,l,r,L,c,I;!function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"}(o||(o={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(a||(a={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(E||(E={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(T||(T={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(l||(l={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"}(r||(r={})),function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"}(L||(L={})),function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(c||(c={})),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"}(I||(I={}));const A={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:n.EQUAL,mask:255,op:{fail:s.KEEP,zFail:s.KEEP,zPass:s.REPLACE}}}},f={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},R={...A,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function u({pixelRatio:e,state:i,displayLevel:n,requiredLevel:s},o){const a=1/2**(n-o.key.level),E=1/2**(s-o.key.level);return{displayMat3:i.displayMat3,displayViewMat3:i.displayViewMat3,displayViewScreenMat3:o.transforms.displayViewScreenMat3,viewMat3:i.viewMat3,tileMat3:o.transforms.tileMat3,displayZoomFactor:a,requiredZoomFactor:E,tileOffset:[o.x,o.y],currentScale:i.scale,currentZoom:n,metersPerSRUnit:t(i.spatialReference),rotation:i.rotation,pixelRatio:e}}function S(t){return"highlight"===t.passOptions?.type}function O(t){return"hittest"===t.passOptions?.type}function _(t){if(!O(t))return null;const{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:s}}function p(t){if(!S(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function M(t,e,i){const n={};for(const s in i)i[s]instanceof Function?n[s]=i[s](t,e):n[s]=i[s];return n}function d(t,e){const{attributeView:i,context:n}=t;return{storage:i.getUniforms(n),view:u(t,e),hittestRequest:_(t),highlight:p(t)}}function N(t){return{inside:t.selection===L.InsideEffect,outside:t.selection===L.OutsideEffect}}function m(t){return O(t)?f:S(t)&&"clear"===t.passOptions.stepType?R:A}function h(t){const{row:n,col:s}=t.key,o=s*i,a=n*i;return{tileOffsetFromLocalOrigin:[o%e,a%e],maxIntsToLocalOrigin:[Math.floor(o/e),Math.floor(a/e)]}}export{L as F,l as M,E as V,a as W,c as a,I as b,d as c,N as d,S as e,u as f,m as g,h,O as i,M as r};
