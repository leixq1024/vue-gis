/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import{geometryTypes as e}from"../geometry.js";import{ClonableMixin as r}from"../core/Clonable.js";import{J as i,s as o}from"./jsonMap.js";import{JSONSupport as s}from"../core/JSONSupport.js";import{L as n}from"./Logger.js";import{property as a}from"../core/accessorSupport/decorators/property.js";import{e as l}from"./ensureType.js";import"../core/lang.js";import{e as p}from"./enumeration.js";import{subclass as u}from"../core/accessorSupport/decorators/subclass.js";import{fromJSON as d}from"../geometry/support/jsonUtils.js";import{u as y}from"./queryUtils.js";import{s as m}from"../config.js";import{Q as c}from"../rest/support/Query.js";import{s as f}from"./spatialRelationships.js";import h from"../rest/support/StatisticDefinition.js";import{n as v}from"./date.js";import w from"../geometry/SpatialReference.js";let j=class extends(r(s)){constructor(t){super(t),this.alias=null,this.expression=null,this.field=null,this.responseType=null}};t([a({type:String,json:{write:!0}})],j.prototype,"alias",void 0),t([a({type:String,json:{write:!0}})],j.prototype,"expression",void 0),t([a({type:String,json:{write:!0}})],j.prototype,"field",void 0),t([a({type:String,json:{write:!0}})],j.prototype,"responseType",void 0),j=t([u("esri.rest.support.BinParametersAttributes")],j);const g=j;j.from=l(j);const B=new i({naturalLog:"natural-log",squareRoot:"square-root"});let b=class extends(r(s)){constructor(t){super(t),this.expression=null,this.field=null,this.firstDayOfWeek=null,this.hideUpperBound=null,this.splitByAttributes=null,this.stackByAttributes=null,this.transformation=null}};t([a({type:String,json:{write:!0}})],b.prototype,"expression",void 0),t([a({type:String,json:{name:"onField",write:!0}})],b.prototype,"field",void 0),t([a({type:String,json:{write:!0}})],b.prototype,"firstDayOfWeek",void 0),t([a({type:String,json:{write:!0}})],b.prototype,"hideUpperBound",void 0),t([a({type:g,json:{write:{target:{splitBy:{type:String},splitByField:{type:String},splitByAlias:{type:String}},writer:(t,e)=>{null!=t.field&&(e.splitByField=t.field),null!=t.expression&&(e.splitBy=t.expression),null!=t.alias&&(e.splitByAlias=t.alias)}},read:{source:["splitBy","splitByField","splitByAlias"],reader:(t,e)=>new g({field:e.splitByField,expression:e.splitBy,alias:e.splitByAlias})}}})],b.prototype,"splitByAttributes",void 0),t([a({type:g,json:{write:{target:{stackBy:{type:String},stackByField:{type:String},stackByAlias:{type:String},jsonStyle:{type:String}},writer:(t,e)=>{null!=t.field&&(e.stackByField=t.field),null!=t.expression&&(e.stackBy=t.expression),null!=t.alias&&(e.stackByAlias=t.alias),null!=t.responseType&&(e.jsonStyle=t.responseType)},overridePolicy(){return{enabled:null!=this.stackByAttributes?.field||null!=this.stackByAttributes?.expression}}},read:{source:["stackBy","stackByField","stackByAlias","jsonStyle"],reader:(t,e)=>new g({field:e.stackByField,expression:e.stackBy,alias:e.stackByAlias,responseType:e.jsonStyle})}}})],b.prototype,"stackByAttributes",void 0),t([p(B)],b.prototype,"transformation",void 0),b=t([u("esri.rest.support.BinParametersBase")],b);const S=b,x=o()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),T="percent-of-total",z="field",A=e=>{let r=class extends e{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,r=null!=this.normalizationTotal;return e||r?(t=e&&z||r&&T||null,e&&r&&n.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==z&&t!==T||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}};return t([a({type:String,json:{name:"parameters.normalizationField",write:!0}})],r.prototype,"normalizationField",void 0),t([a({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],r.prototype,"normalizationMaxValue",void 0),t([a({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],r.prototype,"normalizationMinValue",void 0),t([a({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],r.prototype,"normalizationTotal",void 0),t([p(x,{name:"parameters.normalizationType"})],r.prototype,"normalizationType",null),r=t([u("esri.rest.support.NormalizationBinParametersMixin")],r),r};function k(t,e,r){m(r,t instanceof Date?t.getTime():t,e)}let F=class extends(A(S)){constructor(t){super(t),this.bins=null,this.end=null,this.start=null,this.type="auto-interval"}};t([a({type:Number,json:{name:"parameters.numberOfBins",write:!0}})],F.prototype,"bins",void 0),t([a({json:{name:"parameters.end",write:{writer:k}}})],F.prototype,"end",void 0),t([a({json:{name:"parameters.start",write:{writer:k}}})],F.prototype,"start",void 0),t([p({autoIntervalBin:"auto-interval"},{readOnly:!0})],F.prototype,"type",void 0),F=t([u("esri.rest.support.AutoIntervalBinParameters")],F);const P=F;F.from=l(F);const D=o()({year:"years",quarter:"quarters",month:"months",week:"weeks",day:"days",hour:"hours",minute:"minutes",second:"seconds"});let R=class extends(r(s)){constructor(t){super(t),this.value=null,this.units=null}};t([a({type:Number,json:{name:"number",write:!0}})],R.prototype,"value",void 0),t([p(D,{name:"unit"})],R.prototype,"units",void 0),R=t([u("esri.rest.support.DateBinTimeInterval")],R);const O=R;function M(t,e,r){m(r,"string"==typeof t?t:t?.getTime(),e)}function N(t,e){const r=t.parameters[e];return r?"string"==typeof r?r:new Date(r):null}R.from=l(R);let q=class extends S{constructor(t){super(t),this.end=null,this.interval=null,this.offset=null,this.start=null,this.type="date"}};t([a({cast:t=>t?"string"==typeof t?t:new Date(t):null,json:{name:"parameters.end",read:{reader:(t,e)=>N(e,"end")},write:{writer:M}}})],q.prototype,"end",void 0),t([a({type:O,json:{name:"parameters",write:!0}})],q.prototype,"interval",void 0),t([a({type:O,json:{name:"parameters.offset",write:!0}})],q.prototype,"offset",void 0),t([a({cast:t=>t?"string"==typeof t?t:new Date(t):null,json:{name:"parameters.start",read:{reader:(t,e)=>N(e,"start")},write:{writer:M}}})],q.prototype,"start",void 0),t([p({dateBin:"date"},{readOnly:!0})],q.prototype,"type",void 0),q=t([u("esri.rest.support.DateBinParameters")],q);const V=q;q.from=l(q);let _=class extends S{constructor(t){super(t),this.boundaries=null,this.type="fixed-boundaries"}};t([a({json:{name:"parameters.boundaries",write:{writer:function(t,e,r){m(r,t&&t[0]instanceof Date?t.map((t=>t.getTime())):t,e)}}}})],_.prototype,"boundaries",void 0),t([p({fixedBoundariesBin:"fixed-boundaries"},{readOnly:!0})],_.prototype,"type",void 0),_=t([u("esri.rest.support.FixedBoundariesBinParameters")],_);const I=_;function L(t,e,r){m(r,t instanceof Date?t.getTime():t,e)}_.from=l(_);let Z=class extends(A(S)){constructor(t){super(t),this.end=null,this.interval=null,this.start=null,this.type="fixed-interval"}};t([a({json:{name:"parameters.end",write:{writer:L}}})],Z.prototype,"end",void 0),t([a({type:Number,json:{name:"parameters.interval",write:!0}})],Z.prototype,"interval",void 0),t([a({json:{name:"parameters.start",write:{writer:L}}})],Z.prototype,"start",void 0),t([p({fixedIntervalBin:"fixed-interval"},{readOnly:!0})],Z.prototype,"type",void 0),Z=t([u("esri.rest.support.FixedIntervalBinParameters")],Z);const U=Z;Z.from=l(Z);const Q=new i({asc:"ascending",desc:"descending"}),H={base:S,key:"type",typeMap:{"auto-interval":P,date:V,"fixed-boundaries":I,"fixed-interval":U}};let J=class extends(r(s)){constructor(t){super(t),this.binParameters=null,this.binOrder="ascending",this.cacheHint=void 0,this.datumTransformation=null,this.defaultSpatialReference=null,this.distance=void 0,this.geometry=null,this.lowerBoundaryAlias=null,this.outSpatialReference=null,this.outStatistics=null,this.quantizationParameters=null,this.returnDistinctValues=null,this.spatialRelationship="intersects",this.upperBoundaryAlias=null,this.units=null,this.where="1=1"}set outTimeZone(t){this._set("outTimeZone",t),t&&!v(t)&&n.getLogger(this).warn("#outTimeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}};t([a({types:H,json:{name:"bin",write:!0}})],J.prototype,"binParameters",void 0),t([p(Q)],J.prototype,"binOrder",void 0),t([a({type:Boolean,json:{write:!0}})],J.prototype,"cacheHint",void 0),t([a({json:{write:!0}})],J.prototype,"datumTransformation",void 0),t([a({type:w,json:{name:"defaultSR",write:!0}})],J.prototype,"defaultSpatialReference",void 0),t([a({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],J.prototype,"distance",void 0),t([a({types:e,json:{read:d,write:!0}})],J.prototype,"geometry",void 0),t([a({type:String,json:{write:!0}})],J.prototype,"lowerBoundaryAlias",void 0),t([a({type:w,json:{name:"outSR",write:!0}})],J.prototype,"outSpatialReference",void 0),t([a({type:[h],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&this.outStatistics.length>0}}}}})],J.prototype,"outStatistics",void 0),t([a({value:null,json:{name:"outTimeReference",read:{reader:t=>t.ianaTimeZone},write:{writer:(t,e,r)=>{t&&(e[r]={ianaTimeZone:t})}}}})],J.prototype,"outTimeZone",null),t([a({type:c,json:{write:!0}})],J.prototype,"quantizationParameters",void 0),t([a({type:Boolean,json:{write:!0}})],J.prototype,"returnDistinctValues",void 0),t([p(f,{name:"spatialRel"})],J.prototype,"spatialRelationship",void 0),t([a({type:String,json:{write:!0}})],J.prototype,"upperBoundaryAlias",void 0),t([a({type:String,json:{read:y.read,write:{writer:y.write,overridePolicy(t){return{enabled:null!=t&&null!=this.distance&&this.distance>0}}}}})],J.prototype,"units",void 0),t([a({type:String,json:{write:!0}})],J.prototype,"where",void 0),J=t([u("esri.rest.support.BinsQuery")],J);const W=J;J.from=l(J);const C=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{P as A,W as B,V as D,U as F,I as a,C as b};
