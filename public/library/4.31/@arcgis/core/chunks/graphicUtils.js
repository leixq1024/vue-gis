/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{g as e}from"./unitUtils.js";import{r as t,d as n,h as r}from"./mat4.js";import{c as s}from"./mat4f64.js";import{e as i,O as o}from"./vec3f64.js";import{s as a}from"./vec4.js";import{a as l,O as u}from"./vec4f64.js";import{projectPoint as m}from"../geometry/projection.js";import{w as c,m as f,o as p}from"./aaBoundingBox.js";import{c as h}from"./aaBoundingRect.js";import{r as x}from"../geometry/Polygon.js";import{e as y,d}from"./coordsUtils.js";import{v as g}from"./meshVertexSpaceUtils.js";import{m as j}from"./dehydratedPoint.js";import{i as v,c as z}from"./hydratedFeatures.js";function w(e,t){if("point"===e.type)return R(e,t,!1);if(v(e))switch(e.type){case"extent":return R(e.center,t,!1);case"polygon":return R(e.centroid,t,!1);case"polyline":return R(M(e),t,!0);case"mesh":return R(g(e.vertexSpace,e.spatialReference)??e.extent.center,t,!1);case"multipoint":return}else switch(e.type){case"extent":return R(function(e){return j(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),null!=e.zmin&&null!=e.zmax&&isFinite(e.zmin)&&isFinite(e.zmax)?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return R(function(e){const t=e.rings[0];if(!t||0===t.length)return null;const n=x(e.rings,!!e.hasZ);return j(n[0],n[1],n[2],e.spatialReference)}(e),t,!0);case"polyline":return R(M(e),t,!0);case"multipoint":return}}function M(e){const t=e.paths[0];if(!t||0===t.length)return null;const n=y(t,d(t)/2);return j(n[0],n[1],n[2],e.spatialReference)}function R(e,t,n){const r=n?e:z(e);return t&&e?m(e,r,t)?r:null:r}function P(e){if(!e)return 0;switch(e.type){case"point":return e.z;case"extent":return e.zmax;case"polygon":return e.hasZ?e.rings.reduce(((e,t)=>t.reduce(((e,t)=>Math.max(e,t[2])),e)),-1/0):void 0;case"polyline":return e.hasZ?e.paths.reduce(((e,t)=>t.reduce(((e,t)=>Math.max(e,t[2])),e)),-1/0):void 0;case"mesh":return e.extent.zmax;case"multipoint":return}}function b(e,t,n,r=0){if(e){t||(t=h());const s=e;let i=.5*s.width*(n-1),o=.5*s.height*(n-1);return s.width<1e-7*s.height?i+=o/20:s.height<1e-7*s.width&&(o+=i/20),a(t,s.xmin-i-r,s.ymin-o-r,s.xmax+i+r,s.ymax+o+r),t}return null}function F(e,t,n=null){const r=l(u);return null!=e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),null!=t?r[3]=t:null!=e&&e.length>3&&(r[3]=e[3]),n&&(r[0]*=n,r[1]*=n,r[2]*=n,r[3]*=n),r}function A(e,t,n,r,s,i=[0,0,0,0]){for(let t=0;t<3;++t)i[t]=null!=e?.[t]?e[t]:null!=n?.[t]?n[t]:s[t];return i[3]=null!=t?t:null!=r?r:s[3],i}function B(e=o,t,n,r=1){const s=new Array(3);if(null==t||null==n)s[0]=1,s[1]=1,s[2]=1;else{let r,i=0;for(let o=2;o>=0;o--){const a=e[o];let l;const u=null!=a,m=0===o&&!r&&!u,c=n[o];"symbol-value"===a||m?l=0!==c?t[o]/c:1:u&&"proportional"!==a&&isFinite(a)&&(l=0!==c?a/c:1),null!=l&&(s[o]=l,r=l,i=Math.max(i,Math.abs(l)))}for(let e=2;e>=0;e--)null==s[e]?s[e]=r:0===s[e]&&(s[e]=.001*i)}for(let e=2;e>=0;e--)s[e]/=r;return i(s)}function D(e){return I(null!=e.isPrimitive?[e.width,e.depth,e.height]:e)?null:"Symbol sizes may not be negative values"}function I(e){const t=e=>null==e||e>=0;return Array.isArray(e)?e.every(t):t(e)}function S(e,i,o,a=s()){return e&&t(a,a,-e/180*Math.PI),i&&n(a,a,i/180*Math.PI),o&&r(a,a,o/180*Math.PI),a}function U(t,n,r){if(null!=r.minDemResolution)return r.minDemResolution;const s=e(n),i=c(t)*s,o=f(t)*s,a=p(t)*(n.isGeographic?1:s);return 0===i&&0===o&&0===a?r.minDemResolutionForPoints:.01*Math.max(i,o,a)}export{P as a,B as b,w as c,U as d,b as e,S as f,I as i,F as m,A as o,D as v};
