/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import"../core/lang.js";import"./Logger.js";import{b as t,a as n}from"./mathUtils.js";import{f as r}from"./mat4.js";import{h as s,f as o,c as e,s as i,m as a,a as c,g as u,o as f,q as m,n as l,r as g,l as h,k as p}from"./vec3.js";import{c as M}from"./vec3f64.js";import{c as d,a as j}from"./vec4.js";import{c as b,f as S}from"./vec4f64.js";import{g as q}from"./common.js";import{A as v}from"./Axis.js";import{f as y,g as A}from"./ray.js";import{b as x,r as P,t as R}from"./plane.js";function C(n,r){const e=s(n),i=t(n[2]/e),a=Math.atan2(n[1]/e,n[0]/e);return o(r,e,i,a),r}const _=w();function w(){return b()}const E=j,O=j;function T(t,n){return d(n,t)}function k(t,n){return S(t[0],t[1],t[2],n)}function L(t){return t}function N(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function Z(t){return t[3]}function z(t){return t}function F(t,n,r,s){return S(t,n,r,s)}function I(t,n,r){if(null==n)return!1;if(!X(t,n,V))return!1;let{t0:s,t1:o}=V;if((s<0||o<s&&o>0)&&(s=o),s<0)return!1;if(r){const{origin:t,direction:o}=n;r[0]=t[0]+o[0]*s,r[1]=t[1]+o[1]*s,r[2]=t[2]+o[2]*s}return!0}function U(t,n,r){const s=y(n,r);if(!X(t,s,V))return[];const{origin:o,direction:e}=s,{t0:i,t1:a}=V,c=n=>{const r=M();return p(r,o,e,n),H(t,r,r)};return Math.abs(i-a)<q()?[c(i)]:[c(i),c(a)]}const V={t0:0,t1:0};function X(t,n,r){const{origin:s,direction:o}=n,e=Y;e[0]=s[0]-t[0],e[1]=s[1]-t[1],e[2]=s[2]-t[2];const i=o[0]*o[0]+o[1]*o[1]+o[2]*o[2];if(0===i)return!1;const a=2*(o[0]*e[0]+o[1]*e[1]+o[2]*e[2]),c=a*a-4*i*(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);return r.t0=(-a-u)/(2*i),r.t1=(-a+u)/(2*i),!0}const Y=M();function B(t,n){return I(t,n,null)}function D(t,n,o){const c=x.get(),u=P.get();e(c,n.origin,n.direction);const f=Z(t);e(o,c,n.origin),i(o,o,1/s(o)*f);const m=K(t,n.origin),l=R(n.origin,o);return r(u,l+m,c),a(o,o,u),o}function G(t,n,r,s){const o=Z(t),e=o*o,i=n+.5*Math.PI,a=r*r+e-2*Math.cos(i)*r*o,c=Math.sqrt(a),u=a-e;if(u<=0)return.5;const f=Math.sqrt(u),m=Math.acos(f/c)-Math.asin(o/(c/Math.sin(i)));return Math.min(1,(m+.5*s)/s)}function H(t,n,r){const o=c(x.get(),n,t),e=i(x.get(),o,t[3]/s(o));return u(r,e,t)}function J(t,n){const r=c(x.get(),n,t),s=m(r),o=t[3]*t[3];return Math.sqrt(Math.abs(s-o))}function K(t,r){const o=c(x.get(),r,t),e=s(o),i=Z(t),a=i+Math.abs(i-e);return n(i/a)}const Q=M();function W(t,n,r,s){const e=c(Q,n,t);switch(r){case v.X:{const t=C(e,Q)[2];return o(s,-Math.sin(t),Math.cos(t),0)}case v.Y:{const t=C(e,Q),n=t[1],r=t[2],i=Math.sin(n);return o(s,-i*Math.cos(r),-i*Math.sin(r),Math.cos(n))}case v.Z:return l(s,e);default:return}}function $(t,n){const r=c(rt,n,t);return s(r)-t[3]}function tt(t,n){const r=g(t,n),s=Z(t);return r<=s*s}function nt(t,n,r=b()){const s=f(t,n),o=t[3],e=n[3];return s+e<o?(d(r,t),r):s+o<e?(d(r,n),r):(h(r,t,n,(s+e-o)/(2*s)),r[3]=(s+o+e)/2,r)}const rt=M(),st=w(),ot=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:_,altitudeAt:$,angleToSilhouette:K,axisAt:W,cameraFrustumCoverage:G,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,n,r){return I(t,n,r)?r:(A(n,t,r),H(t,r,r))},closestPointOnSilhouette:D,containsPoint:tt,copy:T,create:w,distanceToSilhouette:J,elevate:function(t,n,r){return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=t[3]+n,r},equals:O,exactEquals:E,fromCenterAndRadius:k,fromRadius:N,fromValues:F,getCenter:z,getExtent:function(t,n){return n},getRadius:Z,intersectLine:U,intersectRay:I,intersectRayClosestSilhouette:function(t,n,r){if(I(t,n,r))return r;const o=D(t,n,x.get());return u(r,n.origin,i(x.get(),n.direction,f(n.origin,o)/s(n.direction))),r},intersectsRay:B,projectPoint:H,setAltitudeAt:function(t,n,r,s){const o=$(t,n),e=W(t,n,v.Z,rt),a=i(rt,e,r-o);return u(s,n,a)},setExtent:function(t,n,r){return t!==r&&T(t,r),r},tmpSphere:st,union:nt,wrap:L},Symbol.toStringTag,{value:"Module"}));export{_ as N,Z as a,w as b,T as c,tt as d,U as e,F as f,z as g,k as h,B as i,E as j,I as k,N as l,G as m,D as n,J as o,H as p,ot as s,st as t,nt as u,L as w};
