/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{O as r}from"./ray.js";import{i as n,a as o,d as i,s as e,g as s,r as a,q as c}from"./vec3.js";import{a as g,c as u}from"./vec3f64.js";import{b as f}from"./plane.js";function v(t){return t?{origin:g(t.origin),vector:g(t.vector)}:{origin:u(),vector:u()}}function p(t,r){const n=x.get();return n.origin=t,n.vector=r,n}function m(t,r=v()){return b(t.origin,t.vector,r)}function b(t,r,o=v()){return n(o.origin,t),n(o.vector,r),o}function h(t,r,i=v()){return n(i.origin,t),o(i.vector,r,t),i}function M(r,n){const s=o(f.get(),n,r.origin),a=i(r.vector,s),c=i(r.vector,r.vector),g=t(a/c,0,1),u=o(f.get(),e(f.get(),r.vector,g),s);return i(u,u)}function d(t,r,n){return j(t,r,0,1,n)}function A(t,r,n){return s(n,t.origin,e(n,t.vector,r))}function j(r,n,a,g,u){const{vector:v,origin:p}=r,m=o(f.get(),n,p),b=i(v,m)/c(v);return e(u,v,t(b,a,g)),s(u,u,r.origin)}function l(t,r){if(w(t,p(r.origin,r.direction),!1,q)){const{tA:r,pB:n,distance2:o}=q;if(r>=0&&r<=1)return o;if(r<0)return a(t.origin,n);if(r>1)return a(s(f.get(),t.origin,t.vector),n)}return null}function B(t,r,o){return!!w(t,r,!0,q)&&(n(o,q.pA),!0)}function w(r,n,o,i){const e=1e-6,c=r.origin,g=s(f.get(),c,r.vector),u=n.origin,v=s(f.get(),u,n.vector),p=f.get(),m=f.get();if(p[0]=c[0]-u[0],p[1]=c[1]-u[1],p[2]=c[2]-u[2],m[0]=v[0]-u[0],m[1]=v[1]-u[1],m[2]=v[2]-u[2],Math.abs(m[0])<e&&Math.abs(m[1])<e&&Math.abs(m[2])<e)return!1;const b=f.get();if(b[0]=g[0]-c[0],b[1]=g[1]-c[1],b[2]=g[2]-c[2],Math.abs(b[0])<e&&Math.abs(b[1])<e&&Math.abs(b[2])<e)return!1;const h=p[0]*m[0]+p[1]*m[1]+p[2]*m[2],M=m[0]*b[0]+m[1]*b[1]+m[2]*b[2],d=p[0]*b[0]+p[1]*b[1]+p[2]*b[2],A=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],j=(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])*A-M*M;if(Math.abs(j)<e)return!1;let l=(h*M-d*A)/j,B=(h+M*l)/A;o&&(l=t(l,0,1),B=t(B,0,1));const w=f.get(),q=f.get();return w[0]=c[0]+l*b[0],w[1]=c[1]+l*b[1],w[2]=c[2]+l*b[2],q[0]=u[0]+B*m[0],q[1]=u[1]+B*m[1],q[2]=u[2]+B*m[2],i.tA=l,i.tB=B,i.pA=w,i.pB=q,i.distance2=a(w,q),!0}const q={tA:0,tB:0,pA:u(),pB:u(),distance2:0},x=new r((()=>v()));export{A as a,d as b,v as c,M as d,l as e,h as f,m as g,b as h,B as i,j as p,p as w};
