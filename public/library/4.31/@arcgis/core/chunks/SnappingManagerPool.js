/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{m as e}from"./handleUtils.js";import{n}from"../core/scheduling.js";import t from"../core/Collection.js";import{watch as r,syncAndInitial as i}from"../core/reactiveUtils.js";import o from"../views/interactive/snapping/FeatureSnappingLayerSource.js";import{d as s}from"./Settings2.js";import a from"../views/interactive/snapping/SnappingOptions.js";import{S as p}from"./SnappingManager.js";const c=new Map;function u(u){if(!c.has(u)){const e=function(e,n){const p=new a({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:n?.distance,touchSensitivityMultiplier:n?.touchSensitivityMultiplier??s.touchSensitivityMultiplier});return{...r((()=>e.map?.allLayers?.toArray()??[]),(e=>{p.featureSources=new t(e).map((e=>new o({layer:e})))}),i),options:p}}(u,{distance:10}),n=function(e,n){return new p({view:e,options:n})}(u,e.options);c.set(u,{referenceCount:0,snappingManager:n,remove:()=>{e.remove(),n.destroy()}})}const m=c.get(u);m.referenceCount++;const f=e((()=>function(e,t){t.referenceCount--,t.referenceCount>0||n((()=>{0===t.referenceCount&&(t.remove(),c.delete(e))}))}(u,m)));return{snappingManager:m.snappingManager,...f}}export{u as a};
