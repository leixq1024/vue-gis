/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import"../geometry.js";import e from"../Graphic.js";import"../symbols.js";import{m as t}from"./handleUtils.js";import{p as r}from"./screenUtils.js";import{a as i}from"./ensureType.js";import{s as o,j as a}from"./vec2.js";import{c as n}from"./vec2f64.js";import{c as l}from"./vec3f64.js";import{L as s,a as m}from"./enums2.js";import{a as c}from"./normalizedPoint.js";import{d as p}from"./Settings2.js";import{S as y}from"./SnappingVisualizer.js";import g from"../geometry/Point.js";import h from"../geometry/Polyline.js";import b from"../geometry/SpatialReference.js";import S from"../symbols/CIMSymbol.js";import f from"../symbols/SimpleMarkerSymbol.js";import u from"../symbols/SimpleLineSymbol.js";class d extends y{constructor(e){super(),this._graphicsLayer=e,this._symbolPairingsByType=new Map}visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator(new g({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("intersectionPoint",t.view.effectiveTheme.accentColor))}visualizePoint(e,t){return this._visualizeSnappingIndicator(new g({x:e.point[0],y:e.point[1],spatialReference:t.spatialReference}),this._getOrCreateSymbol("point",t.view.effectiveTheme.accentColor))}visualizeLine(e,t){return this._visualizeSnappingIndicator(new h({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:i(b,t.spatialReference)}),this._getOrCreateSymbol("line",t.view.effectiveTheme.accentColor))}visualizeParallelSign(e,t){return this._visualizeSnappingIndicator(new h({paths:[[[...e.lineStart],[...e.lineEnd]]],spatialReference:i(b,t.spatialReference)}),this._getOrCreateSymbol("parallelSign",t.view.effectiveTheme.accentColor))}visualizeRightAngleQuad(e,t){const r=n(),s=n(),m=l();o(r,c(e.centerVertex),c(e.previousVertex)),o(s,c(e.nextVertex),c(e.previousVertex)),a(m,r,s);const p="rightAngleQuad"+(m[2]<0?45:225);return this._visualizeSnappingIndicator(new h({paths:[[[...e.previousVertex],[...e.centerVertex],[...e.nextVertex]]],spatialReference:i(b,t.spatialReference)}),this._getOrCreateSymbol(p,t.view.effectiveTheme.accentColor))}_visualizeSnappingIndicator(r,i){const o=new e({geometry:r,symbol:i});return this._graphicsLayer.add(o),t((()=>{this._graphicsLayer.remove(o)}))}_getOrCreateSymbol(e,t){const r=this._symbolPairingsByType;return r.get(e)?.color!==t&&r.set(e,{color:t,symbol:M(e,t)}),r.get(e).symbol}}function M(e,t){const i=[...t.toRgb(),255*t.a];switch(e){case"point":return new f({outline:{width:.5,color:[0,0,0,1]},size:10,color:t});case"intersectionPoint":return new f({outline:new u({width:1.5,color:t}),size:15,color:[0,0,0,0]});case"line":return new S({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:s.Butt,joinStyle:m.Round,miterLimit:10,width:r(p.lineHintWidthTarget),color:i}]}}});case"parallelSign":return new S({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:i}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}});case"rightAngleQuad45":case"rightAngleQuad225":{const o="rightAngleQuad45"===e?45:225;return new S({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:r(p.rightAngleHintSize),rotation:o,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:r(p.rightAngleHintOutlineSize),color:i},{type:"CIMSolidFill",enable:!0,color:[...t.toRgb(),255*t.a*.4]}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}})}}}export{d as S};
