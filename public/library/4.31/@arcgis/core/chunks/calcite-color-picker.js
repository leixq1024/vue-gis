/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{p as e,H as t,c as a,h as i}from"./componentsUtils.js";import{a as n,i as o,b as l,r as s,n as r,o as c,c as h,h as d,O as p,e as u,f as C,d as m,g,j as f,R as v,H as b,k as y,D as x,l as S,m as w,p as k,q as I,s as A,t as D,u as F,v as j,w as O,x as E,S as P}from"./color-picker-swatch.js";import{d as T,r as H,b as L,f as K}from"./dom.js";import{u as R,I as N}from"./interactive.js";import{i as z}from"./key.js";import{s as M,a as $,c as U}from"./loadable.js";import{c as V,d as B}from"./locale2.js";import{r as W,c as q,a as _}from"./math.js";import{u as G,s as X,c as J,d as Y}from"./t9n.js";import{d as Q}from"./button.js";import{d as Z}from"./icon.js";import{d as ee}from"./input-message.js";import{d as te}from"./input-number.js";import{d as ae}from"./input-text.js";import{d as ie}from"./progress.js";import{d as ne}from"./loader.js";import{d as oe}from"./tab.js";import{d as le}from"./tab-nav.js";import{d as se}from"./tab-title.js";import{d as re}from"./tabs.js";import{t as ce}from"./throttle2.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"../core/JSONSupport.js";import"./tslib.es6.js";import"../core/Accessor.js";import"../core/Handles.js";import"./maybe.js";import"../core/accessorSupport/decorators/subclass.js";import"./metadata.js";import"./utils.js";import"./handleUtils.js";import"./tracking.js";import"./ensureType.js";import"../core/accessorSupport/decorators/property.js";import"./ObservableBase.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"./observers.js";import"./form.js";import"./label.js";import"./component.js";import"./Validation.js";import"./input3.js";import"./core.js";import"./debounce.js";
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.0
 */const he=n(),de=e(class extends t{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteColorPickerHexInputChange=a(this,"calciteColorPickerHexInputChange",6),this.onHexInputBlur=()=>{const e=this.hexInputNode,t=e.value,a=`#${t}`,{allowEmpty:i,internalColor:n}=this,r=i&&!t,c=h(a);o(a,this.alphaChannel)&&this.onHexInputChange(),r||l(a)&&c||(e.value=i&&!n?"":this.formatHexForInternalInput(s(n.object())))},this.onOpacityInputBlur=()=>{const e=this.opacityInputNode,t=e.value,{allowEmpty:a,internalColor:i}=this;a&&!t||(e.value=a&&!i?"":this.formatOpacityForInternalInput(i))},this.onOpacityInputInput=()=>{this.onOpacityInputChange()},this.onHexInputChange=()=>{let e=this.hexInputNode.value;if(e){const t=r(e,!1);l(t)&&this.alphaChannel&&this.internalColor&&(e=`${t+r(this.internalColor.hexa(),!0).slice(-2)}`)}this.internalSetValue(e,this.value)},this.onOpacityInputChange=()=>{const e=this.opacityInputNode;let t;if(e.value){const a=c(Number(e.value));t=this.internalColor?.alpha(a).hexa()}else t=e.value;this.internalSetValue(t,this.value)},this.onInputFocus=e=>{"calciteInternalInputTextFocus"===e.type?this.hexInputNode.selectText():this.opacityInputNode.selectText()},this.onHexInputInput=()=>{const e=`#${this.hexInputNode.value}`,t=this.value;l(e,this.alphaChannel)&&h(e,this.alphaChannel)&&this.internalSetValue(e,t)},this.onInputKeyDown=e=>{const{altKey:t,ctrlKey:a,metaKey:i,shiftKey:n}=e,{alphaChannel:l,hexInputNode:s,internalColor:r,value:c}=this,{key:h}=e,p=e.composedPath();if("Tab"===h&&o(c,this.alphaChannel)||"Enter"===h)return p.includes(s)?this.onHexInputChange():this.onOpacityInputChange(),void("Enter"===h&&e.preventDefault());const u="ArrowDown"===h||"ArrowUp"===h,m=this.value;if(u){if(!c)return this.internalSetValue(this.previousNonNullValue,m),void e.preventDefault();const t="ArrowUp"===h?1:-1,a=n?10:1;return this.internalSetValue(d(this.nudgeRGBChannels(r,a*t,p.includes(s)?"rgb":"a"),l),m),void e.preventDefault()}const g=t||a||i,f=1===h.length,v=C.test(h);!f||g||v||e.preventDefault()},this.onHexInputPaste=e=>{const t=e.clipboardData.getData("text");l(t,this.alphaChannel)&&h(t,this.alphaChannel)&&(e.preventDefault(),this.hexInputNode.value=t.slice(1),this.internalSetValue(t,this.value))},this.previousNonNullValue=this.value,this.storeHexInputRef=e=>{this.hexInputNode=e},this.storeOpacityInputRef=e=>{this.opacityInputNode=e},this.allowEmpty=!1,this.alphaChannel=!1,this.hexLabel="Hex",this.messages=void 0,this.numberingSystem=void 0,this.scale="m",this.value=r(d(he,this.alphaChannel),this.alphaChannel,!0),this.internalColor=he}connectedCallback(){const{allowEmpty:e,alphaChannel:t,value:a}=this;if(a){const e=r(a,t);l(e,t)&&this.internalSetValue(e,e,!1)}else e&&this.internalSetValue(null,null,!1)}componentWillLoad(){M(this)}componentDidLoad(){$(this)}handleValueChange(e,t){this.internalSetValue(e,t,!1)}render(){const{alphaChannel:e,hexLabel:t,internalColor:a,messages:n,scale:o,value:l}=this,s=this.formatHexForInternalInput(l),r=this.formatOpacityForInternalInput(a),c="l"===o?"m":"s";return i("div",{key:"70f804fdbc3c29fdf49616f56c39593fdc3717da",class:"container"},i("calcite-input-text",{key:"777d1f8ffa673a0d74f049d4a6bdacbf3510006a",class:"hex-input",label:n?.hex||t,maxLength:this.alphaChannel?8:6,onCalciteInputTextChange:this.onHexInputChange,onCalciteInputTextInput:this.onHexInputInput,onCalciteInternalInputTextBlur:this.onHexInputBlur,onCalciteInternalInputTextFocus:this.onInputFocus,onKeyDown:this.onInputKeyDown,onPaste:this.onHexInputPaste,prefixText:"#",ref:this.storeHexInputRef,scale:c,value:s}),e?i("calcite-input-number",{class:"opacity-input",key:"opacity-input",label:n?.opacity,max:p.max,maxLength:3,min:p.min,numberButtonType:"none",numberingSystem:this.numberingSystem,onCalciteInputNumberInput:this.onOpacityInputInput,onCalciteInternalInputNumberBlur:this.onOpacityInputBlur,onCalciteInternalInputNumberFocus:this.onInputFocus,onKeyDown:this.onInputKeyDown,ref:this.storeOpacityInputRef,scale:c,suffixText:"%",value:r}):null)}async setFocus(){return await U(this),T(this.hexInputNode)}internalSetValue(e,t,a=!0){if(e){const{alphaChannel:t}=this,i=r(e,t,t);if(l(i,t)){const{internalColor:e}=this,o=n(i),l=r(d(o,t),t),s=!e||l!==r(d(e,t),t);return this.internalColor=o,this.previousNonNullValue=l,this.value=l,void(s&&a&&this.calciteColorPickerHexInputChange.emit())}}else if(this.allowEmpty)return this.internalColor=null,this.value=null,void(a&&this.calciteColorPickerHexInputChange.emit());this.value=t}formatHexForInternalInput(e){return e?e.replace("#","").slice(0,6):""}formatOpacityForInternalInput(e){return e?`${u(e.alpha())}`:""}nudgeRGBChannels(e,t,a){let i;const o=e.array(),l=o.slice(0,3);if("rgb"===a)i=[...l.map((e=>e+t)),this.alphaChannel?o[3]:void 0];else{const a=c(u(e.alpha())+t);i=[...l,a]}return n(i)}get el(){return this}static get watchers(){return{value:["handleValueChange"]}}static get style(){return":host{display:block}.container{display:flex;inline-size:100%;flex-wrap:nowrap;align-items:center}.hex-input{flex-grow:1;text-transform:uppercase}.opacity-input{inline-size:68px;margin-inline-start:-1px}:host([scale=s]) .container{flex-wrap:wrap;row-gap:0.125rem}:host([scale=s]) .opacity-input{inline-size:unset;margin-inline-start:unset}:host([scale=l]) .opacity-input{inline-size:88px}:host([hidden]){display:none}[hidden]{display:none}"}},[1,"calcite-color-picker-hex-input",{allowEmpty:[4,"allow-empty"],alphaChannel:[4,"alpha-channel"],hexLabel:[1,"hex-label"],messages:[16],numberingSystem:[1,"numbering-system"],scale:[513],value:[1537],internalColor:[32],setFocus:[64]},void 0,{value:["handleValueChange"]}]);function pe(){"undefined"!=typeof customElements&&["calcite-color-picker-hex-input","calcite-icon","calcite-input-message","calcite-input-number","calcite-input-text","calcite-progress"].forEach((e=>{switch(e){case"calcite-color-picker-hex-input":customElements.get(e)||customElements.define(e,de);break;case"calcite-icon":customElements.get(e)||Z();break;case"calcite-input-message":customElements.get(e)||ee();break;case"calcite-input-number":customElements.get(e)||te();break;case"calcite-input-text":customElements.get(e)||ae();break;case"calcite-progress":customElements.get(e)||ie()}}))}pe();
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
 * v2.13.0
 */
const ue=e(class extends t{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.calciteColorPickerChange=a(this,"calciteColorPickerChange",6),this.calciteColorPickerInput=a(this,"calciteColorPickerInput",6),this.internalColorUpdateContext=null,this.isActiveChannelInputEmpty=!1,this.mode=g.HEX,this.shiftKeyChannelAdjustment=0,this.upOrDownArrowKeyTracker=null,this.handleTabActivate=e=>{this.channelMode=e.currentTarget.getAttribute("data-color-mode"),this.updateChannelsFromColor(this.color)},this.handleColorFieldScopeKeyDown=e=>{const{key:t}=e,a={ArrowUp:{x:0,y:-10},ArrowRight:{x:10,y:0},ArrowDown:{x:0,y:10},ArrowLeft:{x:-10,y:0}};a[t]&&(e.preventDefault(),this.scopeOrientation="ArrowDown"===t||"ArrowUp"===t?"vertical":"horizontal",this.captureColorFieldColor(this.colorFieldScopeLeft+a[t].x||0,this.colorFieldScopeTop+a[t].y||0,!1))},this.handleHueScopeKeyDown=e=>{const t=e.shiftKey?10:1,{key:a}=e,i={ArrowUp:1,ArrowRight:1,ArrowDown:-1,ArrowLeft:-1};if(i[a]){e.preventDefault();const n=i[a]*t,o=this.baseColorFieldColor.hue(),l=this.baseColorFieldColor.hue(o+n);this.internalColorSet(l,!1)}},this.handleHexInputChange=e=>{e.stopPropagation();const{isClearable:t,color:a}=this,i=e.target.value;!t||i?i!==(a&&r(d(a,f(this.mode))))&&this.internalColorSet(n(i)):this.internalColorSet(null)},this.handleSavedColorSelect=e=>{const t=e.currentTarget;this.internalColorSet(n(t.color))},this.handleChannelInput=e=>{const t=e.currentTarget,a=Number(t.getAttribute("data-channel-index")),i=3===a?p.max:"rgb"===this.channelMode?v[Object.keys(v)[a]]:b[Object.keys(b)[a]];let n;if(t.value){const e=Number(t.value)+this.shiftKeyChannelAdjustment;n=q(e,0,i).toString()}else n="",this.isActiveChannelInputEmpty=!0,this.upOrDownArrowKeyTracker=null;t.value=n,(""!==n&&0!==this.shiftKeyChannelAdjustment||""!==n)&&this.handleChannelChange(e)},this.handleChannelBlur=e=>{const t=e.currentTarget,a=Number(t.getAttribute("data-channel-index")),i=[...this.channels];!t.value&&!this.isClearable&&(t.value=i[a]?.toString())},this.handleChannelFocus=e=>{e.currentTarget.selectText()},this.handleChannelChange=e=>{const t=e.currentTarget,a=Number(t.getAttribute("data-channel-index")),i=[...this.channels];if(this.isClearable&&!t.value)return this.channels=[null,null,null,null],void this.internalColorSet(null);const n=3===a;this.isActiveChannelInputEmpty&&this.upOrDownArrowKeyTracker&&(t.value="up"===this.upOrDownArrowKeyTracker?(i[a]+1<=this.getChannelInputLimit(a)?i[a]+1:this.getChannelInputLimit(a)).toString():(i[a]-1>=0?i[a]-1:0).toString(),this.isActiveChannelInputEmpty=!1,this.upOrDownArrowKeyTracker=null);const o=t.value?Number(t.value):i[a];i[a]=n?c(o):o,this.updateColorFromChannels(i)},this.handleSavedColorKeyDown=e=>{z(e.key)&&(e.preventDefault(),this.handleSavedColorSelect(e))},this.handleColorFieldPointerDown=e=>{this.handleCanvasControlPointerDown(e,this.colorFieldRenderingContext,this.captureColorFieldColor,this.colorFieldScopeNode)},this.handleHueSliderPointerDown=e=>{this.handleCanvasControlPointerDown(e,this.hueSliderRenderingContext,this.captureHueSliderColor,this.hueScopeNode)},this.handleOpacitySliderPointerDown=e=>{this.handleCanvasControlPointerDown(e,this.opacitySliderRenderingContext,this.captureOpacitySliderValue,this.opacityScopeNode)},this.globalPointerUpHandler=e=>{if(!H(e))return;const t=this.activeCanvasInfo;this.activeCanvasInfo=null,this.drawColorControls(),t&&this.calciteColorPickerChange.emit()},this.globalPointerMoveHandler=e=>{const{activeCanvasInfo:t,el:a}=this;if(!a.isConnected||!t)return;const{context:i,bounds:n}=t;let o,l;const{clientX:s,clientY:r}=e;i.canvas.matches(":hover")?(o=s-n.x,l=r-n.y):(o=s<n.x+n.width&&s>n.x?s-n.x:s<n.x?0:n.width,l=r<n.y+n.height&&r>n.y?r-n.y:r<n.y?0:n.height),i===this.colorFieldRenderingContext?this.captureColorFieldColor(o,l,!1):i===this.hueSliderRenderingContext?this.captureHueSliderColor(o):i===this.opacitySliderRenderingContext&&this.captureOpacitySliderValue(o)},this.storeColorFieldScope=e=>{this.colorFieldScopeNode=e},this.storeHueScope=e=>{this.hueScopeNode=e},this.renderChannelsTabTitle=e=>{const{channelMode:t,messages:a}=this,n=e===t,o="rgb"===e?a.rgb:a.hsv;return i("calcite-tab-title",{class:y.colorMode,"data-color-mode":e,key:e,onCalciteTabsActivate:this.handleTabActivate,selected:n},o)},this.renderChannelsTab=e=>{const{isClearable:t,channelMode:a,channels:n,messages:o,alphaChannel:l}=this,s=e===a,r="rgb"===e?[o.red,o.green,o.blue]:[o.hue,o.saturation,o.value],c=L(this.el),h=l?n:n.slice(0,3);return i("calcite-tab",{class:y.control,key:e,selected:s},i("div",{class:y.channels,dir:"ltr"},h.map(((e,a)=>{const i=3===a;return i&&(e=t&&!e?e:u(e)),this.renderChannel(e,a,r[a],c,i?"%":"")}))))},this.renderChannel=(e,t,a,n,o)=>i("calcite-input-number",{class:y.channel,"data-channel-index":t,dir:n,key:t,label:a,lang:this.effectiveLocale,numberButtonType:"none",numberingSystem:this.numberingSystem,onCalciteInputNumberChange:this.handleChannelChange,onCalciteInputNumberInput:this.handleChannelInput,onCalciteInternalInputNumberBlur:this.handleChannelBlur,onCalciteInternalInputNumberFocus:this.handleChannelFocus,onKeyDown:this.handleKeyDown,scale:"l"===this.scale?"m":"s",style:{marginLeft:t>0&&("s"!==this.scale||!this.alphaChannel||3!==t)?"-1px":""},suffixText:o,value:e?.toString()}),this.deleteColor=()=>{const e=d(this.color,this.alphaChannel);if(!(this.savedColors.indexOf(e)>-1))return;const t=this.savedColors.filter((t=>t!==e));this.savedColors=t;const a=`${x}${this.storageId}`;this.storageId&&localStorage.setItem(a,JSON.stringify(t))},this.saveColor=()=>{const e=d(this.color,this.alphaChannel);if(this.savedColors.indexOf(e)>-1)return;const t=[...this.savedColors,e];this.savedColors=t;const a=`${x}${this.storageId}`;this.storageId&&localStorage.setItem(a,JSON.stringify(t))},this.drawColorControls=ce(((e="all")=>{"all"!==e&&"color-field"!==e||!this.colorFieldRenderingContext||this.drawColorField(),"all"!==e&&"hue-slider"!==e||!this.hueSliderRenderingContext||this.drawHueSlider(),this.alphaChannel&&("all"===e||"opacity-slider"===e)&&this.opacitySliderRenderingContext&&this.drawOpacitySlider()}),16),this.captureColorFieldColor=(e,t,a=!0)=>{const{dimensions:{colorField:{height:i,width:n}}}=this,o=Math.round(b.s/n*e),l=Math.round(b.v/i*(i-t));this.internalColorSet(this.baseColorFieldColor.hsv().saturationv(o).value(l),a)},this.initColorField=e=>{this.colorFieldRenderingContext=e.getContext("2d"),this.updateCanvasSize("color-field"),this.drawColorControls()},this.initHueSlider=e=>{this.hueSliderRenderingContext=e.getContext("2d"),this.updateCanvasSize("hue-slider"),this.drawHueSlider()},this.initOpacitySlider=e=>{e&&(this.opacitySliderRenderingContext=e.getContext("2d"),this.updateCanvasSize("opacity-slider"),this.drawOpacitySlider())},this.storeOpacityScope=e=>{this.opacityScopeNode=e},this.handleOpacityScopeKeyDown=e=>{const t=e.shiftKey?10:1,{key:a}=e,i={ArrowUp:.01,ArrowRight:.01,ArrowDown:-.01,ArrowLeft:-.01};if(i[a]){e.preventDefault();const n=i[a]*t,o=this.baseColorFieldColor.alpha(),l=this.baseColorFieldColor.alpha(o+n);this.internalColorSet(l,!1)}},this.allowEmpty=!1,this.alphaChannel=!1,this.channelsDisabled=!1,this.clearable=!1,this.color=S,this.disabled=!1,this.format="auto",this.hideChannels=!1,this.hexDisabled=!1,this.hideHex=!1,this.hideSaved=!1,this.savedDisabled=!1,this.scale="m",this.storageId=void 0,this.messageOverrides=void 0,this.numberingSystem=void 0,this.value=r(d(S,this.alphaChannel)),this.channelMode="rgb",this.channels=this.toChannels(S),this.defaultMessages=void 0,this.dimensions=w.m,this.effectiveLocale="",this.messages=void 0,this.savedColors=[],this.colorFieldScopeTop=void 0,this.colorFieldScopeLeft=void 0,this.hueScopeLeft=void 0,this.opacityScopeLeft=void 0,this.scopeOrientation=void 0}handleAllowEmptyOrClearableChange(){this.isClearable=this.clearable||this.allowEmpty}handleAlphaChannelChange(e){const{format:t}=this;e&&"auto"!==t&&!f(t)&&(console.warn(`ignoring alphaChannel as the current format (${t}) does not support alpha`),this.alphaChannel=!1)}handleAlphaChannelDimensionsChange(){this.effectiveSliderWidth=k(this.dimensions,this.alphaChannel),this.drawColorControls()}handleColorChange(e,t){this.drawColorControls(),this.updateChannelsFromColor(e),this.previousColor=t}handleFormatOrAlphaChannelChange(){this.setMode(this.format),this.internalColorSet(this.color,!1,"internal")}handleScaleChange(e="m"){this.updateDimensions(e),this.updateCanvasSize("all"),this.drawColorControls()}onMessagesChange(){}handleValueChange(e,t){const{isClearable:a,format:i}=this;let o=!1;if(!a||e){const a=I(e);if(!a||"auto"!==i&&a!==i)return this.showIncompatibleColorWarning(e,i),void(this.value=t);o=this.mode!==a,this.setMode(a,null===this.internalColorUpdateContext)}const l=this.activeCanvasInfo;if("initial"===this.internalColorUpdateContext)return;if("user-interaction"===this.internalColorUpdateContext)return this.calciteColorPickerInput.emit(),void(l||this.calciteColorPickerChange.emit());const s=a&&!e?null:n(null!=e&&"object"==typeof e&&f(this.mode)?A(e):e),r=!D(s,this.color);(o||r)&&this.internalColorSet(s,this.alphaChannel&&!(this.mode.endsWith("a")||this.mode.endsWith("a-css")),"internal")}get baseColorFieldColor(){return this.color||this.previousColor||S}effectiveLocaleChange(){G(this,this.effectiveLocale)}handleChannelKeyUpOrDown(e){this.shiftKeyChannelAdjustment=0;const{key:t}=e;if("ArrowUp"!==t&&"ArrowDown"!==t||!e.composedPath().some((e=>e.classList?.contains(y.channel))))return;const{shiftKey:a}=e;if(e.preventDefault(),!this.color)return this.internalColorSet(this.previousColor),void e.stopPropagation();this.shiftKeyChannelAdjustment="ArrowUp"===t&&a?9:"ArrowDown"===t&&a?-9:0,"ArrowUp"===t&&(this.upOrDownArrowKeyTracker="up"),"ArrowDown"===t&&(this.upOrDownArrowKeyTracker="down")}getChannelInputLimit(e){return"rgb"===this.channelMode?v[Object.keys(v)[e]]:b[Object.keys(b)[e]]}focusScope(e){requestAnimationFrame((()=>{e.focus()}))}handleCanvasControlPointerDown(e,t,a,i){H(e)&&(window.addEventListener("pointermove",this.globalPointerMoveHandler),window.addEventListener("pointerup",this.globalPointerUpHandler,{once:!0}),this.activeCanvasInfo={context:t,bounds:t.canvas.getBoundingClientRect()},a.call(this,e.offsetX,e.offsetY),this.focusScope(i))}async setFocus(){await U(this),K(this.el)}async componentWillLoad(){M(this),this.handleAllowEmptyOrClearableChange(),this.handleAlphaChannelDimensionsChange();const{isClearable:e,color:t,format:a,value:i}=this,o=e&&!i,l=I(i),s=o||"auto"===a&&l||a===l,r=o?null:s?n(i):t;s||this.showIncompatibleColorWarning(i,a),this.setMode(a,!1),this.internalColorSet(r,!1,"initial"),this.updateDimensions(this.scale);const c=`${x}${this.storageId}`;this.storageId&&localStorage.getItem(c)&&(this.savedColors=JSON.parse(localStorage.getItem(c))),await X(this)}connectedCallback(){V(this),J(this)}componentDidLoad(){$(this)}disconnectedCallback(){window.removeEventListener("pointermove",this.globalPointerMoveHandler),window.removeEventListener("pointerup",this.globalPointerUpHandler),B(this),Y(this)}componentDidRender(){R(this)}render(){const{channelsDisabled:e,color:t,colorFieldScopeLeft:a,colorFieldScopeTop:n,dimensions:{thumb:{radius:o}},hexDisabled:l,hideChannels:s,hideHex:r,hideSaved:c,hueScopeLeft:h,messages:C,alphaChannel:m,opacityScopeLeft:g,savedColors:f,savedDisabled:v,scale:x,scopeOrientation:w}=this,k=this.effectiveSliderWidth,I=t?d(t,m):null,A=o,D=h??k*S.hue()/b.h,F=o,j=g??k*u(S.alpha())/p.max,O=null===t,E="vertical"===w,P=l||r,T=e||s,H=v||c,[L,K]=this.getAdjustedScopePosition(a,n),[R,z]=this.getAdjustedScopePosition(D,A),[M,$]=this.getAdjustedScopePosition(j,F);return i(N,{key:"c4837ef7cbe25b5fc3f0c72fe82d0090c6e0cdb5",disabled:this.disabled},i("div",{key:"28230570482ee9d33df9518e3cca534e3fac44ac",class:y.container},i("div",{key:"83172bc55f13955f5b69b59300e68642d59999af",class:y.controlAndScope},i("canvas",{key:"c20db7054ab5ebdb1e13ba295ac463609c44de47",class:y.colorField,onPointerDown:this.handleColorFieldPointerDown,ref:this.initColorField}),i("div",{key:"1e44beb121ed5a2247a6d69bf42c49a7f1ce5829","aria-label":E?C.value:C.saturation,"aria-valuemax":E?b.v:b.s,"aria-valuemin":"0","aria-valuenow":(E?t?.saturationv():t?.value())||"0",class:{[y.scope]:!0,[y.colorFieldScope]:!0},onKeyDown:this.handleColorFieldScopeKeyDown,ref:this.storeColorFieldScope,role:"slider",style:{top:`${K||0}px`,left:`${L||0}px`},tabindex:"0"})),i("div",{key:"5b873f4e7266cc654086f59c8483d3b4a65c8e8f",class:y.previewAndSliders},i("calcite-color-picker-swatch",{key:"db7c903a933ed061cc2edcd766fde70a8b670f00",class:y.preview,color:I,scale:this.alphaChannel?"l":this.scale}),i("div",{key:"33ea2354cbcfaa6677e82713bd8f02d1b83a9c26",class:y.sliders},i("div",{key:"28493b4bd177b8c97583cabeb5716a7cb7202e76",class:y.controlAndScope},i("canvas",{key:"d0a9ce7fb098b7434cd62f68b6b6092efcef3dc4",class:{[y.slider]:!0,[y.hueSlider]:!0},onPointerDown:this.handleHueSliderPointerDown,ref:this.initHueSlider}),i("div",{key:"2356120385aabf09384f0077dffb7881c55c5ea9","aria-label":C.hue,"aria-valuemax":b.h,"aria-valuemin":"0","aria-valuenow":t?.round().hue()||S.round().hue(),class:{[y.scope]:!0,[y.hueScope]:!0},onKeyDown:this.handleHueScopeKeyDown,ref:this.storeHueScope,role:"slider",style:{top:`${z}px`,left:`${R}px`},tabindex:"0"})),m?i("div",{class:y.controlAndScope},i("canvas",{class:{[y.slider]:!0,[y.opacitySlider]:!0},onPointerDown:this.handleOpacitySliderPointerDown,ref:this.initOpacitySlider}),i("div",{"aria-label":C.opacity,"aria-valuemax":p.max,"aria-valuemin":p.min,"aria-valuenow":(t||S).round().alpha(),class:{[y.scope]:!0,[y.opacityScope]:!0},onKeyDown:this.handleOpacityScopeKeyDown,ref:this.storeOpacityScope,role:"slider",style:{top:`${$}px`,left:`${M}px`},tabindex:"0"})):null)),P&&T?null:i("div",{class:{[y.controlSection]:!0,[y.section]:!0}},i("div",{class:y.hexAndChannelsGroup},P?null:i("div",{class:y.hexOptions},i("calcite-color-picker-hex-input",{allowEmpty:this.isClearable,alphaChannel:m,class:y.control,messages:C,numberingSystem:this.numberingSystem,onCalciteColorPickerHexInputChange:this.handleHexInputChange,scale:x,value:I})),T?null:i("calcite-tabs",{class:{[y.colorModeContainer]:!0,[y.splitSection]:!0},scale:"l"===x?"m":"s"},i("calcite-tab-nav",{slot:"title-group"},this.renderChannelsTabTitle("rgb"),this.renderChannelsTabTitle("hsv")),this.renderChannelsTab("rgb"),this.renderChannelsTab("hsv")))),H?null:i("div",{class:{[y.savedColorsSection]:!0,[y.section]:!0}},i("div",{class:y.header},i("label",null,C.saved),i("div",{class:y.savedColorsButtons},i("calcite-button",{appearance:"transparent",class:y.deleteColor,disabled:O,iconStart:"minus",kind:"neutral",label:C.deleteColor,onClick:this.deleteColor,scale:x,type:"button"}),i("calcite-button",{appearance:"transparent",class:y.saveColor,disabled:O,iconStart:"plus",kind:"neutral",label:C.saveColor,onClick:this.saveColor,scale:x,type:"button"}))),f.length>0?i("div",{class:y.savedColors},[...f.map((e=>i("calcite-color-picker-swatch",{class:y.savedColor,color:e,key:e,onClick:this.handleSavedColorSelect,onKeyDown:this.handleSavedColorKeyDown,scale:x,tabIndex:0})))]):null)))}handleKeyDown(e){"Enter"===e.key&&e.preventDefault()}showIncompatibleColorWarning(e,t){console.warn(`ignoring color value (${e}) as it is not compatible with the current format (${t})`)}setMode(e,t=!0){const a="auto"===e?this.mode:e;this.mode=this.ensureCompatibleMode(a,t)}ensureCompatibleMode(e,t){const{alphaChannel:a}=this,i=f(e);if(a&&!i){const a=F(e);return t&&console.warn(`setting format to (${a}) as the provided one (${e}) does not support alpha`),a}if(!a&&i){const a=j(e);return t&&console.warn(`setting format to (${a}) as the provided one (${e}) does not support alpha`),a}return e}captureHueSliderColor(e){const t=O/this.effectiveSliderWidth*e;this.internalColorSet(this.baseColorFieldColor.hue(t),!1)}captureOpacitySliderValue(e){const t=c(p.max/this.effectiveSliderWidth*e);this.internalColorSet(this.baseColorFieldColor.alpha(t),!1)}internalColorSet(e,t=!0,a="user-interaction"){t&&D(e,this.color)||(this.internalColorUpdateContext=a,this.color=e,this.value=this.toValue(e),this.internalColorUpdateContext=null)}toValue(e,t=this.mode){if(!e)return null;if(t.includes("hex")){const a=t===g.HEXA;return r(d(e.round(),a),a)}if(t.includes("-css")){const a=e[t.replace("-css","").replace("a","")]().round().string();return(t.endsWith("a")||t.endsWith("a-css"))&&1===e.alpha()?`${a.slice(0,3)}a(${a.slice(4,-1)}, ${e.alpha()})`:a}const a=e[j(t)]().round().object();return t.endsWith("a")?E(a):a}getSliderCapSpacing(){const{dimensions:{slider:{height:e},thumb:{radius:t}}}=this;return 2*t-e}updateDimensions(e="m"){this.dimensions=w[e]}drawColorField(){const e=this.colorFieldRenderingContext,{dimensions:{colorField:{height:t,width:a}}}=this;e.fillStyle=this.baseColorFieldColor.hsv().saturationv(100).value(100).alpha(1).string(),e.fillRect(0,0,a,t);const i=e.createLinearGradient(0,0,a,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=i,e.fillRect(0,0,a,t);const n=e.createLinearGradient(0,0,0,t);n.addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),e.fillStyle=n,e.fillRect(0,0,a,t),this.drawActiveColorFieldColor()}setCanvasContextSize(e,{height:t,width:a}){if(!e)return;const i=window.devicePixelRatio||1;e.width=a*i,e.height=t*i,e.style.height=`${t}px`,e.style.width=`${a}px`,e.getContext("2d").scale(i,i)}updateCanvasSize(e="all"){const{dimensions:t}=this;"all"!==e&&"color-field"!==e||this.setCanvasContextSize(this.colorFieldRenderingContext?.canvas,t.colorField);const a={width:this.effectiveSliderWidth,height:t.slider.height+2*(t.thumb.radius-t.slider.height/2)};"all"!==e&&"hue-slider"!==e||this.setCanvasContextSize(this.hueSliderRenderingContext?.canvas,a),"all"!==e&&"opacity-slider"!==e||this.setCanvasContextSize(this.opacitySliderRenderingContext?.canvas,a)}drawActiveColorFieldColor(){const{color:e}=this;if(!e)return;const t=e.hsv(),{dimensions:{colorField:{height:a,width:i},thumb:{radius:n}}}=this,o=t.saturationv()/(b.s/i),l=a-t.value()/(b.v/a);requestAnimationFrame((()=>{this.colorFieldScopeLeft=o,this.colorFieldScopeTop=l})),this.drawThumb(this.colorFieldRenderingContext,n,o,l,t,!1)}drawThumb(e,t,a,i,n,o){const l=2*Math.PI;if(e.beginPath(),e.arc(a,i,t,0,l),e.fillStyle="#fff",e.fill(),e.strokeStyle="rgba(0,0,0,0.3)",e.lineWidth=1,e.stroke(),o&&n.alpha()<1){const n=e.createPattern(this.getCheckeredBackgroundPattern(),"repeat");e.beginPath(),e.arc(a,i,t-3,0,l),e.fillStyle=n,e.fill()}e.globalCompositeOperation="source-atop",e.beginPath(),e.arc(a,i,t-3,0,l);const s=o?n.alpha():1;e.fillStyle=n.rgb().alpha(s).string(),e.fill(),e.globalCompositeOperation="source-over"}drawActiveHueSliderColor(){const{color:e}=this;if(!e)return;const t=e.hsv().saturationv(100).value(100),{dimensions:{thumb:{radius:a}}}=this,i=this.effectiveSliderWidth,n=t.hue()/(O/i),o=a,l=this.getSliderBoundX(n,i,a);requestAnimationFrame((()=>{this.hueScopeLeft=l})),this.drawThumb(this.hueSliderRenderingContext,a,l,o,t,!1)}drawHueSlider(){const e=this.hueSliderRenderingContext,{dimensions:{slider:{height:t},thumb:{radius:a}}}=this,i=a-t/2,o=this.effectiveSliderWidth,l=e.createLinearGradient(0,0,o,0),s=["red","yellow","lime","cyan","blue","magenta","#ff0004"],r=1/(s.length-1);let c=0;s.forEach((e=>{l.addColorStop(c,n(e).string()),c+=r})),e.clearRect(0,0,o,t+2*this.getSliderCapSpacing()),this.drawSliderPath(e,t,o,0,i),e.fillStyle=l,e.fill(),e.strokeStyle="rgba(0,0,0,0.3)",e.lineWidth=1,e.stroke(),this.drawActiveHueSliderColor()}drawOpacitySlider(){const e=this.opacitySliderRenderingContext,{baseColorFieldColor:t,dimensions:{slider:{height:a},thumb:{radius:i}}}=this,n=i-a/2,o=this.effectiveSliderWidth;e.clearRect(0,0,o,a+2*this.getSliderCapSpacing());const l=e.createLinearGradient(0,n,o,0),s=t.rgb().alpha(0),r=t.rgb().alpha(.5),c=t.rgb().alpha(1);l.addColorStop(0,s.string()),l.addColorStop(.5,r.string()),l.addColorStop(1,c.string()),this.drawSliderPath(e,a,o,0,n);const h=e.createPattern(this.getCheckeredBackgroundPattern(),"repeat");e.fillStyle=h,e.fill(),e.fillStyle=l,e.fill(),e.strokeStyle="rgba(0,0,0,0.3)",e.lineWidth=1,e.stroke(),this.drawActiveOpacitySliderColor()}drawSliderPath(e,t,a,i,n){const o=t/2+1;e.beginPath(),e.moveTo(i+o,n),e.lineTo(i+a-o,n),e.quadraticCurveTo(i+a,n,i+a,n+o),e.lineTo(i+a,n+t-o),e.quadraticCurveTo(i+a,n+t,i+a-o,n+t),e.lineTo(i+o,n+t),e.quadraticCurveTo(i,n+t,i,n+t-o),e.lineTo(i,n+o),e.quadraticCurveTo(i,n,i+o,n),e.closePath()}getCheckeredBackgroundPattern(){if(this.checkerPattern)return this.checkerPattern;const e=document.createElement("canvas");e.width=10,e.height=10;const t=e.getContext("2d");return t.fillStyle="#ccc",t.fillRect(0,0,10,10),t.fillStyle="#fff",t.fillRect(0,0,5,5),t.fillRect(5,5,5,5),this.checkerPattern=e,e}drawActiveOpacitySliderColor(){const{color:e}=this;if(!e)return;const t=e,{dimensions:{thumb:{radius:a}}}=this,i=this.effectiveSliderWidth,n=u(t.alpha())/(p.max/i),o=a,l=this.getSliderBoundX(n,i,a);requestAnimationFrame((()=>{this.opacityScopeLeft=l})),this.drawThumb(this.opacitySliderRenderingContext,a,l,o,t,!0)}getSliderBoundX(e,t,a){const i=_(e,t,a);return 0===i?e:-1===i?W(e,0,t,a,2*a):W(e,0,t,t-2*a,t-a)}updateColorFromChannels(e){this.internalColorSet(n(e,this.channelMode))}updateChannelsFromColor(e){this.channels=e?this.toChannels(e):[null,null,null,null]}toChannels(e){const{channelMode:t}=this,a=e[t]().array().map(((e,t)=>3===t?e:Math.floor(e)));return 3===a.length&&a.push(1),a}getAdjustedScopePosition(e,t){return[e-P/2,t-P/2]}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{allowEmpty:["handleAllowEmptyOrClearableChange"],clearable:["handleAllowEmptyOrClearableChange"],alphaChannel:["handleAlphaChannelChange","handleAlphaChannelDimensionsChange","handleFormatOrAlphaChannelChange"],dimensions:["handleAlphaChannelDimensionsChange"],color:["handleColorChange"],format:["handleFormatOrAlphaChannelChange"],scale:["handleScaleChange"],messageOverrides:["onMessagesChange"],value:["handleValueChange"],effectiveLocale:["effectiveLocaleChange"]}}static get style(){return':host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:inline-block;font-size:var(--calcite-font-size--2);line-height:1rem;font-weight:var(--calcite-font-weight-normal)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}:host([scale=s]){--calcite-color-picker-spacing:8px}:host([scale=s]) .container{inline-size:160px}:host([scale=s]) .saved-colors{gap:0.25rem;grid-template-columns:repeat(auto-fill, 20px)}:host([scale=m]){--calcite-color-picker-spacing:12px}:host([scale=m]) .container{inline-size:272px}:host([scale=l]){--calcite-color-picker-spacing:16px;font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=l]) .container{inline-size:464px}:host([scale=l]) .section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}:host([scale=l]) .saved-colors{grid-template-columns:repeat(auto-fill, 32px)}:host([scale=l]) .control-section{flex-wrap:nowrap;align-items:baseline;flex-wrap:wrap}:host([scale=l]) .color-hex-options{display:flex;flex-shrink:1;flex-direction:column;justify-content:space-around}:host([scale=l]) .color-mode-container{flex-shrink:3}.container{background-color:var(--calcite-color-foreground-1);display:inline-block;border:1px solid var(--calcite-color-border-1)}.control-and-scope{position:relative;display:flex;cursor:pointer;touch-action:none}.color-field,.control-and-scope{-webkit-user-select:none;user-select:none}.scope{pointer-events:none;position:absolute;z-index:var(--calcite-z-index);block-size:1px;inline-size:1px;border-radius:9999px;background-color:transparent;font-size:var(--calcite-font-size--1);outline-color:transparent}.scope:focus{outline:2px solid var(--calcite-ui-focus-color, var(--calcite-color-brand));outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-offset-invert-focus),\n                1\n              )\n            )\n          );outline-offset:6px}.hex-and-channels-group{inline-size:100%}.hex-and-channels-group,.control-section{display:flex;flex-direction:row;flex-wrap:wrap}.section{padding-block:0 var(--calcite-color-picker-spacing);padding-inline:var(--calcite-color-picker-spacing)}.section:first-of-type{padding-block-start:var(--calcite-color-picker-spacing)}.sliders{display:flex;flex-direction:column;justify-content:space-between;margin-inline-start:var(--calcite-color-picker-spacing);gap:var(--calcite-spacing-xxs)}.preview-and-sliders{display:flex;align-items:center;padding:var(--calcite-color-picker-spacing)}.color-hex-options,.section--split{flex-grow:1}.header{display:flex;align-items:center;justify-content:space-between;color:var(--calcite-color-text-1)}.color-mode-container{padding-block-start:var(--calcite-color-picker-spacing)}.channels{display:flex;row-gap:0.125rem}.channel[data-channel-index="3"]{inline-size:159px}:host([scale=s]) .channels{flex-wrap:wrap}:host([scale=s]) .channel{flex-basis:30%;flex-grow:1}:host([scale=s]) .channel[data-channel-index="3"]{inline-size:unset;margin-inline-start:unset}:host([scale=l]) .channel[data-channel-index="3"]{inline-size:131px}.saved-colors{display:grid;gap:0.5rem;padding-block-start:var(--calcite-color-picker-spacing);grid-template-columns:repeat(auto-fill, 24px)}.saved-colors-buttons{display:flex}.saved-color{outline-offset:0;outline-color:transparent;cursor:pointer}.saved-color:focus{outline:2px solid var(--calcite-color-brand);outline-offset:2px}.saved-color:hover{transition:outline-color var(--calcite-internal-animation-timing-fast) ease-in-out;outline:2px solid var(--calcite-color-border-2);outline-offset:2px}:host([hidden]){display:none}[hidden]{display:none}'}},[1,"calcite-color-picker",{allowEmpty:[516,"allow-empty"],alphaChannel:[4,"alpha-channel"],channelsDisabled:[4,"channels-disabled"],clearable:[516],color:[1040],disabled:[516],format:[513],hideChannels:[516,"hide-channels"],hexDisabled:[4,"hex-disabled"],hideHex:[516,"hide-hex"],hideSaved:[516,"hide-saved"],savedDisabled:[516,"saved-disabled"],scale:[513],storageId:[513,"storage-id"],messageOverrides:[1040],numberingSystem:[513,"numbering-system"],value:[1025],messages:[1040],channelMode:[32],channels:[32],defaultMessages:[32],dimensions:[32],effectiveLocale:[32],savedColors:[32],colorFieldScopeTop:[32],colorFieldScopeLeft:[32],hueScopeLeft:[32],opacityScopeLeft:[32],scopeOrientation:[32],setFocus:[64]},[[2,"keydown","handleChannelKeyUpOrDown"],[2,"keyup","handleChannelKeyUpOrDown"]],{allowEmpty:["handleAllowEmptyOrClearableChange"],clearable:["handleAllowEmptyOrClearableChange"],alphaChannel:["handleAlphaChannelChange","handleAlphaChannelDimensionsChange","handleFormatOrAlphaChannelChange"],dimensions:["handleAlphaChannelDimensionsChange"],color:["handleColorChange"],format:["handleFormatOrAlphaChannelChange"],scale:["handleScaleChange"],messageOverrides:["onMessagesChange"],value:["handleValueChange"],effectiveLocale:["effectiveLocaleChange"]}]);function Ce(){"undefined"!=typeof customElements&&["calcite-color-picker","calcite-button","calcite-color-picker-hex-input","calcite-color-picker-swatch","calcite-icon","calcite-input-message","calcite-input-number","calcite-input-text","calcite-loader","calcite-progress","calcite-tab","calcite-tab-nav","calcite-tab-title","calcite-tabs"].forEach((e=>{switch(e){case"calcite-color-picker":customElements.get(e)||customElements.define(e,ue);break;case"calcite-button":customElements.get(e)||Q();break;case"calcite-color-picker-hex-input":customElements.get(e)||pe();break;case"calcite-color-picker-swatch":customElements.get(e)||m();break;case"calcite-icon":customElements.get(e)||Z();break;case"calcite-input-message":customElements.get(e)||ee();break;case"calcite-input-number":customElements.get(e)||te();break;case"calcite-input-text":customElements.get(e)||ae();break;case"calcite-loader":customElements.get(e)||ne();break;case"calcite-progress":customElements.get(e)||ie();break;case"calcite-tab":customElements.get(e)||oe();break;case"calcite-tab-nav":customElements.get(e)||le();break;case"calcite-tab-title":customElements.get(e)||se();break;case"calcite-tabs":customElements.get(e)||re()}}))}Ce();const me=ue,ge=Ce;export{me as CalciteColorPicker,ge as defineCustomElement};
