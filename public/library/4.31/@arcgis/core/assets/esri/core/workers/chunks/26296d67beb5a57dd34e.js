"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[6421],{86421:(e,n,t)=>{t.r(n),t.d(n,{registerFunctions:()=>D});var i=t(26589),a=t(22976),r=t(81743),s=t(97503),l=t(1223),o=t(29023),d=t(54642),f=t(71689),u=t(80959),c=t(38896),m=t(77125),y=t(44864),p=t(82408);async function h(e,n,t){const i=e.getVariables();if(i.length>0){const a=[];for(let e=0;e<i.length;e++){const r={name:i[e]};a.push(await n.evaluateIdentifier(t,r))}const r={};for(let e=0;e<i.length;e++)r[i[e]]=a[e];return e.parameters=r,e}return e}function w(e,n,t=null){for(const t in e)if(t.toLowerCase()===n.toLowerCase())return e[t];return t}function g(e){if(null===e)return null;const n={type:w(e,"type",""),name:w(e,"name","")};if("range"===n.type)n.range=w(e,"range",[]);else{n.codedValues=[];for(const t of w(e,"codedValues",[]))n.codedValues.push({name:w(t,"name",""),code:w(t,"code",null)})}return n}function I(e){if(null===e)return null;const n={},t=w(e,"wkt");null!==t&&(n.wkt=t);const i=w(e,"wkid");return null!==i&&(n.wkid=i),n}function F(e){if(null===e)return null;const n={hasZ:w(e,"hasz",!1),hasM:w(e,"hasm",!1)},t=w(e,"spatialreference");null!=t&&(n.spatialReference=I(t));const i=w(e,"x",null);if(null!==i)return n.x=i,n.y=w(e,"y",null),n.hasZ&&(n.z=w(e,"z",null)),n.hasM&&(n.m=w(e,"m",null)),n;const a=w(e,"rings",null);if(null!==a)return n.rings=a,n;const r=w(e,"paths",null);if(null!==r)return n.paths=r,n;const s=w(e,"points",null);if(null!==s)return n.points=s,n;for(const t of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const i=w(e,t,null);null!==i&&(n[t]=i)}return n}function E(e){return"utc"===e?.toLowerCase()?"UTC":"unknown"===e?.toLowerCase()?"Unknown":e}function D(e){"async"===e.mode&&(e.functions.timezone=function(n,t){return e.standardFunctionAsync(n,t,(async(e,s,l)=>{if((0,r.p)(l,1,2,n,t),(0,r.G)(l[0]))return"Unknown";if((0,r.H)(l[0]))return"Unknown";if((0,r.g)(l[0])){if(await l[0].load(),1===l.length||null===l[1])return l[0].datesInUnknownTimezone?E("unknown"):E(l[0].dateFieldsTimeZone);if(!(l[1]instanceof a.D)||!1===l[1].hasField("type"))throw new r.n(n,r.E.InvalidParameter,t);const e=l[1].field("type");if(!1===(0,r.t)(e))throw new r.n(n,r.E.InvalidParameter,t);switch((0,r.x)(e).toLowerCase()){case"preferredtimezone":return E(l[0].preferredTimeZone);case"editfieldsinfo":return E(l[0].editFieldsInfo?.timeZone??null);case"timeinfo":return E(l[0].timeInfo?.timeZone??null);case"field":if(l[1].hasField("fieldname")&&(0,r.t)(l[1].field("fieldname")))return E(l[0].fieldTimeZone((0,r.x)(l[1].field("fieldname"))))}throw new r.n(n,r.E.InvalidParameter,t)}const o=(0,r.Q)(l[0],(0,r.P)(n));if(null===o)return null;const d=o.timeZone;return"system"===d?i.A.systemTimeZoneCanonicalName:"utc"===d.toLowerCase()?"UTC":"unknown"===d.toLowerCase()?"Unknown":d}))},e.functions.sqltimestamp=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.p)(a,1,3,n,t);const s=a[0];if((0,r.i)(s)){if(1===a.length)return s.toSQLWithKeyword();if(2===a.length)return s.changeTimeZone((0,r.x)(a[1])).toSQLWithKeyword();throw new r.n(n,r.E.InvalidParameter,t)}if((0,r.H)(s))return s.toSQLWithKeyword();if((0,r.g)(s)){if(3!==a.length)throw new r.n(n,r.E.InvalidParameter,t);await s.load();const e=(0,r.x)(a[1]);if((0,r.H)(a[2]))return a[2].toSQLWithKeyword();if(!1===(0,r.i)(a[2]))throw new r.n(n,r.E.InvalidParameter,t);const i=s.fieldTimeZone(e);return null===i?a[2].toSQLWithKeyword():a[2].changeTimeZone(i).toSQLWithKeyword()}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"sqltimestamp",min:2,max:4}),e.functions.featuresetbyid=function(n,t){return e.standardFunctionAsync(n,t,((e,i,a)=>{if((0,r.p)(a,2,4,n,t),(0,r.f)(a[0])){const e=(0,r.x)(a[1]);let i=(0,r.J)(a[2],null);const s=(0,r.O)((0,r.J)(a[3],!0));if(null===i&&(i=["*"]),!1===(0,r.d)(i))throw new r.n(n,r.E.InvalidParameter,t);return a[0].featureSetById(e,s,i)}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyid",min:2,max:4}),e.functions.getfeatureset=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.p)(a,1,2,n,t),(0,r.e)(a[0])){let e=(0,r.J)(a[1],"datasource");return null===e&&(e="datasource"),e=(0,r.x)(e).toLowerCase(),(0,s.c)(a[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference??null)}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"getfeatureset",min:1,max:2}),e.functions.featuresetbyportalitem=function(n,t){return e.standardFunctionAsync(n,t,((e,i,l)=>{if((0,r.p)(l,2,5,n,t),null===l[0])throw new r.n(n,r.E.PortalRequired,t);if(l[0]instanceof a.l){const e=(0,r.x)(l[1]),i=(0,r.x)(l[2]);let a=(0,r.J)(l[3],null);const d=(0,r.O)((0,r.J)(l[4],!0));if(null===a&&(a=["*"]),!1===(0,r.d)(a))throw new r.n(n,r.E.InvalidParameter,t);let f;return f=n.services?.portal?n.services.portal:p.A.getDefault(),f=(0,o.g)(l[0],f),(0,s.a)(e,i,n.spatialReference??null,a,d,f,n.lrucache,n.interceptor)}if(!1===(0,r.t)(l[0]))throw new r.n(n,r.E.PortalRequired,t);const d=(0,r.x)(l[0]),f=(0,r.x)(l[1]);let u=(0,r.J)(l[2],null);const c=(0,r.O)((0,r.J)(l[3],!0));if(null===u&&(u=["*"]),!1===(0,r.d)(u))throw new r.n(n,r.E.InvalidParameter,t);return(0,s.a)(d,f,n.spatialReference??null,u,c,n.services?.portal??p.A.getDefault(),n.lrucache,n.interceptor)}))},e.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),e.functions.featuresetbyname=function(n,t){return e.standardFunctionAsync(n,t,((e,i,a)=>{if((0,r.p)(a,2,4,n,t),(0,r.f)(a[0])){const e=(0,r.x)(a[1]);let i=(0,r.J)(a[2],null);const s=(0,r.O)((0,r.J)(a[3],!0));if(null===i&&(i=["*"]),!1===(0,r.d)(i))throw new r.n(n,r.E.InvalidParameter,t);return a[0].featureSetByName(e,s,i)}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyname",min:2,max:4}),e.functions.featureset=function(n,t){return e.standardFunction(n,t,((e,i,l)=>{(0,r.p)(l,1,1,n,t);const o={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",hasM:!1,hasZ:!1,fields:[]},featureSet:{geometryType:"",features:[]}};if((0,r.t)(l[0])){const e=JSON.parse(l[0]);void 0!==e.layerDefinition?(o.layerDefinition=e.layerDefinition,o.featureSet=e.featureSet,e.layerDefinition.spatialReference&&(o.layerDefinition.spatialReference=e.layerDefinition.spatialReference)):(o.featureSet.features=e.features,o.featureSet.geometryType=e.geometryType,o.layerDefinition.geometryType=o.featureSet.geometryType,o.layerDefinition.objectIdField=e.objectIdFieldName??"",o.layerDefinition.typeIdField=e.typeIdFieldName,o.layerDefinition.globalIdField=e.globalIdFieldName,o.layerDefinition.fields=e.fields,e.spatialReference&&(o.layerDefinition.spatialReference=e.spatialReference))}else{if(!(l[0]instanceof a.D))throw new r.n(n,r.E.InvalidParameter,t);{const e=JSON.parse(l[0].castToText(!0)),i=w(e,"layerdefinition");if(null!==i){o.layerDefinition.geometryType=w(i,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.globalIdField=w(i,"globalidfield",""),o.layerDefinition.objectIdField=w(i,"objectidfield",""),o.layerDefinition.typeIdField=w(i,"typeidfield",""),o.layerDefinition.hasZ=!0===w(i,"hasz",!1),o.layerDefinition.hasM=!0===w(i,"hasm",!1);const n=w(i,"spatialreference");n&&(o.layerDefinition.spatialReference=I(n));const t=[];for(const e of w(i,"fields",[])){const n={name:w(e,"name",""),alias:w(e,"alias",""),type:w(e,"type",""),nullable:w(e,"nullable",!0),editable:w(e,"editable",!0),length:w(e,"length",null),domain:g(w(e,"domain"))};t.push(n)}o.layerDefinition.fields=t;const a=w(e,"featureset");if(a){const e={};for(const n of t)e[n.name.toLowerCase()]=n.name;for(const n of w(a,"features",[])){const t={},i=w(n,"attributes",{});for(const n in i)t[e[n.toLowerCase()]]=i[n];o.featureSet.features.push({attributes:t,geometry:F(w(n,"geometry"))})}}}else{o.layerDefinition.hasZ=!0===w(e,"hasz",!1),o.layerDefinition.hasM=!0===w(e,"hasm",!1),o.layerDefinition.geometryType=w(e,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.objectIdField=w(e,"objectidfieldname",""),o.layerDefinition.typeIdField=w(e,"typeidfieldname","");const i=w(e,"spatialreference");i&&(o.layerDefinition.spatialReference=I(i));const a=[],s=w(e,"fields",null);if(!(0,r.d)(s))throw new r.n(n,r.E.InvalidParameter,t);for(const e of s){const n={name:w(e,"name",""),alias:w(e,"alias",""),type:w(e,"type",""),nullable:w(e,"nullable",!0),editable:w(e,"editable",!0),length:w(e,"length",null),domain:g(w(e,"domain"))};a.push(n)}o.layerDefinition.fields=a;const l={};for(const e of a)l[e.name.toLowerCase()]=e.name;let d=w(e,"features",null);if((0,r.d)(d))for(const e of d){const n={},t=w(e,"attributes",{});for(const e in t)n[l[e.toLowerCase()]]=t[e];o.featureSet.features.push({attributes:n,geometry:F(w(e,"geometry",null))})}else d=null,o.featureSet.features=d}}}if(0==(!!(d=o).layerDefinition&&!!d.featureSet&&!1!==function(e){for(const n of["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])if(n===e)return!0;return!1}(d.layerDefinition.geometryType)&&!1!==(0,r.d)(d.layerDefinition.fields)&&!1!==(0,r.d)(d.featureSet.features)))throw new r.n(n,r.E.InvalidParameter,t);var d;return o.layerDefinition.geometryType||(o.layerDefinition.geometryType="esriGeometryNull"),s.F.create(o,n.spatialReference)}))},e.signatures.push({name:"featureset",min:1,max:1}),e.functions.filter=function(n,t){return e.standardFunctionAsync(n,t,(async(i,a,o)=>{if((0,r.p)(o,2,2,n,t),(0,r.d)(o[0])||(0,r.c)(o[0])){const e=[];let i,a=o[0];if(a instanceof l.I&&(a=a.toArray()),!(0,r.k)(o[1]))throw new r.n(n,r.E.InvalidParameter,t);i=o[1].createFunction(n);for(const n of a){const t=i(n);(0,u.$X)(t)?!0===await t&&e.push(n):!0===t&&e.push(n)}return e}if((0,r.g)(o[0])){const t=await o[0].load(),i=c.WhereClause.create(o[1],{fieldsIndex:t.getFieldsIndex(),timeZone:t.dateFieldsTimeZoneDefaultUTC}),a=i.getVariables();if(a.length>0){const t=[];for(let i=0;i<a.length;i++){const r={name:a[i]};t.push(await e.evaluateIdentifier(n,r))}const r={};for(let e=0;e<a.length;e++)r[a[e]]=t[e];return i.parameters=r,new s.b({parentfeatureset:o[0],whereclause:i})}return new s.b({parentfeatureset:o[0],whereclause:i})}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"filter",min:2,max:2}),e.functions.orderby=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.p)(a,2,2,n,t),(0,r.g)(a[0])){const e=new s.O(a[1]);return new s.d({parentfeatureset:a[0],orderbyclause:e})}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"orderby",min:2,max:2}),e.functions.top=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.p)(a,2,2,n,t),(0,r.g)(a[0]))return new s.T({parentfeatureset:a[0],topnum:a[1]});if((0,r.d)(a[0]))return(0,r.w)(a[1])>=a[0].length?a[0].slice():a[0].slice(0,(0,r.w)(a[1]));if((0,r.c)(a[0]))return(0,r.w)(a[1])>=a[0].length()?a[0].slice():a[0].slice(0,(0,r.w)(a[1]));throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"top",min:2,max:2}),e.functions.first=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,s)=>{if((0,r.p)(s,1,1,n,t),(0,r.g)(s[0])){const t=await s[0].first(e.abortSignal);if(null!==t){const e=a.F.createFromGraphicLikeObject(t.geometry,t.attributes,s[0],n.timeZone);return e._underlyingGraphic=t,e}return t}return(0,r.d)(s[0])?0===s[0].length?null:s[0][0]:(0,r.c)(s[0])?0===s[0].length()?null:s[0].get(0):null}))},e.signatures.push({name:"first",min:1,max:1}),e.functions.attachments=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,l)=>{(0,r.p)(l,1,2,n,t);const o={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(l.length>1)if(l[1]instanceof a.D){if(l[1].hasField("minsize")&&(o.minsize=(0,r.w)(l[1].field("minsize"))),l[1].hasField("metadata")&&(o.returnMetadata=(0,r.O)(l[1].field("metadata"))),l[1].hasField("maxsize")&&(o.maxsize=(0,r.w)(l[1].field("maxsize"))),l[1].hasField("types")){const e=(0,r.T)(l[1].field("types"),!1);e.length>0&&(o.types=e)}}else if(null!==l[1])throw new r.n(n,r.E.InvalidParameter,t);if((0,r.e)(l[0])){let e=l[0]._layer;return e instanceof m.default&&(e=(0,s.e)(e,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===e||!1===(0,r.g)(e)?[]:(await e.load(),e.queryAttachments(l[0].field(e.objectIdField),o.minsize,o.maxsize,o.types,o.returnMetadata))}if(null===l[0])return[];throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"attachments",min:1,max:2}),e.functions.featuresetbyrelationshipname=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.p)(a,2,4,n,t);const l=a[0],o=(0,r.x)(a[1]);let f=(0,r.J)(a[2],null);const u=(0,r.O)((0,r.J)(a[3],!0));if(null===f&&(f=["*"]),!1===(0,r.d)(f))throw new r.n(n,r.E.InvalidParameter,t);if(null===a[0])return null;if(!(0,r.e)(a[0]))throw new r.n(n,r.E.InvalidParameter,t);let y=l._layer;if(y instanceof m.default&&(y=(0,s.e)(y,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===y)return null;if(!1===(0,r.g)(y))return null;y=await y.load();const p=y.relationshipMetaData().filter((e=>e.name===o));if(0===p.length)return null;if(void 0!==p[0].relationshipTableId&&null!==p[0].relationshipTableId&&p[0].relationshipTableId>-1)return(0,s.f)(y,p[0],l.field(y.objectIdField),y.spatialReference,f,u,n.lrucache,n.interceptor);let h=y.serviceUrl();if(!h)return null;h="/"===h.charAt(h.length-1)?h+p[0].relatedTableId.toString():h+"/"+p[0].relatedTableId.toString();const w=await(0,s.g)(h,y.spatialReference,f,u,n.lrucache,n.interceptor);await w.load();let g=w.relationshipMetaData();if(g=g.filter((e=>e.id===p[0].id)),!1===l.hasField(p[0].keyField)||null===l.field(p[0].keyField)){const e=await y.getFeatureByObjectId(l.field(y.objectIdField),[p[0].keyField]);if(e){const n=c.WhereClause.create(g[0].keyField+"= @id",{fieldsIndex:w.getFieldsIndex(),timeZone:w.dateFieldsTimeZoneDefaultUTC});return n.parameters={id:e.attributes[p[0].keyField]},w.filter(n)}return new d.E({parentfeatureset:w})}const I=c.WhereClause.create(g[0].keyField+"= @id",{fieldsIndex:w.getFieldsIndex(),timeZone:w.dateFieldsTimeZoneDefaultUTC});return I.parameters={id:l.field(p[0].keyField)},w.filter(I)}))},e.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),e.functions.featuresetbyassociation=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{(0,r.p)(a,2,3,n,t);const l=a[0],o=(0,r.x)((0,r.J)(a[1],"")).toLowerCase(),d=(0,r.t)(a[2])?(0,r.x)(a[2]):null;if(null===a[0])return null;if(!(0,r.e)(a[0]))throw new r.n(n,r.E.InvalidParameter,t);let u=l._layer;if(u instanceof m.default&&(u=(0,s.e)(u,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===u)return null;if(!1===(0,r.g)(u))return null;await u.load();const p=u.serviceUrl(),h=await(0,s.h)(p,n.spatialReference);let w=null,g=null,I=!1;if(null!==d&&""!==d&&void 0!==d){for(const e of h.terminals)e.terminalName===d&&(g=e.terminalId);null===g&&(I=!0)}const F=h.associations.getFieldsIndex(),E=F.get("TOGLOBALID").name,D=F.get("FROMGLOBALID").name,x=F.get("TOTERMINALID").name,T=F.get("FROMTERMINALID").name,b=F.get("FROMNETWORKSOURCEID").name,A=F.get("TONETWORKSOURCEID").name,C=F.get("ASSOCIATIONTYPE").name,N=F.get("ISCONTENTVISIBLE").name,S=F.get("OBJECTID").name;for(const e of u.fields)if("global-id"===e.type){w=l.field(e.name);break}let L=null,Z=new s.S(new y.A({name:"percentalong",alias:"percentalong",type:"double"}),c.WhereClause.create("0",{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC})),v=new s.S(new y.A({name:"side",alias:"side",type:"string"}),c.WhereClause.create("''",{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC}));const $="globalid",P="globalId",k={};for(const e in h.lkp)k[e]=h.lkp[e].sourceId;const U=new s.i(new y.A({name:"classname",alias:"classname",type:"string"}),null,k);let R="";switch(o){case"midspan":{R=`((${E}='${w}') OR ( ${D}='${w}')) AND (${C} IN (5))`,U.codefield=c.WhereClause.create(`CASE WHEN (${E}='${w}') THEN ${b} ELSE ${A} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC});const e=(0,f.c)(s.A.findField(h.associations.fields,D));e.name=$,e.alias=$,L=new s.S(e,c.WhereClause.create(`CASE WHEN (${D}='${w}') THEN ${E} ELSE ${D} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC})),Z=h.unVersion>=4?new s.k(s.A.findField(h.associations.fields,F.get("PERCENTALONG").name)):new s.S(new y.A({name:"percentalong",alias:"percentalong",type:"double"}),c.WhereClause.create("0",{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC}));break}case"junctionedge":{R=`((${E}='${w}') OR ( ${D}='${w}')) AND (${C} IN (4,6))`,U.codefield=c.WhereClause.create(`CASE WHEN (${E}='${w}') THEN ${b} ELSE ${A} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC});const e=(0,f.c)(s.A.findField(h.associations.fields,D));e.name=$,e.alias=$,L=new s.S(e,c.WhereClause.create(`CASE WHEN (${D}='${w}') THEN ${E} ELSE ${D} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC})),v=new s.S(new y.A({name:"side",alias:"side",type:"string"}),c.WhereClause.create(`CASE WHEN (${C}=4) THEN 'from' ELSE 'to' END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC}));break}case"connected":{let e=`${E}='@T'`,n=`${D}='@T'`;null!==g&&(e+=` AND ${x}=@A`,n+=` AND ${T}=@A`),R="(("+e+") OR ("+n+"))",R=(0,r.U)(R,"@T",w??""),e=(0,r.U)(e,"@T",w??""),null!==g&&(e=(0,r.U)(e,"@A",g.toString()),R=(0,r.U)(R,"@A",g.toString())),U.codefield=c.WhereClause.create("CASE WHEN "+e+` THEN ${b} ELSE ${A} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC});const t=(0,f.c)(s.A.findField(h.associations.fields,D));t.name=$,t.alias=$,L=new s.S(t,c.WhereClause.create("CASE WHEN "+e+` THEN ${D} ELSE ${E} END`,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC}));break}case"container":R=`${E}='${w}' AND ${C} = 2`,null!==g&&(R+=` AND ${x} = `+g.toString()),U.codefield=b,R="( "+R+" )",L=new s.j(s.A.findField(h.associations.fields,D),$,$);break;case"content":R=`(${D}='${w}' AND ${C} = 2)`,null!==g&&(R+=` AND ${T} = `+g.toString()),U.codefield=A,R="( "+R+" )",L=new s.j(s.A.findField(h.associations.fields,E),$,$);break;case"structure":R=`(${E}='${w}' AND ${C} = 3)`,null!==g&&(R+=` AND ${x} = `+g.toString()),U.codefield=b,R="( "+R+" )",L=new s.j(s.A.findField(h.associations.fields,D),$,P);break;case"attached":R=`(${D}='${w}' AND ${C} = 3)`,null!==g&&(R+=` AND ${T} = `+g.toString()),U.codefield=A,R="( "+R+" )",L=new s.j(s.A.findField(h.associations.fields,E),$,P);break;default:throw new r.n(n,r.E.InvalidParameter,t)}return I&&(R="1 <> 1"),new s.A({parentfeatureset:h.associations,adaptedFields:[new s.k(s.A.findField(h.associations.fields,S)),new s.k(s.A.findField(h.associations.fields,N)),L,v,U,Z],extraFilter:R?c.WhereClause.create(R,{fieldsIndex:h.associations.getFieldsIndex(),timeZone:h.associations.dateFieldsTimeZoneDefaultUTC}):null})}))},e.signatures.push({name:"featuresetbyassociation",min:2,max:6}),e.functions.groupby=function(n,t){return e.standardFunctionAsync(n,t,(async(i,s,l)=>{if((0,r.p)(l,3,3,n,t),!(0,r.g)(l[0]))throw new r.n(n,r.E.InvalidParameter,t);const o=await l[0].load(),f=[],u=[];let m=!1,y=[];if((0,r.t)(l[1]))y.push(l[1]);else if(l[1]instanceof a.D)y.push(l[1]);else if((0,r.d)(l[1]))y=l[1];else{if(!(0,r.c)(l[1]))throw new r.n(n,r.E.InvalidParameter,t);y=l[1].toArray()}for(const e of y)if((0,r.t)(e)){const n=c.WhereClause.create((0,r.x)(e),{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC}),t=!0===(0,d.i)(n)?(0,r.x)(e):"%%%%FIELDNAME";f.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(m=!0)}else{if(!(e instanceof a.D))throw new r.n(n,r.E.InvalidParameter,t);{const i=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",a=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===i&&(m=!0),!i)throw new r.n(n,r.E.InvalidParameter,t);f.push({name:i,expression:c.WhereClause.create(a||i,{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC})})}}if(y=[],(0,r.t)(l[2]))y.push(l[2]);else if((0,r.d)(l[2]))y=l[2];else if((0,r.c)(l[2]))y=l[2].toArray();else{if(!(l[2]instanceof a.D))throw new r.n(n,r.E.InvalidParameter,t);y.push(l[2])}for(const e of y){if(!(e instanceof a.D))throw new r.n(n,r.E.InvalidParameter,t);{const i=e.hasField("name")?e.field("name"):"",a=e.hasField("statistic")?e.field("statistic"):"",s=e.hasField("expression")?e.field("expression"):"";if(!i||!a||!s)throw new r.n(n,r.E.InvalidParameter,t);u.push({name:i,statistic:a.toLowerCase(),expression:c.WhereClause.create(s,{fieldsIndex:o.getFieldsIndex(),timeZone:o.dateFieldsTimeZoneDefaultUTC})})}}if(m){const e={};for(const n of o.fields)e[n.name.toLowerCase()]=1;for(const n of f)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of u)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of f)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of f)await h(t.expression,e,n);for(const t of u)await h(t.expression,e,n);return l[0].groupby(f,u)}))},e.signatures.push({name:"groupby",min:3,max:3}),e.functions.distinct=function(n,t){return e.standardFunctionAsync(n,t,(async(i,s,l)=>{if((0,r.g)(l[0])){(0,r.p)(l,2,2,n,t);const i=await l[0].load(),s=[];let o=[];if((0,r.t)(l[1]))o.push(l[1]);else if(l[1]instanceof a.D)o.push(l[1]);else if((0,r.d)(l[1]))o=l[1];else{if(!(0,r.c)(l[1]))throw new r.n(n,r.E.InvalidParameter,t);o=l[1].toArray()}let f=!1;for(const e of o)if((0,r.t)(e)){const n=c.WhereClause.create((0,r.x)(e),{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC}),t=!0===(0,d.i)(n)?(0,r.x)(e):"%%%%FIELDNAME";s.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(f=!0)}else{if(!(e instanceof a.D))throw new r.n(n,r.E.InvalidParameter,t);{const a=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",l=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===a&&(f=!0),!a)throw new r.n(n,r.E.InvalidParameter,t);s.push({name:a,expression:c.WhereClause.create(l||a,{fieldsIndex:i.getFieldsIndex(),timeZone:i.dateFieldsTimeZoneDefaultUTC})})}}if(f){const e={};for(const n of i.fields)e[n.name.toLowerCase()]=1;for(const n of s)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of s)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of s)await h(t.expression,e,n);return l[0].groupby(s,[])}return function(e){if(1===e.length){if((0,r.d)(e[0]))return(0,a.o)("distinct",e[0],-1);if((0,r.c)(e[0]))return(0,a.o)("distinct",e[0].toArray(),-1)}return(0,a.o)("distinct",e,-1)}(l)}))},e.functions.getfeaturesetinfo=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,s)=>{if((0,r.p)(s,1,1,n,t),!(0,r.g)(s[0]))return null;const l=await s[0].getFeatureSetInfo();return l?a.D.convertObjectToArcadeDictionary({layerId:l.layerId,layerName:l.layerName,itemId:l.itemId,serviceLayerUrl:l.serviceLayerUrl,webMapLayerId:l.webMapLayerId??null,webMapLayerTitle:l.webMapLayerTitle??null,className:null,objectClassId:null},(0,r.P)(n),!1,!1):null}))},e.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),e.functions.filterbysubtypecode=function(n,t){return e.standardFunctionAsync(n,t,(async(e,i,a)=>{if((0,r.p)(a,2,2,n,t),(0,r.g)(a[0])){const e=await a[0].load(),i=a[1];if(!(0,r.V)(i))throw new r.n(n,r.E.InvalidParameter,t);if(e.subtypeField){const n=c.WhereClause.create(`${e.subtypeField}= ${a[1]}`,{fieldsIndex:e.getFieldsIndex(),timeZone:e.dateFieldsTimeZoneDefaultUTC});return new s.b({parentfeatureset:a[0],whereclause:n})}if(null===e.typeIdField||""===e.typeIdField)throw new r.n(n,r.E.FeatureSetDoesNotHaveSubtypes,t);const l=c.WhereClause.create(`${e.typeIdField}= ${a[1]}`,{fieldsIndex:e.getFieldsIndex(),timeZone:e.dateFieldsTimeZoneDefaultUTC});return new s.b({parentfeatureset:a[0],whereclause:l})}throw new r.n(n,r.E.InvalidParameter,t)}))},e.signatures.push({name:"filterbysubtypecode",min:2,max:2}))}t(20266),t(90740),t(32773),t(133),t(54483),t(59192),t(13671),t(44600),t(32816),t(29298),t(36544),t(93181),t(40499),t(6407),t(69421),t(91047),t(2160),t(99924),t(41390),t(58498),t(45371),t(49877),t(7969),t(69763),t(93804),t(18683),t(64604),t(29512),t(99063),t(56273),t(64752),t(48844),t(29208),t(94345),t(36533),t(84200),t(97827),t(91695),t(18169),t(20762),t(48402),t(16699),t(67504),t(92517),t(77037),t(90791),t(83637),t(47239),t(79875),t(30011),t(55270),t(50214),t(95779),t(13262),t(346),t(13317),t(93049),t(73600),t(88663),t(81284),t(78860),t(52731),t(26805),t(13983),t(58194),t(4734),t(27281),t(72393),t(17745),t(81272),t(44945),t(51961),t(62399),t(64995),t(33150),t(58173),t(66110),t(67520),t(27532),t(48103),t(65085),t(33611),t(84857),t(60373),t(98187),t(35902),t(13226),t(16794),t(52357),t(11090),t(49319),t(93546),t(29570),t(34592),t(79825),t(95101),t(67578),t(17857),t(82537),t(14896),t(95611),t(98089),t(91366),t(80473),t(43435),t(73435),t(4048),t(85232),t(93471),t(53252),t(34039),t(70061),t(3495),t(97906),t(64524),t(65023),t(31424),t(74676),t(2589),t(53610),t(29447),t(78273),t(49475),t(32368),t(7391),t(22529),t(43534),t(38094),t(67723),t(59858),t(63728),t(1178),t(7182),t(47788),t(19297),t(4157),t(62401),t(89322),t(20138),t(53370),t(46946),t(3816),t(73509),t(28276),t(69277),t(70580),t(75191),t(24319),t(62092),t(71992),t(80167),t(4478),t(91808),t(7161),t(55586),t(35121),t(92229),t(18344),t(64884),t(23351),t(51222),t(42870),t(67321),t(73067),t(54512),t(53103),t(19648),t(42948),t(76636),t(1739),t(66322),t(95637),t(59930),t(45862),t(72762),t(71613),t(78644),t(81618),t(17872),t(73597),t(43059),t(89935),t(49813),t(39236),t(11494),t(6801),t(41003),t(9380),t(91381),t(60027),t(57111),t(75651),t(88614),t(1030),t(15319),t(60785),t(56487),t(6399),t(9498),t(24079),t(38149),t(19681),t(40328),t(84539),t(65299),t(6510),t(38641),t(73502),t(19869),t(3827),t(65174),t(78328),t(23916),t(54616),t(25018),t(41740),t(49011),t(23787),t(22151),t(54912),t(83002),t(24330),t(91276),t(18527),t(62482),t(45476),t(4718),t(69310),t(43682),t(85351),t(54481),t(1535),t(9943),t(89253),t(16677),t(17813),t(3112),t(46626),t(45560),t(56303),t(85890),t(55884),t(32397),t(2810),t(89601),t(85472),t(79323),t(74148),t(3175),t(66959),t(78774),t(8884),t(38212),t(81095),t(4798),t(67470),t(25579),t(69660),t(85994),t(35935),t(23070),t(95717),t(968),t(85901),t(82458),t(37740),t(25329),t(82140),t(40988),t(42586),t(44370),t(18653),t(70534),t(45817),t(90509),t(71868),t(64102),t(8824),t(67315),t(8368),t(1985),t(31315),t(12119),t(13201),t(47215),t(47812),t(4335),t(99781),t(25643),t(56367),t(8904),t(29201),t(32826),t(98238),t(49755),t(54131),t(53065),t(20804),t(87357),t(25946),t(63834),t(19969),t(9207),t(58196),t(86941),t(89575),t(71895),t(27084),t(61904),t(21914),t(29755),t(97511),t(32264),t(68849),t(82842),t(10224),t(36309),t(62959),t(74159),t(90197),t(88730),t(6837),t(96625),t(38424),t(82454),t(78281),t(47387),t(46728),t(23439),t(98335),t(46935),t(96807),t(69448),t(35619),t(31175),t(38093),t(60408),t(59955),t(58396),t(20978),t(40558)},29023:(e,n,t)=>{t.d(n,{g:()=>a});var i=t(82408);function a(e,n){return null===e?n:new i.A({url:e.field("url")})}}}]);