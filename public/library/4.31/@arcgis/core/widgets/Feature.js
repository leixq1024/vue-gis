/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../intl.js";import{watch as t,initial as i,on as s}from"../core/reactiveUtils.js";import{property as r}from"../core/accessorSupport/decorators/property.js";import{cast as o}from"../core/accessorSupport/decorators/cast.js";import"../core/lang.js";import{subclass as n}from"../core/accessorSupport/decorators/subclass.js";import a from"./Widget.js";import"../chunks/Logger.js";import l from"./Attachments.js";import d,{F as p,a as c,b as u,c as m,d as h,e as y}from"./Feature/FeatureViewModel.js";import{H as v}from"../chunks/Heading.js";import{a as f}from"../chunks/widgetUtils.js";import{t as g,a as _}from"../chunks/jsxFactory.js";import{B as j}from"../chunks/featureUtils.js";import{isWidget as w,hasDomNode as b}from"./support/widget.js";import{g as M}from"../chunks/globalCss.js";import{a as k}from"../chunks/uriUtils.js";import{m as I}from"../chunks/messageBundle.js";import{p as C}from"../chunks/a11yUtils.js";import{getColorsFromRenderer as F}from"../renderers/support/utils.js";import{l as A}from"../chunks/componentsUtils.js";import{i as T}from"../chunks/themeUtils.js";import{s as x}from"../chunks/substitute.js";import{d as E}from"../chunks/maybe.js";import{after as S}from"../core/promiseUtils.js";import{F as L}from"../chunks/FeatureRelationshipViewModel.js";import{R}from"../chunks/ReactiveMap.js";import{f as U}from"../chunks/number.js";import{getFeaturePopupTitle as $}from"../support/popupUtils.js";import P from"../core/Accessor.js";import"../core/Error.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../config.js";import"../chunks/locale.js";import"../chunks/handleUtils.js";import"../chunks/datetime.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/JSONSupport.js";import"../chunks/utils.js";import"../core/Handles.js";import"../chunks/metadata.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../core/scheduling.js";import"../chunks/ensureType.js";import"../chunks/assets.js";import"../chunks/asyncUtils.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../chunks/domUtils.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/unitFormatUtils.js";import"../chunks/ByteSizeUnit.js";import"../chunks/Cyclical.js";import"../chunks/mathUtils.js";import"../chunks/quantityUtils.js";import"../chunks/unitUtils.js";import"./Attachments/AttachmentsViewModel.js";import"../Graphic.js";import"../geometry.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../chunks/reader.js";import"../geometry/SpatialReference.js";import"../chunks/writer.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/Axis.js";import"../chunks/extentUtils.js";import"../chunks/boundsUtils.js";import"../chunks/aaBoundingRect.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../geometry/support/jsonUtils.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../layers/support/fieldUtils.js";import"../core/sql.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../Color.js";import"../chunks/colorUtils.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/content/UtilityNetworkAssociationsContent.js";import"../popup/support/UtilityNetworkAssociationType.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../symbols.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils4.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../chunks/vec3f64.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/lineMarkers.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils5.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/aaBoundingBox.js";import"../symbols/Font.js";import"../symbols/IconSymbol3DLayer.js";import"../chunks/persistableUrlUtils.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../portal/PortalGroup.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MarkerSymbol.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../rest/query/support/AttachmentInfo.js";import"../rest/support/AttachmentQuery.js";import"../chunks/layerUtils.js";import"../chunks/utils3.js";import"../chunks/basemapUtils.js";import"../Basemap.js";import"../chunks/loadAll.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../support/BasemapStyle.js";import"../chunks/writeUtils.js";import"../chunks/utils2.js";import"../chunks/mat4.js";import"../chunks/common.js";import"../chunks/attachmentUtils.js";import"../chunks/legacyIcon.js";import"../chunks/throttle.js";import"../chunks/executeQueryJSON.js";import"../chunks/utils9.js";import"../chunks/query.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils10.js";import"../chunks/pbfQueryUtils.js";import"../chunks/pbf.js";import"../chunks/OptimizedGeometry.js";import"../chunks/OptimizedFeature.js";import"../chunks/OptimizedFeatureSet.js";import"../chunks/queryZScale.js";import"../chunks/zscale.js";import"../rest/support/FeatureSet.js";import"../layers/support/Field.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../chunks/fieldType.js";import"../rest/support/Query.js";import"../chunks/DataLayerSource.js";import"../chunks/FullTextSearch.js";import"../chunks/spatialRelationships.js";import"../rest/support/StatisticDefinition.js";import"../time/TimeExtent.js";import"../chunks/timeUtils.js";import"../rest/support/RelationshipQuery.js";import"../chunks/shared2.js";import"../chunks/TimeOnly.js";import"../chunks/UnknownTimeZone.js";import"../layers/FeatureLayer.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/sizeVariableUtils.js";import"../chunks/visualVariableUtils.js";import"../chunks/compilerUtils.js";import"../chunks/lengthUtils.js";import"../renderers/support/ClassBreakInfo.js";import"../chunks/commonProperties.js";import"../symbols/support/jsonUtils.js";import"../chunks/defaults.js";import"../chunks/defaultsJSON.js";import"../chunks/RendererLegendOptions.js";import"../renderers/DictionaryRenderer.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/Version2.js";import"../layers/support/FieldsIndex.js";import"../chunks/OverrideHelper.js";import"../chunks/colorUtils2.js";import"../chunks/vec4.js";import"../chunks/vec4f64.js";import"../chunks/utils7.js";import"../chunks/enums2.js";import"../chunks/quantizationUtils.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../renderers/PieChartRenderer.js";import"../renderers/SimpleRenderer.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../renderers/support/UniqueValue.js";import"../renderers/support/UniqueValueClass.js";import"../renderers/support/UniqueValueGroup.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils.js";import"../renderers/support/jsonUtils.js";import"../chunks/MultiOriginJSONSupport.js";import"../chunks/layerContainerType.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../form/elements/Element.js";import"../form/support/elements.js";import"../form/elements/AttachmentElement.js";import"../form/elements/inputs/attachments/AttachmentInput.js";import"../chunks/Input.js";import"../form/elements/inputs/attachments/support/inputs.js";import"../form/elements/inputs/attachments/AudioInput.js";import"../chunks/utils8.js";import"../form/elements/inputs/attachments/DocumentInput.js";import"../form/elements/inputs/attachments/ImageInput.js";import"../form/elements/inputs/attachments/SignatureInput.js";import"../form/elements/inputs/attachments/VideoInput.js";import"../form/elements/FieldElement.js";import"../form/elements/support/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DatePickerInput.js";import"../form/elements/inputs/DateTimeOffsetPickerInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../form/elements/inputs/TimePickerInput.js";import"../form/elements/RelationshipElement.js";import"../form/elements/TextElement.js";import"../chunks/formUtils.js";import"../layers/Layer.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../chunks/Queue.js";import"../core/workers/RemoteClient.js";import"../chunks/editsZScale.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../chunks/arcgisLayerUrl.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils.js";import"../chunks/parser.js";import"../layers/mixins/CustomParametersMixin.js";import"../chunks/EditBusLayer.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../layers/mixins/FeatureLayerBase.js";import"../geometry/HeightModelInfo.js";import"../chunks/commonProperties2.js";import"../chunks/ElevationInfo.js";import"../chunks/unitConversionUtils.js";import"../tables/AttributeTableTemplate.js";import"../tables/elements/AttributeTableGroupElement.js";import"../tables/elements/AttributeTableElement.js";import"../tables/support/elements.js";import"../tables/elements/AttributeTableAttachmentElement.js";import"../tables/elements/AttributeTableFieldElement.js";import"../tables/elements/AttributeTableRelationshipElement.js";import"../chunks/featureLayerUtils.js";import"../chunks/featureQueryAll.js";import"../layers/support/GeometryFieldsInfo.js";import"../layers/support/LayerFloorInfo.js";import"../layers/support/Relationship.js";import"../chunks/serviceCapabilitiesUtils.js";import"../layers/support/Subtype.js";import"../layers/mixins/FeatureReductionLayer.js";import"../layers/support/AggregateField.js";import"../layers/support/ExpressionInfo.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../chunks/clusterUtils.js";import"../chunks/MD5.js";import"../layers/mixins/OperationalLayer.js";import"../layers/mixins/OrderedLayer.js";import"../chunks/OrderByInfo.js";import"../layers/mixins/PortalLayer.js";import"../chunks/portalItemUtils.js";import"../geometry/projection.js";import"../chunks/projectBuffer.js";import"../chunks/geodesicConstants.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../layers/mixins/PublishableLayer.js";import"../layers/support/PublishingInfo.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/ScaleRangeLayer.js";import"../layers/mixins/TemporalLayer.js";import"../layers/support/TimeInfo.js";import"../time/TimeInterval.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../chunks/labelingInfo.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils2.js";import"../chunks/AlphaCutoff.js";import"../chunks/interfaces2.js";import"../chunks/typeUtils2.js";import"../rest/networks/support/Association.js";import"../rest/networks/support/NetworkElement.js";import"../chunks/featureFormUtils.js";import"../chunks/accessibleHandler.js";import"../chunks/vmEvent.js";import"../chunks/numberUtils.js";import"../chunks/utils12.js";import"../symbols/support/cimSymbolUtils.js";import"../chunks/colorRampUtils2.js";import"../chunks/utils15.js";const V="esri-feature-element-info",O={base:V,title:`${V}__title`,description:`${V}__description`};let N=class extends a{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return g("div",{class:O.base},this._renderTitle(),this._renderDescription())}_renderTitle(){const{title:e}=this;return e?g(v,{class:O.title,innerHTML:e,level:this.headingLevel}):null}_renderDescription(){const{description:e}=this;return e?g("div",{class:O.description,innerHTML:e,key:"description"}):null}};e([r()],N.prototype,"description",void 0),e([r()],N.prototype,"headingLevel",void 0),e([r()],N.prototype,"title",void 0),N=e([n("esri.widgets.Feature.support.FeatureElementInfo")],N);const D=N;let W=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new l,this.headingLevel=2,this.viewModel=new p}initialize(){this._featureElementInfo=new D,this.addHandles([t((()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),i),t((()=>this.viewModel),(e=>this.attachmentsWidget.viewModel=e),i)])}destroy(){this.attachmentsWidget.viewModel=null,this.attachmentsWidget.destroy(),this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){const{attachmentsWidget:e}=this;return g("div",{class:"esri-feature-attachments"},this._featureElementInfo?.render(),e?.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:i}=this;this._featureElementInfo?.set({description:e,title:t,headingLevel:i})}};e([r({readOnly:!0})],W.prototype,"attachmentsWidget",void 0),e([r()],W.prototype,"description",null),e([r()],W.prototype,"displayType",null),e([r()],W.prototype,"graphic",null),e([r()],W.prototype,"headingLevel",void 0),e([r()],W.prototype,"title",null),e([r({type:p})],W.prototype,"viewModel",void 0),W=e([n("esri.widgets.Feature.FeatureAttachments")],W);const B=W,H="esri-feature-content",z={base:H,loaderContainer:`${H}__loader-container`,loader:`${H}__loader`};let X=class extends a{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{j(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank")}))}}get creator(){return this.viewModel?.creator}set creator(e){this.viewModel&&(this.viewModel.creator=e)}get graphic(){return this.viewModel?.graphic}set graphic(e){this.viewModel&&(this.viewModel.graphic=e)}render(){const e=this.viewModel?.state;return g("div",{class:z.base},"loading"===e?this._renderLoading():this._renderCreated())}_renderLoading(){return g("div",{class:z.loaderContainer,key:"loader"},g("div",{class:z.loader}))}_renderCreated(){const e=this.viewModel?.created;return e?e instanceof HTMLElement?g("div",{afterCreate:this._attachToNode,bind:e,key:e}):w(e)?g("div",{key:e},!e.destroyed&&e.render()):g("div",{afterCreate:this._addTargetToAnchors,innerHTML:e,key:e}):null}_attachToNode(e){e.appendChild(this)}};e([r()],X.prototype,"creator",null),e([r()],X.prototype,"graphic",null),e([r({type:c})],X.prototype,"viewModel",void 0),X=e([n("esri.widgets.Feature.FeatureContent")],X);const q=X,Y="esri-feature-fields",Q={base:Y,fieldHeader:`${Y}__field-header`,fieldData:`${Y}__field-data`,fieldDataDate:`${Y}__field-data--date`};let K=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new u,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new D,this.addHandles(t((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),i))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return g("div",{class:Q.base},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(e,t){const{attributes:i}=this.viewModel,s=e.fieldName||"",r=e.label||s,o=i?null==i[s]?"":i[s]:"",n=!!e.format?.dateFormat,a="number"!=typeof o||n?k(this.messagesURIUtils,o):this._forceLTR(o),l={[Q.fieldDataDate]:n};return g("tr",{key:`fields-element-info-row-${s}-${t}`},g("th",{class:Q.fieldHeader,innerHTML:r,key:`fields-element-info-row-header-${s}-${t}`}),g("td",{class:this.classes(Q.fieldData,l),innerHTML:a,key:`fields-element-info-row-data-${s}-${t}`}))}_renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e?.length?g("table",{class:M.table,summary:this.messages.fieldsSummary},g("tbody",null,e.map(((e,t)=>this._renderFieldInfo(e,t))))):null}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo?.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};e([r()],K.prototype,"attributes",null),e([r()],K.prototype,"description",null),e([r()],K.prototype,"expressionInfos",null),e([r()],K.prototype,"fieldInfos",null),e([r()],K.prototype,"title",null),e([r({type:u,nonNullable:!0})],K.prototype,"viewModel",void 0),e([r(),I("esri/widgets/Feature/t9n/Feature")],K.prototype,"messages",void 0),e([r(),I("esri/widgets/support/t9n/uriUtils")],K.prototype,"messagesURIUtils",void 0),K=e([n("esri.widgets.Feature.FeatureFields")],K);const G=K,J="esri-feature-media",Z={base:J,mediaContainer:`${J}__container`,mediaItemContainer:`${J}__item-container`,mediaItem:`${J}__item`,mediaItemText:`${J}__item-text`,mediaItemTitle:`${J}__item-title`,mediaItemCaption:`${J}__item-caption`,mediaNavigation:`${J}__item-navigation`,mediaPagination:`${J}__pagination`,mediaPaginationText:`${J}__pagination-text`,mediaPrevious:`${J}__previous`,mediaPreviousIconLTR:`${J}__previous-icon`,mediaPreviousIconRTL:`${J}__previous-icon--rtl`,mediaNext:`${J}__next`,mediaNextIconLTR:`${J}__next-icon`,mediaNextIconRTL:`${J}__next-icon--rtl`,mediaChart:`${J}__chart`,mediaPaginationButton:`${J}__pagination-button`,mediaPaginationIcon:`${J}__pagination-icon`,mediaChartRendered:`${J}__chart--rendered`},ee="category",te="value";let ie=class extends a{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this._chartRootMap=new WeakMap,this.viewModel=new m,this.messages=null,this._disposeChart=e=>{this._chartRootMap.get(e)?.dispose(),this._chartRootMap.delete(e)},this._createChart=async e=>{const{destroyed:t,viewModel:i}=this;if(t||!i||!e)return;const{createRoot:s}=await import("../chunks/chartUtilsAm5.js").then((e=>e.a)),r=await s(e);this._chartRootMap.set(e,r),this._renderChart({mediaInfo:i.activeMediaInfo,root:r})}}initialize(){this._featureElementInfo=new D,this.addHandles([t((()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex]),(()=>this._setupMediaRefreshTimer()),i),t((()=>[this.viewModel?.description,this.viewModel?.title]),(()=>this._setupFeatureElementInfo()),i)])}loadDependencies(){return A({icon:()=>import("../chunks/calcite-icon.js")})}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return g("div",{bind:this,class:Z.base,onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const{formattedMediaInfoCount:e,activeMediaInfoIndex:t}=this.viewModel,i=this._renderMediaText();return e?g("div",{class:Z.mediaContainer,key:"media-element-container"},this._renderMediaInfo(),g("div",{class:Z.mediaNavigation},i,e>1?g("div",{class:Z.mediaPagination},this._renderMediaPageButton("previous"),g("span",{class:Z.mediaPaginationText},x(this.messages.pageText,{index:t+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e&&e.title?g("div",{class:Z.mediaItemTitle,innerHTML:e.title,key:"media-title"}):null,i=e&&e.caption?g("div",{class:Z.mediaItemCaption,innerHTML:e.caption,key:"media-caption"}):null;return t||i?g("div",{class:Z.mediaItemText,key:"media-text"},t,i):null}_renderImageMediaInfo(e){if(!e.value)return null;const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:s}=this.viewModel,{value:r,refreshInterval:o,altText:n,title:a,type:l}=e,{sourceURL:d,linkURL:p}=r,c=j(p??void 0)?"_blank":"_self",u="_blank"===c?"noreferrer":"",m=o?t:null,h=m?m.timestamp:0,y=m?m.sourceURL:d,v=g("img",{alt:n||a,key:`media-${l}-${i}-${s}-${h}`,src:y??void 0});return(p?g("a",{href:p,rel:u,target:c,title:a},v):null)??v}_renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return g("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:Z.mediaChart,key:`media-${e.type}-${t}-${i}`})}_renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;return e?g("div",{class:Z.mediaItemContainer,key:"media-container"},g("div",{class:Z.mediaItem,key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,s=t?"chevron-left":"chevron-right",r=t?"media-previous":"media-next",o=t?this._previous:this._next;return g("button",{"aria-label":i,bind:this,class:Z.mediaPaginationButton,key:r,onclick:o,tabIndex:0,title:i,type:"button"},g("calcite-icon",{class:Z.mediaPaginationIcon,icon:s,scale:"s"}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo?.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(!this.viewModel)return;const{isAggregate:e,layer:t}=this.viewModel;return e&&t?.featureReduction&&"renderer"in t.featureReduction?t.featureReduction.renderer:t?.renderer}async _getSeriesColors(e){const{colorAm5:t}=await import("../chunks/chartCommon.js"),i=new Map;return e.forEach((e=>{e.color&&i.set(e,t(e.color.toCss(!0)))})),i}async _getRendererColors(){const{colorAm5:e}=await import("../chunks/chartCommon.js"),t=new Map,i=this._getRenderer();if(!i)return t;const s=await F(i);return s.delete("default"),Array.from(s.values()).every((e=>1===e?.length))?(Array.from(s.keys()).forEach((i=>{const r=s.get(i)?.[0]?.toCss(!0);r&&t.set(i,e(r))})),t):t}_handleMediaKeyup(e){const{key:t}=e;"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return!!this.viewModel&&!!this.viewModel.abilities.chartAnimation&&!C()}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const{root:t,mediaInfo:i}=e,{value:s,type:r}=i,{ResponsiveThemeAm5:o,DarkThemeAm5:n,AnimatedThemeAm5:a,ColorSetAm5:l,ThemeAm5:d,esriChartColorSet:p}=await import("../chunks/chartCommon.js"),c=d.new(t);c.rule("ColorSet").set("colors",p),c.rule("ColorSet").set("reuse",!0);const u=[o.new(t),c];T()&&u.push(n.new(t)),this._canAnimateChart()&&u.push(a.new(t)),t.setThemes(u);const m=await this._getRendererColors(),h=await this._getSeriesColors(s.series),y=l.new(t,{}),v=h.get(s.series[0]),f=v?{lineSettings:{stroke:v}}:void 0,g=s.series.map(((e,t)=>{const i=h.get(e)||m.get(e.fieldName)||y.getIndex(t);return{[ee]:e.tooltip,[te]:e.value,columnSettings:{fill:i,stroke:i},...f}})).filter((e=>"pie-chart"!==r||null!=e.value&&e.value>0));"pie-chart"===r?this._createPieChart(e,g):this._createXYChart(e,g)}_getDirection(){return f(this.container)?"rtl":"ltr"}async _customizeChartTooltip(e,t="horizontal"){const{colorAm5:i}=await import("../chunks/chartCommon.js");e.setAll({pointerOrientation:t}),e.get("background")?.setAll({stroke:i("rgba(50, 50, 50, 1)")}),e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,t){const{TooltipAm5:i}=await import("../chunks/chartCommon.js"),{PieChartAm5:s,PieSeriesAm5:r}=await import("../chunks/pieChart.js"),{mediaInfo:o,root:n}=e,{title:a}=o,l=o?.altText||o?.title||"",d=n.container.children.push(s.new(n,{ariaLabel:l,focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5})),p="{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",c=i.new(n,{labelText:p}),u=d.series.push(r.new(n,{name:a,valueField:te,categoryField:ee,tooltip:c}));u.ticks.template.set("forceHidden",!0),u.labels.template.set("forceHidden",!0),u.slices.template.states.create("active",{shiftRadius:5}),this._customizeChartTooltip(c),u.slices.template.setAll({ariaLabel:p,focusable:!0,templateField:"columnSettings"}),u.data.setAll(t),u.appear(this._getChartSeriesAnimationMS()),d.appear(this._getChartAnimationMS()),d.root.dom.classList.toggle(Z.mediaChartRendered,!0)}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}async _createColumnChart(e,t,i){const{TooltipAm5:s,ScrollbarAm5:r}=await import("../chunks/chartCommon.js"),{CategoryAxisAm5:o,AxisRendererXAm5:n,ValueAxisAm5:a,AxisRendererYAm5:l,ColumnSeriesAm5:d}=await import("../chunks/xyChart.js"),{mediaInfo:p,root:c}=t,{value:u,title:m}=p;e.setAll({wheelX:"panX",wheelY:"zoomX"});const h=e.xAxes.push(o.new(c,{renderer:n.new(c,{inversed:f(this.container)}),categoryField:ee}));h.get("renderer").labels.template.setAll({forceHidden:!0});const y=e.yAxes.push(a.new(c,{renderer:l.new(c,{inside:!1}),min:this._getMinSeriesValue(u.series)}));y.get("renderer").labels.template.setAll({direction:this._getDirection()});const v="{categoryX}",g=s.new(c,{labelText:v}),_=e.series.push(d.new(c,{name:m,xAxis:h,yAxis:y,valueYField:te,categoryXField:ee,tooltip:g}));this._customizeChartTooltip(g),_.columns.template.setAll({ariaLabel:v,focusable:!0,templateField:"columnSettings"}),u.series.length>15&&e.set("scrollbarX",r.new(c,{orientation:"horizontal"})),h.data.setAll(i),_.data.setAll(i),_.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createBarChart(e,t,i){const{TooltipAm5:s,ScrollbarAm5:r}=await import("../chunks/chartCommon.js"),{CategoryAxisAm5:o,AxisRendererXAm5:n,ValueAxisAm5:a,AxisRendererYAm5:l,ColumnSeriesAm5:d}=await import("../chunks/xyChart.js"),{mediaInfo:p,root:c}=t,{value:u,title:m}=p;e.setAll({wheelX:"panY",wheelY:"zoomY"});const h=e.yAxes.push(o.new(c,{renderer:l.new(c,{inversed:!0}),categoryField:ee}));h.get("renderer").labels.template.setAll({forceHidden:!0});const y=e.xAxes.push(a.new(c,{renderer:n.new(c,{inside:!1,inversed:f(this.container)}),min:this._getMinSeriesValue(u.series)}));y.get("renderer").labels.template.setAll({direction:this._getDirection()});const v="{categoryY}",g=s.new(c,{labelText:v}),_=e.series.push(d.new(c,{name:m,xAxis:y,yAxis:h,valueXField:te,categoryYField:ee,tooltip:g}));this._customizeChartTooltip(g,"vertical"),_.columns.template.setAll({ariaLabel:v,focusable:!0,templateField:"columnSettings"}),u.series.length>15&&e.set("scrollbarY",r.new(c,{orientation:"vertical"})),h.data.setAll(i),_.data.setAll(i),_.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createLineChart(e,t,i){const{TooltipAm5:s,ScrollbarAm5:r}=await import("../chunks/chartCommon.js"),{CategoryAxisAm5:o,AxisRendererXAm5:n,ValueAxisAm5:a,AxisRendererYAm5:l,LineSeriesAm5:d}=await import("../chunks/xyChart.js"),{root:p,mediaInfo:c}=t,{value:u,title:m}=c;e.setAll({wheelX:"panX",wheelY:"zoomX"});const h=e.xAxes.push(o.new(p,{renderer:n.new(p,{inversed:f(this.container)}),categoryField:ee}));h.get("renderer").labels.template.setAll({forceHidden:!0});const y=e.yAxes.push(a.new(p,{renderer:l.new(p,{inside:!1}),min:this._getMinSeriesValue(u.series)}));y.get("renderer").labels.template.setAll({direction:this._getDirection()});const v=i[0]?.lineSettings?.stroke,g=s.new(p,{getFillFromSprite:!v,labelText:"{categoryX}"});v&&g.get("background")?.setAll({fill:v});const _=e.series.push(d.new(p,{name:m,xAxis:h,yAxis:y,valueYField:te,categoryXField:ee,tooltip:g}));_.strokes.template.setAll({templateField:"lineSettings"}),this._customizeChartTooltip(g,"vertical"),u.series.length>15&&e.set("scrollbarX",r.new(p,{orientation:"horizontal"})),h.data.setAll(i),_.data.setAll(i),_.appear(this._getChartSeriesAnimationMS()),e.appear(this._getChartAnimationMS())}async _createXYChart(e,t){const{XYChartAm5:i,XYCursorAm5:s}=await import("../chunks/xyChart.js"),{root:r,mediaInfo:o}=e,{type:n}=o,a=o?.altText||o?.title||"",l=r.container.children.push(i.new(r,{ariaLabel:a,focusable:!0,panX:!0,panY:!0}));l.set("cursor",s.new(r,{})),"column-chart"===n&&await this._createColumnChart(l,e,t),"bar-chart"===n&&await this._createBarChart(l,e,t),"line-chart"===n&&await this._createLineChart(l,e,t),l.root.dom.classList.toggle(Z.mediaChartRendered,!0)}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:e&&this._getImageSource(e,t)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;"image"===e?.type&&e?.refreshInterval>0&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e,s=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const r=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),s);this._refreshTimer=r}_getImageSource(e,t){const i=e.includes("?")?"&":"?",[s,r=""]=e.split("#");return`${s}${i}timestamp=${t}${r?"#":""}${r}`}};e([r()],ie.prototype,"_refreshIntervalInfo",void 0),e([r()],ie.prototype,"attributes",null),e([r()],ie.prototype,"activeMediaInfoIndex",null),e([r()],ie.prototype,"description",null),e([r()],ie.prototype,"fieldInfoMap",null),e([r()],ie.prototype,"layer",null),e([r()],ie.prototype,"mediaInfos",null),e([r()],ie.prototype,"popupTemplate",null),e([r()],ie.prototype,"relatedInfos",null),e([r()],ie.prototype,"title",null),e([r({type:m})],ie.prototype,"viewModel",void 0),e([r(),I("esri/widgets/Feature/t9n/Feature")],ie.prototype,"messages",void 0),ie=e([n("esri.widgets.Feature.FeatureMedia")],ie);const se=ie,re="esri-feature",oe={base:`${re}-expression`,loadingSpinnerContainer:`${re}__loading-container`};let ne=class extends a{constructor(e,t){super(e,t),this._contentWidget=null,this.viewModel=new h}initialize(){this.addHandles(t((()=>this.viewModel?.contentElementViewModel),(()=>this._setupExpressionWidget()),i))}loadDependencies(){return A({loader:()=>import("../chunks/calcite-loader.js")})}destroy(){this._destroyContentWidget()}render(){const{state:e}=this.viewModel;return g("div",{class:oe.base},"loading"===e?this._renderLoading():"disabled"===e?null:this._contentWidget?.render())}_renderLoading(){return g("div",{class:oe.loadingSpinnerContainer,key:"loading-container"},g("calcite-loader",{inline:!0,label:""}))}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,i=t?.type;this._destroyContentWidget();const s=e?"fields"===i?new G({viewModel:e}):"media"===i?new se({viewModel:e}):"text"===i?new q({viewModel:e}):null:null;this._contentWidget=s,this.scheduleRender()}};e([r({type:h})],ne.prototype,"viewModel",void 0),ne=e([n("esri.widgets.Feature.FeatureExpression")],ne);const ae=ne;var le;const de="esri-feature",pe=`${de}-relationship`,ce={base:pe,listContainer:`${pe}__list`,listItem:`${pe}__list-item`,listItemHidden:`${pe}__list-item--hidden`,listContainerQuerying:`${pe}__list--querying`,featureObserver:`${de}__feature-observer`,stickySpinnerContainer:`${de}__sticky-loading-container`,loadingSpinnerContainer:`${de}__loading-container`},ue={title:!0,description:!0};let me=le=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserverNode=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver((([e])=>{e?.isIntersecting&&this._increaseFeaturePage()}),{root:window.document}),this.flowItems=null,this.flowType="feature-relationship",this.headingLevel=2,this.viewModel=new L,this.messages=null,this.messagesCommon=null,this.visibleElements={...ue},this._increaseFeaturePage=()=>{const{state:e,showAllEnabled:t,relatedFeatures:i,featuresPerPage:s,featurePage:r}=this.viewModel;"ready"===e&&t&&i.length>=s*r&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new D,this.addHandles([t((()=>[this.viewModel.description,this.viewModel.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),i),t((()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode]),(()=>this._handleRelatedFeatureObserverChange())),s((()=>this.viewModel.relatedFeatureViewModels),"change",(()=>this._setupRelatedFeatureViewModels()))])}loadDependencies(){return A({icon:()=>import("../chunks/calcite-icon.js"),list:()=>import("../chunks/calcite-list.js"),"list-item":()=>import("../chunks/calcite-list-item.js"),loader:()=>import("../chunks/calcite-loader.js"),notice:()=>import("../chunks/calcite-notice.js")})}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=E(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:i,state:s}=this.viewModel;return!e&&!!t&&"ready"===s&&(t>i||0===i)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return x(e?.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...ue,...e}}render(){const{state:e}=this.viewModel;return g("div",{class:this.classes(ce.base,M.widget)},this._featureElementInfo?.render(),"loading"===e?this._renderLoading():"disabled"===e?this._renderRelationshipNotFound():this._renderRelatedFeatures())}async _selectRecord(e){const{flowItems:t,featureVisibleElements:i}=this;if(!t)return;e.abilities={relationshipContent:!0};const{default:s}=await Promise.resolve().then((()=>Re));t.push(new s({flowItems:t,flowType:this.flowType,viewModel:e,visibleElements:i}))}_showAllRecords(){const{flowItems:e}=this;if(!e)return;const{viewModel:t,featureVisibleElements:i}=this;t.showAllEnabled=!0;const s=new le({flowItems:e,featureVisibleElements:i,visibleElements:{title:!1,description:!1},viewModel:t});e.push(s)}_renderStickyLoading(){return"querying"===this.viewModel.state?g("div",{class:ce.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return g("calcite-loader",{inline:!0,label:""})}_renderLoading(){return g("div",{class:ce.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return g("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const e=f(this.container)?"chevron-left":"chevron-right";return g("calcite-icon",{icon:e,scale:"s",slot:"content-end"})}_renderRelatedFeature(e){const{itemDescriptionFieldName:t}=this.viewModel,i=e.title;e.description=t&&e.formattedAttributes?.global[t];const s="loading"===e.state;return g("calcite-list-item",{class:this.classes(ce.listItem,{[ce.listItemHidden]:s}),description:e.description??"",key:e.uid,label:i,onCalciteListItemSelect:()=>this._selectRecord(e)},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?g("calcite-list-item",{description:this.featureCountDescription,key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this._showAllRecords()},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return g("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},g("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return g("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:ce.featureObserver,key:"feature-observer"})}_renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return g("calcite-list",null,e.toArray().map((e=>this._renderRelatedFeature(e))),this._renderShowAllListItem())}_renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return g("div",{class:this.classes(ce.listContainer,{[ce.listContainerQuerying]:"querying"===t}),key:"list-container"},e?this._renderList():"ready"===t?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return g("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},g("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,s="related-feature-viewmodels";this.removeHandles(s),e?.forEach((e=>{this.addHandles(t((()=>[e.title,e.state]),(()=>this.scheduleRender()),i),s)})),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,i=t.description&&this.description,s=t.title&&this.title;this._featureElementInfo?.set({description:i,title:s,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await S(0),this._relatedFeatureIntersectionObserverNode&&"ready"===e&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};e([r()],me.prototype,"_relatedFeatureIntersectionObserverNode",void 0),e([r({readOnly:!0})],me.prototype,"displayShowAllButton",null),e([r({readOnly:!0})],me.prototype,"displayListItems",null),e([r()],me.prototype,"description",null),e([r({readOnly:!0})],me.prototype,"featureCountDescription",null),e([r()],me.prototype,"featureVisibleElements",void 0),e([r()],me.prototype,"flowItems",void 0),e([r()],me.prototype,"flowType",void 0),e([r()],me.prototype,"headingLevel",void 0),e([r()],me.prototype,"title",null),e([r({type:L})],me.prototype,"viewModel",void 0),e([r(),I("esri/widgets/Feature/t9n/Feature")],me.prototype,"messages",void 0),e([r(),I("esri/t9n/common")],me.prototype,"messagesCommon",void 0),e([r()],me.prototype,"visibleElements",void 0),e([o("visibleElements")],me.prototype,"castVisibleElements",null),me=le=e([n("esri.widgets.Feature.FeatureRelationship")],me);const he=me;let ye=class extends P{constructor(e){super(e),this.title=!0,this.description=!0}};e([r({type:Boolean,nonNullable:!0})],ye.prototype,"title",void 0),e([r({type:Boolean,nonNullable:!0})],ye.prototype,"description",void 0),ye=e([n("esri.widgets.Feature.FeatureUtilityNetworkAssociations.VisibleElements")],ye);const ve=ye;var fe;const ge="esri-feature",_e=`${ge}-relationship`,je={base:_e,listContainer:`${_e}__list`,listItem:`${_e}__list-item`,listItemHidden:`${_e}__list-item--hidden`,listContainerQuerying:`${_e}__list--querying`,featureObserver:`${ge}__feature-observer`,stickySpinnerContainer:`${ge}__sticky-loading-container`,loadingSpinnerContainer:`${ge}__loading-container`,expander:`${_e}__expander`,filterContainer:`${ge}__filter-container`};let we=fe=class extends a{constructor(e,t){super(e,t),this.flowType="feature-utility-network-association-type",this.description=null,this.headingLevel=2,this.title=null,this.viewModel=new y,this.parentFeatureViewModel=null,this.listType=null,this.selectedLayer=null,this.flowItems=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new ve,this._featuresPerPage=50,this._maxNumFeatures=1e3,this._currentFeaturePage=1,this._previewDisplayCount=3,this._associatedFeatureIntersectionObserverNode=null,this._associatedFeatureIntersectionObserver=new IntersectionObserver((([e])=>{e?.isIntersecting&&this._increaseFeaturePage()}),{root:window.document}),this._tooltipReferenceMap=new R,this._filterText=""}initialize(){this.addHandles([t((()=>[this._associatedFeatureIntersectionObserverNode]),(()=>this._handleAssociatedFeatureObserverChange()))])}loadDependencies(){return A({chip:()=>import("../chunks/calcite-chip.js"),icon:()=>import("../chunks/calcite-icon.js"),input:()=>import("../chunks/calcite-input.js"),loader:()=>import("../chunks/calcite-loader.js"),list:()=>import("../chunks/calcite-list.js"),"list-item":()=>import("../chunks/calcite-list-item.js"),tooltip:()=>import("../chunks/calcite-tooltip.js")})}destroy(){this._tooltipReferenceMap.clear()}get _numAssociatedFeatures(){const e=this.viewModel.associationViewModels;return this.selectedLayer?e.get(this.selectedLayer).length:0}set currentFeaturePage(e){const{_featuresPerPage:t,_numAssociatedFeatures:i}=this,s=Math.ceil(i/t)||1;this._currentFeaturePage=Math.max(Math.min(e,s),1)}get currentFeaturePage(){return this._currentFeaturePage}render(){const e=this.viewModel.associationViewModels,{state:t,showAllEnabled:i}=this.viewModel,{state:s}=this.parentFeatureViewModel??{};return g("div",{class:this.classes(je.base,M.widget)},"loading"===t||"querying"===t||"loading"===s?this._renderLoading():g("calcite-list",null,i&&this.selectedLayer?g(_,null,this._renderFilter(),this._renderAssociatedFeatureListPage(),this._renderFeatureObserver()):Array.from(e.keys(),(t=>this._renderTypeList(t,e.get(t))))))}_renderFilter(){return g("div",{class:je.filterContainer,key:"filter"},g("calcite-input",{icon:"search",placeholder:this.messages.associationFilterPlaceholder,type:"search",onCalciteInputInput:e=>{this._filterText=e.target.value.trim().toLowerCase(),this._currentFeaturePage=1}}))}_showAllAssociations(e){const{flowItems:t,viewModel:i,description:s}=this;if(!t||!e)return;i.showAllEnabled=!0;const r=new fe({selectedLayer:e,title:e?.title,flowItems:t,parentFeatureViewModel:this.parentFeatureViewModel,featureVisibleElements:this.featureVisibleElements,description:s,visibleElements:{title:!1,description:!1},viewModel:i});t.push(r)}_renderAssociatedFeatureListPage(){const{currentFeaturePage:e,_featuresPerPage:t,_maxNumFeatures:i,_filterText:s}=this,r=Math.min(e*t,i),o=this.viewModel.associationViewModels.get(this.selectedLayer).filter((e=>$(e.featureViewModel).toLowerCase().includes(s))).slice(0,r);return[...this._renderTooltips(o),...this._renderAssociatedFeatureList(o)]}async _handleAssociatedFeatureObserverChange(){this._associatedFeatureIntersectionObserverNode&&this._associatedFeatureIntersectionObserver.unobserve(this._associatedFeatureIntersectionObserverNode);const{state:e,showAllEnabled:t}=this.viewModel;await S(0),this._associatedFeatureIntersectionObserverNode&&"ready"===e&&t&&this._associatedFeatureIntersectionObserver.observe(this._associatedFeatureIntersectionObserverNode)}_associatedFeatureIntersectionObserverCreated(e){this._associatedFeatureIntersectionObserverNode=e}_renderFeatureObserver(){return g("div",{afterCreate:this._associatedFeatureIntersectionObserverCreated,bind:this,class:je.featureObserver,key:"feature-observer"})}_increaseFeaturePage(){this.currentFeaturePage++}_renderLoading(){return g("div",{class:je.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderLoadingIcon(){return g("calcite-loader",{inline:!0,label:""})}isConnectivity(e){return["connectivity","junction-junction-connectivity","junction-edge-from-connectivity","junction-midspan-connectivity","junction-edge-to-connectivity"].includes(e.association.associationType)}_getConnectivityTooltip(e){switch(e){case"connectivity":case"junction-junction-connectivity":return this.messages.associationsJunctionJunction;case"junction-edge-from-connectivity":return this.messages.associationsJunctionEdgeFrom;case"junction-midspan-connectivity":return this.messages.associationsJunctionEdgeMidspan;case"junction-edge-to-connectivity":return this.messages.associationsJunctionEdgeTo;default:return""}}_renderItemTooltip(e){const{_tooltipReferenceMap:t}=this;return this.isConnectivity(e)?g("calcite-tooltip",{key:`tooltip-${e.featureViewModel.uid}`,referenceElement:t.get(e.featureViewModel.uid)},this._getConnectivityTooltip(e.association.associationType)):null}_renderConnectivityIcon(e,t){let i;switch(e){case"junction-edge-from-connectivity":i="connection-end-left";break;case"junction-edge-to-connectivity":i="connection-end-right";break;case"junction-midspan-connectivity":i="connection-middle";break;default:i="connection-to-connection"}return g("calcite-icon",{afterCreate:e=>this._tooltipReferenceMap.set(t,e),afterRemoved:()=>this._tooltipReferenceMap.delete(t),icon:i,scale:"s",slot:"content-start"})}_formatPercentAlong(e){return`${U(e.association.percentAlong,{style:"percent",maximumFractionDigits:2})}`}_renderAssociatedFeature(e){const{featureViewModel:t}=e,i=$(t),s="loading"===t.state,r=this._findFlowItem(t),o=r<0&&this._isParentFeature(t),n=o||r>=0,a=this.isConnectivity(e),l=a&&"junction-midspan-connectivity"===e.association.associationType;return g("calcite-list-item",{class:this.classes(je.listItem,{[je.listItemHidden]:s}),description:e.terminalName??"",key:`associated-feature-type-${t.uid}`,label:i,onCalciteListItemSelect:()=>this._handleFeatureClick(o,r,t)},a?this._renderConnectivityIcon(e.association.associationType,e.featureViewModel.uid):null,l?g("calcite-chip",{scale:"s",slot:"content-end",value:e.association.percentAlong},this._formatPercentAlong(e)):null,this._renderChevronIconNode(n))}async _selectAssociation(e){const{flowItems:t,featureVisibleElements:i}=this;if(!t)return;e.abilities={utilityNetworkAssociationsContent:!0};const{default:s}=await Promise.resolve().then((()=>Re));t.push(new s({flowItems:t,flowType:"feature-association",viewModel:e,visibleElements:i}))}_handleFeatureClick(e,t,i){if(e)this.flowItems.drain((e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()}));else if(t<0||!this.flowItems)this._selectAssociation(i);else for(;this.flowItems.length>t+1;){const e=this.flowItems.pop();e&&("showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy())}}_featureViewModelMatch(e,t){const i=e.graphic,s=i?.layer;let r=null;"subtype-sublayer"===s?.type&&s.parent?r=s.parent.globalIdField??null:s&&"globalIdField"in s&&(r=s.globalIdField);const o=r?i?.attributes[r]:null,n=t.graphic,a=n?.layer;let l=null;"subtype-sublayer"===a?.type&&a.parent?l=a.parent.globalIdField??null:a&&"globalIdField"in a&&(l=a.globalIdField);const d=l?n?.attributes[l]:null;return o&&d&&o===d}_isParentFeature(e){const t=this.flowItems?.getItemAt(0);if(!t)return!1;const i=t.parentFeatureViewModel;return this._featureViewModelMatch(i,e)}_findFlowItem(e){return this.flowItems?.findIndex((t=>{if("feature"!==t.flowType)return!1;const i=t.viewModel;return this._featureViewModelMatch(i,e)}))??-1}_renderTooltips(e){return e.toArray().map((e=>this._renderItemTooltip(e)))}_renderAssociatedFeatureList(e){return e.toArray().map((e=>this._renderAssociatedFeature(e)))}_renderChevronIconNode(e){return g("calcite-icon",{flipRtl:!0,icon:e?"move-up":"chevron-right",scale:"s",slot:"content-end"})}_renderTypeList(e,t){const{messages:i}=this,s=t.slice(0,this._previewDisplayCount),r=s.length<t.length;return g("calcite-list-item",{key:"show-all",label:e.title,open:!0,value:e.id},g("calcite-chip",{scale:"s",slot:"actions-end",value:e.id},t.length),g("calcite-list",{group:e.id},[this._renderTooltips(s),this._renderAssociatedFeatureList(s)],r?g("calcite-list-item",{description:x(i?.numberRecords,{number:t.length.toString()}),key:"show-all-item",label:i.showAll,onCalciteListItemSelect:()=>this._showAllAssociations(e)},g("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})):null))}};e([r()],we.prototype,"flowType",void 0),e([r()],we.prototype,"description",void 0),e([r()],we.prototype,"headingLevel",void 0),e([r()],we.prototype,"title",void 0),e([r({type:y})],we.prototype,"viewModel",void 0),e([r()],we.prototype,"parentFeatureViewModel",void 0),e([r()],we.prototype,"listType",void 0),e([r()],we.prototype,"selectedLayer",void 0),e([r()],we.prototype,"featureVisibleElements",void 0),e([r()],we.prototype,"flowItems",void 0),e([r(),I("esri/widgets/Feature/t9n/Feature")],we.prototype,"messages",void 0),e([r(),I("esri/t9n/common")],we.prototype,"messagesCommon",void 0),e([r({type:ve,nonNullable:!0})],we.prototype,"visibleElements",void 0),e([r()],we.prototype,"_featuresPerPage",void 0),e([r()],we.prototype,"_maxNumFeatures",void 0),e([r()],we.prototype,"_numAssociatedFeatures",null),e([r()],we.prototype,"_currentFeaturePage",void 0),e([r()],we.prototype,"currentFeaturePage",null),e([r()],we.prototype,"_previewDisplayCount",void 0),e([r()],we.prototype,"_associatedFeatureIntersectionObserverNode",void 0),e([r()],we.prototype,"_tooltipReferenceMap",void 0),e([r()],we.prototype,"_filterText",void 0),we=fe=e([n("esri.widgets.Feature.FeatureUtilityNetworkAssociationType")],we);const be=we,Me="esri-feature",ke=`${Me}-relationship`,Ie={base:ke,listContainer:`${ke}__list`,listItem:`${ke}__list-item`,listItemHidden:`${ke}__list-item--hidden`,listContainerQuerying:`${ke}__list--querying`,featureObserver:`${Me}__feature-observer`,stickySpinnerContainer:`${Me}__sticky-loading-container`,loadingSpinnerContainer:`${Me}__loading-container`,expander:`${ke}__expander`};let Ce=class extends a{constructor(e,t){super(e,t),this._featureElementInfo=null,this.flowType="feature-utility-network-associations",this.flowItems=null,this.parentFeatureViewModel=null,this.headingLevel=2,this.viewModel=new y,this.messages=null,this.messagesCommon=null,this.visibleElements=new ve}initialize(){this._featureElementInfo=new D,this.addHandles([t((()=>[this.viewModel.description,this.viewModel.title,this.headingLevel]),(()=>this._setupFeatureElementInfo()),i)])}loadDependencies(){return A({chip:()=>import("../chunks/calcite-chip.js"),icon:()=>import("../chunks/calcite-icon.js"),loader:()=>import("../chunks/calcite-loader.js"),notice:()=>import("../chunks/calcite-notice.js"),list:()=>import("../chunks/calcite-list.js"),"list-item":()=>import("../chunks/calcite-list-item.js")})}destroy(){this._featureElementInfo=E(this._featureElementInfo)}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){const{state:e}=this.viewModel;return g("div",{class:this.classes(Ie.base,M.widget)},this._featureElementInfo?.render(),"loading"===e?this._renderLoading():"disabled"===e?this._renderAssociationNotFound():this._renderContent())}_renderStickyLoading(){return"querying"===this.viewModel.state?g("div",{class:Ie.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return g("calcite-loader",{inline:!0,label:""})}_renderLoading(){return g("div",{class:Ie.loadingSpinnerContainer,key:"loading-container"},this._renderLoadingIcon())}_renderAssociationNotFound(){return g("calcite-notice",{icon:"exclamation-mark-triangle",key:"association-not-found",kind:"danger",open:!0,scale:"s",width:"full"},g("div",{slot:"message"},this.messages?.noAssociations))}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,i=t.description&&this.description,s=t.title&&this.title;this._featureElementInfo?.set({description:i,title:s,headingLevel:e})}_getAssociationTypeTitle(e){const{messages:t}=this;if(e.title)return e.title;switch(e.type){case"attachment":return t.associationsAttachments;case"connectivity":return t.associationsConnectivity;case"structure":return t.associationsStructure;case"content":return t.associationsContents;case"container":return t.associationsContainer}}_selectAssociationType(e){const{viewModel:t,flowItems:i,parentFeatureViewModel:s}=this;if(!i)return;const{associationTypes:r}=t;r.forEach((t=>{t.type===e.type?t.open=!0:t.open=!1}));const o=new be({viewModel:t,parentFeatureViewModel:s,listType:e,title:this._getAssociationTypeTitle(e),featureVisibleElements:this.featureVisibleElements,description:this.parentFeatureViewModel?.title,flowItems:i});i.push(o)}_renderAssociationType(e){const t=this._getAssociationTypeTitle(e);return g("calcite-list-item",{description:e.description,key:`association-type-${e.type}`,label:t,value:e.type,onCalciteListItemSelect:()=>this._selectAssociationType(e)},g("calcite-chip",{scale:"s",slot:"content-end",value:e.type},this._getFeatureCount(e.type)),g("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_getFeatureCount(e){switch(e){case"attachment":return this.viewModel.attachmentsFeatureCount;case"structure":return this.viewModel.structureFeatureCount;case"content":return this.viewModel.contentFeatureCount;case"container":return this.viewModel.containerFeatureCount;case"connectivity":return this.viewModel.connectivityFeatureCount}}_renderAssociations(e){return g("div",null,this._getFeatureCount(e.type)>0?this._renderAssociationType(e):null)}_renderContent(){const{state:e,associationTypes:t}=this.viewModel;return g("div",{class:this.classes(Ie.listContainer,{[Ie.listContainerQuerying]:"querying"===e}),key:"list-container"},"ready"===e?g("calcite-list",null,t.map((e=>this._renderAssociations(e)))):null,this._renderStickyLoading())}};e([r()],Ce.prototype,"flowType",void 0),e([r()],Ce.prototype,"flowItems",void 0),e([r()],Ce.prototype,"parentFeatureViewModel",void 0),e([r()],Ce.prototype,"featureVisibleElements",void 0),e([r()],Ce.prototype,"description",null),e([r()],Ce.prototype,"headingLevel",void 0),e([r()],Ce.prototype,"title",null),e([r({type:y})],Ce.prototype,"viewModel",void 0),e([r(),I("esri/widgets/Feature/t9n/Feature")],Ce.prototype,"messages",void 0),e([r(),I("esri/t9n/common")],Ce.prototype,"messagesCommon",void 0),e([r({type:ve,nonNullable:!0})],Ce.prototype,"visibleElements",void 0),Ce=e([n("esri.widgets.Feature.FeatureUtilityNetworkAssociations")],Ce);const Fe=Ce,Ae="esri-feature",Te={base:Ae,container:`${Ae}__size-container`,title:`${Ae}__title`,main:`${Ae}__main-container`,btn:`${Ae}__button`,icon:`${Ae}__icon`,content:`${Ae}__content`,contentNode:`${Ae}__content-node`,contentNodeText:`${Ae}__content-node--text`,contentElement:`${Ae}__content-element`,text:`${Ae}__text`,lastEditedInfo:`${Ae}__last-edited-info`,fields:`${Ae}__fields`,fieldHeader:`${Ae}__field-header`,fieldData:`${Ae}__field-data`,fieldDataDate:`${Ae}__field-data--date`,loadingSpinnerContainer:`${Ae}__loading-container`},xe=t=>{let i=class extends t{constructor(){super(...arguments),this.renderNodeContent=e=>w(e)&&!e.destroyed?g("div",{class:Te.contentNode,key:e},e.render()):e instanceof HTMLElement?g("div",{afterCreate:this._attachToNode,bind:e,class:Te.contentNode,key:e}):b(e)?g("div",{afterCreate:this._attachToNode,bind:e.domNode,class:Te.contentNode,key:e}):null}_attachToNode(e){e.appendChild(this)}};return i=e([n("esri.widgets.Feature.support.FeatureContentMixin")],i),i},Ee={title:!0,content:!0,lastEditedInfo:!0};let Se=class extends(xe(a)){constructor(e,t){super(e,t),this._contentWidgets=[],this.flowType="feature",this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.visibleElements={...Ee},this.viewModel=new d}initialize(){this.addHandles(t((()=>this.viewModel?.contentViewModels),(()=>this._setupContentWidgets()),i))}loadDependencies(){return A({notice:()=>import("../chunks/calcite-notice.js"),loader:()=>import("../chunks/calcite-loader.js")})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get isTable(){return this.viewModel.isTable}get icon(){return"polygon"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get title(){return this.viewModel.title}castVisibleElements(e){return{...Ee,...e}}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}setActiveMedia(e,t){return this.viewModel.setActiveMedia(e,t)}nextMedia(e){return this.viewModel.nextMedia(e)}previousMedia(e){return this.viewModel.previousMedia(e)}render(){const{state:e}=this.viewModel,t=g("div",{class:Te.container,key:"container"},this._renderTitle(),"error"===e?this._renderError():"loading"===e?this._renderLoading():this._renderContentContainer());return g("div",{class:this.classes(Te.base,M.widget)},t)}_renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return g("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},i.title?g("div",{key:"error-title",slot:"title"},e.errorMessage):null,g("div",{key:"error-message",slot:"message"},t.loadingError))}_renderLoading(){return g("div",{class:Te.loadingSpinnerContainer,key:"loading-container"},g("calcite-loader",{inline:!0,label:""}))}_renderContentContainer(){const{visibleElements:e}=this;return e.content?g("div",{class:Te.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const{visibleElements:e,title:t}=this;return e.title?g(v,{class:Te.title,innerHTML:t,level:this.headingLevel}):null}_renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?g("div",{class:Te.contentNode,key:`${t}-content-elements`},e.map(this._renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return!e||e.destroyed?null:g("div",{class:this.classes(Te.contentNode,Te.contentNodeText),key:`${t}-content`},e.render())}return this.renderNodeContent(e)}_renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content?.[e.type])return null;switch(e.type){case"attachments":return this._renderAttachments(t);case"custom":return this._renderCustom(e,t);case"fields":return this._renderFields(t);case"media":return this._renderMedia(t);case"text":return this._renderText(e,t);case"expression":return this._renderExpression(t);case"relationship":return this._renderRelationship(t);case"utility-network-associations":return this._renderAssociation(t);default:return null}}_renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return"loading"===i||s.length>0?g("div",{class:this.classes(Te.contentElement),key:this._buildKey("attachments-element",e)},t.render()):null}_renderRelationship(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?g("div",{class:Te.contentElement,key:this._buildKey("relationship-element",e)},t.render()):null}_renderAssociation(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&this.flowItems?g("div",{class:Te.contentElement,key:this._buildKey("utility-network-association-element",e)},t.render()):null}_renderExpression(e){const t=this._contentWidgets[e];return t&&!t.destroyed&&t.viewModel.contentElement?g("div",{class:Te.contentElement,key:this._buildKey("expression-element",e)},t.render()):null}_renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return!s||s.destroyed?null:i?g("div",{class:Te.contentElement,key:this._buildKey("custom-element",t)},s.render()):null}_renderFields(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:g("div",{class:Te.contentElement,key:this._buildKey("fields-element",e)},t.render())}_renderMedia(e){const t=this._contentWidgets[e];return!t||t.destroyed?null:g("div",{class:Te.contentElement,key:this._buildKey("media-element",e)},t.render())}_renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:r}=i,o="edit"===i.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,n=x(o,{date:s,user:r});return g("div",{class:this.classes(Te.lastEditedInfo,Te.contentElement),key:"edit-info-element"},n)}_renderText(e,t){const i=e.text,s=this._contentWidgets[t];return!s||s.destroyed?null:i?g("div",{class:this.classes(Te.contentElement,Te.text),key:this._buildKey("text-element",t)},s.render()):null}_buildKey(e,...t){return`${e}__${this.viewModel?.graphic?.uid||"0"}-${t.join("-")}`}_destroyContentWidget(e){e&&(e.viewModel=null,!e.destroyed&&e.destroy())}_destroyContentWidgets(){this._contentWidgets.forEach((e=>this._destroyContentWidget(e))),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t,flowItems:i,viewModel:s}=this,r=s?.content,{contentViewModels:o}=s;if(Array.isArray(r))r.forEach(((r,n)=>{if("attachments"===r.type&&(this._contentWidgets[n]=new B({displayType:r.displayType,headingLevel:t.title&&e<6?e+1:e,viewModel:o[n]})),"fields"===r.type&&(this._contentWidgets[n]=new G({viewModel:o[n]})),"media"===r.type&&(this._contentWidgets[n]=new se({viewModel:o[n]})),"text"===r.type&&(this._contentWidgets[n]=new q({viewModel:o[n]})),"custom"===r.type&&(this._contentWidgets[n]=new q({viewModel:o[n]})),"expression"===r.type&&(this._contentWidgets[n]=new ae({viewModel:o[n]})),"relationship"===r.type){const e=new he({flowItems:i,featureVisibleElements:t,viewModel:o[n]});this._contentWidgets[n]=e}if("utility-network-associations"===r.type){const e=new Fe({flowItems:i,parentFeatureViewModel:s,featureVisibleElements:t,viewModel:o[n]});this._contentWidgets[n]=e}}),this);else{const e=o[0];e&&!e.destroyed&&(this._contentWidgets[0]=new q({viewModel:e}))}this.scheduleRender()}};e([r()],Se.prototype,"flowType",void 0),e([r()],Se.prototype,"graphic",null),e([r()],Se.prototype,"defaultPopupTemplateEnabled",null),e([r()],Se.prototype,"flowItems",void 0),e([r()],Se.prototype,"headingLevel",void 0),e([r({readOnly:!0})],Se.prototype,"isTable",null),e([r()],Se.prototype,"icon",null),e([r()],Se.prototype,"label",null),e([r()],Se.prototype,"location",null),e([r(),I("esri/widgets/Feature/t9n/Feature")],Se.prototype,"messages",void 0),e([r(),I("esri/t9n/common")],Se.prototype,"messagesCommon",void 0),e([r()],Se.prototype,"spatialReference",null),e([r()],Se.prototype,"timeZone",null),e([r({readOnly:!0})],Se.prototype,"title",null),e([r()],Se.prototype,"visibleElements",void 0),e([o("visibleElements")],Se.prototype,"castVisibleElements",null),e([r()],Se.prototype,"map",null),e([r()],Se.prototype,"view",null),e([r({type:d})],Se.prototype,"viewModel",void 0),Se=e([n("esri.widgets.Feature")],Se);const Le=Se,Re=Object.freeze(Object.defineProperty({__proto__:null,default:Le},Symbol.toStringTag,{value:"Module"}));export{xe as F,Te as c,Le as default};
