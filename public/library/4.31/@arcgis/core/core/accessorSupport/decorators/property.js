/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
import{L as t}from"../../../chunks/Logger.js";import{h as r,b as n,i as e,j as s,k as o,l as i,m as a,n as c,o as u,p as f,e as l}from"../../../chunks/ensureType.js";import{p,g,i as y}from"../../../chunks/utils.js";import{g as d,m}from"../../../chunks/metadata.js";import h from"../../Error.js";import{h as j}from"../../lang.js";import"../../../config.js";import"../../../chunks/handleUtils.js";function v(t,r){const n="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=r.getItemAt||Array.isArray(r)){const t=parseInt(n,10);if(!isNaN(t))return Array.isArray(r)?r[t]:r.at(t)}const e=g(r);return y(e,n)?e.get(n):r[n]}function w(t,r,n){if(null==t)return t;const e=v(r[n],t);return!e&&n<r.length-1?void 0:n===r.length-1?e:w(e,r,n+1)}function A(t,r,n=0){return"string"!=typeof r||r.includes(".")?w(t,p(r),n):v(r,t)}function O(t,r){return A(t,r)}function k(t,r){return void 0!==A(r,t)}function b(t,r,n){if(t&&r)if("object"==typeof r)for(const n of Object.getOwnPropertyNames(r))b(t,n,r[n]);else{if(r.includes(".")){const e=r.split("."),s=e.splice(-1,1)[0];return void b(O(t,e),s,n)}const e=t.__accessor__;null!=e&&function(t,r){if(j("esri-unknown-property-errors")&&!function(t,r){return null!=r.metadata[t]}(t,r))throw new h("set:unknown-property",function(t,r){return"setting unknown property '"+t+"' on instance of "+r.host.declaredClass}(t,r))}(r,e),t[r]=n}}function _(p={}){return(g,y)=>{if(g===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${g.name}.${y}. Accessor does not support static properties.`);const h=Object.getOwnPropertyDescriptor(g,y),j=d(g,y);h&&(h.get||h.set?(j.get=h.get||j.get,j.set=h.set||j.set):"value"in h&&("value"in p&&t.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${y}" on "${g.constructor.name}" already defined in the metadata`,p),j.value=p.value=h.value)),null!=p.readOnly&&(j.readOnly=p.readOnly);const v=p.aliasOf;if(v){const t="string"==typeof v?v:v.source,r="string"==typeof v?null:!0===v.overridable;let n;j.dependsOn=[t],j.get=function(){let r=O(this,t);if("function"==typeof r){n||(n=t.split(".").slice(0,-1).join("."));const e=O(this,n);e&&(r=r.bind(e))}return r},j.readOnly||(j.set=r?function(t){this._override(y,t)}:function(r){b(this,t,r)})}const w=p.type,A=p.types;if(!j.cast){let t;w?t=function(t){let r=0,n=t;if(s(t))return o(t);for(;Array.isArray(n)&&1===n.length&&"string"!=typeof n[0]&&"number"!=typeof n[0];)n=n[0],r++;const e=n;if(i(e))return 0===r?a(e):c(a(e),r);if(1===r)return u(e);if(r>1)return f(e,r);const p=t;return p.from?p.from:l(p)}(w):A&&(t=Array.isArray(A)?r(n(A[0])):n(A)),p.cast=I(p.cast,t)}m(j,p),p.range&&(j.cast=e(j.cast,p.range))}}function $(t,r,n){const e=d(t,n);e.json||(e.json={});let s=e.json;return void 0!==r&&(s.origins||(s.origins={}),s.origins[r]||(s.origins[r]={}),s=s.origins[r]),s}function I(t,r){if(t||r)return t?r?(n,e)=>r(t(n,e),e):t:r}export{I as composeCasters,k as e,O as g,_ as property,$ as propertyJSONMeta,b as s,A as v};
