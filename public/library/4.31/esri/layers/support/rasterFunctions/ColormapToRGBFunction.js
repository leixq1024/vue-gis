// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../SimpleBandStatistics ./BaseRasterFunction ./ColormapToRGBFunctionArguments ./pixelUtils ../../../renderers/support/rasterRendererChecks".split(" "),function(f,h,d,y,z,q,p,r,t,u,v){d=class extends r{constructor(){super(...arguments);this.functionName="ColormapToRGB";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){var a=this.sourceRasterInfos[0];if(1<a.bandCount||!a.colormap?.length)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: source data must be single band with a colormap"};const b=a.clone();b.pixelType=this.outputPixelType=this._getOutputPixelType("u8");this._removeStatsHistColormapVAT(b);b.bandCount=3;b.statistics=[{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20}];this.rasterInfo=b;a=[...a.colormap].sort((k,
l)=>k[0]-l[0]);const {indexedColormap:e,offset:m}=u.createColormapLUT({colormap:a});if(!e)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: the colormap is not supported"};this.lookup={indexedColormap:e,offset:m};return{success:!0,supportsGPU:v.isColormapSupportedByWebGL(e)}}_processPixels(a){a=a.pixelBlocks?.[0];if(!a||!this.lookup)return a;a=a.clone();const b=a.pixels[0],e=a.mask??(new Uint8Array(b.length)).fill(255),m=new Uint8Array(b.length),k=new Uint8Array(b.length),l=new Uint8Array(b.length),
{indexedColormap:n,offset:w}=this.lookup,x=n.length;for(let c=0;c<b.length;c++)if(e[c]){let g=4*(b[c]-w);0>g||g>x-4?e[c]=0:(m[c]=n[g++],k[c]=n[g++],l[c]=n[g++])}a.pixels=[m,k,l];a.statistics=[new p.SimpleBandStatistics(0,255),new p.SimpleBandStatistics(0,255),new p.SimpleBandStatistics(0,255)];a.pixelType=this.outputPixelType;return a}_getWebGLParameters(){return this.lookup}};f.__decorate([h.property({json:{write:!0,name:"rasterFunction"}})],d.prototype,"functionName",void 0);f.__decorate([h.property({type:t,
json:{write:!0,name:"rasterFunctionArguments"}})],d.prototype,"functionArguments",void 0);f.__decorate([h.property()],d.prototype,"rasterArgumentNames",void 0);f.__decorate([h.property({json:{write:!0}})],d.prototype,"lookup",void 0);return d=f.__decorate([q.subclass("esri.layers.support.rasterFunctions.ColormapToRGBFunction")],d)});