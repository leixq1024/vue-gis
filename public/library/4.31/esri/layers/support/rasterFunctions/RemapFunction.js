// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),function(q,t,r,m,y,z,u,v,w,h,x){m=class extends w{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=
null}_bindSourceRasters(){const c=this.sourceRasterInfos[0].clone(),{pixelType:e}=c;this.outputPixelType=this._getOutputPixelType(e);c.pixelType=this.outputPixelType;c.bandCount=1;const {statistics:f}=c;this._removeStatsHistColormapVAT(c);const {allowUnmatched:d,outputValues:a,inputRanges:k,noDataRanges:l,isLastInputRangeInclusive:b}=this.functionArguments;if(null!=f&&f.length&&a?.length)if(d){var g=Math.min.apply(null,[...a,f[0].min]),n=Math.max.apply(null,[...a,f[0].max]);c.statistics=[{...f[0],
min:g,max:n}]}else{n=g=a[0];for(let p=0;p<a.length;p++)g=g>a[p]?a[p]:g,n=n>a[p]?n:a[p];c.statistics=[{...f[0],min:g,max:n}]}this.rasterInfo=c;this.lookup=d?null:h.createRemapLUT({srcPixelType:e,inputRanges:k,outputValues:a,noDataRanges:l,allowUnmatched:d,isLastInputRangeInclusive:b,outputPixelType:this.outputPixelType});return{success:!0,supportsGPU:(!a||a.length<=h.maxMapSizeGpu)&&(!l||l.length<=h.maxMapSizeGpu)}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return null;const {lookup:e,outputPixelType:f}=
this;if(e){const g=h.lookupPixels(c,{lut:[e.lut],offset:e.offset,outputPixelType:f});null!=g&&e.mask&&(g.mask=h.lookupBandValues(c.pixels[0],c.mask,e.mask,e.offset,"u8"));return g}const {inputRanges:d,outputValues:a,noDataRanges:k,allowUnmatched:l,isLastInputRangeInclusive:b}=this.functionArguments;return h.remap(c,{inputRanges:d,outputValues:a,noDataRanges:k,outputPixelType:f,allowUnmatched:l,isLastInputRangeInclusive:b})}_getWebGLParameters(){const {allowUnmatched:c,noDataRanges:e,isLastInputRangeInclusive:f}=
this.functionArguments,d=new Float32Array(3*h.maxMapSizeGpu);var a=this.functionArguments.inputRanges??[],k=this.functionArguments.outputValues??[];const l=k.length;for(let b=0;b<h.maxMapSizeGpu;b++)if(d[3*b]=a[2*b]??t.numberMaxFloat32-1,d[3*b+1]=a[2*b+1]??t.numberMaxFloat32,d[3*b+2]=k[b]??0,b<l&&(0<b&&(d[3*b]-=1E-5),b<l-1||!f))d[3*b+1]-=1E-5;a=new Float32Array(2*h.maxMapSizeGpu);a.fill(t.numberMaxFloat32);e?.length&&a.set(e);k=v.getPixelValueRange(this.outputPixelType);return{allowUnmatched:c,rangeMaps:d,
noDataRanges:a,clampRange:k}}};q.__decorate([r.property({json:{write:!0,name:"rasterFunction"}})],m.prototype,"functionName",void 0);q.__decorate([r.property({type:x,json:{write:!0,name:"rasterFunctionArguments"}})],m.prototype,"functionArguments",void 0);q.__decorate([r.property()],m.prototype,"rasterArgumentNames",void 0);q.__decorate([r.property({json:{write:!0}})],m.prototype,"lookup",void 0);return m=q.__decorate([u.subclass("esri.layers.support.rasterFunctions.RemapFunction")],m)});