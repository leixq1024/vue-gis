// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(p,w,r,M,G,R,J,L,B,z){var l;r=l=class extends r.JSONSupport{static createEmptyBand(g,h){return new (l.getPixelArrayConstructor(g))(h)}static combineBandMasks(g){if(2>
g.length)return g[0];const h=g[0].length,d=(new Uint8Array(h)).fill(255);for(let u=0;u<g.length;u++){const n=g[u];for(let A=0;A<h;A++)n[A]||(d[A]=0)}return d}static getPixelArrayConstructor(g){let h;switch(g){case "u1":case "u2":case "u4":case "u8":h=Uint8Array;break;case "u16":h=Uint16Array;break;case "u32":h=Uint32Array;break;case "s8":h=Int8Array;break;case "s16":h=Int16Array;break;case "s32":h=Int32Array;break;case "f32":h=Float32Array;break;case "f64":h=Float64Array;break;case "c64":case "c128":case "unknown":h=
Float32Array}return h}constructor(g){super(g);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(g){if(!g)return"f32";g=g.toLowerCase();["u1","u2","u4"].includes(g)?g="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(g)||(g="f32");return g}getPlaneCount(){return this.pixels?.length}addData(g){if(!g.pixels||g.pixels.length!==this.width*this.height)throw new w("pixelblock:invalid-or-missing-pixels",
"add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(g.pixels);this.statistics.push(g.statistics??new B.SimpleBandStatistics)}getAsRGBA(){const g=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(g);break;default:this._fillFrom8Bit(g)}return new Uint8ClampedArray(g)}getAsRGBAFloat(){const g=
new Float32Array(this.width*this.height*4);this._fillFrom32Bit(g);return g}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(d=>{var u=this.mask;let n=Infinity,A=-Infinity;const m=d.length;let v,a=0;if(null!=u)for(v=0;v<m;v++)u[v]&&(a=d[v],n=a<n?a:n,A=a>A?a:A);else for(v=0;v<m;v++)a=d[v],n=a<n?a:n,A=a>A?a:A;return new B.SimpleBandStatistics(n,A)});var g=this.mask,h=0;if(null!=g)for(let d=0;d<g.length;d++)g[d]&&h++;else h=this.width*this.height;this.validPixelCount=h}}clamp(g){if(g&&
"f64"!==g&&"f32"!==g&&this.pixels){var [h,d]=z.getPixelValueRange(g),u=this.pixels,n=this.width*this.height,A=u.length,m=[];for(let k=0;k<A;k++){var v=l.createEmptyBand(g,n);var a=u[k];for(let f=0;f<n;f++){var b=a[f];v[f]=b>d?d:b<h?h:b}m.push(v)}this.pixels=m;this.pixelType=g}}extractBands(g){const {pixels:h,statistics:d}=this;if(null==g||0===g.length||!h||0===h.length)return this;var u=h.length;const n=g.some(k=>k>=h.length),A=u===g.length&&!g.some((k,f)=>k!==f);if(n||A)return this;u=this.bandMasks?.length===
u?g.map(k=>this.bandMasks[k]):void 0;let {mask:m,validPixelCount:v}=this;const {width:a,height:b}=this;u?.length&&(m=l.combineBandMasks(u),v=m.filter(k=>!!k).length);return new l({pixelType:this.pixelType,width:a,height:b,mask:m,bandMasks:u,validPixelCount:v,maskIsAlpha:this.maskIsAlpha,pixels:g.map(k=>h[k]),statistics:d&&g.map(k=>d[k])})}clone(){const g=new l({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&
(g.mask=new Uint8Array(this.mask));this.bandMasks&&(g.bandMasks=this.bandMasks.map(u=>new Uint8Array(u)));let h;const d=l.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){g.pixels=[];const u=!!this.pixels[0].slice;for(h=0;h<this.pixels.length;h++)g.pixels[h]=u?this.pixels[h].slice():new d(this.pixels[h])}if(this.statistics)for(g.statistics=[],h=0;h<this.statistics.length;h++)g.statistics[h]=M.clone(this.statistics[h]);g.premultiplyAlpha=this.premultiplyAlpha;return g}_fillFrom8Bit(g){const {mask:h,
maskIsAlpha:d,premultiplyAlpha:u,pixels:n}=this;if(g&&n?.length){var A,m;var v=A=m=n[0];3<=n.length?(A=n[1],m=n[2]):2===n.length&&(A=n[1]);var a=new Uint32Array(g),b=this.width*this.height;if(v.length!==b)G.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=h&&h.length===b)if(d)for(g=0;g<b;g++){const k=h[g];if(k){const f=k/255;a[g]=u?k<<24|m[g]*f<<16|A[g]*f<<8|v[g]*f:k<<24|m[g]<<16|A[g]<<8|v[g]}}else for(g=0;g<b;g++)h[g]&&(a[g]=-16777216|m[g]<<
16|A[g]<<8|v[g]);else for(g=0;g<b;g++)a[g]=-16777216|m[g]<<16|A[g]<<8|v[g]}else G.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(g){const {pixels:h,mask:d,statistics:u}=this;if(g&&h?.length){var n=this.pixelType,A=1,m=0;A=1;if(u&&0<u.length){for(var v of u)null!=v.minValue&&(m=Math.min(m,v.minValue)),null!=v.maxValue&&null!=v.minValue&&(A=Math.max(A,v.maxValue-v.minValue));A=255/A}else A=255,"s8"===n?(m=-128,A=127):"u16"===n?A=65535:
"s16"===n?(m=-32768,A=32767):"u32"===n?A=4294967295:"s32"===n?(m=-2147483648,A=2147483647):"f32"===n?(m=-3.4*1E39,A=3.4*1E39):"f64"===n&&(m=-Number.MAX_VALUE,A=Number.MAX_VALUE),A=255/(A-m);g=new Uint32Array(g);n=this.width*this.height;var a,b,k;v=a=b=h[0];if(v.length!==n)return G.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=h.length)if(a=h[1],3<=h.length&&(b=h[2]),null!=d&&d.length===n)for(k=0;k<n;k++)d[k]&&(g[k]=-16777216|(b[k]-m)*A<<16|(a[k]-
m)*A<<8|(v[k]-m)*A);else for(k=0;k<n;k++)g[k]=-16777216|(b[k]-m)*A<<16|(a[k]-m)*A<<8|(v[k]-m)*A;else if(null!=d&&d.length===n)for(k=0;k<n;k++)a=(v[k]-m)*A,d[k]&&(g[k]=-16777216|a<<16|a<<8|a);else for(k=0;k<n;k++)a=(v[k]-m)*A,g[k]=-16777216|a<<16|a<<8|a}else G.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(g){const {pixels:h,mask:d}=this;if(!g||!h?.length)return G.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");
let u,n,A,m;u=n=A=h[0];3<=h.length?(n=h[1],A=h[2]):2===h.length&&(n=h[1]);const v=this.width*this.height;if(u.length!==v)return G.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=d&&d.length===v)for(m=0;m<v;m++)g[a++]=u[m],g[a++]=n[m],g[a++]=A[m],g[a++]=d[m]&1;else for(m=0;m<v;m++)g[a++]=u[m],g[a++]=n[m],g[a++]=A[m],g[a++]=1}};p.__decorate([R.property({json:{write:!0}})],r.prototype,"width",void 0);p.__decorate([R.property({json:{write:!0}})],
r.prototype,"height",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"pixelType",void 0);p.__decorate([J.cast("pixelType")],r.prototype,"castPixelType",null);p.__decorate([R.property({json:{write:!0}})],r.prototype,"validPixelCount",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"mask",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"maskIsAlpha",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"pixels",void 0);p.__decorate([R.property()],
r.prototype,"premultiplyAlpha",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"statistics",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"depthCount",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"noDataValues",void 0);p.__decorate([R.property({json:{write:!0}})],r.prototype,"bandMasks",void 0);return r=l=p.__decorate([L.subclass("esri.layers.support.PixelBlock")],r)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],
function(p){class w{constructor(r=null,M=null,G=null){this.minValue=r;this.maxValue=M;this.noDataValue=G}}p.SimpleBandStatistics=w;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(p){function w(G){return M[G]??[-3.4028234663852886E38,3.4028234663852886E38]}function r(G){return(G?.startsWith("s")||G?.startsWith("u"))??!1}const M={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],
s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};p.clipBandToPixelTypeRange=function(G,R,J,L){let [B,z]=w(J);var l=r(J);l&&(B-=1E-5,z+=1E-5);if(l)if(J.startsWith("u")){const [g,h]=[B,z];for(J=0;J<R.length;J++)R[J]&&(l=G[J],l<g||l>h?R[J]=0:L[J]=l+.5<<0)}else{const [g,h]=[B,z];for(J=0;J<R.length;J++)R[J]&&(l=G[J],l<g||l>h?R[J]=0:L[J]=l+(0<l?.5:-.5)<<0)}else{const [g,
h]=[B,z];for(J=0;J<R.length;J++)R[J]&&(l=G[J],l<g||l>h?R[J]=0:L[J]=l)}};p.convertNoDataToMask=function(G,R,J){if(!(G.depthCount&&1<G.depthCount)){var {pixels:L,statistics:B,pixelType:z}=G,l=L[0].length,g=G.bandMasks??[];l=G.mask??(new Uint8Array(l)).fill(255);var h="f32"===z||"f64"===z,d=w(z),u=!1;for(let m=0;m<L.length;m++){const v="number"===typeof R?R:R[m];if(null==v)continue;var n=B?.[m]?.maxValue??d[1];if((B?.[m]?.minValue??d[0])>v+Number.EPSILON||n<v-Number.EPSILON)continue;n=g[m]||l.slice();
const a=L[m];var A=J?.customFloatTolerance;if(h&&0!==A){A||=9.999999E37<=Math.abs(v)?2E-7*Math.abs(v):"f32"===z?2**-23:Number.EPSILON;for(let b=0;b<a.length;b++)n[b]&&Math.abs(a[b]-v)<A&&(a[b]=0,n[b]=0,l[b]=0,u=!0)}else for(A=0;A<a.length;A++)n[A]&&a[A]===v&&(a[A]=0,n[A]=0,l[A]=0,u=!0);g[m]=n}u&&(G.bandMasks=G.bandMasks||1<G.pixels.length?g:null,G.mask=l);u&&"updateStatistics"in G&&G.updateStatistics()}};p.fixNaN=function(G,R){for(let J=0;J<R.length;J++)R[J]&&isNaN(G[J])&&(R[J]=0,G[J]=0)};p.getIntegerPixelType=
function(G,R){return null==G||null==R?"s32":0>G?-128<=G&&128>R?"s8":-32768<=G&&32768>R?"s16":"s32":256>R?"u8":65536>R?"u16":"u32"};p.getPixelValueRange=w;p.isIntegerPixelType=r;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ../SimpleBandStatistics ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g,h,d){async function u(q,D){if(!d.isPlatformLittleEndian)throw new w("rasterCoded:decode","lerc decoder is not supported on big endian platform");await L.load();const {offset:K}=D,{width:H,height:P,pixelType:I,statistics:S,depthCount:E,noDataValues:F,bandMasks:Q,pixels:V,mask:ba}=L.decode(q,{inputOffset:K,returnInterleaved:D.returnInterleaved});q=new M({width:H,height:P,pixelType:I.toLowerCase(),pixels:V,mask:ba,statistics:S.map(({minValue:da,maxValue:X})=>new G.SimpleBandStatistics(da,
X)),bandMasks:Q,depthCount:E,noDataValues:F});S?.length||q.updateStatistics();return q}async function n(q,D){q=await h.decode(q,{...D,noDataValue:null});r.assertIsSome(q);q=new M({width:q.width,height:q.height,pixels:q.pixels,pixelType:q.pixelType.toLowerCase(),mask:q.mask,bandMasks:q.bandMasks,statistics:null});q.updateStatistics();return q}async function A(q,D){q=await h.decodeTileOrStrip(q,D.customOptions);q=new M({width:q.width,height:q.height,pixels:q.pixels,pixelType:q.pixelType.toLowerCase(),
mask:q.mask,statistics:null});q.updateStatistics();return q}function m(q,D){const K=D.pixelType||"u8",H=M.getPixelArrayConstructor(K),P="u8"===K?q:new H(q.buffer),I=[],S=D.planes||1;if(1===S)I.push(P);else for(let E=0;E<S;E++){const F=(D.width||1)*(D.height||q.length),Q=new H(F);for(let V=0;V<F;V++)Q[V]=P[V*S+E];I.push(Q)}q=new M({width:D.width||1,height:D.height||q.length,pixels:I,pixelType:K,statistics:null});q.updateStatistics();return q}function v(q,D){q=(new l.Zlib(new Uint8Array(q))).getBytes();
return m(q,D)}function a(q,D){q=B.decode(q,D.offset,D.eof,!D.isInputBigEndian);return m(q,D)}function b(q,D){q=J.decode(q,D.hasNoZlibMask??void 0);q=new M({width:q.width,height:q.height,pixels:q.pixels,pixelType:"u8",mask:q.mask,statistics:null});q.updateStatistics();return q}function k(q,D){q=new Uint8Array(q);q=new t(q);const {width:K,height:H}=D;D=K*H;q=q.decode();let P=0;var I=0;let S;I=new Uint8Array(D);for(P=0;P<D;P++)I[P]=q[4*P+3];const E=new M({width:K,height:H,pixels:[],pixelType:"u8",mask:I,
statistics:[]});for(P=0;3>P;P++){S=new Uint8Array(D);for(I=0;I<D;I++)S[I]=q[4*I+P];E.addData({pixels:S})}E.updateStatistics();return E}async function f(q,D,K,H){q=await (new R).decode(q,{applyJpegMask:!1,format:D,...K},H);q=new M(q);q.updateStatistics();return q}function c(q){if(null==q)throw new w("rasterCodec:decode","parameter encodeddata is required.");q=new Uint8Array(q,0,10);let D="";255===q[0]&&216===q[1]?D="jpg":137===q[0]&&80===q[1]&&78===q[2]&&71===q[3]?D="png":67===q[0]&&110===q[1]&&116===
q[2]&&90===q[3]&&73===q[4]&&109===q[5]&&97===q[6]&&103===q[7]&&101===q[8]&&32===q[9]?D="lerc":76===q[0]&&101===q[1]&&114===q[2]&&99===q[3]&&50===q[4]&&32===q[5]?D="lerc2":73===q[0]&&73===q[1]&&42===q[2]&&0===q[3]||77===q[0]&&77===q[1]&&0===q[2]&&42===q[3]||73===q[0]&&73===q[1]&&43===q[2]&&0===q[3]||77===q[0]&&77===q[1]&&0===q[2]&&43===q[3]?D="tiff":71===q[0]&&73===q[1]&&70===q[2]?D="gif":66===q[0]&&77===q[1]?D="bmp":String.fromCharCode.apply(null,q).toLowerCase().includes("error")&&(D="error");return D}
function e(q){let D=null;switch(q){case "lerc":case "lerc2":D=u;break;case "jpg":D=b;break;case "png":D=k;break;case "bsq":case "bip":D=(K,H)=>{var P=H.pixelType,I=null;let S=null;switch(P?P.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":S=255;I=Uint8Array;break;case "u16":S=S||65535;I=Uint16Array;break;case "u32":S=S||2**32-1;I=Uint32Array;break;case "s8":S=S||-128;I=Int8Array;break;case "s16":S=S||-32768;I=Int16Array;break;case "s32":S=S||-(2**31);I=Int32Array;break;default:I=Float32Array}({pixelTypeCtor:P}=
{pixelTypeCtor:I,noDataValue:S});I=g.decode;K=I(K,{width:H.width,height:H.height,pixelType:P,format:q});H=new M({width:H.width,height:H.height,pixels:K.pixels,pixelType:H.pixelType,mask:K.mask,statistics:null});H.updateStatistics();return H};break;case "tiff":D=n;break;case "deflate":D=v;break;case "lzw":D=a;break;case "error":D=()=>{throw new w("rasterCodec:decode","input data contains error");};break;default:D=()=>{throw new w("rasterCodec:decode","unsupported raster format");}}return D}function x(q,
D=1){if(q){var {pixels:K,width:H,height:P,mask:I}=q;if(K&&0!==K.length){var S=K.length,E=H-1,F=P-1,Q=[],V,ba,da=null,X=M.getPixelArrayConstructor(q.pixelType);if(0===D){for(D=0;D<S;D++){var T=K[D];var Y=new X(E*F);for(V=0;V<F;V++){var ia=V*H;for(ba=0;ba<E;ba++)Y[V*E+ba]=T[ia+ba]}Q.push(Y)}if(null!=I)for(da=new Uint8Array(E*F),V=0;V<F;V++)for(ia=V*H,ba=0;ba<E;ba++)da[V*E+ba]=I[ia+ba]}else{for(D=0;D<S;D++){T=K[D];Y=new X(E*F);for(V=0;V<F;V++)for(ia=V*H,ba=0;ba<E;ba++)Y[V*E+ba]=(T[ia+ba]+T[ia+ba+1]+
T[ia+H+ba]+T[ia+H+ba+1])/4;Q.push(Y)}if(I)for(da=new Uint8Array(E*F),V=0;V<F;V++)for(ia=V*H,ba=0;ba<E;ba++)da[V*E+ba]=Math.min.apply(null,[I[ia+ba],I[ia+ba+1],I[ia+H+ba],I[ia+H+ba+1]])}q.width=E;q.height=F;q.mask=da;q.pixels=Q}}}var t=function(q){function D(I){var S,E;this.data=I;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(E=null;;){var F=this.readUInt32();var Q=I=void 0;I=[];for(Q=0;4>Q;++Q)I.push(String.fromCharCode(this.data[this.pos++]));
I=I.join("");switch(I){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(F);break;case "fcTL":E&&this.animation.frames.push(E);this.pos+=
4;E={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};I=this.readUInt16();F=this.readUInt16()||100;E.delay=1E3*I/F;E.disposeOp=this.data[this.pos++];E.blendOp=this.data[this.pos++];E.data=[];break;case "IDAT":case "fdAT":"fdAT"===I&&(this.pos+=4,F-=4);I=(null!=E?E.data:void 0)||this.imgData;for(Q=0;0<=F?Q<F:Q>F;0<=F?++Q:--Q)I.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=
this.read(F);F=255-this.transparency.indexed.length;if(0<F)for(I=0;0<=F?I<F:I>F;0<=F?++I:--I)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(F)[0];break;case 2:this.transparency.rgb=this.read(F)}break;case "tEXt":Q=this.read(F);F=Q.indexOf(0);I=String.fromCharCode.apply(String,Q.slice(0,F));this.text[I]=String.fromCharCode.apply(String,Q.slice(F+1));break;case "IEND":E&&this.animation.frames.push(E);a:{switch(this.colorType){case 0:case 3:case 4:E=1;break a;
case 2:case 6:E=3;break a}E=void 0}this.colors=E;this.hasAlphaChannel=4===(S=this.colorType)||6===S;S=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*S;a:{switch(this.colors){case 1:S="DeviceGray";break a;case 3:S="DeviceRGB";break a}S=void 0}this.colorSpace=S;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=F}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var K;D.load=function(I,S,E){"function"===typeof S&&(E=S);var F=
new XMLHttpRequest;F.open("GET",I,!0);F.responseType="arraybuffer";F.onload=function(){var Q=new Uint8Array(F.response||F.mozResponseArrayBuffer);Q=new D(Q);"function"===typeof(null!=S?S.getContext:void 0)&&Q.render(S);return"function"===typeof E?E(Q):void 0};return F.send(null)};D.prototype.read=function(I){var S;var E=[];for(S=0;0<=I?S<I:S>I;0<=I?++S:--S)E.push(this.data[this.pos++]);return E};D.prototype.readUInt32=function(){var I=this.data[this.pos++]<<24;var S=this.data[this.pos++]<<16;var E=
this.data[this.pos++]<<8;var F=this.data[this.pos++];return I|S|E|F};D.prototype.readUInt16=function(){var I=this.data[this.pos++]<<8;var S=this.data[this.pos++];return I|S};D.prototype.decodePixels=function(I){var S,E,F,Q,V,ba,da,X;null==I&&(I=this.imgData);if(0===I.length)return new Uint8Array(0);I=new l.Zlib(I);I=I.getBytes();var T=this.pixelBitlength/8;var Y=T*this.width;var ia=new Uint8Array(Y*this.height);var ma=I.length;for(E=Q=V=0;Q<ma;){switch(I[Q++]){case 0:for(F=S=0;S<Y;F=S+=1)ia[E++]=
I[Q++];break;case 1:for(F=ba=0;ba<Y;F=ba+=1){S=I[Q++];var C=F<T?0:ia[E-T];ia[E++]=(S+C)%256}break;case 2:for(F=C=0;C<Y;F=C+=1){S=I[Q++];var O=(F-F%T)/T;ba=V&&ia[(V-1)*Y+O*T+F%T];ia[E++]=(ba+S)%256}break;case 3:for(F=X=0;X<Y;F=X+=1)S=I[Q++],O=(F-F%T)/T,C=F<T?0:ia[E-T],ba=V&&ia[(V-1)*Y+O*T+F%T],ia[E++]=(S+Math.floor((C+ba)/2))%256;break;case 4:for(F=X=0;X<Y;F=X+=1){S=I[Q++];O=(F-F%T)/T;C=F<T?0:ia[E-T];0===V?ba=da=0:(ba=ia[(V-1)*Y+O*T+F%T],da=O&&ia[(V-1)*Y+(O-1)*T+F%T]);var N=C+ba-da;F=Math.abs(N-C);
O=Math.abs(N-ba);N=Math.abs(N-da);C=F<=O&&F<=N?C:O<=N?ba:da;ia[E++]=(S+C)%256}break;default:throw Error("Invalid filter algorithm: "+I[Q-1]);}V++}return ia};D.prototype.decodePalette=function(){var I,S,E,F;var Q=this.palette;var V=this.transparency.indexed||[];var ba=new Uint8Array((V.length||0)+Q.length);var da=0;Q.length;var X=S=I=0;for(E=Q.length;S<E;X=S+=3)ba[da++]=Q[X],ba[da++]=Q[X+1],ba[da++]=Q[X+2],ba[da++]=null!=(F=V[I++])?F:255;return ba};D.prototype.copyToImageData=function(I,S){var E,F;
var Q=this.colors;var V=null;var ba=this.hasAlphaChannel;this.palette.length&&(V=null!=(E=this._decodedPalette)?E:this._decodedPalette=this.decodePalette(),Q=4,ba=!0);I=I.data||I;var da=I.length;var X=V||S;E=F=0;if(1===Q)for(;E<da;)Q=V?4*S[E/4]:F,F=X[Q++],I[E++]=F,I[E++]=F,I[E++]=F,I[E++]=ba?X[Q++]:this.transparency.grayscale&&this.transparency.grayscale===F?0:255,F=Q;else for(;E<da;)Q=V?4*S[E/4]:F,I[E++]=X[Q++],I[E++]=X[Q++],I[E++]=X[Q++],I[E++]=ba?X[Q++]:this.transparency.rgb&&this.transparency.rgb[1]===
X[Q-3]&&this.transparency.rgb[3]===X[Q-2]&&this.transparency.rgb[5]===X[Q-1]?0:255,F=Q};D.prototype.decode=function(){var I=new Uint8Array(this.width*this.height*4);this.copyToImageData(I,this.decodePixels());return I};var H=(K=q.document&&q.document.createElement("canvas"))&&K.getContext("2d");var P=function(I){H.width=I.width;H.height=I.height;H.clearRect(0,0,I.width,I.height);H.putImageData(I,0,0);I=new Image;I.src=K.toDataURL();return I};D.prototype.decodeFrames=function(I){var S,E;if(this.animation){var F=
this.animation.frames;var Q=[];var V=S=0;for(E=F.length;S<E;V=++S){V=F[V];var ba=I.createImageData(V.width,V.height);var da=this.decodePixels(new Uint8Array(V.data));this.copyToImageData(ba,da);V.imageData=ba;Q.push(V.image=P(ba))}return Q}};D.prototype.renderFrame=function(I,S){var E=this.animation.frames;var F=E[S];E=E[S-1];0===S&&I.clearRect(0,0,this.width,this.height);1===(null!=E?E.disposeOp:void 0)?I.clearRect(E.xOffset,E.yOffset,E.width,E.height):2===(null!=E?E.disposeOp:void 0)&&I.putImageData(E.imageData,
E.xOffset,E.yOffset);0===F.blendOp&&I.clearRect(F.xOffset,F.yOffset,F.width,F.height);return I.drawImage(F.image,F.xOffset,F.yOffset)};D.prototype.animate=function(I){var S,E=this;var F=0;var Q=this.animation;var V=Q.numFrames;var ba=Q.frames;var da=Q.numPlays;return(S=function(){var X=F++%V;var T=ba[X];E.renderFrame(I,X);if(1<V&&F/V<da)return E.animation._timeout=setTimeout(S,T.delay)})()};D.prototype.stopAnimation=function(){var I;return clearTimeout(null!=(I=this.animation)?I._timeout:void 0)};
D.prototype.render=function(I){I._png&&I._png.stopAnimation();I._png=this;I.width=this.width;I.height=this.height;I=I.getContext("2d");if(this.animation)return this.decodeFrames(I),this.animate(I);var S=I.createImageData(this.width,this.height);this.copyToImageData(S,this.decodePixels());return I.putImageData(S,0,0)};return D}(self);const y=new Set(["jpg","png","bmp","gif"]);p.decode=async function(q,D={},K){if(null==q)throw new w("rasterCodec:decode","missing encodeddata parameter.");let H=D.format?.toLowerCase();
if(!("bsq"!==H&&"bip"!==H||null!=D.width&&null!=D.height))throw new w("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===H&&D.customOptions)return A(q,D);if(!H||"bsq"!==H&&"bip"!==H&&"deflate"!==H&&"lzw"!==H)H=c(q);if(D.useCanvas&&y.has(H))return f(q,H,D,K);const P=e(H);D.isPoint&&(D={...D},null!=D.width&&D.width++,null!=D.height&&D.height++);let I;const {offsets:S}=D;if(S&&1<S.length){K=S.map((F,Q)=>P(q.slice(F,S[Q+1]),D));K=await Promise.all(K);I=K[0];I.pixels=K.map(F=>
F.pixels[0]);const E=K.map(F=>F.mask);K.some(F=>null!=F)&&(E.forEach((F,Q)=>{null==F&&(E[Q]=(new Uint8Array(I.width*I.height)).fill(255))}),I.bandMasks=E,I.mask=M.combineBandMasks(E));I.updateStatistics()}else I=await P(q,{...D,offset:S?.[0]??D.offset});"jpg"!==H&&null!=D.noDataValue&&1===I.depthCount&&z.convertNoDataToMask(I,D.noDataValue,{customFloatTolerance:D.tolerance});D.isPoint&&x(I);return I};p.getFormat=function(q){q=c(q);"lerc2"===q?q="lerc":"error"===q&&(q="");return q};Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(p,w,r){class M{constructor(G){this._ctx=this._canvas=null;G&&(this._canvas=G.canvas,this._ctx=G.ctx||G.canvas&&G.canvas.getContext("2d"))}decode(G,R,J){if(!G||10>G.byteLength)throw new p("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:L=0,height:B=0,format:z}=R;const {applyJpegMask:l}=
R;if(l&&(!L||!B))throw new p("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((g,h)=>{let d=null;"jpg"===z&&l&&(d=M._getMask(G,{width:L,height:B}));const u=new Blob([new Uint8Array(G)],{type:"jpg"==="image/"+z?"jpeg":z}),n=URL.createObjectURL(u),A=new Image;let m;A.src=n;A.onload=()=>{URL.revokeObjectURL(n);if(w.isAborted(J))h(w.createAbortError());else{L=A.width;B=A.height;if(this._canvas&&this._ctx){if(this._canvas.width!==
L||this._canvas.height!==B)this._canvas.width=L,this._canvas.height=B;this._ctx.clearRect(0,0,L,B)}else this._canvas=document.createElement("canvas"),this._canvas.width=L,this._canvas.height=B,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(A,0,0);var v=this._ctx.getImageData(0,0,L,B);m=v.data;var a;if(R.renderOnCanvas){if(d)for(a=0;a<d.length;a++)m[4*a+3]=d[a]?255:0;this._ctx.putImageData(v,0,0);g(null)}else{v=L*B;var b=new Uint8Array(v),k=new Uint8Array(v),f=new Uint8Array(v);if(d)for(a=
0;a<v;a++)b[a]=m[4*a],k[a]=m[4*a+1],f[a]=m[4*a+2];else for(d=new Uint8Array(v),a=0;a<v;a++)b[a]=m[4*a],k[a]=m[4*a+1],f[a]=m[4*a+2],d[a]=m[4*a+3];g({width:L,height:B,pixels:[b,k,f],mask:d,pixelType:"u8"})}}};A.onerror=()=>{URL.revokeObjectURL(n);h("cannot load image")}})}static _getMask(G,R){let J=null;try{var L=new Uint8Array(G);G=0;var B=L.length-2;for(G=Math.ceil(L.length/2);G<B&&(255!==L[G]||217!==L[G+1]);G++);G+=2;if(G<L.length-1){const z=(new r.Zlib(L.subarray(G))).getBytes();J=new Uint8Array(R.width*
R.height);R=0;for(L=0;L<z.length;L++)for(B=7;0<=B;B--)J[R++]=z[L]>>B&1}}catch(z){}return J}}return M})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],function(p,w){var r={exports:{}},M,G=function(){if(M)return r.exports;M=1;(function(R){(function(J){J=J();void 0!==J&&(R.exports=J)})(function(){var J=function(){function L(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}L.prototype={ensureBuffer:function(B){var z=this.buffer,l=z?z.byteLength:0;if(B<l)return z;for(var g=
512;g<B;)g<<=1;B=new Uint8Array(g);for(g=0;g<l;++g)B[g]=z[g];return this.buffer=B},getByte:function(){for(var B=this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(B){var z=this.pos;if(B){this.ensureBuffer(z+B);for(B=z+B;!this.eof&&this.bufferLength<B;)this.readBlock();var l=this.bufferLength;B>l&&(B=l)}else{for(;!this.eof;)this.readBlock();B=this.bufferLength}this.pos=B;return this.buffer.subarray(z,B)},lookChar:function(){for(var B=
this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var B=this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(B,z,l){for(var g=B+z;this.bufferLength<=g&&!this.eof;)this.readBlock();return new Stream(this.buffer,B,z,l)},skip:function(B){B||=1;this.pos+=B},reset:function(){this.pos=0}};return L}();return function(){function L(u){throw Error(u);
}function B(u){var n=0,A=u[n++],m=u[n++];-1!=A&&-1!=m||L("Invalid header in flate stream");8!=(A&15)&&L("Unknown compression method in flate stream");0!=((A<<8)+m)%31&&L("Bad FCHECK in flate stream");m&32&&L("FDICT bit set in flate stream");this.bytes=u;this.bytesPos=n;this.codeBuf=this.codeSize=0;J.call(this)}if(!self||!self.Uint32Array)return null;var z=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,
131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),g=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),h=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,
459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,
459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,
459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,
459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,
459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,
459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,
459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],d=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,
327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];B.prototype=Object.create(J.prototype);B.prototype.getBits=function(u){for(var n=this.codeSize,A=this.codeBuf,m=this.bytes,v=this.bytesPos,a;n<u;)"undefined"==typeof(a=m[v++])&&L("Bad encoding in flate stream"),A|=a<<n,n+=8;this.codeBuf=A>>u;this.codeSize=n-=u;this.bytesPos=v;return A&(1<<u)-1};B.prototype.getCode=function(u){var n=u[0],A=u[1];u=this.codeSize;for(var m=
this.codeBuf,v=this.bytes,a=this.bytesPos;u<A;){var b;"undefined"==typeof(b=v[a++])&&L("Bad encoding in flate stream");m|=b<<u;u+=8}A=n[m&(1<<A)-1];n=A>>16;A&=65535;(0==u||u<n||0==n)&&L("Bad encoding in flate stream");this.codeBuf=m>>n;this.codeSize=u-n;this.bytesPos=a;return A};B.prototype.generateHuffmanTable=function(u){for(var n=u.length,A=0,m=0;m<n;++m)u[m]>A&&(A=u[m]);for(var v=1<<A,a=new Uint32Array(v),b=1,k=0,f=2;b<=A;++b,k<<=1,f<<=1)for(var c=0;c<n;++c)if(u[c]==b){var e=0,x=k;for(m=0;m<b;++m)e=
e<<1|x&1,x>>=1;for(m=e;m<v;m+=f)a[m]=b<<16|c;++k}return[a,A]};B.prototype.readBlock=function(){function u(e,x,t,y,q){for(e=e.getBits(t)+y;0<e--;)x[k++]=q}var n=this.getBits(3);n&1&&(this.eof=!0);n>>=1;if(0==n){var A=this.bytes,m=this.bytesPos,v;"undefined"==typeof(v=A[m++])&&L("Bad block header in flate stream");var a=v;"undefined"==typeof(v=A[m++])&&L("Bad block header in flate stream");a|=v<<8;"undefined"==typeof(v=A[m++])&&L("Bad block header in flate stream");n=v;"undefined"==typeof(v=A[m++])&&
L("Bad block header in flate stream");(n|v<<8)!=(~a&65535)&&L("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;v=this.bufferLength;n=this.ensureBuffer(v+a);this.bufferLength=a=v+a;for(var b=v;b<a;++b){if("undefined"==typeof(v=A[m++])){this.eof=!0;break}n[b]=v}this.bytesPos=m}else{if(1==n)m=h,v=d;else if(2==n){n=this.getBits(5)+257;v=this.getBits(5)+1;A=this.getBits(4)+4;m=Array(z.length);for(var k=0;k<A;)m[z[k++]]=this.getBits(3);m=this.generateHuffmanTable(m);k=A=0;v=
n+v;for(a=Array(v);k<v;)b=this.getCode(m),16==b?u(this,a,2,3,A):17==b?u(this,a,3,3,A=0):18==b?u(this,a,7,11,A=0):a[k++]=A=b;m=this.generateHuffmanTable(a.slice(0,n));v=this.generateHuffmanTable(a.slice(n,v))}else L("Unknown block type in flate stream");a=(n=this.buffer)?n.length:0;for(b=this.bufferLength;;){var f=this.getCode(m);if(256>f)b+1>=a&&(n=this.ensureBuffer(b+1),a=n.length),n[b++]=f;else{if(256==f){this.bufferLength=b;break}f-=257;f=l[f];var c=f>>16;0<c&&(c=this.getBits(c));A=(f&65535)+c;
f=this.getCode(v);f=g[f];c=f>>16;0<c&&(c=this.getBits(c));f=(f&65535)+c;b+A>=a&&(n=this.ensureBuffer(b+A),a=n.length);for(c=0;c<A;++c,++b)n[b]=n[b-f]}}}};return B}()})})(r);return r.exports}();w=w.getDefaultExportFromCjs(G);p.Zlib=w})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(p){p.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};p.getDefaultExportFromCjs=function(w){return w&&
w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w["default"]:w}})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(p,w){class r{static decode(M,G=!1){const R=new Uint8Array(M);M=new p.JpegImage;M.parse(R);const {width:J,height:L,numComponents:B,eof:z}=M,l=M.getData(J,L,!0),g=J*L;M=null;let h=0,d=0,u=0;if(!G&&z<R.length-1)try{var n=(new w.Zlib(R.subarray(z))).getBytes();M=new Uint8Array(g);for(h=G=0;h<n.length;h++)for(u=
7;0<=u;u--)M[G++]=n[h]>>u&1}catch{}if(1===B&&l.length===J*L)n=new Uint8Array(l.buffer),n=[n,n,n];else{n=[];for(h=0;3>h;h++)n.push(new Uint8Array(g));for(d=u=0;d<g;d++)for(h=0;3>h;h++)n[h][d]=l[u++]}return{width:J,height:L,pixels:n,mask:M}}}return r})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(p,w){var r={exports:{}},M,G=function(){if(M)return r.exports;M=1;(function(R){(function(J){J=J();void 0!==J&&(R.exports=J)})(function(){var J=function(){function L(B){this.message=
"JPEG error: "+B}L.prototype=Error();L.prototype.name="JpegError";return L.constructor=L}();return function(){function L(){this.decodeTransform=null;this.colorTransform=-1}function B(d,u){for(var n=0,A=[],m,v,a=16;0<a&&!d[a-1];)a--;A.push({children:[],index:0});var b=A[0],k;for(m=0;m<a;m++){for(v=0;v<d[m];v++){b=A.pop();for(b.children[b.index]=u[n];0<b.index;)b=A.pop();b.index++;for(A.push(b);A.length<=m;)A.push(k={children:[],index:0}),b.children[b.index]=k.children,b=k;n++}m+1<a&&(A.push(k={children:[],
index:0}),b.children[b.index]=k.children,b=k)}return A[0].children}function z(d,u,n,A,m,v,a,b,k){function f(){if(0<S)return S--,I>>S&1;I=d[u++];if(255===I){var N=d[u++];if(N)throw new J("unexpected marker "+(I<<8|N).toString(16));}S=7;return I>>>7}function c(N){for(;;){N=N[f()];if("number"===typeof N)return N;if("object"!==typeof N)throw new J("invalid huffman sequence");}}function e(N){for(var W=0;0<N;)W=W<<1|f(),N--;return W}function x(N){if(1===N)return 1===f()?1:-1;var W=e(N);return W>=1<<N-1?
W:W+(-1<<N)+1}function t(N,W){var ca=c(N.huffmanTableDC);ca=0===ca?0:x(ca);N.blockData[W]=N.pred+=ca;for(ca=1;64>ca;){var aa=c(N.huffmanTableAC),ea=aa&15;aa>>=4;if(0===ea){if(15>aa)break;ca+=16}else ca+=aa,N.blockData[W+h[ca]]=x(ea),ca++}}function y(N,W){var ca=c(N.huffmanTableDC);ca=0===ca?0:x(ca)<<k;N.blockData[W]=N.pred+=ca}function q(N,W){N.blockData[W]|=f()<<k}function D(N,W){if(0<E)E--;else for(var ca=v;ca<=a;){var aa=c(N.huffmanTableAC),ea=aa&15;aa>>=4;if(0===ea){if(15>aa){E=e(aa)+(1<<aa)-
1;break}ca+=16}else ca+=aa,N.blockData[W+h[ca]]=x(ea)*(1<<k),ca++}}function K(N,W){for(var ca=v,aa=0,ea;ca<=a;){ea=h[ca];switch(F){case 0:aa=c(N.huffmanTableAC);ea=aa&15;aa>>=4;if(0===ea)15>aa?(E=e(aa)+(1<<aa),F=4):(aa=16,F=1);else{if(1!==ea)throw new J("invalid ACn encoding");Q=x(ea);F=aa?2:3}continue;case 1:case 2:N.blockData[W+ea]?N.blockData[W+ea]+=f()<<k:(aa--,0===aa&&(F=2===F?3:0));break;case 3:N.blockData[W+ea]?N.blockData[W+ea]+=f()<<k:(N.blockData[W+ea]=Q<<k,F=0);break;case 4:N.blockData[W+
ea]&&(N.blockData[W+ea]+=f()<<k)}ca++}4===F&&(E--,0===E&&(F=0))}var H=n.mcusPerLine,P=u,I=0,S=0,E=0,F=0,Q,V=A.length,ba,da,X,T;b=n.progressive?0===v?0===b?y:q:0===b?D:K:t;var Y=0;n=1===V?A[0].blocksPerLine*A[0].blocksPerColumn:H*n.mcusPerColumn;for(var ia,ma;Y<n;){var C=m?Math.min(n-Y,m):n;for(ba=0;ba<V;ba++)A[ba].pred=0;E=0;if(1===V){var O=A[0];for(T=0;T<C;T++)b(O,64*((O.blocksPerLine+1)*(Y/O.blocksPerLine|0)+Y%O.blocksPerLine)),Y++}else for(T=0;T<C;T++){for(ba=0;ba<V;ba++)for(O=A[ba],ia=O.h,ma=
O.v,da=0;da<ma;da++)for(X=0;X<ia;X++)b(O,64*((O.blocksPerLine+1)*((Y/H|0)*O.v+da)+(Y%H*O.h+X)));Y++}S=0;(O=g(d,u))&&O.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+O.invalid),u=O.offset);O=O&&O.marker;if(!O||65280>=O)throw new J("marker was not found");if(65488<=O&&65495>=O)u+=2;else break}(O=g(d,u))&&O.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+O.invalid),u=O.offset);return u-P}function l(d,u){d=u.blocksPerLine;for(var n=u.blocksPerColumn,
A=new Int16Array(64),m=0;m<n;m++)for(var v=0;v<d;v++){var a=void 0,b=void 0,k=void 0,f=void 0,c=void 0,e=void 0,x=void 0,t=void 0,y=c=e=f=b=a=void 0,q=void 0,D=void 0,K=void 0,H=64*((u.blocksPerLine+1)*m+v),P=A,I=u.quantizationTable,S=u.blockData;if(!I)throw new J("missing required Quantization Table.");for(var E=0;64>E;E+=8)a=S[H+E],t=S[H+E+1],x=S[H+E+2],e=S[H+E+3],c=S[H+E+4],f=S[H+E+5],k=S[H+E+6],b=S[H+E+7],a*=I[E],0===(t|x|e|c|f|k|b)?(a=5793*a+512>>10,P[E]=a,P[E+1]=a,P[E+2]=a,P[E+3]=a,P[E+4]=a,
P[E+5]=a,P[E+6]=a,P[E+7]=a):(t*=I[E+1],x*=I[E+2],e*=I[E+3],c*=I[E+4],f*=I[E+5],k*=I[E+6],b*=I[E+7],K=5793*a+128>>8,D=5793*c+128>>8,q=x,y=k,c=2896*(t-b)+128>>8,b=2896*(t+b)+128>>8,e<<=4,f<<=4,K=K+D+1>>1,D=K-D,a=3784*q+1567*y+128>>8,q=1567*q-3784*y+128>>8,y=a,c=c+f+1>>1,f=c-f,b=b+e+1>>1,e=b-e,K=K+y+1>>1,y=K-y,D=D+q+1>>1,q=D-q,a=2276*c+3406*b+2048>>12,c=3406*c-2276*b+2048>>12,b=a,a=799*e+4017*f+2048>>12,e=4017*e-799*f+2048>>12,f=a,P[E]=K+b,P[E+7]=K-b,P[E+1]=D+f,P[E+6]=D-f,P[E+2]=q+e,P[E+5]=q-e,P[E+3]=
y+c,P[E+4]=y-c);for(I=0;8>I;++I)a=P[I],t=P[I+8],x=P[I+16],e=P[I+24],c=P[I+32],f=P[I+40],k=P[I+48],b=P[I+56],0===(t|x|e|c|f|k|b)?(a=5793*a+8192>>14,a=-2040>a?0:2024<=a?255:a+2056>>4,S[H+I]=a,S[H+I+8]=a,S[H+I+16]=a,S[H+I+24]=a,S[H+I+32]=a,S[H+I+40]=a,S[H+I+48]=a,S[H+I+56]=a):(K=5793*a+2048>>12,D=5793*c+2048>>12,q=x,y=k,c=2896*(t-b)+2048>>12,b=2896*(t+b)+2048>>12,K=(K+D+1>>1)+4112,D=K-D,a=3784*q+1567*y+2048>>12,q=1567*q-3784*y+2048>>12,y=a,c=c+f+1>>1,f=c-f,b=b+e+1>>1,e=b-e,K=K+y+1>>1,y=K-y,D=D+q+1>>
1,q=D-q,a=2276*c+3406*b+2048>>12,c=3406*c-2276*b+2048>>12,b=a,a=799*e+4017*f+2048>>12,e=4017*e-799*f+2048>>12,f=a,a=K+b,b=K-b,t=D+f,k=D-f,x=q+e,f=q-e,e=y+c,c=y-c,a=16>a?0:4080<=a?255:a>>4,t=16>t?0:4080<=t?255:t>>4,x=16>x?0:4080<=x?255:x>>4,e=16>e?0:4080<=e?255:e>>4,c=16>c?0:4080<=c?255:c>>4,f=16>f?0:4080<=f?255:f>>4,k=16>k?0:4080<=k?255:k>>4,b=16>b?0:4080<=b?255:b>>4,S[H+I]=a,S[H+I+8]=t,S[H+I+16]=x,S[H+I+24]=e,S[H+I+32]=c,S[H+I+40]=f,S[H+I+48]=k,S[H+I+56]=b)}return u.blockData}function g(d,u,n){var A=
d.length-1;n=n<u?n:u;if(u>=A)return null;var m=d[u]<<8|d[u+1];if(65472<=m&&65534>=m)return{invalid:null,marker:m,offset:u};for(u=d[n]<<8|d[n+1];!(65472<=u&&65534>=u);){if(++n>=A)return null;u=d[n]<<8|d[n+1]}return{invalid:m.toString(16),marker:u,offset:n}}if(!self||!self.Uint8ClampedArray)return null;var h=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,
63]);L.prototype={parse:function(d){function u(){var I=d[m]<<8|d[m+1];m+=2;return I}function n(){var I=u();I=m+I-2;var S=g(d,I,m);S&&S.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+S.invalid),I=S.offset);I=d.subarray(m,I);m+=I.length;return I}function A(I){for(var S=Math.ceil(I.samplesPerLine/8/I.maxH),E=Math.ceil(I.scanLines/8/I.maxV),F=0;F<I.components.length;F++){P=I.components[F];var Q=Math.ceil(Math.ceil(I.samplesPerLine/8)*P.h/I.maxH),V=Math.ceil(Math.ceil(I.scanLines/
8)*P.v/I.maxV);P.blockData=new Int16Array(64*E*P.v*(S*P.h+1));P.blocksPerLine=Q;P.blocksPerColumn=V}I.mcusPerLine=S;I.mcusPerColumn=E}var m=0,v=null,a=null,b=[],k=[],f=[],c=u();if(65496!==c)throw new J("SOI not found");for(c=u();65497!==c;){switch(c){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var e=n();65504===c&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&
0===e[4]&&(v={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])});65518===c&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&(a={version:e[5]<<8|e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break;case 65499:c=u()+m-2;for(var x;m<c;){var t=d[m++],y=new Uint16Array(64);if(0===t>>4)for(e=0;64>e;e++)x=h[e],y[x]=d[m++];else if(1===t>>4)for(e=0;64>e;e++)x=
h[e],y[x]=u();else throw new J("DQT - invalid table spec");b[t&15]=y}break;case 65472:case 65473:case 65474:if(q)throw new J("Only single frame JPEGs supported");u();var q={};q.extended=65473===c;q.progressive=65474===c;q.precision=d[m++];q.scanLines=u();q.samplesPerLine=u();q.components=[];q.componentIds={};e=d[m++];for(c=y=t=0;c<e;c++){x=d[m];var D=d[m+1]>>4;var K=d[m+1]&15;t<D&&(t=D);y<K&&(y=K);D=q.components.push({h:D,v:K,quantizationId:d[m+2],quantizationTable:null});q.componentIds[x]=D-1;m+=
3}q.maxH=t;q.maxV=y;A(q);break;case 65476:x=u();for(c=2;c<x;){t=d[m++];y=new Uint8Array(16);for(e=D=0;16>e;e++,m++)D+=y[e]=d[m];K=new Uint8Array(D);for(e=0;e<D;e++,m++)K[e]=d[m];c+=17+D;(0===t>>4?f:k)[t&15]=B(y,K)}break;case 65501:u();var H=u();break;case 65498:u();x=d[m++];e=[];for(c=0;c<x;c++){t=q.componentIds[d[m++]];var P=q.components[t];t=d[m++];P.huffmanTableDC=f[t>>4];P.huffmanTableAC=k[t&15];e.push(P)}c=d[m++];x=d[m++];t=d[m++];c=z(d,m,q,e,H,c,x,t>>4,t&15);m+=c;break;case 65535:255!==d[m]&&
m--;break;default:if(255===d[m-3]&&192<=d[m-2]&&254>=d[m-2])m-=3;else throw new J("unknown marker "+c.toString(16));}c=u()}this.width=q.samplesPerLine;this.height=q.scanLines;this.jfif=v;this.eof=m;this.adobe=a;this.components=[];for(c=0;c<q.components.length;c++){P=q.components[c];if(v=b[P.quantizationId])P.quantizationTable=v;this.components.push({output:l(q,P),scaleX:P.h/q.maxH,scaleY:P.v/q.maxV,blocksPerLine:P.blocksPerLine,blocksPerColumn:P.blocksPerColumn})}this.numComponents=this.components.length},
_getLinearizedBlockData:function(d,u){var n=this.width/d,A=this.height/u,m,v,a=0,b=this.components.length,k=d*u*b,f=new Uint8ClampedArray(k),c=new Uint32Array(d);for(v=0;v<b;v++){var e=this.components[v];var x=e.scaleX*n;var t=e.scaleY*A;a=v;var y=e.output;var q=e.blocksPerLine+1<<3;for(m=0;m<d;m++)e=0|m*x,c[m]=(e&4294967288)<<3|e&7;for(x=0;x<u;x++)for(e=0|x*t,e=q*(e&4294967288)|(e&7)<<3,m=0;m<d;m++)f[a]=y[e+c[m]],a+=b}if(u=this.decodeTransform)for(v=0;v<k;)for(d=e=0;e<b;e++,v++,d+=2)f[v]=(f[v]*u[d]>>
8)+u[d+1];return f},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(d){for(var u,n,A,m=0,v=d.length;m<v;m+=3)u=d[m],n=d[m+1],A=d[m+2],d[m]=u-179.456+1.402*A,d[m+1]=u+135.459-.344*n-.714*A,d[m+2]=u-226.816+1.772*n;return d},_convertYcckToRgb:function(d){for(var u,n,A,m,v=0,a=0,b=d.length;a<b;a+=4)u=d[a],n=d[a+1],A=d[a+2],m=d[a+3],d[v++]=-122.67195406894+n*(-6.60635669420364E-5*
n+4.37130475926232E-4*A-5.4080610064599E-5*u+4.8449797120281E-4*m-.154362151871126)+A*(-9.57964378445773E-4*A+8.17076911346625E-4*u-.00477271405408747*m+1.53380253221734)+u*(9.61250184130688E-4*u-.00266257332283933*m+.48357088451265)+m*(-3.36197177618394E-4*m+.484791561490776),d[v++]=107.268039397724+n*(2.19927104525741E-5*n-6.40992018297945E-4*A+6.59397001245577E-4*u+4.26105652938837E-4*m-.176491792462875)+A*(-7.78269941513683E-4*A+.00130872261408275*u+7.70482631801132E-4*m-.151051492775562)+u*(.00126935368114843*
u-.00265090189010898*m+.25802910206845)+m*(-3.18913117588328E-4*m-.213742400323665),d[v++]=-20.810012546947+n*(-5.70115196973677E-4*n-2.63409051004589E-5*A+.0020741088115012*u-.00288260236853442*m+.814272968359295)+A*(-1.53496057440975E-5*A-1.32689043961446E-4*u+5.60833691242812E-4*m-.195152027534049)+u*(.00174418132927582*u-.00255243321439347*m+.116935020465145)+m*(-3.43531996510555E-4*m+.24165260232407);return d},_convertYcckToCmyk:function(d){for(var u,n,A,m=0,v=d.length;m<v;m+=4)u=d[m],n=d[m+
1],A=d[m+2],d[m]=434.456-u-1.402*A,d[m+1]=119.541-u+.344*n+.714*A,d[m+2]=481.816-u-1.772*n;return d},_convertCmykToRgb:function(d){for(var u,n,A,m,v=0,a=1/255,b=0,k=d.length;b<k;b+=4)u=d[b]*a,n=d[b+1]*a,A=d[b+2]*a,m=d[b+3]*a,d[v++]=255+u*(-4.387332384609988*u+54.48615194189176*n+18.82290502165302*A+212.25662451639585*m-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*A-17.873870861415444*m-5.497006427196366)+A*(-2.5217340131683033*A-21.248923337353073*m+17.5119270841813)-m*(21.86122147463605*
m+189.48180835922747),d[v++]=255+u*(8.841041422036149*u+60.118027045597366*n+6.871425592049007*A+31.159100130055922*m-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*A+131.35250912493976*m-190.9453302588951)+A*(4.444339102852739*A+9.8632861493405*m-24.86741582555878)-m*(20.737325471181034*m+187.80453709719578),d[v++]=255+u*(.8842522430003296*u+8.078677503112928*n+30.89978309703729*A-.23883238689178934*m-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*A+50.606957656360734*
m-112.23884253719248)+A*(.03296041114873217*A+115.60384449646641*m-193.58209356861505)-m*(22.33816807309886*m+180.12613974708367);return d},getData:function(d,u,n){if(4<this.numComponents)throw new J("Unsupported color mode");d=this._getLinearizedBlockData(d,u);if(1===this.numComponents&&n){n=d.length;u=new Uint8ClampedArray(3*n);for(var A=0,m=0;m<n;m++){var v=d[m];u[A++]=v;u[A++]=v;u[A++]=v}return u}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(d);if(4===
this.numComponents){if(this._isColorConversionNeeded())return n?this._convertYcckToRgb(d):this._convertYcckToCmyk(d);if(n)return this._convertCmykToRgb(d)}return d}};return L}()})})(r);return r.exports}();w=w.getDefaultExportFromCjs(G);p.JpegImage=w})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(p,w,r){function M(B,z,l){l.set(B.slice(z,z+l.length))}function G(B){const {_malloc:z,_free:l,_lerc_getBlobInfo:g,_lerc_getDataRanges:h,_lerc_decode_4D:d,
asm:u}=B;let n;const A=Object.values(u).find(v=>v&&"buffer"in v&&v.buffer===B.HEAPU8.buffer),m=v=>{v=v.map(k=>(k>>3<<3)+16);var a=v.reduce((k,f)=>k+f),b=z(a);n=new Uint8Array(A.buffer);a=v[0];v[0]=b;for(b=1;b<v.length;b++){const k=v[b];v[b]=v[b-1]+a;a=k}return v};L.getBlobInfo=v=>{var a=new Uint8Array(48),b=new Uint8Array(24);const [k,f,c]=m([v.length,a.length,b.length]);n.set(v,k);n.set(a,f);n.set(b,c);var e=g(k,v.length,f,c,12,3);if(e)throw l(k),Error(`lerc-getBlobInfo: error code is ${e}`);n=new Uint8Array(A.buffer);
M(n,f,a);M(n,c,b);a=new Uint32Array(a.buffer);var x=new Float64Array(b.buffer);const [t,y,,q,D,K,H,P,I,S,E]=a;b={version:t,depthCount:S,width:q,height:D,validPixelCount:H,bandCount:K,blobSize:P,maskCount:I,dataType:y,minValue:x[0],maxValue:x[1],maxZerror:x[2],statistics:[],bandCountWithNoData:E};if(E&&1<S)return l(k),b;if(1===S&&1===K)return l(k),b.statistics.push({minValue:x[0],maxValue:x[1]}),b;e=S*K*8;var F=new Uint8Array(e),Q=new Uint8Array(e);a=k;var V=x=0;let ba=!1;n.byteLength<k+2*e?(l(k),
ba=!0,[a,x,V]=m([v.length,e,e]),n.set(v,a)):[x,V]=m([e,e]);n.set(F,x);n.set(Q,V);if(e=h(a,v.length,S,K,x,V))throw l(a),ba||l(x),Error(`lerc-getDataRanges: error code is ${e}`);n=new Uint8Array(A.buffer);M(n,x,F);M(n,V,Q);v=new Float64Array(F.buffer);e=new Float64Array(Q.buffer);Q=b.statistics;for(F=0;F<K;F++)if(1<S){V=v.slice(F*S,(F+1)*S);const da=e.slice(F*S,(F+1)*S),X=Math.min.apply(null,V),T=Math.max.apply(null,da);Q.push({minValue:X,maxValue:T,depthStats:{minValues:V,maxValues:da}})}else Q.push({minValue:v[F],
maxValue:e[F]});l(a);ba||l(x);return b};L.decode=(v,a)=>{const {maskCount:b,depthCount:k,bandCount:f,width:c,height:e,dataType:x,bandCountWithNoData:t}=a;var y=R[x],q=c*e;a=new Uint8Array(q*f);y=new Uint8Array(q*k*f*y.size);q=new Uint8Array(f);var D=new Uint8Array(8*f);const [K,H,P,I,S]=m([v.length,a.length,y.length,q.length,D.length]);n.set(v,K);n.set(a,H);n.set(y,P);n.set(q,I);n.set(D,S);if(v=d(K,v.length,b,H,k,c,e,f,x,P,I,S))throw l(K),Error(`lerc-decode: error code is ${v}`);n=new Uint8Array(A.buffer);
M(n,P,y);M(n,H,a);v=null;if(t){M(n,I,q);M(n,S,D);v=[];D=new Float64Array(D.buffer);for(let E=0;E<q.length;E++)v.push(q[E]?D[E]:null)}l(K);return{data:y,maskData:a,noDataValues:v}}}const R=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let J=null;const L={getBlobInfo:null,decode:null};w.decode=function(B,z={}){var l=z.inputOffset??0;B=B instanceof Uint8Array?B.subarray(l):new Uint8Array(B,l);l=L.getBlobInfo(B);const {data:g,maskData:h,noDataValues:d}=L.decode(B,l),{width:u,height:n,bandCount:A,
depthCount:m,dataType:v,maskCount:a,statistics:b}=l;var k=R[v],f=new k.ctor(g.buffer);B=[];l=[];const c=u*n;var e=c*m;for(var x=0;x<A;x++){var t=f.subarray(x*e,(x+1)*e);if(z.returnInterleaved)B.push(t);else{a:{var y=c,q=m;if(2>q)break a;const D=new k.ctor(y*q);for(let K=0,H=0;K<y;K++)for(let P=0,I=K;P<q;P++,I+=y)D[I]=t[H++];t=D}B.push(t)}l.push(h.subarray(x*e,(x+1)*e))}f=0===a?null:1===a?l[0]:new Uint8Array(c);if(1<a)for(f.set(l[0]),e=1;e<l.length;e++)for(x=l[e],t=0;t<c;t++)f[t]&=x[t];({noDataValue:z}=
z);e=null!=z&&k.range[0]<=z&&k.range[1]>=z;if(0<a&&e)for(e=0;e<A;e++)for(x=B[e],t=l[e]||f,y=0;y<c;y++)0===t[y]&&(x[y]=z);({pixelType:k}=k);return{width:u,height:n,bandCount:A,pixelType:k,depthCount:m,statistics:b,pixels:B,mask:f,bandMasks:a===A&&1<A?l:null,noDataValues:d}};w.getBlobInfo=function(B,z={}){B=B instanceof Uint8Array?B.subarray(z.inputOffset??0):new Uint8Array(B,z.inputOffset??0);return L.getBlobInfo(B)};w.load=function(){return J?J:J=(new Promise((B,z)=>p(["../../../chunks/lerc-wasm"],
B,z))).then(B=>B.lercWasm).then(({default:B})=>B({locateFile:z=>r.getAssetUrl(`esri/layers/support/rasterFormats/${z}`)})).then(B=>{G(B)})};w.pixelTypeInfoMap=R;Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(p){function w(R,J,L,B=!0){if(0!==J%4||0!==L%4){var z=new ArrayBuffer(4*Math.ceil(L/4));z=new Uint8Array(z);R=new Uint8Array(R,J,L);if(B)for(B=0;B<z.length;B+=4)z[B]=R[B+3],z[B+1]=R[B+2],z[B+2]=R[B+
1],z[B+3]=R[B];else z.set(R);return new Uint32Array(z.buffer)}if(B){B=new Uint8Array(R,J,L);z=new Uint8Array(B.length);for(R=0;R<z.length;R+=4)z[R]=B[R+3],z[R+1]=B[R+2],z[R+2]=B[R+1],z[R+3]=B[R];return new Uint32Array(z.buffer)}return new Uint32Array(R,J,L/4)}function r(){const R=[];for(let J=0;257>=J;J++)R[J]=[J];return R}function M(R,J){for(let L=0;L<J.length;L++)R.push(J[L])}const G=new Set;G.add(511);G.add(1023);G.add(2047);G.add(4095);G.add(8191);p.decode=function(R,J,L,B=!0){R=w(R,J,L,B);J=
9;B=r();let z=32,l=B.length,g=[],h=1,d=R[0],u=0;const n=R.length;L=8*(4*n-L);const A=[];for(;null!=d;){if(z>=J)z-=J,u=d>>>32-J,d<<=J;else{u=d>>>32-z;d=R[h++];var m=J-z;z=32-m;u=(u<<m)+(d>>>z);d<<=m}if(257===u)break;if(256===u)J=9,B=r(),l=B.length,g=[];else{m=B[u];if(null==m){if(u>B.length)throw Error("data integrity issue: code does not exist on code page");g.push(g[0]);B[l++]=g.slice();M(A,g)}else M(A,m),g.push(m[0]),1<g.length&&(B[l++]=g.slice()),g=m.slice();G.has(l)&&J++;0===z&&(d=R[h++],z=32);
if(h>n||h===n&&z<=L)break}}return new Uint8Array(A)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const p=r=>{let M=1;switch(r){case Uint8Array:case Int8Array:M=1;break;case Uint16Array:case Int16Array:M=2;break;case Uint32Array:case Int32Array:case Float32Array:M=4;break;case Float64Array:M=8}return M};class w{static decode(r,M){var G=M.pixelType;const R=[],J=M.width*M.height;var L=Math.floor(r.byteLength/(M.width*
M.height*p(M.pixelType)));const {bandIds:B,format:z}=M;M=B?.length||Math.floor(r.byteLength/(M.width*M.height*p(M.pixelType)));var l=r.byteLength-r.byteLength%(J*p(G)),g=new G(r,0,J*L);let h,d,u,n,A=null;if("bip"===z)for(h=0;h<M;h++){u=new G(J);n=B?B[h]:h;for(d=0;d<J;d++)u[d]=g[d*L+n];R.push(u)}else if("bsq"===z)for(h=0;h<M;h++)n=B?B[h]:h,R.push(g.subarray(n*J,(n+1)*J));if(l<r.byteLength-1)if(r=r.slice(l),8*r.byteLength<J)A=null;else{r=new Uint8Array(r,0,Math.ceil(J/8));G=new Uint8Array(J);for(l=
g=l=M=L=0;l<r.length-1;l++)for(M=r[l],g=7;0<=g;g--)G[L++]=M>>g&1;for(g=7;L<J-1;)M=r[r.length-1],G[L++]=M>>g&1,g--;A=G}return{pixels:R,mask:A}}}return w})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../core/has ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(p,w,r,M,G,R,J,L,B,z){function l(E,F){let Q="unknown";3===E?Q=64===F?"f64":"f32":1===E?1===F?Q="u1":2===F?Q=
"u2":4===F?Q="u4":8>=F?Q="u8":16>=F?Q="u16":32>=F&&(Q="u32"):2===E&&(8>=F?Q="s8":16>=F?Q="s16":32>=F&&(Q="s32"));return Q}function g(E){let F=null;switch(E?E.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":F=Uint8Array;break;case "u16":F=Uint16Array;break;case "u32":F=Uint32Array;break;case "s8":F=Int8Array;break;case "s16":F=Int16Array;break;case "s32":F=Int32Array;break;case "f64":F=Float64Array;break;default:F=Float32Array}return F}function h(E,F){return{x:F[0]*E.x+F[1]*E.y+F[2],y:F[3]*
E.x+F[4]*E.y+F[5]}}function d(E,F){return E.get(F)?.values?.[0]}function u(E,F,Q,V=0,ba=L.tiffTags,da=4){var X=8===da;const T=X?t(new DataView(E,Q,8),0,F):(new DataView(E,Q,2)).getUint16(0,F),Y=4+2*da;var ia=X?8:2;X=ia+T*Y;if(Q+X>E.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:X};const ma=Q+X+4<=E.byteLength?y(new DataView(E,Q+X,8===da?8:4),0,F,8===da):null;Q+=ia;ia=new Map;let C,O,N,W=0,ca=0;for(let ea=0;ea<T;ea++){var aa=new DataView(E,Q+Y*ea,Y);C=aa.getUint16(0,F);N=aa.getUint16(2,
F);O=L.getTagName(C,ba);const ha=[];2===da?(W=aa.getUint16(4,F),ca=aa.getUint16(6,F)):4===da?(W=aa.getUint32(4,F),ca=aa.getUint32(8,F)):8===da&&(W=y(aa,4,F,!0),ca=y(aa,12,F,!0),ha.push(aa.getUint32(12,F)),ha.push(aa.getUint32(16,F)));aa={id:C,type:N,valueCount:W,valueOffset:ca,valueOffsets:ha,values:null};b(E,F,aa,V,!1,da);ia.set(O,aa)}return{success:!0,ifd:ia,nextIFD:ma,requiredBufferSize:X}}function n(E,F){if(1!==F&&2!==F&&4!==F)return E;const Q=new Uint8Array(E),V=8/F;E=new Uint8Array(E.byteLength*
V);let ba=0;const da=2**F-1;for(let X=0;X<Q.length;X++){const T=Q[X];for(let Y=0;Y<V;Y++)E[ba++]=T<<F*Y>>>8-F&da}return E.buffer}function A(E,F,Q){const V=new M.JpegImage;V.parse(E);V.colorTransform=6===Q?-1:0;E=V.getData(V.width,V.height,1!==F&&4!==F);return new Uint8Array(E.buffer)}function m(E){E=(new z.Zlib(E)).getBytes();var F=new ArrayBuffer(E.length);F=new Uint8Array(F);F.set(E);return F}async function v(E,F,Q,V,ba){var da=B.isPlatformLittleEndian===F,X=d(Q,"BITSPERSAMPLE"),T=d(Q,"SAMPLESPERPIXEL")??
1,Y=d(Q,"PHOTOMETRICINTERPRETATION"),ia=d(Q,"SAMPLEFORMAT")??1,ma=l(ia,X),C=d(Q,"COMPRESSION")??1,O=g(ma);if(34887===C)return await G.load(),G.decode(E,{inputOffset:V}).pixels[0];if(1===C)Y=E.slice(V,V+ba),F=new Uint8Array(Y);else if(8===C||32946===C)F=new Uint8Array(E,V,ba),F=m(F),Y=F.buffer;else if(6===C)F=new Uint8Array(E,V,ba),F=A(F,T,Y),Y=F.buffer;else if(7===C){const N=Q.get("JPEGTABLES").values,W=N.length-2;F=new Uint8Array(W+ba-2);for(let ca=0;ca<W;ca++)F[ca]=N[ca];E=new Uint8Array(E,V+2,
ba-2);for(V=0;V<E.length;V++)F[W+V]=E[V];F=A(F,T,Y);Y=F.buffer}else if(5===C)F=R.decode(E,V,ba,F),Y=F.buffer;else throw Error("tiff-decode: unsupport compression "+C);Y=n(Y,X);if("u8"!==ma&&"s8"!==ma&&!da)switch(Y=new ArrayBuffer(F.length),da=new Uint8Array(Y),ma){case "u16":case "s16":for(ma=0;ma<F.length;ma+=2)da[ma]=F[ma+1],da[ma+1]=F[ma];break;case "u32":case "s32":case "f32":for(ma=0;ma<F.length;ma+=4)da[ma]=F[ma+3],da[ma+1]=F[ma+2],da[ma+2]=F[ma+1],da[ma+3]=F[ma]}X=new O(Y);da=d(Q,"PREDICTOR")??
1;ma=d(Q,"TILEWIDTH");F=d(Q,"TILELENGTH");if(1<da&&(5===C||8===C||32946===C)&&ma&&F){C=f(Q);O=new O(X.length);O.set(X);Q=3===ia&&3===da;C=C?1:T;T=Q?4:1;ia=ma*T*C;Q&&(O=new Uint8Array(O.buffer));for(da=0;da<F;da++)for(X=da*ia,Y=C;Y<ia;Y++)O[X+Y]+=O[X+Y-C];if(Q){Q=new Uint8Array(O.length);C*=ma;for(ma=0;ma<F;ma++)for(da=ma*ia,X=0;X<C;X++)for(Y=0;Y<T;Y++)Q[da+X*T+Y]=O[da+X+(T-Y-1)*C];X=new Float32Array(Q.buffer)}else X=O}return X}async function a(E,F,Q){const V=Q.get("TILEOFFSETS")?.values;if(void 0===
V)return null;const ba=Q.get("TILEBYTECOUNTS")?.values,{width:da,height:X,pixelType:T,tileWidth:Y,tileHeight:ia}=k([Q]);var ma=f(Q,F);const C=d(Q,"SAMPLESPERPIXEL")||F.planes;var O=da*X,N=d(Q,"BITSPERSAMPLE"),W=34887===(d(Q,"COMPRESSION")??1),ca=g(T);const aa=[];for(var ea=0;ea<C;ea++)aa.push(new ca(O));let ha,ja,na,pa,ra,sa,qa,va,ta;ca=Math.ceil(da/Y);O=(new Uint8Array(O)).fill(255);ea=!1;if(0===N%8)if(W&&ma&&1<C)for(ma=Math.round(V.length/C),N=0;N<ma;N++){var wa=Math.floor(N/ca)*ia;na=N%ca*Y;pa=
wa*da+na;for(W=0;W<C;W++){var U=N*C+W;0===ba[U]?(U=null,ea=!0):U=await v(E,F.littleEndian,Q,V[U],ba[U]);sa=0;ra=pa;va=Math.min(Y,da-na);qa=Math.min(ia,X-wa);ta=aa[W];for(ha=0;ha<qa;ha++)for(ra=pa+ha*da,sa=ha*Y,ja=0;ja<va;ja++,ra++,sa++)U?ta[ra]=U[sa]:O[ra]=0}}else for(N=0;N<V.length;N++)for(wa=Math.floor(N/ca)*ia,na=N%ca*Y,pa=wa*da+na,0===ba[N]?(U=null,ea=!0):U=await v(E,F.littleEndian,Q,V[N],ba[N]),sa=0,ra=pa,va=Math.min(Y,da-na),qa=Math.min(ia,X-wa),wa=0;wa<C;wa++)if(ta=aa[wa],ma||W)for(ha=0;ha<
qa;ha++)for(ra=pa+ha*da,sa=Y*ia*wa+ha*Y,ja=0;ja<va;ja++,ra++,sa++)U?ta[ra]=U[sa]:O[ra]=0;else for(ha=0;ha<qa;ha++)for(ra=pa+ha*da,sa=ha*Y*C+wa,ja=0;ja<va;ja++,ra++,sa+=C)U?ta[ra]=U[sa]:O[ra]=0;return{width:da,height:X,pixelType:T,pixels:aa,mask:ea?O:void 0}}function b(E,F,Q,V=0,ba=!1,da=4){if(Q.values)return!0;var X=Q.type,T=Q.valueCount,Y=Q.valueOffset;let ia=[];var ma=H[X],C=8*ma,O=T*ma,N=T*H[X]*8,W=8===da?64:32;da=Q.valueOffsets;if(N>W&&O>(ba?E.byteLength:E?E.byteLength-Y+V:0))return Q.offlineOffsetSize=
[Y,O],Q.values=null,!1;if(N<=W)if(F||(32>=W?Y>>>=32-N:(E=da?.length?da[0]:Y>>>0,F=da?.length?da[1]:Math.round((Y-E)/4294967296),32>=N?(Y=E>>>32-N,da[0]=Y):(Y=E*2**(32-N)+(F>>>32-N),da[0]=E,da[1]=F>>>32-N))),1===T&&C===W)ia=[Y];else if(64===W)for(E=da?.length?da[0]:Y>>>0,Y=da?.length?da[1]:Math.round((Y-E)/4294967296),F=E,ma=32,E=1;E<=T;E++)O=32-C*E%32,ma<C?(O=F<<O>>>32-ma,N=Y<<32-ma>>>32-ma,F=Y,ia.push(O+N*2**(C-ma)),ma-=32-(C-ma)):(ia.push(F<<O>>>32-C),ma-=C),0===ma&&(ma=32,F=Y);else for(E=1;E<=
T;E++)ia.push(Y<<32-C*E>>>32-C);else for(Y-=V,ba&&(Y=0),T=Y;T<Y+O;T+=ma){switch(X){case 1:C=(new DataView(E,T,1)).getUint8(0);break;case 2:C=(new DataView(E,T,1)).getUint8(0);break;case 3:C=(new DataView(E,T,2)).getUint16(0,F);break;case 4:case 13:C=(new DataView(E,T,4)).getUint32(0,F);break;case 5:C=(new DataView(E,T,4)).getUint32(0,F)/(new DataView(E,T+4,4)).getUint32(0,F);break;case 6:C=(new DataView(E,T,1)).getInt8(0);break;case 7:C=(new DataView(E,T,1)).getUint8(0);break;case 8:C=(new DataView(E,
T,2)).getInt16(0,F);break;case 9:C=(new DataView(E,T,4)).getInt32(0,F);break;case 10:C=(new DataView(E,T,4)).getInt32(0,F)/(new DataView(E,T+4,4)).getInt32(0,F);break;case 11:C=(new DataView(E,T,4)).getFloat32(0,F);break;case 12:C=(new DataView(E,T,8)).getFloat64(0,F);break;case 16:case 18:C=t(new DataView(E,T,8),0,F);break;case 17:da=new DataView(E,T,8);N=(C=F)?da.getInt32(0,C):da.getUint32(0,C);da=C?da.getUint32(4,C):da.getInt32(4,C);W=0<=(C?N:da)?1:-1;C?N*=W:da*=W;C=W*(C?4294967296*da+N:4294967296*
N+da);break;default:C=null}ia.push(C)}if(2===X){X="";Y=ia;ia=[];for(E=0;E<Y.length;E++)0===Y[E]&&""!==X?(ia.push(X),X=""):X+=String.fromCharCode(Y[E]);""===X&&0!==ia.length||ia.push(X)}Q.values=ia;return!0}function k(E){var F=E[0];const Q=d(F,"TILEWIDTH"),V=d(F,"TILELENGTH"),ba=d(F,"IMAGEWIDTH"),da=d(F,"IMAGELENGTH");var X=d(F,"BITSPERSAMPLE");const T=d(F,"SAMPLESPERPIXEL");var Y=d(F,"SAMPLEFORMAT")??1;const ia=l(Y,X),ma=f(F);var C=F.get("GDAL_NODATA")?.values;let O=null;C?.length&&(O=C.map(ta=>parseFloat(ta)),
O.some(ta=>isNaN(ta))&&(O=null));var N=d(F,"COMPRESSION")??1;switch(N){case 1:C="NONE";break;case 2:case 3:case 4:case 32771:C="CCITT";break;case 5:C="LZW";break;case 6:case 7:C="JPEG";break;case 32773:C="PACKBITS";break;case 8:case 32946:C="DEFLATE";break;case 34712:C="JPEG2000";break;case 34887:C="LERC";break;default:C=String(N)}let W=!0,ca="";P.has(N)||(W=!1,ca+="unsupported tag compression "+N);3<Y&&(W=!1,ca+="unsupported tag sampleFormat "+Y);1!==X&&2!==X&&4!==X&&0!==X%8&&(W=!1,ca+="unsupported tag bitsPerSample "+
X);X=F.get("GEOASCIIPARAMS")?.values?.[0];if(X){X=(X=X.split("|").find(ta=>ta.includes("ESRI PE String \x3d ")))?X.replace("ESRI PE String \x3d ",""):"";var aa=X.startsWith("COMPD_CS")||X.startsWith("PROJCS")||X.startsWith("GEOGCS")?{wkid:null,wkt:X}:null}Y=F.get("GEOTIEPOINTS")?.values;X=F.get("GEOPIXELSCALE")?.values;N=F.get("GEOTRANSMATRIX")?.values;var ea=F.has("GEOKEYDIRECTORY")?F.get("GEOKEYDIRECTORY").data:null,ha=!1;F=!1;if(ea){ha=2===d(ea,"GTRasterTypeGeoKey");var ja=d(ea,"GTModelTypeGeoKey");
2===ja?(ea=d(ea,"GeographicTypeGeoKey"),1024<=ea&&32766>=ea&&(aa={wkid:ea}),aa||32767!==ea||(F=!0,aa={wkid:4326})):1===ja&&(ea=d(ea,"ProjectedCSTypeGeoKey"),1024<=ea&&32766>=ea&&(aa={wkid:ea}))}let na;X&&Y&&6<=Y.length?(na=[X[0],0,Y[3]-Y[0]*X[0],0,-Math.abs(X[1]),Y[4]-Y[1]*X[1]],ha&&(na[2]-=.5*na[0]+.5*na[1],na[5]-=.5*na[3]+.5*na[4])):N&&16===N.length&&(na=ha?[N[0],N[1],N[3]-.5*N[0],N[4],N[5],N[7]-.5*N[5]]:[N[0],N[1],N[3],N[4],N[5],N[7]]);if(na){Y=[{x:0,y:da},{x:0,y:0},{x:ba,y:da},{x:ba,y:0}];ea=
ha=Number.POSITIVE_INFINITY;let ta=ja=Number.NEGATIVE_INFINITY;for(let wa=0;wa<Y.length;wa++)N=h(Y[wa],na),ha=N.x>ha?ha:N.x,ja=N.x<ja?ja:N.x,ea=N.y>ea?ea:N.y,ta=N.y<ta?ta:N.y;Y={xmin:ha,xmax:ja,ymin:ea,ymax:ta,spatialReference:aa}}else Y={xmin:-.5,ymin:.5-da,xmax:ba-.5,ymax:.5,spatialReference:aa};F&&(400<Y.xmax-Y.xmin||361<Math.max(Math.abs(Y.xmin),Math.abs(Y.xmax)))&&(aa=null,Y.spatialReference=null);aa=c(E);let pa;let ra,sa;if(0<aa.length){ra=Math.round(Math.log(ba/d(aa[0],"IMAGEWIDTH"))/Math.LN2);
var qa=aa[aa.length-1];sa=aa.length;pa=d(qa,"TILEWIDTH");qa=d(qa,"TILELENGTH")}pa=null!=sa&&0<sa?pa||Q:null;qa=null!=sa&&0<sa?qa||V:null;let va;Q&&(va=[{maxCol:Math.ceil(ba/Q)-1,maxRow:Math.ceil(da/V)-1,minRow:0,minCol:0}],aa.forEach(ta=>{va.push({maxCol:Math.ceil(d(ta,"IMAGEWIDTH")/d(ta,"TILEWIDTH"))-1,maxRow:Math.ceil(d(ta,"IMAGELENGTH")/d(ta,"TILELENGTH"))-1,minRow:0,minCol:0})}));N=E[0].get("GDAL_METADATA")?.values?.[0];N=S(N);ca+=" "+K({width:ba,height:da,tileWidth:Q,tileHeight:V,planes:T,ifds:E});
E=e(E).length===aa.length+1;aa=aa?.length?aa.map(ta=>{const wa=ba/d(ta,"IMAGEWIDTH");ta=da/d(ta,"IMAGELENGTH");return{x:wa,y:ta}}):void 0;return{width:ba,height:da,tileWidth:Q,tileHeight:V,planes:T,isBSQ:ma,pixelType:ia,compression:C,noData:O,hasMaskBand:E,isSupported:W,pyramidResolutions:aa,message:ca,extent:Y,isPseudoGeographic:F,affine:X?null:na,firstPyramidLevel:ra,maximumPyramidLevel:sa,pyramidBlockWidth:pa,pyramidBlockHeight:qa,tileBoundary:va,metadata:N}}function f(E,F){return(E=E.get("PLANARCONFIGURATION")?.values)?
2===E[0]:F?F.isBSQ:!1}function c(E){return E.filter(F=>1===d(F,"NEWSUBFILETYPE"))}function e(E){return E.filter(F=>{const Q=4===((d(F,"NEWSUBFILETYPE")??0)&4);F=4===d(F,"PHOTOMETRICINTERPRETATION");return Q&&F})}function x(E){const {littleEndian:F,isBigTiff:Q,firstIFDPos:V}=q(E);var ba=V;const da=[];do if(ba=D(E,F,ba,0,L.tiffTags,Q?8:4),ba.success)da.push(ba.ifd),ba=ba.nextIFD;else break;while(0<ba);E=k(da);ba=c(da);const X=e(da);return{...E,littleEndian:F,isBigTiff:Q,ifds:da,pyramidIFDs:ba,maskIFDs:X}}
function t(E,F,Q){const V=E.getUint32(F,Q);E=E.getUint32(F+4,Q);return Q?4294967296*E+V:4294967296*V+E}function y(E,F,Q,V){return V?t(E,F,Q):E.getUint32(F,Q)}function q(E){var F=new DataView(E,0,16),Q=F.getUint16(0,!1);E=null;if(18761===Q)E=!0;else if(19789===Q)E=!1;else throw Error("unexpected endianess byte");var V=F.getUint16(2,E);if(42!==V&&43!==V)throw Error("unexpected tiff identifier");Q=4;if(V=43===V){const ba=F.getUint16(Q,E);Q+=2;if(8!==ba)throw Error("unsupported bigtiff version");if(0!==
F.getUint16(Q,E))throw Error("unsupported bigtiff version");Q+=2}F=y(F,Q,E,V);return{littleEndian:E,isBigTiff:V,firstIFDPos:F}}function D(E,F,Q,V=0,ba=L.tiffTags,da=4){Q=u(E,F,Q,V,ba,da);let X;const T=Q.ifd;T&&(L.ifdTags.forEach((Y,ia)=>{T.has(ia)&&(X=T.get(ia),X.data=u(E,F,X.valueOffset-V,V,Y).ifd)}),T.has("GEOKEYDIRECTORY")&&(X=T.get("GEOKEYDIRECTORY"),(ba=X.values)&&4<ba.length&&(ba=ba[0]+"."+ba[1]+"."+ba[2],X.data=u(E,F,X.valueOffset+6-V,V,L.geoKeys,2).ifd,X.data&&X.data.set("GEOTIFFVersion",
{id:0,type:2,valueCount:1,valueOffset:null,values:[ba]}))),T.has("XMP")&&(X=T.get("XMP"),ba=X.values,"number"===typeof ba[0]&&7===X.type&&(X.values=[r.bytesToUTF8(new Uint8Array(ba))])));return Q}function K(E){const {width:F,height:Q,tileHeight:V,tileWidth:ba}=E,da=E.planes,X=ba?ba*V:F*Q;E=d(E.ifds[0],"BITSPERSAMPLE");let T="";X*da>2**30/(8<E?E/8:1)&&(T=ba?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return T}const H=[0,1,1,2,4,
8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],P=new Set([1,5,6,7,8,34712,34887]),I=(E,F,Q)=>{if(!(E&&0<E.length&&F&&Q))return null;let V,ba,da;const X=E[0].length,T=E.length,Y=new Uint8Array(X);for(let ma=0;ma<T;ma++)if(V=E[ma],ba=F[ma],da=Q[ma],0===ma)for(var ia=0;ia<X;ia++)Y[ia]=V[ia]<ba||V[ia]>da?0:1;else for(ia=0;ia<X;ia++)Y[ia]&&(Y[ia]=V[ia]<ba||V[ia]>da?0:1);return Y},S=E=>{if(!E)return null;var F=E.match(/<Item(.*?)Item>/gi);if(!F||0===F.length)return null;E=new Map;var Q;for(var V=0;V<F.length;V++){var ba=
F[V];var da=ba.slice(6,ba.indexOf("\x3e"));var X=ba.indexOf("sample\x3d");-1<X&&(Q=ba.slice(X+8,ba.indexOf('"',X+8)));X=ba.indexOf("name\x3d");-1<X&&(da=ba.slice(X+6,ba.indexOf('"',X+6)));da&&(ba=ba.slice(ba.indexOf("\x3e")+1,ba.indexOf("\x3c/Item\x3e")).trim(),null!=Q?E.has(da)?E.get(da)[Q]=ba:E.set(da,[ba]):E.set(da,ba));Q=null}F=E.get("STATISTICS_MINIMUM");da=E.get("STATISTICS_MAXIMUM");V=E.get("STATISTICS_MEAN");ba=E.get("STATISTICS_STDDEV");Q=null;if(F&&da)for(Q=[],X=0;X<F.length;X++)Q.push({min:parseFloat(F[X]),
max:parseFloat(da[X]),avg:V&&parseFloat(V[X]),stddev:ba&&parseFloat(ba[X])});da=E.get("BandName");V=E.get("WavelengthMin");ba=E.get("WavelengthMax");F=null;if(da)for(F=[],X=0;X<da.length;X++)F.push({BandName:da[X],WavelengthMin:V&&parseFloat(V[X]),WavelengthMax:ba&&parseFloat(ba[X])});da=E.get("DataType");return{statistics:Q,bandProperties:F,dataType:da,rawMetadata:E}};p.decode=async function(E,F={}){var Q=F.pyramidLevel||0,V=F.headerInfo||x(E);const {ifds:ba,noData:da}=V;if(0===ba.length)throw Error("no valid image file directory");
var X=K(V);if(X)throw X;X=null;var T=-1===Q?ba[ba.length-1]:ba[Q];F=da??F.noDataValue;if(V.tileWidth)X=await a(E,V,T);else{{const sa=B.isPlatformLittleEndian===V.littleEndian,qa=T.get("STRIPOFFSETS")?.values;if(void 0===qa)X=null;else{var {width:Y,height:ia,pixelType:ma}=k([T]);Q=d(T,"SAMPLESPERPIXEL")||V.planes;var C=d(T,"PHOTOMETRICINTERPRETATION");X=Y*ia;var O=d(T,"BITSPERSAMPLE"),N=g(ma),W=new N(X*Q),ca=T.get("STRIPBYTECOUNTS")?.values,aa=d(T,"ROWSPERSTRIP"),ea=d(T,"COMPRESSION")??1,ha;if(0===
O%8)for(T=0;T<qa.length;T++){var ja=T*aa*Y*Q;if("u8"===ma||"s8"===ma||sa)if(8===ea||32946===ea){var na=new Uint8Array(E,qa[T],ca[T]);na=m(na);var pa=na.buffer}else 6===ea?(na=new Uint8Array(E,qa[T],ca[T]),na=A(na,Q,C),pa=na.buffer):5===ea?(na=R.decode(E,qa[T],ca[T],V.littleEndian),pa=na.buffer):pa=E.slice(qa[T],qa[T]+ca[T]);else{if(6===ea||8===ea||32946===ea){na=new Uint8Array(E,qa[T],ca[T]);var ra=m(na);pa=ra.buffer}else pa=new ArrayBuffer(ca[T]),na=new Uint8Array(E,qa[T],ca[T]),ra=new Uint8Array(pa);
switch(ma){case "u16":case "s16":for(ha=0;ha<na.length;ha+=2)ra[ha]=na[ha+1],ra[ha+1]=na[ha];break;case "u32":case "s32":case "f32":for(ha=0;ha<na.length;ha+=4)ra[ha]=na[ha+3],ra[ha+1]=na[ha+2],ra[ha+2]=na[ha+1],ra[ha+3]=na[ha]}}pa=n(pa,O);ha=new N(pa);W.set(ha,ja)}C=[];if(1===Q)C.push(W);else for(T=0;T<Q;T++){V=new N(X);for(E=0;E<X;E++)V[E]=W[E*Q+T];C.push(V)}X={width:Y,height:ia,pixelType:ma,pixels:C}}}}if(!X)return X;null!=F&&J.convertNoDataToMask(X,F);return X};p.decodeTileOrStrip=async function(E,
F){const {headerInfo:Q,ifd:V,offsets:ba,sizes:da}=F;var X=[];for(var T=0;T<ba.length;T++){0===da[T]?1:0;var Y=await v(E,Q.littleEndian,V,ba[T],da[T]||E.byteLength);X.push(Y)}var ia=f(V,Q);E=d(V,"BITSPERSAMPLE");T=d(V,"SAMPLEFORMAT")??1;T=l(T,E);var ma=d(V,"SAMPLESPERPIXEL")||Q.planes;const C=g(T);Y=d(V,"TILEWIDTH");const O=d(V,"TILELENGTH");var N=d(V,"COMPRESSION")??1;const W=Y*O;E=[];let ca=X[0];const aa=34887===N;for(let ea=0;ea<ma;ea++){N=new C(W);if(X.length===ma)ca=X[ea],ca.length===W&&(N=ca);
else if(ca.length)if(ia||aa)N=ca.length===W?ca:ca.slice(W*ea,W*(ea+1));else for(let ha=0;ha<W;ha++)N[ha]=ca[ha*ma+ea];E.push(N)}X=Q.noData?Q.noData[0]:F.noDataValue;ia=(ma=Q.metadata?Q.metadata.statistics:null)?ma.map(ea=>ea.min):null;ma=ma?ma.map(ea=>ea.max):null;T={pixelType:T,width:Y,height:O,pixels:E,noDataValue:X};null!=X?J.convertNoDataToMask(T,X):ia&&ma&&F.applyMinMaxConstraint&&(T.mask=I(E,ia,ma));return T};p.getImageInfo=k;p.getMaskIFDs=e;p.getPyramidIFDs=c;p.isBSQConfig=f;p.parseFieldValues=
b;p.parseHeader=x;p.parseIFD=D;p.parseSignature=q;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(p){p.bytesToUTF8=function(w,r){let M=0,G="",R=0,J=0;const L=w.length;for(;M<L;)if(J=w[M++],R=J>>4,8>R?R=1:15===R?(R=4,J=(J&7)<<18|(w[M++]&63)<<12|(w[M++]&63)<<6|w[M++]&63):14===R?(R=3,J=(J&15)<<12|(w[M++]&63)<<6|w[M++]&63):(R=2,J=(J&31)<<6|w[M++]&63),0!==J||r)G+=String.fromCharCode(J);return G};
Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const p=(()=>{const G=[];G[254]="NEWSUBFILETYPE";G[255]="SUBFILETYPE";G[256]="IMAGEWIDTH";G[257]="IMAGELENGTH";G[258]="BITSPERSAMPLE";G[259]="COMPRESSION";G[262]="PHOTOMETRICINTERPRETATION";G[263]="THRESHHOLDING";G[264]="CELLWIDTH";G[265]="CELLLENGTH";G[266]="FILLORDER";G[269]="DOCUMENTNAME";G[270]="IMAGEDESCRIPTION";G[271]="MAKE";G[272]="MODEL";G[273]="STRIPOFFSETS";
G[274]="ORIENTATION";G[277]="SAMPLESPERPIXEL";G[278]="ROWSPERSTRIP";G[279]="STRIPBYTECOUNTS";G[280]="MINSAMPLEVALUE";G[281]="MAXSAMPLEVALUE";G[282]="XRESOLUTION";G[283]="YRESOLUTION";G[284]="PLANARCONFIGURATION";G[285]="PAGENAME";G[286]="XPOSITION";G[287]="YPOSITION";G[288]="FREEOFFSETS";G[289]="FREEBYTECOUNTS";G[290]="GRAYRESPONSEUNIT";G[291]="GRAYRESPONSECURVE";G[292]="T4OPTIONS";G[293]="T6OPTIONS";G[296]="RESOLUTIONUNIT";G[297]="PAGENUMBER";G[300]="COLORRESPONSEUNIT";G[301]="TRANSFERFUNCTION";
G[305]="SOFTWARE";G[306]="DATETIME";G[315]="ARTIST";G[316]="HOSTCOMPUTER";G[317]="PREDICTOR";G[318]="WHITEPOINT";G[319]="PRIMARYCHROMATICITIES";G[320]="COLORMAP";G[321]="HALFTONEHINTS";G[322]="TILEWIDTH";G[323]="TILELENGTH";G[324]="TILEOFFSETS";G[325]="TILEBYTECOUNTS";G[326]="BADFAXLINES";G[327]="CLEANFAXDATA";G[328]="CONSECUTIVEBADFAXLINES";G[330]="SUBIFD";G[332]="INKSET";G[333]="INKNAMES";G[334]="NUMBEROFINKS";G[336]="DOTRANGE";G[337]="TARGETPRINTER";G[338]="EXTRASAMPLES";G[339]="SAMPLEFORMAT";
G[340]="SMINSAMPLEVALUE";G[341]="SMAXSAMPLEVALUE";G[342]="TRANSFERRANGE";G[347]="JPEGTABLES";G[512]="JPEGPROC";G[513]="JPEGIFOFFSET";G[514]="JPEGIFBYTECOUNT";G[515]="JPEGRESTARTINTERVAL";G[517]="JPEGLOSSLESSPREDICTORS";G[518]="JPEGPOINTTRANSFORM";G[519]="JPEGQTABLES";G[520]="JPEGDCTABLES";G[521]="JPEGACTABLES";G[529]="YCBCRCOEFFICIENTS";G[530]="YCBCRSUBSAMPLING";G[531]="YCBCRPOSITIONING";G[532]="REFERENCEBLACKWHITE";G[700]="XMP";G[33550]="GEOPIXELSCALE";G[33922]="GEOTIEPOINTS";G[33432]="COPYRIGHT";
G[42112]="GDAL_METADATA";G[42113]="GDAL_NODATA";G[50844]="RPCCOEFFICIENT";G[34264]="GEOTRANSMATRIX";G[34735]="GEOKEYDIRECTORY";G[34736]="GEODOUBLEPARAMS";G[34737]="GEOASCIIPARAMS";G[34665]="EXIFIFD";G[34853]="GPSIFD";G[40965]="INTEROPERABILITYIFD";return G})(),w=(()=>{const G=p.slice();G[36864]="ExifVersion";G[40960]="FlashpixVersion";G[40961]="ColorSpace";G[42240]="Gamma";G[37121]="ComponentsConfiguration";G[37122]="CompressedBitsPerPixel";G[40962]="PixelXDimension";G[40963]="PixelYDimension";G[37500]=
"MakerNote";G[37510]="UserComment";G[40964]="RelatedSoundFile";G[36867]="DateTimeOriginal";G[36868]="DateTimeDigitized";G[36880]="OffsetTime";G[36881]="OffsetTimeOriginal";G[36882]="OffsetTimeDigitized";G[37520]="SubSecTime";G[37521]="SubSecTimeOriginal";G[37522]="SubSecTimeDigitized";G[37888]="Temperature";G[37889]="Humidity";G[37890]="Pressure";G[37891]="WaterDepth";G[37892]="Acceleration";G[37893]="CameraElevationAngle";G[42016]="ImageUniqueID";G[42032]="CameraOwnerName";G[42033]="BodySerialNumber";
G[42034]="LensSpecification";G[42035]="LensMake";G[42036]="LensModel";G[42037]="LensSerialNumber";G[33434]="ExposureTime";G[33437]="FNumber";G[34850]="ExposureProgram";G[34852]="SpectralSensitivity";G[34855]="PhotographicSensitivity";G[34856]="OECF";G[34864]="SensitivityType";G[34865]="StandardOutputSensitivity";G[34866]="RecommendedExposureIndex";G[34867]="ISOSpeed";G[34868]="ISOSpeedLatitudeyyy";G[34869]="ISOSpeedLatitudezzz";G[37377]="ShutterSpeedValue";G[37378]="ApertureValue";G[37379]="BrightnessValue";
G[37380]="ExposureBiasValue";G[37381]="MaxApertureValue";G[37382]="SubjectDistance";G[37383]="MeteringMode";G[37384]="LightSource";G[37385]="Flash";G[37386]="FocalLength";G[37396]="SubjectArea";G[41483]="FlashEnergy";G[41484]="SpatialFrequencyResponse";G[41486]="FocalPlaneXResolution";G[41487]="FocalPlaneYResolution";G[41488]="FocalPlaneResolutionUnit";G[41492]="SubjectLocation";G[41493]="ExposureIndex";G[41495]="SensingMethod";G[41728]="FileSource";G[41729]="SceneType";G[41730]="CFAPattern";G[41985]=
"CustomRendered";G[41986]="ExposureMode";G[41987]="WhiteBalance";G[41988]="DigitalZoomRatio";G[41989]="FocalLengthIn35mmFilm";G[41990]="SceneCaptureType";G[41991]="GainControl";G[41992]="Contrast";G[41993]="Saturation";G[41994]="Sharpness";G[41995]="DeviceSettingDescription";G[41996]="SubjectDistanceRange";return G})(),r=(()=>{const G=[];G[1024]="GTModelTypeGeoKey";G[1025]="GTRasterTypeGeoKey";G[1026]="GTCitationGeoKey";G[2048]="GeographicTypeGeoKey";G[2049]="GeogCitationGeoKey";G[2050]="GeogGeodeticDatumGeoKey";
G[2051]="GeogPrimeMeridianGeoKey";G[2052]="GeogLinearUnitsGeoKey";G[2053]="GeogLinearUnitSizeGeoKey";G[2054]="GeogAngularUnitsGeoKey";G[2055]="GeogAngularUnitSizeGeoKey";G[2056]="GeogEllipsoidGeoKey";G[2057]="GeogSemiMajorAxisGeoKey";G[2058]="GeogSemiMinorAxisGeoKey";G[2059]="GeogInvFlatteningGeoKey";G[2061]="GeogPrimeMeridianLongGeoKey";G[2060]="GeogAzimuthUnitsGeoKey";G[3072]="ProjectedCSTypeGeoKey";G[3073]="PCSCitationGeoKey";G[3074]="ProjectionGeoKey";G[3075]="ProjCoordTransGeoKey";G[3076]="ProjLinearUnitsGeoKey";
G[3077]="ProjLinearUnitSizeGeoKey";G[3078]="ProjStdParallel1GeoKey";G[3079]="ProjStdParallel2GeoKey";G[3080]="ProjNatOriginLongGeoKey";G[3081]="ProjNatOriginLatGeoKey";G[3082]="ProjFalseEastingGeoKey";G[3083]="ProjFalseNorthingGeoKey";G[3084]="ProjFalseOriginLongGeoKey";G[3085]="ProjFalseOriginLatGeoKey";G[3086]="ProjFalseOriginEastingGeoKey";G[3087]="ProjFalseOriginNorthingGeoKey";G[3088]="ProjCenterLongGeoKey";G[3090]="ProjCenterEastingGeoKey";G[3091]="ProjCenterNorthingGeoKey";G[3092]="ProjScaleAtNatOriginGeoKey";
G[3093]="ProjScaleAtCenterGeoKey";G[3094]="ProjAzimuthAngleGeoKey";G[3095]="ProjStraightVertPoleLongGeoKey";G[4096]="VerticalCSTypeGeoKey";G[4097]="VerticalCitationGeoKey";G[4098]="VerticalDatumGeoKey";G[4099]="VerticalUnitsGeoKey";return G})(),M=new Map;M.set("EXIFIFD",w);M.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:p,ifdTags:M,geoKeys:r,getTagName:(G,R)=>{R=(R||p)[G];void 0===R&&(R="unknown"+String(G));return R}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(p){const w=new ArrayBuffer(4),r=new Uint8Array(w);(new Uint32Array(w))[0]=1;p.isPlatformLittleEndian=1===r[0];Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],
function(p,w,r){function M(a){return null!=a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function G(a,b,k,f,c){const e=a.length;c=w.createEmptyBand(c,e);if(b)for(let x=0;x<e;x++)b[x]&&(c[x]=k[a[x]-f]);else for(b=0;b<e;b++)c[b]=k[a[b]-f];return c}function R(a,b,k,f){const c=null!=k&&2<=k.length?new Set(k):null;k=1===k?.length?k[0]:null;const e=!!b?.length;for(let x=0;x<a.length;x++)if(f[x]){const t=a[x];if(e){let y=!1;for(let q=0;q<b.length;q+=2)if(t>=b[q]&&t<=
b[q+1]){y=!0;break}y||(f[x]=0)}f[x]&&(t===k||c?.has(t))&&(f[x]=0)}}function J(a,b){const k=a[0].length;for(let f=0;f<k;f++)if(b[f]){let c=!1;for(let e=0;e<a.length;e++)if(a[e][f]){c=!0;break}c||(b[f]=0)}}function L(a,b){const k=a[0].length;for(let f=0;f<k;f++)if(b[f]){let c=!1;for(let e=0;e<a.length;e++)if(0===a[e][f]){c=!0;break}c&&(b[f]=0)}}function B(a,b,k,f,c,e,x,t){return{xmin:c<=k*a?0:c<k*a+a?c-k*a:a,ymin:e<=f*b?0:e<f*b+b?e-f*b:b,xmax:c+x<=k*a?0:c+x<k*a+a?c+x-k*a:a,ymax:e+t<=f*b?0:e+t<f*b+b?
e+t-f*b:b}}function z(a,b,k,f,c,e){const {width:x,height:t}=k.block,{x:y,y:q}=k.offset,{width:D,height:K}=k.mosaic;k=B(x,t,f,c,y,q,D,K);let H=0;var P=0;if(e){var I=e.hasGCSSShiftTransform?360:e.halfWorldWidth??0,S=x*e.resolutionX;const E=e.startX+f*S;E<I&&E+S>I?P=e.rightPadding:E>=I&&(H=e.leftMargin-e.rightPadding,P=0)}k.xmax-=P;if("number"===typeof b)for(e=k.ymin;e<k.ymax;e++)for(P=(c*t+e-q)*D+(f*x-y)+H,I=k.xmin;I<k.xmax;I++)a[P+I]=b;else for(e=k.ymin;e<k.ymax;e++)for(P=(c*t+e-q)*D+(f*x-y)+H,I=e*
x,S=k.xmin;S<k.xmax;S++)a[P+S]=b[I+S]}function l(a,b,k={}){const {clipOffset:f,clipSize:c,alignmentInfo:e,blockWidths:x}=k;if(x)return g(a,b,{blockWidths:x});var t=a.find(V=>M(V));if(null==t)return null;k=c?c.width:b.width;const y=c?c.height:b.height;var q=t.width,D=t.height;const K=b.width/q,H=b.height/D;b={offset:f||{x:0,y:0},mosaic:c||b,block:{width:q,height:D}};q=t.pixelType;var P=w.getPixelArrayConstructor(q);t=t.pixels.length;D=[];for(var I=0;I<t;I++){var S=new P(k*y);for(var E=0;E<H;E++)for(var F=
0;F<K;F++){var Q=a[E*K+F];M(Q)&&(Q=Q.pixels[I],z(S,Q,b,F,E,e))}D.push(S)}P=a.some(V=>null==V||null!=V.mask&&0<V.mask.length);S=a.some(V=>V?.bandMasks&&1<V.bandMasks.length);P=P?new Uint8Array(k*y):void 0;S=S?[]:void 0;if(P){for(I=0;I<H;I++)for(E=0;E<K;E++)F=a[I*K+E],Q=null!=F?F.mask:null,null!=Q?z(P,Q,b,E,I,e):F?z(P,255,b,E,I,e):z(P,0,b,E,I,e);if(S)for(I=0;I<t;I++){E=new Uint8Array(k*y);for(F=0;F<H;F++)for(Q=0;Q<K;Q++){const V=a[F*K+Q],ba=V?.bandMasks?.[I]??V?.mask;null!=ba?z(E,ba,b,Q,F,e):V?z(E,
255,b,Q,F,e):z(E,0,b,Q,F,e)}S.push(E)}}a=new w({width:k,height:y,pixels:D,pixelType:q,bandMasks:S,mask:P});a.updateStatistics();return a}function g(a,b,k){const f=a.find(E=>null!=E);if(null==f)return null;var c=a.some(E=>null!=E?!!E.mask:!0);const {width:e,height:x}=b;b=c?new Uint8Array(e*x):null;({blockWidths:k}=k);const t=[],y=f.getPlaneCount(),q=w.getPixelArrayConstructor(f.pixelType);if(c)for(let E=0,F=0;E<a.length;F+=k[E],E++)if(c=a[E],M(c)){var D=c.mask;for(var K=0;K<x;K++)for(var H=0;H<k[E];H++)b[K*
e+H+F]=null==D?255:D[K*c.width+H]}D=(c=a.some(E=>E?.bandMasks&&1<E.bandMasks.length))?[]:void 0;K=e*x;for(H=0;H<y;H++){const E=new q(K),F=c?new Uint8Array(K):void 0;for(let Q=0,V=0;Q<a.length;V+=k[Q],Q++){const ba=a[Q];if(M(ba)){var P=ba.pixels[H];if(null!=P){for(var I=0;I<x;I++)for(var S=0;S<k[Q];S++)E[I*e+S+V]=P[I*ba.width+S];if(F)for(P=ba.bandMasks?.[H]??ba.mask,I=0;I<x;I++)for(S=0;S<k[Q];S++)F[I*e+S+V]=P?P[I*ba.width+S]:255}}}t.push(E);D&&F&&D.push(F)}a=new w({width:e,height:x,mask:b,bandMasks:D,
pixels:t,pixelType:f.pixelType});a.updateStatistics();return a}function h(a){if(!M(a))return null;const b=a.clone(),{width:k,height:f,pixels:c}=a;var e=c[0];const x=b.pixels[0];a=a.mask;for(let q=2;q<f-1;q++){const D=new Map;for(var t=q-2;t<q+2;t++)for(var y=0;4>y;y++){const K=t*k+y;n(D,e[K],a?a[K]:1)}x[q*k]=d(D);x[q*k+1]=x[q*k+2]=x[q*k];for(t=3;t<k-1;t++)y=(q-2)*k+t+1,n(D,e[y],a?a[y]:1),y=(q-1)*k+t+1,n(D,e[y],a?a[y]:1),y=q*k+t+1,n(D,e[y],a?a[y]:1),y=(q+1)*k+t+1,n(D,e[y],a?a[y]:1),y=(q-2)*k+t-3,u(D,
e[y],a?a[y]:1),y=(q-1)*k+t-3,u(D,e[y],a?a[y]:1),y=q*k+t-3,u(D,e[y],a?a[y]:1),y=(q+1)*k+t-3,u(D,e[y],a?a[y]:1),x[q*k+t]=d(D);x[q*k+t+1]=x[q*k+t]}for(e=0;e<k;e++)x[e]=x[k+e]=x[2*k+e],x[(f-1)*k+e]=x[(f-2)*k+e];b.updateStatistics();return b}function d(a){if(0===a.size)return 0;let b=0,k=-1,f=0;const c=a.keys();let e=c.next();for(;!e.done;)f=a.get(e.value),f>b&&(k=e.value,b=f),e=c.next();return k}function u(a,b,k){0!==k&&(k=a.get(b),1===k?a.delete(b):a.set(b,k-1))}function n(a,b,k){0!==k&&a.set(b,a.has(b)?
a.get(b)+1:1)}function A(a,b,k){let {x:f,y:c}=b;const {width:e,height:x}=k;if(0===f&&0===c&&x===a.height&&e===a.width)return a;const {width:t,height:y}=a;b=Math.max(0,c);const q=Math.max(0,f),D=Math.min(f+e,t),K=Math.min(c+x,y);if(0>D||0>K||!M(a))return null;f=Math.max(0,-f);c=Math.max(0,-c);var {pixels:H}=a,P=e*x,I=H.length;const S=[];for(var E=0;E<I;E++){var F=H[E],Q=w.createEmptyBand(a.pixelType,P);for(let V=b;V<K;V++){const ba=V*t;let da=(V+c-b)*e+f;for(let X=q;X<D;X++)Q[da++]=F[ba+X]}S.push(Q)}H=
new Uint8Array(P);P=a.mask;for(I=b;I<K;I++)for(E=I*t,F=(I+c-b)*e+f,Q=q;Q<D;Q++)H[F++]=P?P[E+Q]:1;a=new w({width:k.width,height:k.height,pixelType:a.pixelType,pixels:S,mask:H});a.updateStatistics();return a}function m(a,b=!0){if(!M(a))return null;const {pixels:k,width:f,height:c,mask:e,pixelType:x}=a;a=[];const t=Math.round(f/2),y=Math.round(c/2),q=c-1,D=f-1;for(var K=0;K<k.length;K++){var H=k[K],P=w.createEmptyBand(x,t*y),I=0;for(var S=0;S<c;S+=2)for(var E=0;E<f;E+=2){var F=H[S*f+E];if(b){var Q=E===
D?F:H[S*f+E+1];const V=S===q?F:H[S*f+E+f],ba=E===D?V:S===q?Q:H[S*f+E+f+1];P[I++]=(F+Q+V+ba)/4}else P[I++]=F}a.push(P)}K=null;if(null!=e)for(K=new Uint8Array(t*y),H=0,P=0;P<c;P+=2)for(I=0;I<f;I+=2)S=e[P*f+I],b?(E=I===D?S:e[P*f+I+1],F=P===q?S:e[P*f+I+f],Q=I===D?F:P===q?E:e[P*f+I+f+1],K[H++]=S*E*F*Q?1:0):K[H++]=S;return new w({width:t,height:y,pixelType:x,pixels:a,mask:K})}function v(a,b,k,f,c=0){const {width:e,height:x}=a,{width:t,height:y}=b;a=f.cols;f=f.rows;b=Math.ceil(t/a-.1/a);const q=Math.ceil(y/
f-.1/f);let D,K,H,P,I;const S=b*a;var E=S*q*f;const F=new Float32Array(E),Q=new Float32Array(E),V=new Uint32Array(E),ba=new Uint32Array(E);let da=0,X,T;for(let ma=0;ma<q;ma++)for(let C=0;C<b;C++){var Y=12*(ma*b+C);E=k[Y];D=k[Y+1];K=k[Y+2];H=k[Y+3];P=k[Y+4];I=k[Y+5];for(var ia=0;ia<f;ia++){da=(ma*f+ia)*S+C*a;T=(ia+.5)/f;for(let O=0;O<ia;O++)X=(O+.5)/a,F[da+O]=(E*X+D*T+K)*e+c,Q[da+O]=(H*X+P*T+I)*x+c,V[da+O]=Math.floor(F[da+O]),ba[da+O]=Math.floor(Q[da+O])}Y+=6;E=k[Y];D=k[Y+1];K=k[Y+2];H=k[Y+3];P=k[Y+
4];I=k[Y+5];for(Y=0;Y<f;Y++)for(da=(ma*f+Y)*S+C*a,T=(Y+.5)/f,ia=Y;ia<a;ia++)X=(ia+.5)/a,F[da+ia]=(E*X+D*T+K)*e+c,Q[da+ia]=(H*X+P*T+I)*x+c,V[da+ia]=Math.floor(F[da+ia]),ba[da+ia]=Math.floor(Q[da+ia])}return{offsets_x:F,offsets_y:Q,offsets_xi:V,offsets_yi:ba,gridWidth:S}}p.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(p.NoDataInterpretation||(p.NoDataInterpretation={}));p.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]=
"fail"})(p.MissingBandAction||(p.MissingBandAction={}));p.approximateTransform=function(a,b,k,f,c="nearest"){if(!M(a))return null;"majority"===c&&(a=h(a));const {pixels:e,mask:x,bandMasks:t,pixelType:y}=a,q=a.width;var D=a.height;const K=w.getPixelArrayConstructor(y),H=e.length,{width:P,height:I}=b;a=!1;for(var S=0;S<k.length;S+=3)-1===k[S]&&-1===k[S+1]&&-1===k[S+2]&&(a=!0);const {offsets_x:E,offsets_y:F,offsets_xi:Q,offsets_yi:V,gridWidth:ba}=v({width:q,height:D},b,k,f,"majority"===c?.5:0);let da;
b=(T,Y,ia,ma)=>{const C=T instanceof Float32Array||T instanceof Float64Array?0:.5;for(let O=0;O<I;O++){da=O*ba;for(let N=0;N<P;N++){if(0>E[da]||0>F[da])T[O*P+N]=0;else if(ma)T[O*P+N]=Y[Q[da]+V[da]*q];else{const W=Math.floor(E[da]),ca=Math.floor(F[da]),aa=Math.ceil(E[da]),ea=Math.ceil(F[da]),ha=E[da]-W,ja=F[da]-ca;T[O*P+N]=!ia||ia[W+ca*q]&&ia[aa+ca*q]&&ia[W+ea*q]&&ia[aa+ea*q]?(1-ja)*((1-ha)*Y[W+ca*q]+ha*Y[aa+ca*q])+ja*((1-ha)*Y[W+ea*q]+ha*Y[aa+ea*q])+C:Y[Q[da]+V[da]*q]}da++}}};k=[];f=t?.length===H;
D=[];for(S=0;S<H;S++){if(f){var X=new Uint8Array(P*I);b(X,t[S],t[S],!0);D.push(X)}X=new K(P*I);b(X,e[S],f?t[S]:x,"nearest"===c||"majority"===c);k.push(X)}c=new w({width:P,height:I,pixelType:y,pixels:k,bandMasks:f?D:void 0});if(null!=x)c.mask=new Uint8Array(P*I),b(c.mask,x,x,!0);else if(a)for(c.mask=new Uint8Array(P*I),a=0;a<P*I;a++)c.mask[a]=0>E[a]||0>F[a]?0:1;c.updateStatistics();return c};p.clip=A;p.clipTile=function(a){const {pixelBlock:b,tileSize:k,level:f,row:c,col:e,useBilinear:x}=a;if(!M(b))return null;
const {width:t,height:y}=k;var q=2**f;a=q*t;q*=y;a=A(b,{y:c*q,x:e*a},{width:a,height:q});if(!a)return null;for(q=f;0<q;q--)a=m(a,x);return a};p.colorize=function(a,b){if(!M(a)||!b||!b.indexedColormap&&!b.indexed2DColormap)return a;const k=a.clone();var f=k.pixels;let c=k.mask;const e=k.width*k.height;if(1!==f.length)return a;const {indexedColormap:x,indexed2DColormap:t,offset:y,alphaSpecified:q}=b;a=0;f=f[0];b=new Uint8Array(f.length);const D=new Uint8Array(f.length),K=new Uint8Array(f.length);var H=
0;if(x){const P=x.length-1;if(null!=c)for(a=0;a<e;a++)c[a]&&(H=4*(f[a]-y),H<y||H>P?c[a]=0:(b[a]=x[H],D[a]=x[H+1],K[a]=x[H+2],c[a]=x[H+3]));else{c=new Uint8Array(e);for(a=0;a<e;a++)H=4*(f[a]-y),H<y||H>P?c[a]=0:(b[a]=x[H],D[a]=x[H+1],K[a]=x[H+2],c[a]=x[H+3]);k.mask=c}}else if(t)if(null!=c)for(a=0;a<e;a++)c[a]&&(H=t[f[a]],b[a]=H[0],D[a]=H[1],K[a]=H[2],c[a]=H[3]);else{c=new Uint8Array(e);for(a=0;a<e;a++)H=t[f[a]],b[a]=H[0],D[a]=H[1],K[a]=H[2],c[a]=H[3];k.mask=c}k.pixels=[b,D,K];k.statistics=null;k.pixelType=
"u8";k.maskIsAlpha=q;return k};p.compositeBands=function(a){if(!a?.length||a.some(y=>!M(y)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:b,height:k,pixelType:f}=a[0];if(a.some(y=>y.width!==b||y.height!==k))return null;const c=a.map(({mask:y})=>y).filter(y=>null!=y);let e=null;c.length&&(e=new Uint8Array(b*k),e.set(c[0]),1<c.length&&L(c.slice(1),e));const x=[];a.forEach(({pixels:y})=>x.push(...y));const t=[];a.map(({statistics:y})=>y).filter(y=>y?.length).forEach(y=>t.push(...y));
return new w({pixelType:f,width:b,height:k,mask:e,pixels:x,statistics:t.length?t:null})};p.createColormapLUT=function(a){if(a){var b=a.colormap;if(b&&0!==b.length){b=b.sort((q,D)=>q[0]-D[0]);var k=0;0>b[0][0]&&(k=b[0][0]);var f=Math.max(256,b[b.length-1][0]-k+1),c=new Uint8Array(4*f),e=[],x=0,t=0,y=5===b[0].length;if(65536<f)return b.forEach(q=>{e[q[0]-k]=y?q.slice(1):q.slice(1).concat([255])}),{indexed2DColormap:e,offset:k,alphaSpecified:y};if(a.fillUnspecified)for(a=b[t],x=a[0]-k;x<f;x++)c[4*x]=
a[1],c[4*x+1]=a[2],c[4*x+2]=a[3],c[4*x+3]=y?a[4]:255,x===a[0]-k&&(a=t===b.length-1?a:b[++t]);else for(x=0;x<b.length;x++)a=b[x],t=4*(a[0]-k),c[t]=a[1],c[t+1]=a[2],c[t+2]=a[3],c[t+3]=y?a[4]:255;return{indexedColormap:c,offset:k,alphaSpecified:y}}}};p.createMaskLUT=function(a,b,k){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var f=a.includes("16")?65536:256;a=a.includes("s")?-f/2:0;f=new Uint8Array(f);if(b)for(let e=0;e<b.length;e++){var c=Math.ceil(b[2*e]-a);const x=Math.floor(b[2*e+1]-
a);for(;c<=x;c++)f[c]=255}else f.fill(255);if(k)for(b=0;b<k.length;b++)f[k[b]-a]=0;return{lut:f,offset:a}};p.createRemapLUT=function(a){const {srcPixelType:b,inputRanges:k,outputValues:f,allowUnmatched:c,noDataRanges:e,isLastInputRangeInclusive:x,outputPixelType:t}=a;if("u8"!==b&&"s8"!==b&&"u16"!==b&&"s16"!==b)return null;var y=b.includes("16")?65536:256;a=b.includes("s")?-y/2:0;const q=w.createEmptyBand(t,y);y=new Uint8Array(y);c&&y.fill(255);const [D,K]=r.getPixelValueRange(t);if(k?.length&&f?.length){var H=
k.map(E=>E-1E-6);H[0]=k[0];x&&(H[H.length-1]=k[k.length-1]);for(var P=0;P<H.length;P++){var I=f[P]>K?K:f[P]<D?D:f[P],S=Math.ceil(H[2*P]-a);const E=Math.floor(H[2*P+1]-a);for(;S<=E;S++)q[S]=I,y[S]=255}}if(e?.length)for(H=0;H<e.length;H++)for(I=Math.ceil(e[2*H]-a),P=Math.floor(e[2*H+1]-a);I<=P;I++)y[I]=0;return{lut:q,offset:a,mask:y}};p.extractBands=function(a,b){return b?.length&&M(a)?a.extractBands(b):a};p.getClipBounds=B;p.getLocalArithmeticNorthRotations=function(a,b){const {coefficients:k,spacing:f}=
b,{offsets_x:c,offsets_y:e,gridWidth:x}=v(a,a,k,{rows:f[0],cols:f[1]}),{width:t,height:y}=a;a=new Float32Array(t*y);b=180/Math.PI;for(let K=0;K<y;K++)for(let H=0;H<t;H++){var q=K*x+H,D=0===K?q:q-x;const P=K===y-1?q:q+x;q=c[D]-c[P];D=e[P]-e[D];isNaN(q)||isNaN(D)?a[K*t+H]=90:(D=Math.atan2(D,q)*b,D=(360+D)%360,a[K*t+H]=D)}return a};p.interpolateOffsets=v;p.isValidPixelBlock=M;p.lookupBandValues=G;p.lookupPixels=function(a,b){if(!M(a))return null;const {pixels:k,mask:f}=a,c=k.length;let e=b.lut;const {offset:x}=
b;e&&1===e[0].length&&(e=k.map(()=>e));const t=[];b=b.outputPixelType||"u8";for(let y=0;y<c;y++){const q=G(k[y],f,e[y],x||0,b);t.push(q)}a=new w({width:a.width,height:a.height,pixels:t,mask:f,pixelType:b});a.updateStatistics();return a};p.mask=function(a,b){if(!M(a))return null;const {width:k,height:f,pixels:c}=a;var e=k*f;const x=new Uint8Array(e);a.mask?x.set(a.mask):x.fill(255);a=c.length;const {includedRanges:t,noDataValues:y,outputPixelType:q,matchAll:D,lookups:K}=b;if(K){e=[];for(b=0;b<a;b++){var H=
K[b];H=G(c[b],x,H.lut,H.offset||0,"u8");e.push(H)}1===e.length?x.set(e[0]):D?J(e,x):L(e,x)}else if(D){b=[];for(H=0;H<a;H++){const P=new Uint8Array(e);P.set(x);R(c[H],t?.slice(2*H,2*H+2),y?.[H],P);b.push(P)}1===b.length?x.set(b[0]):J(b,x)}else for(e=0;e<a;e++)R(c[e],t?.slice(2*e,2*e+2),y?.[e],x);return new w({width:k,height:f,pixelType:q,pixels:c,mask:x})};p.maxMapSizeGpu=6;p.mosaic=l;p.mosaicPixelData=function(a,b){if(!a||0===a.length)return null;var k=a.find(K=>K.pixelBlock);if(null==k?.pixelBlock)return null;
var f=(k.extent.xmax-k.extent.xmin)/k.pixelBlock.width;const c=(k.extent.ymax-k.extent.ymin)/k.pixelBlock.height,e=.01*Math.min(f,c),x=a.sort((K,H)=>Math.abs(K.extent.ymax-H.extent.ymax)>e?H.extent.ymax-K.extent.ymax:Math.abs(K.extent.xmin-H.extent.xmin)>e?K.extent.xmin-H.extent.xmin:0);var t=Math.min.apply(null,x.map(K=>K.extent.xmin));const y=Math.min.apply(null,x.map(K=>K.extent.ymin)),q=Math.max.apply(null,x.map(K=>K.extent.xmax)),D=Math.max.apply(null,x.map(K=>K.extent.ymax));a={x:Math.round((b.xmin-
t)/f),y:Math.round((D-b.ymax)/c)};t={width:Math.round((q-t)/f),height:Math.round((D-y)/c)};f={width:Math.round((b.xmax-b.xmin)/f),height:Math.round((b.ymax-b.ymin)/c)};if(Math.round(t.width/k.pixelBlock.width)*Math.round(t.height/k.pixelBlock.height)!==x.length||0>a.x||0>a.y||t.width<f.width||t.height<f.height)return null;k=x.map(K=>K.pixelBlock);k=l(k,t,{clipOffset:a,clipSize:f});return{extent:b,pixelBlock:k}};p.remap=function(a,b){if(!M(a))return null;const {width:k,height:f}=a,{inputRanges:c,outputValues:e,
outputPixelType:x,noDataRanges:t,allowUnmatched:y,isLastInputRangeInclusive:q}=b;b=a.pixels[0];const D=w.createEmptyBand(x,b.length),K=a.mask,H=new Uint8Array(k*f);K?H.set(K):H.fill(255);const P=a.pixelType.startsWith("f")?1E-6:0;a=c.map(da=>da-P);a[0]=c[0];a[a.length-1]=c[c.length-1]+(q?1E-6:0);var I=c.length/2;const [S,E]=r.getPixelValueRange(x);for(var F=0;F<f;F++)for(var Q=0;Q<k;Q++){var V=F*k+Q;if(H[V]){var ba=b[V];let da=!1;for(let X=I-1;0<=X;X--)if(ba===a[2*X]||ba>a[2*X]&&ba<a[2*X+1]){D[V]=
e[X];da=!0;break}da||(y?D[V]=ba>E?E:ba<S?S:ba:H[V]=0)}}if(a=t?.length)for(I=0;I<f;I++)for(F=0;F<k;F++)if(Q=I*k+F,!K||K[Q])for(V=b[Q],ba=0;ba<a;ba+=2)if(V>=t[ba]&&V<=t[ba+1]){D[Q]=0;H[Q]=0;break}return new w({width:k,height:f,pixelType:x,pixels:[D],mask:H})};p.remapColor=function(a,b){if(!M(a))return null;a=a.clone();var {pixels:k}=a;const f=a.width*a.height,c=b.length,e=Math.floor(c/2),x=b[Math.floor(e)];k=k[0];let t,y,q,D,K,H,P=!1;const I=new Uint8Array(f),S=new Uint8Array(f),E=new Uint8Array(f);
let F=a.mask;const Q=4===b[0].mappedColor.length;F||(F=new Uint8Array(f),F.fill(Q?255:1),a.mask=F);for(K=0;K<f;K++)if(F[K]){t=k[K];P=!1;H=e;y=x;q=0;for(D=c-1;1<D-q;){if(t===y.value){P=!0;break}t>y.value?q=H:D=H;H=Math.floor((q+D)/2);y=b[Math.floor(H)]}P||(t===b[q].value?(y=b[q],P=!0):t===b[D].value?(y=b[D],P=!0):t<b[q].value?(P=!1,y=null):t>b[q].value&&(t<b[D].value?(y=b[q],P=!0):D===c-1?(P=!1,y=null):(y=b[D],P=!0)));P?(I[K]=y.mappedColor[0],S[K]=y.mappedColor[1],E[K]=y.mappedColor[2],F[K]=y.mappedColor[3]):
I[K]=S[K]=E[K]=F[K]=0}a.pixels=[I,S,E];a.mask=F;a.pixelType="u8";a.maskIsAlpha=Q;return a};p.resampleByMajority=h;p.setValidBoundary=function(a,b,k){if(!M(a))return null;const {width:f,height:c}=a,e=b.x;b=b.y;const x=k.width+e;k=k.height+b;if(0>e||0>b||x>f||k>c||0===e&&0===b&&x===f&&k===c)return a;a.mask||(a.mask=new Uint8Array(f*c));const t=a.mask;for(let y=0;y<c;y++){const q=y*f;for(let D=0;D<f;D++)t[q+D]=y<b||y>=k||D<e||D>=x?0:1}a.updateStatistics();return a};p.split=function(a,b,k=0,f=!0){if(!M(a))return null;
const {width:c,height:e}=b;let {width:x,height:t}=a;const y=new Map,q={x:0,y:0};k=1+k;for(let D=0;D<k;D++){const K=Math.ceil(x/c),H=Math.ceil(t/e);for(let P=0;P<H;P++){q.y=P*e;for(let I=0;I<K;I++){q.x=I*c;const S=A(a,q,b);y.set(`${D}/${P}/${I}`,S)}}D<k-1&&(a=m(a,f));x=Math.round(x/2);t=Math.round(t/2)}return y};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./ArithmeticFunction ./AspectFunction ./BandArithmeticFunction ./ClipFunction ./ColormapFunction ./ColormapToRGBFunction ./CompositeBandFunction ./ComputeChangeFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./GrayscaleFunction ./HillshadeFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./ShadedReliefFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g,h,d,u,n,A,m,v,a,b,k,f,c,e,x,t,y){function q(T,Y){({rasterFunctionArguments:T}=T);T&&(T.rasters||[T.raster,T.raster2]).forEach(ia=>{ia&&"number"!==typeof ia&&("string"===typeof ia?ia.startsWith("http")&&(Y.includes(ia)||Y.push(ia)):"rasterFunctionArguments"in ia&&q(ia,Y))})}function D(T,Y){return"rasters"===Y[0]&&Array.isArray(T.rasters)?T.rasters:Y.map(ia=>T[ia])}function K(T){return!!(T&&"object"===typeof T&&T.rasterFunction&&T.rasterFunctionArguments)}function H(T){const {rasterFunction:Y,
rasterFunctionArguments:ia}=T,ma={};for(const O in ia){let N=ia[O];var C=O.toLowerCase();if("rasters"===C&&Array.isArray(N))ma.rasters=N.map(W=>K(W)?H(W):W);else switch(K(N)&&(N=H(N)),C){case "dra":ma.dra=N;break;case "pspower":ma.psPower=N;break;case "pszfactor":ma.psZFactor=N;break;case "bandids":ma.bandIds=N;break;default:C=O[0].toLowerCase()+O.slice(1),ma[C]=N}}"Local"!==Y||ma.rasters?.length||(ma.rasters=["$$"]);return{...T,rasterFunctionArguments:ma}}function P(T,Y){const {rasterFunction:ia,
rasterFunctionArguments:ma}=T;var C=T.outputPixelType?.toLowerCase();if(null==ia||!X.has(ia))throw new r("raster-function-helper",`unsupported raster function: ${ia}`);var O=X.get(ia);const N=("function"===typeof O.ctor?O.ctor:O.ctor["default"]).fromJSON({...T,outputPixelType:C});({rasterArgumentNames:T}=N);C=[];O=D(ma,T);const W="rasters"===T[0]||1<T.length,ca=[];for(let aa=0;aa<O.length;aa++){const ea=O[aa];let ha;null==ea||"string"===typeof ea&&ea.startsWith("$")?C.push(Y?.raster):"string"===typeof ea?
Y[ea]&&C.push(Y[ea]):"number"!==typeof ea&&"rasterFunction"in ea&&(ha=P(ea,Y),W||(N.functionArguments[T[aa]]=ha),C.push(ha));W&&ca.push(ha??ea)}W&&("rasters"===T[0]?N.functionArguments.rasters=ca:T.forEach((aa,ea)=>{N.functionArguments[aa]=ca[ea]}));Y&&(N.sourceRasters=C,Y=Y.raster?.url)&&(N.mainPrimaryRasterId=Y);return N}function I(T,Y){if(T&&Y)for(const ia in T){const ma=T[ia];ma&&"object"===typeof ma&&"type"in ma&&("RasterFunctionTemplate"===ma.type?I(ma.arguments,Y):"RasterFunctionVariable"===
ma.type&&null!=Y[ma.name]&&(ma.value=Y[ma.name]))}}function S(T,Y){if(!T||"object"!==typeof T)return T;const {value:ia}=T;if(!ia||"object"!==typeof ia)return T.isDataset?"$$":ia;if(Array.isArray(ia))return 0===ia.length?[]:ia.map(C=>"object"===typeof C&&"RasterFunctionVariable"===C.type?S(C,Y):C);if("value"in ia&&["number","string","boolean"].includes(typeof ia.value))return ia.value;if(T.isDataset&&"Scalar"!==ia.type)return"$$";if(!("type"in ia))return ia;T=ia;switch(ia.type){case "Scalar":T=ia.value;
break;case "AlgorithmicColorRamp":T=E(ia);break;case "MultiPartColorRamp":T={type:"multipart",colorRamps:ia.ArrayOfColorRamp.map(E)};break;case "ArgumentArray":if(ia.elements?.length&&"RasterStatistics"!==ia.elements[0].type){T=[];for(let C=0;C<ia.elements.length;C++){const O=ia.elements[C];var {type:ma}=O;if(ma)if("RasterFunctionTemplate"===ma)({renderingRule:ma}=F(O,Y)),T.push(ma),null!=O._object_id&&Y.set(O._object_id,ma);else if("RasterFunctionVariable"===ma)ma=S(O,Y),T.push(ma),null!=O._object_id&&
Y.set(O._object_id,ma);else throw new r("raster-function-helper","unsupported raster function json.");else T.push(O)}}else T=ia.elements}null!=ia._object_id&&Y.set(ia._object_id,T);return T}function E(T){const Y=T.algorithm??"esriHSVAlgorithm";let {FromColor:ia,ToColor:ma}=T;if(!Array.isArray(ia)){const {r:C,g:O,b:N}=w.toRGB({h:ia.Hue,s:ia.Saturation,v:ia.Value});ia=[C,O,N,ia.AlphaValue]}if(!Array.isArray(ma)){const {r:C,g:O,b:N}=w.toRGB({h:ma.Hue,s:ma.Saturation,v:ma.Value});ma=[C,O,N,ma.AlphaValue]}return{type:"algorithmic",
algorithm:Y,fromColor:ia,toColor:ma}}function F(T,Y,ia){ia&&I(T,ia);Y={renderingRule:{},templates:Y};Q(T,Y);return Y}function Q(T,Y){if(T&&Y.renderingRule){var {renderingRule:ia,templates:ma}=Y,{function:C,arguments:O,_object_id:N}=T;if(C&&O){null!=N&&ma.set(N,ia);ia.rasterFunction=C.type.replace("Function","");ia.outputPixelType=C.pixelType;T={};ia.rasterFunctionArguments=T;for(const W in O)"type"!==W&&"object_id"!==W&&"_object_ref_id"!==W&&((Y=O[W])&&"object"===typeof Y&&"type"in Y&&("RasterFunctionTemplate"===
Y.type||"RasterFunctionVariable"===Y.type)?("RasterFunctionVariable"===Y.type?T[W]=S(Y,ma):(ia.rasterFunctionArguments[W]={},Q(Y,{renderingRule:ia.rasterFunctionArguments[W],templates:ma})),null!=Y._object_id&&ma.set(Y._object_id,T[W])):T[W]=Y);T.DEM&&!T.Raster&&(T.Raster=T.DEM,delete T.DEM);switch(ia.rasterFunction){case "Stretch":ba(T);break;case "Colormap":"randomcolorramp"===T.ColorRamp?.type?.toLowerCase()&&(delete T.ColorRamp,T.ColormapName="Random");0===T.ColorSchemeType&&delete T.ColorRamp;
break;case "Convolution":null!=T.ConvolutionType&&(T.Type=T.ConvolutionType,delete T.ConvolutionType);break;case "Mask":da(T)}}}}function V(T){const {renderingRule:Y,templates:ia}=T;if("object"===typeof Y&&Y?.rasterFunctionArguments&&ia.size){({rasterFunctionArguments:T}=Y);for(const ma in T){const C=T[ma],O="_object_ref_id"===ma?C:C&&"object"===typeof C&&"_object_ref_id"in C?C._object_ref_id:null;if(null!=O){if(!ia.has(O))throw new r("raster-function-helper",`unsupported raster function json. _object_ref_id: ${O} does not exist`);
const N=ia.get(O);"_object_ref_id"!==ma?T[ma]=N:N&&"object"===typeof N&&Object.assign(T,N)}else C&&"object"===typeof C&&(C.rasterFunctionArguments&&V({renderingRule:C,templates:ia}),Array.isArray(C)&&C.forEach((N,W)=>{if("object"===typeof N)if(null!=N._object_ref_id){if(!ia.has(N._object_ref_id))throw new r("raster-function-helper",`unsupported raster function json. _object_ref_id: ${C} does not exist`);const ca=ia.get(O);ca&&"object"===typeof ca?Object.assign(N,ca):C[W]=ca}else V({renderingRule:N,
templates:ia})}))}}}function ba(T){T.Statistics?.length&&"object"===typeof T.Statistics&&(T.Statistics=T.Statistics.map(Y=>[Y.min,Y.max,Y.mean,Y.standardDeviation]));null!=T.NumberOfStandardDeviation&&(T.NumberOfStandardDeviations=T.NumberOfStandardDeviation,delete T.NumberOfStandardDeviation)}function da(T){T.NoDataValues?.length&&"string"===typeof T.NoDataValues[0]&&(T.NoDataValues=T.NoDataValues.filter(Y=>""!==Y).map(Y=>Number(Y)))}const X=new Map;X.set("Arithmetic",{desc:"Arithmetic Function",
ctor:G,rasterArgumentNames:["rasters"]});X.set("Aspect",{desc:"Aspect Function",ctor:R,rasterArgumentNames:["raster"]});X.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:J,rasterArgumentNames:["raster"]});X.set("Colormap",{desc:"Colormap Function",ctor:B,rasterArgumentNames:["raster"]});X.set("ColormapToRGB",{desc:"ColormapToRGB Function",ctor:z,rasterArgumentNames:["raster"]});X.set("CompositeBand",{desc:"CompositeBand Function",ctor:l,rasterArgumentNames:["rasters"]});X.set("ComputeChange",
{desc:"ComputeChange Function",ctor:g,rasterArgumentNames:["rasters"]});X.set("Convolution",{desc:"Convolution Function",ctor:d,rasterArgumentNames:["raster"]});X.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:h,rasterArgumentNames:["raster"]});X.set("ExtractBand",{desc:"ExtractBand Function",ctor:n,rasterArgumentNames:["raster"]});X.set("Curvature",{desc:"Curvature Function",ctor:u,rasterArgumentNames:["raster"]});X.set("Hillshade",{desc:"Hillshade Function",ctor:m,rasterArgumentNames:["raster"]});
X.set("ShadedRelief",{desc:"ShadedRelief Function",ctor:f,rasterArgumentNames:["raster"]});X.set("Grayscale",{desc:"Grayscale Function",ctor:A,rasterArgumentNames:["raster"]});X.set("Clip",{desc:"Clip Function",ctor:L,rasterArgumentNames:["raster"]});X.set("Local",{desc:"Local Function",ctor:v,rasterArgumentNames:["rasters"]});X.set("Mask",{desc:"Mask Function",ctor:a,rasterArgumentNames:["raster"]});X.set("NDVI",{desc:"NDVI Function",ctor:b,rasterArgumentNames:["raster"]});X.set("Remap",{desc:"Remap Function",
ctor:k,rasterArgumentNames:["raster"]});X.set("Slope",{desc:"Slope Function",ctor:c,rasterArgumentNames:["raster"]});X.set("Statistics",{desc:"Focal Statistics Function",ctor:e,rasterArgumentNames:["raster"]});X.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:x,rasterArgumentNames:["raster"]});X.set("Stretch",{desc:"Stretch Function",ctor:t,rasterArgumentNames:["raster"]});X.set("Table",{desc:"Attribute Table Function",ctor:y,rasterArgumentNames:["raster"]});p.create=function(T,
Y){Y=Y??{};T=M.clone(T);if("function"in T&&"arguments"in T&&T.arguments){const ia=new Map;T=F(T,ia,Y);V(T);if(!T.renderingRule)throw new r("raster-function-helper","Unsupported raster function json.");T=T.renderingRule}if("rasterFunction"in T)return T=H(T),P(T,Y);throw new r("raster-function-helper","unsupported raster function json.");};p.getPrimaryRasterUrls=q;p.getRasterValues=D;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./ArithmeticFunctionArguments ./BaseRasterFunction ./localUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){r=class extends B{constructor(){super(...arguments);this.functionName="Arithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){var {operation:l}=this.functionArguments;if(1>l||6<l)return{success:!1,supportsGPU:!1,error:"unsupported operation"};l=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(l.pixelType);l.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(l);this.rasterInfo=
l;return{success:!0,supportsGPU:3>=l.bandCount}}_processPixels(l){({pixelBlocks:l}=l);return null==l?.[0]||null==l?.[1]?null:z.arithmetic(l,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){var {operation:l}=this.functionArguments;l=" plus minus times divide power mod".split(" ")[l];var g=this.outputPixelType??"f32";let [h,d]=J.getPixelValueRange(g);if(g=J.isIntegerPixelType(g))h-=1E-4,d+=1E-4;return{imageCount:2,operationName:l,domainRange:[h,d],isOutputRounded:g}}};p.__decorate([w.property({json:{write:!0,
name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ArithmeticFunction")],r)})},"esri/layers/support/rasterFunctions/ArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J){var L;r=L=class extends J{constructor(){super(...arguments);this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new L({raster:this.raster,raster2:this.raster2,operation:this.operation})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"operation",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"raster2",void 0);p.__decorate([w.property({readOnly:!0})],r.prototype,"rasters",null);return r=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],
r)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(p,w,r,M,G,R,J){w=class extends w.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};p.__decorate([r.property({json:{write:!0}})],w.prototype,"raster",void 0);return w=
p.__decorate([J.subclass("esri.layers.support.rasterFunctions.BaseFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),function(p,w,r,M,G,R,J,L,B){const z=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));
w=class extends w.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.rawSourceRasterInfos=null;this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var l=this.getWebGLProcessorDefinition();if(!l)return null;const g=[l];({parameters:l}=l);for(l=l.rasters||
l.raster&&[l.raster];l?.length;){g.unshift(...l);var h=[];for(var d=0;d<l.length;d++){var {parameters:u}=l[d];u=u.rasters||u.raster&&[u.raster];u?.length&&h.push(...u)}l=h}for(l=g.length-1;0<=l;l--)g[l].isNoopProcess&&g.splice(l,1);l=!1;for(h=0;h<g.length;h++)d=g[h],d.id=g.length-h-1,{rasters:d}=d.parameters,l=l||null!=d&&1<d.length;h=g.some(({name:n})=>z.has(n.toLowerCase()));({rawSourceRasterInfos:d}=this);return{functions:g,hasBranches:l,hasFocalFunction:h,isSourceSingleBand:1===d?.[0]?.bandCount}}bind(l,
g=!1,h=-1){this.id=h+1;h=this._getRasterValues();let d=!0;for(let n=0;n<h.length;n++){var u=h[n];if(null!=u&&this._isRasterFunctionValue(u)){u=u.bind(l,g,this.id+n);if(!u.success)return this._bindingResult=u;d=d&&u.supportsGPU}}if(!this.rasterInfo||g)return this.sourceRasterInfos=this._getSourceRasterInfos(l),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=d&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(l){var g=this._getRasterValues();g=0===g.length?l.pixelBlocks??l.primaryPixelBlocks:g.map(h=>this._readRasterValue(h,l));return this._processPixels({...l,pixelBlocks:g})}processInputBandIds(){var l=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<l.length)return this.rawInputBandIds=l.map(h=>h.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((h,
d)=>h!==d),l=l.filter(h=>"ExtractBand"===h.functionName),l.length&&l.forEach((h,d)=>{h.isInputBandIdsSwizzled=!0;h.swizzledBandSelection=[d,d,d]}),this.rawInputBandIds;var g=l[0];if(g){if(l=g.processInputBandIds(),g.isInputBandIdsSwizzled)return this.rawInputBandIds=l}else{l=[];({bandCount:g}=this.sourceRasterInfos[0]);for(let h=0;h<g;h++)l.push(h)}l=this._getInputBandIds(l);this.isInputBandIdsSwizzled=l.some((h,d)=>h!==d);return this.rawInputBandIds=l}getPrimaryRasters(){const l=[],g=[];this._getPrimaryRasters(this,
l,g);return{rasters:l,rasterIds:g}}getWebGLProcessorDefinition(){const l=this._getWebGLParameters(),{raster:g,rasters:h}=this.functionArguments;h&&Array.isArray(h)&&h.length?(l.rasters=h.map(d=>this._isRasterFunctionValue(d)?d.getWebGLProcessorDefinition():"number"===typeof d?{name:"Constant",parameters:{value:d},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:d},pixelType:"f32",id:-1,isNoopProcess:!1}),l.rasters.some(d=>null!=d)||(l.rasters=null)):this._isRasterFunctionValue(g)&&
(l.raster=g.getWebGLProcessorDefinition());return{name:this.functionName,parameters:l,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}getClippingGeometries(){const l=[];"Clip"===this.functionName&&l.push(this.functionArguments);const {raster:g,rasters:h}=this.functionArguments;if(h&&Array.isArray(h)&&h.length)h.forEach(d=>{this._isRasterFunctionValue(d)&&(d=d.getClippingGeometries(),l.push(...d))});else if(this._isRasterFunctionValue(g)){const d=g.getClippingGeometries();
l.push(...d)}return l}_getOutputPixelType(l){return"unknown"===this.outputPixelType?l:this.outputPixelType??l}_getWebGLParameters(){return{}}_getInputBandIds(l){return l}_removeStatsHistColormapVAT(l){l.statistics=null;l.histograms=null;l.colormap=null;l.attributeTable=null;l.multidimensionalInfo?.variables.forEach(g=>{g.statistics=void 0;g.histograms=void 0})}_getRasterValues(){const {rasterArgumentNames:l}=this;return"rasters"===l[0]?this.functionArguments.rasters??[]:l.flatMap(g=>this.functionArguments[g])}_getSourceRasterInfos(l){const g=
this._getRasterValues(),{rasterInfos:h,rasterIds:d}=l;if(0===g.length)return h;const u=g.map(A=>{if(A&&"object"===typeof A&&"bind"in A&&A.rasterInfo)return A.rasterInfo;if("string"===typeof A&&d.includes(A))return h[d.indexOf(A)];if("number"!==typeof A)return h[0]}),n=u.find(A=>A)??h[0];u.forEach((A,m)=>{void 0===A&&(u[m]=n)});return u}_getPrimaryRasterId(l){return l?.rasterId}_getPrimaryRasters(l,g=[],h=[]){for(let u=0;u<l.sourceRasters.length;u++){var d=l.sourceRasters[u];if("number"!==typeof d)if("bind"in
d)this._getPrimaryRasters(d,g,h);else{const n=this._getPrimaryRasterId(d);null==n||h.includes(n)||(this.mainPrimaryRasterId===n?(g.unshift(d),h.unshift(n)):(g.push(d),h.push(n)))}}}_isRasterFunctionValue(l){return null!=l&&"object"===typeof l&&"getWebGLProcessorDefinition"in l}_readRasterValue(l,g){var {primaryPixelBlocks:h}=g;if(null==l||"$$"===l)return l=h[0],null==l?null:l.clone();if("string"===typeof l)return l=g.primaryRasterIds.indexOf(l),-1===l?null:h[l];if("number"===typeof l){h=h[0];if(null==
h)return null;const {width:d,height:u,pixelType:n}=h;h=new Float32Array(d*u);h.fill(l);l=Array(this.sourceRasterInfos[0].bandCount).fill(h);return new L({width:d,height:u,pixelType:n,pixels:l})}return l.process(g)}_patchRasterInfo(){const {rasterInfo:l}=this;if(l?.keyProperties){var {bandCount:g,keyProperties:h,statistics:d,histograms:u}=l,n=h.BandProperties;n&&n.length!==g&&(l.keyProperties={...h,BandProperties:void 0});d&&d.length!==g&&(l.statistics=d.length>g?d.slice(0,g):null);u&&u.length!==g&&
(l.histograms=u.length>g?u.slice(0,g):null);h.BAND_COUNT&&Number(h.BAND_COUNT)!==g&&(l.keyProperties={...h,BAND_COUNT:"string"===typeof h.BAND_COUNT?String(g):g})}}};p.__decorate([r.property({json:{write:!0}})],w.prototype,"functionName",void 0);p.__decorate([r.property({json:{write:!0}})],w.prototype,"functionArguments",void 0);p.__decorate([r.property()],w.prototype,"rasterArgumentNames",void 0);p.__decorate([r.property({json:{write:!0}}),M.cast(l=>l?.toLowerCase())],w.prototype,"outputPixelType",
void 0);p.__decorate([r.property({json:{write:!0}})],w.prototype,"mainPrimaryRasterId",void 0);p.__decorate([r.property()],w.prototype,"sourceRasters",void 0);p.__decorate([r.property({type:[B],json:{write:!0}})],w.prototype,"sourceRasterInfos",void 0);p.__decorate([r.property({json:{write:!0}})],w.prototype,"rasterInfo",void 0);p.__decorate([r.property({json:{write:!0}})],w.prototype,"readingBufferSize",void 0);p.__decorate([r.property({json:{write:!0}})],w.prototype,"id",void 0);p.__decorate([r.property()],
w.prototype,"isNoopProcess",void 0);p.__decorate([r.property()],w.prototype,"supportsGPU",null);p.__decorate([r.property()],w.prototype,"rawInputBandIds",void 0);p.__decorate([r.property()],w.prototype,"rawSourceRasterInfos",void 0);p.__decorate([r.property()],w.prototype,"isInputBandIdsSwizzled",void 0);p.__decorate([r.property()],w.prototype,"swizzledBandSelection",void 0);p.__decorate([r.property()],w.prototype,"isBranch",void 0);p.__decorate([r.property({readOnly:!0})],w.prototype,"flatWebGLFunctionChain",
null);p.__decorate([r.property()],w.prototype,"_bindingResult",void 0);return w=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],w)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g){var h;w=h=class extends w.JSONSupport{constructor(d){super(d);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var d=this.keyProperties.BandProperties,{bandCount:u}=
this;if(!d?.length||d.length<u){d=[];for(let n=1;n<=u;n++)d.push(new z({name:"band_"+n}));return d}u=d.map(n=>z.fromJSON(n));for(d=0;d<u.length;d++)u[d].name=u[d].name||"band_"+(d+1);return u}get dataType(){const d=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===d?"standard-time":d}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(d){d&&this._set("nativeExtent",d)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;
const d=this.nativeExtent;return{x:d.width/this.width,y:d.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return l.fromJSON(this.keyProperties)}clone(){return new h({attributeTable:r.clone(this.attributeTable),bandCount:this.bandCount,colormap:r.clone(this.colormap),extent:r.clone(this.extent),format:this.format,height:this.height,width:this.width,histograms:r.clone(this.histograms),keyProperties:r.clone(this.keyProperties),
multidimensionalInfo:r.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:r.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:r.clone(this.spatialReference),statistics:r.clone(this.statistics),storageInfo:r.clone(this.storageInfo),transform:r.clone(this.transform)})}};p.__decorate([M.property({json:{write:!0}})],w.prototype,"attributeTable",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"bandCount",
void 0);p.__decorate([M.property({readOnly:!0})],w.prototype,"bandInfos",null);p.__decorate([M.property({json:{write:!0}})],w.prototype,"colormap",void 0);p.__decorate([M.property({type:String,readOnly:!0})],w.prototype,"dataType",null);p.__decorate([M.property({type:L,json:{write:!0}})],w.prototype,"extent",void 0);p.__decorate([M.property({type:L,json:{write:!0}})],w.prototype,"nativeExtent",null);p.__decorate([M.property({json:{write:!0}})],w.prototype,"nativePixelSize",null);p.__decorate([M.property({json:{write:!0}})],
w.prototype,"format",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"height",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"width",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"hasMultidimensionalTranspose",null);p.__decorate([M.property({json:{write:!0}})],w.prototype,"histograms",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"keyProperties",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"multidimensionalInfo",
void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"noDataValue",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"pixelSize",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"pixelType",void 0);p.__decorate([M.property()],w.prototype,"isPseudoSpatialReference",void 0);p.__decorate([M.property({readOnly:!0})],w.prototype,"sensorInfo",null);p.__decorate([M.property({type:B,json:{write:!0}})],w.prototype,"spatialReference",void 0);p.__decorate([M.property({json:{write:!0}})],
w.prototype,"statistics",void 0);p.__decorate([M.property({type:g,json:{write:!0}})],w.prototype,"storageInfo",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"transform",void 0);return w=h=p.__decorate([J.subclass("esri.layers.support.RasterInfo")],w)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,w,r,M,G,R,J){function L(z){z=Number(z);return isNaN(z)?void 0:z}var B;w=B=class extends w.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new B({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};p.__decorate([r.property({json:{name:"BandName",write:!0}})],w.prototype,"name",void 0);p.__decorate([r.property({json:{name:"WavelengthMin",read:{reader:L},write:!0}})],w.prototype,"minWavelength",void 0);p.__decorate([r.property({json:{name:"WavelengthMax",read:{reader:L},write:!0}})],w.prototype,"maxWavelength",void 0);p.__decorate([r.property({json:{name:"RadianceBias",read:{reader:L},write:!0}})],w.prototype,"radianceBias",
void 0);p.__decorate([r.property({json:{name:"RadianceGain",read:{reader:L},write:!0}})],w.prototype,"radianceGain",void 0);p.__decorate([r.property({json:{name:"ReflectanceBias",read:{reader:L},write:!0}})],w.prototype,"reflectanceBias",void 0);p.__decorate([r.property({json:{name:"ReflectanceGain",read:{reader:L},write:!0}})],w.prototype,"reflectanceGain",void 0);p.__decorate([r.property({json:{name:"SolarIrradiance",read:{reader:L},write:!0}})],w.prototype,"solarIrradiance",void 0);return w=B=
p.__decorate([J.subclass("esri.layers.support.RasterBandInfo")],w)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(p,w,r,M,G,R,J,L,B){function z(g){g=Number(g);return isNaN(g)?void 0:
g}var l;w=l=class extends w.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(g){return new Date(g)}writeAcquisitionDate(g,h){h.AcquisitionDate=g.getTime()}clone(){return new l({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};p.__decorate([r.property({json:{name:"AcquisitionDate",write:!0}})],w.prototype,"acquisitionDate",void 0);p.__decorate([J.reader("acquisitionDate")],w.prototype,"readAcquisitionDate",null);p.__decorate([B.writer("acquisitionDate")],w.prototype,"writeAcquisitionDate",null);p.__decorate([r.property({json:{name:"CloudCover",read:{reader:z},write:!0}})],w.prototype,"cloudCover",void 0);p.__decorate([r.property({json:{name:"ProductName",
write:!0}})],w.prototype,"productName",void 0);p.__decorate([r.property({json:{name:"SensorName",write:!0}})],w.prototype,"sensorName",void 0);p.__decorate([r.property({json:{name:"SensorAzimuth",read:{reader:z},write:!0}})],w.prototype,"sensorAzimuth",void 0);p.__decorate([r.property({json:{name:"SensorElevation",read:{reader:z},write:!0}})],w.prototype,"sensorElevation",void 0);p.__decorate([r.property({json:{name:"SunAzimuth",read:{reader:z},write:!0}})],w.prototype,"sunAzimuth",void 0);p.__decorate([r.property({json:{name:"SunElevation",
read:{reader:z},write:!0}})],w.prototype,"sunElevation",void 0);return w=l=p.__decorate([L.subclass("esri.layers.support.RasterSensorInfo")],w)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(p,w,r,M,G,R,J,L){var B;w=B=class extends w.JSONSupport{constructor(){super(...arguments);
this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new B({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:r.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,
pyramidResolutions:r.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:r.clone(this.tileInfo),transposeInfo:r.clone(this.transposeInfo),blockBoundary:r.clone(this.blockBoundary)})}};p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,"blockWidth",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,
"blockHeight",void 0);p.__decorate([M.property({type:String,json:{write:!0}})],w.prototype,"compression",void 0);p.__decorate([M.property({type:L,json:{write:!0}})],w.prototype,"origin",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,"firstPyramidLevel",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,"maximumPyramidLevel",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"pyramidResolutions",void 0);p.__decorate([M.property({type:Number,
json:{write:!0}})],w.prototype,"pyramidScalingFactor",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,"pyramidBlockWidth",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],w.prototype,"pyramidBlockHeight",void 0);p.__decorate([M.property({type:Boolean,json:{write:!0}})],w.prototype,"isVirtualTileInfo",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"tileInfo",void 0);p.__decorate([M.property()],w.prototype,"transposeInfo",void 0);p.__decorate([M.property()],
w.prototype,"blockBoundary",void 0);return w=B=p.__decorate([J.subclass("esri.layers.support.RasterStorageInfo")],w)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(p,w,r,M){function G(U,ka=!1){var Z=U.map(fa=>fa.mask);const la=Z.filter(fa=>null!=fa);U=U[0].pixels[0].length;if(0===la.length||ka&&la.length!==Z.length)return(new Uint8Array(U)).fill(255);Z=new Uint8Array(la[0]);
if(1===la.length)return Z;if(!ka){for(ka=1;ka<la.length;ka++){U=la[ka];for(var oa=0;oa<Z.length;oa++)Z[oa]&&(Z[oa]=U[oa]?255:0)}return Z}for(ka=1;ka<la.length;ka++)for(U=la[ka],oa=0;oa<Z.length;oa++)0===Z[oa]&&(Z[oa]=U[oa]?255:0);return Z}function R(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]+oa[fa];return Z}function J(U,ka,Z){[U]=U;ka=w.createEmptyBand("f32",U.length);ka.set(U);return ka}function L(U,ka,Z){[U]=U;const la=U.length;
Z=w.createEmptyBand(Z,la);for(let oa=0;oa<la;oa++)if(!ka||ka[oa])Z[oa]=U[oa]*U[oa];return Z}function B(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]-oa[fa];return Z}function z(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]*oa[fa];return Z}function l(U,ka,Z){[U]=U;const la=U.length;Z=w.createEmptyBand(Z,la);for(let oa=0;oa<la;oa++)if(!ka||ka[oa])Z[oa]=Math.sign(U[oa])*
Math.floor(Math.abs(U[oa]));return Z}function g(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]/oa[fa];return Z}function h(U,ka,Z){return g(U,ka,"f32")}function d(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=Math.floor(la[fa]/oa[fa]);return Z}function u(U,ka,Z,la){U=U[0];const oa=U.length;Z=w.createEmptyBand(Z,oa);if(la===r.localTrigonometricOperation.atanh){for(la=0;la<oa;la++)if(ka[la]){var fa=
U[la];1<=Math.abs(fa)?ka[la]=0:Z[la]=Math.atanh(fa)}return Z}la=la===r.localTrigonometricOperation.asin?Math.asin:Math.acos;for(fa=0;fa<oa;fa++)if(ka[fa]){const ua=U[fa];1<Math.abs(ua)?ka[fa]=0:Z[fa]=la(ua)}return Z}function n(U,ka,Z,la){[U]=U;const oa=U.length;Z=w.createEmptyBand(Z,oa);for(let fa=0;fa<oa;fa++)if(!ka||ka[fa])Z[fa]=la(U[fa]);return Z}function A(U,ka,Z,la){const [oa,fa]=U;U=oa.length;Z=w.createEmptyBand(Z,U);for(let ua=0;ua<U;ua++)if(!ka||ka[ua])Z[ua]=la(oa[ua],fa[ua]);return Z}function m(U,
ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]&oa[fa];return Z}function v(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]<<oa[fa];return Z}function a(U,ka,Z){[U]=U;const la=U.length;Z=w.createEmptyBand(Z,la);for(let oa=0;oa<la;oa++)if(!ka||ka[oa])Z[oa]=~U[oa];return Z}function b(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=
la[fa]|oa[fa];return Z}function k(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]>>oa[fa];return Z}function f(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]^oa[fa];return Z}function c(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]&&oa[fa]?1:0;return Z}function e(U,ka,Z){[U]=U;const la=U.length;Z=w.createEmptyBand(Z,
la);for(let oa=0;oa<la;oa++)if(!ka||ka[oa])Z[oa]=U[oa]?0:1;return Z}function x(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]||oa[fa]?1:0;return Z}function t(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=(la[fa]?1:0)^(oa[fa]?1:0);return Z}function y(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]===oa[fa]?1:0;return Z}
function q(U,ka,Z,la){[U]=U;const oa=U.length;Z=w.createEmptyBand(Z,oa);const fa=la===Math.E;for(let ua=0;ua<oa;ua++)if(!ka||ka[ua])Z[ua]=fa?Math.exp(U[ua]):la**U[ua];return Z}function D(U,ka,Z){return q(U,ka,Z,10)}function K(U,ka,Z){return q(U,ka,Z,2)}function H(U,ka,Z){return q(U,ka,Z,Math.E)}function P(U,ka,Z,la){[U]=U;const oa=U.length;Z=w.createEmptyBand(Z,oa);for(let fa=0;fa<oa;fa++)if(!ka||ka[fa])0>=U[fa]?ka[fa]=0:Z[fa]=la(U[fa]);return Z}function I(U,ka,Z){return P(U,ka,Z,Math.log10)}function S(U,
ka,Z){return P(U,ka,Z,Math.log2)}function E(U,ka,Z){return P(U,ka,Z,Math.log)}function F(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]>oa[fa]?1:0;return Z}function Q(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]>=oa[fa]?1:0;return Z}function V(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]<oa[fa]?1:0;return Z}
function ba(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]<=oa[fa]?1:0;return Z}function da(U,ka,Z){[U]=U;U=U.length;Z=w.createEmptyBand(Z,U);if(!ka)return Z;for(let la=0;la<U;la++)Z[la]=ka[la]?0:1;return Z}function X(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]%oa[fa];return Z}function T(U,ka,Z){[U]=U;const la=U.length;Z=w.createEmptyBand(Z,la);for(let oa=0;oa<la;oa++)if(!ka||
ka[oa])Z[oa]=-U[oa];return Z}function Y(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]===oa[fa]?0:1;return Z}function ia(U,ka,Z){const [la,oa]=U;U=la.length;Z=w.createEmptyBand(Z,U);const fa=new Uint8Array(U);for(let ua=0;ua<U;ua++)null!=ka&&!ka[ua]||0!==la[ua]||(Z[ua]=oa[ua],fa[ua]=255);return{band:Z,mask:fa}}function ma(U,ka,Z){const [la,oa,fa]=U;U=la.length;Z=w.createEmptyBand(Z,U);for(let ua=0;ua<U;ua++)if(!ka||ka[ua])Z[ua]=la[ua]?
oa[ua]:fa[ua];return Z}function C(U,ka,Z){const la=U.length;if(2>la)return U[0];const [oa]=U,fa=oa.length;Z=w.createEmptyBand(Z,fa);for(let ua=0;ua<fa;ua++)if(!ka||ka[ua]){let xa=oa[ua];for(let ya=1;ya<la;ya++){const za=U[ya][ua];xa<za&&(xa=za)}Z[ua]=xa}return Z}function O(U,ka,Z){const la=U.length;if(2>la)return U[0];const [oa]=U,fa=oa.length;Z=w.createEmptyBand(Z,fa);for(let ua=0;ua<fa;ua++)if(!ka||ka[ua]){let xa=oa[ua];for(let ya=1;ya<la;ya++){const za=U[ya][ua];xa>za&&(xa=za)}Z[ua]=xa}return Z}
function N(U,ka,Z){const la=U.length;if(2>la)return U[0];const [oa]=U,fa=oa.length;Z=w.createEmptyBand(Z,fa);for(let ua=0;ua<fa;ua++)if(!ka||ka[ua]){let xa=oa[ua],ya=xa;for(let za=1;za<la;za++){const Ba=U[za][ua];ya<Ba?ya=Ba:xa>Ba&&(xa=Ba)}Z[ua]=ya-xa}return Z}function W(U,ka,Z){const la=U.length;if(2>la)return U[0];var [oa]=U;oa=oa.length;Z=w.createEmptyBand(Z,oa);for(let fa=0;fa<oa;fa++)if(!ka||ka[fa]){let ua=0;for(let xa=0;xa<la;xa++)ua+=U[xa][fa];Z[fa]=ua/la}return Z}function ca(U,ka,Z){const la=
U.length;if(2>la)return U[0];var [oa]=U;oa=oa.length;Z=w.createEmptyBand(Z,oa);for(let fa=0;fa<oa;fa++)if(!ka||ka[fa])for(let ua=0;ua<la;ua++)Z[fa]+=U[ua][fa];return Z}function aa(U,ka,Z){const la=U.length;if(2>la)return U[0];var [oa]=U;oa=oa.length;Z=w.createEmptyBand(Z,oa);for(let xa=0;xa<oa;xa++)if(!ka||ka[xa]){const ya=new Float32Array(la);let za=0;for(var fa=0;fa<la;fa++){var ua=U[fa];za+=ua[xa];ya[fa]=ua[xa]}za/=la;fa=0;for(ua=0;ua<la;ua++)fa+=(ya[ua]-za)**2;Z[xa]=Math.sqrt(fa/la)}return Z}
function ea(U,ka,Z){const la=U.length;if(2>la)return U[0];const oa=Math.floor(la/2);var [fa]=U;fa=fa.length;Z=w.createEmptyBand(Z,fa);const ua=new Float32Array(la),xa=1===la%2;for(let ya=0;ya<fa;ya++)if(!ka||ka[ya]){for(let za=0;za<la;za++)ua[za]=U[za][ya];ua.sort();Z[ya]=xa?ua[oa]:(ua[oa]+ua[oa-1])/2}return Z}function ha(U,ka,Z){const [la,oa]=U;if(null==oa)return la;U=la.length;Z=w.createEmptyBand(Z,U);for(let fa=0;fa<U;fa++)if(!ka||ka[fa])Z[fa]=la[fa]<oa[fa]?la[fa]:oa[fa];return Z}function ja(U,
ka,Z){const la=U.length;if(2>=la)return ha(U,ka,Z);const oa=U[0].length;Z=w.createEmptyBand(Z,oa);const fa=new Map;for(let ya=0;ya<oa;ya++)if(!ka||ka[ya]){fa.clear();for(var ua=0;ua<la;ua++){var xa=U[ua][ya];fa.set(xa,fa.has(xa)?fa.get(xa)+1:1)}xa=ua=0;const za=[];for(const Ba of fa.keys())ua=fa.get(Ba),ua>xa?(xa=ua,za.length=0,za.push(Ba)):ua===xa&&za.push(Ba);1<za.length&&za.sort((Ba,Ca)=>Ba-Ca);Z[ya]=za[0]}return Z}function na(U,ka,Z){const la=U.length;if(2>=la)return ha(U,ka,Z);const oa=U[0].length;
Z=w.createEmptyBand(Z,oa);const fa=new Map;for(let ya=0;ya<oa;ya++)if(!ka||ka[ya]){fa.clear();for(var ua=0;ua<la;ua++){var xa=U[ua][ya];fa.set(xa,fa.has(xa)?fa.get(xa)+1:1)}ua=0;xa=U.length;const za=[];for(const Ba of fa.keys())ua=fa.get(Ba),ua<xa?(xa=ua,za.length=0,za.push(Ba)):ua===xa&&za.push(Ba);1<za.length&&za.sort((Ba,Ca)=>Ba-Ca);Z[ya]=za[0]}return Z}function pa(U,ka,Z){const la=U.length;if(2>la)return U[0];var [oa]=U;oa=oa.length;Z=w.createEmptyBand(Z,oa);const fa=new Set;for(let ua=0;ua<oa;ua++)if(!ka||
ka[ua]){fa.clear();let xa;for(let ya=0;ya<la;ya++)xa=U[ya][ua],fa.add(xa);Z[ua]=fa.size}return Z}function ra(U,ka,Z={}){qa.size||(qa.set(4,Math.sqrt),qa.set(6,Math.acos),qa.set(7,Math.asin),qa.set(8,Math.atan),qa.set(9,Math.atanh),qa.set(10,Math.abs),qa.set(21,Math.cos),qa.set(22,Math.cosh),qa.set(48,Math.floor),qa.set(49,Math.ceil),qa.set(51,Math.sin),qa.set(52,Math.sinh),qa.set(56,Math.tan),qa.set(57,Math.tanh),qa.set(59,Math.acosh),qa.set(60,Math.asinh),qa.set(65,Math.floor),va.set(5,Math.pow),
va.set(61,Math.atan2),ta.set(1,R),ta.set(2,B),ta.set(3,z),ta.set(11,m),ta.set(12,v),ta.set(13,a),ta.set(14,b),ta.set(15,k),ta.set(16,f),ta.set(17,c),ta.set(18,e),ta.set(19,x),ta.set(20,t),ta.set(23,g),ta.set(24,y),ta.set(25,H),ta.set(26,D),ta.set(27,K),ta.set(28,F),ta.set(29,Q),ta.set(30,l),ta.set(31,da),ta.set(32,J),ta.set(33,V),ta.set(34,ba),ta.set(35,E),ta.set(36,I),ta.set(37,S),ta.set(44,X),ta.set(45,T),ta.set(46,Y),ta.set(53,L),ta.set(64,h),ta.set(65,d),ta.set(76,ma),ta.set(78,ma),wa.set(38,
ja),wa.set(39,C),wa.set(40,W),wa.set(41,ea),wa.set(42,O),wa.set(43,na),wa.set(47,N),wa.set(54,aa),wa.set(55,ca),wa.set(58,pa),wa.set(66,ja),wa.set(67,C),wa.set(68,W),wa.set(69,ea),wa.set(70,O),wa.set(71,na),wa.set(72,N),wa.set(73,aa),wa.set(74,ca),wa.set(75,pa));var la=G(U,66<=ka&&75>=ka);const {outputPixelType:oa="f32"}=Z,fa=!wa.has(ka)||Z.processAsMultiband,ua=fa?U[0].pixels.length:1;Z=[];for(let za=0;za<ua;za++){var xa=wa.has(ka)&&!fa?U.flatMap(Ba=>Ba.pixels):U.map(Ba=>Ba.pixels[za]),ya=!0;ka===
r.localConditionalOperation.setNull?(la=ia(xa,la,oa),xa=la.band,la=la.mask,ya=!1):ta.has(ka)?xa=ta.get(ka)(xa,la,"f64"):qa.has(ka)?xa=ka===r.localTrigonometricOperation.asin||ka===r.localTrigonometricOperation.acos||ka===r.localTrigonometricOperation.atanh?u(xa,la,"f64",ka):n(xa,la,"f64",qa.get(ka)):va.has(ka)?xa=A(xa,la,"f64",va.get(ka)):wa.has(ka)?xa=wa.get(ka)(xa,la,"f64"):(xa=xa[0],ya=!1);ya&&ka!==r.localLogicalOperation.isNull&&!sa.has(ka)&&(ya=w.createEmptyBand(oa,xa.length),la||=(new Uint8Array(xa.length)).fill(255),
M.fixNaN(xa,la),M.clipBandToPixelTypeRange(xa,la,oa,ya),xa=ya);Z.push(xa)}U=U[0];return new w({width:U.width,height:U.height,pixelType:oa,mask:ka===r.localLogicalOperation.isNull?null:la,pixels:Z})}const sa=new Map([[r.localTrigonometricOperation.acos,{domain:[0,Math.PI],isInteger:!1}],[r.localTrigonometricOperation.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[r.localTrigonometricOperation.atan,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[r.localTrigonometricOperation.cos,{domain:[-1,1],
isInteger:!1}],[r.localTrigonometricOperation.sin,{domain:[-1,1],isInteger:!1}],[r.localLogicalOperation.booleanAnd,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.booleanNot,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.booleanOr,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.booleanXOr,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.equalTo,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.notEqual,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.greaterThan,
{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.greaterThanEqual,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.lessThan,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.lessThanEqual,{domain:[0,1],isInteger:!0}],[r.localLogicalOperation.isNull,{domain:[0,1],isInteger:!0}]]),qa=new Map,va=new Map,ta=new Map,wa=new Map;p.arithmetic=function(U,ka,Z){ka=[null,1,2,3,23,5,44][ka]??1;return ra(U,ka,{outputPixelType:Z})};p.getOutputDomain=function(U){return sa.get(U)};p.local=ra;p.operandsCount=
[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(p){const w={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,
roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},r={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},M={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},G={majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,
variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},R={setNull:50,conditional:78},J={...w,...r,...M,...G,...R};p.arithmeticOperation={plus:1,minus:2,multiply:3,divide:4,power:5,mod:6};p.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,
CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};p.cellStatisticalOperation=G;p.clippingType={outside:1,inside:2};p.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",
brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",greenToBlue:"Green to Blue",orangeBright:"Orange Bright",
orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",
purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",
spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};p.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",gray:"Gray",hillshade:"Hillshade"};p.computeChangeMethod=
{difference:0,relativeDifference:1,categorical:2,spectralEuclidianDistance:3,spectralAngleDifference:4,bandWithMostChange:5};p.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,
sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};p.curvatureType={standard:0,planform:1,profile:2};p.hillshadeType={traditional:0,multidirectional:1};p.localArithmeticOperation=w;p.localConditionalOperation=R;p.localLogicalOperation=r;p.localOperators=J;p.localTrigonometricOperation=M;p.missingBandAction={bestMatch:0,fail:1};p.noDataInterpretation={matchAny:0,matchAll:1};p.slopeType={degree:1,percentRise:2,adjusted:3};p.statisticsType={min:1,max:2,mean:3,standardDeviation:4,median:5,
majority:6,minority:7};p.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(p,w,r,M,G,R,J,L,B){r=class extends L{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var z=this.sourceRasterInfos[0];this.isGCS=z.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");z=z.clone();z.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(z);z.statistics=[{min:-1,max:360,avg:180,stddev:30}];z.bandCount=1;this.rasterInfo=z;
return{success:!0,supportsGPU:!0}}_processPixels(z){const l=z.pixelBlocks?.[0];if(null==l)return null;const {extent:g,primaryPixelSizes:h}=z;z=h?.[0];return B.aspect(l,{resolution:null==z?g?{x:g.width/l.width,y:g.height/l.height}:{x:1,y:1}:z})}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,
"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isGCS",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.AspectFunction")],r)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,w,r,M,G,R,J){var L;
w=L=class extends J{clone(){return new L({raster:this.raster})}};return w=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","../SimpleBandStatistics","./pixelUtils"],function(p,w,r,M){function G(B){let {altitude:z,azimuth:l}=B;const {hillshadeType:g,pixelSizePower:h=1,pixelSizeFactor:d=1,scalingType:u,isGCS:n,resolution:A}=B;var m="multi-directional"===g?2*
B.zFactor:B.zFactor;const {x:v,y:a}=A;B=m/(8*v);var b=m/(8*a);n&&.001<m&&(B/=L,b/=L);"adjusted"===u&&(n?(B=v*L,b=a*L,B=(m+B**h*d)/(8*B),b=(m+b**h*d)/(8*b)):(B=(m+v**h*d)/(8*v),b=(m+a**h*d)/(8*a)));var k=(90-z)*Math.PI/180;m=Math.cos(k);let f=(360-l+90)*Math.PI/180,c=Math.sin(k)*Math.cos(f);k=Math.sin(k)*Math.sin(f);const e=[315,270,225,360,180,0],x=[60,60,60,60,60,90];var t=new Float32Array([3,5,3,2,1,4]);const y=t.reduce((P,I)=>P+I);t=t.map(P=>P/y);const q="multi-directional"===g?e.length:1,D=new Float32Array(6),
K=new Float32Array(6),H=new Float32Array(6);if("multi-directional"===g)for(let P=0;P<q;P++)z=x[P],l=e[P],k=(90-z)*Math.PI/180,m=Math.cos(k),f=(360-l+90)*Math.PI/180,c=Math.sin(k)*Math.cos(f),k=Math.sin(k)*Math.sin(f),D[P]=m,K[P]=c,H[P]=k;else D.fill(m),K.fill(c),H.fill(k);return{resolution:A,factor:[B,b],sinZcosA:c,sinZsinA:k,cosZ:m,sinZcosAs:K,sinZsinAs:H,cosZs:D,weights:t,hillshadeType:["traditional","multi-directional"].indexOf(g)}}function R(B,z){const {width:l,height:g}=B;var h=l*g;const d=new Uint8Array(h),
u=null!=B.mask;let n;if(u){n=new Uint8Array(B.mask);for(var A=0;A<n.length;A++)n[A]&&(d[A]=1,n[A]=1)}B=B.pixels[0];A=new Float32Array(h);const m=new Float32Array(h);let v=0;if(z){({resolution:a}=z);var a=a?(a.x+a.y)/2:1;v=200*z.zFactor/(a*a);a=new Float32Array(h)}z=z?.curvatureType;let b;let k;for(h=1;h<g-1;h++){const D=h*l;for(let K=1;K<l-1;K++){const H=D+K;if(!n||0!==n[H]){if(n){if(7>n[H-l-1]+n[H-l]+n[H-l+1]+n[H-1]+n[H+1]+n[H+l-1]+n[H+l]+n[H+l+1]){d[H]=0;continue}var f=n[H-l-1]?B[H-l-1]:B[H];var c=
n[H-l]?B[H-l]:B[H];var e=n[H-l+1]?B[H-l+1]:B[H];var x=n[H-1]?B[H-1]:B[H];var t=n[H+1]?B[H+1]:B[H];b=n[H+l-1]?B[H+l-1]:B[H];var y=n[H+l]?B[H+l]:B[H];k=n[H+l+1]?B[H+l+1]:B[H]}else f=B[H-l-1],c=B[H-l],e=B[H-l+1],x=B[H-1],t=B[H+1],b=B[H+l-1],y=B[H+l],k=B[H+l+1];A[H]=e+t+t+k-(f+x+x+b);m[H]=b+y+y+k-(f+c+c+e);if(null!=a){var q=B[H];const P=.5*(x+t)-q;q=.5*(c+y)-q;"standard"===z?a[H]=-v*(P+q):(f=(-f+e+b-k)/4,x=(-x+t)/2,c=(c-y)/2,y=x*x,t=c*c,(e=y+t)&&(a[H]="profile"===z?v*(P*y+q*t+f*x*c)/e:-v*(P*t+q*y-f*x*
c)/e))}}}}return{outMask:u?d:null,dzxs:A,dzys:m,curvatures:a}}function J(B,z,l){for(var g=0;g<l;g++)B[g*z]=B[g*z+1],B[(g+1)*z-1]=B[(g+1)*z-2];for(g=1;g<z-1;g++)B[g]=B[g+z],B[g+(l-1)*z]=B[g+(l-2)*z]}const L=1/111E3;p.aspect=function(B,z={}){if(!M.isValidPixelBlock(B))return B;var {resolution:l}=z;z=l?1/l.x:1;l=l?1/l.y:1;const {dzxs:g,dzys:h,outMask:d}=R(B),{width:u,height:n}=B,A=new Float32Array(u*n);for(let v=1;v<n-1;v++){const a=v*u;for(let b=1;b<u-1;b++){var m=a+b;if(!d||d[m]){const k=g[m]*z;m=
h[m]*l;let f=-1;if(0!==k||0!==m)f=90-57.29578*Math.atan2(m,-k),0>f&&(f+=360),360===f?f=0:360<f&&(f%=360);A[a+b]=f}}}J(A,u,n);return new w({width:u,height:n,pixels:[A],mask:d,pixelType:"f32",validPixelCount:B.validPixelCount,statistics:[new r.SimpleBandStatistics(-1,360)]})};p.calculateHillshadeParams=G;p.curvature=function(B,z){if(!M.isValidPixelBlock(B))return B;const {curvatures:l,outMask:g}=R(B,z),{width:h,height:d}=B;J(l,h,d);B=new w({width:h,height:d,pixels:[l],mask:g,pixelType:"f32",validPixelCount:B.validPixelCount});
B.updateStatistics();return B};p.gcsFactor=L;p.getHillshadeOptions=function(B,z,l){const {hillshadeType:g,altitude:h,azimuth:d,zFactor:u,pixelSizeFactor:n,pixelSizePower:A,slopeType:m}=B;return{hillshadeType:g,altitude:h,azimuth:d,zFactor:u,pixelSizePower:A,pixelSizeFactor:n,scalingType:"scaled"===m?"adjusted":"none",resolution:z,isGCS:l}};p.hillshade=function(B,z){if(!M.isValidPixelBlock(B))return B;const {factor:l,sinZcosA:g,sinZsinA:h,cosZ:d,sinZcosAs:u,sinZsinAs:n,cosZs:A,weights:m}=G(z),[v,a]=
l;z="traditional"===z.hillshadeType;const {width:b,height:k}=B,f=new Uint8Array(b*k),{dzxs:c,dzys:e,outMask:x}=R(B);for(let y=1;y<k-1;y++){const q=y*b;for(let D=1;D<b-1;D++){const K=q+D;if(!x||x[K]){var t=c[K]*v;const H=e[K]*a,P=Math.sqrt(1+t*t+H*H);let I=0;if(z)t=255*(d+h*H-g*t)/P,0>t&&(t=0),I=t;else{const S=n.length;for(let E=0;E<S;E++){let F=255*(A[E]+n[E]*H-u[E]*t)/P;0>F&&(F=0);I+=F*m[E]}}f[K]=I&255}}}J(f,b,k);return new w({width:b,height:k,pixels:[f],mask:x,pixelType:"u8",validPixelCount:B.validPixelCount,
statistics:[new r.SimpleBandStatistics(0,255)]})};p.slope=function(B,z){if(!M.isValidPixelBlock(B))return B;var l=z.zFactor,g=z.pixelSizePower??1,h=z.pixelSizeFactor??1;const d=z.slopeType;var u=z.isGCS;const {x:n,y:A}=z.resolution;z=l/(8*n);let m=l/(8*A);u&&1E-4>Math.abs(l-1)&&(z/=L,m/=L);"adjusted"===d&&(z=(l+n**g*h)/(8*n),m=(l+A**g*h)/(8*A));const {dzxs:v,dzys:a,outMask:b}=R(B),{width:k,height:f}=B;l=new Float32Array(k*f);for(g=1;g<f-1;g++)for(h=g*k,u=1;u<k-1;u++){var c=h+u;if(!b||b[c]){var e=
v[c]*z;c=a[c]*m;e=Math.sqrt(e*e+c*c);l[h+u]="percent-rise"===d?100*e:57.2957795*Math.atan(e)}}J(l,k,f);B=new w({width:k,height:f,pixels:[l],mask:b,pixelType:"f32",validPixelCount:B.validPixelCount});B.updateStatistics();return B};p.tintHillshade=function(B,z,l,g){if(M.isValidPixelBlock(B)&&M.isValidPixelBlock(z)){var {min:h,max:d}=g;g=B.pixels[0];var {pixels:u,mask:n}=z;z=u[0];var A=255.00001/(d-h),m=new Uint8ClampedArray(z.length),v=new Uint8ClampedArray(z.length),a=new Uint8ClampedArray(z.length),
b=l.length-1;for(let c=0;c<z.length;c++){if(n&&0===n[c])continue;var k=Math.floor((z[c]-h)*A);const [e,x]=l[0>k?0:k>b?b:k];var f=g[c];k=f*x;const t=k*(1-Math.abs(e%2-1));f-=k;switch(Math.floor(e)){case 0:m[c]=k+f;v[c]=t+f;a[c]=f;break;case 1:m[c]=t+f;v[c]=k+f;a[c]=f;break;case 2:m[c]=f;v[c]=k+f;a[c]=t+f;break;case 3:m[c]=f;v[c]=t+f;a[c]=k+f;break;case 4:m[c]=t+f;v[c]=f;a[c]=k+f;break;case 5:case 6:m[c]=k+f,v[c]=f,a[c]=t+f}}B.pixels=[m,v,a];B.updateStatistics()}};Object.defineProperty(p,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),function(p,w,r,M,G,R,J,L,B,z){const l=new Set(["vari","mtvi2","rtvi-core","evi"]);r=class extends z{constructor(){super(...arguments);
this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var g=this.sourceRasterInfos[0];if(2>g.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};g=g.clone();g.pixelType=this.outputPixelType;g.bandCount="sultan"===this.functionArguments.method?3:1;this._removeStatsHistColormapVAT(g);g.keyProperties={...g.keyProperties,
BandProperties:void 0};this.rasterInfo=g;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(g){g=g.pixelBlocks?.[0];if(null==g)return g;const {method:h,bandIndexes:d}=this.functionArguments,u=d.split(" ").map(n=>parseFloat(n));return B.calculateBandIndex(g,{method:h,bandIndexes:u,equation:d,outputPixelType:this.outputPixelType})}_getWebGLParameters(){var g=this.functionArguments.bandIndexes.split(" ").map(n=>parseFloat(n)-1);2===g.length&&
g.push(0);var h=this.isInputBandIdsSwizzled?[0,1,2]:g;const d=new Float32Array(3);({method:u}=this.functionArguments);switch(u){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":h=B.getBandMatrix3([h[0],h[1],0]);var u="ndxi";break;case "ndwi":h=B.getBandMatrix3([h[1],h[0],0]);u="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":h=B.getBandMatrix3([h[0],h[1],0]);u="sr";break;case "ci-g":case "ci-re":h=
B.getBandMatrix3([h[0],h[1],0]);u="ci";break;case "savi":h=B.getBandMatrix3([h[0],h[1],0]);u="savi";d[0]=g[2]+1;break;case "tsavi":h=B.getBandMatrix3([h[0],h[1],0]);u="tsavi";d[0]=g[2]+1;d[1]=g[3]+1;d[2]=g[4]+1;break;case "msavi":h=B.getBandMatrix3([h[0],h[1],0]);u="msavi";break;case "gemi":h=B.getBandMatrix3([h[0],h[1],0]);u="gemi";break;case "pvi":h=B.getBandMatrix3([h[0],h[1],0]);u="tsavi";d[0]=g[2]+1;d[1]=g[3]+1;break;case "vari":h=B.getBandMatrix3([h[0],h[1],h[2]]);u="vari";break;case "mtvi2":h=
B.getBandMatrix3([h[0],h[1],h[2]]);u="mtvi";break;case "rtvi-core":h=B.getBandMatrix3([h[0],h[1],h[2]]);u="rtvicore";break;case "evi":h=B.getBandMatrix3([h[0],h[1],h[2]]);u="evi";break;case "wndwi":h=B.getBandMatrix3([h[0],h[1],0]);u="wndwi";d[0]=g[3]?g[3]+1:.5;break;case "bai":h=B.getBandMatrix3([h[1],h[0],0]);u="bai";break;default:h=B.getBandMatrix3([0,1,2]),u="custom"}g=J.isIntegerPixelType(this.outputPixelType);return{bandIndexMat3:h,indexType:u,adjustments:d,isOutputRounded:g}}_getInputBandIds(g){if("custom"===
this.functionArguments.method)return g;var h=this.functionArguments.bandIndexes.split(" ").map(n=>parseFloat(n)-1);const d=g.length;h=h.map(n=>n>=d?d-1:n);const u=l.has(this.functionArguments.method)?3:2;h=h.slice(0,u).map(n=>g[n]);2===h.length&&h.push(0);return h}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],
r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],r)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;M=z=class extends B{constructor(){super(...arguments);this.method="custom"}clone(){return new z({method:this.method,bandIndexes:this.bandIndexes,raster:w.clone(this.raster)})}};p.__decorate([r.property({json:{type:String,write:!0}})],M.prototype,"bandIndexes",void 0);p.__decorate([R.enumeration(L.bandIndexMethodMap)],M.prototype,"method",void 0);return M=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],M)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports",
"../../jsonMap","./property"],function(p,w,r){p.enumeration=function(M,G={}){M=M instanceof w.JSONMap?M:new w.JSONMap(M,G);const {alwaysWriteDefaults:R,default:J,ignoreUnknown:L=!0,name:B,nonNullable:z,readOnly:l=!1}=G;return r.property({type:L?M.apiValues:String,json:{type:M.jsonValues,default:J,name:B,read:l?!1:{reader:M.read},write:{writer:M.write,alwaysWriteDefaults:R}},nonNullable:z,readOnly:l})};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define("exports ../../../core/jsonMap ../PixelBlock ../rasterFormats/pixelRangeUtils ./customBandIndexUtils ./pixelUtils".split(" "),
function(p,w,r,M,G,R){function J(f,c,e){const x=e.length,t=new Float32Array(x);for(let y=0;y<x;y++)if(null==f||f[y]){const q=c[y],D=e[y],K=q+D;K&&(t[y]=(q-D)/K)}return[t]}function L(f,c,e){const x=e.length,t=new Float32Array(x);for(let y=0;y<x;y++)if(null==f||f[y]){const q=c[y],D=e[y];D&&(t[y]=q/D)}return[t]}function B(f,c,e){const x=c.length,t=new Float32Array(x);for(let y=0;y<x;y++)if(null==f||f[y]){const q=c[y],D=e[y];D&&(t[y]=q/D-1)}return[t]}function z(f,c,e,x){const t=e.length,y=new Float32Array(t);
for(let q=0;q<t;q++)if(null==f||f[q]){const D=e[q],K=c[q],H=K+D+x;H&&(y[q]=(K-D)/H*(1+x))}return[y]}function l(f,c,e,x,t,y){const q=e.length,D=new Float32Array(q);y=-t*x+y*(1+x*x);for(let K=0;K<q;K++)if(null==f||f[K]){const H=e[K],P=c[K],I=t*P+H+y;I&&(D[K]=x*(P-x*H-t)/I)}return[D]}function g(f,c,e){const x=e.length,t=new Float32Array(x);for(let y=0;y<x;y++)if(null==f||f[y]){const q=c[y],D=2*q+1;t[y]=.5*(D-Math.sqrt(D*D-8*(q-e[y])))}return[t]}function h(f,c,e){const x=e.length,t=new Float32Array(x);
for(let q=0;q<x;q++)if(null==f||f[q]){const D=e[q];var y=c[q];1!==D&&0!==y+D+.5&&(y=(2*(y*y-D*D)+1.5*y+.5*D)/(y+D+.5),t[q]=y*(1-.25*y)-(D-.125)/(1-D))}return[t]}function d(f,c,e,x,t){const y=e.length,q=new Float32Array(y),D=1/Math.sqrt(1+x*x);for(let K=0;K<y;K++)if(null==f||f[K])q[K]=(c[K]-x*e[K]-t)*D;return[q]}function u(f,c){const [e,x,t,y,q,D]=c;c=e.length;const K=new Float32Array(c);for(let H=0;H<c;H++)if(null==f||f[H])K[H]=-.2848*e[H]-.2435*x[H]-.5436*t[H]+.7243*y[H]+.084*q[H]-.18*D[H];return[K]}
function n(f,c){const [e,x,t,y,q]=c;c=e.length;const D=new Float32Array(c),K=new Float32Array(c),H=new Float32Array(c);for(let P=0;P<c;P++)if(null==f||f[P])D[P]=q[P]?y[P]/q[P]*100:0,K[P]=e[P]?y[P]/e[P]*100:0,H[P]=t[P]?x[P]/t[P]*(y[P]/t[P])*100:0;return[D,K,H]}function A(f,c){const [e,x,t]=c;c=e.length;const y=new Float32Array(c);for(let q=0;q<c;q++)if(null==f||f[q])for(q=0;q<c;q++){const D=e[q],K=x[q],H=K+D-t[q];H&&(y[q]=(K-D)/H)}return[y]}function m(f,c){const [e,x,t]=c;c=e.length;const y=new Float32Array(c);
for(let q=0;q<c;q++)if(null==f||f[q])for(q=0;q<c;q++){const D=e[q],K=x[q],H=t[q],P=Math.sqrt((2*D+1)**2-(6*D-5*Math.sqrt(K))-.5);P&&(y[q]=1.5*(1.2*(D-H)-2.5*(K-H))/P)}return[y]}function v(f,c){const [e,x,t]=c;c=e.length;const y=new Float32Array(c);for(let q=0;q<c;q++)if(null==f||f[q])for(q=0;q<c;q++){const D=e[q];y[q]=100*(D-x[q])-10*(D-t[q])}return[y]}function a(f,c){const [e,x,t]=c;c=e.length;const y=new Float32Array(c);for(let q=0;q<c;q++)if(null==f||f[q])for(q=0;q<c;q++){const D=e[q],K=x[q],H=
D+6*K-7.5*t[q]+1;H&&(y[q]=2.5*(D-K)/H)}return[y]}function b(f,c,e=.5){const [x,t,y]=c;c=t.length;const q=new Float32Array(c);for(let D=0;D<c;D++)if(null==f||f[D])for(D=0;D<c;D++){const K=x[D],H=t[D],P=y[D],I=K+e*H+(1-e)*P;I&&(q[D]=(K-e*H-(1-e)*P)/I)}return[q]}function k(f,c,e){const x=e.length,t=new Float32Array(x);for(let y=0;y<x;y++)if(null==f||f[y])for(y=0;y<x;y++){const q=(.1-c[y])**2+(.06-e[y])**2;q&&(t[y]=1/q)}return[t]}w=new w.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",
6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});p.bandIndexMethodMap=w;p.calculateBandIndex=function(f,c){if(!R.isValidPixelBlock(f))return f;const {equation:e,method:x}=c;var t=c.bandIndexes.map(H=>H-1);const {pixels:y,mask:q}=f;switch(x){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":t=
J(q,y[t[0]],y[t[1]]);break;case "ndwi":t=J(q,y[t[1]],y[t[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":t=L(q,y[t[0]],y[t[1]]);break;case "ci-g":case "ci-re":t=B(q,y[t[0]],y[t[1]]);break;case "savi":t=z(q,y[t[0]],y[t[1]],t[2]+1);break;case "tsavi":t=l(q,y[t[0]],y[t[1]],t[2]+1,t[3]+1,t[4]+1);break;case "msavi":t=g(q,y[t[0]],y[t[1]]);break;case "gemi":t=h(q,y[t[0]],y[t[1]]);break;case "pvi":t=d(q,y[t[0]],y[t[1]],t[2]+1,t[3]+1);break;case "gvitm":t=u(q,
[y[t[0]],y[t[1]],y[t[2]],y[t[3]],y[t[4]],y[t[5]]]);break;case "sultan":t=n(q,[y[t[0]],y[t[1]],y[t[2]],y[t[3]],y[t[4]]]);break;case "vari":t=A(q,[y[t[0]],y[t[1]],y[t[2]]]);break;case "mtvi2":t=m(q,[y[t[0]],y[t[1]],y[t[2]]]);break;case "rtvi-core":t=v(q,[y[t[0]],y[t[1]],y[t[2]]]);break;case "evi":t=a(q,[y[t[0]],y[t[1]],y[t[2]]]);break;case "wndwi":t=b(q,[y[t[0]],y[t[1]],y[t[2]]],t[3]?t[3]+1:.5);break;case "bai":t=k(q,y[t[0]],y[t[1]]);break;case "custom":t=G.calculateCustomBandIndex(q,y,e);break;default:return f}const {outputPixelType:D=
"f32"}=c;c=null!=D&&M.isIntegerPixelType(D);let K;q?(K=new Uint8Array(f.width*f.height),K.set(q)):c&&(K=(new Uint8Array(f.width*f.height)).fill(255));c&&(t=t.map(H=>{const P=r.createEmptyBand(D,H.length);M.clipBandToPixelTypeRange(H,K,D,P);return P}));f=new r({width:f.width,height:f.height,pixelType:D,pixels:t,mask:K});f.updateStatistics();return f};p.calculateNDVI=function(f,c,e,x){const {mask:t,pixels:y,width:q,height:D}=f;f=y[e];c=y[c];e=c.length;const K=x?new Uint8Array(e):new Float32Array(e),
H=x?100:1,P=x?100.5:0;for(let I=0;I<e;I++)if(null==t||t[I]){const S=f[I],E=c[I],F=S+E;F&&(K[I]=(S-E)/F*H+P)}x=new r({width:q,height:D,mask:t,pixelType:x?"u8":"f32",pixels:[K]});x.updateStatistics();return x};p.getBandMatrix3=function(f){const c=new Float32Array(9);c[3*f[0]]=1;c[3*f[1]+1]=1;c[3*f[2]+2]=1;return c};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports","../../../core/has"],function(p,w){function r(G,
R){return G.toLowerCase().startsWith("b")?R[parseInt(G.slice(1),10)-1]:parseFloat(G)}const M=new Set("+-*/()".split(""));p.calculateCustomBandIndex=function(G,R,J){J=J.replaceAll(" ","");J.startsWith("-")&&(J="0"+J);J.startsWith("+")&&(J=J.slice(1));J=J.split("");var L=[],B=[],z="";for(var l=0;l<J.length;l++){const u=J[l];M.has(u)?(z.length&&B.push(r(z,R)),L.push(u),z=""):z=z.concat(u)}z.length&&B.push(r(z,R));let {ops:g,nums:h}={ops:L,nums:B};if(0===g.length){G=1===h.length?h[0]:R[0];if(G instanceof
Float32Array)return[G];var d=new Float32Array(R[0].length);"number"===typeof G?d.fill(G):d.set(G);return[d]}for(;0<g.length;){d=g;if(1===d.length)d={opIndex:0,numIndex:0};else{L=J=0;for(R=0;R<d.length;R++)if("("===d[R])J=R;else if(")"===d[R]){L=R;break}B=0===L?d:d.slice(J+1,L);R=-1;for(z=0;z<B.length;z++)if("*"===B[z]||"/"===B[z]){R=z;break}if(!(-1<R))for(z=0;z<B.length;z++)if("+"===B[z]||"-"===B[z]){R=z;break}0<L&&(R+=J+1);J=0;for(L=0;L<R;L++)"("===d[L]&&J++;d={opIndex:R,numIndex:R-J}}const {numIndex:u,
opIndex:n}=d;L=J=R=void 0;d=G;z=g[n];B=h[u];l=h[u+1];if("number"===typeof B&&"number"===typeof l)d=B+l;else{"number"===typeof B?(R=l,L=R.length,J=new Float32Array(L),J.fill(B)):(L=B.length,J=B,l.constructor===Number?(R=new Float32Array(L),R.fill(l)):R=l);B=new Float32Array(L);switch(z){case "+":for(z=0;z<L;z++)if(null==d||d[z])B[z]=J[z]+R[z];break;case "-":for(z=0;z<L;z++)if(null==d||d[z])B[z]=J[z]-R[z];break;case "*":for(z=0;z<L;z++)if(null==d||d[z])B[z]=J[z]*R[z];break;case "/":for(z=0;z<L;z++)(null==
d||d[z])&&R[z]&&(B[z]=J[z]/R[z]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}d=B}if(1===g.length)break;else{R=g;R.splice(n,1);L=J=0;do{L=J=0;for(B=0;B<R.length;B++)if("("===R[B])J=B;else if(")"===R[B]){L=B;break}L===J+1&&R.splice(J,2)}while(L===J+1);g=R;h.splice(u,2,d)}}return[d]};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ClipFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ClipFunctionArguments ./clipUtils ./rasterProjectionHelper".split(" "),
function(p,w,r,M,G,R,J,L,B,z){r=class extends J{constructor(){super(...arguments);this.functionName="Clip";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){const l=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(l.pixelType);l.pixelType=this.outputPixelType;this.rasterInfo=l;var {functionArguments:g}=this;const {clippingGeometry:h,clippingType:d}=g;if(!h)return{success:!1,supportsGPU:!1,error:"missing clipping geometry"};
if("outside"===d)try{({spatialReference:g}=l);const u="extent"===h.type?z.projectExtent(h,g):z.projectPolygon(h,g).extent;u&&B.clipRasterInfo(l,u)}catch{}return{success:!0,supportsGPU:!0}}_processPixels(l){return l.pixelBlocks?.[0]}_getWebGLParameters(){const {clippingGeometry:l,clippingType:g}=this.functionArguments;return{clippingGeometry:l.toJSON(),clippingType:g}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,
json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property()],r.prototype,"isNoopProcess",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ClipFunction")],r)})},"esri/layers/support/rasterFunctions/ClipFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/jsonUtils ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B,z){var l;r=new r.JSONMap({1:"outside",2:"inside"},{useNumericKeys:!0});z=l=class extends z{constructor(){super(...arguments);this.clippingType="outside"}clone(){return new l({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}};p.__decorate([M.property({types:w.geometryTypes,json:{read:B.fromJSON,write:!0}})],z.prototype,"clippingGeometry",void 0);p.__decorate([M.property({json:{read:r.read,write:r.write}})],z.prototype,"clippingType",void 0);
return z=l=p.__decorate([L.subclass("esri.layers.support.rasterFunctions.ClipFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/clipUtils":function(){define("require exports ../../../core/unitUtils ../../../geometry/Extent ../../../geometry/Point ../PixelBlock".split(" "),function(p,w,r,M,G,R){function J(l,g,h){if(!l)return l;const {width:d,height:u}=l,n=g.width/d,A=g.height/u,{xmin:m,ymax:v}=g;if("extent"===h.type){g=(h.xmin-m)/n;var a=(h.xmax-m)/n,b=(v-h.ymax)/A;h=(v-h.ymin)/A;h=[[[g,
b],[g,h],[a,h],[a,b],[g,b]]]}else h=h.rings.map(f=>f.map(([c,e])=>[(c-m)/n,(v-e)/A]));g=document.createElement("canvas");g.width=d;g.height=u;const k=g.getContext("2d");k.fillStyle="#f00";k.beginPath();h.forEach(f=>{k.moveTo(f[0][0],f[0][1]);for(let c=0;c<f.length;c++)k.lineTo(f[c][0],f[c][1]);k.closePath()});k.fill();h=k.getImageData(0,0,d,u).data;g=l.mask;a=d*u;b=new Uint8Array(a);for(let f=0;f<a;f++)if(!g||g[f])b[f]=127<h[4*f+3]?255:0;return new R({pixelType:l.pixelType,width:d,height:u,mask:b,
maskIsAlpha:!1,pixels:[...l.pixels]})}function L(l,g,h){const {width:d,height:u}=l,n=new Uint8Array(d*u);var A=g.width/d,m=g.height/u;if(.5>h.width/A||.5>h.height/m)return new R({pixelType:l.pixelType,width:d,height:u,mask:n,pixels:[...l.pixels]});const {xmin:v,xmax:a,ymin:b,ymax:k}=g,{xmin:f,xmax:c,ymin:e,ymax:x}=h;g=Math.max(v,f);var t=Math.min(a,c);h=Math.max(b,e);var y=Math.min(k,x),q=.5*A,D=.5*m;if(t-g<q||y-h<D||t<v+q||g>a-q||h>k-D||y<b+D)return new R({pixelType:l.pixelType,width:d,height:u,
mask:n,pixels:[...l.pixels]});g=Math.max(0,(g-v)/A);t=Math.min(d,Math.max(0,(t-v)/A));y=Math.max(0,(k-y)/m);D=Math.min(u,Math.max(0,(k-h)/m));m=Math.round(g);A=Math.round(t)-1;q=Math.round(y);h=Math.round(D)-1;if(m===A&&.5<g%1&&.5>t%1||q===h&&.5<y%1&&.5>D%1)return new R({pixelType:l.pixelType,width:d,height:u,mask:n,pixels:[...l.pixels]});if(0===m&&0===q&&A===d&&h===u)return l;g=l.mask;for(t=q;t<=h;t++)for(y=m;y<=A;y++)q=t*d+y,n[q]=g?g[q]:255;return new R({pixelType:l.pixelType,width:d,height:u,mask:n,
pixels:[...l.pixels]})}function B(l,g,h){const {width:d,height:u}=l,n=new Uint8Array(d*u),A=g.width/d,m=g.height/u,{xmin:v,ymax:a}=g;({paths:g}=h);h=l.mask;for(let e=0;e<g.length;e++){const x=g[e];for(let t=0;t<x.length-1;t++){const [y,q]=x[t],[D,K]=x[t+1];let H=Math.floor((a-q)/m),P=Math.floor((a-K)/m);if(P<H){var b=H;H=P;P=b}H=Math.max(0,H);P=Math.min(u-1,P);b=(D-y)/(K-q);for(let I=H;I<=P;I++){var k=I===H?Math.max(q,K):(u+1-I)*m,f=I===P?Math.min(q,K):k-m;k=K===q?Math.floor((y-v)/A):Math.floor((b*
(k-q)+y-v)/A);f=K===q?Math.floor((D-v)/A):Math.floor((b*(f-q)+y-v)/A);if(f<k){var c=k;k=f;f=c}c=I*d;k=Math.max(0,k);f=Math.min(d-1,f);for(k=c+k;k<=c+f;k++)n[k]=h?h[k]:255}}}return new R({pixelType:l.pixelType,width:d,height:u,mask:n,pixels:[...l.pixels]})}function z(l,g,h,d=!0){var {spatialReference:u}=l;if(!h.spatialReference.equals(u)){var n=r.getMetersPerUnitForSR(h.spatialReference),A=r.getMetersPerUnitForSR(u);n!==A&&(n/=A,h={x:h.x*n,y:h.y*n})}const {x:m,y:v}=h;let {xmin:a,xmax:b,ymax:k,ymin:f}=
"extent"===g.type?g:g.extent;const {xmin:c,ymax:e}=l.extent;d?(a=c+(a>c?m*Math.round((a-c)/m):0),k=e-(k<e?v*Math.round((e-k)/v):0),b=c+(b>c?m*Math.round((b-c)/m):0),f=e-(f<e?v*Math.round((e-f)/v):0),u=new M({xmin:a,ymax:k,xmax:b,ymin:f,spatialReference:u}),l=Math.round(u.width/m),g=Math.round(u.height/v)):(l=Math.floor((b-a)/m+.8),g=Math.floor((k-f)/v+.8),a=c+(a>c?m*Math.floor((a-c)/m+.1):0),k=e-(k<e?v*Math.floor((e-k)/v+.1):0),u=new M({xmin:a,ymax:k,xmax:a+l*m,ymin:k-g*v,spatialReference:u}));return{extent:u,
width:l,height:g}}w.clip=async function(l,g,h){if("extent"===h.type)return L(l,g,h);const {width:d,height:u}=l,n=new Uint8Array(d*u),{contains:A,intersects:m}=await new Promise((v,a)=>p(["../../../geometry/geometryEngine"],v,a));return m(g,h)?"polyline"===h.type?B(l,g,h):A(h,g)?l:J(l,g,h):new R({pixelType:l.pixelType,width:d,height:u,mask:n,maskIsAlpha:!1,pixels:[...l.pixels]})};w.clipRasterInfo=function(l,g){({extent:g}=z(l,g,new G({x:l.pixelSize.x,y:l.pixelSize.y,spatialReference:l.spatialReference})));
var {extent:h}=l.extent;g.xmax=Math.min(g.xmax,h.xmax);g.ymax=Math.min(g.ymax,h.ymax);if(g.xmin<g.xmax&&g.ymin<g.ymax){const {x:d,y:u}=l.pixelSize;h=Math.round(g.width/d);const n=Math.round(g.height/u);l.extent=g;l.width=h;l.height=n}};w.snapToRaster=z;Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("require exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Polygon ../../../geometry/Point ../../../geometry/SpatialReference".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g,h){function d(C,O,N){return!L.canProjectWithoutEngine(C,O,N)}function u(C,O,N){if((C=d(C,O,N))&&!L.isLoaded())throw new G("rasterprojectionhelper-project","projection engine is not loaded");return C}function n(C,O,N){u(C.spatialReference,O);return N?L.getTransformation(O,C.spatialReference,C):L.getTransformation(C.spatialReference,O,C)}function A(C,O,N){O=R.getMetersPerUnitForSR(O)/R.getMetersPerUnitForSR(N);return{x:C.x*O,y:C.y*O}}function m(C,O,N){const {spatialReference:W}=
N;if(!W||!O||W.equals(O))return C;if(W.isGeographic&&O.isGeographic)return A(C,W,O);u(W,O);if(!ma)throw new G("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let {x:ca,y:aa}=C;var ea=R.getMetersPerUnitForSR(W),ha=(ca+aa)/2*ea;ea=1;30<ha&&(ea=30/ha,ca*=ea,aa*=ea);ha=256*ca/2;var ja=256*aa/2;const {x:na,y:pa}=N.center;N=[];for(var ra=0;256>=ra;ra++)N.push([na-ha,pa-ja+ra*aa]);for(ra=1;256>=ra;ra++)N.push([na-ha+ra*ca,pa+ja]);for(ra=1;256>=ra;ra++)N.push([na+ha,
pa+ja-ra*aa]);for(ra=1;256>ra;ra++)N.push([na+ha-ra*ca,pa-ja]);N.push(N[0]);ha=new l({rings:[N],spatialReference:W});ja=L.project(ha,O);if(!ja)return A(C,W,O);ha=ja.extent;N=P(O);if(null==ha||null!=N&&ha.width>=N)return A(C,W,O);C=ma.planarArea(ja);C=Math.sqrt(C/(ca*aa*65536))/ea;ea={x:ha.width/ea/256,y:ha.height/ea/256};C={x:ca*C,y:aa*C};O=ea.x*ea.y;return.1>Math.abs(O-C.x*C.y)/O?ea:C}function v(C,O=.01){return R.getMetersPerUnitForSR(C)?O/R.getMetersPerUnitForSR(C):0}function a(C,O,N=null,W=!0){const ca=
C.spatialReference;if(ca.equals(O))return C;u(ca,O,N);N=L.project(C,O,N);if(!W||!N)return N;b([C],[N],ca,O);return N}function b(C,O,N,W){const ca=I(N,!0),aa=I(W,!0);N=v(N,500);W=v(W,500);if(N&&null!=ca&&null!=aa)for(let ea=0;ea<C.length;ea++){const ha=O[ea];if(!ha)continue;const {x:ja}=C[ea],{x:na}=ha;na>=aa[1]-W&&Math.abs(ja-ca[0])<N?ha.x-=aa[1]-aa[0]:na<=aa[0]+W&&Math.abs(ja-ca[1])<N&&(ha.x+=aa[1]-aa[0])}}function k(C){const {inSR:O,outSR:N,datumTransformation:W,preferPE:ca}=C;if(O.equals(N))return{points:C}=
t(C,null),C;if(O.isWebMercator&&N.isWGS84||O.isWGS84&&N.isWebMercator){const {cols:ja,rows:na,xres:pa,yres:ra,usePixelCenter:sa,inSR:qa,outSR:va}=C;let {xmin:ta,ymax:wa}=C;sa&&(ta+=pa/2,wa-=ra/2);C=[];const U=[];var aa=Math.max(ja,na);for(var ea=0;ea<aa;ea++){var ha=L.project(new g({x:ta+pa*Math.min(ja,ea),y:wa-ra*Math.min(na,ea),spatialReference:qa}),va);ea<=ja&&C.push(ha.x);ea<=na&&U.push(ha.y)}aa=[];for(ea=0;ea<ja;ea++)for(ha=0;ha<na;ha++)aa.push([C[ea],U[ha]]);return aa}return u(O,N,W)&&ca&&(O.isGeographic||
null!=e(O))?c(C):f(C)}function f(C){var {points:O}=t(C,null);const {inSR:N,outSR:W,datumTransformation:ca}=C;C=O.map(aa=>new g(aa[0],aa[1],N));O=L.project(C,W,ca);ca&&b(C,O,N,W);return O.map(aa=>aa?[aa.x,aa.y]:[NaN,NaN])}function c(C){const {inSR:O,outSR:N,datumTransformation:W}=C;var ca=e(O);const {points:aa,mask:ea}=t(C,ca);O.isGeographic||(C=O.wkid?J.PeFactory.coordsys(O.wkid):J.PeFactory.fromString(O.isGeographic?J.PeDefs.PE_TYPE_GEOGCS:J.PeDefs.PE_TYPE_PROJCS,O.wkt2||O.wkt),J.PeCSTransformations.projToGeog(C,
aa.length,aa));if(null!=W&&W.steps.length){var ha;N.isGeographic&&(ha=aa.map(([ja])=>179.9955<ja?1:-179.9955>ja?-1:0));W.steps.forEach(ja=>{const na=ja.wkid?J.PeFactory.geogtran(ja.wkid):J.PeFactory.fromString(J.PeDefs.PE_TYPE_GEOGTRAN,ja.wkt);J.PeGTTransformations.geogToGeog(na,aa.length,aa,null,ja.isInverse?J.PeDefs.PE_TRANSFORM_2_TO_1:J.PeDefs.PE_TRANSFORM_1_TO_2)});if(ha)for(C=0;C<aa.length;C++){ca=ha[C];const ja=aa[C][0],na=179.9955<ja?1:-179.9955>ja?-1:0;ca&&na&&ca!==na&&(aa[C][0]=0<ca?ja+360:
ja-360)}}N.isGeographic||(ha=e(N,!0),y(aa,null!=ha&&ha.isEnvelope?[ha.bbox[1],ha.bbox[3]]:[-90,90]),ha=N.wkid?J.PeFactory.coordsys(N.wkid):J.PeFactory.fromString(N.isGeographic?J.PeDefs.PE_TYPE_GEOGCS:J.PeDefs.PE_TYPE_PROJCS,N.wkt2||N.wkt),J.PeCSTransformations.geogToProj(ha,aa.length,aa));ha=aa;if(ea&&aa.length!==ea.length){ha=[];for(let ja=0,na=0;ja<ea.length;ja++)ea[ja]?ha.push(aa[na++]):ha.push([NaN,NaN])}return ha}function e(C,O=!1){var N=C.wkid||C.wkt2||C.wkt;if(!N||C.isGeographic)return null;
N=String(N);if(Y.has(N))return N=Y.get(N),O?N?.gcs:N?.pcs;var W=C.wkid?J.PeFactory.coordsys(C.wkid):J.PeFactory.fromString(C.isGeographic?J.PeDefs.PE_TYPE_GEOGCS:J.PeDefs.PE_TYPE_PROJCS,C.wkt2||C.wkt);C=v(C,1E-4);C=x(W,C);W=x(W,0,!0);Y.set(N,{pcs:C,gcs:W});return O?W:C}function x(C,O=0,N=!1){var W=J.PePCSInfo.generate(C),ca=N?C.horizonGcsGenerate():C.horizonPcsGenerate();if(!W||!ca?.length)return null;C=!1;var aa=ca.find(pa=>1===pa.getInclusive()&&1===pa.getKind());if(!aa){aa=ca.find(pa=>1===pa.getInclusive()&&
0===pa.getKind());if(!aa)return null;C=!0}N=N?0:(2===W.getNorthPoleLocation()?1:0)|(2===W.getSouthPoleLocation()?2:0);W=W.isPannableRectangle();aa=aa.getCoord();if(C)return{isEnvelope:C,isPannable:W,vertices:aa,coef:null,bbox:[aa[0][0]-O,aa[0][1]-O,aa[1][0]+O,aa[1][1]+O],poleLocation:N};O=0;C=[];let [ea,ha]=aa[0],[ja,na]=aa[0];for(let pa=0,ra=aa.length;pa<ra;pa++){O++;O===ra&&(O=0);const [sa,qa]=aa[pa],[va,ta]=aa[O];if(ta===qa)C.push([sa,va,qa,ta,2]);else{ca=(va-sa)/(ta-qa||1E-4);const wa=sa-ca*qa;
qa<ta?C.push([ca,wa,qa,ta,0]):C.push([ca,wa,ta,qa,1])}ea=ea<sa?ea:sa;ha=ha<qa?ha:qa;ja=ja>sa?ja:sa;na=na>qa?na:qa}return{isEnvelope:!1,isPannable:W,vertices:aa,coef:C,bbox:[ea,ha,ja,na],poleLocation:N}}function t(C,O){const N=[],{cols:W,rows:ca,xres:aa,yres:ea,usePixelCenter:ha}=C;let {xmin:ja,ymax:na}=C;ha&&(ja+=aa/2,na-=ea/2);if(null==O){for(C=0;C<W;C++)for(O=0;O<ca;O++)N.push([ja+aa*C,na-ea*O]);return{points:N}}C=new Uint8Array(W*ca);if(O.isEnvelope){const {bbox:[wa,U,ka,Z]}=O;for(let la=0,oa=
0;la<W;la++){var pa=ja+aa*la,ra=O.isPannable||pa>=wa&&pa<=ka;for(var sa=0;sa<ca;sa++,oa++){var qa=na-ea*sa;ra&&qa>=U&&qa<=Z&&(N.push([pa,qa]),C[oa]=1)}}return{points:N,mask:C}}pa=O.coef;O=[];for(ra=0;ra<ca;ra++){var va=na-ea*ra;sa=[];qa=[];for(var ta=0;ta<pa.length;ta++){const [wa,U,ka,Z,la]=pa[ta];va===ka&&ka===Z?(sa.push(wa),sa.push(U),qa.push(2),qa.push(2)):va>=ka&&va<=Z&&(sa.push(wa*va+U),qa.push(la))}va=sa;if(2<sa.length){ta=2===qa[0]?0:qa[0];let wa=sa[0];va=[];for(let U=1;U<qa.length;U++)if(2!==
qa[U]||U===qa.length-1)qa[U]!==ta&&(va.push(0===ta?Math.min(wa,sa[U-1]):Math.max(wa,sa[U-1])),ta=qa[U],wa=sa[U]),U===qa.length-1&&va.push(0===qa[U]?Math.min(wa,sa[U]):Math.max(wa,sa[U]));va.sort((U,ka)=>U-ka)}else sa[0]>sa[1]&&(va=[sa[1],sa[0]]);O.push(va)}for(let wa=0,U=0;wa<W;wa++)for(pa=ja+aa*wa,ra=0;ra<ca;ra++,U++)if(sa=na-ea*ra,qa=O[ra],2===qa.length)pa>=qa[0]&&pa<=qa[1]&&(N.push([pa,sa]),C[U]=1);else if(2<qa.length){va=!1;for(ta=0;ta<qa.length;ta+=2)if(pa>=qa[ta]&&pa<=qa[ta+1]){va=!0;break}va&&
(N.push([pa,sa]),C[U]=1)}return{points:N,mask:C}}function y(C,O){const [N,W]=O;for(O=0;O<C.length;O++){const ca=C[O][1];if(ca<N||ca>W)C[O]=[NaN,NaN]}}function q(C,O){const N=P(C[0].spatialReference);if(2>C.length||null==N)return C[0];O=O??v(C[0].spatialReference);C=C.filter(ha=>ha.width>O);if(1===C.length)return C[0];let {xmin:W,xmax:ca,ymin:aa,ymax:ea}=C[0];for(let ha=1;ha<C.length;ha++){const ja=C[ha];ca=ja.xmax+N*ha;aa=Math.min(aa,ja.ymin);ea=Math.max(ea,ja.ymax)}return new z({xmin:W,xmax:ca,ymin:aa,
ymax:ea,spatialReference:C[0].spatialReference})}function D(C,O,N=null,W=!0){var ca=C.spatialReference;if(ca.equals(O))return C;var aa=E(C);const ea=P(ca,!0);var ha=P(O);if(0===aa||null==ea||null==ha)return aa=H(C,O,N,W),null==ea&&null!=ha&&Math.abs(aa.width-ha)<v(O)&&L.isLoaded()&&(ca=e(ca),null!=ca&&ca.poleLocation===da.None&&C.width<(ca.bbox[2]-ca.bbox[0])/2)?K(C,O)||aa:aa;ha=C.clone().normalize();if(1===ha.length&&C.xmax<ea&&C.xmax-ea/2>v(ca)){const {xmin:ja,xmax:na}=C;for(let pa=0;pa<=aa;pa++)ha[pa]=
new z({xmin:0===pa?ja:-ea/2,xmax:pa===aa?na-ea*pa:ea/2,ymin:C.ymin,ymax:C.ymax,spatialReference:ca})}C=ha.map(ja=>H(ja,O,N,W));return q(C.filter(M.isSome))}function K(C,O){const N=P(O);if(null==N)return null;let {xmin:W,ymin:ca,xmax:aa,ymax:ea}=C;var ha=C.spatialReference;C=new l({spatialReference:ha,rings:[[[W,ca],[aa,ca],[aa,ea],[W,ea],[W,ca]]]});C=L.project(C,O);if(2!==C.rings.length||!C.rings[0].length||!C.rings[1].length)return null;({rings:C}=C);ha=v(ha);O=new z({spatialReference:O});for(let ja=
0;2>ja;ja++){W=aa=C[ja][0][0];ca=ea=C[ja][0][1];for(let na=0;na<C[ja].length;na++)W=W>C[ja][na][0]?C[ja][na][0]:W,aa=aa<C[ja][na][0]?C[ja][na][0]:aa,ca=ca>C[ja][na][1]?C[ja][na][1]:ca,ea=ea<C[ja][na][1]?C[ja][na][1]:ea;if(0===ja)O.ymin=ca,O.ymax=ea,O.xmin=W,O.xmax=aa;else if(O.ymin=Math.min(O.ymin,ca),O.ymax=Math.max(O.ymax,ea),Math.abs(aa-N/2)<ha)O.xmin=W,O.xmax+=N;else if(Math.abs(W+N/2)<ha)O.xmax=aa+N;else return null}return O}function H(C,O,N=null,W=!0,ca=!0){const aa=C.spatialReference;if(aa.equals(O)||
!O)return C;u(aa,O,N);const ea=L.project(C,O,N);if(ca&&O.isWebMercator&&ea&&(ea.ymax=Math.min(2.0037508342787E7,ea.ymax),ea.ymin=Math.max(-2.0037508342787E7,ea.ymin),ea.ymin>=ea.ymax))return null;if(!W||!ea)return ea;var ha=I(aa,!0);W=I(O,!0);if(null==ha||null==W)return ea;ca=v(aa,.001);const ja=v(aa,500);var na=v(O,.001);if(Math.abs(ea.xmin-W[0])<na&&Math.abs(ea.xmax-W[1])<na){na=Math.abs(C.xmin-ha[0]);ha=Math.abs(ha[1]-C.xmax);if(na<ca&&ha>ja){ea.xmin=W[0];var pa=[];pa.push(new g(C.xmax,C.ymin,
aa));pa.push(new g(C.xmax,(C.ymin+C.ymax)/2,aa));pa.push(new g(C.xmax,C.ymax,aa));pa=pa.map(ra=>a(ra,O,N)).filter(ra=>!isNaN(ra?.x)).map(ra=>ra.x);ea.xmax=Math.max.apply(null,pa)}ha<ca&&na>ja&&(ea.xmax=W[1],W=[],W.push(new g(C.xmin,C.ymin,aa)),W.push(new g(C.xmin,(C.ymin+C.ymax)/2,aa)),W.push(new g(C.xmin,C.ymax,aa)),C=W.map(ra=>a(ra,O,N)).filter(ra=>!isNaN(ra?.x)).map(ra=>ra.x),ea.xmin=Math.min.apply(null,C))}else C=v(O,.001),Math.abs(ea.xmin-W[0])<C&&(ea.xmin=W[0]),Math.abs(ea.xmax-W[1])<C&&(ea.xmax=
W[1]);return ea}function P(C,O=!1){return C?C.isWebMercator?2*(O?2.0037508342787E7:2.0037508342788905E7):C.wkid&&C.isGeographic?360:2*T[C.wkid]||null:null}function I(C,O=!1){if(C.isGeographic)return[-180,180];C=P(C,O);return null!=C?[-C/2,C/2]:null}function S(C,O,N,W){C=(C-O)/N;0!==C-Math.floor(C)?C=Math.floor(C):W&&--C;return C}function E(C,O=!1){var N=P(C.spatialReference);if(null==N)return 0;const W=O?0:-(N/2),ca=v(C.spatialReference),aa=!O&&Math.abs(C.xmin+N/2)<ca?-N/2:C.xmin;C=S(!O&&Math.abs(C.xmax-
N/2)<ca?N/2:C.xmax,W,N,!0);N=S(aa,W,N,!1);return C-N}function F(C){const {projectedExtent:O,srcBufferExtent:N,pixelSize:W,datumTransformation:ca,rasterTransform:aa}=C;var ea=O.spatialReference;const ha=N.spatialReference;var ja=u(ea,ha);const {xmin:na,ymin:pa,xmax:ra,ymax:sa}=O,qa=P(ha),va=null!=qa&&(C.hasWrapAround||"gcs-shift"===aa?.type);C=C.spacing||[32,32];var ta=C[0]*W.x,wa=C[1]*W.y;const U=1===C[0],ka=Math.ceil((ra-na)/ta-.1/C[0])+(U?0:1),Z=Math.ceil((sa-pa)/wa-.1/C[1])+(U?0:1);ta=k({cols:ka,
rows:Z,xmin:na,ymax:sa,xres:ta,yres:wa,inSR:ea,outSR:ha,datumTransformation:ca,preferPE:4>=C[0],usePixelCenter:U});wa=[];let la,oa=0;const fa=U?-1:NaN,{xmin:ua,xmax:xa,ymax:ya,width:za,height:Ba}=N,Ca=v(ha,500),Fa=null!=qa&&0<ua&&xa>qa/2;var Da=!1;ja&&(Da=e(ea),Da=null!=Da&&0<Da.poleLocation);for(ea=0;ea<ka;ea++){ja=[];for(let Ea=0;Ea<Z;Ea++){var Aa=ta[ea*Z+Ea];va&&Aa[0]>xa&&Aa[0]>qa/2-Ca?Aa[0]-=qa:va&&0===ea&&0>Aa[0]&&Fa&&!aa&&(Aa[0]+=qa);!Aa||isNaN(Aa[0])||isNaN(Aa[1])?(wa.push(fa),wa.push(fa),
ja.push(null),oa++):(aa&&(Aa=aa.inverseTransform(new g({x:Aa[0],y:Aa[1],spatialReference:ha})),Aa=[Aa.x,Aa.y]),ja.push(Aa),0<ea&&va&&la[Ea]&&Aa[0]<la[Ea][0]&&(Aa[0]+=qa,Da&&Aa[0]>xa&&Aa[0]>qa&&(Aa[0]-=qa)),wa.push((Aa[0]-ua)/za),wa.push((ya-Aa[1])/Ba))}la=ja}return{offsets:wa,error:null,coefficients:null,outofBoundPointCount:oa,spacing:C,size:U?[ka,Z]:[ka-1,Z-1]}}function Q(C,O,N){const {cols:W,rows:ca}=O;O=new Float32Array((W-1)*(ca-1)*12);const aa=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),ea=
new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let sa=0;sa<W-1;sa++){for(var ha=0;ha<ca-1;ha++){var ja=sa*ca*2+2*ha,na=C[ja];const qa=C[ja+1];var pa=C[ja+2],ra=C[ja+3];ja+=2*ca;const va=C[ja],ta=C[ja+1],wa=C[ja+2];ja=C[ja+3];let U=0,ka=12*(ha*(W-1)+sa);for(let Z=0;3>Z;Z++)O[ka++]=aa[U++]*na+aa[U++]*pa+aa[U++]*wa;U=0;for(pa=0;3>pa;pa++)O[ka++]=aa[U++]*qa+aa[U++]*ra+aa[U++]*ja;U=0;for(ra=0;3>ra;ra++)O[ka++]=ea[U++]*na+ea[U++]*va+ea[U++]*wa;U=0;for(na=0;3>na;na++)O[ka++]=ea[U++]*qa+ea[U++]*ta+ea[U++]*ja}if(N)for(ha=
0;ha<O.length;ha++)isNaN(O[ha])&&(O[ha]=-1)}return O}function V(C,O){C=C.clone().normalize();return 1===C.length?C[0]:q(C,O)}function ba(C,O){const {pixelSize:N,extent:W}=C;C=n(W,O,!1);const ca=V(W,(N.x+N.y)/16);return D(ca,O,C)}var da;(function(C){C[C.None=0]="None";C[C.North=1]="North";C[C.South=2]="South";C[C.Both=3]="Both"})(da||={});const X=(C,O,N,W=0)=>{if(1===N[0])return[0,0];var ca=1,aa=-1,ea=1,ha=-1;for(var ja=0;ja<C.length;ja+=2)isNaN(C[ja])||(ca=ca>C[ja]?C[ja]:ca,aa=aa>C[ja]?aa:C[ja],ea=
ea>C[ja+1]?C[ja+1]:ea,ha=ha>C[ja+1]?ha:C[ja+1]);const {cols:na,rows:pa}=O;O=(aa-ca)/na/N[0];N=(ha-ea)/pa/N[1];W*=2;ea=0;ha=!1;ca=[0,0];for(aa=0;aa<na-3;aa++){for(ja=0;ja<pa-3;ja++){var ra=aa*pa*2+2*ja;const sa=Math.abs(((C[ra]+C[ra+4]+C[ra+4*pa]+C[ra+4*pa+4])/4-C[ra+2*pa+2])/O);ra=Math.abs(((C[ra+1]+C[ra+5]+C[ra+4*pa+1]+C[ra+4*pa+5])/4-C[ra+2*pa+3])/N);sa+ra>ea&&(ea=sa+ra,ca=[sa,ra]);if(W&&ea>W){ha=!0;break}}if(ha)break}return ca},T={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,
3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,
54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},Y=new Map,ia=new Map;let ma=null;w.computeProjectedScales=function(C,O,N){var W=N?.tileSize??512,ca=N?.alignGlobalDatasetWithAGOL??!0,aa=!!N?.limitToSrcResolution;const {extent:ea,spatialReference:ha,pixelSize:ja}=C;N=m(ja,O,ea);if(null==N)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const na=(N.x+
N.y)/2,pa=R.getMetersPerUnitForSR(O);var ra=na*pa*96*39.37,sa=O.isGeographic?256/W*2.958287637958547E8:256/W*5.91657527591555E8,qa="vector-magdir"===C.dataType||"vector-uv"===C.dataType,va=ba(C,O),ta=Math.min(Math.ceil(Math.log(Math.min(C.width,C.height)/32)/Math.LN2),Math.ceil(Math.log(sa/2/ra)/Math.LN2));if(!qa&&ca&&(O.isGeographic||O.isWebMercator)&&(ca=P(O),qa=0<E(va)||null!=ca&&va.width>ca/4,!qa&&null!=ca)){qa=-1;if(3>ta)qa=2**ta*na*W;else if(C.storageInfo){const {maximumPyramidLevel:wa=0,pyramidScalingFactor:U=
2}=C.storageInfo;qa=U**wa*na*W}W=Math.ceil(ca/qa);qa=1===W||2===W&&ca/2-va.xmax<qa}W=ra;va=Math.min(2,Math.max(1.414,C.storageInfo?.pyramidScalingFactor||2));if(qa)W=sa,sa=O.isGeographic?1.341104507446289E-6:.29858214164761665,ta=96*sa*pa*39.37,C=ba(C,new h({wkid:O.isGeographic?4326:3857})),C=m({x:sa,y:sa},ha,C),C.x*=W/ta,C.y*=W/ta;else{C={x:ja.x,y:ja.y};for(O=0;W<.5005*sa&&O<ta;)O++,W*=va,C.x*=va,C.y*=va;1.001>=Math.max(W,sa)/Math.min(W,sa)&&(W=sa)}O=[W];sa=[{x:C.x,y:C.y}];for(ra=Math.min(70.5310735,
ra)/1.001;W>=ra;)W/=va,C.x/=va,C.y/=va,O.push(W),sa.push({x:C.x,y:C.y});if(aa){const wa=.001*ja.x;aa=sa.findIndex(U=>U.x>=ja.x-wa&&U.x<=ja.x+wa);-1<aa?(sa.length=aa+1,O.length=aa+1):(aa=sa.findIndex(U=>U.x<=ja.x+wa),0<aa&&(sa.length=aa,O.length=aa))}return{projectedPixelSize:N,scales:O,srcResolutions:sa,isCustomTilingScheme:!qa}};w.defaultGridSpacing=32;w.defaultProjectionToleranceInPixels=4;w.getDefaultDatumTransformationForDataset=n;w.getProjectedGridPoints=k;w.getProjectionOffsetGrid=function(C){var O=
C.isAdaptive&&null==C.spacing;let N=C.spacing||[32,32],W=F(C);var ca={cols:W.size[0]+1,rows:W.size[1]+1};const aa=0<W.outofBoundPointCount&&W.outofBoundPointCount<W.offsets.length/2;let ea=W.outofBoundPointCount===W.offsets.length/2||O&&aa?[0,0]:X(W.offsets,ca,N,4);const ha=(ea[0]+ea[1])/2;var ja=C.projectedExtent.spatialReference;const na=C.srcBufferExtent.spatialReference;O&&(aa||4<ha)&&(d(ja,na,C.datumTransformation)&&(ja.isGeographic||null!=e(ja)),N=[4,4],W=F({...C,spacing:N}),ca={cols:W.size[0]+
1,rows:W.size[1]+1},ea=X(W.offsets,ca,N,4));W.error=ea;1<N[0]&&(W.coefficients=Q(W.offsets,ca,aa));!C.includeGCSGrid||ja.isGeographic||ja.isWebMercator||(na.isGeographic?W.gcsGrid={offsets:W.offsets,coefficients:W.coefficients,spacing:N}:(O=e(ja),null==O||O.isEnvelope||(ja&&!ja.isGeographic&&(O=String(ja.wkid||ja.wkt2||ja.wkt),ia.has(O)?ja=ia.get(O):(ja=(ja.wkid?J.PeFactory.coordsys(ja.wkid):J.PeFactory.fromString(J.PeDefs.PE_TYPE_PROJCS,ja.wkt2||ja.wkt)).getGeogcs().getCode(),ia.set(O,ja)),ja=new h({wkid:ja})),
ja=D(C.projectedExtent,ja),{offsets:C}=F({...C,srcBufferExtent:ja,spacing:N}),ca=Q(C,ca,aa),W.gcsGrid={offsets:C,coefficients:ca,spacing:N})));return W};w.getRasterDatasetAlignmentInfo=function(C){const O=C.storageInfo.origin.x;var N=P(C.spatialReference,!0);if(null==N)return{originX:O,halfWorldWidth:null,pyramidsInfo:null};const W=N/2,{nativePixelSize:ca,storageInfo:aa,extent:ea}=C,{maximumPyramidLevel:ha,blockWidth:ja,pyramidScalingFactor:na}=aa;let pa=ca.x;const ra=[];C=null!=C.transform&&"gcs-shift"===
C.transform.type;const sa=O+(C?0:W);N=C?N-O:W-O;for(let qa=0;qa<=ha;qa++){const va=(ea.xmax-O)/pa/ja,ta=N/pa/ja;ra.push({resolutionX:pa,blockWidth:ja,datasetColumnCount:0===va-Math.floor(va)?va:Math.ceil(va),worldColumnCountFromOrigin:0===ta-Math.floor(ta)?ta:Math.ceil(ta),leftMargin:Math.round(sa/pa)%ja,rightPadding:(ja-Math.round(N/pa)%ja)%ja,originColumnOffset:Math.floor(sa/pa/ja)});pa*=na}return{originX:O,halfWorldWidth:W,pyramidsInfo:ra,hasGCSSShiftTransform:C}};w.getWorldWidth=P;w.getWorldWrapCount=
E;w.load=async function(){ma&&L.isLoaded()||(L.isLoaded()||await L.load(),ma=await new Promise((C,O)=>p(["../../../geometry/geometryEngine"],C,O)))};w.minimumGridSpacing=4;w.projectDatasetExtent=ba;w.projectDatasetResolution=m;w.projectExtent=D;w.projectPoint=a;w.projectPolygon=function(C,O,N){if("extent"===C.type){const {xmin:W,ymin:ca,xmax:aa,ymax:ea,spatialReference:ha}=C;C=new l({rings:[[[W,ea],[aa,ea],[aa,ca],[W,ca],[W,ea]]],spatialReference:ha})}if(C.spatialReference.equals(O))return C;u(C.spatialReference,
O,N);return L.project(C,O,N)};w.projectResolution=function(C,O,N,W=null){const ca=C.spatialReference;if(!ca||!O||ca.equals(O))return C;u(ca,O,W);N=N.center;N=new z({xmin:N.x-C.x/2,xmax:N.x+C.x/2,ymin:N.y-C.y/2,ymax:N.y+C.y/2,spatialReference:ca});W=L.project(N,O,W);N=P(O);return null==W||null!=N&&W.width>=N?A(C,ca,O):{x:W.width,y:W.height}};w.requirePE=d;w.shiftExtent=function(C){var {spatialReference:O}=C;O=B.getInfo(O);if(!O)return C;const [N,W]=O.valid;O=W-N;let ca=0;C.xmin<N?ca=Math.ceil((N-C.xmin)/
O):C.xmin>W&&(ca=-Math.ceil((C.xmin-W)/O));return new z({spatialReference:C.spatialReference,xmin:C.xmin+ca*O,ymin:C.ymin,xmax:C.xmax+ca*O,ymax:C.ymax})};w.snapExtent=V;w.snapPyramid=function(C,O,N){const {storageInfo:W,pixelSize:ca}=O;var aa=0;let ea=!1;var {pyramidResolutions:ha}=W,ja="mixed"===W.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,W.tileInfo.dpi/96)):1;ja=(C.x+C.y)/2/ja;if(null!=ha&&ha.length){C=ha[ha.length-1];C=(C.x+C.y)/2;var na=(ca.x+ca.y)/2;if(ja<=na)aa=0;else if(ja>=C)aa=
ha.length,ea=8<ja/C;else{C=na;for(let pa=1;pa<=ha.length;pa++){na=(ha[pa-1].x+ha[pa-1].y)/2;if(ja<=na){ja===na?aa=pa:"down"===N?(aa=pa-1,ea=8<ja/C):aa="up"===N?pa:ja-C>na-ja||2<ja/C?pa:pa-1;break}C=na}}N=0===aa?ca:ha[aa-1];ea&&(ha=Math.min(N.x,N.y),ja=R.getMetersPerUnitForSR(O.spatialReference),19567<ha*ja&&(ea=!1));return{pyramidLevel:aa,pyramidResolution:new g({x:N.x,y:N.y,spatialReference:O.spatialReference}),excessiveReading:ea}}aa=Math.log(C.x/ca.x)/Math.LN2;ja=Math.log(C.y/ca.y)/Math.LN2;ha=
O.storageInfo.maximumPyramidLevel||0;aa="down"===N?Math.floor(Math.min(aa,ja)):"up"===N?Math.ceil(Math.max(aa,ja)):Math.round((aa+ja)/2);0>aa?aa=0:aa>ha&&(ea=aa>ha+3,aa=ha);N=2**aa;O=new g({x:N*O.nativePixelSize.x,y:N*O.nativePixelSize.y,spatialReference:O.spatialReference});return{pyramidLevel:aa,pyramidResolution:O,excessiveReading:ea}};Object.defineProperty(w,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g){r=class extends L{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var h=this.sourceRasterInfos[0];if(1<h.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:d,colormapName:u,colorRamp:n,colorRampName:A}=this.functionArguments;if(!d?.length)if(n)this.colorRamp=n,d=l.convertColorRampToColormap(n,
{interpolateAlpha:!0});else if(A){var m=l.getColorRampJSON(A);m&&(d=l.convertColorRampToColormap(m),this.colorRamp=g.fromJSON(m))}else u&&(d=z.getColormapByName(u));if(!d?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};m=this._getOutputPixelType(h.pixelType);this.outputPixelType=m.startsWith("f")?"s32":m;h=h.clone();h.pixelType=this.outputPixelType;h.colormap=d;h.bandCount=1;this.rasterInfo=h;return{success:!0,supportsGPU:!0}}_processPixels(h){h=h.pixelBlocks?.[0];
if(!h||J.isIntegerPixelType(h.pixelType))return h;h=h.clone();h.clamp(this.outputPixelType);return h}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property()],r.prototype,"isNoopProcess",void 0);p.__decorate([w.property({json:{write:!0}})],
r.prototype,"indexedColormap",void 0);p.__decorate([w.property()],r.prototype,"colorRamp",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],r)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;J=z=class extends J{castColormapName(l){if(!l)return null;l=l.toLowerCase();return L.rasterColormapNames.includes(l)?l:null}readColorRamp(l){return B.fromJSON(l)}readColorRampName(l,g){return l?(g=L.colorRampDict.jsonValues.find(h=>h.toLowerCase()===l.toLowerCase()))?L.colorRampDict.fromJSON(g):null:null}clone(){return new z({colormap:w.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};p.__decorate([r.property({type:[[Number]],
json:{write:!0}})],J.prototype,"colormap",void 0);p.__decorate([r.property({type:String,json:{write:!0}})],J.prototype,"colormapName",void 0);p.__decorate([M.cast("colormapName")],J.prototype,"castColormapName",null);p.__decorate([r.property({types:B.types,json:{write:!0}})],J.prototype,"colorRamp",void 0);p.__decorate([G.reader("colorRamp")],J.prototype,"readColorRamp",null);p.__decorate([r.property({type:L.colorRampDict.apiValues,json:{type:L.colorRampDict.jsonValues,write:L.colorRampDict.write}})],
J.prototype,"colorRampName",void 0);p.__decorate([G.reader("colorRampName")],J.prototype,"readColorRampName",null);return J=z=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],J)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(p,w,r,M,G){function R(a,b){if(!a||!b||a.length!==b.length)return!1;for(let k=0;k<a.length;k++)if(a[k]>b[k]+2||a[k]<
b[k]-2)return!1;return!0}function J(a){const b=a.clone();b.fromColor=a.toColor;b.toColor=a.fromColor;b.algorithm=a.algorithm;return b}function L(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(b=>J(b));return a}return J(a)}function B(a,b){if(a){b=b??m;var k=null;"algorithmic"===a.type?b.some(f=>{if(R(a.fromColor.toRgb(),f.fromColor)&&R(a.toColor.toRgb(),f.toColor))return k=f.id,!0}):"multipart"===a.type&&b.some(f=>{const c=a.colorRamps,
e=f.colorRamps;if(c&&e&&c.length===e.length&&!e.some((x,t)=>{if(!R(c[t].fromColor.toRgb(),(new w(x.fromColor)).toRgb())||!R(c[t].toColor.toRgb(),(new w(x.toColor)).toRgb()))return!0})){if(k)return!0;k=f.id}});return k}}function z(a,b,k=!1){if(a){var f=!1,c=B(a,b);null!=c||k||(f=!0,a=L(a),c=B(a,b));return c?{id:c,inverted:f}:void 0}}function l(a,b=!1){return(a="string"===typeof a?a:z(a,void 0,b)?.id)?v.toJSON(a):null}function g(a){a=a||{};const b=a.numColors||256;return{...a,numColors:b,distanceOffset:a.distanceOffset||
0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(b-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(b-1),weights:a.weights}}function h(a,b){let {fromColor:k,toColor:f}=a;k=[...k];f=[...f];3===k.length&&(k=k.concat([255]));3===f.length&&(f=f.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var c=g(b);const {numColors:e,distanceOffset:x,isCustomInterval:t,interpolateAlpha:y}=c;if(1===e&&0===x)return[k];
if(2===e&&0===x&&!t)return[k,f];var q={r:k[0],g:k[1],b:k[2]};b={r:f[0],g:f[1],b:f[2]};if("esriCIELabAlgorithm"===a){a=r.toLAB(q);b=r.toLAB(b);const {numColors:P,distanceOffset:I,distanceInterval:S,isCustomInterval:E}=c;let {l:F,a:Q,b:V}=a;a=(b.l-F)*S;q=(b.a-Q)*S;c=(b.b-V)*S;var D=[];if(I){var K=I/S;F+=K*a;Q+=K*q;V+=K*c}for(K=0;K<P-1;K++)D.push({l:F,a:Q,b:V}),F+=a,Q+=q,V+=c;D.push(E?{l:F,a:Q,b:V}:b);b=D}else if("esriHSVAlgorithm"===a){a=r.toHSV(q);b=r.toHSV(b);const {numColors:P,distanceOffset:I,distanceInterval:S,
isCustomInterval:E}=c;D=0===a.s;K=0===b.s;q=a.h;c=b.h;D&&!K?q=c:K&&!D&&(b={...b,h:q},c=q);D=Math.abs(c-q);180>D?c=(c-q)*S:(D=360-D,c=q>c?D*S:-D*S);D=(b.s-a.s)*S;K=(b.v-a.v)*S;let {s:F,v:Q}=a;a=q;I&&(q=I/S,a=(a+q*c+360)%360,F+=q*D,Q+=q*K);q=[];for(var H=0;H<P-1;H++)q.push({h:a,s:F,v:Q}),a=(a+c+360)%360,F+=D,Q+=K;q.push(E?{h:a,s:F,v:Q}:b);b=q}else{q=r.toLCH(q);b=r.toLCH(b);const {numColors:P,distanceOffset:I,distanceInterval:S,isCustomInterval:E}=c;c=q.h;D=b.h;a=2*Math.PI;c<=D?(K=D-c,c=D-c-a,c=Math.abs(c)<
Math.abs(K)?c:K):(K=D+a-c,c=D-c,c=Math.abs(c)<Math.abs(K)?c:K);c*=S;D=(b.l-q.l)*S;K=(b.c-q.c)*S;let {l:F,c:Q,h:V}=q;I&&(q=I/S,F+=q*D,Q+=q*K,V=(V+q*c+a)%a);q=[];for(H=0;H<P-1;H++)q.push({l:F,c:Q,h:V}),F+=D,Q+=K,V=(V+c+a)%a;q.push(E?{l:F,c:Q,h:V}:b);b=q}a=[];q=k[3]??255;c=((f[3]??255)-q)/(e-1);for(D=0;D<e;D++){const {r:P,g:I,b:S}=r.toRGB(b[D]);a.push([P,I,S,y?Math.round(q+c*D):255])}return a}function d(a,b){const {numColors:k,interpolateAlpha:f}=g(b);b=b?.weights;({colorRamps:a}=a);if(b){const D=b.reduce((K,
H)=>K+H);b=b.map(K=>K/D)}else{b=[];for(var c=0;c<a.length;c++)b[c]=1/a.length}c=[];const e=1/(k-1);let x=0,t=!1;for(let D=0;D<a.length;D++){var y=c.length,q=t?0:y*e-x;x+=b[D];y=D===a.length-1?k-1-y:(b[D]-q)/e;t=Math.ceil(y)===y;y=Math.ceil(y);0!==y&&(q=h(a[D],{numColors:y,interpolateAlpha:f,distanceOffset:q/b[D],distanceInterval:e/b[D]}),c.push(...q))}b=[...a[a.length-1].toColor];3===b.length&&b.push(255);c.push(b);return c}function u(a,b){a=G.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?
d(a,b):h(a,b)}function n(a){a=r.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function A(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:n(a.fromColor),ToColor:n(a.toColor)}}const m=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,
251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",
fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,
57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,
237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",
type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",
fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,
255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],
toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,
57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,
0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,
0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,
153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,
255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,
147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],v=new M.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark",
"Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright",
"Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",
Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright",
"Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue",
"Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});p.colorRampDict=v;p.convertColorRampToColormap=function(a,b){a=u(a,b);const k=b?.interpolateAlpha;a.forEach((f,c)=>{f.unshift(c);k||f.pop()});return a};p.convertColorRampToColors=u;p.convertRGBATo32Bit=function(a){a=a.reverse().map(b=>{b=b.toString(16);return 2>b.length?"0"+b:b});return 4294967295&Number.parseInt(a.join(""),16)};p.createHsvMap=function(a){const b=
[];for(let k=0;k<a.length;k+=4){const f=r.toHSV({r:a[k],g:a[k+1],b:a[k+2]});b.push([f.h/60,f.s/100,255*f.v/100])}return b};p.getColorRampId=z;p.getColorRampJSON=function(a,b="esriCIELabAlgorithm"){const k=m.find(({id:f})=>f===a);return k?k.colorRamps?{type:"multipart",colorRamps:k.colorRamps.map(f=>({type:"algorithmic",algorithm:b,fromColor:[...f.fromColor],toColor:[...f.toColor]}))}:{type:"algorithmic",algorithm:b,fromColor:[...k.fromColor],toColor:[...k.toColor]}:null};p.getColorRampName=l;p.getRFxArgColorRampValue=
function(a){const b=l(a);return b?"algorithmic"===a.type?{...A(a),Name:b}:a.colorRamps?(a=a.colorRamps.map(A),{type:"MultiPartColorRamp",NumColorRamps:a.length,ArrayOfColorRamp:a,Name:b}):null:null};p.predefinedJsonColorRamps=m;p.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(p,
w,r,M){r={key:"type",base:r,typeMap:{algorithmic:w,multipart:M}};p.fromJSON=function(G){return G?.type?"algorithmic"===G.type?w.fromJSON(G):"multipart"===G.type?M.fromJSON(G):null:null};p.types=r;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),
function(p,w,r,M,G,R,J,L){var B;L=B=class extends L{constructor(z){super(z);this.toColor=this.fromColor=this.algorithm=null;this.type="algorithmic"}clone(){return new B({fromColor:r.clone(this.fromColor),toColor:r.clone(this.toColor),algorithm:this.algorithm})}};p.__decorate([R.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],L.prototype,"algorithm",void 0);p.__decorate([M.property({type:w,json:{type:[G.Integer],write:!0}})],L.prototype,"fromColor",
void 0);p.__decorate([M.property({type:w,json:{type:[G.Integer],write:!0}})],L.prototype,"toColor",void 0);p.__decorate([M.property({type:["algorithmic"]})],L.prototype,"type",void 0);return L=B=p.__decorate([J.subclass("esri.rest.support.AlgorithmicColorRamp")],L)})},"esri/rest/support/ColorRamp":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,w,r,M,G,R,J){w=class extends w.JSONSupport{constructor(L){super(L);this.type=null}};p.__decorate([r.property({readOnly:!0,json:{read:!1,write:!0}})],w.prototype,"type",void 0);return w=p.__decorate([J.subclass("esri.rest.support.ColorRamp")],w)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(p,w,r,M,G,R,J,L){var B;M=B=class extends L{constructor(z){super(z);this.colorRamps=null;this.type="multipart"}clone(){return new B({colorRamps:w.clone(this.colorRamps)})}};p.__decorate([r.property({type:[J],json:{write:!0}})],M.prototype,"colorRamps",void 0);p.__decorate([r.property({type:["multipart"]})],M.prototype,"type",void 0);return M=B=p.__decorate([R.subclass("esri.rest.support.MultipartColorRamp")],M)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports",
"../../../renderers/support/colorRampUtils"],function(p,w){function r(L,B){const z=[],l=[];for(let g=0;g<L.length-1;g++)z.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:L[g].slice(1),toColor:L[g+1].slice(1)}),l.push(L[g+1][0]-L[g][0]);L=L[L.length-1][0];B=B??l;return w.convertColorRampToColors({type:"multipart",colorRamps:z},{numColors:L,weights:B})}function M(){const L=r([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,
144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let B=L.length;256>B;B++)L.push([6,27,7]);return L}function G(){const L=[];for(let B=0;256>B;B++){const z=[];for(let l=0;3>l;l++)z.push(Math.round(255*Math.random()));L.push(z)}return L}const R=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,
89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],
[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,
197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,
166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],J=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,
83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,
99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,
108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,
0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,
115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];p.getColormapByName=function(L){let B;switch(L){case "elevation":B=r([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case "gray":B=w.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":B=r([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":B=R;break;case "ndvi2":B=
M();break;case "ndvi3":B=J;break;case "random":B=G()}return B?B=B.map((z,l)=>[l,...z]):null};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapToRGBFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../SimpleBandStatistics ./BaseRasterFunction ./ColormapToRGBFunctionArguments ./pixelUtils ../../../renderers/support/rasterRendererChecks".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l){r=class extends L{constructor(){super(...arguments);this.functionName="ColormapToRGB";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var g=this.sourceRasterInfos[0];if(1<g.bandCount||!g.colormap?.length)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: source data must be single band with a colormap"};const h=g.clone();h.pixelType=this.outputPixelType=this._getOutputPixelType("u8");this._removeStatsHistColormapVAT(h);
h.bandCount=3;h.statistics=[{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20}];this.rasterInfo=h;g=[...g.colormap].sort((n,A)=>n[0]-A[0]);const {indexedColormap:d,offset:u}=z.createColormapLUT({colormap:g});if(!d)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: the colormap is not supported"};this.lookup={indexedColormap:d,offset:u};return{success:!0,supportsGPU:l.isColormapSupportedByWebGL(d)}}_processPixels(g){g=g.pixelBlocks?.[0];
if(!g||!this.lookup)return g;g=g.clone();const h=g.pixels[0],d=g.mask??(new Uint8Array(h.length)).fill(255),u=new Uint8Array(h.length),n=new Uint8Array(h.length),A=new Uint8Array(h.length),{indexedColormap:m,offset:v}=this.lookup,a=m.length;for(let b=0;b<h.length;b++)if(d[b]){let k=4*(h[b]-v);0>k||k>a-4?d[b]=0:(u[b]=m[k++],n[b]=m[k++],A[b]=m[k++])}g.pixels=[u,n,A];g.statistics=[new J.SimpleBandStatistics(0,255),new J.SimpleBandStatistics(0,255),new J.SimpleBandStatistics(0,255)];g.pixelType=this.outputPixelType;
return g}_getWebGLParameters(){return this.lookup}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"lookup",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapToRGBFunction")],
r)})},"esri/layers/support/rasterFunctions/ColormapToRGBFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,w,r,M,G,R,J){var L;w=L=class extends J{clone(){return new L({raster:this.raster})}};return w=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ColormapToRGBFunctionArguments")],w)})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],
function(p){function w(r){return["u8","s8"].includes(r.pixelType)&&null!=r.statistics?.[0]?.min&&null!=r.statistics[0]?.max&&1===r.bandCount}p.isClassBreaksSupported=function(r,M=!1){const {attributeTable:G,bandCount:R}=r;return 1===R&&(!M||null!=G||null!=r.histograms)};p.isColormapRendererSupported=function(r,M=!1){const {bandCount:G,colormap:R,pixelType:J}=r;return 1===G&&(!!R?.length||!M&&"u8"===J)};p.isColormapSupportedByWebGL=function(r){return!!r?.length&&16384>=r.length};p.isFlowRendererSupported=
function(r){({dataType:r}=r);return"vector-uv"===r||"vector-magdir"===r};p.isShadedReliefRendererSupported=function(r){const {bandCount:M,dataType:G,pixelType:R}=r;return"elevation"===G||"generic"===G&&1===M&&("s16"===R||"s32"===R||"f32"===R||"f64"===R)};p.isSingleBand8BitRasterWithStats=w;p.isUVRendererSupported=function(r,M){const {attributeTable:G,bandCount:R}=r;return null==G&&w(r)?!0:null==G||1<R||M&&null==G.fields.find(J=>J.name.toLowerCase()===M.toLowerCase())?!1:!0};p.isVectorFieldRendererSupported=
function(r){({dataType:r}=r);return"vector-uv"===r||"vector-magdir"===r};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),function(p,w,r,M,
G,R,J,L,B){r=class extends J{constructor(){super(...arguments);this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const {sourceRasterInfos:z}=this;var l=z[0];this.outputPixelType=this._getOutputPixelType(l.pixelType);l=l.clone();l.attributeTable=null;l.colormap=null;l.pixelType=this.outputPixelType;l.bandCount=z.map(({bandCount:h})=>h).reduce((h,d)=>h+d);if(z.every(({statistics:h})=>null!=h&&h.length)){const h=[];z.forEach(({statistics:d})=>
null!=d&&h.push(...d));l.statistics=h}if(z.every(({histograms:h})=>null!=h&&h.length)){const h=[];z.forEach(({histograms:d})=>null!=d&&h.push(...d));l.histograms=h}l.multidimensionalInfo&&l.multidimensionalInfo.variables.forEach(h=>{var d=z.map(n=>n.multidimensionalInfo?.variables.find(({name:A})=>A===h.name));const u=d.map(n=>n?.statistics?.length?n.statistics:null);d=d.map(n=>n?.histograms?.length?n.histograms:null);h.statistics=u.every(n=>null!=n)?u.flat():null;h.histograms=d.every(n=>null!=n)?
d.flat():null});1<l.bandCount&&(l.colormap=null,l.attributeTable=null);const g=z.every(h=>h.keyProperties.BandProperties?.length)?z.flatMap(h=>h.keyProperties.BandProperties):void 0;l.keyProperties={...l.keyProperties,BandProperties:g};this.rasterInfo=l;return{success:!0,supportsGPU:3>=l.bandCount}}_processPixels(z){({pixelBlocks:z}=z);return z&&null!=z?.[0]?B.compositeBands(z):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],
r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],r)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L){var B;M=B=class extends L{constructor(){super(...arguments);this.rasters=[]}writeRasters(z,l){l.rasters=z.map(g=>"number"===typeof g||"string"===typeof g?g:g.toJSON())}clone(){return new B({rasters:w.clone(this.rasters)})}};p.__decorate([r.property({json:{write:!0}})],M.prototype,"rasters",void 0);p.__decorate([J.writer("rasters")],M.prototype,"writeRasters",null);return M=B=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],M)})},
"esri/layers/support/rasterFunctions/ComputeChangeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../Field ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./changeDetectionUtils ./ComputeChangeFunctionArguments".split(" "),function(p,w,r,M,G,R,J,L,B,z,l){r=class extends B{constructor(){super(...arguments);this.functionName=
"ComputeChange";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const {method:g}=this.functionArguments,h=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(h.pixelType);h.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(h);if("categorical"===g){var d=this.sourceRasterInfos.map(n=>n.attributeTable);const u=this._getFieldNames(d,"value");d=d.map(n=>this._getClassFieldName(n));if(null==u[0]||null==u[1]||null==
d[0]||null==d[1])return{success:!1,supportsGPU:!1,error:"both inputs must have proper attribute table with value and class fields"};this._updateAttributeTable(h,u,d)}h.bandCount=1;this.rasterInfo=h;return{success:!0,supportsGPU:"difference"===g||"relative-difference"===g}}_processPixels(g){({pixelBlocks:g}=g);if(null==g?.[0]||null==g?.[1])return null;const {method:h}=this.functionArguments;return z.computeChange(g,h,this.outputPixelType,this._categoryConfig)}_getWebGLParameters(){var g=this.outputPixelType??
"f32";let [h,d]=L.getPixelValueRange(g);if(g=L.isIntegerPixelType(g))h-=1E-4,d+=1E-4;return{method:this.functionArguments.method,domainRange:[h,d],isOutputRounded:g}}_updateAttributeTable(g,h,d){var u=this.sourceRasterInfos.map(y=>y.attributeTable),n=u.map((y,q)=>y.features.map(D=>D.attributes[h[q]])),A=u.map((y,q)=>y.features.map(D=>D.attributes[d[q]])),m=n.map(y=>{const q=[];y.forEach((D,K)=>q[D]=K);return q});const {keepMethod:v}=this.functionArguments;this._categoryConfig={categoryIndexLookups:m,
classNames:A,keepMethod:v};m=u[0].clone();m.fields=[new J({name:"OID",type:"oid"}),new J({name:"Value",type:"integer"}),new J({name:"ClassName",type:"string"}),new J({name:"Class_From",type:"string"}),new J({name:"Class_To",type:"string"})];const a=this._getFieldNames(u,"red"),b=this._getFieldNames(u,"green"),k=this._getFieldNames(u,"blue"),f=[],c=2===a.length&&2===b.length&&2===k.length;c&&(f.push(...u.map((y,q)=>y.features.map(D=>[D.attributes[a[q]],D.attributes[b[q]],D.attributes[k[q]]]))),m.fields.push(new J({name:"Red",
type:"integer"}),new J({name:"Green",type:"integer"}),new J({name:"Blue",type:"integer"})));const e=m.features[0].clone();e.geometry=null;u=[];const [x,t]=n.map(y=>y.length);n=1;for(let y=0;y<x;y++){const q=A[0][y];for(let D=0;D<t;D++){const K=A[1][D];if("changed"===v&&q===K||"unchanged"===v&&q!==K)continue;const H=e.clone();H.attributes={OID:n++,Value:y*t+D,ClassName:q===K?q:`${q} -> ${K}`,Class_From:q,Class_To:K};c&&(H.attributes.Red=f[0][y][0]+f[1][D][0]>>1,H.attributes.Green=f[0][y][1]+f[1][D][1]>>
1,H.attributes.Blue=f[0][y][2]+f[1][D][2]>>1);u.push(H)}}"changed"===v?(A=e.clone(),A.attributes={OID:n++,Value:x*t+1,ClassName:"No Change",Class_From:"Same",Class_To:"Same"},u.push(A)):"unchanged"===v&&(A=e.clone(),A.attributes={OID:n++,Value:x*t+2,ClassName:"Changed",Class_From:"Any",Class_To:"Any"},u.push(A));m.features=u;g.attributeTable=m}_getFieldNames(g,h){return g.map(({fields:d})=>d.find(u=>u.name.toLowerCase()===h)?.name).filter(d=>d)}_getClassFieldName(g){return(g.fields.find(h=>"string"===
h.type&&h.name.toLowerCase().startsWith("class"))??g.fields.find(h=>"string"===h.type&&h.name.toLowerCase().includes("class")||h.name.toLowerCase().includes("type")||h.name.toLowerCase().includes("name"))??g.fields.find(h=>"string"===h.type))?.name}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:l,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],
r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"_categoryConfig",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunction")],r)})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g){var h;const d=new w.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});w=h=class extends r.JSONSupport{constructor(u){super(u);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(u,{description:n}){u=null;try{u=n?JSON.parse(n):null}catch(A){}return u?.value??null}readValueType(u,{description:n}){u=null;try{u=n?JSON.parse(n):null}catch(A){}return u?d.fromJSON(u.fieldValueType):null}clone(){return new h({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};p.__decorate([M.property({type:String,json:{write:!0}})],w.prototype,"alias",void 0);p.__decorate([M.property({type:[String,Number],json:{write:{allowNull:!0}}})],w.prototype,"defaultValue",void 0);p.__decorate([M.property()],w.prototype,"description",void 0);p.__decorate([B.reader("description")],w.prototype,"readDescription",
null);p.__decorate([M.property({types:l.types,json:{read:{reader:l.fromJSON},write:!0}})],w.prototype,"domain",void 0);p.__decorate([M.property({type:Boolean,json:{write:!0}})],w.prototype,"editable",void 0);p.__decorate([M.property({type:G.Integer,json:{write:{overridePolicy(u){return{enabled:Number.isFinite(u)}}}}})],w.prototype,"length",void 0);p.__decorate([M.property({type:String,json:{write:!0}})],w.prototype,"name",void 0);p.__decorate([M.property({type:Boolean,json:{write:!0}})],w.prototype,
"nullable",void 0);p.__decorate([L.enumeration(g.kebabDict)],w.prototype,"type",void 0);p.__decorate([M.property()],w.prototype,"valueType",void 0);p.__decorate([B.reader("valueType",["description"])],w.prototype,"readValueType",null);p.__decorate([M.property({type:Boolean,json:{read:!1}})],w.prototype,"visible",void 0);return w=h=p.__decorate([z.subclass("esri.layers.support.Field")],w)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(p,w,r,M,G,R){w={key:"type",base:M,typeMap:{range:R,"coded-value":r,inherited:G}};p.CodedValueDomain=r;p.DomainBase=M;p.InheritedDomain=G;p.RangeDomain=R;p.fromJSON=function(J){if(!J?.type)return null;switch(J.type){case "range":return R.fromJSON(J);case "codedValue":return r.fromJSON(J);case "inherited":return G.fromJSON(J)}return null};p.types=w;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;M=z=class extends B{constructor(l){super(l);this.codedValues=null;this.type="coded-value"}getName(l){let g=null;if(this.codedValues){const h=String(l);this.codedValues.some(d=>{String(d.code)===h&&(g=d.name);return!!g})}return g}clone(){return new z({codedValues:w.clone(this.codedValues),name:this.name})}};p.__decorate([r.property({type:[L.CodedValue],json:{write:!0}})],M.prototype,"codedValues",void 0);p.__decorate([R.enumeration({codedValue:"coded-value"})],M.prototype,
"type",void 0);return M=z=p.__decorate([J.subclass("esri.layers.support.CodedValueDomain")],M)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(p,w,r,M,G,R,J,L){var B;p.CodedValue=B=class extends r.JSONSupport{constructor(z){super(z);this.code=this.name=null}clone(){return new B({name:this.name,
code:this.code})}};w.__decorate([M.property({type:String,json:{write:!0}})],p.CodedValue.prototype,"name",void 0);w.__decorate([M.property({type:[String,Number],json:{write:!0}})],p.CodedValue.prototype,"code",void 0);p.CodedValue=B=w.__decorate([L.subclass("esri.layers.support.CodedValue")],p.CodedValue);Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,w,r,M,G,R,J,L,B){w=new w.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});r=class extends r.JSONSupport{constructor(z){super(z);this.type=this.name=null}};p.__decorate([M.property({type:String,json:{write:!0}})],r.prototype,"name",void 0);p.__decorate([L.enumeration(w)],r.prototype,"type",void 0);return r=p.__decorate([B.subclass("esri.layers.support.Domain")],r)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(p,w,r,M,G,R,J,L){var B;w=B=class extends L{constructor(z){super(z);this.type="inherited"}clone(){return new B}};p.__decorate([R.enumeration({inherited:"inherited"})],w.prototype,"type",void 0);return w=B=p.__decorate([J.subclass("esri.layers.support.InheritedDomain")],w)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(p,w,r,M,G,R,J,L){var B;r=B=class extends L{constructor(z){super(z);this.minValue=this.maxValue=null;this.type="range"}clone(){return new B({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};p.__decorate([w.property({json:{type:[Number],read:{source:"range",reader(z,l){return l.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(z,l,g){l[g]=[this.minValue||0,z]}}}})],r.prototype,"maxValue",void 0);p.__decorate([w.property({json:{type:[Number],
read:{source:"range",reader(z,l){return l.range?.[0]}},write:{target:"range",writer(z,l,g){l[g]=[z,this.maxValue||0]}}}})],r.prototype,"minValue",void 0);p.__decorate([R.enumeration({range:"range"})],r.prototype,"type",void 0);return r=B=p.__decorate([J.subclass("esri.layers.support.RangeDomain")],r)})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(p,w){w=new w.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",
esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});p.kebabDict=w;Object.defineProperty(p,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/changeDetectionUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(p,w,r,M,G){function R(l){const {bands:[g,h],mask:d,isRelative:u,isRoundingNeeded:n,outBand:A}=l;l=g.length;for(let m=0;m<l;m++)if(!d||d[m]){let v=g[m]-h[m];if(u){const a=Math.max(Math.abs(g[m])-Math.abs(h[m]));v=0<a?v/a:0}A[m]=n?Math.round(v):v}}function J(l){const {bands:[g,h],categoryIndexLookups:[d,
u],classNames:[n,A],mask:m,keepMethod:v,outBand:a}=l;l=g.length;const b=A.length,k=n.length*b,f=k+1,c=k+2;for(let e=0;e<l;e++)if(!m||m[e]){const x=d[g[e]],t=u[h[e]],y=n[x],q=A[t];a[e]=null==x||null==t?k:"changed"===v&&y===q?f:"unchanged"===v&&y!==q?c:x*b+t}}function L(l){const {pixels:[g,h],mask:d,outBand:u}=l;l=g[0].length;const n=g.length;for(let A=0;A<l;A++)if(!d||d[A]){let m=0;for(let v=0;v<n;v++){const a=g[v][A]-h[v][A];m+=a*a}u[A]=Math.sqrt(m)}}function B(l){const {pixels:[g,h],mask:d,outBand:u}=
l;l=g[0].length;const n=g.length;for(let m=0;m<l;m++)if(!d||d[m]){let v=0;var A=0;let a=0;for(let b=0;b<n;b++){const k=g[b][m],f=h[b][m];v+=k*f;A+=k*k;a+=f*f}A=Math.sqrt(A*a);u[m]=A?Math.acos(v/A):1.5707963267948966}}function z(l){const {pixels:[g,h],mask:d,outBand:u}=l;l=g[0].length;const n=g.length;for(let A=0;A<l;A++)if(!d||d[A]){let m=0,v=0;for(let a=0;a<n;a++){const b=Math.abs(g[a][A]-h[a][A]);b>m&&(m=b,v=a)}u[A]=v}}w=new r.JSONMap({0:"difference",1:"relative-difference",2:"categorical",3:"euclidean-distance",
4:"angle-difference",5:"band-with-most-change"},{useNumericKeys:!0});r=new r.JSONMap({0:"all",1:"changed",2:"unchanged"},{useNumericKeys:!0});p.changeMethodMap=w;p.computeChange=function(l,g,h,d){const [u,n]=l,A=G.isIntegerPixelType(h)&&!G.isIntegerPixelType(u.pixelType)&&!G.isIntegerPixelType(n.pixelType);var m=[u.mask,n.mask].filter(f=>f);m=M.combineBandMasks(m);const v=l.map(f=>f.pixels[0]),{width:a,height:b}=u,k=M.createEmptyBand(h,a*b);switch(g){case "difference":case "relative-difference":R({bands:v,
mask:m,outBand:k,isRoundingNeeded:A,isRelative:"relative-difference"===g});break;case "categorical":J({bands:v,mask:m,outBand:k,...d});break;case "euclidean-distance":L({pixels:l.map(f=>f.pixels),mask:m,outBand:k});break;case "angle-difference":B({pixels:l.map(f=>f.pixels),mask:m,outBand:k});break;case "band-with-most-change":z({pixels:l.map(f=>f.pixels),mask:m,outBand:k})}l=new M({width:a,height:b,pixels:[k],pixelType:h,mask:m});l.updateStatistics();return l};p.keepMethodMap=r;Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ComputeChangeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./changeDetectionUtils".split(" "),function(p,w,r,M,G,R,J,L,B){var z;r=z=class extends L{constructor(){super(...arguments);
this.method="difference";this.keepMethod="all";this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new z({raster:this.raster,raster2:this.raster2,method:this.method,keepMethod:this.keepMethod})}};p.__decorate([R.enumeration(B.changeMethodMap)],r.prototype,"method",void 0);p.__decorate([R.enumeration(B.keepMethodMap)],r.prototype,"keepMethod",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"raster2",void 0);p.__decorate([w.property({readOnly:!0})],r.prototype,
"rasters",null);return r=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunctionArguments")],r)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){r=class extends J{constructor(){super(...arguments);this.functionName="ContrastBrightness";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:l}=this;l=l[0];if("u8"!==l.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");l=l.clone();this._removeStatsHistColormapVAT(l);this.rasterInfo=
l;const {contrastOffset:g,brightnessOffset:h}=this.functionArguments;this.lookup=z.createContrastBrightnessLUT(g,h);return{success:!0,supportsGPU:!0}}_processPixels(l){l=l.pixelBlocks?.[0];return null==l?null:B.lookupPixels(l,{lut:l.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:l,brightnessOffset:g}=this.functionArguments;return{contrastOffset:l,brightnessOffset:g}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,
"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"lookup",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],r)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J){var L;r=L=class extends J{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new L({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"contrastOffset",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"brightnessOffset",void 0);return r=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
r)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(p,w,r,M,G){function R(h,d=256){d=Math.min(d,256);const {size:u,counts:n}=h;h=new Uint8Array(u);var A=n.reduce((k,f)=>k+f/d,0);let m=0;var v=0;let a=0,b=A;for(let k=0;k<u;k++)if(a+=n[k],!(k<u-1&&a+n[k+1]<b)){for(;m<d-1&&b<a;)m++,b+=A;for(;v<=k;v++)h[v]=m;v=k+1}for(A=v;A<u;A++)h[A]=d-
1;return h}function J(h,d){h=Math.min(Math.max(h,-100),100);d=Math.min(Math.max(d??0,-100),100);let u=0,n=0;const A=new Uint8Array(256);for(u=0;256>u;u++)0<h&&100>h?n=(200*u-25500+510*d)/(2*(100-h))+128:0>=h&&-100<h?n=(200*u-25500+510*d)*(100+h)/2E4+128:100===h?(n=200*u-25500+256*(100-h)+510*d,n=0<n?255:0):-100===h&&(n=128),A[u]=255<n?255:0>n?0:n;return A}function L(h,d,u,n){n=Infinity;let A=-Infinity;var m=0,v=0,a=0,b=0;const k=h.length;var f=new Map,c=[];for(let e=0;e<k;e++){const x=h[e];if(!d||
d[e]){c.push(x);const t=(f.get(x)??0)+1;f.set(x,t);t>b&&(b=t,a=x);n=x<n?x:n;A=x>A?x:A;m+=x;v++}}if(0===v)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};m/=v;b=0;for(f=0;f<k;f++)if(!d||d[f])b+=(h[f]-m)**2;f=d?d.filter(e=>e).length:k;b=1>=f?0:Math.sqrt(b/(f-1));c.sort((e,x)=>e-x);f=v>>>1;a={min:n,max:A,avg:m,stddev:b,mode:a,median:v%2?c[Math.floor(f)]:(c[f-1]+c[f])/2};if(["u8","s8","u4","u2","u1"].includes(u)){v=A-n+1;u=new Uint32Array(v);for(c=0;c<k;c++)d&&!d[c]||u[h[c]-
n]++;return{statistics:a,histogram:{min:n-.5,max:A+.5,size:v,counts:u}}}u=new Uint32Array(256);c=(A-n)/256;if(0===c)return{statistics:a,histogram:{min:n,max:A,size:1,counts:(new Uint32Array(1)).fill(v)}};v=new Uint32Array(257);for(m=0;m<k;m++)d&&!d[m]||v[Math.floor((h[m]-n)/c)]++;for(h=0;255>h;h++)u[h]=v[h];u[255]=v[255]+v[256];return{statistics:a,histogram:{min:n,max:A,size:256,counts:u}}}function B(h){if(!h?.pixels?.length)return null;const {pixels:d,mask:u,bandMasks:n,pixelType:A}=h,m=h.width*
h.height,v=d.length,a=[],b=[];let k,f;for(let K=0;K<v;K++){var c=new Uint32Array(256);var e=d[K],x=n?.[K]??u;if("u8"===A){k=255;f=0;if(x)for(var t=0;t<m;t++){if(x[t]){var y=e[t];k=y<k?y:k;f=y>f?y:f;c[y]++}}else for(x=0;x<m;x++)t=e[x],k=t<k?t:k,f=t>f?t:f,c[t]++;c=c.slice(k,f+1)}else{y=!1;h.statistics||(h.updateStatistics(),y=!0);var q=h.statistics;k=q[K].minValue;f=q[K].maxValue;t=(f-k)/256;if(0===t)for(!q||h.validPixelCount||y||h.updateStatistics(),e=(h.validPixelCount||h.width*h.height)/256,x=0;256>
x;x++)c[x]=Math.round(e*(x+1))-Math.round(e*x);else{y=new Uint32Array(257);for(q=0;q<m;q++)x&&!x[q]||y[Math.floor((e[q]-k)/t)]++;for(e=0;255>e;e++)c[e]=y[e];c[255]=y[255]+y[256]}}t="u8"===A?k-.5:k;y="u8"===A?f+.5:f;a.push({min:t,max:y,size:c.length,counts:c});x=q=e=0;for(var D=0;D<c.length;D++)e+=c[D],q+=D*c[D];q/=e;for(D=0;D<c.length;D++)x+=c[D]*(D-q)**2;c=(y-t)/c.length;b.push({min:k,max:f,avg:(q+("u8"===A?0:.5))*c+k,stddev:Math.sqrt(x/(e-1))*c})}return{statistics:b,histograms:a}}function z(h,d){if(null==
d||0===d.length)return h;const u=Math.max.apply(null,d),{minCutOff:n,maxCutOff:A,outMin:m,outMax:v,histogramLut:a}=h;return n.length===d.length||n.length<=u?h:{minCutOff:d.map(b=>n[b]),maxCutOff:d.map(b=>A[b]),histogramLut:a?d.map(b=>a[b]):null,outMin:m,outMax:v}}function l(h,d){const u=new Float32Array(h);for(let n=0;n<h;n++)u[n]=1<d[n]?2<d[n]?6.5+(d[n]-2)**2.5:6.5+100*(2-d[n])**4:1;return u}const g=[.299,.587,.114];p.computeGammaCorrection=l;p.computeGammaValues=function(h,d,u){const n=[];for(let b=
0;b<d.length;b++){var A=0,m=0,v=0;"min"in d[b]?{min:A,max:m,avg:v}=d[b]:[A,m,v]=d[b];v=v??0;"u8"!==h&&(v=255*(v-A)/(m-A));u&&(v*=g[b]);A=n;m=A.push;if(0>=v||255<=v)v=1;else{var a=0;150!==v&&(a=150>=v?45*Math.cos(.01047*v):17*Math.sin(.021*v));a=Math.log((v+a)/255);0===a?v=1:(v=Math.log(v/255)/a,v=isNaN(v)?1:Math.min(9.9,Math.max(.01,v)))}m.call(A,v)}return n};p.computeStatisticsHistograms=function(h){const {pixels:d,mask:u,pixelType:n,bandMasks:A}=h;var m=d.map((v,a)=>L(v,A?.[a]??u,n));h=m.map(({statistics:v})=>
v);m=m.map(({histogram:v})=>v);return{statistics:h,histograms:m}};p.createContrastBrightnessLUT=J;p.createHistogramEqualizationLUT=R;p.createStretchLUT=function(h){const {minCutOff:d,maxCutOff:u,gamma:n,pixelType:A,rounding:m}=h,v=h.outMin||0,a=h.outMax||255;if(!["u8","u16","s8","s16"].includes(A))return null;const b=d.length;let k,f,c=0;"s8"===A?c=-127:"s16"===A&&(c=-32767);let e=256;["u16","s16"].includes(A)&&(e=65536);var x=[],t=[];const y=a-v;for(k=0;k<b;k++)t[k]=u[k]-d[k],x[k]=0===t[k]?0:y/t[k];
let q;const D=[];let K,H;if(n&&n.length>=b)for(x=l(b,n),k=0;k<b;k++){H=[];for(f=0;f<e;f++)if(0===t[k])H[f]=v;else{var P=f+c;q=(P-d[k])/t[k];K=1;1<n[k]&&(K-=(1/y)**(q*x[k]));P<u[k]&&P>d[k]?(P=K*y*q**(1/n[k])+v,H[f]="floor"===m?Math.floor(P):"round"===m?Math.round(P):P):H[f]=P>=u[k]?a:v}D[k]=H}else for(k=0;k<b;k++){H=[];for(f=0;f<e;f++)P=f+c,P<=d[k]?H[f]=v:P>=u[k]?H[f]=a:(t=(P-d[k])*x[k]+v,H[f]="floor"===m?Math.floor(t):"round"===m?Math.round(t):t);D[k]=H}if(null!=h.contrastOffset)for(h=J(h.contrastOffset,
h.brightnessOffset),k=0;k<b;k++)for(H=D[k],f=0;f<e;f++)H[f]=h[H[f]];return{lut:D,offset:c}};p.estimateStatisticsFromHistograms=function(h){const d=[];for(let m=0;m<h.length;m++){const {min:v,max:a,size:b,counts:k}=h[m];let f=0;var u=0;for(var n=0;n<b;n++)f+=k[n],u+=n*k[n];u/=f;n=0;for(var A=0;A<b;A++)n+=k[A]*(A-u)**2;A=(a-v)/b;d.push({min:v,max:a,avg:(u+.5)*A+v,stddev:Math.sqrt(n/(f-1))*A})}return d};p.estimateStatisticsHistograms=B;p.getStretchCutoff=function(h,d){const {pixelBlock:u,bandIds:n,returnHistogramLut:A,
rasterInfo:m}=d;var v=null;d=null;var a=h.stretchType;"number"===typeof a&&(a=G.stretchTypeFunctionEnum[a]);h.dra?"minMax"===a&&u?.statistics?v=u.statistics.map(P=>[P.minValue,P.maxValue,0,0]):(d=B(u),v=null!=d?d.statistics:null,d=null!=d?d.histograms:null):(v=h.statistics?.length?h.statistics:m.statistics,d="histograms"in h?h.histograms:void 0,d||(d=m.histograms));"percentClip"!==a&&"histogramEqualization"!==a||d?.length||(a="minMax");var b=v?.length||d?.length||m.bandCount;const k=[],f=[];let c,
e,x;v&&!Array.isArray(v[0])&&(v=v.map(P=>[P.min,P.max,P.avg,P.stddev]));const [t,y]=M.getPixelValueRange(m.pixelType);if(!v?.length){v=[];for(e=0;e<b;e++)v.push([t,y,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(e=0;e<b;e++)k[e]=t,f[e]=y;break;case "minMax":for(e=0;e<b;e++){var q=v[e];k[e]=q[0];f[e]=q[1]}break;case "standardDeviation":({numberOfStandardDeviations:q=2}=h);for(e=0;e<b;e++){var D=v[e];k[e]=D[2]-q*D[3];f[e]=D[2]+q*D[3];k[e]<D[0]&&(k[e]=D[0]);f[e]>D[1]&&(f[e]=D[1])}break;
case "histogramEqualization":w.assertIsSome(d);for(e=0;e<b;e++)k[e]=d[e].min,f[e]=d[e].max;break;case "percentClip":w.assertIsSome(d);for(e=0;e<d.length;e++){v=d[e];D=new Uint32Array(v.size);var K=[...v.counts];20<=K.length&&(K[0]=K[1]=K[2]=K[K.length-1]=K[K.length-2]=0);q=0;b=(v.max-v.min)/v.size;c=-.5===v.min&&1===b?.5:0;for(x=0;x<v.size;x++)q+=K[x],D[x]=q;K=(h.minPercent||0)*q/100;k[e]=v.min+c;for(x=0;x<v.size;x++)if(D[x]>K){k[e]=v.min+b*(x+c);break}K=(1-(h.maxPercent||0)/100)*q;f[e]=v.max+c;for(x=
v.size-2;0<=x;x--)if(D[x]<K){f[e]=v.min+b*(x+2-c);break}f[e]<k[e]&&(v=k[e],k[e]=f[e],f[e]=v)}break;default:for(e=0;e<b;e++)q=v[e],k[e]=q[0],f[e]=q[1]}let H;"histogramEqualization"===a?(w.assertIsSome(d),a=d[0].size||256,h=0,A&&(H=d.map(P=>R(P)))):(a=h.max||255,h=h.min||0);return z({minCutOff:k,maxCutOff:f,outMax:a,outMin:h,histogramLut:H},n)};p.stretch=function(h,d){if(!h?.pixels?.length)return h;const {mask:u,bandMasks:n,width:A,height:m,pixels:v}=h,{minCutOff:a,maxCutOff:b,gamma:k}=d;var f=d.outMin||
0;const c=d.outMax||255,e=A*m,x=d.outputPixelType||"u8";h=h.pixels.map(()=>r.createEmptyBand(x,e));const t=h.length;var y=c-f,q=[],D=[];for(var K=0;K<t;K++)D[K]=b[K]-a[K],q[K]=0===D[K]?0:y/D[K];K=x.startsWith("u")||x.startsWith("s");d=!!d.isRenderer;if(k&&k.length>=t){q=l(t,k);for(var H=0;H<t;H++){var P=n?.[H]??u;for(let S=0;S<e;S++)if(null==P||P[S]){if(0===D[H]){h[H][S]=f;continue}var I=v[H][S];const E=(I-a[H])/D[H];let F=1;1<k[H]&&(F-=(1/y)**(E*q[H]));I<b[H]&&I>a[H]?(I=F*y*E**(1/k[H])+f,h[H][S]=
d?Math.floor(I):K?Math.round(I):I):h[H][S]=I>=b[H]?c:f}}}else for(y=0;y<t;y++)for(D=n?.[y]??u,H=0;H<e;H++)if(null==D||D[H])P=v[y][H],P<b[y]&&P>a[y]?(P=(P-a[y])*q[y]+f,h[y][H]=d?Math.floor(P):K?Math.round(P):P):h[y][H]=P>=b[y]?c:f;f=new r({width:A,height:m,mask:u,bandMasks:n,pixels:h,pixelType:x});f.updateStatistics();return f};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(p,
w){w=new w.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});p.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};p.stretchTypeJSONDict=w;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l){r=class extends B{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}get _normalizedKernel(){const {kernel:g,convolutionType:h}=this.functionArguments,d=g.reduce((u,n)=>u+n);return-1===h||0===d||1===d?g:g.map(u=>u/d)}_bindSourceRasters(){const {convolutionType:g,rows:h,cols:d,kernel:u}=this.functionArguments;if(!Object.values(J.convolutionKernel).includes(g))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${g}`};
if(g!==J.convolutionKernel.none&&h*d!==u.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var n=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(n.pixelType);n=n.clone();n.pixelType=this.outputPixelType;const A=[J.convolutionKernel.none,J.convolutionKernel.sharpen,J.convolutionKernel.sharpen2,J.convolutionKernel.sharpening3x3,J.convolutionKernel.sharpening5x5];if(-1===g||"u8"!==this.outputPixelType&&
!A.includes(g))n.statistics=null,n.histograms=null;n.colormap=null;n.attributeTable=null;this.rasterInfo=n;return{success:!0,supportsGPU:25>=u.length}}_processPixels(g){g=g.pixelBlocks?.[0];if(null==g||this.functionArguments.convolutionType===J.convolutionKernel.none)return g;const {rows:h,cols:d}=this.functionArguments,{_normalizedKernel:u}=this;return l.convolute(g,{kernel:u,rows:h,cols:d,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const g=new Float32Array(25);g.set(this._normalizedKernel);
return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:g,clampRange:L.getPixelValueRange(this.outputPixelType)}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:z,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property()],r.prototype,"_normalizedKernel",
null);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],r)})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(p,w,r,M,G,R,J,L,B){var z;M=z=class extends L{constructor(){super(...arguments);
this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(l){this._set("convolutionType",l);const g=B.convolutionKernels.get(l);g&&l!==J.convolutionKernel.userDefined&&l!==J.convolutionKernel.none&&(l=Math.sqrt(g.length),this._set("kernel",g),this._set("cols",l),this._set("rows",l))}clone(){return new z({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:w.clone(this.raster)})}};p.__decorate([r.property({json:{type:Number,write:!0}})],
M.prototype,"rows",void 0);p.__decorate([r.property({json:{type:Number,write:!0}})],M.prototype,"cols",void 0);p.__decorate([r.property({json:{name:"type",type:Number,write:!0}})],M.prototype,"convolutionType",null);p.__decorate([r.property({json:{type:[Number],write:!0}})],M.prototype,"kernel",void 0);return M=z=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],M)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock",
"../rasterFunctionConstants","./mirror"],function(p,w,r,M){function G(z){const l=Math.sqrt(z.length),g=z.slice(0,l),h=[1];for(let d=1;d<l;d++){let u=null;for(let n=0;n<l;n++){const A=z[n+d*l],m=z[n];if(null==u)if(0===m){if(A)return{separable:!1,row:null,col:null}}else u=A/m;else if(A/m!==u)return{separable:!1,row:null,col:null}}if(null==u)return{separable:!1,row:null,col:null};h.push(u)}return{separable:!0,row:g,col:h}}function R(z,l,g,h,d,u,n){const A=new Float32Array(l*g),m=u.length,v=n?0:h,a=n?
h:0;n=n?1:l;for(let b=v;b<g-v;b++){const k=b*l;for(let f=a;f<l-a;f++){if(d&&!d[k+f])continue;let c=0;for(let e=0;e<m;e++)c+=z[k+f+(e-h)*n]*u[e];A[k+f]=c}}return A}function J(z,l,g=!0){const {pixels:h,width:d,height:u,pixelType:n,mask:A}=z;z=h.length;const m=[],{kernel:v,rows:a,cols:b}=l;for(l=0;l<z;l++){var k=h[l],f=d,c=u,e=a,x=b,t=A,y=v;const q=new Float32Array(f*c),D=Math.floor(e/2),K=Math.floor(x/2);for(let H=D;H<c-D;H++){const P=H*f;for(let I=K;I<f-K;I++){if(t&&!t[P+I])continue;let S=0;for(let E=
0;E<e;E++)for(let F=0;F<x;F++)S+=k[P+I+(E-D)*f+F-K]*y[E*x+F];q[P+I]=S}}k=q;g&&M.mirror(k,d,u,a,b);m.push(k)}return new w({width:d,height:u,pixelType:n,pixels:m,mask:A})}function L(z,l,g,h=!0){const {pixels:d,width:u,height:n,pixelType:A,mask:m}=z;z=d.length;const v=[],a=l.length,b=g.length,k=Math.floor(a/2),f=Math.floor(b/2);for(let c=0;c<z;c++){let e=R(d[c],u,n,k,m,l,!0);e=R(e,u,n,f,m,g,!1);h&&M.mirror(e,u,n,a,b);v.push(e)}return new w({width:u,height:n,pixelType:A,pixels:v,mask:m})}const B=new Map;
B.set(r.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);B.set(r.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);B.set(r.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);B.set(r.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);B.set(r.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);B.set(r.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);B.set(r.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);B.set(r.convolutionKernel.gradientEast,
[1,0,-1,2,0,-2,1,0,-1]);B.set(r.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);B.set(r.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);B.set(r.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);B.set(r.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);B.set(r.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);B.set(r.convolutionKernel.smoothing5x5,
[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);B.set(r.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);B.set(r.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);B.set(r.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);B.set(r.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);B.set(r.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);B.set(r.convolutionKernel.sobelVertical,
[-1,0,1,-2,0,2,-1,0,1]);B.set(r.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);B.set(r.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);B.set(r.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);p.convolute=function(z,l){const g=G(l.kernel),h=!1!==l.mirrorEdges;z=g.separable?L(z,g.row,g.col,h):J(z,l,h);({outputPixelType:l}=l);l&&z.clamp(l);return z};p.convoluteSeparable=L;p.convolutionKernels=B;p.separateKernels=G;Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(p){p.mirror=function(w,r,M,G,R){G=Math.floor(G/2);for(var J=0;J<G;J++)for(var L=0;L<r;L++)w[J*r+L]=w[(R-1-J)*r+L],w[(M-1-J)*r+L]=w[(M-R+J)*r+L];G=Math.floor(R/2);for(J=0;J<M;J++){L=J*r;for(let B=0;B<G;B++)w[L+B]=w[L+R-1-B],w[L+r-B-1]=w[L+r+B-R]}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),
function(p,w,r,M,G,R,J,L,B){r=class extends J{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const z=this.sourceRasterInfos[0].clone();z.pixelType=this.outputPixelType;z.bandCount=1;this._removeStatsHistColormapVAT(z);this.rasterInfo=z;this.isGCS=z.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(z){const l=
z.pixelBlocks?.[0];if(null==l)return null;const {zFactor:g,curvatureType:h}=this.functionArguments,{extent:d,primaryPixelSizes:u}=z;z=u?.[0];return B.curvature(l,{zFactor:this.isGCS&&1<=g?g*B.gcsFactor:g,curvatureType:h,resolution:null==z?d?{x:d.width/l.width,y:d.height/l.height}:{x:1,y:1}:z})}_getWebGLParameters(){const {zFactor:z,curvatureType:l}=this.functionArguments;return{curvatureType:l,zFactor:this.isGCS&&1<=z?z*B.gcsFactor:z}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],
r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isGCS",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],r)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B,z){var l;const g=new w.JSONMap({0:"standard",1:"planform",2:"profile"},{useNumericKeys:!0});w=l=class extends z{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(h,d){return g.fromJSON(d.type??d.curvatureType??0)}clone(){return new l({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};p.__decorate([r.property({json:{write:{target:"type"}}}),J.enumeration(g)],w.prototype,"curvatureType",void 0);p.__decorate([L.reader("curvatureType",
["type","curvatureType"])],w.prototype,"readCurvatureType",null);p.__decorate([r.property({type:Number,json:{write:!0}})],w.prototype,"zFactor",void 0);return w=l=p.__decorate([B.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){function l(d,u){d=d.bandInfos.map(({name:A})=>A.toLowerCase());const n=[];for(let A=0;A<u.length;A++){const m=u[A].toLowerCase();let v=d.indexOf(m);-1===v&&"nearinfrared"===m&&(v=d.findIndex(a=>a.startsWith("nearinfrared_1")),-1===v&&(v=d.findIndex(a=>a.startsWith("nearinfrared"))));if(-1===v)return null;n.push(v)}return n}function g(d,u,n){const {bandCount:A}=d;return!u?.length||n&&u.some(m=>0>m||m>=A)?null:u}function h(d,u,{wavelengthMatchTolerance:n},A){var {bandInfos:m}=
d;d=[];for(var v=0;v<m.length;v++){const {minWavelength:a,maxWavelength:b}=m[v];if(!a||!b)return null;d.push({minWavelength:a,maxWavelength:b})}m=[];for(v=0;v<u.length;v++){const a=u[v];let b=!1,k=-1,f=Number.MAX_VALUE;for(let c=0;c<d.length;c++){const e=d[c],x=Math.abs(a-(e.minWavelength+e.maxWavelength)/2);a>=e.minWavelength&&a<=e.maxWavelength?x<f&&(b=!0,k=c,f=x):!b&&x<f&&(k=c,f=x)}!b&&n&&f<n&&(b=!0);if(!b&&A)return null;m.push(k)}return m}r=class extends L{constructor(){super(...arguments);this.functionName=
"ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:d,sourceRasterInfos:u}=this;var n=u[0];const {method:A,bandNames:m,bandWavelengths:v,bandIds:a,missingBandAction:b}=d,k=m?.length&&("name"===A||"id"!==A&&!a?.length),f=v?.length&&("wavelength"===A||"id"!==A&&!a?.length),c=b===z.MissingBandAction.fail,e=k?l(n,m):f?h(n,v,this.functionArguments,c):g(n,a,c);if(null==e)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${k?
"band names":f?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=e;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");n=n.clone();n.pixelType=this.outputPixelType;n.bandCount=e.length;const {statistics:x,histograms:t}=n;null!=x&&x.length&&(n.statistics=e.map(q=>x[q]||x[x.length-1]));null!=t&&t.length&&(n.histograms=e.map(q=>t[q]||t[t.length-1]));n.multidimensionalInfo&&n.multidimensionalInfo.variables.forEach(q=>{const {statistics:D,
histograms:K}=q;null!=D&&D.length&&(q.statistics=e.map(H=>D[H]||D[D.length-1]));null!=K&&K.length&&(q.histograms=e.map(H=>K[H]||K[K.length-1]))});let y=n.keyProperties?.BandProperties;y?.length&&(y=e.map(q=>q>=y.length?y[y.length-1]:y[q]),n.keyProperties={...n.keyProperties,BandProperties:y});this.rasterInfo=n;return{success:!0,supportsGPU:3>=n.bandCount}}_processPixels(d){d=d.pixelBlocks?.[0];if(null==d)return null;const u=d.pixels.length,n=this.functionArguments.bandIds.map(A=>A>=u?u-1:A);return d.extractBands(n)}_getWebGLParameters(){let d;
if(this.isInputBandIdsSwizzled)d=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{d=[...this.functionArguments.bandIds];0===d.length?d=[0,1,2]:3>d.length&&(d[1]=d[1]??d[0],d[2]=d[2]??d[1]);for(let u=0;3>u;u++)d[u]=Math.min(d[u],2)}return{bandIndexMat3:J.getBandMatrix3(d)}}_getInputBandIds(d){const u=d.length;return this.functionArguments.bandIds.map(n=>n>=u?u-1:n).map(n=>d[n])}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",
void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],r)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;r=z=class extends L{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=B.MissingBandAction.bestMatch}clone(){return new z({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,
"bandIds",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"bandNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"bandWavelengths",void 0);p.__decorate([R.enumeration({0:"name",1:"wavelength",2:"id"})],r.prototype,"method",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"missingBandAction",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"wavelengthMatchTolerance",void 0);return r=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
r)})},"esri/layers/support/rasterFunctions/GrayscaleFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./conversionUtils ./GrayscaleFunctionArguments".split(" "),function(p,w,r,M,G,R,J,L,B){r=class extends J{constructor(){super(...arguments);this.functionName="Grayscale";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}get _normalizedWeights(){const {conversionParameters:z}=this.functionArguments,l=z.reduce((g,h)=>g+h);return z.map(g=>g/l)}_bindSourceRasters(){var {conversionParameters:z}=this.functionArguments;if(!z?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const l=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(l.pixelType);l.pixelType=this.outputPixelType;z=3===z.length||3===l.bandCount&&3<z.length;l.bandCount=1;this._removeStatsHistColormapVAT(l);
this.rasterInfo=l;return{success:!0,supportsGPU:z}}_processPixels(z){z=z.pixelBlocks?.[0];return null==z?null:L.grayscale(z,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",
void 0);p.__decorate([w.property()],r.prototype,"_normalizedWeights",null);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.GrayscaleFunction")],r)})},"esri/layers/support/rasterFunctions/conversionUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(p,w,r){p.grayscale=function(M,G,R){const {pixels:J,width:L,height:B,mask:z,bandMasks:l}=M;var g=L*B;const h=l?.length?w.combineBandMasks(l):z,d=Math.min(G.length,J.length),u=R.startsWith("f");
M=!u&&R!==M.pixelType;const [n,A]=r.getPixelValueRange(R);g=w.createEmptyBand(R,g);for(let m=0;m<B;m++){let v=m*L;for(let a=0;a<L;a++,v++)if(!h||h[v]){let b=0;for(let k=0;k<d;k++)b+=G[k]*J[k][v];u||(b=Math.round(b),M&&(b=b>A?A:b<n?n:b));g[v]=b}}G=new w({width:L,height:B,pixels:[g],pixelType:R,mask:h});G.updateStatistics();return G};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/GrayscaleFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J){var L;r=L=class extends J{clone(){return new L({conversionParameters:[...this.conversionParameters],raster:this.raster})}};p.__decorate([w.property({type:[Number],json:{write:!0}})],r.prototype,"conversionParameters",void 0);return r=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],r)})},"esri/layers/support/rasterFunctions/HillshadeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./HillshadeFunctionArguments ./surfaceUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){r=class extends L{constructor(){super(...arguments);this.functionName="Hillshade";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var l=this.sourceRasterInfos[0];if(1<l.bandCount)return{success:!1,supportsGPU:!1,error:"hillshade-function: source data must be single band"};this.outputPixelType=this._getOutputPixelType("u8");l=l.clone();this._removeStatsHistColormapVAT(l);l.pixelType=this.outputPixelType;l.bandCount=1;
l.statistics=[{min:0,max:255,avg:60,stddev:10}];this.rasterInfo=l;this.isGCS=l.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(l){var g=l.pixelBlocks?.[0];if(!g)return null;const {extent:h,primaryPixelSizes:d}=l;l=d?.[0];l=z.getHillshadeOptions(this.functionArguments,null==l?h?{x:h.width/g.width,y:h.height/g.height}:{x:1,y:1}:l,this.isGCS);g=z.hillshade(g,l);g.pixelType=this.outputPixelType;return g}_getWebGLParameters(){var l=z.getHillshadeOptions(this.functionArguments,
{x:1,y:1},this.isGCS);l=z.calculateHillshadeParams(l);const {slopeType:g,zFactor:h,pixelSizeFactor:d,pixelSizePower:u}=this.functionArguments,n="scaled"===g,A=J.isIntegerPixelType(this.outputPixelType);return{...l,zFactor:h,gcsFactor:this.isGCS?z.gcsFactor:1,pixelSizeFactor:n?d:0,pixelSizePower:n?u:0,isOutputRounded:A}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],
r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isGCS",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.HillshadeFunction")],r)})},"esri/layers/support/rasterFunctions/HillshadeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;M=new w.JSONMap({0:"traditional",1:"multi-directional"},{useNumericKeys:!0});w=new w.JSONMap({1:"degree",2:"percent-rise",3:"scaled"},{useNumericKeys:!0});B=z=class extends B{constructor(){super(...arguments);this.altitude=45;this.azimuth=315;this.hillshadeType="traditional";this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.slopeType="degree";this.zFactor=1;this.removeEdgeEffect=!1}clone(){return new z({hillshadeType:this.hillshadeType,altitude:this.altitude,
azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};p.__decorate([r.property({type:Number,json:{write:!0}})],B.prototype,"altitude",void 0);p.__decorate([r.property({type:Number,json:{write:!0}})],B.prototype,"azimuth",void 0);p.__decorate([r.property(),J.enumeration(M)],B.prototype,"hillshadeType",void 0);p.__decorate([r.property({type:Number,json:{write:!0,
name:"psPower"}})],B.prototype,"pixelSizePower",void 0);p.__decorate([r.property({type:Number,json:{write:!0,name:"psZFactor"}})],B.prototype,"pixelSizeFactor",void 0);p.__decorate([r.property(),J.enumeration(w)],B.prototype,"slopeType",void 0);p.__decorate([r.property({type:Number,json:{write:!0}})],B.prototype,"zFactor",void 0);p.__decorate([r.property({type:Boolean,json:{write:!0}})],B.prototype,"removeEdgeEffect",void 0);return B=z=p.__decorate([L.subclass("esri.layers.support.rasterFunctions.HillshadeFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(p,w,r,M,G,R,J,L,B,z,l){r=class extends B{constructor(){super(...arguments);this.functionName="Local";
this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:g}=this,h=g[0];const {bandCount:d}=h,{processAsMultiband:u}=this.functionArguments;if(g.some(m=>m.bandCount!==d))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:n,rasters:A}=this.functionArguments;g=l.operandsCount[n];if(!(999===g||A.length===g||1>=A.length&&1===g))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${g}`};
h=h.clone();h.bandCount=999!==g||u?d:1;this._removeStatsHistColormapVAT(h);this._updateStatistics(h);this._updatePixelType(h);this.rasterInfo=h;return{success:!0,supportsGPU:1===h.bandCount&&3>=g}}_processPixels(g){({pixelBlocks:g}=g);return null==g||g.some(h=>null==h)?null:l.local(g,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:g}=this.functionArguments,h=l.operandsCount[g],
d=Object.keys(J.localOperators).find(m=>J.localOperators[m]===g)?.toLowerCase()??"undefined";var u=this.outputPixelType??"f32";let [n,A]=L.getPixelValueRange(u);if(u=L.isIntegerPixelType(u))n-=1E-4,A+=1E-4;return{imageCount:h,operationName:d,domainRange:[n,A],isOutputRounded:u}}_updateStatistics(g){var h=this.sourceRasterInfos[0];const {operation:d}=this.functionArguments,u=l.getOutputDomain(d)?.domain;if(u)for(g.statistics=[],h=0;h<g.bandCount;h++)g.statistics[h]={min:u[0],max:u[1],avg:(u[0]+u[1])/
2,stddev:(u[0]+u[1])/10};else 45===d&&h.statistics?.length&&(g.statistics=h.statistics.map(n=>({min:-n.max,max:-n.min,avg:null!=n.avg?-n.avg:void 0,stddev:null!=n.stddev?-n.stddev:void 0})))}_updatePixelType(g){const {statistics:h,pixelType:d}=this.sourceRasterInfos[0];var {operation:u}=this.functionArguments;const {domain:n,isInteger:A}=l.getOutputDomain(u)??{domain:null,isInteger:!1};var m="f32";n&&A?m=L.getIntegerPixelType(n[0],n[1]):30===u?m=(u=h?.[0])?L.getIntegerPixelType(u.min,u.max):L.isIntegerPixelType(d)?
d:"s32":45===u&&L.isIntegerPixelType(d)&&(m=h?.map(({max:v})=>-v),u=h?.map(({min:v})=>-v),m=m?.length?Math.min(...m):null,u=u?.length?Math.min(...u):null,m=null!=m&&null!=u?L.getIntegerPixelType(m,u):d.startsWith("s")?d.replace("s","u"):"u1"===d||"u2"===d||"u4"===d?"s8":"u8"===d?"s16":"s32");g.pixelType=this.outputPixelType=this._getOutputPixelType(m)}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:z,json:{write:!0,
name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.LocalFunction")],r)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L){var B;M=B=class extends L{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(z,l){l.rasters=z.map(g=>"number"===typeof g||"string"===typeof g?g:g.toJSON())}clone(){return new B({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:w.clone(this.rasters)})}};p.__decorate([r.property({json:{write:!0}})],M.prototype,"operation",void 0);p.__decorate([r.property({json:{write:!0}})],M.prototype,"rasters",void 0);p.__decorate([J.writer("rasters")],
M.prototype,"writeRasters",null);p.__decorate([r.property({json:{write:!0}})],M.prototype,"processAsMultiband",void 0);return M=B=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],M)})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){M=class extends L{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var l=this.sourceRasterInfos[0].clone();const {pixelType:g}=l;this.outputPixelType=this._getOutputPixelType(g);l.pixelType=this.outputPixelType;this.rasterInfo=l;const {includedRanges:h,normalizedNoDataValues:d}=this.functionArguments;if(!h?.length&&!d?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};
let u=[];for(let n=0;n<l.bandCount;n++){const A=z.createMaskLUT(g,h?.slice(2*n,2*n+2),d?.[n]);if(null==A){u=null;break}u.push(A)}this.lookups=u;l=null!=d&&d.every(n=>n?.length===d[0]?.length);return{success:!0,supportsGPU:(!h||h.length<=2*z.maxMapSizeGpu)&&(!d||l&&d[0].length<=z.maxMapSizeGpu)}}_processPixels(l){l=l.pixelBlocks?.[0];if(null==l)return null;const {outputPixelType:g,lookups:h}=this,{includedRanges:d,noDataInterpretation:u,normalizedNoDataValues:n}=this.functionArguments;return z.mask(l,
{includedRanges:d,noDataValues:n,outputPixelType:g,matchAll:u===z.NoDataInterpretation.matchAll,lookups:h})}_getWebGLParameters(){const {includedRanges:l,normalizedNoDataValues:g}=this.functionArguments,h=new Float32Array(z.maxMapSizeGpu);h.fill(w.numberMaxFloat32);g?.[0]?.length&&h.set(g[0]);const d=new Float32Array(z.maxMapSizeGpu);for(let u=0;u<d.length;u+=2)d[u]=l?.[u]??-w.numberMaxFloat32,d[u+1]=l?.[u+1]??w.numberMaxFloat32;l?.length&&d.set(l);return{bandCount:this.sourceRasterInfos[0].bandCount,
noDataValues:h,includedRanges:d}}};p.__decorate([r.property({json:{write:!0,name:"rasterFunction"}})],M.prototype,"functionName",void 0);p.__decorate([r.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],M.prototype,"functionArguments",void 0);p.__decorate([r.property()],M.prototype,"rasterArgumentNames",void 0);p.__decorate([r.property({json:{write:!0}})],M.prototype,"lookups",void 0);return M=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.MaskFunction")],M)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(p,w,r,M,G,R,J,L){var B;r=B=class extends J{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=L.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:z}=this;if(!z?.length)return null;let l=!1;z=z.map(g=>"number"===typeof g?(l=!0,[g]):"string"===typeof g?(g=g.trim().split(" ").filter(h=>""!==h.trim()).map(h=>Number(h)),l=l||0<g.length,0===g.length?null:g):null);return l?z:null}clone(){return new B({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"includedRanges",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"noDataValues",void 0);p.__decorate([w.property()],r.prototype,"normalizedNoDataValues",null);p.__decorate([w.property({json:{write:!0}})],r.prototype,"noDataInterpretation",void 0);return r=B=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
r)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(p,w,r,M,G,R,J,L,B){r=class extends L{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {scientificOutput:z,
visibleBandID:l,infraredBandID:g}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(z?"f32":"u8");var h=this.sourceRasterInfos[0];const d=Math.max(l,g);if(2>h.bandCount||d>=h.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};h=h.clone();h.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(h);h.bandCount=1;h.keyProperties={...h.keyProperties,BandProperties:void 0};const [u,n,A,m]=z?[-1,1,0,.1]:[0,
200,100,10];h.statistics=[{min:u,max:n,avg:A,stddev:m}];this.rasterInfo=h;return{success:!0,supportsGPU:!0}}_processPixels(z){z=z.pixelBlocks?.[0];if(null==z)return null;const {visibleBandID:l,infraredBandID:g,scientificOutput:h}=this.functionArguments;return J.calculateNDVI(z,l,g,!h)}_getWebGLParameters(){const {visibleBandID:z,infraredBandID:l,scientificOutput:g}=this.functionArguments;return{bandIndexMat3:J.getBandMatrix3(this.isInputBandIdsSwizzled?[0,1,2]:[l,z,0]),scaled:!g}}_getInputBandIds(z){const {visibleBandID:l,
infraredBandID:g}=this.functionArguments;return[g,l,0].map(h=>z[h])}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],r)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J){var L;r=L=class extends J{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:B,infraredBandID:z,scientificOutput:l}=this;return new L({visibleBandID:B,infraredBandID:z,scientificOutput:l})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"visibleBandID",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"infraredBandID",void 0);p.__decorate([w.property({json:{write:!0}})],
r.prototype,"scientificOutput",void 0);return r=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],r)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l){M=class extends B{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const g=this.sourceRasterInfos[0].clone(),{pixelType:h}=g;this.outputPixelType=this._getOutputPixelType(h);g.pixelType=this.outputPixelType;g.bandCount=1;const {statistics:d}=g;this._removeStatsHistColormapVAT(g);const {allowUnmatched:u,outputValues:n,inputRanges:A,noDataRanges:m,isLastInputRangeInclusive:v}=
this.functionArguments;if(null!=d&&d.length&&n?.length)if(u){var a=Math.min.apply(null,[...n,d[0].min]),b=Math.max.apply(null,[...n,d[0].max]);g.statistics=[{...d[0],min:a,max:b}]}else{b=a=n[0];for(let k=0;k<n.length;k++)a=a>n[k]?n[k]:a,b=b>n[k]?b:n[k];g.statistics=[{...d[0],min:a,max:b}]}this.rasterInfo=g;this.lookup=u?null:z.createRemapLUT({srcPixelType:h,inputRanges:A,outputValues:n,noDataRanges:m,allowUnmatched:u,isLastInputRangeInclusive:v,outputPixelType:this.outputPixelType});return{success:!0,
supportsGPU:(!n||n.length<=z.maxMapSizeGpu)&&(!m||m.length<=z.maxMapSizeGpu)}}_processPixels(g){g=g.pixelBlocks?.[0];if(null==g)return null;const {lookup:h,outputPixelType:d}=this;if(h){const a=z.lookupPixels(g,{lut:[h.lut],offset:h.offset,outputPixelType:d});null!=a&&h.mask&&(a.mask=z.lookupBandValues(g.pixels[0],g.mask,h.mask,h.offset,"u8"));return a}const {inputRanges:u,outputValues:n,noDataRanges:A,allowUnmatched:m,isLastInputRangeInclusive:v}=this.functionArguments;return z.remap(g,{inputRanges:u,
outputValues:n,noDataRanges:A,outputPixelType:d,allowUnmatched:m,isLastInputRangeInclusive:v})}_getWebGLParameters(){const {allowUnmatched:g,noDataRanges:h,isLastInputRangeInclusive:d}=this.functionArguments,u=new Float32Array(3*z.maxMapSizeGpu);var n=this.functionArguments.inputRanges??[],A=this.functionArguments.outputValues??[];const m=A.length;for(let v=0;v<z.maxMapSizeGpu;v++)if(u[3*v]=n[2*v]??w.numberMaxFloat32-1,u[3*v+1]=n[2*v+1]??w.numberMaxFloat32,u[3*v+2]=A[v]??0,v<m&&(0<v&&(u[3*v]-=1E-5),
v<m-1||!d))u[3*v+1]-=1E-5;n=new Float32Array(2*z.maxMapSizeGpu);n.fill(w.numberMaxFloat32);h?.length&&n.set(h);A=L.getPixelValueRange(this.outputPixelType);return{allowUnmatched:g,rangeMaps:u,noDataRanges:n,clampRange:A}}};p.__decorate([r.property({json:{write:!0,name:"rasterFunction"}})],M.prototype,"functionName",void 0);p.__decorate([r.property({type:l,json:{write:!0,name:"rasterFunctionArguments"}})],M.prototype,"functionArguments",void 0);p.__decorate([r.property()],M.prototype,"rasterArgumentNames",
void 0);p.__decorate([r.property({json:{write:!0}})],M.prototype,"lookup",void 0);return M=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.RemapFunction")],M)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,w,r,M,G,R,
J){var L;r=L=class extends J{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new L({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"inputRanges",void 0);p.__decorate([w.property({json:{write:!0}})],
r.prototype,"outputValues",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"noDataRanges",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"allowUnmatched",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isLastInputRangeInclusive",void 0);return r=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],r)})},"esri/layers/support/rasterFunctions/ShadedReliefFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./ShadedReliefFunctionArguments ./surfaceUtils ../../../renderers/support/colorRampUtils ../../../renderers/support/rasterRendererChecks".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g,h){r=class extends L{constructor(){super(...arguments);this.functionName="ShadedRelief";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var d=this.sourceRasterInfos[0];if(1<d.bandCount)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: source data must be single band"};let {colorRamp:u,colormap:n}=this.functionArguments;if(!u&&!n?.length)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: a color ramp argument must be specified"};
this.outputPixelType=this._getOutputPixelType("u8");d=d.clone();this._removeStatsHistColormapVAT(d);d.pixelType=this.outputPixelType;d.bandCount=3;d.statistics=[{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10}];this.rasterInfo=d;this.isGCS=d.spatialReference?.isGeographic??!1;n?.length||(n=g.convertColorRampToColormap(u,{interpolateAlpha:!0}));const {indexedColormap:A,offset:m}=B.createColormapLUT({colormap:n});if(!A?.length)return{success:!1,supportsGPU:!1,
error:"shadedrelief-function: a valid colorramp is required"};d=g.createHsvMap(A);this.lookup={indexedColormap:A,offset:m,hsvMap:d};return{success:!0,supportsGPU:h.isColormapSupportedByWebGL(A)}}_processPixels(d){const u=d.pixelBlocks?.[0];if(!u||!this.lookup)return null;let n=d.primaryPixelSizes?.[0];null==n&&({extent:d}=d,n=d?{x:d.width/u.width,y:d.height/u.height}:{x:1,y:1});d=l.getHillshadeOptions(this.functionArguments,n,this.isGCS);d=l.hillshade(u,d);l.tintHillshade(d,u,this.lookup.hsvMap,this.sourceRasterInfos[0].statistics?.[0]??
{min:0,max:8E3});d.pixelType=this.outputPixelType;return d}_getWebGLParameters(){var d=l.getHillshadeOptions(this.functionArguments,{x:1,y:1},this.isGCS);d=l.calculateHillshadeParams(d);const {slopeType:u,zFactor:n,pixelSizeFactor:A,pixelSizePower:m}=this.functionArguments,v="scaled"===u,{indexedColormap:a,offset:b}=this.lookup,k=this.sourceRasterInfos[0].statistics?.[0],f=J.isIntegerPixelType(this.outputPixelType);return{...d,indexedColormap:a,offset:b,zFactor:n,gcsFactor:this.isGCS?l.gcsFactor:
1,pixelSizeFactor:v?A:0,pixelSizePower:v?m:0,minValue:k?.min??0,maxValue:k?.max??8E3,isOutputRounded:f}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:z,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isGCS",void 0);p.__decorate([w.property({json:{write:!0}})],
r.prototype,"lookup",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.ShadedReliefFunction")],r)})},"esri/layers/support/rasterFunctions/ShadedReliefFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./HillshadeFunctionArguments ../../../renderers/support/colorRampUtils".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;r=z=class extends L{readColorRamp(l){if("string"===typeof l){const g=B.colorRampDict.jsonValues.find(h=>h.toLowerCase()===l.toLowerCase());return g?B.getColorRampJSON(B.colorRampDict.fromJSON(g)):null}return"toJSON"in l?l.toJSON():l}clone(){return new z({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,
colorRamp:this.colorRamp,colormap:this.colormap,raster:this.raster})}};p.__decorate([w.property({json:{write:!0}})],r.prototype,"colorRamp",void 0);p.__decorate([R.reader("colorRamp")],r.prototype,"readColorRamp",null);p.__decorate([w.property({type:[[Number]],json:{write:!0}})],r.prototype,"colormap",void 0);return r=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.ShadedReliefFunctionArguments")],r)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z){r=class extends L{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const l=this.sourceRasterInfos[0].clone();l.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(l);l.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;l.bandCount=1;this.rasterInfo=
l;this.isGCS=l.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(l){const g=l.pixelBlocks?.[0];if(null==g)return null;const {zFactor:h,slopeType:d,pixelSizePower:u,pixelSizeFactor:n}=this.functionArguments,{isGCS:A}=this,{extent:m,primaryPixelSizes:v}=l;l=v?.[0];return z.slope(g,{zFactor:h,slopeType:d,pixelSizePower:u,pixelSizeFactor:n,isGCS:A,resolution:null==l?m?{x:m.width/g.width,y:m.height/g.height}:{x:1,y:1}:l})}_getWebGLParameters(){const {zFactor:l,slopeType:g,
pixelSizeFactor:h,pixelSizePower:d}=this.functionArguments,u=this.isGCS&&1<=l?l*z.gcsFactor:l,n=J.isIntegerPixelType(this.outputPixelType);return{zFactor:u,slopeType:g,pixelSizeFactor:h??0,pixelSizePower:d??0,isOutputRounded:n}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",
void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"isGCS",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],r)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;w=new w.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});B=z=class extends B{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new z({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};p.__decorate([J.enumeration(w)],
B.prototype,"slopeType",void 0);p.__decorate([r.property({type:Number,json:{write:!0}})],B.prototype,"zFactor",void 0);p.__decorate([r.property({type:Number,json:{name:"psPower",write:!0}})],B.prototype,"pixelSizePower",void 0);p.__decorate([r.property({type:Number,json:{name:"psZFactor",write:!0}})],B.prototype,"pixelSizeFactor",void 0);p.__decorate([r.property({type:Boolean,json:{write:!0}})],B.prototype,"removeEdgeEffect",void 0);return B=z=p.__decorate([L.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(p,w,r,M,G,R,J,L,B,z){r=class extends L{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {type:l}=this.functionArguments.toJSON();if(1>l||7<l)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${l}`};var g=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(g.pixelType);g=g.clone();g.pixelType=this.outputPixelType;const {statisticsType:h}=this.functionArguments;"stddev"===h&&this._removeStatsHistColormapVAT(g);this.rasterInfo=g;return{success:!0,supportsGPU:3>=g.bandCount&&5>
l}}_processPixels(l){l=l.pixelBlocks?.[0];if(null==l)return l;const {statisticsType:g,rows:h,cols:d,fillNoDataOnly:u}=this.functionArguments;return B.computeFocalStatistics(l,{kernelRows:h,kernelCols:d,fillNoDataOnly:u,outputPixelType:this.outputPixelType,statisticsType:g,mirrorEdges:!0})}_getWebGLParameters(){const {rows:l,cols:g,statisticsType:h,fillNoDataOnly:d}=this.functionArguments;return{fillNoDataOnly:d,kernelRows:l,kernelCols:g,statisticsType:h,clampRange:J.getPixelValueRange(this.outputPixelType)}}};
p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:z,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],r)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap",
"../PixelBlock","./mirror"],function(p,w,r,M,G){function R(J,L){const {fillNoDataOnly:B}=L,{band:z,width:l,height:g,mask:h,outBand:d}=J;if(B&&!h)d.set(z);else{var {kernelRows:u,kernelCols:n}=L;J=Math.floor(u/2);L=Math.floor(n/2);var A=d.slice(),m=new Uint32Array(l*g);for(var v=J;v<g-J;v++){var a=v*l;for(var b=L;b<l-L;b++){if(B&&h?.[a+b])continue;const k=[];for(let f=0;f<u;f++)for(let c=0;c<n;c++){const e=a+b+(f-J)*l+c-L;h&&!h[e]||k.push(z[e])}k.length&&(k.sort((f,c)=>f-c),h?(A[a+b]=k[Math.floor((k.length-
1)/2)],m[a+b]=k.length):d[a+b]=k[Math.floor((k.length-1)/2)])}}if(h)for(v=J;v<g-J;v++)for(a=v*l,b=L;b<l-L;b++)!m[a+b]||B&&h[a+b]||(d[a+b]=A[a+b],h[a+b]=255)}}w=new r.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});p.computeFocalStatistics=function(J,L){const {mask:B}=J,{fillNoDataOnly:z}=L;if(z&&!B)return J;const {pixels:l,width:g,height:h,bandMasks:d,pixelType:u}=J,n=l.length,A=g*h,m=[],{kernelRows:v,kernelCols:a,statisticsType:b,mirrorEdges:k}=
L;if(z&&!B)return J;const f=L.outputPixelType??u,c=[];for(let D=0;D<n;D++){const K=l[D],H=M.createEmptyBand(f,A);z&&H.set(K);const P=(d?.[D]??B)?.slice()??null,I={band:K,width:g,height:h,mask:P,outBand:H};switch(b){case "min":case "max":a:{var e=L;const {fillNoDataOnly:S}=e,{band:E,width:F,height:Q,mask:V,outBand:ba}=I;if(S&&!V){ba.set(E);break a}const {kernelRows:da,kernelCols:X,statisticsType:T}=e,Y=Math.floor(da/2),ia=Math.floor(X/2),ma="min"===T,C=ba.slice(),O=new Uint32Array(F*Q);for(let N=Y;N<
Q-Y;N++){const W=N*F;for(let ca=ia;ca<F-ia;ca++){let aa=ma?Number.MAX_VALUE:-Number.MAX_VALUE,ea=0;for(let ha=0;ha<da;ha++)for(let ja=0;ja<X;ja++){const na=W+ca+(ha-Y)*F+ja-ia;if(!V||V[na])aa=ma?Math.min(aa,E[na]):Math.max(aa,E[na]),ea++}V?(C[W+ca]=0===ea?0:aa,O[W+ca]=ea):ba[W+ca]=0===ea?0:aa}}if(V)for(let N=Y;N<Q-Y;N++){const W=N*F;for(let ca=ia;ca<F-ia;ca++)!O[W+ca]||S&&V[W+ca]||(ba[W+ca]=C[W+ca],V[W+ca]=255)}}break;case "mean":case "stddev":a:{var x=L;const {fillNoDataOnly:S}=x,{band:E,width:F,
height:Q,mask:V,outBand:ba}=I;if(S&&!V){ba.set(E);break a}const {statisticsType:da,kernelRows:X,kernelCols:T}=x,Y="stddev"===da,ia=F*Q,ma=new Float64Array(ia),C=new Float64Array(ia),O=new Uint32Array(ia);for(let ja=0;ja<Q;ja++){const na=ja*F;let pa=0,ra=0,sa=0;for(let qa=0;qa<T;qa++)if(!V||V[na+qa])pa+=E[na+qa],Y&&(ra+=E[na+qa]**2),sa++;ma[na]=pa;C[na]=ra;O[na]=sa;for(let qa=1;qa<=F-T;qa++){const va=na+qa-1,ta=va+T;V?(V[va]&&(sa--,pa-=E[va],Y&&(ra-=E[va]**2)),V[ta]&&(sa++,pa+=E[ta],Y&&(ra+=E[ta]**
2))):(pa-=E[va],pa+=E[ta],Y&&(ra-=E[va]**2,ra+=E[ta]**2));ma[na+qa]=pa;O[na+qa]=sa;Y&&(C[na+qa]=ra)}}const N=new Float64Array(ia),W=new Float64Array(ia),ca=new Uint32Array(ia),aa=X*F;for(let ja=0;ja<=F-T;ja++){let na=0,pa=0,ra=0;for(let sa=0;sa<X;sa++){const qa=sa*F+ja;na+=ma[qa];ra+=O[qa];Y&&(pa+=C[qa])}N[ja]=na;W[ja]=pa;ca[ja]=ra;for(let sa=1;sa<=Q-X;sa++){const qa=(sa-1)*F+ja,va=qa+aa;na-=ma[qa];na+=ma[va];ra-=O[qa];ra+=O[va];Y&&(pa-=C[qa],pa+=C[va]);N[sa*F+ja]=na;W[sa*F+ja]=pa;ca[sa*F+ja]=ra}}const ea=
Math.floor(X/2),ha=Math.floor(T/2);for(let ja=ea;ja<Q-ea;ja++){const na=ja*F;for(let pa=ha;pa<F-ha;pa++){const ra=(ja-ea)*F+pa-ha,sa=ca[ra];if(0===sa||S&&(!V||V[na+pa]))continue;const qa=N[ra]/sa;ba[na+pa]=Y?Math.sqrt((W[ra]-N[ra]*qa)/sa):qa;V&&(V[na+pa]=255)}}}break;case "median":R(I,L);break;case "majority":case "minority":a:{var t=L;const {fillNoDataOnly:S}=t,{band:E,width:F,height:Q,mask:V,outBand:ba}=I;if(S&&!V){ba.set(E);break a}const {kernelRows:da,kernelCols:X}=t,T=Math.floor(da/2),Y=Math.floor(X/
2),ia="majority"===t.statisticsType,ma=da*X,C=ba.slice(),O=new Uint32Array(F*Q);for(let N=T;N<Q-T;N++){const W=N*F;for(let ca=Y;ca<F-Y;ca++){if(S&&V?.[W+ca])continue;const aa=new Map;for(let na=0;na<da;na++)for(let pa=0;pa<X;pa++){const ra=W+ca+(na-T)*F+pa-Y;if(V&&!V[ra])continue;const sa=E[ra];aa.set(sa,aa.has(sa)?aa.get(sa)+1:1)}if(0===aa.size)continue;let ea=0,ha=0,ja=ia?0:ma+1;for(const na of aa.keys())ha=aa.get(na),ia===ha>ja&&(ja=ha,ea=na);V?(C[W+ca]=ea,O[W+ca]=aa.size):ba[W+ca]=ea}}if(V)for(let N=
T;N<Q-T;N++){const W=N*F;for(let ca=Y;ca<F-Y;ca++)!O[W+ca]||S&&V[W+ca]||(ba[W+ca]=C[W+ca],V[W+ca]=255)}}}k&&!z&&G.mirror(H,g,h,v,a);m.push(H);P&&c.push(P)}let y=c[0]??B;c.length!==n&&(c.length=0);1<n&&d?.length&&(y=M.combineBandMasks(d));const q=new M({pixelType:f,width:g,height:h,pixels:m,bandMasks:d&&c.length?c:null,mask:y});q.updateStatistics();return q};p.statisticsTypeMap=w;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;M=z=class extends L{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new z({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:w.clone(this.raster)})}};p.__decorate([r.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(l,g)=>Number(l??g?.kernelRows??3)}}})],M.prototype,"rows",void 0);p.__decorate([r.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(l,g)=>Number(l??g?.kernelCols??3)}}})],M.prototype,"cols",void 0);p.__decorate([r.property({json:{write:!0}})],M.prototype,"fillNoDataOnly",void 0);p.__decorate([r.property({json:{read:{source:["statisticsType","type"],reader:(l,g)=>B.statisticsTypeMap.fromJSON(g?.statisticsType??g?.type)??"min"},write:{target:"type"}}}),R.enumeration(B.statisticsTypeMap)],M.prototype,"statisticsType",void 0);return M=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
M)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(p,w,r,M,G,R,J,L){r=class extends J{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var B=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");B=B.clone();const {statistics:z,histograms:l}=this.functionArguments;l&&(B.histograms=l);z&&(B.statistics=z);this.rasterInfo=B;return{success:!0,supportsGPU:!0}}_processPixels(B){return B.pixelBlocks?.[0]}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],
r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"indexedColormap",void 0);p.__decorate([w.property()],r.prototype,"isNoopProcess",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],r)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B){var z;M=z=class extends B{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(l,g){if(!l?.length)return null;const h=[];l.forEach(d=>{h.push({min:d.min,max:d.max,avg:d.avg??d.mean,stddev:d.stddev??d.standardDeviation})});return h}writeStatistics(l,g,h){if(l?.length){var d=[];l.forEach(u=>{u={...u,mean:u.avg,standardDeviation:u.stddev};delete u.avg;delete u.stddev;d.push(u)});g[h]=d}}clone(){return new z({statistics:w.clone(this.statistics),
histograms:w.clone(this.histograms)})}};p.__decorate([r.property({json:{write:!0}})],M.prototype,"statistics",void 0);p.__decorate([R.reader("statistics")],M.prototype,"readStatistics",null);p.__decorate([L.writer("statistics")],M.prototype,"writeStatistics",null);p.__decorate([r.property({json:{write:!0}})],M.prototype,"histograms",void 0);return M=z=p.__decorate([J.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],M)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l){r=class extends L{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var g=this.sourceRasterInfos[0],{pixelType:h}=g,{functionArguments:d}=this;const {dynamicRangeAdjustment:u,gamma:n,useGamma:A}=d;if(!u&&["u8","u16","s8","s16"].includes(h)){d=l.getStretchCutoff(d.toJSON(),{rasterInfo:g});const a=J.isIntegerPixelType(this.outputPixelType)?
"round":"float";this.lookup=l.createStretchLUT({pixelType:h,...d,gamma:A?n:null,rounding:a});this.cutOffs=d}else u||(this.cutOffs=l.getStretchCutoff(d.toJSON(),{rasterInfo:g}));this.outputPixelType=this._getOutputPixelType(h);g=g.clone();g.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(g);"u8"===this.outputPixelType&&(g.keyProperties.DataType="processed");const {outputMin:m=0,outputMax:v=255}=this.functionArguments;g.statistics=[];for(h=0;h<g.bandCount;h++)g.statistics[h]={min:m,
max:v};this.rasterInfo=g;return{success:!0,supportsGPU:!u}}_processPixels(g){g=g.pixelBlocks?.[0];if(null==g)return g;var {lookup:h}=this;if(h)return B.lookupPixels(g,{...h,outputPixelType:this.rasterInfo.pixelType});({functionArguments:h}=this);const d=this.cutOffs||l.getStretchCutoff(h.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:g});return l.stretch(g,{...d,gamma:h.useGamma?h.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:g=0,outputMax:h=255,
gamma:d,useGamma:u}=this.functionArguments,n=2<=this.rasterInfo.bandCount?3:1,A=u&&d?.length?l.computeGammaCorrection(n,d):[1,1,1],{minCutOff:m,maxCutOff:v}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===m.length&&(m[1]=m[2]=m[0],v[1]=v[2]=v[0]);const a=new Float32Array(n);var b;for(b=0;b<n;b++)a[b]=(h-g)/(v[b]-m[b]);b=J.isIntegerPixelType(this.outputPixelType);return{bandCount:n,outMin:g,outMax:h,minCutOff:m,maxCutOff:v,factor:a,useGamma:u,gamma:u&&d?d:[1,1,1],gammaCorrection:u&&A?
A:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:b,type:"stretch"}}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",void 0);p.__decorate([w.property({type:z,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property({json:{write:!0}})],r.prototype,"lookup",void 0);p.__decorate([w.property({json:{write:!0}})],
r.prototype,"cutOffs",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.StretchFunction")],r)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L,B,z){var l;w=new w.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});z=l=class extends z{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(g,h,d){g?.length&&(Array.isArray(g[0])||(g=g.map(u=>[u.min,u.max,u.avg,u.stddev])),h[d]=g)}clone(){return new l({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:r.clone(this.statistics),gamma:r.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:r.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};p.__decorate([M.property({type:Boolean,json:{write:!0}})],z.prototype,
"computeGamma",void 0);p.__decorate([M.property({type:Boolean,json:{name:"dra",write:!0}})],z.prototype,"dynamicRangeAdjustment",void 0);p.__decorate([M.property({type:[Number],json:{write:!0}})],z.prototype,"gamma",void 0);p.__decorate([M.property()],z.prototype,"histograms",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],z.prototype,"maxPercent",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],z.prototype,"minPercent",void 0);p.__decorate([M.property({type:Number,
json:{write:!0}})],z.prototype,"numberOfStandardDeviations",void 0);p.__decorate([M.property({type:Number,json:{name:"max",write:!0}})],z.prototype,"outputMax",void 0);p.__decorate([M.property({type:Number,json:{name:"min",write:!0}})],z.prototype,"outputMin",void 0);p.__decorate([M.property({type:Number,json:{write:!0}})],z.prototype,"sigmoidStrengthLevel",void 0);p.__decorate([M.property({json:{type:[[Number]],write:!0}})],z.prototype,"statistics",void 0);p.__decorate([B.writer("statistics")],z.prototype,
"writeStatistics",null);p.__decorate([J.enumeration(w)],z.prototype,"stretchType",void 0);p.__decorate([M.property({type:Boolean,json:{write:!0}})],z.prototype,"useGamma",void 0);return z=l=p.__decorate([L.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],z)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(p,w,r,M,G,R,J,L){r=class extends J{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var B=this.sourceRasterInfos[0];if(1<B.bandCount||B.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:z}=this.functionArguments;if(!z)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(B.pixelType);B=B.clone();B.pixelType=this.outputPixelType;B.bandCount=1;"thematic"!==B.dataType&&(B.keyProperties=B.keyProperties?{...B.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=B;return{success:!0,supportsGPU:!0}}_processPixels(B){return B.pixelBlocks?.[0]}};p.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],r.prototype,"functionName",
void 0);p.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],r.prototype,"functionArguments",void 0);p.__decorate([w.property()],r.prototype,"rasterArgumentNames",void 0);p.__decorate([w.property()],r.prototype,"isNoopProcess",void 0);return r=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.TableFunction")],r)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,w,r,M,G,R,J){var L;M=L=class extends J{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new L({attributeTableAsRecordSet:w.clone(this.attributeTableAsRecordSet)})}};p.__decorate([r.property({json:{write:!0}})],M.prototype,"attributeTableAsRecordSet",void 0);return M=L=p.__decorate([R.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],M)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap",
"../PixelBlock","./pixelUtils"],function(p,w,r,M){function G(c,e){return n.get(c)/n.get(e)||1}function R(c,e="geographic"){const [x,t]=c;c=Math.sqrt(x*x+t*t);let y=Math.atan2(t,x)*A;y=(360+y)%360;"geographic"===e&&(y=(450-y)%360);return[c,y]}function J(c,e="geographic"){let x=c[1];"geographic"===e&&(x=(450-x)%360);x%=360;c=c[0];return[c*Math.cos(x/A),c*Math.sin(x/A)]}function L(c,e,x="geographic",t=1){if(!M.isValidPixelBlock(c))return c;const {pixels:y,width:q,height:D}=c;var K=q*D;const H=y[0],P=
y[1],I=c.pixelType.startsWith("f")?c.pixelType:"f32",S=r.createEmptyBand(I,K);K=r.createEmptyBand(I,K);let E=0;for(let F=0;F<D;F++)for(let Q=0;Q<q;Q++)"vector-uv"===e?([S[E],K[E]]=R([H[E],P[E]],x),S[E]*=t):([S[E],K[E]]=J([H[E],P[E]],x),S[E]*=t,K[E]*=t),E++;c=new r({pixelType:I,width:c.width,height:c.height,mask:c.mask,validPixelCount:c.validPixelCount,maskIsAlpha:c.maskIsAlpha,pixels:[S,K]});c.updateStatistics();return c}function B(c=0,e=0,x=Math.PI,t=!0){t&&(x=(2*Math.PI-x)%(2*Math.PI));t=t?-1:1;
const y=-7*t,q=-2*t,D=-16*t,[K,H]=l(0,e+13*t,x,21.75),[P,I]=l(c-5.5,e+y,x,21.75),[S,E]=l(c+5.5,e+y,x,21.75),[F,Q]=l(c-1.5,e+q,x,21.75),[V,ba]=l(c+1.5,e+q,x,21.75),[da,X]=l(c-1.5,e+D,x,21.75),[T,Y]=l(c+1.5,e+D,x,21.75);return[K,H,P,I,F,Q,V,ba,S,E,da,X,T,Y]}function z(c=0,e=Math.PI,x=!0){x&&(e=(2*Math.PI-e)%(2*Math.PI));var t=x?-1:1,y=5*t;const q=20*t,D=25*t;t*=2;const K=x?1:-1;x=5*K;let [H,P]=[0+x,0-q],[I,S]=[H+2*K,P],[E,F]=[I-0*K,S+t],[Q,V]=[0-x,0-D],[ba,da]=[Q+0*K,V-t],X=Math.ceil(c/5),T=Math.floor(X/
10);X-=8*T;c=[];const Y=[];for(let ea=0;ea<X/2;ea++,T--){0>=T&&1===X%2&&ea===(X-1)/2&&(Q=0,ba=Q+0*K,V=(V+P)/2,da=V-t);const [ha,ja]=l(Q,V,e,45);if(0<T){const [na,pa]=l(I,V,e,45),[ra,sa]=l(H,P,e,45);c.push(na);c.push(pa);c.push(ha);c.push(ja);c.push(ra);c.push(sa)}else{const [na,pa]=l(I,S,e,45),[ra,sa]=l(E,F,e,45),[qa,va]=l(ba,da,e,45);Y.push(ha);Y.push(ja);Y.push(qa);Y.push(va);Y.push(ra);Y.push(sa);Y.push(na);Y.push(pa)}V+=y;P+=y;S+=y;F+=y;da+=y}const [ia,ma]=l(0+x,0+q,e,45);y=7*K;const [C,O]=l(0+
y,0+q,e,45),[N,W]=l(0+x,0-D,e,45),[ca,aa]=l(0+y,0-D,e,45);return{pennants:c,barbs:Y,shaft:[ia,ma,C,O,N,W,ca,aa]}}function l(c,e,x,t=1){return[Math.sqrt(c*c+e*e)/t,(2*Math.PI+(2*Math.PI+Math.atan2(e,c))%(2*Math.PI)-x)%(2*Math.PI)]}function g(c,e,x,t){x=G(t||"knots",x);for(t=1;t<e.length;t++)if(t===e.length-1){if(c<e[t]*x)break}else if(c<=e[t]*x)break;return Math.min(t-1,e.length-2)}function h(c,e,x,t,y){let q=0;switch(e){case "beaufort_kn":q=g(c,a,"knots",x);break;case "beaufort_km":q=g(c,a,"kilometer-per-hour",
x);break;case "beaufort_ft":q=g(c,a,"feet-per-second",x);break;case "beaufort_m":q=g(c,a,"meter-per-second",x);break;case "classified_arrow":q=g(c,y??[],t,x);break;case "ocean_current_m":q=g(c,b,"meter-per-second",x);break;case "ocean_current_kn":q=g(c,k,"knots",x)}return q}function d(c,e){const {style:x,inputUnit:t,outputUnit:y,breakValues:q}=e,D=m.fromJSON(t),K=m.fromJSON(y);let H=0,P=0;const {width:I,height:S,mask:E}=c,F=c.pixels[0];c=c.pixels[1];var Q=null!=E?E.filter(da=>0<da).length:I*S;const V=
new Float32Array(42*Q);Q=new Uint32Array(15*Q);e=e.invertDirection?B(0,0,0,!1):v;for(let da=0;da<S;da++)for(let X=0;X<I;X++){var ba=da*I+X;if(!E||E[da*I+X]){const T=(c[ba]+360)%360/180*Math.PI,Y=h(F[ba],x,D,K,q);for(let ia=0;ia<e.length;ia+=2)V[H++]=(X+.5)/I,V[H++]=(da+.5)/S,V[H++]=e[ia],V[H++]=e[ia+1]+T,V[H++]=Y,V[H++]=F[ba];ba=7*(H/42-1);Q[P++]=ba;Q[P++]=ba+1;Q[P++]=ba+2;Q[P++]=ba+0;Q[P++]=ba+4;Q[P++]=ba+3;Q[P++]=ba+0;Q[P++]=ba+2;Q[P++]=ba+3;Q[P++]=ba+2;Q[P++]=ba+5;Q[P++]=ba+3;Q[P++]=ba+5;Q[P++]=
ba+6;Q[P++]=ba+3}}return{vertexData:V,indexData:Q}}function u(c,e){let x=0,t=0;const {width:y,height:q,mask:D}=c;c=c.pixels[0];const K=[],H=[];var P=m.fromJSON(e.inputUnit);P=G(P,"knots");e="wind_speed"===e.style?5:Number.MAX_VALUE;for(let S=0;S<q;S++)for(let E=0;E<y;E++){var I=c[S*y+E]*P;if((!D||D[S*y+E])&&I<e){for(let F=0;4>F;F++)K[x++]=(E+.5)/y,K[x++]=(S+.5)/q,K[x++]=2>F?-.5:.5,K[x++]=0===F%2?-.5:.5,K[x++]=0,K[x++]=I;I=4*(x/24-1);H[t++]=I;H[t++]=I+1;H[t++]=I+2;H[t++]=I+1;H[t++]=I+2;H[t++]=I+3}}return{vertexData:new Float32Array(K),
indexData:new Uint32Array(H)}}const n=new Map;n.set("meter-per-second",1);n.set("kilometer-per-hour",.277778);n.set("knots",.514444);n.set("feet-per-second",.3048);n.set("mile-per-hour",.44704);const A=180/Math.PI,m=new w.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),v=B(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],b=[0,.5,1,1.5,2],k=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],
f=[];p.convertToLocalDirections=function(c,e,x,t="geographic"){if(!M.isValidPixelBlock(c)||null==x)return c;c="vector-magdir"===e?c.clone():L(c,e);const y=c.pixels[1];for(let q=0;q<y.length;q++)y[q]="geographic"===t?(y[q]+x[q]+270)%360:(y[q]+360-x[q])%360;return"vector-magdir"===e?c:L(c,"vector-magdir")};p.convertVectorFieldData=L;p.convertVectorFieldUnit=function(c,e,x=1){if(1===x||!M.isValidPixelBlock(c))return c;c=c.clone();const {pixels:t,width:y,height:q}=c,D=t[0],K=t[1];let H=0;for(let P=0;P<
q;P++)for(let I=0;I<y;I++)"vector-uv"===e?(D[H]*=x,K[H]*=x):D[H]*=x,H++;c.updateStatistics();return c};p.createVFMesh=function(c,e){if("simple_scalar"===e.style)e=u(c,e);else if("wind_speed"===e.style){if(0===f.length)for(var x=0;30>x;x++)f.push(z(5*x,0,!e.invertDirection));e=m.fromJSON(e.inputUnit);e=G(e,"knots");const {width:D,height:K,mask:H}=c;x=c.pixels[0];c=c.pixels[1];const P=[],I=[];let S=0,E=0;for(let F=0;F<K;F++)for(let Q=0;Q<D;Q++){var t=F*D+Q,y=x[t]*e;if((!H||H[F*D+Q])&&5<=y){const V=
(c[t]+360)%360/180*Math.PI,{pennants:ba,barbs:da,shaft:X}=f[Math.min(Math.floor(y/5),29)];if(0===ba.length+da.length)continue;t=P.length/6;const T=(Q+.5)/D,Y=(F+.5)/K;for(var q=0;q<ba.length;q+=2)P[S++]=T,P[S++]=Y,P[S++]=ba[q],P[S++]=ba[q+1]+V,P[S++]=0,P[S++]=y;for(q=0;q<da.length;q+=2)P[S++]=T,P[S++]=Y,P[S++]=da[q],P[S++]=da[q+1]+V,P[S++]=0,P[S++]=y;for(q=0;q<X.length;q+=2)P[S++]=T,P[S++]=Y,P[S++]=X[q],P[S++]=X[q+1]+V,P[S++]=0,P[S++]=y;for(y=0;y<ba.length/6;y++)I[E++]=t,I[E++]=t+1,I[E++]=t+2,t+=
3;for(y=0;y<da.length/8;y++)I[E++]=t,I[E++]=t+1,I[E++]=t+2,I[E++]=t+1,I[E++]=t+2,I[E++]=t+3,t+=4;I[E++]=t+0;I[E++]=t+1;I[E++]=t+2;I[E++]=t+1;I[E++]=t+3;I[E++]=t+2;t+=4}}e={vertexData:new Float32Array(P),indexData:new Uint32Array(I)}}else e=d(c,e);return e};p.createVFMeshScalar=u;p.getUnitConversionFactor=G;p.sampleVectorField=function(c,e,x,t=[0,0],y=.5){const {width:q,height:D,mask:K}=c,[H,P]=c.pixels,[I,S]=t;c=Math.round((q-I)/x);t=Math.round((D-S)/x);var E=c*t;const F=new Float32Array(E),Q=new Float32Array(E);
E=new Uint8Array(E);e="vector-uv"===e;for(let ba=0;ba<t;ba++)for(let da=0;da<c;da++){let X=0;const T=ba*c+da,Y=Math.max(0,ba*x+S),ia=Math.max(0,da*x+I),ma=Math.min(D,Y+x),C=Math.min(q,ia+x);for(let O=Y;O<ma;O++)for(let N=ia;N<C;N++){var V=O*q+N;if(!K||K[V]){X++;V=e?[H[V],P[V]]:[H[V],(360+P[V])%360];const [W,ca]=e?V:J(V);F[T]+=W;Q[T]+=ca}}if(X>=(ma-Y)*(C-ia)*(1-y)){E[T]=1;const [O,N]=R([F[T]/X,Q[T]/X]);F[T]=O;Q[T]=N}else E[T]=0,F[T]=0,Q[T]=0}x=new r({width:c,height:t,pixels:[F,Q],mask:E});x.updateStatistics();
return x};p.snapImageToSymbolTile=function(c,e,x,t,y){if(null==y||!y.spatialReference.equals(c.spatialReference))return{extent:c,width:Math.round(e/t),height:Math.round(x/t),resolution:c.width/e};const q=y.xmin;y=y.ymax;e=(c.xmax-c.xmin)/e*t;x=(c.ymax-c.ymin)/x*t;c.xmin=q+Math.floor((c.xmin-q)/e)*e;c.xmax=q+Math.ceil((c.xmax-q)/e)*e;c.ymin=y+Math.floor((c.ymin-y)/x)*x;c.ymax=y+Math.ceil((c.ymax-y)/x)*x;return{extent:c,width:Math.round(c.width/e),height:Math.round(c.height/x),resolution:(e+x)/2}};
p.unitKebabDict=m;p.uvComponentToVector=R;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform","./IdentityTransform","./PolynomialTransform"],function(p,w,r,M){const G={GCSShiftXform:w,IdentityXform:r,PolynomialXform:M},R=Object.keys(G);p.isTransformSupported=function(J){return!J||R.includes(J?.type)};p.readTransform=function(J){if(!J?.type)return null;var L=G[J?.type];return L?(L=new L,L.read(J),
L):null};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),function(p,w,r,M,G,R,J,L){var B;r=B=class extends L{constructor(){super(...arguments);
this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(z){z=z.clone();if("point"===z.type)return z.x>180+this.tolerance&&(z.x-=360),z;z.xmin>=180-this.tolerance?(z.xmax-=360,z.xmin-=360):z.xmax>180+this.tolerance&&(z.xmin=-180,z.xmax=180);return z}inverseTransform(z){z=z.clone();if("point"===z.type)return z.x<-this.tolerance&&(z.x+=360),z;z.xmin<-this.tolerance&&(z.xmin+=360,z.xmax+=360);return z}clone(){return new B({tolerance:this.tolerance})}};p.__decorate([R.enumeration({GCSShiftXform:"gcs-shift"})],
r.prototype,"type",void 0);p.__decorate([w.property()],r.prototype,"tolerance",void 0);return r=B=p.__decorate([J.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],r)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(p,
w,r,M,G,R,J){w=class extends w.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(L){return L}inverseTransform(L){return L}};p.__decorate([r.property()],w.prototype,"affectsPixelSize",null);p.__decorate([r.property({json:{write:!0}})],w.prototype,"spatialReference",void 0);return w=p.__decorate([J.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],w)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(p,w,r,M,G,R,J,L){var B;w=B=class extends L{constructor(){super(...arguments);this.type="identity"}clone(){return new B}};p.__decorate([R.enumeration({IdentityXform:"identity"})],w.prototype,"type",void 0);return w=B=p.__decorate([J.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],w)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(p,w,r,M,G,R,J,L,B,z,l,g,h){function d(A,m,v){const {x:a,y:b}=m;if(2>v)return{x:A[0]+a*A[2]+b*A[4],y:A[1]+a*A[3]+b*A[5]};if(2===v){m=a*a;v=b*b;var k=a*b;return{x:A[0]+a*A[2]+b*A[4]+m*A[6]+k*A[8]+v*A[10],y:A[1]+a*A[3]+b*A[5]+m*A[7]+k*A[9]+v*A[11]}}m=a*a;v=b*b;k=a*b;const f=m*a,c=m*b,e=a*v,x=b*v;return{x:A[0]+a*A[2]+b*A[4]+m*A[6]+k*A[8]+v*A[10]+f*A[12]+c*A[14]+e*A[16]+x*A[18],y:A[1]+a*A[3]+b*A[5]+m*A[7]+k*A[9]+v*A[11]+f*A[13]+c*A[15]+e*A[17]+x*A[19]}}function u(A,m,v){const {xmin:a,ymin:b,xmax:k,
ymax:f,spatialReference:c}=m;m=[];if(2>v)m.push({x:a,y:f}),m.push({x:k,y:f}),m.push({x:a,y:b}),m.push({x:k,y:b});else{var e=10;for(var x=0;x<e;x++)m.push({x:a,y:b+(f-b)*x/(e-1)}),m.push({x:k,y:b+(f-b)*x/(e-1)});e=8;for(x=1;x<=e;x++)m.push({x:a+(k-a)*x/e,y:b}),m.push({x:a+(k-a)*x/e,y:f})}m=m.map(t=>d(A,t,v));e=m.map(t=>t.x);m=m.map(t=>t.y);return new h({xmin:Math.min.apply(null,e),xmax:Math.max.apply(null,e),ymin:Math.min.apply(null,m),ymax:Math.max.apply(null,m),spatialReference:c})}var n;w=n=class extends l{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(A,m){const {coeffX:v,coeffY:a}=m;if(!v?.length||!a?.length||v.length!==a.length)return null;A=[];for(m=0;m<v.length;m++)A.push(v[m]),A.push(a[m]);return A}writeForwardCoefficients(A,m,v){v=[];const a=[];for(let b=0;b<A?.length;b++)0===b%2?v.push(A[b]):a.push(A[b]);m.coeffX=v;m.coeffY=a}get inverseCoefficients(){var A=this._get("inverseCoefficients"),m=this._get("forwardCoefficients");if(!A&&m&&2>this.polynomialOrder){const [v,a,
b,k,f,c]=m;A=b*c-f*k;m=f*k-b*c;A=[(f*a-v*c)/A,(b*a-v*k)/m,c/A,k/m,-f/A,-b/m]}return A}set inverseCoefficients(A){this._set("inverseCoefficients",A)}readInverseCoefficients(A,m){const {inverseCoeffX:v,inverseCoeffY:a}=m;if(!v?.length||!a?.length||v.length!==a.length)return null;A=[];for(m=0;m<v.length;m++)A.push(v[m]),A.push(a[m]);return A}writeInverseCoefficients(A,m,v){v=[];const a=[];for(let b=0;b<A?.length;b++)0===b%2?v.push(A[b]):a.push(A[b]);m.inverseCoeffX=v;m.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(A){if("point"===A.type){const m=d(this.forwardCoefficients,A,this.polynomialOrder);return new g({x:m.x,y:m.y,spatialReference:A.spatialReference})}return u(this.forwardCoefficients,A,this.polynomialOrder)}inverseTransform(A){if("point"===A.type){const m=d(this.inverseCoefficients,A,this.polynomialOrder);return new g({x:m.x,y:m.y,spatialReference:A.spatialReference})}return u(this.inverseCoefficients,A,this.polynomialOrder)}clone(){return new n({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};p.__decorate([r.property({json:{write:!0}})],w.prototype,"polynomialOrder",void 0);p.__decorate([r.property()],w.prototype,"forwardCoefficients",void 0);p.__decorate([L.reader("forwardCoefficients",["coeffX","coeffY"])],w.prototype,"readForwardCoefficients",null);p.__decorate([z.writer("forwardCoefficients")],w.prototype,"writeForwardCoefficients",
null);p.__decorate([r.property({json:{write:!0}})],w.prototype,"inverseCoefficients",null);p.__decorate([L.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],w.prototype,"readInverseCoefficients",null);p.__decorate([z.writer("inverseCoefficients")],w.prototype,"writeInverseCoefficients",null);p.__decorate([r.property()],w.prototype,"affectsPixelSize",null);p.__decorate([J.enumeration({PolynomialXform:"polynomial"})],w.prototype,"type",void 0);return w=n=p.__decorate([B.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
w)})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),function(p,
w,r,M,G,R,J,L,B,z,l,g,h){function d(m){return"percentClip"===m||"histogramEqualization"===m}function u(m){return null!=m&&0<m.length&&null!=m[0].min&&null!=m[0].max}function n(m){return B.isValidPixelBlock(m)&&0!==m.validPixelCount}function A(m){return"algorithmic"===m.type&&["0,0,0,255","0,0,0"].includes(m.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(m.toColor.join(","))}w=class extends w.JSONSupport{constructor(m){super(m)}bind(){const {rendererJSON:m}=this;if(!m)return{success:!1};
this.lookup={rendererJSON:{}};let v;switch(m.type){case "uniqueValue":v=this._updateUVRenderer(m);break;case "rasterColormap":v=this._updateColormapRenderer(m);break;case "rasterStretch":v=this._updateStretchRenderer(m);break;case "classBreaks":v=this._updateClassBreaksRenderer(m);break;case "rasterShadedRelief":v=this._updateShadedReliefRenderer(m);break;case "vectorField":v=this._updateVectorFieldRenderer();break;case "flowRenderer":v=this._updateFlowRenderer()}return v}symbolize(m){let v=m?.pixelBlock;
if(!n(v))return v;if(m.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(v,m.simpleStretchParams);try{3<v.pixels.length&&(v=v.extractBands(m.bandIds??[0,1,2]));let a;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":a=this._symbolizeColormap(v);break;case "classBreaks":a=this._symbolizeClassBreaks(v);break;case "rasterStretch":a=this._symbolizeStretch(v,m.bandIds);break;case "rasterShadedRelief":const b=m.extent;a=this._symbolizeShadedRelief(v,
{isGCS:b.spatialReference.isGeographic,resolution:{x:(b.xmax-b.xmin)/v.width,y:(b.ymax-b.ymin)/v.height}})}return a}catch(a){return r.getLogger(this).error("symbolize",a.message),v}}simpleStretch(m,v){if(!n(m))return m;try{return 3<m.pixels.length&&(m=m.extractBands([0,1,2])),z.stretch(m,{...v,isRenderer:!0})}catch(a){return r.getLogger(this).error("symbolize",a.message),m}}generateWebGLParameters(m){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:f,
offset:c}=this.lookup.colormapLut||{};return{colormap:f,colormapOffset:c,isClassBreaks:"classBreaks"===this.rendererJSON.type,type:"lut"}}const {pixelBlock:v,isGCS:a,resolution:b,bandIds:k}=m;({rendererJSON:m}=this);return"rasterStretch"===m.type?this._generateStretchWebGLParams(v,m,k):"rasterShadedRelief"===m.type?this._generateShadedReliefWebGLParams(m,a,b??void 0):"vectorField"===m.type?this._generateVectorFieldWebGLParams(m):null}_isLUTChanged(m){if(!this.lookup||!this.lookup.rendererJSON)return!0;
if("colorRamp"in this.rendererJSON){const v=this.rendererJSON.colorRamp;if(m)return JSON.stringify(v)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(m){return this._isLUTChanged()&&!this.bind().success?m:B.colorize(m,this.lookup.colormapLut)}_symbolizeClassBreaks(m){const {canUseIndexedLUT:v}=this._analyzeClassBreaks(this.rendererJSON);
return this._isLUTChanged()&&!this.bind().success?m:v?B.colorize(m,this.lookup.colormapLut):B.remapColor(m,this.lookup.remapLut??[])}_symbolizeStretch(m,v){const {rasterInfo:a}=this,{pixelType:b,bandCount:k}=a,f=this.rendererJSON;var c=["u8","u16","s8","s16"].includes(b);let e;var {dra:x}=f;({gamma:t}=this.lookup);if("histogramEqualization"===f.stretchType){c=x?null:this.lookup?.histogramLut;v=z.getStretchCutoff(f,{rasterInfo:a,pixelBlock:m,bandIds:v,returnHistogramLut:!c});var t=z.stretch(m,{...v,
gamma:t,isRenderer:!0});t=B.lookupPixels(t,{lut:x?v.histogramLut:c,offset:0})}else if(c){if(x)x=z.getStretchCutoff(f,{rasterInfo:a,pixelBlock:m,bandIds:v}),e=z.createStretchLUT({pixelType:b,...x,gamma:t,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return m;e=this.lookup?this.lookup.stretchLut:null}if(!e)return m;1<k&&null!=v&&v.length===m?.pixels.length&&e?.lut.length===k&&(e={lut:v.map(y=>e.lut[y]),offset:e.offset});t=B.lookupPixels(m,e)}else x=z.getStretchCutoff(f,{rasterInfo:a,
pixelBlock:m,bandIds:v}),t=z.stretch(m,{...x,gamma:t,isRenderer:!0});if(f.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return m;t=B.colorize(t,this.lookup?.colormapLut)}return t}_symbolizeShadedRelief(m,v){var a=this.rendererJSON;v=l.hillshade(m,{...a,...v});if(!a.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return v;a=this.lookup?this.lookup.hsvMap:null;if(!a)return v;l.tintHillshade(v,m,a,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return v}_isVectorFieldData(){const {bandCount:m,
dataType:v}=this.rasterInfo;return 2===m&&("vector-magdir"===v||"vector-uv"===v)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(m){const {bandCount:v,
attributeTable:a,pixelType:b}=this.rasterInfo,k=m.field1;if(!k)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const f=m.defaultSymbol;var c=1===v&&["u8","s8"].includes(b);if(!h.isUVRendererSupported(this.rasterInfo,k)&&!c)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const e=[];if(null!=a){const x=a.fields.find(t=>"value"===t.name.toLowerCase());if(!x)return{success:!1,
error:"Unsupported data; the data's raster attribute table does not have a value field."};a.features.forEach(t=>{const y=m.uniqueValueInfos?.find(q=>String(q.value)===String(t.attributes[k]))?.symbol?.color;y?e.push([t.attributes[x.name]].concat(y)):f&&e.push([t.attributes[x.name]].concat(f.color))})}else{if("value"!==k.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not available.'};m.uniqueValueInfos?.forEach(x=>
{const t=x?.symbol?.color;t?e.push([parseInt(""+x.value,10)].concat(t)):f&&e.push([parseInt(""+x.value,10)].concat(f?.color))})}if(0===e.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};c=B.createColormapLUT({colormap:e});this.lookup={rendererJSON:m,colormapLut:c};this.canRenderInWebGL=h.isColormapSupportedByWebGL(c?.indexedColormap);return{success:!0}}_updateColormapRenderer(m){if(!h.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var v=m.colormapInfos.map(a=>[a.value].concat(a.color)).sort((a,b)=>a[0]-b[0]);if(!v||0===v.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};v=B.createColormapLUT({colormap:v});this.lookup={rendererJSON:m,colormapLut:v};this.canRenderInWebGL=h.isColormapSupportedByWebGL(v?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(m){if(!h.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(m.colorRamp){var v=g.convertColorRampToColormap(m.colorRamp,{interpolateAlpha:!0});v=B.createColormapLUT({colormap:v});const a=g.createHsvMap(v.indexedColormap);this.lookup={rendererJSON:m,colormapLut:v,hsvMap:a}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}}_analyzeClassBreaks(m){const {attributeTable:v,pixelType:a}=this.rasterInfo,b=
null!=v?v.fields.find(c=>"value"===c.name.toLowerCase()):null,k=null!=v?v.fields.find(c=>c.name.toLowerCase()===m.field.toLowerCase()):null,f=null!=b&&null!==k;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(a)||f,tableValueField:b,tableBreakField:k}}_updateClassBreaksRenderer(m){var {attributeTable:v}=this.rasterInfo;const {canUseIndexedLUT:a,tableValueField:b,tableBreakField:k}=this._analyzeClassBreaks(m);var f=m.classBreakInfos;if(!f?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};
f=f.sort((y,q)=>y.classMaxValue-q.classMaxValue);var c=f[f.length-1],e=m.minValue;if(!a){var x=[];for(var t=0;t<f.length;t++)x.push({value:f[t].classMinValue??e,mappedColor:f[t].symbol.color}),e=f[t].classMaxValue;x.push({value:c.classMaxValue,mappedColor:c.symbol.color});this.lookup={rendererJSON:m,remapLut:x};this.canRenderInWebGL=!1;return{success:!0}}x=[];if(null!=v&&null!=b&&null!==k&&b!==k){c=b.name;const y=k.name,q=f[f.length-1],{classMaxValue:D}=q;e=m.minValue;for(t of v.features){v=t.attributes[c];
const K=t.attributes[y],H=K===D?q:K<e?null:f.find(({classMaxValue:P})=>P>K);H&&x.push([v].concat(H.symbol.color))}}else{e=Math.floor(m.minValue);for(t=0;t<f.length;t++){for(v=f[t];e<v.classMaxValue;e++)x.push([e].concat(v.symbol.color));e=Math.ceil(v.classMaxValue)}c.classMaxValue===e&&x.push([c.classMaxValue].concat(c.symbol.color))}f=B.createColormapLUT({colormap:x,fillUnspecified:!1});this.lookup={rendererJSON:m,colormapLut:f};this.canRenderInWebGL=h.isColormapSupportedByWebGL(f?.indexedColormap);
return{success:!0}}_updateStretchRenderer(m){let {stretchType:v,dra:a}=m;if(!("none"===v||m.statistics?.length||u(this.rasterInfo.statistics)||a))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var b=m.histograms||this.rasterInfo.histograms;!d(m.stretchType)||b?.length||a||(v="minMax");const {computeGamma:k,useGamma:f,colorRamp:c}=m;let {gamma:e}=m;f&&k&&!e?.length&&(e=z.computeGammaValues(this.rasterInfo.pixelType,
m.statistics?.length?m.statistics:this.rasterInfo.statistics));var x=this.rasterInfo.pixelType;const t=!a&&["u8","u16","s8","s16"].includes(x);"histogramEqualization"===v?(x=b.map(y=>z.createHistogramEqualizationLUT(y)),this.lookup={rendererJSON:m,histogramLut:x}):t&&(b=z.getStretchCutoff(m,{rasterInfo:this.rasterInfo}),x=z.createStretchLUT({pixelType:x,...b,gamma:f?e:null,rounding:"floor"}),this.lookup={rendererJSON:m,stretchLut:x});c&&!A(c)&&(x=g.convertColorRampToColormap(c,{interpolateAlpha:!0}),
this.lookup||(this.lookup={rendererJSON:m}),this.lookup.colormapLut=B.createColormapLUT({colormap:x}),this.lookup.rendererJSON=m);this.lookup.gamma=f&&e?.length?e:null;this.canRenderInWebGL=!0;return{success:!0}}_generateStretchWebGLParams(m,v,a){let b=null,k=null;var f=this.lookup?.colormapLut;v.colorRamp&&f&&(b=f.indexedColormap,k=f.offset);"histogramEqualization"===v.stretchType&&(v={...v,stretchType:"minMax"});({gamma:f}=this.lookup);const c=!(!v.useGamma||!f?.some(H=>1!==H)),{minCutOff:e,maxCutOff:x,
outMin:t,outMax:y}=z.getStretchCutoff(v,{rasterInfo:this.rasterInfo,pixelBlock:m,bandIds:a});var q=0;null!=m&&(q=m.getPlaneCount(),2===q&&(m=m.clone(),m.statistics=[m.statistics[0]],m.pixels=[m.pixels[0]]));({bandCount:m}=this.rasterInfo);a=Math.min(3,a?.length||q||m,m);m=new Float32Array(a);q=b||c?1:255;let D;for(D=0;D<e.length;D++)m[D]=x[D]===e[D]?0:(y-t)/(x[D]-e[D])/q;const K=new Float32Array(a);if(c&&f)for(D=0;D<a;D++)K[D]=1<f[D]?2<f[D]?6.5+(f[D]-2)**2.5:6.5+100*(2-f[D])**4:1;return{bandCount:a,
outMin:t/q,outMax:y/q,minCutOff:e,maxCutOff:x,factor:m,useGamma:c,gamma:c?f:[1,1,1],gammaCorrection:c?K:[1,1,1],colormap:b,colormapOffset:k,stretchType:v.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(m,v=!1,a={x:0,y:0}){let b=null,k=null;const f=this.lookup?.colormapLut;m.colorRamp&&f&&(b=f.indexedColormap,k=f.offset);v=l.calculateHillshadeParams({...m,isGCS:v,resolution:a});a=this.rasterInfo.statistics?.[0];return{...v,minValue:a?.min??0,maxValue:a?.max??8E3,hillshadeType:"traditional"===
m.hillshadeType?0:1,type:"hillshade",colormap:b,colormapOffset:k}}_generateVectorFieldWebGLParams(m){const {style:v,inputUnit:a,outputUnit:b,visualVariables:k,symbolTileSize:f,flowRepresentation:c}=m;let e;var x=this.rasterInfo.statistics?.[0].min??0,t=this.rasterInfo.statistics?.[0].max??50,y=k?.find(K=>"sizeInfo"===K.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:t,maxSize:.8*f,minDataValue:x,minSize:.2*f},q=y.minDataValue??x,D=y.maxDataValue??t;t=null!=y.maxSize&&null!=y.minSize?[y.minSize/
f,y.maxSize/f]:[.2,.8];"wind_speed"===v&&(t[0]=t[1]=(t[0]+t[1])/2);x=null!=q&&null!=D?[q,D]:null;if("classified_arrow"===v)if(null!=q&&null!=D&&null!=y)for(e=[],q=(y.maxDataValue-y.minDataValue)/5,D=0;6>D;D++)e.push(y.minDataValue+q*D);else e=[0,1E-6,3.5,7,10.5,14];y="flow_to"===c===("ocean_current_kn"===v||"ocean_current_m"===v)?0:Math.PI;q=k?.find(K=>"rotationInfo"===K.type);return{breakValues:e,dataRange:x,inputUnit:a,outputUnit:b,symbolTileSize:f,symbolPercentRange:t,style:v||"single_arrow",rotation:y,
rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":q?.rotationType||m.rotationType,type:"vectorField"}}};p.__decorate([M.property({json:{write:!0}})],w.prototype,"rendererJSON",void 0);p.__decorate([M.property({type:L,json:{write:!0}})],w.prototype,"rasterInfo",void 0);p.__decorate([M.property({json:{write:!0}})],w.prototype,"lookup",void 0);p.__decorate([M.property()],w.prototype,"canRenderInWebGL",void 0);return w=p.__decorate([J.subclass("esri.renderers.support.RasterSymbolizer")],
w)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(p,w,r,M,G,R,J,L,B){function z(a,b){const k=h(b.data,b.width,b.height,a.smoothing);return a.interpolate?(f,c)=>{const e=Math.floor(f),x=Math.floor(c);if(0>e||e>=b.width||0>x||x>=b.height)return[0,
0];f-=e;c-=x;const t=e<b.width-1?e+1:e,y=x<b.height-1?x+1:x;return[(k[2*(x*b.width+e)]*(1-c)+k[2*(y*b.width+e)]*c)*(1-f)+(k[2*(x*b.width+t)]*(1-c)+k[2*(y*b.width+t)]*c)*f,(k[2*(x*b.width+e)+1]*(1-c)+k[2*(y*b.width+e)+1]*c)*(1-f)+(k[2*(x*b.width+t)+1]*(1-c)+k[2*(y*b.width+t)+1]*c)*f]}:(f,c)=>{f=Math.round(f);c=Math.round(c);return 0>f||f>=b.width||0>c||c>=b.height?[0,0]:[k[2*(c*b.width+f)],k[2*(c*b.width+f)+1]]}}function l(a,b,k,f,c,e,x,t,y){const q=[];let D=0,[K,H]=b(k,f);K*=a.velocityScale;H*=a.velocityScale;
q.push({x:k,y:f,t:D,speed:Math.sqrt(K*K+H*H)});for(let S=0;S<a.verticesPerLine;S++){let [E,F]=b(k,f);E*=a.velocityScale;F*=a.velocityScale;const Q=Math.sqrt(E*E+F*F);if(Q<a.minSpeedThreshold)break;const V=E/Q,ba=F/Q;k+=V*a.segmentLength;f+=ba*a.segmentLength;D+=a.segmentLength/Q;if(Math.acos(V*P+ba*I)>a.maxTurnAngle)break;if(a.collisions){var P=Math.round(k*y);var I=Math.round(f*y);if(0>P||P>x-1||0>I||I>t-1)break;const da=e[I*x+P];if(-1!==da&&da!==c)break;e[I*x+P]=c}q.push({x:k,y:f,t:D,speed:Q});
P=V;I=ba}return q}function g(a,b,k,f){const c=[],e=new J,x=1/Math.max(a.lineCollisionWidth,1),t=Math.round(k*x),y=Math.round(f*x),q=new Int32Array(t*y);for(var D=0;D<q.length;D++)q[D]=-1;D=[];for(let K=0;K<f;K+=a.lineSpacing)for(let H=0;H<k;H+=a.lineSpacing)D.push({x:H,y:K,sort:e.getFloat()});D.sort((K,H)=>K.sort-H.sort);for(const {x:K,y:H}of D)e.getFloat()<a.density&&(k=l(a,b,K,H,c.length,q,t,y,x),2>k.length||c.push(k));return c}function h(a,b,k,f){if(0===f)return a;const c=Math.round(3*f),e=Array(2*
c+1);var x=0;for(var t=-c;t<=c;t++){var y=Math.exp(-t*t/(f*f));e[t+c]=y;x+=y}for(f=-c;f<=c;f++)e[f+c]/=x;x=new Float32Array(a.length);for(f=0;f<k;f++)for(t=0;t<b;t++){var q=y=0;for(var D=-c;D<=c;D++)if(!(0>t+D||t+D>=b)){var K=e[D+c];y+=K*a[2*(f*b+(t+D))];q+=K*a[2*(f*b+(t+D))+1]}x[2*(f*b+t)]=y;x[2*(f*b+t)+1]=q}a=new Float32Array(a.length);for(f=0;f<b;f++)for(t=0;t<k;t++){q=y=0;for(D=-c;D<=c;D++)0>t+D||t+D>=k||(K=e[D+c],y+=K*x[2*((t+D)*b+f)],q+=K*x[2*((t+D)*b+f)+1]);a[2*(t*b+f)]=y;a[2*(t*b+f)+1]=q}return a}
function d(a,b){const k=new J;var f=a.reduce((t,y)=>t+y.length,0);f=new Float32Array(4*f);const c=Array(a.length);let e=0,x=0;for(const t of a){a=e;for(const y of t)f[4*e]=y.x,f[4*e+1]=y.y,f[4*e+2]=y.t,f[4*e+3]=y.speed,e++;c[x++]={startVertex:a,numberOfVertices:t.length,totalTime:t[t.length-1].t,timeSeed:b?k.getFloat():0}}return{lineVertices:f,lineDescriptors:c}}function u(a,b){function k(P,I,S,E,F,Q,V,ba){const da=9*y;let X=0;t[da+X++]=P;t[da+X++]=I;t[da+X++]=1;t[da+X++]=S;t[da+X++]=Q;t[da+X++]=
V;t[da+X++]=E/2;t[da+X++]=F/2;t[da+X++]=ba;y++;t[da+X++]=P;t[da+X++]=I;t[da+X++]=-1;t[da+X++]=S;t[da+X++]=Q;t[da+X++]=V;t[da+X++]=-E/2;t[da+X++]=-F/2;t[da+X++]=ba;y++}const {lineVertices:f,lineDescriptors:c}=a;var e=a=0;for(var x of c)a+=2*x.numberOfVertices,e+=6*(x.numberOfVertices-1);const t=new Float32Array(9*a);x=new Uint32Array(e);let y=0;a=0;for(const P of c){const {totalTime:I,timeSeed:S}=P;let E=e=null,F=null;var q=null,D=null,K=null;for(let Q=0;Q<P.numberOfVertices;Q++){q=f[4*(P.startVertex+
Q)];const V=f[4*(P.startVertex+Q)+1],ba=f[4*(P.startVertex+Q)+2],da=f[4*(P.startVertex+Q)+3];let X=null,T=null;var H=null;let Y=null;0<Q&&(X=q-e,T=V-E,H=Math.sqrt(X*X+T*T),X/=H,T/=H,1<Q?(D=X+D,K=T+K,H=Math.sqrt(D*D+K*K),D/=H,K/=H,H=Math.min(1/(D*X+K*T),b),D*=H,K*=H,H=-K,Y=D):(H=-T,Y=X),null!==H&&null!==Y&&(k(e,E,F,H,Y,I,S,da),x[a++]=y-2,x[a++]=y,x[a++]=y-1,x[a++]=y,x[a++]=y+1,x[a++]=y-1));e=q;E=V;F=ba;D=X;K=T;q=da}k(e,E,F,-K,D,I,S,q)}return{vertexData:t,indexData:x}}function n(a){function b(ma,C){var O=
ba+X,N=da+T,W=Math.sqrt(O*O+N*N);O/=W;N/=W;var ca=ba*O+da*N,aa=X+Y,ea=T+ia;W=Math.sqrt(aa*aa+ea*ea);aa/=W;ea/=W;var ha=X*aa+T*ea;W=H;var ja=P,na=I,pa=S;N=-(N/ca);O/=ca;ca=E;var ra=F,sa=Q,qa=V;ea=-(ea/ha);aa/=ha;ha=16*D;let va=0;for(const ta of[1,2])for(const wa of[1,2,3,4])y[ha+va++]=W,y[ha+va++]=ja,y[ha+va++]=na,y[ha+va++]=pa,y[ha+va++]=ca,y[ha+va++]=ra,y[ha+va++]=sa,y[ha+va++]=qa,y[ha+va++]=ta,y[ha+va++]=wa,y[ha+va++]=ma,y[ha+va++]=C,y[ha+va++]=N/2,y[ha+va++]=O/2,y[ha+va++]=ea/2,y[ha+va++]=aa/2,
D++;q[K++]=D-8;q[K++]=D-7;q[K++]=D-6;q[K++]=D-7;q[K++]=D-5;q[K++]=D-6;q[K++]=D-4;q[K++]=D-3;q[K++]=D-2;q[K++]=D-3;q[K++]=D-1;q[K++]=D-2}function k(ma,C,O,N,W,ca){ba=X;da=T;X=Y;T=ia;null==ba&&null==da&&(ba=X,da=T);if(null!=E&&null!=F){Y=ma-E;ia=C-F;const aa=Math.sqrt(Y*Y+ia*ia);Y/=aa;ia/=aa}null!=ba&&null!=da&&b(W,ca);H=E;P=F;I=Q;S=V;E=ma;F=C;Q=O;V=N}function f(ma,C){ba=X;da=T;X=Y;T=ia;null==ba&&null==da&&(ba=X,da=T);null!=ba&&null!=da&&b(ma,C)}const {lineVertices:c,lineDescriptors:e}=a;let x=a=0;
for(var t of e){const ma=t.numberOfVertices-1;a+=8*ma;x+=12*ma}const y=new Float32Array(16*a),q=new Uint32Array(x);let D=0,K=0,H,P,I,S,E,F,Q,V,ba,da,X,T,Y,ia;for(const ma of e){ia=Y=T=X=da=ba=V=Q=F=E=S=I=P=H=null;const {totalTime:C,timeSeed:O}=ma;for(t=0;t<ma.numberOfVertices;t++)k(c[4*(ma.startVertex+t)],c[4*(ma.startVertex+t)+1],c[4*(ma.startVertex+t)+2],c[4*(ma.startVertex+t)+3],C,O);f(C,O)}return{vertexData:y,indexData:q}}function A(a,b){const k=b.pixels,{width:f,height:c}=b,e=new Float32Array(f*
c*2),x=b.mask||new Uint8Array(f*c*2);b.mask||x.fill(255);if("vector-uv"===a)for(a=0;a<f*c;a++)e[2*a]=k[0][a],e[2*a+1]=-k[1][a];else if("vector-magdir"===a)for(a=0;a<f*c;a++){b=k[0][a];const t=G.deg2rad(k[1][a]),y=Math.sin(t-Math.PI/2);e[2*a]=Math.cos(t-Math.PI/2)*b;e[2*a+1]=y*b}return{data:e,mask:x,width:f,height:c}}async function m(a,b,k,f,c,e){const x={requestProjectedLocalDirections:!0,signal:e};null!=c&&(x.timeExtent=c);if("imagery"===a.type)return await a.load({signal:e}),c=a.rasterInfo.dataType,
a=await a.fetchImage(b,k,f,x),null==a?.pixelData?.pixelBlock?{data:new Float32Array(k*f*2),mask:new Uint8Array(k*f),width:k,height:f}:A(c,a.pixelData.pixelBlock);await a.load({signal:e});c=a.serviceRasterInfo.dataType;a=await a.fetchPixels(b,k,f,x);return null==a?.pixelBlock?{data:new Float32Array(k*f*2),mask:new Uint8Array(k*f),width:k,height:f}:A(c,a.pixelBlock)}const v=()=>M.getLogger("esri.views.2d.engine.flow.dataUtils");p.createAnimatedLinesData=d;p.createFlowMesh=async function(a,b,k,f){const c=
performance.now();var e=z(b,k);const x=performance.now();k=g(b,e,k.width,k.height);b=performance.now();e=d(k,!0);k=performance.now();a="Streamlines"===a?u(e,10):n(e);e=performance.now();r("esri-2d-profiler")&&(v().info("I.1","_createFlowFieldFromData (ms)",Math.round(x-c)),v().info("I.2","_getStreamlines (ms)",Math.round(b-x)),v().info("I.3","createAnimatedLinesData (ms)",Math.round(k-b)),v().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(e-k)),v().info("I.5","createFlowMesh (ms)",
Math.round(e-c)),v().info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();R.throwIfAborted(f);return a};p.createParticlesMesh=n;p.createStreamlinesMesh=u;p.loadImagery=async function(a,b,k,f,c,e){const x=performance.now();var t=L.getInfo(b.spatialReference);if(!t)return k=await m(a,b,k,f,c,e),r("esri-2d-profiler")&&v().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-x)),r("esri-2d-profiler")&&v().info("I.9","Number of parts",
1),k;const [y,q]=t.valid,D=Math.ceil(b.width/(q-y)),K=b.width/D,H=Math.round(k/D);let P=b.xmin;const I=[];t=performance.now();for(let S=0;S<D;S++){const E=new B({xmin:P,xmax:P+K,ymin:b.ymin,ymax:b.ymax,spatialReference:b.spatialReference});I.push(m(a,E,H,f,c,e));P+=K}a=await Promise.all(I);r("esri-2d-profiler")&&v().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-t));r("esri-2d-profiler")&&v().info("I.9","Number of parts",a.length);f={data:new Float32Array(k*f*2),mask:new Uint8Array(k*
f),width:k,height:f};b=0;for(const S of a){for(a=0;a<S.height;a++)for(c=0;c<S.width;c++)b+c>=k||(f.data[2*(a*k+b+c)]=S.data[2*(a*S.width+c)],f.data[2*(a*k+b+c)+1]=S.data[2*(a*S.width+c)+1],f.mask[a*k+b+c]=S.mask[a*S.width+c]);b+=S.width}r("esri-2d-profiler")&&v().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-x));return f};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../geometry ../../geometry/support/GeographicTransformation ./PixelBlock ./rasterFormats/RasterCodec ./rasterFunctions/pixelUtils ./rasterFunctions/rasterFunctionHelper ./rasterFunctions/rasterProjectionHelper ./rasterFunctions/stretchUtils ./rasterFunctions/vectorFieldUtils ./rasterTransforms/utils ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/Point".split(" "),function(p,w,r,M,G,R,J,L,B,z,l,g,h,d){class u{convertVectorFieldData(n){const A=
r.fromJSON(n.pixelBlock);n=B.convertVectorFieldData(A,n.type);return Promise.resolve(null!=n?n.toJSON():null)}computeStatisticsHistograms(n){n=r.fromJSON(n.pixelBlock);n=L.computeStatisticsHistograms(n);return Promise.resolve(n)}async decode(n){return(n=await M.decode(n.data,n.options))&&n.toJSON()}symbolize(n){n.pixelBlock=r.fromJSON(n.pixelBlock);n.extent=n.extent?h.fromJSON(n.extent):null;n=this.symbolizer.symbolize(n);return Promise.resolve(null!=n?n.toJSON():null)}async updateSymbolizer(n){this.symbolizer=
l.fromJSON(n.symbolizerJSON);n.histograms&&"rasterStretch"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=n.histograms)}async updateRasterFunction(n){this.rasterFunction=R.create(n.rasterFunctionJSON)}async process(n){n=this.rasterFunction.process({extent:h.fromJSON(n.extent),primaryPixelBlocks:n.primaryPixelBlocks.map(A=>null!=A?r.fromJSON(A):null),primaryPixelSizes:n.primaryPixelSizes?.map(A=>null!=A?d.fromJSON(A):null),primaryRasterIds:n.primaryRasterIds});return null!=
n?n.toJSON():null}stretch(n){n=this.symbolizer.simpleStretch(r.fromJSON(n.srcPixelBlock),n.stretchParams);return Promise.resolve(n?.toJSON())}estimateStatisticsHistograms(n){n=L.estimateStatisticsHistograms(r.fromJSON(n.srcPixelBlock));return Promise.resolve(n)}split(n){const A=G.split(r.fromJSON(n.srcPixelBlock),n.tileSize,n.maximumPyramidLevel??0,!1===n.useBilinear);A&&A.forEach((m,v)=>{A.set(v,m?.toJSON())});return Promise.resolve(A)}clipTile(n){const A=r.fromJSON(n.pixelBlock);n=G.clipTile({...n,
pixelBlock:A});return Promise.resolve(n?.toJSON())}async mosaicAndTransform(n){var A=n.srcPixelBlocks.map(a=>a?new r(a):null);let m=A=G.mosaic(A,n.srcMosaicSize,{blockWidths:n.blockWidths,alignmentInfo:n.alignmentInfo,clipOffset:n.clipOffset,clipSize:n.clipSize});n.coefs&&(m=G.approximateTransform(A,n.destDimension,n.coefs,n.sampleSpacing,n.interpolation));let v;n.projectDirections&&n.gcsGrid&&(v=G.getLocalArithmeticNorthRotations(n.destDimension,n.gcsGrid),m=B.convertToLocalDirections(m,n.isUV?"vector-uv":
"vector-magdir",v));return{pixelBlock:m?.toJSON(),localNorthDirections:v}}async createFlowMesh(n,A){const m={data:new Float32Array(n.flowData.buffer),mask:new Uint8Array(n.flowData.maskBuffer),width:n.flowData.width,height:n.flowData.height},{vertexData:v,indexData:a}=await g.createFlowMesh(n.meshType,n.simulationSettings,m,A.signal);return{result:{vertexBuffer:v.buffer,indexBuffer:a.buffer},transferList:[v.buffer,a.buffer]}}async getProjectionOffsetGrid(n){const A=h.fromJSON(n.projectedExtent),m=
h.fromJSON(n.srcBufferExtent);let v=null;n.datumTransformationSteps&&(v=new w({steps:n.datumTransformationSteps}));(n.includeGCSGrid||J.requirePE(A.spatialReference,m.spatialReference,v))&&await J.load();const a=n.rasterTransform?z.readTransform(n.rasterTransform):null;return J.getProjectionOffsetGrid({...n,projectedExtent:A,srcBufferExtent:m,datumTransformation:v,rasterTransform:a})}}return u});