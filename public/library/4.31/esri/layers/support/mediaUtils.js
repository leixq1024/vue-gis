// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../geometry ../../core/screenUtils ../../core/accessorSupport/PropertyOrigin ../../geometry/support/spatialReferenceUtils ./ControlPointsGeoreference ./CornersGeoreference ./ExtentAndRotationGeoreference ./GeoreferenceBase ../../geometry/Extent ../../geometry/Point".split(" "),function(l,r,p,t,A,m,q,B,u,C,k){function v(a,b){b=t.nameToId(b);return"media"===a?.type&&!!a.portalItem&&null!=b&&b>t.OriginId.PORTAL_ITEM}function w(a,b,d){return{enabled:!v(d?.layer,d?.origin),ignoreOrigin:!0}}
r={json:{name:"url",type:String,write:{overridePolicy:w}}};const D={readOnly:!0,json:{read:!1,write:{target:"mediaType",overridePolicy:w}}};q={types:{key:"type",base:u,typeMap:{"control-points":m,corners:q,"extent-and-rotation":B}},json:{types:{key:"type",base:u,typeMap:{"control-points":m}},write:{overridePolicy(){return{enabled:!0,ignoreOrigin:!0}}}}};l.createDefaultControlPointsGeoreference=async function(a,b){a.loaded||await a.load();const {contentWidth:d,contentHeight:f}=a;({spatialReference:a}=
b);var c=A.getInfo(a),e=!1;c&&b.width>c.valid[1]-c.valid[0]&&(b=new C({xmin:c.valid[0],ymin:b.ymin,xmax:c.valid[1],ymax:b.ymax,spatialReference:b.spatialReference}),e=!0);b=b.expand(.5);const {center:g,width:x,height:y}=b;c=d/f;var h=e||1<c;e=h?100:100*c;b=h?100/c:100;var n=h?x:y*c;h=h?x/c:y;c=g.x-n/2;n=g.x+n/2;const z=g.y+h/2;h=g.y-h/2;return new m({controlPoints:[{sourcePoint:{x:e,y:f-b},mapPoint:new k({x:c,y:h,spatialReference:a})},{sourcePoint:{x:e,y:b},mapPoint:new k({x:c,y:z,spatialReference:a})},
{sourcePoint:{x:d-e,y:b},mapPoint:new k({x:n,y:z,spatialReference:a})},{sourcePoint:{x:d-e,y:f-b},mapPoint:new k({x:n,y:h,spatialReference:a})}],width:d,height:f})};l.createLocalModeControlPointsGeoreference=function(a){a=a.georeference;if("control-points"!==a.type)return null;const b={wkid:0},{width:d,height:f}=a;return new m({controlPoints:a.controlPoints.map(c=>{const {x:e,y:g}=c.sourcePoint;return{sourcePoint:{x:e,y:g},mapPoint:new k({x:e,y:f-g,spatialReference:b})}}),width:d,height:f})};l.isWritingLayerFromItemToWebDocument=
v;l.mediaElementUrlProperty=r;l.mediaGeoreferenceProperty=q;l.mediaTypeProperty=D;l.toControlPointsGeoreference=function(a,b,d){if(!a||"control-points"===a.type)return a;({coords:a}=a);if(5!==a?.rings[0]?.length)return null;const [f,c,e,g]=a.rings[0];({spatialReference:a}=a);return new m({controlPoints:[{mapPoint:new k({x:f[0],y:f[1],spatialReference:a}),sourcePoint:p.createScreenPoint(0,d)},{mapPoint:new k({x:c[0],y:c[1],spatialReference:a}),sourcePoint:p.createScreenPoint(0,0)},{mapPoint:new k({x:e[0],
y:e[1],spatialReference:a}),sourcePoint:p.createScreenPoint(b,0)},{mapPoint:new k({x:g[0],y:g[1],spatialReference:a}),sourcePoint:p.createScreenPoint(b,d)}],width:b,height:d})};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});