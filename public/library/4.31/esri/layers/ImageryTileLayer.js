// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ImageryTileMixin":function(){define("exports ../../chunks/tslib.es6 ../../geometry ../../rasterRenderers ../../request ../../core/deprecate ../../core/Error ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/support/spatialReferenceUtils ../support/arcgisLayerUrl ../support/commonProperties ../support/DimensionalDefinition ../support/MultidimensionalSubset ../support/rasterEnums ../support/RasterFunction ../support/RasterJobHandler ../support/TileInfo ../support/rasterDatasets/FunctionRaster ../support/rasterDatasets/multidimensionalUtils ../support/rasterFunctions/clipUtils ../support/rasterFunctions/rasterFunctionHelper ../support/rasterFunctions/rasterProjectionHelper ../support/rasterFunctions/stretchUtils ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../rest/support/ImageHistogramParameters ../../views/2d/engine/flow/dataUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b,g,z,v,C,y,A,x,E,N,G,O,H,J){p.ImageryTileMixin=R=>{function Y(T){if(!T.raster||!T.serviceRasterInfo)throw new M("imagery-tile","no raster");}R=class extends R{constructor(...T){super(...T);this._isConstructedFromFunctionRaster=!1;this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};this.symbolizer=this.spatialReference=this.sourceJSON=this.serviceRasterInfo=this.raster=this.multidimensionalSubset=this.interpolation=this.copyright=
this.bandIds=null;this._isConstructedFromFunctionRaster="Function"===T[0]?.raster?.datasetFormat}get fullExtent(){return this.serviceRasterInfo?.extent}set multidimensionalDefinition(T){this._set("multidimensionalDefinition",T);this.updateRenderer()}set rasterFunction(T){"none"===T?.functionName?.toLowerCase()&&(T=void 0);this._set("rasterFunction",T);this.updateRasterFunction()}get rasterInfo(){P.deprecatedProperty(Q.getLogger(this),"rasterInfo",{replacement:"serviceRasterInfo",version:"4.29",warnOnce:!0});
return this._get("serviceRasterInfo")}set url(T){this._set("url",w.sanitizeUrl(T,Q.getLogger(this)))}get renderer(){if("imagery-tile"!==this.type)return this.internalRenderer;const {activePresetRendererName:T,presetRenderers:X}=this;return T?X?.find(({name:V})=>V===T)?.renderer.clone():this.internalRenderer}set renderer(T){"imagery-tile"===this.type&&(this.activePresetRendererName=null);this.internalRenderer=T}set internalRenderer(T){null==T&&null==this.rasterFunction?this._configDefaultRenderer("override"):
(this._set("internalRenderer",T),this.updateRenderer())}readRenderer(T,X,V){return L.read(X?.layerDefinition?.drawingInfo?.renderer,V)||void 0}async convertVectorFieldData(T,X){var {serviceRasterInfo:V}=this;if(null==T||!V)return null;const K=this._rasterJobHandler.instance;V=V.dataType;return K?K.convertVectorFieldData({pixelBlock:T,dataType:V},X):x.convertVectorFieldData(T,V)}async computeStatisticsHistograms(T,X){await this.load(X);T=D.ensureClass(G,T).clone();var {serviceRasterInfo:V}=this;if(null==
V)throw new M("imagery-tile-mixin:compute-statistics-histograms","serviceRasterInfo must be specified");const {geometry:K}=T;if(null==K)throw new M("imagery-tile-mixin:compute-statistics-histograms","geometry must be specified");var S=K;const {spatialReference:Z}=V;K.spatialReference.equals(Z)||(await y.load(),S="extent"===K.type?y.projectExtent(K,Z):y.projectPolygon(K,Z));T=T.pixelSize??new J({x:V.pixelSize.x,y:V.pixelSize.y,spatialReference:Z});const {extent:ca,width:I,height:U}=v.snapToRaster(V,
S,T);V=await this.fetchPixels(ca,I,U,{...X,interpolation:"nearest"});if(null==V.pixelBlock)throw new M("imagery-tile-mixin:compute-statistics-histograms","failed to fetch pixels");S=await v.clip(V.pixelBlock,ca,S);return(V=this._rasterJobHandler.instance)?V.computeStatisticsHistograms({pixelBlock:S},X):A.computeStatisticsHistograms(S)}async createFlowMesh(T,X){const V=this._rasterJobHandler.instance;return V?V.createFlowMesh(T,X):O.createFlowMesh(T.meshType,T.simulationSettings,T.flowData,null!=X.signal?
X.signal:(new AbortController).signal)}normalizeRasterFetchOptions(T){var {multidimensionalInfo:X}=this.serviceRasterInfo??{};if(null==X)return T;let V=T.multidimensionalDefinition||this.multidimensionalDefinition;V?.length||(V=z.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));var K=T.timeExtent||this.timeExtent;if(null!=V&&null!=K&&(null!=K.start||null!=K.end)){V=V.map(aa=>aa.clone());var S=X.variables.find(({name:aa})=>aa===V[0].variableName)?.dimensions?.find(({name:aa})=>
"StdTime"===aa);X=V.find(({dimensionName:aa})=>"StdTime"===aa);if(!S||!X)return{...T,multidimensionalDefinition:null};const {start:Z,end:ca}=K;K=null==Z?null:Z.getTime();const I=null==ca?null:ca.getTime(),U=K??I,W=I??K;if(null!=S.values)S=S.values.filter(aa=>{if(Array.isArray(aa)){if(U===W)return aa[0]<=U&&aa[1]>=U;const da=aa[0]>=U&&aa[1]<=W||aa[0]<U&&aa[1]>W;return aa[0]<=U&&aa[1]>U||aa[0]<W&&aa[1]>=W||da}return U===W?aa===U:aa>=U&&aa<=W}),S.length?(S=S.sort((aa,da)=>{const ea=Array.isArray(aa)?
aa[0]:aa;aa=Array.isArray(aa)?aa[1]:aa;const ha=Array.isArray(da)?da[0]:da;da=Array.isArray(da)?da[1]:da;return U===W?ea-ha:Math.abs(aa-W)-Math.abs(da-W)})[0],X.values=[S]):V=null;else if(S.hasRegularIntervals&&S.extent){const [aa,da]=S.extent;U>da||W<aa?V=null:X.values=U===W?[U]:[Math.max(aa,U),Math.min(da,W)]}}return null!=V&&z.hasExcludedVariableOrDimension(V,this.multidimensionalSubset)?{...T,multidimensionalDefinition:null}:{...T,multidimensionalDefinition:V}}async updateRasterFunction(){if(this.loaded&&
"imagery-tile"===this.type&&(this.rasterFunction||this._cachedRasterFunctionJson)&&JSON.stringify(this.rasterFunction)!==JSON.stringify(this._cachedRasterFunctionJson))if(this._isConstructedFromFunctionRaster&&"Function"===this.raster.datasetFormat){var T=this.raster.rasterFunction.toJSON();!this.rasterFunction&&T&&this._set("rasterFunction",l.fromJSON(T));this._cachedRasterFunctionJson=this.rasterFunction?.toJSON()}else{var X=this.raster;T=!1;if("Function"===X.datasetFormat){var V=X.primaryRasters.rasters;
X=V[0];T=!0}else V=[X];var {rasterFunction:K}=this;if(K){const Z={raster:X};1<V.length&&V.forEach(ca=>Z[ca.url]=ca);X=C.create(K.functionDefinition?.toJSON()??K.toJSON(),Z);X=new g({rasterFunction:X});X.rasterJobHandler=this._rasterJobHandler.instance;await X.open();this._cachedRasterFunctionJson=this.rasterFunction?.toJSON();this.raster=X}else this.raster=X,this._cachedRasterFunctionJson=null,await X.open();this._cachedRendererJson=null;if(T||K){({bandIds:T}=this);var {bandCount:S}=this.raster.rasterInfo;
K=T?.length?T.some(Z=>Z>=S):3<=S;T&&(K||this.renderer&&"raster-stretch"!==this.renderer.type)&&this._set("bandIds",null);this._configDefaultRenderer("auto")}}}async updateRenderer(){const {loaded:T,symbolizer:X}=this;if(T&&X&&this.renderer){var {rasterInfo:V}=this.raster,K=z.getDefaultVariableInfo(V,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,S=E.normalizeRendererJSON({...this.renderer.toJSON(),variableName:K});if(JSON.stringify(this._cachedRendererJson)!==
JSON.stringify(S)){var Z=this._rasterJobHandler.instance;Z&&(X.rasterInfo=E.getVariableRasterInfo(V,K),X.rendererJSON=S,X.bind(),await Z.updateSymbolizer(X),this._cachedRendererJson=S)}}}async applyRenderer(T,X){var V=T?.pixelBlock;if(!(null!=V&&V.pixels&&0<V.pixels.length))return null;await this.updateRenderer();V=this._rasterJobHandler.instance;const K=this.bandIds??[];return V?await V.symbolize({...T,simpleStretchParams:X,bandIds:K}):this.symbolizer.symbolize({...T,simpleStretchParams:X,bandIds:K})}getTileUrl(T,
X,V){return"RasterTileServer"===this.raster.datasetFormat?`${this.url}/tile/${T}/${X}/${V}`:""}getCompatibleTileInfo(T,X,V=!1){if(!this.loaded||null==X)return null;if(V&&T.equals(this.spatialReference))return this.tileInfo;V=m.getInfo(T);return b.create({size:256,spatialReference:T,origin:V?{x:V.origin[0],y:V.origin[1]}:{x:X.xmin,y:X.ymax}})}getCompatibleFullExtent(T){return this.loaded?this._compatibleFullExtent?.spatialReference.equals(T)?this._compatibleFullExtent:this._compatibleFullExtent=this.raster.computeExtent(T):
null}async fetchTile(T,X,V,K={}){Y(this);if(K.requestAsImageElement)return T=this.getTileUrl(T,X,V),F(T,{responseType:"image",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:K.signal}).then(Z=>Z.data);const {serviceRasterInfo:S}=this;if(null!=S.multidimensionalInfo&&(K=this.normalizeRasterFetchOptions(K),null==K.multidimensionalDefinition))return{extent:this.raster.getTileExtentFromTileInfo(T,X,V,K.tileInfo||S.storageInfo.tileInfo),pixelBlock:null};await this._initJobHandler();
await this.updateRasterFunction();"raster-shaded-relief"===this.renderer?.type&&(K={...K,buffer:{cols:1,rows:1}});return this.raster.fetchTile(T,X,V,K)}async fetchPixels(T,X,V,K={}){if(null!=this.serviceRasterInfo.multidimensionalInfo&&(K=this.normalizeRasterFetchOptions(K),null==K.multidimensionalDefinition))return{extent:T,pixelBlock:null};await this._initJobHandler();await this.updateRasterFunction();X=Math.round(X);V=Math.round(V);return this.raster.fetchPixels(T,X,V,K)}async identify(T,X={}){await this.load();
const {raster:V,serviceRasterInfo:K}=this;if(!(null==K?.multidimensionalInfo||K.hasMultidimensionalTranspose&&(z.isMultiSliceOrRangeDefinition(X.multidimensionalDefinition)||X.transposedVariableName||X.timeExtent))&&(X=this.normalizeRasterFetchOptions(X),null==X.multidimensionalDefinition))return{location:T,value:null};const S=this.multidimensionalSubset?.areaOfInterest;if(S&&!S.contains(T))throw new M("imagery-tile-mixin:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");
return V.identify(T,X)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()}hasStandardTime(){const T=this.serviceRasterInfo?.multidimensionalInfo;if(null==T||"standard-time"!==this.serviceRasterInfo?.dataType)return!1;const X=this.multidimensionalDefinition,V=X?.[0]?.variableName;return T.variables.some(K=>K.name===V&&(!X?.[0].dimensionName||K.dimensions.some(S=>
"StdTime"===S.name)))}getStandardTimeValue(T){return(new Date(864E5*(T-25569))).toString()}getMultidimensionalSubsetVariables(T){return z.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,T??this.serviceRasterInfo?.multidimensionalInfo)}_configDefaultSettings(){this._configDefaultInterpolation();this.multidimensionalDefinition||(this.multidimensionalDefinition=z.getDefaultMultidimensionalDefinition(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));this.rasterFunction&&
"Function"===this.raster.datasetFormat&&(this._cachedRasterFunctionJson=this.rasterFunction.toJSON());this._configDefaultRenderer()}_initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const T=new d;this._rasterJobHandler.connectionPromise=T.initialize().then(async()=>{Y(this);this._rasterJobHandler.instance=T;this.raster.rasterJobHandler=T;"Function"===this.raster.datasetFormat&&this.raster.syncJobHandler();this.rasterFunction&&await this.updateRasterFunction().catch(()=>
{});this.renderer&&this.updateRenderer()}).catch(()=>{});return this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null;this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){if(null==this.interpolation){Y(this);var {raster:T}=this;T=E.getDefaultInterpolation(T.rasterInfo,
T.tileType,this.sourceJSON?.defaultResamplingMethod);this._set("interpolation",T)}}_configDefaultRenderer(T="no"){Y(this);var {rasterInfo:X}=this.raster,V=z.getDefaultVariableInfo(X,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,K=E.matchPresetRenderer({variableName:V,rasterFunctionName:this.rasterFunction?.functionName,presetRenderers:this.presetRenderers});!this.bandIds&&1<X.bandCount&&(this.bandIds=K?.bandIds??E.getDefaultBandCombination(X));
if(!this.renderer||"override"===T){var S=E.getFunctionColorRamp(this.raster);K=K?.renderer??E.createDefaultRenderer(X,{bandIds:this.bandIds,variableName:V,rasterFunctionColorRamp:S});S=(S=X.statistics)&&0<S.length?S[0]:null;"WCSServer"===this.raster.datasetFormat&&"raster-stretch"===K.type&&(1E24<(S?.max??0)||-1E24>(S?.min??0))&&(K.dynamicRangeAdjustment=!0,K.customStatistics=null,"none"===K.stretchType&&(K.stretchType="min-max"));this.renderer=K}K=E.normalizeRendererJSON({...this.renderer.toJSON(),
variableName:V});X=E.getVariableRasterInfo(X,V);this.symbolizer?(this.symbolizer.rendererJSON=K,this.symbolizer.rasterInfo=X):this.symbolizer=new N({rendererJSON:K,rasterInfo:X});X=this.symbolizer.bind();X.success?"auto"===T&&({colormap:X}=this.raster.rasterInfo,T=this.renderer,null!=X&&"raster-colormap"===T.type?(X=E.createDefaultRenderer(this.raster.rasterInfo),JSON.stringify(X)!==JSON.stringify(T)&&this._configDefaultRenderer("override")):"raster-stretch"===T.type&&(X=this.bandIds?.length,V=T.customStatistics?.length,
!T.dynamicRangeAdjustment&&V&&X&&V!==X&&this._configDefaultRenderer("override"))):(Q.getLogger(this).warn("imagery-tile-mixin",X.error||"The given renderer is not supported by the layer."),"auto"===T&&this._configDefaultRenderer("override"))}};u.__decorate([B.property({clonable:!1})],R.prototype,"_cachedRendererJson",void 0);u.__decorate([B.property({clonable:!1})],R.prototype,"_cachedRasterFunctionJson",void 0);u.__decorate([B.property({clonable:!1})],R.prototype,"_compatibleFullExtent",void 0);
u.__decorate([B.property({clonable:!1})],R.prototype,"_isConstructedFromFunctionRaster",void 0);u.__decorate([B.property({clonable:!1})],R.prototype,"_rasterJobHandler",void 0);u.__decorate([B.property({type:[D.Integer],json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"0,1,2"!==this.bandIds?.join(",")}}}}})],R.prototype,"bandIds",void 0);u.__decorate([B.property({json:{origins:{service:{read:{source:"copyrightText"}}}}})],R.prototype,"copyright",void 0);
u.__decorate([B.property({json:{read:!1}})],R.prototype,"fullExtent",null);u.__decorate([B.property({json:{write:{overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType||"bilinear"!==this.interpolation}}}}}),e.enumeration(f.interpolationKebab)],R.prototype,"interpolation",void 0);u.__decorate([B.property()],R.prototype,"ioConfig",void 0);u.__decorate([B.property({type:[r],json:{write:!0}})],R.prototype,"multidimensionalDefinition",null);u.__decorate([B.property({type:a,json:{write:!0}})],
R.prototype,"multidimensionalSubset",void 0);u.__decorate([B.property()],R.prototype,"raster",void 0);u.__decorate([B.property({type:l,json:{name:"renderingRule",write:!0}})],R.prototype,"rasterFunction",null);u.__decorate([B.property({readOnly:!0})],R.prototype,"rasterInfo",null);u.__decorate([B.property()],R.prototype,"serviceRasterInfo",void 0);u.__decorate([B.property()],R.prototype,"sourceJSON",void 0);u.__decorate([B.property({readOnly:!0,type:H,json:{read:!1}})],R.prototype,"spatialReference",
void 0);u.__decorate([B.property({type:b})],R.prototype,"tileInfo",void 0);u.__decorate([B.property(k.url)],R.prototype,"url",null);u.__decorate([B.property()],R.prototype,"renderer",null);u.__decorate([B.property({types:L.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(){const T="raster-stretch"===this.renderer?.type&&"none"===this.renderer.stretchType&&!this.renderer.useGamma;return{enabled:!this.loaded||"Raster"===this.raster.tileType||!T}}},origins:{"web-scene":{types:L.websceneRasterRendererTypes,
name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(T){return{enabled:T&&"vector-field"!==T.type&&"flow"!==T.type}}}}}}})],R.prototype,"internalRenderer",null);u.__decorate([n.reader("internalRenderer")],R.prototype,"readRenderer",null);u.__decorate([B.property({clonable:!1})],R.prototype,"symbolizer",void 0);return R=u.__decorate([h.subclass("esri.layers.mixins.ImageryTileMixin")],R)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),
function(p,u,t,L,F,P,M,Q,B){function D(n,h){if(!n)return null;if("classBreaks"===n.type&&n.classificationMethod){var m=n.authoringInfo||{classificationMethod:""};m.classificationMethod=n.classificationMethod;n.authoringInfo=m}"vectorField"===n.type&&n.visualVariables&&!Array.isArray(n.visualVariables)&&(n.visualVariables=[n.visualVariables]);m=n?e[n.type]||null:null;if(m)return m=new m,m.read(n,h),m;h?.messages&&n&&h.messages.push(new u("renderer:unsupported","Renderers of type '"+(n.type||"unknown")+
"' are not supported",{definition:n,context:h}));return null}const q={key:"type",base:null,typeMap:{"unique-value":Q,"class-breaks":t,"raster-colormap":F,"raster-stretch":M,"vector-field":B,"raster-shaded-relief":P,flow:L}},c={...q,typeMap:{...q.typeMap}};delete c.typeMap["vector-field"];delete c.typeMap.flow;const e={uniqueValue:Q,classBreaks:t,rasterStretch:M,rasterColormap:F,vectorField:B,rasterShadedRelief:P,flowRenderer:L};p.ClassBreaksRenderer=t;p.FlowRenderer=L;p.RasterColormapRenderer=F;p.RasterShadedReliefRenderer=
P;p.RasterStretchRenderer=M;p.UniqueValueRenderer=Q;p.VectorFieldRenderer=B;p.fromJSON=function(n,h){return D(n,h)};p.rasterRendererTypes=q;p.read=D;p.websceneRasterRendererTypes=c;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/RendererLegendOptions".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n){var h;t=new t.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});L=h=class extends c.VisualVariablesMixin(L.JSONSupport){constructor(m){super(m);this.density=.8;this.color=new u([255,255,255,1]);this.maxPathLength=200;this.trailWidth=1.5;this.flowSpeed=10;this.trailLength=100;this.smoothing=0;this.flowRepresentation="flow-from";this.type="flow";this.legendOptions=this.authoringInfo=null;this.trailCap="butt";this.background="none"}clone(){const {density:m,maxPathLength:w,
trailWidth:k,flowSpeed:r,trailLength:a,smoothing:f,flowRepresentation:l,trailCap:d,background:b}=this,g=this.color.clone(),z=(this.visualVariables||[]).map(y=>y.clone()),v=this.authoringInfo?.clone(),C=this.legendOptions?.clone();return new h({density:m,color:g,maxPathLength:w,trailWidth:k,flowSpeed:r,trailLength:a,trailCap:d,background:b,smoothing:f,flowRepresentation:l,visualVariables:z,authoringInfo:v,legendOptions:C})}getSymbol(m,w){}async getSymbolAsync(m,w){}getSymbols(){return[]}};p.__decorate([P.property({type:Number,
json:{write:!0}})],L.prototype,"density",void 0);p.__decorate([P.property({type:u,json:{write:{allowNull:!0}}})],L.prototype,"color",void 0);p.__decorate([P.property({type:Number,cast:F.toPt,json:{write:!0}})],L.prototype,"maxPathLength",void 0);p.__decorate([P.property({type:Number,cast:F.toPt,json:{write:!0}})],L.prototype,"trailWidth",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],L.prototype,"flowSpeed",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],L.prototype,
"trailLength",void 0);p.__decorate([P.property({type:Number,cast:F.toPt,json:{write:!1}})],L.prototype,"smoothing",void 0);p.__decorate([P.property({type:t.apiValues,json:{type:t.jsonValues,read:{reader:t.read},write:{writer:t.write}}})],L.prototype,"flowRepresentation",void 0);p.__decorate([D.enumeration({flowRenderer:"flow"})],L.prototype,"type",void 0);p.__decorate([P.property({type:e,json:{write:!0}})],L.prototype,"authoringInfo",void 0);p.__decorate([P.property({type:n,json:{write:!0}})],L.prototype,
"legendOptions",void 0);p.__decorate([P.property({type:String,json:{write:!0}})],L.prototype,"trailCap",void 0);p.__decorate([P.property({type:String,json:{write:!0}})],L.prototype,"background",void 0);return L=h=p.__decorate([q.subclass("esri.renderers.FlowRenderer")],L)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){var q;u=q=class extends u.JSONSupport{constructor(c){super(c);this.colormapInfos=null;this.type="raster-colormap"}static createFromColormap(c,e){if(!c)return null;const n=5===c[0].length;c=[...c].sort((h,m)=>h[0]-m[0]).map(h=>B.fromJSON({value:h[0],color:n?h.slice(1,5):h.slice(1,4).concat([255]),label:e?e[h[0]]??"":h[0]}));return new q({colormapInfos:c})}static createFromColorramp(c){c=D.convertColorRampToColormap(c);return q.createFromColormap(c)}clone(){return new q({colormapInfos:this.colormapInfos.map(c=>
c.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:c,color:e})=>[c,e.r,e.g,e.b,1<e.a?e.a:255*e.a&255]).sort((c,e)=>c[0]-e[0])}};p.__decorate([t.property({type:[B],json:{write:!0}})],u.prototype,"colormapInfos",void 0);p.__decorate([M.enumeration({rasterColormap:"raster-colormap"})],u.prototype,"type",void 0);return u=q=p.__decorate([Q.subclass("esri.renderers.RasterColormapRenderer")],u)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,u,t,L,F,P,M,Q){t=class extends t.JSONSupport{constructor(){super(...arguments);this.color=this.label=this.value=null}};p.__decorate([L.property({type:Number,json:{write:!0}})],t.prototype,"value",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"label",void 0);p.__decorate([L.property({type:u,json:{type:[F.Integer],write:!0}})],t.prototype,"color",void 0);return t=p.__decorate([Q.subclass("esri.renderers.support.ColormapInfo")],t)})},"esri/renderers/support/colorRampUtils":function(){define(["exports",
"../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(p,u,t,L,F){function P(a,f){if(!a||!f||a.length!==f.length)return!1;for(let l=0;l<a.length;l++)if(a[l]>f[l]+2||a[l]<f[l]-2)return!1;return!0}function M(a){const f=a.clone();f.fromColor=a.toColor;f.toColor=a.fromColor;f.algorithm=a.algorithm;return f}function Q(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(f=>M(f));return a}return M(a)}function B(a,
f){if(a){f=f??k;var l=null;"algorithmic"===a.type?f.some(d=>{if(P(a.fromColor.toRgb(),d.fromColor)&&P(a.toColor.toRgb(),d.toColor))return l=d.id,!0}):"multipart"===a.type&&f.some(d=>{const b=a.colorRamps,g=d.colorRamps;if(b&&g&&b.length===g.length&&!g.some((z,v)=>{if(!P(b[v].fromColor.toRgb(),(new u(z.fromColor)).toRgb())||!P(b[v].toColor.toRgb(),(new u(z.toColor)).toRgb()))return!0})){if(l)return!0;l=d.id}});return l}}function D(a,f,l=!1){if(a){var d=!1,b=B(a,f);null!=b||l||(d=!0,a=Q(a),b=B(a,f));
return b?{id:b,inverted:d}:void 0}}function q(a,f=!1){return(a="string"===typeof a?a:D(a,void 0,f)?.id)?r.toJSON(a):null}function c(a){a=a||{};const f=a.numColors||256;return{...a,numColors:f,distanceOffset:a.distanceOffset||0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(f-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(f-1),weights:a.weights}}function e(a,f){let {fromColor:l,toColor:d}=a;l=[...l];
d=[...d];3===l.length&&(l=l.concat([255]));3===d.length&&(d=d.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var b=c(f);const {numColors:g,distanceOffset:z,isCustomInterval:v,interpolateAlpha:C}=b;if(1===g&&0===z)return[l];if(2===g&&0===z&&!v)return[l,d];var y={r:l[0],g:l[1],b:l[2]};f={r:d[0],g:d[1],b:d[2]};if("esriCIELabAlgorithm"===a){a=t.toLAB(y);f=t.toLAB(f);const {numColors:N,distanceOffset:G,distanceInterval:O,isCustomInterval:H}=b;let {l:J,a:R,b:Y}=a;a=(f.l-J)*O;y=(f.a-R)*O;b=(f.b-Y)*
O;var A=[];if(G){var x=G/O;J+=x*a;R+=x*y;Y+=x*b}for(x=0;x<N-1;x++)A.push({l:J,a:R,b:Y}),J+=a,R+=y,Y+=b;A.push(H?{l:J,a:R,b:Y}:f);f=A}else if("esriHSVAlgorithm"===a){a=t.toHSV(y);f=t.toHSV(f);const {numColors:N,distanceOffset:G,distanceInterval:O,isCustomInterval:H}=b;A=0===a.s;x=0===f.s;y=a.h;b=f.h;A&&!x?y=b:x&&!A&&(f={...f,h:y},b=y);A=Math.abs(b-y);180>A?b=(b-y)*O:(A=360-A,b=y>b?A*O:-A*O);A=(f.s-a.s)*O;x=(f.v-a.v)*O;let {s:J,v:R}=a;a=y;G&&(y=G/O,a=(a+y*b+360)%360,J+=y*A,R+=y*x);y=[];for(var E=0;E<
N-1;E++)y.push({h:a,s:J,v:R}),a=(a+b+360)%360,J+=A,R+=x;y.push(H?{h:a,s:J,v:R}:f);f=y}else{y=t.toLCH(y);f=t.toLCH(f);const {numColors:N,distanceOffset:G,distanceInterval:O,isCustomInterval:H}=b;b=y.h;A=f.h;a=2*Math.PI;b<=A?(x=A-b,b=A-b-a,b=Math.abs(b)<Math.abs(x)?b:x):(x=A+a-b,b=A-b,b=Math.abs(b)<Math.abs(x)?b:x);b*=O;A=(f.l-y.l)*O;x=(f.c-y.c)*O;let {l:J,c:R,h:Y}=y;G&&(y=G/O,J+=y*A,R+=y*x,Y=(Y+y*b+a)%a);y=[];for(E=0;E<N-1;E++)y.push({l:J,c:R,h:Y}),J+=A,R+=x,Y=(Y+b+a)%a;y.push(H?{l:J,c:R,h:Y}:f);f=
y}a=[];y=l[3]??255;b=((d[3]??255)-y)/(g-1);for(A=0;A<g;A++){const {r:N,g:G,b:O}=t.toRGB(f[A]);a.push([N,G,O,C?Math.round(y+b*A):255])}return a}function n(a,f){const {numColors:l,interpolateAlpha:d}=c(f);f=f?.weights;({colorRamps:a}=a);if(f){const A=f.reduce((x,E)=>x+E);f=f.map(x=>x/A)}else{f=[];for(var b=0;b<a.length;b++)f[b]=1/a.length}b=[];const g=1/(l-1);let z=0,v=!1;for(let A=0;A<a.length;A++){var C=b.length,y=v?0:C*g-z;z+=f[A];C=A===a.length-1?l-1-C:(f[A]-y)/g;v=Math.ceil(C)===C;C=Math.ceil(C);
0!==C&&(y=e(a[A],{numColors:C,interpolateAlpha:d,distanceOffset:y/f[A],distanceInterval:g/f[A]}),b.push(...y))}f=[...a[a.length-1].toColor];3===f.length&&f.push(255);b.push(f);return b}function h(a,f){a=F.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?n(a,f):e(a,f)}function m(a){a=t.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function w(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:m(a.fromColor),
ToColor:m(a.toColor)}}const k=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,
0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,
255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,
255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,
255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,
96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,
242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},
{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},
{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",
colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",
fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},
{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",
type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,
0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},
{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",
colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,
107,45]}],r=new L.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging",
"Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging",
"Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark",
"Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark",
"Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});p.colorRampDict=r;p.convertColorRampToColormap=function(a,f){a=h(a,f);const l=f?.interpolateAlpha;a.forEach((d,b)=>{d.unshift(b);l||d.pop()});
return a};p.convertColorRampToColors=h;p.convertRGBATo32Bit=function(a){a=a.reverse().map(f=>{f=f.toString(16);return 2>f.length?"0"+f:f});return 4294967295&Number.parseInt(a.join(""),16)};p.createHsvMap=function(a){const f=[];for(let l=0;l<a.length;l+=4){const d=t.toHSV({r:a[l],g:a[l+1],b:a[l+2]});f.push([d.h/60,d.s/100,255*d.v/100])}return f};p.getColorRampId=D;p.getColorRampJSON=function(a,f="esriCIELabAlgorithm"){const l=k.find(({id:d})=>d===a);return l?l.colorRamps?{type:"multipart",colorRamps:l.colorRamps.map(d=>
({type:"algorithmic",algorithm:f,fromColor:[...d.fromColor],toColor:[...d.toColor]}))}:{type:"algorithmic",algorithm:f,fromColor:[...l.fromColor],toColor:[...l.toColor]}:null};p.getColorRampName=q;p.getRFxArgColorRampValue=function(a){const f=q(a);return f?"algorithmic"===a.type?{...w(a),Name:f}:a.colorRamps?(a=a.colorRamps.map(w),{type:"MultiPartColorRamp",NumColorRamps:a.length,ArrayOfColorRamp:a,Name:f}):null:null};p.predefinedJsonColorRamps=k;p.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");
Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(p,u,t,L,F,P,M,Q,B,D){var q;u=q=class extends u.JSONSupport{constructor(c){super(c);
this.altitude=45;this.azimuth=315;this.colorRamp=null;this.hillshadeType="traditional";this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.scalingType="none";this.type="raster-shaded-relief";this.zFactor=1}readColorRamp(c){return D.fromJSON(c)}clone(){return new q({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:t.clone(this.colorRamp)})}};
p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"altitude",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"azimuth",void 0);p.__decorate([L.property({types:D.types,json:{write:!0}})],u.prototype,"colorRamp",void 0);p.__decorate([Q.reader("colorRamp")],u.prototype,"readColorRamp",null);p.__decorate([L.property({type:["traditional","multi-directional"],json:{write:!0}})],u.prototype,"hillshadeType",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],
u.prototype,"pixelSizePower",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"pixelSizeFactor",void 0);p.__decorate([L.property({type:["none","adjusted"],json:{write:!0}})],u.prototype,"scalingType",void 0);p.__decorate([M.enumeration({rasterShadedRelief:"raster-shaded-relief"})],u.prototype,"type",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"zFactor",void 0);return u=q=p.__decorate([B.subclass("esri.renderers.RasterShadedReliefRenderer")],
u)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/tslib.es6 ../core/deprecate ../core/JSONSupport ../core/lang ../core/Logger ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),function(p,u,t,L,F,P,M,Q,B,D,q,c,e){var n;t=n=class extends t.JSONSupport{constructor(h){super(h);
this.colorRamp=null;this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.histograms=this.sigmoidStrengthLevel=this.outputMin=this.outputMax=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=null;this.useGamma=!1;this.stretchType="none";this.type="raster-stretch"}readColorRamp(h){if(h)return e.fromJSON(h)}get statistics(){return this._get("statistics")}set statistics(h){u.deprecatedProperty(F.getLogger(this),"statistics",{replacement:"customStatistics",version:"4.31",warnOnce:!0});
this._set("statistics",h)}get customStatistics(){const h=this.statistics;return h&&Array.isArray(h[0])?h.map(m=>({min:m[0],max:m[1],avg:m[2],stddev:m[3]})):h}set customStatistics(h){this._set("statistics",h?.map(m=>[m.min,m.max,m.avg??0,m.stddev??1]))}readCustomStatistics(h){return h?.map(m=>({min:m[0],max:m[1],avg:m[2],stddev:m[3]}))}writeCustomStatistics(h,m,w){h?.length&&(m[w]=h.map(k=>[k.min,k.max,k.avg??0,k.stddev??1]))}readStretchType(h,m){h=m.stretchType;"number"===typeof h&&(h=c.stretchTypeFunctionEnum[h]);
return c.stretchTypeJSONDict.read(h)}clone(){return new n({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:L.clone(this.statistics),customStatistics:L.clone(this.customStatistics),gamma:L.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:L.clone(this.colorRamp),histograms:L.clone(this.histograms),
dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};p.__decorate([P.property({types:e.types,json:{write:!0}})],t.prototype,"colorRamp",void 0);p.__decorate([B.reader("colorRamp")],t.prototype,"readColorRamp",null);p.__decorate([P.property({type:Boolean,json:{write:!0}})],t.prototype,"computeGamma",void 0);p.__decorate([P.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],t.prototype,"dynamicRangeAdjustment",void 0);p.__decorate([P.property({type:[Number],json:{write:!0}})],
t.prototype,"gamma",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],t.prototype,"maxPercent",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],t.prototype,"minPercent",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],t.prototype,"numberOfStandardDeviations",void 0);p.__decorate([P.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],t.prototype,"outputMax",void 0);p.__decorate([P.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],
t.prototype,"outputMin",void 0);p.__decorate([P.property({type:Number,json:{write:!0}})],t.prototype,"sigmoidStrengthLevel",void 0);p.__decorate([P.property({})],t.prototype,"statistics",null);p.__decorate([P.property()],t.prototype,"histograms",void 0);p.__decorate([P.property({json:{type:[[Number]],name:"statistics",write:!0}})],t.prototype,"customStatistics",null);p.__decorate([B.reader("customStatistics")],t.prototype,"readCustomStatistics",null);p.__decorate([q.writer("customStatistics")],t.prototype,
"writeCustomStatistics",null);p.__decorate([P.property({type:Boolean,json:{write:!0}})],t.prototype,"useGamma",void 0);p.__decorate([P.property({type:c.stretchTypeJSONDict.apiValues,json:{type:c.stretchTypeJSONDict.jsonValues,write:c.stretchTypeJSONDict.write}})],t.prototype,"stretchType",void 0);p.__decorate([B.reader("stretchType",["stretchType"])],t.prototype,"readStretchType",null);p.__decorate([Q.enumeration({rasterStretch:"raster-stretch"})],t.prototype,"type",void 0);return t=n=p.__decorate([D.subclass("esri.renderers.RasterStretchRenderer")],
t)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(p,u){u=new u.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});p.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};p.stretchTypeJSONDict=u;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/VectorFieldRenderer":function(){define("../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../geometry/Point ../symbols/PictureMarkerSymbol".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b,g,z,v){var C;const y=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);t=new P.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
P=new P.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});M=C=class extends k.VisualVariablesMixin(M.JSONSupport){constructor(A){super(A);this.attributeField="Magnitude";this.flowRepresentation="flow-from";this.rotationType="arithmetic";this.style="single-arrow";this.symbolTileSize=50;this.type="vector-field"}readInputUnit(A,x){return y.has(A)?m.unitKebabDict.fromJSON(A):null}readOutputUnit(A,x){return y.has(A)?m.unitKebabDict.fromJSON(A):null}get styleRenderer(){const A=this.attributeField,x=this._createStyleRenderer(this.style);
x.field=A;return x}get sizeVariables(){const A=[];if(this.visualVariables)for(var x of this.visualVariables)"size"===x.type&&A.push(x);0===A.length&&(x=new f({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(x):this._set("visualVariables",[x]),A.push(x));return A}get rotationVariables(){const A=[];if(this.visualVariables)for(var x of this.visualVariables)"rotation"===x.type&&A.push(x);0===A.length&&(x=new a({field:"Direction",
rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(x):this._set("visualVariables",[x]),A.push(x));return A}clone(){return new C({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:Q.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(A,x=!1,E=[]){const N=[];var G=m.getUnitConversionFactor(this.inputUnit,
this.outputUnit),O=this.rotationVariables[0]?.rotationType||this.rotationType;x=x?m.convertVectorFieldData(A.pixelBlock,"vector-uv",O,G):m.convertVectorFieldUnit(A.pixelBlock,"vector-magdir",G);if(null==x)return N;A=A.extent;G=null!=x.mask&&0<x.mask.length;O=0;const H=(A.xmax-A.xmin)/x.width,J=(A.ymax-A.ymin)/x.height;for(let Y=0;Y<x.height;Y++)for(let T=0;T<x.width;T++,O++){let X=new z({x:A.xmin+T*H+H/2,y:A.ymax-Y*J-J/2,spatialReference:A.spatialReference});X=(await h.normalizeCentralMeridian(X))[0];
var R=E.some(V=>V.intersects(X));G&&!x.mask[O]||R||(R={Magnitude:x.pixels[0][O],Direction:x.pixels[1][O]},R=new L({geometry:new z({x:X.x,y:X.y,spatialReference:A.spatialReference}),attributes:R}),R.symbol=this._getVisualVariablesAppliedSymbol(R),N.push(R))}return N}getSymbol(A,x){}async getSymbolAsync(A,x){}getSymbols(){return[]}getClassBreakInfos(){return this.styleRenderer?.classBreakInfos}getDefaultSymbol(){return this.styleRenderer?.defaultSymbol}_getDefaultSymbol(A){return new b({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",
outline:new d({width:0}),size:20,color:A||new u([0,92,230])})}_getVisualVariablesAppliedSymbol(A){if(A){var x=this.styleRenderer?.getSymbol(A)?.clone(),E=this.sizeVariables,N=this.rotationVariables;E&&E.length&&this.sizeVariables.forEach(G=>g.applySizesToSymbol(x,l.getAllSizes([G],A)));N&&N.length&&(A.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(G=>g.applyRotationToSymbol(x,l.getRotationAngle(G,
A),G.axis)));return x}}_createStyleRenderer(A){let x={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(A){case "single-arrow":x=this._createSingleArrowRenderer();break;case "beaufort-kn":x=this._createBeaufortKnotsRenderer();break;case "beaufort-m":x=this._createBeaufortMeterRenderer();break;case "beaufort-ft":x=this._createBeaufortFeetRenderer();break;case "beaufort-mi":x=this._createBeaufortMilesRenderer();break;case "beaufort-km":x=this._createBeaufortKilometersRenderer();break;
case "ocean-current-m":x=this._createCurrentMeterRenderer();break;case "ocean-current-kn":x=this._createCurrentKnotsRenderer();break;case "simple-scalar":x=this._createSimpleScalarRenderer();break;case "wind-barb":x=this._createWindBarbsRenderer();break;case "classified-arrow":x=this._createClassifiedArrowRenderer()}return new w(x)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const A=this._getDefaultSymbol(new u([214,47,39])),x=this._getClassBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:A,classBreakInfos:x}}_createBeaufortMeterRenderer(){const A=this._getDefaultSymbol(new u([214,47,39])),x=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,
220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:A,classBreakInfos:x}}_createBeaufortFeetRenderer(){const A=this._getDefaultSymbol(new u([214,47,39]));var x=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];x=x.map(E=>3.28084*E);x=this._getClassBreaks(x,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:A,classBreakInfos:x}}_createBeaufortMilesRenderer(){const A=
this._getDefaultSymbol(new u([214,47,39]));var x=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];x=x.map(E=>2.23694*E);x=this._getClassBreaks(x,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:A,classBreakInfos:x}}_createBeaufortKilometersRenderer(){const A=this._getDefaultSymbol(new u([214,47,39]));var x=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,
32.7];x=x.map(E=>3.6*E);x=this._getClassBreaks(x,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:A,classBreakInfos:x}}_createCurrentMeterRenderer(){const A=this._getDefaultSymbol(new u([177,177,177])),x=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:A,classBreakInfos:x}}_createCurrentKnotsRenderer(){const A=
this._getDefaultSymbol(new u([177,177,177])),x=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:A,classBreakInfos:x}}_createClassifiedArrowRenderer(){const A=this._getDefaultSymbol(new u([56,168,0]));var x=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const E=this.sizeVariables[0].minDataValue,N=this.sizeVariables[0].maxDataValue;if(E&&N){const G=(N-E)/5;x=
Array.from(Array(6).keys()).map(O=>E+G*O)}}x=this._getClassBreaks(x,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:A,classBreakInfos:x}}_createSimpleScalarRenderer(){return{defaultSymbol:v.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const A=Array.from(Array(31).keys()).map(G=>5*G),x=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],E=v.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),N=A.map((G,O)=>{if(O!==A.length-1)if(0===O)var H={minValue:G,maxValue:A[O+1],symbol:E};else H=v.fromJSON({type:"esriPMS",imageData:x[O].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),H={minValue:G,maxValue:A[O+1],symbol:H};return new r(H)});return{defaultSymbol:E,classBreakInfos:N}}_getClassBreaks(A,x){return x.map((E,N)=>new r({minValue:A[N],maxValue:A[N+1],symbol:this._getDefaultSymbol(new u(E))}))}};p.__decorate([B.property({type:["Magnitude"],
json:{write:!0}})],M.prototype,"attributeField",void 0);p.__decorate([B.property({type:P.apiValues,json:{type:P.jsonValues,read:{reader:P.read},write:{writer:P.write}}})],M.prototype,"flowRepresentation",void 0);p.__decorate([B.property({type:["geographic","arithmetic"],json:{write:!0}})],M.prototype,"rotationType",void 0);p.__decorate([B.property({type:t.apiValues,json:{type:t.jsonValues,read:{reader:t.read},write:{writer:t.write}}})],M.prototype,"style",void 0);p.__decorate([B.property({json:{write:!0}})],
M.prototype,"symbolTileSize",void 0);p.__decorate([B.property({type:m.unitKebabDict.apiValues,json:{type:m.unitKebabDict.jsonValues,write:{writer:m.unitKebabDict.write}}})],M.prototype,"inputUnit",void 0);p.__decorate([e.reader("inputUnit")],M.prototype,"readInputUnit",null);p.__decorate([B.property({type:m.unitKebabDict.apiValues,json:{type:m.unitKebabDict.jsonValues,read:{reader:m.unitKebabDict.read},write:{writer:m.unitKebabDict.write}}})],M.prototype,"outputUnit",void 0);p.__decorate([e.reader("outputUnit")],
M.prototype,"readOutputUnit",null);p.__decorate([c.enumeration({vectorField:"vector-field"})],M.prototype,"type",void 0);p.__decorate([B.property({type:w})],M.prototype,"styleRenderer",null);p.__decorate([B.property({type:f})],M.prototype,"sizeVariables",null);p.__decorate([B.property({type:a})],M.prototype,"rotationVariables",null);return M=C=p.__decorate([n.subclass("esri.renderers.VectorFieldRenderer")],M)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap",
"../PixelBlock","./pixelUtils"],function(p,u,t,L){function F(b,g){return m.get(b)/m.get(g)||1}function P(b,g="geographic"){const [z,v]=b;b=Math.sqrt(z*z+v*v);let C=Math.atan2(v,z)*w;C=(360+C)%360;"geographic"===g&&(C=(450-C)%360);return[b,C]}function M(b,g="geographic"){let z=b[1];"geographic"===g&&(z=(450-z)%360);z%=360;b=b[0];return[b*Math.cos(z/w),b*Math.sin(z/w)]}function Q(b,g,z="geographic",v=1){if(!L.isValidPixelBlock(b))return b;const {pixels:C,width:y,height:A}=b;var x=y*A;const E=C[0],N=
C[1],G=b.pixelType.startsWith("f")?b.pixelType:"f32",O=t.createEmptyBand(G,x);x=t.createEmptyBand(G,x);let H=0;for(let J=0;J<A;J++)for(let R=0;R<y;R++)"vector-uv"===g?([O[H],x[H]]=P([E[H],N[H]],z),O[H]*=v):([O[H],x[H]]=M([E[H],N[H]],z),O[H]*=v,x[H]*=v),H++;b=new t({pixelType:G,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:[O,x]});b.updateStatistics();return b}function B(b=0,g=0,z=Math.PI,v=!0){v&&(z=(2*Math.PI-z)%(2*Math.PI));v=v?-1:1;
const C=-7*v,y=-2*v,A=-16*v,[x,E]=q(0,g+13*v,z,21.75),[N,G]=q(b-5.5,g+C,z,21.75),[O,H]=q(b+5.5,g+C,z,21.75),[J,R]=q(b-1.5,g+y,z,21.75),[Y,T]=q(b+1.5,g+y,z,21.75),[X,V]=q(b-1.5,g+A,z,21.75),[K,S]=q(b+1.5,g+A,z,21.75);return[x,E,N,G,J,R,Y,T,O,H,X,V,K,S]}function D(b=0,g=Math.PI,z=!0){z&&(g=(2*Math.PI-g)%(2*Math.PI));var v=z?-1:1,C=5*v;const y=20*v,A=25*v;v*=2;const x=z?1:-1;z=5*x;let [E,N]=[0+z,0-y],[G,O]=[E+2*x,N],[H,J]=[G-0*x,O+v],[R,Y]=[0-z,0-A],[T,X]=[R+0*x,Y-v],V=Math.ceil(b/5),K=Math.floor(V/
10);V-=8*K;b=[];const S=[];for(let ha=0;ha<V/2;ha++,K--){0>=K&&1===V%2&&ha===(V-1)/2&&(R=0,T=R+0*x,Y=(Y+N)/2,X=Y-v);const [ia,ka]=q(R,Y,g,45);if(0<K){const [ma,pa]=q(G,Y,g,45),[oa,sa]=q(E,N,g,45);b.push(ma);b.push(pa);b.push(ia);b.push(ka);b.push(oa);b.push(sa)}else{const [ma,pa]=q(G,O,g,45),[oa,sa]=q(H,J,g,45),[qa,va]=q(T,X,g,45);S.push(ia);S.push(ka);S.push(qa);S.push(va);S.push(oa);S.push(sa);S.push(ma);S.push(pa)}Y+=C;N+=C;O+=C;J+=C;X+=C}const [Z,ca]=q(0+z,0+y,g,45);C=7*x;const [I,U]=q(0+C,0+
y,g,45),[W,aa]=q(0+z,0-A,g,45),[da,ea]=q(0+C,0-A,g,45);return{pennants:b,barbs:S,shaft:[Z,ca,I,U,W,aa,da,ea]}}function q(b,g,z,v=1){return[Math.sqrt(b*b+g*g)/v,(2*Math.PI+(2*Math.PI+Math.atan2(g,b))%(2*Math.PI)-z)%(2*Math.PI)]}function c(b,g,z,v){z=F(v||"knots",z);for(v=1;v<g.length;v++)if(v===g.length-1){if(b<g[v]*z)break}else if(b<=g[v]*z)break;return Math.min(v-1,g.length-2)}function e(b,g,z,v,C){let y=0;switch(g){case "beaufort_kn":y=c(b,a,"knots",z);break;case "beaufort_km":y=c(b,a,"kilometer-per-hour",
z);break;case "beaufort_ft":y=c(b,a,"feet-per-second",z);break;case "beaufort_m":y=c(b,a,"meter-per-second",z);break;case "classified_arrow":y=c(b,C??[],v,z);break;case "ocean_current_m":y=c(b,f,"meter-per-second",z);break;case "ocean_current_kn":y=c(b,l,"knots",z)}return y}function n(b,g){const {style:z,inputUnit:v,outputUnit:C,breakValues:y}=g,A=k.fromJSON(v),x=k.fromJSON(C);let E=0,N=0;const {width:G,height:O,mask:H}=b,J=b.pixels[0];b=b.pixels[1];var R=null!=H?H.filter(X=>0<X).length:G*O;const Y=
new Float32Array(42*R);R=new Uint32Array(15*R);g=g.invertDirection?B(0,0,0,!1):r;for(let X=0;X<O;X++)for(let V=0;V<G;V++){var T=X*G+V;if(!H||H[X*G+V]){const K=(b[T]+360)%360/180*Math.PI,S=e(J[T],z,A,x,y);for(let Z=0;Z<g.length;Z+=2)Y[E++]=(V+.5)/G,Y[E++]=(X+.5)/O,Y[E++]=g[Z],Y[E++]=g[Z+1]+K,Y[E++]=S,Y[E++]=J[T];T=7*(E/42-1);R[N++]=T;R[N++]=T+1;R[N++]=T+2;R[N++]=T+0;R[N++]=T+4;R[N++]=T+3;R[N++]=T+0;R[N++]=T+2;R[N++]=T+3;R[N++]=T+2;R[N++]=T+5;R[N++]=T+3;R[N++]=T+5;R[N++]=T+6;R[N++]=T+3}}return{vertexData:Y,
indexData:R}}function h(b,g){let z=0,v=0;const {width:C,height:y,mask:A}=b;b=b.pixels[0];const x=[],E=[];var N=k.fromJSON(g.inputUnit);N=F(N,"knots");g="wind_speed"===g.style?5:Number.MAX_VALUE;for(let O=0;O<y;O++)for(let H=0;H<C;H++){var G=b[O*C+H]*N;if((!A||A[O*C+H])&&G<g){for(let J=0;4>J;J++)x[z++]=(H+.5)/C,x[z++]=(O+.5)/y,x[z++]=2>J?-.5:.5,x[z++]=0===J%2?-.5:.5,x[z++]=0,x[z++]=G;G=4*(z/24-1);E[v++]=G;E[v++]=G+1;E[v++]=G+2;E[v++]=G+1;E[v++]=G+2;E[v++]=G+3}}return{vertexData:new Float32Array(x),
indexData:new Uint32Array(E)}}const m=new Map;m.set("meter-per-second",1);m.set("kilometer-per-hour",.277778);m.set("knots",.514444);m.set("feet-per-second",.3048);m.set("mile-per-hour",.44704);const w=180/Math.PI,k=new u.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),r=B(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],f=[0,.5,1,1.5,2],l=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],
d=[];p.convertToLocalDirections=function(b,g,z,v="geographic"){if(!L.isValidPixelBlock(b)||null==z)return b;b="vector-magdir"===g?b.clone():Q(b,g);const C=b.pixels[1];for(let y=0;y<C.length;y++)C[y]="geographic"===v?(C[y]+z[y]+270)%360:(C[y]+360-z[y])%360;return"vector-magdir"===g?b:Q(b,"vector-magdir")};p.convertVectorFieldData=Q;p.convertVectorFieldUnit=function(b,g,z=1){if(1===z||!L.isValidPixelBlock(b))return b;b=b.clone();const {pixels:v,width:C,height:y}=b,A=v[0],x=v[1];let E=0;for(let N=0;N<
y;N++)for(let G=0;G<C;G++)"vector-uv"===g?(A[E]*=z,x[E]*=z):A[E]*=z,E++;b.updateStatistics();return b};p.createVFMesh=function(b,g){if("simple_scalar"===g.style)g=h(b,g);else if("wind_speed"===g.style){if(0===d.length)for(var z=0;30>z;z++)d.push(D(5*z,0,!g.invertDirection));g=k.fromJSON(g.inputUnit);g=F(g,"knots");const {width:A,height:x,mask:E}=b;z=b.pixels[0];b=b.pixels[1];const N=[],G=[];let O=0,H=0;for(let J=0;J<x;J++)for(let R=0;R<A;R++){var v=J*A+R,C=z[v]*g;if((!E||E[J*A+R])&&5<=C){const Y=
(b[v]+360)%360/180*Math.PI,{pennants:T,barbs:X,shaft:V}=d[Math.min(Math.floor(C/5),29)];if(0===T.length+X.length)continue;v=N.length/6;const K=(R+.5)/A,S=(J+.5)/x;for(var y=0;y<T.length;y+=2)N[O++]=K,N[O++]=S,N[O++]=T[y],N[O++]=T[y+1]+Y,N[O++]=0,N[O++]=C;for(y=0;y<X.length;y+=2)N[O++]=K,N[O++]=S,N[O++]=X[y],N[O++]=X[y+1]+Y,N[O++]=0,N[O++]=C;for(y=0;y<V.length;y+=2)N[O++]=K,N[O++]=S,N[O++]=V[y],N[O++]=V[y+1]+Y,N[O++]=0,N[O++]=C;for(C=0;C<T.length/6;C++)G[H++]=v,G[H++]=v+1,G[H++]=v+2,v+=3;for(C=0;C<
X.length/8;C++)G[H++]=v,G[H++]=v+1,G[H++]=v+2,G[H++]=v+1,G[H++]=v+2,G[H++]=v+3,v+=4;G[H++]=v+0;G[H++]=v+1;G[H++]=v+2;G[H++]=v+1;G[H++]=v+3;G[H++]=v+2;v+=4}}g={vertexData:new Float32Array(N),indexData:new Uint32Array(G)}}else g=n(b,g);return g};p.createVFMeshScalar=h;p.getUnitConversionFactor=F;p.sampleVectorField=function(b,g,z,v=[0,0],C=.5){const {width:y,height:A,mask:x}=b,[E,N]=b.pixels,[G,O]=v;b=Math.round((y-G)/z);v=Math.round((A-O)/z);var H=b*v;const J=new Float32Array(H),R=new Float32Array(H);
H=new Uint8Array(H);g="vector-uv"===g;for(let T=0;T<v;T++)for(let X=0;X<b;X++){let V=0;const K=T*b+X,S=Math.max(0,T*z+O),Z=Math.max(0,X*z+G),ca=Math.min(A,S+z),I=Math.min(y,Z+z);for(let U=S;U<ca;U++)for(let W=Z;W<I;W++){var Y=U*y+W;if(!x||x[Y]){V++;Y=g?[E[Y],N[Y]]:[E[Y],(360+N[Y])%360];const [aa,da]=g?Y:M(Y);J[K]+=aa;R[K]+=da}}if(V>=(ca-S)*(I-Z)*(1-C)){H[K]=1;const [U,W]=P([J[K]/V,R[K]/V]);J[K]=U;R[K]=W}else H[K]=0,J[K]=0,R[K]=0}z=new t({width:b,height:v,pixels:[J,R],mask:H});z.updateStatistics();
return z};p.snapImageToSymbolTile=function(b,g,z,v,C){if(null==C||!C.spatialReference.equals(b.spatialReference))return{extent:b,width:Math.round(g/v),height:Math.round(z/v),resolution:b.width/g};const y=C.xmin;C=C.ymax;g=(b.xmax-b.xmin)/g*v;z=(b.ymax-b.ymin)/z*v;b.xmin=y+Math.floor((b.xmin-y)/g)*g;b.xmax=y+Math.ceil((b.xmax-y)/g)*g;b.ymin=C+Math.floor((b.ymin-C)/z)*z;b.ymax=C+Math.ceil((b.ymax-C)/z)*z;return{extent:b,width:Math.round(b.width/g),height:Math.round(b.height/z),resolution:(g+z)/2}};
p.unitKebabDict=k;p.uvComponentToVector=P;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(p,u,t,L,F,P,M,Q,B,D){var q;t=q=class extends t.JSONSupport{static createEmptyBand(c,
e){return new (q.getPixelArrayConstructor(c))(e)}static combineBandMasks(c){if(2>c.length)return c[0];const e=c[0].length,n=(new Uint8Array(e)).fill(255);for(let h=0;h<c.length;h++){const m=c[h];for(let w=0;w<e;w++)m[w]||(n[w]=0)}return n}static getPixelArrayConstructor(c){let e;switch(c){case "u1":case "u2":case "u4":case "u8":e=Uint8Array;break;case "u16":e=Uint16Array;break;case "u32":e=Uint32Array;break;case "s8":e=Int8Array;break;case "s16":e=Int16Array;break;case "s32":e=Int32Array;break;case "f32":e=
Float32Array;break;case "f64":e=Float64Array;break;case "c64":case "c128":case "unknown":e=Float32Array}return e}constructor(c){super(c);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(c){if(!c)return"f32";c=c.toLowerCase();["u1","u2","u4"].includes(c)?c="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(c)||(c="f32");return c}getPlaneCount(){return this.pixels?.length}addData(c){if(!c.pixels||
c.pixels.length!==this.width*this.height)throw new u("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics??new B.SimpleBandStatistics)}getAsRGBA(){const c=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(c);
break;default:this._fillFrom8Bit(c)}return new Uint8ClampedArray(c)}getAsRGBAFloat(){const c=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(c);return c}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(n=>{var h=this.mask;let m=Infinity,w=-Infinity;const k=n.length;let r,a=0;if(null!=h)for(r=0;r<k;r++)h[r]&&(a=n[r],m=a<m?a:m,w=a>w?a:w);else for(r=0;r<k;r++)a=n[r],m=a<m?a:m,w=a>w?a:w;return new B.SimpleBandStatistics(m,w)});var c=this.mask,e=0;if(null!=c)for(let n=
0;n<c.length;n++)c[n]&&e++;else e=this.width*this.height;this.validPixelCount=e}}clamp(c){if(c&&"f64"!==c&&"f32"!==c&&this.pixels){var [e,n]=D.getPixelValueRange(c),h=this.pixels,m=this.width*this.height,w=h.length,k=[];for(let l=0;l<w;l++){var r=q.createEmptyBand(c,m);var a=h[l];for(let d=0;d<m;d++){var f=a[d];r[d]=f>n?n:f<e?e:f}k.push(r)}this.pixels=k;this.pixelType=c}}extractBands(c){const {pixels:e,statistics:n}=this;if(null==c||0===c.length||!e||0===e.length)return this;var h=e.length;const m=
c.some(l=>l>=e.length),w=h===c.length&&!c.some((l,d)=>l!==d);if(m||w)return this;h=this.bandMasks?.length===h?c.map(l=>this.bandMasks[l]):void 0;let {mask:k,validPixelCount:r}=this;const {width:a,height:f}=this;h?.length&&(k=q.combineBandMasks(h),r=k.filter(l=>!!l).length);return new q({pixelType:this.pixelType,width:a,height:f,mask:k,bandMasks:h,validPixelCount:r,maskIsAlpha:this.maskIsAlpha,pixels:c.map(l=>e[l]),statistics:n&&c.map(l=>n[l])})}clone(){const c=new q({width:this.width,height:this.height,
pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&(c.mask=new Uint8Array(this.mask));this.bandMasks&&(c.bandMasks=this.bandMasks.map(h=>new Uint8Array(h)));let e;const n=q.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){c.pixels=[];const h=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)c.pixels[e]=h?this.pixels[e].slice():new n(this.pixels[e])}if(this.statistics)for(c.statistics=[],e=0;e<this.statistics.length;e++)c.statistics[e]=
L.clone(this.statistics[e]);c.premultiplyAlpha=this.premultiplyAlpha;return c}_fillFrom8Bit(c){const {mask:e,maskIsAlpha:n,premultiplyAlpha:h,pixels:m}=this;if(c&&m?.length){var w,k;var r=w=k=m[0];3<=m.length?(w=m[1],k=m[2]):2===m.length&&(w=m[1]);var a=new Uint32Array(c),f=this.width*this.height;if(r.length!==f)F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=e&&e.length===f)if(n)for(c=0;c<f;c++){const l=e[c];if(l){const d=l/255;a[c]=h?
l<<24|k[c]*d<<16|w[c]*d<<8|r[c]*d:l<<24|k[c]<<16|w[c]<<8|r[c]}}else for(c=0;c<f;c++)e[c]&&(a[c]=-16777216|k[c]<<16|w[c]<<8|r[c]);else for(c=0;c<f;c++)a[c]=-16777216|k[c]<<16|w[c]<<8|r[c]}else F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(c){const {pixels:e,mask:n,statistics:h}=this;if(c&&e?.length){var m=this.pixelType,w=1,k=0;w=1;if(h&&0<h.length){for(var r of h)null!=r.minValue&&(k=Math.min(k,r.minValue)),null!=r.maxValue&&null!=
r.minValue&&(w=Math.max(w,r.maxValue-r.minValue));w=255/w}else w=255,"s8"===m?(k=-128,w=127):"u16"===m?w=65535:"s16"===m?(k=-32768,w=32767):"u32"===m?w=4294967295:"s32"===m?(k=-2147483648,w=2147483647):"f32"===m?(k=-3.4*1E39,w=3.4*1E39):"f64"===m&&(k=-Number.MAX_VALUE,w=Number.MAX_VALUE),w=255/(w-k);c=new Uint32Array(c);m=this.width*this.height;var a,f,l;r=a=f=e[0];if(r.length!==m)return F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=e.length)if(a=
e[1],3<=e.length&&(f=e[2]),null!=n&&n.length===m)for(l=0;l<m;l++)n[l]&&(c[l]=-16777216|(f[l]-k)*w<<16|(a[l]-k)*w<<8|(r[l]-k)*w);else for(l=0;l<m;l++)c[l]=-16777216|(f[l]-k)*w<<16|(a[l]-k)*w<<8|(r[l]-k)*w;else if(null!=n&&n.length===m)for(l=0;l<m;l++)a=(r[l]-k)*w,n[l]&&(c[l]=-16777216|a<<16|a<<8|a);else for(l=0;l<m;l++)a=(r[l]-k)*w,c[l]=-16777216|a<<16|a<<8|a}else F.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(c){const {pixels:e,mask:n}=
this;if(!c||!e?.length)return F.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let h,m,w,k;h=m=w=e[0];3<=e.length?(m=e[1],w=e[2]):2===e.length&&(m=e[1]);const r=this.width*this.height;if(h.length!==r)return F.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=n&&n.length===r)for(k=0;k<r;k++)c[a++]=h[k],c[a++]=m[k],c[a++]=w[k],c[a++]=n[k]&1;else for(k=0;k<r;k++)c[a++]=h[k],c[a++]=
m[k],c[a++]=w[k],c[a++]=1}};p.__decorate([P.property({json:{write:!0}})],t.prototype,"width",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"height",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"pixelType",void 0);p.__decorate([M.cast("pixelType")],t.prototype,"castPixelType",null);p.__decorate([P.property({json:{write:!0}})],t.prototype,"validPixelCount",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"mask",void 0);p.__decorate([P.property({json:{write:!0}})],
t.prototype,"maskIsAlpha",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"pixels",void 0);p.__decorate([P.property()],t.prototype,"premultiplyAlpha",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"statistics",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"depthCount",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"noDataValues",void 0);p.__decorate([P.property({json:{write:!0}})],t.prototype,"bandMasks",void 0);return t=q=p.__decorate([Q.subclass("esri.layers.support.PixelBlock")],
t)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(p){class u{constructor(t=null,L=null,F=null){this.minValue=t;this.maxValue=L;this.noDataValue=F}}p.SimpleBandStatistics=u;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(p){function u(F){return L[F]??[-3.4028234663852886E38,3.4028234663852886E38]}function t(F){return(F?.startsWith("s")||F?.startsWith("u"))??
!1}const L={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};p.clipBandToPixelTypeRange=function(F,P,M,Q){let [B,D]=u(M);var q=t(M);q&&(B-=1E-5,D+=1E-5);if(q)if(M.startsWith("u")){const [c,e]=[B,D];for(M=0;M<P.length;M++)P[M]&&(q=F[M],q<c||q>e?P[M]=0:Q[M]=q+.5<<0)}else{const [c,e]=[B,
D];for(M=0;M<P.length;M++)P[M]&&(q=F[M],q<c||q>e?P[M]=0:Q[M]=q+(0<q?.5:-.5)<<0)}else{const [c,e]=[B,D];for(M=0;M<P.length;M++)P[M]&&(q=F[M],q<c||q>e?P[M]=0:Q[M]=q)}};p.convertNoDataToMask=function(F,P,M){if(!(F.depthCount&&1<F.depthCount)){var {pixels:Q,statistics:B,pixelType:D}=F,q=Q[0].length,c=F.bandMasks??[];q=F.mask??(new Uint8Array(q)).fill(255);var e="f32"===D||"f64"===D,n=u(D),h=!1;for(let k=0;k<Q.length;k++){const r="number"===typeof P?P:P[k];if(null==r)continue;var m=B?.[k]?.maxValue??n[1];
if((B?.[k]?.minValue??n[0])>r+Number.EPSILON||m<r-Number.EPSILON)continue;m=c[k]||q.slice();const a=Q[k];var w=M?.customFloatTolerance;if(e&&0!==w){w||=9.999999E37<=Math.abs(r)?2E-7*Math.abs(r):"f32"===D?2**-23:Number.EPSILON;for(let f=0;f<a.length;f++)m[f]&&Math.abs(a[f]-r)<w&&(a[f]=0,m[f]=0,q[f]=0,h=!0)}else for(w=0;w<a.length;w++)m[w]&&a[w]===r&&(a[w]=0,m[w]=0,q[w]=0,h=!0);c[k]=m}h&&(F.bandMasks=F.bandMasks||1<F.pixels.length?c:null,F.mask=q);h&&"updateStatistics"in F&&F.updateStatistics()}};p.fixNaN=
function(F,P){for(let M=0;M<P.length;M++)P[M]&&isNaN(F[M])&&(P[M]=0,F[M]=0)};p.getIntegerPixelType=function(F,P){return null==F||null==P?"s32":0>F?-128<=F&&128>P?"s8":-32768<=F&&32768>P?"s16":"s32":256>P?"u8":65536>P?"u16":"u32"};p.getPixelValueRange=u;p.isIntegerPixelType=t;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(p,u,t){function L(a){return null!=
a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function F(a,f,l,d,b){const g=a.length;b=u.createEmptyBand(b,g);if(f)for(let z=0;z<g;z++)f[z]&&(b[z]=l[a[z]-d]);else for(f=0;f<g;f++)b[f]=l[a[f]-d];return b}function P(a,f,l,d){const b=null!=l&&2<=l.length?new Set(l):null;l=1===l?.length?l[0]:null;const g=!!f?.length;for(let z=0;z<a.length;z++)if(d[z]){const v=a[z];if(g){let C=!1;for(let y=0;y<f.length;y+=2)if(v>=f[y]&&v<=f[y+1]){C=!0;break}C||(d[z]=0)}d[z]&&(v===l||
b?.has(v))&&(d[z]=0)}}function M(a,f){const l=a[0].length;for(let d=0;d<l;d++)if(f[d]){let b=!1;for(let g=0;g<a.length;g++)if(a[g][d]){b=!0;break}b||(f[d]=0)}}function Q(a,f){const l=a[0].length;for(let d=0;d<l;d++)if(f[d]){let b=!1;for(let g=0;g<a.length;g++)if(0===a[g][d]){b=!0;break}b&&(f[d]=0)}}function B(a,f,l,d,b,g,z,v){return{xmin:b<=l*a?0:b<l*a+a?b-l*a:a,ymin:g<=d*f?0:g<d*f+f?g-d*f:f,xmax:b+z<=l*a?0:b+z<l*a+a?b+z-l*a:a,ymax:g+v<=d*f?0:g+v<d*f+f?g+v-d*f:f}}function D(a,f,l,d,b,g){const {width:z,
height:v}=l.block,{x:C,y}=l.offset,{width:A,height:x}=l.mosaic;l=B(z,v,d,b,C,y,A,x);let E=0;var N=0;if(g){var G=g.hasGCSSShiftTransform?360:g.halfWorldWidth??0,O=z*g.resolutionX;const H=g.startX+d*O;H<G&&H+O>G?N=g.rightPadding:H>=G&&(E=g.leftMargin-g.rightPadding,N=0)}l.xmax-=N;if("number"===typeof f)for(g=l.ymin;g<l.ymax;g++)for(N=(b*v+g-y)*A+(d*z-C)+E,G=l.xmin;G<l.xmax;G++)a[N+G]=f;else for(g=l.ymin;g<l.ymax;g++)for(N=(b*v+g-y)*A+(d*z-C)+E,G=g*z,O=l.xmin;O<l.xmax;O++)a[N+O]=f[G+O]}function q(a,
f,l={}){const {clipOffset:d,clipSize:b,alignmentInfo:g,blockWidths:z}=l;if(z)return c(a,f,{blockWidths:z});var v=a.find(Y=>L(Y));if(null==v)return null;l=b?b.width:f.width;const C=b?b.height:f.height;var y=v.width,A=v.height;const x=f.width/y,E=f.height/A;f={offset:d||{x:0,y:0},mosaic:b||f,block:{width:y,height:A}};y=v.pixelType;var N=u.getPixelArrayConstructor(y);v=v.pixels.length;A=[];for(var G=0;G<v;G++){var O=new N(l*C);for(var H=0;H<E;H++)for(var J=0;J<x;J++){var R=a[H*x+J];L(R)&&(R=R.pixels[G],
D(O,R,f,J,H,g))}A.push(O)}N=a.some(Y=>null==Y||null!=Y.mask&&0<Y.mask.length);O=a.some(Y=>Y?.bandMasks&&1<Y.bandMasks.length);N=N?new Uint8Array(l*C):void 0;O=O?[]:void 0;if(N){for(G=0;G<E;G++)for(H=0;H<x;H++)J=a[G*x+H],R=null!=J?J.mask:null,null!=R?D(N,R,f,H,G,g):J?D(N,255,f,H,G,g):D(N,0,f,H,G,g);if(O)for(G=0;G<v;G++){H=new Uint8Array(l*C);for(J=0;J<E;J++)for(R=0;R<x;R++){const Y=a[J*x+R],T=Y?.bandMasks?.[G]??Y?.mask;null!=T?D(H,T,f,R,J,g):Y?D(H,255,f,R,J,g):D(H,0,f,R,J,g)}O.push(H)}}a=new u({width:l,
height:C,pixels:A,pixelType:y,bandMasks:O,mask:N});a.updateStatistics();return a}function c(a,f,l){const d=a.find(H=>null!=H);if(null==d)return null;var b=a.some(H=>null!=H?!!H.mask:!0);const {width:g,height:z}=f;f=b?new Uint8Array(g*z):null;({blockWidths:l}=l);const v=[],C=d.getPlaneCount(),y=u.getPixelArrayConstructor(d.pixelType);if(b)for(let H=0,J=0;H<a.length;J+=l[H],H++)if(b=a[H],L(b)){var A=b.mask;for(var x=0;x<z;x++)for(var E=0;E<l[H];E++)f[x*g+E+J]=null==A?255:A[x*b.width+E]}A=(b=a.some(H=>
H?.bandMasks&&1<H.bandMasks.length))?[]:void 0;x=g*z;for(E=0;E<C;E++){const H=new y(x),J=b?new Uint8Array(x):void 0;for(let R=0,Y=0;R<a.length;Y+=l[R],R++){const T=a[R];if(L(T)){var N=T.pixels[E];if(null!=N){for(var G=0;G<z;G++)for(var O=0;O<l[R];O++)H[G*g+O+Y]=N[G*T.width+O];if(J)for(N=T.bandMasks?.[E]??T.mask,G=0;G<z;G++)for(O=0;O<l[R];O++)J[G*g+O+Y]=N?N[G*T.width+O]:255}}}v.push(H);A&&J&&A.push(J)}a=new u({width:g,height:z,mask:f,bandMasks:A,pixels:v,pixelType:d.pixelType});a.updateStatistics();
return a}function e(a){if(!L(a))return null;const f=a.clone(),{width:l,height:d,pixels:b}=a;var g=b[0];const z=f.pixels[0];a=a.mask;for(let y=2;y<d-1;y++){const A=new Map;for(var v=y-2;v<y+2;v++)for(var C=0;4>C;C++){const x=v*l+C;m(A,g[x],a?a[x]:1)}z[y*l]=n(A);z[y*l+1]=z[y*l+2]=z[y*l];for(v=3;v<l-1;v++)C=(y-2)*l+v+1,m(A,g[C],a?a[C]:1),C=(y-1)*l+v+1,m(A,g[C],a?a[C]:1),C=y*l+v+1,m(A,g[C],a?a[C]:1),C=(y+1)*l+v+1,m(A,g[C],a?a[C]:1),C=(y-2)*l+v-3,h(A,g[C],a?a[C]:1),C=(y-1)*l+v-3,h(A,g[C],a?a[C]:1),C=y*
l+v-3,h(A,g[C],a?a[C]:1),C=(y+1)*l+v-3,h(A,g[C],a?a[C]:1),z[y*l+v]=n(A);z[y*l+v+1]=z[y*l+v]}for(g=0;g<l;g++)z[g]=z[l+g]=z[2*l+g],z[(d-1)*l+g]=z[(d-2)*l+g];f.updateStatistics();return f}function n(a){if(0===a.size)return 0;let f=0,l=-1,d=0;const b=a.keys();let g=b.next();for(;!g.done;)d=a.get(g.value),d>f&&(l=g.value,f=d),g=b.next();return l}function h(a,f,l){0!==l&&(l=a.get(f),1===l?a.delete(f):a.set(f,l-1))}function m(a,f,l){0!==l&&a.set(f,a.has(f)?a.get(f)+1:1)}function w(a,f,l){let {x:d,y:b}=f;
const {width:g,height:z}=l;if(0===d&&0===b&&z===a.height&&g===a.width)return a;const {width:v,height:C}=a;f=Math.max(0,b);const y=Math.max(0,d),A=Math.min(d+g,v),x=Math.min(b+z,C);if(0>A||0>x||!L(a))return null;d=Math.max(0,-d);b=Math.max(0,-b);var {pixels:E}=a,N=g*z,G=E.length;const O=[];for(var H=0;H<G;H++){var J=E[H],R=u.createEmptyBand(a.pixelType,N);for(let Y=f;Y<x;Y++){const T=Y*v;let X=(Y+b-f)*g+d;for(let V=y;V<A;V++)R[X++]=J[T+V]}O.push(R)}E=new Uint8Array(N);N=a.mask;for(G=f;G<x;G++)for(H=
G*v,J=(G+b-f)*g+d,R=y;R<A;R++)E[J++]=N?N[H+R]:1;a=new u({width:l.width,height:l.height,pixelType:a.pixelType,pixels:O,mask:E});a.updateStatistics();return a}function k(a,f=!0){if(!L(a))return null;const {pixels:l,width:d,height:b,mask:g,pixelType:z}=a;a=[];const v=Math.round(d/2),C=Math.round(b/2),y=b-1,A=d-1;for(var x=0;x<l.length;x++){var E=l[x],N=u.createEmptyBand(z,v*C),G=0;for(var O=0;O<b;O+=2)for(var H=0;H<d;H+=2){var J=E[O*d+H];if(f){var R=H===A?J:E[O*d+H+1];const Y=O===y?J:E[O*d+H+d],T=H===
A?Y:O===y?R:E[O*d+H+d+1];N[G++]=(J+R+Y+T)/4}else N[G++]=J}a.push(N)}x=null;if(null!=g)for(x=new Uint8Array(v*C),E=0,N=0;N<b;N+=2)for(G=0;G<d;G+=2)O=g[N*d+G],f?(H=G===A?O:g[N*d+G+1],J=N===y?O:g[N*d+G+d],R=G===A?J:N===y?H:g[N*d+G+d+1],x[E++]=O*H*J*R?1:0):x[E++]=O;return new u({width:v,height:C,pixelType:z,pixels:a,mask:x})}function r(a,f,l,d,b=0){const {width:g,height:z}=a,{width:v,height:C}=f;a=d.cols;d=d.rows;f=Math.ceil(v/a-.1/a);const y=Math.ceil(C/d-.1/d);let A,x,E,N,G;const O=f*a;var H=O*y*d;
const J=new Float32Array(H),R=new Float32Array(H),Y=new Uint32Array(H),T=new Uint32Array(H);let X=0,V,K;for(let ca=0;ca<y;ca++)for(let I=0;I<f;I++){var S=12*(ca*f+I);H=l[S];A=l[S+1];x=l[S+2];E=l[S+3];N=l[S+4];G=l[S+5];for(var Z=0;Z<d;Z++){X=(ca*d+Z)*O+I*a;K=(Z+.5)/d;for(let U=0;U<Z;U++)V=(U+.5)/a,J[X+U]=(H*V+A*K+x)*g+b,R[X+U]=(E*V+N*K+G)*z+b,Y[X+U]=Math.floor(J[X+U]),T[X+U]=Math.floor(R[X+U])}S+=6;H=l[S];A=l[S+1];x=l[S+2];E=l[S+3];N=l[S+4];G=l[S+5];for(S=0;S<d;S++)for(X=(ca*d+S)*O+I*a,K=(S+.5)/d,
Z=S;Z<a;Z++)V=(Z+.5)/a,J[X+Z]=(H*V+A*K+x)*g+b,R[X+Z]=(E*V+N*K+G)*z+b,Y[X+Z]=Math.floor(J[X+Z]),T[X+Z]=Math.floor(R[X+Z])}return{offsets_x:J,offsets_y:R,offsets_xi:Y,offsets_yi:T,gridWidth:O}}p.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(p.NoDataInterpretation||(p.NoDataInterpretation={}));p.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(p.MissingBandAction||(p.MissingBandAction={}));p.approximateTransform=
function(a,f,l,d,b="nearest"){if(!L(a))return null;"majority"===b&&(a=e(a));const {pixels:g,mask:z,bandMasks:v,pixelType:C}=a,y=a.width;var A=a.height;const x=u.getPixelArrayConstructor(C),E=g.length,{width:N,height:G}=f;a=!1;for(var O=0;O<l.length;O+=3)-1===l[O]&&-1===l[O+1]&&-1===l[O+2]&&(a=!0);const {offsets_x:H,offsets_y:J,offsets_xi:R,offsets_yi:Y,gridWidth:T}=r({width:y,height:A},f,l,d,"majority"===b?.5:0);let X;f=(K,S,Z,ca)=>{const I=K instanceof Float32Array||K instanceof Float64Array?0:.5;
for(let U=0;U<G;U++){X=U*T;for(let W=0;W<N;W++){if(0>H[X]||0>J[X])K[U*N+W]=0;else if(ca)K[U*N+W]=S[R[X]+Y[X]*y];else{const aa=Math.floor(H[X]),da=Math.floor(J[X]),ea=Math.ceil(H[X]),ha=Math.ceil(J[X]),ia=H[X]-aa,ka=J[X]-da;K[U*N+W]=!Z||Z[aa+da*y]&&Z[ea+da*y]&&Z[aa+ha*y]&&Z[ea+ha*y]?(1-ka)*((1-ia)*S[aa+da*y]+ia*S[ea+da*y])+ka*((1-ia)*S[aa+ha*y]+ia*S[ea+ha*y])+I:S[R[X]+Y[X]*y]}X++}}};l=[];d=v?.length===E;A=[];for(O=0;O<E;O++){if(d){var V=new Uint8Array(N*G);f(V,v[O],v[O],!0);A.push(V)}V=new x(N*G);
f(V,g[O],d?v[O]:z,"nearest"===b||"majority"===b);l.push(V)}b=new u({width:N,height:G,pixelType:C,pixels:l,bandMasks:d?A:void 0});if(null!=z)b.mask=new Uint8Array(N*G),f(b.mask,z,z,!0);else if(a)for(b.mask=new Uint8Array(N*G),a=0;a<N*G;a++)b.mask[a]=0>H[a]||0>J[a]?0:1;b.updateStatistics();return b};p.clip=w;p.clipTile=function(a){const {pixelBlock:f,tileSize:l,level:d,row:b,col:g,useBilinear:z}=a;if(!L(f))return null;const {width:v,height:C}=l;var y=2**d;a=y*v;y*=C;a=w(f,{y:b*y,x:g*a},{width:a,height:y});
if(!a)return null;for(y=d;0<y;y--)a=k(a,z);return a};p.colorize=function(a,f){if(!L(a)||!f||!f.indexedColormap&&!f.indexed2DColormap)return a;const l=a.clone();var d=l.pixels;let b=l.mask;const g=l.width*l.height;if(1!==d.length)return a;const {indexedColormap:z,indexed2DColormap:v,offset:C,alphaSpecified:y}=f;a=0;d=d[0];f=new Uint8Array(d.length);const A=new Uint8Array(d.length),x=new Uint8Array(d.length);var E=0;if(z){const N=z.length-1;if(null!=b)for(a=0;a<g;a++)b[a]&&(E=4*(d[a]-C),E<C||E>N?b[a]=
0:(f[a]=z[E],A[a]=z[E+1],x[a]=z[E+2],b[a]=z[E+3]));else{b=new Uint8Array(g);for(a=0;a<g;a++)E=4*(d[a]-C),E<C||E>N?b[a]=0:(f[a]=z[E],A[a]=z[E+1],x[a]=z[E+2],b[a]=z[E+3]);l.mask=b}}else if(v)if(null!=b)for(a=0;a<g;a++)b[a]&&(E=v[d[a]],f[a]=E[0],A[a]=E[1],x[a]=E[2],b[a]=E[3]);else{b=new Uint8Array(g);for(a=0;a<g;a++)E=v[d[a]],f[a]=E[0],A[a]=E[1],x[a]=E[2],b[a]=E[3];l.mask=b}l.pixels=[f,A,x];l.statistics=null;l.pixelType="u8";l.maskIsAlpha=y;return l};p.compositeBands=function(a){if(!a?.length||a.some(C=>
!L(C)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:f,height:l,pixelType:d}=a[0];if(a.some(C=>C.width!==f||C.height!==l))return null;const b=a.map(({mask:C})=>C).filter(C=>null!=C);let g=null;b.length&&(g=new Uint8Array(f*l),g.set(b[0]),1<b.length&&Q(b.slice(1),g));const z=[];a.forEach(({pixels:C})=>z.push(...C));const v=[];a.map(({statistics:C})=>C).filter(C=>C?.length).forEach(C=>v.push(...C));return new u({pixelType:d,width:f,height:l,mask:g,pixels:z,statistics:v.length?
v:null})};p.createColormapLUT=function(a){if(a){var f=a.colormap;if(f&&0!==f.length){f=f.sort((y,A)=>y[0]-A[0]);var l=0;0>f[0][0]&&(l=f[0][0]);var d=Math.max(256,f[f.length-1][0]-l+1),b=new Uint8Array(4*d),g=[],z=0,v=0,C=5===f[0].length;if(65536<d)return f.forEach(y=>{g[y[0]-l]=C?y.slice(1):y.slice(1).concat([255])}),{indexed2DColormap:g,offset:l,alphaSpecified:C};if(a.fillUnspecified)for(a=f[v],z=a[0]-l;z<d;z++)b[4*z]=a[1],b[4*z+1]=a[2],b[4*z+2]=a[3],b[4*z+3]=C?a[4]:255,z===a[0]-l&&(a=v===f.length-
1?a:f[++v]);else for(z=0;z<f.length;z++)a=f[z],v=4*(a[0]-l),b[v]=a[1],b[v+1]=a[2],b[v+2]=a[3],b[v+3]=C?a[4]:255;return{indexedColormap:b,offset:l,alphaSpecified:C}}}};p.createMaskLUT=function(a,f,l){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var d=a.includes("16")?65536:256;a=a.includes("s")?-d/2:0;d=new Uint8Array(d);if(f)for(let g=0;g<f.length;g++){var b=Math.ceil(f[2*g]-a);const z=Math.floor(f[2*g+1]-a);for(;b<=z;b++)d[b]=255}else d.fill(255);if(l)for(f=0;f<l.length;f++)d[l[f]-a]=
0;return{lut:d,offset:a}};p.createRemapLUT=function(a){const {srcPixelType:f,inputRanges:l,outputValues:d,allowUnmatched:b,noDataRanges:g,isLastInputRangeInclusive:z,outputPixelType:v}=a;if("u8"!==f&&"s8"!==f&&"u16"!==f&&"s16"!==f)return null;var C=f.includes("16")?65536:256;a=f.includes("s")?-C/2:0;const y=u.createEmptyBand(v,C);C=new Uint8Array(C);b&&C.fill(255);const [A,x]=t.getPixelValueRange(v);if(l?.length&&d?.length){var E=l.map(H=>H-1E-6);E[0]=l[0];z&&(E[E.length-1]=l[l.length-1]);for(var N=
0;N<E.length;N++){var G=d[N]>x?x:d[N]<A?A:d[N],O=Math.ceil(E[2*N]-a);const H=Math.floor(E[2*N+1]-a);for(;O<=H;O++)y[O]=G,C[O]=255}}if(g?.length)for(E=0;E<g.length;E++)for(G=Math.ceil(g[2*E]-a),N=Math.floor(g[2*E+1]-a);G<=N;G++)C[G]=0;return{lut:y,offset:a,mask:C}};p.extractBands=function(a,f){return f?.length&&L(a)?a.extractBands(f):a};p.getClipBounds=B;p.getLocalArithmeticNorthRotations=function(a,f){const {coefficients:l,spacing:d}=f,{offsets_x:b,offsets_y:g,gridWidth:z}=r(a,a,l,{rows:d[0],cols:d[1]}),
{width:v,height:C}=a;a=new Float32Array(v*C);f=180/Math.PI;for(let x=0;x<C;x++)for(let E=0;E<v;E++){var y=x*z+E,A=0===x?y:y-z;const N=x===C-1?y:y+z;y=b[A]-b[N];A=g[N]-g[A];isNaN(y)||isNaN(A)?a[x*v+E]=90:(A=Math.atan2(A,y)*f,A=(360+A)%360,a[x*v+E]=A)}return a};p.interpolateOffsets=r;p.isValidPixelBlock=L;p.lookupBandValues=F;p.lookupPixels=function(a,f){if(!L(a))return null;const {pixels:l,mask:d}=a,b=l.length;let g=f.lut;const {offset:z}=f;g&&1===g[0].length&&(g=l.map(()=>g));const v=[];f=f.outputPixelType||
"u8";for(let C=0;C<b;C++){const y=F(l[C],d,g[C],z||0,f);v.push(y)}a=new u({width:a.width,height:a.height,pixels:v,mask:d,pixelType:f});a.updateStatistics();return a};p.mask=function(a,f){if(!L(a))return null;const {width:l,height:d,pixels:b}=a;var g=l*d;const z=new Uint8Array(g);a.mask?z.set(a.mask):z.fill(255);a=b.length;const {includedRanges:v,noDataValues:C,outputPixelType:y,matchAll:A,lookups:x}=f;if(x){g=[];for(f=0;f<a;f++){var E=x[f];E=F(b[f],z,E.lut,E.offset||0,"u8");g.push(E)}1===g.length?
z.set(g[0]):A?M(g,z):Q(g,z)}else if(A){f=[];for(E=0;E<a;E++){const N=new Uint8Array(g);N.set(z);P(b[E],v?.slice(2*E,2*E+2),C?.[E],N);f.push(N)}1===f.length?z.set(f[0]):M(f,z)}else for(g=0;g<a;g++)P(b[g],v?.slice(2*g,2*g+2),C?.[g],z);return new u({width:l,height:d,pixelType:y,pixels:b,mask:z})};p.maxMapSizeGpu=6;p.mosaic=q;p.mosaicPixelData=function(a,f){if(!a||0===a.length)return null;var l=a.find(x=>x.pixelBlock);if(null==l?.pixelBlock)return null;var d=(l.extent.xmax-l.extent.xmin)/l.pixelBlock.width;
const b=(l.extent.ymax-l.extent.ymin)/l.pixelBlock.height,g=.01*Math.min(d,b),z=a.sort((x,E)=>Math.abs(x.extent.ymax-E.extent.ymax)>g?E.extent.ymax-x.extent.ymax:Math.abs(x.extent.xmin-E.extent.xmin)>g?x.extent.xmin-E.extent.xmin:0);var v=Math.min.apply(null,z.map(x=>x.extent.xmin));const C=Math.min.apply(null,z.map(x=>x.extent.ymin)),y=Math.max.apply(null,z.map(x=>x.extent.xmax)),A=Math.max.apply(null,z.map(x=>x.extent.ymax));a={x:Math.round((f.xmin-v)/d),y:Math.round((A-f.ymax)/b)};v={width:Math.round((y-
v)/d),height:Math.round((A-C)/b)};d={width:Math.round((f.xmax-f.xmin)/d),height:Math.round((f.ymax-f.ymin)/b)};if(Math.round(v.width/l.pixelBlock.width)*Math.round(v.height/l.pixelBlock.height)!==z.length||0>a.x||0>a.y||v.width<d.width||v.height<d.height)return null;l=z.map(x=>x.pixelBlock);l=q(l,v,{clipOffset:a,clipSize:d});return{extent:f,pixelBlock:l}};p.remap=function(a,f){if(!L(a))return null;const {width:l,height:d}=a,{inputRanges:b,outputValues:g,outputPixelType:z,noDataRanges:v,allowUnmatched:C,
isLastInputRangeInclusive:y}=f;f=a.pixels[0];const A=u.createEmptyBand(z,f.length),x=a.mask,E=new Uint8Array(l*d);x?E.set(x):E.fill(255);const N=a.pixelType.startsWith("f")?1E-6:0;a=b.map(X=>X-N);a[0]=b[0];a[a.length-1]=b[b.length-1]+(y?1E-6:0);var G=b.length/2;const [O,H]=t.getPixelValueRange(z);for(var J=0;J<d;J++)for(var R=0;R<l;R++){var Y=J*l+R;if(E[Y]){var T=f[Y];let X=!1;for(let V=G-1;0<=V;V--)if(T===a[2*V]||T>a[2*V]&&T<a[2*V+1]){A[Y]=g[V];X=!0;break}X||(C?A[Y]=T>H?H:T<O?O:T:E[Y]=0)}}if(a=v?.length)for(G=
0;G<d;G++)for(J=0;J<l;J++)if(R=G*l+J,!x||x[R])for(Y=f[R],T=0;T<a;T+=2)if(Y>=v[T]&&Y<=v[T+1]){A[R]=0;E[R]=0;break}return new u({width:l,height:d,pixelType:z,pixels:[A],mask:E})};p.remapColor=function(a,f){if(!L(a))return null;a=a.clone();var {pixels:l}=a;const d=a.width*a.height,b=f.length,g=Math.floor(b/2),z=f[Math.floor(g)];l=l[0];let v,C,y,A,x,E,N=!1;const G=new Uint8Array(d),O=new Uint8Array(d),H=new Uint8Array(d);let J=a.mask;const R=4===f[0].mappedColor.length;J||(J=new Uint8Array(d),J.fill(R?
255:1),a.mask=J);for(x=0;x<d;x++)if(J[x]){v=l[x];N=!1;E=g;C=z;y=0;for(A=b-1;1<A-y;){if(v===C.value){N=!0;break}v>C.value?y=E:A=E;E=Math.floor((y+A)/2);C=f[Math.floor(E)]}N||(v===f[y].value?(C=f[y],N=!0):v===f[A].value?(C=f[A],N=!0):v<f[y].value?(N=!1,C=null):v>f[y].value&&(v<f[A].value?(C=f[y],N=!0):A===b-1?(N=!1,C=null):(C=f[A],N=!0)));N?(G[x]=C.mappedColor[0],O[x]=C.mappedColor[1],H[x]=C.mappedColor[2],J[x]=C.mappedColor[3]):G[x]=O[x]=H[x]=J[x]=0}a.pixels=[G,O,H];a.mask=J;a.pixelType="u8";a.maskIsAlpha=
R;return a};p.resampleByMajority=e;p.setValidBoundary=function(a,f,l){if(!L(a))return null;const {width:d,height:b}=a,g=f.x;f=f.y;const z=l.width+g;l=l.height+f;if(0>g||0>f||z>d||l>b||0===g&&0===f&&z===d&&l===b)return a;a.mask||(a.mask=new Uint8Array(d*b));const v=a.mask;for(let C=0;C<b;C++){const y=C*d;for(let A=0;A<d;A++)v[y+A]=C<f||C>=l||A<g||A>=z?0:1}a.updateStatistics();return a};p.split=function(a,f,l=0,d=!0){if(!L(a))return null;const {width:b,height:g}=f;let {width:z,height:v}=a;const C=new Map,
y={x:0,y:0};l=1+l;for(let A=0;A<l;A++){const x=Math.ceil(z/b),E=Math.ceil(v/g);for(let N=0;N<E;N++){y.y=N*g;for(let G=0;G<x;G++){y.x=G*b;const O=w(a,y,f);C.set(`${A}/${N}/${G}`,O)}}A<l-1&&(a=k(a,d));z=Math.round(z/2);v=Math.round(v/2)}return C};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c){function e(b){b=b.symbolLayers;if(!b)return null;let g=null;b.forEach(z=>{"object"===z.type&&z.resource?.href||(g="water"===z.type?z.color:z.material?z.material.color:null)});return g?new t(g):null}function n(b,g){if(null==g||null==b)return b;b=b.toRgba();b[3]*=g;return new t(b)}function h(b,g,z){if(b=b.symbolLayers){var v=C=>{g=g??C??(null!=z?d:null);return n(g,z)};b.forEach(C=>{if("object"!==C.type||!C.resource?.href||g)if("water"===C.type)C.color=v(C.color);else{const y=
v(null!=C.material?C.material.color:null);null==C.material?C.material=new c.Symbol3DMaterial({color:y}):C.material.color=y;null!=z&&"outline"in C&&null!=C.outline?.color&&(C.outline.color=n(C.outline.color,z))}})}}async function m(b,g){(b=b.symbolLayers)&&await F.forEach(b,async z=>w(z,g))}async function w(b,g){switch(b.type){case "extrude":b.size="number"===typeof g[2]?g[2]:0;break;case "icon":case "line":case "text":g=k(g);null!=g&&(b.size=g);break;case "path":const z=a(g,Q.ONES,[b.width,void 0,
b.height]);b.width=l(g[0],b.width,1,z);b.height=l(g[2],b.height,1,z);break;case "object":await r(b,g)}}function k(b){for(const g of b)if("number"===typeof g)return g;return null}async function r(b,g){const {resourceSize:z,symbolSize:v}=await f(b),C=a(g,z,v);b.width=l(g[0],v[0],z[0],C);b.depth=l(g[1],v[1],z[1],C);b.height=l(g[2],v[2],z[2],C)}function a(b,g,z){for(let v=0;3>v;v++){const C=b[v];switch(C){case "symbol-value":return b=z[v],null!=b?b/g[v]:1;case "proportional":break;default:if(C&&g[v])return C/
g[v]}}return 1}async function f(b){var {computeObjectLayerResourceSize:g}=await new Promise((x,E)=>p(["./symbolLayerUtils"],x,E));g=await g(b,10);const {width:z,height:v,depth:C}=b;b=[z,C,v];let y=1;for(var A=0;3>A;A++){const x=b[A];if(null!=x){y=x/g[A];break}}for(A=0;3>A;A++)null==b[A]&&(b[A]=g[A]*y);return{resourceSize:g,symbolSize:b}}function l(b,g,z,v){switch(b){case "proportional":return z*v;case "symbol-value":return null!=g?g:z;default:return b}}const d=new t("white");u.applyColorToSymbol=
function(b,g,z){if(b&&(g||null!=z))if(g&&=new t(g),L.isSymbol3D(b))h(b,g,z);else if(L.isSymbol2D(b)){if(g=g??b.color)b.color=n(g,z);null!=z&&"outline"in b&&b.outline?.color&&(b.outline.color=n(b.outline.color,z))}};u.applyOpacityToColor=n;u.applyRotationToSymbol=function(b,g,z){b&&null!=g&&(L.isSymbol3D(b)?(b=b.symbolLayers)&&b.forEach(v=>{if("object"===v.type)switch(z){case "tilt":v.tilt=(v.tilt??0)+g;break;case "roll":v.roll=(v.roll??0)+g;break;default:v.heading=(v.heading??0)+g}"icon"===v.type&&
(v.angle+=g)}):!L.isSymbol2D(b)||"simple-marker"!==b.type&&"picture-marker"!==b.type&&"text"!==b.type||(b.angle+=g))};u.applySizesToSymbol=async function(b,g){if(b&&g){if(L.isSymbol3D(b))return m(b,g);if(L.isSymbol2D(b)&&(g=k(g),null!=g))switch(b.type){case "simple-marker":b.size=g;break;case "picture-marker":const z=b.width/b.height;1<z?(b.width=g,b.height=g*z):(b.width=g*z,b.height=g);break;case "simple-line":b.width=g;break;case "text":b.font.size=g}}};u.fetchWebStyleSymbol=async function(b,g){const z=
await b.fetchSymbol(g);return z?z:b.fetchCIMSymbol(g)};u.getCSSFilterFromEffectList=function(b){if(!b)return null;b=b.effects.filter(g=>"bloom"!==g.type).map(g=>g.toJSON());return B.effectFunctionsFromJSON(b)};u.getColorFromSymbol=function(b,g){if(!b)return null;let z=null;L.isSymbol3D(b)?z=e(b):L.isSymbol2D(b)&&(z="cim"===b.type?D.getCIMSymbolColor(b):b.color?new t(b.color):null);return z?n(z,g):null};u.getIconHref=function(b){return b.resource?.href??""};u.getSymbolOutlineSize=function(b){return b?
L.isSymbol3D(b)?(b=(b=b.symbolLayers?.at(-1))&&"outline"in b?b?.outline?.size:void 0,null!=b?b:0):M.px2pt(q.getStroke(b)?.width):0};u.isVolumetricSymbol=function(b){if(null==b||!("symbolLayers"in b)||null==b.symbolLayers)return!1;switch(b.type){case "point-3d":return b.symbolLayers.some(g=>"object"===g.type);case "line-3d":return b.symbolLayers.some(g=>"path"===g.type);case "polygon-3d":return b.symbolLayers.some(g=>"object"===g.type||"extrude"===g.type);default:return!1}};u.symbolHasExtrudeSymbolLayer=
function(b){return null!=b&&"polygon-3d"===b.type&&b.symbolLayers.some(g=>"extrude"===g.type)};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(p,u,t){function L(c){c=t.toCIMSymbolJSON(c);if("CIMTextSymbol"===c?.type)return c.height??0;let e=0;if(c?.symbolLayers)for(const n of c.symbolLayers)t.isCIMMarker(n)&&null!=n.size&&n.size>e?e=n.size:t.isCIMStroke(n)&&null!=n.width&&n.width>
e?e=n.width:t.isCIMFill(n);return e}function F(c,e,n,h){if(c)if("CIMTextSymbol"===c.type)null!=c.height&&(c.height*=e);else{if(n&&c.effects)for(const m of c.effects)Q(m,e);if(c.symbolLayers)for(const m of c.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":P(m,e,h);break;case "CIMPictureStroke":case "CIMSolidStroke":!h?.preserveOutlineWidth&&m.width&&(m.width*=e);break;case "CIMPictureFill":m.height&&(m.height*=e);m.offsetX&&(m.offsetX*=e);m.offsetY&&(m.offsetY*=e);break;
case "CIMHatchFill":F(m.lineSymbol,e,!0,{...h,preserveOutlineWidth:!1}),m.offsetX&&(m.offsetX*=e),m.offsetY&&(m.offsetY*=e),m.separation&&(m.separation*=e)}}}function P(c,e,n){if(c&&(c.markerPlacement&&M(c.markerPlacement,e),c.offsetX&&(c.offsetX*=e),c.offsetY&&(c.offsetY*=e),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*e,y:c.anchorPoint.y*e}),c.size=null!=c.size?c.size*e:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const h of c.markerGraphics)c.scaleSymbolsProportionally||
F(h.symbol,e,!0,n)}function M(c,e){t.isCIMMarkerStrokePlacement(c)&&c.offset&&(c.offset*=e);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=e);if(c.placementTemplate&&c.placementTemplate.length){var n=c.placementTemplate.map(h=>h*e);c.placementTemplate=n}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=e);c.placementTemplate&&
c.placementTemplate.length&&(n=c.placementTemplate.map(h=>h*e),c.placementTemplate=n);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=e);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=e);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=e);c.endPosition&&(c.endPosition*=e);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&
(c.offsetX*=e),c.offsetY&&(c.offsetY*=e),c.stepX&&(c.stepX*=e),c.stepY&&(c.stepY*=e)}}function Q(c,e){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=e);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=e);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=e);c.endCut&&(c.endCut*=e);c.middleCut&&(c.middleCut*=e);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=
e);if(c.dashTemplate&&c.dashTemplate.length){const n=c.dashTemplate.map(h=>h*e);c.dashTemplate=n}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=e);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=e);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=e);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&
(c.fromWidth*=e);c.length&&(c.length*=e);c.toWidth&&(c.toWidth*=e);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=e),c.period&&(c.period*=e)}}function B(c,e){if(c){var n="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(n?.symbolLayers)for(const h of n.symbolLayers)if(!(h.colorLocked||c&&(t.isCIMStroke(h)||t.isCIMMarker(h)&&h.markerPlacement&&t.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor&&
D(e,h.tintColor);break;case "CIMVectorMarker":h.markerGraphics?.forEach(m=>{B(m.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":D(e,h.color);break;case "CIMHatchFill":B(h.lineSymbol,e)}}}function D(c,e){for(const n of c)if(n.join(".")===e.join("."))return;c.push(e)}function q(c,e,n){if(c){var h="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===h?.type;if(h?.symbolLayers)for(const m of h.symbolLayers)if(!m.colorLocked){if(c)if(n){if({layersToColor:h}=n,(t.isCIMStroke(m)||t.isCIMMarker(m)&&
m.markerPlacement&&t.isCIMMarkerStrokePlacement(m.markerPlacement))&&"fill"===h||t.isCIMFill(m)&&"outline"===h)continue}else if(t.isCIMStroke(m)||t.isCIMMarker(m)&&m.markerPlacement&&t.isCIMMarkerStrokePlacement(m.markerPlacement))continue;h=e.toArray();switch(m.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":m.tintColor=h;break;case "CIMVectorMarker":m.markerGraphics?.forEach(w=>{q(w.symbol,e,n)});break;case "CIMSolidStroke":case "CIMSolidFill":m.color=h;break;case "CIMHatchFill":q(m.lineSymbol,
e,n)}}}}p.applyCIMSymbolColor=function(c,e,n){e instanceof u||(e=new u(e));(c=t.toCIMSymbolJSON(c))&&q(c,e,n)};p.applyCIMSymbolRotation=function(c,e,n=!1){c=t.toCIMSymbolJSON(c);n&&(e=360-e);if("CIMTextSymbol"===c?.type)c.angle=e;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){n=e-(c.angle||0);for(const h of c.symbolLayers)if(t.isCIMMarker(h)){let m=h.rotation||0;m=h.rotateClockwise?m-n:m+n;h.rotation=m}c.angle=e}};p.getCIMSymbolColor=function(c){c=t.toCIMSymbolJSON(c);const e=[];B(c,e);return e.length?
new u(t.normalizeAlpha(e[0])):null};p.getCIMSymbolRotation=function(c,e=!1){c=t.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&e?360-c:c??0):0};p.getCIMSymbolSize=L;p.getCIMSymbolType=function(c){c=t.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";
default:return null}};p.scaleCIMMarker=P;p.scaleCIMSymbol=F;p.scaleCIMSymbolTo=function(c,e,n){if(c){var h=t.toCIMSymbolJSON(c);c=L(c);if(0===c){if(h)if("CIMTextSymbol"===h.type)h.height=e;else if(h.symbolLayers)for(const m of h.symbolLayers)switch(m.type){case "CIMPictureMarker":case "CIMVectorMarker":m.size=e;break;case "CIMPictureStroke":case "CIMSolidStroke":m.width=e}}else F(h,e/c,!1,n)}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(p,u,t,L,F,P,M){function Q(e){if(!e)return null;let n=null;switch(e.type){case "simple-fill":case "picture-fill":case "simple-marker":n=Q(e.outline);break;case "simple-line":const h=P.pt2px(e.width);null!=e.style&&"none"!==e.style&&0!==h&&(n={color:e.color,style:c(e.style),width:h,cap:e.cap,join:"miter"===e.join?P.pt2px(e.miterLimit):e.join},n.dashArray=B(n).join(",")||"none");break;default:n=null}return n}function B(e){if(!e?.style)return[];const {dashArray:n,style:h,width:m}=e;if("string"===
typeof n&&"none"!==n)return n.split(",").map(r=>Number(r));const w=m??0,k=D.has(h)?D.get(h).map(r=>r*w):[];if("butt"!==e.cap)for(const [r,a]of k.entries())k[r]=1===r%2?a+w:Math.max(a-w,1);return k}const D=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),q=new F.LRUCache(1E3),c=(()=>{const e={};return n=>
{if(e[n])return e[n];const h=n.replaceAll("-","");return e[n]=h}})();t=new t([128,128,128]);p.defaultThematicColor=t;p.dekebabifyLineStyle=c;p.getDashArray=B;p.getFill=function(e){const n=e.style;let h=null;if(e)switch(e.type){case "simple-marker":"cross"!==n&&"x"!==n&&(h=e.color);break;case "simple-fill":n&&"solid"!==n?"none"!==n&&(h={type:"pattern",x:0,y:0,src:u.getAssetUrl(`esri/symbols/patterns/${n}.png`),width:5,height:5}):h=e.color;break;case "picture-fill":h={type:"pattern",src:e.url,width:P.pt2px(e.width)*
e.xscale,height:P.pt2px(e.height)*e.yscale,x:P.pt2px(e.xoffset),y:P.pt2px(e.yoffset)};break;case "text":h=e.color;break;case "cim":h=M.getCIMSymbolColor(e)}return h};p.getPatternUrlWithColor=function(e,n){const h=e+"-"+n;return void 0!==q.get(h)?Promise.resolve(q.get(h)):L(e,{responseType:"image"}).then(m=>{m=m.data;const w=m.naturalWidth,k=m.naturalHeight,r=document.createElement("canvas");r.width=w;r.height=k;const a=r.getContext("2d");a.fillStyle=n;a.fillRect(0,0,w,k);a.globalCompositeOperation=
"destination-in";a.drawImage(m,0,0);m=r.toDataURL();q.put(h,m);return m})};p.getStroke=Q;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/DimensionalDefinition":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass".split(" "),function(p,u,t,L,F,P){var M;u=M=class extends u.JSONSupport{constructor(Q){super(Q);
this.dimensionName=this.variableName=null;this.values=[];this.isSlice=!1}clone(){return new M({variableName:this.variableName,dimensionName:this.dimensionName,values:t.clone(this.values),isSlice:this.isSlice})}};p.__decorate([L.property({type:String,json:{write:!0}})],u.prototype,"variableName",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],u.prototype,"dimensionName",void 0);p.__decorate([L.property({type:F.types.array(F.types.oneOf([F.types.native(Number),F.types.array(F.types.native(Number))])),
json:{write:!0}})],u.prototype,"values",void 0);p.__decorate([L.property({type:Boolean,json:{write:!0}})],u.prototype,"isSlice",void 0);return u=M=p.__decorate([P.subclass("esri.layers.support.DimensionalDefinition")],u)})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){var n;u={base:e,key:"type",typeMap:{extent:B,polygon:D}};t=n=class extends t.JSONSupport{constructor(h){super(h);this.subsetDefinitions=this.areaOfInterest=null}get dimensions(){var {subsetDefinitions:h}=this;if(null==h||0===h.length)return[];const m=new Map;h.forEach(w=>{if(w.dimensionName){if(Array.isArray(w.values[0])){var k=w.values;var r=k[0][0];k=k[w.values.length-1][1]}else k=w.values,r=k[0],k=k[w.values.length-1];m.has(w.dimensionName)?(w=m.get(w.dimensionName),
w[0]=Math.min(r,w[0]),w[1]=Math.max(k,w[1])):m.set(w.dimensionName,[r,k])}});h=[];for(const w of m)h.push({name:w[0],extent:w[1]});return h}get variables(){const {subsetDefinitions:h}=this;if(null==h||0===h.length)return[];const m=new Set;h.forEach(w=>{w.variableName&&m.add(w.variableName)});return[...m]}clone(){const h=this.subsetDefinitions?.map(w=>w.clone()),m=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new n({areaOfInterest:m,subsetDefinitions:h})}};p.__decorate([L.property({types:u,
json:{read:q.fromJSON,write:!0}})],t.prototype,"areaOfInterest",void 0);p.__decorate([L.property({readOnly:!0})],t.prototype,"dimensions",null);p.__decorate([L.property({readOnly:!0})],t.prototype,"variables",null);p.__decorate([L.property({type:[c],json:{write:!0}})],t.prototype,"subsetDefinitions",void 0);return t=n=p.__decorate([Q.subclass("esri.layers.support.MultidimensionalSubset")],t)})},"esri/layers/support/rasterEnums":function(){define(["exports","../../core/jsonMap"],function(p,u){const t=
u.strict()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),L=u.strict()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"});u=u.strict()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});p.interpolationKebab=t;p.noDataInterpretationKebab=L;p.pixelTypeKebabDict=u;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/RasterFunction":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./RasterFunctionTemplate".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q){var c;const e=new Set(["raster","raster2","dem","fillraster"]),n=new Set(["rasters"]),h=r=>r?.rasterFunction?k.fromJSON(r):r,m=r=>r&&r instanceof k?r.toJSON():r,w=r=>r?.functionName&&!r.declaredClass?new k(r):r;F={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:q}},json:{write:!0,name:"rasterFunctionDefinition"}};let k=c=class extends u.JSONSupport{constructor(r){super(r);this.functionName=null;this.outputPixelType="unknown";this.functionDefinition=this.variableName=
null}set functionArguments(r){if(r){const a=Object.keys(r);if(a.some(f=>{var l;if(l=e.has(f.toLowerCase()))f=r[f],l=f?.functionName&&!f.declaredClass;return l})||a.some(f=>n.has(f.toLowerCase())&&Array.isArray(r[f])&&r[f].some(l=>l?.functionName&&!l.declaredClass))){r=t.clone(r);for(const f of a)e.has(f.toLowerCase())?r[f]=w(r[f]):n.has(f.toLowerCase())&&Array.isArray(r[f])&&(r[f]=r[f].map(l=>w(l)))}}this._set("functionArguments",r)}readFunctionArguments(r){if(null==r)var a=null;else{r=t.clone(r);
var f={};for(a of Object.keys(r))e.has(a.toLowerCase())?f[a]=h(r[a]):n.has(a.toLowerCase())&&Array.isArray(r[a])?f[a]=r[a].map(h):f[a]=r[a];a=f}return a}writeFunctionArguments(r,a,f){const l={};for(const d of Object.keys(r))e.has(d.toLowerCase())?l[d]=m(r[d]):n.has(d.toLowerCase())&&Array.isArray(r[d])?l[d]=r[d].map(m):l[d]=m(r[d]);a[f]=l}readFunctionName(r,a){r=a.rasterFunctionInfos;const f=a.name;return f?f:r?.length&&"None"!==r[0].name?r[0].name:a.rasterFunction||a.rasterFunctionDefinition?.name}get rasterFunctionDefinition(){return this.functionDefinition?.toJSON()}set rasterFunctionDefinition(r){this.functionDefinition=
r?q.fromJSON(r):null}get hasClipFunction(){return this.rasterFunctionDefinition?JSON.stringify(this.rasterFunctionDefinition).includes('"type":"ClipFunction"'):JSON.stringify(this).includes('"rasterFunction":"Clip"')}clone(){return new c({functionName:this.functionName,functionArguments:t.clone(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:t.clone(this.rasterFunctionDefinition)})}};p.__decorate([L.property({json:{type:Object,name:"rasterFunctionArguments"}})],
k.prototype,"functionArguments",null);p.__decorate([Q.reader("functionArguments")],k.prototype,"readFunctionArguments",null);p.__decorate([D.writer("functionArguments")],k.prototype,"writeFunctionArguments",null);p.__decorate([L.property({json:{type:String,write:{target:"rasterFunction"}}})],k.prototype,"functionName",void 0);p.__decorate([Q.reader("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],k.prototype,"readFunctionName",null);p.__decorate([M.enumeration({C128:"c128",
C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1,default:"unknown"})],k.prototype,"outputPixelType",void 0);p.__decorate([L.property({type:String,json:{read:!0,write:!0}})],k.prototype,"variableName",void 0);p.__decorate([L.property()],k.prototype,"rasterFunctionDefinition",null);p.__decorate([L.property(F)],k.prototype,"functionDefinition",void 0);p.__decorate([L.property()],k.prototype,"hasClipFunction",
null);return k=c=p.__decorate([B.subclass("esri.layers.support.RasterFunction")],k)})},"esri/layers/support/RasterFunctionTemplate":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionInfo ./RasterFunctionProperties".split(" "),function(p,u,t,L,F,P,M,Q,B,D){u=new u.JSONMap({0:"mosaic",
1:"item",2:"item-group"},{useNumericKeys:!0});t=class extends t.JSONSupport{constructor(){super(...arguments);this.functionType="mosaic";this.type="RasterFunctionTemplate"}};p.__decorate([L.property({type:[String],json:{write:!0}})],t.prototype,"aliases",void 0);p.__decorate([L.property({type:Object,json:{write:!0}})],t.prototype,"arguments",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"description",void 0);p.__decorate([L.property({type:B,json:{write:!0,name:"function"}})],
t.prototype,"functionInfo",void 0);p.__decorate([L.property({type:u.apiValues,json:{type:[0,1,2],read:u.read,write:u.write}})],t.prototype,"functionType",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"group",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"help",void 0);p.__decorate([L.property({type:Number,json:{type:F.Integer,write:!0,name:"_object_id"}})],t.prototype,"id",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],
t.prototype,"name",void 0);p.__decorate([L.property({type:String,json:{write:!0,name:"definition"}})],t.prototype,"queryDefinition",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"tag",void 0);p.__decorate([L.property({type:D,json:{write:!0}})],t.prototype,"properties",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"thumbnail",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],t.prototype,"thumbnailEx",void 0);p.__decorate([L.property({json:{type:["RasterFunctionTemplate"],
write:!0}})],t.prototype,"type",void 0);return t=p.__decorate([Q.subclass("esri.layers.support.RasterFunctionTemplate")],t)})},"esri/layers/support/RasterFunctionInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./rasterEnums".split(" "),function(p,u,t,L,F,P,M,Q){u=class extends u.JSONSupport{constructor(){super(...arguments);
this.pixelType="unknown"}};p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,"name",void 0);p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,"description",void 0);p.__decorate([t.property({type:L.Integer,json:{type:L.Integer,write:!0,name:"_object_id"}})],u.prototype,"id",void 0);p.__decorate([t.property({type:String,json:{type:Q.pixelTypeKebabDict.jsonValues,read:Q.pixelTypeKebabDict.read,write:Q.pixelTypeKebabDict.write}})],u.prototype,"pixelType",void 0);
p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,"type",void 0);return u=p.__decorate([M.subclass("esri.layers.support.RasterFunctionInfo")],u)})},"esri/layers/support/RasterFunctionProperties":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./RasterFunctionVariable".split(" "),function(p,u,t,L,
F,P,M,Q){F={key:"type",base:null,typeMap:{RasterFunctionVariable:Q}};u=class extends u.JSONSupport{};p.__decorate([t.property({types:F,json:{types:F,name:"MatchVariable"}})],u.prototype,"matchVariable",void 0);p.__decorate([t.property({types:F,json:{types:F,name:"UnionDimension"}})],u.prototype,"unionDimension",void 0);p.__decorate([t.property({type:Number,json:{type:L.Integer,write:!0,name:"_object_id"}})],u.prototype,"id",void 0);p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,
"type",void 0);return u=p.__decorate([M.subclass("esri.layers.support.RasterFunctionProperties")],u)})},"esri/layers/support/RasterFunctionVariable":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(p,u,t,L,F,P,M){u=class extends u.JSONSupport{constructor(){super(...arguments);this.isPublic=this.isDataset=
!1;this.type="RasterFunctionVariable"}};p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,"name",void 0);p.__decorate([t.property({type:Number,json:{type:L.Integer,write:!0,name:"_object_id"}})],u.prototype,"id",void 0);p.__decorate([t.property({type:Boolean,json:{write:!0}})],u.prototype,"isDataset",void 0);p.__decorate([t.property({type:Boolean,json:{write:!0}})],u.prototype,"isPublic",void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"value",void 0);p.__decorate([t.property({type:String,
json:{write:!0}})],u.prototype,"type",void 0);return u=p.__decorate([M.subclass("esri.layers.support.RasterFunctionVariable")],u)})},"esri/layers/support/RasterJobHandler":function(){define(["../../core/Error","../../core/workers/workers","./PixelBlock"],function(p,u,t){class L{constructor(){this._workerThread=null;this._destroyed=!1}async initialize(){const F=await u.open("RasterWorker");this._destroyed?F.close():this._workerThread=F}destroy(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),
this._workerThread=null)}async convertVectorFieldData(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");return(F=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:F.pixelBlock.toJSON(),type:F.dataType},P))?new t(F):null}computeStatisticsHistograms(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:F.pixelBlock.toJSON()},
P)}async decode(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");return(F=await this._workerThread.invoke("decode",F,P))?new t(F):null}async symbolize(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");F={extent:F.extent?.toJSON(),pixelBlock:F.pixelBlock?.toJSON(),simpleStretchParams:F.simpleStretchParams,bandIds:F.bandIds};return(P=await this._workerThread.invoke("symbolize",F,P))?
new t(P):null}async updateSymbolizer(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");const M=F?.rendererJSON?.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:F.toJSON(),histograms:M},P))}async updateRasterFunction(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:F.toJSON()},
P))}async process(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");return(F=await this._workerThread.invoke("process",{extent:F.extent?.toJSON(),primaryPixelSizes:F.primaryPixelSizes?.map(M=>null!=M?M.toJSON():null),primaryPixelBlocks:F.primaryPixelBlocks.map(M=>null!=M?M.toJSON():null),primaryRasterIds:F.primaryRasterIds},P))?new t(F):null}async stretch(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");
if(!F?.pixelBlock)return null;F={srcPixelBlock:F.pixelBlock.toJSON(),stretchParams:F.stretchParams};return(P=await this._workerThread.invoke("stretch",F,P))?new t(P):null}async split(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");if(!F?.pixelBlock)return null;F={srcPixelBlock:F.pixelBlock.toJSON(),tileSize:F.tileSize,maximumPyramidLevel:F.maximumPyramidLevel,useBilinear:F.useBilinear};const M=await this._workerThread.invoke("split",F,P);
M&&M.forEach((Q,B)=>{M.set(B,Q?t.fromJSON(Q):null)});return M}async clipTile(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");if(!F?.pixelBlock)return null;F={...F,pixelBlock:F.pixelBlock.toJSON()};return(P=await this._workerThread.invoke("clipTile",F,P))?t.fromJSON(P):null}async estimateStatisticsHistograms(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");if(!F?.pixelBlock)return null;
F={srcPixelBlock:F.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",F,P)}async mosaicAndTransform(F,P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");if(!F?.srcPixelBlocks?.length)return{pixelBlock:null};F={...F,srcPixelBlocks:F.srcPixelBlocks.map(M=>null!=M?M.toJSON():null)};P=await this._workerThread.invoke("mosaicAndTransform",F,P);return{pixelBlock:P.pixelBlock?new t(P.pixelBlock):null,localNorthDirections:P.localNorthDirections}}async createFlowMesh(F,
P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");const M={buffer:F.flowData.data.buffer,maskBuffer:F.flowData.mask.buffer,width:F.flowData.width,height:F.flowData.height},{meshType:Q,simulationSettings:B}=F;F=await this._workerThread.invoke("createFlowMesh",{meshType:Q,flowData:M,simulationSettings:B},{...P,transferList:[M.buffer,M.maskBuffer]});return{vertexData:new Float32Array(F.vertexBuffer),indexData:new Uint32Array(F.indexBuffer)}}getProjectionOffsetGrid(F,
P){if(!this._workerThread)throw new p("raster-jobhandler:no-connection","no available worker connection");const M=null!=F.datumTransformation?F.datumTransformation.steps.map(B=>({wkid:B.wkid,wkt:B.wkt,isInverse:B.isInverse})):null,Q=null!=F.rasterTransform?F.rasterTransform.toJSON():null;F={projectedExtent:F.projectedExtent.toJSON(),srcBufferExtent:F.srcBufferExtent.toJSON(),pixelSize:F.pixelSize,hasWrapAround:F.hasWrapAround,spacing:F.spacing,datumTransformationSteps:M,rasterTransform:Q,isAdaptive:F.isAdaptive,
includeGCSGrid:F.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",F,P)}}return L})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k){var r;u=new u.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});t=r=class extends t.JSONSupport{static create(a={}){const {resolutionFactor:f=1,scales:l,size:d=256,spatialReference:b=e.WebMercator,numLODs:g=24}=a;if(!h.isValid(b)){a=[];if(l)for(var z=0;z<l.length;z++){var v=
l[z];a.push(new w({level:z,scale:v,resolution:v}))}else for(z=5E-4,v=g-1;0<=v;v--)a.unshift(new w({level:v,scale:z,resolution:z})),z*=2;return new r({dpi:96,lods:a,origin:new c(0,0,b),size:[d,d],spatialReference:b})}z=h.getInfo(b);a=a.origin?new c({x:a.origin.x,y:a.origin.y,spatialReference:b}):z?new c({x:z.origin[0],y:z.origin[1],spatialReference:b}):new c({x:0,y:0,spatialReference:b});z=1/(39.37*L.getMetersPerUnitForSR(b)*96);v=[];if(l)for(var C=0;C<l.length;C++){var y=l[C];v.push(new w({level:C,
scale:y,resolution:y*z}))}else{var A=h.isGeographic(b)?512/d*5.916575275917094E8:256/d*5.91657527591555E8;C=Math.ceil(g/f);v.push(new w({level:0,scale:A,resolution:A*z}));for(y=1;y<C;y++)A/=2**f,v.push(new w({level:y,scale:A,resolution:A*z}))}return new r({dpi:96,lods:v,origin:a,size:[d,d],spatialReference:b})}constructor(a){super(a);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:a,origin:f}=this;if(a&&f){const l=h.getInfo(a);return a.isWrappable&&
!!l&&Math.abs(l.origin[0]-f.x)<=l.dx}return!1}readOrigin(a,f){return c.fromJSON({spatialReference:f.spatialReference,...a})}set lods(a){const f=[],l=this._levelToLOD={};a&&a.forEach(d=>{f.push(d.scale);l[d.level]=d});this._set("scales",f);this._set("lods",a);this._initializeUpsampleLevels()}readSize(a,f){return[f.cols,f.rows]}writeSize(a,f){f.cols=a[0];f.rows=a[1]}zoomToScale(a){const f=this.scales;if(0>=a)return f[0];if(a>=f.length-1)return f[f.length-1];const l=Math.floor(a);return f[l]/(f[l]/f[l+
1])**(a-l)}scaleToZoom(a){const f=this.scales,l=f.length-1;let d=0;for(;d<l;d++){const b=f[d],g=f[d+1];if(b<=a)break;if(g===a)return d+1;if(b>a&&g<a)return d+Math.log(b/a)/Math.log(b/g)}return d}tileAt(a,f,l,d){var b=this.lodAt(a);if(!b)return null;let g;if("number"===typeof f)g=f,f=l;else{if(h.equals(f.spatialReference,this.spatialReference))g=f.x,f=f.y;else{d=m.project(f,this.spatialReference);if(null==d)return null;g=d.x;f=d.y}d=l}l=b.resolution*this.size[0];b=b.resolution*this.size[1];d||=new k.TileKey(null,
0,0,0,n.create());d.level=a;d.row=Math.floor((this.origin.y-f)/b+.001);d.col=Math.floor((g-this.origin.x)/l+.001);this.updateTileInfo(d);return d}updateTileInfo(a,f=r.ExtrapolateOptions.NONE){var l=this.lodAt(a.level);l||f!==r.ExtrapolateOptions.POWER_OF_TWO||(f=this.lods[this.lods.length-1],f.level<a.level&&(l=f));if(l){var d=a.level-l.level;f=l.resolution*this.size[0]/2**d;l=l.resolution*this.size[1]/2**d;a.id=`${a.level}/${a.row}/${a.col}`;a.extent||(a.extent=n.create());a.extent[0]=this.origin.x+
a.col*f;a.extent[1]=this.origin.y-(a.row+1)*l;a.extent[2]=a.extent[0]+f;a.extent[3]=a.extent[1]+l}}upsampleTile(a){const f=this._upsampleLevels[a.level];if(!f||-1===f.parentLevel)return!1;a.level=f.parentLevel;a.row=Math.floor(a.row/f.factor+.001);a.col=Math.floor(a.col/f.factor+.001);this.updateTileInfo(a);return!0}getTileBounds(a,f){var l=this.lodAt(f.level);if(null==l)return null;var {resolution:d}=l;l=d*this.size[0];d*=this.size[1];a[0]=this.origin.x+f.col*l;a[1]=this.origin.y-(f.row+1)*d;a[2]=
a[0]+l;a[3]=a[1]+d;return a}lodAt(a){return this._levelToLOD?.[a]??null}clone(){return r.fromJSON(this.write({}))}getCompatibleForVTL(a){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===a)return null;const f=(512===this.size[0]&&256===a?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===a&&0===f)return this;const l=[],d=this.lods.length-f;for(let b=0;b<d;b++){const g=b+f,{scale:z,resolution:v}=0<=g?this.lods[g]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};
l.push(new w({level:b,scale:z,resolution:v}))}return new r({size:[a,a],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:l})}_initializeUpsampleLevels(){const a=this.lods;this._upsampleLevels=[];let f=null;for(let l=0;l<a.length;l++){const d=a[l];this._upsampleLevels[d.level]={parentLevel:f?f.level:-1,factor:f?f.resolution/d.resolution:0};f=d}}};p.__decorate([F.property({type:Number,json:{write:!0}})],t.prototype,
"compressionQuality",void 0);p.__decorate([F.property({type:Number,json:{write:!0}})],t.prototype,"dpi",void 0);p.__decorate([F.property({type:String,json:{read:u.read,write:u.write,origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"format",void 0);p.__decorate([F.property({readOnly:!0})],t.prototype,"isWrappable",null);p.__decorate([F.property({type:c,json:{write:!0}})],t.prototype,"origin",void 0);p.__decorate([B.reader("origin")],t.prototype,"readOrigin",null);p.__decorate([F.property({type:[w],
value:null,json:{write:!0}})],t.prototype,"lods",null);p.__decorate([F.property({readOnly:!0})],t.prototype,"scales",void 0);p.__decorate([F.property({cast:a=>Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]})],t.prototype,"size",void 0);p.__decorate([B.reader("size",["rows","cols"])],t.prototype,"readSize",null);p.__decorate([q.writer("size",{cols:{type:P.Integer},rows:{type:P.Integer}})],t.prototype,"writeSize",null);p.__decorate([F.property({type:e,json:{write:!0}})],t.prototype,"spatialReference",
void 0);t=r=p.__decorate([D.subclass("esri.layers.support.TileInfo")],t);(function(a){a=a.ExtrapolateOptions||(a.ExtrapolateOptions={});a[a.NONE=0]="NONE";a[a.POWER_OF_TWO=1]="POWER_OF_TWO"})(t||={});return t})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(p,u,t,L,F,
P,M){var Q;u=Q=class extends u.JSONSupport{constructor(B){super(B);this.cols=null;this.level=0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new Q({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};p.__decorate([t.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,"cols",void 0);p.__decorate([t.property({type:L.Integer,
json:{write:!0}})],u.prototype,"level",void 0);p.__decorate([t.property({type:String,json:{write:!0}})],u.prototype,"levelValue",void 0);p.__decorate([t.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,"origin",void 0);p.__decorate([t.property({type:Number,json:{write:!0}})],u.prototype,"resolution",void 0);p.__decorate([t.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],u.prototype,
"rows",void 0);p.__decorate([t.property({type:Number,json:{write:!0}})],u.prototype,"scale",void 0);return u=Q=p.__decorate([M.subclass("esri.layers.support.LOD")],u)})},"esri/layers/support/TileKey":function(){define(["exports"],function(p){class u{constructor(t,L,F,P,M){this.id=t;this.level=L;this.row=F;this.col=P;this.extent=M}}p.TileKey=u;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/FunctionRaster":function(){define("require ../../../chunks/tslib.es6 ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/Polygon ./BaseRaster ../rasterFunctions/clipUtils ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../../../rest/support/FeatureSet".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n){F=class extends D{constructor(){super(...arguments);this.datasetFormat="Function";this.tileType="Raster";this.rasterFunction=null;this._clippingGeometry=new Map}async fetchPixels(h,m,w,k={}){const {rasters:r,rasterIds:a}=this.primaryRasters;var f=!1,{interpolation:l}=k,d=this.rasterFunction.flatWebGLFunctionChain?.hasFocalFunction;!k.requestRawData&&d&&(f=1===r.length&&!k.skipRasterFunction,k={...k,interpolation:"bilinear",requestRawData:f});d=r.map(v=>v.fetchPixels(h,
m,w,k));d=await Promise.all(d);var b=d.map(v=>v.pixelBlock),g=f||k.requestRawData?d.map(v=>v.srcTilePixelSize):null;if(k.skipRasterFunction||b.every(v=>null==v))return d[0];const z=d.find(v=>null!=v.pixelBlock)?.extent??h;b=this.rasterJobHandler?await this.rasterJobHandler.process({extent:z,primaryPixelBlocks:b,primaryPixelSizes:g,primaryRasterIds:a}):this.rasterFunction.process({extent:z,primaryPixelBlocks:b,primaryPixelSizes:g,primaryRasterIds:a});({transformGrid:g}=d[0]);if(!f||null==b||null==
g)return l=k.noClip?null:this.getClippingGeometry(z.spatialReference),k.noClip||k.requestRawData||null==b||!l||(b=await q.clip(b,z,l)),{...d[0],pixelBlock:b};f={rows:g.spacing[0],cols:g.spacing[1]};l=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:[b],srcMosaicSize:{width:b.width,height:b.height},destDimension:{width:m,height:w},coefs:g.coefficients,sampleSpacing:f,projectDirections:!1,gcsGrid:null,isUV:!1,interpolation:l,alignmentInfo:void 0,blockWidths:null},
k)).pixelBlock:c.approximateTransform(b,{width:m,height:w},g.coefficients,f,l);f=k.noClip?null:this.getClippingGeometry(h.spatialReference);k.noClip||k.requestRawData||null==l||null==f||(l=await q.clip(l,h,f));return{extent:h,srcExtent:d[0].srcExtent,pixelBlock:l}}getClippingGeometry(h){const m=this._clippingGeometry.get("0");if(!h||!m)return m;const w=String(h.wkid??h.wkt??h.wkt2);let k=this._clippingGeometry.get(w);if(null!=k)return k;k=h.equals(m.spatialReference)?m:e.projectPolygon(m,h);this._clippingGeometry.set(w,
k);return k}async _open(h){const {rasterFunction:m}=this;this.primaryRasters?.rasters?.length?m.sourceRasters=this.primaryRasters.rasters:(this.primaryRasters=m.getPrimaryRasters(),this.rasterJobHandler&&this.primaryRasters.rasters?.forEach(l=>l.rasterJobHandler=this.rasterJobHandler));const {rasters:w,rasterIds:k}=this.primaryRasters;var r=w.map(l=>l.rasterInfo?void 0:l.open(h));await Promise.all(r);r=w.map(({rasterInfo:l})=>l);var a=m.bind({rasterInfos:r,rasterIds:k});m.rawSourceRasterInfos=r;if(!a.success||
0===r.length)throw new t("raster-function:open",`cannot bind the function: ${a.error??""}`);a="Table"===m.functionName?m:m.functionArguments?.raster;"Table"===a?.functionName&&(m.rasterInfo.attributeTable=n.fromJSON(a.functionArguments.attributeTableAsRecordSet));await this.syncJobHandler();const f=r[0];this.hasUniqueSourceStorageInfo=1===r.length||r.slice(1).every(l=>{const {storageInfo:d,pixelSize:b,spatialReference:g,extent:z}=l,{storageInfo:v,pixelSize:C,spatialReference:y,extent:A}=f;return b.x===
C.x&&b.y===C.y&&g.equals(y)&&z.equals(A)&&d.blockHeight===v.blockHeight&&d.blockWidth===v.blockWidth&&d.maximumPyramidLevel===v.maximumPyramidLevel});this.set("sourceJSON",w[0].sourceJSON);this.set("rasterInfo",m.rasterInfo);await this._updateClipGeometry()}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async _updateClipGeometry(){var h=this.rasterFunction.getClippingGeometries()[0];let m=h?.clippingGeometry;if(m&&"inside"===h.clippingType){({extent:h}=
this.rasterInfo);const {difference:w,densify:k}=await new Promise((r,a)=>p(["../../../geometry/geometryEngine"],r,a));h=k(B.fromExtent(h),2*(h.width+h.height)/40);h=e.projectPolygon(h,m.spatialReference);m=w(h,m)}this._clippingGeometry.clear();m&&this._clippingGeometry.set("0",m)}};u.__decorate([L.property({type:String,json:{write:!0}})],F.prototype,"datasetFormat",void 0);u.__decorate([L.property()],F.prototype,"tileType",void 0);u.__decorate([L.property()],F.prototype,"rasterFunction",void 0);u.__decorate([L.property()],
F.prototype,"primaryRasters",void 0);return F=u.__decorate([Q.subclass("esri.layers.support.rasterDatasets.FunctionRaster")],F)})},"esri/layers/support/rasterDatasets/BaseRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../request ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../arcgisLayerUrl ../commonProperties ../DimensionalDefinition ../LOD ../RasterStorageInfo ../TileInfo ./multidimensionalUtils ./RawBlockCache ../rasterFormats/pixelRangeUtils ../rasterFormats/RasterCodec ../rasterFunctions/pixelUtils ../rasterFunctions/rasterProjectionHelper ../rasterFunctions/vectorFieldUtils ../../../views/support/QueueProcessor ../../../geometry/Point ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b,g,z,v,C,y){let A=0;u=class extends F.JSONSupport{constructor(){super(...arguments);this._tileFetchQueue=new z.QueueProcessor({concurrency:32,process:(x,E)=>this._fetchRawTile(x.pyramidLevel,x.row,x.col,{...x.options,signal:E})});this.datasetFormat=this.datasetName=null;this.hasUniqueSourceStorageInfo=!0;this.rasterInfo=null;this.ioConfig={sampling:"closest"}}normalizeCtorArgs(x){x?.ioConfig&&(x={...x,ioConfig:{resolution:null,bandIds:null,sampling:"closest",
tileInfo:k.create(),...x.ioConfig}});return x}get _isGlobalWrappableSource(){const {rasterInfo:x}=this,E=b.getWorldWidth(x.spatialReference);return null!=E&&x.extent.width>=E/2}get _hasNoneOrGCSShiftTransform(){const {transform:x}=this.rasterInfo;return null==x||"gcs-shift"===x.type}set rasterJobHandler(x){this._set("rasterJobHandler",x);"Function"===this.datasetFormat&&this.primaryRasters?.rasters?.forEach(E=>E.rasterJobHandler=x)}get rasterId(){return this.url||`rasterId-${A++}`}set url(x){this._set("url",
e.sanitizeUrl(x,P.getLogger(this)))}async open(x){this._openPromise??(this._openPromise=b.load().then(()=>this._open(x)));return this._openPromise}async fetchTile(x,E,N,G={}){const O=G.tileInfo||this.rasterInfo.storageInfo.tileInfo;x=this.getTileExtentFromTileInfo(x,E,N,O);G={noClip:!0,...G};return this.fetchPixels(x,O.size[0],O.size[1],G)}async identify(x,E={}){x=B.ensureClass(v,x).clone().normalize();const {multidimensionalDefinition:N,timeExtent:G}=E;var {rasterInfo:O}=this;const {hasMultidimensionalTranspose:H,
multidimensionalInfo:J}=O;var {transposedVariableName:R}=E,Y=null!=J&&H&&(null!=G||r.isMultiSliceOrRangeDefinition(N));Y&&!R&&(R=null!=N&&0<N.length?N[0].variableName??void 0:J.variables[0].name,E={...E,transposedVariableName:R});E=this._getRequestOptionsWithSliceId(E);const {spatialReference:T,extent:X}=O;var {datumTransformation:V}=E;V=b.projectPoint(x,T,V);if(!X.intersects(V)||null!=O.transform&&(V=O.transform.inverseTransform(V),!O.nativeExtent.intersects(V)))return{location:V,value:null};var K=
0,S=null!=R&&null!=J&&O.hasMultidimensionalTranspose;if("Function"===this.datasetFormat){Y=this.primaryRasters.rasters[0];if(S)return Y.identify(V,E);({pixelSize:K}=O);S=3*K.x/2;K=3*K.y/2;S=new C({xmin:V.x-S,xmax:V.x+S,ymin:V.y-K,ymax:V.y+K,spatialReference:T});E={interpolation:"nearest",multidimensionalDefinition:N,sliceId:E.sliceId};({pixelBlock:Y}=await Y.fetchPixels(S,3,3,E));({pixelBlock:E}=await this.fetchPixels(S,3,3,E));if(null==Y)return{location:V,value:null};Y=!Y.mask||Y.mask[4]?Y.pixels.map(da=>
da[4]):null;var Z;null!=E&&(Z=!E.mask||E.mask[4]?E.pixels.map(da=>da[4]):void 0);return{location:V,value:Y,processedValue:Z,pyramidLevel:0}}if(!S)if(E.srcResolution)K=b.snapPyramid(E.srcResolution,O,this.ioConfig.sampling).pyramidLevel;else if(K=await this.computeBestPyramidLevelForLocation(x,E),null==K)return{location:V,value:null};Z=this.identifyPixelLocation(V,K,null,S);if(null===Z)return{location:V,value:null};const {row:ca,col:I,rowOffset:U,colOffset:W,blockWidth:aa}=Z;Z=a.getRasterId(this.rasterId,
R??E.sliceId);O=`${K}/${ca}/${I}`;R=a.getBlock(Z,null,O);null==R&&(R=this.fetchRawTile(K,ca,I,E),a.putBlock(Z,null,O,R));Z=await R;return Z?.pixels?.length?this._processIdentifyResult(Z,{srcLocation:V,position:U*aa+W,pyramidLevel:K,useTransposedTile:!!S,requestSomeSlices:Y,identifyOptions:E}):{location:V,value:null}}async fetchPixels(x,E,N,G={}){x=b.shiftExtent(x);G=this._getRequestOptionsWithSliceId(G);var {_hasNoneOrGCSShiftTransform:O}=this;if(G.requestRawData&&O)return this._fetchPixels(x,E,N,
G);var H=b.getWorldWidth(x.spatialReference),J=b.getWorldWrapCount(x);if(null==H||0===J||1===J&&this._isGlobalWrappableSource&&O)return this._fetchPixels(x,E,N,G);if(3<=J)return{extent:x,pixelBlock:null};const R=[],{xmin:Y,xmax:T}=x,X=Math.round(H/(T-Y)*E),V=X-Math.round((H/2-Y)/(T-Y)*E);let K=0;O=[];for(let Z=0;Z<=J;Z++){var S=new C({xmin:0===Z?Y:-H/2,xmax:Z===J?T-H*Z:H/2,ymin:x.ymin,ymax:x.ymax,spatialReference:x.spatialReference});const ca=0===Z?X-V:Z===J?E-K:X;K+=ca;O.push(ca);S=G.disableWrapAround&&
0<Z?null:this._fetchPixels(S,ca,N,G);R.push(S)}H=(await Promise.all(R)).map(Z=>Z?.pixelBlock);J=null;E={width:E,height:N};J=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:H,srcMosaicSize:E,destDimension:null,coefs:null,sampleSpacing:null,interpolation:"nearest",alignmentInfo:null,blockWidths:O},G)).pixelBlock:d.mosaic(H,E,{blockWidths:O});G=b.projectExtent(x,this.rasterInfo.spatialReference,G.datumTransformation);return{extent:x,srcExtent:G,pixelBlock:J}}async fetchRawPixels(x,
E,N,G={}){E={x:Math.floor(E.x),y:Math.floor(E.y)};const O=await this._fetchRawTiles(x,E,N,G),{nativeExtent:H,nativePixelSize:J,storageInfo:R}=this.rasterInfo;var Y=2**x,T=J.x*Y;Y*=J.y;T=new C({xmin:H.xmin+T*E.x,xmax:H.xmin+T*(E.x+N.width-1),ymin:H.ymax-Y*(E.y+N.height-1),ymax:H.ymax-Y*E.y,spatialReference:H.spatialReference});if(!O)return{extent:T,srcExtent:T,pixelBlock:null};const {pixelBlocks:X,mosaicSize:V}=O;if(1===X.length&&null!=X[0]&&X[0].width===N.width&&X[0].height===N.height)return{extent:T,
srcExtent:T,pixelBlock:O.pixelBlocks[0]};x={x:E.x%(0<x?R.pyramidBlockWidth:R.blockWidth),y:E.y%(0<x?R.pyramidBlockHeight:R.blockHeight)};N=this.rasterJobHandler?(await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:X,srcMosaicSize:V,destDimension:N,clipOffset:x,clipSize:N,coefs:null,sampleSpacing:null,interpolation:G.interpolation,alignmentInfo:null,blockWidths:null},G)).pixelBlock:d.mosaic(X,V,{clipOffset:x,clipSize:N});return{extent:T,srcExtent:T,pixelBlock:N}}fetchRawTile(x,E,N,G){throw new L("BaseRaster:read-not-implemented",
"fetchRawTile() is not implemented");}computeExtent(x){return b.projectExtent(this.rasterInfo.extent,x)}decodePixelBlock(x,E){return!this.rasterJobHandler||E.useCanvas?l.decode(x,E):this.rasterJobHandler.decode({data:x,options:E})}async request(x,E,N=0){const {customFetchParameters:G}=this.ioConfig,{range:O,query:H,headers:J}=E;N=N??E.retryCount??this.ioConfig.retryCount;const R=O?{Range:`bytes=${O.from}-${O.to}`}:null;try{return await t(x,{...E,query:{...H,...G},headers:{...J,...R}})}catch(Y){if(0<
N)return N--,this.request(x,E,N);throw Y;}}getSliceIndex(x){const {multidimensionalInfo:E}=this.rasterInfo;return null==E||null==x||0===x.length?null:r.getSliceIndex(x,E)}getTileExtentFromTileInfo(x,E,N,G){x=G.lodAt(x);return this.getTileExtent({x:x.resolution,y:x.resolution},E,N,G.origin,G.spatialReference,G.size)}updateTileInfo(){const {storageInfo:x,spatialReference:E,extent:N,pixelSize:G}=this.rasterInfo;var {pyramidResolutions:O}=x;if(!x.tileInfo){const H=[],J=x.maximumPyramidLevel||0;let R=
(G.x+G.y)/2,Y=1/.0254*96*R;for(let T=0;T<=J;T++){H.unshift(new m({level:J-T,resolution:R,scale:Y}));if(T===J)break;if(O){const X=(O[T].x+O[T].y)/2;Y*=X/R;R=X}else R*=2,Y*=2}O=new v({x:N.xmin,y:N.ymax,spatialReference:E});x.tileInfo=new k({origin:O,size:[x.blockWidth,x.blockHeight],spatialReference:E,lods:H});x.isVirtualTileInfo=!0}}createRemoteDatasetStorageInfo(x,E=512,N=512,G){const {width:O,height:H,nativeExtent:J,pixelSize:R,spatialReference:Y}=x,T=new v({x:J.xmin,y:J.ymax,spatialReference:Y});
null==G&&(G=Math.max(0,Math.round(Math.log(Math.max(O,H))/Math.LN2-8)));const X=this.computeBlockBoundary(J,512,512,{x:J.xmin,y:J.ymax},[R],G);x.storageInfo=new w({blockWidth:E,blockHeight:N,pyramidBlockWidth:E,pyramidBlockHeight:N,origin:T,firstPyramidLevel:1,maximumPyramidLevel:G,blockBoundary:X})}async computeBestPyramidLevelForLocation(x,E){return 0}computeBlockBoundary(x,E,N,G,O,H=0,J=2){if(1===O.length&&0<H){O=[...O];let {x:T,y:X}=O[0];for(let V=0;V<H;V++)T*=J,X*=J,O.push({x:T,y:X})}H=[];const {x:R,
y:Y}=G;for(G=0;G<O.length;G++){const {x:T,y:X}=O[G];H.push({minCol:Math.floor((x.xmin-R+.1*T)/E/T),maxCol:Math.floor((x.xmax-R-.1*T)/E/T),minRow:Math.floor((Y-x.ymax+.1*X)/N/X),maxRow:Math.floor((Y-x.ymin-.1*X)/N/X)})}return H}getPyramidPixelSize(x){const {nativePixelSize:E}=this.rasterInfo,{pyramidResolutions:N,pyramidScalingFactor:G}=this.rasterInfo.storageInfo;if(0===x)return E;if(null!=N&&N.length)return N[x-1];x=G**x;return{x:E.x*x,y:E.y*x}}identifyPixelLocation(x,E,N,G){const {spatialReference:O,
nativeExtent:H,storageInfo:J}=this.rasterInfo,{maximumPyramidLevel:R,origin:Y,transposeInfo:T}=J,X=G&&null!=T?T.tileSize[0]:J.blockWidth;G=G&&null!=T?T.tileSize[1]:J.blockHeight;x=b.projectPoint(x,O,N);if(!H.intersects(x)||0>E||E>R)return null;N=this.getPyramidPixelSize(E);const {x:V,y:K}=N;N=(Y.y-x.y)/K/G;const S=(x.x-Y.x)/V/X;return{pyramidLevel:E,row:Math.floor(N),col:Math.floor(S),rowOffset:Math.min(G-1,Math.floor((N-Math.floor(N))*G)),colOffset:Math.min(X-1,Math.floor((S-Math.floor(S))*X)),blockWidth:X,
srcLocation:x}}getTileExtent(x,E,N,G,O,H){const [J,R]=H;N=G.x+N*J*x.x;E=G.y-E*R*x.y;return new C({xmin:N,xmax:N+J*x.x,ymin:E-R*x.y,ymax:E,spatialReference:O})}getBlockWidthHeight(x){return{blockWidth:0<x?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,blockHeight:0<x?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight}}isBlockOutside(x,E,N){x=this.rasterInfo.storageInfo.blockBoundary[x];return!x||x.maxRow<E||x.maxCol<N||x.minRow>
E||x.minCol>N}updateImageSpaceRasterInfo(x){const {pixelSize:E}=x,{width:N,height:G}=x,O=y.WebMercator;x.spatialReference=O;x.extent=x.nativeExtent=new C({xmin:-.5,ymax:.5,xmax:N-.5,ymin:.5-G,spatialReference:O});x.isPseudoSpatialReference=!0;x.transform=null;x.pixelSize=new v({x:1,y:1,spatialReference:O});const {extent:H,storageInfo:J}=x;if(J){J.origin=new v({x:H.xmin,y:H.ymax,spatialReference:O});const {pyramidResolutions:R,tileInfo:Y}=J;R&&R.forEach(T=>{T.x/=E.x;T.y/=E.y});if(Y){Y.origin=J.origin;
const T=(x.nativePixelSize.x+x.nativePixelSize.y)/2;Y.lods.forEach((X,V)=>{X.resolution=T*2**V;X.scale=96*X.resolution/.0254})}}}async _fetchPixels(x,E,N,G={}){var O=b.getWorldWrapCount(x);if(2<=O)return{extent:x,pixelBlock:null};var H=this._getSourceDataInfo(x,E,N,G);const {pyramidLevel:J,srcResolution:R,srcExtent:Y,srcWidth:T,srcHeight:X,ul:V}=H;if(0===T||0===X)return{extent:x,srcExtent:Y,pixelBlock:null};var {rasterInfo:K}=this,S=K.transform,Z="gcs-shift"===S?.type,ca=null!=b.getWorldWidth(x.spatialReference);
if(Z||!ca)O=b.getWorldWrapCount(H.srcExtent,Z);H=await this._fetchRawTiles(J,V,{width:T,height:X,wrapCount:O},G);if(!H)return{extent:x,srcExtent:Y,pixelBlock:null};var I=K.storageInfo;Z=0<J?I.pyramidBlockWidth:I.blockWidth;var U=0<J?I.pyramidBlockHeight:I.blockHeight;let {x:W,y:aa}=K.pixelSize;if(0<J){const {pyramidResolutions:oa,pyramidScalingFactor:sa}=I;null!=oa&&oa[J-1]?{x:W,y:aa}=oa[J-1]:(I=sa**J,W*=I,aa*=I)}var da=K.spatialReference;K=new v({x:W,y:aa,spatialReference:da});const ea=Z===T&&U===
X&&0===V.x%Z&&0===V.y%U;I=new v({x:(x.xmax-x.xmin)/E,y:(x.ymax-x.ymin)/N,spatialReference:x.spatialReference});const ha=!x.spatialReference.equals(da),ia=da.isGeographic?1E-9:1E-4;({datumTransformation:da}=G);if(!ha&&ea&&1===H.pixelBlocks.length&&Z===E&&U===N&&Math.abs(R.x-I.x)<ia&&Math.abs(R.y-I.y)<ia)return{extent:x,srcExtent:Y,srcTilePixelSize:K,pixelBlock:H.pixelBlocks[0]};Z=ca&&null!=b.getWorldWidth(Y.spatialReference)&&this._hasNoneOrGCSShiftTransform;(ca=G.requestProjectedLocalDirections&&
this.rasterInfo.dataType.startsWith("vector"))&&!this.rasterJobHandler&&await b.load();O=this.rasterJobHandler?await this.rasterJobHandler.getProjectionOffsetGrid({projectedExtent:x,srcBufferExtent:H.extent,pixelSize:I.toJSON(),datumTransformation:da,rasterTransform:S,hasWrapAround:0<O||Z,isAdaptive:!1!==this.ioConfig.optimizeProjectionAccuracy,includeGCSGrid:ca},G):b.getProjectionOffsetGrid({projectedExtent:x,srcBufferExtent:H.extent,pixelSize:I,datumTransformation:da,rasterTransform:S,hasWrapAround:0<
O||Z,isAdaptive:!1,includeGCSGrid:ca});S=!G.requestRawData;Z={rows:O.spacing[0],cols:O.spacing[1]};U=this._hasNoneOrGCSShiftTransform?this._getRasterTileAlignmentInfo(J,H.extent.xmin):void 0;const {pixelBlocks:ka,mosaicSize:ma,isPartiallyFilled:pa}=H;H=null;this.rasterJobHandler?(E=await this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:ka,srcMosaicSize:ma,destDimension:S?{width:E,height:N}:null,coefs:S?O.coefficients:null,sampleSpacing:S?Z:null,projectDirections:ca,gcsGrid:ca?O.gcsGrid:null,
isUV:"vector-uv"===this.rasterInfo.dataType,interpolation:G.interpolation,alignmentInfo:U,blockWidths:null},G),{pixelBlock:S,localNorthDirections:H}=E):(U=d.mosaic(ka,ma,{alignmentInfo:U}),S=S?d.approximateTransform(U,{width:E,height:N},O.coefficients,Z,G.interpolation):U,ca&&O.gcsGrid&&(H=d.getLocalArithmeticNorthRotations({width:E,height:N},O.gcsGrid),S=g.convertToLocalDirections(S,this.rasterInfo.dataType,H)));return G.requestRawData||ca?{extent:x,srcExtent:Y,srcTilePixelSize:K,pixelBlock:S,transformGrid:O,
localNorthDirections:H,isPartiallyFilled:pa}:{extent:x,srcExtent:Y,srcTilePixelSize:K,pixelBlock:S}}async _fetchRawTiles(x,E,N,G){const {origin:O,blockBoundary:H}=this.rasterInfo.storageInfo,{blockWidth:J,blockHeight:R}=this.getBlockWidthHeight(x);let {x:Y,y:T}=E,{width:X,height:V,wrapCount:K}=N;var S=this._getRasterTileAlignmentInfo(x,0);G.buffer&&(Y-=G.buffer.cols,T-=G.buffer.rows,X+=2*G.buffer.cols,V+=2*G.buffer.rows);var Z=0,ca=0;let I=0;K&&null!=S&&({worldColumnCountFromOrigin:ca,originColumnOffset:I,
rightPadding:Z}=S,ca*S.blockWidth-Z>=Y+X&&(Z=0));E=Math.floor(Y/J);N=Math.floor(T/R);const U=Math.floor((Y+X+Z-1)/J);Z=Math.floor((T+V+Z-1)/R);var W=H[x];if(!W)return null;const {minRow:aa,minCol:da,maxCol:ea,maxRow:ha}=W;if(0===K&&(Z<aa||U<da||N>ha||E>ea))return null;W=[];let ia=!1;const ka=null==this.ioConfig.allowPartialFill?G.allowPartialFill:this.ioConfig.allowPartialFill;for(let oa=N;oa<=Z;oa++)for(let sa=E;sa<=U;sa++){let qa=sa;!G.disableWrapAround&&K&&null!=S&&ca<=sa&&(qa=sa-ca-I);if(oa>=
aa&&qa>=da&&ha>=oa&&ea>=qa){const va=this._tileFetchQueue.push({pyramidLevel:x,row:oa,col:qa,options:G},{signal:G.signal});ka?W.push(new Promise(ta=>{va.then(wa=>ta(wa)).catch(()=>{ia=!0;ta(null)})})):W.push(va)}else W.push(Promise.resolve(null))}if(0===W.length)return null;G=await Promise.all(W);S={height:(Z-N+1)*R,width:(U-E+1)*J};({spatialReference:ca}=this.rasterInfo);x=this.getPyramidPixelSize(x);const {x:ma,y:pa}=x;return{extent:new C({xmin:O.x+E*J*ma,xmax:O.x+(U+1)*J*ma,ymin:O.y-(Z+1)*R*pa,
ymax:O.y-N*R*pa,spatialReference:ca}),pixelBlocks:G,mosaicSize:S,isPartiallyFilled:ia}}_fetchRawTile(x,E,N,G){var O=this.rasterInfo.storageInfo.blockBoundary[x];if(!O)return Promise.resolve(null);const {minRow:H,minCol:J,maxCol:R,maxRow:Y}=O;if(E<H||N<J||E>Y||N>R)return Promise.resolve(null);const T=a.getRasterId(this.rasterId,G.sliceId),X=`${x}/${E}/${N}`;O=a.getBlock(T,G.registryId,X);if(null==O){const V=new AbortController;O=this.fetchRawTile(x,E,N,{...G,signal:V.signal});a.putBlock(T,G.registryId,
X,O,V);O.catch(()=>a.deleteBlock(T,G.registryId,X))}if(G.signal)M.onAbort(G,()=>{a.decreaseRefCount(T,G.registryId,X)});return O}_computeMagDirValues(x){const {bandCount:E,dataType:N}=this.rasterInfo;if((2!==E||"vector-magdir"!==N)&&"vector-uv"!==N||2!==x?.length||!x[0]?.length)return null;var G=x[0].length;if("vector-magdir"===N)return G=x[1].map(R=>(R+360)%360),[x[0],G];const [O,H]=x;x=[];const J=[];for(let R=0;R<G;R++){const [Y,T]=g.uvComponentToVector([O[R],H[R]]);x.push(Y);J.push(T)}return[x,
J]}_getRasterTileAlignmentInfo(x,E){null==this._rasterTileAlignmentInfo&&(this._rasterTileAlignmentInfo=b.getRasterDatasetAlignmentInfo(this.rasterInfo));return null==this._rasterTileAlignmentInfo.pyramidsInfo?null:{startX:E,halfWorldWidth:this._rasterTileAlignmentInfo.halfWorldWidth,hasGCSSShiftTransform:this._rasterTileAlignmentInfo.hasGCSSShiftTransform,...this._rasterTileAlignmentInfo.pyramidsInfo[x]}}_getSourceDataInfo(x,E,N,G={}){const O={datumTransformation:G.datumTransformation,pyramidLevel:0,
pyramidResolution:null,srcExtent:null,srcHeight:0,srcResolution:null,srcWidth:0,ul:{x:0,y:0}};G.srcResolution&&(O.srcResolution=G.srcResolution,this._updateSourceDataInfo(x,O));var H=this.rasterInfo.storageInfo.maximumPyramidLevel||0;const {srcWidth:J,srcHeight:R,pyramidLevel:Y}=O;var T=J/E;const X=R/N,V=Y<H&&16<=T*X;var K=Y===H&&this._requireTooManySrcTiles(J,R,E,N);if(V||K||0===J||0===R){K=new v({x:(x.xmax-x.xmin)/E,y:(x.ymax-x.ymin)/N,spatialReference:x.spatialReference});K=b.projectResolution(K,
this.rasterInfo.spatialReference,x,O.datumTransformation);const S=!K||G.srcResolution&&K.x+K.y<G.srcResolution.x+G.srcResolution.y;V&&G.srcResolution&&S&&(T=Math.round(Math.log(Math.max(T,X))/Math.LN2)-1,H-Y+3>=T&&(H=2**T,K={x:G.srcResolution.x*H,y:G.srcResolution.y*H}));K&&(O.srcResolution=K,this._updateSourceDataInfo(x,O))}this._requireTooManySrcTiles(O.srcWidth,O.srcHeight,E,N)&&(O.srcWidth=0,O.srcHeight=0);return O}_requireTooManySrcTiles(x,E,N,G){const {tileInfo:O}=this.rasterInfo.storageInfo;
return Math.ceil(x/O.size[0])*Math.ceil(E/O.size[1])>=256*Math.max(1,(N+G)/1024)||8<x/N||8<E/G}_updateSourceDataInfo(x,E){E.srcWidth=0;E.srcHeight=0;var {rasterInfo:N}=this,G=N.spatialReference;const {srcResolution:O,datumTransformation:H}=E,{pyramidLevel:J,pyramidResolution:R,excessiveReading:Y}=b.snapPyramid(O,N,this.ioConfig.sampling);if(!Y&&(x=E.srcExtent||b.projectExtent(x,G,H),null!=x)){(G=N.transform)&&(x=G.inverseTransform(x));E.srcExtent=x;var {x:T,y:X}=N.storageInfo.origin;N=Math.floor((x.xmin-
T)/R.x+.1);G=Math.floor((X-x.ymax)/R.y+.1);var V=Math.floor((x.xmax-T)/R.x-.1),K=Math.floor((X-x.ymin)/R.y-.1);V=x.width<.1*R.x?0:V-N+1;x=x.height<.1*R.y?0:K-G+1;E.pyramidLevel=J;E.pyramidResolution=R;E.srcWidth=V;E.srcHeight=x;E.ul={x:N,y:G}}}_getRequestOptionsWithSliceId(x){null!=this.rasterInfo.multidimensionalInfo&&null==x.sliceId&&(x={...x,sliceId:this.getSliceIndex(x.multidimensionalDefinition)});return x}_processIdentifyResult(x,E){const {srcLocation:N,position:G,pyramidLevel:O,useTransposedTile:H}=
E,J=x.pixels[0].length/x.width/x.height;if(x.mask&&!x.mask[G])return{location:N,value:null};const {multidimensionalInfo:R}=this.rasterInfo;if(null==R||!H)return E=x.pixels.map(Z=>Z[G]),x={location:N,value:E,pyramidLevel:O},E=this._computeMagDirValues(E.map(Z=>[Z])),E?.length&&(x.magdirValue=E.map(Z=>Z[0])),x;let Y=x.pixels.map(Z=>Z.slice(G*J,G*J+J)),T=this._computeMagDirValues(Y);const {requestSomeSlices:X,identifyOptions:V}=E;let K=r.createSlices(R,V.transposedVariableName);if(X){const Z=r.getSliceIds(K,
V.multidimensionalDefinition,V.timeExtent);Y=Y.map(ca=>Z.map(I=>ca[I]));T=T?.map(ca=>Z.map(I=>ca[I]));K=Z.map(ca=>K[ca])}E=x.noDataValues||this.rasterInfo.noDataValue;x={pixels:Y,pixelType:x.pixelType};let S;null!=E&&(f.convertNoDataToMask(x,E),S=x.mask);x=K.map((Z,ca)=>{Z={value:0===S?.[ca]?null:Y.map(I=>I[ca]),multidimensionalDefinition:Z.multidimensionalDefinition.map(I=>new h({...I,isSlice:!0}))};T?.length&&(Z.magdirValue=[T[0][ca],T[1][ca]]);return Z});return{location:N,value:null,dataSeries:x,
pyramidLevel:O}}};p.__decorate([Q.property()],u.prototype,"_rasterTileAlignmentInfo",void 0);p.__decorate([Q.property()],u.prototype,"_tileFetchQueue",void 0);p.__decorate([Q.property({readOnly:!0})],u.prototype,"_isGlobalWrappableSource",null);p.__decorate([Q.property({readOnly:!0})],u.prototype,"_hasNoneOrGCSShiftTransform",null);p.__decorate([Q.property()],u.prototype,"_openPromise",void 0);p.__decorate([Q.property()],u.prototype,"rasterJobHandler",null);p.__decorate([Q.property({readOnly:!0})],
u.prototype,"rasterId",null);p.__decorate([Q.property(n.url)],u.prototype,"url",null);p.__decorate([Q.property({type:String,json:{write:!0}})],u.prototype,"datasetName",void 0);p.__decorate([Q.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);p.__decorate([Q.property()],u.prototype,"hasUniqueSourceStorageInfo",void 0);p.__decorate([Q.property()],u.prototype,"rasterInfo",void 0);p.__decorate([Q.property()],u.prototype,"ioConfig",void 0);p.__decorate([Q.property()],u.prototype,
"sourceJSON",void 0);return u=p.__decorate([c.subclass("esri.layers.support.rasterDatasets.BaseRaster")],u)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(p,u,t,L,F,P,M,Q){var B;u=B=class extends u.JSONSupport{constructor(){super(...arguments);this.blockHeight=
this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new B({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:t.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:t.clone(this.pyramidResolutions),
pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:t.clone(this.tileInfo),transposeInfo:t.clone(this.transposeInfo),blockBoundary:t.clone(this.blockBoundary)})}};p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"blockWidth",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"blockHeight",void 0);p.__decorate([L.property({type:String,
json:{write:!0}})],u.prototype,"compression",void 0);p.__decorate([L.property({type:Q,json:{write:!0}})],u.prototype,"origin",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"firstPyramidLevel",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"maximumPyramidLevel",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"pyramidResolutions",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"pyramidScalingFactor",
void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"pyramidBlockWidth",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],u.prototype,"pyramidBlockHeight",void 0);p.__decorate([L.property({type:Boolean,json:{write:!0}})],u.prototype,"isVirtualTileInfo",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"tileInfo",void 0);p.__decorate([L.property()],u.prototype,"transposeInfo",void 0);p.__decorate([L.property()],u.prototype,"blockBoundary",void 0);
return u=B=p.__decorate([M.subclass("esri.layers.support.RasterStorageInfo")],u)})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/arrayUtils","../DimensionalDefinition"],function(p,u,t){function L(h,m,w){const k=m.shift();0===w.length&&w.push({sliceId:-1,multidimensionalDefinition:[]});const r=w.length;for(let a=0;a<r;a++){const f=w.shift().multidimensionalDefinition;k.values?.forEach(l=>{w.push({sliceId:-1,multidimensionalDefinition:[...f,
{variableName:h,dimensionName:k.name,values:[l]}]})})}m.length&&L(h,m,w)}function F(h,m){return Array.isArray(h)?m[0]===m[1]?h[0]===m[0]||h[1]===m[0]:h[0]>=m[0]&&h[0]<=m[1]&&h[1]>=m[0]&&h[1]<=m[1]:h>=m[0]&&h<=m[1]}function P(h,m){return h[0]<=m[0]&&h[1]>=m[0]||h[0]<=m[1]&&h[1]>=m[1]||h[0]>=m[0]&&h[1]<=m[1]}function M(h){return 1===h.length?[h[0],h[0]]:[h[0],h[h.length-1]]}function Q(h,m,w){if(!m?.subsetDefinitions?.length)return h;if(w){const {variables:r}=m;if(r.length&&!r.includes(w))return null;
m=m.subsetDefinitions.find(a=>a.dimensionName===h.name&&a.variableName===w);if(!m?.values?.length)return h;m=M(m.values)}else m=m.dimensions.find(({name:r})=>r===h.name)?.extent;const k=m;if(!k?.length)return h;m=h.values.filter(r=>F(r,k));return{...h,extent:[...k],values:m}}function B(h,m,w){if(!m?.subsetDefinitions?.length)return!1;const {variables:k}=m;if(k.length&&h.some(({variableName:r})=>r&&!k.includes(r)))return!0;for(let r=0;r<h.length;r++){const a=h[r],f=m.subsetDefinitions.find(l=>(""===
a.variableName||l.variableName===a.variableName)&&l.dimensionName===a.dimensionName);if(f?.values.length){const l=M(f.values);if(!a.isSlice&&2===a.values.length&&!Array.isArray(a.values[0])&&a.values[0]!==a.values[1]&&w){if(!P(a.values,l))return!0}else if(a.values.some(d=>!F(d,l)))return!0}}return!1}function D(h,m){var w=h.dimensions.find(({name:f})=>"StdTime"===f);if(null==w||null==m.start&&null==m.end)return m;m=m.clone();const {start:k,end:r}=m.toJSON(),a=k===r?[k]:null!=k&&null!=r?[k,r]:[k??r];
if(2===a.length&&w?.extent.length&&(a[0]=Math.max(a[0],w.extent[0]),a[1]=Math.min(a[1],w.extent[1]??w.extent[0]),a[1]<a[0]))return null;w=new t({variableName:"",dimensionName:"StdTime",isSlice:1===a.length,values:a});if(B([w],h,!0))return null;m.start=new Date(a[0]);m.end=new Date(a[1]??a[0]);return m}function q(h,m={}){const {multidimensionalInfo:w,keyProperties:k}=h;if(null==w)return null;const {variableName:r,multidimensionalSubset:a,multidimensionalDefinition:f}=m;h=null!=f?f[0]?.variableName:
null;const l=r||h||k?.DefaultVariable;({variables:h}=w);a?.variables?.length&&(h=h.filter(({name:d})=>a.variables.includes(d)));return l?h.find(({name:d})=>d===l)??h[0]:h[0]}function c(h,m){var {values:w}=m;if(w?.length){m=Array.isArray(w[0]);var k=Array.isArray(h);return m!==k?-1:m&&k?w.findIndex(a=>a[0]===h[0]&&a[1]===h[1]):w.indexOf(h)}({extent:k}=m);if(Array.isArray(h)||!k||h<k[0]||h>k[1])return-1;w=m.interval||1;if("ISO8601"!==m.unit)return Math.round((h-k[0])/w);k=k[0];let r=-1;switch(m.intervalUnit?.toLowerCase()||
"days"){case "seconds":r=Math.round((h-k)/1E3/w);break;case "minutes":r=Math.round((h-k)/6E4/w);break;case "hours":r=Math.round((h-k)/36E5/w);break;case "days":r=Math.round((h-k)/864E5/w);break;case "months":m=(new Date(h)).getUTCFullYear()-(new Date(k)).getUTCFullYear();w=(new Date(k)).getUTCMonth();k=(new Date(h)).getUTCMonth();r=0===m?k-w:k+11-w+12*(m-1);break;case "years":r=Math.round(((new Date(h)).getUTCFullYear()-(new Date(k)).getUTCFullYear())/w);break;case "decades":r=Math.round(((new Date(h)).getUTCFullYear()-
(new Date(k)).getUTCFullYear())/10/w)}return r}function e(h){var m=h.values?.length;if(m)return m;const {extent:w,unit:k}=h;m=h.interval||1;var r=w?w[1]-w[0]:0;if("ISO8601"!==k)return Math.round(r/m);switch(h.intervalUnit?.toLowerCase()??"seconds"){case "seconds":m=Math.round(r/1E3/m);break;case "minutes":m=Math.round(r/6E4/m);break;case "hours":m=Math.round(r/36E5/m);break;case "days":m=Math.round(r/864E5/m);break;case "months":w?(h=(new Date(w[1])).getUTCFullYear()-(new Date(w[0])).getUTCFullYear(),
m=(new Date(w[0])).getUTCMonth(),r=(new Date(w[1])).getUTCMonth(),m=0===h?r-m+1:r+11-m+12*(h-1)+1):m=0;break;case "years":m=w?Math.round(((new Date(w[1])).getUTCFullYear()-(new Date(w[0])).getUTCFullYear())/m):0;break;case "decades":m=w?Math.round(((new Date(w[1])).getUTCFullYear()-(new Date(w[0])).getUTCFullYear())/10/m):0;break;default:m=0}return m}function n(h,m,w,k){const r=[];let a=h;for(h=new Date(h);a<=m;)switch(r.push(a),k){case "decades":h.setUTCFullYear(h.getUTCFullYear()+10*w);a=h.getTime();
break;case "years":h.setUTCFullYear(h.getUTCFullYear()+w);a=h.getTime();break;case "months":h.setUTCMonth(h.getUTCMonth()+w);a=h.getTime();break;case "days":a+=864E5*w;break;case "hours":a+=36E5*w;break;case "minutes":a+=6E4*w;break;case "seconds":a+=1E3*w}1===r.length?r[1]=m:r[r.length-1]=m;return r}p.createSlices=function(h,m){const w=[];let k=0;(m?h.variables.filter(r=>r.name.toLowerCase()===m.toLowerCase()):[...h.variables].sort((r,a)=>r.name>a.name?1:-1)).forEach(r=>{const a=[],f=[...r.dimensions].sort((l,
d)=>l.name>d.name?-1:1);L(r.name,f,a);a.forEach(l=>{w.push({...l,sliceId:k++})})});return w};p.getDefaultMultidimensionalDefinition=function(h,m={}){var w=q(h,m);if(!w)return null;h=[];const {dimensions:k,name:r}=w;if(0===k.length)return[new t({variableName:r,dimensionName:"",values:[],isSlice:!0})];for(w=0;w<k.length;w++){const a=Q(k[w],m.multidimensionalSubset,r);if(!a)return null;const {values:f,extent:l}=a;let d=f?.[0]??l?.[0];"stdz"===a.name.toLowerCase()&&!a.hasRanges&&l&&Math.abs(l[1])<=Math.abs(l[0])&&
(d=f?.length?f[f.length-1]:l[1]);h.push(new t({variableName:r,dimensionName:a.name,values:[d],isSlice:m.useRangeForRangedDimensionInfo?!!a.hasRanges:!0}))}return h};p.getDefaultVariableInfo=q;p.getDimensionValues=function(h){if(2!==h.extent?.length||!h.interval)return[];const {extent:[m,w],interval:k}=h;if("ISO8601"===h.unit)return h=h.intervalUnit?.toLowerCase()??"days","decades years months days hours minutes seconds".split(" ").includes(h)?n(m,w,k,h):[];const r=Math.round((w-m)/k);return Array.from({length:r},
(a,f)=>f===r-1?w:m+f*k)};p.getSliceIds=function(h,m,w){let k=h;m&&(m=[...m].sort((r,a)=>r.dimensionName<a.dimensionName?-1:1),m.forEach(({dimensionName:r,values:a,isSlice:f})=>{a.length&&(k=k.filter(l=>{l=l.multidimensionalDefinition.find(b=>b.dimensionName===r);if(null==l)return!1;const d=l.values[0];return"number"===typeof d?"number"===typeof a[0]?a.includes(d):a.some(b=>b[0]<=d&&b[1]>=d):"number"===typeof a[0]?a.some(b=>d[0]<=b&&d[1]>=b):f?a.some(b=>b[0]===d[0]&&b[0]===d[1]):a.some(b=>b[0]>=d[0]&&
b[0]<=d[1]||b[1]>=d[0]&&b[1]<=d[1]||b[0]<d[0]&&b[1]>d[1])}))}));if(k.length&&null!=w?.start&&null!=w.end){const r=w.start.getTime(),a=w.end.getTime(),f=k[0].multidimensionalDefinition.findIndex(l=>"StdTime"===l.dimensionName);-1<f&&(k=k.filter(l=>{l=l.multidimensionalDefinition[f].values[0];return r<=l&&a>=l}))}return k.map(r=>r.sliceId)};p.getSliceIndex=function(h,m){let w=0;var k=h[0].variableName;m=[...m.variables].sort((a,f)=>a.name>f.name?1:-1);for(var r=0;r<m.length;r++){const a=m[r],f=[...a.dimensions].sort((l,
d)=>l.name>d.name?-1:1);if(a.name!==k)w+=f.map(l=>e(l)).reduce((l,d)=>l*d);else{k=f.map(l=>e(l));m=f.length;for(let l=0;l<m;l++){r=h.find(d=>d.dimensionName===f[l].name);if(null==r)return null;r=c(r.values[0],f[l]);if(-1===r)return null;k.shift();w=l===m-1?w+r:w+r*k.reduce((d,b)=>d*b)}break}}return w};p.getSubsetVariablesFromMdInfo=function(h,m){if(null==m||null==h)return null;m=m.variables.map(w=>({...w}));h?.variables?.length&&(m=m.filter(({name:w})=>h.variables.includes(w)),m.forEach(w=>{w.dimensions=
w.dimensions.map(k=>Q(k,h,w.name)).filter(u.isSome)}));return m};p.getTimeDimensionValues=n;p.hasExcludedVariableOrDimension=B;p.intersectMultimensionalSubset=function(h,m){if(null==h)return{isOutside:!1};const {geometry:w,timeExtent:k,multidimensionalDefinition:r}=m;m=null;if(null!=k&&(m=D(h,k),null==m))return{isOutside:!0};const {areaOfInterest:a}=h;if(a&&w){const f="point"===w.type?w:"extent"===w.type?w.center:"polygon"===w.type?w.centroid:null;if(f&&!a.contains(f))return{isOutside:!0}}return null!=
r&&r.length&&B(r,h,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:w,timeExtent:m,multidimensionalDefinition:r}}};p.isMultiSliceOrRangeDefinition=function(h){return h?.length?h.some(m=>{if(null==m.values)return!0;const w=m.values.length;return 0===w||1<w||!m.isSlice&&Array.isArray(m.values[0])}):!1};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/RawBlockCache":function(){define(["exports","../../../geometry","./EphemeralBlockCache","../rasterFunctions/rasterProjectionHelper",
"../../../geometry/Point"],function(p,u,t,L,F){function P(B,D){return(B=M.get(B))?B[D]??null:null}const M=new Map,Q=new t;p.decreaseRefCount=function(B,D,q){const c=M.get(B);if(!c)return null==D?Q.decreaseRefCount(B,q):0;if(null==D||null==c[D])return Q.decreaseRefCount(B,q);D=c[D]?.cache;B=D?.get(q);if(D&&B){B.refCount--;if(0===B.refCount){D.delete(q);for(D=0;D<c.length;D++)c[D]?.cache.delete(q);B.controller&&B.controller.abort()}return B.refCount}return 0};p.deleteBlock=function(B,D,q){const c=M.get(B);
c?null==D||null==c[D]?Q.deleteBlock(B,q):c[D]?.cache.delete(q):null==D&&Q.deleteBlock(B,q)};p.deleteRaster=function(B){M.delete(B)};p.getBlock=function(B,D,q){const c=M.get(B);if(!c)return null==D?Q.getBlock(B,q):null;if(null==D||null==c[D]){for(D=0;D<c.length;D++){var e=c[D]?.cache.get(q);if(e)return e.refCount++,e.block}return Q.getBlock(B,q)}if(B=c[D]?.cache.get(q))return B.refCount++,B.block;for(B=0;B<c.length;B++){if(B===D||!c[B])continue;e=c[B]?.cache;const n=e?.get(q);if(e&&n)return n.refCount++,
e.set(q,n),n.block}return null};p.getRasterId=function(B,D){return null==D?B:`${B}?sliceId=${D}`};p.putBlock=function(B,D,q,c,e=null){const n=M.get(B);if(n)if(null==D||null==n[D])Q.putBlock(B,q,c,e);else{var h={refCount:1,block:c,isResolved:!1,isRejected:!1,controller:e};c.then(()=>h.isResolved=!0).catch(()=>h.isRejected=!0);n[D]?.cache.set(q,h)}else null==D&&Q.putBlock(B,q,c,e)};p.register=function(B,D){D={extent:null,rasterInfo:D,cache:new Map};const q=M.get(B);if(q)return q.push(D),q.length-1;
M.set(B,[D]);return 0};p.unregister=function(B,D){const q=M.get(B);q&&(q[D]=null,q.some(c=>null!=c)||M.delete(B))};p.update=function(B,D,q,c,e,n,h=null){if(B=P(B,D)){D=B.extent;var {cache:m,rasterInfo:w}=B;if(!D||D.xmin!==q.xmin||D.xmax!==q.xmax||D.ymin!==q.ymin||D.ymax!==q.ymax){c=c??0;D=q.clone().normalize();var {spatialReference:k,transform:r}=w,a=new Set;for(let z=0;z<D.length;z++){var f=D[z];if(f.xmax-f.xmin<=c||f.ymax-f.ymin<=c)continue;var l=L.projectExtent(f,k,h);null!=r&&(l=r.inverseTransform(l));
var d=new F({x:c,y:c,spatialReference:f.spatialReference});if(null==e&&(e=L.projectResolution(d,k,f,h),!e))return;const {pyramidLevel:v,pyramidResolution:C,excessiveReading:y}=L.snapPyramid(e,w,n||"closest");if(y)return;({storageInfo:f}=w);var {origin:b}=f;d=Math.max(0,Math.floor((l.xmin-b.x)/C.x));b=Math.max(0,Math.floor((b.y-l.ymax)/C.y));const A=0<v?f.pyramidBlockWidth:f.blockWidth,x=0<v?f.pyramidBlockHeight:f.blockHeight;f=Math.max(0,Math.floor(d/A)-1);var g=Math.max(0,Math.floor(b/x)-1);d=Math.floor((d+
Math.ceil((l.xmax-l.xmin)/C.x-.1)-1)/A)+1;l=Math.floor((b+Math.ceil((l.ymax-l.ymin)/C.y-.1)-1)/x)+1;for(b=g;b<=l;b++)for(g=f;g<=d;g++)a.add(`${v}/${b}/${g}`)}m.forEach((z,v)=>{a.has(v)||(z=m.get(v),(null==z||z.isResolved||z.isRejected)&&m.delete(v))});B.extent={xmin:q.xmin,ymin:q.ymin,xmax:q.xmax,ymax:q.ymax}}}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/EphemeralBlockCache":function(){define(function(){class p{constructor(u=15E3,t=5E3){this._timer=
null;this._cachedBlocks=new Map;this._size=-1;this._duration=u;this._interval=Math.min(u,t)}decreaseRefCount(u,t){u=u+"/"+t;t=this._cachedBlocks;if(t.has(u)){const L=t.get(u);L.refCount--;0>=L.refCount&&(t.delete(u),L.controller&&L.controller.abort());return L.refCount}return 0}getBlock(u,t){u=u+"/"+t;t=this._cachedBlocks;if(t.has(u)){const L=t.get(u);L.ts=Date.now();L.refCount++;t.delete(u);t.set(u,L);return L.block}return null}putBlock(u,t,L,F){const P=this._cachedBlocks;u=u+"/"+t;P.has(u)?(L=P.get(u),
L.ts=Date.now(),L.refCount++):P.set(u,{block:L,ts:Date.now(),refCount:1,controller:F});this._trim();this._updateTimer()}deleteBlock(u,t){const L=this._cachedBlocks;u=u+"/"+t;L.has(u)&&L.delete(u)}updateMaxSize(u){this._size=u;this._trim()}empty(){this._cachedBlocks.clear();this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null==this._timer){var u=this._cachedBlocks;this._timer=setInterval(()=>{const t=Array.from(u),L=Date.now();for(let F=0;F<t.length;F++)if(t[F][1].ts<=
L-this._duration)u.delete(t[F][0]);else break;0===u.size&&this._clearTimer()},this._interval)}}_trim(){const u=this._cachedBlocks;if(!(-1===this._size||this._size>=u.size)){var t=Array.from(u);for(let L=0;L<t.length-this._size;L++)u.delete(t[L][0])}}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}return p})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("require exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Polygon ../../../geometry/Point ../../../geometry/SpatialReference".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){function n(I,U,W){return!Q.canProjectWithoutEngine(I,U,W)}function h(I,U,W){if((I=n(I,U,W))&&!Q.isLoaded())throw new F("rasterprojectionhelper-project","projection engine is not loaded");return I}function m(I,U,W){h(I.spatialReference,U);return W?Q.getTransformation(U,I.spatialReference,I):Q.getTransformation(I.spatialReference,U,I)}function w(I,U,W){U=P.getMetersPerUnitForSR(U)/P.getMetersPerUnitForSR(W);return{x:I.x*U,y:I.y*U}}function k(I,U,W){const {spatialReference:aa}=
W;if(!aa||!U||aa.equals(U))return I;if(aa.isGeographic&&U.isGeographic)return w(I,aa,U);h(aa,U);if(!ca)throw new F("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let {x:da,y:ea}=I;var ha=P.getMetersPerUnitForSR(aa),ia=(da+ea)/2*ha;ha=1;30<ia&&(ha=30/ia,da*=ha,ea*=ha);ia=256*da/2;var ka=256*ea/2;const {x:ma,y:pa}=W.center;W=[];for(var oa=0;256>=oa;oa++)W.push([ma-ia,pa-ka+oa*ea]);for(oa=1;256>=oa;oa++)W.push([ma-ia+oa*da,pa+ka]);for(oa=1;256>=oa;oa++)W.push([ma+
ia,pa+ka-oa*ea]);for(oa=1;256>oa;oa++)W.push([ma+ia-oa*da,pa-ka]);W.push(W[0]);ia=new q({rings:[W],spatialReference:aa});ka=Q.project(ia,U);if(!ka)return w(I,aa,U);ia=ka.extent;W=N(U);if(null==ia||null!=W&&ia.width>=W)return w(I,aa,U);I=ca.planarArea(ka);I=Math.sqrt(I/(da*ea*65536))/ha;ha={x:ia.width/ha/256,y:ia.height/ha/256};I={x:da*I,y:ea*I};U=ha.x*ha.y;return.1>Math.abs(U-I.x*I.y)/U?ha:I}function r(I,U=.01){return P.getMetersPerUnitForSR(I)?U/P.getMetersPerUnitForSR(I):0}function a(I,U,W=null,
aa=!0){const da=I.spatialReference;if(da.equals(U))return I;h(da,U,W);W=Q.project(I,U,W);if(!aa||!W)return W;f([I],[W],da,U);return W}function f(I,U,W,aa){const da=G(W,!0),ea=G(aa,!0);W=r(W,500);aa=r(aa,500);if(W&&null!=da&&null!=ea)for(let ha=0;ha<I.length;ha++){const ia=U[ha];if(!ia)continue;const {x:ka}=I[ha],{x:ma}=ia;ma>=ea[1]-aa&&Math.abs(ka-da[0])<W?ia.x-=ea[1]-ea[0]:ma<=ea[0]+aa&&Math.abs(ka-da[1])<W&&(ia.x+=ea[1]-ea[0])}}function l(I){const {inSR:U,outSR:W,datumTransformation:aa,preferPE:da}=
I;if(U.equals(W))return{points:I}=v(I,null),I;if(U.isWebMercator&&W.isWGS84||U.isWGS84&&W.isWebMercator){const {cols:ka,rows:ma,xres:pa,yres:oa,usePixelCenter:sa,inSR:qa,outSR:va}=I;let {xmin:ta,ymax:wa}=I;sa&&(ta+=pa/2,wa-=oa/2);I=[];const ba=[];var ea=Math.max(ka,ma);for(var ha=0;ha<ea;ha++){var ia=Q.project(new c({x:ta+pa*Math.min(ka,ha),y:wa-oa*Math.min(ma,ha),spatialReference:qa}),va);ha<=ka&&I.push(ia.x);ha<=ma&&ba.push(ia.y)}ea=[];for(ha=0;ha<ka;ha++)for(ia=0;ia<ma;ia++)ea.push([I[ha],ba[ia]]);
return ea}return h(U,W,aa)&&da&&(U.isGeographic||null!=g(U))?b(I):d(I)}function d(I){var {points:U}=v(I,null);const {inSR:W,outSR:aa,datumTransformation:da}=I;I=U.map(ea=>new c(ea[0],ea[1],W));U=Q.project(I,aa,da);da&&f(I,U,W,aa);return U.map(ea=>ea?[ea.x,ea.y]:[NaN,NaN])}function b(I){const {inSR:U,outSR:W,datumTransformation:aa}=I;var da=g(U);const {points:ea,mask:ha}=v(I,da);U.isGeographic||(I=U.wkid?M.PeFactory.coordsys(U.wkid):M.PeFactory.fromString(U.isGeographic?M.PeDefs.PE_TYPE_GEOGCS:M.PeDefs.PE_TYPE_PROJCS,
U.wkt2||U.wkt),M.PeCSTransformations.projToGeog(I,ea.length,ea));if(null!=aa&&aa.steps.length){var ia;W.isGeographic&&(ia=ea.map(([ka])=>179.9955<ka?1:-179.9955>ka?-1:0));aa.steps.forEach(ka=>{const ma=ka.wkid?M.PeFactory.geogtran(ka.wkid):M.PeFactory.fromString(M.PeDefs.PE_TYPE_GEOGTRAN,ka.wkt);M.PeGTTransformations.geogToGeog(ma,ea.length,ea,null,ka.isInverse?M.PeDefs.PE_TRANSFORM_2_TO_1:M.PeDefs.PE_TRANSFORM_1_TO_2)});if(ia)for(I=0;I<ea.length;I++){da=ia[I];const ka=ea[I][0],ma=179.9955<ka?1:-179.9955>
ka?-1:0;da&&ma&&da!==ma&&(ea[I][0]=0<da?ka+360:ka-360)}}W.isGeographic||(ia=g(W,!0),C(ea,null!=ia&&ia.isEnvelope?[ia.bbox[1],ia.bbox[3]]:[-90,90]),ia=W.wkid?M.PeFactory.coordsys(W.wkid):M.PeFactory.fromString(W.isGeographic?M.PeDefs.PE_TYPE_GEOGCS:M.PeDefs.PE_TYPE_PROJCS,W.wkt2||W.wkt),M.PeCSTransformations.geogToProj(ia,ea.length,ea));ia=ea;if(ha&&ea.length!==ha.length){ia=[];for(let ka=0,ma=0;ka<ha.length;ka++)ha[ka]?ia.push(ea[ma++]):ia.push([NaN,NaN])}return ia}function g(I,U=!1){var W=I.wkid||
I.wkt2||I.wkt;if(!W||I.isGeographic)return null;W=String(W);if(S.has(W))return W=S.get(W),U?W?.gcs:W?.pcs;var aa=I.wkid?M.PeFactory.coordsys(I.wkid):M.PeFactory.fromString(I.isGeographic?M.PeDefs.PE_TYPE_GEOGCS:M.PeDefs.PE_TYPE_PROJCS,I.wkt2||I.wkt);I=r(I,1E-4);I=z(aa,I);aa=z(aa,0,!0);S.set(W,{pcs:I,gcs:aa});return U?aa:I}function z(I,U=0,W=!1){var aa=M.PePCSInfo.generate(I),da=W?I.horizonGcsGenerate():I.horizonPcsGenerate();if(!aa||!da?.length)return null;I=!1;var ea=da.find(pa=>1===pa.getInclusive()&&
1===pa.getKind());if(!ea){ea=da.find(pa=>1===pa.getInclusive()&&0===pa.getKind());if(!ea)return null;I=!0}W=W?0:(2===aa.getNorthPoleLocation()?1:0)|(2===aa.getSouthPoleLocation()?2:0);aa=aa.isPannableRectangle();ea=ea.getCoord();if(I)return{isEnvelope:I,isPannable:aa,vertices:ea,coef:null,bbox:[ea[0][0]-U,ea[0][1]-U,ea[1][0]+U,ea[1][1]+U],poleLocation:W};U=0;I=[];let [ha,ia]=ea[0],[ka,ma]=ea[0];for(let pa=0,oa=ea.length;pa<oa;pa++){U++;U===oa&&(U=0);const [sa,qa]=ea[pa],[va,ta]=ea[U];if(ta===qa)I.push([sa,
va,qa,ta,2]);else{da=(va-sa)/(ta-qa||1E-4);const wa=sa-da*qa;qa<ta?I.push([da,wa,qa,ta,0]):I.push([da,wa,ta,qa,1])}ha=ha<sa?ha:sa;ia=ia<qa?ia:qa;ka=ka>sa?ka:sa;ma=ma>qa?ma:qa}return{isEnvelope:!1,isPannable:aa,vertices:ea,coef:I,bbox:[ha,ia,ka,ma],poleLocation:W}}function v(I,U){const W=[],{cols:aa,rows:da,xres:ea,yres:ha,usePixelCenter:ia}=I;let {xmin:ka,ymax:ma}=I;ia&&(ka+=ea/2,ma-=ha/2);if(null==U){for(I=0;I<aa;I++)for(U=0;U<da;U++)W.push([ka+ea*I,ma-ha*U]);return{points:W}}I=new Uint8Array(aa*
da);if(U.isEnvelope){const {bbox:[wa,ba,la,fa]}=U;for(let na=0,ra=0;na<aa;na++){var pa=ka+ea*na,oa=U.isPannable||pa>=wa&&pa<=la;for(var sa=0;sa<da;sa++,ra++){var qa=ma-ha*sa;oa&&qa>=ba&&qa<=fa&&(W.push([pa,qa]),I[ra]=1)}}return{points:W,mask:I}}pa=U.coef;U=[];for(oa=0;oa<da;oa++){var va=ma-ha*oa;sa=[];qa=[];for(var ta=0;ta<pa.length;ta++){const [wa,ba,la,fa,na]=pa[ta];va===la&&la===fa?(sa.push(wa),sa.push(ba),qa.push(2),qa.push(2)):va>=la&&va<=fa&&(sa.push(wa*va+ba),qa.push(na))}va=sa;if(2<sa.length){ta=
2===qa[0]?0:qa[0];let wa=sa[0];va=[];for(let ba=1;ba<qa.length;ba++)if(2!==qa[ba]||ba===qa.length-1)qa[ba]!==ta&&(va.push(0===ta?Math.min(wa,sa[ba-1]):Math.max(wa,sa[ba-1])),ta=qa[ba],wa=sa[ba]),ba===qa.length-1&&va.push(0===qa[ba]?Math.min(wa,sa[ba]):Math.max(wa,sa[ba]));va.sort((ba,la)=>ba-la)}else sa[0]>sa[1]&&(va=[sa[1],sa[0]]);U.push(va)}for(let wa=0,ba=0;wa<aa;wa++)for(pa=ka+ea*wa,oa=0;oa<da;oa++,ba++)if(sa=ma-ha*oa,qa=U[oa],2===qa.length)pa>=qa[0]&&pa<=qa[1]&&(W.push([pa,sa]),I[ba]=1);else if(2<
qa.length){va=!1;for(ta=0;ta<qa.length;ta+=2)if(pa>=qa[ta]&&pa<=qa[ta+1]){va=!0;break}va&&(W.push([pa,sa]),I[ba]=1)}return{points:W,mask:I}}function C(I,U){const [W,aa]=U;for(U=0;U<I.length;U++){const da=I[U][1];if(da<W||da>aa)I[U]=[NaN,NaN]}}function y(I,U){const W=N(I[0].spatialReference);if(2>I.length||null==W)return I[0];U=U??r(I[0].spatialReference);I=I.filter(ia=>ia.width>U);if(1===I.length)return I[0];let {xmin:aa,xmax:da,ymin:ea,ymax:ha}=I[0];for(let ia=1;ia<I.length;ia++){const ka=I[ia];
da=ka.xmax+W*ia;ea=Math.min(ea,ka.ymin);ha=Math.max(ha,ka.ymax)}return new D({xmin:aa,xmax:da,ymin:ea,ymax:ha,spatialReference:I[0].spatialReference})}function A(I,U,W=null,aa=!0){var da=I.spatialReference;if(da.equals(U))return I;var ea=H(I);const ha=N(da,!0);var ia=N(U);if(0===ea||null==ha||null==ia)return ea=E(I,U,W,aa),null==ha&&null!=ia&&Math.abs(ea.width-ia)<r(U)&&Q.isLoaded()&&(da=g(da),null!=da&&da.poleLocation===X.None&&I.width<(da.bbox[2]-da.bbox[0])/2)?x(I,U)||ea:ea;ia=I.clone().normalize();
if(1===ia.length&&I.xmax<ha&&I.xmax-ha/2>r(da)){const {xmin:ka,xmax:ma}=I;for(let pa=0;pa<=ea;pa++)ia[pa]=new D({xmin:0===pa?ka:-ha/2,xmax:pa===ea?ma-ha*pa:ha/2,ymin:I.ymin,ymax:I.ymax,spatialReference:da})}I=ia.map(ka=>E(ka,U,W,aa));return y(I.filter(L.isSome))}function x(I,U){const W=N(U);if(null==W)return null;let {xmin:aa,ymin:da,xmax:ea,ymax:ha}=I;var ia=I.spatialReference;I=new q({spatialReference:ia,rings:[[[aa,da],[ea,da],[ea,ha],[aa,ha],[aa,da]]]});I=Q.project(I,U);if(2!==I.rings.length||
!I.rings[0].length||!I.rings[1].length)return null;({rings:I}=I);ia=r(ia);U=new D({spatialReference:U});for(let ka=0;2>ka;ka++){aa=ea=I[ka][0][0];da=ha=I[ka][0][1];for(let ma=0;ma<I[ka].length;ma++)aa=aa>I[ka][ma][0]?I[ka][ma][0]:aa,ea=ea<I[ka][ma][0]?I[ka][ma][0]:ea,da=da>I[ka][ma][1]?I[ka][ma][1]:da,ha=ha<I[ka][ma][1]?I[ka][ma][1]:ha;if(0===ka)U.ymin=da,U.ymax=ha,U.xmin=aa,U.xmax=ea;else if(U.ymin=Math.min(U.ymin,da),U.ymax=Math.max(U.ymax,ha),Math.abs(ea-W/2)<ia)U.xmin=aa,U.xmax+=W;else if(Math.abs(aa+
W/2)<ia)U.xmax=ea+W;else return null}return U}function E(I,U,W=null,aa=!0,da=!0){const ea=I.spatialReference;if(ea.equals(U)||!U)return I;h(ea,U,W);const ha=Q.project(I,U,W);if(da&&U.isWebMercator&&ha&&(ha.ymax=Math.min(2.0037508342787E7,ha.ymax),ha.ymin=Math.max(-2.0037508342787E7,ha.ymin),ha.ymin>=ha.ymax))return null;if(!aa||!ha)return ha;var ia=G(ea,!0);aa=G(U,!0);if(null==ia||null==aa)return ha;da=r(ea,.001);const ka=r(ea,500);var ma=r(U,.001);if(Math.abs(ha.xmin-aa[0])<ma&&Math.abs(ha.xmax-
aa[1])<ma){ma=Math.abs(I.xmin-ia[0]);ia=Math.abs(ia[1]-I.xmax);if(ma<da&&ia>ka){ha.xmin=aa[0];var pa=[];pa.push(new c(I.xmax,I.ymin,ea));pa.push(new c(I.xmax,(I.ymin+I.ymax)/2,ea));pa.push(new c(I.xmax,I.ymax,ea));pa=pa.map(oa=>a(oa,U,W)).filter(oa=>!isNaN(oa?.x)).map(oa=>oa.x);ha.xmax=Math.max.apply(null,pa)}ia<da&&ma>ka&&(ha.xmax=aa[1],aa=[],aa.push(new c(I.xmin,I.ymin,ea)),aa.push(new c(I.xmin,(I.ymin+I.ymax)/2,ea)),aa.push(new c(I.xmin,I.ymax,ea)),I=aa.map(oa=>a(oa,U,W)).filter(oa=>!isNaN(oa?.x)).map(oa=>
oa.x),ha.xmin=Math.min.apply(null,I))}else I=r(U,.001),Math.abs(ha.xmin-aa[0])<I&&(ha.xmin=aa[0]),Math.abs(ha.xmax-aa[1])<I&&(ha.xmax=aa[1]);return ha}function N(I,U=!1){return I?I.isWebMercator?2*(U?2.0037508342787E7:2.0037508342788905E7):I.wkid&&I.isGeographic?360:2*K[I.wkid]||null:null}function G(I,U=!1){if(I.isGeographic)return[-180,180];I=N(I,U);return null!=I?[-I/2,I/2]:null}function O(I,U,W,aa){I=(I-U)/W;0!==I-Math.floor(I)?I=Math.floor(I):aa&&--I;return I}function H(I,U=!1){var W=N(I.spatialReference);
if(null==W)return 0;const aa=U?0:-(W/2),da=r(I.spatialReference),ea=!U&&Math.abs(I.xmin+W/2)<da?-W/2:I.xmin;I=O(!U&&Math.abs(I.xmax-W/2)<da?W/2:I.xmax,aa,W,!0);W=O(ea,aa,W,!1);return I-W}function J(I){const {projectedExtent:U,srcBufferExtent:W,pixelSize:aa,datumTransformation:da,rasterTransform:ea}=I;var ha=U.spatialReference;const ia=W.spatialReference;var ka=h(ha,ia);const {xmin:ma,ymin:pa,xmax:oa,ymax:sa}=U,qa=N(ia),va=null!=qa&&(I.hasWrapAround||"gcs-shift"===ea?.type);I=I.spacing||[32,32];var ta=
I[0]*aa.x,wa=I[1]*aa.y;const ba=1===I[0],la=Math.ceil((oa-ma)/ta-.1/I[0])+(ba?0:1),fa=Math.ceil((sa-pa)/wa-.1/I[1])+(ba?0:1);ta=l({cols:la,rows:fa,xmin:ma,ymax:sa,xres:ta,yres:wa,inSR:ha,outSR:ia,datumTransformation:da,preferPE:4>=I[0],usePixelCenter:ba});wa=[];let na,ra=0;const ja=ba?-1:NaN,{xmin:ua,xmax:xa,ymax:ya,width:za,height:Ba}=W,Ca=r(ia,500),Fa=null!=qa&&0<ua&&xa>qa/2;var Da=!1;ka&&(Da=g(ha),Da=null!=Da&&0<Da.poleLocation);for(ha=0;ha<la;ha++){ka=[];for(let Ea=0;Ea<fa;Ea++){var Aa=ta[ha*
fa+Ea];va&&Aa[0]>xa&&Aa[0]>qa/2-Ca?Aa[0]-=qa:va&&0===ha&&0>Aa[0]&&Fa&&!ea&&(Aa[0]+=qa);!Aa||isNaN(Aa[0])||isNaN(Aa[1])?(wa.push(ja),wa.push(ja),ka.push(null),ra++):(ea&&(Aa=ea.inverseTransform(new c({x:Aa[0],y:Aa[1],spatialReference:ia})),Aa=[Aa.x,Aa.y]),ka.push(Aa),0<ha&&va&&na[Ea]&&Aa[0]<na[Ea][0]&&(Aa[0]+=qa,Da&&Aa[0]>xa&&Aa[0]>qa&&(Aa[0]-=qa)),wa.push((Aa[0]-ua)/za),wa.push((ya-Aa[1])/Ba))}na=ka}return{offsets:wa,error:null,coefficients:null,outofBoundPointCount:ra,spacing:I,size:ba?[la,fa]:[la-
1,fa-1]}}function R(I,U,W){const {cols:aa,rows:da}=U;U=new Float32Array((aa-1)*(da-1)*12);const ea=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),ha=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let sa=0;sa<aa-1;sa++){for(var ia=0;ia<da-1;ia++){var ka=sa*da*2+2*ia,ma=I[ka];const qa=I[ka+1];var pa=I[ka+2],oa=I[ka+3];ka+=2*da;const va=I[ka],ta=I[ka+1],wa=I[ka+2];ka=I[ka+3];let ba=0,la=12*(ia*(aa-1)+sa);for(let fa=0;3>fa;fa++)U[la++]=ea[ba++]*ma+ea[ba++]*pa+ea[ba++]*wa;ba=0;for(pa=0;3>pa;pa++)U[la++]=ea[ba++]*
qa+ea[ba++]*oa+ea[ba++]*ka;ba=0;for(oa=0;3>oa;oa++)U[la++]=ha[ba++]*ma+ha[ba++]*va+ha[ba++]*wa;ba=0;for(ma=0;3>ma;ma++)U[la++]=ha[ba++]*qa+ha[ba++]*ta+ha[ba++]*ka}if(W)for(ia=0;ia<U.length;ia++)isNaN(U[ia])&&(U[ia]=-1)}return U}function Y(I,U){I=I.clone().normalize();return 1===I.length?I[0]:y(I,U)}function T(I,U){const {pixelSize:W,extent:aa}=I;I=m(aa,U,!1);const da=Y(aa,(W.x+W.y)/16);return A(da,U,I)}var X;(function(I){I[I.None=0]="None";I[I.North=1]="North";I[I.South=2]="South";I[I.Both=3]="Both"})(X||=
{});const V=(I,U,W,aa=0)=>{if(1===W[0])return[0,0];var da=1,ea=-1,ha=1,ia=-1;for(var ka=0;ka<I.length;ka+=2)isNaN(I[ka])||(da=da>I[ka]?I[ka]:da,ea=ea>I[ka]?ea:I[ka],ha=ha>I[ka+1]?I[ka+1]:ha,ia=ia>I[ka+1]?ia:I[ka+1]);const {cols:ma,rows:pa}=U;U=(ea-da)/ma/W[0];W=(ia-ha)/pa/W[1];aa*=2;ha=0;ia=!1;da=[0,0];for(ea=0;ea<ma-3;ea++){for(ka=0;ka<pa-3;ka++){var oa=ea*pa*2+2*ka;const sa=Math.abs(((I[oa]+I[oa+4]+I[oa+4*pa]+I[oa+4*pa+4])/4-I[oa+2*pa+2])/U);oa=Math.abs(((I[oa+1]+I[oa+5]+I[oa+4*pa+1]+I[oa+4*pa+
5])/4-I[oa+2*pa+3])/W);sa+oa>ha&&(ha=sa+oa,da=[sa,oa]);if(aa&&ha>aa){ia=!0;break}}if(ia)break}return da},K={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,
53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},S=new Map,Z=new Map;let ca=null;u.computeProjectedScales=function(I,U,W){var aa=W?.tileSize??512,da=W?.alignGlobalDatasetWithAGOL??!0,ea=!!W?.limitToSrcResolution;
const {extent:ha,spatialReference:ia,pixelSize:ka}=I;W=k(ka,U,ha);if(null==W)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ma=(W.x+W.y)/2,pa=P.getMetersPerUnitForSR(U);var oa=ma*pa*96*39.37,sa=U.isGeographic?256/aa*2.958287637958547E8:256/aa*5.91657527591555E8,qa="vector-magdir"===I.dataType||"vector-uv"===I.dataType,va=T(I,U),ta=Math.min(Math.ceil(Math.log(Math.min(I.width,I.height)/32)/Math.LN2),Math.ceil(Math.log(sa/2/oa)/Math.LN2));if(!qa&&da&&(U.isGeographic||
U.isWebMercator)&&(da=N(U),qa=0<H(va)||null!=da&&va.width>da/4,!qa&&null!=da)){qa=-1;if(3>ta)qa=2**ta*ma*aa;else if(I.storageInfo){const {maximumPyramidLevel:wa=0,pyramidScalingFactor:ba=2}=I.storageInfo;qa=ba**wa*ma*aa}aa=Math.ceil(da/qa);qa=1===aa||2===aa&&da/2-va.xmax<qa}aa=oa;va=Math.min(2,Math.max(1.414,I.storageInfo?.pyramidScalingFactor||2));if(qa)aa=sa,sa=U.isGeographic?1.341104507446289E-6:.29858214164761665,ta=96*sa*pa*39.37,I=T(I,new e({wkid:U.isGeographic?4326:3857})),I=k({x:sa,y:sa},
ia,I),I.x*=aa/ta,I.y*=aa/ta;else{I={x:ka.x,y:ka.y};for(U=0;aa<.5005*sa&&U<ta;)U++,aa*=va,I.x*=va,I.y*=va;1.001>=Math.max(aa,sa)/Math.min(aa,sa)&&(aa=sa)}U=[aa];sa=[{x:I.x,y:I.y}];for(oa=Math.min(70.5310735,oa)/1.001;aa>=oa;)aa/=va,I.x/=va,I.y/=va,U.push(aa),sa.push({x:I.x,y:I.y});if(ea){const wa=.001*ka.x;ea=sa.findIndex(ba=>ba.x>=ka.x-wa&&ba.x<=ka.x+wa);-1<ea?(sa.length=ea+1,U.length=ea+1):(ea=sa.findIndex(ba=>ba.x<=ka.x+wa),0<ea&&(sa.length=ea,U.length=ea))}return{projectedPixelSize:W,scales:U,
srcResolutions:sa,isCustomTilingScheme:!qa}};u.defaultGridSpacing=32;u.defaultProjectionToleranceInPixels=4;u.getDefaultDatumTransformationForDataset=m;u.getProjectedGridPoints=l;u.getProjectionOffsetGrid=function(I){var U=I.isAdaptive&&null==I.spacing;let W=I.spacing||[32,32],aa=J(I);var da={cols:aa.size[0]+1,rows:aa.size[1]+1};const ea=0<aa.outofBoundPointCount&&aa.outofBoundPointCount<aa.offsets.length/2;let ha=aa.outofBoundPointCount===aa.offsets.length/2||U&&ea?[0,0]:V(aa.offsets,da,W,4);const ia=
(ha[0]+ha[1])/2;var ka=I.projectedExtent.spatialReference;const ma=I.srcBufferExtent.spatialReference;U&&(ea||4<ia)&&(n(ka,ma,I.datumTransformation)&&(ka.isGeographic||null!=g(ka)),W=[4,4],aa=J({...I,spacing:W}),da={cols:aa.size[0]+1,rows:aa.size[1]+1},ha=V(aa.offsets,da,W,4));aa.error=ha;1<W[0]&&(aa.coefficients=R(aa.offsets,da,ea));!I.includeGCSGrid||ka.isGeographic||ka.isWebMercator||(ma.isGeographic?aa.gcsGrid={offsets:aa.offsets,coefficients:aa.coefficients,spacing:W}:(U=g(ka),null==U||U.isEnvelope||
(ka&&!ka.isGeographic&&(U=String(ka.wkid||ka.wkt2||ka.wkt),Z.has(U)?ka=Z.get(U):(ka=(ka.wkid?M.PeFactory.coordsys(ka.wkid):M.PeFactory.fromString(M.PeDefs.PE_TYPE_PROJCS,ka.wkt2||ka.wkt)).getGeogcs().getCode(),Z.set(U,ka)),ka=new e({wkid:ka})),ka=A(I.projectedExtent,ka),{offsets:I}=J({...I,srcBufferExtent:ka,spacing:W}),da=R(I,da,ea),aa.gcsGrid={offsets:I,coefficients:da,spacing:W})));return aa};u.getRasterDatasetAlignmentInfo=function(I){const U=I.storageInfo.origin.x;var W=N(I.spatialReference,
!0);if(null==W)return{originX:U,halfWorldWidth:null,pyramidsInfo:null};const aa=W/2,{nativePixelSize:da,storageInfo:ea,extent:ha}=I,{maximumPyramidLevel:ia,blockWidth:ka,pyramidScalingFactor:ma}=ea;let pa=da.x;const oa=[];I=null!=I.transform&&"gcs-shift"===I.transform.type;const sa=U+(I?0:aa);W=I?W-U:aa-U;for(let qa=0;qa<=ia;qa++){const va=(ha.xmax-U)/pa/ka,ta=W/pa/ka;oa.push({resolutionX:pa,blockWidth:ka,datasetColumnCount:0===va-Math.floor(va)?va:Math.ceil(va),worldColumnCountFromOrigin:0===ta-
Math.floor(ta)?ta:Math.ceil(ta),leftMargin:Math.round(sa/pa)%ka,rightPadding:(ka-Math.round(W/pa)%ka)%ka,originColumnOffset:Math.floor(sa/pa/ka)});pa*=ma}return{originX:U,halfWorldWidth:aa,pyramidsInfo:oa,hasGCSSShiftTransform:I}};u.getWorldWidth=N;u.getWorldWrapCount=H;u.load=async function(){ca&&Q.isLoaded()||(Q.isLoaded()||await Q.load(),ca=await new Promise((I,U)=>p(["../../../geometry/geometryEngine"],I,U)))};u.minimumGridSpacing=4;u.projectDatasetExtent=T;u.projectDatasetResolution=k;u.projectExtent=
A;u.projectPoint=a;u.projectPolygon=function(I,U,W){if("extent"===I.type){const {xmin:aa,ymin:da,xmax:ea,ymax:ha,spatialReference:ia}=I;I=new q({rings:[[[aa,ha],[ea,ha],[ea,da],[aa,da],[aa,ha]]],spatialReference:ia})}if(I.spatialReference.equals(U))return I;h(I.spatialReference,U,W);return Q.project(I,U,W)};u.projectResolution=function(I,U,W,aa=null){const da=I.spatialReference;if(!da||!U||da.equals(U))return I;h(da,U,aa);W=W.center;W=new D({xmin:W.x-I.x/2,xmax:W.x+I.x/2,ymin:W.y-I.y/2,ymax:W.y+I.y/
2,spatialReference:da});aa=Q.project(W,U,aa);W=N(U);return null==aa||null!=W&&aa.width>=W?w(I,da,U):{x:aa.width,y:aa.height}};u.requirePE=n;u.shiftExtent=function(I){var {spatialReference:U}=I;U=B.getInfo(U);if(!U)return I;const [W,aa]=U.valid;U=aa-W;let da=0;I.xmin<W?da=Math.ceil((W-I.xmin)/U):I.xmin>aa&&(da=-Math.ceil((I.xmin-aa)/U));return new D({spatialReference:I.spatialReference,xmin:I.xmin+da*U,ymin:I.ymin,xmax:I.xmax+da*U,ymax:I.ymax})};u.snapExtent=Y;u.snapPyramid=function(I,U,W){const {storageInfo:aa,
pixelSize:da}=U;var ea=0;let ha=!1;var {pyramidResolutions:ia}=aa,ka="mixed"===aa.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,aa.tileInfo.dpi/96)):1;ka=(I.x+I.y)/2/ka;if(null!=ia&&ia.length){I=ia[ia.length-1];I=(I.x+I.y)/2;var ma=(da.x+da.y)/2;if(ka<=ma)ea=0;else if(ka>=I)ea=ia.length,ha=8<ka/I;else{I=ma;for(let pa=1;pa<=ia.length;pa++){ma=(ia[pa-1].x+ia[pa-1].y)/2;if(ka<=ma){ka===ma?ea=pa:"down"===W?(ea=pa-1,ha=8<ka/I):ea="up"===W?pa:ka-I>ma-ka||2<ka/I?pa:pa-1;break}I=ma}}W=0===ea?da:ia[ea-
1];ha&&(ia=Math.min(W.x,W.y),ka=P.getMetersPerUnitForSR(U.spatialReference),19567<ia*ka&&(ha=!1));return{pyramidLevel:ea,pyramidResolution:new c({x:W.x,y:W.y,spatialReference:U.spatialReference}),excessiveReading:ha}}ea=Math.log(I.x/da.x)/Math.LN2;ka=Math.log(I.y/da.y)/Math.LN2;ia=U.storageInfo.maximumPyramidLevel||0;ea="down"===W?Math.floor(Math.min(ea,ka)):"up"===W?Math.ceil(Math.max(ea,ka)):Math.round((ea+ka)/2);0>ea?ea=0:ea>ia&&(ha=ea>ia+3,ea=ia);W=2**ea;U=new c({x:W*U.nativePixelSize.x,y:W*U.nativePixelSize.y,
spatialReference:U.spatialReference});return{pyramidLevel:ea,pyramidResolution:U,excessiveReading:ha}};Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ../SimpleBandStatistics ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n){async function h(y,A){if(!n.isPlatformLittleEndian)throw new u("rasterCoded:decode",
"lerc decoder is not supported on big endian platform");await Q.load();const {offset:x}=A,{width:E,height:N,pixelType:G,statistics:O,depthCount:H,noDataValues:J,bandMasks:R,pixels:Y,mask:T}=Q.decode(y,{inputOffset:x,returnInterleaved:A.returnInterleaved});y=new L({width:E,height:N,pixelType:G.toLowerCase(),pixels:Y,mask:T,statistics:O.map(({minValue:X,maxValue:V})=>new F.SimpleBandStatistics(X,V)),bandMasks:R,depthCount:H,noDataValues:J});O?.length||y.updateStatistics();return y}async function m(y,
A){y=await e.decode(y,{...A,noDataValue:null});t.assertIsSome(y);y=new L({width:y.width,height:y.height,pixels:y.pixels,pixelType:y.pixelType.toLowerCase(),mask:y.mask,bandMasks:y.bandMasks,statistics:null});y.updateStatistics();return y}async function w(y,A){y=await e.decodeTileOrStrip(y,A.customOptions);y=new L({width:y.width,height:y.height,pixels:y.pixels,pixelType:y.pixelType.toLowerCase(),mask:y.mask,statistics:null});y.updateStatistics();return y}function k(y,A){const x=A.pixelType||"u8",E=
L.getPixelArrayConstructor(x),N="u8"===x?y:new E(y.buffer),G=[],O=A.planes||1;if(1===O)G.push(N);else for(let H=0;H<O;H++){const J=(A.width||1)*(A.height||y.length),R=new E(J);for(let Y=0;Y<J;Y++)R[Y]=N[Y*O+H];G.push(R)}y=new L({width:A.width||1,height:A.height||y.length,pixels:G,pixelType:x,statistics:null});y.updateStatistics();return y}function r(y,A){y=(new q.Zlib(new Uint8Array(y))).getBytes();return k(y,A)}function a(y,A){y=B.decode(y,A.offset,A.eof,!A.isInputBigEndian);return k(y,A)}function f(y,
A){y=M.decode(y,A.hasNoZlibMask??void 0);y=new L({width:y.width,height:y.height,pixels:y.pixels,pixelType:"u8",mask:y.mask,statistics:null});y.updateStatistics();return y}function l(y,A){y=new Uint8Array(y);y=new v(y);const {width:x,height:E}=A;A=x*E;y=y.decode();let N=0;var G=0;let O;G=new Uint8Array(A);for(N=0;N<A;N++)G[N]=y[4*N+3];const H=new L({width:x,height:E,pixels:[],pixelType:"u8",mask:G,statistics:[]});for(N=0;3>N;N++){O=new Uint8Array(A);for(G=0;G<A;G++)O[G]=y[4*G+N];H.addData({pixels:O})}H.updateStatistics();
return H}async function d(y,A,x,E){y=await (new P).decode(y,{applyJpegMask:!1,format:A,...x},E);y=new L(y);y.updateStatistics();return y}function b(y){if(null==y)throw new u("rasterCodec:decode","parameter encodeddata is required.");y=new Uint8Array(y,0,10);let A="";255===y[0]&&216===y[1]?A="jpg":137===y[0]&&80===y[1]&&78===y[2]&&71===y[3]?A="png":67===y[0]&&110===y[1]&&116===y[2]&&90===y[3]&&73===y[4]&&109===y[5]&&97===y[6]&&103===y[7]&&101===y[8]&&32===y[9]?A="lerc":76===y[0]&&101===y[1]&&114===
y[2]&&99===y[3]&&50===y[4]&&32===y[5]?A="lerc2":73===y[0]&&73===y[1]&&42===y[2]&&0===y[3]||77===y[0]&&77===y[1]&&0===y[2]&&42===y[3]||73===y[0]&&73===y[1]&&43===y[2]&&0===y[3]||77===y[0]&&77===y[1]&&0===y[2]&&43===y[3]?A="tiff":71===y[0]&&73===y[1]&&70===y[2]?A="gif":66===y[0]&&77===y[1]?A="bmp":String.fromCharCode.apply(null,y).toLowerCase().includes("error")&&(A="error");return A}function g(y){let A=null;switch(y){case "lerc":case "lerc2":A=h;break;case "jpg":A=f;break;case "png":A=l;break;case "bsq":case "bip":A=
(x,E)=>{var N=E.pixelType,G=null;let O=null;switch(N?N.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":O=255;G=Uint8Array;break;case "u16":O=O||65535;G=Uint16Array;break;case "u32":O=O||2**32-1;G=Uint32Array;break;case "s8":O=O||-128;G=Int8Array;break;case "s16":O=O||-32768;G=Int16Array;break;case "s32":O=O||-(2**31);G=Int32Array;break;default:G=Float32Array}({pixelTypeCtor:N}={pixelTypeCtor:G,noDataValue:O});G=c.decode;x=G(x,{width:E.width,height:E.height,pixelType:N,format:y});E=new L({width:E.width,
height:E.height,pixels:x.pixels,pixelType:E.pixelType,mask:x.mask,statistics:null});E.updateStatistics();return E};break;case "tiff":A=m;break;case "deflate":A=r;break;case "lzw":A=a;break;case "error":A=()=>{throw new u("rasterCodec:decode","input data contains error");};break;default:A=()=>{throw new u("rasterCodec:decode","unsupported raster format");}}return A}function z(y,A=1){if(y){var {pixels:x,width:E,height:N,mask:G}=y;if(x&&0!==x.length){var O=x.length,H=E-1,J=N-1,R=[],Y,T,X=null,V=L.getPixelArrayConstructor(y.pixelType);
if(0===A){for(A=0;A<O;A++){var K=x[A];var S=new V(H*J);for(Y=0;Y<J;Y++){var Z=Y*E;for(T=0;T<H;T++)S[Y*H+T]=K[Z+T]}R.push(S)}if(null!=G)for(X=new Uint8Array(H*J),Y=0;Y<J;Y++)for(Z=Y*E,T=0;T<H;T++)X[Y*H+T]=G[Z+T]}else{for(A=0;A<O;A++){K=x[A];S=new V(H*J);for(Y=0;Y<J;Y++)for(Z=Y*E,T=0;T<H;T++)S[Y*H+T]=(K[Z+T]+K[Z+T+1]+K[Z+E+T]+K[Z+E+T+1])/4;R.push(S)}if(G)for(X=new Uint8Array(H*J),Y=0;Y<J;Y++)for(Z=Y*E,T=0;T<H;T++)X[Y*H+T]=Math.min.apply(null,[G[Z+T],G[Z+T+1],G[Z+E+T],G[Z+E+T+1]])}y.width=H;y.height=
J;y.mask=X;y.pixels=R}}}var v=function(y){function A(G){var O,H;this.data=G;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(H=null;;){var J=this.readUInt32();var R=G=void 0;G=[];for(R=0;4>R;++R)G.push(String.fromCharCode(this.data[this.pos++]));G=G.join("");switch(G){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];
this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(J);break;case "fcTL":H&&this.animation.frames.push(H);this.pos+=4;H={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};G=this.readUInt16();J=this.readUInt16()||100;H.delay=1E3*G/J;H.disposeOp=this.data[this.pos++];H.blendOp=
this.data[this.pos++];H.data=[];break;case "IDAT":case "fdAT":"fdAT"===G&&(this.pos+=4,J-=4);G=(null!=H?H.data:void 0)||this.imgData;for(R=0;0<=J?R<J:R>J;0<=J?++R:--R)G.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(J);J=255-this.transparency.indexed.length;if(0<J)for(G=0;0<=J?G<J:G>J;0<=J?++G:--G)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(J)[0];break;case 2:this.transparency.rgb=
this.read(J)}break;case "tEXt":R=this.read(J);J=R.indexOf(0);G=String.fromCharCode.apply(String,R.slice(0,J));this.text[G]=String.fromCharCode.apply(String,R.slice(J+1));break;case "IEND":H&&this.animation.frames.push(H);a:{switch(this.colorType){case 0:case 3:case 4:H=1;break a;case 2:case 6:H=3;break a}H=void 0}this.colors=H;this.hasAlphaChannel=4===(O=this.colorType)||6===O;O=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*O;a:{switch(this.colors){case 1:O="DeviceGray";break a;
case 3:O="DeviceRGB";break a}O=void 0}this.colorSpace=O;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=J}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var x;A.load=function(G,O,H){"function"===typeof O&&(H=O);var J=new XMLHttpRequest;J.open("GET",G,!0);J.responseType="arraybuffer";J.onload=function(){var R=new Uint8Array(J.response||J.mozResponseArrayBuffer);R=new A(R);"function"===typeof(null!=O?O.getContext:void 0)&&R.render(O);return"function"===
typeof H?H(R):void 0};return J.send(null)};A.prototype.read=function(G){var O;var H=[];for(O=0;0<=G?O<G:O>G;0<=G?++O:--O)H.push(this.data[this.pos++]);return H};A.prototype.readUInt32=function(){var G=this.data[this.pos++]<<24;var O=this.data[this.pos++]<<16;var H=this.data[this.pos++]<<8;var J=this.data[this.pos++];return G|O|H|J};A.prototype.readUInt16=function(){var G=this.data[this.pos++]<<8;var O=this.data[this.pos++];return G|O};A.prototype.decodePixels=function(G){var O,H,J,R,Y,T,X,V;null==
G&&(G=this.imgData);if(0===G.length)return new Uint8Array(0);G=new q.Zlib(G);G=G.getBytes();var K=this.pixelBitlength/8;var S=K*this.width;var Z=new Uint8Array(S*this.height);var ca=G.length;for(H=R=Y=0;R<ca;){switch(G[R++]){case 0:for(J=O=0;O<S;J=O+=1)Z[H++]=G[R++];break;case 1:for(J=T=0;T<S;J=T+=1){O=G[R++];var I=J<K?0:Z[H-K];Z[H++]=(O+I)%256}break;case 2:for(J=I=0;I<S;J=I+=1){O=G[R++];var U=(J-J%K)/K;T=Y&&Z[(Y-1)*S+U*K+J%K];Z[H++]=(T+O)%256}break;case 3:for(J=V=0;V<S;J=V+=1)O=G[R++],U=(J-J%K)/
K,I=J<K?0:Z[H-K],T=Y&&Z[(Y-1)*S+U*K+J%K],Z[H++]=(O+Math.floor((I+T)/2))%256;break;case 4:for(J=V=0;V<S;J=V+=1){O=G[R++];U=(J-J%K)/K;I=J<K?0:Z[H-K];0===Y?T=X=0:(T=Z[(Y-1)*S+U*K+J%K],X=U&&Z[(Y-1)*S+(U-1)*K+J%K]);var W=I+T-X;J=Math.abs(W-I);U=Math.abs(W-T);W=Math.abs(W-X);I=J<=U&&J<=W?I:U<=W?T:X;Z[H++]=(O+I)%256}break;default:throw Error("Invalid filter algorithm: "+G[R-1]);}Y++}return Z};A.prototype.decodePalette=function(){var G,O,H,J;var R=this.palette;var Y=this.transparency.indexed||[];var T=new Uint8Array((Y.length||
0)+R.length);var X=0;R.length;var V=O=G=0;for(H=R.length;O<H;V=O+=3)T[X++]=R[V],T[X++]=R[V+1],T[X++]=R[V+2],T[X++]=null!=(J=Y[G++])?J:255;return T};A.prototype.copyToImageData=function(G,O){var H,J;var R=this.colors;var Y=null;var T=this.hasAlphaChannel;this.palette.length&&(Y=null!=(H=this._decodedPalette)?H:this._decodedPalette=this.decodePalette(),R=4,T=!0);G=G.data||G;var X=G.length;var V=Y||O;H=J=0;if(1===R)for(;H<X;)R=Y?4*O[H/4]:J,J=V[R++],G[H++]=J,G[H++]=J,G[H++]=J,G[H++]=T?V[R++]:this.transparency.grayscale&&
this.transparency.grayscale===J?0:255,J=R;else for(;H<X;)R=Y?4*O[H/4]:J,G[H++]=V[R++],G[H++]=V[R++],G[H++]=V[R++],G[H++]=T?V[R++]:this.transparency.rgb&&this.transparency.rgb[1]===V[R-3]&&this.transparency.rgb[3]===V[R-2]&&this.transparency.rgb[5]===V[R-1]?0:255,J=R};A.prototype.decode=function(){var G=new Uint8Array(this.width*this.height*4);this.copyToImageData(G,this.decodePixels());return G};var E=(x=y.document&&y.document.createElement("canvas"))&&x.getContext("2d");var N=function(G){E.width=
G.width;E.height=G.height;E.clearRect(0,0,G.width,G.height);E.putImageData(G,0,0);G=new Image;G.src=x.toDataURL();return G};A.prototype.decodeFrames=function(G){var O,H;if(this.animation){var J=this.animation.frames;var R=[];var Y=O=0;for(H=J.length;O<H;Y=++O){Y=J[Y];var T=G.createImageData(Y.width,Y.height);var X=this.decodePixels(new Uint8Array(Y.data));this.copyToImageData(T,X);Y.imageData=T;R.push(Y.image=N(T))}return R}};A.prototype.renderFrame=function(G,O){var H=this.animation.frames;var J=
H[O];H=H[O-1];0===O&&G.clearRect(0,0,this.width,this.height);1===(null!=H?H.disposeOp:void 0)?G.clearRect(H.xOffset,H.yOffset,H.width,H.height):2===(null!=H?H.disposeOp:void 0)&&G.putImageData(H.imageData,H.xOffset,H.yOffset);0===J.blendOp&&G.clearRect(J.xOffset,J.yOffset,J.width,J.height);return G.drawImage(J.image,J.xOffset,J.yOffset)};A.prototype.animate=function(G){var O,H=this;var J=0;var R=this.animation;var Y=R.numFrames;var T=R.frames;var X=R.numPlays;return(O=function(){var V=J++%Y;var K=
T[V];H.renderFrame(G,V);if(1<Y&&J/Y<X)return H.animation._timeout=setTimeout(O,K.delay)})()};A.prototype.stopAnimation=function(){var G;return clearTimeout(null!=(G=this.animation)?G._timeout:void 0)};A.prototype.render=function(G){G._png&&G._png.stopAnimation();G._png=this;G.width=this.width;G.height=this.height;G=G.getContext("2d");if(this.animation)return this.decodeFrames(G),this.animate(G);var O=G.createImageData(this.width,this.height);this.copyToImageData(O,this.decodePixels());return G.putImageData(O,
0,0)};return A}(self);const C=new Set(["jpg","png","bmp","gif"]);p.decode=async function(y,A={},x){if(null==y)throw new u("rasterCodec:decode","missing encodeddata parameter.");let E=A.format?.toLowerCase();if(!("bsq"!==E&&"bip"!==E||null!=A.width&&null!=A.height))throw new u("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===E&&A.customOptions)return w(y,A);if(!E||"bsq"!==E&&"bip"!==E&&"deflate"!==E&&"lzw"!==E)E=b(y);if(A.useCanvas&&C.has(E))return d(y,E,A,x);const N=
g(E);A.isPoint&&(A={...A},null!=A.width&&A.width++,null!=A.height&&A.height++);let G;const {offsets:O}=A;if(O&&1<O.length){x=O.map((J,R)=>N(y.slice(J,O[R+1]),A));x=await Promise.all(x);G=x[0];G.pixels=x.map(J=>J.pixels[0]);const H=x.map(J=>J.mask);x.some(J=>null!=J)&&(H.forEach((J,R)=>{null==J&&(H[R]=(new Uint8Array(G.width*G.height)).fill(255))}),G.bandMasks=H,G.mask=L.combineBandMasks(H));G.updateStatistics()}else G=await N(y,{...A,offset:O?.[0]??A.offset});"jpg"!==E&&null!=A.noDataValue&&1===G.depthCount&&
D.convertNoDataToMask(G,A.noDataValue,{customFloatTolerance:A.tolerance});A.isPoint&&z(G);return G};p.getFormat=function(y){y=b(y);"lerc2"===y?y="lerc":"error"===y&&(y="");return y};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],function(p,u,t){class L{constructor(F){this._ctx=this._canvas=null;F&&(this._canvas=F.canvas,this._ctx=F.ctx||
F.canvas&&F.canvas.getContext("2d"))}decode(F,P,M){if(!F||10>F.byteLength)throw new p("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:Q=0,height:B=0,format:D}=P;const {applyJpegMask:q}=P;if(q&&(!Q||!B))throw new p("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((c,e)=>{let n=null;"jpg"===D&&q&&(n=L._getMask(F,{width:Q,height:B}));const h=new Blob([new Uint8Array(F)],{type:"jpg"==="image/"+
D?"jpeg":D}),m=URL.createObjectURL(h),w=new Image;let k;w.src=m;w.onload=()=>{URL.revokeObjectURL(m);if(u.isAborted(M))e(u.createAbortError());else{Q=w.width;B=w.height;if(this._canvas&&this._ctx){if(this._canvas.width!==Q||this._canvas.height!==B)this._canvas.width=Q,this._canvas.height=B;this._ctx.clearRect(0,0,Q,B)}else this._canvas=document.createElement("canvas"),this._canvas.width=Q,this._canvas.height=B,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(w,0,0);var r=this._ctx.getImageData(0,
0,Q,B);k=r.data;var a;if(P.renderOnCanvas){if(n)for(a=0;a<n.length;a++)k[4*a+3]=n[a]?255:0;this._ctx.putImageData(r,0,0);c(null)}else{r=Q*B;var f=new Uint8Array(r),l=new Uint8Array(r),d=new Uint8Array(r);if(n)for(a=0;a<r;a++)f[a]=k[4*a],l[a]=k[4*a+1],d[a]=k[4*a+2];else for(n=new Uint8Array(r),a=0;a<r;a++)f[a]=k[4*a],l[a]=k[4*a+1],d[a]=k[4*a+2],n[a]=k[4*a+3];c({width:Q,height:B,pixels:[f,l,d],mask:n,pixelType:"u8"})}}};w.onerror=()=>{URL.revokeObjectURL(m);e("cannot load image")}})}static _getMask(F,
P){let M=null;try{var Q=new Uint8Array(F);F=0;var B=Q.length-2;for(F=Math.ceil(Q.length/2);F<B&&(255!==Q[F]||217!==Q[F+1]);F++);F+=2;if(F<Q.length-1){const D=(new t.Zlib(Q.subarray(F))).getBytes();M=new Uint8Array(P.width*P.height);P=0;for(Q=0;Q<D.length;Q++)for(B=7;0<=B;B--)M[P++]=D[Q]>>B&1}}catch(D){}return M}}return L})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],function(p,u){var t={exports:{}},L,F=function(){if(L)return t.exports;L=1;(function(P){(function(M){M=M();
void 0!==M&&(P.exports=M)})(function(){var M=function(){function Q(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}Q.prototype={ensureBuffer:function(B){var D=this.buffer,q=D?D.byteLength:0;if(B<q)return D;for(var c=512;c<B;)c<<=1;B=new Uint8Array(c);for(c=0;c<q;++c)B[c]=D[c];return this.buffer=B},getByte:function(){for(var B=this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(B){var D=this.pos;if(B){this.ensureBuffer(D+
B);for(B=D+B;!this.eof&&this.bufferLength<B;)this.readBlock();var q=this.bufferLength;B>q&&(B=q)}else{for(;!this.eof;)this.readBlock();B=this.bufferLength}this.pos=B;return this.buffer.subarray(D,B)},lookChar:function(){for(var B=this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var B=this.pos;this.bufferLength<=B;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},
makeSubStream:function(B,D,q){for(var c=B+D;this.bufferLength<=c&&!this.eof;)this.readBlock();return new Stream(this.buffer,B,D,q)},skip:function(B){B||=1;this.pos+=B},reset:function(){this.pos=0}};return Q}();return function(){function Q(h){throw Error(h);}function B(h){var m=0,w=h[m++],k=h[m++];-1!=w&&-1!=k||Q("Invalid header in flate stream");8!=(w&15)&&Q("Unknown compression method in flate stream");0!=((w<<8)+k)%31&&Q("Bad FCHECK in flate stream");k&32&&Q("FDICT bit set in flate stream");this.bytes=
h;this.bytesPos=m;this.codeBuf=this.codeSize=0;M.call(this)}if(!self||!self.Uint32Array)return null;var D=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),q=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),c=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,
591361,657409,658433,724993,727041,794625,798721,868353,876545]),e=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,
524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,
459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,
524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,
459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,
524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,
459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,
524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],n=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];B.prototype=Object.create(M.prototype);B.prototype.getBits=function(h){for(var m=this.codeSize,w=this.codeBuf,k=this.bytes,
r=this.bytesPos,a;m<h;)"undefined"==typeof(a=k[r++])&&Q("Bad encoding in flate stream"),w|=a<<m,m+=8;this.codeBuf=w>>h;this.codeSize=m-=h;this.bytesPos=r;return w&(1<<h)-1};B.prototype.getCode=function(h){var m=h[0],w=h[1];h=this.codeSize;for(var k=this.codeBuf,r=this.bytes,a=this.bytesPos;h<w;){var f;"undefined"==typeof(f=r[a++])&&Q("Bad encoding in flate stream");k|=f<<h;h+=8}w=m[k&(1<<w)-1];m=w>>16;w&=65535;(0==h||h<m||0==m)&&Q("Bad encoding in flate stream");this.codeBuf=k>>m;this.codeSize=h-
m;this.bytesPos=a;return w};B.prototype.generateHuffmanTable=function(h){for(var m=h.length,w=0,k=0;k<m;++k)h[k]>w&&(w=h[k]);for(var r=1<<w,a=new Uint32Array(r),f=1,l=0,d=2;f<=w;++f,l<<=1,d<<=1)for(var b=0;b<m;++b)if(h[b]==f){var g=0,z=l;for(k=0;k<f;++k)g=g<<1|z&1,z>>=1;for(k=g;k<r;k+=d)a[k]=f<<16|b;++l}return[a,w]};B.prototype.readBlock=function(){function h(g,z,v,C,y){for(g=g.getBits(v)+C;0<g--;)z[l++]=y}var m=this.getBits(3);m&1&&(this.eof=!0);m>>=1;if(0==m){var w=this.bytes,k=this.bytesPos,r;
"undefined"==typeof(r=w[k++])&&Q("Bad block header in flate stream");var a=r;"undefined"==typeof(r=w[k++])&&Q("Bad block header in flate stream");a|=r<<8;"undefined"==typeof(r=w[k++])&&Q("Bad block header in flate stream");m=r;"undefined"==typeof(r=w[k++])&&Q("Bad block header in flate stream");(m|r<<8)!=(~a&65535)&&Q("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;r=this.bufferLength;m=this.ensureBuffer(r+a);this.bufferLength=a=r+a;for(var f=r;f<a;++f){if("undefined"==
typeof(r=w[k++])){this.eof=!0;break}m[f]=r}this.bytesPos=k}else{if(1==m)k=e,r=n;else if(2==m){m=this.getBits(5)+257;r=this.getBits(5)+1;w=this.getBits(4)+4;k=Array(D.length);for(var l=0;l<w;)k[D[l++]]=this.getBits(3);k=this.generateHuffmanTable(k);l=w=0;r=m+r;for(a=Array(r);l<r;)f=this.getCode(k),16==f?h(this,a,2,3,w):17==f?h(this,a,3,3,w=0):18==f?h(this,a,7,11,w=0):a[l++]=w=f;k=this.generateHuffmanTable(a.slice(0,m));r=this.generateHuffmanTable(a.slice(m,r))}else Q("Unknown block type in flate stream");
a=(m=this.buffer)?m.length:0;for(f=this.bufferLength;;){var d=this.getCode(k);if(256>d)f+1>=a&&(m=this.ensureBuffer(f+1),a=m.length),m[f++]=d;else{if(256==d){this.bufferLength=f;break}d-=257;d=q[d];var b=d>>16;0<b&&(b=this.getBits(b));w=(d&65535)+b;d=this.getCode(r);d=c[d];b=d>>16;0<b&&(b=this.getBits(b));d=(d&65535)+b;f+w>=a&&(m=this.ensureBuffer(f+w),a=m.length);for(b=0;b<w;++b,++f)m[f]=m[f-d]}}}};return B}()})})(t);return t.exports}();u=u.getDefaultExportFromCjs(F);p.Zlib=u})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],
function(p){p.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};p.getDefaultExportFromCjs=function(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u["default"]:u}})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(p,u){class t{static decode(L,F=!1){const P=new Uint8Array(L);L=new p.JpegImage;
L.parse(P);const {width:M,height:Q,numComponents:B,eof:D}=L,q=L.getData(M,Q,!0),c=M*Q;L=null;let e=0,n=0,h=0;if(!F&&D<P.length-1)try{var m=(new u.Zlib(P.subarray(D))).getBytes();L=new Uint8Array(c);for(e=F=0;e<m.length;e++)for(h=7;0<=h;h--)L[F++]=m[e]>>h&1}catch{}if(1===B&&q.length===M*Q)m=new Uint8Array(q.buffer),m=[m,m,m];else{m=[];for(e=0;3>e;e++)m.push(new Uint8Array(c));for(n=h=0;n<c;n++)for(e=0;3>e;e++)m[e][n]=q[h++]}return{width:M,height:Q,pixels:m,mask:L}}}return t})},"esri/chunks/Jpg":function(){define(["exports",
"./_commonjsHelpers"],function(p,u){var t={exports:{}},L,F=function(){if(L)return t.exports;L=1;(function(P){(function(M){M=M();void 0!==M&&(P.exports=M)})(function(){var M=function(){function Q(B){this.message="JPEG error: "+B}Q.prototype=Error();Q.prototype.name="JpegError";return Q.constructor=Q}();return function(){function Q(){this.decodeTransform=null;this.colorTransform=-1}function B(n,h){for(var m=0,w=[],k,r,a=16;0<a&&!n[a-1];)a--;w.push({children:[],index:0});var f=w[0],l;for(k=0;k<a;k++){for(r=
0;r<n[k];r++){f=w.pop();for(f.children[f.index]=h[m];0<f.index;)f=w.pop();f.index++;for(w.push(f);w.length<=k;)w.push(l={children:[],index:0}),f.children[f.index]=l.children,f=l;m++}k+1<a&&(w.push(l={children:[],index:0}),f.children[f.index]=l.children,f=l)}return w[0].children}function D(n,h,m,w,k,r,a,f,l){function d(){if(0<O)return O--,G>>O&1;G=n[h++];if(255===G){var W=n[h++];if(W)throw new M("unexpected marker "+(G<<8|W).toString(16));}O=7;return G>>>7}function b(W){for(;;){W=W[d()];if("number"===
typeof W)return W;if("object"!==typeof W)throw new M("invalid huffman sequence");}}function g(W){for(var aa=0;0<W;)aa=aa<<1|d(),W--;return aa}function z(W){if(1===W)return 1===d()?1:-1;var aa=g(W);return aa>=1<<W-1?aa:aa+(-1<<W)+1}function v(W,aa){var da=b(W.huffmanTableDC);da=0===da?0:z(da);W.blockData[aa]=W.pred+=da;for(da=1;64>da;){var ea=b(W.huffmanTableAC),ha=ea&15;ea>>=4;if(0===ha){if(15>ea)break;da+=16}else da+=ea,W.blockData[aa+e[da]]=z(ha),da++}}function C(W,aa){var da=b(W.huffmanTableDC);
da=0===da?0:z(da)<<l;W.blockData[aa]=W.pred+=da}function y(W,aa){W.blockData[aa]|=d()<<l}function A(W,aa){if(0<H)H--;else for(var da=r;da<=a;){var ea=b(W.huffmanTableAC),ha=ea&15;ea>>=4;if(0===ha){if(15>ea){H=g(ea)+(1<<ea)-1;break}da+=16}else da+=ea,W.blockData[aa+e[da]]=z(ha)*(1<<l),da++}}function x(W,aa){for(var da=r,ea=0,ha;da<=a;){ha=e[da];switch(J){case 0:ea=b(W.huffmanTableAC);ha=ea&15;ea>>=4;if(0===ha)15>ea?(H=g(ea)+(1<<ea),J=4):(ea=16,J=1);else{if(1!==ha)throw new M("invalid ACn encoding");
R=z(ha);J=ea?2:3}continue;case 1:case 2:W.blockData[aa+ha]?W.blockData[aa+ha]+=d()<<l:(ea--,0===ea&&(J=2===J?3:0));break;case 3:W.blockData[aa+ha]?W.blockData[aa+ha]+=d()<<l:(W.blockData[aa+ha]=R<<l,J=0);break;case 4:W.blockData[aa+ha]&&(W.blockData[aa+ha]+=d()<<l)}da++}4===J&&(H--,0===H&&(J=0))}var E=m.mcusPerLine,N=h,G=0,O=0,H=0,J=0,R,Y=w.length,T,X,V,K;f=m.progressive?0===r?0===f?C:y:0===f?A:x:v;var S=0;m=1===Y?w[0].blocksPerLine*w[0].blocksPerColumn:E*m.mcusPerColumn;for(var Z,ca;S<m;){var I=
k?Math.min(m-S,k):m;for(T=0;T<Y;T++)w[T].pred=0;H=0;if(1===Y){var U=w[0];for(K=0;K<I;K++)f(U,64*((U.blocksPerLine+1)*(S/U.blocksPerLine|0)+S%U.blocksPerLine)),S++}else for(K=0;K<I;K++){for(T=0;T<Y;T++)for(U=w[T],Z=U.h,ca=U.v,X=0;X<ca;X++)for(V=0;V<Z;V++)f(U,64*((U.blocksPerLine+1)*((S/E|0)*U.v+X)+(S%E*U.h+V)));S++}O=0;(U=c(n,h))&&U.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+U.invalid),h=U.offset);U=U&&U.marker;if(!U||65280>=U)throw new M("marker was not found");if(65488<=
U&&65495>=U)h+=2;else break}(U=c(n,h))&&U.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+U.invalid),h=U.offset);return h-N}function q(n,h){n=h.blocksPerLine;for(var m=h.blocksPerColumn,w=new Int16Array(64),k=0;k<m;k++)for(var r=0;r<n;r++){var a=void 0,f=void 0,l=void 0,d=void 0,b=void 0,g=void 0,z=void 0,v=void 0,C=b=g=d=f=a=void 0,y=void 0,A=void 0,x=void 0,E=64*((h.blocksPerLine+1)*k+r),N=w,G=h.quantizationTable,O=h.blockData;if(!G)throw new M("missing required Quantization Table.");
for(var H=0;64>H;H+=8)a=O[E+H],v=O[E+H+1],z=O[E+H+2],g=O[E+H+3],b=O[E+H+4],d=O[E+H+5],l=O[E+H+6],f=O[E+H+7],a*=G[H],0===(v|z|g|b|d|l|f)?(a=5793*a+512>>10,N[H]=a,N[H+1]=a,N[H+2]=a,N[H+3]=a,N[H+4]=a,N[H+5]=a,N[H+6]=a,N[H+7]=a):(v*=G[H+1],z*=G[H+2],g*=G[H+3],b*=G[H+4],d*=G[H+5],l*=G[H+6],f*=G[H+7],x=5793*a+128>>8,A=5793*b+128>>8,y=z,C=l,b=2896*(v-f)+128>>8,f=2896*(v+f)+128>>8,g<<=4,d<<=4,x=x+A+1>>1,A=x-A,a=3784*y+1567*C+128>>8,y=1567*y-3784*C+128>>8,C=a,b=b+d+1>>1,d=b-d,f=f+g+1>>1,g=f-g,x=x+C+1>>1,C=
x-C,A=A+y+1>>1,y=A-y,a=2276*b+3406*f+2048>>12,b=3406*b-2276*f+2048>>12,f=a,a=799*g+4017*d+2048>>12,g=4017*g-799*d+2048>>12,d=a,N[H]=x+f,N[H+7]=x-f,N[H+1]=A+d,N[H+6]=A-d,N[H+2]=y+g,N[H+5]=y-g,N[H+3]=C+b,N[H+4]=C-b);for(G=0;8>G;++G)a=N[G],v=N[G+8],z=N[G+16],g=N[G+24],b=N[G+32],d=N[G+40],l=N[G+48],f=N[G+56],0===(v|z|g|b|d|l|f)?(a=5793*a+8192>>14,a=-2040>a?0:2024<=a?255:a+2056>>4,O[E+G]=a,O[E+G+8]=a,O[E+G+16]=a,O[E+G+24]=a,O[E+G+32]=a,O[E+G+40]=a,O[E+G+48]=a,O[E+G+56]=a):(x=5793*a+2048>>12,A=5793*b+2048>>
12,y=z,C=l,b=2896*(v-f)+2048>>12,f=2896*(v+f)+2048>>12,x=(x+A+1>>1)+4112,A=x-A,a=3784*y+1567*C+2048>>12,y=1567*y-3784*C+2048>>12,C=a,b=b+d+1>>1,d=b-d,f=f+g+1>>1,g=f-g,x=x+C+1>>1,C=x-C,A=A+y+1>>1,y=A-y,a=2276*b+3406*f+2048>>12,b=3406*b-2276*f+2048>>12,f=a,a=799*g+4017*d+2048>>12,g=4017*g-799*d+2048>>12,d=a,a=x+f,f=x-f,v=A+d,l=A-d,z=y+g,d=y-g,g=C+b,b=C-b,a=16>a?0:4080<=a?255:a>>4,v=16>v?0:4080<=v?255:v>>4,z=16>z?0:4080<=z?255:z>>4,g=16>g?0:4080<=g?255:g>>4,b=16>b?0:4080<=b?255:b>>4,d=16>d?0:4080<=d?
255:d>>4,l=16>l?0:4080<=l?255:l>>4,f=16>f?0:4080<=f?255:f>>4,O[E+G]=a,O[E+G+8]=v,O[E+G+16]=z,O[E+G+24]=g,O[E+G+32]=b,O[E+G+40]=d,O[E+G+48]=l,O[E+G+56]=f)}return h.blockData}function c(n,h,m){var w=n.length-1;m=m<h?m:h;if(h>=w)return null;var k=n[h]<<8|n[h+1];if(65472<=k&&65534>=k)return{invalid:null,marker:k,offset:h};for(h=n[m]<<8|n[m+1];!(65472<=h&&65534>=h);){if(++m>=w)return null;h=n[m]<<8|n[m+1]}return{invalid:k.toString(16),marker:h,offset:m}}if(!self||!self.Uint8ClampedArray)return null;var e=
new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);Q.prototype={parse:function(n){function h(){var G=n[k]<<8|n[k+1];k+=2;return G}function m(){var G=h();G=k+G-2;var O=c(n,G,k);O&&O.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+O.invalid),G=O.offset);G=n.subarray(k,G);k+=G.length;return G}function w(G){for(var O=Math.ceil(G.samplesPerLine/
8/G.maxH),H=Math.ceil(G.scanLines/8/G.maxV),J=0;J<G.components.length;J++){N=G.components[J];var R=Math.ceil(Math.ceil(G.samplesPerLine/8)*N.h/G.maxH),Y=Math.ceil(Math.ceil(G.scanLines/8)*N.v/G.maxV);N.blockData=new Int16Array(64*H*N.v*(O*N.h+1));N.blocksPerLine=R;N.blocksPerColumn=Y}G.mcusPerLine=O;G.mcusPerColumn=H}var k=0,r=null,a=null,f=[],l=[],d=[],b=h();if(65496!==b)throw new M("SOI not found");for(b=h();65497!==b;){switch(b){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var g=
m();65504===b&&74===g[0]&&70===g[1]&&73===g[2]&&70===g[3]&&0===g[4]&&(r={version:{major:g[5],minor:g[6]},densityUnits:g[7],xDensity:g[8]<<8|g[9],yDensity:g[10]<<8|g[11],thumbWidth:g[12],thumbHeight:g[13],thumbData:g.subarray(14,14+3*g[12]*g[13])});65518===b&&65===g[0]&&100===g[1]&&111===g[2]&&98===g[3]&&101===g[4]&&(a={version:g[5]<<8|g[6],flags0:g[7]<<8|g[8],flags1:g[9]<<8|g[10],transformCode:g[11]});break;case 65499:b=h()+k-2;for(var z;k<b;){var v=n[k++],C=new Uint16Array(64);if(0===v>>4)for(g=
0;64>g;g++)z=e[g],C[z]=n[k++];else if(1===v>>4)for(g=0;64>g;g++)z=e[g],C[z]=h();else throw new M("DQT - invalid table spec");f[v&15]=C}break;case 65472:case 65473:case 65474:if(y)throw new M("Only single frame JPEGs supported");h();var y={};y.extended=65473===b;y.progressive=65474===b;y.precision=n[k++];y.scanLines=h();y.samplesPerLine=h();y.components=[];y.componentIds={};g=n[k++];for(b=C=v=0;b<g;b++){z=n[k];var A=n[k+1]>>4;var x=n[k+1]&15;v<A&&(v=A);C<x&&(C=x);A=y.components.push({h:A,v:x,quantizationId:n[k+
2],quantizationTable:null});y.componentIds[z]=A-1;k+=3}y.maxH=v;y.maxV=C;w(y);break;case 65476:z=h();for(b=2;b<z;){v=n[k++];C=new Uint8Array(16);for(g=A=0;16>g;g++,k++)A+=C[g]=n[k];x=new Uint8Array(A);for(g=0;g<A;g++,k++)x[g]=n[k];b+=17+A;(0===v>>4?d:l)[v&15]=B(C,x)}break;case 65501:h();var E=h();break;case 65498:h();z=n[k++];g=[];for(b=0;b<z;b++){v=y.componentIds[n[k++]];var N=y.components[v];v=n[k++];N.huffmanTableDC=d[v>>4];N.huffmanTableAC=l[v&15];g.push(N)}b=n[k++];z=n[k++];v=n[k++];b=D(n,k,
y,g,E,b,z,v>>4,v&15);k+=b;break;case 65535:255!==n[k]&&k--;break;default:if(255===n[k-3]&&192<=n[k-2]&&254>=n[k-2])k-=3;else throw new M("unknown marker "+b.toString(16));}b=h()}this.width=y.samplesPerLine;this.height=y.scanLines;this.jfif=r;this.eof=k;this.adobe=a;this.components=[];for(b=0;b<y.components.length;b++){N=y.components[b];if(r=f[N.quantizationId])N.quantizationTable=r;this.components.push({output:q(y,N),scaleX:N.h/y.maxH,scaleY:N.v/y.maxV,blocksPerLine:N.blocksPerLine,blocksPerColumn:N.blocksPerColumn})}this.numComponents=
this.components.length},_getLinearizedBlockData:function(n,h){var m=this.width/n,w=this.height/h,k,r,a=0,f=this.components.length,l=n*h*f,d=new Uint8ClampedArray(l),b=new Uint32Array(n);for(r=0;r<f;r++){var g=this.components[r];var z=g.scaleX*m;var v=g.scaleY*w;a=r;var C=g.output;var y=g.blocksPerLine+1<<3;for(k=0;k<n;k++)g=0|k*z,b[k]=(g&4294967288)<<3|g&7;for(z=0;z<h;z++)for(g=0|z*v,g=y*(g&4294967288)|(g&7)<<3,k=0;k<n;k++)d[a]=C[g+b[k]],a+=f}if(h=this.decodeTransform)for(r=0;r<l;)for(n=g=0;g<f;g++,
r++,n+=2)d[r]=(d[r]*h[n]>>8)+h[n+1];return d},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(n){for(var h,m,w,k=0,r=n.length;k<r;k+=3)h=n[k],m=n[k+1],w=n[k+2],n[k]=h-179.456+1.402*w,n[k+1]=h+135.459-.344*m-.714*w,n[k+2]=h-226.816+1.772*m;return n},_convertYcckToRgb:function(n){for(var h,m,w,k,r=0,a=0,f=n.length;a<f;a+=4)h=n[a],m=n[a+1],w=n[a+2],k=n[a+3],n[r++]=
-122.67195406894+m*(-6.60635669420364E-5*m+4.37130475926232E-4*w-5.4080610064599E-5*h+4.8449797120281E-4*k-.154362151871126)+w*(-9.57964378445773E-4*w+8.17076911346625E-4*h-.00477271405408747*k+1.53380253221734)+h*(9.61250184130688E-4*h-.00266257332283933*k+.48357088451265)+k*(-3.36197177618394E-4*k+.484791561490776),n[r++]=107.268039397724+m*(2.19927104525741E-5*m-6.40992018297945E-4*w+6.59397001245577E-4*h+4.26105652938837E-4*k-.176491792462875)+w*(-7.78269941513683E-4*w+.00130872261408275*h+7.70482631801132E-4*
k-.151051492775562)+h*(.00126935368114843*h-.00265090189010898*k+.25802910206845)+k*(-3.18913117588328E-4*k-.213742400323665),n[r++]=-20.810012546947+m*(-5.70115196973677E-4*m-2.63409051004589E-5*w+.0020741088115012*h-.00288260236853442*k+.814272968359295)+w*(-1.53496057440975E-5*w-1.32689043961446E-4*h+5.60833691242812E-4*k-.195152027534049)+h*(.00174418132927582*h-.00255243321439347*k+.116935020465145)+k*(-3.43531996510555E-4*k+.24165260232407);return n},_convertYcckToCmyk:function(n){for(var h,
m,w,k=0,r=n.length;k<r;k+=4)h=n[k],m=n[k+1],w=n[k+2],n[k]=434.456-h-1.402*w,n[k+1]=119.541-h+.344*m+.714*w,n[k+2]=481.816-h-1.772*m;return n},_convertCmykToRgb:function(n){for(var h,m,w,k,r=0,a=1/255,f=0,l=n.length;f<l;f+=4)h=n[f]*a,m=n[f+1]*a,w=n[f+2]*a,k=n[f+3]*a,n[r++]=255+h*(-4.387332384609988*h+54.48615194189176*m+18.82290502165302*w+212.25662451639585*k-285.2331026137004)+m*(1.7149763477362134*m-5.6096736904047315*w-17.873870861415444*k-5.497006427196366)+w*(-2.5217340131683033*w-21.248923337353073*
k+17.5119270841813)-k*(21.86122147463605*k+189.48180835922747),n[r++]=255+h*(8.841041422036149*h+60.118027045597366*m+6.871425592049007*w+31.159100130055922*k-79.2970844816548)+m*(-15.310361306967817*m+17.575251261109482*w+131.35250912493976*k-190.9453302588951)+w*(4.444339102852739*w+9.8632861493405*k-24.86741582555878)-k*(20.737325471181034*k+187.80453709719578),n[r++]=255+h*(.8842522430003296*h+8.078677503112928*m+30.89978309703729*w-.23883238689178934*k-14.183576799673286)+m*(10.49593273432072*
m+63.02378494754052*w+50.606957656360734*k-112.23884253719248)+w*(.03296041114873217*w+115.60384449646641*k-193.58209356861505)-k*(22.33816807309886*k+180.12613974708367);return n},getData:function(n,h,m){if(4<this.numComponents)throw new M("Unsupported color mode");n=this._getLinearizedBlockData(n,h);if(1===this.numComponents&&m){m=n.length;h=new Uint8ClampedArray(3*m);for(var w=0,k=0;k<m;k++){var r=n[k];h[w++]=r;h[w++]=r;h[w++]=r}return h}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(n);
if(4===this.numComponents){if(this._isColorConversionNeeded())return m?this._convertYcckToRgb(n):this._convertYcckToCmyk(n);if(m)return this._convertCmykToRgb(n)}return n}};return Q}()})})(t);return t.exports}();u=u.getDefaultExportFromCjs(F);p.JpegImage=u})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(p,u,t){function L(B,D,q){q.set(B.slice(D,D+q.length))}function F(B){const {_malloc:D,_free:q,_lerc_getBlobInfo:c,_lerc_getDataRanges:e,
_lerc_decode_4D:n,asm:h}=B;let m;const w=Object.values(h).find(r=>r&&"buffer"in r&&r.buffer===B.HEAPU8.buffer),k=r=>{r=r.map(l=>(l>>3<<3)+16);var a=r.reduce((l,d)=>l+d),f=D(a);m=new Uint8Array(w.buffer);a=r[0];r[0]=f;for(f=1;f<r.length;f++){const l=r[f];r[f]=r[f-1]+a;a=l}return r};Q.getBlobInfo=r=>{var a=new Uint8Array(48),f=new Uint8Array(24);const [l,d,b]=k([r.length,a.length,f.length]);m.set(r,l);m.set(a,d);m.set(f,b);var g=c(l,r.length,d,b,12,3);if(g)throw q(l),Error(`lerc-getBlobInfo: error code is ${g}`);
m=new Uint8Array(w.buffer);L(m,d,a);L(m,b,f);a=new Uint32Array(a.buffer);var z=new Float64Array(f.buffer);const [v,C,,y,A,x,E,N,G,O,H]=a;f={version:v,depthCount:O,width:y,height:A,validPixelCount:E,bandCount:x,blobSize:N,maskCount:G,dataType:C,minValue:z[0],maxValue:z[1],maxZerror:z[2],statistics:[],bandCountWithNoData:H};if(H&&1<O)return q(l),f;if(1===O&&1===x)return q(l),f.statistics.push({minValue:z[0],maxValue:z[1]}),f;g=O*x*8;var J=new Uint8Array(g),R=new Uint8Array(g);a=l;var Y=z=0;let T=!1;
m.byteLength<l+2*g?(q(l),T=!0,[a,z,Y]=k([r.length,g,g]),m.set(r,a)):[z,Y]=k([g,g]);m.set(J,z);m.set(R,Y);if(g=e(a,r.length,O,x,z,Y))throw q(a),T||q(z),Error(`lerc-getDataRanges: error code is ${g}`);m=new Uint8Array(w.buffer);L(m,z,J);L(m,Y,R);r=new Float64Array(J.buffer);g=new Float64Array(R.buffer);R=f.statistics;for(J=0;J<x;J++)if(1<O){Y=r.slice(J*O,(J+1)*O);const X=g.slice(J*O,(J+1)*O),V=Math.min.apply(null,Y),K=Math.max.apply(null,X);R.push({minValue:V,maxValue:K,depthStats:{minValues:Y,maxValues:X}})}else R.push({minValue:r[J],
maxValue:g[J]});q(a);T||q(z);return f};Q.decode=(r,a)=>{const {maskCount:f,depthCount:l,bandCount:d,width:b,height:g,dataType:z,bandCountWithNoData:v}=a;var C=P[z],y=b*g;a=new Uint8Array(y*d);C=new Uint8Array(y*l*d*C.size);y=new Uint8Array(d);var A=new Uint8Array(8*d);const [x,E,N,G,O]=k([r.length,a.length,C.length,y.length,A.length]);m.set(r,x);m.set(a,E);m.set(C,N);m.set(y,G);m.set(A,O);if(r=n(x,r.length,f,E,l,b,g,d,z,N,G,O))throw q(x),Error(`lerc-decode: error code is ${r}`);m=new Uint8Array(w.buffer);
L(m,N,C);L(m,E,a);r=null;if(v){L(m,G,y);L(m,O,A);r=[];A=new Float64Array(A.buffer);for(let H=0;H<y.length;H++)r.push(y[H]?A[H]:null)}q(x);return{data:C,maskData:a,noDataValues:r}}}const P=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let M=null;const Q={getBlobInfo:null,decode:null};u.decode=function(B,D={}){var q=D.inputOffset??0;B=B instanceof Uint8Array?B.subarray(q):new Uint8Array(B,q);q=Q.getBlobInfo(B);const {data:c,maskData:e,noDataValues:n}=Q.decode(B,q),{width:h,height:m,bandCount:w,
depthCount:k,dataType:r,maskCount:a,statistics:f}=q;var l=P[r],d=new l.ctor(c.buffer);B=[];q=[];const b=h*m;var g=b*k;for(var z=0;z<w;z++){var v=d.subarray(z*g,(z+1)*g);if(D.returnInterleaved)B.push(v);else{a:{var C=b,y=k;if(2>y)break a;const A=new l.ctor(C*y);for(let x=0,E=0;x<C;x++)for(let N=0,G=x;N<y;N++,G+=C)A[G]=v[E++];v=A}B.push(v)}q.push(e.subarray(z*g,(z+1)*g))}d=0===a?null:1===a?q[0]:new Uint8Array(b);if(1<a)for(d.set(q[0]),g=1;g<q.length;g++)for(z=q[g],v=0;v<b;v++)d[v]&=z[v];({noDataValue:D}=
D);g=null!=D&&l.range[0]<=D&&l.range[1]>=D;if(0<a&&g)for(g=0;g<w;g++)for(z=B[g],v=q[g]||d,C=0;C<b;C++)0===v[C]&&(z[C]=D);({pixelType:l}=l);return{width:h,height:m,bandCount:w,pixelType:l,depthCount:k,statistics:f,pixels:B,mask:d,bandMasks:a===w&&1<w?q:null,noDataValues:n}};u.getBlobInfo=function(B,D={}){B=B instanceof Uint8Array?B.subarray(D.inputOffset??0):new Uint8Array(B,D.inputOffset??0);return Q.getBlobInfo(B)};u.load=function(){return M?M:M=(new Promise((B,D)=>p(["../../../chunks/lerc-wasm"],
B,D))).then(B=>B.lercWasm).then(({default:B})=>B({locateFile:D=>t.getAssetUrl(`esri/layers/support/rasterFormats/${D}`)})).then(B=>{F(B)})};u.pixelTypeInfoMap=P;Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(p){function u(P,M,Q,B=!0){if(0!==M%4||0!==Q%4){var D=new ArrayBuffer(4*Math.ceil(Q/4));D=new Uint8Array(D);P=new Uint8Array(P,M,Q);if(B)for(B=0;B<D.length;B+=4)D[B]=P[B+3],D[B+1]=P[B+2],D[B+2]=P[B+
1],D[B+3]=P[B];else D.set(P);return new Uint32Array(D.buffer)}if(B){B=new Uint8Array(P,M,Q);D=new Uint8Array(B.length);for(P=0;P<D.length;P+=4)D[P]=B[P+3],D[P+1]=B[P+2],D[P+2]=B[P+1],D[P+3]=B[P];return new Uint32Array(D.buffer)}return new Uint32Array(P,M,Q/4)}function t(){const P=[];for(let M=0;257>=M;M++)P[M]=[M];return P}function L(P,M){for(let Q=0;Q<M.length;Q++)P.push(M[Q])}const F=new Set;F.add(511);F.add(1023);F.add(2047);F.add(4095);F.add(8191);p.decode=function(P,M,Q,B=!0){P=u(P,M,Q,B);M=
9;B=t();let D=32,q=B.length,c=[],e=1,n=P[0],h=0;const m=P.length;Q=8*(4*m-Q);const w=[];for(;null!=n;){if(D>=M)D-=M,h=n>>>32-M,n<<=M;else{h=n>>>32-D;n=P[e++];var k=M-D;D=32-k;h=(h<<k)+(n>>>D);n<<=k}if(257===h)break;if(256===h)M=9,B=t(),q=B.length,c=[];else{k=B[h];if(null==k){if(h>B.length)throw Error("data integrity issue: code does not exist on code page");c.push(c[0]);B[q++]=c.slice();L(w,c)}else L(w,k),c.push(k[0]),1<c.length&&(B[q++]=c.slice()),c=k.slice();F.has(q)&&M++;0===D&&(n=P[e++],D=32);
if(e>m||e===m&&D<=Q)break}}return new Uint8Array(w)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const p=t=>{let L=1;switch(t){case Uint8Array:case Int8Array:L=1;break;case Uint16Array:case Int16Array:L=2;break;case Uint32Array:case Int32Array:case Float32Array:L=4;break;case Float64Array:L=8}return L};class u{static decode(t,L){var F=L.pixelType;const P=[],M=L.width*L.height;var Q=Math.floor(t.byteLength/(L.width*
L.height*p(L.pixelType)));const {bandIds:B,format:D}=L;L=B?.length||Math.floor(t.byteLength/(L.width*L.height*p(L.pixelType)));var q=t.byteLength-t.byteLength%(M*p(F)),c=new F(t,0,M*Q);let e,n,h,m,w=null;if("bip"===D)for(e=0;e<L;e++){h=new F(M);m=B?B[e]:e;for(n=0;n<M;n++)h[n]=c[n*Q+m];P.push(h)}else if("bsq"===D)for(e=0;e<L;e++)m=B?B[e]:e,P.push(c.subarray(m*M,(m+1)*M));if(q<t.byteLength-1)if(t=t.slice(q),8*t.byteLength<M)w=null;else{t=new Uint8Array(t,0,Math.ceil(M/8));F=new Uint8Array(M);for(q=
c=q=L=Q=0;q<t.length-1;q++)for(L=t[q],c=7;0<=c;c--)F[Q++]=L>>c&1;for(c=7;Q<M-1;)L=t[t.length-1],F[Q++]=L>>c&1,c--;w=F}return{pixels:P,mask:w}}}return u})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../core/has ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(p,u,t,L,F,P,M,Q,B,D){function q(H,J){let R="unknown";3===H?R=64===J?"f64":"f32":1===H?1===J?R="u1":2===J?R=
"u2":4===J?R="u4":8>=J?R="u8":16>=J?R="u16":32>=J&&(R="u32"):2===H&&(8>=J?R="s8":16>=J?R="s16":32>=J&&(R="s32"));return R}function c(H){let J=null;switch(H?H.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":J=Uint8Array;break;case "u16":J=Uint16Array;break;case "u32":J=Uint32Array;break;case "s8":J=Int8Array;break;case "s16":J=Int16Array;break;case "s32":J=Int32Array;break;case "f64":J=Float64Array;break;default:J=Float32Array}return J}function e(H,J){return{x:J[0]*H.x+J[1]*H.y+J[2],y:J[3]*
H.x+J[4]*H.y+J[5]}}function n(H,J){return H.get(J)?.values?.[0]}function h(H,J,R,Y=0,T=Q.tiffTags,X=4){var V=8===X;const K=V?v(new DataView(H,R,8),0,J):(new DataView(H,R,2)).getUint16(0,J),S=4+2*X;var Z=V?8:2;V=Z+K*S;if(R+V>H.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:V};const ca=R+V+4<=H.byteLength?C(new DataView(H,R+V,8===X?8:4),0,J,8===X):null;R+=Z;Z=new Map;let I,U,W,aa=0,da=0;for(let ha=0;ha<K;ha++){var ea=new DataView(H,R+S*ha,S);I=ea.getUint16(0,J);W=ea.getUint16(2,
J);U=Q.getTagName(I,T);const ia=[];2===X?(aa=ea.getUint16(4,J),da=ea.getUint16(6,J)):4===X?(aa=ea.getUint32(4,J),da=ea.getUint32(8,J)):8===X&&(aa=C(ea,4,J,!0),da=C(ea,12,J,!0),ia.push(ea.getUint32(12,J)),ia.push(ea.getUint32(16,J)));ea={id:I,type:W,valueCount:aa,valueOffset:da,valueOffsets:ia,values:null};f(H,J,ea,Y,!1,X);Z.set(U,ea)}return{success:!0,ifd:Z,nextIFD:ca,requiredBufferSize:V}}function m(H,J){if(1!==J&&2!==J&&4!==J)return H;const R=new Uint8Array(H),Y=8/J;H=new Uint8Array(H.byteLength*
Y);let T=0;const X=2**J-1;for(let V=0;V<R.length;V++){const K=R[V];for(let S=0;S<Y;S++)H[T++]=K<<J*S>>>8-J&X}return H.buffer}function w(H,J,R){const Y=new L.JpegImage;Y.parse(H);Y.colorTransform=6===R?-1:0;H=Y.getData(Y.width,Y.height,1!==J&&4!==J);return new Uint8Array(H.buffer)}function k(H){H=(new D.Zlib(H)).getBytes();var J=new ArrayBuffer(H.length);J=new Uint8Array(J);J.set(H);return J}async function r(H,J,R,Y,T){var X=B.isPlatformLittleEndian===J,V=n(R,"BITSPERSAMPLE"),K=n(R,"SAMPLESPERPIXEL")??
1,S=n(R,"PHOTOMETRICINTERPRETATION"),Z=n(R,"SAMPLEFORMAT")??1,ca=q(Z,V),I=n(R,"COMPRESSION")??1,U=c(ca);if(34887===I)return await F.load(),F.decode(H,{inputOffset:Y}).pixels[0];if(1===I)S=H.slice(Y,Y+T),J=new Uint8Array(S);else if(8===I||32946===I)J=new Uint8Array(H,Y,T),J=k(J),S=J.buffer;else if(6===I)J=new Uint8Array(H,Y,T),J=w(J,K,S),S=J.buffer;else if(7===I){const W=R.get("JPEGTABLES").values,aa=W.length-2;J=new Uint8Array(aa+T-2);for(let da=0;da<aa;da++)J[da]=W[da];H=new Uint8Array(H,Y+2,T-2);
for(Y=0;Y<H.length;Y++)J[aa+Y]=H[Y];J=w(J,K,S);S=J.buffer}else if(5===I)J=P.decode(H,Y,T,J),S=J.buffer;else throw Error("tiff-decode: unsupport compression "+I);S=m(S,V);if("u8"!==ca&&"s8"!==ca&&!X)switch(S=new ArrayBuffer(J.length),X=new Uint8Array(S),ca){case "u16":case "s16":for(ca=0;ca<J.length;ca+=2)X[ca]=J[ca+1],X[ca+1]=J[ca];break;case "u32":case "s32":case "f32":for(ca=0;ca<J.length;ca+=4)X[ca]=J[ca+3],X[ca+1]=J[ca+2],X[ca+2]=J[ca+1],X[ca+3]=J[ca]}V=new U(S);X=n(R,"PREDICTOR")??1;ca=n(R,"TILEWIDTH");
J=n(R,"TILELENGTH");if(1<X&&(5===I||8===I||32946===I)&&ca&&J){I=d(R);U=new U(V.length);U.set(V);R=3===Z&&3===X;I=I?1:K;K=R?4:1;Z=ca*K*I;R&&(U=new Uint8Array(U.buffer));for(X=0;X<J;X++)for(V=X*Z,S=I;S<Z;S++)U[V+S]+=U[V+S-I];if(R){R=new Uint8Array(U.length);I*=ca;for(ca=0;ca<J;ca++)for(X=ca*Z,V=0;V<I;V++)for(S=0;S<K;S++)R[X+V*K+S]=U[X+V+(K-S-1)*I];V=new Float32Array(R.buffer)}else V=U}return V}async function a(H,J,R){const Y=R.get("TILEOFFSETS")?.values;if(void 0===Y)return null;const T=R.get("TILEBYTECOUNTS")?.values,
{width:X,height:V,pixelType:K,tileWidth:S,tileHeight:Z}=l([R]);var ca=d(R,J);const I=n(R,"SAMPLESPERPIXEL")||J.planes;var U=X*V,W=n(R,"BITSPERSAMPLE"),aa=34887===(n(R,"COMPRESSION")??1),da=c(K);const ea=[];for(var ha=0;ha<I;ha++)ea.push(new da(U));let ia,ka,ma,pa,oa,sa,qa,va,ta;da=Math.ceil(X/S);U=(new Uint8Array(U)).fill(255);ha=!1;if(0===W%8)if(aa&&ca&&1<I)for(ca=Math.round(Y.length/I),W=0;W<ca;W++){var wa=Math.floor(W/da)*Z;ma=W%da*S;pa=wa*X+ma;for(aa=0;aa<I;aa++){var ba=W*I+aa;0===T[ba]?(ba=null,
ha=!0):ba=await r(H,J.littleEndian,R,Y[ba],T[ba]);sa=0;oa=pa;va=Math.min(S,X-ma);qa=Math.min(Z,V-wa);ta=ea[aa];for(ia=0;ia<qa;ia++)for(oa=pa+ia*X,sa=ia*S,ka=0;ka<va;ka++,oa++,sa++)ba?ta[oa]=ba[sa]:U[oa]=0}}else for(W=0;W<Y.length;W++)for(wa=Math.floor(W/da)*Z,ma=W%da*S,pa=wa*X+ma,0===T[W]?(ba=null,ha=!0):ba=await r(H,J.littleEndian,R,Y[W],T[W]),sa=0,oa=pa,va=Math.min(S,X-ma),qa=Math.min(Z,V-wa),wa=0;wa<I;wa++)if(ta=ea[wa],ca||aa)for(ia=0;ia<qa;ia++)for(oa=pa+ia*X,sa=S*Z*wa+ia*S,ka=0;ka<va;ka++,oa++,
sa++)ba?ta[oa]=ba[sa]:U[oa]=0;else for(ia=0;ia<qa;ia++)for(oa=pa+ia*X,sa=ia*S*I+wa,ka=0;ka<va;ka++,oa++,sa+=I)ba?ta[oa]=ba[sa]:U[oa]=0;return{width:X,height:V,pixelType:K,pixels:ea,mask:ha?U:void 0}}function f(H,J,R,Y=0,T=!1,X=4){if(R.values)return!0;var V=R.type,K=R.valueCount,S=R.valueOffset;let Z=[];var ca=E[V],I=8*ca,U=K*ca,W=K*E[V]*8,aa=8===X?64:32;X=R.valueOffsets;if(W>aa&&U>(T?H.byteLength:H?H.byteLength-S+Y:0))return R.offlineOffsetSize=[S,U],R.values=null,!1;if(W<=aa)if(J||(32>=aa?S>>>=32-
W:(H=X?.length?X[0]:S>>>0,J=X?.length?X[1]:Math.round((S-H)/4294967296),32>=W?(S=H>>>32-W,X[0]=S):(S=H*2**(32-W)+(J>>>32-W),X[0]=H,X[1]=J>>>32-W))),1===K&&I===aa)Z=[S];else if(64===aa)for(H=X?.length?X[0]:S>>>0,S=X?.length?X[1]:Math.round((S-H)/4294967296),J=H,ca=32,H=1;H<=K;H++)U=32-I*H%32,ca<I?(U=J<<U>>>32-ca,W=S<<32-ca>>>32-ca,J=S,Z.push(U+W*2**(I-ca)),ca-=32-(I-ca)):(Z.push(J<<U>>>32-I),ca-=I),0===ca&&(ca=32,J=S);else for(H=1;H<=K;H++)Z.push(S<<32-I*H>>>32-I);else for(S-=Y,T&&(S=0),K=S;K<S+U;K+=
ca){switch(V){case 1:I=(new DataView(H,K,1)).getUint8(0);break;case 2:I=(new DataView(H,K,1)).getUint8(0);break;case 3:I=(new DataView(H,K,2)).getUint16(0,J);break;case 4:case 13:I=(new DataView(H,K,4)).getUint32(0,J);break;case 5:I=(new DataView(H,K,4)).getUint32(0,J)/(new DataView(H,K+4,4)).getUint32(0,J);break;case 6:I=(new DataView(H,K,1)).getInt8(0);break;case 7:I=(new DataView(H,K,1)).getUint8(0);break;case 8:I=(new DataView(H,K,2)).getInt16(0,J);break;case 9:I=(new DataView(H,K,4)).getInt32(0,
J);break;case 10:I=(new DataView(H,K,4)).getInt32(0,J)/(new DataView(H,K+4,4)).getInt32(0,J);break;case 11:I=(new DataView(H,K,4)).getFloat32(0,J);break;case 12:I=(new DataView(H,K,8)).getFloat64(0,J);break;case 16:case 18:I=v(new DataView(H,K,8),0,J);break;case 17:X=new DataView(H,K,8);W=(I=J)?X.getInt32(0,I):X.getUint32(0,I);X=I?X.getUint32(4,I):X.getInt32(4,I);aa=0<=(I?W:X)?1:-1;I?W*=aa:X*=aa;I=aa*(I?4294967296*X+W:4294967296*W+X);break;default:I=null}Z.push(I)}if(2===V){V="";S=Z;Z=[];for(H=0;H<
S.length;H++)0===S[H]&&""!==V?(Z.push(V),V=""):V+=String.fromCharCode(S[H]);""===V&&0!==Z.length||Z.push(V)}R.values=Z;return!0}function l(H){var J=H[0];const R=n(J,"TILEWIDTH"),Y=n(J,"TILELENGTH"),T=n(J,"IMAGEWIDTH"),X=n(J,"IMAGELENGTH");var V=n(J,"BITSPERSAMPLE");const K=n(J,"SAMPLESPERPIXEL");var S=n(J,"SAMPLEFORMAT")??1;const Z=q(S,V),ca=d(J);var I=J.get("GDAL_NODATA")?.values;let U=null;I?.length&&(U=I.map(ta=>parseFloat(ta)),U.some(ta=>isNaN(ta))&&(U=null));var W=n(J,"COMPRESSION")??1;switch(W){case 1:I=
"NONE";break;case 2:case 3:case 4:case 32771:I="CCITT";break;case 5:I="LZW";break;case 6:case 7:I="JPEG";break;case 32773:I="PACKBITS";break;case 8:case 32946:I="DEFLATE";break;case 34712:I="JPEG2000";break;case 34887:I="LERC";break;default:I=String(W)}let aa=!0,da="";N.has(W)||(aa=!1,da+="unsupported tag compression "+W);3<S&&(aa=!1,da+="unsupported tag sampleFormat "+S);1!==V&&2!==V&&4!==V&&0!==V%8&&(aa=!1,da+="unsupported tag bitsPerSample "+V);V=J.get("GEOASCIIPARAMS")?.values?.[0];if(V){V=(V=
V.split("|").find(ta=>ta.includes("ESRI PE String \x3d ")))?V.replace("ESRI PE String \x3d ",""):"";var ea=V.startsWith("COMPD_CS")||V.startsWith("PROJCS")||V.startsWith("GEOGCS")?{wkid:null,wkt:V}:null}S=J.get("GEOTIEPOINTS")?.values;V=J.get("GEOPIXELSCALE")?.values;W=J.get("GEOTRANSMATRIX")?.values;var ha=J.has("GEOKEYDIRECTORY")?J.get("GEOKEYDIRECTORY").data:null,ia=!1;J=!1;if(ha){ia=2===n(ha,"GTRasterTypeGeoKey");var ka=n(ha,"GTModelTypeGeoKey");2===ka?(ha=n(ha,"GeographicTypeGeoKey"),1024<=ha&&
32766>=ha&&(ea={wkid:ha}),ea||32767!==ha||(J=!0,ea={wkid:4326})):1===ka&&(ha=n(ha,"ProjectedCSTypeGeoKey"),1024<=ha&&32766>=ha&&(ea={wkid:ha}))}let ma;V&&S&&6<=S.length?(ma=[V[0],0,S[3]-S[0]*V[0],0,-Math.abs(V[1]),S[4]-S[1]*V[1]],ia&&(ma[2]-=.5*ma[0]+.5*ma[1],ma[5]-=.5*ma[3]+.5*ma[4])):W&&16===W.length&&(ma=ia?[W[0],W[1],W[3]-.5*W[0],W[4],W[5],W[7]-.5*W[5]]:[W[0],W[1],W[3],W[4],W[5],W[7]]);if(ma){S=[{x:0,y:X},{x:0,y:0},{x:T,y:X},{x:T,y:0}];ha=ia=Number.POSITIVE_INFINITY;let ta=ka=Number.NEGATIVE_INFINITY;
for(let wa=0;wa<S.length;wa++)W=e(S[wa],ma),ia=W.x>ia?ia:W.x,ka=W.x<ka?ka:W.x,ha=W.y>ha?ha:W.y,ta=W.y<ta?ta:W.y;S={xmin:ia,xmax:ka,ymin:ha,ymax:ta,spatialReference:ea}}else S={xmin:-.5,ymin:.5-X,xmax:T-.5,ymax:.5,spatialReference:ea};J&&(400<S.xmax-S.xmin||361<Math.max(Math.abs(S.xmin),Math.abs(S.xmax)))&&(ea=null,S.spatialReference=null);ea=b(H);let pa;let oa,sa;if(0<ea.length){oa=Math.round(Math.log(T/n(ea[0],"IMAGEWIDTH"))/Math.LN2);var qa=ea[ea.length-1];sa=ea.length;pa=n(qa,"TILEWIDTH");qa=n(qa,
"TILELENGTH")}pa=null!=sa&&0<sa?pa||R:null;qa=null!=sa&&0<sa?qa||Y:null;let va;R&&(va=[{maxCol:Math.ceil(T/R)-1,maxRow:Math.ceil(X/Y)-1,minRow:0,minCol:0}],ea.forEach(ta=>{va.push({maxCol:Math.ceil(n(ta,"IMAGEWIDTH")/n(ta,"TILEWIDTH"))-1,maxRow:Math.ceil(n(ta,"IMAGELENGTH")/n(ta,"TILELENGTH"))-1,minRow:0,minCol:0})}));W=H[0].get("GDAL_METADATA")?.values?.[0];W=O(W);da+=" "+x({width:T,height:X,tileWidth:R,tileHeight:Y,planes:K,ifds:H});H=g(H).length===ea.length+1;ea=ea?.length?ea.map(ta=>{const wa=
T/n(ta,"IMAGEWIDTH");ta=X/n(ta,"IMAGELENGTH");return{x:wa,y:ta}}):void 0;return{width:T,height:X,tileWidth:R,tileHeight:Y,planes:K,isBSQ:ca,pixelType:Z,compression:I,noData:U,hasMaskBand:H,isSupported:aa,pyramidResolutions:ea,message:da,extent:S,isPseudoGeographic:J,affine:V?null:ma,firstPyramidLevel:oa,maximumPyramidLevel:sa,pyramidBlockWidth:pa,pyramidBlockHeight:qa,tileBoundary:va,metadata:W}}function d(H,J){return(H=H.get("PLANARCONFIGURATION")?.values)?2===H[0]:J?J.isBSQ:!1}function b(H){return H.filter(J=>
1===n(J,"NEWSUBFILETYPE"))}function g(H){return H.filter(J=>{const R=4===((n(J,"NEWSUBFILETYPE")??0)&4);J=4===n(J,"PHOTOMETRICINTERPRETATION");return R&&J})}function z(H){const {littleEndian:J,isBigTiff:R,firstIFDPos:Y}=y(H);var T=Y;const X=[];do if(T=A(H,J,T,0,Q.tiffTags,R?8:4),T.success)X.push(T.ifd),T=T.nextIFD;else break;while(0<T);H=l(X);T=b(X);const V=g(X);return{...H,littleEndian:J,isBigTiff:R,ifds:X,pyramidIFDs:T,maskIFDs:V}}function v(H,J,R){const Y=H.getUint32(J,R);H=H.getUint32(J+4,R);
return R?4294967296*H+Y:4294967296*Y+H}function C(H,J,R,Y){return Y?v(H,J,R):H.getUint32(J,R)}function y(H){var J=new DataView(H,0,16),R=J.getUint16(0,!1);H=null;if(18761===R)H=!0;else if(19789===R)H=!1;else throw Error("unexpected endianess byte");var Y=J.getUint16(2,H);if(42!==Y&&43!==Y)throw Error("unexpected tiff identifier");R=4;if(Y=43===Y){const T=J.getUint16(R,H);R+=2;if(8!==T)throw Error("unsupported bigtiff version");if(0!==J.getUint16(R,H))throw Error("unsupported bigtiff version");R+=
2}J=C(J,R,H,Y);return{littleEndian:H,isBigTiff:Y,firstIFDPos:J}}function A(H,J,R,Y=0,T=Q.tiffTags,X=4){R=h(H,J,R,Y,T,X);let V;const K=R.ifd;K&&(Q.ifdTags.forEach((S,Z)=>{K.has(Z)&&(V=K.get(Z),V.data=h(H,J,V.valueOffset-Y,Y,S).ifd)}),K.has("GEOKEYDIRECTORY")&&(V=K.get("GEOKEYDIRECTORY"),(T=V.values)&&4<T.length&&(T=T[0]+"."+T[1]+"."+T[2],V.data=h(H,J,V.valueOffset+6-Y,Y,Q.geoKeys,2).ifd,V.data&&V.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[T]}))),K.has("XMP")&&(V=K.get("XMP"),
T=V.values,"number"===typeof T[0]&&7===V.type&&(V.values=[t.bytesToUTF8(new Uint8Array(T))])));return R}function x(H){const {width:J,height:R,tileHeight:Y,tileWidth:T}=H,X=H.planes,V=T?T*Y:J*R;H=n(H.ifds[0],"BITSPERSAMPLE");let K="";V*X>2**30/(8<H?H/8:1)&&(K=T?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return K}const E=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],N=new Set([1,5,6,7,8,34712,34887]),G=(H,J,R)=>{if(!(H&&0<H.length&&
J&&R))return null;let Y,T,X;const V=H[0].length,K=H.length,S=new Uint8Array(V);for(let ca=0;ca<K;ca++)if(Y=H[ca],T=J[ca],X=R[ca],0===ca)for(var Z=0;Z<V;Z++)S[Z]=Y[Z]<T||Y[Z]>X?0:1;else for(Z=0;Z<V;Z++)S[Z]&&(S[Z]=Y[Z]<T||Y[Z]>X?0:1);return S},O=H=>{if(!H)return null;var J=H.match(/<Item(.*?)Item>/gi);if(!J||0===J.length)return null;H=new Map;var R;for(var Y=0;Y<J.length;Y++){var T=J[Y];var X=T.slice(6,T.indexOf("\x3e"));var V=T.indexOf("sample\x3d");-1<V&&(R=T.slice(V+8,T.indexOf('"',V+8)));V=T.indexOf("name\x3d");
-1<V&&(X=T.slice(V+6,T.indexOf('"',V+6)));X&&(T=T.slice(T.indexOf("\x3e")+1,T.indexOf("\x3c/Item\x3e")).trim(),null!=R?H.has(X)?H.get(X)[R]=T:H.set(X,[T]):H.set(X,T));R=null}J=H.get("STATISTICS_MINIMUM");X=H.get("STATISTICS_MAXIMUM");Y=H.get("STATISTICS_MEAN");T=H.get("STATISTICS_STDDEV");R=null;if(J&&X)for(R=[],V=0;V<J.length;V++)R.push({min:parseFloat(J[V]),max:parseFloat(X[V]),avg:Y&&parseFloat(Y[V]),stddev:T&&parseFloat(T[V])});X=H.get("BandName");Y=H.get("WavelengthMin");T=H.get("WavelengthMax");
J=null;if(X)for(J=[],V=0;V<X.length;V++)J.push({BandName:X[V],WavelengthMin:Y&&parseFloat(Y[V]),WavelengthMax:T&&parseFloat(T[V])});X=H.get("DataType");return{statistics:R,bandProperties:J,dataType:X,rawMetadata:H}};p.decode=async function(H,J={}){var R=J.pyramidLevel||0,Y=J.headerInfo||z(H);const {ifds:T,noData:X}=Y;if(0===T.length)throw Error("no valid image file directory");var V=x(Y);if(V)throw V;V=null;var K=-1===R?T[T.length-1]:T[R];J=X??J.noDataValue;if(Y.tileWidth)V=await a(H,Y,K);else{{const sa=
B.isPlatformLittleEndian===Y.littleEndian,qa=K.get("STRIPOFFSETS")?.values;if(void 0===qa)V=null;else{var {width:S,height:Z,pixelType:ca}=l([K]);R=n(K,"SAMPLESPERPIXEL")||Y.planes;var I=n(K,"PHOTOMETRICINTERPRETATION");V=S*Z;var U=n(K,"BITSPERSAMPLE"),W=c(ca),aa=new W(V*R),da=K.get("STRIPBYTECOUNTS")?.values,ea=n(K,"ROWSPERSTRIP"),ha=n(K,"COMPRESSION")??1,ia;if(0===U%8)for(K=0;K<qa.length;K++){var ka=K*ea*S*R;if("u8"===ca||"s8"===ca||sa)if(8===ha||32946===ha){var ma=new Uint8Array(H,qa[K],da[K]);
ma=k(ma);var pa=ma.buffer}else 6===ha?(ma=new Uint8Array(H,qa[K],da[K]),ma=w(ma,R,I),pa=ma.buffer):5===ha?(ma=P.decode(H,qa[K],da[K],Y.littleEndian),pa=ma.buffer):pa=H.slice(qa[K],qa[K]+da[K]);else{if(6===ha||8===ha||32946===ha){ma=new Uint8Array(H,qa[K],da[K]);var oa=k(ma);pa=oa.buffer}else pa=new ArrayBuffer(da[K]),ma=new Uint8Array(H,qa[K],da[K]),oa=new Uint8Array(pa);switch(ca){case "u16":case "s16":for(ia=0;ia<ma.length;ia+=2)oa[ia]=ma[ia+1],oa[ia+1]=ma[ia];break;case "u32":case "s32":case "f32":for(ia=
0;ia<ma.length;ia+=4)oa[ia]=ma[ia+3],oa[ia+1]=ma[ia+2],oa[ia+2]=ma[ia+1],oa[ia+3]=ma[ia]}}pa=m(pa,U);ia=new W(pa);aa.set(ia,ka)}I=[];if(1===R)I.push(aa);else for(K=0;K<R;K++){Y=new W(V);for(H=0;H<V;H++)Y[H]=aa[H*R+K];I.push(Y)}V={width:S,height:Z,pixelType:ca,pixels:I}}}}if(!V)return V;null!=J&&M.convertNoDataToMask(V,J);return V};p.decodeTileOrStrip=async function(H,J){const {headerInfo:R,ifd:Y,offsets:T,sizes:X}=J;var V=[];for(var K=0;K<T.length;K++){0===X[K]?1:0;var S=await r(H,R.littleEndian,
Y,T[K],X[K]||H.byteLength);V.push(S)}var Z=d(Y,R);H=n(Y,"BITSPERSAMPLE");K=n(Y,"SAMPLEFORMAT")??1;K=q(K,H);var ca=n(Y,"SAMPLESPERPIXEL")||R.planes;const I=c(K);S=n(Y,"TILEWIDTH");const U=n(Y,"TILELENGTH");var W=n(Y,"COMPRESSION")??1;const aa=S*U;H=[];let da=V[0];const ea=34887===W;for(let ha=0;ha<ca;ha++){W=new I(aa);if(V.length===ca)da=V[ha],da.length===aa&&(W=da);else if(da.length)if(Z||ea)W=da.length===aa?da:da.slice(aa*ha,aa*(ha+1));else for(let ia=0;ia<aa;ia++)W[ia]=da[ia*ca+ha];H.push(W)}V=
R.noData?R.noData[0]:J.noDataValue;Z=(ca=R.metadata?R.metadata.statistics:null)?ca.map(ha=>ha.min):null;ca=ca?ca.map(ha=>ha.max):null;K={pixelType:K,width:S,height:U,pixels:H,noDataValue:V};null!=V?M.convertNoDataToMask(K,V):Z&&ca&&J.applyMinMaxConstraint&&(K.mask=G(H,Z,ca));return K};p.getImageInfo=l;p.getMaskIFDs=g;p.getPyramidIFDs=b;p.isBSQConfig=d;p.parseFieldValues=f;p.parseHeader=z;p.parseIFD=A;p.parseSignature=y;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],
function(p){p.bytesToUTF8=function(u,t){let L=0,F="",P=0,M=0;const Q=u.length;for(;L<Q;)if(M=u[L++],P=M>>4,8>P?P=1:15===P?(P=4,M=(M&7)<<18|(u[L++]&63)<<12|(u[L++]&63)<<6|u[L++]&63):14===P?(P=3,M=(M&15)<<12|(u[L++]&63)<<6|u[L++]&63):(P=2,M=(M&31)<<6|u[L++]&63),0!==M||t)F+=String.fromCharCode(M);return F};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const p=(()=>{const F=[];F[254]="NEWSUBFILETYPE";F[255]="SUBFILETYPE";
F[256]="IMAGEWIDTH";F[257]="IMAGELENGTH";F[258]="BITSPERSAMPLE";F[259]="COMPRESSION";F[262]="PHOTOMETRICINTERPRETATION";F[263]="THRESHHOLDING";F[264]="CELLWIDTH";F[265]="CELLLENGTH";F[266]="FILLORDER";F[269]="DOCUMENTNAME";F[270]="IMAGEDESCRIPTION";F[271]="MAKE";F[272]="MODEL";F[273]="STRIPOFFSETS";F[274]="ORIENTATION";F[277]="SAMPLESPERPIXEL";F[278]="ROWSPERSTRIP";F[279]="STRIPBYTECOUNTS";F[280]="MINSAMPLEVALUE";F[281]="MAXSAMPLEVALUE";F[282]="XRESOLUTION";F[283]="YRESOLUTION";F[284]="PLANARCONFIGURATION";
F[285]="PAGENAME";F[286]="XPOSITION";F[287]="YPOSITION";F[288]="FREEOFFSETS";F[289]="FREEBYTECOUNTS";F[290]="GRAYRESPONSEUNIT";F[291]="GRAYRESPONSECURVE";F[292]="T4OPTIONS";F[293]="T6OPTIONS";F[296]="RESOLUTIONUNIT";F[297]="PAGENUMBER";F[300]="COLORRESPONSEUNIT";F[301]="TRANSFERFUNCTION";F[305]="SOFTWARE";F[306]="DATETIME";F[315]="ARTIST";F[316]="HOSTCOMPUTER";F[317]="PREDICTOR";F[318]="WHITEPOINT";F[319]="PRIMARYCHROMATICITIES";F[320]="COLORMAP";F[321]="HALFTONEHINTS";F[322]="TILEWIDTH";F[323]="TILELENGTH";
F[324]="TILEOFFSETS";F[325]="TILEBYTECOUNTS";F[326]="BADFAXLINES";F[327]="CLEANFAXDATA";F[328]="CONSECUTIVEBADFAXLINES";F[330]="SUBIFD";F[332]="INKSET";F[333]="INKNAMES";F[334]="NUMBEROFINKS";F[336]="DOTRANGE";F[337]="TARGETPRINTER";F[338]="EXTRASAMPLES";F[339]="SAMPLEFORMAT";F[340]="SMINSAMPLEVALUE";F[341]="SMAXSAMPLEVALUE";F[342]="TRANSFERRANGE";F[347]="JPEGTABLES";F[512]="JPEGPROC";F[513]="JPEGIFOFFSET";F[514]="JPEGIFBYTECOUNT";F[515]="JPEGRESTARTINTERVAL";F[517]="JPEGLOSSLESSPREDICTORS";F[518]=
"JPEGPOINTTRANSFORM";F[519]="JPEGQTABLES";F[520]="JPEGDCTABLES";F[521]="JPEGACTABLES";F[529]="YCBCRCOEFFICIENTS";F[530]="YCBCRSUBSAMPLING";F[531]="YCBCRPOSITIONING";F[532]="REFERENCEBLACKWHITE";F[700]="XMP";F[33550]="GEOPIXELSCALE";F[33922]="GEOTIEPOINTS";F[33432]="COPYRIGHT";F[42112]="GDAL_METADATA";F[42113]="GDAL_NODATA";F[50844]="RPCCOEFFICIENT";F[34264]="GEOTRANSMATRIX";F[34735]="GEOKEYDIRECTORY";F[34736]="GEODOUBLEPARAMS";F[34737]="GEOASCIIPARAMS";F[34665]="EXIFIFD";F[34853]="GPSIFD";F[40965]=
"INTEROPERABILITYIFD";return F})(),u=(()=>{const F=p.slice();F[36864]="ExifVersion";F[40960]="FlashpixVersion";F[40961]="ColorSpace";F[42240]="Gamma";F[37121]="ComponentsConfiguration";F[37122]="CompressedBitsPerPixel";F[40962]="PixelXDimension";F[40963]="PixelYDimension";F[37500]="MakerNote";F[37510]="UserComment";F[40964]="RelatedSoundFile";F[36867]="DateTimeOriginal";F[36868]="DateTimeDigitized";F[36880]="OffsetTime";F[36881]="OffsetTimeOriginal";F[36882]="OffsetTimeDigitized";F[37520]="SubSecTime";
F[37521]="SubSecTimeOriginal";F[37522]="SubSecTimeDigitized";F[37888]="Temperature";F[37889]="Humidity";F[37890]="Pressure";F[37891]="WaterDepth";F[37892]="Acceleration";F[37893]="CameraElevationAngle";F[42016]="ImageUniqueID";F[42032]="CameraOwnerName";F[42033]="BodySerialNumber";F[42034]="LensSpecification";F[42035]="LensMake";F[42036]="LensModel";F[42037]="LensSerialNumber";F[33434]="ExposureTime";F[33437]="FNumber";F[34850]="ExposureProgram";F[34852]="SpectralSensitivity";F[34855]="PhotographicSensitivity";
F[34856]="OECF";F[34864]="SensitivityType";F[34865]="StandardOutputSensitivity";F[34866]="RecommendedExposureIndex";F[34867]="ISOSpeed";F[34868]="ISOSpeedLatitudeyyy";F[34869]="ISOSpeedLatitudezzz";F[37377]="ShutterSpeedValue";F[37378]="ApertureValue";F[37379]="BrightnessValue";F[37380]="ExposureBiasValue";F[37381]="MaxApertureValue";F[37382]="SubjectDistance";F[37383]="MeteringMode";F[37384]="LightSource";F[37385]="Flash";F[37386]="FocalLength";F[37396]="SubjectArea";F[41483]="FlashEnergy";F[41484]=
"SpatialFrequencyResponse";F[41486]="FocalPlaneXResolution";F[41487]="FocalPlaneYResolution";F[41488]="FocalPlaneResolutionUnit";F[41492]="SubjectLocation";F[41493]="ExposureIndex";F[41495]="SensingMethod";F[41728]="FileSource";F[41729]="SceneType";F[41730]="CFAPattern";F[41985]="CustomRendered";F[41986]="ExposureMode";F[41987]="WhiteBalance";F[41988]="DigitalZoomRatio";F[41989]="FocalLengthIn35mmFilm";F[41990]="SceneCaptureType";F[41991]="GainControl";F[41992]="Contrast";F[41993]="Saturation";F[41994]=
"Sharpness";F[41995]="DeviceSettingDescription";F[41996]="SubjectDistanceRange";return F})(),t=(()=>{const F=[];F[1024]="GTModelTypeGeoKey";F[1025]="GTRasterTypeGeoKey";F[1026]="GTCitationGeoKey";F[2048]="GeographicTypeGeoKey";F[2049]="GeogCitationGeoKey";F[2050]="GeogGeodeticDatumGeoKey";F[2051]="GeogPrimeMeridianGeoKey";F[2052]="GeogLinearUnitsGeoKey";F[2053]="GeogLinearUnitSizeGeoKey";F[2054]="GeogAngularUnitsGeoKey";F[2055]="GeogAngularUnitSizeGeoKey";F[2056]="GeogEllipsoidGeoKey";F[2057]="GeogSemiMajorAxisGeoKey";
F[2058]="GeogSemiMinorAxisGeoKey";F[2059]="GeogInvFlatteningGeoKey";F[2061]="GeogPrimeMeridianLongGeoKey";F[2060]="GeogAzimuthUnitsGeoKey";F[3072]="ProjectedCSTypeGeoKey";F[3073]="PCSCitationGeoKey";F[3074]="ProjectionGeoKey";F[3075]="ProjCoordTransGeoKey";F[3076]="ProjLinearUnitsGeoKey";F[3077]="ProjLinearUnitSizeGeoKey";F[3078]="ProjStdParallel1GeoKey";F[3079]="ProjStdParallel2GeoKey";F[3080]="ProjNatOriginLongGeoKey";F[3081]="ProjNatOriginLatGeoKey";F[3082]="ProjFalseEastingGeoKey";F[3083]="ProjFalseNorthingGeoKey";
F[3084]="ProjFalseOriginLongGeoKey";F[3085]="ProjFalseOriginLatGeoKey";F[3086]="ProjFalseOriginEastingGeoKey";F[3087]="ProjFalseOriginNorthingGeoKey";F[3088]="ProjCenterLongGeoKey";F[3090]="ProjCenterEastingGeoKey";F[3091]="ProjCenterNorthingGeoKey";F[3092]="ProjScaleAtNatOriginGeoKey";F[3093]="ProjScaleAtCenterGeoKey";F[3094]="ProjAzimuthAngleGeoKey";F[3095]="ProjStraightVertPoleLongGeoKey";F[4096]="VerticalCSTypeGeoKey";F[4097]="VerticalCitationGeoKey";F[4098]="VerticalDatumGeoKey";F[4099]="VerticalUnitsGeoKey";
return F})(),L=new Map;L.set("EXIFIFD",u);L.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:p,ifdTags:L,geoKeys:t,getTagName:(F,P)=>{P=(P||p)[F];void 0===P&&(P="unknown"+String(F));return P}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(p){const u=new ArrayBuffer(4),t=new Uint8Array(u);(new Uint32Array(u))[0]=1;p.isPlatformLittleEndian=1===t[0];Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/QueueProcessor":function(){define("exports ../../core/has ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/ReactiveMap ../../core/scheduling ../../core/signal".split(" "),
function(p,u,t,L,F,P,M,Q){class B{constructor(q,c){this.item=q;this.controller=c;this.promise=null}}class D{constructor(q){this._task=this._schedule=null;this._deferreds=new P;this._controllers=new P;this._processingItems=new P;this._pausedSignal=Q.signal(!1);this.concurrency=1;q.concurrency&&(this.concurrency=q.concurrency);this._queue=new F(q.peeker);this.process=q.process;const c=q.scheduler;q.priority&&c&&(this._task=c.registerTask(q.priority,this))}destroy(){this.clear();this._schedule=t.removeMaybe(this._schedule);
this._task=t.removeMaybe(this._task)}get updating(){return!!this._task?.updating||this.running}get length(){return this._processingItems.size+this._queue.length}abort(q){(q=this._controllers.get(q))&&q.abort()}clear(){this._queue.clear();const q=[];this._controllers.forEach(c=>q.push(c));this._controllers.clear();q.forEach(c=>c.abort());this._processingItems.clear();this._cancelNext()}forEach(q){this._deferreds.forEach((c,e)=>q(e))}get(q){return(q=this._deferreds.get(q))?q.promise:void 0}isOngoing(q){return this._processingItems.has(q)}has(q){return this._deferreds.has(q)}pause(){this._pausedSignal.value||
(this._pausedSignal.value=!0,this._cancelNext())}push(q,c){const e=this.get(q);if(e)return e;const n=new AbortController;let h=null;c&&(h=L.onAbort(c,()=>n.abort()));const m=()=>{w.remove();null!=h&&h.remove();this._removeItem(q);this._queue.remove(q);this._scheduleNext()},w=L.onAbortOrThrow(n.signal,()=>{const r=this._processingItems.get(q);r&&r.controller.abort();m();k.reject(L.createAbortError())}),k=L.createResolver();this._deferreds.set(q,k);this._controllers.set(q,n);k.promise.then(m,m);this._queue.push(q);
this._scheduleNext();return k.promise}last(){return this._queue.last()}lastPromise(){const q=this.last();return q?this.get(q):null}peek(){return this._queue.peek()}popLast(){const q=this._queue.popLast();q&&(this._deferreds.get(q)?.reject(L.createAbortError()),this._removeItem(q));return q}reset(){const q=Array.from(this._processingItems.values());this._processingItems.clear();for(const c of q)this._queue.push(c.item),c.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=
!1,this._scheduleNext())}takeAll(){const q=[];for(;this._queue.length;)q.push(this._queue.pop());this.clear();return q}get running(){return!this._pausedSignal.value&&0<this._queue.length&&this._processingItems.size<this.concurrency}runTask(q){for(;!q.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),q.madeProgress()}_removeItem(q){this._deferreds.delete(q);this._controllers.delete(q);this._processingItems.delete(q)}_scheduleNext(){this._task||
this._pausedSignal.value||this._schedule||(this._schedule=M.schedule(()=>{this._schedule=null;this._next()}))}_next(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(q,c){this._canProcessFulfillment(q)&&(this._scheduleNext(),this._deferreds.get(q.item).resolve(c))}_processError(q,c){this._canProcessFulfillment(q)&&(this._scheduleNext(),this._deferreds.get(q.item).reject(c))}_canProcessFulfillment(q){return this._deferreds.get(q.item)&&
this._processingItems.get(q.item)===q?!0:!1}_process(q){if(null!=q){var c=new AbortController,e=new B(q,c);this._processingItems.set(q,e);try{var n=this.process(q,c.signal)}catch(h){this._processError(e,h)}L.isPromiseLike(n)?(e.promise=n,n.then(h=>this._processResult(e,h),h=>this._processError(e,h))):this._processResult(e,n)}}get test(){}}p.QueueProcessor=D;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/clipUtils":function(){define("require exports ../../../core/unitUtils ../../../geometry/Extent ../../../geometry/Point ../PixelBlock".split(" "),
function(p,u,t,L,F,P){function M(q,c,e){if(!q)return q;const {width:n,height:h}=q,m=c.width/n,w=c.height/h,{xmin:k,ymax:r}=c;if("extent"===e.type){c=(e.xmin-k)/m;var a=(e.xmax-k)/m,f=(r-e.ymax)/w;e=(r-e.ymin)/w;e=[[[c,f],[c,e],[a,e],[a,f],[c,f]]]}else e=e.rings.map(d=>d.map(([b,g])=>[(b-k)/m,(r-g)/w]));c=document.createElement("canvas");c.width=n;c.height=h;const l=c.getContext("2d");l.fillStyle="#f00";l.beginPath();e.forEach(d=>{l.moveTo(d[0][0],d[0][1]);for(let b=0;b<d.length;b++)l.lineTo(d[b][0],
d[b][1]);l.closePath()});l.fill();e=l.getImageData(0,0,n,h).data;c=q.mask;a=n*h;f=new Uint8Array(a);for(let d=0;d<a;d++)if(!c||c[d])f[d]=127<e[4*d+3]?255:0;return new P({pixelType:q.pixelType,width:n,height:h,mask:f,maskIsAlpha:!1,pixels:[...q.pixels]})}function Q(q,c,e){const {width:n,height:h}=q,m=new Uint8Array(n*h);var w=c.width/n,k=c.height/h;if(.5>e.width/w||.5>e.height/k)return new P({pixelType:q.pixelType,width:n,height:h,mask:m,pixels:[...q.pixels]});const {xmin:r,xmax:a,ymin:f,ymax:l}=c,
{xmin:d,xmax:b,ymin:g,ymax:z}=e;c=Math.max(r,d);var v=Math.min(a,b);e=Math.max(f,g);var C=Math.min(l,z),y=.5*w,A=.5*k;if(v-c<y||C-e<A||v<r+y||c>a-y||e>l-A||C<f+A)return new P({pixelType:q.pixelType,width:n,height:h,mask:m,pixels:[...q.pixels]});c=Math.max(0,(c-r)/w);v=Math.min(n,Math.max(0,(v-r)/w));C=Math.max(0,(l-C)/k);A=Math.min(h,Math.max(0,(l-e)/k));k=Math.round(c);w=Math.round(v)-1;y=Math.round(C);e=Math.round(A)-1;if(k===w&&.5<c%1&&.5>v%1||y===e&&.5<C%1&&.5>A%1)return new P({pixelType:q.pixelType,
width:n,height:h,mask:m,pixels:[...q.pixels]});if(0===k&&0===y&&w===n&&e===h)return q;c=q.mask;for(v=y;v<=e;v++)for(C=k;C<=w;C++)y=v*n+C,m[y]=c?c[y]:255;return new P({pixelType:q.pixelType,width:n,height:h,mask:m,pixels:[...q.pixels]})}function B(q,c,e){const {width:n,height:h}=q,m=new Uint8Array(n*h),w=c.width/n,k=c.height/h,{xmin:r,ymax:a}=c;({paths:c}=e);e=q.mask;for(let g=0;g<c.length;g++){const z=c[g];for(let v=0;v<z.length-1;v++){const [C,y]=z[v],[A,x]=z[v+1];let E=Math.floor((a-y)/k),N=Math.floor((a-
x)/k);if(N<E){var f=E;E=N;N=f}E=Math.max(0,E);N=Math.min(h-1,N);f=(A-C)/(x-y);for(let G=E;G<=N;G++){var l=G===E?Math.max(y,x):(h+1-G)*k,d=G===N?Math.min(y,x):l-k;l=x===y?Math.floor((C-r)/w):Math.floor((f*(l-y)+C-r)/w);d=x===y?Math.floor((A-r)/w):Math.floor((f*(d-y)+C-r)/w);if(d<l){var b=l;l=d;d=b}b=G*n;l=Math.max(0,l);d=Math.min(n-1,d);for(l=b+l;l<=b+d;l++)m[l]=e?e[l]:255}}}return new P({pixelType:q.pixelType,width:n,height:h,mask:m,pixels:[...q.pixels]})}function D(q,c,e,n=!0){var {spatialReference:h}=
q;if(!e.spatialReference.equals(h)){var m=t.getMetersPerUnitForSR(e.spatialReference),w=t.getMetersPerUnitForSR(h);m!==w&&(m/=w,e={x:e.x*m,y:e.y*m})}const {x:k,y:r}=e;let {xmin:a,xmax:f,ymax:l,ymin:d}="extent"===c.type?c:c.extent;const {xmin:b,ymax:g}=q.extent;n?(a=b+(a>b?k*Math.round((a-b)/k):0),l=g-(l<g?r*Math.round((g-l)/r):0),f=b+(f>b?k*Math.round((f-b)/k):0),d=g-(d<g?r*Math.round((g-d)/r):0),h=new L({xmin:a,ymax:l,xmax:f,ymin:d,spatialReference:h}),q=Math.round(h.width/k),c=Math.round(h.height/
r)):(q=Math.floor((f-a)/k+.8),c=Math.floor((l-d)/r+.8),a=b+(a>b?k*Math.floor((a-b)/k+.1):0),l=g-(l<g?r*Math.floor((g-l)/r+.1):0),h=new L({xmin:a,ymax:l,xmax:a+q*k,ymin:l-c*r,spatialReference:h}));return{extent:h,width:q,height:c}}u.clip=async function(q,c,e){if("extent"===e.type)return Q(q,c,e);const {width:n,height:h}=q,m=new Uint8Array(n*h),{contains:w,intersects:k}=await new Promise((r,a)=>p(["../../../geometry/geometryEngine"],r,a));return k(c,e)?"polyline"===e.type?B(q,c,e):w(e,c)?q:M(q,c,e):
new P({pixelType:q.pixelType,width:n,height:h,mask:m,maskIsAlpha:!1,pixels:[...q.pixels]})};u.clipRasterInfo=function(q,c){({extent:c}=D(q,c,new F({x:q.pixelSize.x,y:q.pixelSize.y,spatialReference:q.spatialReference})));var {extent:e}=q.extent;c.xmax=Math.min(c.xmax,e.xmax);c.ymax=Math.min(c.ymax,e.ymax);if(c.xmin<c.xmax&&c.ymin<c.ymax){const {x:n,y:h}=q.pixelSize;e=Math.round(c.width/n);const m=Math.round(c.height/h);q.extent=c;q.width=e;q.height=m}};u.snapToRaster=D;Object.defineProperty(u,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./ArithmeticFunction ./AspectFunction ./BandArithmeticFunction ./ClipFunction ./ColormapFunction ./ColormapToRGBFunction ./CompositeBandFunction ./ComputeChangeFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./GrayscaleFunction ./HillshadeFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./ShadedReliefFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b,g,z,v,C){function y(K,S){({rasterFunctionArguments:K}=K);K&&(K.rasters||[K.raster,K.raster2]).forEach(Z=>{Z&&"number"!==typeof Z&&("string"===typeof Z?Z.startsWith("http")&&(S.includes(Z)||S.push(Z)):"rasterFunctionArguments"in Z&&y(Z,S))})}function A(K,S){return"rasters"===S[0]&&Array.isArray(K.rasters)?K.rasters:S.map(Z=>K[Z])}function x(K){return!!(K&&"object"===typeof K&&K.rasterFunction&&K.rasterFunctionArguments)}function E(K){const {rasterFunction:S,
rasterFunctionArguments:Z}=K,ca={};for(const U in Z){let W=Z[U];var I=U.toLowerCase();if("rasters"===I&&Array.isArray(W))ca.rasters=W.map(aa=>x(aa)?E(aa):aa);else switch(x(W)&&(W=E(W)),I){case "dra":ca.dra=W;break;case "pspower":ca.psPower=W;break;case "pszfactor":ca.psZFactor=W;break;case "bandids":ca.bandIds=W;break;default:I=U[0].toLowerCase()+U.slice(1),ca[I]=W}}"Local"!==S||ca.rasters?.length||(ca.rasters=["$$"]);return{...K,rasterFunctionArguments:ca}}function N(K,S){const {rasterFunction:Z,
rasterFunctionArguments:ca}=K;var I=K.outputPixelType?.toLowerCase();if(null==Z||!V.has(Z))throw new t("raster-function-helper",`unsupported raster function: ${Z}`);var U=V.get(Z);const W=("function"===typeof U.ctor?U.ctor:U.ctor["default"]).fromJSON({...K,outputPixelType:I});({rasterArgumentNames:K}=W);I=[];U=A(ca,K);const aa="rasters"===K[0]||1<K.length,da=[];for(let ea=0;ea<U.length;ea++){const ha=U[ea];let ia;null==ha||"string"===typeof ha&&ha.startsWith("$")?I.push(S?.raster):"string"===typeof ha?
S[ha]&&I.push(S[ha]):"number"!==typeof ha&&"rasterFunction"in ha&&(ia=N(ha,S),aa||(W.functionArguments[K[ea]]=ia),I.push(ia));aa&&da.push(ia??ha)}aa&&("rasters"===K[0]?W.functionArguments.rasters=da:K.forEach((ea,ha)=>{W.functionArguments[ea]=da[ha]}));S&&(W.sourceRasters=I,S=S.raster?.url)&&(W.mainPrimaryRasterId=S);return W}function G(K,S){if(K&&S)for(const Z in K){const ca=K[Z];ca&&"object"===typeof ca&&"type"in ca&&("RasterFunctionTemplate"===ca.type?G(ca.arguments,S):"RasterFunctionVariable"===
ca.type&&null!=S[ca.name]&&(ca.value=S[ca.name]))}}function O(K,S){if(!K||"object"!==typeof K)return K;const {value:Z}=K;if(!Z||"object"!==typeof Z)return K.isDataset?"$$":Z;if(Array.isArray(Z))return 0===Z.length?[]:Z.map(I=>"object"===typeof I&&"RasterFunctionVariable"===I.type?O(I,S):I);if("value"in Z&&["number","string","boolean"].includes(typeof Z.value))return Z.value;if(K.isDataset&&"Scalar"!==Z.type)return"$$";if(!("type"in Z))return Z;K=Z;switch(Z.type){case "Scalar":K=Z.value;break;case "AlgorithmicColorRamp":K=
H(Z);break;case "MultiPartColorRamp":K={type:"multipart",colorRamps:Z.ArrayOfColorRamp.map(H)};break;case "ArgumentArray":if(Z.elements?.length&&"RasterStatistics"!==Z.elements[0].type){K=[];for(let I=0;I<Z.elements.length;I++){const U=Z.elements[I];var {type:ca}=U;if(ca)if("RasterFunctionTemplate"===ca)({renderingRule:ca}=J(U,S)),K.push(ca),null!=U._object_id&&S.set(U._object_id,ca);else if("RasterFunctionVariable"===ca)ca=O(U,S),K.push(ca),null!=U._object_id&&S.set(U._object_id,ca);else throw new t("raster-function-helper",
"unsupported raster function json.");else K.push(U)}}else K=Z.elements}null!=Z._object_id&&S.set(Z._object_id,K);return K}function H(K){const S=K.algorithm??"esriHSVAlgorithm";let {FromColor:Z,ToColor:ca}=K;if(!Array.isArray(Z)){const {r:I,g:U,b:W}=u.toRGB({h:Z.Hue,s:Z.Saturation,v:Z.Value});Z=[I,U,W,Z.AlphaValue]}if(!Array.isArray(ca)){const {r:I,g:U,b:W}=u.toRGB({h:ca.Hue,s:ca.Saturation,v:ca.Value});ca=[I,U,W,ca.AlphaValue]}return{type:"algorithmic",algorithm:S,fromColor:Z,toColor:ca}}function J(K,
S,Z){Z&&G(K,Z);S={renderingRule:{},templates:S};R(K,S);return S}function R(K,S){if(K&&S.renderingRule){var {renderingRule:Z,templates:ca}=S,{function:I,arguments:U,_object_id:W}=K;if(I&&U){null!=W&&ca.set(W,Z);Z.rasterFunction=I.type.replace("Function","");Z.outputPixelType=I.pixelType;K={};Z.rasterFunctionArguments=K;for(const aa in U)"type"!==aa&&"object_id"!==aa&&"_object_ref_id"!==aa&&((S=U[aa])&&"object"===typeof S&&"type"in S&&("RasterFunctionTemplate"===S.type||"RasterFunctionVariable"===S.type)?
("RasterFunctionVariable"===S.type?K[aa]=O(S,ca):(Z.rasterFunctionArguments[aa]={},R(S,{renderingRule:Z.rasterFunctionArguments[aa],templates:ca})),null!=S._object_id&&ca.set(S._object_id,K[aa])):K[aa]=S);K.DEM&&!K.Raster&&(K.Raster=K.DEM,delete K.DEM);switch(Z.rasterFunction){case "Stretch":T(K);break;case "Colormap":"randomcolorramp"===K.ColorRamp?.type?.toLowerCase()&&(delete K.ColorRamp,K.ColormapName="Random");0===K.ColorSchemeType&&delete K.ColorRamp;break;case "Convolution":null!=K.ConvolutionType&&
(K.Type=K.ConvolutionType,delete K.ConvolutionType);break;case "Mask":X(K)}}}}function Y(K){const {renderingRule:S,templates:Z}=K;if("object"===typeof S&&S?.rasterFunctionArguments&&Z.size){({rasterFunctionArguments:K}=S);for(const ca in K){const I=K[ca],U="_object_ref_id"===ca?I:I&&"object"===typeof I&&"_object_ref_id"in I?I._object_ref_id:null;if(null!=U){if(!Z.has(U))throw new t("raster-function-helper",`unsupported raster function json. _object_ref_id: ${U} does not exist`);const W=Z.get(U);"_object_ref_id"!==
ca?K[ca]=W:W&&"object"===typeof W&&Object.assign(K,W)}else I&&"object"===typeof I&&(I.rasterFunctionArguments&&Y({renderingRule:I,templates:Z}),Array.isArray(I)&&I.forEach((W,aa)=>{if("object"===typeof W)if(null!=W._object_ref_id){if(!Z.has(W._object_ref_id))throw new t("raster-function-helper",`unsupported raster function json. _object_ref_id: ${I} does not exist`);const da=Z.get(U);da&&"object"===typeof da?Object.assign(W,da):I[aa]=da}else Y({renderingRule:W,templates:Z})}))}}}function T(K){K.Statistics?.length&&
"object"===typeof K.Statistics&&(K.Statistics=K.Statistics.map(S=>[S.min,S.max,S.mean,S.standardDeviation]));null!=K.NumberOfStandardDeviation&&(K.NumberOfStandardDeviations=K.NumberOfStandardDeviation,delete K.NumberOfStandardDeviation)}function X(K){K.NoDataValues?.length&&"string"===typeof K.NoDataValues[0]&&(K.NoDataValues=K.NoDataValues.filter(S=>""!==S).map(S=>Number(S)))}const V=new Map;V.set("Arithmetic",{desc:"Arithmetic Function",ctor:F,rasterArgumentNames:["rasters"]});V.set("Aspect",{desc:"Aspect Function",
ctor:P,rasterArgumentNames:["raster"]});V.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:M,rasterArgumentNames:["raster"]});V.set("Colormap",{desc:"Colormap Function",ctor:B,rasterArgumentNames:["raster"]});V.set("ColormapToRGB",{desc:"ColormapToRGB Function",ctor:D,rasterArgumentNames:["raster"]});V.set("CompositeBand",{desc:"CompositeBand Function",ctor:q,rasterArgumentNames:["rasters"]});V.set("ComputeChange",{desc:"ComputeChange Function",ctor:c,rasterArgumentNames:["rasters"]});V.set("Convolution",
{desc:"Convolution Function",ctor:n,rasterArgumentNames:["raster"]});V.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:e,rasterArgumentNames:["raster"]});V.set("ExtractBand",{desc:"ExtractBand Function",ctor:m,rasterArgumentNames:["raster"]});V.set("Curvature",{desc:"Curvature Function",ctor:h,rasterArgumentNames:["raster"]});V.set("Hillshade",{desc:"Hillshade Function",ctor:k,rasterArgumentNames:["raster"]});V.set("ShadedRelief",{desc:"ShadedRelief Function",ctor:d,rasterArgumentNames:["raster"]});
V.set("Grayscale",{desc:"Grayscale Function",ctor:w,rasterArgumentNames:["raster"]});V.set("Clip",{desc:"Clip Function",ctor:Q,rasterArgumentNames:["raster"]});V.set("Local",{desc:"Local Function",ctor:r,rasterArgumentNames:["rasters"]});V.set("Mask",{desc:"Mask Function",ctor:a,rasterArgumentNames:["raster"]});V.set("NDVI",{desc:"NDVI Function",ctor:f,rasterArgumentNames:["raster"]});V.set("Remap",{desc:"Remap Function",ctor:l,rasterArgumentNames:["raster"]});V.set("Slope",{desc:"Slope Function",
ctor:b,rasterArgumentNames:["raster"]});V.set("Statistics",{desc:"Focal Statistics Function",ctor:g,rasterArgumentNames:["raster"]});V.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:z,rasterArgumentNames:["raster"]});V.set("Stretch",{desc:"Stretch Function",ctor:v,rasterArgumentNames:["raster"]});V.set("Table",{desc:"Attribute Table Function",ctor:C,rasterArgumentNames:["raster"]});p.create=function(K,S){S=S??{};K=L.clone(K);if("function"in K&&"arguments"in K&&K.arguments){const Z=
new Map;K=J(K,Z,S);Y(K);if(!K.renderingRule)throw new t("raster-function-helper","Unsupported raster function json.");K=K.renderingRule}if("rasterFunction"in K)return K=E(K),N(K,S);throw new t("raster-function-helper","unsupported raster function json.");};p.getPrimaryRasterUrls=y;p.getRasterValues=A;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./ArithmeticFunctionArguments ./BaseRasterFunction ./localUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends B{constructor(){super(...arguments);this.functionName="Arithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){var {operation:q}=this.functionArguments;if(1>q||6<q)return{success:!1,supportsGPU:!1,error:"unsupported operation"};q=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(q.pixelType);q.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(q);this.rasterInfo=
q;return{success:!0,supportsGPU:3>=q.bandCount}}_processPixels(q){({pixelBlocks:q}=q);return null==q?.[0]||null==q?.[1]?null:D.arithmetic(q,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){var {operation:q}=this.functionArguments;q=" plus minus times divide power mod".split(" ")[q];var c=this.outputPixelType??"f32";let [e,n]=M.getPixelValueRange(c);if(c=M.isIntegerPixelType(c))e-=1E-4,n+=1E-4;return{imageCount:2,operationName:q,domainRange:[e,n],isOutputRounded:c}}};p.__decorate([u.property({json:{write:!0,
name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ArithmeticFunction")],t)})},"esri/layers/support/rasterFunctions/ArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M){var Q;t=Q=class extends M{constructor(){super(...arguments);this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new Q({raster:this.raster,raster2:this.raster2,operation:this.operation})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"operation",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"raster2",void 0);p.__decorate([u.property({readOnly:!0})],t.prototype,"rasters",null);return t=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],
t)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(p,u,t,L,F,P,M){u=class extends u.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};p.__decorate([t.property({json:{write:!0}})],u.prototype,"raster",void 0);return u=
p.__decorate([M.subclass("esri.layers.support.rasterFunctions.BaseFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),function(p,u,t,L,F,P,M,Q,B){const D=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));
u=class extends u.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.rawSourceRasterInfos=null;this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var q=this.getWebGLProcessorDefinition();if(!q)return null;const c=[q];({parameters:q}=q);for(q=q.rasters||
q.raster&&[q.raster];q?.length;){c.unshift(...q);var e=[];for(var n=0;n<q.length;n++){var {parameters:h}=q[n];h=h.rasters||h.raster&&[h.raster];h?.length&&e.push(...h)}q=e}for(q=c.length-1;0<=q;q--)c[q].isNoopProcess&&c.splice(q,1);q=!1;for(e=0;e<c.length;e++)n=c[e],n.id=c.length-e-1,{rasters:n}=n.parameters,q=q||null!=n&&1<n.length;e=c.some(({name:m})=>D.has(m.toLowerCase()));({rawSourceRasterInfos:n}=this);return{functions:c,hasBranches:q,hasFocalFunction:e,isSourceSingleBand:1===n?.[0]?.bandCount}}bind(q,
c=!1,e=-1){this.id=e+1;e=this._getRasterValues();let n=!0;for(let m=0;m<e.length;m++){var h=e[m];if(null!=h&&this._isRasterFunctionValue(h)){h=h.bind(q,c,this.id+m);if(!h.success)return this._bindingResult=h;n=n&&h.supportsGPU}}if(!this.rasterInfo||c)return this.sourceRasterInfos=this._getSourceRasterInfos(q),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=n&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(q){var c=this._getRasterValues();c=0===c.length?q.pixelBlocks??q.primaryPixelBlocks:c.map(e=>this._readRasterValue(e,q));return this._processPixels({...q,pixelBlocks:c})}processInputBandIds(){var q=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<q.length)return this.rawInputBandIds=q.map(e=>e.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((e,
n)=>e!==n),q=q.filter(e=>"ExtractBand"===e.functionName),q.length&&q.forEach((e,n)=>{e.isInputBandIdsSwizzled=!0;e.swizzledBandSelection=[n,n,n]}),this.rawInputBandIds;var c=q[0];if(c){if(q=c.processInputBandIds(),c.isInputBandIdsSwizzled)return this.rawInputBandIds=q}else{q=[];({bandCount:c}=this.sourceRasterInfos[0]);for(let e=0;e<c;e++)q.push(e)}q=this._getInputBandIds(q);this.isInputBandIdsSwizzled=q.some((e,n)=>e!==n);return this.rawInputBandIds=q}getPrimaryRasters(){const q=[],c=[];this._getPrimaryRasters(this,
q,c);return{rasters:q,rasterIds:c}}getWebGLProcessorDefinition(){const q=this._getWebGLParameters(),{raster:c,rasters:e}=this.functionArguments;e&&Array.isArray(e)&&e.length?(q.rasters=e.map(n=>this._isRasterFunctionValue(n)?n.getWebGLProcessorDefinition():"number"===typeof n?{name:"Constant",parameters:{value:n},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:n},pixelType:"f32",id:-1,isNoopProcess:!1}),q.rasters.some(n=>null!=n)||(q.rasters=null)):this._isRasterFunctionValue(c)&&
(q.raster=c.getWebGLProcessorDefinition());return{name:this.functionName,parameters:q,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}getClippingGeometries(){const q=[];"Clip"===this.functionName&&q.push(this.functionArguments);const {raster:c,rasters:e}=this.functionArguments;if(e&&Array.isArray(e)&&e.length)e.forEach(n=>{this._isRasterFunctionValue(n)&&(n=n.getClippingGeometries(),q.push(...n))});else if(this._isRasterFunctionValue(c)){const n=c.getClippingGeometries();
q.push(...n)}return q}_getOutputPixelType(q){return"unknown"===this.outputPixelType?q:this.outputPixelType??q}_getWebGLParameters(){return{}}_getInputBandIds(q){return q}_removeStatsHistColormapVAT(q){q.statistics=null;q.histograms=null;q.colormap=null;q.attributeTable=null;q.multidimensionalInfo?.variables.forEach(c=>{c.statistics=void 0;c.histograms=void 0})}_getRasterValues(){const {rasterArgumentNames:q}=this;return"rasters"===q[0]?this.functionArguments.rasters??[]:q.flatMap(c=>this.functionArguments[c])}_getSourceRasterInfos(q){const c=
this._getRasterValues(),{rasterInfos:e,rasterIds:n}=q;if(0===c.length)return e;const h=c.map(w=>{if(w&&"object"===typeof w&&"bind"in w&&w.rasterInfo)return w.rasterInfo;if("string"===typeof w&&n.includes(w))return e[n.indexOf(w)];if("number"!==typeof w)return e[0]}),m=h.find(w=>w)??e[0];h.forEach((w,k)=>{void 0===w&&(h[k]=m)});return h}_getPrimaryRasterId(q){return q?.rasterId}_getPrimaryRasters(q,c=[],e=[]){for(let h=0;h<q.sourceRasters.length;h++){var n=q.sourceRasters[h];if("number"!==typeof n)if("bind"in
n)this._getPrimaryRasters(n,c,e);else{const m=this._getPrimaryRasterId(n);null==m||e.includes(m)||(this.mainPrimaryRasterId===m?(c.unshift(n),e.unshift(m)):(c.push(n),e.push(m)))}}}_isRasterFunctionValue(q){return null!=q&&"object"===typeof q&&"getWebGLProcessorDefinition"in q}_readRasterValue(q,c){var {primaryPixelBlocks:e}=c;if(null==q||"$$"===q)return q=e[0],null==q?null:q.clone();if("string"===typeof q)return q=c.primaryRasterIds.indexOf(q),-1===q?null:e[q];if("number"===typeof q){e=e[0];if(null==
e)return null;const {width:n,height:h,pixelType:m}=e;e=new Float32Array(n*h);e.fill(q);q=Array(this.sourceRasterInfos[0].bandCount).fill(e);return new Q({width:n,height:h,pixelType:m,pixels:q})}return q.process(c)}_patchRasterInfo(){const {rasterInfo:q}=this;if(q?.keyProperties){var {bandCount:c,keyProperties:e,statistics:n,histograms:h}=q,m=e.BandProperties;m&&m.length!==c&&(q.keyProperties={...e,BandProperties:void 0});n&&n.length!==c&&(q.statistics=n.length>c?n.slice(0,c):null);h&&h.length!==c&&
(q.histograms=h.length>c?h.slice(0,c):null);e.BAND_COUNT&&Number(e.BAND_COUNT)!==c&&(q.keyProperties={...e,BAND_COUNT:"string"===typeof e.BAND_COUNT?String(c):c})}}};p.__decorate([t.property({json:{write:!0}})],u.prototype,"functionName",void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"functionArguments",void 0);p.__decorate([t.property()],u.prototype,"rasterArgumentNames",void 0);p.__decorate([t.property({json:{write:!0}}),L.cast(q=>q?.toLowerCase())],u.prototype,"outputPixelType",
void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"mainPrimaryRasterId",void 0);p.__decorate([t.property()],u.prototype,"sourceRasters",void 0);p.__decorate([t.property({type:[B],json:{write:!0}})],u.prototype,"sourceRasterInfos",void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"rasterInfo",void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"readingBufferSize",void 0);p.__decorate([t.property({json:{write:!0}})],u.prototype,"id",void 0);p.__decorate([t.property()],
u.prototype,"isNoopProcess",void 0);p.__decorate([t.property()],u.prototype,"supportsGPU",null);p.__decorate([t.property()],u.prototype,"rawInputBandIds",void 0);p.__decorate([t.property()],u.prototype,"rawSourceRasterInfos",void 0);p.__decorate([t.property()],u.prototype,"isInputBandIdsSwizzled",void 0);p.__decorate([t.property()],u.prototype,"swizzledBandSelection",void 0);p.__decorate([t.property()],u.prototype,"isBranch",void 0);p.__decorate([t.property({readOnly:!0})],u.prototype,"flatWebGLFunctionChain",
null);p.__decorate([t.property()],u.prototype,"_bindingResult",void 0);return u=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],u)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c){var e;u=e=class extends u.JSONSupport{constructor(n){super(n);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var n=this.keyProperties.BandProperties,{bandCount:h}=
this;if(!n?.length||n.length<h){n=[];for(let m=1;m<=h;m++)n.push(new D({name:"band_"+m}));return n}h=n.map(m=>D.fromJSON(m));for(n=0;n<h.length;n++)h[n].name=h[n].name||"band_"+(n+1);return h}get dataType(){const n=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===n?"standard-time":n}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(n){n&&this._set("nativeExtent",n)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;
const n=this.nativeExtent;return{x:n.width/this.width,y:n.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return q.fromJSON(this.keyProperties)}clone(){return new e({attributeTable:t.clone(this.attributeTable),bandCount:this.bandCount,colormap:t.clone(this.colormap),extent:t.clone(this.extent),format:this.format,height:this.height,width:this.width,histograms:t.clone(this.histograms),keyProperties:t.clone(this.keyProperties),
multidimensionalInfo:t.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:t.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:t.clone(this.spatialReference),statistics:t.clone(this.statistics),storageInfo:t.clone(this.storageInfo),transform:t.clone(this.transform)})}};p.__decorate([L.property({json:{write:!0}})],u.prototype,"attributeTable",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"bandCount",
void 0);p.__decorate([L.property({readOnly:!0})],u.prototype,"bandInfos",null);p.__decorate([L.property({json:{write:!0}})],u.prototype,"colormap",void 0);p.__decorate([L.property({type:String,readOnly:!0})],u.prototype,"dataType",null);p.__decorate([L.property({type:Q,json:{write:!0}})],u.prototype,"extent",void 0);p.__decorate([L.property({type:Q,json:{write:!0}})],u.prototype,"nativeExtent",null);p.__decorate([L.property({json:{write:!0}})],u.prototype,"nativePixelSize",null);p.__decorate([L.property({json:{write:!0}})],
u.prototype,"format",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"height",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"width",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"hasMultidimensionalTranspose",null);p.__decorate([L.property({json:{write:!0}})],u.prototype,"histograms",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"keyProperties",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"multidimensionalInfo",
void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"noDataValue",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"pixelSize",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"pixelType",void 0);p.__decorate([L.property()],u.prototype,"isPseudoSpatialReference",void 0);p.__decorate([L.property({readOnly:!0})],u.prototype,"sensorInfo",null);p.__decorate([L.property({type:B,json:{write:!0}})],u.prototype,"spatialReference",void 0);p.__decorate([L.property({json:{write:!0}})],
u.prototype,"statistics",void 0);p.__decorate([L.property({type:c,json:{write:!0}})],u.prototype,"storageInfo",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"transform",void 0);return u=e=p.__decorate([M.subclass("esri.layers.support.RasterInfo")],u)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,u,t,L,F,P,M){function Q(D){D=Number(D);return isNaN(D)?void 0:D}var B;u=B=class extends u.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new B({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};p.__decorate([t.property({json:{name:"BandName",write:!0}})],u.prototype,"name",void 0);p.__decorate([t.property({json:{name:"WavelengthMin",read:{reader:Q},write:!0}})],u.prototype,"minWavelength",void 0);p.__decorate([t.property({json:{name:"WavelengthMax",read:{reader:Q},write:!0}})],u.prototype,"maxWavelength",void 0);p.__decorate([t.property({json:{name:"RadianceBias",read:{reader:Q},write:!0}})],u.prototype,"radianceBias",
void 0);p.__decorate([t.property({json:{name:"RadianceGain",read:{reader:Q},write:!0}})],u.prototype,"radianceGain",void 0);p.__decorate([t.property({json:{name:"ReflectanceBias",read:{reader:Q},write:!0}})],u.prototype,"reflectanceBias",void 0);p.__decorate([t.property({json:{name:"ReflectanceGain",read:{reader:Q},write:!0}})],u.prototype,"reflectanceGain",void 0);p.__decorate([t.property({json:{name:"SolarIrradiance",read:{reader:Q},write:!0}})],u.prototype,"solarIrradiance",void 0);return u=B=
p.__decorate([M.subclass("esri.layers.support.RasterBandInfo")],u)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(p,u,t,L,F,P,M,Q,B){function D(c){c=Number(c);return isNaN(c)?void 0:
c}var q;u=q=class extends u.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(c){return new Date(c)}writeAcquisitionDate(c,e){e.AcquisitionDate=c.getTime()}clone(){return new q({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};p.__decorate([t.property({json:{name:"AcquisitionDate",write:!0}})],u.prototype,"acquisitionDate",void 0);p.__decorate([M.reader("acquisitionDate")],u.prototype,"readAcquisitionDate",null);p.__decorate([B.writer("acquisitionDate")],u.prototype,"writeAcquisitionDate",null);p.__decorate([t.property({json:{name:"CloudCover",read:{reader:D},write:!0}})],u.prototype,"cloudCover",void 0);p.__decorate([t.property({json:{name:"ProductName",
write:!0}})],u.prototype,"productName",void 0);p.__decorate([t.property({json:{name:"SensorName",write:!0}})],u.prototype,"sensorName",void 0);p.__decorate([t.property({json:{name:"SensorAzimuth",read:{reader:D},write:!0}})],u.prototype,"sensorAzimuth",void 0);p.__decorate([t.property({json:{name:"SensorElevation",read:{reader:D},write:!0}})],u.prototype,"sensorElevation",void 0);p.__decorate([t.property({json:{name:"SunAzimuth",read:{reader:D},write:!0}})],u.prototype,"sunAzimuth",void 0);p.__decorate([t.property({json:{name:"SunElevation",
read:{reader:D},write:!0}})],u.prototype,"sunElevation",void 0);return u=q=p.__decorate([Q.subclass("esri.layers.support.RasterSensorInfo")],u)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(p,u,t,L){function F(ba,la=!1){var fa=ba.map(ja=>ja.mask);const na=fa.filter(ja=>null!=ja);ba=ba[0].pixels[0].length;if(0===na.length||la&&na.length!==fa.length)return(new Uint8Array(ba)).fill(255);
fa=new Uint8Array(na[0]);if(1===na.length)return fa;if(!la){for(la=1;la<na.length;la++){ba=na[la];for(var ra=0;ra<fa.length;ra++)fa[ra]&&(fa[ra]=ba[ra]?255:0)}return fa}for(la=1;la<na.length;la++)for(ba=na[la],ra=0;ra<fa.length;ra++)0===fa[ra]&&(fa[ra]=ba[ra]?255:0);return fa}function P(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]+ra[ja];return fa}function M(ba,la,fa){[ba]=ba;la=u.createEmptyBand("f32",ba.length);la.set(ba);
return la}function Q(ba,la,fa){[ba]=ba;const na=ba.length;fa=u.createEmptyBand(fa,na);for(let ra=0;ra<na;ra++)if(!la||la[ra])fa[ra]=ba[ra]*ba[ra];return fa}function B(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]-ra[ja];return fa}function D(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]*ra[ja];return fa}function q(ba,la,fa){[ba]=ba;const na=ba.length;
fa=u.createEmptyBand(fa,na);for(let ra=0;ra<na;ra++)if(!la||la[ra])fa[ra]=Math.sign(ba[ra])*Math.floor(Math.abs(ba[ra]));return fa}function c(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]/ra[ja];return fa}function e(ba,la,fa){return c(ba,la,"f32")}function n(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=Math.floor(na[ja]/ra[ja]);return fa}function h(ba,la,
fa,na){ba=ba[0];const ra=ba.length;fa=u.createEmptyBand(fa,ra);if(na===t.localTrigonometricOperation.atanh){for(na=0;na<ra;na++)if(la[na]){var ja=ba[na];1<=Math.abs(ja)?la[na]=0:fa[na]=Math.atanh(ja)}return fa}na=na===t.localTrigonometricOperation.asin?Math.asin:Math.acos;for(ja=0;ja<ra;ja++)if(la[ja]){const ua=ba[ja];1<Math.abs(ua)?la[ja]=0:fa[ja]=na(ua)}return fa}function m(ba,la,fa,na){[ba]=ba;const ra=ba.length;fa=u.createEmptyBand(fa,ra);for(let ja=0;ja<ra;ja++)if(!la||la[ja])fa[ja]=na(ba[ja]);
return fa}function w(ba,la,fa,na){const [ra,ja]=ba;ba=ra.length;fa=u.createEmptyBand(fa,ba);for(let ua=0;ua<ba;ua++)if(!la||la[ua])fa[ua]=na(ra[ua],ja[ua]);return fa}function k(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]&ra[ja];return fa}function r(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]<<ra[ja];return fa}function a(ba,la,fa){[ba]=ba;const na=
ba.length;fa=u.createEmptyBand(fa,na);for(let ra=0;ra<na;ra++)if(!la||la[ra])fa[ra]=~ba[ra];return fa}function f(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]|ra[ja];return fa}function l(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]>>ra[ja];return fa}function d(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||
la[ja])fa[ja]=na[ja]^ra[ja];return fa}function b(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]&&ra[ja]?1:0;return fa}function g(ba,la,fa){[ba]=ba;const na=ba.length;fa=u.createEmptyBand(fa,na);for(let ra=0;ra<na;ra++)if(!la||la[ra])fa[ra]=ba[ra]?0:1;return fa}function z(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]||ra[ja]?1:0;return fa}function v(ba,
la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=(na[ja]?1:0)^(ra[ja]?1:0);return fa}function C(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]===ra[ja]?1:0;return fa}function y(ba,la,fa,na){[ba]=ba;const ra=ba.length;fa=u.createEmptyBand(fa,ra);const ja=na===Math.E;for(let ua=0;ua<ra;ua++)if(!la||la[ua])fa[ua]=ja?Math.exp(ba[ua]):na**ba[ua];return fa}function A(ba,
la,fa){return y(ba,la,fa,10)}function x(ba,la,fa){return y(ba,la,fa,2)}function E(ba,la,fa){return y(ba,la,fa,Math.E)}function N(ba,la,fa,na){[ba]=ba;const ra=ba.length;fa=u.createEmptyBand(fa,ra);for(let ja=0;ja<ra;ja++)if(!la||la[ja])0>=ba[ja]?la[ja]=0:fa[ja]=na(ba[ja]);return fa}function G(ba,la,fa){return N(ba,la,fa,Math.log10)}function O(ba,la,fa){return N(ba,la,fa,Math.log2)}function H(ba,la,fa){return N(ba,la,fa,Math.log)}function J(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,
ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]>ra[ja]?1:0;return fa}function R(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]>=ra[ja]?1:0;return fa}function Y(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]<ra[ja]?1:0;return fa}function T(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=
na[ja]<=ra[ja]?1:0;return fa}function X(ba,la,fa){[ba]=ba;ba=ba.length;fa=u.createEmptyBand(fa,ba);if(!la)return fa;for(let na=0;na<ba;na++)fa[na]=la[na]?0:1;return fa}function V(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]%ra[ja];return fa}function K(ba,la,fa){[ba]=ba;const na=ba.length;fa=u.createEmptyBand(fa,na);for(let ra=0;ra<na;ra++)if(!la||la[ra])fa[ra]=-ba[ra];return fa}function S(ba,la,fa){const [na,ra]=ba;ba=na.length;
fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]===ra[ja]?0:1;return fa}function Z(ba,la,fa){const [na,ra]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);const ja=new Uint8Array(ba);for(let ua=0;ua<ba;ua++)null!=la&&!la[ua]||0!==na[ua]||(fa[ua]=ra[ua],ja[ua]=255);return{band:fa,mask:ja}}function ca(ba,la,fa){const [na,ra,ja]=ba;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ua=0;ua<ba;ua++)if(!la||la[ua])fa[ua]=na[ua]?ra[ua]:ja[ua];return fa}function I(ba,la,fa){const na=
ba.length;if(2>na)return ba[0];const [ra]=ba,ja=ra.length;fa=u.createEmptyBand(fa,ja);for(let ua=0;ua<ja;ua++)if(!la||la[ua]){let xa=ra[ua];for(let ya=1;ya<na;ya++){const za=ba[ya][ua];xa<za&&(xa=za)}fa[ua]=xa}return fa}function U(ba,la,fa){const na=ba.length;if(2>na)return ba[0];const [ra]=ba,ja=ra.length;fa=u.createEmptyBand(fa,ja);for(let ua=0;ua<ja;ua++)if(!la||la[ua]){let xa=ra[ua];for(let ya=1;ya<na;ya++){const za=ba[ya][ua];xa>za&&(xa=za)}fa[ua]=xa}return fa}function W(ba,la,fa){const na=ba.length;
if(2>na)return ba[0];const [ra]=ba,ja=ra.length;fa=u.createEmptyBand(fa,ja);for(let ua=0;ua<ja;ua++)if(!la||la[ua]){let xa=ra[ua],ya=xa;for(let za=1;za<na;za++){const Ba=ba[za][ua];ya<Ba?ya=Ba:xa>Ba&&(xa=Ba)}fa[ua]=ya-xa}return fa}function aa(ba,la,fa){const na=ba.length;if(2>na)return ba[0];var [ra]=ba;ra=ra.length;fa=u.createEmptyBand(fa,ra);for(let ja=0;ja<ra;ja++)if(!la||la[ja]){let ua=0;for(let xa=0;xa<na;xa++)ua+=ba[xa][ja];fa[ja]=ua/na}return fa}function da(ba,la,fa){const na=ba.length;if(2>
na)return ba[0];var [ra]=ba;ra=ra.length;fa=u.createEmptyBand(fa,ra);for(let ja=0;ja<ra;ja++)if(!la||la[ja])for(let ua=0;ua<na;ua++)fa[ja]+=ba[ua][ja];return fa}function ea(ba,la,fa){const na=ba.length;if(2>na)return ba[0];var [ra]=ba;ra=ra.length;fa=u.createEmptyBand(fa,ra);for(let xa=0;xa<ra;xa++)if(!la||la[xa]){const ya=new Float32Array(na);let za=0;for(var ja=0;ja<na;ja++){var ua=ba[ja];za+=ua[xa];ya[ja]=ua[xa]}za/=na;ja=0;for(ua=0;ua<na;ua++)ja+=(ya[ua]-za)**2;fa[xa]=Math.sqrt(ja/na)}return fa}
function ha(ba,la,fa){const na=ba.length;if(2>na)return ba[0];const ra=Math.floor(na/2);var [ja]=ba;ja=ja.length;fa=u.createEmptyBand(fa,ja);const ua=new Float32Array(na),xa=1===na%2;for(let ya=0;ya<ja;ya++)if(!la||la[ya]){for(let za=0;za<na;za++)ua[za]=ba[za][ya];ua.sort();fa[ya]=xa?ua[ra]:(ua[ra]+ua[ra-1])/2}return fa}function ia(ba,la,fa){const [na,ra]=ba;if(null==ra)return na;ba=na.length;fa=u.createEmptyBand(fa,ba);for(let ja=0;ja<ba;ja++)if(!la||la[ja])fa[ja]=na[ja]<ra[ja]?na[ja]:ra[ja];return fa}
function ka(ba,la,fa){const na=ba.length;if(2>=na)return ia(ba,la,fa);const ra=ba[0].length;fa=u.createEmptyBand(fa,ra);const ja=new Map;for(let ya=0;ya<ra;ya++)if(!la||la[ya]){ja.clear();for(var ua=0;ua<na;ua++){var xa=ba[ua][ya];ja.set(xa,ja.has(xa)?ja.get(xa)+1:1)}xa=ua=0;const za=[];for(const Ba of ja.keys())ua=ja.get(Ba),ua>xa?(xa=ua,za.length=0,za.push(Ba)):ua===xa&&za.push(Ba);1<za.length&&za.sort((Ba,Ca)=>Ba-Ca);fa[ya]=za[0]}return fa}function ma(ba,la,fa){const na=ba.length;if(2>=na)return ia(ba,
la,fa);const ra=ba[0].length;fa=u.createEmptyBand(fa,ra);const ja=new Map;for(let ya=0;ya<ra;ya++)if(!la||la[ya]){ja.clear();for(var ua=0;ua<na;ua++){var xa=ba[ua][ya];ja.set(xa,ja.has(xa)?ja.get(xa)+1:1)}ua=0;xa=ba.length;const za=[];for(const Ba of ja.keys())ua=ja.get(Ba),ua<xa?(xa=ua,za.length=0,za.push(Ba)):ua===xa&&za.push(Ba);1<za.length&&za.sort((Ba,Ca)=>Ba-Ca);fa[ya]=za[0]}return fa}function pa(ba,la,fa){const na=ba.length;if(2>na)return ba[0];var [ra]=ba;ra=ra.length;fa=u.createEmptyBand(fa,
ra);const ja=new Set;for(let ua=0;ua<ra;ua++)if(!la||la[ua]){ja.clear();let xa;for(let ya=0;ya<na;ya++)xa=ba[ya][ua],ja.add(xa);fa[ua]=ja.size}return fa}function oa(ba,la,fa={}){qa.size||(qa.set(4,Math.sqrt),qa.set(6,Math.acos),qa.set(7,Math.asin),qa.set(8,Math.atan),qa.set(9,Math.atanh),qa.set(10,Math.abs),qa.set(21,Math.cos),qa.set(22,Math.cosh),qa.set(48,Math.floor),qa.set(49,Math.ceil),qa.set(51,Math.sin),qa.set(52,Math.sinh),qa.set(56,Math.tan),qa.set(57,Math.tanh),qa.set(59,Math.acosh),qa.set(60,
Math.asinh),qa.set(65,Math.floor),va.set(5,Math.pow),va.set(61,Math.atan2),ta.set(1,P),ta.set(2,B),ta.set(3,D),ta.set(11,k),ta.set(12,r),ta.set(13,a),ta.set(14,f),ta.set(15,l),ta.set(16,d),ta.set(17,b),ta.set(18,g),ta.set(19,z),ta.set(20,v),ta.set(23,c),ta.set(24,C),ta.set(25,E),ta.set(26,A),ta.set(27,x),ta.set(28,J),ta.set(29,R),ta.set(30,q),ta.set(31,X),ta.set(32,M),ta.set(33,Y),ta.set(34,T),ta.set(35,H),ta.set(36,G),ta.set(37,O),ta.set(44,V),ta.set(45,K),ta.set(46,S),ta.set(53,Q),ta.set(64,e),
ta.set(65,n),ta.set(76,ca),ta.set(78,ca),wa.set(38,ka),wa.set(39,I),wa.set(40,aa),wa.set(41,ha),wa.set(42,U),wa.set(43,ma),wa.set(47,W),wa.set(54,ea),wa.set(55,da),wa.set(58,pa),wa.set(66,ka),wa.set(67,I),wa.set(68,aa),wa.set(69,ha),wa.set(70,U),wa.set(71,ma),wa.set(72,W),wa.set(73,ea),wa.set(74,da),wa.set(75,pa));var na=F(ba,66<=la&&75>=la);const {outputPixelType:ra="f32"}=fa,ja=!wa.has(la)||fa.processAsMultiband,ua=ja?ba[0].pixels.length:1;fa=[];for(let za=0;za<ua;za++){var xa=wa.has(la)&&!ja?ba.flatMap(Ba=>
Ba.pixels):ba.map(Ba=>Ba.pixels[za]),ya=!0;la===t.localConditionalOperation.setNull?(na=Z(xa,na,ra),xa=na.band,na=na.mask,ya=!1):ta.has(la)?xa=ta.get(la)(xa,na,"f64"):qa.has(la)?xa=la===t.localTrigonometricOperation.asin||la===t.localTrigonometricOperation.acos||la===t.localTrigonometricOperation.atanh?h(xa,na,"f64",la):m(xa,na,"f64",qa.get(la)):va.has(la)?xa=w(xa,na,"f64",va.get(la)):wa.has(la)?xa=wa.get(la)(xa,na,"f64"):(xa=xa[0],ya=!1);ya&&la!==t.localLogicalOperation.isNull&&!sa.has(la)&&(ya=
u.createEmptyBand(ra,xa.length),na||=(new Uint8Array(xa.length)).fill(255),L.fixNaN(xa,na),L.clipBandToPixelTypeRange(xa,na,ra,ya),xa=ya);fa.push(xa)}ba=ba[0];return new u({width:ba.width,height:ba.height,pixelType:ra,mask:la===t.localLogicalOperation.isNull?null:na,pixels:fa})}const sa=new Map([[t.localTrigonometricOperation.acos,{domain:[0,Math.PI],isInteger:!1}],[t.localTrigonometricOperation.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[t.localTrigonometricOperation.atan,{domain:[-Math.PI/
2,Math.PI/2],isInteger:!1}],[t.localTrigonometricOperation.cos,{domain:[-1,1],isInteger:!1}],[t.localTrigonometricOperation.sin,{domain:[-1,1],isInteger:!1}],[t.localLogicalOperation.booleanAnd,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.booleanNot,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.booleanOr,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.booleanXOr,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.equalTo,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.notEqual,
{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.greaterThan,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.greaterThanEqual,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.lessThan,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.lessThanEqual,{domain:[0,1],isInteger:!0}],[t.localLogicalOperation.isNull,{domain:[0,1],isInteger:!0}]]),qa=new Map,va=new Map,ta=new Map,wa=new Map;p.arithmetic=function(ba,la,fa){la=[null,1,2,3,23,5,44][la]??1;return oa(ba,la,{outputPixelType:fa})};
p.getOutputDomain=function(ba){return sa.get(ba)};p.local=oa;p.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(p){const u={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,
exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},t={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},L={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},F={majority:38,
max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},P={setNull:50,conditional:78},M={...u,...t,...L,...F,...P};p.arithmeticOperation={plus:1,minus:2,multiply:3,divide:4,power:5,mod:6};p.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,
Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};p.cellStatisticalOperation=F;p.clippingType={outside:1,inside:2};p.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",
brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",
greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",
slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};p.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",
gray:"Gray",hillshade:"Hillshade"};p.computeChangeMethod={difference:0,relativeDifference:1,categorical:2,spectralEuclidianDistance:3,spectralAngleDifference:4,bandWithMostChange:5};p.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,
laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};p.curvatureType={standard:0,planform:1,profile:2};p.hillshadeType={traditional:0,multidirectional:1};p.localArithmeticOperation=u;p.localConditionalOperation=P;p.localLogicalOperation=t;p.localOperators=M;p.localTrigonometricOperation=L;p.missingBandAction={bestMatch:0,fail:1};p.noDataInterpretation={matchAny:0,matchAll:1};p.slopeType={degree:1,percentRise:2,adjusted:3};p.statisticsType=
{min:1,max:2,mean:3,standardDeviation:4,median:5,majority:6,minority:7};p.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){t=class extends Q{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var D=this.sourceRasterInfos[0];this.isGCS=D.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");D=D.clone();D.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(D);D.statistics=[{min:-1,max:360,avg:180,stddev:30}];D.bandCount=1;this.rasterInfo=D;
return{success:!0,supportsGPU:!0}}_processPixels(D){const q=D.pixelBlocks?.[0];if(null==q)return null;const {extent:c,primaryPixelSizes:e}=D;D=e?.[0];return B.aspect(q,{resolution:null==D?c?{x:c.width/q.width,y:c.height/q.height}:{x:1,y:1}:D})}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:M,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,
"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isGCS",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.AspectFunction")],t)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,u,t,L,F,P,M){var Q;
u=Q=class extends M{clone(){return new Q({raster:this.raster})}};return u=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","../SimpleBandStatistics","./pixelUtils"],function(p,u,t,L){function F(B){let {altitude:D,azimuth:q}=B;const {hillshadeType:c,pixelSizePower:e=1,pixelSizeFactor:n=1,scalingType:h,isGCS:m,resolution:w}=B;var k="multi-directional"===c?2*
B.zFactor:B.zFactor;const {x:r,y:a}=w;B=k/(8*r);var f=k/(8*a);m&&.001<k&&(B/=Q,f/=Q);"adjusted"===h&&(m?(B=r*Q,f=a*Q,B=(k+B**e*n)/(8*B),f=(k+f**e*n)/(8*f)):(B=(k+r**e*n)/(8*r),f=(k+a**e*n)/(8*a)));var l=(90-D)*Math.PI/180;k=Math.cos(l);let d=(360-q+90)*Math.PI/180,b=Math.sin(l)*Math.cos(d);l=Math.sin(l)*Math.sin(d);const g=[315,270,225,360,180,0],z=[60,60,60,60,60,90];var v=new Float32Array([3,5,3,2,1,4]);const C=v.reduce((N,G)=>N+G);v=v.map(N=>N/C);const y="multi-directional"===c?g.length:1,A=new Float32Array(6),
x=new Float32Array(6),E=new Float32Array(6);if("multi-directional"===c)for(let N=0;N<y;N++)D=z[N],q=g[N],l=(90-D)*Math.PI/180,k=Math.cos(l),d=(360-q+90)*Math.PI/180,b=Math.sin(l)*Math.cos(d),l=Math.sin(l)*Math.sin(d),A[N]=k,x[N]=b,E[N]=l;else A.fill(k),x.fill(b),E.fill(l);return{resolution:w,factor:[B,f],sinZcosA:b,sinZsinA:l,cosZ:k,sinZcosAs:x,sinZsinAs:E,cosZs:A,weights:v,hillshadeType:["traditional","multi-directional"].indexOf(c)}}function P(B,D){const {width:q,height:c}=B;var e=q*c;const n=new Uint8Array(e),
h=null!=B.mask;let m;if(h){m=new Uint8Array(B.mask);for(var w=0;w<m.length;w++)m[w]&&(n[w]=1,m[w]=1)}B=B.pixels[0];w=new Float32Array(e);const k=new Float32Array(e);let r=0;if(D){({resolution:a}=D);var a=a?(a.x+a.y)/2:1;r=200*D.zFactor/(a*a);a=new Float32Array(e)}D=D?.curvatureType;let f;let l;for(e=1;e<c-1;e++){const A=e*q;for(let x=1;x<q-1;x++){const E=A+x;if(!m||0!==m[E]){if(m){if(7>m[E-q-1]+m[E-q]+m[E-q+1]+m[E-1]+m[E+1]+m[E+q-1]+m[E+q]+m[E+q+1]){n[E]=0;continue}var d=m[E-q-1]?B[E-q-1]:B[E];var b=
m[E-q]?B[E-q]:B[E];var g=m[E-q+1]?B[E-q+1]:B[E];var z=m[E-1]?B[E-1]:B[E];var v=m[E+1]?B[E+1]:B[E];f=m[E+q-1]?B[E+q-1]:B[E];var C=m[E+q]?B[E+q]:B[E];l=m[E+q+1]?B[E+q+1]:B[E]}else d=B[E-q-1],b=B[E-q],g=B[E-q+1],z=B[E-1],v=B[E+1],f=B[E+q-1],C=B[E+q],l=B[E+q+1];w[E]=g+v+v+l-(d+z+z+f);k[E]=f+C+C+l-(d+b+b+g);if(null!=a){var y=B[E];const N=.5*(z+v)-y;y=.5*(b+C)-y;"standard"===D?a[E]=-r*(N+y):(d=(-d+g+f-l)/4,z=(-z+v)/2,b=(b-C)/2,C=z*z,v=b*b,(g=C+v)&&(a[E]="profile"===D?r*(N*C+y*v+d*z*b)/g:-r*(N*v+y*C-d*z*
b)/g))}}}}return{outMask:h?n:null,dzxs:w,dzys:k,curvatures:a}}function M(B,D,q){for(var c=0;c<q;c++)B[c*D]=B[c*D+1],B[(c+1)*D-1]=B[(c+1)*D-2];for(c=1;c<D-1;c++)B[c]=B[c+D],B[c+(q-1)*D]=B[c+(q-2)*D]}const Q=1/111E3;p.aspect=function(B,D={}){if(!L.isValidPixelBlock(B))return B;var {resolution:q}=D;D=q?1/q.x:1;q=q?1/q.y:1;const {dzxs:c,dzys:e,outMask:n}=P(B),{width:h,height:m}=B,w=new Float32Array(h*m);for(let r=1;r<m-1;r++){const a=r*h;for(let f=1;f<h-1;f++){var k=a+f;if(!n||n[k]){const l=c[k]*D;k=
e[k]*q;let d=-1;if(0!==l||0!==k)d=90-57.29578*Math.atan2(k,-l),0>d&&(d+=360),360===d?d=0:360<d&&(d%=360);w[a+f]=d}}}M(w,h,m);return new u({width:h,height:m,pixels:[w],mask:n,pixelType:"f32",validPixelCount:B.validPixelCount,statistics:[new t.SimpleBandStatistics(-1,360)]})};p.calculateHillshadeParams=F;p.curvature=function(B,D){if(!L.isValidPixelBlock(B))return B;const {curvatures:q,outMask:c}=P(B,D),{width:e,height:n}=B;M(q,e,n);B=new u({width:e,height:n,pixels:[q],mask:c,pixelType:"f32",validPixelCount:B.validPixelCount});
B.updateStatistics();return B};p.gcsFactor=Q;p.getHillshadeOptions=function(B,D,q){const {hillshadeType:c,altitude:e,azimuth:n,zFactor:h,pixelSizeFactor:m,pixelSizePower:w,slopeType:k}=B;return{hillshadeType:c,altitude:e,azimuth:n,zFactor:h,pixelSizePower:w,pixelSizeFactor:m,scalingType:"scaled"===k?"adjusted":"none",resolution:D,isGCS:q}};p.hillshade=function(B,D){if(!L.isValidPixelBlock(B))return B;const {factor:q,sinZcosA:c,sinZsinA:e,cosZ:n,sinZcosAs:h,sinZsinAs:m,cosZs:w,weights:k}=F(D),[r,a]=
q;D="traditional"===D.hillshadeType;const {width:f,height:l}=B,d=new Uint8Array(f*l),{dzxs:b,dzys:g,outMask:z}=P(B);for(let C=1;C<l-1;C++){const y=C*f;for(let A=1;A<f-1;A++){const x=y+A;if(!z||z[x]){var v=b[x]*r;const E=g[x]*a,N=Math.sqrt(1+v*v+E*E);let G=0;if(D)v=255*(n+e*E-c*v)/N,0>v&&(v=0),G=v;else{const O=m.length;for(let H=0;H<O;H++){let J=255*(w[H]+m[H]*E-h[H]*v)/N;0>J&&(J=0);G+=J*k[H]}}d[x]=G&255}}}M(d,f,l);return new u({width:f,height:l,pixels:[d],mask:z,pixelType:"u8",validPixelCount:B.validPixelCount,
statistics:[new t.SimpleBandStatistics(0,255)]})};p.slope=function(B,D){if(!L.isValidPixelBlock(B))return B;var q=D.zFactor,c=D.pixelSizePower??1,e=D.pixelSizeFactor??1;const n=D.slopeType;var h=D.isGCS;const {x:m,y:w}=D.resolution;D=q/(8*m);let k=q/(8*w);h&&1E-4>Math.abs(q-1)&&(D/=Q,k/=Q);"adjusted"===n&&(D=(q+m**c*e)/(8*m),k=(q+w**c*e)/(8*w));const {dzxs:r,dzys:a,outMask:f}=P(B),{width:l,height:d}=B;q=new Float32Array(l*d);for(c=1;c<d-1;c++)for(e=c*l,h=1;h<l-1;h++){var b=e+h;if(!f||f[b]){var g=
r[b]*D;b=a[b]*k;g=Math.sqrt(g*g+b*b);q[e+h]="percent-rise"===n?100*g:57.2957795*Math.atan(g)}}M(q,l,d);B=new u({width:l,height:d,pixels:[q],mask:f,pixelType:"f32",validPixelCount:B.validPixelCount});B.updateStatistics();return B};p.tintHillshade=function(B,D,q,c){if(L.isValidPixelBlock(B)&&L.isValidPixelBlock(D)){var {min:e,max:n}=c;c=B.pixels[0];var {pixels:h,mask:m}=D;D=h[0];var w=255.00001/(n-e),k=new Uint8ClampedArray(D.length),r=new Uint8ClampedArray(D.length),a=new Uint8ClampedArray(D.length),
f=q.length-1;for(let b=0;b<D.length;b++){if(m&&0===m[b])continue;var l=Math.floor((D[b]-e)*w);const [g,z]=q[0>l?0:l>f?f:l];var d=c[b];l=d*z;const v=l*(1-Math.abs(g%2-1));d-=l;switch(Math.floor(g)){case 0:k[b]=l+d;r[b]=v+d;a[b]=d;break;case 1:k[b]=v+d;r[b]=l+d;a[b]=d;break;case 2:k[b]=d;r[b]=l+d;a[b]=v+d;break;case 3:k[b]=d;r[b]=v+d;a[b]=l+d;break;case 4:k[b]=v+d;r[b]=d;a[b]=l+d;break;case 5:case 6:k[b]=l+d,r[b]=d,a[b]=v+d}}B.pixels=[k,r,a];B.updateStatistics()}};Object.defineProperty(p,Symbol.toStringTag,
{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),function(p,u,t,L,F,P,M,Q,B,D){const q=new Set(["vari","mtvi2","rtvi-core","evi"]);t=class extends D{constructor(){super(...arguments);
this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var c=this.sourceRasterInfos[0];if(2>c.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};c=c.clone();c.pixelType=this.outputPixelType;c.bandCount="sultan"===this.functionArguments.method?3:1;this._removeStatsHistColormapVAT(c);c.keyProperties={...c.keyProperties,
BandProperties:void 0};this.rasterInfo=c;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return c;const {method:e,bandIndexes:n}=this.functionArguments,h=n.split(" ").map(m=>parseFloat(m));return B.calculateBandIndex(c,{method:e,bandIndexes:h,equation:n,outputPixelType:this.outputPixelType})}_getWebGLParameters(){var c=this.functionArguments.bandIndexes.split(" ").map(m=>parseFloat(m)-1);2===c.length&&
c.push(0);var e=this.isInputBandIdsSwizzled?[0,1,2]:c;const n=new Float32Array(3);({method:h}=this.functionArguments);switch(h){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":e=B.getBandMatrix3([e[0],e[1],0]);var h="ndxi";break;case "ndwi":e=B.getBandMatrix3([e[1],e[0],0]);h="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":e=B.getBandMatrix3([e[0],e[1],0]);h="sr";break;case "ci-g":case "ci-re":e=
B.getBandMatrix3([e[0],e[1],0]);h="ci";break;case "savi":e=B.getBandMatrix3([e[0],e[1],0]);h="savi";n[0]=c[2]+1;break;case "tsavi":e=B.getBandMatrix3([e[0],e[1],0]);h="tsavi";n[0]=c[2]+1;n[1]=c[3]+1;n[2]=c[4]+1;break;case "msavi":e=B.getBandMatrix3([e[0],e[1],0]);h="msavi";break;case "gemi":e=B.getBandMatrix3([e[0],e[1],0]);h="gemi";break;case "pvi":e=B.getBandMatrix3([e[0],e[1],0]);h="tsavi";n[0]=c[2]+1;n[1]=c[3]+1;break;case "vari":e=B.getBandMatrix3([e[0],e[1],e[2]]);h="vari";break;case "mtvi2":e=
B.getBandMatrix3([e[0],e[1],e[2]]);h="mtvi";break;case "rtvi-core":e=B.getBandMatrix3([e[0],e[1],e[2]]);h="rtvicore";break;case "evi":e=B.getBandMatrix3([e[0],e[1],e[2]]);h="evi";break;case "wndwi":e=B.getBandMatrix3([e[0],e[1],0]);h="wndwi";n[0]=c[3]?c[3]+1:.5;break;case "bai":e=B.getBandMatrix3([e[1],e[0],0]);h="bai";break;default:e=B.getBandMatrix3([0,1,2]),h="custom"}c=M.isIntegerPixelType(this.outputPixelType);return{bandIndexMat3:e,indexType:h,adjustments:n,isOutputRounded:c}}_getInputBandIds(c){if("custom"===
this.functionArguments.method)return c;var e=this.functionArguments.bandIndexes.split(" ").map(m=>parseFloat(m)-1);const n=c.length;e=e.map(m=>m>=n?n-1:m);const h=q.has(this.functionArguments.method)?3:2;e=e.slice(0,h).map(m=>c[m]);2===e.length&&e.push(0);return e}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],
t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],t)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;L=D=class extends B{constructor(){super(...arguments);this.method="custom"}clone(){return new D({method:this.method,bandIndexes:this.bandIndexes,raster:u.clone(this.raster)})}};p.__decorate([t.property({json:{type:String,write:!0}})],L.prototype,"bandIndexes",void 0);p.__decorate([P.enumeration(Q.bandIndexMethodMap)],L.prototype,"method",void 0);return L=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define("exports ../../../core/jsonMap ../PixelBlock ../rasterFormats/pixelRangeUtils ./customBandIndexUtils ./pixelUtils".split(" "),
function(p,u,t,L,F,P){function M(d,b,g){const z=g.length,v=new Float32Array(z);for(let C=0;C<z;C++)if(null==d||d[C]){const y=b[C],A=g[C],x=y+A;x&&(v[C]=(y-A)/x)}return[v]}function Q(d,b,g){const z=g.length,v=new Float32Array(z);for(let C=0;C<z;C++)if(null==d||d[C]){const y=b[C],A=g[C];A&&(v[C]=y/A)}return[v]}function B(d,b,g){const z=b.length,v=new Float32Array(z);for(let C=0;C<z;C++)if(null==d||d[C]){const y=b[C],A=g[C];A&&(v[C]=y/A-1)}return[v]}function D(d,b,g,z){const v=g.length,C=new Float32Array(v);
for(let y=0;y<v;y++)if(null==d||d[y]){const A=g[y],x=b[y],E=x+A+z;E&&(C[y]=(x-A)/E*(1+z))}return[C]}function q(d,b,g,z,v,C){const y=g.length,A=new Float32Array(y);C=-v*z+C*(1+z*z);for(let x=0;x<y;x++)if(null==d||d[x]){const E=g[x],N=b[x],G=v*N+E+C;G&&(A[x]=z*(N-z*E-v)/G)}return[A]}function c(d,b,g){const z=g.length,v=new Float32Array(z);for(let C=0;C<z;C++)if(null==d||d[C]){const y=b[C],A=2*y+1;v[C]=.5*(A-Math.sqrt(A*A-8*(y-g[C])))}return[v]}function e(d,b,g){const z=g.length,v=new Float32Array(z);
for(let y=0;y<z;y++)if(null==d||d[y]){const A=g[y];var C=b[y];1!==A&&0!==C+A+.5&&(C=(2*(C*C-A*A)+1.5*C+.5*A)/(C+A+.5),v[y]=C*(1-.25*C)-(A-.125)/(1-A))}return[v]}function n(d,b,g,z,v){const C=g.length,y=new Float32Array(C),A=1/Math.sqrt(1+z*z);for(let x=0;x<C;x++)if(null==d||d[x])y[x]=(b[x]-z*g[x]-v)*A;return[y]}function h(d,b){const [g,z,v,C,y,A]=b;b=g.length;const x=new Float32Array(b);for(let E=0;E<b;E++)if(null==d||d[E])x[E]=-.2848*g[E]-.2435*z[E]-.5436*v[E]+.7243*C[E]+.084*y[E]-.18*A[E];return[x]}
function m(d,b){const [g,z,v,C,y]=b;b=g.length;const A=new Float32Array(b),x=new Float32Array(b),E=new Float32Array(b);for(let N=0;N<b;N++)if(null==d||d[N])A[N]=y[N]?C[N]/y[N]*100:0,x[N]=g[N]?C[N]/g[N]*100:0,E[N]=v[N]?z[N]/v[N]*(C[N]/v[N])*100:0;return[A,x,E]}function w(d,b){const [g,z,v]=b;b=g.length;const C=new Float32Array(b);for(let y=0;y<b;y++)if(null==d||d[y])for(y=0;y<b;y++){const A=g[y],x=z[y],E=x+A-v[y];E&&(C[y]=(x-A)/E)}return[C]}function k(d,b){const [g,z,v]=b;b=g.length;const C=new Float32Array(b);
for(let y=0;y<b;y++)if(null==d||d[y])for(y=0;y<b;y++){const A=g[y],x=z[y],E=v[y],N=Math.sqrt((2*A+1)**2-(6*A-5*Math.sqrt(x))-.5);N&&(C[y]=1.5*(1.2*(A-E)-2.5*(x-E))/N)}return[C]}function r(d,b){const [g,z,v]=b;b=g.length;const C=new Float32Array(b);for(let y=0;y<b;y++)if(null==d||d[y])for(y=0;y<b;y++){const A=g[y];C[y]=100*(A-z[y])-10*(A-v[y])}return[C]}function a(d,b){const [g,z,v]=b;b=g.length;const C=new Float32Array(b);for(let y=0;y<b;y++)if(null==d||d[y])for(y=0;y<b;y++){const A=g[y],x=z[y],E=
A+6*x-7.5*v[y]+1;E&&(C[y]=2.5*(A-x)/E)}return[C]}function f(d,b,g=.5){const [z,v,C]=b;b=v.length;const y=new Float32Array(b);for(let A=0;A<b;A++)if(null==d||d[A])for(A=0;A<b;A++){const x=z[A],E=v[A],N=C[A],G=x+g*E+(1-g)*N;G&&(y[A]=(x-g*E-(1-g)*N)/G)}return[y]}function l(d,b,g){const z=g.length,v=new Float32Array(z);for(let C=0;C<z;C++)if(null==d||d[C])for(C=0;C<z;C++){const y=(.1-b[C])**2+(.06-g[C])**2;y&&(v[C]=1/y)}return[v]}u=new u.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",
6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});p.bandIndexMethodMap=u;p.calculateBandIndex=function(d,b){if(!P.isValidPixelBlock(d))return d;const {equation:g,method:z}=b;var v=b.bandIndexes.map(E=>E-1);const {pixels:C,mask:y}=d;switch(z){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":v=
M(y,C[v[0]],C[v[1]]);break;case "ndwi":v=M(y,C[v[1]],C[v[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":v=Q(y,C[v[0]],C[v[1]]);break;case "ci-g":case "ci-re":v=B(y,C[v[0]],C[v[1]]);break;case "savi":v=D(y,C[v[0]],C[v[1]],v[2]+1);break;case "tsavi":v=q(y,C[v[0]],C[v[1]],v[2]+1,v[3]+1,v[4]+1);break;case "msavi":v=c(y,C[v[0]],C[v[1]]);break;case "gemi":v=e(y,C[v[0]],C[v[1]]);break;case "pvi":v=n(y,C[v[0]],C[v[1]],v[2]+1,v[3]+1);break;case "gvitm":v=h(y,
[C[v[0]],C[v[1]],C[v[2]],C[v[3]],C[v[4]],C[v[5]]]);break;case "sultan":v=m(y,[C[v[0]],C[v[1]],C[v[2]],C[v[3]],C[v[4]]]);break;case "vari":v=w(y,[C[v[0]],C[v[1]],C[v[2]]]);break;case "mtvi2":v=k(y,[C[v[0]],C[v[1]],C[v[2]]]);break;case "rtvi-core":v=r(y,[C[v[0]],C[v[1]],C[v[2]]]);break;case "evi":v=a(y,[C[v[0]],C[v[1]],C[v[2]]]);break;case "wndwi":v=f(y,[C[v[0]],C[v[1]],C[v[2]]],v[3]?v[3]+1:.5);break;case "bai":v=l(y,C[v[0]],C[v[1]]);break;case "custom":v=F.calculateCustomBandIndex(y,C,g);break;default:return d}const {outputPixelType:A=
"f32"}=b;b=null!=A&&L.isIntegerPixelType(A);let x;y?(x=new Uint8Array(d.width*d.height),x.set(y)):b&&(x=(new Uint8Array(d.width*d.height)).fill(255));b&&(v=v.map(E=>{const N=t.createEmptyBand(A,E.length);L.clipBandToPixelTypeRange(E,x,A,N);return N}));d=new t({width:d.width,height:d.height,pixelType:A,pixels:v,mask:x});d.updateStatistics();return d};p.calculateNDVI=function(d,b,g,z){const {mask:v,pixels:C,width:y,height:A}=d;d=C[g];b=C[b];g=b.length;const x=z?new Uint8Array(g):new Float32Array(g),
E=z?100:1,N=z?100.5:0;for(let G=0;G<g;G++)if(null==v||v[G]){const O=d[G],H=b[G],J=O+H;J&&(x[G]=(O-H)/J*E+N)}z=new t({width:y,height:A,mask:v,pixelType:z?"u8":"f32",pixels:[x]});z.updateStatistics();return z};p.getBandMatrix3=function(d){const b=new Float32Array(9);b[3*d[0]]=1;b[3*d[1]+1]=1;b[3*d[2]+2]=1;return b};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports","../../../core/has"],function(p,u){function t(F,
P){return F.toLowerCase().startsWith("b")?P[parseInt(F.slice(1),10)-1]:parseFloat(F)}const L=new Set("+-*/()".split(""));p.calculateCustomBandIndex=function(F,P,M){M=M.replaceAll(" ","");M.startsWith("-")&&(M="0"+M);M.startsWith("+")&&(M=M.slice(1));M=M.split("");var Q=[],B=[],D="";for(var q=0;q<M.length;q++){const h=M[q];L.has(h)?(D.length&&B.push(t(D,P)),Q.push(h),D=""):D=D.concat(h)}D.length&&B.push(t(D,P));let {ops:c,nums:e}={ops:Q,nums:B};if(0===c.length){F=1===e.length?e[0]:P[0];if(F instanceof
Float32Array)return[F];var n=new Float32Array(P[0].length);"number"===typeof F?n.fill(F):n.set(F);return[n]}for(;0<c.length;){n=c;if(1===n.length)n={opIndex:0,numIndex:0};else{Q=M=0;for(P=0;P<n.length;P++)if("("===n[P])M=P;else if(")"===n[P]){Q=P;break}B=0===Q?n:n.slice(M+1,Q);P=-1;for(D=0;D<B.length;D++)if("*"===B[D]||"/"===B[D]){P=D;break}if(!(-1<P))for(D=0;D<B.length;D++)if("+"===B[D]||"-"===B[D]){P=D;break}0<Q&&(P+=M+1);M=0;for(Q=0;Q<P;Q++)"("===n[Q]&&M++;n={opIndex:P,numIndex:P-M}}const {numIndex:h,
opIndex:m}=n;Q=M=P=void 0;n=F;D=c[m];B=e[h];q=e[h+1];if("number"===typeof B&&"number"===typeof q)n=B+q;else{"number"===typeof B?(P=q,Q=P.length,M=new Float32Array(Q),M.fill(B)):(Q=B.length,M=B,q.constructor===Number?(P=new Float32Array(Q),P.fill(q)):P=q);B=new Float32Array(Q);switch(D){case "+":for(D=0;D<Q;D++)if(null==n||n[D])B[D]=M[D]+P[D];break;case "-":for(D=0;D<Q;D++)if(null==n||n[D])B[D]=M[D]-P[D];break;case "*":for(D=0;D<Q;D++)if(null==n||n[D])B[D]=M[D]*P[D];break;case "/":for(D=0;D<Q;D++)(null==
n||n[D])&&P[D]&&(B[D]=M[D]/P[D]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}n=B}if(1===c.length)break;else{P=c;P.splice(m,1);Q=M=0;do{Q=M=0;for(B=0;B<P.length;B++)if("("===P[B])M=B;else if(")"===P[B]){Q=B;break}Q===M+1&&P.splice(M,2)}while(Q===M+1);c=P;e.splice(h,2,n)}}return[n]};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ClipFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ClipFunctionArguments ./clipUtils ./rasterProjectionHelper".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends M{constructor(){super(...arguments);this.functionName="Clip";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){const q=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(q.pixelType);q.pixelType=this.outputPixelType;this.rasterInfo=q;var {functionArguments:c}=this;const {clippingGeometry:e,clippingType:n}=c;if(!e)return{success:!1,supportsGPU:!1,error:"missing clipping geometry"};
if("outside"===n)try{({spatialReference:c}=q);const h="extent"===e.type?D.projectExtent(e,c):D.projectPolygon(e,c).extent;h&&B.clipRasterInfo(q,h)}catch{}return{success:!0,supportsGPU:!0}}_processPixels(q){return q.pixelBlocks?.[0]}_getWebGLParameters(){const {clippingGeometry:q,clippingType:c}=this.functionArguments;return{clippingGeometry:q.toJSON(),clippingType:c}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,
json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property()],t.prototype,"isNoopProcess",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ClipFunction")],t)})},"esri/layers/support/rasterFunctions/ClipFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/jsonUtils ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){var q;t=new t.JSONMap({1:"outside",2:"inside"},{useNumericKeys:!0});D=q=class extends D{constructor(){super(...arguments);this.clippingType="outside"}clone(){return new q({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}};p.__decorate([L.property({types:u.geometryTypes,json:{read:B.fromJSON,write:!0}})],D.prototype,"clippingGeometry",void 0);p.__decorate([L.property({json:{read:t.read,write:t.write}})],D.prototype,"clippingType",void 0);
return D=q=p.__decorate([Q.subclass("esri.layers.support.rasterFunctions.ClipFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c){t=class extends Q{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var e=this.sourceRasterInfos[0];if(1<e.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:n,colormapName:h,colorRamp:m,colorRampName:w}=this.functionArguments;if(!n?.length)if(m)this.colorRamp=m,n=q.convertColorRampToColormap(m,
{interpolateAlpha:!0});else if(w){var k=q.getColorRampJSON(w);k&&(n=q.convertColorRampToColormap(k),this.colorRamp=c.fromJSON(k))}else h&&(n=D.getColormapByName(h));if(!n?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};k=this._getOutputPixelType(e.pixelType);this.outputPixelType=k.startsWith("f")?"s32":k;e=e.clone();e.pixelType=this.outputPixelType;e.colormap=n;e.bandCount=1;this.rasterInfo=e;return{success:!0,supportsGPU:!0}}_processPixels(e){e=e.pixelBlocks?.[0];
if(!e||M.isIntegerPixelType(e.pixelType))return e;e=e.clone();e.clamp(this.outputPixelType);return e}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property()],t.prototype,"isNoopProcess",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"indexedColormap",void 0);p.__decorate([u.property()],t.prototype,"colorRamp",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],t)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;M=D=class extends M{castColormapName(q){if(!q)return null;q=q.toLowerCase();return Q.rasterColormapNames.includes(q)?q:null}readColorRamp(q){return B.fromJSON(q)}readColorRampName(q,c){return q?(c=Q.colorRampDict.jsonValues.find(e=>e.toLowerCase()===q.toLowerCase()))?Q.colorRampDict.fromJSON(c):null:null}clone(){return new D({colormap:u.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};p.__decorate([t.property({type:[[Number]],
json:{write:!0}})],M.prototype,"colormap",void 0);p.__decorate([t.property({type:String,json:{write:!0}})],M.prototype,"colormapName",void 0);p.__decorate([L.cast("colormapName")],M.prototype,"castColormapName",null);p.__decorate([t.property({types:B.types,json:{write:!0}})],M.prototype,"colorRamp",void 0);p.__decorate([F.reader("colorRamp")],M.prototype,"readColorRamp",null);p.__decorate([t.property({type:Q.colorRampDict.apiValues,json:{type:Q.colorRampDict.jsonValues,write:Q.colorRampDict.write}})],
M.prototype,"colorRampName",void 0);p.__decorate([F.reader("colorRampName")],M.prototype,"readColorRampName",null);return M=D=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],M)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],function(p,u){function t(Q,B){const D=[],q=[];for(let c=0;c<Q.length-1;c++)D.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:Q[c].slice(1),toColor:Q[c+
1].slice(1)}),q.push(Q[c+1][0]-Q[c][0]);Q=Q[Q.length-1][0];B=B??q;return u.convertColorRampToColors({type:"multipart",colorRamps:D},{numColors:Q,weights:B})}function L(){const Q=t([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let B=Q.length;256>B;B++)Q.push([6,27,7]);return Q}function F(){const Q=[];for(let B=0;256>B;B++){const D=[];for(let q=0;3>q;q++)D.push(Math.round(255*Math.random()));
Q.push(D)}return Q}const P=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,
5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,
111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,
247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,
101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,
57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],M=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,
0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,
0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,
238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,
173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,
130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];p.getColormapByName=function(Q){let B;switch(Q){case "elevation":B=t([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,
20,20,20]]);break;case "gray":B=u.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":B=t([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":B=P;break;case "ndvi2":B=L();break;case "ndvi3":B=M;break;case "random":B=F()}return B?B=B.map((D,q)=>[q,...D]):null};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ColormapToRGBFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../SimpleBandStatistics ./BaseRasterFunction ./ColormapToRGBFunctionArguments ./pixelUtils ../../../renderers/support/rasterRendererChecks".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q){t=class extends Q{constructor(){super(...arguments);this.functionName="ColormapToRGB";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var c=this.sourceRasterInfos[0];if(1<c.bandCount||!c.colormap?.length)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: source data must be single band with a colormap"};const e=c.clone();e.pixelType=this.outputPixelType=this._getOutputPixelType("u8");this._removeStatsHistColormapVAT(e);
e.bandCount=3;e.statistics=[{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20}];this.rasterInfo=e;c=[...c.colormap].sort((m,w)=>m[0]-w[0]);const {indexedColormap:n,offset:h}=D.createColormapLUT({colormap:c});if(!n)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: the colormap is not supported"};this.lookup={indexedColormap:n,offset:h};return{success:!0,supportsGPU:q.isColormapSupportedByWebGL(n)}}_processPixels(c){c=c.pixelBlocks?.[0];
if(!c||!this.lookup)return c;c=c.clone();const e=c.pixels[0],n=c.mask??(new Uint8Array(e.length)).fill(255),h=new Uint8Array(e.length),m=new Uint8Array(e.length),w=new Uint8Array(e.length),{indexedColormap:k,offset:r}=this.lookup,a=k.length;for(let f=0;f<e.length;f++)if(n[f]){let l=4*(e[f]-r);0>l||l>a-4?n[f]=0:(h[f]=k[l++],m[f]=k[l++],w[f]=k[l++])}c.pixels=[h,m,w];c.statistics=[new M.SimpleBandStatistics(0,255),new M.SimpleBandStatistics(0,255),new M.SimpleBandStatistics(0,255)];c.pixelType=this.outputPixelType;
return c}_getWebGLParameters(){return this.lookup}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"lookup",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ColormapToRGBFunction")],
t)})},"esri/layers/support/rasterFunctions/ColormapToRGBFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,u,t,L,F,P,M){var Q;u=Q=class extends M{clone(){return new Q({raster:this.raster})}};return u=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ColormapToRGBFunctionArguments")],u)})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],
function(p){function u(t){return["u8","s8"].includes(t.pixelType)&&null!=t.statistics?.[0]?.min&&null!=t.statistics[0]?.max&&1===t.bandCount}p.isClassBreaksSupported=function(t,L=!1){const {attributeTable:F,bandCount:P}=t;return 1===P&&(!L||null!=F||null!=t.histograms)};p.isColormapRendererSupported=function(t,L=!1){const {bandCount:F,colormap:P,pixelType:M}=t;return 1===F&&(!!P?.length||!L&&"u8"===M)};p.isColormapSupportedByWebGL=function(t){return!!t?.length&&16384>=t.length};p.isFlowRendererSupported=
function(t){({dataType:t}=t);return"vector-uv"===t||"vector-magdir"===t};p.isShadedReliefRendererSupported=function(t){const {bandCount:L,dataType:F,pixelType:P}=t;return"elevation"===F||"generic"===F&&1===L&&("s16"===P||"s32"===P||"f32"===P||"f64"===P)};p.isSingleBand8BitRasterWithStats=u;p.isUVRendererSupported=function(t,L){const {attributeTable:F,bandCount:P}=t;return null==F&&u(t)?!0:null==F||1<P||L&&null==F.fields.find(M=>M.name.toLowerCase()===L.toLowerCase())?!1:!0};p.isVectorFieldRendererSupported=
function(t){({dataType:t}=t);return"vector-uv"===t||"vector-magdir"===t};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),function(p,u,t,L,
F,P,M,Q,B){t=class extends M{constructor(){super(...arguments);this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const {sourceRasterInfos:D}=this;var q=D[0];this.outputPixelType=this._getOutputPixelType(q.pixelType);q=q.clone();q.attributeTable=null;q.colormap=null;q.pixelType=this.outputPixelType;q.bandCount=D.map(({bandCount:e})=>e).reduce((e,n)=>e+n);if(D.every(({statistics:e})=>null!=e&&e.length)){const e=[];D.forEach(({statistics:n})=>
null!=n&&e.push(...n));q.statistics=e}if(D.every(({histograms:e})=>null!=e&&e.length)){const e=[];D.forEach(({histograms:n})=>null!=n&&e.push(...n));q.histograms=e}q.multidimensionalInfo&&q.multidimensionalInfo.variables.forEach(e=>{var n=D.map(m=>m.multidimensionalInfo?.variables.find(({name:w})=>w===e.name));const h=n.map(m=>m?.statistics?.length?m.statistics:null);n=n.map(m=>m?.histograms?.length?m.histograms:null);e.statistics=h.every(m=>null!=m)?h.flat():null;e.histograms=n.every(m=>null!=m)?
n.flat():null});1<q.bandCount&&(q.colormap=null,q.attributeTable=null);const c=D.every(e=>e.keyProperties.BandProperties?.length)?D.flatMap(e=>e.keyProperties.BandProperties):void 0;q.keyProperties={...q.keyProperties,BandProperties:c};this.rasterInfo=q;return{success:!0,supportsGPU:3>=q.bandCount}}_processPixels(D){({pixelBlocks:D}=D);return D&&null!=D?.[0]?B.compositeBands(D):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],
t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],t)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q){var B;L=B=class extends Q{constructor(){super(...arguments);this.rasters=[]}writeRasters(D,q){q.rasters=D.map(c=>"number"===typeof c||"string"===typeof c?c:c.toJSON())}clone(){return new B({rasters:u.clone(this.rasters)})}};p.__decorate([t.property({json:{write:!0}})],L.prototype,"rasters",void 0);p.__decorate([M.writer("rasters")],L.prototype,"writeRasters",null);return L=B=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],L)})},
"esri/layers/support/rasterFunctions/ComputeChangeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../Field ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./changeDetectionUtils ./ComputeChangeFunctionArguments".split(" "),function(p,u,t,L,F,P,M,Q,B,D,q){t=class extends B{constructor(){super(...arguments);this.functionName=
"ComputeChange";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const {method:c}=this.functionArguments,e=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(e.pixelType);e.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(e);if("categorical"===c){var n=this.sourceRasterInfos.map(m=>m.attributeTable);const h=this._getFieldNames(n,"value");n=n.map(m=>this._getClassFieldName(m));if(null==h[0]||null==h[1]||null==
n[0]||null==n[1])return{success:!1,supportsGPU:!1,error:"both inputs must have proper attribute table with value and class fields"};this._updateAttributeTable(e,h,n)}e.bandCount=1;this.rasterInfo=e;return{success:!0,supportsGPU:"difference"===c||"relative-difference"===c}}_processPixels(c){({pixelBlocks:c}=c);if(null==c?.[0]||null==c?.[1])return null;const {method:e}=this.functionArguments;return D.computeChange(c,e,this.outputPixelType,this._categoryConfig)}_getWebGLParameters(){var c=this.outputPixelType??
"f32";let [e,n]=Q.getPixelValueRange(c);if(c=Q.isIntegerPixelType(c))e-=1E-4,n+=1E-4;return{method:this.functionArguments.method,domainRange:[e,n],isOutputRounded:c}}_updateAttributeTable(c,e,n){var h=this.sourceRasterInfos.map(C=>C.attributeTable),m=h.map((C,y)=>C.features.map(A=>A.attributes[e[y]])),w=h.map((C,y)=>C.features.map(A=>A.attributes[n[y]])),k=m.map(C=>{const y=[];C.forEach((A,x)=>y[A]=x);return y});const {keepMethod:r}=this.functionArguments;this._categoryConfig={categoryIndexLookups:k,
classNames:w,keepMethod:r};k=h[0].clone();k.fields=[new M({name:"OID",type:"oid"}),new M({name:"Value",type:"integer"}),new M({name:"ClassName",type:"string"}),new M({name:"Class_From",type:"string"}),new M({name:"Class_To",type:"string"})];const a=this._getFieldNames(h,"red"),f=this._getFieldNames(h,"green"),l=this._getFieldNames(h,"blue"),d=[],b=2===a.length&&2===f.length&&2===l.length;b&&(d.push(...h.map((C,y)=>C.features.map(A=>[A.attributes[a[y]],A.attributes[f[y]],A.attributes[l[y]]]))),k.fields.push(new M({name:"Red",
type:"integer"}),new M({name:"Green",type:"integer"}),new M({name:"Blue",type:"integer"})));const g=k.features[0].clone();g.geometry=null;h=[];const [z,v]=m.map(C=>C.length);m=1;for(let C=0;C<z;C++){const y=w[0][C];for(let A=0;A<v;A++){const x=w[1][A];if("changed"===r&&y===x||"unchanged"===r&&y!==x)continue;const E=g.clone();E.attributes={OID:m++,Value:C*v+A,ClassName:y===x?y:`${y} -> ${x}`,Class_From:y,Class_To:x};b&&(E.attributes.Red=d[0][C][0]+d[1][A][0]>>1,E.attributes.Green=d[0][C][1]+d[1][A][1]>>
1,E.attributes.Blue=d[0][C][2]+d[1][A][2]>>1);h.push(E)}}"changed"===r?(w=g.clone(),w.attributes={OID:m++,Value:z*v+1,ClassName:"No Change",Class_From:"Same",Class_To:"Same"},h.push(w)):"unchanged"===r&&(w=g.clone(),w.attributes={OID:m++,Value:z*v+2,ClassName:"Changed",Class_From:"Any",Class_To:"Any"},h.push(w));k.features=h;c.attributeTable=k}_getFieldNames(c,e){return c.map(({fields:n})=>n.find(h=>h.name.toLowerCase()===e)?.name).filter(n=>n)}_getClassFieldName(c){return(c.fields.find(e=>"string"===
e.type&&e.name.toLowerCase().startsWith("class"))??c.fields.find(e=>"string"===e.type&&e.name.toLowerCase().includes("class")||e.name.toLowerCase().includes("type")||e.name.toLowerCase().includes("name"))??c.fields.find(e=>"string"===e.type))?.name}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],
t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"_categoryConfig",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunction")],t)})},"esri/layers/support/rasterFunctions/changeDetectionUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(p,u,t,L,F){function P(q){const {bands:[c,e],mask:n,isRelative:h,isRoundingNeeded:m,
outBand:w}=q;q=c.length;for(let k=0;k<q;k++)if(!n||n[k]){let r=c[k]-e[k];if(h){const a=Math.max(Math.abs(c[k])-Math.abs(e[k]));r=0<a?r/a:0}w[k]=m?Math.round(r):r}}function M(q){const {bands:[c,e],categoryIndexLookups:[n,h],classNames:[m,w],mask:k,keepMethod:r,outBand:a}=q;q=c.length;const f=w.length,l=m.length*f,d=l+1,b=l+2;for(let g=0;g<q;g++)if(!k||k[g]){const z=n[c[g]],v=h[e[g]],C=m[z],y=w[v];a[g]=null==z||null==v?l:"changed"===r&&C===y?d:"unchanged"===r&&C!==y?b:z*f+v}}function Q(q){const {pixels:[c,
e],mask:n,outBand:h}=q;q=c[0].length;const m=c.length;for(let w=0;w<q;w++)if(!n||n[w]){let k=0;for(let r=0;r<m;r++){const a=c[r][w]-e[r][w];k+=a*a}h[w]=Math.sqrt(k)}}function B(q){const {pixels:[c,e],mask:n,outBand:h}=q;q=c[0].length;const m=c.length;for(let k=0;k<q;k++)if(!n||n[k]){let r=0;var w=0;let a=0;for(let f=0;f<m;f++){const l=c[f][k],d=e[f][k];r+=l*d;w+=l*l;a+=d*d}w=Math.sqrt(w*a);h[k]=w?Math.acos(r/w):1.5707963267948966}}function D(q){const {pixels:[c,e],mask:n,outBand:h}=q;q=c[0].length;
const m=c.length;for(let w=0;w<q;w++)if(!n||n[w]){let k=0,r=0;for(let a=0;a<m;a++){const f=Math.abs(c[a][w]-e[a][w]);f>k&&(k=f,r=a)}h[w]=r}}u=new t.JSONMap({0:"difference",1:"relative-difference",2:"categorical",3:"euclidean-distance",4:"angle-difference",5:"band-with-most-change"},{useNumericKeys:!0});t=new t.JSONMap({0:"all",1:"changed",2:"unchanged"},{useNumericKeys:!0});p.changeMethodMap=u;p.computeChange=function(q,c,e,n){const [h,m]=q,w=F.isIntegerPixelType(e)&&!F.isIntegerPixelType(h.pixelType)&&
!F.isIntegerPixelType(m.pixelType);var k=[h.mask,m.mask].filter(d=>d);k=L.combineBandMasks(k);const r=q.map(d=>d.pixels[0]),{width:a,height:f}=h,l=L.createEmptyBand(e,a*f);switch(c){case "difference":case "relative-difference":P({bands:r,mask:k,outBand:l,isRoundingNeeded:w,isRelative:"relative-difference"===c});break;case "categorical":M({bands:r,mask:k,outBand:l,...n});break;case "euclidean-distance":Q({pixels:q.map(d=>d.pixels),mask:k,outBand:l});break;case "angle-difference":B({pixels:q.map(d=>
d.pixels),mask:k,outBand:l});break;case "band-with-most-change":D({pixels:q.map(d=>d.pixels),mask:k,outBand:l})}q=new L({width:a,height:f,pixels:[l],pixelType:e,mask:k});q.updateStatistics();return q};p.keepMethodMap=t;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ComputeChangeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./changeDetectionUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;t=D=class extends Q{constructor(){super(...arguments);this.method="difference";this.keepMethod="all";this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new D({raster:this.raster,raster2:this.raster2,method:this.method,keepMethod:this.keepMethod})}};p.__decorate([P.enumeration(B.changeMethodMap)],t.prototype,"method",void 0);p.__decorate([P.enumeration(B.keepMethodMap)],t.prototype,"keepMethod",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"raster2",void 0);p.__decorate([u.property({readOnly:!0})],t.prototype,"rasters",null);return t=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.ComputeChangeFunctionArguments")],t)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends M{constructor(){super(...arguments);this.functionName="ContrastBrightness";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:q}=this;q=q[0];if("u8"!==q.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");q=q.clone();this._removeStatsHistColormapVAT(q);this.rasterInfo=
q;const {contrastOffset:c,brightnessOffset:e}=this.functionArguments;this.lookup=D.createContrastBrightnessLUT(c,e);return{success:!0,supportsGPU:!0}}_processPixels(q){q=q.pixelBlocks?.[0];return null==q?null:B.lookupPixels(q,{lut:q.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:q,brightnessOffset:c}=this.functionArguments;return{contrastOffset:q,brightnessOffset:c}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,
"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"lookup",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],t)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M){var Q;t=Q=class extends M{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new Q({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"contrastOffset",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"brightnessOffset",void 0);return t=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
t)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(p,u,t,L,F){function P(e,n=256){n=Math.min(n,256);const {size:h,counts:m}=e;e=new Uint8Array(h);var w=m.reduce((l,d)=>l+d/n,0);let k=0;var r=0;let a=0,f=w;for(let l=0;l<h;l++)if(a+=m[l],!(l<h-1&&a+m[l+1]<f)){for(;k<n-1&&f<a;)k++,f+=w;for(;r<=l;r++)e[r]=k;r=l+1}for(w=r;w<h;w++)e[w]=n-
1;return e}function M(e,n){e=Math.min(Math.max(e,-100),100);n=Math.min(Math.max(n??0,-100),100);let h=0,m=0;const w=new Uint8Array(256);for(h=0;256>h;h++)0<e&&100>e?m=(200*h-25500+510*n)/(2*(100-e))+128:0>=e&&-100<e?m=(200*h-25500+510*n)*(100+e)/2E4+128:100===e?(m=200*h-25500+256*(100-e)+510*n,m=0<m?255:0):-100===e&&(m=128),w[h]=255<m?255:0>m?0:m;return w}function Q(e,n,h,m){m=Infinity;let w=-Infinity;var k=0,r=0,a=0,f=0;const l=e.length;var d=new Map,b=[];for(let g=0;g<l;g++){const z=e[g];if(!n||
n[g]){b.push(z);const v=(d.get(z)??0)+1;d.set(z,v);v>f&&(f=v,a=z);m=z<m?z:m;w=z>w?z:w;k+=z;r++}}if(0===r)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};k/=r;f=0;for(d=0;d<l;d++)if(!n||n[d])f+=(e[d]-k)**2;d=n?n.filter(g=>g).length:l;f=1>=d?0:Math.sqrt(f/(d-1));b.sort((g,z)=>g-z);d=r>>>1;a={min:m,max:w,avg:k,stddev:f,mode:a,median:r%2?b[Math.floor(d)]:(b[d-1]+b[d])/2};if(["u8","s8","u4","u2","u1"].includes(h)){r=w-m+1;h=new Uint32Array(r);for(b=0;b<l;b++)n&&!n[b]||h[e[b]-
m]++;return{statistics:a,histogram:{min:m-.5,max:w+.5,size:r,counts:h}}}h=new Uint32Array(256);b=(w-m)/256;if(0===b)return{statistics:a,histogram:{min:m,max:w,size:1,counts:(new Uint32Array(1)).fill(r)}};r=new Uint32Array(257);for(k=0;k<l;k++)n&&!n[k]||r[Math.floor((e[k]-m)/b)]++;for(e=0;255>e;e++)h[e]=r[e];h[255]=r[255]+r[256];return{statistics:a,histogram:{min:m,max:w,size:256,counts:h}}}function B(e){if(!e?.pixels?.length)return null;const {pixels:n,mask:h,bandMasks:m,pixelType:w}=e,k=e.width*
e.height,r=n.length,a=[],f=[];let l,d;for(let x=0;x<r;x++){var b=new Uint32Array(256);var g=n[x],z=m?.[x]??h;if("u8"===w){l=255;d=0;if(z)for(var v=0;v<k;v++){if(z[v]){var C=g[v];l=C<l?C:l;d=C>d?C:d;b[C]++}}else for(z=0;z<k;z++)v=g[z],l=v<l?v:l,d=v>d?v:d,b[v]++;b=b.slice(l,d+1)}else{C=!1;e.statistics||(e.updateStatistics(),C=!0);var y=e.statistics;l=y[x].minValue;d=y[x].maxValue;v=(d-l)/256;if(0===v)for(!y||e.validPixelCount||C||e.updateStatistics(),g=(e.validPixelCount||e.width*e.height)/256,z=0;256>
z;z++)b[z]=Math.round(g*(z+1))-Math.round(g*z);else{C=new Uint32Array(257);for(y=0;y<k;y++)z&&!z[y]||C[Math.floor((g[y]-l)/v)]++;for(g=0;255>g;g++)b[g]=C[g];b[255]=C[255]+C[256]}}v="u8"===w?l-.5:l;C="u8"===w?d+.5:d;a.push({min:v,max:C,size:b.length,counts:b});z=y=g=0;for(var A=0;A<b.length;A++)g+=b[A],y+=A*b[A];y/=g;for(A=0;A<b.length;A++)z+=b[A]*(A-y)**2;b=(C-v)/b.length;f.push({min:l,max:d,avg:(y+("u8"===w?0:.5))*b+l,stddev:Math.sqrt(z/(g-1))*b})}return{statistics:f,histograms:a}}function D(e,n){if(null==
n||0===n.length)return e;const h=Math.max.apply(null,n),{minCutOff:m,maxCutOff:w,outMin:k,outMax:r,histogramLut:a}=e;return m.length===n.length||m.length<=h?e:{minCutOff:n.map(f=>m[f]),maxCutOff:n.map(f=>w[f]),histogramLut:a?n.map(f=>a[f]):null,outMin:k,outMax:r}}function q(e,n){const h=new Float32Array(e);for(let m=0;m<e;m++)h[m]=1<n[m]?2<n[m]?6.5+(n[m]-2)**2.5:6.5+100*(2-n[m])**4:1;return h}const c=[.299,.587,.114];p.computeGammaCorrection=q;p.computeGammaValues=function(e,n,h){const m=[];for(let f=
0;f<n.length;f++){var w=0,k=0,r=0;"min"in n[f]?{min:w,max:k,avg:r}=n[f]:[w,k,r]=n[f];r=r??0;"u8"!==e&&(r=255*(r-w)/(k-w));h&&(r*=c[f]);w=m;k=w.push;if(0>=r||255<=r)r=1;else{var a=0;150!==r&&(a=150>=r?45*Math.cos(.01047*r):17*Math.sin(.021*r));a=Math.log((r+a)/255);0===a?r=1:(r=Math.log(r/255)/a,r=isNaN(r)?1:Math.min(9.9,Math.max(.01,r)))}k.call(w,r)}return m};p.computeStatisticsHistograms=function(e){const {pixels:n,mask:h,pixelType:m,bandMasks:w}=e;var k=n.map((r,a)=>Q(r,w?.[a]??h,m));e=k.map(({statistics:r})=>
r);k=k.map(({histogram:r})=>r);return{statistics:e,histograms:k}};p.createContrastBrightnessLUT=M;p.createHistogramEqualizationLUT=P;p.createStretchLUT=function(e){const {minCutOff:n,maxCutOff:h,gamma:m,pixelType:w,rounding:k}=e,r=e.outMin||0,a=e.outMax||255;if(!["u8","u16","s8","s16"].includes(w))return null;const f=n.length;let l,d,b=0;"s8"===w?b=-127:"s16"===w&&(b=-32767);let g=256;["u16","s16"].includes(w)&&(g=65536);var z=[],v=[];const C=a-r;for(l=0;l<f;l++)v[l]=h[l]-n[l],z[l]=0===v[l]?0:C/v[l];
let y;const A=[];let x,E;if(m&&m.length>=f)for(z=q(f,m),l=0;l<f;l++){E=[];for(d=0;d<g;d++)if(0===v[l])E[d]=r;else{var N=d+b;y=(N-n[l])/v[l];x=1;1<m[l]&&(x-=(1/C)**(y*z[l]));N<h[l]&&N>n[l]?(N=x*C*y**(1/m[l])+r,E[d]="floor"===k?Math.floor(N):"round"===k?Math.round(N):N):E[d]=N>=h[l]?a:r}A[l]=E}else for(l=0;l<f;l++){E=[];for(d=0;d<g;d++)N=d+b,N<=n[l]?E[d]=r:N>=h[l]?E[d]=a:(v=(N-n[l])*z[l]+r,E[d]="floor"===k?Math.floor(v):"round"===k?Math.round(v):v);A[l]=E}if(null!=e.contrastOffset)for(e=M(e.contrastOffset,
e.brightnessOffset),l=0;l<f;l++)for(E=A[l],d=0;d<g;d++)E[d]=e[E[d]];return{lut:A,offset:b}};p.estimateStatisticsFromHistograms=function(e){const n=[];for(let k=0;k<e.length;k++){const {min:r,max:a,size:f,counts:l}=e[k];let d=0;var h=0;for(var m=0;m<f;m++)d+=l[m],h+=m*l[m];h/=d;m=0;for(var w=0;w<f;w++)m+=l[w]*(w-h)**2;w=(a-r)/f;n.push({min:r,max:a,avg:(h+.5)*w+r,stddev:Math.sqrt(m/(d-1))*w})}return n};p.estimateStatisticsHistograms=B;p.getStretchCutoff=function(e,n){const {pixelBlock:h,bandIds:m,returnHistogramLut:w,
rasterInfo:k}=n;var r=null;n=null;var a=e.stretchType;"number"===typeof a&&(a=F.stretchTypeFunctionEnum[a]);e.dra?"minMax"===a&&h?.statistics?r=h.statistics.map(N=>[N.minValue,N.maxValue,0,0]):(n=B(h),r=null!=n?n.statistics:null,n=null!=n?n.histograms:null):(r=e.statistics?.length?e.statistics:k.statistics,n="histograms"in e?e.histograms:void 0,n||(n=k.histograms));"percentClip"!==a&&"histogramEqualization"!==a||n?.length||(a="minMax");var f=r?.length||n?.length||k.bandCount;const l=[],d=[];let b,
g,z;r&&!Array.isArray(r[0])&&(r=r.map(N=>[N.min,N.max,N.avg,N.stddev]));const [v,C]=L.getPixelValueRange(k.pixelType);if(!r?.length){r=[];for(g=0;g<f;g++)r.push([v,C,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(g=0;g<f;g++)l[g]=v,d[g]=C;break;case "minMax":for(g=0;g<f;g++){var y=r[g];l[g]=y[0];d[g]=y[1]}break;case "standardDeviation":({numberOfStandardDeviations:y=2}=e);for(g=0;g<f;g++){var A=r[g];l[g]=A[2]-y*A[3];d[g]=A[2]+y*A[3];l[g]<A[0]&&(l[g]=A[0]);d[g]>A[1]&&(d[g]=A[1])}break;
case "histogramEqualization":u.assertIsSome(n);for(g=0;g<f;g++)l[g]=n[g].min,d[g]=n[g].max;break;case "percentClip":u.assertIsSome(n);for(g=0;g<n.length;g++){r=n[g];A=new Uint32Array(r.size);var x=[...r.counts];20<=x.length&&(x[0]=x[1]=x[2]=x[x.length-1]=x[x.length-2]=0);y=0;f=(r.max-r.min)/r.size;b=-.5===r.min&&1===f?.5:0;for(z=0;z<r.size;z++)y+=x[z],A[z]=y;x=(e.minPercent||0)*y/100;l[g]=r.min+b;for(z=0;z<r.size;z++)if(A[z]>x){l[g]=r.min+f*(z+b);break}x=(1-(e.maxPercent||0)/100)*y;d[g]=r.max+b;for(z=
r.size-2;0<=z;z--)if(A[z]<x){d[g]=r.min+f*(z+2-b);break}d[g]<l[g]&&(r=l[g],l[g]=d[g],d[g]=r)}break;default:for(g=0;g<f;g++)y=r[g],l[g]=y[0],d[g]=y[1]}let E;"histogramEqualization"===a?(u.assertIsSome(n),a=n[0].size||256,e=0,w&&(E=n.map(N=>P(N)))):(a=e.max||255,e=e.min||0);return D({minCutOff:l,maxCutOff:d,outMax:a,outMin:e,histogramLut:E},m)};p.stretch=function(e,n){if(!e?.pixels?.length)return e;const {mask:h,bandMasks:m,width:w,height:k,pixels:r}=e,{minCutOff:a,maxCutOff:f,gamma:l}=n;var d=n.outMin||
0;const b=n.outMax||255,g=w*k,z=n.outputPixelType||"u8";e=e.pixels.map(()=>t.createEmptyBand(z,g));const v=e.length;var C=b-d,y=[],A=[];for(var x=0;x<v;x++)A[x]=f[x]-a[x],y[x]=0===A[x]?0:C/A[x];x=z.startsWith("u")||z.startsWith("s");n=!!n.isRenderer;if(l&&l.length>=v){y=q(v,l);for(var E=0;E<v;E++){var N=m?.[E]??h;for(let O=0;O<g;O++)if(null==N||N[O]){if(0===A[E]){e[E][O]=d;continue}var G=r[E][O];const H=(G-a[E])/A[E];let J=1;1<l[E]&&(J-=(1/C)**(H*y[E]));G<f[E]&&G>a[E]?(G=J*C*H**(1/l[E])+d,e[E][O]=
n?Math.floor(G):x?Math.round(G):G):e[E][O]=G>=f[E]?b:d}}}else for(C=0;C<v;C++)for(A=m?.[C]??h,E=0;E<g;E++)if(null==A||A[E])N=r[C][E],N<f[C]&&N>a[C]?(N=(N-a[C])*y[C]+d,e[C][E]=n?Math.floor(N):x?Math.round(N):N):e[C][E]=N>=f[C]?b:d;d=new t({width:w,height:k,mask:h,bandMasks:m,pixels:e,pixelType:z});d.updateStatistics();return d};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q){t=class extends B{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}get _normalizedKernel(){const {kernel:c,convolutionType:e}=this.functionArguments,n=c.reduce((h,m)=>h+m);return-1===e||0===n||1===n?c:c.map(h=>h/n)}_bindSourceRasters(){const {convolutionType:c,rows:e,cols:n,kernel:h}=this.functionArguments;if(!Object.values(M.convolutionKernel).includes(c))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${c}`};
if(c!==M.convolutionKernel.none&&e*n!==h.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var m=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(m.pixelType);m=m.clone();m.pixelType=this.outputPixelType;const w=[M.convolutionKernel.none,M.convolutionKernel.sharpen,M.convolutionKernel.sharpen2,M.convolutionKernel.sharpening3x3,M.convolutionKernel.sharpening5x5];if(-1===c||"u8"!==this.outputPixelType&&
!w.includes(c))m.statistics=null,m.histograms=null;m.colormap=null;m.attributeTable=null;this.rasterInfo=m;return{success:!0,supportsGPU:25>=h.length}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c||this.functionArguments.convolutionType===M.convolutionKernel.none)return c;const {rows:e,cols:n}=this.functionArguments,{_normalizedKernel:h}=this;return q.convolute(c,{kernel:h,rows:e,cols:n,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const c=new Float32Array(25);c.set(this._normalizedKernel);
return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:c,clampRange:Q.getPixelValueRange(this.outputPixelType)}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property()],t.prototype,"_normalizedKernel",
null);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],t)})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(p,u,t,L,F,P,M,Q,B){var D;L=D=class extends Q{constructor(){super(...arguments);
this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(q){this._set("convolutionType",q);const c=B.convolutionKernels.get(q);c&&q!==M.convolutionKernel.userDefined&&q!==M.convolutionKernel.none&&(q=Math.sqrt(c.length),this._set("kernel",c),this._set("cols",q),this._set("rows",q))}clone(){return new D({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:u.clone(this.raster)})}};p.__decorate([t.property({json:{type:Number,write:!0}})],
L.prototype,"rows",void 0);p.__decorate([t.property({json:{type:Number,write:!0}})],L.prototype,"cols",void 0);p.__decorate([t.property({json:{name:"type",type:Number,write:!0}})],L.prototype,"convolutionType",null);p.__decorate([t.property({json:{type:[Number],write:!0}})],L.prototype,"kernel",void 0);return L=D=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock",
"../rasterFunctionConstants","./mirror"],function(p,u,t,L){function F(D){const q=Math.sqrt(D.length),c=D.slice(0,q),e=[1];for(let n=1;n<q;n++){let h=null;for(let m=0;m<q;m++){const w=D[m+n*q],k=D[m];if(null==h)if(0===k){if(w)return{separable:!1,row:null,col:null}}else h=w/k;else if(w/k!==h)return{separable:!1,row:null,col:null}}if(null==h)return{separable:!1,row:null,col:null};e.push(h)}return{separable:!0,row:c,col:e}}function P(D,q,c,e,n,h,m){const w=new Float32Array(q*c),k=h.length,r=m?0:e,a=m?
e:0;m=m?1:q;for(let f=r;f<c-r;f++){const l=f*q;for(let d=a;d<q-a;d++){if(n&&!n[l+d])continue;let b=0;for(let g=0;g<k;g++)b+=D[l+d+(g-e)*m]*h[g];w[l+d]=b}}return w}function M(D,q,c=!0){const {pixels:e,width:n,height:h,pixelType:m,mask:w}=D;D=e.length;const k=[],{kernel:r,rows:a,cols:f}=q;for(q=0;q<D;q++){var l=e[q],d=n,b=h,g=a,z=f,v=w,C=r;const y=new Float32Array(d*b),A=Math.floor(g/2),x=Math.floor(z/2);for(let E=A;E<b-A;E++){const N=E*d;for(let G=x;G<d-x;G++){if(v&&!v[N+G])continue;let O=0;for(let H=
0;H<g;H++)for(let J=0;J<z;J++)O+=l[N+G+(H-A)*d+J-x]*C[H*z+J];y[N+G]=O}}l=y;c&&L.mirror(l,n,h,a,f);k.push(l)}return new u({width:n,height:h,pixelType:m,pixels:k,mask:w})}function Q(D,q,c,e=!0){const {pixels:n,width:h,height:m,pixelType:w,mask:k}=D;D=n.length;const r=[],a=q.length,f=c.length,l=Math.floor(a/2),d=Math.floor(f/2);for(let b=0;b<D;b++){let g=P(n[b],h,m,l,k,q,!0);g=P(g,h,m,d,k,c,!1);e&&L.mirror(g,h,m,a,f);r.push(g)}return new u({width:h,height:m,pixelType:w,pixels:r,mask:k})}const B=new Map;
B.set(t.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);B.set(t.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);B.set(t.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);B.set(t.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);B.set(t.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);B.set(t.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);B.set(t.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);B.set(t.convolutionKernel.gradientEast,
[1,0,-1,2,0,-2,1,0,-1]);B.set(t.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);B.set(t.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);B.set(t.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);B.set(t.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);B.set(t.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);B.set(t.convolutionKernel.smoothing5x5,
[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);B.set(t.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);B.set(t.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);B.set(t.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);B.set(t.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);B.set(t.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);B.set(t.convolutionKernel.sobelVertical,
[-1,0,1,-2,0,2,-1,0,1]);B.set(t.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);B.set(t.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);B.set(t.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);p.convolute=function(D,q){const c=F(q.kernel),e=!1!==q.mirrorEdges;D=c.separable?Q(D,c.row,c.col,e):M(D,q,e);({outputPixelType:q}=q);q&&D.clamp(q);return D};p.convoluteSeparable=Q;p.convolutionKernels=B;p.separateKernels=F;Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(p){p.mirror=function(u,t,L,F,P){F=Math.floor(F/2);for(var M=0;M<F;M++)for(var Q=0;Q<t;Q++)u[M*t+Q]=u[(P-1-M)*t+Q],u[(L-1-M)*t+Q]=u[(L-P+M)*t+Q];F=Math.floor(P/2);for(M=0;M<L;M++){Q=M*t;for(let B=0;B<F;B++)u[Q+B]=u[Q+P-1-B],u[Q+t-B-1]=u[Q+t+B-P]}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){t=class extends M{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const D=this.sourceRasterInfos[0].clone();D.pixelType=this.outputPixelType;D.bandCount=1;this._removeStatsHistColormapVAT(D);this.rasterInfo=D;this.isGCS=D.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(D){const q=
D.pixelBlocks?.[0];if(null==q)return null;const {zFactor:c,curvatureType:e}=this.functionArguments,{extent:n,primaryPixelSizes:h}=D;D=h?.[0];return B.curvature(q,{zFactor:this.isGCS&&1<=c?c*B.gcsFactor:c,curvatureType:e,resolution:null==D?n?{x:n.width/q.width,y:n.height/q.height}:{x:1,y:1}:D})}_getWebGLParameters(){const {zFactor:D,curvatureType:q}=this.functionArguments;return{curvatureType:q,zFactor:this.isGCS&&1<=D?D*B.gcsFactor:D}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],
t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isGCS",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],t)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){var q;const c=new u.JSONMap({0:"standard",1:"planform",2:"profile"},{useNumericKeys:!0});u=q=class extends D{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(e,n){return c.fromJSON(n.type??n.curvatureType??0)}clone(){return new q({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};p.__decorate([t.property({json:{write:{target:"type"}}}),M.enumeration(c)],u.prototype,"curvatureType",void 0);p.__decorate([Q.reader("curvatureType",
["type","curvatureType"])],u.prototype,"readCurvatureType",null);p.__decorate([t.property({type:Number,json:{write:!0}})],u.prototype,"zFactor",void 0);return u=q=p.__decorate([B.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],u)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){function q(n,h){n=n.bandInfos.map(({name:w})=>w.toLowerCase());const m=[];for(let w=0;w<h.length;w++){const k=h[w].toLowerCase();let r=n.indexOf(k);-1===r&&"nearinfrared"===k&&(r=n.findIndex(a=>a.startsWith("nearinfrared_1")),-1===r&&(r=n.findIndex(a=>a.startsWith("nearinfrared"))));if(-1===r)return null;m.push(r)}return m}function c(n,h,m){const {bandCount:w}=n;return!h?.length||m&&h.some(k=>0>k||k>=w)?null:h}function e(n,h,{wavelengthMatchTolerance:m},w){var {bandInfos:k}=
n;n=[];for(var r=0;r<k.length;r++){const {minWavelength:a,maxWavelength:f}=k[r];if(!a||!f)return null;n.push({minWavelength:a,maxWavelength:f})}k=[];for(r=0;r<h.length;r++){const a=h[r];let f=!1,l=-1,d=Number.MAX_VALUE;for(let b=0;b<n.length;b++){const g=n[b],z=Math.abs(a-(g.minWavelength+g.maxWavelength)/2);a>=g.minWavelength&&a<=g.maxWavelength?z<d&&(f=!0,l=b,d=z):!f&&z<d&&(l=b,d=z)}!f&&m&&d<m&&(f=!0);if(!f&&w)return null;k.push(l)}return k}t=class extends Q{constructor(){super(...arguments);this.functionName=
"ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:n,sourceRasterInfos:h}=this;var m=h[0];const {method:w,bandNames:k,bandWavelengths:r,bandIds:a,missingBandAction:f}=n,l=k?.length&&("name"===w||"id"!==w&&!a?.length),d=r?.length&&("wavelength"===w||"id"!==w&&!a?.length),b=f===D.MissingBandAction.fail,g=l?q(m,k):d?e(m,r,this.functionArguments,b):c(m,a,b);if(null==g)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${l?
"band names":d?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=g;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");m=m.clone();m.pixelType=this.outputPixelType;m.bandCount=g.length;const {statistics:z,histograms:v}=m;null!=z&&z.length&&(m.statistics=g.map(y=>z[y]||z[z.length-1]));null!=v&&v.length&&(m.histograms=g.map(y=>v[y]||v[v.length-1]));m.multidimensionalInfo&&m.multidimensionalInfo.variables.forEach(y=>{const {statistics:A,
histograms:x}=y;null!=A&&A.length&&(y.statistics=g.map(E=>A[E]||A[A.length-1]));null!=x&&x.length&&(y.histograms=g.map(E=>x[E]||x[x.length-1]))});let C=m.keyProperties?.BandProperties;C?.length&&(C=g.map(y=>y>=C.length?C[C.length-1]:C[y]),m.keyProperties={...m.keyProperties,BandProperties:C});this.rasterInfo=m;return{success:!0,supportsGPU:3>=m.bandCount}}_processPixels(n){n=n.pixelBlocks?.[0];if(null==n)return null;const h=n.pixels.length,m=this.functionArguments.bandIds.map(w=>w>=h?h-1:w);return n.extractBands(m)}_getWebGLParameters(){let n;
if(this.isInputBandIdsSwizzled)n=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{n=[...this.functionArguments.bandIds];0===n.length?n=[0,1,2]:3>n.length&&(n[1]=n[1]??n[0],n[2]=n[2]??n[1]);for(let h=0;3>h;h++)n[h]=Math.min(n[h],2)}return{bandIndexMat3:M.getBandMatrix3(n)}}_getInputBandIds(n){const h=n.length;return this.functionArguments.bandIds.map(m=>m>=h?h-1:m).map(m=>n[m])}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",
void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],t)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;t=D=class extends Q{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=B.MissingBandAction.bestMatch}clone(){return new D({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,
"bandIds",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"bandNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"bandWavelengths",void 0);p.__decorate([P.enumeration({0:"name",1:"wavelength",2:"id"})],t.prototype,"method",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"missingBandAction",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"wavelengthMatchTolerance",void 0);return t=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
t)})},"esri/layers/support/rasterFunctions/GrayscaleFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./conversionUtils ./GrayscaleFunctionArguments".split(" "),function(p,u,t,L,F,P,M,Q,B){t=class extends M{constructor(){super(...arguments);this.functionName="Grayscale";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}get _normalizedWeights(){const {conversionParameters:D}=this.functionArguments,q=D.reduce((c,e)=>c+e);return D.map(c=>c/q)}_bindSourceRasters(){var {conversionParameters:D}=this.functionArguments;if(!D?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const q=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(q.pixelType);q.pixelType=this.outputPixelType;D=3===D.length||3===q.bandCount&&3<D.length;q.bandCount=1;this._removeStatsHistColormapVAT(q);
this.rasterInfo=q;return{success:!0,supportsGPU:D}}_processPixels(D){D=D.pixelBlocks?.[0];return null==D?null:Q.grayscale(D,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",
void 0);p.__decorate([u.property()],t.prototype,"_normalizedWeights",null);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.GrayscaleFunction")],t)})},"esri/layers/support/rasterFunctions/conversionUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(p,u,t){p.grayscale=function(L,F,P){const {pixels:M,width:Q,height:B,mask:D,bandMasks:q}=L;var c=Q*B;const e=q?.length?u.combineBandMasks(q):D,n=Math.min(F.length,M.length),h=P.startsWith("f");
L=!h&&P!==L.pixelType;const [m,w]=t.getPixelValueRange(P);c=u.createEmptyBand(P,c);for(let k=0;k<B;k++){let r=k*Q;for(let a=0;a<Q;a++,r++)if(!e||e[r]){let f=0;for(let l=0;l<n;l++)f+=F[l]*M[l][r];h||(f=Math.round(f),L&&(f=f>w?w:f<m?m:f));c[r]=f}}F=new u({width:Q,height:B,pixels:[c],pixelType:P,mask:e});F.updateStatistics();return F};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/GrayscaleFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M){var Q;t=Q=class extends M{clone(){return new Q({conversionParameters:[...this.conversionParameters],raster:this.raster})}};p.__decorate([u.property({type:[Number],json:{write:!0}})],t.prototype,"conversionParameters",void 0);return t=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],t)})},"esri/layers/support/rasterFunctions/HillshadeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./HillshadeFunctionArguments ./surfaceUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends Q{constructor(){super(...arguments);this.functionName="Hillshade";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var q=this.sourceRasterInfos[0];if(1<q.bandCount)return{success:!1,supportsGPU:!1,error:"hillshade-function: source data must be single band"};this.outputPixelType=this._getOutputPixelType("u8");q=q.clone();this._removeStatsHistColormapVAT(q);q.pixelType=this.outputPixelType;q.bandCount=1;
q.statistics=[{min:0,max:255,avg:60,stddev:10}];this.rasterInfo=q;this.isGCS=q.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(q){var c=q.pixelBlocks?.[0];if(!c)return null;const {extent:e,primaryPixelSizes:n}=q;q=n?.[0];q=D.getHillshadeOptions(this.functionArguments,null==q?e?{x:e.width/c.width,y:e.height/c.height}:{x:1,y:1}:q,this.isGCS);c=D.hillshade(c,q);c.pixelType=this.outputPixelType;return c}_getWebGLParameters(){var q=D.getHillshadeOptions(this.functionArguments,
{x:1,y:1},this.isGCS);q=D.calculateHillshadeParams(q);const {slopeType:c,zFactor:e,pixelSizeFactor:n,pixelSizePower:h}=this.functionArguments,m="scaled"===c,w=M.isIntegerPixelType(this.outputPixelType);return{...q,zFactor:e,gcsFactor:this.isGCS?D.gcsFactor:1,pixelSizeFactor:m?n:0,pixelSizePower:m?h:0,isOutputRounded:w}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],
t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isGCS",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.HillshadeFunction")],t)})},"esri/layers/support/rasterFunctions/HillshadeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;L=new u.JSONMap({0:"traditional",1:"multi-directional"},{useNumericKeys:!0});u=new u.JSONMap({1:"degree",2:"percent-rise",3:"scaled"},{useNumericKeys:!0});B=D=class extends B{constructor(){super(...arguments);this.altitude=45;this.azimuth=315;this.hillshadeType="traditional";this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.slopeType="degree";this.zFactor=1;this.removeEdgeEffect=!1}clone(){return new D({hillshadeType:this.hillshadeType,altitude:this.altitude,
azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};p.__decorate([t.property({type:Number,json:{write:!0}})],B.prototype,"altitude",void 0);p.__decorate([t.property({type:Number,json:{write:!0}})],B.prototype,"azimuth",void 0);p.__decorate([t.property(),M.enumeration(L)],B.prototype,"hillshadeType",void 0);p.__decorate([t.property({type:Number,json:{write:!0,
name:"psPower"}})],B.prototype,"pixelSizePower",void 0);p.__decorate([t.property({type:Number,json:{write:!0,name:"psZFactor"}})],B.prototype,"pixelSizeFactor",void 0);p.__decorate([t.property(),M.enumeration(u)],B.prototype,"slopeType",void 0);p.__decorate([t.property({type:Number,json:{write:!0}})],B.prototype,"zFactor",void 0);p.__decorate([t.property({type:Boolean,json:{write:!0}})],B.prototype,"removeEdgeEffect",void 0);return B=D=p.__decorate([Q.subclass("esri.layers.support.rasterFunctions.HillshadeFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),function(p,u,t,L,F,P,M,Q,B,D,q){t=class extends B{constructor(){super(...arguments);this.functionName="Local";
this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:c}=this,e=c[0];const {bandCount:n}=e,{processAsMultiband:h}=this.functionArguments;if(c.some(k=>k.bandCount!==n))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:m,rasters:w}=this.functionArguments;c=q.operandsCount[m];if(!(999===c||w.length===c||1>=w.length&&1===c))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${c}`};
e=e.clone();e.bandCount=999!==c||h?n:1;this._removeStatsHistColormapVAT(e);this._updateStatistics(e);this._updatePixelType(e);this.rasterInfo=e;return{success:!0,supportsGPU:1===e.bandCount&&3>=c}}_processPixels(c){({pixelBlocks:c}=c);return null==c||c.some(e=>null==e)?null:q.local(c,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:c}=this.functionArguments,e=q.operandsCount[c],
n=Object.keys(M.localOperators).find(k=>M.localOperators[k]===c)?.toLowerCase()??"undefined";var h=this.outputPixelType??"f32";let [m,w]=Q.getPixelValueRange(h);if(h=Q.isIntegerPixelType(h))m-=1E-4,w+=1E-4;return{imageCount:e,operationName:n,domainRange:[m,w],isOutputRounded:h}}_updateStatistics(c){var e=this.sourceRasterInfos[0];const {operation:n}=this.functionArguments,h=q.getOutputDomain(n)?.domain;if(h)for(c.statistics=[],e=0;e<c.bandCount;e++)c.statistics[e]={min:h[0],max:h[1],avg:(h[0]+h[1])/
2,stddev:(h[0]+h[1])/10};else 45===n&&e.statistics?.length&&(c.statistics=e.statistics.map(m=>({min:-m.max,max:-m.min,avg:null!=m.avg?-m.avg:void 0,stddev:null!=m.stddev?-m.stddev:void 0})))}_updatePixelType(c){const {statistics:e,pixelType:n}=this.sourceRasterInfos[0];var {operation:h}=this.functionArguments;const {domain:m,isInteger:w}=q.getOutputDomain(h)??{domain:null,isInteger:!1};var k="f32";m&&w?k=Q.getIntegerPixelType(m[0],m[1]):30===h?k=(h=e?.[0])?Q.getIntegerPixelType(h.min,h.max):Q.isIntegerPixelType(n)?
n:"s32":45===h&&Q.isIntegerPixelType(n)&&(k=e?.map(({max:r})=>-r),h=e?.map(({min:r})=>-r),k=k?.length?Math.min(...k):null,h=h?.length?Math.min(...h):null,k=null!=k&&null!=h?Q.getIntegerPixelType(k,h):n.startsWith("s")?n.replace("s","u"):"u1"===n||"u2"===n||"u4"===n?"s8":"u8"===n?"s16":"s32");c.pixelType=this.outputPixelType=this._getOutputPixelType(k)}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:D,json:{write:!0,
name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.LocalFunction")],t)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q){var B;L=B=class extends Q{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(D,q){q.rasters=D.map(c=>"number"===typeof c||"string"===typeof c?c:c.toJSON())}clone(){return new B({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:u.clone(this.rasters)})}};p.__decorate([t.property({json:{write:!0}})],L.prototype,"operation",void 0);p.__decorate([t.property({json:{write:!0}})],L.prototype,"rasters",void 0);p.__decorate([M.writer("rasters")],
L.prototype,"writeRasters",null);p.__decorate([t.property({json:{write:!0}})],L.prototype,"processAsMultiband",void 0);return L=B=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){L=class extends Q{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var q=this.sourceRasterInfos[0].clone();const {pixelType:c}=q;this.outputPixelType=this._getOutputPixelType(c);q.pixelType=this.outputPixelType;this.rasterInfo=q;const {includedRanges:e,normalizedNoDataValues:n}=this.functionArguments;if(!e?.length&&!n?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};
let h=[];for(let m=0;m<q.bandCount;m++){const w=D.createMaskLUT(c,e?.slice(2*m,2*m+2),n?.[m]);if(null==w){h=null;break}h.push(w)}this.lookups=h;q=null!=n&&n.every(m=>m?.length===n[0]?.length);return{success:!0,supportsGPU:(!e||e.length<=2*D.maxMapSizeGpu)&&(!n||q&&n[0].length<=D.maxMapSizeGpu)}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return null;const {outputPixelType:c,lookups:e}=this,{includedRanges:n,noDataInterpretation:h,normalizedNoDataValues:m}=this.functionArguments;return D.mask(q,
{includedRanges:n,noDataValues:m,outputPixelType:c,matchAll:h===D.NoDataInterpretation.matchAll,lookups:e})}_getWebGLParameters(){const {includedRanges:q,normalizedNoDataValues:c}=this.functionArguments,e=new Float32Array(D.maxMapSizeGpu);e.fill(u.numberMaxFloat32);c?.[0]?.length&&e.set(c[0]);const n=new Float32Array(D.maxMapSizeGpu);for(let h=0;h<n.length;h+=2)n[h]=q?.[h]??-u.numberMaxFloat32,n[h+1]=q?.[h+1]??u.numberMaxFloat32;q?.length&&n.set(q);return{bandCount:this.sourceRasterInfos[0].bandCount,
noDataValues:e,includedRanges:n}}};p.__decorate([t.property({json:{write:!0,name:"rasterFunction"}})],L.prototype,"functionName",void 0);p.__decorate([t.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],L.prototype,"functionArguments",void 0);p.__decorate([t.property()],L.prototype,"rasterArgumentNames",void 0);p.__decorate([t.property({json:{write:!0}})],L.prototype,"lookups",void 0);return L=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.MaskFunction")],L)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(p,u,t,L,F,P,M,Q){var B;t=B=class extends M{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=Q.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:D}=this;if(!D?.length)return null;let q=!1;D=D.map(c=>"number"===typeof c?(q=!0,[c]):"string"===typeof c?(c=c.trim().split(" ").filter(e=>""!==e.trim()).map(e=>Number(e)),q=q||0<c.length,0===c.length?null:c):null);return q?D:null}clone(){return new B({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"includedRanges",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"noDataValues",void 0);p.__decorate([u.property()],t.prototype,"normalizedNoDataValues",null);p.__decorate([u.property({json:{write:!0}})],t.prototype,"noDataInterpretation",void 0);return t=B=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
t)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(p,u,t,L,F,P,M,Q,B){t=class extends Q{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {scientificOutput:D,
visibleBandID:q,infraredBandID:c}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(D?"f32":"u8");var e=this.sourceRasterInfos[0];const n=Math.max(q,c);if(2>e.bandCount||n>=e.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};e=e.clone();e.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(e);e.bandCount=1;e.keyProperties={...e.keyProperties,BandProperties:void 0};const [h,m,w,k]=D?[-1,1,0,.1]:[0,
200,100,10];e.statistics=[{min:h,max:m,avg:w,stddev:k}];this.rasterInfo=e;return{success:!0,supportsGPU:!0}}_processPixels(D){D=D.pixelBlocks?.[0];if(null==D)return null;const {visibleBandID:q,infraredBandID:c,scientificOutput:e}=this.functionArguments;return M.calculateNDVI(D,q,c,!e)}_getWebGLParameters(){const {visibleBandID:D,infraredBandID:q,scientificOutput:c}=this.functionArguments;return{bandIndexMat3:M.getBandMatrix3(this.isInputBandIdsSwizzled?[0,1,2]:[q,D,0]),scaled:!c}}_getInputBandIds(D){const {visibleBandID:q,
infraredBandID:c}=this.functionArguments;return[c,q,0].map(e=>D[e])}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],t)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M){var Q;t=Q=class extends M{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:B,infraredBandID:D,scientificOutput:q}=this;return new Q({visibleBandID:B,infraredBandID:D,scientificOutput:q})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"visibleBandID",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"infraredBandID",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"scientificOutput",void 0);return t=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],t)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q){L=class extends B{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const c=this.sourceRasterInfos[0].clone(),{pixelType:e}=c;this.outputPixelType=this._getOutputPixelType(e);c.pixelType=this.outputPixelType;c.bandCount=1;const {statistics:n}=c;this._removeStatsHistColormapVAT(c);const {allowUnmatched:h,outputValues:m,inputRanges:w,noDataRanges:k,isLastInputRangeInclusive:r}=
this.functionArguments;if(null!=n&&n.length&&m?.length)if(h){var a=Math.min.apply(null,[...m,n[0].min]),f=Math.max.apply(null,[...m,n[0].max]);c.statistics=[{...n[0],min:a,max:f}]}else{f=a=m[0];for(let l=0;l<m.length;l++)a=a>m[l]?m[l]:a,f=f>m[l]?f:m[l];c.statistics=[{...n[0],min:a,max:f}]}this.rasterInfo=c;this.lookup=h?null:D.createRemapLUT({srcPixelType:e,inputRanges:w,outputValues:m,noDataRanges:k,allowUnmatched:h,isLastInputRangeInclusive:r,outputPixelType:this.outputPixelType});return{success:!0,
supportsGPU:(!m||m.length<=D.maxMapSizeGpu)&&(!k||k.length<=D.maxMapSizeGpu)}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return null;const {lookup:e,outputPixelType:n}=this;if(e){const a=D.lookupPixels(c,{lut:[e.lut],offset:e.offset,outputPixelType:n});null!=a&&e.mask&&(a.mask=D.lookupBandValues(c.pixels[0],c.mask,e.mask,e.offset,"u8"));return a}const {inputRanges:h,outputValues:m,noDataRanges:w,allowUnmatched:k,isLastInputRangeInclusive:r}=this.functionArguments;return D.remap(c,{inputRanges:h,
outputValues:m,noDataRanges:w,outputPixelType:n,allowUnmatched:k,isLastInputRangeInclusive:r})}_getWebGLParameters(){const {allowUnmatched:c,noDataRanges:e,isLastInputRangeInclusive:n}=this.functionArguments,h=new Float32Array(3*D.maxMapSizeGpu);var m=this.functionArguments.inputRanges??[],w=this.functionArguments.outputValues??[];const k=w.length;for(let r=0;r<D.maxMapSizeGpu;r++)if(h[3*r]=m[2*r]??u.numberMaxFloat32-1,h[3*r+1]=m[2*r+1]??u.numberMaxFloat32,h[3*r+2]=w[r]??0,r<k&&(0<r&&(h[3*r]-=1E-5),
r<k-1||!n))h[3*r+1]-=1E-5;m=new Float32Array(2*D.maxMapSizeGpu);m.fill(u.numberMaxFloat32);e?.length&&m.set(e);w=Q.getPixelValueRange(this.outputPixelType);return{allowUnmatched:c,rangeMaps:h,noDataRanges:m,clampRange:w}}};p.__decorate([t.property({json:{write:!0,name:"rasterFunction"}})],L.prototype,"functionName",void 0);p.__decorate([t.property({type:q,json:{write:!0,name:"rasterFunctionArguments"}})],L.prototype,"functionArguments",void 0);p.__decorate([t.property()],L.prototype,"rasterArgumentNames",
void 0);p.__decorate([t.property({json:{write:!0}})],L.prototype,"lookup",void 0);return L=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.RemapFunction")],L)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(p,u,t,L,F,P,
M){var Q;t=Q=class extends M{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new Q({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"inputRanges",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"outputValues",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"noDataRanges",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"allowUnmatched",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isLastInputRangeInclusive",void 0);return t=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],t)})},"esri/layers/support/rasterFunctions/ShadedReliefFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./ShadedReliefFunctionArguments ./surfaceUtils ../../../renderers/support/colorRampUtils ../../../renderers/support/rasterRendererChecks".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){t=class extends Q{constructor(){super(...arguments);this.functionName="ShadedRelief";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var n=this.sourceRasterInfos[0];if(1<n.bandCount)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: source data must be single band"};let {colorRamp:h,colormap:m}=this.functionArguments;if(!h&&!m?.length)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: a color ramp argument must be specified"};
this.outputPixelType=this._getOutputPixelType("u8");n=n.clone();this._removeStatsHistColormapVAT(n);n.pixelType=this.outputPixelType;n.bandCount=3;n.statistics=[{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10}];this.rasterInfo=n;this.isGCS=n.spatialReference?.isGeographic??!1;m?.length||(m=c.convertColorRampToColormap(h,{interpolateAlpha:!0}));const {indexedColormap:w,offset:k}=B.createColormapLUT({colormap:m});if(!w?.length)return{success:!1,supportsGPU:!1,
error:"shadedrelief-function: a valid colorramp is required"};n=c.createHsvMap(w);this.lookup={indexedColormap:w,offset:k,hsvMap:n};return{success:!0,supportsGPU:e.isColormapSupportedByWebGL(w)}}_processPixels(n){const h=n.pixelBlocks?.[0];if(!h||!this.lookup)return null;let m=n.primaryPixelSizes?.[0];null==m&&({extent:n}=n,m=n?{x:n.width/h.width,y:n.height/h.height}:{x:1,y:1});n=q.getHillshadeOptions(this.functionArguments,m,this.isGCS);n=q.hillshade(h,n);q.tintHillshade(n,h,this.lookup.hsvMap,this.sourceRasterInfos[0].statistics?.[0]??
{min:0,max:8E3});n.pixelType=this.outputPixelType;return n}_getWebGLParameters(){var n=q.getHillshadeOptions(this.functionArguments,{x:1,y:1},this.isGCS);n=q.calculateHillshadeParams(n);const {slopeType:h,zFactor:m,pixelSizeFactor:w,pixelSizePower:k}=this.functionArguments,r="scaled"===h,{indexedColormap:a,offset:f}=this.lookup,l=this.sourceRasterInfos[0].statistics?.[0],d=M.isIntegerPixelType(this.outputPixelType);return{...n,indexedColormap:a,offset:f,zFactor:m,gcsFactor:this.isGCS?q.gcsFactor:
1,pixelSizeFactor:r?w:0,pixelSizePower:r?k:0,minValue:l?.min??0,maxValue:l?.max??8E3,isOutputRounded:d}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isGCS",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"lookup",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.ShadedReliefFunction")],t)})},"esri/layers/support/rasterFunctions/ShadedReliefFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./HillshadeFunctionArguments ../../../renderers/support/colorRampUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;t=D=class extends Q{readColorRamp(q){if("string"===typeof q){const c=B.colorRampDict.jsonValues.find(e=>e.toLowerCase()===q.toLowerCase());return c?B.getColorRampJSON(B.colorRampDict.fromJSON(c)):null}return"toJSON"in q?q.toJSON():q}clone(){return new D({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,
colorRamp:this.colorRamp,colormap:this.colormap,raster:this.raster})}};p.__decorate([u.property({json:{write:!0}})],t.prototype,"colorRamp",void 0);p.__decorate([P.reader("colorRamp")],t.prototype,"readColorRamp",null);p.__decorate([u.property({type:[[Number]],json:{write:!0}})],t.prototype,"colormap",void 0);return t=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.ShadedReliefFunctionArguments")],t)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends Q{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const q=this.sourceRasterInfos[0].clone();q.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(q);q.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;q.bandCount=1;this.rasterInfo=
q;this.isGCS=q.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(q){const c=q.pixelBlocks?.[0];if(null==c)return null;const {zFactor:e,slopeType:n,pixelSizePower:h,pixelSizeFactor:m}=this.functionArguments,{isGCS:w}=this,{extent:k,primaryPixelSizes:r}=q;q=r?.[0];return D.slope(c,{zFactor:e,slopeType:n,pixelSizePower:h,pixelSizeFactor:m,isGCS:w,resolution:null==q?k?{x:k.width/c.width,y:k.height/c.height}:{x:1,y:1}:q})}_getWebGLParameters(){const {zFactor:q,slopeType:c,
pixelSizeFactor:e,pixelSizePower:n}=this.functionArguments,h=this.isGCS&&1<=q?q*D.gcsFactor:q,m=M.isIntegerPixelType(this.outputPixelType);return{zFactor:h,slopeType:c,pixelSizeFactor:e??0,pixelSizePower:n??0,isOutputRounded:m}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:B,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",
void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"isGCS",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],t)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;u=new u.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});B=D=class extends B{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new D({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};p.__decorate([M.enumeration(u)],
B.prototype,"slopeType",void 0);p.__decorate([t.property({type:Number,json:{write:!0}})],B.prototype,"zFactor",void 0);p.__decorate([t.property({type:Number,json:{name:"psPower",write:!0}})],B.prototype,"pixelSizePower",void 0);p.__decorate([t.property({type:Number,json:{name:"psZFactor",write:!0}})],B.prototype,"pixelSizeFactor",void 0);p.__decorate([t.property({type:Boolean,json:{write:!0}})],B.prototype,"removeEdgeEffect",void 0);return B=D=p.__decorate([Q.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
B)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(p,u,t,L,F,P,M,Q,B,D){t=class extends Q{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {type:q}=this.functionArguments.toJSON();if(1>q||7<q)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${q}`};var c=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(c.pixelType);c=c.clone();c.pixelType=this.outputPixelType;const {statisticsType:e}=this.functionArguments;"stddev"===e&&this._removeStatsHistColormapVAT(c);this.rasterInfo=c;return{success:!0,supportsGPU:3>=c.bandCount&&5>
q}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return q;const {statisticsType:c,rows:e,cols:n,fillNoDataOnly:h}=this.functionArguments;return B.computeFocalStatistics(q,{kernelRows:e,kernelCols:n,fillNoDataOnly:h,outputPixelType:this.outputPixelType,statisticsType:c,mirrorEdges:!0})}_getWebGLParameters(){const {rows:q,cols:c,statisticsType:e,fillNoDataOnly:n}=this.functionArguments;return{fillNoDataOnly:n,kernelRows:q,kernelCols:c,statisticsType:e,clampRange:M.getPixelValueRange(this.outputPixelType)}}};
p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],t)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap",
"../PixelBlock","./mirror"],function(p,u,t,L,F){function P(M,Q){const {fillNoDataOnly:B}=Q,{band:D,width:q,height:c,mask:e,outBand:n}=M;if(B&&!e)n.set(D);else{var {kernelRows:h,kernelCols:m}=Q;M=Math.floor(h/2);Q=Math.floor(m/2);var w=n.slice(),k=new Uint32Array(q*c);for(var r=M;r<c-M;r++){var a=r*q;for(var f=Q;f<q-Q;f++){if(B&&e?.[a+f])continue;const l=[];for(let d=0;d<h;d++)for(let b=0;b<m;b++){const g=a+f+(d-M)*q+b-Q;e&&!e[g]||l.push(D[g])}l.length&&(l.sort((d,b)=>d-b),e?(w[a+f]=l[Math.floor((l.length-
1)/2)],k[a+f]=l.length):n[a+f]=l[Math.floor((l.length-1)/2)])}}if(e)for(r=M;r<c-M;r++)for(a=r*q,f=Q;f<q-Q;f++)!k[a+f]||B&&e[a+f]||(n[a+f]=w[a+f],e[a+f]=255)}}u=new t.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});p.computeFocalStatistics=function(M,Q){const {mask:B}=M,{fillNoDataOnly:D}=Q;if(D&&!B)return M;const {pixels:q,width:c,height:e,bandMasks:n,pixelType:h}=M,m=q.length,w=c*e,k=[],{kernelRows:r,kernelCols:a,statisticsType:f,mirrorEdges:l}=
Q;if(D&&!B)return M;const d=Q.outputPixelType??h,b=[];for(let A=0;A<m;A++){const x=q[A],E=L.createEmptyBand(d,w);D&&E.set(x);const N=(n?.[A]??B)?.slice()??null,G={band:x,width:c,height:e,mask:N,outBand:E};switch(f){case "min":case "max":a:{var g=Q;const {fillNoDataOnly:O}=g,{band:H,width:J,height:R,mask:Y,outBand:T}=G;if(O&&!Y){T.set(H);break a}const {kernelRows:X,kernelCols:V,statisticsType:K}=g,S=Math.floor(X/2),Z=Math.floor(V/2),ca="min"===K,I=T.slice(),U=new Uint32Array(J*R);for(let W=S;W<R-S;W++){const aa=
W*J;for(let da=Z;da<J-Z;da++){let ea=ca?Number.MAX_VALUE:-Number.MAX_VALUE,ha=0;for(let ia=0;ia<X;ia++)for(let ka=0;ka<V;ka++){const ma=aa+da+(ia-S)*J+ka-Z;if(!Y||Y[ma])ea=ca?Math.min(ea,H[ma]):Math.max(ea,H[ma]),ha++}Y?(I[aa+da]=0===ha?0:ea,U[aa+da]=ha):T[aa+da]=0===ha?0:ea}}if(Y)for(let W=S;W<R-S;W++){const aa=W*J;for(let da=Z;da<J-Z;da++)!U[aa+da]||O&&Y[aa+da]||(T[aa+da]=I[aa+da],Y[aa+da]=255)}}break;case "mean":case "stddev":a:{var z=Q;const {fillNoDataOnly:O}=z,{band:H,width:J,height:R,mask:Y,
outBand:T}=G;if(O&&!Y){T.set(H);break a}const {statisticsType:X,kernelRows:V,kernelCols:K}=z,S="stddev"===X,Z=J*R,ca=new Float64Array(Z),I=new Float64Array(Z),U=new Uint32Array(Z);for(let ka=0;ka<R;ka++){const ma=ka*J;let pa=0,oa=0,sa=0;for(let qa=0;qa<K;qa++)if(!Y||Y[ma+qa])pa+=H[ma+qa],S&&(oa+=H[ma+qa]**2),sa++;ca[ma]=pa;I[ma]=oa;U[ma]=sa;for(let qa=1;qa<=J-K;qa++){const va=ma+qa-1,ta=va+K;Y?(Y[va]&&(sa--,pa-=H[va],S&&(oa-=H[va]**2)),Y[ta]&&(sa++,pa+=H[ta],S&&(oa+=H[ta]**2))):(pa-=H[va],pa+=H[ta],
S&&(oa-=H[va]**2,oa+=H[ta]**2));ca[ma+qa]=pa;U[ma+qa]=sa;S&&(I[ma+qa]=oa)}}const W=new Float64Array(Z),aa=new Float64Array(Z),da=new Uint32Array(Z),ea=V*J;for(let ka=0;ka<=J-K;ka++){let ma=0,pa=0,oa=0;for(let sa=0;sa<V;sa++){const qa=sa*J+ka;ma+=ca[qa];oa+=U[qa];S&&(pa+=I[qa])}W[ka]=ma;aa[ka]=pa;da[ka]=oa;for(let sa=1;sa<=R-V;sa++){const qa=(sa-1)*J+ka,va=qa+ea;ma-=ca[qa];ma+=ca[va];oa-=U[qa];oa+=U[va];S&&(pa-=I[qa],pa+=I[va]);W[sa*J+ka]=ma;aa[sa*J+ka]=pa;da[sa*J+ka]=oa}}const ha=Math.floor(V/2),
ia=Math.floor(K/2);for(let ka=ha;ka<R-ha;ka++){const ma=ka*J;for(let pa=ia;pa<J-ia;pa++){const oa=(ka-ha)*J+pa-ia,sa=da[oa];if(0===sa||O&&(!Y||Y[ma+pa]))continue;const qa=W[oa]/sa;T[ma+pa]=S?Math.sqrt((aa[oa]-W[oa]*qa)/sa):qa;Y&&(Y[ma+pa]=255)}}}break;case "median":P(G,Q);break;case "majority":case "minority":a:{var v=Q;const {fillNoDataOnly:O}=v,{band:H,width:J,height:R,mask:Y,outBand:T}=G;if(O&&!Y){T.set(H);break a}const {kernelRows:X,kernelCols:V}=v,K=Math.floor(X/2),S=Math.floor(V/2),Z="majority"===
v.statisticsType,ca=X*V,I=T.slice(),U=new Uint32Array(J*R);for(let W=K;W<R-K;W++){const aa=W*J;for(let da=S;da<J-S;da++){if(O&&Y?.[aa+da])continue;const ea=new Map;for(let ma=0;ma<X;ma++)for(let pa=0;pa<V;pa++){const oa=aa+da+(ma-K)*J+pa-S;if(Y&&!Y[oa])continue;const sa=H[oa];ea.set(sa,ea.has(sa)?ea.get(sa)+1:1)}if(0===ea.size)continue;let ha=0,ia=0,ka=Z?0:ca+1;for(const ma of ea.keys())ia=ea.get(ma),Z===ia>ka&&(ka=ia,ha=ma);Y?(I[aa+da]=ha,U[aa+da]=ea.size):T[aa+da]=ha}}if(Y)for(let W=K;W<R-K;W++){const aa=
W*J;for(let da=S;da<J-S;da++)!U[aa+da]||O&&Y[aa+da]||(T[aa+da]=I[aa+da],Y[aa+da]=255)}}}l&&!D&&F.mirror(E,c,e,r,a);k.push(E);N&&b.push(N)}let C=b[0]??B;b.length!==m&&(b.length=0);1<m&&n?.length&&(C=L.combineBandMasks(n));const y=new L({pixelType:d,width:c,height:e,pixels:k,bandMasks:n&&b.length?b:null,mask:C});y.updateStatistics();return y};p.statisticsTypeMap=u;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;L=D=class extends Q{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new D({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:u.clone(this.raster)})}};p.__decorate([t.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(q,c)=>Number(q??c?.kernelRows??3)}}})],L.prototype,"rows",void 0);p.__decorate([t.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(q,c)=>Number(q??c?.kernelCols??3)}}})],L.prototype,"cols",void 0);p.__decorate([t.property({json:{write:!0}})],L.prototype,"fillNoDataOnly",void 0);p.__decorate([t.property({json:{read:{source:["statisticsType","type"],reader:(q,c)=>B.statisticsTypeMap.fromJSON(c?.statisticsType??c?.type)??"min"},write:{target:"type"}}}),P.enumeration(B.statisticsTypeMap)],L.prototype,"statisticsType",void 0);return L=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
L)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(p,u,t,L,F,P,M,Q){t=class extends M{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var B=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");B=B.clone();const {statistics:D,histograms:q}=this.functionArguments;q&&(B.histograms=q);D&&(B.statistics=D);this.rasterInfo=B;return{success:!0,supportsGPU:!0}}_processPixels(B){return B.pixelBlocks?.[0]}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],
t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"indexedColormap",void 0);p.__decorate([u.property()],t.prototype,"isNoopProcess",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],t)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B){var D;L=D=class extends B{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(q,c){if(!q?.length)return null;const e=[];q.forEach(n=>{e.push({min:n.min,max:n.max,avg:n.avg??n.mean,stddev:n.stddev??n.standardDeviation})});return e}writeStatistics(q,c,e){if(q?.length){var n=[];q.forEach(h=>{h={...h,mean:h.avg,standardDeviation:h.stddev};delete h.avg;delete h.stddev;n.push(h)});c[e]=n}}clone(){return new D({statistics:u.clone(this.statistics),
histograms:u.clone(this.histograms)})}};p.__decorate([t.property({json:{write:!0}})],L.prototype,"statistics",void 0);p.__decorate([P.reader("statistics")],L.prototype,"readStatistics",null);p.__decorate([Q.writer("statistics")],L.prototype,"writeStatistics",null);p.__decorate([t.property({json:{write:!0}})],L.prototype,"histograms",void 0);return L=D=p.__decorate([M.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],L)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q){t=class extends Q{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var c=this.sourceRasterInfos[0],{pixelType:e}=c,{functionArguments:n}=this;const {dynamicRangeAdjustment:h,gamma:m,useGamma:w}=n;if(!h&&["u8","u16","s8","s16"].includes(e)){n=q.getStretchCutoff(n.toJSON(),{rasterInfo:c});const a=M.isIntegerPixelType(this.outputPixelType)?
"round":"float";this.lookup=q.createStretchLUT({pixelType:e,...n,gamma:w?m:null,rounding:a});this.cutOffs=n}else h||(this.cutOffs=q.getStretchCutoff(n.toJSON(),{rasterInfo:c}));this.outputPixelType=this._getOutputPixelType(e);c=c.clone();c.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(c);"u8"===this.outputPixelType&&(c.keyProperties.DataType="processed");const {outputMin:k=0,outputMax:r=255}=this.functionArguments;c.statistics=[];for(e=0;e<c.bandCount;e++)c.statistics[e]={min:k,
max:r};this.rasterInfo=c;return{success:!0,supportsGPU:!h}}_processPixels(c){c=c.pixelBlocks?.[0];if(null==c)return c;var {lookup:e}=this;if(e)return B.lookupPixels(c,{...e,outputPixelType:this.rasterInfo.pixelType});({functionArguments:e}=this);const n=this.cutOffs||q.getStretchCutoff(e.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:c});return q.stretch(c,{...n,gamma:e.useGamma?e.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:c=0,outputMax:e=255,
gamma:n,useGamma:h}=this.functionArguments,m=2<=this.rasterInfo.bandCount?3:1,w=h&&n?.length?q.computeGammaCorrection(m,n):[1,1,1],{minCutOff:k,maxCutOff:r}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===k.length&&(k[1]=k[2]=k[0],r[1]=r[2]=r[0]);const a=new Float32Array(m);var f;for(f=0;f<m;f++)a[f]=(e-c)/(r[f]-k[f]);f=M.isIntegerPixelType(this.outputPixelType);return{bandCount:m,outMin:c,outMax:e,minCutOff:k,maxCutOff:r,factor:a,useGamma:h,gamma:h&&n?n:[1,1,1],gammaCorrection:h&&w?
w:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:f,type:"stretch"}}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",void 0);p.__decorate([u.property({type:D,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property({json:{write:!0}})],t.prototype,"lookup",void 0);p.__decorate([u.property({json:{write:!0}})],
t.prototype,"cutOffs",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.StretchFunction")],t)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){var q;u=new u.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});D=q=class extends D{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(c,e,n){c?.length&&(Array.isArray(c[0])||(c=c.map(h=>[h.min,h.max,h.avg,h.stddev])),e[n]=c)}clone(){return new q({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:t.clone(this.statistics),gamma:t.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:t.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};p.__decorate([L.property({type:Boolean,json:{write:!0}})],D.prototype,
"computeGamma",void 0);p.__decorate([L.property({type:Boolean,json:{name:"dra",write:!0}})],D.prototype,"dynamicRangeAdjustment",void 0);p.__decorate([L.property({type:[Number],json:{write:!0}})],D.prototype,"gamma",void 0);p.__decorate([L.property()],D.prototype,"histograms",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],D.prototype,"maxPercent",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],D.prototype,"minPercent",void 0);p.__decorate([L.property({type:Number,
json:{write:!0}})],D.prototype,"numberOfStandardDeviations",void 0);p.__decorate([L.property({type:Number,json:{name:"max",write:!0}})],D.prototype,"outputMax",void 0);p.__decorate([L.property({type:Number,json:{name:"min",write:!0}})],D.prototype,"outputMin",void 0);p.__decorate([L.property({type:Number,json:{write:!0}})],D.prototype,"sigmoidStrengthLevel",void 0);p.__decorate([L.property({json:{type:[[Number]],write:!0}})],D.prototype,"statistics",void 0);p.__decorate([B.writer("statistics")],D.prototype,
"writeStatistics",null);p.__decorate([M.enumeration(u)],D.prototype,"stretchType",void 0);p.__decorate([L.property({type:Boolean,json:{write:!0}})],D.prototype,"useGamma",void 0);return D=q=p.__decorate([Q.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],D)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(p,u,t,L,F,P,M,Q){t=class extends M{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var B=this.sourceRasterInfos[0];if(1<B.bandCount||B.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:D}=this.functionArguments;if(!D)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(B.pixelType);B=B.clone();B.pixelType=this.outputPixelType;B.bandCount=1;"thematic"!==B.dataType&&(B.keyProperties=B.keyProperties?{...B.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=B;return{success:!0,supportsGPU:!0}}_processPixels(B){return B.pixelBlocks?.[0]}};p.__decorate([u.property({json:{write:!0,name:"rasterFunction"}})],t.prototype,"functionName",
void 0);p.__decorate([u.property({type:Q,json:{write:!0,name:"rasterFunctionArguments"}})],t.prototype,"functionArguments",void 0);p.__decorate([u.property()],t.prototype,"rasterArgumentNames",void 0);p.__decorate([u.property()],t.prototype,"isNoopProcess",void 0);return t=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.TableFunction")],t)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(p,u,t,L,F,P,M){var Q;L=Q=class extends M{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new Q({attributeTableAsRecordSet:u.clone(this.attributeTableAsRecordSet)})}};p.__decorate([t.property({json:{write:!0}})],L.prototype,"attributeTableAsRecordSet",void 0);return L=Q=p.__decorate([P.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],L)})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/unitUtils ../../layers/support/Field ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./rasterRendererChecks ./UniqueValueInfo ../visualVariables/ColorVariable ../visualVariables/SizeVariable ../visualVariables/support/ColorStop ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../../symbols/SimpleFillSymbol ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b){function g(K,S){K=z(K,S?.variableName);const {bandCount:Z}=K;let {bandIds:ca,stretchType:I}=S||{};ca?.some(ea=>ea>=Z)&&(ca=null);let U=K.statistics,W=K.histograms;1<Z?(ca=ca?.length?ca:v(K),U=null==U?null:ca?.map(ea=>U[ea]),W=null==W?null:ca?.map(ea=>W[ea])):ca=[0];null==I&&(I=y(K));S?.includeStatisticsInStretch&&("percent-clip"===I||"histogram-equalization"===I)&&K.statistics?.length&&(I="min-max");let aa=!1;switch(I){case "none":aa=!1;break;
case "percent-clip":aa=!W?.length;break;default:aa=!U?.length}var {dataType:da}=K;da=1===ca?.length&&X.has(da)?Y:null;da=new r({stretchType:I,dynamicRangeAdjustment:aa,colorRamp:da,outputMin:0,outputMax:255,gamma:1===ca?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===I?da.maxPercent=da.minPercent=.25:"standard-deviation"===I&&(da.numberOfStandardDeviations=2);if(!aa&&(null!=K.multidimensionalInfo||S?.includeStatisticsInStretch))if("percent-clip"===I)da.histograms=W;else if("min-max"===I||"standard-deviation"===
I)da.statistics=U;return da}function z(K,S){var {multidimensionalInfo:Z}=K;if(!S||!Z)return K;Z=Z.variables.find(ca=>ca.name===S);if(!Z)return K;K=K.clone();if(Z){const {statistics:ca,histograms:I}=Z;ca?.length&&(K.statistics=ca.map(U=>({min:U.min,max:U.max,avg:U.avg,stddev:U.stddev})));I?.length&&(K.histograms=I)}return K}function v(K){const S=K.bandCount;if(1===S)return null;if(2===S)return[0];({bandInfos:K}=K);let Z;if(K.length===S){const {red:ca,green:I,blue:U,nir:W}=C(K);null!=ca&&null!=I&&null!=
U?Z=[ca,I,U]:null!=W&&null!=ca&&null!=I&&(Z=[W,ca,I])}!Z&&3<=S&&(Z=[0,1,2]);return Z}function C(K){const S={};for(let I=0;I<K.length;I++){var Z=K[I],ca=Z.name.toLowerCase();"red"===ca?S.red=I:"green"===ca?S.green=I:"blue"===ca?S.blue=I:"nearinfrared"===ca||"nearinfrared_1"===ca||"nir"===ca?S.nir=I:Z.maxWavelength&&Z.minWavelength&&(ca=Z.minWavelength,Z=Z.maxWavelength,null==S.blue&&410<=ca&&480>=ca&&480<=Z&&540>=Z?S.blue=I:null==S.green&&490<=ca&&560>=ca&&560<=Z&&610>=Z?S.green=I:null==S.red&&595<=
ca&&670>=ca&&660<=Z&&730>=Z?S.red=I:null==S.nir&&700<=ca&&860>=ca&&800<=Z&&950>=Z&&(S.nir=I))}return S}function y(K){let S="percent-clip";const {pixelType:Z,dataType:ca,histograms:I,statistics:U,multidimensionalInfo:W}=K;K=X.has(ca)||"generic"===ca&&null!=W;"u8"!==Z||"processed"!==ca&&null!=I&&null!=U?"u8"===Z||"elevation"===ca||K?S="min-max":null!=I?S="percent-clip":null!=U&&(S="min-max"):S="none";return S}function A(K,S,Z,ca){if(!D.isUVRendererSupported(K,S))return null;const {attributeTable:I,
statistics:U}=K,W=x(I,S),aa=N(I,"red"),da=N(I,"green"),ea=N(I,"blue");K=new M;const ha=[],ia=new Set,ka=!!(aa&&da&&ea);if(null!=I)I.features.forEach(ma=>{var pa=ma.attributes[W.name];ia.has(ma.attributes[W.name])||null==pa||(ia.add(pa),pa=!ka||"single"!==aa.type&&"double"!==aa.type||"single"!==da.type&&"double"!==da.type||"single"!==ea.type&&"double"!==ea.type||I.features.some(oa=>1<oa.attributes[aa.name]||1<oa.attributes[da.name]||1<oa.attributes[ea.name])?1:255,ha.push(new q({value:ma.attributes[W.name],
label:ma.attributes[W.name]+"",symbol:new k({style:"solid",outline:null,color:ka?new u([ma.attributes[aa.name]*pa,ma.attributes[da.name]*pa,ma.attributes[ea.name]*pa,1]):new u([0,0,0,0])})})))});else if(U?.[0])for(S=U[0].min;S<=U[0].max;S++)ha.push(new q({value:S,label:S.toString(),symbol:new k({style:"solid",outline:null,color:new u([0,0,0,0])})}));ha.sort((ma,pa)=>ma.value&&"string"===typeof ma.value.valueOf()?0:ma.value>pa.value?1:-1);if(!ka){const ma=B.convertColorRampToColormap(T,{numColors:ha.length});
ha.forEach((pa,oa)=>pa.symbol.color=new u(ma[oa].slice(1,4)));K.colorRamp=T}if(Z||ca){const ma=Z||B.convertColorRampToColormap(ca,{numColors:ha.length}).map(pa=>pa.slice(1));ha.forEach((pa,oa)=>pa.symbol.color=new u(ma[oa]));K.colorRamp=ca}return new a({field:W.name,uniqueValueInfos:ha,authoringInfo:K})}function x(K,S,Z){let ca;null!=K?(ca=S?K.fields.find(I=>S.toLowerCase()===I.name.toLowerCase()):E(K.fields),ca||(Z||(ca=K.fields.find(I=>"string"===I.type)),ca||=N(K,"value"))):ca=new F({name:"value"});
return ca}function E(K){let S;for(let Z=0;Z<K.length;Z++){const ca=K[Z].name.toLowerCase();if("string"===K[Z].type){if(ca.startsWith("class")){S=K[Z];break}null==S&&(ca.endsWith("name")||ca.endsWith("type"))&&(S=K[Z])}}return S}function N(K,S){return null==K?null:K.fields.find(Z=>Z.name.toLowerCase()===S)}function G(K){if(!D.isColormapRendererSupported(K))return null;let S;const {attributeTable:Z,colormap:ca}=K;if(null!=Z){const I=N(Z,"value"),U=x(Z,null,!0);"string"===U.type&&(S={},Z.features.forEach(W=>
{W=W.attributes;S[W[I.name]]=U?W[U.name]:W[I.name]}))}return f.createFromColormap(ca,S)}function O(K,S,Z){let ca=0,I=0;null!=K.attributeTable?(K=K.attributeTable,ca=I=K.features[0].attributes[S.name],K.features.forEach(U=>{U=U.attributes[S.name];U<ca&&(ca=U);U>I&&(I=U)})):null!=K.histograms&&(K=K.histograms,ca=K[0].min,I=K[0].max);return(I-ca)/Z}function H(K){if(!D.isVectorFieldRendererSupported(K))return null;if(null!=K.statistics&&K.statistics.length&&("vector-magdir"===K.dataType||"vector-uv"===
K.dataType)){const {minMagnitude:Z,maxMagnitude:ca}=R(K.dataType,K.statistics);var S=[new e({field:"Magnitude",minSize:10,maxSize:40,minDataValue:Z,maxDataValue:ca})]}K=null!=K.multidimensionalInfo?V.get(K.multidimensionalInfo.variables[0].unit):void 0;S=new b({visualVariables:S,inputUnit:K,rotationType:"geographic"});S.visualVariables=[...S.sizeVariables,...S.rotationVariables];return S}function J(K){return{color:K.symbolLayers[0].material?.color,type:"esriSFS",style:"esriSFSSolid"}}function R(K,
S){if("vector-magdir"===K)K=S[0].min,S=S[0].max;else{const Z=S[0].min,ca=S[0].max,I=S[1].min;S=S[1].max;K=0;S=Math.max(Math.abs(Z),Math.abs(I),Math.abs(ca),Math.abs(S))}return{minMagnitude:K,maxMagnitude:S}}const Y=w.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),T=w.fromJSON(B.predefinedJsonColorRamps[0]),X=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),
V=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);p.createClassBreaksRenderer=function(K,S){K=z(K,S?.variableName);const {attributeTable:Z}=K;if(!D.isClassBreaksSupported(K))return null;const ca=null!=K.histograms?K.histograms[0]:null,I=null!=S?.numClasses&&isFinite(S?.numClasses)?S.numClasses:5,U=new M({classificationMethod:S?.classificationMethod,colorRamp:S?.colorRamp});let W=S?.field||"value";const aa=[],
da=[],ea=null!=Z,ha=ea&&Z.fields.find(oa=>"count"===oa.name.toLowerCase()),ia=ea?Z.fields.find(oa=>oa.name.toLowerCase()===W.toLowerCase()):void 0;if(ia&&ea){W=ia.name;const oa=Z.features.length;let sa=0;Z.features.forEach(qa=>sa+=(ha?qa.attributes[ha.name]:50)/oa);Z.features.forEach(qa=>{const va=qa.attributes[ia.name];qa=ha?qa.attributes[ha.name]:50;if(0<qa){da.push(qa);qa=Math.max(1,Math.round(qa/oa/sa*1E3));for(let ta=0;ta<qa;ta++)aa.push(va)}})}else{var {pixelType:ka}=K;const oa=(ca.max-ca.min)/
ca.size,sa=(ka=ka.includes("s")||ka.includes("u"))&&1===oa?Math.floor(ca.min+.5):ca.min,qa=ka&&1===oa?Math.floor(ca.max-.5):ca.max,va=ca.size;let ta=0,wa;ca.counts.forEach(ba=>ta+=ba/va);ca.counts.forEach((ba,la)=>{if(0<ba)for(da.push(ba),ba=Math.max(1,Math.round(ba/va/ta*1E3)),wa=ea?Z.features[la].attributes[ia.name]:0===la?sa:la===va-1?qa:ca.min+oa*(la+.5),la=0;la<ba;la++)aa.push(wa)})}ka=S?.classificationMethod||"natural-breaks";let ma=S?.definedInterval;"defined-interval"!==ka||ma||(ma=O(K,ia,
I));K=m.createGenerateRendererClassBreaks({values:aa,valueFrequency:da,normalizationTotal:null,definition:new h({classificationMethod:ka,breakCount:I,definedInterval:ma})});let pa=S?.colors;pa||(S=S?.colorRamp||Y,U.colorRamp=S,pa=B.convertColorRampToColormap(S,{numColors:K.classBreaks.length,interpolateAlpha:!0}).map(oa=>oa.slice(1)));S=K.classBreaks.map((oa,sa)=>new Q({minValue:oa.minValue,maxValue:oa.maxValue,label:oa.label,symbol:new k({color:pa[sa]})}));return new d({field:W,classBreakInfos:S,
authoringInfo:U})};p.createColormapRenderer=G;p.createDefaultRenderer=function(K,S){const {attributeTable:Z,colormap:ca}=K;if(D.isVectorFieldRendererSupported(K)){var I=H(K);if(null!=I)return I}return S?.rasterFunctionColorRamp?(K=g(K,S),K.colorRamp=S.rasterFunctionColorRamp,K):null!=ca&&(I=G(K),null!=I)||null!=Z&&(I=A(K),null!=I)?I:g(K,S)};p.createFlowRenderer=function(K){if(!D.isFlowRendererSupported(K))return null;let S;if(null!=K.statistics&&0<K.statistics.length&&("vector-magdir"===K.dataType||
"vector-uv"===K.dataType)){const {minMagnitude:Z,maxMagnitude:ca}=R(K.dataType,K.statistics);S=[new c({field:"Magnitude",stops:[new n({value:Z,color:new u("#1020c0")}),new n({value:ca,color:new u("#c02010")})]})]}return new P({visualVariables:S})};p.createShadedReliefRenderer=function(K,S="traditional"){if(!D.isShadedReliefRendererSupported(K))return null;({extent:K}=K);K=K.width*L.getMetersPerUnitForSR(K.spatialReference);return new l({hillshadeType:S,scalingType:5E6<K?"adjusted":"none"})};p.createStretchRenderer=
g;p.createUVRenderer=A;p.createVectorFieldRenderer=H;p.estimateMagnitudeRange=R;p.getBandNames=function(K,S){const Z=K.bandInfos.map(({name:ca})=>ca);return S?.length?S.map(ca=>Z[ca]):Z};p.getClassField=x;p.getDefaultBandCombination=v;p.getDefaultInterpolation=function(K,S,Z){const ca=Z?.toLowerCase().replace("bicubic","cubic");Z=["nearest","bilinear","cubic","majority"].find(I=>I===ca);return"Map"===S?Z??"bilinear":"standard-time"===K.dataType?Z??"nearest":"thematic"===K.dataType||K.attributeTable||
K.colormap?"nearest"===Z||"majority"===Z?Z:"nearest":Z??"bilinear"};p.getDefinedInterval=O;p.getField=N;p.getFunctionColorRamp=function(K){return"Function"===K.datasetFormat&&"Colormap"===K.rasterFunction.functionName?K.rasterFunction.colorRamp:void 0};p.getSupportedRendererTypes=function(K,S=!1){const Z=["raster-stretch"];D.isColormapRendererSupported(K,S)&&Z.push("raster-colormap");D.isUVRendererSupported(K)&&Z.push("unique-value");D.isClassBreaksSupported(K,S)&&Z.push("class-breaks");D.isShadedReliefRendererSupported(K)&&
Z.push("raster-shaded-relief");D.isVectorFieldRendererSupported(K)&&Z.push("vector-field");D.isFlowRendererSupported(K)&&Z.push("flow");return Z};p.getVariableRasterInfo=z;p.getWellKnownBandIndexes=C;p.matchPresetRenderer=function(K){return K.presetRenderers?.find(({method:S,value:Z})=>"raster-function-template"===S?Z===K.rasterFunctionName:"variable"===S?Z===K.variableName:!1)};p.normalizeRendererJSON=function(K){if("uniqueValue"===K.type){var S=K.uniqueValueInfos;S?.[0].symbol?.symbolLayers?.length&&
(K.uniqueValueInfos=S?.map(Z=>({value:Z.value,label:Z.label,symbol:Z.symbol?J(Z.symbol):null})));return K}"classBreaks"===K.type&&(S=K.classBreakInfos,S[0].symbol?.symbolLayers?.length&&(K.classBreakInfos=S.map(Z=>({classMinValue:Z.classMinValue,classMaxValue:Z.classMaxValue,label:Z.label,symbol:Z.symbol?J(Z.symbol):null}))));return K};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,u,t,L,F,P,M,Q,B){F=new u.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});u=new u.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});t=class extends t.JSONSupport{constructor(D){super(D);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(D){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",D)}set definedInterval(D){"defined-interval"===this.classificationMethod&&this._set("definedInterval",D)}};p.__decorate([Q.enumeration({classBreaksDef:"class-breaks-definition"})],t.prototype,"type",void 0);p.__decorate([L.property({json:{write:!0}})],t.prototype,
"breakCount",void 0);p.__decorate([L.property({json:{write:!0}})],t.prototype,"classificationField",void 0);p.__decorate([L.property({type:String,json:{read:F.read,write:F.write}})],t.prototype,"classificationMethod",void 0);p.__decorate([L.property({json:{write:!0}})],t.prototype,"normalizationField",void 0);p.__decorate([L.property({json:{read:u.read,write:u.write}})],t.prototype,"normalizationType",void 0);p.__decorate([L.property({value:null,json:{write:!0}})],t.prototype,"standardDeviationInterval",
null);p.__decorate([L.property({value:null,json:{write:!0}})],t.prototype,"definedInterval",null);return t=p.__decorate([B.subclass("esri.rest.support.ClassBreaksDefinition")],t)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(p,u){function t(c){var e=c.definition;const {classificationMethod:n,normalizationType:h,definedInterval:m}=e;e=e.breakCount??1;const w=[];var k=c.values;if(0===k.length)return[];k=k.sort((b,g)=>b-g);var r=k[0],a=k[k.length-
1];if("equal-interval"===n)if(k.length>=e){k=(a-r)/e;c=r;for(var f=1;f<e;f++){var l=Number((r+f*k).toFixed(6));w.push({minValue:c,maxValue:l,label:L(c,l,h)});c=l}w.push({minValue:c,maxValue:a,label:L(c,a,h)})}else k.forEach(b=>{w.push({minValue:b,maxValue:b,label:L(b,b,h)})});else if("natural-breaks"===n){k=F(k);c=P(k.uniqueValues,c.valueFrequency||k.valueFrequency,e);for(f=1;f<e;f++)k.uniqueValues.length>f&&(l=Number(k.uniqueValues[c[f]].toFixed(6)),w.push({minValue:r,maxValue:l,label:L(r,l,h)}),
r=l);w.push({minValue:r,maxValue:a,label:L(r,a,h)})}else if("quantile"===n)if(k.length>=e&&r!==a){c=Math.ceil(k.length/e);f=0;for(l=1;l<e;l++){var d=c+f-1;d>k.length&&(d=k.length-1);0>d&&(d=0);w.push({minValue:r,maxValue:k[d],label:L(r,k[d],h)});r=k[d];f+=c;c=Math.ceil((k.length-f)/(e-l))}w.push({minValue:r,maxValue:a,label:L(r,a,h)})}else for(e=-1,a=0;a<k.length;a++)r=k[a],r!==e&&(e=r,w.push({minValue:e,maxValue:r,label:L(e,r,h)}),e=r);else if("standard-deviation"===n)if(c=B(k),f=D(k,c),0===f)w.push({minValue:k[0],
maxValue:k[0],label:L(k[0],k[0],h)});else{k=Q(r,a,e,c,f)*f;f=0;for(l=e;1<=l;l--)d=Number((c-(l-.5)*k).toFixed(6)),w.push({minValue:r,maxValue:d,label:L(r,d,h)}),r=d,f++;l=Number((c+.5*k).toFixed(6));w.push({minValue:r,maxValue:l,label:L(r,l,h)});r=l;f++;for(d=1;d<=e;d++)l=f===2*e?a:Number((c+(d+.5)*k).toFixed(6)),w.push({minValue:r,maxValue:l,label:L(r,l,h)}),r=l,f++}else if("defined-interval"===n){if(!m)return w;e=k[0];a=k[k.length-1];k=Math.ceil((a-e)/m);r=e;for(c=1;c<k;c++)f=Number((e+c*m).toFixed(6)),
w.push({minValue:r,maxValue:f,label:L(r,f,h)}),r=f;w.push({minValue:r,maxValue:a,label:L(r,a,h)})}return w}function L(c,e,n){let h=null;return h=c===e?n&&"percent-of-total"===n?c+"%":c.toString():n&&"percent-of-total"===n?c+"% - "+e+"%":c+" - "+e}function F(c){const e=[],n=[];let h=Number.MIN_VALUE,m=1,w=-1;for(let k=0;k<c.length;k++){const r=c[k];r===h?(m++,n[w]=m):null!==r&&(e.push(r),h=r,m=1,n.push(m),w++)}return{uniqueValues:e,valueFrequency:n}}function P(c,e,n){var h=c.length;const m=[];n>h&&
(n=h);for(var w=0;w<n;w++)m.push(Math.round(w*h/n-1));m.push(h-1);w=M(m,c,e,n);h=w.mean;w=w.sdcm;var k=n,r=0,a=0;let f=0,l=0,d=!0;for(let g=0;2>g&&d;g++){0===g&&(d=!1);for(var b=0;b<k-1;b++)for(;m[b+1]+1!==m[b+2];)if(m[b+1]+=1,r=q(b,m,c,e),f=r.sbMean,r=r.sbSdcm,a=q(b+1,m,c,e),l=a.sbMean,a=a.sbSdcm,r+a<w[b]+w[b+1])w[b]=r,w[b+1]=a,h[b]=f,h[b+1]=l,d=!0;else{--m[b+1];break}for(b=k-1;0<b;b--)for(;m[b]!==m[b-1]+1;)if(--m[b],r=q(b-1,m,c,e),f=r.sbMean,r=r.sbSdcm,a=q(b,m,c,e),l=a.sbMean,a=a.sbSdcm,r+a<w[b-
1]+w[b])w[b-1]=r,w[b]=a,h[b-1]=f,h[b]=l,d=!0;else{m[b]+=1;break}}d&&(w=M(m,c,e,n));return m}function M(c,e,n,h){let m=[];var w=[],k=[];let r=0;const a=[],f=[];for(var l=0;l<h;l++){var d=q(l,c,e,n);a.push(d.sbMean);f.push(d.sbSdcm);r+=f[l]}d=r;for(l=!0;l||r<d;){l=!1;m=[];for(w=0;w<h;w++)m.push(c[w]);for(k=0;k<h;k++)for(d=c[k]+1;d<=c[k+1];d++)if(w=e[d],0<k&&d!==c[k+1]&&Math.abs(w-a[k])>Math.abs(w-a[k-1]))c[k]=d;else if(k<h-1&&c[k]!==d-1&&Math.abs(w-a[k])>Math.abs(w-a[k+1])){c[k+1]=d-1;break}d=r;r=0;
w=[];k=[];for(let b=0;b<h;b++){w.push(a[b]);k.push(f[b]);const g=q(b,c,e,n);a[b]=g.sbMean;f[b]=g.sbSdcm;r+=f[b]}}if(r>d){for(e=0;e<h;e++)c[e]=m[e],a[e]=w[e],f[e]=k[e];r=d}return{mean:a,sdcm:f}}function Q(c,e,n,h,m){c=Math.max(h-c,e-h)/m/n;return 1<=c?1:.5<=c?.5:.25}function B(c){let e=0;for(let n=0;n<c.length;n++)e+=c[n];return e/=c.length}function D(c,e){let n=0;for(let h=0;h<c.length;h++){const m=c[h];n+=(m-e)*(m-e)}n/=c.length;return Math.sqrt(n)}function q(c,e,n,h){var m=0,w=0;for(var k=e[c]+
1;k<=e[c+1];k++){const r=h[k];m+=n[k]*r;w+=r}0>=w&&u.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");m/=w;w=0;for(k=e[c]+1;k<=e[c+1];k++)w+=h[k]*(n[k]-m)**2;return{sbMean:m,sbSdcm:w}}p.createGenerateRendererClassBreaks=function(c){const {normalizationTotal:e}=c;return{classBreaks:t(c),normalizationTotal:e}};p.createGenerateRendererUniqueValues=function(c){c=F(c);const e=[],n=c.uniqueValues.length;for(let h=0;h<n;h++){const m=c.uniqueValues[h];e.push({value:m,
count:c.valueFrequency[h],label:m.toString()})}return{uniqueValues:e}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){function n(k){return"percentClip"===k||"histogramEqualization"===k}function h(k){return null!=k&&0<k.length&&null!=k[0].min&&null!=k[0].max}function m(k){return B.isValidPixelBlock(k)&&0!==k.validPixelCount}function w(k){return"algorithmic"===k.type&&["0,0,0,255","0,0,0"].includes(k.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(k.toColor.join(","))}u=class extends u.JSONSupport{constructor(k){super(k)}bind(){const {rendererJSON:k}=this;if(!k)return{success:!1};
this.lookup={rendererJSON:{}};let r;switch(k.type){case "uniqueValue":r=this._updateUVRenderer(k);break;case "rasterColormap":r=this._updateColormapRenderer(k);break;case "rasterStretch":r=this._updateStretchRenderer(k);break;case "classBreaks":r=this._updateClassBreaksRenderer(k);break;case "rasterShadedRelief":r=this._updateShadedReliefRenderer(k);break;case "vectorField":r=this._updateVectorFieldRenderer();break;case "flowRenderer":r=this._updateFlowRenderer()}return r}symbolize(k){let r=k?.pixelBlock;
if(!m(r))return r;if(k.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(r,k.simpleStretchParams);try{3<r.pixels.length&&(r=r.extractBands(k.bandIds??[0,1,2]));let a;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":a=this._symbolizeColormap(r);break;case "classBreaks":a=this._symbolizeClassBreaks(r);break;case "rasterStretch":a=this._symbolizeStretch(r,k.bandIds);break;case "rasterShadedRelief":const f=k.extent;a=this._symbolizeShadedRelief(r,
{isGCS:f.spatialReference.isGeographic,resolution:{x:(f.xmax-f.xmin)/r.width,y:(f.ymax-f.ymin)/r.height}})}return a}catch(a){return t.getLogger(this).error("symbolize",a.message),r}}simpleStretch(k,r){if(!m(k))return k;try{return 3<k.pixels.length&&(k=k.extractBands([0,1,2])),D.stretch(k,{...r,isRenderer:!0})}catch(a){return t.getLogger(this).error("symbolize",a.message),k}}generateWebGLParameters(k){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:d,
offset:b}=this.lookup.colormapLut||{};return{colormap:d,colormapOffset:b,isClassBreaks:"classBreaks"===this.rendererJSON.type,type:"lut"}}const {pixelBlock:r,isGCS:a,resolution:f,bandIds:l}=k;({rendererJSON:k}=this);return"rasterStretch"===k.type?this._generateStretchWebGLParams(r,k,l):"rasterShadedRelief"===k.type?this._generateShadedReliefWebGLParams(k,a,f??void 0):"vectorField"===k.type?this._generateVectorFieldWebGLParams(k):null}_isLUTChanged(k){if(!this.lookup||!this.lookup.rendererJSON)return!0;
if("colorRamp"in this.rendererJSON){const r=this.rendererJSON.colorRamp;if(k)return JSON.stringify(r)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(k){return this._isLUTChanged()&&!this.bind().success?k:B.colorize(k,this.lookup.colormapLut)}_symbolizeClassBreaks(k){const {canUseIndexedLUT:r}=this._analyzeClassBreaks(this.rendererJSON);
return this._isLUTChanged()&&!this.bind().success?k:r?B.colorize(k,this.lookup.colormapLut):B.remapColor(k,this.lookup.remapLut??[])}_symbolizeStretch(k,r){const {rasterInfo:a}=this,{pixelType:f,bandCount:l}=a,d=this.rendererJSON;var b=["u8","u16","s8","s16"].includes(f);let g;var {dra:z}=d;({gamma:v}=this.lookup);if("histogramEqualization"===d.stretchType){b=z?null:this.lookup?.histogramLut;r=D.getStretchCutoff(d,{rasterInfo:a,pixelBlock:k,bandIds:r,returnHistogramLut:!b});var v=D.stretch(k,{...r,
gamma:v,isRenderer:!0});v=B.lookupPixels(v,{lut:z?r.histogramLut:b,offset:0})}else if(b){if(z)z=D.getStretchCutoff(d,{rasterInfo:a,pixelBlock:k,bandIds:r}),g=D.createStretchLUT({pixelType:f,...z,gamma:v,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return k;g=this.lookup?this.lookup.stretchLut:null}if(!g)return k;1<l&&null!=r&&r.length===k?.pixels.length&&g?.lut.length===l&&(g={lut:r.map(C=>g.lut[C]),offset:g.offset});v=B.lookupPixels(k,g)}else z=D.getStretchCutoff(d,{rasterInfo:a,
pixelBlock:k,bandIds:r}),v=D.stretch(k,{...z,gamma:v,isRenderer:!0});if(d.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return k;v=B.colorize(v,this.lookup?.colormapLut)}return v}_symbolizeShadedRelief(k,r){var a=this.rendererJSON;r=q.hillshade(k,{...a,...r});if(!a.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return r;a=this.lookup?this.lookup.hsvMap:null;if(!a)return r;q.tintHillshade(r,k,a,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return r}_isVectorFieldData(){const {bandCount:k,
dataType:r}=this.rasterInfo;return 2===k&&("vector-magdir"===r||"vector-uv"===r)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(k){const {bandCount:r,
attributeTable:a,pixelType:f}=this.rasterInfo,l=k.field1;if(!l)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const d=k.defaultSymbol;var b=1===r&&["u8","s8"].includes(f);if(!e.isUVRendererSupported(this.rasterInfo,l)&&!b)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const g=[];if(null!=a){const z=a.fields.find(v=>"value"===v.name.toLowerCase());if(!z)return{success:!1,
error:"Unsupported data; the data's raster attribute table does not have a value field."};a.features.forEach(v=>{const C=k.uniqueValueInfos?.find(y=>String(y.value)===String(v.attributes[l]))?.symbol?.color;C?g.push([v.attributes[z.name]].concat(C)):d&&g.push([v.attributes[z.name]].concat(d.color))})}else{if("value"!==l.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not available.'};k.uniqueValueInfos?.forEach(z=>
{const v=z?.symbol?.color;v?g.push([parseInt(""+z.value,10)].concat(v)):d&&g.push([parseInt(""+z.value,10)].concat(d?.color))})}if(0===g.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};b=B.createColormapLUT({colormap:g});this.lookup={rendererJSON:k,colormapLut:b};this.canRenderInWebGL=e.isColormapSupportedByWebGL(b?.indexedColormap);return{success:!0}}_updateColormapRenderer(k){if(!e.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var r=k.colormapInfos.map(a=>[a.value].concat(a.color)).sort((a,f)=>a[0]-f[0]);if(!r||0===r.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};r=B.createColormapLUT({colormap:r});this.lookup={rendererJSON:k,colormapLut:r};this.canRenderInWebGL=e.isColormapSupportedByWebGL(r?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(k){if(!e.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(k.colorRamp){var r=c.convertColorRampToColormap(k.colorRamp,{interpolateAlpha:!0});r=B.createColormapLUT({colormap:r});const a=c.createHsvMap(r.indexedColormap);this.lookup={rendererJSON:k,colormapLut:r,hsvMap:a}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}}_analyzeClassBreaks(k){const {attributeTable:r,pixelType:a}=this.rasterInfo,f=
null!=r?r.fields.find(b=>"value"===b.name.toLowerCase()):null,l=null!=r?r.fields.find(b=>b.name.toLowerCase()===k.field.toLowerCase()):null,d=null!=f&&null!==l;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(a)||d,tableValueField:f,tableBreakField:l}}_updateClassBreaksRenderer(k){var {attributeTable:r}=this.rasterInfo;const {canUseIndexedLUT:a,tableValueField:f,tableBreakField:l}=this._analyzeClassBreaks(k);var d=k.classBreakInfos;if(!d?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};
d=d.sort((C,y)=>C.classMaxValue-y.classMaxValue);var b=d[d.length-1],g=k.minValue;if(!a){var z=[];for(var v=0;v<d.length;v++)z.push({value:d[v].classMinValue??g,mappedColor:d[v].symbol.color}),g=d[v].classMaxValue;z.push({value:b.classMaxValue,mappedColor:b.symbol.color});this.lookup={rendererJSON:k,remapLut:z};this.canRenderInWebGL=!1;return{success:!0}}z=[];if(null!=r&&null!=f&&null!==l&&f!==l){b=f.name;const C=l.name,y=d[d.length-1],{classMaxValue:A}=y;g=k.minValue;for(v of r.features){r=v.attributes[b];
const x=v.attributes[C],E=x===A?y:x<g?null:d.find(({classMaxValue:N})=>N>x);E&&z.push([r].concat(E.symbol.color))}}else{g=Math.floor(k.minValue);for(v=0;v<d.length;v++){for(r=d[v];g<r.classMaxValue;g++)z.push([g].concat(r.symbol.color));g=Math.ceil(r.classMaxValue)}b.classMaxValue===g&&z.push([b.classMaxValue].concat(b.symbol.color))}d=B.createColormapLUT({colormap:z,fillUnspecified:!1});this.lookup={rendererJSON:k,colormapLut:d};this.canRenderInWebGL=e.isColormapSupportedByWebGL(d?.indexedColormap);
return{success:!0}}_updateStretchRenderer(k){let {stretchType:r,dra:a}=k;if(!("none"===r||k.statistics?.length||h(this.rasterInfo.statistics)||a))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var f=k.histograms||this.rasterInfo.histograms;!n(k.stretchType)||f?.length||a||(r="minMax");const {computeGamma:l,useGamma:d,colorRamp:b}=k;let {gamma:g}=k;d&&l&&!g?.length&&(g=D.computeGammaValues(this.rasterInfo.pixelType,
k.statistics?.length?k.statistics:this.rasterInfo.statistics));var z=this.rasterInfo.pixelType;const v=!a&&["u8","u16","s8","s16"].includes(z);"histogramEqualization"===r?(z=f.map(C=>D.createHistogramEqualizationLUT(C)),this.lookup={rendererJSON:k,histogramLut:z}):v&&(f=D.getStretchCutoff(k,{rasterInfo:this.rasterInfo}),z=D.createStretchLUT({pixelType:z,...f,gamma:d?g:null,rounding:"floor"}),this.lookup={rendererJSON:k,stretchLut:z});b&&!w(b)&&(z=c.convertColorRampToColormap(b,{interpolateAlpha:!0}),
this.lookup||(this.lookup={rendererJSON:k}),this.lookup.colormapLut=B.createColormapLUT({colormap:z}),this.lookup.rendererJSON=k);this.lookup.gamma=d&&g?.length?g:null;this.canRenderInWebGL=!0;return{success:!0}}_generateStretchWebGLParams(k,r,a){let f=null,l=null;var d=this.lookup?.colormapLut;r.colorRamp&&d&&(f=d.indexedColormap,l=d.offset);"histogramEqualization"===r.stretchType&&(r={...r,stretchType:"minMax"});({gamma:d}=this.lookup);const b=!(!r.useGamma||!d?.some(E=>1!==E)),{minCutOff:g,maxCutOff:z,
outMin:v,outMax:C}=D.getStretchCutoff(r,{rasterInfo:this.rasterInfo,pixelBlock:k,bandIds:a});var y=0;null!=k&&(y=k.getPlaneCount(),2===y&&(k=k.clone(),k.statistics=[k.statistics[0]],k.pixels=[k.pixels[0]]));({bandCount:k}=this.rasterInfo);a=Math.min(3,a?.length||y||k,k);k=new Float32Array(a);y=f||b?1:255;let A;for(A=0;A<g.length;A++)k[A]=z[A]===g[A]?0:(C-v)/(z[A]-g[A])/y;const x=new Float32Array(a);if(b&&d)for(A=0;A<a;A++)x[A]=1<d[A]?2<d[A]?6.5+(d[A]-2)**2.5:6.5+100*(2-d[A])**4:1;return{bandCount:a,
outMin:v/y,outMax:C/y,minCutOff:g,maxCutOff:z,factor:k,useGamma:b,gamma:b?d:[1,1,1],gammaCorrection:b?x:[1,1,1],colormap:f,colormapOffset:l,stretchType:r.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(k,r=!1,a={x:0,y:0}){let f=null,l=null;const d=this.lookup?.colormapLut;k.colorRamp&&d&&(f=d.indexedColormap,l=d.offset);r=q.calculateHillshadeParams({...k,isGCS:r,resolution:a});a=this.rasterInfo.statistics?.[0];return{...r,minValue:a?.min??0,maxValue:a?.max??8E3,hillshadeType:"traditional"===
k.hillshadeType?0:1,type:"hillshade",colormap:f,colormapOffset:l}}_generateVectorFieldWebGLParams(k){const {style:r,inputUnit:a,outputUnit:f,visualVariables:l,symbolTileSize:d,flowRepresentation:b}=k;let g;var z=this.rasterInfo.statistics?.[0].min??0,v=this.rasterInfo.statistics?.[0].max??50,C=l?.find(x=>"sizeInfo"===x.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:v,maxSize:.8*d,minDataValue:z,minSize:.2*d},y=C.minDataValue??z,A=C.maxDataValue??v;v=null!=C.maxSize&&null!=C.minSize?[C.minSize/
d,C.maxSize/d]:[.2,.8];"wind_speed"===r&&(v[0]=v[1]=(v[0]+v[1])/2);z=null!=y&&null!=A?[y,A]:null;if("classified_arrow"===r)if(null!=y&&null!=A&&null!=C)for(g=[],y=(C.maxDataValue-C.minDataValue)/5,A=0;6>A;A++)g.push(C.minDataValue+y*A);else g=[0,1E-6,3.5,7,10.5,14];C="flow_to"===b===("ocean_current_kn"===r||"ocean_current_m"===r)?0:Math.PI;y=l?.find(x=>"rotationInfo"===x.type);return{breakValues:g,dataRange:z,inputUnit:a,outputUnit:f,symbolTileSize:d,symbolPercentRange:v,style:r||"single_arrow",rotation:C,
rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":y?.rotationType||k.rotationType,type:"vectorField"}}};p.__decorate([L.property({json:{write:!0}})],u.prototype,"rendererJSON",void 0);p.__decorate([L.property({type:Q,json:{write:!0}})],u.prototype,"rasterInfo",void 0);p.__decorate([L.property({json:{write:!0}})],u.prototype,"lookup",void 0);p.__decorate([L.property()],u.prototype,"canRenderInWebGL",void 0);return u=p.__decorate([M.subclass("esri.renderers.support.RasterSymbolizer")],
u)})},"esri/rest/support/ImageHistogramParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/support/jsonUtils ../../layers/support/MosaicRule ../../layers/support/RasterFunction ../../time/TimeExtent ../../geometry/Point".split(" "),function(p,u,t,L,F,P,M,Q,B,
D,q,c,e,n){var h;t=h=class extends t.JSONSupport{constructor(){super(...arguments);this.pixelSize=this.rasterFunction=this.mosaicRule=this.geometry=null;this.raster=void 0;this.timeExtent=null}writeGeometry(m,w,k){null!=m&&(w.geometryType=D.getJsonType(m),w[k]=m.toJSON())}clone(){return new h(L.clone({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}};p.__decorate([F.property({types:u.geometryTypes,
json:{read:D.fromJSON}})],t.prototype,"geometry",void 0);p.__decorate([B.writer("geometry")],t.prototype,"writeGeometry",null);p.__decorate([F.property({type:q,json:{write:!0}})],t.prototype,"mosaicRule",void 0);p.__decorate([F.property({type:c,json:{write:!0,name:"renderingRule"}})],t.prototype,"rasterFunction",void 0);p.__decorate([F.property({type:n,json:{write:!0}})],t.prototype,"pixelSize",void 0);p.__decorate([F.property({json:{write:!0}})],t.prototype,"raster",void 0);p.__decorate([F.property({type:e,
json:{read:{source:"time"},write:{target:"time"}}})],t.prototype,"timeExtent",void 0);return t=h=p.__decorate([Q.subclass("esri.rest.support.ImageHistogramParameters")],t)})},"esri/layers/support/MosaicRule":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/Point ./DimensionalDefinition ./RasterFunction".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){var n;const h=u.strict()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),m=u.strict()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});u=n=class extends t.JSONSupport{constructor(w){super(w);this.ascending=!0;this.where=
this.viewpoint=this.sortValue=this.sortField=this.operation=this.objectIds=this.multidimensionalDefinition=this.method=this.lockRasterIds=this.itemRasterFunction=null}readAscending(w,k){return null!=k.ascending?k.ascending:null!=k.sortAscending?k.sortAscending:!0}readMethod(w,k){w=k.mosaicMethod||k.defaultMosaicMethod;switch(w?w.toLowerCase().replace("esrimosaic",""):""){case "byattribute":case "attribute":w="esriMosaicAttribute";break;case "lockraster":w="esriMosaicLockRaster";break;case "center":w=
"esriMosaicCenter";break;case "northwest":w="esriMosaicNorthwest";break;case "nadir":w="esriMosaicNadir";break;case "viewpoint":w="esriMosaicViewpoint";break;case "seamline":w="esriMosaicSeamline";break;case "none":w="esriMosaicNone";break;default:w="esriMosaicNone"}return m.fromJSON(w)}writeMultidimensionalDefinition(w,k,r){null!=w&&(w=w.filter(({variableName:a,dimensionName:f})=>a&&"*"!==a||f),w.length&&(k[r]=w.map(a=>a.toJSON())))}readOperation(w,k){w=k.mosaicOperation;k=k.mosaicOperator?.toLowerCase();
k=w||(k?h.toJSON(k):null);return h.fromJSON(k)||"first"}castSortValue(w){return null==w||"string"===typeof w||"number"===typeof w?w:`${w}`}clone(){return new n({ascending:this.ascending,itemRasterFunction:L.clone(this.itemRasterFunction),lockRasterIds:L.clone(this.lockRasterIds),method:this.method,multidimensionalDefinition:L.clone(this.multidimensionalDefinition),objectIds:L.clone(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:L.clone(this.viewpoint),
where:this.where})}};p.__decorate([F.property({type:Boolean,json:{write:!0}})],u.prototype,"ascending",void 0);p.__decorate([M.reader("ascending",["ascending","sortAscending"])],u.prototype,"readAscending",null);p.__decorate([F.property({type:e,json:{name:"itemRenderingRule",write:!0}})],u.prototype,"itemRasterFunction",void 0);p.__decorate([F.property({type:[D.Integer],json:{write:{overridePolicy(){return{enabled:"lock-raster"===this.method}}}}})],u.prototype,"lockRasterIds",void 0);p.__decorate([F.property({type:String,
json:{type:m.jsonValues,write:{target:"mosaicMethod",writer:m.write}}})],u.prototype,"method",void 0);p.__decorate([M.reader("method",["mosaicMethod","defaultMosaicMethod"])],u.prototype,"readMethod",null);p.__decorate([F.property({type:[c],json:{write:!0}})],u.prototype,"multidimensionalDefinition",void 0);p.__decorate([B.writer("multidimensionalDefinition")],u.prototype,"writeMultidimensionalDefinition",null);p.__decorate([F.property({type:[D.Integer],json:{name:"fids",write:!0}})],u.prototype,
"objectIds",void 0);p.__decorate([F.property({json:{type:h.jsonValues,read:{reader:h.read},write:{target:"mosaicOperation",writer:h.write}}})],u.prototype,"operation",void 0);p.__decorate([M.reader("operation",["mosaicOperation","mosaicOperator"])],u.prototype,"readOperation",null);p.__decorate([F.property({type:String,json:{write:{overridePolicy(){return{enabled:"attribute"===this.method}}}}})],u.prototype,"sortField",void 0);p.__decorate([F.property({type:[String,Number],json:{write:{allowNull:!0,
overridePolicy(){return{enabled:"attribute"===this.method,allowNull:!0}}}}})],u.prototype,"sortValue",void 0);p.__decorate([P.cast("sortValue")],u.prototype,"castSortValue",null);p.__decorate([F.property({type:q,json:{write:!0}})],u.prototype,"viewpoint",void 0);p.__decorate([F.property({type:String,json:{write:!0}})],u.prototype,"where",void 0);return u=n=p.__decorate([Q.subclass("esri.layers.support.MosaicRule")],u)})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(p,u,t,L,F,P,M,Q,B){function D(a,f){const l=e(f.data,f.width,f.height,a.smoothing);return a.interpolate?(d,b)=>{const g=Math.floor(d),z=Math.floor(b);if(0>g||g>=f.width||0>z||z>=f.height)return[0,0];d-=g;b-=z;const v=g<f.width-1?g+1:g,C=z<f.height-1?z+1:z;return[(l[2*(z*f.width+g)]*(1-b)+l[2*(C*f.width+g)]*b)*(1-d)+(l[2*(z*f.width+v)]*(1-b)+l[2*(C*f.width+v)]*b)*d,(l[2*(z*f.width+g)+1]*(1-b)+l[2*(C*f.width+g)+1]*b)*(1-d)+(l[2*(z*f.width+v)+1]*(1-b)+l[2*(C*f.width+v)+1]*b)*d]}:(d,b)=>{d=Math.round(d);
b=Math.round(b);return 0>d||d>=f.width||0>b||b>=f.height?[0,0]:[l[2*(b*f.width+d)],l[2*(b*f.width+d)+1]]}}function q(a,f,l,d,b,g,z,v,C){const y=[];let A=0,[x,E]=f(l,d);x*=a.velocityScale;E*=a.velocityScale;y.push({x:l,y:d,t:A,speed:Math.sqrt(x*x+E*E)});for(let O=0;O<a.verticesPerLine;O++){let [H,J]=f(l,d);H*=a.velocityScale;J*=a.velocityScale;const R=Math.sqrt(H*H+J*J);if(R<a.minSpeedThreshold)break;const Y=H/R,T=J/R;l+=Y*a.segmentLength;d+=T*a.segmentLength;A+=a.segmentLength/R;if(Math.acos(Y*N+
T*G)>a.maxTurnAngle)break;if(a.collisions){var N=Math.round(l*C);var G=Math.round(d*C);if(0>N||N>z-1||0>G||G>v-1)break;const X=g[G*z+N];if(-1!==X&&X!==b)break;g[G*z+N]=b}y.push({x:l,y:d,t:A,speed:R});N=Y;G=T}return y}function c(a,f,l,d){const b=[],g=new M,z=1/Math.max(a.lineCollisionWidth,1),v=Math.round(l*z),C=Math.round(d*z),y=new Int32Array(v*C);for(var A=0;A<y.length;A++)y[A]=-1;A=[];for(let x=0;x<d;x+=a.lineSpacing)for(let E=0;E<l;E+=a.lineSpacing)A.push({x:E,y:x,sort:g.getFloat()});A.sort((x,
E)=>x.sort-E.sort);for(const {x,y:E}of A)g.getFloat()<a.density&&(l=q(a,f,x,E,b.length,y,v,C,z),2>l.length||b.push(l));return b}function e(a,f,l,d){if(0===d)return a;const b=Math.round(3*d),g=Array(2*b+1);var z=0;for(var v=-b;v<=b;v++){var C=Math.exp(-v*v/(d*d));g[v+b]=C;z+=C}for(d=-b;d<=b;d++)g[d+b]/=z;z=new Float32Array(a.length);for(d=0;d<l;d++)for(v=0;v<f;v++){var y=C=0;for(var A=-b;A<=b;A++)if(!(0>v+A||v+A>=f)){var x=g[A+b];C+=x*a[2*(d*f+(v+A))];y+=x*a[2*(d*f+(v+A))+1]}z[2*(d*f+v)]=C;z[2*(d*
f+v)+1]=y}a=new Float32Array(a.length);for(d=0;d<f;d++)for(v=0;v<l;v++){y=C=0;for(A=-b;A<=b;A++)0>v+A||v+A>=l||(x=g[A+b],C+=x*z[2*((v+A)*f+d)],y+=x*z[2*((v+A)*f+d)+1]);a[2*(v*f+d)]=C;a[2*(v*f+d)+1]=y}return a}function n(a,f){const l=new M;var d=a.reduce((v,C)=>v+C.length,0);d=new Float32Array(4*d);const b=Array(a.length);let g=0,z=0;for(const v of a){a=g;for(const C of v)d[4*g]=C.x,d[4*g+1]=C.y,d[4*g+2]=C.t,d[4*g+3]=C.speed,g++;b[z++]={startVertex:a,numberOfVertices:v.length,totalTime:v[v.length-
1].t,timeSeed:f?l.getFloat():0}}return{lineVertices:d,lineDescriptors:b}}function h(a,f){function l(N,G,O,H,J,R,Y,T){const X=9*C;let V=0;v[X+V++]=N;v[X+V++]=G;v[X+V++]=1;v[X+V++]=O;v[X+V++]=R;v[X+V++]=Y;v[X+V++]=H/2;v[X+V++]=J/2;v[X+V++]=T;C++;v[X+V++]=N;v[X+V++]=G;v[X+V++]=-1;v[X+V++]=O;v[X+V++]=R;v[X+V++]=Y;v[X+V++]=-H/2;v[X+V++]=-J/2;v[X+V++]=T;C++}const {lineVertices:d,lineDescriptors:b}=a;var g=a=0;for(var z of b)a+=2*z.numberOfVertices,g+=6*(z.numberOfVertices-1);const v=new Float32Array(9*
a);z=new Uint32Array(g);let C=0;a=0;for(const N of b){const {totalTime:G,timeSeed:O}=N;let H=g=null,J=null;var y=null,A=null,x=null;for(let R=0;R<N.numberOfVertices;R++){y=d[4*(N.startVertex+R)];const Y=d[4*(N.startVertex+R)+1],T=d[4*(N.startVertex+R)+2],X=d[4*(N.startVertex+R)+3];let V=null,K=null;var E=null;let S=null;0<R&&(V=y-g,K=Y-H,E=Math.sqrt(V*V+K*K),V/=E,K/=E,1<R?(A=V+A,x=K+x,E=Math.sqrt(A*A+x*x),A/=E,x/=E,E=Math.min(1/(A*V+x*K),f),A*=E,x*=E,E=-x,S=A):(E=-K,S=V),null!==E&&null!==S&&(l(g,
H,J,E,S,G,O,X),z[a++]=C-2,z[a++]=C,z[a++]=C-1,z[a++]=C,z[a++]=C+1,z[a++]=C-1));g=y;H=Y;J=T;A=V;x=K;y=X}l(g,H,J,-x,A,G,O,y)}return{vertexData:v,indexData:z}}function m(a){function f(ca,I){var U=T+V,W=X+K,aa=Math.sqrt(U*U+W*W);U/=aa;W/=aa;var da=T*U+X*W,ea=V+S,ha=K+Z;aa=Math.sqrt(ea*ea+ha*ha);ea/=aa;ha/=aa;var ia=V*ea+K*ha;aa=E;var ka=N,ma=G,pa=O;W=-(W/da);U/=da;da=H;var oa=J,sa=R,qa=Y;ha=-(ha/ia);ea/=ia;ia=16*A;let va=0;for(const ta of[1,2])for(const wa of[1,2,3,4])C[ia+va++]=aa,C[ia+va++]=ka,C[ia+
va++]=ma,C[ia+va++]=pa,C[ia+va++]=da,C[ia+va++]=oa,C[ia+va++]=sa,C[ia+va++]=qa,C[ia+va++]=ta,C[ia+va++]=wa,C[ia+va++]=ca,C[ia+va++]=I,C[ia+va++]=W/2,C[ia+va++]=U/2,C[ia+va++]=ha/2,C[ia+va++]=ea/2,A++;y[x++]=A-8;y[x++]=A-7;y[x++]=A-6;y[x++]=A-7;y[x++]=A-5;y[x++]=A-6;y[x++]=A-4;y[x++]=A-3;y[x++]=A-2;y[x++]=A-3;y[x++]=A-1;y[x++]=A-2}function l(ca,I,U,W,aa,da){T=V;X=K;V=S;K=Z;null==T&&null==X&&(T=V,X=K);if(null!=H&&null!=J){S=ca-H;Z=I-J;const ea=Math.sqrt(S*S+Z*Z);S/=ea;Z/=ea}null!=T&&null!=X&&f(aa,da);
E=H;N=J;G=R;O=Y;H=ca;J=I;R=U;Y=W}function d(ca,I){T=V;X=K;V=S;K=Z;null==T&&null==X&&(T=V,X=K);null!=T&&null!=X&&f(ca,I)}const {lineVertices:b,lineDescriptors:g}=a;let z=a=0;for(var v of g){const ca=v.numberOfVertices-1;a+=8*ca;z+=12*ca}const C=new Float32Array(16*a),y=new Uint32Array(z);let A=0,x=0,E,N,G,O,H,J,R,Y,T,X,V,K,S,Z;for(const ca of g){Z=S=K=V=X=T=Y=R=J=H=O=G=N=E=null;const {totalTime:I,timeSeed:U}=ca;for(v=0;v<ca.numberOfVertices;v++)l(b[4*(ca.startVertex+v)],b[4*(ca.startVertex+v)+1],b[4*
(ca.startVertex+v)+2],b[4*(ca.startVertex+v)+3],I,U);d(I,U)}return{vertexData:C,indexData:y}}function w(a,f){const l=f.pixels,{width:d,height:b}=f,g=new Float32Array(d*b*2),z=f.mask||new Uint8Array(d*b*2);f.mask||z.fill(255);if("vector-uv"===a)for(a=0;a<d*b;a++)g[2*a]=l[0][a],g[2*a+1]=-l[1][a];else if("vector-magdir"===a)for(a=0;a<d*b;a++){f=l[0][a];const v=F.deg2rad(l[1][a]),C=Math.sin(v-Math.PI/2);g[2*a]=Math.cos(v-Math.PI/2)*f;g[2*a+1]=C*f}return{data:g,mask:z,width:d,height:b}}async function k(a,
f,l,d,b,g){const z={requestProjectedLocalDirections:!0,signal:g};null!=b&&(z.timeExtent=b);if("imagery"===a.type)return await a.load({signal:g}),b=a.rasterInfo.dataType,a=await a.fetchImage(f,l,d,z),null==a?.pixelData?.pixelBlock?{data:new Float32Array(l*d*2),mask:new Uint8Array(l*d),width:l,height:d}:w(b,a.pixelData.pixelBlock);await a.load({signal:g});b=a.serviceRasterInfo.dataType;a=await a.fetchPixels(f,l,d,z);return null==a?.pixelBlock?{data:new Float32Array(l*d*2),mask:new Uint8Array(l*d),width:l,
height:d}:w(b,a.pixelBlock)}const r=()=>L.getLogger("esri.views.2d.engine.flow.dataUtils");p.createAnimatedLinesData=n;p.createFlowMesh=async function(a,f,l,d){const b=performance.now();var g=D(f,l);const z=performance.now();l=c(f,g,l.width,l.height);f=performance.now();g=n(l,!0);l=performance.now();a="Streamlines"===a?h(g,10):m(g);g=performance.now();t("esri-2d-profiler")&&(r().info("I.1","_createFlowFieldFromData (ms)",Math.round(z-b)),r().info("I.2","_getStreamlines (ms)",Math.round(f-z)),r().info("I.3",
"createAnimatedLinesData (ms)",Math.round(l-f)),r().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(g-l)),r().info("I.5","createFlowMesh (ms)",Math.round(g-b)),r().info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();P.throwIfAborted(d);return a};p.createParticlesMesh=m;p.createStreamlinesMesh=h;p.loadImagery=async function(a,f,l,d,b,g){const z=performance.now();var v=Q.getInfo(f.spatialReference);if(!v)return l=await k(a,
f,l,d,b,g),t("esri-2d-profiler")&&r().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-z)),t("esri-2d-profiler")&&r().info("I.9","Number of parts",1),l;const [C,y]=v.valid,A=Math.ceil(f.width/(y-C)),x=f.width/A,E=Math.round(l/A);let N=f.xmin;const G=[];v=performance.now();for(let O=0;O<A;O++){const H=new B({xmin:N,xmax:N+x,ymin:f.ymin,ymax:f.ymax,spatialReference:f.spatialReference});G.push(k(a,H,E,d,b,g));N+=x}a=await Promise.all(G);t("esri-2d-profiler")&&r().info("I.8","All calls to _fetchPart (ms)",
Math.round(performance.now()-v));t("esri-2d-profiler")&&r().info("I.9","Number of parts",a.length);d={data:new Float32Array(l*d*2),mask:new Uint8Array(l*d),width:l,height:d};f=0;for(const O of a){for(a=0;a<O.height;a++)for(b=0;b<O.width;b++)f+b>=l||(d.data[2*(a*l+f+b)]=O.data[2*(a*O.width+b)],d.data[2*(a*l+f+b)+1]=O.data[2*(a*O.width+b)+1],d.mask[a*l+f+b]=O.mask[a*O.width+b]);f+=O.width}t("esri-2d-profiler")&&r().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-z));return d};
Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/RasterPresetRendererMixin":function(){define("exports ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/RasterPresetRenderer".split(" "),function(p,u,t,L,F,P,M,Q){p.RasterPresetRendererMixin=B=>{B=class extends B{constructor(){super(...arguments);this.presetRenderers=this.activePresetRendererName=
null}};u.__decorate([t.property({type:String,json:{name:"layerDefinition.activePresetRendererName",write:{allowNull:!0}}})],B.prototype,"activePresetRendererName",void 0);u.__decorate([t.property({type:[Q],json:{name:"layerDefinition.presetRenderers",write:!0}})],B.prototype,"presetRenderers",void 0);return B=u.__decorate([M.subclass("esri.layers.mixins.RasterPresetRendererMixin")],B)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterPresetRenderer":function(){define("../../chunks/tslib.es6 ../../rasterRenderers ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(p,u,t,L,F,P,M,Q,B,D){t=class extends t.ClonableMixin(L.JSONSupport){constructor(q){super(q);this.name=void 0;this.method="none";this.renderer=this.bandIds=this.value=void 0}};p.__decorate([F.property({type:String,json:{write:!0}})],t.prototype,"name",void 0);p.__decorate([F.property({type:["raster-function-template","variable","none"],json:{write:!0}}),B.enumeration({rasterFunctionTemplate:"raster-function-template",variable:"variable",none:"none"})],t.prototype,"method",void 0);p.__decorate([F.property({type:String,
json:{write:!0}})],t.prototype,"value",void 0);p.__decorate([F.property({type:[P.Integer],json:{write:!0}})],t.prototype,"bandIds",void 0);p.__decorate([F.property({types:u.rasterRendererTypes,json:{write:!0,origins:{"web-scene":{types:u.websceneRasterRendererTypes,write:{overridePolicy(q){return{enabled:q&&"vector-field"!==q.type&&"flow"!==q.type}}}}}}})],t.prototype,"renderer",void 0);return t=p.__decorate([D.subclass("esri.renderers.support.RasterPresetRenderer")],t)})},"esri/layers/support/rasterDatasets/RasterFactory":function(){define("../../../core/Error ./CovJSONRaster ./ImageAuxRaster ./ImageServerRaster ./InMemoryRaster ./MRFRaster ./TIFFRaster".split(" "),
function(p,u,t,L,F,P,M){const Q=new Map;Q.set("MRF",{desc:"Meta Raster Format",constructor:P});Q.set("TIFF",{desc:"GeoTIFF",constructor:M});Q.set("RasterTileServer",{desc:"Raster Tile Server",constructor:L});Q.set("JPG",{desc:"JPG Raster Format",constructor:t});Q.set("PNG",{desc:"PNG Raster Format",constructor:t});Q.set("GIF",{desc:"GIF Raster Format",constructor:t});Q.set("BMP",{desc:"BMP Raster Format",constructor:t});Q.set("CovJSON",{desc:"COVJSON Raster Format",constructor:u});Q.set("MEMORY",
{desc:"In Memory Raster Format",constructor:F});class B{static get supportedFormats(){const D=new Set;Q.forEach((q,c)=>D.add(c));return D}static async open(D){const {url:q,ioConfig:c,source:e,sourceJSON:n}=D;let h=D.datasetFormat??c?.datasetFormat;null==h&&(q.includes(".")?h=q.slice(q.lastIndexOf(".")+1).toUpperCase():"coverage"===e?.type?.toLowerCase()?h="CovJSON":e?.extent&&e.pixelblocks&&(h="MEMORY"));"OVR"===h||"TIF"===h?h="TIFF":"JPG"===h||"JPEG"===h||"JFIF"===h?h="JPG":"COVJSON"===h&&(h="CovJSON");
q.toLowerCase().includes("/imageserver")&&!q.toLowerCase().includes("/wcsserver")&&(h="RasterTileServer");var m={bandIds:null,sampling:null};const w={url:q,source:e,sourceJSON:n,datasetFormat:h,ioConfig:c??m};Object.keys(w).forEach(f=>{null==w[f]&&delete w[f]});if(h){if(!this.supportedFormats.has(h))throw new p("rasterfactory:open","not a supported format "+h);if("CRF"===h)throw new p("rasterfactory:open",`cannot open raster: ${q}`);m=new (Q.get(h).constructor)(w);await m.open({signal:D.signal});
return m}const k=Array.from(Q.keys()).filter(f=>"CovJSON"!==f&&"Memory"!==f);let r=0;const a=()=>{h=k[r++];if(!h||"CRF"===h)return null;const f=new (Q.get(h).constructor)(w);return f.open({signal:D.signal}).then(()=>f).catch(()=>a())};return a()}static register(D,q,c){Q.has(D.toUpperCase())||Q.set(D.toUpperCase(),{desc:q,constructor:c})}}return B})},"esri/layers/support/rasterDatasets/CovJSONRaster":function(){define("../../../chunks/tslib.es6 ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./covJSONParser ./InMemoryRaster ../rasterFunctions/stretchUtils ../../../rest/support/FeatureSet".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c){L=class extends Q{constructor(){super(...arguments);this.datasetFormat="CovJSON"}fetchRawTile(e,n,h,m={}){return this._inMemoryRaster.fetchRawTile(e,n,h,m)}async _open(e){const {extent:n,pixelBlocks:h,multidimensionalInfo:m,attributeTable:w,bandNames:k}=await this._fetchData(e),{statistics:r,histograms:a}=q.computeStatisticsHistograms(h[0]);e=k?.map(l=>({BandName:l}));e={DataType:w?"Thematic":m?"Scientific":"Generic",BandProperties:e};e=new D({source:{extent:n,pixelBlocks:h,
attributeTable:w?c.fromJSON(w):null,multidimensionalInfo:m,statistics:r,histograms:a,keyProperties:e,isPseudoSpatialReference:!1}});await e.open();this._inMemoryRaster=e;const f=this.source?"":this.url.slice(this.url.lastIndexOf("/")+1);this._set("datasetName",f.slice(0,f.indexOf(".")));this._set("rasterInfo",e.rasterInfo)}async _fetchData(e){e=this.source??(await this.request(this.url,{signal:e?.signal})).data;if("coverage"!==e.type?.toLowerCase()||"grid"!==e.domain?.domainType?.toLowerCase())throw new u("imagery-tile-layer:open-coverage-json",
"Only coverage with Grid domain type is supported");if(!e.ranges)throw new u("imagery-tile-layer:open-coverage-json","Missing ranges in the grid coverage data");if(!e.domain.referencing?.length)throw new u("imagery-tile-layer:open-coverage-json","Missing domain referencing in the grid coverage data");const n=Object.values(e.ranges);for(let h=0;h<n.length;h++){const {axisNames:m,shape:w,type:k,values:r}=n[h];if(!("ndarray"===k.toLowerCase()&&r?.length&&m?.length&&w?.length))throw new u("imagery-tile-layer:open-coverage-json",
"Only ranges with valid NdArray, axisNames, shape, and inline values are supported");if(!B.isXAxis(m[m.length-1])||!B.isYAxis(m[m.length-2]))throw new u("imagery-tile-layer:open-coverage-json","Only row-major ordered pixel values are supported. X axis must be the last axis.");}return B.parseGridCoverage(e)}};p.__decorate([t.property({type:String,json:{write:!0}})],L.prototype,"datasetFormat",void 0);p.__decorate([t.property({constructOnly:!0})],L.prototype,"source",void 0);return L=p.__decorate([M.subclass("esri.layers.support.rasterDatasets.CovJSONRaster")],
L)})},"esri/layers/support/rasterDatasets/covJSONParser":function(){define("exports ../../../Color ../../../geometry ../../../geometry/Extent ../../../intl/locale ../PixelBlock ../rasterFormats/pixelRangeUtils ../../../geometry/SpatialReference".split(" "),function(p,u,t,L,F,P,M,Q){function B(m){return["x","e","east","long","longitude"].includes(m.toLowerCase())}function D(m){return["y","n","west","lat","latitude"].includes(m.toLowerCase())}function q(m){const {axes:w}=m.domain,k=Object.keys(w);var r=
[];const a=[];let f=-1,l=-1,d=[];for(let y=0;y<k.length;y++){const A=k[y];B(A)?f=y:D(A)&&(l=y);var b=w[A];const x=[];if("values"in b)b.values.forEach(E=>x.push("string"===typeof E?(new Date(E)).getTime():E)),b=x[1]-x[0],r.push([x[0]-.5*b,x[x.length-1]+.5*b]),a.push(b);else{const {start:E,stop:N,num:G}=b;b=(N-E)/(G-1);r.push([E-.5*b,N+.5*b]);a.push(b);for(let O=0;O<G;O++)x.push(E+b*O)}d.push({name:A,values:x,extent:[x[0],x[x.length-1]]})}-1<f&&-1===l?l=0===f?1:0:-1<l&&-1===f?f=0===l?1:0:-1===l&&-1===
f&&(f=0,l=1);d=d.filter((y,A)=>!(A===f||A===l));({referencing:m}=m.domain);m=m.find(y=>y.coordinates.includes(k[f])).system.id;m=m?.slice(m.lastIndexOf("/")+1);m=new Q({wkid:null==m||"CRS84"===m?4326:Number(m)});const [g,z]=r[f],[v,C]=r[l];r=new L({xmin:g,xmax:z,ymin:v,ymax:C,spatialReference:m});return{width:Math.round(r.width/a[f]),height:Math.round(r.height/a[l]),extent:r,dimensions:d}}function c(m){const w=F.getLanguage();return w?m[w]??Object.values(m)[0]:Object.values(m)[0]}function e(m){const w=
{};({parameters:m}=m);if(!m)return w;for(const [k,r]of Object.entries(m)){const {type:a,description:f,unit:l,categoryEncoding:d,observedProperty:b}=r;if("Parameter"===a&&(w[k]={},f&&(w[k].description=c(f)),l&&(w[k].unit=l.label?c(l.label):null,w[k].symbol=l.symbol?.value),d)){const g=Object.entries(d).map((v,C)=>({OID:C,Value:Number(v[1]),ClassName:v[0].slice(v[0].lastIndexOf("/")+1),Count:1}));let z=!1;b?.categories?.length&&(b.categories.forEach(v=>{if(v.id){var C=v.id.slice(v.id.lastIndexOf("/")+
1),y=g.find(x=>x.ClassName===C);if(y){var A=v.label?c(v.label):null;y.Label=A;v.preferredColor&&(v=u.fromHex(v.preferredColor))&&(z=!0,y.Red=v.r,y.Green=v.g,y.Blue=v.b)}}}),z&&g.forEach(v=>{null==v.Red&&(v.Red=Math.round(255*Math.random()),v.Green=Math.round(255*Math.random()),v.Blue=Math.round(255*Math.random()))}));m={objectIdFieldName:"",fields:[{name:"OID",type:"esriFieldTypeOID",alias:"OID",domain:null},{name:"Value",type:"esriFieldTypeInteger",alias:"Value",domain:null},{name:"Count",type:"esriFieldTypeDouble",
alias:"Count",domain:null},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",domain:null,length:50},{name:"Label",type:"esriFieldTypeString",alias:"Label",domain:null,length:50}],features:g.map(v=>({attributes:v}))};z&&m.fields.push({name:"Red",type:"esriFieldTypeInteger",alias:"Red",domain:null},{name:"Green",type:"esriFieldTypeInteger",alias:"Green",domain:null},{name:"Blue",type:"esriFieldTypeInteger",alias:"Blue",domain:null});w[k].attributeTable=m}}return w}function n(m){let w=Number.MAX_VALUE,
k=-Number.MAX_VALUE;for(let r=0;r<m.length;r++){const a=m[r];null!=a&&(a<w&&(w=a),a>k&&(k=a))}return M.getIntegerPixelType(w,k)}function h(m,w,k){const r=m.map((l,d)=>({name:l,count:w[d]})).sort((l,d)=>l.name>d.name?-1:1);var a=(l=>d=>l*=d.count)(1);a=[...r.slice(1),{name:"",count:1}].reverse().map(a).reverse();let f=0;for(let l=m.length-1;0<=l;l--){const d=r.findIndex(({name:b})=>b===m[l]);f+=k%w[l]*a[d];k=Math.floor(k/w[l])}return f}p.isXAxis=B;p.isYAxis=D;p.parseGridCoverage=function(m){const {width:w,
height:k,extent:r,dimensions:a}=q(m);var {ranges:f}=m;const l=Object.keys(f).sort((A,x)=>A<x?-1:1);var d=[];for(var b=0;b<l.length;b++){var g=l[b];a?.length&&d.push({name:g,dimensions:a})}const z=e(m);d.forEach(A=>z[A.name]&&Object.assign(A,z[A.name]));m=d.length?{variables:d}:void 0;d=[];for(b=0;b<l.length;b++){const {values:A,dataType:x,axisNames:E,shape:N}=f[l[b]];g=2<N.length?b*N.slice(0,-2).reduce((Y,T)=>Y*T):0;const G=E.slice(0,-2),O=N.slice(0,-2),H="float"===x?"f32":n(A),J=w*k,R=A.length/J;
for(let Y=0;Y<R;Y++){var v=P.createEmptyBand(H,J),C=(new Uint8Array(J)).fill(255);let T=!1;var y=Y*J;for(let X=0;X<J;X++){const V=A[y+X];null==V?(C[X]=0,T=!0):v[X]=V}0===b||a?.length?(v=new P({width:w,height:k,mask:T?C:null,pixels:[v],pixelType:H}),v.updateStatistics(),a?.length?(C=h(G,O,Y),d[C+g]=v):d.push(v)):(y=d[Y],y.pixels.push(v),T?y.mask&&(y.mask=P.combineBandMasks([y.mask,C])):y.mask=T?C:null)}}f=Object.values(z).find(A=>A.attributeTable)?.attributeTable;return{extent:r,pixelBlocks:d,multidimensionalInfo:m,
attributeTable:f,bandNames:m?void 0:l}};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/InMemoryRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../DimensionalDefinition ../RasterInfo ./BaseRaster ./multidimensionalUtils ../rasterFunctions/pixelUtils ../rasterFunctions/stretchUtils ../../../geometry/Extent ../../../geometry/SpatialReference".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w){u=class extends c{constructor(){super(...arguments);this.datasetFormat="MEMORY";this.source=null}get url(){return""}fetchRawTile(k,r,a,f={}){if(!this._pixelBlockTiles){const {rasterInfo:l}=this,[d,b]=l.storageInfo.tileInfo.size,{sliceId:g}=f,{pixelBlocks:z}=this.source;k={pixelBlock:null==g?z[0]:z[g],useBilinear:"thematic"!==l.dataType,tileSize:{width:d,height:b},level:k,row:r,col:a};f=this.rasterJobHandler?this.rasterJobHandler.clipTile(k,f):n.clipTile(k);
return Promise.resolve(f)}f=this._pixelBlockTiles.get(`${k}/${r}/${a}`);return Promise.resolve(f)}async _open(k){const r=this.source,{pixelBlocks:a,attributeTable:f,statistics:l,histograms:d,name:b,nativeExtent:g,transform:z}=r,v=a[0],{width:C,height:y,pixelType:A}=v;var x=r.extent??new m({xmin:-.5,ymin:.5,xmax:C-.5,ymax:y-.5,spatialReference:new w({wkid:3857})});const E=r.isPseudoSpatialReference??!r.extent,N={x:x.width/C,y:x.height/y},G={...r.keyProperties};f&&(G.DataType="Thematic");x=new q({width:C,
height:y,pixelType:A,extent:x,nativeExtent:g,attributeTable:f,transform:z,pixelSize:N,spatialReference:x.spatialReference,bandCount:v.pixels.length,keyProperties:G,multidimensionalInfo:r.multidimensionalInfo,statistics:l,isPseudoSpatialReference:E,histograms:d});this.ioConfig.skipMapInfo&&this.updateImageSpaceRasterInfo(x);this.createRemoteDatasetStorageInfo(x,512,512);this._set("rasterInfo",x);this.updateTileInfo();x.multidimensionalInfo?await this._buildMDimStats(r.pixelBlocks,x.multidimensionalInfo):
await this._buildInMemoryRaster(v,{width:512,height:512},k);x.multidimensionalInfo||(this.source=null);this.datasetName=b}async _buildInMemoryRaster(k,r,a){const {rasterInfo:f}=this;var l=f.storageInfo.maximumPyramidLevel??0,d="thematic"!==f.dataType;d=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:k,tileSize:r,maximumPyramidLevel:l,useBilinear:d},a):Promise.resolve(n.split(k,r,l,d));r=null!=f.statistics;l=null!=f.histograms;k=this.ioConfig.skipStatistics||r?Promise.resolve({statistics:null,
histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:k},a):Promise.resolve(h.estimateStatisticsHistograms(k));k=await L.eachAlways([d,k]);if(!k[0].value&&k[1].value)throw new t("inmemory-raster:open","failed to build in memory raster");this._pixelBlockTiles=k[0].value;r||(f.statistics=k[1].value?.statistics);l||(f.histograms=k[1].value?.histograms)}async _buildMDimStats(k,r,a){for(let l=0;l<r.variables.length;l++){const d=r.variables[l];if(!d.statistics){var f=
d.dimensions.map(b=>new D({variableName:d.name,dimensionName:b.name,values:[b.values?.[0]??b.extent?.[0]],isSlice:!0}));f=e.getSliceIndex(f,r);f=null==f?null:k[f];null!=f&&(f=this.rasterJobHandler?await this.rasterJobHandler.computeStatisticsHistograms({pixelBlock:f},a):h.computeStatisticsHistograms(f),d.statistics=f.statistics,d.histograms||(d.histograms=f.histograms))}}}};p.__decorate([F.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);p.__decorate([F.property()],u.prototype,
"source",void 0);p.__decorate([F.property()],u.prototype,"url",null);return u=p.__decorate([B.subclass("esri.layers.support.rasterDatasets.InMemoryRaster")],u)})},"esri/layers/support/rasterDatasets/ImageAuxRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/has ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRaster ./InMemoryRaster ./pamParser ../rasterFormats/RasterCodec ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference ../../../geometry/Extent".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w){u=class extends D{fetchRawTile(k,r,a,f={}){return this._inMemoryRaster.fetchRawTile(k,r,a,f)}async _open(k){var r=await this._fetchData(k);let {spatialReference:a,statistics:f,histograms:l,transform:d}=await this._fetchAuxiliaryData(k);(k=!a)&&(a=new m({wkid:3857}));l?.length&&null==f&&(f=n.estimateStatisticsFromHistograms(l));const {width:b,height:g}=r;let z=new w({xmin:-.5,ymin:.5-g,xmax:b-.5,ymax:.5,spatialReference:a});const v=d?d.forwardTransform(z):
z;var C=!0;d&&(C=(C=d.forwardCoefficients)&&0===C[1]&&0===C[2])&&(d=null,z=v);r=new q({source:{extent:v,nativeExtent:z,transform:d,pixelBlocks:[r],statistics:f,histograms:l,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:k},ioConfig:{sampling:"closest",skipStatistics:!0}});this.ioConfig.skipMapInfo&&(r.ioConfig.skipMapInfo=!0);await r.open();r.source=null;this._set("rasterInfo",r.rasterInfo);this._inMemoryRaster=r}async _fetchData(k){({data:k}=await this.request(this.url,{responseType:"array-buffer",
signal:k?.signal}));var r=e.getFormat(k).toUpperCase();if("JPG"===r||"PNG"===r||"GIF"===r||"BMP"===r)this._set("datasetFormat",r);else throw new t("image-aux-raster:open","the data is not a supported format");r=r.toLowerCase();const a="gif"===r||"bmp"===r||!L("ios");k=await this.decodePixelBlock(k,{format:r,useCanvas:a,hasNoZlibMask:!0});if(null==k)throw new t("image-aux-raster:open","the data cannot be decoded");return k}async _fetchAuxiliaryData(k){k=k?.signal;const {skipExtensions:r=[],skipMapInfo:a}=
this.ioConfig;var f=a||r.includes("aux.xml")?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:k}),l=this.datasetFormat;l=(l="JPG"===l?"jgw":"PNG"===l?"pgw":"BMP"===l?"bpw":null)&&r.includes(l)?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+l,{responseType:"text",signal:k});f=await F.eachAlways([f,l]);if(k?.aborted)throw F.createAbortError();k=c.parsePAMInfo(f[0].value?.data);k.transform||(f=f[1].value?f[1].value.data.split("\n").slice(0,6).map(d=>Number(d)):null,
k.transform=6===f?.length?new h({forwardCoefficients:[f[4],f[5],f[0],-f[1],f[2],-f[3]]}):null);return k}};p.__decorate([P.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);return u=p.__decorate([B.subclass("esri.layers.support.rasterDatasets.ImageAuxRaster")],u)})},"esri/layers/support/rasterDatasets/pamParser":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../geometry/support/spatialReferenceUtils ./xmlUtilities ../rasterTransforms/PolynomialTransform ../../../geometry/SpatialReference".split(" "),
function(p,u,t,L,F,P,M){function Q(e,n){if(!e||!n)return null;const h=[];for(let m=0;m<e.length;m++)h.push(e[m]),h.push(n[m]);return h}function B(e){var n=F.getElement(e,"GeodataXform");e=F.getElementNumericValue(n,"SpatialReference/WKID")||F.getElementValue(n,"SpatialReference/WKT");e=q(e);if("typens:PolynomialXform"!==n.getAttribute("xsi:type"))return{spatialReference:e,transform:null};var h=F.getElementNumericValue(n,"PolynomialOrder")??1,m=F.getElementNumericValues(n,"CoeffX/Double");const w=
F.getElementNumericValues(n,"CoeffY/Double");var k=F.getElementNumericValues(n,"InverseCoeffX/Double");n=F.getElementNumericValues(n,"InverseCoeffY/Double");m=Q(m,w);k=Q(k,n);h=m&&k&&m.length&&k.length?new P({spatialReference:e,polynomialOrder:h,forwardCoefficients:m,inverseCoefficients:k}):null;return{spatialReference:e,transform:h}}function D(e){const n=F.getElementNumericValue(e,"NoDataValue");var h=F.getElement(e,"Histograms/HistItem");const m=F.getElementNumericValue(h,"HistMin"),w=F.getElementNumericValue(h,
"HistMax"),k=F.getElementNumericValue(h,"BucketCount");h=F.getElementValue(h,"HistCounts")?.split("|").map(d=>Number(d));let r,a,f,l;F.getElements(e,"Metadata/MDI").forEach(d=>{const b=Number(d.textContent??d.nodeValue);switch(d.getAttribute("key").toUpperCase()){case "STATISTICS_MINIMUM":r=b;break;case "STATISTICS_MAXIMUM":a=b;break;case "STATISTICS_MEAN":f=b;break;case "STATISTICS_STDDEV":l=b}});e=F.getElementNumericValue(e,"Metadata/SourceBandIndex");return{noDataValue:n,histogram:h?.length&&null!=
m&&null!=w?{min:m,max:w,size:k||h.length,counts:h}:null,sourceBandIndex:e,statistics:null!=r&&null!=a?{min:r,max:a,avg:f,stddev:l}:null}}function q(e){if(!e)return null;var n=Number(e);if(!isNaN(n)&&0!==n)return new M({wkid:n});e=String(e).trim();if(L.isWKT2(e))return new M({wkt2:e});var h=e.toUpperCase();if(h.startsWith("COMPD_CS")){if(!h.includes("VERTCS")||!h.includes("GEOGCS")&&!h.startsWith("PROJCS"))return null;n=h.indexOf("VERTCS");const m=h.indexOf("PROJCS");h=-1<m?m:h.indexOf("GEOGCS");if(-1===
h)return null;h=e.slice(h,e.lastIndexOf("]",n)+1).trim();e=e.slice(n,e.lastIndexOf("]")).trim();n=(n=c(h))?new M({wkid:n}):new M({wkt:h});if(e=c(e))n.vcsWkid=e;return n}if(!h.startsWith("GEOGCS")&&!h.startsWith("PROJCS"))return null;n=c(e);return 0!==n?new M({wkid:n}):new M({wkt:e})}function c(e){var n=e.replaceAll("]","[").replaceAll('"',"").split("[").map(m=>m.trim()).filter(m=>""!==m);n=n[n.length-1].split(",");const h=n[0]?.toLowerCase();return"epsg"!==h&&"esri"!==h||!e.endsWith('"]]')||(e=Number(n[1]),
isNaN(e)||0===e)?0:e}p.parsePAMInfo=function(e){if("pamdataset"!==e?.documentElement.tagName?.toLowerCase())return{};const n={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};e.documentElement.childNodes.forEach(h=>{if(1===h.nodeType)if(F.isSameTagIgnoreNS(h,"SRS"))n.spatialReference||(h=F.getElementValue(h),n.spatialReference=q(h));else if(F.isSameTagIgnoreNS(h,"Metadata"))if("xml:ESRI"===h.getAttribute("domain")){const {spatialReference:m,transform:w}=
B(h);n.transform=w;n.spatialReference||(n.spatialReference=m)}else F.getElements(h,"MDI").forEach(m=>n.metadata[m.getAttribute("key")]=F.getElementValue(m));else F.isSameTagIgnoreNS(h,"PAMRasterBand")&&(h=D(h),null!=h.sourceBandIndex&&null==n.rasterBands[h.sourceBandIndex]?n.rasterBands[h.sourceBandIndex]=h:n.rasterBands.push(h))});e=n.rasterBands;e.length&&(n.statistics=e[0].statistics?e.map(h=>h.statistics).filter(t.isSome):null,n.histograms=e[0].histogram?e.map(h=>h.histogram).filter(t.isSome):
null);return n};p.parseSpatialReference=q;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/xmlUtilities":function(){define(["exports"],function(p){function u(P,M){if(!P||!M)return[];var Q=M;M.includes("/")?(Q=M.slice(0,M.indexOf("/")),M=M.slice(M.indexOf("/")+1)):M="";const B=[];if(M){P=u(P,Q);for(Q=0;Q<P.length;Q++)u(P[Q],M).forEach(D=>B.push(D));return B}M=P.getElementsByTagNameNS("*",Q);if(!M||0===M.length)return[];for(P=0;P<M.length;P++)B.push(M[P]||
M.item(P));return B}function t(P,M){if(!P||!M)return null;let Q=M;M.includes("/")?(Q=M.slice(0,M.indexOf("/")),M=M.slice(M.indexOf("/")+1)):M="";P=u(P,Q);return 0<P.length?M?t(P[0],M):P[0]:null}function L(P,M=null){if(P=M?t(P,M):P)if(P=P.textContent||P.nodeValue)return P.trim();return null}function F(P,M){P=u(P,M);M=[];let Q;for(let B=0;B<P.length;B++)if(Q=P[B].textContent||P[B].nodeValue)Q=Q.trim(),""!==Q&&M.push(Q);return M}p.getElement=t;p.getElementNumericValue=function(P,M){P=L(P,M);return Number(P)};
p.getElementNumericValues=function(P,M){return F(P,M).map(Q=>Number(Q))};p.getElementValue=L;p.getElementValues=F;p.getElements=u;p.getNodeNameIgnoreNS=function(P){return P.nodeName.slice(P.nodeName.lastIndexOf(":")+1)};p.getSpaceDelimitedNumericValues=function(P,M=null){return L(P,M)?.split(" ").map(Q=>Number(Q))??[]};p.isSameTagIgnoreNS=function(P,M){P=P?.nodeName?.toLowerCase();M=M.toLowerCase();return P.slice(P.lastIndexOf(":")+1)===M};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e){function n(w,k,r){const {x:a,y:f}=k;if(2>r)return{x:w[0]+a*w[2]+f*w[4],y:w[1]+a*w[3]+f*w[5]};if(2===r){k=a*a;r=f*f;var l=a*f;return{x:w[0]+a*w[2]+f*w[4]+k*w[6]+l*w[8]+r*w[10],y:w[1]+a*w[3]+f*w[5]+k*w[7]+l*w[9]+r*w[11]}}k=a*a;r=f*f;l=a*f;const d=k*a,b=k*f,g=a*r,z=f*r;return{x:w[0]+a*w[2]+f*w[4]+k*w[6]+l*w[8]+r*w[10]+d*w[12]+b*w[14]+g*w[16]+z*w[18],y:w[1]+a*w[3]+f*w[5]+k*w[7]+l*w[9]+r*w[11]+d*w[13]+b*w[15]+g*w[17]+z*w[19]}}function h(w,k,r){const {xmin:a,ymin:f,xmax:l,
ymax:d,spatialReference:b}=k;k=[];if(2>r)k.push({x:a,y:d}),k.push({x:l,y:d}),k.push({x:a,y:f}),k.push({x:l,y:f});else{var g=10;for(var z=0;z<g;z++)k.push({x:a,y:f+(d-f)*z/(g-1)}),k.push({x:l,y:f+(d-f)*z/(g-1)});g=8;for(z=1;z<=g;z++)k.push({x:a+(l-a)*z/g,y:f}),k.push({x:a+(l-a)*z/g,y:d})}k=k.map(v=>n(w,v,r));g=k.map(v=>v.x);k=k.map(v=>v.y);return new e({xmin:Math.min.apply(null,g),xmax:Math.max.apply(null,g),ymin:Math.min.apply(null,k),ymax:Math.max.apply(null,k),spatialReference:b})}var m;u=m=class extends q{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(w,k){const {coeffX:r,coeffY:a}=k;if(!r?.length||!a?.length||r.length!==a.length)return null;w=[];for(k=0;k<r.length;k++)w.push(r[k]),w.push(a[k]);return w}writeForwardCoefficients(w,k,r){r=[];const a=[];for(let f=0;f<w?.length;f++)0===f%2?r.push(w[f]):a.push(w[f]);k.coeffX=r;k.coeffY=a}get inverseCoefficients(){var w=this._get("inverseCoefficients"),k=this._get("forwardCoefficients");if(!w&&k&&2>this.polynomialOrder){const [r,a,
f,l,d,b]=k;w=f*b-d*l;k=d*l-f*b;w=[(d*a-r*b)/w,(f*a-r*l)/k,b/w,l/k,-d/w,-f/k]}return w}set inverseCoefficients(w){this._set("inverseCoefficients",w)}readInverseCoefficients(w,k){const {inverseCoeffX:r,inverseCoeffY:a}=k;if(!r?.length||!a?.length||r.length!==a.length)return null;w=[];for(k=0;k<r.length;k++)w.push(r[k]),w.push(a[k]);return w}writeInverseCoefficients(w,k,r){r=[];const a=[];for(let f=0;f<w?.length;f++)0===f%2?r.push(w[f]):a.push(w[f]);k.inverseCoeffX=r;k.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(w){if("point"===w.type){const k=n(this.forwardCoefficients,w,this.polynomialOrder);return new c({x:k.x,y:k.y,spatialReference:w.spatialReference})}return h(this.forwardCoefficients,w,this.polynomialOrder)}inverseTransform(w){if("point"===w.type){const k=n(this.inverseCoefficients,w,this.polynomialOrder);return new c({x:k.x,y:k.y,spatialReference:w.spatialReference})}return h(this.inverseCoefficients,w,this.polynomialOrder)}clone(){return new m({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};p.__decorate([t.property({json:{write:!0}})],u.prototype,"polynomialOrder",void 0);p.__decorate([t.property()],u.prototype,"forwardCoefficients",void 0);p.__decorate([Q.reader("forwardCoefficients",["coeffX","coeffY"])],u.prototype,"readForwardCoefficients",null);p.__decorate([D.writer("forwardCoefficients")],u.prototype,"writeForwardCoefficients",
null);p.__decorate([t.property({json:{write:!0}})],u.prototype,"inverseCoefficients",null);p.__decorate([Q.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],u.prototype,"readInverseCoefficients",null);p.__decorate([D.writer("inverseCoefficients")],u.prototype,"writeInverseCoefficients",null);p.__decorate([t.property()],u.prototype,"affectsPixelSize",null);p.__decorate([M.enumeration({PolynomialXform:"polynomial"})],u.prototype,"type",void 0);return u=m=p.__decorate([B.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
u)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(p,u,t,L,F,P,M){u=class extends u.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(Q){return Q}inverseTransform(Q){return Q}};p.__decorate([t.property()],u.prototype,"affectsPixelSize",
null);p.__decorate([t.property({json:{write:!0}})],u.prototype,"spatialReference",void 0);return u=p.__decorate([M.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],u)})},"esri/layers/support/rasterDatasets/ImageServerRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/maybe ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ../TileInfo ../TilemapCache ./BaseRaster ../rasterFunctions/pixelUtils ../rasterTransforms/GCSShiftTransform ../../../rest/imageService/fetchRasterInfo ../../../geometry/SpatialReference ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f){function l(b,g){if(!b)return null;const {minScale:z,maxScale:v,minLOD:C,maxLOD:y}=g;if(null!=C&&null!=y)return e.fromJSON({...b,lods:b.lods.filter(({level:A})=>null!=A&&A>=C&&A<=y)});if(0!==z&&0!==v){const A=z?Math.round(1E4*z)/1E4:Infinity,x=v?Math.round(1E4*v)/1E4:-Infinity;return e.fromJSON({...b,lods:b.lods.filter(E=>{E=Math.round(1E4*E.scale)/1E4;return E<=A&&E>=x})})}return e.fromJSON(b)}function d(b){const {extent:g,spatialReference:z}=b;
-1<g.xmin&&181<g.xmax&&z?.wkid&&z.isGeographic&&(b.nativeExtent=b.extent,b.transform=new w,b.extent=b.transform.forwardTransform(g))}u=class extends h{constructor(){super(...arguments);this._levelOffset=0;this._slices=this._tilemapCache=null;this.datasetFormat="RasterTileServer";this.tileType=null}async fetchRawTile(b,g,z,v={}){const {storageInfo:C,extent:y}=this.rasterInfo;var {transposeInfo:A}=C,x=null!=A&&!!v.transposedVariableName;if(this._slices&&!x&&null==v.sliceId)return null;({data:v}=await this.request(`${this.url}/tile/${x?
0:C.maximumPyramidLevel-b+this._levelOffset}/${g}/${z}`,{query:this._slices?x?{variable:v.transposedVariableName}:{sliceId:v.sliceId||0}:null,responseType:"array-buffer",signal:v.signal}));if(!v)return null;A=x?A.tileSize:C.tileInfo.size;x=await this.decodePixelBlock(v,{width:A[0],height:A[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType,returnInterleaved:x,noDataValue:this.rasterInfo.noDataValue});if(null==x)return null;A=C.blockBoundary[b];if("jpg"!==C.compression||z>A.minCol&&
z<A.maxCol&&g>A.minRow&&g<A.maxRow)return x;const {origin:E,blockWidth:N,blockHeight:G}=C,{x:O,y:H}=this.getPyramidPixelSize(b);var J=Math.round((y.xmin-E.x)/O)%N;b=Math.round((y.xmax-E.x)/O)%N||N;var R=Math.round((E.y-y.ymax)/H)%G;v=Math.round((E.y-y.ymin)/H)%G||G;J=z===A.minCol?J:0;R=g===A.minRow?R:0;m.setValidBoundary(x,{x:J,y:R},{width:(z===A.maxCol?b:N)-J,height:(g===A.maxRow?v:G)-R});return x}getSliceIndex(b){if(!this._slices||null==b||0===b.length)return null;for(let g=0;g<this._slices.length;g++){const z=
this._slices[g].multidimensionalDefinition;if(z.length===b.length&&!z.some(v=>{var C=b.find(A=>v.variableName===A.variableName&&A.dimensionName===v.dimensionName);if(!C)return!0;const y=Array.isArray(v.values[0])?`${v.values[0][0]}-${v.values[0][1]}`:v.values[0];C=Array.isArray(C.values[0])?`${C.values[0][0]}-${C.values[0][1]}`:C.values[0];return y!==C}))return g}return null}async fetchVariableStatisticsHistograms(b,g){var z=this.request(this.url+"/statistics",{query:{variable:b,f:"json"},signal:g}).then(v=>
v.data?.statistics);b=this.request(this.url+"/histograms",{query:{variable:b,f:"json"},signal:g}).then(v=>v.data?.histograms);z=await Promise.all([z,b]);z[0]&&z[0].forEach(v=>{v.avg=v.mean;v.stddev=v.standardDeviation});z[1]?.[0]?.counts?.length||(z[1]=null);return{statistics:z[0]||null,histograms:z[1]||null}}async computeBestPyramidLevelForLocation(b,g={}){if(!this._tilemapCache)return 0;b=this.identifyPixelLocation(b,0,g.datumTransformation);if(null===b)return null;let z=0;var {maximumPyramidLevel:v}=
this.rasterInfo.storageInfo;v=v-z+this._levelOffset;const C=b.srcLocation;for(;0<=v;){try{if("available"===await this._tilemapCache.fetchAvailability(v,b.row,b.col,g))break}catch{}v--;z++;b=this.identifyPixelLocation(C,z,g.datumTransformation);if(null===b)return null}return-1===v||null==b?null:z}async _open(b){var g=b?.signal;b=this.sourceJSON?{data:this.sourceJSON}:await this.request(this.url,{query:{f:"json"},signal:g});b.ssl&&(this.url=this.url.replace(/^http:/i,"https:"));this.sourceJSON=b=b.data;
if(!b)throw new t("imageserverraster:open","cannot initialize tiled image service, missing service info");if(!b.tileInfo)throw new t("imageserverraster:open","use ImageryLayer to open non-tiled image services");this._fixScaleInServiceInfo();var z="jpg jpeg png png8 png24 png32 mixed".split(" ");this.tileType=b.cacheType;null==this.tileType&&(z.includes(b.tileInfo.format.toLowerCase())?this.tileType="Map":"lerc"===b.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster");this.datasetName=
b.name?.slice(b.name.indexOf("/")+1)??"";g=await this._fetchRasterInfo({signal:g});if(null==g)throw new t("image-server-raster:open","cannot initialize image service");k.patchServiceInfo(g,b);z="Map"===this.tileType?l(b.tileInfo,b):e.fromJSON(b.tileInfo);L.assertIsSome(z);const [v,C]=this._computeMinMaxLOD(g,z),{extent:y,pixelSize:A}=g,x=.5/g.width*A.x,E=Math.max(A.x,A.y),{lods:N}=z;if("Map"!==this.tileType&&0!==b.maxScale||Math.abs(A.x-A.y)>x||!N.some(K=>Math.abs(K.resolution-E)<x))A.x=A.y=v.resolution,
g.width=Math.ceil((y.xmax-y.xmin)/A.x-.1),g.height=Math.ceil((y.ymax-y.ymin)/A.y-.1);const G=v.level-C.level,[O,H]=z.size,J=[],R=[];N.forEach((K,S)=>{K.level>=C.level&&K.level<=v.level&&J.push({x:K.resolution,y:K.resolution});S<N.length-1&&R.push(Math.round(10*K.resolution/N[S+1].resolution)/10)});J.sort((K,S)=>K.x-S.x);const Y=this.computeBlockBoundary(y,O,H,z.origin,J,G),T=1<J.length?J.slice(1):null;var X;b.transposeInfo&&(X={tileSize:[b.transposeInfo.rows,b.transposeInfo.cols],packetSize:g.keyProperties?._yxs.PacketSize??
0});const V=1>=R.length||3<=R.length&&R.slice(0,-1).every(K=>K===R[0])?R[0]??2:Math.round(10/(C.resolution/v.resolution)**(-1/G))/10;g.storageInfo=new c({blockWidth:z.size[0],blockHeight:z.size[1],pyramidBlockWidth:z.size[0],pyramidBlockHeight:z.size[1],pyramidResolutions:T,pyramidScalingFactor:V,compression:z.format,origin:z.origin,firstPyramidLevel:1,maximumPyramidLevel:G,tileInfo:z,transposeInfo:X,blockBoundary:Y});d(g);this._set("rasterInfo",g);b.capabilities.toLowerCase().includes("tilemap")&&
(X={tileInfo:g.storageInfo.tileInfo,parsedUrl:F.urlToObject(this.url),url:this.url,tileServers:[]},this._tilemapCache=new n.TilemapCache({layer:X}))}async _fetchRasterInfo(b){var g=this.sourceJSON;if("Map"===this.tileType){b=g.fullExtent||g.extent;var z=Math.ceil((b.xmax-b.xmin)/g.pixelSizeX-.1);const v=Math.ceil((b.ymax-b.ymin)/g.pixelSizeY-.1),C=r.fromJSON(g.spatialReference||b.spatialReference);g=new a({x:g.pixelSizeX,y:g.pixelSizeY,spatialReference:C});return new q({width:z,height:v,bandCount:3,
extent:f.fromJSON(b),spatialReference:C,pixelSize:g,pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}})}({signal:z}=b);b=k.fetchServiceRasterInfo(this.url,this.sourceJSON,{signal:z,query:this.ioConfig.customFetchParameters});g=g.hasMultidimensions?this.request(`${this.url}/slices`,{query:{f:"json"},signal:z}).then(v=>v.data?.slices).catch(()=>null):null;g=await Promise.all([b,g]);this._slices=g[1];return g[0]}_fixScaleInServiceInfo(){const {sourceJSON:b}=this;b.minScale&&0>b.minScale&&
(b.minScale=0);b.maxScale&&0>b.maxScale&&(b.maxScale=0)}_computeMinMaxLOD(b,g){const {pixelSize:z}=b,v=.5/b.width*z.x;({lods:b}=g);var C=g.lodAt(Math.max.apply(null,b.map(E=>E.level)));g=g.lodAt(Math.min.apply(null,b.map(E=>E.level)));var {tileType:y}=this;if("Map"===y)return this._levelOffset=b[0].level,[C,g];if("Raster"===y)return[b.find(E=>E.resolution===z.x)??C,g];const {minScale:A,maxScale:x}=this.sourceJSON;y=C;0<x&&((y=b.find(E=>Math.abs(E.scale-x)<v))||(y=b.filter(E=>E.scale>x).sort((E,N)=>
E.scale>N.scale?1:-1)[0]??C));C=g;0<A&&(C=b.find(E=>Math.abs(E.scale-A)<v)??g,this._levelOffset=C.level-g.level);return[y,C]}};p.__decorate([P.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);p.__decorate([P.property()],u.prototype,"tileType",void 0);return u=p.__decorate([D.subclass("esri.layers.support.rasterDatasets.ImageServerRaster")],u)})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/ByteSizeUnit ../../core/Error ../../core/handleUtils ../../core/has ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a){function f(d,b,g){return new P("tile-map:tile-unavailable","Tile is not available",{level:d,row:b,col:g})}var l;p.TilemapCache=l=class extends L{constructor(d){super(d);this._pendingTilemapRequests={};this.request=t;this.size=32;this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new B.LRUCache(2*F.ByteSizeUnit.MEGABYTES);this.addHandles(c.watch(()=>{const {layer:d}=this;return[d?.parsedUrl,d?.tileServers,d?.apiKey,d?.customParameters]},()=>
this._initializeTilemapDefinition(),c.initial))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}getAvailability(d,b,g){return!this.layer.tileInfo.lodAt(d)||d<this.effectiveMinLOD||d>this.effectiveMaxLOD?"unavailable":(d=this._tilemapFromCache(d,b,g,this._tmpTilemapDefinition))?d.getAvailability(b,g):"unknown"}fetchAvailability(d,b,g,z){return!this.layer.tileInfo.lodAt(d)||
d<this.effectiveMinLOD||d>this.effectiveMaxLOD?Promise.reject(f(d,b,g)):this._fetchTilemap(d,b,g,z).catch(v=>v).then(v=>{if(v instanceof a.Tilemap){v=v.getAvailability(b,g);if("unavailable"===v)throw f(d,b,g);return v}if(q.isAbortError(v))throw v;return"unknown"})}fetchAvailabilityUpsample(d,b,g,z,v){z.level=d;z.row=b;z.col=g;const C=this.layer.tileInfo;C.updateTileInfo(z);const y=this.fetchAvailability(d,b,g,v).catch(A=>{if(q.isAbortError(A))throw A;if(C.upsampleTile(z))return this.fetchAvailabilityUpsample(z.level,
z.row,z.col,z,v);throw A;});this._fetchAvailabilityUpsamplePrefetch(z.id,d,b,g,v,y);return y}async _fetchAvailabilityUpsamplePrefetch(d,b,g,z,v,C){if(this._prefetchingEnabled&&null!=d){var y=`prefetch-${d}`;if(!this.hasHandles(y)){var A=new AbortController;C.then(()=>A.abort(),()=>A.abort());var x=!1;C=M.makeHandle(()=>{x||(x=!0,A.abort())});this.addHandles(C,y);await e.waitTicks(10,A.signal).catch(()=>{});x||(x=!0,this.removeHandles(y));if(!q.isAborted(A))for(d=new r.TileKey(d,b,g,z),v={...v,signal:A.signal},
b=this.layer.tileInfo,g=0;l._prefetches.length<l._maxPrefetch&&b.upsampleTile(d);++g){const E=this.fetchAvailability(d.level,d.row,d.col,v);l._prefetches.push(E);z=()=>{l._prefetches.removeUnordered(E)};E.then(z,z)}}}}_fetchTilemap(d,b,g,z){if(!this.layer.tileInfo.lodAt(d)||d<this.effectiveMinLOD||d>this.effectiveMaxLOD)return Promise.reject(new P("tilemap-cache:level-unavailable",`Level ${d} is unavailable in the service`));const v=this._tmpTilemapDefinition;if(d=this._tilemapFromCache(d,b,g,v))return Promise.resolve(d);
const C=z?.signal;z={...z,signal:null};return new Promise((y,A)=>{q.onAbort(C,()=>A(q.createAbortError()));const x=a.tilemapDefinitionId(v);let E=this._pendingTilemapRequests[x];if(!E){E=a.Tilemap.fromDefinition(v,z).then(G=>{this._tilemapCache.put(x,G,G.byteSize);return G});const N=()=>{delete this._pendingTilemapRequests[x]};this._pendingTilemapRequests[x]=E;E.then(N,N)}E.then(y,A)})}_initializeTilemapDefinition(){if(this.layer.parsedUrl){var {parsedUrl:d,apiKey:b,customParameters:g}=this.layer;
this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:d.path,query:n.objectToQuery({...d.query,...g,token:b??d.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}}_tilemapFromCache(d,b,g,z){z.level=d;z.row=b-b%this.size;z.col=g-g%this.size;d=a.tilemapDefinitionId(z);return this._tilemapCache.get(d)}get test(){}};p.TilemapCache._maxPrefetch=4;p.TilemapCache._prefetches=new D({initialSize:l._maxPrefetch});u.__decorate([h.property({constructOnly:!0})],
p.TilemapCache.prototype,"layer",void 0);u.__decorate([h.property({constructOnly:!0})],p.TilemapCache.prototype,"minLOD",void 0);u.__decorate([h.property({constructOnly:!0})],p.TilemapCache.prototype,"maxLOD",void 0);u.__decorate([h.property({constructOnly:!0})],p.TilemapCache.prototype,"request",void 0);u.__decorate([h.property({constructOnly:!0})],p.TilemapCache.prototype,"size",void 0);p.TilemapCache=l=u.__decorate([k.subclass("esri.layers.support.TilemapCache")],p.TilemapCache);Object.defineProperty(p,
Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(p){p.ByteSizeUnit=void 0;var u=p.ByteSizeUnit||(p.ByteSizeUnit={});u[u.KILOBYTES=1024]="KILOBYTES";u[u.MEGABYTES=1048576]="MEGABYTES";u[u.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define("exports ../../request ../../core/Error ../../core/lang ../../core/typedArrayUtil ../../geometry/support/UintArray".split(" "),
function(p,u,t,L,F,P){function M(B){if(B.service.tileServers?.length){var D=B.service.tileServers;D=`${D&&D.length?D[B.row%D.length]:B.service.url}/tilemap/${B.level}/${B.row}/${B.col}/${B.width}/${B.height}`}else D=`${B.service.url}/tilemap/${B.level}/${B.row}/${B.col}/${B.width}/${B.height}`;(B=B.service.query)&&(D=`${D}?${B}`);return D}class Q{constructor(B){if(!B?.location)throw new t("tilemap:missing-location","Location missing from tilemap response");if(!1===B.valid)throw new t("tilemap:invalid",
"Tilemap response was marked as invalid");if(!B.data)throw new t("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(B.data))throw new t("tilemap:data-mismatch","Data must be an array of numbers");if(B.data.length!==B.location.width*B.location.height)throw new t("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");const {location:D,data:q}=B;this.location=Object.freeze(L.clone(D));let c=B=!0;const e=P.newUintArray(Math.ceil(this.location.width*
this.location.height/32));let n=0;for(let h=0;h<q.length;h++){const m=h%32;q[h]?(c=!1,e[n]|=1<<m):B=!1;31===m&&++n}c?(this._availability="unavailable",this.byteSize=40):B?(this._availability="available",this.byteSize=40):(this._availability=e,this.byteSize=40+F.estimateSize(e))}getAvailability(B,D){if("unavailable"===this._availability||"available"===this._availability)return this._availability;B=(B-this.location.top)*this.location.width+(D-this.location.left);D=B>>5;const q=this._availability;return 0>
D||D>q.length?"unknown":q[D]&1<<B%32?"available":"unavailable"}static fromDefinition(B,D){const q=B.service.request||u,{row:c,col:e,width:n,height:h}=B,m={query:{f:"json"}};D=D?{...m,...D}:m;return q(M(B),D).then(w=>w.data).catch(w=>{if(422===w?.details?.httpStatus)return{location:{top:c,left:e,width:n,height:h},valid:!0,data:Array(n*h).fill(0)};throw w;}).then(w=>{if(w.location&&(w.location.top!==c||w.location.left!==e||w.location.width!==n||w.location.height!==h))throw new t("tilemap:location-mismatch",
"Tilemap response for different location than requested",{response:w,definition:{top:c,left:e,width:n,height:h}});return Q.fromJSON(w)})}static fromJSON(B){return Object.freeze(new Q(B))}}p.Tilemap=Q;p.tilemapDefinitionId=function(B){return`${B.level}/${B.row}/${B.col}/${B.width}/${B.height}`};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/UintArray":function(){define(["exports","../../core/typedArrayUtil"],function(p,u){p.newUintArray=function(t,L=!1){return t<=
u.nativeArrayMaxSize?L?Array(t).fill(0):Array(t):new Uint32Array(t)};p.uintSubArray=function(t,L,F){return Array.isArray(t)?t.slice(L,L+F):t.subarray(L,L+F)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(p,u,t,L,F,P,M,Q){var B;t=B=class extends Q{constructor(){super(...arguments);this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(D){D=D.clone();if("point"===D.type)return D.x>180+this.tolerance&&(D.x-=360),D;D.xmin>=180-this.tolerance?(D.xmax-=360,D.xmin-=360):D.xmax>180+this.tolerance&&(D.xmin=-180,D.xmax=180);return D}inverseTransform(D){D=D.clone();if("point"===D.type)return D.x<-this.tolerance&&(D.x+=360),D;D.xmin<-this.tolerance&&(D.xmin+=360,D.xmax+=360);return D}clone(){return new B({tolerance:this.tolerance})}};
p.__decorate([P.enumeration({GCSShiftXform:"gcs-shift"})],t.prototype,"type",void 0);p.__decorate([u.property()],t.prototype,"tolerance",void 0);return t=B=p.__decorate([M.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],t)})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../../layers/support/RasterStorageInfo ../utils ../support/FeatureSet".split(" "),
function(p,u,t,L,F,P,M,Q,B){async function D(q,c,e){q=Q.parseUrl(q);const {rasterFunction:n,sourceJSON:h}=c||{};c=n?JSON.stringify(n.rasterFunctionDefinition||n):null;c=Q.encode({...q.query,renderingRule:c,f:"json"});c=Q.asValidOptions(c,e);q=q.path;e=h||await u(q,c).then(v=>v.data);var m=e.hasRasterAttributeTable?u(`${q}/rasterAttributeTable`,c):null,w=e.hasColormap?u(`${q}/colormap`,c):null,k=e.hasHistograms?u(`${q}/histograms`,c):null,r=10.3<=e.currentVersion?u(`${q}/keyProperties`,c):null;q=e.hasMultidimensions?
u(`${q}/multidimensionalInfo`,c):null;k=await Promise.allSettled([m,w,k,r,q]);q=null;if(e.minValues&&e.minValues.length===e.bandCount)for(q=[],c=0;c<e.minValues.length;c++)q.push({min:e.minValues[c],max:e.maxValues[c],avg:e.meanValues[c],stddev:e.stdvValues[c]});m=t.fromJSON(e.extent);c=Math.ceil(m.width/e.pixelSizeX-.1);m=Math.ceil(m.height/e.pixelSizeY-.1);w=F.fromJSON(e.spatialReference||e.extent.spatialReference);r="fulfilled"===k[0].status?k[0].value?.data:null;r=r?.features?.length?B.fromJSON(r):
null;var a="fulfilled"===k[1].status?k[1].value?.data.colormap:null;a=a?.length?a:null;var f="fulfilled"===k[2].status?k[2].value?.data.histograms:null;f=f?.[0]?.counts?.length?f:null;const l="fulfilled"===k[3].status?k[3].value?.data??{}:{};k="fulfilled"===k[4].status?k[4].value?.data.multidimensionalInfo:null;(k=k?.variables?.length?k:null)&&k.variables.forEach(v=>{v.statistics?.length&&v.statistics.forEach(C=>{C.avg=C.mean;C.stddev=C.standardDeviation})});const {defaultVariable:d,serviceDataType:b}=
e;d&&d!==l.DefaultVariable&&(l.DefaultVariable=d);b?.includes("esriImageServiceDataTypeVector")&&!b.includes(l.DataType)&&(l.DataType=b.replace("esriImageServiceDataType",""));let g=e.noDataValue;e.noDataValues?.length&&e.noDataValues.some(v=>v!==g)&&(g=e.noDataValues);const z=e.transposeInfo?new M({blockWidth:256,blockHeight:256,pyramidBlockWidth:256,pyramidBlockHeight:256,pyramidScalingFactor:2,compression:"lerc",origin:new L({x:e.extent.xmin,y:e.extent.ymax,spatialReference:w}),firstPyramidLevel:1,
maximumPyramidLevel:Math.max(0,Math.round(Math.log(Math.max(c,m))/Math.LN2-8)),transposeInfo:e.transposeInfo}):void 0;return new P({width:c,height:m,bandCount:e.bandCount,extent:t.fromJSON(e.extent),spatialReference:w,pixelSize:new L({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:w}),pixelType:e.pixelType.toLowerCase(),statistics:q,attributeTable:r,colormap:a,histograms:f,keyProperties:l,noDataValue:g,multidimensionalInfo:k,storageInfo:z})}p.fetchServiceRasterInfo=function(q,c,e){return D(q,{sourceJSON:c},
e)};p.generateRasterInfo=function(q,c,e){return D(q,{rasterFunction:c},e)};p.patchServiceInfo=function(q,c){q.attributeTable||(c.hasRasterAttributeTable=!1);q.histograms||(c.hasHistograms=!1);q.colormap||(c.hasColormap=!1);q.multidimensionalInfo||(c.hasMultidimensions=!1)};Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/MRFRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/Error ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo ../RasterStorageInfo ./BaseRaster ./pamParser ./xmlUtilities ../rasterFormats/utils ../rasterFunctions/stretchUtils ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r){const a=new Map;a.set("Int8","s8");a.set("UInt8","u8");a.set("Int16","s16");a.set("UInt16","u16");a.set("Int32","s32");a.set("UInt32","u32");a.set("Float32","f32");a.set("Float64","f32");a.set("Double64","f32");const f=new Map;f.set("none",{blobExtension:".til",isOneSegment:!0,decoderFormat:"bip"});f.set("lerc",{blobExtension:".lrc",isOneSegment:!1,decoderFormat:"lerc"});f.set("deflate",{blobExtension:".pzp",isOneSegment:!0,decoderFormat:"deflate"});
f.set("jpeg",{blobExtension:".pjg",isOneSegment:!0,decoderFormat:"jpg"});u=class extends c{constructor(){super(...arguments);this._storageIndex=this._files=null;this.datasetFormat="MRF"}async fetchRawTile(l,d,b,g={}){const {blockWidth:z,blockHeight:v,blockBoundary:C}=this.rasterInfo.storageInfo;var y=C[l];if(!y||y.maxRow<d||y.maxCol<b||y.minRow>d||y.minCol>b)return null;const {bandCount:A,pixelType:x}=this.rasterInfo,{ranges:E,actualTileWidth:N,actualTileHeight:G}=this._getTileLocation(l,d,b);if(!E||
0===E.length)return null;if(0===E[0].from&&0===E[0].to)return l=new Uint8Array(z*v),new B({width:z,height:v,pixels:void 0,mask:l,validPixelCount:0});({bandIds:d}=this.ioConfig);b=this._getBandSegmentCount();y=[];for(l=l=0;l<b;l++)d&&!d.includes(l)||y.push(this.request(this._files.data,{range:{from:E[l].from,to:E[l].to},responseType:"array-buffer",signal:g.signal}));g=await Promise.all(y);l=g.map(J=>J.data.byteLength).reduce((J,R)=>J+R);y=new Uint8Array(l);const O=[];let H=0;for(l=0;l<b;l++)O.push(H),
y.set(new Uint8Array(g[l].data),H),H+=g[l].data.byteLength;l=f.get(this.rasterInfo.storageInfo.compression).decoderFormat;d=await this.decodePixelBlock(y.buffer,{width:z,height:v,format:l,planes:d?.length||A,offsets:O,pixelType:x});if(null==d)return null;({noDataValue:b}=this.rasterInfo);if(null!=b&&"lerc"!==l&&!d.mask&&(b=b[0],null!=b)){g=d.width*d.height;y=new Uint8Array(g);if(1E24<Math.abs(b))for(l=0;l<g;l++)1E-6<Math.abs((d.pixels[0][l]-b)/b)&&(y[l]=1);else for(l=0;l<g;l++)d.pixels[0][l]!==b&&
(y[l]=1);d.mask=y}g=b=0;if(N!==z||G!==v)if(y=d.mask)for(l=0;l<v;l++)for(g=l*z,b=l<G?N:0;b<z;b++)y[g+b]=0;else for(y=new Uint8Array(z*v),d.mask=y,l=0;l<G;l++)for(g=l*z,b=0;b<N;b++)y[g+b]=1;return d}async _open(l){this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1);var d=l?l.signal:null,b=await this.request(this.url,{responseType:"xml",signal:d});const {rasterInfo:g,files:z}=this._parseHeader(b.data),{skipMapInfo:v,skipExtensions:C=[]}=this.ioConfig;C.includes("aux.xml")||v||(l=await this._fetchAuxiliaryData(l),
null!=l&&(g.statistics=l.statistics??g.statistics,(g.histograms=l.histograms)&&null==g.statistics&&(g.statistics=m.estimateStatisticsFromHistograms(l.histograms))));v&&this.updateImageSpaceRasterInfo(g);this._set("rasterInfo",g);this._files=z;d=(await this.request(z.index,{responseType:"array-buffer",signal:d})).data;if(0<d.byteLength%16)throw Error("invalid array buffer must be multiples of 16");var y,A;if(h.isPlatformLittleEndian){l=new Uint8Array(d);var x=new ArrayBuffer(d.byteLength);b=new Uint8Array(x);
for(y=0;y<d.byteLength/4;y++)for(A=0;4>A;A++)b[4*y+A]=l[4*y+3-A];d=new Uint32Array(x)}else d=new Uint32Array(d);this._storageIndex=d;const {blockWidth:E,blockHeight:N}=this.rasterInfo.storageInfo;d=this.rasterInfo.storageInfo.pyramidScalingFactor;const {width:G,height:O}=this.rasterInfo;l=[];b=this._getBandSegmentCount();x=0;for(y=-1;x<this._storageIndex.length;){y++;A=Math.ceil(G/E/d**y)-1;const H=Math.ceil(O/N/d**y)-1;x+=(A+1)*(H+1)*b*4;l.push({maxRow:H,maxCol:A,minCol:0,minRow:0})}this.rasterInfo.storageInfo.blockBoundary=
l;0<y&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=y);this.updateTileInfo()}_getBandSegmentCount(){return f.get(this.rasterInfo.storageInfo.compression).isOneSegment?1:this.rasterInfo.bandCount}_getTileLocation(l,d,b){const {blockWidth:g,blockHeight:z,pyramidScalingFactor:v}=this.rasterInfo.storageInfo,{width:C,height:y}=this.rasterInfo,A=this._getBandSegmentCount();let x,E;var N,G=0;let O=0;for(N=0;N<l;N++)O=v**N,x=Math.ceil(C/g/O),E=Math.ceil(y/
z/O),G+=x*E;O=v**l;x=Math.ceil(C/g/O);E=Math.ceil(y/z/O);G=4*(G+(d*x+b))*A;l=this._storageIndex.subarray(G,G+4*A);G=N=0;const H=[];for(let J=0;J<A;J++)N=l[4*J]*2**32+l[4*J+1],G=N+l[4*J+2]*2**32+l[4*J+3],H.push({from:N,to:G});return{ranges:H,actualTileWidth:b<x-1?g:Math.ceil(C/O)-g*(x-1),actualTileHeight:d<E-1?z:Math.ceil(y/O)-z*(E-1)}}_parseHeader(l){var d=n.getElement(l,"MRF_META/Raster");if(!d)throw new t("mrf:open","not a valid MRF format");var b=n.getElement(d,"Size"),g=parseInt(b.getAttribute("x"),
10),z=parseInt(b.getAttribute("y"),10);const v=parseInt(b.getAttribute("c"),10);b=(n.getElementValue(d,"Compression")||"none").toLowerCase();if(!f.has(b))throw new t("mrf:open","currently does not support compression "+b);var C=n.getElementValue(d,"DataType")||"UInt8";const y=a.get(C);if(null==y)throw new t("mrf:open","currently does not support pixel type "+C);var A=n.getElement(d,"PageSize");C=parseInt(A.getAttribute("x"),10);A=parseInt(A.getAttribute("y"),10);d=n.getElement(d,"DataValues");let x;
d&&(d=d.getAttribute("NoData"),null!=d&&(x=d.trim().split(" ").map(R=>parseFloat(R))));if(n.getElement(l,"MRF_META/CachedSource"))throw new t("mrf:open","currently does not support MRF referencing other data files");var E=n.getElement(l,"MRF_META/GeoTags"),N=n.getElement(E,"BoundingBox");d=!1;if(null!=N){var G=parseFloat(N.getAttribute("minx"));var O=parseFloat(N.getAttribute("miny")),H=parseFloat(N.getAttribute("maxx"));N=parseFloat(N.getAttribute("maxy"));var J=n.getElementValue(E,"Projection")||
"";E=w.WGS84;"LOCAL_CS[]"!==J?J.toLowerCase().startsWith("epsg:")?(J=Number(J.slice(5)),isNaN(J)||0===J||(E=new w({wkid:J}))):E=e.parseSpatialReference(J)??w.WGS84:(d=!0,E=new w({wkid:3857}));G=new k(G,O,H,N);G.spatialReference=E}else d=!0,G=new k({xmin:-.5,ymin:.5-z,xmax:g-.5,ymax:.5,spatialReference:new w({wkid:3857})});O=n.getElement(l,"MRF_META/Rsets");H=parseInt(O?.getAttribute("scale")||"2",10);O=G.spatialReference;C=new q({origin:new r({x:G.xmin,y:G.ymax,spatialReference:O}),blockWidth:C,blockHeight:A,
pyramidBlockWidth:C,pyramidBlockHeight:A,compression:b,pyramidScalingFactor:H});A=new r({x:G.width/g,y:G.height/z,spatialReference:O});g=new D({width:g,height:z,extent:G,isPseudoSpatialReference:d,spatialReference:O,bandCount:v,pixelType:y,pixelSize:A,noDataValue:x,storageInfo:C});z=n.getElementValue(l,"datafile");l=n.getElementValue(l,"IndexFile");l={mrf:this.url,index:l||this.url.replace(".mrf",".idx"),data:z||this.url.replace(".mrf",f.get(b).blobExtension)};return{rasterInfo:g,files:l}}async _fetchAuxiliaryData(l){try{const {data:d}=
await this.request(this.url+".aux.xml",{responseType:"xml",signal:l?.signal});return e.parsePAMInfo(d)}catch{return null}}};p.__decorate([L.property()],u.prototype,"_files",void 0);p.__decorate([L.property()],u.prototype,"_storageIndex",void 0);p.__decorate([L.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);return u=p.__decorate([Q.subclass("esri.layers.support.rasterDatasets.MRFRaster")],u)})},"esri/layers/support/rasterDatasets/TIFFRaster":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/decorators/subclass ../RasterInfo ../RasterStorageInfo ./BaseRaster ./DBFParser ./pamParser ../rasterFormats/TiffDecoder ../rasterFormats/TiffTags ../rasterFunctions/stretchUtils ../rasterTransforms/PolynomialTransform ../../../rest/support/FeatureSet ../../../geometry/SpatialReference ../../../geometry/Extent ../../../geometry/Point".split(" "),
function(p,u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f){function l(d){const b=n.getImageInfo(d),{width:g,height:z,tileWidth:v,tileHeight:C,planes:y,pixelType:A,compression:x,firstPyramidLevel:E,maximumPyramidLevel:N,pyramidBlockWidth:G,pyramidBlockHeight:O,pyramidResolutions:H,tileBoundary:J,affine:R,metadata:Y}=b;let T=e.parseSpatialReference(b.extent.spatialReference?.wkt||b.extent.spatialReference?.wkid);var X=!!b.isPseudoGeographic;null==T&&(X=!0,T=new r({wkid:3857}));const V=new a({...b.extent,spatialReference:T});
var K=V?new f({x:V.xmin,y:V.ymax,spatialReference:T}):new f({x:0,y:0});K=new D({blockWidth:v,blockHeight:C,pyramidBlockWidth:G,pyramidBlockHeight:O,compression:x,origin:K,firstPyramidLevel:E,maximumPyramidLevel:N,pyramidResolutions:H,blockBoundary:J});const S=new f({x:(V.xmax-V.xmin)/g,y:(V.ymax-V.ymin)/z,spatialReference:T}),Z=Y?{BandProperties:Y.bandProperties,DataType:Y.dataType}:{};let ca=null;var I=d[0].get("PHOTOMETRICINTERPRETATION")?.values?.[0];d=d[0].get("COLORMAP")?.values;if(3>=I&&3<d?.length&&
0===d.length%3){ca=[];I=d.length/3;for(let U=0;U<I;U++)ca.push([U,d[U]>>>8,d[U+I]>>>8,d[U+2*I]>>>8])}X=new B({width:g,height:z,bandCount:y,pixelType:A,pixelSize:S,storageInfo:K,spatialReference:T,isPseudoSpatialReference:X,keyProperties:Z,extent:V,colormap:ca,statistics:Y?Y.statistics:null});R?.length&&(X.nativeExtent=new a({xmin:-.5,ymin:.5-z,xmax:g-.5,ymax:.5,spatialReference:T}),X.transform=new w({polynomialOrder:1,forwardCoefficients:[R[2]+R[0]/2,R[5]-R[3]/2,R[0],R[3],-R[1],-R[4]]}),X.extent=
X.transform.forwardTransform(X.nativeExtent),X.pixelSize=new f({x:(V.xmax-V.xmin)/g,y:(V.ymax-V.ymin)/z,spatialReference:T}),K.origin.x=-.5,K.origin.y=.5);if(H){const {x:U,y:W}=X.pixelSize;H.forEach(aa=>{aa.x*=U;aa.y*=W})}return{imageInfo:b,rasterInfo:X}}u=class extends q{constructor(){super(...arguments);this._headerInfo=this._files=null;this._bufferSize=1048576;this.datasetFormat="TIFF"}async fetchRawTile(d,b,g,z={}){if(!this._headerInfo?.isSupported||this.isBlockOutside(d,b,g))return null;const v=
await this._fetchRawTiffTile(d,b,g,!1,z);null!=v&&this._headerInfo.hasMaskBand&&(d=await this._fetchRawTiffTile(d,b,g,!0,z),null!=d&&d.pixels[0]instanceof Uint8Array&&(v.mask=d.pixels[0]));return v}async _open(d){var b=d?d.signal:null,{data:g}=await this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:b});if(!g)throw new L("tiffraster:open","failed to open url "+this.url);this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1,this.url.lastIndexOf("."));
const {littleEndian:z,firstIFDPos:v,isBigTiff:C}=n.parseSignature(g);var y=[];await this._readIFDs(y,g,z,v,0,C?8:4,b);const {imageInfo:A,rasterInfo:x}=l(y);b=n.getPyramidIFDs(y);g=n.getMaskIFDs(y);this._headerInfo={littleEndian:z,isBigTiff:C,ifds:y,pyramidIFDs:b,maskIFDs:g,...A};this._set("rasterInfo",x);if(!A.isSupported)throw new L("tiffraster:open","this tiff is not supported: "+A.message);if(!A.tileWidth)throw new L("tiffraster:open","none-tiled tiff is not optimized for access, convert to COG and retry.");
x.isPseudoSpatialReference&&F.getLogger(this).warn("The spatial reference for this tiff is unsupported. Only EPSG spatial reference codes and Esri WKTs are supported.");b=y[0].get("PREDICTOR")?.values?.[0];if(3===y[0].get("SAMPLEFORMAT")?.values?.[0]&&2===b)throw new L("tiffraster:open","unsupported horizontal difference encoding. Predictor\x3d3 is supported for floating point data");const {skipMapInfo:E,skipExtensions:N=[]}=this.ioConfig;N.includes("aux.xml")||E||(y=await this._fetchAuxiliaryMetaData(d),
null!=y&&(x.statistics=y.statistics??x.statistics,(x.histograms=y.histograms)&&null==x.statistics&&(x.statistics=m.estimateStatisticsFromHistograms(y.histograms)),y.transform&&null==x.transform&&(x.transform=y.transform,x.nativeExtent=x.extent,b=x.transform.forwardTransform(x.nativeExtent),x.pixelSize=new f({x:(b.xmax-b.xmin)/x.width,y:(b.ymax-b.ymin)/x.height,spatialReference:x.spatialReference}),x.extent=b),x.isPseudoSpatialReference&&y.spatialReference&&(x.spatialReference=y.spatialReference,x.extent.spatialReference=
x.nativeExtent.spatialReference=x.storageInfo.origin.spatialReference=x.spatialReference)));N.includes("vat.dbf")||1!==x.bandCount||"u8"!==x.pixelType||E||(x.attributeTable=await this._fetchAuxiliaryTable(d),null!=x.attributeTable&&(x.keyProperties.DataType="thematic"));E&&this.updateImageSpaceRasterInfo(x);this.updateTileInfo()}async _readIFDs(d,b,g,z,v,C=4,y){if(!z)return null;if(z>=b.byteLength||0>z)b=(await this.request(this.url,{range:{from:z+v,to:z+v+this._bufferSize},responseType:"array-buffer",
signal:y})).data,v=z+v,z=0;z=await this._readIFD(b,g,z,v,h.tiffTags,C,y);d.push(z.ifd);if(!z.nextIFD)return null;await this._readIFDs(d,b,g,z.nextIFD-v,v,C,y)}async _readIFD(d,b,g,z,v=h.tiffTags,C=4,y){if(!d)return null;g=n.parseIFD(d,b,g,z,v,C);if(g.success){const A=[];g.ifd?.forEach(x=>{x.values||A.push(x)});0<A.length&&(C=A.map(x=>x.offlineOffsetSize).filter(t.isSome),v=Math.min.apply(null,C.map(x=>x[0])),Math.min.apply(null,C.map(x=>x[0]+x[1]))-v<=this._bufferSize&&({data:C}=await this.request(this.url,
{range:{from:v,to:v+this._bufferSize},responseType:"array-buffer",signal:y}),d=C,z=v,A.forEach(x=>n.parseFieldValues(d,b,x,z))));g.ifd?.has("GEOKEYDIRECTORY")&&(v=g.ifd.get("GEOKEYDIRECTORY"),(C=v?.values)&&4<C.length&&(C=C[0]+"."+C[1]+"."+C[2],y=await this._readIFD(d,b,v.valueOffset+6-z,z,h.geoKeys,2,y),v.data=y.ifd,v.data&&v.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[C]})));return g}if(g.requiredBufferSize&&g.requiredBufferSize!==d.byteLength)return d=(await this.request(this.url,
{range:{from:z,to:z+g.requiredBufferSize+4},responseType:"array-buffer",signal:y})).data,d.byteLength<g.requiredBufferSize?null:this._readIFD(d,b,0,z,h.tiffTags,4,y)}async _fetchRawTiffTile(d,b,g,z,v={}){b=this._getTileLocation(d,b,g,z);if(!b)return null;const {ranges:C,actualTileWidth:y,actualTileHeight:A,ifd:x}=b;b=C.map(O=>this.request(this.url,{range:O,responseType:"array-buffer",signal:v.signal}));b=await Promise.all(b);g=b.map(O=>O.data.byteLength).reduce((O,H)=>O+H);g=1===b.length?b[0].data:
new ArrayBuffer(g);z=[0];var E=[0];if(1<b.length){const O=new Uint8Array(g);for(let H=0,J=0;H<b.length;H++){const R=b[H].data;O.set(new Uint8Array(R),J);z[H]=J;J+=R.byteLength;E[H]=R.byteLength}}const {blockWidth:N,blockHeight:G}=this.getBlockWidthHeight(d);d=await this.decodePixelBlock(g,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:x,offsets:z,sizes:E},width:N,height:G,planes:null,pixelType:null});if(null==d)return null;if(y!==N||A!==G)if(E=d.mask)for(b=0;b<G;b++)for(z=b*N,g=b<A?
y:0;g<N;g++)E[z+g]=0;else for(E=new Uint8Array(N*G),d.mask=E,b=0;b<A;b++)for(z=b*N,g=0;g<y;g++)E[z+g]=1;return d}_getTileLocation(d,b,g,z=!1){const {firstPyramidLevel:v,blockBoundary:C}=this.rasterInfo.storageInfo;var y=0===d?0:d-(v-1);({_headerInfo:d}=this);if(!d)return null;z=z?d.maskIFDs[y]:0===y?d?.ifds[0]:d?.pyramidIFDs[y-1];if(!z)return null;var A=n.isBSQConfig(z,d);d=z.get("TILEOFFSETS")?.values;if(void 0===d)return null;const x=z.get("TILEBYTECOUNTS")?.values,{minRow:E,minCol:N,maxRow:G,maxCol:O}=
C[y];if(b>G||g>O||b<E||g<N)return null;y=z.get("IMAGEWIDTH")?.values?.[0];const H=z.get("IMAGELENGTH")?.values?.[0],J=z.get("TILEWIDTH")?.values?.[0],R=z.get("TILELENGTH")?.values?.[0],Y=[];if(A){({bandCount:A}=this.rasterInfo);for(let T=0;T<A;T++){const X=T*(G+1)*(O+1)+b*(O+1)+g;Y[T]={from:d[X],to:d[X]+x[X]-1}}}else A=b*(O+1)+g,Y.push({from:d[A],to:d[A]+x[A]-1});for(d=0;d<Y.length;d++)if(null==Y[d].from||!Y[d].to||0>Y[d].to)return null;return{ranges:Y,ifd:z,actualTileWidth:g===O?y%J||J:J,actualTileHeight:b===
G?H%R||R:R}}async _fetchAuxiliaryMetaData(d){try{const {data:b}=await this.request(this.url+".aux.xml",{responseType:"xml",signal:d?.signal});return e.parsePAMInfo(b)}catch{return null}}async _fetchAuxiliaryTable(d){try{const {data:b}=await this.request(this.url+".vat.dbf",{responseType:"array-buffer",signal:d?.signal}),g=c.parse(b);return g?.recordSet?k.fromJSON(g.recordSet):null}catch{return null}}};p.__decorate([P.property()],u.prototype,"_files",void 0);p.__decorate([P.property()],u.prototype,
"_headerInfo",void 0);p.__decorate([P.property()],u.prototype,"_bufferSize",void 0);p.__decorate([P.property({type:String,json:{write:!0}})],u.prototype,"datasetFormat",void 0);return u=p.__decorate([Q.subclass("esri.layers.support.rasterDatasets.TIFFRaster")],u)})},"esri/layers/support/rasterDatasets/DBFParser":function(){define(["./byteStreamUtils"],function(p){function u(L){var F=L.fields;L=L.records;const P=F.some(q=>"oid"===q.name.toLowerCase())?"OBJECTID":"OID";F=[{name:P,type:"esriFieldTypeOID",
alias:"OID"}].concat(F.map(q=>({name:q.name,type:"esriFieldType"+q.typeName,alias:q.name})));const M=F.map(q=>q.name),Q=[];let B=0,D=0;L.forEach(q=>{const c={};c[P]=B++;for(D=1;D<M.length;D++)c[M[D]]=q[D-1];Q.push({attributes:c})});return{displayFieldName:"",fields:F,features:Q}}class t{static get supportedVersions(){return[5]}static parse(L){var F=new DataView(L),P=F.getUint8(0)&3;if(3!==P)return{header:{version:P},recordSet:null};const M=F.getUint32(4,!0);var Q=F.getUint16(8,!0);const B=F.getUint16(10,
!0);Q={version:P,recordCount:M,headerByteCount:Q,recordByteCount:B};let D=32;const q=[],c=[];if(3===P){for(;13!==F.getUint8(D);)P=String.fromCharCode(F.getUint8(D+11)).trim(),q.push({name:p.bytesToUTF8(new Uint8Array(L,D,11)),type:P,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(P)],length:F.getUint8(D+16)}),D+=32;D+=1;if(0<q.length)for(;c.length<M&&L.byteLength-D>B;){const e=[];32===F.getUint8(D)?(D+=1,q.forEach(n=>{if("C"===n.type)e.push(p.bytesToUTF8(new Uint8Array(L,
D,n.length)).trim());else if("N"===n.type)e.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(L,D,n.length)).trim(),10));else if("F"===n.type)e.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(L,D,n.length)).trim()));else if("D"===n.type){const h=String.fromCharCode.apply(null,new Uint8Array(L,D,n.length)).trim();e.push(new Date(parseInt(h.slice(0,4),10),parseInt(h.slice(4,6),10)-1,parseInt(h.slice(6,8),10)))}D+=n.length}),c.push(e)):D+=B}}F=u({fields:q,records:c});return{header:Q,
fields:q,records:c,recordSet:F}}}return t})},"*noref":1}});
define("require ../chunks/tslib.es6 ../PopupTemplate ../core/Clonable ../core/Error ../core/Logger ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Layer ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/ImageryTileMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RasterPresetRendererMixin ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/Field ./support/RasterFunction ./support/rasterDatasets/FunctionRaster ./support/rasterDatasets/RasterFactory ./support/rasterFunctions/rasterFunctionHelper ../support/popupUtils ../webdoc/interfaces".split(" "),function(p,
u,t,L,F,P,M,Q,B,D,q,c,e,n,h,m,w,k,r,a,f,l,d,b,g,z,v,C,y,A,x,E,N){L=class extends w.BlendLayer(b.ScaleRangeLayer(a.OperationalLayer(f.PortalLayer(l.RasterPresetRendererMixin(k.CustomParametersMixin(r.ImageryTileMixin(g.TemporalLayer(m.ArcGISService(d.RefreshableLayer(M.MultiOriginJSONMixin(L.ClonableMixin(h)))))))))))){constructor(...G){super(...G);this._primaryRasters=[];this.legendEnabled=!0;this.isReference=null;this.listMode="show";this.version=this.sourceJSON=null;this.type="imagery-tile";this.operationalLayerType=
"ArcGISTiledImageServiceLayer";this.popupEnabled=!0;this.fields=this.popupTemplate=null;this.source=void 0;this._debouncedSaveOperations=Q.debounce(async(O,H,J)=>{const {save:R,saveAs:Y}=await new Promise((T,X)=>p(["./save/imageryUtils"],T,X));switch(O){case N.SaveOperationType.SAVE:return R(this,H);case N.SaveOperationType.SAVE_AS:return Y(this,J,H)}})}normalizeCtorArgs(G,O){return"string"===typeof G?{url:G,...O}:G}load(G){const O=null!=G?G.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},
G).catch(Q.throwIfAbortError).then(()=>this._openRaster(O)));return Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){var G=new v({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"}),O=new v({name:"Raster.ServicePixelValue.Raw",alias:"Raw Pixel Value",domain:null,editable:!1,length:50,type:"string"});G=[G,O];O=this.raster?.rasterInfo??this.serviceRasterInfo;var H=O?.attributeTable;if(H=null!=H?H.fields:
null)H=H.filter(J=>"oid"!==J.type&&"value"!==J.name.toLowerCase()).map(J=>{const R=J.clone();R.name="Raster."+J.name;return R}),G.push(...H);H=O?.dataType;O=O?.multidimensionalInfo;"vector-magdir"!==H&&"vector-uv"!==H||null==O||(O=O.variables[0].unit?.trim(),G.push(new v({name:"Raster.Magnitude",alias:"Magnitude"+(O?` (${O})`:""),domain:null,editable:!1,type:"double"})),G.push(new v({name:"Raster.Direction",alias:"Direction (\u00b0)",domain:null,editable:!1,type:"double"})));return G}createPopupTemplate(G){var {rasterFields:O}=
this;const H=G?.visibleFieldNames??new Set(O.map(({name:J})=>J).filter(J=>"raster.servicepixelvalue.raw"!==J.toLowerCase()));G=E.createPopupTemplate({fields:O,title:this.title},{...G,visibleFieldNames:H});({rasterInfo:O}=this.raster);G?.fieldInfos&&O?.pixelType.startsWith("f")&&G.fieldInfos.forEach(({format:J,fieldName:R})=>{J&&R&&/^raster\.(item|service)pixelvalue/i.test(R)&&(J.places=2)});return G}async generateRasterInfo(G,O){G=q.ensureClass(C,G);await this.load();if(!G||"none"===G.functionName?.toLowerCase())return this.serviceRasterInfo;
try{const {rasterInfo:H}=await this._openFunctionRaster(G,O);return H}catch(H){if(H instanceof F)throw H;throw new F("imagery-tile-layer","the given raster function is not supported");}}async save(G){return this._debouncedSaveOperations(N.SaveOperationType.SAVE,G)}async saveAs(G,O){return this._debouncedSaveOperations(N.SaveOperationType.SAVE_AS,O,G)}write(G,O){const H=this._primaryRasters[0]??this.raster;if(this.loaded?"RasterTileServer"===H.datasetFormat&&("Raster"===H.tileType||"Map"===H.tileType):
this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return super.write(G,O);O?.messages&&O.messages.push(new F("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${O.origin}/${O.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null}async _openRaster(G){let O=!1;if(this.raster)await this._openFromRaster(this.raster,G),O="Function"===this.raster.datasetFormat,!O&&this.rasterFunction&&(this._primaryRasters=
[this.raster],await this._initializeWithFunctionRaster(this.rasterFunction));else{const {url:H,rasterFunction:J,source:R}=this;if(!H&&!R)throw new F("imagery-tile-layer:open","missing url or source parameter");R?await this._openFromSource(R,G):J?await this._openFromUrlWithRasterFunction(H,J,G):await this._openFromUrl(H,G)}G=this.raster.rasterInfo;if(!G)throw new F("imagery-tile-layer:load","cannot load resources on "+this.url);this._set("serviceRasterInfo",O?G:this._primaryRasters[0].rasterInfo);
this._set("spatialReference",G.spatialReference);this.sourceJSON=this.sourceJSON||this.raster.sourceJSON;null!=this.sourceJSON?this.read("Map"===this.raster.tileType&&null!=this.sourceJSON.minLOD&&null!=this.sourceJSON.maxLOD?this.sourceJSON:{...this.sourceJSON,minScale:0,maxScale:0},{origin:"service"}):this.read({tileInfo:this.serviceRasterInfo?.storageInfo.tileInfo.toJSON()},{origin:"service"});this.title||(this.title=this.raster.datasetName);"Map"===this.raster.tileType&&(this.popupEnabled=!1);
this._configDefaultSettings();this.addHandles(B.watch(()=>this.customParameters,H=>{this.raster&&(this.raster.ioConfig.customFetchParameters=H)}))}async _openFromRaster(G,O){G.rasterInfo||await G.open({signal:O});this._primaryRasters="Function"===G.datasetFormat?G.primaryRasters.rasters:[G];this.url||(this.url=this._primaryRasters[0].url)}async _openFromUrlWithRasterFunction(G,O,H){G=[G];O&&x.getPrimaryRasterUrls(O.toJSON(),G);const J=await Promise.all(G.map(Y=>A.open({url:Y,sourceJSON:this.sourceJSON,
ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:H}))),R=J.findIndex(Y=>null==Y);if(-1<R)throw new F("imagery-tile-layer:open",`cannot open raster: ${G[R]}`);this._primaryRasters=J;return this._initializeWithFunctionRaster(O)}async _openFromUrl(G,O){O=await A.open({url:G,sourceJSON:this.sourceJSON,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:O});if(null==O)throw new F("imagery-tile-layer:open",`cannot open raster: ${G}`);
this._primaryRasters=[O];this.raster=O}async _openFromSource(G,O){const H="coverage"===G.type?.toLowerCase()?"CovJSON":G.extent&&G.pixelBlock?"MEMORY":null;if(!H)throw new F("imagery-tile-layer:open","the tiled imagery data source is not supported");"MEMORY"===H&&(G={...G,pixelBlock:void 0,pixelBlocks:[G.pixelBlock]});G=await A.open({url:"",source:G,datasetFormat:H,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters},signal:O});if(null==G)throw new F("imagery-tile-layer:open",
"the tiled imagery data source is not supported");this._primaryRasters=[G];this.rasterFunction?await this._initializeWithFunctionRaster(this.rasterFunction):this.raster=G}async _openFunctionRaster(G,O){const H={raster:this._primaryRasters[0]};1<this._primaryRasters.length&&this._primaryRasters.forEach(J=>H[J.url]=J);G=x.create(G.functionDefinition?.toJSON()??G.toJSON(),H);G=new y({rasterFunction:G});await G.open(O);return G}async _initializeWithFunctionRaster(G,O){try{this.raster=await this._openFunctionRaster(G,
O)}catch(H){H instanceof F&&P.getLogger(this).error("imagery-tile-layer:open",H.message),P.getLogger(this).warn("imagery-tile-layer:open","the raster function cannot be applied and is removed"),this._set("rasterFunction",null),this.raster=this._primaryRasters[0]}}};u.__decorate([D.property({clonable:!1})],L.prototype,"_primaryRasters",void 0);u.__decorate([D.property(z.legendEnabled)],L.prototype,"legendEnabled",void 0);u.__decorate([D.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>
({enabled:!1})}}})],L.prototype,"isReference",void 0);u.__decorate([D.property({type:["show","hide"]})],L.prototype,"listMode",void 0);u.__decorate([D.property({json:{read:!0,write:!0}})],L.prototype,"blendMode",void 0);u.__decorate([D.property()],L.prototype,"sourceJSON",void 0);u.__decorate([D.property({readOnly:!0,json:{origins:{service:{read:{source:"currentVersion"}}}}})],L.prototype,"version",void 0);u.__decorate([D.property({readOnly:!0,json:{read:!1}})],L.prototype,"type",void 0);u.__decorate([D.property({type:["ArcGISTiledImageServiceLayer"]})],
L.prototype,"operationalLayerType",void 0);u.__decorate([D.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader(G,O){return!O.disablePopup}},write:{target:"disablePopup",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}},writer(G,O,H){O[H]=!G}}}})],L.prototype,"popupEnabled",void 0);u.__decorate([D.property({type:t,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy(){return{enabled:!this.loaded||"Raster"===this.raster.tileType}}}}})],
L.prototype,"popupTemplate",void 0);u.__decorate([D.property({readOnly:!0})],L.prototype,"defaultPopupTemplate",null);u.__decorate([D.property({readOnly:!0,type:[v]})],L.prototype,"fields",void 0);u.__decorate([D.property({readOnly:!0,type:[v]})],L.prototype,"rasterFields",null);u.__decorate([D.property({constructOnly:!0})],L.prototype,"source",void 0);return L=u.__decorate([n.subclass("esri.layers.ImageryTileLayer")],L)});