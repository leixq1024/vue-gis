// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISImageService":function(){define("exports ../../chunks/tslib.es6 ../../geometry ../../Graphic ../../rasterRenderers ../../request ../../core/Error ../../core/lang ../../core/Logger ../../core/reactiveUtils ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/support/spatialReferenceUtils ../support/commonProperties ../support/DimensionalDefinition ../support/ExportImageServiceParameters ../support/Field ../support/FieldsIndex ../support/imageBitmapUtils ../support/imageryRendererUtils ../support/MosaicRule ../support/MultidimensionalSubset ../support/PixelBlock ../support/rasterEnums ../support/RasterFunction ../support/RasterInfo ../support/RasterJobHandler ../support/rasterDatasets/multidimensionalUtils ../support/rasterFormats/RasterCodec ../support/rasterFunctions/vectorFieldUtils ../../renderers/support/rasterRendererHelper ../../renderers/support/RasterSymbolizer ../../rest/imageService ../../rest/imageService/fetchRasterInfo ../../rest/imageService/getCatalogItemRasterInfo ../../rest/query/executeForCount ../../rest/query/executeForIds ../../rest/query/executeQueryJSON ../../rest/support/FeatureSet ../../rest/support/ImageIdentifyParameters ../../rest/support/Query ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/SpatialReference ../../geometry/Polygon".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t,p,l,g,y,f,n,a,d,e,h,b,c,q,v,A,m,r,C,E,I,D,J,u,x,K,R,V,W,U,L,O,X,aa,ba,fa,ca){function ka(ea){ea=JSON.stringify(ea);const ia=ea.includes('"rasterFunctionDefinition":{');return(ea=(ia?ea.match(/"type":"(.*?FunctionArguments")/gi):ea.match(/"rasterFunction":"(.*?")/gi))?.map(w=>ia?w.slice(8,-18):w.slice(18,-1)))?ea.join("/"):null}const la=new Set("png png8 png24 png32 jpg bmp gif jpgpng lerc tiff".split(" ")),na=t.ensureRange(t.ensureNumber,{min:0,max:255});B.ArcGISImageService=
ea=>{function ia(w){return w?.path??""}ea=class extends ea{constructor(){super(...arguments);this._functionRasterInfos={};this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null};this._serviceSupportsMosaicRule=this._cachedRendererJson=null;this._rasterAttributeTableFieldPrefix="Raster.";this.adjustAspectRatio=null;this.bandIds=void 0;this.capabilities=null;this.compressionQuality=void 0;this.compressionTolerance=.01;this.fullExtent=this.fields=this.rasterInfo=this.exportImageServiceParameters=
this.definitionExpression=this.defaultMosaicRule=this.copyright=null;this.hasMultidimensions=!1;this.imageMaxWidth=this.imageMaxHeight=4100;this.interpolation=void 0;this.maxScale=this.minScale=0;this.noData=this.multidimensionalSubset=this.multidimensionalInfo=null;this.noDataInterpretation=void 0;this.objectIdField=null;this.geometryType="polygon";this.typeIdField=null;this.types=[];this.pixelFilter=null;this.raster=void 0;this.sourceType=null;this.viewId=void 0;this.url=this.sourceJSON=this.serviceRasterInfo=
this.pixelType=this.spatialReference=this.serviceDataType=this.rasterFunctionInfos=this.symbolizer=null;this.version=void 0}initialize(){this._set("exportImageServiceParameters",new a.ExportImageServiceParameters({layer:this}))}readServiceSupportsMosaicRule(w,G){return this._isMosaicRuleSupported(G)}get _rasterFunctionNamesIndex(){const w=new Map;if(!this.rasterFunctionInfos||null!=this.rasterFunctionInfos&&1>this.rasterFunctionInfos.length)return w;null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.forEach(G=>
{w.set(G.name.toLowerCase().replaceAll(/ /gi,"_"),G.name)});return w}readBandIds(w,G){if(Array.isArray(w)&&0<w.length&&w.every(Y=>"number"===typeof Y))return w}readCapabilities(w,G){return this._readCapabilities(G)}writeCompressionQuality(w,G,Y){null!=w&&"lerc"!==this.format&&(G[Y]=w)}writeCompressionTolerance(w,G,Y){"lerc"===this.format&&null!=w&&(G[Y]=w)}readDefaultMosaicRule(w,G){return this._serviceSupportsMosaicRule?c.fromJSON(G):null}get fieldsIndex(){return this.fields?new e(this.fields):null}set format(w){w&&
la.has(w.toLowerCase())&&this._set("format",w.toLowerCase())}readFormat(w,G){return"esriImageServiceDataTypeVector-UV"===G.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===G.serviceDataType?"lerc":null!=this.pixelFilter?"lerc":"jpgpng"}readMinScale(w,G){return null!=G.minLOD&&null!=G.maxLOD?w:0}readMaxScale(w,G){return null!=G.minLOD&&null!=G.maxLOD?w:0}set mosaicRule(w){w?.mosaicMethod&&(w=c.fromJSON({...w.toJSON(),mosaicMethod:w.mosaicMethod,mosaicOperation:w.mosaicOperation}));this._set("mosaicRule",
w)}readMosaicRule(w,G){return(w=w||G.mosaicRule)?c.fromJSON(w):this._isMosaicRuleSupported(G)?c.fromJSON(G):null}writeMosaicRule(w,G,Y){w=this.mosaicRule;const da=this.definitionExpression;w?da&&da!==w.where&&(w=w.clone(),w.where=da):da&&(w=new c({where:da}));this._isValidCustomizedMosaicRule(w)&&(G[Y]=w.toJSON())}writeNoData(w,G,Y){null!=w&&"number"===typeof w&&(G[Y]=na(w))}readObjectIdField(w,G){w||=G.fields.find(Y=>"esriFieldTypeOID"===Y.type||"oid"===Y.type)?.name;return w}get parsedUrl(){return P.urlToObject(this.url)}readSourceType(w,
G){return this._isMosaicDataset(G)?"mosaic-dataset":"raster-dataset"}get renderer(){const {activePresetRendererName:w,presetRenderers:G}=this;return w?G?.find(({name:Y})=>Y===w)?.renderer.clone():this.internalRenderer}set renderer(w){this.activePresetRendererName=null;this.internalRenderer=w}set internalRenderer(w){this.loaded&&(w=this._configRenderer(w));this._set("internalRenderer",w)}readRenderer(w,G,Y){w=G?.layerDefinition?.drawingInfo?.renderer;Y=z.read(w,Y);if(null==Y)return null;"vector-field"===
Y.type&&G.symbolTileSize&&!w.symbolTileSize&&(Y.symbolTileSize=G.symbolTileSize);b.isSupportedRendererType(Y)||H.getLogger(this).warn("ArcGISImageService","Imagery layer doesn't support given renderer type.");return Y}writeRenderer(w,G,Y){G.layerDefinition=G.layerDefinition||{};G.layerDefinition.drawingInfo=G.layerDefinition.drawingInfo||{};G.layerDefinition.drawingInfo.renderer=w.toJSON();"vector-field"===w.type&&(G.symbolTileSize=w.symbolTileSize)}get rasterFields(){const w=this._rasterAttributeTableFieldPrefix;
var G=new d({name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"});const Y=new d({name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"}),da=new d({name:"Raster.ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"string"});let ja=this.fields?Z.clone(this.fields):[];ja.push(Y);this.capabilities?.operations.supportsQuery&&this.fields&&0<this.fields.length&&
ja.push(G);10.4<=this.version&&null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.some(ha=>"none"===ha.name.toLowerCase())&&ja.push(da);null!=this.rasterFunctionInfos&&this.rasterFunctionInfos.filter(ha=>"none"!==ha.name.toLowerCase()).forEach(ha=>{ja.push(new d({name:"Raster.ServicePixelValue."+ha.name,alias:ha.name,domain:null,editable:!1,length:50,type:"string"}))});this._isVectorDataSet()&&(ja.push(new d({name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"})),
ja.push(new d({name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"})));({attributeTable:G}=this.rasterInfo??{});null!=G&&(G=G.fields.filter(ha=>"esriFieldTypeOID"!==ha.type&&"value"!==ha.name.toLowerCase()).map(ha=>{const oa=Z.clone(ha);oa.name=w+ha.name;return oa}),ja=ja.concat(G));return ja}set rasterFunction(w){w?.rasterFunction&&(w=m.fromJSON({...w.toJSON(),rasterFunction:w.rasterFunction,rasterFunctionArguments:w.rasterFunctionArguments}));this._set("rasterFunction",
w)}readRasterFunction(w,G){w=G.rasterFunctionInfos;return G.renderingRule||w?.length&&"None"!==w[0].name?this._isRFTJson(G.renderingRule)?m.fromJSON({rasterFunctionDefinition:G.renderingRule}):m.fromJSON(G.renderingRule||{rasterFunctionInfos:G.rasterFunctionInfos}):null}readSpatialReference(w,G){return(w=w||G.extent.spatialReference)?fa.fromJSON(w):null}readPixelType(w){return A.pixelTypeKebabDict.fromJSON(w)||w}writePixelType(w,G,Y){if(null==this.serviceRasterInfo||this.pixelType!==this.serviceRasterInfo.pixelType)G[Y]=
A.pixelTypeKebabDict.toJSON(w)}readVersion(w,G){(w=G.currentVersion)||(w=G.hasOwnProperty("fields")||G.hasOwnProperty("timeInfo")?10:9.3);return w}applyFilter(w){let G=w;this.pixelFilter&&(G=this._clonePixelData(w),this.pixelFilter(G));return G}async applyRenderer(w,G){var Y=w;const {renderer:da,symbolizer:ja,pixelFilter:ha,bandIds:oa}=this;if(!this._isPicture()&&da&&ja&&!ha){Y=JSON.stringify(this._cachedRendererJson)!==JSON.stringify(da.toJSON());const ma=this._rasterJobHandler.instance;ma?(Y&&(ja.bind(),
await ma.updateSymbolizer(ja,G),this._cachedRendererJson=da.toJSON()),G=await ma.symbolize({bandIds:oa,...w},G),Y={extent:w.extent,pixelBlock:G}):Y={extent:w.extent,pixelBlock:ja.symbolize({bandIds:oa,...w})}}return Y}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--;0>=this._rasterJobHandler.refCount&&this._shutdownJobHandler()}async computeAngles(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsComputeAngles)throw new T("imagery-layer:compute-angles",
"this operation is not supported on the input image service");return x.computeAngles(this.url,w,this._getRequestOptions(G))}async computePixelSpaceLocations(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsComputePixelLocation)throw new T("imagery-layer:compute-pixel-space-locations","this operation is not supported on the input image service");return x.computePixelSpaceLocations(this.url,w,this._getRequestOptions(G))}async computeHistograms(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsComputeHistograms)throw new T("imagery-layer:compute-histograms",
"this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.computeHistograms(this.url,w,this._getRequestOptions(G))}async computeStatisticsHistograms(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsComputeStatisticsHistograms)throw new T("imagery-layer:compute-statistics-histograms","this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.computeStatisticsHistograms(this.url,
w,this._getRequestOptions(G))}async measureHeight(w,G){const Y=await this._fetchCapabilities(G?.signal);if(!("base-and-top"===w.operationType?Y.mensuration.supportsHeightFromBaseAndTop:"base-and-top-shadow"===w.operationType?Y.mensuration.supportsHeightFromBaseAndTopShadow:Y.mensuration.supportsHeightFromTopAndTopShadow))throw new T("imagery-layer:measure-height","this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.measureHeight(this.url,
w,this._getRequestOptions(G))}async measureAreaAndPerimeter(w,G){const Y=await this._fetchCapabilities(G?.signal);if(!Y.mensuration.supportsAreaAndPerimeter||w.is3D&&!Y.mensuration.supports3D)throw new T("imagery-layer:measure-area-and-perimeter","this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.measureAreaAndPerimeter(this.url,w,this._getRequestOptions(G))}async measureDistanceAndAngle(w,G){const Y=await this._fetchCapabilities(G?.signal);
if(!Y.mensuration.supportsDistanceAndAngle||w.is3D&&!Y.mensuration.supports3D)throw new T("imagery-layer:measure-distance-and-angle","this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.measureDistanceAndAngle(this.url,w,this._getRequestOptions(G))}async measurePointOrCentroid(w,G){const Y=await this._fetchCapabilities(G?.signal);if(!Y.mensuration.supportsPointOrCentroid||w.is3D&&!Y.mensuration.supports3D)throw new T("imagery-layer:measure-point-or-centroid",
"this operation is not supported on the input image service");w=Z.clone(w);this._applyMosaicAndRenderingRules(w);return x.measurePointOrCentroid(this.url,w,this._getRequestOptions(G))}async measureLengthFromImage(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsMeasureFromImage)throw new T("imagery-layer:measure-length-from-image","this operation is not supported on the input image service");if("polyline"!==w.geometry.type)throw new T("imagery-layer:measure-length-from-image",
"this input geometry must be a polyline");return x.measureLengthFromImage(this.url,w,this._getRequestOptions(G))}async measureAreaFromImage(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsMeasureFromImage)throw new T("imagery-layer:measure-area-from-image","this operation is not supported on the input image service");if("polygon"!==w.geometry.type)throw new T("imagery-layer:measure-area-from-image","this input geometry must be a polygon");return x.measureAreaFromImage(this.url,
w,this._getRequestOptions(G))}getField(w){const {fieldsIndex:G}=this;return null!=G?G.get(w):void 0}getFieldDomain(w,G){return(w=this.getField(w))?w.domain:null}async fetchImage(w,G,Y,da={}){if(null==w||null==G||null==Y)throw new T("imagery-layer:fetch-image","Insufficient parameters for requesting an image. A valid extent, width and height values are required.");if(this.renderer||this.symbolizer){var ja=await this._generateRasterInfo(this.rasterFunction,{signal:da.signal});ja&&(this.rasterInfo=ja)}ja=
this.getExportImageServiceParameters(w,G,Y,da.timeExtent);if(null==ja){if(da.requestAsImageElement&&this._canRequestImageElement(this.format))return w=document.createElement("canvas"),w.width=G,w.height=Y,da.returnImageBitmap?{imageBitmap:await h.createBitmap(w,`${ia(this.parsedUrl)}/exportImage`,da.signal)}:{imageOrCanvasElement:w};const {bandIds:oa,rasterInfo:ma}=this;da=(oa?.length||ma.bandCount)??0;ja=G*Y;var ha=ma.pixelType;const qa=[];for(let pa=0;pa<da;pa++)qa.push(v.createEmptyBand(ha,ja));
return{pixelData:{pixelBlock:new v({width:G,height:Y,pixels:qa,mask:new Uint8Array(ja),pixelType:ha}),extent:w}}}ha=!!da.requestAsImageElement&&!this.pixelFilter;return this._requestArrayBuffer({imageServiceParameters:ja,imageProps:{extent:w,width:G,height:Y,format:this.format},requestAsImageElement:ha,returnImageBitmap:ha&&!!da.returnImageBitmap,signal:da.signal})}fetchKeyProperties(w){return Q(ia(this.parsedUrl)+"/keyProperties",{query:this._getQueryParams({renderingRule:10.3<=this.version?w?.rasterFunction:
null})}).then(G=>G.data)}fetchRasterAttributeTable(w){return 10.1>this.version?Promise.reject(new T("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable")):Q(ia(this.parsedUrl)+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:10.3<=this.version?w?.rasterFunction:null})}).then(G=>L.fromJSON(G.data))}getCatalogItemRasterInfo(w,G){const Y=this._getQueryParams();G={...G,query:Y};return R.getCatalogItemRasterInfo(ia(this.parsedUrl),w,G)}async getCatalogItemICSInfo(w,G){var {data:Y}=
await Q(ia(this.parsedUrl)+"/"+w+"/info/ics",{query:this._getQueryParams(),...G});if(Y=Y?.ics){var da=null;try{da=(await Q(ia(this.parsedUrl)+"/"+w+"/info",{query:this._getQueryParams(),...G})).data.extent}catch{}if(!da?.spatialReference)return{ics:Y,icsToPixelTransform:null,icsExtent:null,northDirection:null};var ja=10.7<=this.version?Q(ia(this.parsedUrl)+"/"+w+"/info/icstopixel",{query:this._getQueryParams(),...G}).then(ra=>ra.data).catch(()=>({})):{},ha=da.spatialReference,oa={geometries:JSON.stringify({geometryType:"esriGeometryEnvelope",
geometries:[da]}),inSR:y.srToRESTValue(ha),outSR:"0:"+w};oa=Q(ia(this.parsedUrl)+"/project",{query:this._getQueryParams(oa),...G}).then(ra=>ra.data).catch(()=>({}));var ma=(da.xmin+da.xmax)/2,qa=(da.ymax-da.ymin)/6;da=da.ymin+qa;var pa=[];for(let ra=0;5>ra;ra++)pa.push({x:ma,y:da+qa*ra});w={geometries:JSON.stringify({geometryType:"esriGeometryPoint",geometries:pa}),inSR:y.srToRESTValue(ha),outSR:"0:"+w};G=Q(ia(this.parsedUrl)+"/project",{query:this._getQueryParams(w),...G}).then(ra=>ra.data).catch(()=>
({}));w=await Promise.all([ja,oa,G]);G=w[0].ipxf;null==G&&(ja=Y.geodataXform?.xf_0,"topup"===ja?.name?.toLowerCase()&&6===ja?.coefficients?.length&&(G={affine:{name:"ics [sensor: Frame] to pixel (column, row) transformation",coefficients:ja.coefficients,cellsizeRatio:0,type:"GeometricXform"}}));if(ja=ba.fromJSON(w[1]?.geometries?.[0]))ja.spatialReference=new fa({wkid:0,imageCoordinateSystem:Y});w=w[2].geometries?w[2].geometries.filter(ra=>null!=ra?.x&&null!=ra.y&&"NaN"!==ra.x&&"NaN"!==ra.y):[];oa=
w.length;if(3>oa)return{ics:Y,icsToPixelTransform:G,icsExtent:ja,northDirection:null};da=qa=ma=ha=0;for(pa=0;pa<oa;pa++)ha+=w[pa].x,ma+=w[pa].y,qa+=w[pa].x*w[pa].x,da+=w[pa].x*w[pa].y;oa=(oa*da-ha*ma)/(oa*qa-ha*ha);ha=0;ma=w[4].x>w[0].x;w=w[4].y>w[0].y;Infinity===oa?ha=w?90:270:0===oa?ha=ma?0:180:0<oa?ha=ma?180*Math.atan(oa)/Math.PI:180*Math.atan(oa)/Math.PI+180:0>oa&&(ha=w?180+180*Math.atan(oa)/Math.PI:360+180*Math.atan(oa)/Math.PI);return{ics:Y,icsToPixelTransform:G,icsExtent:ja,northDirection:ha}}}async generateRasterInfo(w,
G){w=t.ensureClass(m,w);const Y={...G,query:this._getQueryParams()};if(!w||"none"===w.functionName?.toLowerCase()||this._isVectorFieldResampleFunction(w))return this.serviceRasterInfo??K.fetchServiceRasterInfo(ia(this.parsedUrl),this.sourceJSON,Y);G=ka(w);if(!G)throw new T("imagery-layer:generate-raster-info","the rendering rule is not supported");if(this._functionRasterInfos[G])return this._functionRasterInfos[G];w=K.generateRasterInfo(ia(this.parsedUrl),w,Y);this._functionRasterInfos[G]=w;try{return await w}catch(da){throw this._functionRasterInfos[G]=
null,da;}}getExportImageServiceParameters(w,G,Y,da){w=w.clone().shiftCentralMeridian();const ja=x.getImageSpatialReferenceQueryParameter(w.spatialReference,ia(this.parsedUrl));this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);const ha=this.exportImageServiceParameters.toJSON(),{bandIds:oa,noData:ma}=ha;var {renderingRule:qa}=ha,pa=this.rasterFunction?.rasterFunctionDefinition,ra=this.renderer?.type;ra=!ra||"raster-stretch"===ra||"raster-colormap"===
ra||"unique-value"===ra||"class-breaks"===ra||"raster-shaded-relief"===ra;oa?.length&&this._hasRasterFunction(this.rasterFunction)&&!pa&&ra?(pa={rasterFunction:"ExtractBand",rasterFunctionArguments:{BandIds:oa}},"Stretch"===qa.rasterFunction?(pa.rasterFunctionArguments.Raster=qa.rasterFunctionArguments.Raster,qa.rasterFunctionArguments.Raster=pa):"Colormap"===qa.rasterFunction?(ra=qa.rasterFunctionArguments.Raster,"Stretch"===ra?.rasterFunction?(pa.rasterFunctionArguments.Raster=ra.rasterFunctionArguments.Raster,
ra.rasterFunctionArguments.Raster=pa):(pa.rasterFunctionArguments.Raster=ra,qa.rasterFunctionArguments.Raster=pa)):(pa.rasterFunctionArguments.Raster=qa,qa=pa),ha.bandIds=void 0):ha.bandIds=oa?.join(",");Array.isArray(ma)&&0<ma.length&&(ha.noData=ma.join(","));da=this._processMultidimensionalIntersection(null,da,this.exportImageServiceParameters.mosaicRule);if(da.isOutSide)return null;ha.mosaicRule=null!=da.mosaicRule?JSON.stringify(da.mosaicRule):null;da=da.timeExtent;ha.renderingRule=this._getRenderingRuleString(m.fromJSON(qa));
qa={};if(null!=da){const {start:sa,end:ta}=da.toJSON();if(sa&&ta&&sa===ta)qa.time=""+sa;else if(null!=sa||null!=ta)qa.time=`${null==sa?"null":sa},${null==ta?"null":ta}`}return{bbox:w.xmin+","+w.ymin+","+w.xmax+","+w.ymax,bboxSR:ja,imageSR:ja,size:G+","+Y,...ha,...qa}}async getSamples(w,G){if(!(await this._fetchCapabilities(G?.signal))?.operations.supportsGetSamples)throw new T("imagery-layer:get-samples","getSamples operation is not supported on the input image service");w=Z.clone(w);const {raster:Y}=
this;Y&&null==w.raster&&(w.raster=Y);return x.getSamples(this.url,w,this._getRequestOptions(G))}async identify(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsIdentify)throw new T("imagery-layer:identify","identify operation is not supported on the input image service");w=Z.clone(w);10.91>this.version&&"extent"===w.geometry?.type&&(w.geometry=ca.fromExtent(w.geometry));const Y=this._processMultidimensionalIntersection(w.geometry,w.timeExtent,w.mosaicRule||this.mosaicRule);if(Y.isOutSide)throw new T("imagery-layer:identify",
"the request cannot be fulfilled when falling outside of the multidimensional subset");w.timeExtent=Y.timeExtent;w.mosaicRule=Y.mosaicRule;const {raster:da,rasterFunction:ja}=this;ja&&null==w.rasterFunction&&(w.rasterFunction=ja);da&&null==w.raster&&(w.raster=da);return x.identify(this.url,w,this._getRequestOptions(G))}async imageToMap(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsImageToMap)throw new T("imagery-layer:image-to-map","imageToMap operation is not supported on the input image service");
return x.imageToMap(ia(this.parsedUrl),w,this._getRequestOptions(G))}async imageToMapMultiray(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsImageToMapMultiray)throw new T("imagery-layer:image-to-map-multiray","imageToMapMultiray operation is not supported on the input image service");return x.imageToMapMultiray(ia(this.parsedUrl),w,this._getRequestOptions(G))}async mapToImage(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsMapToImage)throw new T("imagery-layer:map-to-image",
"mapToImage operation is not supported on the input image service");return x.mapToImage(ia(this.parsedUrl),w,this._getRequestOptions(G))}async findImages(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsFindImages)throw new T("imagery-layer:find-images","findImages operation is not supported on the input image service");return x.findImages(ia(this.parsedUrl),w,this._getRequestOptions(G))}async getImageUrl(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsGetImageUrl)throw new T("imagery-layer:get-image-url",
"getImageUrl operation is not supported on the input image service");return x.getImageUrl(ia(this.parsedUrl),w,this._getRequestOptions(G))}createQuery(){return new X({outFields:["*"],returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})}async queryBoundary(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsQueryBoundary)throw new T("imagery-layer:query-boundary","queryBoundary operation is not supported on the input image service");w=w??{outSpatialReference:this.spatialReference};
return x.queryBoundary(ia(this.parsedUrl),w,this._getRequestOptions(G))}async queryRasters(w,G){({query:w,requestOptions:G}=await this._prepareForQuery(w,G));return U.executeQueryJSON(this.url,w,G)}async queryObjectIds(w,G){({query:w,requestOptions:G}=await this._prepareForQuery(w,G));return W.executeForIds(this.url,w,G)}async queryGPSInfo(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsQueryGPSInfo)throw new T("imagery-layer:query-gps-info","queryGPSInfo operation is not supported on the input image service");
w=w??{where:"1\x3d1"};return x.queryGPSInfo(ia(this.parsedUrl),w,this._getRequestOptions(G))}async queryRasterCount(w,G){({query:w,requestOptions:G}=await this._prepareForQuery(w,G));return V.executeForCount(this.url,w,G)}async queryVisibleRasters(w,G){if(!w)throw new T("imagery-layer: query-visible-rasters","missing query parameter");await this.load();const {pixelSize:Y,returnDomainValues:da,returnTopmostRaster:ja,showNoDataRecords:ha}=G||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,
showNoDataRecords:!1};let oa=!1;var ma=null,qa=null;const pa=this._rasterFunctionNamesIndex;if(null!=w.outFields&&(oa=w.outFields.some(va=>!va.toLowerCase().includes("raster.servicepixelvalue")),10.4<=this.version)){qa=w.outFields.filter(ua=>ua.toLowerCase().includes("raster.servicepixelvalue")&&24<ua.length).map(ua=>{ua=ua.slice(25);return[this._updateRenderingRulesFunctionName(ua,pa),ua]});ma=qa.map(ua=>new m({functionName:ua[0]}));qa=qa.map(ua=>ua[1]);const {rasterFunction:va}=this;0===ma.length?
va?.functionName?(ma.push(va),qa.push(va.functionName)):ma=null:va?.functionName&&!ma.some(ua=>ua.functionName===va.functionName)&&(ma.push(va),qa.push(va.functionName))}const ra=null==w.outSpatialReference||w.outSpatialReference.equals(this.spatialReference);var {multidimensionalSubset:sa}=this;let ta=w.timeExtent||this.timeExtent;if(sa){const {isOutside:va,intersection:ua}=E.intersectMultimensionalSubset(sa,{geometry:w.geometry,timeExtent:w.timeExtent,multidimensionalDefinition:this.exportImageServiceParameters.mosaicRule?.multidimensionalDefinition});
if(va)throw new T("imagery-layer:query-visible-rasters","the request cannot be fulfilled when falling outside of the multidimensional subset");null!=ua?.timeExtent&&(ta=ua.timeExtent)}sa=this._combineMosaicRuleWithTimeExtent(this.exportImageServiceParameters.mosaicRule,ta);let wa=w.geometry;10.91>this.version&&"extent"===wa?.type&&(wa=ca.fromExtent(wa));ma=this._getQueryParams({geometry:wa,timeExtent:ta,mosaicRule:sa,rasterFunction:10.4>this.version?this.rasterFunction:null,rasterFunctions:ma,pixelSize:Y,
returnCatalogItems:oa,returnGeometry:ra,raster:this.raster,maxItemCount:ja?1:null});delete ma.f;ma=new O(ma);try{await this._generateRasterInfo(this.rasterFunction);const va=await x.identify(this.url,ma,{signal:G?.signal,query:{...this.customParameters}}),ua=w.outFields,Ca=null!=va.value&&va.value.toLowerCase().includes("nodata");if(!oa||ra||!va?.catalogItems?.features.length||!ha&&Ca)return this._processVisibleRastersResponse(va,{returnDomainValues:da,templateRRFunctionNames:qa,showNoDataRecords:ha,
templateFields:ua});const ya=this.objectIdField||"ObjectId",Aa=va.catalogItems?.features??[],Da=Aa.map(xa=>xa.attributes?.[ya]),Ea=new X({objectIds:Da,returnGeometry:!0,outSpatialReference:w.outSpatialReference,outFields:[ya]}),Ba=await this.queryRasters(Ea);Ba?.features?.length&&Ba.features.forEach(xa=>{Aa.forEach(za=>{za.attributes[ya]===xa.attributes[ya]&&xa.geometry&&(za.geometry=xa.geometry.clone(),null!=w.outSpatialReference&&(za.geometry.spatialReference=w.outSpatialReference))})});return this._processVisibleRastersResponse(va,
{returnDomainValues:da,templateRRFunctionNames:qa,showNoDataRecords:ha,templateFields:ua})}catch{throw new T("imagery-layer:query-visible-rasters","encountered error when querying visible rasters");}}async fetchVariableStatisticsHistograms(w,G){var Y=Q(ia(this.parsedUrl)+"/statistics",{query:this._getQueryParams({variable:w}),signal:G}).then(da=>da.data?.statistics);w=Q(ia(this.parsedUrl)+"/histograms",{query:this._getQueryParams({variable:w}),signal:G}).then(da=>da.data?.histograms);Y=await Promise.all([Y,
w]);Y[0]&&Y[0].forEach(da=>{da.avg=da.mean;da.stddev=da.standardDeviation});return{statistics:Y[0]||null,histograms:Y[1]||null}}async createFlowMesh(w,G){const Y=this._rasterJobHandler.instance;return Y?Y.createFlowMesh(w,G):aa.createFlowMesh(w.meshType,w.simulationSettings,w.flowData,null!=G.signal?G.signal:(new AbortController).signal)}getMultidimensionalSubsetVariables(w){return E.getSubsetVariablesFromMdInfo(this.multidimensionalSubset,w??this.serviceRasterInfo.multidimensionalInfo)}async _fetchService(w){await this._fetchServiceInfo(w);
this.rasterInfo||(this.rasterInfo=this.serviceRasterInfo);const G=this.sourceJSON,Y=null!=this.serviceRasterInfo?Promise.resolve(this.serviceRasterInfo):K.fetchServiceRasterInfo(ia(this.parsedUrl),G,{signal:w,query:this._getQueryParams()}).then(ja=>{this._set("serviceRasterInfo",ja);this._set("multidimensionalInfo",ja.multidimensionalInfo);K.patchServiceInfo(ja,G);return ja});w=this._hasRasterFunction(this.rasterFunction)?this._generateRasterInfo(this.rasterFunction,{signal:w}):null;const da=this._getRasterFunctionInfos();
return Promise.all([Y,w,da]).then(ja=>{ja[1]?this._set("rasterInfo",ja[1]):this._set("rasterInfo",ja[0]);ja[2]&&this._set("rasterFunctionInfos",ja[2]);this.internalRenderer&&!this._isSupportedRenderer(this.internalRenderer)&&(this._set("internalRenderer",null),H.getLogger(this).warn("ArcGISImageService","Switching to the default renderer. Renderer applied is not valid for this Imagery Layer"));this._set("internalRenderer",this._configRenderer(this.renderer));this.addHandles([S.watch(()=>this.rasterFunction,
ha=>{(this.renderer||this.symbolizer||this.popupEnabled&&this.popupTemplate)&&this._generateRasterInfo(ha).then(oa=>{oa&&(this.rasterInfo=oa)})})]);({serviceRasterInfo:ja}=this);null!=ja.multidimensionalInfo&&this._updateMultidimensionalDefinition(ja)})}_combineMosaicRuleWithTimeExtent(w,G){var Y=this.timeInfo,{multidimensionalInfo:da}=this.serviceRasterInfo;if(null==w||null==da||null==G||null==Y?.startField)return w;const {startField:ja}=Y,ha=da.variables.some(pa=>pa.dimensions.some(ra=>ra.name===
ja))?ja:"StdTime";w=w.clone();if("mosaic-dataset"===this.sourceType)return w.multidimensionalDefinition=w.multidimensionalDefinition?.filter(pa=>pa.dimensionName!==ha),this._cleanupMultidimensionalDefinition(w);w.multidimensionalDefinition=w.multidimensionalDefinition||[];Y=w.multidimensionalDefinition.filter(pa=>pa.dimensionName===ha);da=null!=G.start?G.start.getTime():null;G=null!=G.end?G.end.getTime():null;const oa=null==da||null==G||da===G,ma=oa?[da||G]:[[da,G]],qa=10.8<=this.version;Y.length?
Y.forEach(pa=>{pa.dimensionName===ha&&(qa?(pa.dimensionName=null,pa.isSlice=!1,pa.values=[]):(pa.isSlice=oa,pa.values=ma))}):qa||(G=w.multidimensionalDefinition.filter(pa=>null!=pa.variableName&&null==pa.dimensionName),G.length?G.forEach(pa=>{pa.dimensionName=ha;pa.isSlice=oa;pa.values=ma}):w.multidimensionalDefinition.push(new n({variableName:"",dimensionName:ha,isSlice:oa,values:ma})));return this._cleanupMultidimensionalDefinition(w)}_cleanupMultidimensionalDefinition(w){if(null==w)return null;
w.multidimensionalDefinition&&(w.multidimensionalDefinition=w.multidimensionalDefinition.filter(G=>!(!G.variableName&&!G.dimensionName)),0===w.multidimensionalDefinition.length&&(w.multidimensionalDefinition=null));return"mosaic-dataset"!==this.sourceType&&null==w.multidimensionalDefinition?null:w}async _prepareForQuery(w,G){if(!(await this._fetchCapabilities(G?.signal)).operations.supportsQuery)throw new T("imagery-layer:query-rasters","query operation is not supported on the input image service");
w=null!=w?t.ensureClass(X,w):this.createQuery();G=this._getRequestOptions(G);this.raster&&(G.query={...G.query,raster:this.raster});return{query:w,requestOptions:G}}async _initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const w=new C;this._rasterJobHandler.connectionPromise=w.initialize().then(()=>{this._rasterJobHandler.instance=w},()=>{});await this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&
this._rasterJobHandler.instance.destroy();this._rasterJobHandler.instance=null;this._rasterJobHandler.connectionPromise=null;this._rasterJobHandler.refCount=0;this._cachedRendererJson=null}_isSupportedRenderer(w){const {rasterInfo:G,rasterFunction:Y}=this;return"unique-value"===w.type&&this._hasRasterFunction(Y)&&1===G?.bandCount&&["u8","s8"].includes(G.pixelType)||null!=G&&null!=w&&J.getSupportedRendererTypes(G).includes(w.type)}async _fetchCapabilities(w){if(this.capabilities)return this.capabilities;
await this._fetchServiceInfo(w);return this.capabilities}async _fetchServiceInfo(w){let G=this.sourceJSON;if(!G){const {data:Y,ssl:da}=await Q(ia(this.parsedUrl),{query:this._getQueryParams(),signal:w});this.sourceJSON=G=Y;da&&(this.url=this.url.replace(/^http:/i,"https:"))}if(-1<G.capabilities?.toLowerCase().split(",").map(Y=>Y.trim()).indexOf("tilesonly"))throw new T("imagery-layer:fetch-service-info","use ImageryTileLayer to open tiles-only image services");this.read(G,{origin:"service",url:this.parsedUrl})}_isMosaicDataset(w){return w.serviceSourceType?
"esriImageServiceSourceTypeMosaicDataset"===w.serviceSourceType:0<w.fields?.length}_isMosaicRuleSupported(w){if(!w)return!1;const G=this._isMosaicDataset(w);w=10.71<=w.currentVersion&&w.hasMultidimensions&&!(1<w.fields?.length);return G||w}_isVectorFieldResampleFunction(w){if(null==w)return!1;const {functionName:G,functionArguments:Y}=w;w="resample"===G?.toLowerCase();const da=Y?.ResampleType||Y?.resampleType;return w&&(7===da||10===da)}_isPicture(){return!this.format||this.format.includes("jpg")||
this.format.includes("png")}_configRenderer(w){var G=this._isPicture();const {rasterInfo:Y}=this;if(!G&&!this.pixelFilter||this._isVectorDataSet()){G=this.mosaicRule?.multidimensionalDefinition?.[0].variableName;const da=J.matchPresetRenderer({variableName:G,rasterFunctionName:this.rasterFunction?.functionName,presetRenderers:this.presetRenderers});if(!this.bandIds&&3<=Y.bandCount){const ja=da?.bandIds??J.getDefaultBandCombination(Y);!ja||3===Y.bandCount&&0===ja[0]&&1===ja[1]&&2===ja[2]||(this.bandIds=
ja)}w||=da?.renderer??J.createDefaultRenderer(Y,{bandIds:this.bandIds,variableName:this.rasterFunction?null:G});G=J.normalizeRendererJSON(w.toJSON());this.symbolizer?(this.symbolizer.rendererJSON=G,this.symbolizer.rasterInfo=Y):this.symbolizer=new u({rendererJSON:G,rasterInfo:Y});this.symbolizer.bind().success||(this.symbolizer=null)}return w}_clonePixelData(w){return null==w?w:{extent:w.extent&&w.extent.clone(),pixelBlock:null!=w.pixelBlock?w.pixelBlock.clone():null}}_getQueryParams(w){null!=w?.renderingRule&&
"string"!==typeof w.renderingRule&&(w.renderingRule=this._getRenderingRuleString(w.renderingRule));const {raster:G,viewId:Y}=this;return{raster:G,viewId:Y,f:"json",...w,...this.customParameters}}_getRequestOptions(w){return{...w,query:{...w?.query,...this.customParameters}}}_decodePixelBlock(w,G,Y){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:w,options:G}):I.decode(w,G,Y)}async _getRasterFunctionInfos(w){const G=this.sourceJSON.rasterFunctionInfos;return this.loaded?
G:G&&10.3<=this.version?1===G.length&&"none"===G[0].name.toLowerCase()?G:(await Q(ia(this.parsedUrl)+"/rasterFunctionInfos",{query:this._getQueryParams(),signal:w})).data?.rasterFunctionInfos:null}_canRequestImageElement(w){return!this.pixelFilter&&(!w||w.includes("png"))}async _requestArrayBuffer(w){const {imageProps:G,requestAsImageElement:Y,returnImageBitmap:da,signal:ja}=w;if(Y&&this._canRequestImageElement(G.format)){var ha=`${ia(this.parsedUrl)}/exportImage`;({data:w}=await Q(ha,{responseType:da?
"blob":"image",query:this._getQueryParams({f:"image",...this.refreshParameters,...w.imageServiceParameters}),signal:ja}));return w instanceof Blob?{imageBitmap:await h.createBitmap(w,ha,ja),params:G}:{imageOrCanvasElement:w,params:G}}ha=this._initJobHandler();w=Q(ia(this.parsedUrl)+"/exportImage",{responseType:"array-buffer",query:this._getQueryParams({f:"image",...w.imageServiceParameters}),signal:ja});w=(await Promise.all([w,ha]))[0].data;var oa=ha=G.format||"jpgpng";"bsq"!==oa&&"bip"!==oa&&(oa=
I.getFormat(w));if(!oa)throw new T("imagery-layer:fetch-image","unsupported format signature "+String.fromCharCode.apply(null,new Uint8Array(w)));oa="gif"===ha||"bmp"===ha||ha.includes("png")&&("png"===oa||"jpg"===oa);const ma={signal:ja};return{pixelData:{pixelBlock:await (oa?I.decode(w,{useCanvas:!0,...G},ma):this._decodePixelBlock(w,{width:G.width,height:G.height,planes:null,pixelType:null,noDataValue:null,format:ha},ma)),extent:G.extent},params:G}}_generateRasterInfo(w,G){return this.generateRasterInfo(w,
G).catch(()=>null)}_isValidCustomizedMosaicRule(w){return w&&JSON.stringify(w.toJSON())!==JSON.stringify(this.defaultMosaicRule?.toJSON())}_updateMultidimensionalDefinition(w){if(!this._isValidCustomizedMosaicRule(this.mosaicRule)&&(w=E.getDefaultMultidimensionalDefinition(w,{multidimensionalSubset:this.multidimensionalSubset}),null!=w&&0<w.length)){this.mosaicRule=this.mosaicRule||new c;const G=this.mosaicRule.multidimensionalDefinition;!this.sourceJSON.defaultVariableName&&this.rasterFunction&&
"none"!==this.rasterFunction.functionName?.toLowerCase()&&w.forEach(Y=>Y.variableName="");w=w.filter(({variableName:Y,dimensionName:da})=>Y&&"*"!==Y||da);!G?.length&&w.length&&(this.mosaicRule.multidimensionalDefinition=w)}}_processVisibleRastersResponse(w,G){G=G||{};const Y=w.value,{templateRRFunctionNames:da,showNoDataRecords:ja,returnDomainValues:ha,templateFields:oa}=G;G=w.processedValues;var ma=w.catalogItems?.features;let qa=w.properties?.Values?.map(wa=>wa.replaceAll(/ /gi,", "))||[];var pa=
this.objectIdField||"ObjectId",ra="string"===typeof Y&&Y.toLowerCase().includes("nodata");w=[];!Y||ma||ra||(ma={},ma[pa]=0,ma=new N({geometry:this.fullExtent,attributes:ma}),qa=[Y],ma=[ma]);if(!ma)return[];this._updateResponseFieldNames(ma,oa);ra&&!ja&&(ma=[]);for(pa=0;pa<ma.length;pa++){ra=ma[pa];if(null!=Y){var sa=qa[pa];var ta=this.rasterFunction&&G&&0<G.length&&da&&0<da.length&&da.includes(this.rasterFunction.functionName)?G[da.indexOf(this.rasterFunction.functionName)]:Y;if("nodata"===sa.toLowerCase()&&
!ja)continue;ra.attributes["Raster.ItemPixelValue"]=sa;ra.attributes["Raster.ServicePixelValue"]=ta;this._updateFeatureWithMagDirValues(ra,sa);const wa=this.fields&&0<this.fields.length;ta=this.rasterFunction&&null!=this.serviceRasterInfo.attributeTable?wa?sa:Y:ta;this.rasterFunction||(ta=wa?sa:Y);this._updateFeatureWithRasterAttributeTableValues(ra,ta)}ra.sourceLayer=ra.layer=this;ha&&this._updateFeatureWithDomainValues(ra);if(da&&G&&da.length===G.length)for(sa=0;sa<da.length;sa++)ra.attributes["Raster.ServicePixelValue."+
da[sa]]=G[sa];w.push(ma[pa])}return w}_processMultidimensionalIntersection(w,G,Y){const {multidimensionalSubset:da}=this;if(!da)return Y=this._combineMosaicRuleWithTimeExtent(Y,G),{isOutSide:!1,timeExtent:G,mosaicRule:Y};if(da){const {isOutside:ja,intersection:ha}=E.intersectMultimensionalSubset(da,{geometry:w,timeExtent:G});if(ja)return{isOutSide:!0,timeExtent:null,mosaicRule:null};null!=ha?.timeExtent&&(G=ha.timeExtent)}Y=this._combineMosaicRuleWithTimeExtent(Y,G);return Y?.multidimensionalDefinition&&
({isOutside:w}=E.intersectMultimensionalSubset(da,{multidimensionalDefinition:Y.multidimensionalDefinition}),w)?{isOutSide:!0,timeExtent:null,mosaicRule:null}:{isOutSide:!1,timeExtent:G,mosaicRule:Y}}_updateFeatureWithRasterAttributeTableValues(w,G){const Y=this.rasterInfo.attributeTable||this.serviceRasterInfo.attributeTable;if(null!=Y){var {features:da,fields:ja}=Y,ha=ja.map(ma=>ma.name).find(ma=>"value"===ma.toLowerCase());if(ha){var oa=da.filter(ma=>ma.attributes[ha]===(null!=G?parseInt(G,10):
null));oa&&oa[0]&&ja.forEach(ma=>{w.attributes[this._rasterAttributeTableFieldPrefix+ma.name]=oa[0].attributes[ma.name]})}}}_updateFeatureWithMagDirValues(w,G){if(this._isVectorDataSet()){var Y=G.split(/,\s*/).map(da=>parseFloat(da));G=Y.map(da=>[da]);Y=Y.map(da=>({minValue:da,maxValue:da,noDataValue:null}));G=new v({height:1,width:1,pixelType:"f32",pixels:G,statistics:Y});null!=this.pixelFilter&&this.pixelFilter({pixelBlock:G,extent:new ba(0,0,0,0,this.spatialReference)});G="esriImageServiceDataTypeVector-MagDir"===
this.serviceDataType?[G.pixels[0][0],G.pixels[1][0]]:D.uvComponentToVector([G.pixels[0][0],G.pixels[1][0]]);w.attributes["Raster.Magnitude"]=G[0];w.attributes["Raster.Direction"]=G[1]}}_updateFeatureWithDomainValues(w){const G=this.fields&&this.fields.filter(Y=>Y.domain&&"coded-value"===Y.domain.type);null!=G&&G.forEach(Y=>{const da=w.attributes[Y.name];if(null!=da){const ja=Y.domain.codedValues.find(ha=>ha.code===da);ja&&(w.attributes[Y.name]=ja.name)}})}_updateResponseFieldNames(w,G){if(G&&!(1>
G.length)){var Y=this.fieldsIndex;null!=Y&&w.forEach(da=>{if(da?.attributes)for(const ja of G){const ha=Y.get(ja)?.name;ha&&ha!==ja&&(da.attributes[ja]=da.attributes[ha],delete da.attributes[ha])}})}}_getRenderingRuleString(w){if(w){w=w.toJSON();w=w.rasterFunctionDefinition??w;if(w.thumbnail||w.thumbnailEx)w.thumbnail=w.thumbnailEx=null;return JSON.stringify(w)}return null}_hasRasterFunction(w){return null!=w?.functionName&&"none"!==w.functionName.toLowerCase()}_updateRenderingRulesFunctionName(w,
G){if(w&&!(1>w.length)){if("Raw"===w)return w.replace("Raw","None");var Y=w.toLowerCase().replaceAll(/ /gi,"_");return G.has(Y)?G.get(Y):w}}_isRFTJson(w){return w?.name&&w.arguments&&w.function&&w.hasOwnProperty("functionType")}_isVectorDataSet(){return"esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType}_applyMosaicAndRenderingRules(w){const {raster:G,mosaicRule:Y,rasterFunction:da}=this;da&&"rasterFunction"in w&&null==w.rasterFunction&&
(w.rasterFunction=da);Y&&null==w.mosaicRule&&(w.mosaicRule=Y);G&&null==w.raster&&(w.raster=G)}_readCapabilities(w){var G=w.capabilities?w.capabilities.toLowerCase().split(",").map(ta=>ta.trim()):["image","catalog"];const {currentVersion:Y,advancedQueryCapabilities:da,maxRecordCount:ja}=w,ha=G.includes("image"),oa="esriImageServiceDataTypeElevation"===w.serviceDataType;var ma=!(!w.spatialReference&&!w.extent?.spatialReference);const qa=G.includes("edit");ma=G.includes("mensuration")&&ma;const pa=null==
w.mensurationCapabilities?[]:w.mensurationCapabilities.toLowerCase().split(",").map(ta=>ta.trim()),ra=ma&&pa.includes("basic"),sa=this._isMosaicDataset(w)&&G.includes("catalog");G=G.includes("download");return{data:{supportsAttachment:!1},operations:{supportsComputeHistograms:ha,supportsExportImage:ha,supportsIdentify:ha,supportsImageToMap:11.2<=Y&&sa,supportsImageToMapMultiray:11.2<=Y&&sa,supportsMapToImage:11.2<=Y&&sa,supportsFindImages:11.2<=Y&&sa,supportsGetImageUrl:11.3<=Y&&G,supportsMeasure:ma,
supportsMeasureFromImage:11.2<=Y,supportsDownload:G,supportsQuery:sa&&w.fields&&0<w.fields.length,supportsGetSamples:10.2<=Y&&ha,supportsProject:10.3<=Y&&ha,supportsComputeStatisticsHistograms:10.4<=Y&&ha,supportsQueryBoundary:10.6<=Y&&ha,supportsCalculateVolume:10.7<=Y&&oa,supportsComputePixelLocation:10.7<=Y&&sa,supportsComputeAngles:10.91<=Y,supportsQueryGPSInfo:11.2<=Y&&sa,supportsAdd:qa,supportsDelete:qa,supportsEditing:qa,supportsUpdate:qa,supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,
supportsChangeTracking:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsExceedsLimitStatistics:!1,supportsQueryAnalytics:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:ja,maxRecordCountFactor:void 0,supportsStatistics:!!da?.supportsStatistics,supportsOrderBy:!!da?.supportsOrderBy,supportsDistinct:!!da?.supportsDistinct,supportsPagination:!!da?.supportsPagination,supportsStandardizedQueriesOnly:!!da?.useStandardizedQueries,
supportsPercentileStatistics:!!da?.supportsPercentileStatistics,supportsCentroid:!!da?.supportsReturningGeometryCentroid,supportsDistance:!!da?.supportsQueryWithDistance,supportsExtent:!!da?.supportsReturningQueryExtent,supportsGeometryProperties:!!da?.supportsReturningGeometryProperties,supportsHavingClause:!!da?.supportsHavingClause,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsMaxRecordCountFactor:!1,supportsSqlExpression:!1,supportsTopFeaturesQuery:!1,
supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!1,supportsCacheHint:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!!da?.supportsDefaultSR,supportsFullTextSearch:!1,supportsCompactGeometry:!1,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0},mensuration:{supportsDistanceAndAngle:ra,supportsAreaAndPerimeter:ra,
supportsPointOrCentroid:ra,supportsHeightFromBaseAndTop:ma&&pa.includes("base-top height"),supportsHeightFromBaseAndTopShadow:ma&&pa.includes("base-top shadow height"),supportsHeightFromTopAndTopShadow:ma&&pa.includes("top-top shadow height"),supports3D:ma&&pa.includes("3d")}}}};F.__decorate([k.property({clonable:!1})],ea.prototype,"_functionRasterInfos",void 0);F.__decorate([k.property({clonable:!1})],ea.prototype,"_rasterJobHandler",void 0);F.__decorate([k.property({clonable:!1})],ea.prototype,
"_cachedRendererJson",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,"_serviceSupportsMosaicRule",void 0);F.__decorate([p.reader("_serviceSupportsMosaicRule",["currentVersion","fields"])],ea.prototype,"readServiceSupportsMosaicRule",null);F.__decorate([k.property({readOnly:!0})],ea.prototype,"_rasterAttributeTableFieldPrefix",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,"_rasterFunctionNamesIndex",null);F.__decorate([k.property()],ea.prototype,"adjustAspectRatio",void 0);
F.__decorate([k.property({type:[t.Integer],json:{write:!0}})],ea.prototype,"bandIds",void 0);F.__decorate([p.reader("bandIds")],ea.prototype,"readBandIds",null);F.__decorate([k.property({readOnly:!0,json:{read:!1}})],ea.prototype,"capabilities",void 0);F.__decorate([p.reader("service","capabilities",["capabilities","currentVersion","serviceDataType"])],ea.prototype,"readCapabilities",null);F.__decorate([k.property({type:Number})],ea.prototype,"compressionQuality",void 0);F.__decorate([g.writer("compressionQuality")],
ea.prototype,"writeCompressionQuality",null);F.__decorate([k.property({type:Number})],ea.prototype,"compressionTolerance",void 0);F.__decorate([g.writer("compressionTolerance")],ea.prototype,"writeCompressionTolerance",null);F.__decorate([k.property({json:{read:{source:"copyrightText"}}})],ea.prototype,"copyright",void 0);F.__decorate([k.property({readOnly:!0,dependsOn:["_serviceSupportsMosaicRule"]})],ea.prototype,"defaultMosaicRule",void 0);F.__decorate([p.reader("defaultMosaicRule",["defaultMosaicMethod"])],
ea.prototype,"readDefaultMosaicRule",null);F.__decorate([k.property({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],ea.prototype,"definitionExpression",void 0);F.__decorate([k.property({readOnly:!0,constructOnly:!0})],ea.prototype,"exportImageServiceParameters",void 0);F.__decorate([k.property()],ea.prototype,"rasterInfo",void 0);F.__decorate([k.property({readOnly:!0,type:[d]})],ea.prototype,"fields",void 0);F.__decorate([k.property({readOnly:!0})],
ea.prototype,"fieldsIndex",null);F.__decorate([k.property({type:"png png8 png24 png32 jpg bmp gif jpgpng lerc tiff bip bsq".split(" "),json:{write:!0}})],ea.prototype,"format",null);F.__decorate([p.reader("service","format",["serviceDataType"])],ea.prototype,"readFormat",null);F.__decorate([k.property({type:ba})],ea.prototype,"fullExtent",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,"hasMultidimensions",void 0);F.__decorate([k.property({json:{read:{source:"maxImageHeight"}}})],ea.prototype,
"imageMaxHeight",void 0);F.__decorate([k.property({json:{read:{source:"maxImageWidth"}}})],ea.prototype,"imageMaxWidth",void 0);F.__decorate([k.property({type:String,json:{type:A.interpolationKebab.jsonValues,read:A.interpolationKebab.read,write:A.interpolationKebab.write}})],ea.prototype,"interpolation",void 0);F.__decorate([k.property()],ea.prototype,"minScale",void 0);F.__decorate([p.reader("service","minScale")],ea.prototype,"readMinScale",null);F.__decorate([k.property()],ea.prototype,"maxScale",
void 0);F.__decorate([p.reader("service","maxScale")],ea.prototype,"readMaxScale",null);F.__decorate([k.property({type:c})],ea.prototype,"mosaicRule",null);F.__decorate([p.reader("mosaicRule",["mosaicRule","defaultMosaicMethod"])],ea.prototype,"readMosaicRule",null);F.__decorate([g.writer("mosaicRule")],ea.prototype,"writeMosaicRule",null);F.__decorate([k.property()],ea.prototype,"multidimensionalInfo",void 0);F.__decorate([k.property({type:q,json:{write:!0}})],ea.prototype,"multidimensionalSubset",
void 0);F.__decorate([k.property({json:{type:t.Integer}})],ea.prototype,"noData",void 0);F.__decorate([g.writer("noData")],ea.prototype,"writeNoData",null);F.__decorate([k.property({type:String,json:{type:A.noDataInterpretationKebab.jsonValues,read:A.noDataInterpretationKebab.read,write:A.noDataInterpretationKebab.write}})],ea.prototype,"noDataInterpretation",void 0);F.__decorate([k.property({type:String,readOnly:!0,json:{read:{source:["fields"]}}})],ea.prototype,"objectIdField",void 0);F.__decorate([p.reader("objectIdField")],
ea.prototype,"readObjectIdField",null);F.__decorate([k.property({readOnly:!0})],ea.prototype,"geometryType",void 0);F.__decorate([k.property({})],ea.prototype,"typeIdField",void 0);F.__decorate([k.property({})],ea.prototype,"types",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,"parsedUrl",null);F.__decorate([k.property({type:Function})],ea.prototype,"pixelFilter",void 0);F.__decorate([k.property()],ea.prototype,"raster",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,
"sourceType",void 0);F.__decorate([p.reader("sourceType",["serviceSourceType","fields"])],ea.prototype,"readSourceType",null);F.__decorate([k.property()],ea.prototype,"viewId",void 0);F.__decorate([k.property()],ea.prototype,"renderer",null);F.__decorate([k.property({types:z.rasterRendererTypes,json:{name:"layerDefinition.drawingInfo.renderer",origins:{"web-scene":{types:z.websceneRasterRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy(w){return{enabled:w&&"vector-field"!==
w.type&&"flow"!==w.type}}}}}}})],ea.prototype,"internalRenderer",null);F.__decorate([p.reader("internalRenderer")],ea.prototype,"readRenderer",null);F.__decorate([g.writer("internalRenderer")],ea.prototype,"writeRenderer",null);F.__decorate([k.property({clonable:!1})],ea.prototype,"symbolizer",void 0);F.__decorate([k.property(f.opacity)],ea.prototype,"opacity",void 0);F.__decorate([k.property({readOnly:!0})],ea.prototype,"rasterFields",null);F.__decorate([k.property({constructOnly:!0})],ea.prototype,
"rasterFunctionInfos",void 0);F.__decorate([k.property({type:m,json:{name:"renderingRule"}})],ea.prototype,"rasterFunction",null);F.__decorate([p.reader("rasterFunction",["renderingRule","rasterFunctionInfos"])],ea.prototype,"readRasterFunction",null);F.__decorate([k.property({readOnly:!0})],ea.prototype,"serviceDataType",void 0);F.__decorate([k.property({readOnly:!0,type:fa})],ea.prototype,"spatialReference",void 0);F.__decorate([p.reader("spatialReference",["spatialReference","extent"])],ea.prototype,
"readSpatialReference",null);F.__decorate([k.property({json:{type:A.pixelTypeKebabDict.jsonValues}})],ea.prototype,"pixelType",void 0);F.__decorate([p.reader("pixelType")],ea.prototype,"readPixelType",null);F.__decorate([g.writer("pixelType")],ea.prototype,"writePixelType",null);F.__decorate([k.property({constructOnly:!0,type:r})],ea.prototype,"serviceRasterInfo",void 0);F.__decorate([k.property()],ea.prototype,"sourceJSON",void 0);F.__decorate([k.property(f.url)],ea.prototype,"url",void 0);F.__decorate([k.property({readOnly:!0})],
ea.prototype,"version",void 0);F.__decorate([p.reader("version",["currentVersion","fields","timeInfo"])],ea.prototype,"readVersion",null);return ea=F.__decorate([l.subclass("esri.layers.mixins.ArcGISImageService")],ea)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/rasterRenderers":function(){define("exports ./core/Warning ./renderers/ClassBreaksRenderer ./renderers/FlowRenderer ./renderers/RasterColormapRenderer ./renderers/RasterShadedReliefRenderer ./renderers/RasterStretchRenderer ./renderers/UniqueValueRenderer ./renderers/VectorFieldRenderer".split(" "),
function(B,F,M,N,z,Q,T,Z,H){function S(p,l){if(!p)return null;if("classBreaks"===p.type&&p.classificationMethod){var g=p.authoringInfo||{classificationMethod:""};g.classificationMethod=p.classificationMethod;p.authoringInfo=g}"vectorField"===p.type&&p.visualVariables&&!Array.isArray(p.visualVariables)&&(p.visualVariables=[p.visualVariables]);g=p?t[p.type]||null:null;if(g)return g=new g,g.read(p,l),g;l?.messages&&p&&l.messages.push(new F("renderer:unsupported","Renderers of type '"+(p.type||"unknown")+
"' are not supported",{definition:p,context:l}));return null}const P={key:"type",base:null,typeMap:{"unique-value":Z,"class-breaks":M,"raster-colormap":z,"raster-stretch":T,"vector-field":H,"raster-shaded-relief":Q,flow:N}},k={...P,typeMap:{...P.typeMap}};delete k.typeMap["vector-field"];delete k.typeMap.flow;const t={uniqueValue:Z,classBreaks:M,rasterStretch:T,rasterColormap:z,vectorField:H,rasterShadedRelief:Q,flowRenderer:N};B.ClassBreaksRenderer=M;B.FlowRenderer=N;B.RasterColormapRenderer=z;B.RasterShadedReliefRenderer=
Q;B.RasterStretchRenderer=T;B.UniqueValueRenderer=Z;B.VectorFieldRenderer=H;B.fromJSON=function(p,l){return S(p,l)};B.rasterRendererTypes=P;B.read=S;B.websceneRasterRendererTypes=k;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/FlowRenderer":function(){define("../chunks/tslib.es6 ../Color ../core/jsonMap ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./mixins/VisualVariablesMixin ./support/AuthoringInfo ./support/RendererLegendOptions".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t,p){var l;M=new M.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});N=l=class extends k.VisualVariablesMixin(N.JSONSupport){constructor(g){super(g);this.density=.8;this.color=new F([255,255,255,1]);this.maxPathLength=200;this.trailWidth=1.5;this.flowSpeed=10;this.trailLength=100;this.smoothing=0;this.flowRepresentation="flow-from";this.type="flow";this.legendOptions=this.authoringInfo=null;this.trailCap="butt";this.background="none"}clone(){const {density:g,maxPathLength:y,
trailWidth:f,flowSpeed:n,trailLength:a,smoothing:d,flowRepresentation:e,trailCap:h,background:b}=this,c=this.color.clone(),q=(this.visualVariables||[]).map(m=>m.clone()),v=this.authoringInfo?.clone(),A=this.legendOptions?.clone();return new l({density:g,color:c,maxPathLength:y,trailWidth:f,flowSpeed:n,trailLength:a,trailCap:h,background:b,smoothing:d,flowRepresentation:e,visualVariables:q,authoringInfo:v,legendOptions:A})}getSymbol(g,y){}async getSymbolAsync(g,y){}getSymbols(){return[]}};B.__decorate([Q.property({type:Number,
json:{write:!0}})],N.prototype,"density",void 0);B.__decorate([Q.property({type:F,json:{write:{allowNull:!0}}})],N.prototype,"color",void 0);B.__decorate([Q.property({type:Number,cast:z.toPt,json:{write:!0}})],N.prototype,"maxPathLength",void 0);B.__decorate([Q.property({type:Number,cast:z.toPt,json:{write:!0}})],N.prototype,"trailWidth",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],N.prototype,"flowSpeed",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],N.prototype,
"trailLength",void 0);B.__decorate([Q.property({type:Number,cast:z.toPt,json:{write:!1}})],N.prototype,"smoothing",void 0);B.__decorate([Q.property({type:M.apiValues,json:{type:M.jsonValues,read:{reader:M.read},write:{writer:M.write}}})],N.prototype,"flowRepresentation",void 0);B.__decorate([S.enumeration({flowRenderer:"flow"})],N.prototype,"type",void 0);B.__decorate([Q.property({type:t,json:{write:!0}})],N.prototype,"authoringInfo",void 0);B.__decorate([Q.property({type:p,json:{write:!0}})],N.prototype,
"legendOptions",void 0);B.__decorate([Q.property({type:String,json:{write:!0}})],N.prototype,"trailCap",void 0);B.__decorate([Q.property({type:String,json:{write:!0}})],N.prototype,"background",void 0);return N=l=B.__decorate([P.subclass("esri.renderers.FlowRenderer")],N)})},"esri/renderers/RasterColormapRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/subclass ./support/ColormapInfo ./support/colorRampUtils".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S){var P;F=P=class extends F.JSONSupport{constructor(k){super(k);this.colormapInfos=null;this.type="raster-colormap"}static createFromColormap(k,t){if(!k)return null;const p=5===k[0].length;k=[...k].sort((l,g)=>l[0]-g[0]).map(l=>H.fromJSON({value:l[0],color:p?l.slice(1,5):l.slice(1,4).concat([255]),label:t?t[l[0]]??"":l[0]}));return new P({colormapInfos:k})}static createFromColorramp(k){k=S.convertColorRampToColormap(k);return P.createFromColormap(k)}clone(){return new P({colormapInfos:this.colormapInfos.map(k=>
k.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:k,color:t})=>[k,t.r,t.g,t.b,1<t.a?t.a:255*t.a&255]).sort((k,t)=>k[0]-t[0])}};B.__decorate([M.property({type:[H],json:{write:!0}})],F.prototype,"colormapInfos",void 0);B.__decorate([T.enumeration({rasterColormap:"raster-colormap"})],F.prototype,"type",void 0);return F=P=B.__decorate([Z.subclass("esri.renderers.RasterColormapRenderer")],F)})},"esri/renderers/support/ColormapInfo":function(){define("../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),
function(B,F,M,N,z,Q,T,Z){M=class extends M.JSONSupport{constructor(){super(...arguments);this.color=this.label=this.value=null}};B.__decorate([N.property({type:Number,json:{write:!0}})],M.prototype,"value",void 0);B.__decorate([N.property({type:String,json:{write:!0}})],M.prototype,"label",void 0);B.__decorate([N.property({type:F,json:{type:[z.Integer],write:!0}})],M.prototype,"color",void 0);return M=B.__decorate([Z.subclass("esri.renderers.support.ColormapInfo")],M)})},"esri/renderers/support/colorRampUtils":function(){define(["exports",
"../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(B,F,M,N,z){function Q(a,d){if(!a||!d||a.length!==d.length)return!1;for(let e=0;e<a.length;e++)if(a[e]>d[e]+2||a[e]<d[e]-2)return!1;return!0}function T(a){const d=a.clone();d.fromColor=a.toColor;d.toColor=a.fromColor;d.algorithm=a.algorithm;return d}function Z(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(d=>T(d));return a}return T(a)}function H(a,
d){if(a){d=d??f;var e=null;"algorithmic"===a.type?d.some(h=>{if(Q(a.fromColor.toRgb(),h.fromColor)&&Q(a.toColor.toRgb(),h.toColor))return e=h.id,!0}):"multipart"===a.type&&d.some(h=>{const b=a.colorRamps,c=h.colorRamps;if(b&&c&&b.length===c.length&&!c.some((q,v)=>{if(!Q(b[v].fromColor.toRgb(),(new F(q.fromColor)).toRgb())||!Q(b[v].toColor.toRgb(),(new F(q.toColor)).toRgb()))return!0})){if(e)return!0;e=h.id}});return e}}function S(a,d,e=!1){if(a){var h=!1,b=H(a,d);null!=b||e||(h=!0,a=Z(a),b=H(a,d));
return b?{id:b,inverted:h}:void 0}}function P(a,d=!1){return(a="string"===typeof a?a:S(a,void 0,d)?.id)?n.toJSON(a):null}function k(a){a=a||{};const d=a.numColors||256;return{...a,numColors:d,distanceOffset:a.distanceOffset||0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(d-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(d-1),weights:a.weights}}function t(a,d){let {fromColor:e,toColor:h}=a;e=[...e];
h=[...h];3===e.length&&(e=e.concat([255]));3===h.length&&(h=h.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var b=k(d);const {numColors:c,distanceOffset:q,isCustomInterval:v,interpolateAlpha:A}=b;if(1===c&&0===q)return[e];if(2===c&&0===q&&!v)return[e,h];var m={r:e[0],g:e[1],b:e[2]};d={r:h[0],g:h[1],b:h[2]};if("esriCIELabAlgorithm"===a){a=M.toLAB(m);d=M.toLAB(d);const {numColors:I,distanceOffset:D,distanceInterval:J,isCustomInterval:u}=b;let {l:x,a:K,b:R}=a;a=(d.l-x)*J;m=(d.a-K)*J;b=(d.b-R)*
J;var r=[];if(D){var C=D/J;x+=C*a;K+=C*m;R+=C*b}for(C=0;C<I-1;C++)r.push({l:x,a:K,b:R}),x+=a,K+=m,R+=b;r.push(u?{l:x,a:K,b:R}:d);d=r}else if("esriHSVAlgorithm"===a){a=M.toHSV(m);d=M.toHSV(d);const {numColors:I,distanceOffset:D,distanceInterval:J,isCustomInterval:u}=b;r=0===a.s;C=0===d.s;m=a.h;b=d.h;r&&!C?m=b:C&&!r&&(d={...d,h:m},b=m);r=Math.abs(b-m);180>r?b=(b-m)*J:(r=360-r,b=m>b?r*J:-r*J);r=(d.s-a.s)*J;C=(d.v-a.v)*J;let {s:x,v:K}=a;a=m;D&&(m=D/J,a=(a+m*b+360)%360,x+=m*r,K+=m*C);m=[];for(var E=0;E<
I-1;E++)m.push({h:a,s:x,v:K}),a=(a+b+360)%360,x+=r,K+=C;m.push(u?{h:a,s:x,v:K}:d);d=m}else{m=M.toLCH(m);d=M.toLCH(d);const {numColors:I,distanceOffset:D,distanceInterval:J,isCustomInterval:u}=b;b=m.h;r=d.h;a=2*Math.PI;b<=r?(C=r-b,b=r-b-a,b=Math.abs(b)<Math.abs(C)?b:C):(C=r+a-b,b=r-b,b=Math.abs(b)<Math.abs(C)?b:C);b*=J;r=(d.l-m.l)*J;C=(d.c-m.c)*J;let {l:x,c:K,h:R}=m;D&&(m=D/J,x+=m*r,K+=m*C,R=(R+m*b+a)%a);m=[];for(E=0;E<I-1;E++)m.push({l:x,c:K,h:R}),x+=r,K+=C,R=(R+b+a)%a;m.push(u?{l:x,c:K,h:R}:d);d=
m}a=[];m=e[3]??255;b=((h[3]??255)-m)/(c-1);for(r=0;r<c;r++){const {r:I,g:D,b:J}=M.toRGB(d[r]);a.push([I,D,J,A?Math.round(m+b*r):255])}return a}function p(a,d){const {numColors:e,interpolateAlpha:h}=k(d);d=d?.weights;({colorRamps:a}=a);if(d){const r=d.reduce((C,E)=>C+E);d=d.map(C=>C/r)}else{d=[];for(var b=0;b<a.length;b++)d[b]=1/a.length}b=[];const c=1/(e-1);let q=0,v=!1;for(let r=0;r<a.length;r++){var A=b.length,m=v?0:A*c-q;q+=d[r];A=r===a.length-1?e-1-A:(d[r]-m)/c;v=Math.ceil(A)===A;A=Math.ceil(A);
0!==A&&(m=t(a[r],{numColors:A,interpolateAlpha:h,distanceOffset:m/d[r],distanceInterval:c/d[r]}),b.push(...m))}d=[...a[a.length-1].toColor];3===d.length&&d.push(255);b.push(d);return b}function l(a,d){a=z.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?p(a,d):t(a,d)}function g(a){a=M.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function y(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:g(a.fromColor),
ToColor:g(a.toColor)}}const f=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,
0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,
255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,
255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,
255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,
96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,
242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},
{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},
{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",
colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",
fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},
{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",
type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,
0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},
{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",
colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,
107,45]}],n=new N.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging",
"Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging",
"Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark",
"Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark",
"Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});B.colorRampDict=n;B.convertColorRampToColormap=function(a,d){a=l(a,d);const e=d?.interpolateAlpha;a.forEach((h,b)=>{h.unshift(b);e||h.pop()});
return a};B.convertColorRampToColors=l;B.convertRGBATo32Bit=function(a){a=a.reverse().map(d=>{d=d.toString(16);return 2>d.length?"0"+d:d});return 4294967295&Number.parseInt(a.join(""),16)};B.createHsvMap=function(a){const d=[];for(let e=0;e<a.length;e+=4){const h=M.toHSV({r:a[e],g:a[e+1],b:a[e+2]});d.push([h.h/60,h.s/100,255*h.v/100])}return d};B.getColorRampId=S;B.getColorRampJSON=function(a,d="esriCIELabAlgorithm"){const e=f.find(({id:h})=>h===a);return e?e.colorRamps?{type:"multipart",colorRamps:e.colorRamps.map(h=>
({type:"algorithmic",algorithm:d,fromColor:[...h.fromColor],toColor:[...h.toColor]}))}:{type:"algorithmic",algorithm:d,fromColor:[...e.fromColor],toColor:[...e.toColor]}:null};B.getColorRampName=P;B.getRFxArgColorRampValue=function(a){const d=P(a);return d?"algorithmic"===a.type?{...y(a),Name:d}:a.colorRamps?(a=a.colorRamps.map(y),{type:"MultiPartColorRamp",NumColorRamps:a.length,ArrayOfColorRamp:a,Name:d}):null:null};B.predefinedJsonColorRamps=f;B.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");
Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/RasterShadedReliefRenderer":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../rest/support/colorRamps".split(" "),function(B,F,M,N,z,Q,T,Z,H,S){var P;F=P=class extends F.JSONSupport{constructor(k){super(k);
this.altitude=45;this.azimuth=315;this.colorRamp=null;this.hillshadeType="traditional";this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.scalingType="none";this.type="raster-shaded-relief";this.zFactor=1}readColorRamp(k){return S.fromJSON(k)}clone(){return new P({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:M.clone(this.colorRamp)})}};
B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"altitude",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"azimuth",void 0);B.__decorate([N.property({types:S.types,json:{write:!0}})],F.prototype,"colorRamp",void 0);B.__decorate([Z.reader("colorRamp")],F.prototype,"readColorRamp",null);B.__decorate([N.property({type:["traditional","multi-directional"],json:{write:!0}})],F.prototype,"hillshadeType",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],
F.prototype,"pixelSizePower",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"pixelSizeFactor",void 0);B.__decorate([N.property({type:["none","adjusted"],json:{write:!0}})],F.prototype,"scalingType",void 0);B.__decorate([T.enumeration({rasterShadedRelief:"raster-shaded-relief"})],F.prototype,"type",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"zFactor",void 0);return F=P=B.__decorate([H.subclass("esri.renderers.RasterShadedReliefRenderer")],
F)})},"esri/renderers/RasterStretchRenderer":function(){define("../chunks/tslib.es6 ../core/deprecate ../core/JSONSupport ../core/lang ../core/Logger ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./support/stretchRendererUtils ../rest/support/colorRamps".split(" "),function(B,F,M,N,z,Q,T,Z,H,S,P,k,t){var p;M=p=class extends M.JSONSupport{constructor(l){super(l);
this.colorRamp=null;this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.histograms=this.sigmoidStrengthLevel=this.outputMin=this.outputMax=this.numberOfStandardDeviations=this.minPercent=this.maxPercent=null;this.useGamma=!1;this.stretchType="none";this.type="raster-stretch"}readColorRamp(l){if(l)return t.fromJSON(l)}get statistics(){return this._get("statistics")}set statistics(l){F.deprecatedProperty(z.getLogger(this),"statistics",{replacement:"customStatistics",version:"4.31",warnOnce:!0});
this._set("statistics",l)}get customStatistics(){const l=this.statistics;return l&&Array.isArray(l[0])?l.map(g=>({min:g[0],max:g[1],avg:g[2],stddev:g[3]})):l}set customStatistics(l){this._set("statistics",l?.map(g=>[g.min,g.max,g.avg??0,g.stddev??1]))}readCustomStatistics(l){return l?.map(g=>({min:g[0],max:g[1],avg:g[2],stddev:g[3]}))}writeCustomStatistics(l,g,y){l?.length&&(g[y]=l.map(f=>[f.min,f.max,f.avg??0,f.stddev??1]))}readStretchType(l,g){l=g.stretchType;"number"===typeof l&&(l=k.stretchTypeFunctionEnum[l]);
return k.stretchTypeJSONDict.read(l)}clone(){return new p({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:N.clone(this.statistics),customStatistics:N.clone(this.customStatistics),gamma:N.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:N.clone(this.colorRamp),histograms:N.clone(this.histograms),
dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};B.__decorate([Q.property({types:t.types,json:{write:!0}})],M.prototype,"colorRamp",void 0);B.__decorate([H.reader("colorRamp")],M.prototype,"readColorRamp",null);B.__decorate([Q.property({type:Boolean,json:{write:!0}})],M.prototype,"computeGamma",void 0);B.__decorate([Q.property({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],M.prototype,"dynamicRangeAdjustment",void 0);B.__decorate([Q.property({type:[Number],json:{write:!0}})],
M.prototype,"gamma",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],M.prototype,"maxPercent",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],M.prototype,"minPercent",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],M.prototype,"numberOfStandardDeviations",void 0);B.__decorate([Q.property({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],M.prototype,"outputMax",void 0);B.__decorate([Q.property({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],
M.prototype,"outputMin",void 0);B.__decorate([Q.property({type:Number,json:{write:!0}})],M.prototype,"sigmoidStrengthLevel",void 0);B.__decorate([Q.property({})],M.prototype,"statistics",null);B.__decorate([Q.property()],M.prototype,"histograms",void 0);B.__decorate([Q.property({json:{type:[[Number]],name:"statistics",write:!0}})],M.prototype,"customStatistics",null);B.__decorate([H.reader("customStatistics")],M.prototype,"readCustomStatistics",null);B.__decorate([P.writer("customStatistics")],M.prototype,
"writeCustomStatistics",null);B.__decorate([Q.property({type:Boolean,json:{write:!0}})],M.prototype,"useGamma",void 0);B.__decorate([Q.property({type:k.stretchTypeJSONDict.apiValues,json:{type:k.stretchTypeJSONDict.jsonValues,write:k.stretchTypeJSONDict.write}})],M.prototype,"stretchType",void 0);B.__decorate([H.reader("stretchType",["stretchType"])],M.prototype,"readStretchType",null);B.__decorate([Z.enumeration({rasterStretch:"raster-stretch"})],M.prototype,"type",void 0);return M=p=B.__decorate([S.subclass("esri.renderers.RasterStretchRenderer")],
M)})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports","../../core/jsonMap"],function(B,F){F=new F.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});B.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};B.stretchTypeJSONDict=F;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/VectorFieldRenderer":function(){define("../chunks/tslib.es6 ../Color ../geometry ../Graphic ../symbols ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/enumeration ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/support/normalizeUtils ../layers/support/rasterFunctions/vectorFieldUtils ./ClassBreaksRenderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./visualVariables/RotationVariable ./visualVariables/SizeVariable ./visualVariables/support/visualVariableUtils ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../symbols/support/utils ../geometry/Point ../symbols/PictureMarkerSymbol".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t,p,l,g,y,f,n,a,d,e,h,b,c,q,v){var A;const m=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]);M=new Q.JSONMap({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"});
Q=new Q.JSONMap({flow_from:"flow-from",flow_to:"flow-to"});T=A=class extends f.VisualVariablesMixin(T.JSONSupport){constructor(r){super(r);this.attributeField="Magnitude";this.flowRepresentation="flow-from";this.rotationType="arithmetic";this.style="single-arrow";this.symbolTileSize=50;this.type="vector-field"}readInputUnit(r,C){return m.has(r)?g.unitKebabDict.fromJSON(r):null}readOutputUnit(r,C){return m.has(r)?g.unitKebabDict.fromJSON(r):null}get styleRenderer(){const r=this.attributeField,C=this._createStyleRenderer(this.style);
C.field=r;return C}get sizeVariables(){const r=[];if(this.visualVariables)for(var C of this.visualVariables)"size"===C.type&&r.push(C);0===r.length&&(C=new d({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize}),this.visualVariables?this.visualVariables.push(C):this._set("visualVariables",[C]),r.push(C));return r}get rotationVariables(){const r=[];if(this.visualVariables)for(var C of this.visualVariables)"rotation"===C.type&&r.push(C);0===r.length&&(C=new a({field:"Direction",
rotationType:this.rotationType}),this.visualVariables?this.visualVariables.push(C):this._set("visualVariables",[C]),r.push(C));return r}clone(){return new A({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:Z.clone(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(r,C=!1,E=[]){const I=[];var D=g.getUnitConversionFactor(this.inputUnit,
this.outputUnit),J=this.rotationVariables[0]?.rotationType||this.rotationType;C=C?g.convertVectorFieldData(r.pixelBlock,"vector-uv",J,D):g.convertVectorFieldUnit(r.pixelBlock,"vector-magdir",D);if(null==C)return I;r=r.extent;D=null!=C.mask&&0<C.mask.length;J=0;const u=(r.xmax-r.xmin)/C.width,x=(r.ymax-r.ymin)/C.height;for(let R=0;R<C.height;R++)for(let V=0;V<C.width;V++,J++){let W=new q({x:r.xmin+V*u+u/2,y:r.ymax-R*x-x/2,spatialReference:r.spatialReference});W=(await l.normalizeCentralMeridian(W))[0];
var K=E.some(U=>U.intersects(W));D&&!C.mask[J]||K||(K={Magnitude:C.pixels[0][J],Direction:C.pixels[1][J]},K=new N({geometry:new q({x:W.x,y:W.y,spatialReference:r.spatialReference}),attributes:K}),K.symbol=this._getVisualVariablesAppliedSymbol(K),I.push(K))}return I}getSymbol(r,C){}async getSymbolAsync(r,C){}getSymbols(){return[]}getClassBreakInfos(){return this.styleRenderer?.classBreakInfos}getDefaultSymbol(){return this.styleRenderer?.defaultSymbol}_getDefaultSymbol(r){return new b({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",
outline:new h({width:0}),size:20,color:r||new F([0,92,230])})}_getVisualVariablesAppliedSymbol(r){if(r){var C=this.styleRenderer?.getSymbol(r)?.clone(),E=this.sizeVariables,I=this.rotationVariables;E&&E.length&&this.sizeVariables.forEach(D=>c.applySizesToSymbol(C,e.getAllSizes([D],r)));I&&I.length&&(r.attributes.Direction+="flow-to"===this.flowRepresentation===("ocean-current-kn"===this.style||"ocean-current-m"===this.style)?0:180,this.rotationVariables.forEach(D=>c.applyRotationToSymbol(C,e.getRotationAngle(D,
r),D.axis)));return C}}_createStyleRenderer(r){let C={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(r){case "single-arrow":C=this._createSingleArrowRenderer();break;case "beaufort-kn":C=this._createBeaufortKnotsRenderer();break;case "beaufort-m":C=this._createBeaufortMeterRenderer();break;case "beaufort-ft":C=this._createBeaufortFeetRenderer();break;case "beaufort-mi":C=this._createBeaufortMilesRenderer();break;case "beaufort-km":C=this._createBeaufortKilometersRenderer();break;
case "ocean-current-m":C=this._createCurrentMeterRenderer();break;case "ocean-current-kn":C=this._createCurrentKnotsRenderer();break;case "simple-scalar":C=this._createSimpleScalarRenderer();break;case "wind-barb":C=this._createWindBarbsRenderer();break;case "classified-arrow":C=this._createClassifiedArrowRenderer()}return new y(C)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const r=this._getDefaultSymbol(new F([214,47,39])),C=this._getClassBreaks([0,
1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]]);return{defaultSymbol:r,classBreakInfos:C}}_createBeaufortMeterRenderer(){const r=this._getDefaultSymbol(new F([214,47,39])),C=this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,
220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:C}}_createBeaufortFeetRenderer(){const r=this._getDefaultSymbol(new F([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];C=C.map(E=>3.28084*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:C}}_createBeaufortMilesRenderer(){const r=
this._getDefaultSymbol(new F([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];C=C.map(E=>2.23694*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:C}}_createBeaufortKilometersRenderer(){const r=this._getDefaultSymbol(new F([214,47,39]));var C=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,
32.7];C=C.map(E=>3.6*E);C=this._getClassBreaks(C,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]]);return{defaultSymbol:r,classBreakInfos:C}}_createCurrentMeterRenderer(){const r=this._getDefaultSymbol(new F([177,177,177])),C=this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]]);return{defaultSymbol:r,classBreakInfos:C}}_createCurrentKnotsRenderer(){const r=
this._getDefaultSymbol(new F([177,177,177])),C=this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]]);return{defaultSymbol:r,classBreakInfos:C}}_createClassifiedArrowRenderer(){const r=this._getDefaultSymbol(new F([56,168,0]));var C=[0,1E-6,3.5,7,10.5,14];if(this.sizeVariables?.length){const E=this.sizeVariables[0].minDataValue,I=this.sizeVariables[0].maxDataValue;if(E&&I){const D=(I-E)/5;C=
Array.from(Array(6).keys()).map(J=>E+D*J)}}C=this._getClassBreaks(C,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]]);return{defaultSymbol:r,classBreakInfos:C}}_createSimpleScalarRenderer(){return{defaultSymbol:v.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII\x3d",
height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const r=Array.from(Array(31).keys()).map(D=>5*D),C=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},
{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"90-95",
path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},
{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},
{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg\x3d\x3d"},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",
imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4\x3d"}],E=v.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",
height:20,width:20,type:"esriPMS",angle:0}),I=r.map((D,J)=>{if(J!==r.length-1)if(0===J)var u={minValue:D,maxValue:r[J+1],symbol:E};else u=v.fromJSON({type:"esriPMS",imageData:C[J].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0}),u={minValue:D,maxValue:r[J+1],symbol:u};return new n(u)});return{defaultSymbol:E,classBreakInfos:I}}_getClassBreaks(r,C){return C.map((E,I)=>new n({minValue:r[I],maxValue:r[I+1],symbol:this._getDefaultSymbol(new F(E))}))}};B.__decorate([H.property({type:["Magnitude"],
json:{write:!0}})],T.prototype,"attributeField",void 0);B.__decorate([H.property({type:Q.apiValues,json:{type:Q.jsonValues,read:{reader:Q.read},write:{writer:Q.write}}})],T.prototype,"flowRepresentation",void 0);B.__decorate([H.property({type:["geographic","arithmetic"],json:{write:!0}})],T.prototype,"rotationType",void 0);B.__decorate([H.property({type:M.apiValues,json:{type:M.jsonValues,read:{reader:M.read},write:{writer:M.write}}})],T.prototype,"style",void 0);B.__decorate([H.property({json:{write:!0}})],
T.prototype,"symbolTileSize",void 0);B.__decorate([H.property({type:g.unitKebabDict.apiValues,json:{type:g.unitKebabDict.jsonValues,write:{writer:g.unitKebabDict.write}}})],T.prototype,"inputUnit",void 0);B.__decorate([t.reader("inputUnit")],T.prototype,"readInputUnit",null);B.__decorate([H.property({type:g.unitKebabDict.apiValues,json:{type:g.unitKebabDict.jsonValues,read:{reader:g.unitKebabDict.read},write:{writer:g.unitKebabDict.write}}})],T.prototype,"outputUnit",void 0);B.__decorate([t.reader("outputUnit")],
T.prototype,"readOutputUnit",null);B.__decorate([k.enumeration({vectorField:"vector-field"})],T.prototype,"type",void 0);B.__decorate([H.property({type:y})],T.prototype,"styleRenderer",null);B.__decorate([H.property({type:d})],T.prototype,"sizeVariables",null);B.__decorate([H.property({type:a})],T.prototype,"rotationVariables",null);return T=A=B.__decorate([p.subclass("esri.renderers.VectorFieldRenderer")],T)})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap",
"../PixelBlock","./pixelUtils"],function(B,F,M,N){function z(b,c){return g.get(b)/g.get(c)||1}function Q(b,c="geographic"){const [q,v]=b;b=Math.sqrt(q*q+v*v);let A=Math.atan2(v,q)*y;A=(360+A)%360;"geographic"===c&&(A=(450-A)%360);return[b,A]}function T(b,c="geographic"){let q=b[1];"geographic"===c&&(q=(450-q)%360);q%=360;b=b[0];return[b*Math.cos(q/y),b*Math.sin(q/y)]}function Z(b,c,q="geographic",v=1){if(!N.isValidPixelBlock(b))return b;const {pixels:A,width:m,height:r}=b;var C=m*r;const E=A[0],I=
A[1],D=b.pixelType.startsWith("f")?b.pixelType:"f32",J=M.createEmptyBand(D,C);C=M.createEmptyBand(D,C);let u=0;for(let x=0;x<r;x++)for(let K=0;K<m;K++)"vector-uv"===c?([J[u],C[u]]=Q([E[u],I[u]],q),J[u]*=v):([J[u],C[u]]=T([E[u],I[u]],q),J[u]*=v,C[u]*=v),u++;b=new M({pixelType:D,width:b.width,height:b.height,mask:b.mask,validPixelCount:b.validPixelCount,maskIsAlpha:b.maskIsAlpha,pixels:[J,C]});b.updateStatistics();return b}function H(b=0,c=0,q=Math.PI,v=!0){v&&(q=(2*Math.PI-q)%(2*Math.PI));v=v?-1:1;
const A=-7*v,m=-2*v,r=-16*v,[C,E]=P(0,c+13*v,q,21.75),[I,D]=P(b-5.5,c+A,q,21.75),[J,u]=P(b+5.5,c+A,q,21.75),[x,K]=P(b-1.5,c+m,q,21.75),[R,V]=P(b+1.5,c+m,q,21.75),[W,U]=P(b-1.5,c+r,q,21.75),[L,O]=P(b+1.5,c+r,q,21.75);return[C,E,I,D,x,K,R,V,J,u,W,U,L,O]}function S(b=0,c=Math.PI,q=!0){q&&(c=(2*Math.PI-c)%(2*Math.PI));var v=q?-1:1,A=5*v;const m=20*v,r=25*v;v*=2;const C=q?1:-1;q=5*C;let [E,I]=[0+q,0-m],[D,J]=[E+2*C,I],[u,x]=[D-0*C,J+v],[K,R]=[0-q,0-r],[V,W]=[K+0*C,R-v],U=Math.ceil(b/5),L=Math.floor(U/
10);U-=8*L;b=[];const O=[];for(let ea=0;ea<U/2;ea++,L--){0>=L&&1===U%2&&ea===(U-1)/2&&(K=0,V=K+0*C,R=(R+I)/2,W=R-v);const [ia,w]=P(K,R,c,45);if(0<L){const [G,Y]=P(D,R,c,45),[da,ja]=P(E,I,c,45);b.push(G);b.push(Y);b.push(ia);b.push(w);b.push(da);b.push(ja)}else{const [G,Y]=P(D,J,c,45),[da,ja]=P(u,x,c,45),[ha,oa]=P(V,W,c,45);O.push(ia);O.push(w);O.push(ha);O.push(oa);O.push(da);O.push(ja);O.push(G);O.push(Y)}R+=A;I+=A;J+=A;x+=A;W+=A}const [X,aa]=P(0+q,0+m,c,45);A=7*C;const [ba,fa]=P(0+A,0+m,c,45),[ca,
ka]=P(0+q,0-r,c,45),[la,na]=P(0+A,0-r,c,45);return{pennants:b,barbs:O,shaft:[X,aa,ba,fa,ca,ka,la,na]}}function P(b,c,q,v=1){return[Math.sqrt(b*b+c*c)/v,(2*Math.PI+(2*Math.PI+Math.atan2(c,b))%(2*Math.PI)-q)%(2*Math.PI)]}function k(b,c,q,v){q=z(v||"knots",q);for(v=1;v<c.length;v++)if(v===c.length-1){if(b<c[v]*q)break}else if(b<=c[v]*q)break;return Math.min(v-1,c.length-2)}function t(b,c,q,v,A){let m=0;switch(c){case "beaufort_kn":m=k(b,a,"knots",q);break;case "beaufort_km":m=k(b,a,"kilometer-per-hour",
q);break;case "beaufort_ft":m=k(b,a,"feet-per-second",q);break;case "beaufort_m":m=k(b,a,"meter-per-second",q);break;case "classified_arrow":m=k(b,A??[],v,q);break;case "ocean_current_m":m=k(b,d,"meter-per-second",q);break;case "ocean_current_kn":m=k(b,e,"knots",q)}return m}function p(b,c){const {style:q,inputUnit:v,outputUnit:A,breakValues:m}=c,r=f.fromJSON(v),C=f.fromJSON(A);let E=0,I=0;const {width:D,height:J,mask:u}=b,x=b.pixels[0];b=b.pixels[1];var K=null!=u?u.filter(W=>0<W).length:D*J;const R=
new Float32Array(42*K);K=new Uint32Array(15*K);c=c.invertDirection?H(0,0,0,!1):n;for(let W=0;W<J;W++)for(let U=0;U<D;U++){var V=W*D+U;if(!u||u[W*D+U]){const L=(b[V]+360)%360/180*Math.PI,O=t(x[V],q,r,C,m);for(let X=0;X<c.length;X+=2)R[E++]=(U+.5)/D,R[E++]=(W+.5)/J,R[E++]=c[X],R[E++]=c[X+1]+L,R[E++]=O,R[E++]=x[V];V=7*(E/42-1);K[I++]=V;K[I++]=V+1;K[I++]=V+2;K[I++]=V+0;K[I++]=V+4;K[I++]=V+3;K[I++]=V+0;K[I++]=V+2;K[I++]=V+3;K[I++]=V+2;K[I++]=V+5;K[I++]=V+3;K[I++]=V+5;K[I++]=V+6;K[I++]=V+3}}return{vertexData:R,
indexData:K}}function l(b,c){let q=0,v=0;const {width:A,height:m,mask:r}=b;b=b.pixels[0];const C=[],E=[];var I=f.fromJSON(c.inputUnit);I=z(I,"knots");c="wind_speed"===c.style?5:Number.MAX_VALUE;for(let J=0;J<m;J++)for(let u=0;u<A;u++){var D=b[J*A+u]*I;if((!r||r[J*A+u])&&D<c){for(let x=0;4>x;x++)C[q++]=(u+.5)/A,C[q++]=(J+.5)/m,C[q++]=2>x?-.5:.5,C[q++]=0===x%2?-.5:.5,C[q++]=0,C[q++]=D;D=4*(q/24-1);E[v++]=D;E[v++]=D+1;E[v++]=D+2;E[v++]=D+1;E[v++]=D+2;E[v++]=D+3}}return{vertexData:new Float32Array(C),
indexData:new Uint32Array(E)}}const g=new Map;g.set("meter-per-second",1);g.set("kilometer-per-hour",.277778);g.set("knots",.514444);g.set("feet-per-second",.3048);g.set("mile-per-hour",.44704);const y=180/Math.PI,f=new F.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),n=H(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],d=[0,.5,1,1.5,2],e=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],
h=[];B.convertToLocalDirections=function(b,c,q,v="geographic"){if(!N.isValidPixelBlock(b)||null==q)return b;b="vector-magdir"===c?b.clone():Z(b,c);const A=b.pixels[1];for(let m=0;m<A.length;m++)A[m]="geographic"===v?(A[m]+q[m]+270)%360:(A[m]+360-q[m])%360;return"vector-magdir"===c?b:Z(b,"vector-magdir")};B.convertVectorFieldData=Z;B.convertVectorFieldUnit=function(b,c,q=1){if(1===q||!N.isValidPixelBlock(b))return b;b=b.clone();const {pixels:v,width:A,height:m}=b,r=v[0],C=v[1];let E=0;for(let I=0;I<
m;I++)for(let D=0;D<A;D++)"vector-uv"===c?(r[E]*=q,C[E]*=q):r[E]*=q,E++;b.updateStatistics();return b};B.createVFMesh=function(b,c){if("simple_scalar"===c.style)c=l(b,c);else if("wind_speed"===c.style){if(0===h.length)for(var q=0;30>q;q++)h.push(S(5*q,0,!c.invertDirection));c=f.fromJSON(c.inputUnit);c=z(c,"knots");const {width:r,height:C,mask:E}=b;q=b.pixels[0];b=b.pixels[1];const I=[],D=[];let J=0,u=0;for(let x=0;x<C;x++)for(let K=0;K<r;K++){var v=x*r+K,A=q[v]*c;if((!E||E[x*r+K])&&5<=A){const R=
(b[v]+360)%360/180*Math.PI,{pennants:V,barbs:W,shaft:U}=h[Math.min(Math.floor(A/5),29)];if(0===V.length+W.length)continue;v=I.length/6;const L=(K+.5)/r,O=(x+.5)/C;for(var m=0;m<V.length;m+=2)I[J++]=L,I[J++]=O,I[J++]=V[m],I[J++]=V[m+1]+R,I[J++]=0,I[J++]=A;for(m=0;m<W.length;m+=2)I[J++]=L,I[J++]=O,I[J++]=W[m],I[J++]=W[m+1]+R,I[J++]=0,I[J++]=A;for(m=0;m<U.length;m+=2)I[J++]=L,I[J++]=O,I[J++]=U[m],I[J++]=U[m+1]+R,I[J++]=0,I[J++]=A;for(A=0;A<V.length/6;A++)D[u++]=v,D[u++]=v+1,D[u++]=v+2,v+=3;for(A=0;A<
W.length/8;A++)D[u++]=v,D[u++]=v+1,D[u++]=v+2,D[u++]=v+1,D[u++]=v+2,D[u++]=v+3,v+=4;D[u++]=v+0;D[u++]=v+1;D[u++]=v+2;D[u++]=v+1;D[u++]=v+3;D[u++]=v+2;v+=4}}c={vertexData:new Float32Array(I),indexData:new Uint32Array(D)}}else c=p(b,c);return c};B.createVFMeshScalar=l;B.getUnitConversionFactor=z;B.sampleVectorField=function(b,c,q,v=[0,0],A=.5){const {width:m,height:r,mask:C}=b,[E,I]=b.pixels,[D,J]=v;b=Math.round((m-D)/q);v=Math.round((r-J)/q);var u=b*v;const x=new Float32Array(u),K=new Float32Array(u);
u=new Uint8Array(u);c="vector-uv"===c;for(let V=0;V<v;V++)for(let W=0;W<b;W++){let U=0;const L=V*b+W,O=Math.max(0,V*q+J),X=Math.max(0,W*q+D),aa=Math.min(r,O+q),ba=Math.min(m,X+q);for(let fa=O;fa<aa;fa++)for(let ca=X;ca<ba;ca++){var R=fa*m+ca;if(!C||C[R]){U++;R=c?[E[R],I[R]]:[E[R],(360+I[R])%360];const [ka,la]=c?R:T(R);x[L]+=ka;K[L]+=la}}if(U>=(aa-O)*(ba-X)*(1-A)){u[L]=1;const [fa,ca]=Q([x[L]/U,K[L]/U]);x[L]=fa;K[L]=ca}else u[L]=0,x[L]=0,K[L]=0}q=new M({width:b,height:v,pixels:[x,K],mask:u});q.updateStatistics();
return q};B.snapImageToSymbolTile=function(b,c,q,v,A){if(null==A||!A.spatialReference.equals(b.spatialReference))return{extent:b,width:Math.round(c/v),height:Math.round(q/v),resolution:b.width/c};const m=A.xmin;A=A.ymax;c=(b.xmax-b.xmin)/c*v;q=(b.ymax-b.ymin)/q*v;b.xmin=m+Math.floor((b.xmin-m)/c)*c;b.xmax=m+Math.ceil((b.xmax-m)/c)*c;b.ymin=A+Math.floor((b.ymin-A)/q)*q;b.ymax=A+Math.ceil((b.ymax-A)/q)*q;return{extent:b,width:Math.round(b.width/c),height:Math.round(b.height/q),resolution:(c+q)/2}};
B.unitKebabDict=f;B.uvComponentToVector=Q;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(B,F,M,N,z,Q,T,Z,H,S){var P;M=P=class extends M.JSONSupport{static createEmptyBand(k,
t){return new (P.getPixelArrayConstructor(k))(t)}static combineBandMasks(k){if(2>k.length)return k[0];const t=k[0].length,p=(new Uint8Array(t)).fill(255);for(let l=0;l<k.length;l++){const g=k[l];for(let y=0;y<t;y++)g[y]||(p[y]=0)}return p}static getPixelArrayConstructor(k){let t;switch(k){case "u1":case "u2":case "u4":case "u8":t=Uint8Array;break;case "u16":t=Uint16Array;break;case "u32":t=Uint32Array;break;case "s8":t=Int8Array;break;case "s16":t=Int16Array;break;case "s32":t=Int32Array;break;case "f32":t=
Float32Array;break;case "f64":t=Float64Array;break;case "c64":case "c128":case "unknown":t=Float32Array}return t}constructor(k){super(k);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(k){if(!k)return"f32";k=k.toLowerCase();["u1","u2","u4"].includes(k)?k="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(k)||(k="f32");return k}getPlaneCount(){return this.pixels?.length}addData(k){if(!k.pixels||
k.pixels.length!==this.width*this.height)throw new F("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(k.pixels);this.statistics.push(k.statistics??new H.SimpleBandStatistics)}getAsRGBA(){const k=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(k);
break;default:this._fillFrom8Bit(k)}return new Uint8ClampedArray(k)}getAsRGBAFloat(){const k=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(k);return k}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(p=>{var l=this.mask;let g=Infinity,y=-Infinity;const f=p.length;let n,a=0;if(null!=l)for(n=0;n<f;n++)l[n]&&(a=p[n],g=a<g?a:g,y=a>y?a:y);else for(n=0;n<f;n++)a=p[n],g=a<g?a:g,y=a>y?a:y;return new H.SimpleBandStatistics(g,y)});var k=this.mask,t=0;if(null!=k)for(let p=
0;p<k.length;p++)k[p]&&t++;else t=this.width*this.height;this.validPixelCount=t}}clamp(k){if(k&&"f64"!==k&&"f32"!==k&&this.pixels){var [t,p]=S.getPixelValueRange(k),l=this.pixels,g=this.width*this.height,y=l.length,f=[];for(let e=0;e<y;e++){var n=P.createEmptyBand(k,g);var a=l[e];for(let h=0;h<g;h++){var d=a[h];n[h]=d>p?p:d<t?t:d}f.push(n)}this.pixels=f;this.pixelType=k}}extractBands(k){const {pixels:t,statistics:p}=this;if(null==k||0===k.length||!t||0===t.length)return this;var l=t.length;const g=
k.some(e=>e>=t.length),y=l===k.length&&!k.some((e,h)=>e!==h);if(g||y)return this;l=this.bandMasks?.length===l?k.map(e=>this.bandMasks[e]):void 0;let {mask:f,validPixelCount:n}=this;const {width:a,height:d}=this;l?.length&&(f=P.combineBandMasks(l),n=f.filter(e=>!!e).length);return new P({pixelType:this.pixelType,width:a,height:d,mask:f,bandMasks:l,validPixelCount:n,maskIsAlpha:this.maskIsAlpha,pixels:k.map(e=>t[e]),statistics:p&&k.map(e=>p[e])})}clone(){const k=new P({width:this.width,height:this.height,
pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&(k.mask=new Uint8Array(this.mask));this.bandMasks&&(k.bandMasks=this.bandMasks.map(l=>new Uint8Array(l)));let t;const p=P.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){k.pixels=[];const l=!!this.pixels[0].slice;for(t=0;t<this.pixels.length;t++)k.pixels[t]=l?this.pixels[t].slice():new p(this.pixels[t])}if(this.statistics)for(k.statistics=[],t=0;t<this.statistics.length;t++)k.statistics[t]=
N.clone(this.statistics[t]);k.premultiplyAlpha=this.premultiplyAlpha;return k}_fillFrom8Bit(k){const {mask:t,maskIsAlpha:p,premultiplyAlpha:l,pixels:g}=this;if(k&&g?.length){var y,f;var n=y=f=g[0];3<=g.length?(y=g[1],f=g[2]):2===g.length&&(y=g[1]);var a=new Uint32Array(k),d=this.width*this.height;if(n.length!==d)z.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=t&&t.length===d)if(p)for(k=0;k<d;k++){const e=t[k];if(e){const h=e/255;a[k]=l?
e<<24|f[k]*h<<16|y[k]*h<<8|n[k]*h:e<<24|f[k]<<16|y[k]<<8|n[k]}}else for(k=0;k<d;k++)t[k]&&(a[k]=-16777216|f[k]<<16|y[k]<<8|n[k]);else for(k=0;k<d;k++)a[k]=-16777216|f[k]<<16|y[k]<<8|n[k]}else z.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(k){const {pixels:t,mask:p,statistics:l}=this;if(k&&t?.length){var g=this.pixelType,y=1,f=0;y=1;if(l&&0<l.length){for(var n of l)null!=n.minValue&&(f=Math.min(f,n.minValue)),null!=n.maxValue&&null!=
n.minValue&&(y=Math.max(y,n.maxValue-n.minValue));y=255/y}else y=255,"s8"===g?(f=-128,y=127):"u16"===g?y=65535:"s16"===g?(f=-32768,y=32767):"u32"===g?y=4294967295:"s32"===g?(f=-2147483648,y=2147483647):"f32"===g?(f=-3.4*1E39,y=3.4*1E39):"f64"===g&&(f=-Number.MAX_VALUE,y=Number.MAX_VALUE),y=255/(y-f);k=new Uint32Array(k);g=this.width*this.height;var a,d,e;n=a=d=t[0];if(n.length!==g)return z.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=t.length)if(a=
t[1],3<=t.length&&(d=t[2]),null!=p&&p.length===g)for(e=0;e<g;e++)p[e]&&(k[e]=-16777216|(d[e]-f)*y<<16|(a[e]-f)*y<<8|(n[e]-f)*y);else for(e=0;e<g;e++)k[e]=-16777216|(d[e]-f)*y<<16|(a[e]-f)*y<<8|(n[e]-f)*y;else if(null!=p&&p.length===g)for(e=0;e<g;e++)a=(n[e]-f)*y,p[e]&&(k[e]=-16777216|a<<16|a<<8|a);else for(e=0;e<g;e++)a=(n[e]-f)*y,k[e]=-16777216|a<<16|a<<8|a}else z.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(k){const {pixels:t,mask:p}=
this;if(!k||!t?.length)return z.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let l,g,y,f;l=g=y=t[0];3<=t.length?(g=t[1],y=t[2]):2===t.length&&(g=t[1]);const n=this.width*this.height;if(l.length!==n)return z.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=p&&p.length===n)for(f=0;f<n;f++)k[a++]=l[f],k[a++]=g[f],k[a++]=y[f],k[a++]=p[f]&1;else for(f=0;f<n;f++)k[a++]=l[f],k[a++]=
g[f],k[a++]=y[f],k[a++]=1}};B.__decorate([Q.property({json:{write:!0}})],M.prototype,"width",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"height",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"pixelType",void 0);B.__decorate([T.cast("pixelType")],M.prototype,"castPixelType",null);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"validPixelCount",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"mask",void 0);B.__decorate([Q.property({json:{write:!0}})],
M.prototype,"maskIsAlpha",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"pixels",void 0);B.__decorate([Q.property()],M.prototype,"premultiplyAlpha",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"statistics",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"depthCount",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"noDataValues",void 0);B.__decorate([Q.property({json:{write:!0}})],M.prototype,"bandMasks",void 0);return M=P=B.__decorate([Z.subclass("esri.layers.support.PixelBlock")],
M)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(B){class F{constructor(M=null,N=null,z=null){this.minValue=M;this.maxValue=N;this.noDataValue=z}}B.SimpleBandStatistics=F;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(B){function F(z){return N[z]??[-3.4028234663852886E38,3.4028234663852886E38]}function M(z){return(z?.startsWith("s")||z?.startsWith("u"))??
!1}const N={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};B.clipBandToPixelTypeRange=function(z,Q,T,Z){let [H,S]=F(T);var P=M(T);P&&(H-=1E-5,S+=1E-5);if(P)if(T.startsWith("u")){const [k,t]=[H,S];for(T=0;T<Q.length;T++)Q[T]&&(P=z[T],P<k||P>t?Q[T]=0:Z[T]=P+.5<<0)}else{const [k,t]=[H,
S];for(T=0;T<Q.length;T++)Q[T]&&(P=z[T],P<k||P>t?Q[T]=0:Z[T]=P+(0<P?.5:-.5)<<0)}else{const [k,t]=[H,S];for(T=0;T<Q.length;T++)Q[T]&&(P=z[T],P<k||P>t?Q[T]=0:Z[T]=P)}};B.convertNoDataToMask=function(z,Q,T){if(!(z.depthCount&&1<z.depthCount)){var {pixels:Z,statistics:H,pixelType:S}=z,P=Z[0].length,k=z.bandMasks??[];P=z.mask??(new Uint8Array(P)).fill(255);var t="f32"===S||"f64"===S,p=F(S),l=!1;for(let f=0;f<Z.length;f++){const n="number"===typeof Q?Q:Q[f];if(null==n)continue;var g=H?.[f]?.maxValue??p[1];
if((H?.[f]?.minValue??p[0])>n+Number.EPSILON||g<n-Number.EPSILON)continue;g=k[f]||P.slice();const a=Z[f];var y=T?.customFloatTolerance;if(t&&0!==y){y||=9.999999E37<=Math.abs(n)?2E-7*Math.abs(n):"f32"===S?2**-23:Number.EPSILON;for(let d=0;d<a.length;d++)g[d]&&Math.abs(a[d]-n)<y&&(a[d]=0,g[d]=0,P[d]=0,l=!0)}else for(y=0;y<a.length;y++)g[y]&&a[y]===n&&(a[y]=0,g[y]=0,P[y]=0,l=!0);k[f]=g}l&&(z.bandMasks=z.bandMasks||1<z.pixels.length?k:null,z.mask=P);l&&"updateStatistics"in z&&z.updateStatistics()}};B.fixNaN=
function(z,Q){for(let T=0;T<Q.length;T++)Q[T]&&isNaN(z[T])&&(Q[T]=0,z[T]=0)};B.getIntegerPixelType=function(z,Q){return null==z||null==Q?"s32":0>z?-128<=z&&128>Q?"s8":-32768<=z&&32768>Q?"s16":"s32":256>Q?"u8":65536>Q?"u16":"u32"};B.getPixelValueRange=F;B.isIntegerPixelType=M;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(B,F,M){function N(a){return null!=
a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function z(a,d,e,h,b){const c=a.length;b=F.createEmptyBand(b,c);if(d)for(let q=0;q<c;q++)d[q]&&(b[q]=e[a[q]-h]);else for(d=0;d<c;d++)b[d]=e[a[d]-h];return b}function Q(a,d,e,h){const b=null!=e&&2<=e.length?new Set(e):null;e=1===e?.length?e[0]:null;const c=!!d?.length;for(let q=0;q<a.length;q++)if(h[q]){const v=a[q];if(c){let A=!1;for(let m=0;m<d.length;m+=2)if(v>=d[m]&&v<=d[m+1]){A=!0;break}A||(h[q]=0)}h[q]&&(v===e||
b?.has(v))&&(h[q]=0)}}function T(a,d){const e=a[0].length;for(let h=0;h<e;h++)if(d[h]){let b=!1;for(let c=0;c<a.length;c++)if(a[c][h]){b=!0;break}b||(d[h]=0)}}function Z(a,d){const e=a[0].length;for(let h=0;h<e;h++)if(d[h]){let b=!1;for(let c=0;c<a.length;c++)if(0===a[c][h]){b=!0;break}b&&(d[h]=0)}}function H(a,d,e,h,b,c,q,v){return{xmin:b<=e*a?0:b<e*a+a?b-e*a:a,ymin:c<=h*d?0:c<h*d+d?c-h*d:d,xmax:b+q<=e*a?0:b+q<e*a+a?b+q-e*a:a,ymax:c+v<=h*d?0:c+v<h*d+d?c+v-h*d:d}}function S(a,d,e,h,b,c){const {width:q,
height:v}=e.block,{x:A,y:m}=e.offset,{width:r,height:C}=e.mosaic;e=H(q,v,h,b,A,m,r,C);let E=0;var I=0;if(c){var D=c.hasGCSSShiftTransform?360:c.halfWorldWidth??0,J=q*c.resolutionX;const u=c.startX+h*J;u<D&&u+J>D?I=c.rightPadding:u>=D&&(E=c.leftMargin-c.rightPadding,I=0)}e.xmax-=I;if("number"===typeof d)for(c=e.ymin;c<e.ymax;c++)for(I=(b*v+c-m)*r+(h*q-A)+E,D=e.xmin;D<e.xmax;D++)a[I+D]=d;else for(c=e.ymin;c<e.ymax;c++)for(I=(b*v+c-m)*r+(h*q-A)+E,D=c*q,J=e.xmin;J<e.xmax;J++)a[I+J]=d[D+J]}function P(a,
d,e={}){const {clipOffset:h,clipSize:b,alignmentInfo:c,blockWidths:q}=e;if(q)return k(a,d,{blockWidths:q});var v=a.find(R=>N(R));if(null==v)return null;e=b?b.width:d.width;const A=b?b.height:d.height;var m=v.width,r=v.height;const C=d.width/m,E=d.height/r;d={offset:h||{x:0,y:0},mosaic:b||d,block:{width:m,height:r}};m=v.pixelType;var I=F.getPixelArrayConstructor(m);v=v.pixels.length;r=[];for(var D=0;D<v;D++){var J=new I(e*A);for(var u=0;u<E;u++)for(var x=0;x<C;x++){var K=a[u*C+x];N(K)&&(K=K.pixels[D],
S(J,K,d,x,u,c))}r.push(J)}I=a.some(R=>null==R||null!=R.mask&&0<R.mask.length);J=a.some(R=>R?.bandMasks&&1<R.bandMasks.length);I=I?new Uint8Array(e*A):void 0;J=J?[]:void 0;if(I){for(D=0;D<E;D++)for(u=0;u<C;u++)x=a[D*C+u],K=null!=x?x.mask:null,null!=K?S(I,K,d,u,D,c):x?S(I,255,d,u,D,c):S(I,0,d,u,D,c);if(J)for(D=0;D<v;D++){u=new Uint8Array(e*A);for(x=0;x<E;x++)for(K=0;K<C;K++){const R=a[x*C+K],V=R?.bandMasks?.[D]??R?.mask;null!=V?S(u,V,d,K,x,c):R?S(u,255,d,K,x,c):S(u,0,d,K,x,c)}J.push(u)}}a=new F({width:e,
height:A,pixels:r,pixelType:m,bandMasks:J,mask:I});a.updateStatistics();return a}function k(a,d,e){const h=a.find(u=>null!=u);if(null==h)return null;var b=a.some(u=>null!=u?!!u.mask:!0);const {width:c,height:q}=d;d=b?new Uint8Array(c*q):null;({blockWidths:e}=e);const v=[],A=h.getPlaneCount(),m=F.getPixelArrayConstructor(h.pixelType);if(b)for(let u=0,x=0;u<a.length;x+=e[u],u++)if(b=a[u],N(b)){var r=b.mask;for(var C=0;C<q;C++)for(var E=0;E<e[u];E++)d[C*c+E+x]=null==r?255:r[C*b.width+E]}r=(b=a.some(u=>
u?.bandMasks&&1<u.bandMasks.length))?[]:void 0;C=c*q;for(E=0;E<A;E++){const u=new m(C),x=b?new Uint8Array(C):void 0;for(let K=0,R=0;K<a.length;R+=e[K],K++){const V=a[K];if(N(V)){var I=V.pixels[E];if(null!=I){for(var D=0;D<q;D++)for(var J=0;J<e[K];J++)u[D*c+J+R]=I[D*V.width+J];if(x)for(I=V.bandMasks?.[E]??V.mask,D=0;D<q;D++)for(J=0;J<e[K];J++)x[D*c+J+R]=I?I[D*V.width+J]:255}}}v.push(u);r&&x&&r.push(x)}a=new F({width:c,height:q,mask:d,bandMasks:r,pixels:v,pixelType:h.pixelType});a.updateStatistics();
return a}function t(a){if(!N(a))return null;const d=a.clone(),{width:e,height:h,pixels:b}=a;var c=b[0];const q=d.pixels[0];a=a.mask;for(let m=2;m<h-1;m++){const r=new Map;for(var v=m-2;v<m+2;v++)for(var A=0;4>A;A++){const C=v*e+A;g(r,c[C],a?a[C]:1)}q[m*e]=p(r);q[m*e+1]=q[m*e+2]=q[m*e];for(v=3;v<e-1;v++)A=(m-2)*e+v+1,g(r,c[A],a?a[A]:1),A=(m-1)*e+v+1,g(r,c[A],a?a[A]:1),A=m*e+v+1,g(r,c[A],a?a[A]:1),A=(m+1)*e+v+1,g(r,c[A],a?a[A]:1),A=(m-2)*e+v-3,l(r,c[A],a?a[A]:1),A=(m-1)*e+v-3,l(r,c[A],a?a[A]:1),A=m*
e+v-3,l(r,c[A],a?a[A]:1),A=(m+1)*e+v-3,l(r,c[A],a?a[A]:1),q[m*e+v]=p(r);q[m*e+v+1]=q[m*e+v]}for(c=0;c<e;c++)q[c]=q[e+c]=q[2*e+c],q[(h-1)*e+c]=q[(h-2)*e+c];d.updateStatistics();return d}function p(a){if(0===a.size)return 0;let d=0,e=-1,h=0;const b=a.keys();let c=b.next();for(;!c.done;)h=a.get(c.value),h>d&&(e=c.value,d=h),c=b.next();return e}function l(a,d,e){0!==e&&(e=a.get(d),1===e?a.delete(d):a.set(d,e-1))}function g(a,d,e){0!==e&&a.set(d,a.has(d)?a.get(d)+1:1)}function y(a,d,e){let {x:h,y:b}=d;
const {width:c,height:q}=e;if(0===h&&0===b&&q===a.height&&c===a.width)return a;const {width:v,height:A}=a;d=Math.max(0,b);const m=Math.max(0,h),r=Math.min(h+c,v),C=Math.min(b+q,A);if(0>r||0>C||!N(a))return null;h=Math.max(0,-h);b=Math.max(0,-b);var {pixels:E}=a,I=c*q,D=E.length;const J=[];for(var u=0;u<D;u++){var x=E[u],K=F.createEmptyBand(a.pixelType,I);for(let R=d;R<C;R++){const V=R*v;let W=(R+b-d)*c+h;for(let U=m;U<r;U++)K[W++]=x[V+U]}J.push(K)}E=new Uint8Array(I);I=a.mask;for(D=d;D<C;D++)for(u=
D*v,x=(D+b-d)*c+h,K=m;K<r;K++)E[x++]=I?I[u+K]:1;a=new F({width:e.width,height:e.height,pixelType:a.pixelType,pixels:J,mask:E});a.updateStatistics();return a}function f(a,d=!0){if(!N(a))return null;const {pixels:e,width:h,height:b,mask:c,pixelType:q}=a;a=[];const v=Math.round(h/2),A=Math.round(b/2),m=b-1,r=h-1;for(var C=0;C<e.length;C++){var E=e[C],I=F.createEmptyBand(q,v*A),D=0;for(var J=0;J<b;J+=2)for(var u=0;u<h;u+=2){var x=E[J*h+u];if(d){var K=u===r?x:E[J*h+u+1];const R=J===m?x:E[J*h+u+h],V=u===
r?R:J===m?K:E[J*h+u+h+1];I[D++]=(x+K+R+V)/4}else I[D++]=x}a.push(I)}C=null;if(null!=c)for(C=new Uint8Array(v*A),E=0,I=0;I<b;I+=2)for(D=0;D<h;D+=2)J=c[I*h+D],d?(u=D===r?J:c[I*h+D+1],x=I===m?J:c[I*h+D+h],K=D===r?x:I===m?u:c[I*h+D+h+1],C[E++]=J*u*x*K?1:0):C[E++]=J;return new F({width:v,height:A,pixelType:q,pixels:a,mask:C})}function n(a,d,e,h,b=0){const {width:c,height:q}=a,{width:v,height:A}=d;a=h.cols;h=h.rows;d=Math.ceil(v/a-.1/a);const m=Math.ceil(A/h-.1/h);let r,C,E,I,D;const J=d*a;var u=J*m*h;
const x=new Float32Array(u),K=new Float32Array(u),R=new Uint32Array(u),V=new Uint32Array(u);let W=0,U,L;for(let aa=0;aa<m;aa++)for(let ba=0;ba<d;ba++){var O=12*(aa*d+ba);u=e[O];r=e[O+1];C=e[O+2];E=e[O+3];I=e[O+4];D=e[O+5];for(var X=0;X<h;X++){W=(aa*h+X)*J+ba*a;L=(X+.5)/h;for(let fa=0;fa<X;fa++)U=(fa+.5)/a,x[W+fa]=(u*U+r*L+C)*c+b,K[W+fa]=(E*U+I*L+D)*q+b,R[W+fa]=Math.floor(x[W+fa]),V[W+fa]=Math.floor(K[W+fa])}O+=6;u=e[O];r=e[O+1];C=e[O+2];E=e[O+3];I=e[O+4];D=e[O+5];for(O=0;O<h;O++)for(W=(aa*h+O)*J+
ba*a,L=(O+.5)/h,X=O;X<a;X++)U=(X+.5)/a,x[W+X]=(u*U+r*L+C)*c+b,K[W+X]=(E*U+I*L+D)*q+b,R[W+X]=Math.floor(x[W+X]),V[W+X]=Math.floor(K[W+X])}return{offsets_x:x,offsets_y:K,offsets_xi:R,offsets_yi:V,gridWidth:J}}B.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(B.NoDataInterpretation||(B.NoDataInterpretation={}));B.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(B.MissingBandAction||(B.MissingBandAction={}));B.approximateTransform=
function(a,d,e,h,b="nearest"){if(!N(a))return null;"majority"===b&&(a=t(a));const {pixels:c,mask:q,bandMasks:v,pixelType:A}=a,m=a.width;var r=a.height;const C=F.getPixelArrayConstructor(A),E=c.length,{width:I,height:D}=d;a=!1;for(var J=0;J<e.length;J+=3)-1===e[J]&&-1===e[J+1]&&-1===e[J+2]&&(a=!0);const {offsets_x:u,offsets_y:x,offsets_xi:K,offsets_yi:R,gridWidth:V}=n({width:m,height:r},d,e,h,"majority"===b?.5:0);let W;d=(L,O,X,aa)=>{const ba=L instanceof Float32Array||L instanceof Float64Array?0:
.5;for(let fa=0;fa<D;fa++){W=fa*V;for(let ca=0;ca<I;ca++){if(0>u[W]||0>x[W])L[fa*I+ca]=0;else if(aa)L[fa*I+ca]=O[K[W]+R[W]*m];else{const ka=Math.floor(u[W]),la=Math.floor(x[W]),na=Math.ceil(u[W]),ea=Math.ceil(x[W]),ia=u[W]-ka,w=x[W]-la;L[fa*I+ca]=!X||X[ka+la*m]&&X[na+la*m]&&X[ka+ea*m]&&X[na+ea*m]?(1-w)*((1-ia)*O[ka+la*m]+ia*O[na+la*m])+w*((1-ia)*O[ka+ea*m]+ia*O[na+ea*m])+ba:O[K[W]+R[W]*m]}W++}}};e=[];h=v?.length===E;r=[];for(J=0;J<E;J++){if(h){var U=new Uint8Array(I*D);d(U,v[J],v[J],!0);r.push(U)}U=
new C(I*D);d(U,c[J],h?v[J]:q,"nearest"===b||"majority"===b);e.push(U)}b=new F({width:I,height:D,pixelType:A,pixels:e,bandMasks:h?r:void 0});if(null!=q)b.mask=new Uint8Array(I*D),d(b.mask,q,q,!0);else if(a)for(b.mask=new Uint8Array(I*D),a=0;a<I*D;a++)b.mask[a]=0>u[a]||0>x[a]?0:1;b.updateStatistics();return b};B.clip=y;B.clipTile=function(a){const {pixelBlock:d,tileSize:e,level:h,row:b,col:c,useBilinear:q}=a;if(!N(d))return null;const {width:v,height:A}=e;var m=2**h;a=m*v;m*=A;a=y(d,{y:b*m,x:c*a},{width:a,
height:m});if(!a)return null;for(m=h;0<m;m--)a=f(a,q);return a};B.colorize=function(a,d){if(!N(a)||!d||!d.indexedColormap&&!d.indexed2DColormap)return a;const e=a.clone();var h=e.pixels;let b=e.mask;const c=e.width*e.height;if(1!==h.length)return a;const {indexedColormap:q,indexed2DColormap:v,offset:A,alphaSpecified:m}=d;a=0;h=h[0];d=new Uint8Array(h.length);const r=new Uint8Array(h.length),C=new Uint8Array(h.length);var E=0;if(q){const I=q.length-1;if(null!=b)for(a=0;a<c;a++)b[a]&&(E=4*(h[a]-A),
E<A||E>I?b[a]=0:(d[a]=q[E],r[a]=q[E+1],C[a]=q[E+2],b[a]=q[E+3]));else{b=new Uint8Array(c);for(a=0;a<c;a++)E=4*(h[a]-A),E<A||E>I?b[a]=0:(d[a]=q[E],r[a]=q[E+1],C[a]=q[E+2],b[a]=q[E+3]);e.mask=b}}else if(v)if(null!=b)for(a=0;a<c;a++)b[a]&&(E=v[h[a]],d[a]=E[0],r[a]=E[1],C[a]=E[2],b[a]=E[3]);else{b=new Uint8Array(c);for(a=0;a<c;a++)E=v[h[a]],d[a]=E[0],r[a]=E[1],C[a]=E[2],b[a]=E[3];e.mask=b}e.pixels=[d,r,C];e.statistics=null;e.pixelType="u8";e.maskIsAlpha=m;return e};B.compositeBands=function(a){if(!a?.length||
a.some(A=>!N(A)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:d,height:e,pixelType:h}=a[0];if(a.some(A=>A.width!==d||A.height!==e))return null;const b=a.map(({mask:A})=>A).filter(A=>null!=A);let c=null;b.length&&(c=new Uint8Array(d*e),c.set(b[0]),1<b.length&&Z(b.slice(1),c));const q=[];a.forEach(({pixels:A})=>q.push(...A));const v=[];a.map(({statistics:A})=>A).filter(A=>A?.length).forEach(A=>v.push(...A));return new F({pixelType:h,width:d,height:e,mask:c,pixels:q,statistics:v.length?
v:null})};B.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){d=d.sort((m,r)=>m[0]-r[0]);var e=0;0>d[0][0]&&(e=d[0][0]);var h=Math.max(256,d[d.length-1][0]-e+1),b=new Uint8Array(4*h),c=[],q=0,v=0,A=5===d[0].length;if(65536<h)return d.forEach(m=>{c[m[0]-e]=A?m.slice(1):m.slice(1).concat([255])}),{indexed2DColormap:c,offset:e,alphaSpecified:A};if(a.fillUnspecified)for(a=d[v],q=a[0]-e;q<h;q++)b[4*q]=a[1],b[4*q+1]=a[2],b[4*q+2]=a[3],b[4*q+3]=A?a[4]:255,q===a[0]-e&&(a=v===d.length-
1?a:d[++v]);else for(q=0;q<d.length;q++)a=d[q],v=4*(a[0]-e),b[v]=a[1],b[v+1]=a[2],b[v+2]=a[3],b[v+3]=A?a[4]:255;return{indexedColormap:b,offset:e,alphaSpecified:A}}}};B.createMaskLUT=function(a,d,e){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var h=a.includes("16")?65536:256;a=a.includes("s")?-h/2:0;h=new Uint8Array(h);if(d)for(let c=0;c<d.length;c++){var b=Math.ceil(d[2*c]-a);const q=Math.floor(d[2*c+1]-a);for(;b<=q;b++)h[b]=255}else h.fill(255);if(e)for(d=0;d<e.length;d++)h[e[d]-a]=
0;return{lut:h,offset:a}};B.createRemapLUT=function(a){const {srcPixelType:d,inputRanges:e,outputValues:h,allowUnmatched:b,noDataRanges:c,isLastInputRangeInclusive:q,outputPixelType:v}=a;if("u8"!==d&&"s8"!==d&&"u16"!==d&&"s16"!==d)return null;var A=d.includes("16")?65536:256;a=d.includes("s")?-A/2:0;const m=F.createEmptyBand(v,A);A=new Uint8Array(A);b&&A.fill(255);const [r,C]=M.getPixelValueRange(v);if(e?.length&&h?.length){var E=e.map(u=>u-1E-6);E[0]=e[0];q&&(E[E.length-1]=e[e.length-1]);for(var I=
0;I<E.length;I++){var D=h[I]>C?C:h[I]<r?r:h[I],J=Math.ceil(E[2*I]-a);const u=Math.floor(E[2*I+1]-a);for(;J<=u;J++)m[J]=D,A[J]=255}}if(c?.length)for(E=0;E<c.length;E++)for(D=Math.ceil(c[2*E]-a),I=Math.floor(c[2*E+1]-a);D<=I;D++)A[D]=0;return{lut:m,offset:a,mask:A}};B.extractBands=function(a,d){return d?.length&&N(a)?a.extractBands(d):a};B.getClipBounds=H;B.getLocalArithmeticNorthRotations=function(a,d){const {coefficients:e,spacing:h}=d,{offsets_x:b,offsets_y:c,gridWidth:q}=n(a,a,e,{rows:h[0],cols:h[1]}),
{width:v,height:A}=a;a=new Float32Array(v*A);d=180/Math.PI;for(let C=0;C<A;C++)for(let E=0;E<v;E++){var m=C*q+E,r=0===C?m:m-q;const I=C===A-1?m:m+q;m=b[r]-b[I];r=c[I]-c[r];isNaN(m)||isNaN(r)?a[C*v+E]=90:(r=Math.atan2(r,m)*d,r=(360+r)%360,a[C*v+E]=r)}return a};B.interpolateOffsets=n;B.isValidPixelBlock=N;B.lookupBandValues=z;B.lookupPixels=function(a,d){if(!N(a))return null;const {pixels:e,mask:h}=a,b=e.length;let c=d.lut;const {offset:q}=d;c&&1===c[0].length&&(c=e.map(()=>c));const v=[];d=d.outputPixelType||
"u8";for(let A=0;A<b;A++){const m=z(e[A],h,c[A],q||0,d);v.push(m)}a=new F({width:a.width,height:a.height,pixels:v,mask:h,pixelType:d});a.updateStatistics();return a};B.mask=function(a,d){if(!N(a))return null;const {width:e,height:h,pixels:b}=a;var c=e*h;const q=new Uint8Array(c);a.mask?q.set(a.mask):q.fill(255);a=b.length;const {includedRanges:v,noDataValues:A,outputPixelType:m,matchAll:r,lookups:C}=d;if(C){c=[];for(d=0;d<a;d++){var E=C[d];E=z(b[d],q,E.lut,E.offset||0,"u8");c.push(E)}1===c.length?
q.set(c[0]):r?T(c,q):Z(c,q)}else if(r){d=[];for(E=0;E<a;E++){const I=new Uint8Array(c);I.set(q);Q(b[E],v?.slice(2*E,2*E+2),A?.[E],I);d.push(I)}1===d.length?q.set(d[0]):T(d,q)}else for(c=0;c<a;c++)Q(b[c],v?.slice(2*c,2*c+2),A?.[c],q);return new F({width:e,height:h,pixelType:m,pixels:b,mask:q})};B.maxMapSizeGpu=6;B.mosaic=P;B.mosaicPixelData=function(a,d){if(!a||0===a.length)return null;var e=a.find(C=>C.pixelBlock);if(null==e?.pixelBlock)return null;var h=(e.extent.xmax-e.extent.xmin)/e.pixelBlock.width;
const b=(e.extent.ymax-e.extent.ymin)/e.pixelBlock.height,c=.01*Math.min(h,b),q=a.sort((C,E)=>Math.abs(C.extent.ymax-E.extent.ymax)>c?E.extent.ymax-C.extent.ymax:Math.abs(C.extent.xmin-E.extent.xmin)>c?C.extent.xmin-E.extent.xmin:0);var v=Math.min.apply(null,q.map(C=>C.extent.xmin));const A=Math.min.apply(null,q.map(C=>C.extent.ymin)),m=Math.max.apply(null,q.map(C=>C.extent.xmax)),r=Math.max.apply(null,q.map(C=>C.extent.ymax));a={x:Math.round((d.xmin-v)/h),y:Math.round((r-d.ymax)/b)};v={width:Math.round((m-
v)/h),height:Math.round((r-A)/b)};h={width:Math.round((d.xmax-d.xmin)/h),height:Math.round((d.ymax-d.ymin)/b)};if(Math.round(v.width/e.pixelBlock.width)*Math.round(v.height/e.pixelBlock.height)!==q.length||0>a.x||0>a.y||v.width<h.width||v.height<h.height)return null;e=q.map(C=>C.pixelBlock);e=P(e,v,{clipOffset:a,clipSize:h});return{extent:d,pixelBlock:e}};B.remap=function(a,d){if(!N(a))return null;const {width:e,height:h}=a,{inputRanges:b,outputValues:c,outputPixelType:q,noDataRanges:v,allowUnmatched:A,
isLastInputRangeInclusive:m}=d;d=a.pixels[0];const r=F.createEmptyBand(q,d.length),C=a.mask,E=new Uint8Array(e*h);C?E.set(C):E.fill(255);const I=a.pixelType.startsWith("f")?1E-6:0;a=b.map(W=>W-I);a[0]=b[0];a[a.length-1]=b[b.length-1]+(m?1E-6:0);var D=b.length/2;const [J,u]=M.getPixelValueRange(q);for(var x=0;x<h;x++)for(var K=0;K<e;K++){var R=x*e+K;if(E[R]){var V=d[R];let W=!1;for(let U=D-1;0<=U;U--)if(V===a[2*U]||V>a[2*U]&&V<a[2*U+1]){r[R]=c[U];W=!0;break}W||(A?r[R]=V>u?u:V<J?J:V:E[R]=0)}}if(a=v?.length)for(D=
0;D<h;D++)for(x=0;x<e;x++)if(K=D*e+x,!C||C[K])for(R=d[K],V=0;V<a;V+=2)if(R>=v[V]&&R<=v[V+1]){r[K]=0;E[K]=0;break}return new F({width:e,height:h,pixelType:q,pixels:[r],mask:E})};B.remapColor=function(a,d){if(!N(a))return null;a=a.clone();var {pixels:e}=a;const h=a.width*a.height,b=d.length,c=Math.floor(b/2),q=d[Math.floor(c)];e=e[0];let v,A,m,r,C,E,I=!1;const D=new Uint8Array(h),J=new Uint8Array(h),u=new Uint8Array(h);let x=a.mask;const K=4===d[0].mappedColor.length;x||(x=new Uint8Array(h),x.fill(K?
255:1),a.mask=x);for(C=0;C<h;C++)if(x[C]){v=e[C];I=!1;E=c;A=q;m=0;for(r=b-1;1<r-m;){if(v===A.value){I=!0;break}v>A.value?m=E:r=E;E=Math.floor((m+r)/2);A=d[Math.floor(E)]}I||(v===d[m].value?(A=d[m],I=!0):v===d[r].value?(A=d[r],I=!0):v<d[m].value?(I=!1,A=null):v>d[m].value&&(v<d[r].value?(A=d[m],I=!0):r===b-1?(I=!1,A=null):(A=d[r],I=!0)));I?(D[C]=A.mappedColor[0],J[C]=A.mappedColor[1],u[C]=A.mappedColor[2],x[C]=A.mappedColor[3]):D[C]=J[C]=u[C]=x[C]=0}a.pixels=[D,J,u];a.mask=x;a.pixelType="u8";a.maskIsAlpha=
K;return a};B.resampleByMajority=t;B.setValidBoundary=function(a,d,e){if(!N(a))return null;const {width:h,height:b}=a,c=d.x;d=d.y;const q=e.width+c;e=e.height+d;if(0>c||0>d||q>h||e>b||0===c&&0===d&&q===h&&e===b)return a;a.mask||(a.mask=new Uint8Array(h*b));const v=a.mask;for(let A=0;A<b;A++){const m=A*h;for(let r=0;r<h;r++)v[m+r]=A<d||A>=e||r<c||r>=q?0:1}a.updateStatistics();return a};B.split=function(a,d,e=0,h=!0){if(!N(a))return null;const {width:b,height:c}=d;let {width:q,height:v}=a;const A=new Map,
m={x:0,y:0};e=1+e;for(let r=0;r<e;r++){const C=Math.ceil(q/b),E=Math.ceil(v/c);for(let I=0;I<E;I++){m.y=I*c;for(let D=0;D<C;D++){m.x=D*b;const J=y(a,m,d);A.set(`${r}/${I}/${D}`,J)}}r<e-1&&(a=f(a,h));q=Math.round(q/2);v=Math.round(v/2)}return A};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k){function t(b){b=b.symbolLayers;if(!b)return null;let c=null;b.forEach(q=>{"object"===q.type&&q.resource?.href||(c="water"===q.type?q.color:q.material?q.material.color:null)});return c?new M(c):null}function p(b,c){if(null==c||null==b)return b;b=b.toRgba();b[3]*=c;return new M(b)}function l(b,c,q){if(b=b.symbolLayers){var v=A=>{c=c??A??(null!=q?h:null);return p(c,q)};b.forEach(A=>{if("object"!==A.type||!A.resource?.href||c)if("water"===A.type)A.color=v(A.color);else{const m=
v(null!=A.material?A.material.color:null);null==A.material?A.material=new k.Symbol3DMaterial({color:m}):A.material.color=m;null!=q&&"outline"in A&&null!=A.outline?.color&&(A.outline.color=p(A.outline.color,q))}})}}async function g(b,c){(b=b.symbolLayers)&&await z.forEach(b,async q=>y(q,c))}async function y(b,c){switch(b.type){case "extrude":b.size="number"===typeof c[2]?c[2]:0;break;case "icon":case "line":case "text":c=f(c);null!=c&&(b.size=c);break;case "path":const q=a(c,Z.ONES,[b.width,void 0,
b.height]);b.width=e(c[0],b.width,1,q);b.height=e(c[2],b.height,1,q);break;case "object":await n(b,c)}}function f(b){for(const c of b)if("number"===typeof c)return c;return null}async function n(b,c){const {resourceSize:q,symbolSize:v}=await d(b),A=a(c,q,v);b.width=e(c[0],v[0],q[0],A);b.depth=e(c[1],v[1],q[1],A);b.height=e(c[2],v[2],q[2],A)}function a(b,c,q){for(let v=0;3>v;v++){const A=b[v];switch(A){case "symbol-value":return b=q[v],null!=b?b/c[v]:1;case "proportional":break;default:if(A&&c[v])return A/
c[v]}}return 1}async function d(b){var {computeObjectLayerResourceSize:c}=await new Promise((C,E)=>B(["./symbolLayerUtils"],C,E));c=await c(b,10);const {width:q,height:v,depth:A}=b;b=[q,A,v];let m=1;for(var r=0;3>r;r++){const C=b[r];if(null!=C){m=C/c[r];break}}for(r=0;3>r;r++)null==b[r]&&(b[r]=c[r]*m);return{resourceSize:c,symbolSize:b}}function e(b,c,q,v){switch(b){case "proportional":return q*v;case "symbol-value":return null!=c?c:q;default:return b}}const h=new M("white");F.applyColorToSymbol=
function(b,c,q){if(b&&(c||null!=q))if(c&&=new M(c),N.isSymbol3D(b))l(b,c,q);else if(N.isSymbol2D(b)){if(c=c??b.color)b.color=p(c,q);null!=q&&"outline"in b&&b.outline?.color&&(b.outline.color=p(b.outline.color,q))}};F.applyOpacityToColor=p;F.applyRotationToSymbol=function(b,c,q){b&&null!=c&&(N.isSymbol3D(b)?(b=b.symbolLayers)&&b.forEach(v=>{if("object"===v.type)switch(q){case "tilt":v.tilt=(v.tilt??0)+c;break;case "roll":v.roll=(v.roll??0)+c;break;default:v.heading=(v.heading??0)+c}"icon"===v.type&&
(v.angle+=c)}):!N.isSymbol2D(b)||"simple-marker"!==b.type&&"picture-marker"!==b.type&&"text"!==b.type||(b.angle+=c))};F.applySizesToSymbol=async function(b,c){if(b&&c){if(N.isSymbol3D(b))return g(b,c);if(N.isSymbol2D(b)&&(c=f(c),null!=c))switch(b.type){case "simple-marker":b.size=c;break;case "picture-marker":const q=b.width/b.height;1<q?(b.width=c,b.height=c*q):(b.width=c*q,b.height=c);break;case "simple-line":b.width=c;break;case "text":b.font.size=c}}};F.fetchWebStyleSymbol=async function(b,c){const q=
await b.fetchSymbol(c);return q?q:b.fetchCIMSymbol(c)};F.getCSSFilterFromEffectList=function(b){if(!b)return null;b=b.effects.filter(c=>"bloom"!==c.type).map(c=>c.toJSON());return H.effectFunctionsFromJSON(b)};F.getColorFromSymbol=function(b,c){if(!b)return null;let q=null;N.isSymbol3D(b)?q=t(b):N.isSymbol2D(b)&&(q="cim"===b.type?S.getCIMSymbolColor(b):b.color?new M(b.color):null);return q?p(q,c):null};F.getIconHref=function(b){return b.resource?.href??""};F.getSymbolOutlineSize=function(b){return b?
N.isSymbol3D(b)?(b=(b=b.symbolLayers?.at(-1))&&"outline"in b?b?.outline?.size:void 0,null!=b?b:0):T.px2pt(P.getStroke(b)?.width):0};F.isVolumetricSymbol=function(b){if(null==b||!("symbolLayers"in b)||null==b.symbolLayers)return!1;switch(b.type){case "point-3d":return b.symbolLayers.some(c=>"object"===c.type);case "line-3d":return b.symbolLayers.some(c=>"path"===c.type);case "polygon-3d":return b.symbolLayers.some(c=>"object"===c.type||"extrude"===c.type);default:return!1}};F.symbolHasExtrudeSymbolLayer=
function(b){return null!=b&&"polygon-3d"===b.type&&b.symbolLayers.some(c=>"extrude"===c.type)};Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(B,F,M){function N(k){k=M.toCIMSymbolJSON(k);if("CIMTextSymbol"===k?.type)return k.height??0;let t=0;if(k?.symbolLayers)for(const p of k.symbolLayers)M.isCIMMarker(p)&&null!=p.size&&p.size>t?t=p.size:M.isCIMStroke(p)&&null!=p.width&&p.width>
t?t=p.width:M.isCIMFill(p);return t}function z(k,t,p,l){if(k)if("CIMTextSymbol"===k.type)null!=k.height&&(k.height*=t);else{if(p&&k.effects)for(const g of k.effects)Z(g,t);if(k.symbolLayers)for(const g of k.symbolLayers)switch(g.type){case "CIMPictureMarker":case "CIMVectorMarker":Q(g,t,l);break;case "CIMPictureStroke":case "CIMSolidStroke":!l?.preserveOutlineWidth&&g.width&&(g.width*=t);break;case "CIMPictureFill":g.height&&(g.height*=t);g.offsetX&&(g.offsetX*=t);g.offsetY&&(g.offsetY*=t);break;
case "CIMHatchFill":z(g.lineSymbol,t,!0,{...l,preserveOutlineWidth:!1}),g.offsetX&&(g.offsetX*=t),g.offsetY&&(g.offsetY*=t),g.separation&&(g.separation*=t)}}}function Q(k,t,p){if(k&&(k.markerPlacement&&T(k.markerPlacement,t),k.offsetX&&(k.offsetX*=t),k.offsetY&&(k.offsetY*=t),k.anchorPoint&&"Absolute"===k.anchorPointUnits&&(k.anchorPoint={x:k.anchorPoint.x*t,y:k.anchorPoint.y*t}),k.size=null!=k.size?k.size*t:0,"CIMVectorMarker"===k.type&&k.markerGraphics))for(const l of k.markerGraphics)k.scaleSymbolsProportionally||
z(l.symbol,t,!0,p)}function T(k,t){M.isCIMMarkerStrokePlacement(k)&&k.offset&&(k.offset*=t);switch(k.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":k.customEndingOffset&&(k.customEndingOffset*=t);k.offsetAlongLine&&(k.offsetAlongLine*=t);if(k.placementTemplate&&k.placementTemplate.length){var p=k.placementTemplate.map(l=>l*t);k.placementTemplate=p}break;case "CIMMarkerPlacementAlongLineVariableSize":k.maxRandomOffset&&(k.maxRandomOffset*=t);k.placementTemplate&&
k.placementTemplate.length&&(p=k.placementTemplate.map(l=>l*t),k.placementTemplate=p);break;case "CIMMarkerPlacementOnLine":k.startPointOffset&&(k.startPointOffset*=t);break;case "CIMMarkerPlacementAtExtremities":k.offsetAlongLine&&(k.offsetAlongLine*=t);break;case "CIMMarkerPlacementAtRatioPositions":k.beginPosition&&(k.beginPosition*=t);k.endPosition&&(k.endPosition*=t);break;case "CIMMarkerPlacementPolygonCenter":k.offsetX&&(k.offsetX*=t);k.offsetY&&(k.offsetY*=t);break;case "CIMMarkerPlacementInsidePolygon":k.offsetX&&
(k.offsetX*=t),k.offsetY&&(k.offsetY*=t),k.stepX&&(k.stepX*=t),k.stepY&&(k.stepY*=t)}}function Z(k,t){switch(k.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":k.width&&(k.width*=t);break;case "CIMGeometricEffectBuffer":k.size&&(k.size*=t);break;case "CIMGeometricEffectCut":k.beginCut&&(k.beginCut*=t);k.endCut&&(k.endCut*=t);k.middleCut&&(k.middleCut*=t);break;case "CIMGeometricEffectDashes":k.customEndingOffset&&(k.customEndingOffset*=t);k.offsetAlongLine&&(k.offsetAlongLine*=
t);if(k.dashTemplate&&k.dashTemplate.length){const p=k.dashTemplate.map(l=>l*t);k.dashTemplate=p}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":k.length&&(k.length*=t);break;case "CIMGeometricEffectMove":k.offsetX&&(k.offsetX*=t);k.offsetY&&(k.offsetY*=t);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":k.offset&&(k.offset*=t);break;case "CIMGeometricEffectRegularPolygon":k.radius&&(k.radius*=t);break;case "CIMGeometricEffectTaperedPolygon":k.fromWidth&&
(k.fromWidth*=t);k.length&&(k.length*=t);k.toWidth&&(k.toWidth*=t);break;case "CIMGeometricEffectWave":k.amplitude&&(k.amplitude*=t),k.period&&(k.period*=t)}}function H(k,t){if(k){var p="CIMTextSymbol"===k.type?k.symbol:k;k="CIMPolygonSymbol"===k.type;if(p?.symbolLayers)for(const l of p.symbolLayers)if(!(l.colorLocked||k&&(M.isCIMStroke(l)||M.isCIMMarker(l)&&l.markerPlacement&&M.isCIMMarkerStrokePlacement(l.markerPlacement))))switch(l.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":l.tintColor&&
S(t,l.tintColor);break;case "CIMVectorMarker":l.markerGraphics?.forEach(g=>{H(g.symbol,t)});break;case "CIMSolidStroke":case "CIMSolidFill":S(t,l.color);break;case "CIMHatchFill":H(l.lineSymbol,t)}}}function S(k,t){for(const p of k)if(p.join(".")===t.join("."))return;k.push(t)}function P(k,t,p){if(k){var l="CIMTextSymbol"===k.type?k.symbol:k;k="CIMPolygonSymbol"===l?.type;if(l?.symbolLayers)for(const g of l.symbolLayers)if(!g.colorLocked){if(k)if(p){if({layersToColor:l}=p,(M.isCIMStroke(g)||M.isCIMMarker(g)&&
g.markerPlacement&&M.isCIMMarkerStrokePlacement(g.markerPlacement))&&"fill"===l||M.isCIMFill(g)&&"outline"===l)continue}else if(M.isCIMStroke(g)||M.isCIMMarker(g)&&g.markerPlacement&&M.isCIMMarkerStrokePlacement(g.markerPlacement))continue;l=t.toArray();switch(g.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":g.tintColor=l;break;case "CIMVectorMarker":g.markerGraphics?.forEach(y=>{P(y.symbol,t,p)});break;case "CIMSolidStroke":case "CIMSolidFill":g.color=l;break;case "CIMHatchFill":P(g.lineSymbol,
t,p)}}}}B.applyCIMSymbolColor=function(k,t,p){t instanceof F||(t=new F(t));(k=M.toCIMSymbolJSON(k))&&P(k,t,p)};B.applyCIMSymbolRotation=function(k,t,p=!1){k=M.toCIMSymbolJSON(k);p&&(t=360-t);if("CIMTextSymbol"===k?.type)k.angle=t;else if("CIMPointSymbol"===k?.type&&k.symbolLayers){p=t-(k.angle||0);for(const l of k.symbolLayers)if(M.isCIMMarker(l)){let g=l.rotation||0;g=l.rotateClockwise?g-p:g+p;l.rotation=g}k.angle=t}};B.getCIMSymbolColor=function(k){k=M.toCIMSymbolJSON(k);const t=[];H(k,t);return t.length?
new F(M.normalizeAlpha(t[0])):null};B.getCIMSymbolRotation=function(k,t=!1){k=M.toCIMSymbolJSON(k);return"CIMTextSymbol"===k?.type||"CIMPointSymbol"===k?.type?(k=k.angle,null!=k&&t?360-k:k??0):0};B.getCIMSymbolSize=N;B.getCIMSymbolType=function(k){k=M.toCIMSymbolJSON(k);if(!k)return null;switch(k.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";
default:return null}};B.scaleCIMMarker=Q;B.scaleCIMSymbol=z;B.scaleCIMSymbolTo=function(k,t,p){if(k){var l=M.toCIMSymbolJSON(k);k=N(k);if(0===k){if(l)if("CIMTextSymbol"===l.type)l.height=t;else if(l.symbolLayers)for(const g of l.symbolLayers)switch(g.type){case "CIMPictureMarker":case "CIMVectorMarker":g.size=t;break;case "CIMPictureStroke":case "CIMSolidStroke":g.width=t}}else z(l,t/k,!1,p)}};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(B,F,M,N,z,Q,T){function Z(t){if(!t)return null;let p=null;switch(t.type){case "simple-fill":case "picture-fill":case "simple-marker":p=Z(t.outline);break;case "simple-line":const l=Q.pt2px(t.width);null!=t.style&&"none"!==t.style&&0!==l&&(p={color:t.color,style:k(t.style),width:l,cap:t.cap,join:"miter"===t.join?Q.pt2px(t.miterLimit):t.join},p.dashArray=H(p).join(",")||"none");break;default:p=null}return p}function H(t){if(!t?.style)return[];const {dashArray:p,style:l,width:g}=t;if("string"===
typeof p&&"none"!==p)return p.split(",").map(n=>Number(n));const y=g??0,f=S.has(l)?S.get(l).map(n=>n*y):[];if("butt"!==t.cap)for(const [n,a]of f.entries())f[n]=1===n%2?a+y:Math.max(a-y,1);return f}const S=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),P=new z.LRUCache(1E3),k=(()=>{const t={};return p=>
{if(t[p])return t[p];const l=p.replaceAll("-","");return t[p]=l}})();M=new M([128,128,128]);B.defaultThematicColor=M;B.dekebabifyLineStyle=k;B.getDashArray=H;B.getFill=function(t){const p=t.style;let l=null;if(t)switch(t.type){case "simple-marker":"cross"!==p&&"x"!==p&&(l=t.color);break;case "simple-fill":p&&"solid"!==p?"none"!==p&&(l={type:"pattern",x:0,y:0,src:F.getAssetUrl(`esri/symbols/patterns/${p}.png`),width:5,height:5}):l=t.color;break;case "picture-fill":l={type:"pattern",src:t.url,width:Q.pt2px(t.width)*
t.xscale,height:Q.pt2px(t.height)*t.yscale,x:Q.pt2px(t.xoffset),y:Q.pt2px(t.yoffset)};break;case "text":l=t.color;break;case "cim":l=T.getCIMSymbolColor(t)}return l};B.getPatternUrlWithColor=function(t,p){const l=t+"-"+p;return void 0!==P.get(l)?Promise.resolve(P.get(l)):N(t,{responseType:"image"}).then(g=>{g=g.data;const y=g.naturalWidth,f=g.naturalHeight,n=document.createElement("canvas");n.width=y;n.height=f;const a=n.getContext("2d");a.fillStyle=p;a.fillRect(0,0,y,f);a.globalCompositeOperation=
"destination-in";a.drawImage(g,0,0);g=n.toDataURL();P.put(l,g);return g})};B.getStroke=Z;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageServiceParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./imageryRendererUtils ./MosaicRule ./rasterEnums ./RasterFunction".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t){B.ExportImageServiceParameters=class extends M.JSONSupport{constructor(){super(...arguments);this.layer=null;this.pixelType=this.compression=void 0;this.lercVersion=2}get adjustAspectRatio(){return this.layer.adjustAspectRatio}writeAdjustAspectRatio(p,l,g){10.3>this.layer.version||(l[g]=p)}get bandIds(){return this.layer.bandIds}get compressionQuality(){return this.layer.compressionQuality}writeCompressionQuality(p,l,g){this.format&&this.format.toLowerCase().includes("jpg")&&
null!=p&&(l[g]=p)}get compressionTolerance(){return this.layer.compressionTolerance}writeCompressionTolerance(p,l,g){"lerc"===this.format&&null!=p&&(l[g]=p)}get format(){return"vector-field"===this.layer.renderer?.type?"lerc":this.layer.format}get interpolation(){return this.layer.interpolation}get noData(){return this.layer.noData}get noDataInterpretation(){return this.layer.noDataInterpretation}writeLercVersion(p,l,g){"lerc"===this.format&&10.5<=this.layer.version&&(l[g]=p)}get version(){const p=
this.layer;p.commitProperty("bandIds");p.commitProperty("format");p.commitProperty("compressionQuality");p.commitProperty("compressionTolerance");p.commitProperty("interpolation");p.commitProperty("noData");p.commitProperty("noDataInterpretation");p.commitProperty("mosaicRule");p.commitProperty("rasterFunction");p.commitProperty("adjustAspectRatio");p.commitProperty("pixelFilter");p.commitProperty("definitionExpression");p.commitProperty("multidimensionalSubset");return(this._get("version")||0)+1}set version(p){this._set("version",
p)}get mosaicRule(){var p=this.layer;let l=p.mosaicRule;p=p.definitionExpression;l?p&&p!==l.where&&(l=l.clone(),l.where=p):p&&(l=new P({where:p}));return l}get rasterFunction(){const p=this.layer;var {rasterFunction:l}=p;const g=p.pixelFilter,y=!p.format||p.format.includes("jpg")||p.format.includes("png");l=this._addResampleRasterFunction(l);var f=p.multidimensionalSubset?.areaOfInterest;f&&(f=new t({functionName:"Clip",functionArguments:{ClippingGeometry:f.toJSON(),ClippingType:1}}),l=S.combineRenderingRules(f,
l));y&&!g&&"vector-field"!==p.renderer?.type&&(l=this.combineRendererWithRenderingRule(l));return l}combineRendererWithRenderingRule(p){const l=this.layer,{rasterInfo:g,renderer:y}=l;p=p||l.rasterFunction;return y&&S.isSupportedRendererType(y)?S.combineRenderingRules(S.convertRendererToRenderingRule(y,{rasterAttributeTable:g.attributeTable,pixelType:g.pixelType,dataType:g.dataType,bandNames:g.bandInfos.map(({name:f})=>f),convertColorRampToColormap:10.6>l.version,convertToRFT:!!p?.rasterFunctionDefinition,
bandCount:g.bandCount}),p):p}_addResampleRasterFunction(p){if("vector-field"!==this.layer.renderer?.type||"Resample"===p?.functionName)return p;let l=new t({functionName:"Resample",functionArguments:{ResamplingType:"esriImageServiceDataTypeVector-UV"===this.layer.serviceDataType?7:10,InputCellSize:this.layer.serviceRasterInfo.pixelSize}});l=p?.rasterFunctionDefinition?new t({rasterFunctionDefinition:S.convertRenderingRuleToRFT(l)}):l;return S.combineRenderingRules(l,p)}};F.__decorate([N.property()],
B.ExportImageServiceParameters.prototype,"layer",void 0);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"adjustAspectRatio",null);F.__decorate([H.writer("adjustAspectRatio")],B.ExportImageServiceParameters.prototype,"writeAdjustAspectRatio",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"bandIds",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"compression",void 0);F.__decorate([N.property({json:{write:!0}})],
B.ExportImageServiceParameters.prototype,"compressionQuality",null);F.__decorate([H.writer("compressionQuality")],B.ExportImageServiceParameters.prototype,"writeCompressionQuality",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"compressionTolerance",null);F.__decorate([H.writer("compressionTolerance")],B.ExportImageServiceParameters.prototype,"writeCompressionTolerance",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,
"format",null);F.__decorate([N.property({type:String,json:{read:{reader:k.interpolationKebab.read},write:{writer:k.interpolationKebab.write}}})],B.ExportImageServiceParameters.prototype,"interpolation",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"noData",null);F.__decorate([N.property({type:String,json:{read:{reader:k.noDataInterpretationKebab.read},write:{writer:k.noDataInterpretationKebab.write}}})],B.ExportImageServiceParameters.prototype,"noDataInterpretation",
null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"pixelType",void 0);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,"lercVersion",void 0);F.__decorate([H.writer("lercVersion")],B.ExportImageServiceParameters.prototype,"writeLercVersion",null);F.__decorate([N.property({type:Number})],B.ExportImageServiceParameters.prototype,"version",null);F.__decorate([N.property({json:{write:!0}})],B.ExportImageServiceParameters.prototype,
"mosaicRule",null);F.__decorate([N.property({json:{write:!0,name:"renderingRule"}})],B.ExportImageServiceParameters.prototype,"rasterFunction",null);B.ExportImageServiceParameters=F.__decorate([Z.subclass("esri.layers.support.ExportImageServiceParameters")],B.ExportImageServiceParameters);Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/imageryRendererUtils":function(){define("exports ../../core/lang ./RasterFunction ./rasterFormats/pixelRangeUtils ./rasterFunctions/rasterFunctionSchema ../../renderers/support/colorRampUtils ../../renderers/support/stretchRendererUtils ../../renderers/visualVariables/SizeVariable".split(" "),
function(B,F,M,N,z,Q,T,Z){function H(b,c){for(const q in b)"raster"===q.toLowerCase()&&("RasterFunctionVariable"===b[q].type?(b[q]=c.rasterFunctionDefinition,b[q].type="RasterFunctionTemplate"):"RasterFunctionTemplate"===b[q].type&&H(b[q].arguments,c))}function S(b){const c=F.clone(z.schema[b.functionName+"Function"]);b=b.functionArguments;for(const q in b)"raster"===q.toLowerCase()?(c.arguments[q]=S(b[q]),c.arguments[q].type="RasterFunctionTemplate"):"colormap"===q.toLowerCase()?(c.arguments[q].value=
n(b[q]),c.arguments.ColorSchemeType.value=0):c.arguments[q].value=b[q];return c}function P(b){const c=b?.Raster??b?.raster;return c&&"esri.layers.support.RasterFunction"===c.declaredClass?P(c.functionArguments):b}function k(b,c){const q=new M;q.functionName="VectorFieldRenderer";const {dataType:v,bandNames:A}=c,m="vector-uv"===v;let r;if(A&&2===A.length){var C=A.map(J=>J.toLowerCase());r=C.indexOf("magnitude");C=C.indexOf("direction")}if(-1===r||null===r)r=0,C=1;const E="arithmetic"===b.rotationType?
1:2,I="flow-from"===b.flowRepresentation?0:1,D=b.visualVariables?b.visualVariables.find(J=>"Magnitude"===J.field):new Z;b={magnitudeBandID:r,directionBandID:C,isUVComponents:m,referenceSystem:E,massFlowAngleRepresentation:I,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:"Vector Average",symbologyName:d[b.style.toLowerCase().replace("-","_")],minimumMagnitude:D.minDataValue,maximumMagnitude:D.maxDataValue,minimumSymbolSize:D.minSize,maximumSymbolSize:D.maxSize};q.functionArguments=b;b=
S(q);return c.convertToRFT?M.fromJSON({rasterFunctionDefinition:b}):q}function t(b,c){const q=c.convertToRFT,v=new M;v.functionName="Stretch";var A=h[T.stretchTypeJSONDict.toJSON(b.stretchType)],m=b.customStatistics?.map(r=>[r.min,r.max,r.avg??0,r.stddev??1]);m={StretchType:A,Statistics:m,DRA:b.dynamicRangeAdjustment,UseGamma:b.useGamma,Gamma:b.gamma,ComputeGamma:b.computeGamma};null!=b.outputMin&&(m.Min=b.outputMin);null!=b.outputMax&&(m.Max=b.outputMax);A===h.standardDeviation?(m.NumberOfStandardDeviations=
b.numberOfStandardDeviations,v.outputPixelType="u8"):A===h.percentClip?(m.MinPercent=b.minPercent,m.MaxPercent=b.maxPercent,v.outputPixelType="u8"):A===h.minMax?v.outputPixelType="u8":A===h.sigmoid&&(m.SigmoidStrengthLevel=b.sigmoidStrengthLevel);v.functionArguments=m;v.variableName="Raster";if(b.colorRamp){m=b.colorRamp;A=new M;if(q)A.functionArguments={ColorRamp:Q.getRFxArgColorRampValue(m)};else{const r=Q.getColorRampName(m,!0);r?A.functionArguments={colorRampName:r}:!c.convertColorRampToColormap||
"algorithmic"!==m.type&&"multipart"!==m.type?(b=b.colorRamp.toJSON(),"algorithmic"===b.type?b.algorithm=b.algorithm||"esriCIELabAlgorithm":"multipart"===b.type&&b.colorRamps?.length&&b.colorRamps.forEach(C=>C.algorithm=C.algorithm||"esriCIELabAlgorithm"),A.functionArguments={colorRamp:b}):A.functionArguments={Colormap:Q.convertColorRampToColormap(m)}}A.variableName="Raster";A.functionName="Colormap";A.functionArguments.Raster=v;return q?new M({rasterFunctionDefinition:S(A)}):A}return q?new M({rasterFunctionDefinition:S(v)}):
v}function p(b,c){const q=[],v=[],A=[],m=[],{pixelType:r,rasterAttributeTable:C}=c,E=null==C?null:C.features,I=g(C);if(I&&E&&Array.isArray(E)&&b.classBreakInfos){b.classBreakInfos.forEach((x,K)=>{const R=x.symbol?.color;let V;R?.a&&null!=x.minValue&&null!=x.maxValue&&E.forEach(W=>{null!=x.minValue&&null!=x.maxValue&&(V=W.attributes[b.field],(V>=x.minValue&&V<x.maxValue||K===b.classBreakInfos.length-1&&V>=x.minValue)&&m.push([W.attributes[I],R.r,R.g,R.b]))})});var D=r?l(m,r):m,J=new M;J.functionName=
"Colormap";J.functionArguments={};J.functionArguments.Colormap=D;J.variableName="Raster";return c.convertToRFT?new M({rasterFunctionDefinition:S(J)}):J}b.classBreakInfos.forEach((x,K)=>{if(null!=x.minValue&&null!=x.maxValue){var R=x.symbol&&x.symbol.color;R?.a?(0===K?q.push(x.minValue,x.maxValue+1E-4):q.push(x.minValue+1E-4,x.maxValue+1E-4),v.push(K),m.push([K,R.r,R.g,R.b])):A.push(x.minValue,x.maxValue)}});D=r?l(m,r):m;J=new M;J.functionName="Remap";J.functionArguments={InputRanges:q,OutputValues:v,
NoDataRanges:A};J.variableName="Raster";const u=new M;u.functionName="Colormap";u.functionArguments={Colormap:D,Raster:J};return c.convertToRFT?new M({rasterFunctionDefinition:S(u)}):u}function l(b,c){(c=a.has(c)?N.getPixelValueRange(c):null)&&b.push([Math.floor(c[0]-1),0,0,0],[Math.ceil(c[1]+1),0,0,0]);return b}function g(b){if(null!=b)return{fields:b}=b,b?.find(c=>c?.name&&"value"===c.name.toLowerCase())?.name}function y(b,c){const q=[],{pixelType:v,rasterAttributeTable:A}=c;var m=null==A?null:
A.features;const r=g(A),C=b.defaultSymbol?.color?.toRgb();var E=b.uniqueValueInfos;if(E)if(!m)for(b=0;b<E.length;b++){var I=E[b];m=f(I);I=+I.value;if(m?.a){if(isNaN(I))return null;q.push([I,m.r,m.g,m.b])}}else if(r){const D=new Map;E.forEach(u=>{const x=u.value;u=f(u);null!=x&&u?.a&&D.set(String(x),u.toRgb())});const J=b.field;J&&m.forEach(({attributes:u})=>{const x=u[r];(u=D.get(String(u[J])))?q.push([x,...u]):C&&q.push([x,...C])})}E=v?l(q,v):q;b=new M;b.functionName="Colormap";b.functionArguments=
{};b.functionArguments.Colormap=E;b.variableName="Raster";return c.convertToRFT?new M({rasterFunctionDefinition:S(b)}):b}function f(b){return"polygon-3d"===b.symbol?.type?b.symbol.symbolLayers?.find(c=>"fill"===c.type)?.material?.color:b.symbol?.color}function n(b){const c=[],q=[];b.forEach(v=>{c.push(v[0]);q.push(Q.convertRGBATo32Bit([...v.slice(1),255]))});return{type:"RasterColormap",values:c,colors:q}}const a=new Set("u1 u2 u4 u8 s8 u16 s16".split(" ")),d={simple_scalar:"Simple Scalar",wind_barb:"Wind Barb",
single_arrow:"Single Arrow",beaufort_kn:"Beaufort Wind (Knots)",beaufort_m:"Beaufort Wind (MetersPerSecond)",ocean_current_m:"Ocean Current (MetersPerSecond)",ocean_current_kn:"Ocean Current (Knots)"},e=new Set("raster-stretch unique-value class-breaks raster-shaded-relief vector-field raster-colormap".split(" ")),h={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};B.combineRenderingRules=function(b,c){if(!b||!c)return F.clone(b||c);b=F.clone(b);if(b.functionDefinition&&
c.rasterFunctionDefinition){const q=c.rasterFunctionDefinition;if(q.thumbnail||q.thumbnailEx)q.thumbnail=q.thumbnailEx=void 0;H(b.functionDefinition.arguments,c);b.rasterFunctionDefinition=b.functionDefinition.toJSON()}else"none"!==c.functionName?.toLowerCase()&&(P(b.functionArguments).Raster=c);return b};B.convertRendererToRenderingRule=function(b,c){c=c||{};switch(b.type){case "raster-stretch":return t(b,c);case "class-breaks":return p(b,c);case "unique-value":return y(b,c);case "raster-colormap":var q=
c;(c=b.extractColormap())&&0!==c.length?({pixelType:b}=q,b=b?l(c,b):c,c=new M,c.functionName="Colormap",c.functionArguments={},c.functionArguments.Colormap=b,b=q.convertToRFT?new M({rasterFunctionDefinition:S(c)}):c):b=null;return b;case "vector-field":return k(b,c);case "raster-shaded-relief":q=c.convertToRFT;if("elevation"!==c.dataType&&("generic"!==c.dataType||1!==c.bandCount||"s16"!==c.pixelType&&"s32"!==c.pixelType&&"f32"!==c.pixelType&&"f64"!==c.pixelType))b=new M;else{c=new M;c.functionName=
"Hillshade";var v="traditional"===b.hillshadeType?0:1,A="none"===b.scalingType?1:3,m={HillshadeType:v,SlopeType:A,ZFactor:b.zFactor};0===v&&(m.Azimuth=b.azimuth,m.Altitude=b.altitude);3===A&&(m.PSPower=b.pixelSizePower,m.PSZFactor=b.pixelSizeFactor);c.functionArguments=m;c.variableName="Raster";b.colorRamp&&(c.functionName="ShadedRelief",q?m.ColorRamp=Q.getRFxArgColorRampValue(b.colorRamp):m.Colormap=Q.convertColorRampToColormap(b.colorRamp));b=q?new M({rasterFunctionDefinition:S(c)}):c}return b;
case "flow":throw Error("Unsupported rendering rule.");}};B.convertRenderingRuleToRFT=S;B.isSupportedRendererType=function(b){return e.has(b.type)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionSchema":function(){define(["exports"],function(B){B.schema={StretchFunction:{arguments:{ComputeGamma:{isDataset:!1,isPublic:!1,name:"ComputeGamma",type:"RasterFunctionVariable",value:!1},DRA:{isDataset:!1,isPublic:!1,name:"DRA",type:"RasterFunctionVariable",
value:!1},EstimateStatsHistogram:{isDataset:!1,isPublic:!1,name:"EstimateStatsHistogram",type:"RasterFunctionVariable",value:!1},Gamma:{displayName:"Gamma",isDataset:!1,isPublic:!1,name:"Gamma",type:"RasterFunctionVariable"},Histograms:{isDataset:!1,isPublic:!1,name:"Histograms",type:"RasterFunctionVariable"},Max:{isDataset:!1,isPublic:!1,name:"Max",type:"RasterFunctionVariable",value:255},MaxPercent:{isDataset:!1,isPublic:!1,name:"MaxPercent",type:"RasterFunctionVariable",value:.5},Min:{isDataset:!1,
isPublic:!1,name:"Min",type:"RasterFunctionVariable",value:0},MinPercent:{isDataset:!1,isPublic:!1,name:"MinPercent",type:"RasterFunctionVariable",value:.25},NumberOfStandardDeviations:{isDataset:!1,isPublic:!1,name:"NumberOfStandardDeviation",type:"RasterFunctionVariable",value:2},Raster:{isDataset:!0,isPublic:!1,name:"Raster",type:"RasterFunctionVariable"},SigmoidStrengthLevel:{isDataset:!1,isPublic:!1,name:"SigmoidStrengthLevel",type:"RasterFunctionVariable",value:2},Statistics:{isDataset:!1,isPublic:!1,
name:"Statistics",type:"RasterFunctionVariable"},StretchType:{isDataset:!1,isPublic:!1,name:"StretchType",type:"RasterFunctionVariable",value:0},type:"StretchFunctionArguments",UseGamma:{isDataset:!1,isPublic:!1,name:"UseGamma",type:"RasterFunctionVariable",value:!1}},description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",
function:{description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",name:"Stretch",pixelType:"UNKNOWN",type:"StretchFunction"},functionType:0,name:"Stretch",thumbnail:""},RemapFunction:{name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table.",function:{type:"RemapFunction",
pixelType:"UNKNOWN",name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},UseTable:{name:"UseTable",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},InputRanges:{name:"InputRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Input Ranges"},OutputValues:{name:"OutputValues",isPublic:!1,isDataset:!1,
type:"RasterFunctionVariable",displayName:"Output Values"},NoDataRanges:{name:"NoDataRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"NoData Ranges"},Table:{name:"Table",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputField:{name:"InputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},OutputField:{name:"OutputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputMaxField:{name:"InputMaxField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},
RemapTableType:{name:"RemapTableType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},AllowUnmatched:{name:"AllowUnmatched",isPublic:!1,isDataset:!1,value:!0,type:"RasterFunctionVariable"},type:"RemapFunctionArguments"},functionType:0,thumbnail:""},ColormapFunction:{name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp.",function:{type:"ColormapFunction",pixelType:"UNKNOWN",
name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},ColormapName:{name:"ColormapName",isPublic:!1,isDataset:!1,
value:"Gray",type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},type:"ColormapFunctionArguments"},functionType:0,thumbnail:""},ShadedReliefFunction:{name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image.",function:{type:"ShadedReliefFunction",pixelType:"UNKNOWN",name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image."},
arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,
value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",
isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"ShadedReliefFunctionArguments"},functionType:0,thumbnail:""},HillshadeFunction:{name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image",function:{type:"HillshadeFunction",pixelType:"UNKNOWN",name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image"},
arguments:{DEM:{name:"DEM",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,
value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"HillshadeFunctionArguments"},functionType:0,thumbnail:""},ResampleFunction:{name:"Resample",description:"Changes the cell size of a raster.",function:{type:"ResampleFunction",
pixelType:"UNKNOWN",name:"Resample",description:"Changes the cell size of a raster."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ResamplingType:{name:"ResamplingType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},InputCellSize:{name:"InputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},OutputCellSize:{name:"OutputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},type:"ResampleFunctionArguments"},
functionType:0,thumbnail:""}};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/imageBitmapUtils":function(){define(["exports","../../core/Error","../../core/promiseUtils"],function(B,F,M){B.createBitmap=async function(N,z,Q){let T;try{T=await createImageBitmap(N)}catch(Z){throw new F("request:server",`Unable to load ${z}`,{url:z,error:Z});}M.throwIfAborted(Q);return T};B.createTileBitmap=async function(N,z,Q,T,Z){let H;try{H=await createImageBitmap(N)}catch(S){throw new F("request:server",
`Unable to load tile ${z}/${Q}/${T}`,{error:S,level:z,row:Q,col:T});}M.throwIfAborted(Z);return H};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/MultidimensionalSubset":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Polygon ../../geometry/support/jsonUtils ./DimensionalDefinition ../../geometry/Geometry".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t){var p;F={base:t,key:"type",typeMap:{extent:H,polygon:S}};M=p=class extends M.JSONSupport{constructor(l){super(l);this.subsetDefinitions=this.areaOfInterest=null}get dimensions(){var {subsetDefinitions:l}=this;if(null==l||0===l.length)return[];const g=new Map;l.forEach(y=>{if(y.dimensionName){if(Array.isArray(y.values[0])){var f=y.values;var n=f[0][0];f=f[y.values.length-1][1]}else f=y.values,n=f[0],f=f[y.values.length-1];g.has(y.dimensionName)?(y=g.get(y.dimensionName),
y[0]=Math.min(n,y[0]),y[1]=Math.max(f,y[1])):g.set(y.dimensionName,[n,f])}});l=[];for(const y of g)l.push({name:y[0],extent:y[1]});return l}get variables(){const {subsetDefinitions:l}=this;if(null==l||0===l.length)return[];const g=new Set;l.forEach(y=>{y.variableName&&g.add(y.variableName)});return[...g]}clone(){const l=this.subsetDefinitions?.map(y=>y.clone()),g=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new p({areaOfInterest:g,subsetDefinitions:l})}};B.__decorate([N.property({types:F,
json:{read:P.fromJSON,write:!0}})],M.prototype,"areaOfInterest",void 0);B.__decorate([N.property({readOnly:!0})],M.prototype,"dimensions",null);B.__decorate([N.property({readOnly:!0})],M.prototype,"variables",null);B.__decorate([N.property({type:[k],json:{write:!0}})],M.prototype,"subsetDefinitions",void 0);return M=p=B.__decorate([Z.subclass("esri.layers.support.MultidimensionalSubset")],M)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k){var t;F=t=class extends F.JSONSupport{constructor(p){super(p);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var p=this.keyProperties.BandProperties,{bandCount:l}=
this;if(!p?.length||p.length<l){p=[];for(let g=1;g<=l;g++)p.push(new S({name:"band_"+g}));return p}l=p.map(g=>S.fromJSON(g));for(p=0;p<l.length;p++)l[p].name=l[p].name||"band_"+(p+1);return l}get dataType(){const p=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===p?"standard-time":p}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(p){p&&this._set("nativeExtent",p)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;
const p=this.nativeExtent;return{x:p.width/this.width,y:p.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return P.fromJSON(this.keyProperties)}clone(){return new t({attributeTable:M.clone(this.attributeTable),bandCount:this.bandCount,colormap:M.clone(this.colormap),extent:M.clone(this.extent),format:this.format,height:this.height,width:this.width,histograms:M.clone(this.histograms),keyProperties:M.clone(this.keyProperties),
multidimensionalInfo:M.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:M.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:M.clone(this.spatialReference),statistics:M.clone(this.statistics),storageInfo:M.clone(this.storageInfo),transform:M.clone(this.transform)})}};B.__decorate([N.property({json:{write:!0}})],F.prototype,"attributeTable",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"bandCount",
void 0);B.__decorate([N.property({readOnly:!0})],F.prototype,"bandInfos",null);B.__decorate([N.property({json:{write:!0}})],F.prototype,"colormap",void 0);B.__decorate([N.property({type:String,readOnly:!0})],F.prototype,"dataType",null);B.__decorate([N.property({type:Z,json:{write:!0}})],F.prototype,"extent",void 0);B.__decorate([N.property({type:Z,json:{write:!0}})],F.prototype,"nativeExtent",null);B.__decorate([N.property({json:{write:!0}})],F.prototype,"nativePixelSize",null);B.__decorate([N.property({json:{write:!0}})],
F.prototype,"format",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"height",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"width",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"hasMultidimensionalTranspose",null);B.__decorate([N.property({json:{write:!0}})],F.prototype,"histograms",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"keyProperties",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"multidimensionalInfo",
void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"noDataValue",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"pixelSize",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"pixelType",void 0);B.__decorate([N.property()],F.prototype,"isPseudoSpatialReference",void 0);B.__decorate([N.property({readOnly:!0})],F.prototype,"sensorInfo",null);B.__decorate([N.property({type:H,json:{write:!0}})],F.prototype,"spatialReference",void 0);B.__decorate([N.property({json:{write:!0}})],
F.prototype,"statistics",void 0);B.__decorate([N.property({type:k,json:{write:!0}})],F.prototype,"storageInfo",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"transform",void 0);return F=t=B.__decorate([T.subclass("esri.layers.support.RasterInfo")],F)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(B,F,M,N,z,Q,T){function Z(S){S=Number(S);return isNaN(S)?void 0:S}var H;F=H=class extends F.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new H({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};B.__decorate([M.property({json:{name:"BandName",write:!0}})],F.prototype,"name",void 0);B.__decorate([M.property({json:{name:"WavelengthMin",read:{reader:Z},write:!0}})],F.prototype,"minWavelength",void 0);B.__decorate([M.property({json:{name:"WavelengthMax",read:{reader:Z},write:!0}})],F.prototype,"maxWavelength",void 0);B.__decorate([M.property({json:{name:"RadianceBias",read:{reader:Z},write:!0}})],F.prototype,"radianceBias",
void 0);B.__decorate([M.property({json:{name:"RadianceGain",read:{reader:Z},write:!0}})],F.prototype,"radianceGain",void 0);B.__decorate([M.property({json:{name:"ReflectanceBias",read:{reader:Z},write:!0}})],F.prototype,"reflectanceBias",void 0);B.__decorate([M.property({json:{name:"ReflectanceGain",read:{reader:Z},write:!0}})],F.prototype,"reflectanceGain",void 0);B.__decorate([M.property({json:{name:"SolarIrradiance",read:{reader:Z},write:!0}})],F.prototype,"solarIrradiance",void 0);return F=H=
B.__decorate([T.subclass("esri.layers.support.RasterBandInfo")],F)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(B,F,M,N,z,Q,T,Z,H){function S(k){k=Number(k);return isNaN(k)?void 0:
k}var P;F=P=class extends F.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(k){return new Date(k)}writeAcquisitionDate(k,t){t.AcquisitionDate=k.getTime()}clone(){return new P({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};B.__decorate([M.property({json:{name:"AcquisitionDate",write:!0}})],F.prototype,"acquisitionDate",void 0);B.__decorate([T.reader("acquisitionDate")],F.prototype,"readAcquisitionDate",null);B.__decorate([H.writer("acquisitionDate")],F.prototype,"writeAcquisitionDate",null);B.__decorate([M.property({json:{name:"CloudCover",read:{reader:S},write:!0}})],F.prototype,"cloudCover",void 0);B.__decorate([M.property({json:{name:"ProductName",
write:!0}})],F.prototype,"productName",void 0);B.__decorate([M.property({json:{name:"SensorName",write:!0}})],F.prototype,"sensorName",void 0);B.__decorate([M.property({json:{name:"SensorAzimuth",read:{reader:S},write:!0}})],F.prototype,"sensorAzimuth",void 0);B.__decorate([M.property({json:{name:"SensorElevation",read:{reader:S},write:!0}})],F.prototype,"sensorElevation",void 0);B.__decorate([M.property({json:{name:"SunAzimuth",read:{reader:S},write:!0}})],F.prototype,"sunAzimuth",void 0);B.__decorate([M.property({json:{name:"SunElevation",
read:{reader:S},write:!0}})],F.prototype,"sunElevation",void 0);return F=P=B.__decorate([Z.subclass("esri.layers.support.RasterSensorInfo")],F)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(B,F,M,N,z,Q,T,Z){var H;F=H=class extends F.JSONSupport{constructor(){super(...arguments);
this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new H({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:M.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,
pyramidResolutions:M.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:M.clone(this.tileInfo),transposeInfo:M.clone(this.transposeInfo),blockBoundary:M.clone(this.blockBoundary)})}};B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"blockWidth",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,
"blockHeight",void 0);B.__decorate([N.property({type:String,json:{write:!0}})],F.prototype,"compression",void 0);B.__decorate([N.property({type:Z,json:{write:!0}})],F.prototype,"origin",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"firstPyramidLevel",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"maximumPyramidLevel",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"pyramidResolutions",void 0);B.__decorate([N.property({type:Number,
json:{write:!0}})],F.prototype,"pyramidScalingFactor",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"pyramidBlockWidth",void 0);B.__decorate([N.property({type:Number,json:{write:!0}})],F.prototype,"pyramidBlockHeight",void 0);B.__decorate([N.property({type:Boolean,json:{write:!0}})],F.prototype,"isVirtualTileInfo",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"tileInfo",void 0);B.__decorate([N.property()],F.prototype,"transposeInfo",void 0);B.__decorate([N.property()],
F.prototype,"blockBoundary",void 0);return F=H=B.__decorate([T.subclass("esri.layers.support.RasterStorageInfo")],F)})},"esri/layers/support/RasterJobHandler":function(){define(["../../core/Error","../../core/workers/workers","./PixelBlock"],function(B,F,M){class N{constructor(){this._workerThread=null;this._destroyed=!1}async initialize(){const z=await F.open("RasterWorker");this._destroyed?z.close():this._workerThread=z}destroy(){this._destroyed=!0;this._workerThread&&(this._workerThread.close(),
this._workerThread=null)}async convertVectorFieldData(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");return(z=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:z.pixelBlock.toJSON(),type:z.dataType},Q))?new M(z):null}computeStatisticsHistograms(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:z.pixelBlock.toJSON()},
Q)}async decode(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");return(z=await this._workerThread.invoke("decode",z,Q))?new M(z):null}async symbolize(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");z={extent:z.extent?.toJSON(),pixelBlock:z.pixelBlock?.toJSON(),simpleStretchParams:z.simpleStretchParams,bandIds:z.bandIds};return(Q=await this._workerThread.invoke("symbolize",z,Q))?
new M(Q):null}async updateSymbolizer(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");const T=z?.rendererJSON?.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:z.toJSON(),histograms:T},Q))}async updateRasterFunction(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:z.toJSON()},
Q))}async process(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");return(z=await this._workerThread.invoke("process",{extent:z.extent?.toJSON(),primaryPixelSizes:z.primaryPixelSizes?.map(T=>null!=T?T.toJSON():null),primaryPixelBlocks:z.primaryPixelBlocks.map(T=>null!=T?T.toJSON():null),primaryRasterIds:z.primaryRasterIds},Q))?new M(z):null}async stretch(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");
if(!z?.pixelBlock)return null;z={srcPixelBlock:z.pixelBlock.toJSON(),stretchParams:z.stretchParams};return(Q=await this._workerThread.invoke("stretch",z,Q))?new M(Q):null}async split(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");if(!z?.pixelBlock)return null;z={srcPixelBlock:z.pixelBlock.toJSON(),tileSize:z.tileSize,maximumPyramidLevel:z.maximumPyramidLevel,useBilinear:z.useBilinear};const T=await this._workerThread.invoke("split",z,Q);
T&&T.forEach((Z,H)=>{T.set(H,Z?M.fromJSON(Z):null)});return T}async clipTile(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");if(!z?.pixelBlock)return null;z={...z,pixelBlock:z.pixelBlock.toJSON()};return(Q=await this._workerThread.invoke("clipTile",z,Q))?M.fromJSON(Q):null}async estimateStatisticsHistograms(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");if(!z?.pixelBlock)return null;
z={srcPixelBlock:z.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",z,Q)}async mosaicAndTransform(z,Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");if(!z?.srcPixelBlocks?.length)return{pixelBlock:null};z={...z,srcPixelBlocks:z.srcPixelBlocks.map(T=>null!=T?T.toJSON():null)};Q=await this._workerThread.invoke("mosaicAndTransform",z,Q);return{pixelBlock:Q.pixelBlock?new M(Q.pixelBlock):null,localNorthDirections:Q.localNorthDirections}}async createFlowMesh(z,
Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");const T={buffer:z.flowData.data.buffer,maskBuffer:z.flowData.mask.buffer,width:z.flowData.width,height:z.flowData.height},{meshType:Z,simulationSettings:H}=z;z=await this._workerThread.invoke("createFlowMesh",{meshType:Z,flowData:T,simulationSettings:H},{...Q,transferList:[T.buffer,T.maskBuffer]});return{vertexData:new Float32Array(z.vertexBuffer),indexData:new Uint32Array(z.indexBuffer)}}getProjectionOffsetGrid(z,
Q){if(!this._workerThread)throw new B("raster-jobhandler:no-connection","no available worker connection");const T=null!=z.datumTransformation?z.datumTransformation.steps.map(H=>({wkid:H.wkid,wkt:H.wkt,isInverse:H.isInverse})):null,Z=null!=z.rasterTransform?z.rasterTransform.toJSON():null;z={projectedExtent:z.projectedExtent.toJSON(),srcBufferExtent:z.srcBufferExtent.toJSON(),pixelSize:z.pixelSize,hasWrapAround:z.hasWrapAround,spacing:z.spacing,datumTransformationSteps:T,rasterTransform:Z,isAdaptive:z.isAdaptive,
includeGCSGrid:z.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",z,Q)}}return N})},"esri/layers/support/rasterDatasets/multidimensionalUtils":function(){define(["exports","../../../core/arrayUtils","../DimensionalDefinition"],function(B,F,M){function N(l,g,y){const f=g.shift();0===y.length&&y.push({sliceId:-1,multidimensionalDefinition:[]});const n=y.length;for(let a=0;a<n;a++){const d=y.shift().multidimensionalDefinition;f.values?.forEach(e=>{y.push({sliceId:-1,multidimensionalDefinition:[...d,
{variableName:l,dimensionName:f.name,values:[e]}]})})}g.length&&N(l,g,y)}function z(l,g){return Array.isArray(l)?g[0]===g[1]?l[0]===g[0]||l[1]===g[0]:l[0]>=g[0]&&l[0]<=g[1]&&l[1]>=g[0]&&l[1]<=g[1]:l>=g[0]&&l<=g[1]}function Q(l,g){return l[0]<=g[0]&&l[1]>=g[0]||l[0]<=g[1]&&l[1]>=g[1]||l[0]>=g[0]&&l[1]<=g[1]}function T(l){return 1===l.length?[l[0],l[0]]:[l[0],l[l.length-1]]}function Z(l,g,y){if(!g?.subsetDefinitions?.length)return l;if(y){const {variables:n}=g;if(n.length&&!n.includes(y))return null;
g=g.subsetDefinitions.find(a=>a.dimensionName===l.name&&a.variableName===y);if(!g?.values?.length)return l;g=T(g.values)}else g=g.dimensions.find(({name:n})=>n===l.name)?.extent;const f=g;if(!f?.length)return l;g=l.values.filter(n=>z(n,f));return{...l,extent:[...f],values:g}}function H(l,g,y){if(!g?.subsetDefinitions?.length)return!1;const {variables:f}=g;if(f.length&&l.some(({variableName:n})=>n&&!f.includes(n)))return!0;for(let n=0;n<l.length;n++){const a=l[n],d=g.subsetDefinitions.find(e=>(""===
a.variableName||e.variableName===a.variableName)&&e.dimensionName===a.dimensionName);if(d?.values.length){const e=T(d.values);if(!a.isSlice&&2===a.values.length&&!Array.isArray(a.values[0])&&a.values[0]!==a.values[1]&&y){if(!Q(a.values,e))return!0}else if(a.values.some(h=>!z(h,e)))return!0}}return!1}function S(l,g){var y=l.dimensions.find(({name:d})=>"StdTime"===d);if(null==y||null==g.start&&null==g.end)return g;g=g.clone();const {start:f,end:n}=g.toJSON(),a=f===n?[f]:null!=f&&null!=n?[f,n]:[f??n];
if(2===a.length&&y?.extent.length&&(a[0]=Math.max(a[0],y.extent[0]),a[1]=Math.min(a[1],y.extent[1]??y.extent[0]),a[1]<a[0]))return null;y=new M({variableName:"",dimensionName:"StdTime",isSlice:1===a.length,values:a});if(H([y],l,!0))return null;g.start=new Date(a[0]);g.end=new Date(a[1]??a[0]);return g}function P(l,g={}){const {multidimensionalInfo:y,keyProperties:f}=l;if(null==y)return null;const {variableName:n,multidimensionalSubset:a,multidimensionalDefinition:d}=g;l=null!=d?d[0]?.variableName:
null;const e=n||l||f?.DefaultVariable;({variables:l}=y);a?.variables?.length&&(l=l.filter(({name:h})=>a.variables.includes(h)));return e?l.find(({name:h})=>h===e)??l[0]:l[0]}function k(l,g){var {values:y}=g;if(y?.length){g=Array.isArray(y[0]);var f=Array.isArray(l);return g!==f?-1:g&&f?y.findIndex(a=>a[0]===l[0]&&a[1]===l[1]):y.indexOf(l)}({extent:f}=g);if(Array.isArray(l)||!f||l<f[0]||l>f[1])return-1;y=g.interval||1;if("ISO8601"!==g.unit)return Math.round((l-f[0])/y);f=f[0];let n=-1;switch(g.intervalUnit?.toLowerCase()||
"days"){case "seconds":n=Math.round((l-f)/1E3/y);break;case "minutes":n=Math.round((l-f)/6E4/y);break;case "hours":n=Math.round((l-f)/36E5/y);break;case "days":n=Math.round((l-f)/864E5/y);break;case "months":g=(new Date(l)).getUTCFullYear()-(new Date(f)).getUTCFullYear();y=(new Date(f)).getUTCMonth();f=(new Date(l)).getUTCMonth();n=0===g?f-y:f+11-y+12*(g-1);break;case "years":n=Math.round(((new Date(l)).getUTCFullYear()-(new Date(f)).getUTCFullYear())/y);break;case "decades":n=Math.round(((new Date(l)).getUTCFullYear()-
(new Date(f)).getUTCFullYear())/10/y)}return n}function t(l){var g=l.values?.length;if(g)return g;const {extent:y,unit:f}=l;g=l.interval||1;var n=y?y[1]-y[0]:0;if("ISO8601"!==f)return Math.round(n/g);switch(l.intervalUnit?.toLowerCase()??"seconds"){case "seconds":g=Math.round(n/1E3/g);break;case "minutes":g=Math.round(n/6E4/g);break;case "hours":g=Math.round(n/36E5/g);break;case "days":g=Math.round(n/864E5/g);break;case "months":y?(l=(new Date(y[1])).getUTCFullYear()-(new Date(y[0])).getUTCFullYear(),
g=(new Date(y[0])).getUTCMonth(),n=(new Date(y[1])).getUTCMonth(),g=0===l?n-g+1:n+11-g+12*(l-1)+1):g=0;break;case "years":g=y?Math.round(((new Date(y[1])).getUTCFullYear()-(new Date(y[0])).getUTCFullYear())/g):0;break;case "decades":g=y?Math.round(((new Date(y[1])).getUTCFullYear()-(new Date(y[0])).getUTCFullYear())/10/g):0;break;default:g=0}return g}function p(l,g,y,f){const n=[];let a=l;for(l=new Date(l);a<=g;)switch(n.push(a),f){case "decades":l.setUTCFullYear(l.getUTCFullYear()+10*y);a=l.getTime();
break;case "years":l.setUTCFullYear(l.getUTCFullYear()+y);a=l.getTime();break;case "months":l.setUTCMonth(l.getUTCMonth()+y);a=l.getTime();break;case "days":a+=864E5*y;break;case "hours":a+=36E5*y;break;case "minutes":a+=6E4*y;break;case "seconds":a+=1E3*y}1===n.length?n[1]=g:n[n.length-1]=g;return n}B.createSlices=function(l,g){const y=[];let f=0;(g?l.variables.filter(n=>n.name.toLowerCase()===g.toLowerCase()):[...l.variables].sort((n,a)=>n.name>a.name?1:-1)).forEach(n=>{const a=[],d=[...n.dimensions].sort((e,
h)=>e.name>h.name?-1:1);N(n.name,d,a);a.forEach(e=>{y.push({...e,sliceId:f++})})});return y};B.getDefaultMultidimensionalDefinition=function(l,g={}){var y=P(l,g);if(!y)return null;l=[];const {dimensions:f,name:n}=y;if(0===f.length)return[new M({variableName:n,dimensionName:"",values:[],isSlice:!0})];for(y=0;y<f.length;y++){const a=Z(f[y],g.multidimensionalSubset,n);if(!a)return null;const {values:d,extent:e}=a;let h=d?.[0]??e?.[0];"stdz"===a.name.toLowerCase()&&!a.hasRanges&&e&&Math.abs(e[1])<=Math.abs(e[0])&&
(h=d?.length?d[d.length-1]:e[1]);l.push(new M({variableName:n,dimensionName:a.name,values:[h],isSlice:g.useRangeForRangedDimensionInfo?!!a.hasRanges:!0}))}return l};B.getDefaultVariableInfo=P;B.getDimensionValues=function(l){if(2!==l.extent?.length||!l.interval)return[];const {extent:[g,y],interval:f}=l;if("ISO8601"===l.unit)return l=l.intervalUnit?.toLowerCase()??"days","decades years months days hours minutes seconds".split(" ").includes(l)?p(g,y,f,l):[];const n=Math.round((y-g)/f);return Array.from({length:n},
(a,d)=>d===n-1?y:g+d*f)};B.getSliceIds=function(l,g,y){let f=l;g&&(g=[...g].sort((n,a)=>n.dimensionName<a.dimensionName?-1:1),g.forEach(({dimensionName:n,values:a,isSlice:d})=>{a.length&&(f=f.filter(e=>{e=e.multidimensionalDefinition.find(b=>b.dimensionName===n);if(null==e)return!1;const h=e.values[0];return"number"===typeof h?"number"===typeof a[0]?a.includes(h):a.some(b=>b[0]<=h&&b[1]>=h):"number"===typeof a[0]?a.some(b=>h[0]<=b&&h[1]>=b):d?a.some(b=>b[0]===h[0]&&b[0]===h[1]):a.some(b=>b[0]>=h[0]&&
b[0]<=h[1]||b[1]>=h[0]&&b[1]<=h[1]||b[0]<h[0]&&b[1]>h[1])}))}));if(f.length&&null!=y?.start&&null!=y.end){const n=y.start.getTime(),a=y.end.getTime(),d=f[0].multidimensionalDefinition.findIndex(e=>"StdTime"===e.dimensionName);-1<d&&(f=f.filter(e=>{e=e.multidimensionalDefinition[d].values[0];return n<=e&&a>=e}))}return f.map(n=>n.sliceId)};B.getSliceIndex=function(l,g){let y=0;var f=l[0].variableName;g=[...g.variables].sort((a,d)=>a.name>d.name?1:-1);for(var n=0;n<g.length;n++){const a=g[n],d=[...a.dimensions].sort((e,
h)=>e.name>h.name?-1:1);if(a.name!==f)y+=d.map(e=>t(e)).reduce((e,h)=>e*h);else{f=d.map(e=>t(e));g=d.length;for(let e=0;e<g;e++){n=l.find(h=>h.dimensionName===d[e].name);if(null==n)return null;n=k(n.values[0],d[e]);if(-1===n)return null;f.shift();y=e===g-1?y+n:y+n*f.reduce((h,b)=>h*b)}break}}return y};B.getSubsetVariablesFromMdInfo=function(l,g){if(null==g||null==l)return null;g=g.variables.map(y=>({...y}));l?.variables?.length&&(g=g.filter(({name:y})=>l.variables.includes(y)),g.forEach(y=>{y.dimensions=
y.dimensions.map(f=>Z(f,l,y.name)).filter(F.isSome)}));return g};B.getTimeDimensionValues=p;B.hasExcludedVariableOrDimension=H;B.intersectMultimensionalSubset=function(l,g){if(null==l)return{isOutside:!1};const {geometry:y,timeExtent:f,multidimensionalDefinition:n}=g;g=null;if(null!=f&&(g=S(l,f),null==g))return{isOutside:!0};const {areaOfInterest:a}=l;if(a&&y){const d="point"===y.type?y:"extent"===y.type?y.center:"polygon"===y.type?y.centroid:null;if(d&&!a.contains(d))return{isOutside:!0}}return null!=
n&&n.length&&H(n,l,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:y,timeExtent:g,multidimensionalDefinition:n}}};B.isMultiSliceOrRangeDefinition=function(l){return l?.length?l.some(g=>{if(null==g.values)return!0;const y=g.values.length;return 0===y||1<y||!g.isSlice&&Array.isArray(g.values[0])}):!1};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ../SimpleBandStatistics ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t,p){async function l(m,r){if(!p.isPlatformLittleEndian)throw new F("rasterCoded:decode","lerc decoder is not supported on big endian platform");await Z.load();const {offset:C}=r,{width:E,height:I,pixelType:D,statistics:J,depthCount:u,noDataValues:x,bandMasks:K,pixels:R,mask:V}=Z.decode(m,{inputOffset:C,returnInterleaved:r.returnInterleaved});m=new N({width:E,height:I,pixelType:D.toLowerCase(),pixels:R,mask:V,statistics:J.map(({minValue:W,maxValue:U})=>new z.SimpleBandStatistics(W,
U)),bandMasks:K,depthCount:u,noDataValues:x});J?.length||m.updateStatistics();return m}async function g(m,r){m=await t.decode(m,{...r,noDataValue:null});M.assertIsSome(m);m=new N({width:m.width,height:m.height,pixels:m.pixels,pixelType:m.pixelType.toLowerCase(),mask:m.mask,bandMasks:m.bandMasks,statistics:null});m.updateStatistics();return m}async function y(m,r){m=await t.decodeTileOrStrip(m,r.customOptions);m=new N({width:m.width,height:m.height,pixels:m.pixels,pixelType:m.pixelType.toLowerCase(),
mask:m.mask,statistics:null});m.updateStatistics();return m}function f(m,r){const C=r.pixelType||"u8",E=N.getPixelArrayConstructor(C),I="u8"===C?m:new E(m.buffer),D=[],J=r.planes||1;if(1===J)D.push(I);else for(let u=0;u<J;u++){const x=(r.width||1)*(r.height||m.length),K=new E(x);for(let R=0;R<x;R++)K[R]=I[R*J+u];D.push(K)}m=new N({width:r.width||1,height:r.height||m.length,pixels:D,pixelType:C,statistics:null});m.updateStatistics();return m}function n(m,r){m=(new P.Zlib(new Uint8Array(m))).getBytes();
return f(m,r)}function a(m,r){m=H.decode(m,r.offset,r.eof,!r.isInputBigEndian);return f(m,r)}function d(m,r){m=T.decode(m,r.hasNoZlibMask??void 0);m=new N({width:m.width,height:m.height,pixels:m.pixels,pixelType:"u8",mask:m.mask,statistics:null});m.updateStatistics();return m}function e(m,r){m=new Uint8Array(m);m=new v(m);const {width:C,height:E}=r;r=C*E;m=m.decode();let I=0;var D=0;let J;D=new Uint8Array(r);for(I=0;I<r;I++)D[I]=m[4*I+3];const u=new N({width:C,height:E,pixels:[],pixelType:"u8",mask:D,
statistics:[]});for(I=0;3>I;I++){J=new Uint8Array(r);for(D=0;D<r;D++)J[D]=m[4*D+I];u.addData({pixels:J})}u.updateStatistics();return u}async function h(m,r,C,E){m=await (new Q).decode(m,{applyJpegMask:!1,format:r,...C},E);m=new N(m);m.updateStatistics();return m}function b(m){if(null==m)throw new F("rasterCodec:decode","parameter encodeddata is required.");m=new Uint8Array(m,0,10);let r="";255===m[0]&&216===m[1]?r="jpg":137===m[0]&&80===m[1]&&78===m[2]&&71===m[3]?r="png":67===m[0]&&110===m[1]&&116===
m[2]&&90===m[3]&&73===m[4]&&109===m[5]&&97===m[6]&&103===m[7]&&101===m[8]&&32===m[9]?r="lerc":76===m[0]&&101===m[1]&&114===m[2]&&99===m[3]&&50===m[4]&&32===m[5]?r="lerc2":73===m[0]&&73===m[1]&&42===m[2]&&0===m[3]||77===m[0]&&77===m[1]&&0===m[2]&&42===m[3]||73===m[0]&&73===m[1]&&43===m[2]&&0===m[3]||77===m[0]&&77===m[1]&&0===m[2]&&43===m[3]?r="tiff":71===m[0]&&73===m[1]&&70===m[2]?r="gif":66===m[0]&&77===m[1]?r="bmp":String.fromCharCode.apply(null,m).toLowerCase().includes("error")&&(r="error");return r}
function c(m){let r=null;switch(m){case "lerc":case "lerc2":r=l;break;case "jpg":r=d;break;case "png":r=e;break;case "bsq":case "bip":r=(C,E)=>{var I=E.pixelType,D=null;let J=null;switch(I?I.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":J=255;D=Uint8Array;break;case "u16":J=J||65535;D=Uint16Array;break;case "u32":J=J||2**32-1;D=Uint32Array;break;case "s8":J=J||-128;D=Int8Array;break;case "s16":J=J||-32768;D=Int16Array;break;case "s32":J=J||-(2**31);D=Int32Array;break;default:D=Float32Array}({pixelTypeCtor:I}=
{pixelTypeCtor:D,noDataValue:J});D=k.decode;C=D(C,{width:E.width,height:E.height,pixelType:I,format:m});E=new N({width:E.width,height:E.height,pixels:C.pixels,pixelType:E.pixelType,mask:C.mask,statistics:null});E.updateStatistics();return E};break;case "tiff":r=g;break;case "deflate":r=n;break;case "lzw":r=a;break;case "error":r=()=>{throw new F("rasterCodec:decode","input data contains error");};break;default:r=()=>{throw new F("rasterCodec:decode","unsupported raster format");}}return r}function q(m,
r=1){if(m){var {pixels:C,width:E,height:I,mask:D}=m;if(C&&0!==C.length){var J=C.length,u=E-1,x=I-1,K=[],R,V,W=null,U=N.getPixelArrayConstructor(m.pixelType);if(0===r){for(r=0;r<J;r++){var L=C[r];var O=new U(u*x);for(R=0;R<x;R++){var X=R*E;for(V=0;V<u;V++)O[R*u+V]=L[X+V]}K.push(O)}if(null!=D)for(W=new Uint8Array(u*x),R=0;R<x;R++)for(X=R*E,V=0;V<u;V++)W[R*u+V]=D[X+V]}else{for(r=0;r<J;r++){L=C[r];O=new U(u*x);for(R=0;R<x;R++)for(X=R*E,V=0;V<u;V++)O[R*u+V]=(L[X+V]+L[X+V+1]+L[X+E+V]+L[X+E+V+1])/4;K.push(O)}if(D)for(W=
new Uint8Array(u*x),R=0;R<x;R++)for(X=R*E,V=0;V<u;V++)W[R*u+V]=Math.min.apply(null,[D[X+V],D[X+V+1],D[X+E+V],D[X+E+V+1]])}m.width=u;m.height=x;m.mask=W;m.pixels=K}}}var v=function(m){function r(D){var J,u;this.data=D;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(u=null;;){var x=this.readUInt32();var K=D=void 0;D=[];for(K=0;4>K;++K)D.push(String.fromCharCode(this.data[this.pos++]));D=D.join("");switch(D){case "IHDR":this.width=this.readUInt32();
this.height=this.readUInt32();this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(x);break;case "fcTL":u&&this.animation.frames.push(u);this.pos+=4;u={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),
yOffset:this.readUInt32()};D=this.readUInt16();x=this.readUInt16()||100;u.delay=1E3*D/x;u.disposeOp=this.data[this.pos++];u.blendOp=this.data[this.pos++];u.data=[];break;case "IDAT":case "fdAT":"fdAT"===D&&(this.pos+=4,x-=4);D=(null!=u?u.data:void 0)||this.imgData;for(K=0;0<=x?K<x:K>x;0<=x?++K:--K)D.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(x);x=255-this.transparency.indexed.length;if(0<x)for(D=0;0<=x?D<x:D>
x;0<=x?++D:--D)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(x)[0];break;case 2:this.transparency.rgb=this.read(x)}break;case "tEXt":K=this.read(x);x=K.indexOf(0);D=String.fromCharCode.apply(String,K.slice(0,x));this.text[D]=String.fromCharCode.apply(String,K.slice(x+1));break;case "IEND":u&&this.animation.frames.push(u);a:{switch(this.colorType){case 0:case 3:case 4:u=1;break a;case 2:case 6:u=3;break a}u=void 0}this.colors=u;this.hasAlphaChannel=4===(J=this.colorType)||
6===J;J=this.colors+(this.hasAlphaChannel?1:0);this.pixelBitlength=this.bits*J;a:{switch(this.colors){case 1:J="DeviceGray";break a;case 3:J="DeviceRGB";break a}J=void 0}this.colorSpace=J;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=x}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var C;r.load=function(D,J,u){"function"===typeof J&&(u=J);var x=new XMLHttpRequest;x.open("GET",D,!0);x.responseType="arraybuffer";x.onload=function(){var K=
new Uint8Array(x.response||x.mozResponseArrayBuffer);K=new r(K);"function"===typeof(null!=J?J.getContext:void 0)&&K.render(J);return"function"===typeof u?u(K):void 0};return x.send(null)};r.prototype.read=function(D){var J;var u=[];for(J=0;0<=D?J<D:J>D;0<=D?++J:--J)u.push(this.data[this.pos++]);return u};r.prototype.readUInt32=function(){var D=this.data[this.pos++]<<24;var J=this.data[this.pos++]<<16;var u=this.data[this.pos++]<<8;var x=this.data[this.pos++];return D|J|u|x};r.prototype.readUInt16=
function(){var D=this.data[this.pos++]<<8;var J=this.data[this.pos++];return D|J};r.prototype.decodePixels=function(D){var J,u,x,K,R,V,W,U;null==D&&(D=this.imgData);if(0===D.length)return new Uint8Array(0);D=new P.Zlib(D);D=D.getBytes();var L=this.pixelBitlength/8;var O=L*this.width;var X=new Uint8Array(O*this.height);var aa=D.length;for(u=K=R=0;K<aa;){switch(D[K++]){case 0:for(x=J=0;J<O;x=J+=1)X[u++]=D[K++];break;case 1:for(x=V=0;V<O;x=V+=1){J=D[K++];var ba=x<L?0:X[u-L];X[u++]=(J+ba)%256}break;case 2:for(x=
ba=0;ba<O;x=ba+=1){J=D[K++];var fa=(x-x%L)/L;V=R&&X[(R-1)*O+fa*L+x%L];X[u++]=(V+J)%256}break;case 3:for(x=U=0;U<O;x=U+=1)J=D[K++],fa=(x-x%L)/L,ba=x<L?0:X[u-L],V=R&&X[(R-1)*O+fa*L+x%L],X[u++]=(J+Math.floor((ba+V)/2))%256;break;case 4:for(x=U=0;U<O;x=U+=1){J=D[K++];fa=(x-x%L)/L;ba=x<L?0:X[u-L];0===R?V=W=0:(V=X[(R-1)*O+fa*L+x%L],W=fa&&X[(R-1)*O+(fa-1)*L+x%L]);var ca=ba+V-W;x=Math.abs(ca-ba);fa=Math.abs(ca-V);ca=Math.abs(ca-W);ba=x<=fa&&x<=ca?ba:fa<=ca?V:W;X[u++]=(J+ba)%256}break;default:throw Error("Invalid filter algorithm: "+
D[K-1]);}R++}return X};r.prototype.decodePalette=function(){var D,J,u,x;var K=this.palette;var R=this.transparency.indexed||[];var V=new Uint8Array((R.length||0)+K.length);var W=0;K.length;var U=J=D=0;for(u=K.length;J<u;U=J+=3)V[W++]=K[U],V[W++]=K[U+1],V[W++]=K[U+2],V[W++]=null!=(x=R[D++])?x:255;return V};r.prototype.copyToImageData=function(D,J){var u,x;var K=this.colors;var R=null;var V=this.hasAlphaChannel;this.palette.length&&(R=null!=(u=this._decodedPalette)?u:this._decodedPalette=this.decodePalette(),
K=4,V=!0);D=D.data||D;var W=D.length;var U=R||J;u=x=0;if(1===K)for(;u<W;)K=R?4*J[u/4]:x,x=U[K++],D[u++]=x,D[u++]=x,D[u++]=x,D[u++]=V?U[K++]:this.transparency.grayscale&&this.transparency.grayscale===x?0:255,x=K;else for(;u<W;)K=R?4*J[u/4]:x,D[u++]=U[K++],D[u++]=U[K++],D[u++]=U[K++],D[u++]=V?U[K++]:this.transparency.rgb&&this.transparency.rgb[1]===U[K-3]&&this.transparency.rgb[3]===U[K-2]&&this.transparency.rgb[5]===U[K-1]?0:255,x=K};r.prototype.decode=function(){var D=new Uint8Array(this.width*this.height*
4);this.copyToImageData(D,this.decodePixels());return D};var E=(C=m.document&&m.document.createElement("canvas"))&&C.getContext("2d");var I=function(D){E.width=D.width;E.height=D.height;E.clearRect(0,0,D.width,D.height);E.putImageData(D,0,0);D=new Image;D.src=C.toDataURL();return D};r.prototype.decodeFrames=function(D){var J,u;if(this.animation){var x=this.animation.frames;var K=[];var R=J=0;for(u=x.length;J<u;R=++J){R=x[R];var V=D.createImageData(R.width,R.height);var W=this.decodePixels(new Uint8Array(R.data));
this.copyToImageData(V,W);R.imageData=V;K.push(R.image=I(V))}return K}};r.prototype.renderFrame=function(D,J){var u=this.animation.frames;var x=u[J];u=u[J-1];0===J&&D.clearRect(0,0,this.width,this.height);1===(null!=u?u.disposeOp:void 0)?D.clearRect(u.xOffset,u.yOffset,u.width,u.height):2===(null!=u?u.disposeOp:void 0)&&D.putImageData(u.imageData,u.xOffset,u.yOffset);0===x.blendOp&&D.clearRect(x.xOffset,x.yOffset,x.width,x.height);return D.drawImage(x.image,x.xOffset,x.yOffset)};r.prototype.animate=
function(D){var J,u=this;var x=0;var K=this.animation;var R=K.numFrames;var V=K.frames;var W=K.numPlays;return(J=function(){var U=x++%R;var L=V[U];u.renderFrame(D,U);if(1<R&&x/R<W)return u.animation._timeout=setTimeout(J,L.delay)})()};r.prototype.stopAnimation=function(){var D;return clearTimeout(null!=(D=this.animation)?D._timeout:void 0)};r.prototype.render=function(D){D._png&&D._png.stopAnimation();D._png=this;D.width=this.width;D.height=this.height;D=D.getContext("2d");if(this.animation)return this.decodeFrames(D),
this.animate(D);var J=D.createImageData(this.width,this.height);this.copyToImageData(J,this.decodePixels());return D.putImageData(J,0,0)};return r}(self);const A=new Set(["jpg","png","bmp","gif"]);B.decode=async function(m,r={},C){if(null==m)throw new F("rasterCodec:decode","missing encodeddata parameter.");let E=r.format?.toLowerCase();if(!("bsq"!==E&&"bip"!==E||null!=r.width&&null!=r.height))throw new F("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===E&&r.customOptions)return y(m,
r);if(!E||"bsq"!==E&&"bip"!==E&&"deflate"!==E&&"lzw"!==E)E=b(m);if(r.useCanvas&&A.has(E))return h(m,E,r,C);const I=c(E);r.isPoint&&(r={...r},null!=r.width&&r.width++,null!=r.height&&r.height++);let D;const {offsets:J}=r;if(J&&1<J.length){C=J.map((x,K)=>I(m.slice(x,J[K+1]),r));C=await Promise.all(C);D=C[0];D.pixels=C.map(x=>x.pixels[0]);const u=C.map(x=>x.mask);C.some(x=>null!=x)&&(u.forEach((x,K)=>{null==x&&(u[K]=(new Uint8Array(D.width*D.height)).fill(255))}),D.bandMasks=u,D.mask=N.combineBandMasks(u));
D.updateStatistics()}else D=await I(m,{...r,offset:J?.[0]??r.offset});"jpg"!==E&&null!=r.noDataValue&&1===D.depthCount&&S.convertNoDataToMask(D,r.noDataValue,{customFloatTolerance:r.tolerance});r.isPoint&&q(D);return D};B.getFormat=function(m){m=b(m);"lerc2"===m?m="lerc":"error"===m&&(m="");return m};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],
function(B,F,M){class N{constructor(z){this._ctx=this._canvas=null;z&&(this._canvas=z.canvas,this._ctx=z.ctx||z.canvas&&z.canvas.getContext("2d"))}decode(z,Q,T){if(!z||10>z.byteLength)throw new B("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:Z=0,height:H=0,format:S}=Q;const {applyJpegMask:P}=Q;if(P&&(!Z||!H))throw new B("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((k,t)=>{let p=null;
"jpg"===S&&P&&(p=N._getMask(z,{width:Z,height:H}));const l=new Blob([new Uint8Array(z)],{type:"jpg"==="image/"+S?"jpeg":S}),g=URL.createObjectURL(l),y=new Image;let f;y.src=g;y.onload=()=>{URL.revokeObjectURL(g);if(F.isAborted(T))t(F.createAbortError());else{Z=y.width;H=y.height;if(this._canvas&&this._ctx){if(this._canvas.width!==Z||this._canvas.height!==H)this._canvas.width=Z,this._canvas.height=H;this._ctx.clearRect(0,0,Z,H)}else this._canvas=document.createElement("canvas"),this._canvas.width=
Z,this._canvas.height=H,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(y,0,0);var n=this._ctx.getImageData(0,0,Z,H);f=n.data;var a;if(Q.renderOnCanvas){if(p)for(a=0;a<p.length;a++)f[4*a+3]=p[a]?255:0;this._ctx.putImageData(n,0,0);k(null)}else{n=Z*H;var d=new Uint8Array(n),e=new Uint8Array(n),h=new Uint8Array(n);if(p)for(a=0;a<n;a++)d[a]=f[4*a],e[a]=f[4*a+1],h[a]=f[4*a+2];else for(p=new Uint8Array(n),a=0;a<n;a++)d[a]=f[4*a],e[a]=f[4*a+1],h[a]=f[4*a+2],p[a]=f[4*a+3];k({width:Z,height:H,
pixels:[d,e,h],mask:p,pixelType:"u8"})}}};y.onerror=()=>{URL.revokeObjectURL(g);t("cannot load image")}})}static _getMask(z,Q){let T=null;try{var Z=new Uint8Array(z);z=0;var H=Z.length-2;for(z=Math.ceil(Z.length/2);z<H&&(255!==Z[z]||217!==Z[z+1]);z++);z+=2;if(z<Z.length-1){const S=(new M.Zlib(Z.subarray(z))).getBytes();T=new Uint8Array(Q.width*Q.height);Q=0;for(Z=0;Z<S.length;Z++)for(H=7;0<=H;H--)T[Q++]=S[Z]>>H&1}}catch(S){}return T}}return N})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],
function(B,F){var M={exports:{}},N,z=function(){if(N)return M.exports;N=1;(function(Q){(function(T){T=T();void 0!==T&&(Q.exports=T)})(function(){var T=function(){function Z(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}Z.prototype={ensureBuffer:function(H){var S=this.buffer,P=S?S.byteLength:0;if(H<P)return S;for(var k=512;k<H;)k<<=1;H=new Uint8Array(k);for(k=0;k<P;++k)H[k]=S[k];return this.buffer=H},getByte:function(){for(var H=this.pos;this.bufferLength<=H;){if(this.eof)return null;
this.readBlock()}return this.buffer[this.pos++]},getBytes:function(H){var S=this.pos;if(H){this.ensureBuffer(S+H);for(H=S+H;!this.eof&&this.bufferLength<H;)this.readBlock();var P=this.bufferLength;H>P&&(H=P)}else{for(;!this.eof;)this.readBlock();H=this.bufferLength}this.pos=H;return this.buffer.subarray(S,H)},lookChar:function(){for(var H=this.pos;this.bufferLength<=H;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var H=this.pos;this.bufferLength<=
H;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(H,S,P){for(var k=H+S;this.bufferLength<=k&&!this.eof;)this.readBlock();return new Stream(this.buffer,H,S,P)},skip:function(H){H||=1;this.pos+=H},reset:function(){this.pos=0}};return Z}();return function(){function Z(l){throw Error(l);}function H(l){var g=0,y=l[g++],f=l[g++];-1!=y&&-1!=f||Z("Invalid header in flate stream");8!=(y&15)&&Z("Unknown compression method in flate stream");
0!=((y<<8)+f)%31&&Z("Bad FCHECK in flate stream");f&32&&Z("FDICT bit set in flate stream");this.bytes=l;this.bytesPos=g;this.codeBuf=this.codeSize=0;T.call(this)}if(!self||!self.Uint32Array)return null;var S=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),P=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),k=new Uint32Array([1,2,3,4,65541,65543,131081,
131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),t=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,
524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,
524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,
524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,
524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,
524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,
524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,
524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],p=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];H.prototype=Object.create(T.prototype);
H.prototype.getBits=function(l){for(var g=this.codeSize,y=this.codeBuf,f=this.bytes,n=this.bytesPos,a;g<l;)"undefined"==typeof(a=f[n++])&&Z("Bad encoding in flate stream"),y|=a<<g,g+=8;this.codeBuf=y>>l;this.codeSize=g-=l;this.bytesPos=n;return y&(1<<l)-1};H.prototype.getCode=function(l){var g=l[0],y=l[1];l=this.codeSize;for(var f=this.codeBuf,n=this.bytes,a=this.bytesPos;l<y;){var d;"undefined"==typeof(d=n[a++])&&Z("Bad encoding in flate stream");f|=d<<l;l+=8}y=g[f&(1<<y)-1];g=y>>16;y&=65535;(0==
l||l<g||0==g)&&Z("Bad encoding in flate stream");this.codeBuf=f>>g;this.codeSize=l-g;this.bytesPos=a;return y};H.prototype.generateHuffmanTable=function(l){for(var g=l.length,y=0,f=0;f<g;++f)l[f]>y&&(y=l[f]);for(var n=1<<y,a=new Uint32Array(n),d=1,e=0,h=2;d<=y;++d,e<<=1,h<<=1)for(var b=0;b<g;++b)if(l[b]==d){var c=0,q=e;for(f=0;f<d;++f)c=c<<1|q&1,q>>=1;for(f=c;f<n;f+=h)a[f]=d<<16|b;++e}return[a,y]};H.prototype.readBlock=function(){function l(c,q,v,A,m){for(c=c.getBits(v)+A;0<c--;)q[e++]=m}var g=this.getBits(3);
g&1&&(this.eof=!0);g>>=1;if(0==g){var y=this.bytes,f=this.bytesPos,n;"undefined"==typeof(n=y[f++])&&Z("Bad block header in flate stream");var a=n;"undefined"==typeof(n=y[f++])&&Z("Bad block header in flate stream");a|=n<<8;"undefined"==typeof(n=y[f++])&&Z("Bad block header in flate stream");g=n;"undefined"==typeof(n=y[f++])&&Z("Bad block header in flate stream");(g|n<<8)!=(~a&65535)&&Z("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;n=this.bufferLength;g=this.ensureBuffer(n+
a);this.bufferLength=a=n+a;for(var d=n;d<a;++d){if("undefined"==typeof(n=y[f++])){this.eof=!0;break}g[d]=n}this.bytesPos=f}else{if(1==g)f=t,n=p;else if(2==g){g=this.getBits(5)+257;n=this.getBits(5)+1;y=this.getBits(4)+4;f=Array(S.length);for(var e=0;e<y;)f[S[e++]]=this.getBits(3);f=this.generateHuffmanTable(f);e=y=0;n=g+n;for(a=Array(n);e<n;)d=this.getCode(f),16==d?l(this,a,2,3,y):17==d?l(this,a,3,3,y=0):18==d?l(this,a,7,11,y=0):a[e++]=y=d;f=this.generateHuffmanTable(a.slice(0,g));n=this.generateHuffmanTable(a.slice(g,
n))}else Z("Unknown block type in flate stream");a=(g=this.buffer)?g.length:0;for(d=this.bufferLength;;){var h=this.getCode(f);if(256>h)d+1>=a&&(g=this.ensureBuffer(d+1),a=g.length),g[d++]=h;else{if(256==h){this.bufferLength=d;break}h-=257;h=P[h];var b=h>>16;0<b&&(b=this.getBits(b));y=(h&65535)+b;h=this.getCode(n);h=k[h];b=h>>16;0<b&&(b=this.getBits(b));h=(h&65535)+b;d+y>=a&&(g=this.ensureBuffer(d+y),a=g.length);for(b=0;b<y;++b,++d)g[d]=g[d-h]}}}};return H}()})})(M);return M.exports}();F=F.getDefaultExportFromCjs(z);
B.Zlib=F})},"esri/chunks/_commonjsHelpers":function(){define(["exports"],function(B){B.commonjsGlobal="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};B.getDefaultExportFromCjs=function(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F["default"]:F}})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg","../../../chunks/Zlib"],function(B,F){class M{static decode(N,
z=!1){const Q=new Uint8Array(N);N=new B.JpegImage;N.parse(Q);const {width:T,height:Z,numComponents:H,eof:S}=N,P=N.getData(T,Z,!0),k=T*Z;N=null;let t=0,p=0,l=0;if(!z&&S<Q.length-1)try{var g=(new F.Zlib(Q.subarray(S))).getBytes();N=new Uint8Array(k);for(t=z=0;t<g.length;t++)for(l=7;0<=l;l--)N[z++]=g[t]>>l&1}catch{}if(1===H&&P.length===T*Z)g=new Uint8Array(P.buffer),g=[g,g,g];else{g=[];for(t=0;3>t;t++)g.push(new Uint8Array(k));for(p=l=0;p<k;p++)for(t=0;3>t;t++)g[t][p]=P[l++]}return{width:T,height:Z,
pixels:g,mask:N}}}return M})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(B,F){var M={exports:{}},N,z=function(){if(N)return M.exports;N=1;(function(Q){(function(T){T=T();void 0!==T&&(Q.exports=T)})(function(){var T=function(){function Z(H){this.message="JPEG error: "+H}Z.prototype=Error();Z.prototype.name="JpegError";return Z.constructor=Z}();return function(){function Z(){this.decodeTransform=null;this.colorTransform=-1}function H(p,l){for(var g=0,y=[],f,n,a=16;0<
a&&!p[a-1];)a--;y.push({children:[],index:0});var d=y[0],e;for(f=0;f<a;f++){for(n=0;n<p[f];n++){d=y.pop();for(d.children[d.index]=l[g];0<d.index;)d=y.pop();d.index++;for(y.push(d);y.length<=f;)y.push(e={children:[],index:0}),d.children[d.index]=e.children,d=e;g++}f+1<a&&(y.push(e={children:[],index:0}),d.children[d.index]=e.children,d=e)}return y[0].children}function S(p,l,g,y,f,n,a,d,e){function h(){if(0<J)return J--,D>>J&1;D=p[l++];if(255===D){var ca=p[l++];if(ca)throw new T("unexpected marker "+
(D<<8|ca).toString(16));}J=7;return D>>>7}function b(ca){for(;;){ca=ca[h()];if("number"===typeof ca)return ca;if("object"!==typeof ca)throw new T("invalid huffman sequence");}}function c(ca){for(var ka=0;0<ca;)ka=ka<<1|h(),ca--;return ka}function q(ca){if(1===ca)return 1===h()?1:-1;var ka=c(ca);return ka>=1<<ca-1?ka:ka+(-1<<ca)+1}function v(ca,ka){var la=b(ca.huffmanTableDC);la=0===la?0:q(la);ca.blockData[ka]=ca.pred+=la;for(la=1;64>la;){var na=b(ca.huffmanTableAC),ea=na&15;na>>=4;if(0===ea){if(15>
na)break;la+=16}else la+=na,ca.blockData[ka+t[la]]=q(ea),la++}}function A(ca,ka){var la=b(ca.huffmanTableDC);la=0===la?0:q(la)<<e;ca.blockData[ka]=ca.pred+=la}function m(ca,ka){ca.blockData[ka]|=h()<<e}function r(ca,ka){if(0<u)u--;else for(var la=n;la<=a;){var na=b(ca.huffmanTableAC),ea=na&15;na>>=4;if(0===ea){if(15>na){u=c(na)+(1<<na)-1;break}la+=16}else la+=na,ca.blockData[ka+t[la]]=q(ea)*(1<<e),la++}}function C(ca,ka){for(var la=n,na=0,ea;la<=a;){ea=t[la];switch(x){case 0:na=b(ca.huffmanTableAC);
ea=na&15;na>>=4;if(0===ea)15>na?(u=c(na)+(1<<na),x=4):(na=16,x=1);else{if(1!==ea)throw new T("invalid ACn encoding");K=q(ea);x=na?2:3}continue;case 1:case 2:ca.blockData[ka+ea]?ca.blockData[ka+ea]+=h()<<e:(na--,0===na&&(x=2===x?3:0));break;case 3:ca.blockData[ka+ea]?ca.blockData[ka+ea]+=h()<<e:(ca.blockData[ka+ea]=K<<e,x=0);break;case 4:ca.blockData[ka+ea]&&(ca.blockData[ka+ea]+=h()<<e)}la++}4===x&&(u--,0===u&&(x=0))}var E=g.mcusPerLine,I=l,D=0,J=0,u=0,x=0,K,R=y.length,V,W,U,L;d=g.progressive?0===
n?0===d?A:m:0===d?r:C:v;var O=0;g=1===R?y[0].blocksPerLine*y[0].blocksPerColumn:E*g.mcusPerColumn;for(var X,aa;O<g;){var ba=f?Math.min(g-O,f):g;for(V=0;V<R;V++)y[V].pred=0;u=0;if(1===R){var fa=y[0];for(L=0;L<ba;L++)d(fa,64*((fa.blocksPerLine+1)*(O/fa.blocksPerLine|0)+O%fa.blocksPerLine)),O++}else for(L=0;L<ba;L++){for(V=0;V<R;V++)for(fa=y[V],X=fa.h,aa=fa.v,W=0;W<aa;W++)for(U=0;U<X;U++)d(fa,64*((fa.blocksPerLine+1)*((O/E|0)*fa.v+W)+(O%E*fa.h+U)));O++}J=0;(fa=k(p,l))&&fa.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+
fa.invalid),l=fa.offset);fa=fa&&fa.marker;if(!fa||65280>=fa)throw new T("marker was not found");if(65488<=fa&&65495>=fa)l+=2;else break}(fa=k(p,l))&&fa.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+fa.invalid),l=fa.offset);return l-I}function P(p,l){p=l.blocksPerLine;for(var g=l.blocksPerColumn,y=new Int16Array(64),f=0;f<g;f++)for(var n=0;n<p;n++){var a=void 0,d=void 0,e=void 0,h=void 0,b=void 0,c=void 0,q=void 0,v=void 0,A=b=c=h=d=a=void 0,m=void 0,r=void 0,C=void 0,
E=64*((l.blocksPerLine+1)*f+n),I=y,D=l.quantizationTable,J=l.blockData;if(!D)throw new T("missing required Quantization Table.");for(var u=0;64>u;u+=8)a=J[E+u],v=J[E+u+1],q=J[E+u+2],c=J[E+u+3],b=J[E+u+4],h=J[E+u+5],e=J[E+u+6],d=J[E+u+7],a*=D[u],0===(v|q|c|b|h|e|d)?(a=5793*a+512>>10,I[u]=a,I[u+1]=a,I[u+2]=a,I[u+3]=a,I[u+4]=a,I[u+5]=a,I[u+6]=a,I[u+7]=a):(v*=D[u+1],q*=D[u+2],c*=D[u+3],b*=D[u+4],h*=D[u+5],e*=D[u+6],d*=D[u+7],C=5793*a+128>>8,r=5793*b+128>>8,m=q,A=e,b=2896*(v-d)+128>>8,d=2896*(v+d)+128>>
8,c<<=4,h<<=4,C=C+r+1>>1,r=C-r,a=3784*m+1567*A+128>>8,m=1567*m-3784*A+128>>8,A=a,b=b+h+1>>1,h=b-h,d=d+c+1>>1,c=d-c,C=C+A+1>>1,A=C-A,r=r+m+1>>1,m=r-m,a=2276*b+3406*d+2048>>12,b=3406*b-2276*d+2048>>12,d=a,a=799*c+4017*h+2048>>12,c=4017*c-799*h+2048>>12,h=a,I[u]=C+d,I[u+7]=C-d,I[u+1]=r+h,I[u+6]=r-h,I[u+2]=m+c,I[u+5]=m-c,I[u+3]=A+b,I[u+4]=A-b);for(D=0;8>D;++D)a=I[D],v=I[D+8],q=I[D+16],c=I[D+24],b=I[D+32],h=I[D+40],e=I[D+48],d=I[D+56],0===(v|q|c|b|h|e|d)?(a=5793*a+8192>>14,a=-2040>a?0:2024<=a?255:a+2056>>
4,J[E+D]=a,J[E+D+8]=a,J[E+D+16]=a,J[E+D+24]=a,J[E+D+32]=a,J[E+D+40]=a,J[E+D+48]=a,J[E+D+56]=a):(C=5793*a+2048>>12,r=5793*b+2048>>12,m=q,A=e,b=2896*(v-d)+2048>>12,d=2896*(v+d)+2048>>12,C=(C+r+1>>1)+4112,r=C-r,a=3784*m+1567*A+2048>>12,m=1567*m-3784*A+2048>>12,A=a,b=b+h+1>>1,h=b-h,d=d+c+1>>1,c=d-c,C=C+A+1>>1,A=C-A,r=r+m+1>>1,m=r-m,a=2276*b+3406*d+2048>>12,b=3406*b-2276*d+2048>>12,d=a,a=799*c+4017*h+2048>>12,c=4017*c-799*h+2048>>12,h=a,a=C+d,d=C-d,v=r+h,e=r-h,q=m+c,h=m-c,c=A+b,b=A-b,a=16>a?0:4080<=a?
255:a>>4,v=16>v?0:4080<=v?255:v>>4,q=16>q?0:4080<=q?255:q>>4,c=16>c?0:4080<=c?255:c>>4,b=16>b?0:4080<=b?255:b>>4,h=16>h?0:4080<=h?255:h>>4,e=16>e?0:4080<=e?255:e>>4,d=16>d?0:4080<=d?255:d>>4,J[E+D]=a,J[E+D+8]=v,J[E+D+16]=q,J[E+D+24]=c,J[E+D+32]=b,J[E+D+40]=h,J[E+D+48]=e,J[E+D+56]=d)}return l.blockData}function k(p,l,g){var y=p.length-1;g=g<l?g:l;if(l>=y)return null;var f=p[l]<<8|p[l+1];if(65472<=f&&65534>=f)return{invalid:null,marker:f,offset:l};for(l=p[g]<<8|p[g+1];!(65472<=l&&65534>=l);){if(++g>=
y)return null;l=p[g]<<8|p[g+1]}return{invalid:f.toString(16),marker:l,offset:g}}if(!self||!self.Uint8ClampedArray)return null;var t=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);Z.prototype={parse:function(p){function l(){var D=p[f]<<8|p[f+1];f+=2;return D}function g(){var D=l();D=f+D-2;var J=k(p,D,f);J&&J.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+
J.invalid),D=J.offset);D=p.subarray(f,D);f+=D.length;return D}function y(D){for(var J=Math.ceil(D.samplesPerLine/8/D.maxH),u=Math.ceil(D.scanLines/8/D.maxV),x=0;x<D.components.length;x++){I=D.components[x];var K=Math.ceil(Math.ceil(D.samplesPerLine/8)*I.h/D.maxH),R=Math.ceil(Math.ceil(D.scanLines/8)*I.v/D.maxV);I.blockData=new Int16Array(64*u*I.v*(J*I.h+1));I.blocksPerLine=K;I.blocksPerColumn=R}D.mcusPerLine=J;D.mcusPerColumn=u}var f=0,n=null,a=null,d=[],e=[],h=[],b=l();if(65496!==b)throw new T("SOI not found");
for(b=l();65497!==b;){switch(b){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var c=g();65504===b&&74===c[0]&&70===c[1]&&73===c[2]&&70===c[3]&&0===c[4]&&(n={version:{major:c[5],minor:c[6]},densityUnits:c[7],xDensity:c[8]<<8|c[9],yDensity:c[10]<<8|c[11],thumbWidth:c[12],thumbHeight:c[13],thumbData:c.subarray(14,14+3*c[12]*c[13])});65518===b&&65===c[0]&&100===
c[1]&&111===c[2]&&98===c[3]&&101===c[4]&&(a={version:c[5]<<8|c[6],flags0:c[7]<<8|c[8],flags1:c[9]<<8|c[10],transformCode:c[11]});break;case 65499:b=l()+f-2;for(var q;f<b;){var v=p[f++],A=new Uint16Array(64);if(0===v>>4)for(c=0;64>c;c++)q=t[c],A[q]=p[f++];else if(1===v>>4)for(c=0;64>c;c++)q=t[c],A[q]=l();else throw new T("DQT - invalid table spec");d[v&15]=A}break;case 65472:case 65473:case 65474:if(m)throw new T("Only single frame JPEGs supported");l();var m={};m.extended=65473===b;m.progressive=
65474===b;m.precision=p[f++];m.scanLines=l();m.samplesPerLine=l();m.components=[];m.componentIds={};c=p[f++];for(b=A=v=0;b<c;b++){q=p[f];var r=p[f+1]>>4;var C=p[f+1]&15;v<r&&(v=r);A<C&&(A=C);r=m.components.push({h:r,v:C,quantizationId:p[f+2],quantizationTable:null});m.componentIds[q]=r-1;f+=3}m.maxH=v;m.maxV=A;y(m);break;case 65476:q=l();for(b=2;b<q;){v=p[f++];A=new Uint8Array(16);for(c=r=0;16>c;c++,f++)r+=A[c]=p[f];C=new Uint8Array(r);for(c=0;c<r;c++,f++)C[c]=p[f];b+=17+r;(0===v>>4?h:e)[v&15]=H(A,
C)}break;case 65501:l();var E=l();break;case 65498:l();q=p[f++];c=[];for(b=0;b<q;b++){v=m.componentIds[p[f++]];var I=m.components[v];v=p[f++];I.huffmanTableDC=h[v>>4];I.huffmanTableAC=e[v&15];c.push(I)}b=p[f++];q=p[f++];v=p[f++];b=S(p,f,m,c,E,b,q,v>>4,v&15);f+=b;break;case 65535:255!==p[f]&&f--;break;default:if(255===p[f-3]&&192<=p[f-2]&&254>=p[f-2])f-=3;else throw new T("unknown marker "+b.toString(16));}b=l()}this.width=m.samplesPerLine;this.height=m.scanLines;this.jfif=n;this.eof=f;this.adobe=
a;this.components=[];for(b=0;b<m.components.length;b++){I=m.components[b];if(n=d[I.quantizationId])I.quantizationTable=n;this.components.push({output:P(m,I),scaleX:I.h/m.maxH,scaleY:I.v/m.maxV,blocksPerLine:I.blocksPerLine,blocksPerColumn:I.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(p,l){var g=this.width/p,y=this.height/l,f,n,a=0,d=this.components.length,e=p*l*d,h=new Uint8ClampedArray(e),b=new Uint32Array(p);for(n=0;n<d;n++){var c=this.components[n];
var q=c.scaleX*g;var v=c.scaleY*y;a=n;var A=c.output;var m=c.blocksPerLine+1<<3;for(f=0;f<p;f++)c=0|f*q,b[f]=(c&4294967288)<<3|c&7;for(q=0;q<l;q++)for(c=0|q*v,c=m*(c&4294967288)|(c&7)<<3,f=0;f<p;f++)h[a]=A[c+b[f]],a+=d}if(l=this.decodeTransform)for(n=0;n<e;)for(p=c=0;c<d;c++,n++,p+=2)h[n]=(h[n]*l[p]>>8)+l[p+1];return h},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(p){for(var l,
g,y,f=0,n=p.length;f<n;f+=3)l=p[f],g=p[f+1],y=p[f+2],p[f]=l-179.456+1.402*y,p[f+1]=l+135.459-.344*g-.714*y,p[f+2]=l-226.816+1.772*g;return p},_convertYcckToRgb:function(p){for(var l,g,y,f,n=0,a=0,d=p.length;a<d;a+=4)l=p[a],g=p[a+1],y=p[a+2],f=p[a+3],p[n++]=-122.67195406894+g*(-6.60635669420364E-5*g+4.37130475926232E-4*y-5.4080610064599E-5*l+4.8449797120281E-4*f-.154362151871126)+y*(-9.57964378445773E-4*y+8.17076911346625E-4*l-.00477271405408747*f+1.53380253221734)+l*(9.61250184130688E-4*l-.00266257332283933*
f+.48357088451265)+f*(-3.36197177618394E-4*f+.484791561490776),p[n++]=107.268039397724+g*(2.19927104525741E-5*g-6.40992018297945E-4*y+6.59397001245577E-4*l+4.26105652938837E-4*f-.176491792462875)+y*(-7.78269941513683E-4*y+.00130872261408275*l+7.70482631801132E-4*f-.151051492775562)+l*(.00126935368114843*l-.00265090189010898*f+.25802910206845)+f*(-3.18913117588328E-4*f-.213742400323665),p[n++]=-20.810012546947+g*(-5.70115196973677E-4*g-2.63409051004589E-5*y+.0020741088115012*l-.00288260236853442*f+
.814272968359295)+y*(-1.53496057440975E-5*y-1.32689043961446E-4*l+5.60833691242812E-4*f-.195152027534049)+l*(.00174418132927582*l-.00255243321439347*f+.116935020465145)+f*(-3.43531996510555E-4*f+.24165260232407);return p},_convertYcckToCmyk:function(p){for(var l,g,y,f=0,n=p.length;f<n;f+=4)l=p[f],g=p[f+1],y=p[f+2],p[f]=434.456-l-1.402*y,p[f+1]=119.541-l+.344*g+.714*y,p[f+2]=481.816-l-1.772*g;return p},_convertCmykToRgb:function(p){for(var l,g,y,f,n=0,a=1/255,d=0,e=p.length;d<e;d+=4)l=p[d]*a,g=p[d+
1]*a,y=p[d+2]*a,f=p[d+3]*a,p[n++]=255+l*(-4.387332384609988*l+54.48615194189176*g+18.82290502165302*y+212.25662451639585*f-285.2331026137004)+g*(1.7149763477362134*g-5.6096736904047315*y-17.873870861415444*f-5.497006427196366)+y*(-2.5217340131683033*y-21.248923337353073*f+17.5119270841813)-f*(21.86122147463605*f+189.48180835922747),p[n++]=255+l*(8.841041422036149*l+60.118027045597366*g+6.871425592049007*y+31.159100130055922*f-79.2970844816548)+g*(-15.310361306967817*g+17.575251261109482*y+131.35250912493976*
f-190.9453302588951)+y*(4.444339102852739*y+9.8632861493405*f-24.86741582555878)-f*(20.737325471181034*f+187.80453709719578),p[n++]=255+l*(.8842522430003296*l+8.078677503112928*g+30.89978309703729*y-.23883238689178934*f-14.183576799673286)+g*(10.49593273432072*g+63.02378494754052*y+50.606957656360734*f-112.23884253719248)+y*(.03296041114873217*y+115.60384449646641*f-193.58209356861505)-f*(22.33816807309886*f+180.12613974708367);return p},getData:function(p,l,g){if(4<this.numComponents)throw new T("Unsupported color mode");
p=this._getLinearizedBlockData(p,l);if(1===this.numComponents&&g){g=p.length;l=new Uint8ClampedArray(3*g);for(var y=0,f=0;f<g;f++){var n=p[f];l[y++]=n;l[y++]=n;l[y++]=n}return l}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(p);if(4===this.numComponents){if(this._isColorConversionNeeded())return g?this._convertYcckToRgb(p):this._convertYcckToCmyk(p);if(g)return this._convertCmykToRgb(p)}return p}};return Z}()})})(M);return M.exports}();F=F.getDefaultExportFromCjs(z);
B.JpegImage=F})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(B,F,M){function N(H,S,P){P.set(H.slice(S,S+P.length))}function z(H){const {_malloc:S,_free:P,_lerc_getBlobInfo:k,_lerc_getDataRanges:t,_lerc_decode_4D:p,asm:l}=H;let g;const y=Object.values(l).find(n=>n&&"buffer"in n&&n.buffer===H.HEAPU8.buffer),f=n=>{n=n.map(e=>(e>>3<<3)+16);var a=n.reduce((e,h)=>e+h),d=S(a);g=new Uint8Array(y.buffer);a=n[0];n[0]=d;for(d=1;d<n.length;d++){const e=
n[d];n[d]=n[d-1]+a;a=e}return n};Z.getBlobInfo=n=>{var a=new Uint8Array(48),d=new Uint8Array(24);const [e,h,b]=f([n.length,a.length,d.length]);g.set(n,e);g.set(a,h);g.set(d,b);var c=k(e,n.length,h,b,12,3);if(c)throw P(e),Error(`lerc-getBlobInfo: error code is ${c}`);g=new Uint8Array(y.buffer);N(g,h,a);N(g,b,d);a=new Uint32Array(a.buffer);var q=new Float64Array(d.buffer);const [v,A,,m,r,C,E,I,D,J,u]=a;d={version:v,depthCount:J,width:m,height:r,validPixelCount:E,bandCount:C,blobSize:I,maskCount:D,dataType:A,
minValue:q[0],maxValue:q[1],maxZerror:q[2],statistics:[],bandCountWithNoData:u};if(u&&1<J)return P(e),d;if(1===J&&1===C)return P(e),d.statistics.push({minValue:q[0],maxValue:q[1]}),d;c=J*C*8;var x=new Uint8Array(c),K=new Uint8Array(c);a=e;var R=q=0;let V=!1;g.byteLength<e+2*c?(P(e),V=!0,[a,q,R]=f([n.length,c,c]),g.set(n,a)):[q,R]=f([c,c]);g.set(x,q);g.set(K,R);if(c=t(a,n.length,J,C,q,R))throw P(a),V||P(q),Error(`lerc-getDataRanges: error code is ${c}`);g=new Uint8Array(y.buffer);N(g,q,x);N(g,R,K);
n=new Float64Array(x.buffer);c=new Float64Array(K.buffer);K=d.statistics;for(x=0;x<C;x++)if(1<J){R=n.slice(x*J,(x+1)*J);const W=c.slice(x*J,(x+1)*J),U=Math.min.apply(null,R),L=Math.max.apply(null,W);K.push({minValue:U,maxValue:L,depthStats:{minValues:R,maxValues:W}})}else K.push({minValue:n[x],maxValue:c[x]});P(a);V||P(q);return d};Z.decode=(n,a)=>{const {maskCount:d,depthCount:e,bandCount:h,width:b,height:c,dataType:q,bandCountWithNoData:v}=a;var A=Q[q],m=b*c;a=new Uint8Array(m*h);A=new Uint8Array(m*
e*h*A.size);m=new Uint8Array(h);var r=new Uint8Array(8*h);const [C,E,I,D,J]=f([n.length,a.length,A.length,m.length,r.length]);g.set(n,C);g.set(a,E);g.set(A,I);g.set(m,D);g.set(r,J);if(n=p(C,n.length,d,E,e,b,c,h,q,I,D,J))throw P(C),Error(`lerc-decode: error code is ${n}`);g=new Uint8Array(y.buffer);N(g,I,A);N(g,E,a);n=null;if(v){N(g,D,m);N(g,J,r);n=[];r=new Float64Array(r.buffer);for(let u=0;u<m.length;u++)n.push(m[u]?r[u]:null)}P(C);return{data:A,maskData:a,noDataValues:n}}}const Q=[{pixelType:"S8",
size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,
1.7976931348623157E308]}];let T=null;const Z={getBlobInfo:null,decode:null};F.decode=function(H,S={}){var P=S.inputOffset??0;H=H instanceof Uint8Array?H.subarray(P):new Uint8Array(H,P);P=Z.getBlobInfo(H);const {data:k,maskData:t,noDataValues:p}=Z.decode(H,P),{width:l,height:g,bandCount:y,depthCount:f,dataType:n,maskCount:a,statistics:d}=P;var e=Q[n],h=new e.ctor(k.buffer);H=[];P=[];const b=l*g;var c=b*f;for(var q=0;q<y;q++){var v=h.subarray(q*c,(q+1)*c);if(S.returnInterleaved)H.push(v);else{a:{var A=
b,m=f;if(2>m)break a;const r=new e.ctor(A*m);for(let C=0,E=0;C<A;C++)for(let I=0,D=C;I<m;I++,D+=A)r[D]=v[E++];v=r}H.push(v)}P.push(t.subarray(q*c,(q+1)*c))}h=0===a?null:1===a?P[0]:new Uint8Array(b);if(1<a)for(h.set(P[0]),c=1;c<P.length;c++)for(q=P[c],v=0;v<b;v++)h[v]&=q[v];({noDataValue:S}=S);c=null!=S&&e.range[0]<=S&&e.range[1]>=S;if(0<a&&c)for(c=0;c<y;c++)for(q=H[c],v=P[c]||h,A=0;A<b;A++)0===v[A]&&(q[A]=S);({pixelType:e}=e);return{width:l,height:g,bandCount:y,pixelType:e,depthCount:f,statistics:d,
pixels:H,mask:h,bandMasks:a===y&&1<y?P:null,noDataValues:p}};F.getBlobInfo=function(H,S={}){H=H instanceof Uint8Array?H.subarray(S.inputOffset??0):new Uint8Array(H,S.inputOffset??0);return Z.getBlobInfo(H)};F.load=function(){return T?T:T=(new Promise((H,S)=>B(["../../../chunks/lerc-wasm"],H,S))).then(H=>H.lercWasm).then(({default:H})=>H({locateFile:S=>M.getAssetUrl(`esri/layers/support/rasterFormats/${S}`)})).then(H=>{z(H)})};F.pixelTypeInfoMap=Q;Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(B){function F(Q,T,Z,H=!0){if(0!==T%4||0!==Z%4){var S=new ArrayBuffer(4*Math.ceil(Z/4));S=new Uint8Array(S);Q=new Uint8Array(Q,T,Z);if(H)for(H=0;H<S.length;H+=4)S[H]=Q[H+3],S[H+1]=Q[H+2],S[H+2]=Q[H+1],S[H+3]=Q[H];else S.set(Q);return new Uint32Array(S.buffer)}if(H){H=new Uint8Array(Q,T,Z);S=new Uint8Array(H.length);for(Q=0;Q<S.length;Q+=4)S[Q]=H[Q+3],S[Q+1]=H[Q+2],S[Q+2]=H[Q+1],S[Q+3]=H[Q];return new Uint32Array(S.buffer)}return new Uint32Array(Q,
T,Z/4)}function M(){const Q=[];for(let T=0;257>=T;T++)Q[T]=[T];return Q}function N(Q,T){for(let Z=0;Z<T.length;Z++)Q.push(T[Z])}const z=new Set;z.add(511);z.add(1023);z.add(2047);z.add(4095);z.add(8191);B.decode=function(Q,T,Z,H=!0){Q=F(Q,T,Z,H);T=9;H=M();let S=32,P=H.length,k=[],t=1,p=Q[0],l=0;const g=Q.length;Z=8*(4*g-Z);const y=[];for(;null!=p;){if(S>=T)S-=T,l=p>>>32-T,p<<=T;else{l=p>>>32-S;p=Q[t++];var f=T-S;S=32-f;l=(l<<f)+(p>>>S);p<<=f}if(257===l)break;if(256===l)T=9,H=M(),P=H.length,k=[];else{f=
H[l];if(null==f){if(l>H.length)throw Error("data integrity issue: code does not exist on code page");k.push(k[0]);H[P++]=k.slice();N(y,k)}else N(y,f),k.push(f[0]),1<k.length&&(H[P++]=k.slice()),k=f.slice();z.has(P)&&T++;0===S&&(p=Q[t++],S=32);if(t>g||t===g&&S<=Z)break}}return new Uint8Array(y)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const B=M=>{let N=1;switch(M){case Uint8Array:case Int8Array:N=1;break;case Uint16Array:case Int16Array:N=
2;break;case Uint32Array:case Int32Array:case Float32Array:N=4;break;case Float64Array:N=8}return N};class F{static decode(M,N){var z=N.pixelType;const Q=[],T=N.width*N.height;var Z=Math.floor(M.byteLength/(N.width*N.height*B(N.pixelType)));const {bandIds:H,format:S}=N;N=H?.length||Math.floor(M.byteLength/(N.width*N.height*B(N.pixelType)));var P=M.byteLength-M.byteLength%(T*B(z)),k=new z(M,0,T*Z);let t,p,l,g,y=null;if("bip"===S)for(t=0;t<N;t++){l=new z(T);g=H?H[t]:t;for(p=0;p<T;p++)l[p]=k[p*Z+g];
Q.push(l)}else if("bsq"===S)for(t=0;t<N;t++)g=H?H[t]:t,Q.push(k.subarray(g*T,(g+1)*T));if(P<M.byteLength-1)if(M=M.slice(P),8*M.byteLength<T)y=null;else{M=new Uint8Array(M,0,Math.ceil(T/8));z=new Uint8Array(T);for(P=k=P=N=Z=0;P<M.length-1;P++)for(N=M[P],k=7;0<=k;k--)z[Z++]=N>>k&1;for(k=7;Z<T-1;)N=M[M.length-1],z[Z++]=N>>k&1,k--;y=z}return{pixels:Q,mask:y}}}return F})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../../../core/has ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S){function P(u,x){let K="unknown";3===u?K=64===x?"f64":"f32":1===u?1===x?K="u1":2===x?K="u2":4===x?K="u4":8>=x?K="u8":16>=x?K="u16":32>=x&&(K="u32"):2===u&&(8>=x?K="s8":16>=x?K="s16":32>=x&&(K="s32"));return K}function k(u){let x=null;switch(u?u.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":x=Uint8Array;break;case "u16":x=Uint16Array;break;case "u32":x=Uint32Array;break;case "s8":x=Int8Array;break;case "s16":x=Int16Array;break;case "s32":x=Int32Array;break;
case "f64":x=Float64Array;break;default:x=Float32Array}return x}function t(u,x){return{x:x[0]*u.x+x[1]*u.y+x[2],y:x[3]*u.x+x[4]*u.y+x[5]}}function p(u,x){return u.get(x)?.values?.[0]}function l(u,x,K,R=0,V=Z.tiffTags,W=4){var U=8===W;const L=U?v(new DataView(u,K,8),0,x):(new DataView(u,K,2)).getUint16(0,x),O=4+2*W;var X=U?8:2;U=X+L*O;if(K+U>u.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:U};const aa=K+U+4<=u.byteLength?A(new DataView(u,K+U,8===W?8:4),0,x,8===W):null;K+=X;X=
new Map;let ba,fa,ca,ka=0,la=0;for(let ea=0;ea<L;ea++){var na=new DataView(u,K+O*ea,O);ba=na.getUint16(0,x);ca=na.getUint16(2,x);fa=Z.getTagName(ba,V);const ia=[];2===W?(ka=na.getUint16(4,x),la=na.getUint16(6,x)):4===W?(ka=na.getUint32(4,x),la=na.getUint32(8,x)):8===W&&(ka=A(na,4,x,!0),la=A(na,12,x,!0),ia.push(na.getUint32(12,x)),ia.push(na.getUint32(16,x)));na={id:ba,type:ca,valueCount:ka,valueOffset:la,valueOffsets:ia,values:null};d(u,x,na,R,!1,W);X.set(fa,na)}return{success:!0,ifd:X,nextIFD:aa,
requiredBufferSize:U}}function g(u,x){if(1!==x&&2!==x&&4!==x)return u;const K=new Uint8Array(u),R=8/x;u=new Uint8Array(u.byteLength*R);let V=0;const W=2**x-1;for(let U=0;U<K.length;U++){const L=K[U];for(let O=0;O<R;O++)u[V++]=L<<x*O>>>8-x&W}return u.buffer}function y(u,x,K){const R=new N.JpegImage;R.parse(u);R.colorTransform=6===K?-1:0;u=R.getData(R.width,R.height,1!==x&&4!==x);return new Uint8Array(u.buffer)}function f(u){u=(new S.Zlib(u)).getBytes();var x=new ArrayBuffer(u.length);x=new Uint8Array(x);
x.set(u);return x}async function n(u,x,K,R,V){var W=H.isPlatformLittleEndian===x,U=p(K,"BITSPERSAMPLE"),L=p(K,"SAMPLESPERPIXEL")??1,O=p(K,"PHOTOMETRICINTERPRETATION"),X=p(K,"SAMPLEFORMAT")??1,aa=P(X,U),ba=p(K,"COMPRESSION")??1,fa=k(aa);if(34887===ba)return await z.load(),z.decode(u,{inputOffset:R}).pixels[0];if(1===ba)O=u.slice(R,R+V),x=new Uint8Array(O);else if(8===ba||32946===ba)x=new Uint8Array(u,R,V),x=f(x),O=x.buffer;else if(6===ba)x=new Uint8Array(u,R,V),x=y(x,L,O),O=x.buffer;else if(7===ba){const ca=
K.get("JPEGTABLES").values,ka=ca.length-2;x=new Uint8Array(ka+V-2);for(let la=0;la<ka;la++)x[la]=ca[la];u=new Uint8Array(u,R+2,V-2);for(R=0;R<u.length;R++)x[ka+R]=u[R];x=y(x,L,O);O=x.buffer}else if(5===ba)x=Q.decode(u,R,V,x),O=x.buffer;else throw Error("tiff-decode: unsupport compression "+ba);O=g(O,U);if("u8"!==aa&&"s8"!==aa&&!W)switch(O=new ArrayBuffer(x.length),W=new Uint8Array(O),aa){case "u16":case "s16":for(aa=0;aa<x.length;aa+=2)W[aa]=x[aa+1],W[aa+1]=x[aa];break;case "u32":case "s32":case "f32":for(aa=
0;aa<x.length;aa+=4)W[aa]=x[aa+3],W[aa+1]=x[aa+2],W[aa+2]=x[aa+1],W[aa+3]=x[aa]}U=new fa(O);W=p(K,"PREDICTOR")??1;aa=p(K,"TILEWIDTH");x=p(K,"TILELENGTH");if(1<W&&(5===ba||8===ba||32946===ba)&&aa&&x){ba=h(K);fa=new fa(U.length);fa.set(U);K=3===X&&3===W;ba=ba?1:L;L=K?4:1;X=aa*L*ba;K&&(fa=new Uint8Array(fa.buffer));for(W=0;W<x;W++)for(U=W*X,O=ba;O<X;O++)fa[U+O]+=fa[U+O-ba];if(K){K=new Uint8Array(fa.length);ba*=aa;for(aa=0;aa<x;aa++)for(W=aa*X,U=0;U<ba;U++)for(O=0;O<L;O++)K[W+U*L+O]=fa[W+U+(L-O-1)*ba];
U=new Float32Array(K.buffer)}else U=fa}return U}async function a(u,x,K){const R=K.get("TILEOFFSETS")?.values;if(void 0===R)return null;const V=K.get("TILEBYTECOUNTS")?.values,{width:W,height:U,pixelType:L,tileWidth:O,tileHeight:X}=e([K]);var aa=h(K,x);const ba=p(K,"SAMPLESPERPIXEL")||x.planes;var fa=W*U,ca=p(K,"BITSPERSAMPLE"),ka=34887===(p(K,"COMPRESSION")??1),la=k(L);const na=[];for(var ea=0;ea<ba;ea++)na.push(new la(fa));let ia,w,G,Y,da,ja,ha,oa,ma;la=Math.ceil(W/O);fa=(new Uint8Array(fa)).fill(255);
ea=!1;if(0===ca%8)if(ka&&aa&&1<ba)for(aa=Math.round(R.length/ba),ca=0;ca<aa;ca++){var qa=Math.floor(ca/la)*X;G=ca%la*O;Y=qa*W+G;for(ka=0;ka<ba;ka++){var pa=ca*ba+ka;0===V[pa]?(pa=null,ea=!0):pa=await n(u,x.littleEndian,K,R[pa],V[pa]);ja=0;da=Y;oa=Math.min(O,W-G);ha=Math.min(X,U-qa);ma=na[ka];for(ia=0;ia<ha;ia++)for(da=Y+ia*W,ja=ia*O,w=0;w<oa;w++,da++,ja++)pa?ma[da]=pa[ja]:fa[da]=0}}else for(ca=0;ca<R.length;ca++)for(qa=Math.floor(ca/la)*X,G=ca%la*O,Y=qa*W+G,0===V[ca]?(pa=null,ea=!0):pa=await n(u,
x.littleEndian,K,R[ca],V[ca]),ja=0,da=Y,oa=Math.min(O,W-G),ha=Math.min(X,U-qa),qa=0;qa<ba;qa++)if(ma=na[qa],aa||ka)for(ia=0;ia<ha;ia++)for(da=Y+ia*W,ja=O*X*qa+ia*O,w=0;w<oa;w++,da++,ja++)pa?ma[da]=pa[ja]:fa[da]=0;else for(ia=0;ia<ha;ia++)for(da=Y+ia*W,ja=ia*O*ba+qa,w=0;w<oa;w++,da++,ja+=ba)pa?ma[da]=pa[ja]:fa[da]=0;return{width:W,height:U,pixelType:L,pixels:na,mask:ea?fa:void 0}}function d(u,x,K,R=0,V=!1,W=4){if(K.values)return!0;var U=K.type,L=K.valueCount,O=K.valueOffset;let X=[];var aa=E[U],ba=
8*aa,fa=L*aa,ca=L*E[U]*8,ka=8===W?64:32;W=K.valueOffsets;if(ca>ka&&fa>(V?u.byteLength:u?u.byteLength-O+R:0))return K.offlineOffsetSize=[O,fa],K.values=null,!1;if(ca<=ka)if(x||(32>=ka?O>>>=32-ca:(u=W?.length?W[0]:O>>>0,x=W?.length?W[1]:Math.round((O-u)/4294967296),32>=ca?(O=u>>>32-ca,W[0]=O):(O=u*2**(32-ca)+(x>>>32-ca),W[0]=u,W[1]=x>>>32-ca))),1===L&&ba===ka)X=[O];else if(64===ka)for(u=W?.length?W[0]:O>>>0,O=W?.length?W[1]:Math.round((O-u)/4294967296),x=u,aa=32,u=1;u<=L;u++)fa=32-ba*u%32,aa<ba?(fa=
x<<fa>>>32-aa,ca=O<<32-aa>>>32-aa,x=O,X.push(fa+ca*2**(ba-aa)),aa-=32-(ba-aa)):(X.push(x<<fa>>>32-ba),aa-=ba),0===aa&&(aa=32,x=O);else for(u=1;u<=L;u++)X.push(O<<32-ba*u>>>32-ba);else for(O-=R,V&&(O=0),L=O;L<O+fa;L+=aa){switch(U){case 1:ba=(new DataView(u,L,1)).getUint8(0);break;case 2:ba=(new DataView(u,L,1)).getUint8(0);break;case 3:ba=(new DataView(u,L,2)).getUint16(0,x);break;case 4:case 13:ba=(new DataView(u,L,4)).getUint32(0,x);break;case 5:ba=(new DataView(u,L,4)).getUint32(0,x)/(new DataView(u,
L+4,4)).getUint32(0,x);break;case 6:ba=(new DataView(u,L,1)).getInt8(0);break;case 7:ba=(new DataView(u,L,1)).getUint8(0);break;case 8:ba=(new DataView(u,L,2)).getInt16(0,x);break;case 9:ba=(new DataView(u,L,4)).getInt32(0,x);break;case 10:ba=(new DataView(u,L,4)).getInt32(0,x)/(new DataView(u,L+4,4)).getInt32(0,x);break;case 11:ba=(new DataView(u,L,4)).getFloat32(0,x);break;case 12:ba=(new DataView(u,L,8)).getFloat64(0,x);break;case 16:case 18:ba=v(new DataView(u,L,8),0,x);break;case 17:W=new DataView(u,
L,8);ca=(ba=x)?W.getInt32(0,ba):W.getUint32(0,ba);W=ba?W.getUint32(4,ba):W.getInt32(4,ba);ka=0<=(ba?ca:W)?1:-1;ba?ca*=ka:W*=ka;ba=ka*(ba?4294967296*W+ca:4294967296*ca+W);break;default:ba=null}X.push(ba)}if(2===U){U="";O=X;X=[];for(u=0;u<O.length;u++)0===O[u]&&""!==U?(X.push(U),U=""):U+=String.fromCharCode(O[u]);""===U&&0!==X.length||X.push(U)}K.values=X;return!0}function e(u){var x=u[0];const K=p(x,"TILEWIDTH"),R=p(x,"TILELENGTH"),V=p(x,"IMAGEWIDTH"),W=p(x,"IMAGELENGTH");var U=p(x,"BITSPERSAMPLE");
const L=p(x,"SAMPLESPERPIXEL");var O=p(x,"SAMPLEFORMAT")??1;const X=P(O,U),aa=h(x);var ba=x.get("GDAL_NODATA")?.values;let fa=null;ba?.length&&(fa=ba.map(ma=>parseFloat(ma)),fa.some(ma=>isNaN(ma))&&(fa=null));var ca=p(x,"COMPRESSION")??1;switch(ca){case 1:ba="NONE";break;case 2:case 3:case 4:case 32771:ba="CCITT";break;case 5:ba="LZW";break;case 6:case 7:ba="JPEG";break;case 32773:ba="PACKBITS";break;case 8:case 32946:ba="DEFLATE";break;case 34712:ba="JPEG2000";break;case 34887:ba="LERC";break;default:ba=
String(ca)}let ka=!0,la="";I.has(ca)||(ka=!1,la+="unsupported tag compression "+ca);3<O&&(ka=!1,la+="unsupported tag sampleFormat "+O);1!==U&&2!==U&&4!==U&&0!==U%8&&(ka=!1,la+="unsupported tag bitsPerSample "+U);U=x.get("GEOASCIIPARAMS")?.values?.[0];if(U){U=(U=U.split("|").find(ma=>ma.includes("ESRI PE String \x3d ")))?U.replace("ESRI PE String \x3d ",""):"";var na=U.startsWith("COMPD_CS")||U.startsWith("PROJCS")||U.startsWith("GEOGCS")?{wkid:null,wkt:U}:null}O=x.get("GEOTIEPOINTS")?.values;U=x.get("GEOPIXELSCALE")?.values;
ca=x.get("GEOTRANSMATRIX")?.values;var ea=x.has("GEOKEYDIRECTORY")?x.get("GEOKEYDIRECTORY").data:null,ia=!1;x=!1;if(ea){ia=2===p(ea,"GTRasterTypeGeoKey");var w=p(ea,"GTModelTypeGeoKey");2===w?(ea=p(ea,"GeographicTypeGeoKey"),1024<=ea&&32766>=ea&&(na={wkid:ea}),na||32767!==ea||(x=!0,na={wkid:4326})):1===w&&(ea=p(ea,"ProjectedCSTypeGeoKey"),1024<=ea&&32766>=ea&&(na={wkid:ea}))}let G;U&&O&&6<=O.length?(G=[U[0],0,O[3]-O[0]*U[0],0,-Math.abs(U[1]),O[4]-O[1]*U[1]],ia&&(G[2]-=.5*G[0]+.5*G[1],G[5]-=.5*G[3]+
.5*G[4])):ca&&16===ca.length&&(G=ia?[ca[0],ca[1],ca[3]-.5*ca[0],ca[4],ca[5],ca[7]-.5*ca[5]]:[ca[0],ca[1],ca[3],ca[4],ca[5],ca[7]]);if(G){O=[{x:0,y:W},{x:0,y:0},{x:V,y:W},{x:V,y:0}];ea=ia=Number.POSITIVE_INFINITY;let ma=w=Number.NEGATIVE_INFINITY;for(let qa=0;qa<O.length;qa++)ca=t(O[qa],G),ia=ca.x>ia?ia:ca.x,w=ca.x<w?w:ca.x,ea=ca.y>ea?ea:ca.y,ma=ca.y<ma?ma:ca.y;O={xmin:ia,xmax:w,ymin:ea,ymax:ma,spatialReference:na}}else O={xmin:-.5,ymin:.5-W,xmax:V-.5,ymax:.5,spatialReference:na};x&&(400<O.xmax-O.xmin||
361<Math.max(Math.abs(O.xmin),Math.abs(O.xmax)))&&(na=null,O.spatialReference=null);na=b(u);let Y;let da,ja;if(0<na.length){da=Math.round(Math.log(V/p(na[0],"IMAGEWIDTH"))/Math.LN2);var ha=na[na.length-1];ja=na.length;Y=p(ha,"TILEWIDTH");ha=p(ha,"TILELENGTH")}Y=null!=ja&&0<ja?Y||K:null;ha=null!=ja&&0<ja?ha||R:null;let oa;K&&(oa=[{maxCol:Math.ceil(V/K)-1,maxRow:Math.ceil(W/R)-1,minRow:0,minCol:0}],na.forEach(ma=>{oa.push({maxCol:Math.ceil(p(ma,"IMAGEWIDTH")/p(ma,"TILEWIDTH"))-1,maxRow:Math.ceil(p(ma,
"IMAGELENGTH")/p(ma,"TILELENGTH"))-1,minRow:0,minCol:0})}));ca=u[0].get("GDAL_METADATA")?.values?.[0];ca=J(ca);la+=" "+C({width:V,height:W,tileWidth:K,tileHeight:R,planes:L,ifds:u});u=c(u).length===na.length+1;na=na?.length?na.map(ma=>{const qa=V/p(ma,"IMAGEWIDTH");ma=W/p(ma,"IMAGELENGTH");return{x:qa,y:ma}}):void 0;return{width:V,height:W,tileWidth:K,tileHeight:R,planes:L,isBSQ:aa,pixelType:X,compression:ba,noData:fa,hasMaskBand:u,isSupported:ka,pyramidResolutions:na,message:la,extent:O,isPseudoGeographic:x,
affine:U?null:G,firstPyramidLevel:da,maximumPyramidLevel:ja,pyramidBlockWidth:Y,pyramidBlockHeight:ha,tileBoundary:oa,metadata:ca}}function h(u,x){return(u=u.get("PLANARCONFIGURATION")?.values)?2===u[0]:x?x.isBSQ:!1}function b(u){return u.filter(x=>1===p(x,"NEWSUBFILETYPE"))}function c(u){return u.filter(x=>{const K=4===((p(x,"NEWSUBFILETYPE")??0)&4);x=4===p(x,"PHOTOMETRICINTERPRETATION");return K&&x})}function q(u){const {littleEndian:x,isBigTiff:K,firstIFDPos:R}=m(u);var V=R;const W=[];do if(V=
r(u,x,V,0,Z.tiffTags,K?8:4),V.success)W.push(V.ifd),V=V.nextIFD;else break;while(0<V);u=e(W);V=b(W);const U=c(W);return{...u,littleEndian:x,isBigTiff:K,ifds:W,pyramidIFDs:V,maskIFDs:U}}function v(u,x,K){const R=u.getUint32(x,K);u=u.getUint32(x+4,K);return K?4294967296*u+R:4294967296*R+u}function A(u,x,K,R){return R?v(u,x,K):u.getUint32(x,K)}function m(u){var x=new DataView(u,0,16),K=x.getUint16(0,!1);u=null;if(18761===K)u=!0;else if(19789===K)u=!1;else throw Error("unexpected endianess byte");var R=
x.getUint16(2,u);if(42!==R&&43!==R)throw Error("unexpected tiff identifier");K=4;if(R=43===R){const V=x.getUint16(K,u);K+=2;if(8!==V)throw Error("unsupported bigtiff version");if(0!==x.getUint16(K,u))throw Error("unsupported bigtiff version");K+=2}x=A(x,K,u,R);return{littleEndian:u,isBigTiff:R,firstIFDPos:x}}function r(u,x,K,R=0,V=Z.tiffTags,W=4){K=l(u,x,K,R,V,W);let U;const L=K.ifd;L&&(Z.ifdTags.forEach((O,X)=>{L.has(X)&&(U=L.get(X),U.data=l(u,x,U.valueOffset-R,R,O).ifd)}),L.has("GEOKEYDIRECTORY")&&
(U=L.get("GEOKEYDIRECTORY"),(V=U.values)&&4<V.length&&(V=V[0]+"."+V[1]+"."+V[2],U.data=l(u,x,U.valueOffset+6-R,R,Z.geoKeys,2).ifd,U.data&&U.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[V]}))),L.has("XMP")&&(U=L.get("XMP"),V=U.values,"number"===typeof V[0]&&7===U.type&&(U.values=[M.bytesToUTF8(new Uint8Array(V))])));return K}function C(u){const {width:x,height:K,tileHeight:R,tileWidth:V}=u,W=u.planes,U=V?V*R:x*K;u=p(u.ifds[0],"BITSPERSAMPLE");let L="";U*W>2**30/(8<u?
u/8:1)&&(L=V?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return L}const E=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],I=new Set([1,5,6,7,8,34712,34887]),D=(u,x,K)=>{if(!(u&&0<u.length&&x&&K))return null;let R,V,W;const U=u[0].length,L=u.length,O=new Uint8Array(U);for(let aa=0;aa<L;aa++)if(R=u[aa],V=x[aa],W=K[aa],0===aa)for(var X=0;X<U;X++)O[X]=R[X]<V||R[X]>W?0:1;else for(X=0;X<U;X++)O[X]&&(O[X]=R[X]<V||R[X]>W?0:1);return O},J=u=>
{if(!u)return null;var x=u.match(/<Item(.*?)Item>/gi);if(!x||0===x.length)return null;u=new Map;var K;for(var R=0;R<x.length;R++){var V=x[R];var W=V.slice(6,V.indexOf("\x3e"));var U=V.indexOf("sample\x3d");-1<U&&(K=V.slice(U+8,V.indexOf('"',U+8)));U=V.indexOf("name\x3d");-1<U&&(W=V.slice(U+6,V.indexOf('"',U+6)));W&&(V=V.slice(V.indexOf("\x3e")+1,V.indexOf("\x3c/Item\x3e")).trim(),null!=K?u.has(W)?u.get(W)[K]=V:u.set(W,[V]):u.set(W,V));K=null}x=u.get("STATISTICS_MINIMUM");W=u.get("STATISTICS_MAXIMUM");
R=u.get("STATISTICS_MEAN");V=u.get("STATISTICS_STDDEV");K=null;if(x&&W)for(K=[],U=0;U<x.length;U++)K.push({min:parseFloat(x[U]),max:parseFloat(W[U]),avg:R&&parseFloat(R[U]),stddev:V&&parseFloat(V[U])});W=u.get("BandName");R=u.get("WavelengthMin");V=u.get("WavelengthMax");x=null;if(W)for(x=[],U=0;U<W.length;U++)x.push({BandName:W[U],WavelengthMin:R&&parseFloat(R[U]),WavelengthMax:V&&parseFloat(V[U])});W=u.get("DataType");return{statistics:K,bandProperties:x,dataType:W,rawMetadata:u}};B.decode=async function(u,
x={}){var K=x.pyramidLevel||0,R=x.headerInfo||q(u);const {ifds:V,noData:W}=R;if(0===V.length)throw Error("no valid image file directory");var U=C(R);if(U)throw U;U=null;var L=-1===K?V[V.length-1]:V[K];x=W??x.noDataValue;if(R.tileWidth)U=await a(u,R,L);else{{const ja=H.isPlatformLittleEndian===R.littleEndian,ha=L.get("STRIPOFFSETS")?.values;if(void 0===ha)U=null;else{var {width:O,height:X,pixelType:aa}=e([L]);K=p(L,"SAMPLESPERPIXEL")||R.planes;var ba=p(L,"PHOTOMETRICINTERPRETATION");U=O*X;var fa=p(L,
"BITSPERSAMPLE"),ca=k(aa),ka=new ca(U*K),la=L.get("STRIPBYTECOUNTS")?.values,na=p(L,"ROWSPERSTRIP"),ea=p(L,"COMPRESSION")??1,ia;if(0===fa%8)for(L=0;L<ha.length;L++){var w=L*na*O*K;if("u8"===aa||"s8"===aa||ja)if(8===ea||32946===ea){var G=new Uint8Array(u,ha[L],la[L]);G=f(G);var Y=G.buffer}else 6===ea?(G=new Uint8Array(u,ha[L],la[L]),G=y(G,K,ba),Y=G.buffer):5===ea?(G=Q.decode(u,ha[L],la[L],R.littleEndian),Y=G.buffer):Y=u.slice(ha[L],ha[L]+la[L]);else{if(6===ea||8===ea||32946===ea){G=new Uint8Array(u,
ha[L],la[L]);var da=f(G);Y=da.buffer}else Y=new ArrayBuffer(la[L]),G=new Uint8Array(u,ha[L],la[L]),da=new Uint8Array(Y);switch(aa){case "u16":case "s16":for(ia=0;ia<G.length;ia+=2)da[ia]=G[ia+1],da[ia+1]=G[ia];break;case "u32":case "s32":case "f32":for(ia=0;ia<G.length;ia+=4)da[ia]=G[ia+3],da[ia+1]=G[ia+2],da[ia+2]=G[ia+1],da[ia+3]=G[ia]}}Y=g(Y,fa);ia=new ca(Y);ka.set(ia,w)}ba=[];if(1===K)ba.push(ka);else for(L=0;L<K;L++){R=new ca(U);for(u=0;u<U;u++)R[u]=ka[u*K+L];ba.push(R)}U={width:O,height:X,pixelType:aa,
pixels:ba}}}}if(!U)return U;null!=x&&T.convertNoDataToMask(U,x);return U};B.decodeTileOrStrip=async function(u,x){const {headerInfo:K,ifd:R,offsets:V,sizes:W}=x;var U=[];for(var L=0;L<V.length;L++){0===W[L]?1:0;var O=await n(u,K.littleEndian,R,V[L],W[L]||u.byteLength);U.push(O)}var X=h(R,K);u=p(R,"BITSPERSAMPLE");L=p(R,"SAMPLEFORMAT")??1;L=P(L,u);var aa=p(R,"SAMPLESPERPIXEL")||K.planes;const ba=k(L);O=p(R,"TILEWIDTH");const fa=p(R,"TILELENGTH");var ca=p(R,"COMPRESSION")??1;const ka=O*fa;u=[];let la=
U[0];const na=34887===ca;for(let ea=0;ea<aa;ea++){ca=new ba(ka);if(U.length===aa)la=U[ea],la.length===ka&&(ca=la);else if(la.length)if(X||na)ca=la.length===ka?la:la.slice(ka*ea,ka*(ea+1));else for(let ia=0;ia<ka;ia++)ca[ia]=la[ia*aa+ea];u.push(ca)}U=K.noData?K.noData[0]:x.noDataValue;X=(aa=K.metadata?K.metadata.statistics:null)?aa.map(ea=>ea.min):null;aa=aa?aa.map(ea=>ea.max):null;L={pixelType:L,width:O,height:fa,pixels:u,noDataValue:U};null!=U?T.convertNoDataToMask(L,U):X&&aa&&x.applyMinMaxConstraint&&
(L.mask=D(u,X,aa));return L};B.getImageInfo=e;B.getMaskIFDs=c;B.getPyramidIFDs=b;B.isBSQConfig=h;B.parseFieldValues=d;B.parseHeader=q;B.parseIFD=r;B.parseSignature=m;Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(B){B.bytesToUTF8=function(F,M){let N=0,z="",Q=0,T=0;const Z=F.length;for(;N<Z;)if(T=F[N++],Q=T>>4,8>Q?Q=1:15===Q?(Q=4,T=(T&7)<<18|(F[N++]&63)<<12|(F[N++]&63)<<6|F[N++]&63):14===Q?
(Q=3,T=(T&15)<<12|(F[N++]&63)<<6|F[N++]&63):(Q=2,T=(T&31)<<6|F[N++]&63),0!==T||M)z+=String.fromCharCode(T);return z};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const B=(()=>{const z=[];z[254]="NEWSUBFILETYPE";z[255]="SUBFILETYPE";z[256]="IMAGEWIDTH";z[257]="IMAGELENGTH";z[258]="BITSPERSAMPLE";z[259]="COMPRESSION";z[262]="PHOTOMETRICINTERPRETATION";z[263]="THRESHHOLDING";z[264]="CELLWIDTH";z[265]="CELLLENGTH";
z[266]="FILLORDER";z[269]="DOCUMENTNAME";z[270]="IMAGEDESCRIPTION";z[271]="MAKE";z[272]="MODEL";z[273]="STRIPOFFSETS";z[274]="ORIENTATION";z[277]="SAMPLESPERPIXEL";z[278]="ROWSPERSTRIP";z[279]="STRIPBYTECOUNTS";z[280]="MINSAMPLEVALUE";z[281]="MAXSAMPLEVALUE";z[282]="XRESOLUTION";z[283]="YRESOLUTION";z[284]="PLANARCONFIGURATION";z[285]="PAGENAME";z[286]="XPOSITION";z[287]="YPOSITION";z[288]="FREEOFFSETS";z[289]="FREEBYTECOUNTS";z[290]="GRAYRESPONSEUNIT";z[291]="GRAYRESPONSECURVE";z[292]="T4OPTIONS";
z[293]="T6OPTIONS";z[296]="RESOLUTIONUNIT";z[297]="PAGENUMBER";z[300]="COLORRESPONSEUNIT";z[301]="TRANSFERFUNCTION";z[305]="SOFTWARE";z[306]="DATETIME";z[315]="ARTIST";z[316]="HOSTCOMPUTER";z[317]="PREDICTOR";z[318]="WHITEPOINT";z[319]="PRIMARYCHROMATICITIES";z[320]="COLORMAP";z[321]="HALFTONEHINTS";z[322]="TILEWIDTH";z[323]="TILELENGTH";z[324]="TILEOFFSETS";z[325]="TILEBYTECOUNTS";z[326]="BADFAXLINES";z[327]="CLEANFAXDATA";z[328]="CONSECUTIVEBADFAXLINES";z[330]="SUBIFD";z[332]="INKSET";z[333]="INKNAMES";
z[334]="NUMBEROFINKS";z[336]="DOTRANGE";z[337]="TARGETPRINTER";z[338]="EXTRASAMPLES";z[339]="SAMPLEFORMAT";z[340]="SMINSAMPLEVALUE";z[341]="SMAXSAMPLEVALUE";z[342]="TRANSFERRANGE";z[347]="JPEGTABLES";z[512]="JPEGPROC";z[513]="JPEGIFOFFSET";z[514]="JPEGIFBYTECOUNT";z[515]="JPEGRESTARTINTERVAL";z[517]="JPEGLOSSLESSPREDICTORS";z[518]="JPEGPOINTTRANSFORM";z[519]="JPEGQTABLES";z[520]="JPEGDCTABLES";z[521]="JPEGACTABLES";z[529]="YCBCRCOEFFICIENTS";z[530]="YCBCRSUBSAMPLING";z[531]="YCBCRPOSITIONING";z[532]=
"REFERENCEBLACKWHITE";z[700]="XMP";z[33550]="GEOPIXELSCALE";z[33922]="GEOTIEPOINTS";z[33432]="COPYRIGHT";z[42112]="GDAL_METADATA";z[42113]="GDAL_NODATA";z[50844]="RPCCOEFFICIENT";z[34264]="GEOTRANSMATRIX";z[34735]="GEOKEYDIRECTORY";z[34736]="GEODOUBLEPARAMS";z[34737]="GEOASCIIPARAMS";z[34665]="EXIFIFD";z[34853]="GPSIFD";z[40965]="INTEROPERABILITYIFD";return z})(),F=(()=>{const z=B.slice();z[36864]="ExifVersion";z[40960]="FlashpixVersion";z[40961]="ColorSpace";z[42240]="Gamma";z[37121]="ComponentsConfiguration";
z[37122]="CompressedBitsPerPixel";z[40962]="PixelXDimension";z[40963]="PixelYDimension";z[37500]="MakerNote";z[37510]="UserComment";z[40964]="RelatedSoundFile";z[36867]="DateTimeOriginal";z[36868]="DateTimeDigitized";z[36880]="OffsetTime";z[36881]="OffsetTimeOriginal";z[36882]="OffsetTimeDigitized";z[37520]="SubSecTime";z[37521]="SubSecTimeOriginal";z[37522]="SubSecTimeDigitized";z[37888]="Temperature";z[37889]="Humidity";z[37890]="Pressure";z[37891]="WaterDepth";z[37892]="Acceleration";z[37893]=
"CameraElevationAngle";z[42016]="ImageUniqueID";z[42032]="CameraOwnerName";z[42033]="BodySerialNumber";z[42034]="LensSpecification";z[42035]="LensMake";z[42036]="LensModel";z[42037]="LensSerialNumber";z[33434]="ExposureTime";z[33437]="FNumber";z[34850]="ExposureProgram";z[34852]="SpectralSensitivity";z[34855]="PhotographicSensitivity";z[34856]="OECF";z[34864]="SensitivityType";z[34865]="StandardOutputSensitivity";z[34866]="RecommendedExposureIndex";z[34867]="ISOSpeed";z[34868]="ISOSpeedLatitudeyyy";
z[34869]="ISOSpeedLatitudezzz";z[37377]="ShutterSpeedValue";z[37378]="ApertureValue";z[37379]="BrightnessValue";z[37380]="ExposureBiasValue";z[37381]="MaxApertureValue";z[37382]="SubjectDistance";z[37383]="MeteringMode";z[37384]="LightSource";z[37385]="Flash";z[37386]="FocalLength";z[37396]="SubjectArea";z[41483]="FlashEnergy";z[41484]="SpatialFrequencyResponse";z[41486]="FocalPlaneXResolution";z[41487]="FocalPlaneYResolution";z[41488]="FocalPlaneResolutionUnit";z[41492]="SubjectLocation";z[41493]=
"ExposureIndex";z[41495]="SensingMethod";z[41728]="FileSource";z[41729]="SceneType";z[41730]="CFAPattern";z[41985]="CustomRendered";z[41986]="ExposureMode";z[41987]="WhiteBalance";z[41988]="DigitalZoomRatio";z[41989]="FocalLengthIn35mmFilm";z[41990]="SceneCaptureType";z[41991]="GainControl";z[41992]="Contrast";z[41993]="Saturation";z[41994]="Sharpness";z[41995]="DeviceSettingDescription";z[41996]="SubjectDistanceRange";return z})(),M=(()=>{const z=[];z[1024]="GTModelTypeGeoKey";z[1025]="GTRasterTypeGeoKey";
z[1026]="GTCitationGeoKey";z[2048]="GeographicTypeGeoKey";z[2049]="GeogCitationGeoKey";z[2050]="GeogGeodeticDatumGeoKey";z[2051]="GeogPrimeMeridianGeoKey";z[2052]="GeogLinearUnitsGeoKey";z[2053]="GeogLinearUnitSizeGeoKey";z[2054]="GeogAngularUnitsGeoKey";z[2055]="GeogAngularUnitSizeGeoKey";z[2056]="GeogEllipsoidGeoKey";z[2057]="GeogSemiMajorAxisGeoKey";z[2058]="GeogSemiMinorAxisGeoKey";z[2059]="GeogInvFlatteningGeoKey";z[2061]="GeogPrimeMeridianLongGeoKey";z[2060]="GeogAzimuthUnitsGeoKey";z[3072]=
"ProjectedCSTypeGeoKey";z[3073]="PCSCitationGeoKey";z[3074]="ProjectionGeoKey";z[3075]="ProjCoordTransGeoKey";z[3076]="ProjLinearUnitsGeoKey";z[3077]="ProjLinearUnitSizeGeoKey";z[3078]="ProjStdParallel1GeoKey";z[3079]="ProjStdParallel2GeoKey";z[3080]="ProjNatOriginLongGeoKey";z[3081]="ProjNatOriginLatGeoKey";z[3082]="ProjFalseEastingGeoKey";z[3083]="ProjFalseNorthingGeoKey";z[3084]="ProjFalseOriginLongGeoKey";z[3085]="ProjFalseOriginLatGeoKey";z[3086]="ProjFalseOriginEastingGeoKey";z[3087]="ProjFalseOriginNorthingGeoKey";
z[3088]="ProjCenterLongGeoKey";z[3090]="ProjCenterEastingGeoKey";z[3091]="ProjCenterNorthingGeoKey";z[3092]="ProjScaleAtNatOriginGeoKey";z[3093]="ProjScaleAtCenterGeoKey";z[3094]="ProjAzimuthAngleGeoKey";z[3095]="ProjStraightVertPoleLongGeoKey";z[4096]="VerticalCSTypeGeoKey";z[4097]="VerticalCitationGeoKey";z[4098]="VerticalDatumGeoKey";z[4099]="VerticalUnitsGeoKey";return z})(),N=new Map;N.set("EXIFIFD",F);N.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:B,ifdTags:N,geoKeys:M,getTagName:(z,Q)=>{Q=(Q||B)[z];void 0===Q&&(Q="unknown"+String(z));return Q}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(B){const F=new ArrayBuffer(4),M=new Uint8Array(F);(new Uint32Array(F))[0]=1;B.isPlatformLittleEndian=1===M[0];Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererHelper":function(){define("exports ../../Color ../../rasterRenderers ../../core/unitUtils ../../layers/support/Field ../FlowRenderer ./AuthoringInfo ./ClassBreakInfo ./colorRampUtils ./rasterRendererChecks ./UniqueValueInfo ../visualVariables/ColorVariable ../visualVariables/SizeVariable ../visualVariables/support/ColorStop ../../rest/support/ClassBreaksDefinition ../../rest/support/generateRendererUtils ../../rest/support/MultipartColorRamp ../../symbols/SimpleFillSymbol ../RasterStretchRenderer ../UniqueValueRenderer ../RasterColormapRenderer ../RasterShadedReliefRenderer ../ClassBreaksRenderer ../VectorFieldRenderer".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t,p,l,g,y,f,n,a,d,e,h,b){function c(L,O){L=q(L,O?.variableName);const {bandCount:X}=L;let {bandIds:aa,stretchType:ba}=O||{};aa?.some(na=>na>=X)&&(aa=null);let fa=L.statistics,ca=L.histograms;1<X?(aa=aa?.length?aa:v(L),fa=null==fa?null:aa?.map(na=>fa[na]),ca=null==ca?null:aa?.map(na=>ca[na])):aa=[0];null==ba&&(ba=m(L));O?.includeStatisticsInStretch&&("percent-clip"===ba||"histogram-equalization"===ba)&&L.statistics?.length&&(ba="min-max");let ka=!1;switch(ba){case "none":ka=
!1;break;case "percent-clip":ka=!ca?.length;break;default:ka=!fa?.length}var {dataType:la}=L;la=1===aa?.length&&W.has(la)?R:null;la=new n({stretchType:ba,dynamicRangeAdjustment:ka,colorRamp:la,outputMin:0,outputMax:255,gamma:1===aa?.length?[1]:[1,1,1],useGamma:!1});"percent-clip"===ba?la.maxPercent=la.minPercent=.25:"standard-deviation"===ba&&(la.numberOfStandardDeviations=2);if(!ka&&(null!=L.multidimensionalInfo||O?.includeStatisticsInStretch))if("percent-clip"===ba)la.histograms=ca;else if("min-max"===
ba||"standard-deviation"===ba)la.statistics=fa;return la}function q(L,O){var {multidimensionalInfo:X}=L;if(!O||!X)return L;X=X.variables.find(aa=>aa.name===O);if(!X)return L;L=L.clone();if(X){const {statistics:aa,histograms:ba}=X;aa?.length&&(L.statistics=aa.map(fa=>({min:fa.min,max:fa.max,avg:fa.avg,stddev:fa.stddev})));ba?.length&&(L.histograms=ba)}return L}function v(L){const O=L.bandCount;if(1===O)return null;if(2===O)return[0];({bandInfos:L}=L);let X;if(L.length===O){const {red:aa,green:ba,blue:fa,
nir:ca}=A(L);null!=aa&&null!=ba&&null!=fa?X=[aa,ba,fa]:null!=ca&&null!=aa&&null!=ba&&(X=[ca,aa,ba])}!X&&3<=O&&(X=[0,1,2]);return X}function A(L){const O={};for(let ba=0;ba<L.length;ba++){var X=L[ba],aa=X.name.toLowerCase();"red"===aa?O.red=ba:"green"===aa?O.green=ba:"blue"===aa?O.blue=ba:"nearinfrared"===aa||"nearinfrared_1"===aa||"nir"===aa?O.nir=ba:X.maxWavelength&&X.minWavelength&&(aa=X.minWavelength,X=X.maxWavelength,null==O.blue&&410<=aa&&480>=aa&&480<=X&&540>=X?O.blue=ba:null==O.green&&490<=
aa&&560>=aa&&560<=X&&610>=X?O.green=ba:null==O.red&&595<=aa&&670>=aa&&660<=X&&730>=X?O.red=ba:null==O.nir&&700<=aa&&860>=aa&&800<=X&&950>=X&&(O.nir=ba))}return O}function m(L){let O="percent-clip";const {pixelType:X,dataType:aa,histograms:ba,statistics:fa,multidimensionalInfo:ca}=L;L=W.has(aa)||"generic"===aa&&null!=ca;"u8"!==X||"processed"!==aa&&null!=ba&&null!=fa?"u8"===X||"elevation"===aa||L?O="min-max":null!=ba?O="percent-clip":null!=fa&&(O="min-max"):O="none";return O}function r(L,O,X,aa){if(!S.isUVRendererSupported(L,
O))return null;const {attributeTable:ba,statistics:fa}=L,ca=C(ba,O),ka=I(ba,"red"),la=I(ba,"green"),na=I(ba,"blue");L=new T;const ea=[],ia=new Set,w=!!(ka&&la&&na);if(null!=ba)ba.features.forEach(G=>{var Y=G.attributes[ca.name];ia.has(G.attributes[ca.name])||null==Y||(ia.add(Y),Y=!w||"single"!==ka.type&&"double"!==ka.type||"single"!==la.type&&"double"!==la.type||"single"!==na.type&&"double"!==na.type||ba.features.some(da=>1<da.attributes[ka.name]||1<da.attributes[la.name]||1<da.attributes[na.name])?
1:255,ea.push(new P({value:G.attributes[ca.name],label:G.attributes[ca.name]+"",symbol:new f({style:"solid",outline:null,color:w?new F([G.attributes[ka.name]*Y,G.attributes[la.name]*Y,G.attributes[na.name]*Y,1]):new F([0,0,0,0])})})))});else if(fa?.[0])for(O=fa[0].min;O<=fa[0].max;O++)ea.push(new P({value:O,label:O.toString(),symbol:new f({style:"solid",outline:null,color:new F([0,0,0,0])})}));ea.sort((G,Y)=>G.value&&"string"===typeof G.value.valueOf()?0:G.value>Y.value?1:-1);if(!w){const G=H.convertColorRampToColormap(V,
{numColors:ea.length});ea.forEach((Y,da)=>Y.symbol.color=new F(G[da].slice(1,4)));L.colorRamp=V}if(X||aa){const G=X||H.convertColorRampToColormap(aa,{numColors:ea.length}).map(Y=>Y.slice(1));ea.forEach((Y,da)=>Y.symbol.color=new F(G[da]));L.colorRamp=aa}return new a({field:ca.name,uniqueValueInfos:ea,authoringInfo:L})}function C(L,O,X){let aa;null!=L?(aa=O?L.fields.find(ba=>O.toLowerCase()===ba.name.toLowerCase()):E(L.fields),aa||(X||(aa=L.fields.find(ba=>"string"===ba.type)),aa||=I(L,"value"))):
aa=new z({name:"value"});return aa}function E(L){let O;for(let X=0;X<L.length;X++){const aa=L[X].name.toLowerCase();if("string"===L[X].type){if(aa.startsWith("class")){O=L[X];break}null==O&&(aa.endsWith("name")||aa.endsWith("type"))&&(O=L[X])}}return O}function I(L,O){return null==L?null:L.fields.find(X=>X.name.toLowerCase()===O)}function D(L){if(!S.isColormapRendererSupported(L))return null;let O;const {attributeTable:X,colormap:aa}=L;if(null!=X){const ba=I(X,"value"),fa=C(X,null,!0);"string"===
fa.type&&(O={},X.features.forEach(ca=>{ca=ca.attributes;O[ca[ba.name]]=fa?ca[fa.name]:ca[ba.name]}))}return d.createFromColormap(aa,O)}function J(L,O,X){let aa=0,ba=0;null!=L.attributeTable?(L=L.attributeTable,aa=ba=L.features[0].attributes[O.name],L.features.forEach(fa=>{fa=fa.attributes[O.name];fa<aa&&(aa=fa);fa>ba&&(ba=fa)})):null!=L.histograms&&(L=L.histograms,aa=L[0].min,ba=L[0].max);return(ba-aa)/X}function u(L){if(!S.isVectorFieldRendererSupported(L))return null;if(null!=L.statistics&&L.statistics.length&&
("vector-magdir"===L.dataType||"vector-uv"===L.dataType)){const {minMagnitude:X,maxMagnitude:aa}=K(L.dataType,L.statistics);var O=[new t({field:"Magnitude",minSize:10,maxSize:40,minDataValue:X,maxDataValue:aa})]}L=null!=L.multidimensionalInfo?U.get(L.multidimensionalInfo.variables[0].unit):void 0;O=new b({visualVariables:O,inputUnit:L,rotationType:"geographic"});O.visualVariables=[...O.sizeVariables,...O.rotationVariables];return O}function x(L){return{color:L.symbolLayers[0].material?.color,type:"esriSFS",
style:"esriSFSSolid"}}function K(L,O){if("vector-magdir"===L)L=O[0].min,O=O[0].max;else{const X=O[0].min,aa=O[0].max,ba=O[1].min;O=O[1].max;L=0;O=Math.max(Math.abs(X),Math.abs(ba),Math.abs(aa),Math.abs(O))}return{minMagnitude:L,maxMagnitude:O}}const R=y.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),V=y.fromJSON(H.predefinedJsonColorRamps[0]),W=new Set("scientific standard-time vector-uv vector-magdir vector-u vector-v vector-magnitude vector-direction".split(" ")),
U=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);B.createClassBreaksRenderer=function(L,O){L=q(L,O?.variableName);const {attributeTable:X}=L;if(!S.isClassBreaksSupported(L))return null;const aa=null!=L.histograms?L.histograms[0]:null,ba=null!=O?.numClasses&&isFinite(O?.numClasses)?O.numClasses:5,fa=new T({classificationMethod:O?.classificationMethod,colorRamp:O?.colorRamp});let ca=O?.field||"value";const ka=
[],la=[],na=null!=X,ea=na&&X.fields.find(da=>"count"===da.name.toLowerCase()),ia=na?X.fields.find(da=>da.name.toLowerCase()===ca.toLowerCase()):void 0;if(ia&&na){ca=ia.name;const da=X.features.length;let ja=0;X.features.forEach(ha=>ja+=(ea?ha.attributes[ea.name]:50)/da);X.features.forEach(ha=>{const oa=ha.attributes[ia.name];ha=ea?ha.attributes[ea.name]:50;if(0<ha){la.push(ha);ha=Math.max(1,Math.round(ha/da/ja*1E3));for(let ma=0;ma<ha;ma++)ka.push(oa)}})}else{var {pixelType:w}=L;const da=(aa.max-
aa.min)/aa.size,ja=(w=w.includes("s")||w.includes("u"))&&1===da?Math.floor(aa.min+.5):aa.min,ha=w&&1===da?Math.floor(aa.max-.5):aa.max,oa=aa.size;let ma=0,qa;aa.counts.forEach(pa=>ma+=pa/oa);aa.counts.forEach((pa,ra)=>{if(0<pa)for(la.push(pa),pa=Math.max(1,Math.round(pa/oa/ma*1E3)),qa=na?X.features[ra].attributes[ia.name]:0===ra?ja:ra===oa-1?ha:aa.min+da*(ra+.5),ra=0;ra<pa;ra++)ka.push(qa)})}w=O?.classificationMethod||"natural-breaks";let G=O?.definedInterval;"defined-interval"!==w||G||(G=J(L,ia,
ba));L=g.createGenerateRendererClassBreaks({values:ka,valueFrequency:la,normalizationTotal:null,definition:new l({classificationMethod:w,breakCount:ba,definedInterval:G})});let Y=O?.colors;Y||(O=O?.colorRamp||R,fa.colorRamp=O,Y=H.convertColorRampToColormap(O,{numColors:L.classBreaks.length,interpolateAlpha:!0}).map(da=>da.slice(1)));O=L.classBreaks.map((da,ja)=>new Z({minValue:da.minValue,maxValue:da.maxValue,label:da.label,symbol:new f({color:Y[ja]})}));return new h({field:ca,classBreakInfos:O,authoringInfo:fa})};
B.createColormapRenderer=D;B.createDefaultRenderer=function(L,O){const {attributeTable:X,colormap:aa}=L;if(S.isVectorFieldRendererSupported(L)){var ba=u(L);if(null!=ba)return ba}return O?.rasterFunctionColorRamp?(L=c(L,O),L.colorRamp=O.rasterFunctionColorRamp,L):null!=aa&&(ba=D(L),null!=ba)||null!=X&&(ba=r(L),null!=ba)?ba:c(L,O)};B.createFlowRenderer=function(L){if(!S.isFlowRendererSupported(L))return null;let O;if(null!=L.statistics&&0<L.statistics.length&&("vector-magdir"===L.dataType||"vector-uv"===
L.dataType)){const {minMagnitude:X,maxMagnitude:aa}=K(L.dataType,L.statistics);O=[new k({field:"Magnitude",stops:[new p({value:X,color:new F("#1020c0")}),new p({value:aa,color:new F("#c02010")})]})]}return new Q({visualVariables:O})};B.createShadedReliefRenderer=function(L,O="traditional"){if(!S.isShadedReliefRendererSupported(L))return null;({extent:L}=L);L=L.width*N.getMetersPerUnitForSR(L.spatialReference);return new e({hillshadeType:O,scalingType:5E6<L?"adjusted":"none"})};B.createStretchRenderer=
c;B.createUVRenderer=r;B.createVectorFieldRenderer=u;B.estimateMagnitudeRange=K;B.getBandNames=function(L,O){const X=L.bandInfos.map(({name:aa})=>aa);return O?.length?O.map(aa=>X[aa]):X};B.getClassField=C;B.getDefaultBandCombination=v;B.getDefaultInterpolation=function(L,O,X){const aa=X?.toLowerCase().replace("bicubic","cubic");X=["nearest","bilinear","cubic","majority"].find(ba=>ba===aa);return"Map"===O?X??"bilinear":"standard-time"===L.dataType?X??"nearest":"thematic"===L.dataType||L.attributeTable||
L.colormap?"nearest"===X||"majority"===X?X:"nearest":X??"bilinear"};B.getDefinedInterval=J;B.getField=I;B.getFunctionColorRamp=function(L){return"Function"===L.datasetFormat&&"Colormap"===L.rasterFunction.functionName?L.rasterFunction.colorRamp:void 0};B.getSupportedRendererTypes=function(L,O=!1){const X=["raster-stretch"];S.isColormapRendererSupported(L,O)&&X.push("raster-colormap");S.isUVRendererSupported(L)&&X.push("unique-value");S.isClassBreaksSupported(L,O)&&X.push("class-breaks");S.isShadedReliefRendererSupported(L)&&
X.push("raster-shaded-relief");S.isVectorFieldRendererSupported(L)&&X.push("vector-field");S.isFlowRendererSupported(L)&&X.push("flow");return X};B.getVariableRasterInfo=q;B.getWellKnownBandIndexes=A;B.matchPresetRenderer=function(L){return L.presetRenderers?.find(({method:O,value:X})=>"raster-function-template"===O?X===L.rasterFunctionName:"variable"===O?X===L.variableName:!1)};B.normalizeRendererJSON=function(L){if("uniqueValue"===L.type){var O=L.uniqueValueInfos;O?.[0].symbol?.symbolLayers?.length&&
(L.uniqueValueInfos=O?.map(X=>({value:X.value,label:X.label,symbol:X.symbol?x(X.symbol):null})));return L}"classBreaks"===L.type&&(O=L.classBreakInfos,O[0].symbol?.symbolLayers?.length&&(L.classBreakInfos=O.map(X=>({classMinValue:X.classMinValue,classMaxValue:X.classMaxValue,label:X.label,symbol:X.symbol?x(X.symbol):null}))));return L};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(B){function F(M){return["u8",
"s8"].includes(M.pixelType)&&null!=M.statistics?.[0]?.min&&null!=M.statistics[0]?.max&&1===M.bandCount}B.isClassBreaksSupported=function(M,N=!1){const {attributeTable:z,bandCount:Q}=M;return 1===Q&&(!N||null!=z||null!=M.histograms)};B.isColormapRendererSupported=function(M,N=!1){const {bandCount:z,colormap:Q,pixelType:T}=M;return 1===z&&(!!Q?.length||!N&&"u8"===T)};B.isColormapSupportedByWebGL=function(M){return!!M?.length&&16384>=M.length};B.isFlowRendererSupported=function(M){({dataType:M}=M);return"vector-uv"===
M||"vector-magdir"===M};B.isShadedReliefRendererSupported=function(M){const {bandCount:N,dataType:z,pixelType:Q}=M;return"elevation"===z||"generic"===z&&1===N&&("s16"===Q||"s32"===Q||"f32"===Q||"f64"===Q)};B.isSingleBand8BitRasterWithStats=F;B.isUVRendererSupported=function(M,N){const {attributeTable:z,bandCount:Q}=M;return null==z&&F(M)?!0:null==z||1<Q||N&&null==z.fields.find(T=>T.name.toLowerCase()===N.toLowerCase())?!1:!0};B.isVectorFieldRendererSupported=function(M){({dataType:M}=M);return"vector-uv"===
M||"vector-magdir"===M};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(B,F,M,N,z,Q,T,Z,H){z=new F.JSONMap({esriClassifyEqualInterval:"equal-interval",
esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});F=new F.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});M=class extends M.JSONSupport{constructor(S){super(S);this.type="class-breaks-definition";this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=
this.breakCount=null}set standardDeviationInterval(S){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",S)}set definedInterval(S){"defined-interval"===this.classificationMethod&&this._set("definedInterval",S)}};B.__decorate([Z.enumeration({classBreaksDef:"class-breaks-definition"})],M.prototype,"type",void 0);B.__decorate([N.property({json:{write:!0}})],M.prototype,"breakCount",void 0);B.__decorate([N.property({json:{write:!0}})],M.prototype,"classificationField",
void 0);B.__decorate([N.property({type:String,json:{read:z.read,write:z.write}})],M.prototype,"classificationMethod",void 0);B.__decorate([N.property({json:{write:!0}})],M.prototype,"normalizationField",void 0);B.__decorate([N.property({json:{read:F.read,write:F.write}})],M.prototype,"normalizationType",void 0);B.__decorate([N.property({value:null,json:{write:!0}})],M.prototype,"standardDeviationInterval",null);B.__decorate([N.property({value:null,json:{write:!0}})],M.prototype,"definedInterval",
null);return M=B.__decorate([H.subclass("esri.rest.support.ClassBreaksDefinition")],M)})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(B,F){function M(k){var t=k.definition;const {classificationMethod:p,normalizationType:l,definedInterval:g}=t;t=t.breakCount??1;const y=[];var f=k.values;if(0===f.length)return[];f=f.sort((b,c)=>b-c);var n=f[0],a=f[f.length-1];if("equal-interval"===p)if(f.length>=t){f=(a-n)/t;k=n;for(var d=1;d<t;d++){var e=Number((n+
d*f).toFixed(6));y.push({minValue:k,maxValue:e,label:N(k,e,l)});k=e}y.push({minValue:k,maxValue:a,label:N(k,a,l)})}else f.forEach(b=>{y.push({minValue:b,maxValue:b,label:N(b,b,l)})});else if("natural-breaks"===p){f=z(f);k=Q(f.uniqueValues,k.valueFrequency||f.valueFrequency,t);for(d=1;d<t;d++)f.uniqueValues.length>d&&(e=Number(f.uniqueValues[k[d]].toFixed(6)),y.push({minValue:n,maxValue:e,label:N(n,e,l)}),n=e);y.push({minValue:n,maxValue:a,label:N(n,a,l)})}else if("quantile"===p)if(f.length>=t&&n!==
a){k=Math.ceil(f.length/t);d=0;for(e=1;e<t;e++){var h=k+d-1;h>f.length&&(h=f.length-1);0>h&&(h=0);y.push({minValue:n,maxValue:f[h],label:N(n,f[h],l)});n=f[h];d+=k;k=Math.ceil((f.length-d)/(t-e))}y.push({minValue:n,maxValue:a,label:N(n,a,l)})}else for(t=-1,a=0;a<f.length;a++)n=f[a],n!==t&&(t=n,y.push({minValue:t,maxValue:n,label:N(t,n,l)}),t=n);else if("standard-deviation"===p)if(k=H(f),d=S(f,k),0===d)y.push({minValue:f[0],maxValue:f[0],label:N(f[0],f[0],l)});else{f=Z(n,a,t,k,d)*d;d=0;for(e=t;1<=e;e--)h=
Number((k-(e-.5)*f).toFixed(6)),y.push({minValue:n,maxValue:h,label:N(n,h,l)}),n=h,d++;e=Number((k+.5*f).toFixed(6));y.push({minValue:n,maxValue:e,label:N(n,e,l)});n=e;d++;for(h=1;h<=t;h++)e=d===2*t?a:Number((k+(h+.5)*f).toFixed(6)),y.push({minValue:n,maxValue:e,label:N(n,e,l)}),n=e,d++}else if("defined-interval"===p){if(!g)return y;t=f[0];a=f[f.length-1];f=Math.ceil((a-t)/g);n=t;for(k=1;k<f;k++)d=Number((t+k*g).toFixed(6)),y.push({minValue:n,maxValue:d,label:N(n,d,l)}),n=d;y.push({minValue:n,maxValue:a,
label:N(n,a,l)})}return y}function N(k,t,p){let l=null;return l=k===t?p&&"percent-of-total"===p?k+"%":k.toString():p&&"percent-of-total"===p?k+"% - "+t+"%":k+" - "+t}function z(k){const t=[],p=[];let l=Number.MIN_VALUE,g=1,y=-1;for(let f=0;f<k.length;f++){const n=k[f];n===l?(g++,p[y]=g):null!==n&&(t.push(n),l=n,g=1,p.push(g),y++)}return{uniqueValues:t,valueFrequency:p}}function Q(k,t,p){var l=k.length;const g=[];p>l&&(p=l);for(var y=0;y<p;y++)g.push(Math.round(y*l/p-1));g.push(l-1);y=T(g,k,t,p);l=
y.mean;y=y.sdcm;var f=p,n=0,a=0;let d=0,e=0,h=!0;for(let c=0;2>c&&h;c++){0===c&&(h=!1);for(var b=0;b<f-1;b++)for(;g[b+1]+1!==g[b+2];)if(g[b+1]+=1,n=P(b,g,k,t),d=n.sbMean,n=n.sbSdcm,a=P(b+1,g,k,t),e=a.sbMean,a=a.sbSdcm,n+a<y[b]+y[b+1])y[b]=n,y[b+1]=a,l[b]=d,l[b+1]=e,h=!0;else{--g[b+1];break}for(b=f-1;0<b;b--)for(;g[b]!==g[b-1]+1;)if(--g[b],n=P(b-1,g,k,t),d=n.sbMean,n=n.sbSdcm,a=P(b,g,k,t),e=a.sbMean,a=a.sbSdcm,n+a<y[b-1]+y[b])y[b-1]=n,y[b]=a,l[b-1]=d,l[b]=e,h=!0;else{g[b]+=1;break}}h&&(y=T(g,k,t,p));
return g}function T(k,t,p,l){let g=[];var y=[],f=[];let n=0;const a=[],d=[];for(var e=0;e<l;e++){var h=P(e,k,t,p);a.push(h.sbMean);d.push(h.sbSdcm);n+=d[e]}h=n;for(e=!0;e||n<h;){e=!1;g=[];for(y=0;y<l;y++)g.push(k[y]);for(f=0;f<l;f++)for(h=k[f]+1;h<=k[f+1];h++)if(y=t[h],0<f&&h!==k[f+1]&&Math.abs(y-a[f])>Math.abs(y-a[f-1]))k[f]=h;else if(f<l-1&&k[f]!==h-1&&Math.abs(y-a[f])>Math.abs(y-a[f+1])){k[f+1]=h-1;break}h=n;n=0;y=[];f=[];for(let b=0;b<l;b++){y.push(a[b]);f.push(d[b]);const c=P(b,k,t,p);a[b]=c.sbMean;
d[b]=c.sbSdcm;n+=d[b]}}if(n>h){for(t=0;t<l;t++)k[t]=g[t],a[t]=y[t],d[t]=f[t];n=h}return{mean:a,sdcm:d}}function Z(k,t,p,l,g){k=Math.max(l-k,t-l)/g/p;return 1<=k?1:.5<=k?.5:.25}function H(k){let t=0;for(let p=0;p<k.length;p++)t+=k[p];return t/=k.length}function S(k,t){let p=0;for(let l=0;l<k.length;l++){const g=k[l];p+=(g-t)*(g-t)}p/=k.length;return Math.sqrt(p)}function P(k,t,p,l){var g=0,y=0;for(var f=t[k]+1;f<=t[k+1];f++){const n=l[f];g+=p[f]*n;y+=n}0>=y&&F.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");
g/=y;y=0;for(f=t[k]+1;f<=t[k+1];f++)y+=l[f]*(p[f]-g)**2;return{sbMean:g,sbSdcm:y}}B.createGenerateRendererClassBreaks=function(k){const {normalizationTotal:t}=k;return{classBreaks:M(k),normalizationTotal:t}};B.createGenerateRendererUniqueValues=function(k){k=z(k);const t=[],p=k.uniqueValues.length;for(let l=0;l<p;l++){const g=k.uniqueValues[l];t.push({value:g,count:k.valueFrequency[l],label:g.toString()})}return{uniqueValues:t}};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(B,F,M,N,z,Q,T,Z,H,S,P,k,t){function p(f){return"percentClip"===f||"histogramEqualization"===f}function l(f){return null!=f&&0<f.length&&null!=f[0].min&&null!=f[0].max}function g(f){return H.isValidPixelBlock(f)&&0!==f.validPixelCount}function y(f){return"algorithmic"===f.type&&["0,0,0,255","0,0,0"].includes(f.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(f.toColor.join(","))}F=class extends F.JSONSupport{constructor(f){super(f)}bind(){const {rendererJSON:f}=this;if(!f)return{success:!1};
this.lookup={rendererJSON:{}};let n;switch(f.type){case "uniqueValue":n=this._updateUVRenderer(f);break;case "rasterColormap":n=this._updateColormapRenderer(f);break;case "rasterStretch":n=this._updateStretchRenderer(f);break;case "classBreaks":n=this._updateClassBreaksRenderer(f);break;case "rasterShadedRelief":n=this._updateShadedReliefRenderer(f);break;case "vectorField":n=this._updateVectorFieldRenderer();break;case "flowRenderer":n=this._updateFlowRenderer()}return n}symbolize(f){let n=f?.pixelBlock;
if(!g(n))return n;if(f.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(n,f.simpleStretchParams);try{3<n.pixels.length&&(n=n.extractBands(f.bandIds??[0,1,2]));let a;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":a=this._symbolizeColormap(n);break;case "classBreaks":a=this._symbolizeClassBreaks(n);break;case "rasterStretch":a=this._symbolizeStretch(n,f.bandIds);break;case "rasterShadedRelief":const d=f.extent;a=this._symbolizeShadedRelief(n,
{isGCS:d.spatialReference.isGeographic,resolution:{x:(d.xmax-d.xmin)/n.width,y:(d.ymax-d.ymin)/n.height}})}return a}catch(a){return M.getLogger(this).error("symbolize",a.message),n}}simpleStretch(f,n){if(!g(f))return f;try{return 3<f.pixels.length&&(f=f.extractBands([0,1,2])),S.stretch(f,{...n,isRenderer:!0})}catch(a){return M.getLogger(this).error("symbolize",a.message),f}}generateWebGLParameters(f){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:h,
offset:b}=this.lookup.colormapLut||{};return{colormap:h,colormapOffset:b,isClassBreaks:"classBreaks"===this.rendererJSON.type,type:"lut"}}const {pixelBlock:n,isGCS:a,resolution:d,bandIds:e}=f;({rendererJSON:f}=this);return"rasterStretch"===f.type?this._generateStretchWebGLParams(n,f,e):"rasterShadedRelief"===f.type?this._generateShadedReliefWebGLParams(f,a,d??void 0):"vectorField"===f.type?this._generateVectorFieldWebGLParams(f):null}_isLUTChanged(f){if(!this.lookup||!this.lookup.rendererJSON)return!0;
if("colorRamp"in this.rendererJSON){const n=this.rendererJSON.colorRamp;if(f)return JSON.stringify(n)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(f){return this._isLUTChanged()&&!this.bind().success?f:H.colorize(f,this.lookup.colormapLut)}_symbolizeClassBreaks(f){const {canUseIndexedLUT:n}=this._analyzeClassBreaks(this.rendererJSON);
return this._isLUTChanged()&&!this.bind().success?f:n?H.colorize(f,this.lookup.colormapLut):H.remapColor(f,this.lookup.remapLut??[])}_symbolizeStretch(f,n){const {rasterInfo:a}=this,{pixelType:d,bandCount:e}=a,h=this.rendererJSON;var b=["u8","u16","s8","s16"].includes(d);let c;var {dra:q}=h;({gamma:v}=this.lookup);if("histogramEqualization"===h.stretchType){b=q?null:this.lookup?.histogramLut;n=S.getStretchCutoff(h,{rasterInfo:a,pixelBlock:f,bandIds:n,returnHistogramLut:!b});var v=S.stretch(f,{...n,
gamma:v,isRenderer:!0});v=H.lookupPixels(v,{lut:q?n.histogramLut:b,offset:0})}else if(b){if(q)q=S.getStretchCutoff(h,{rasterInfo:a,pixelBlock:f,bandIds:n}),c=S.createStretchLUT({pixelType:d,...q,gamma:v,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return f;c=this.lookup?this.lookup.stretchLut:null}if(!c)return f;1<e&&null!=n&&n.length===f?.pixels.length&&c?.lut.length===e&&(c={lut:n.map(A=>c.lut[A]),offset:c.offset});v=H.lookupPixels(f,c)}else q=S.getStretchCutoff(h,{rasterInfo:a,
pixelBlock:f,bandIds:n}),v=S.stretch(f,{...q,gamma:v,isRenderer:!0});if(h.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return f;v=H.colorize(v,this.lookup?.colormapLut)}return v}_symbolizeShadedRelief(f,n){var a=this.rendererJSON;n=P.hillshade(f,{...a,...n});if(!a.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return n;a=this.lookup?this.lookup.hsvMap:null;if(!a)return n;P.tintHillshade(n,f,a,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return n}_isVectorFieldData(){const {bandCount:f,
dataType:n}=this.rasterInfo;return 2===f&&("vector-magdir"===n||"vector-uv"===n)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(f){const {bandCount:n,
attributeTable:a,pixelType:d}=this.rasterInfo,e=f.field1;if(!e)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const h=f.defaultSymbol;var b=1===n&&["u8","s8"].includes(d);if(!t.isUVRendererSupported(this.rasterInfo,e)&&!b)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const c=[];if(null!=a){const q=a.fields.find(v=>"value"===v.name.toLowerCase());if(!q)return{success:!1,
error:"Unsupported data; the data's raster attribute table does not have a value field."};a.features.forEach(v=>{const A=f.uniqueValueInfos?.find(m=>String(m.value)===String(v.attributes[e]))?.symbol?.color;A?c.push([v.attributes[q.name]].concat(A)):h&&c.push([v.attributes[q.name]].concat(h.color))})}else{if("value"!==e.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not available.'};f.uniqueValueInfos?.forEach(q=>
{const v=q?.symbol?.color;v?c.push([parseInt(""+q.value,10)].concat(v)):h&&c.push([parseInt(""+q.value,10)].concat(h?.color))})}if(0===c.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};b=H.createColormapLUT({colormap:c});this.lookup={rendererJSON:f,colormapLut:b};this.canRenderInWebGL=t.isColormapSupportedByWebGL(b?.indexedColormap);return{success:!0}}_updateColormapRenderer(f){if(!t.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var n=f.colormapInfos.map(a=>[a.value].concat(a.color)).sort((a,d)=>a[0]-d[0]);if(!n||0===n.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};n=H.createColormapLUT({colormap:n});this.lookup={rendererJSON:f,colormapLut:n};this.canRenderInWebGL=t.isColormapSupportedByWebGL(n?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(f){if(!t.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(f.colorRamp){var n=k.convertColorRampToColormap(f.colorRamp,{interpolateAlpha:!0});n=H.createColormapLUT({colormap:n});const a=k.createHsvMap(n.indexedColormap);this.lookup={rendererJSON:f,colormapLut:n,hsvMap:a}}else this.lookup=null;this.canRenderInWebGL=!0;return{success:!0}}_analyzeClassBreaks(f){const {attributeTable:n,pixelType:a}=this.rasterInfo,d=
null!=n?n.fields.find(b=>"value"===b.name.toLowerCase()):null,e=null!=n?n.fields.find(b=>b.name.toLowerCase()===f.field.toLowerCase()):null,h=null!=d&&null!==e;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(a)||h,tableValueField:d,tableBreakField:e}}_updateClassBreaksRenderer(f){var {attributeTable:n}=this.rasterInfo;const {canUseIndexedLUT:a,tableValueField:d,tableBreakField:e}=this._analyzeClassBreaks(f);var h=f.classBreakInfos;if(!h?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};
h=h.sort((A,m)=>A.classMaxValue-m.classMaxValue);var b=h[h.length-1],c=f.minValue;if(!a){var q=[];for(var v=0;v<h.length;v++)q.push({value:h[v].classMinValue??c,mappedColor:h[v].symbol.color}),c=h[v].classMaxValue;q.push({value:b.classMaxValue,mappedColor:b.symbol.color});this.lookup={rendererJSON:f,remapLut:q};this.canRenderInWebGL=!1;return{success:!0}}q=[];if(null!=n&&null!=d&&null!==e&&d!==e){b=d.name;const A=e.name,m=h[h.length-1],{classMaxValue:r}=m;c=f.minValue;for(v of n.features){n=v.attributes[b];
const C=v.attributes[A],E=C===r?m:C<c?null:h.find(({classMaxValue:I})=>I>C);E&&q.push([n].concat(E.symbol.color))}}else{c=Math.floor(f.minValue);for(v=0;v<h.length;v++){for(n=h[v];c<n.classMaxValue;c++)q.push([c].concat(n.symbol.color));c=Math.ceil(n.classMaxValue)}b.classMaxValue===c&&q.push([b.classMaxValue].concat(b.symbol.color))}h=H.createColormapLUT({colormap:q,fillUnspecified:!1});this.lookup={rendererJSON:f,colormapLut:h};this.canRenderInWebGL=t.isColormapSupportedByWebGL(h?.indexedColormap);
return{success:!0}}_updateStretchRenderer(f){let {stretchType:n,dra:a}=f;if(!("none"===n||f.statistics?.length||l(this.rasterInfo.statistics)||a))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var d=f.histograms||this.rasterInfo.histograms;!p(f.stretchType)||d?.length||a||(n="minMax");const {computeGamma:e,useGamma:h,colorRamp:b}=f;let {gamma:c}=f;h&&e&&!c?.length&&(c=S.computeGammaValues(this.rasterInfo.pixelType,
f.statistics?.length?f.statistics:this.rasterInfo.statistics));var q=this.rasterInfo.pixelType;const v=!a&&["u8","u16","s8","s16"].includes(q);"histogramEqualization"===n?(q=d.map(A=>S.createHistogramEqualizationLUT(A)),this.lookup={rendererJSON:f,histogramLut:q}):v&&(d=S.getStretchCutoff(f,{rasterInfo:this.rasterInfo}),q=S.createStretchLUT({pixelType:q,...d,gamma:h?c:null,rounding:"floor"}),this.lookup={rendererJSON:f,stretchLut:q});b&&!y(b)&&(q=k.convertColorRampToColormap(b,{interpolateAlpha:!0}),
this.lookup||(this.lookup={rendererJSON:f}),this.lookup.colormapLut=H.createColormapLUT({colormap:q}),this.lookup.rendererJSON=f);this.lookup.gamma=h&&c?.length?c:null;this.canRenderInWebGL=!0;return{success:!0}}_generateStretchWebGLParams(f,n,a){let d=null,e=null;var h=this.lookup?.colormapLut;n.colorRamp&&h&&(d=h.indexedColormap,e=h.offset);"histogramEqualization"===n.stretchType&&(n={...n,stretchType:"minMax"});({gamma:h}=this.lookup);const b=!(!n.useGamma||!h?.some(E=>1!==E)),{minCutOff:c,maxCutOff:q,
outMin:v,outMax:A}=S.getStretchCutoff(n,{rasterInfo:this.rasterInfo,pixelBlock:f,bandIds:a});var m=0;null!=f&&(m=f.getPlaneCount(),2===m&&(f=f.clone(),f.statistics=[f.statistics[0]],f.pixels=[f.pixels[0]]));({bandCount:f}=this.rasterInfo);a=Math.min(3,a?.length||m||f,f);f=new Float32Array(a);m=d||b?1:255;let r;for(r=0;r<c.length;r++)f[r]=q[r]===c[r]?0:(A-v)/(q[r]-c[r])/m;const C=new Float32Array(a);if(b&&h)for(r=0;r<a;r++)C[r]=1<h[r]?2<h[r]?6.5+(h[r]-2)**2.5:6.5+100*(2-h[r])**4:1;return{bandCount:a,
outMin:v/m,outMax:A/m,minCutOff:c,maxCutOff:q,factor:f,useGamma:b,gamma:b?h:[1,1,1],gammaCorrection:b?C:[1,1,1],colormap:d,colormapOffset:e,stretchType:n.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(f,n=!1,a={x:0,y:0}){let d=null,e=null;const h=this.lookup?.colormapLut;f.colorRamp&&h&&(d=h.indexedColormap,e=h.offset);n=P.calculateHillshadeParams({...f,isGCS:n,resolution:a});a=this.rasterInfo.statistics?.[0];return{...n,minValue:a?.min??0,maxValue:a?.max??8E3,hillshadeType:"traditional"===
f.hillshadeType?0:1,type:"hillshade",colormap:d,colormapOffset:e}}_generateVectorFieldWebGLParams(f){const {style:n,inputUnit:a,outputUnit:d,visualVariables:e,symbolTileSize:h,flowRepresentation:b}=f;let c;var q=this.rasterInfo.statistics?.[0].min??0,v=this.rasterInfo.statistics?.[0].max??50,A=e?.find(C=>"sizeInfo"===C.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:v,maxSize:.8*h,minDataValue:q,minSize:.2*h},m=A.minDataValue??q,r=A.maxDataValue??v;v=null!=A.maxSize&&null!=A.minSize?[A.minSize/
h,A.maxSize/h]:[.2,.8];"wind_speed"===n&&(v[0]=v[1]=(v[0]+v[1])/2);q=null!=m&&null!=r?[m,r]:null;if("classified_arrow"===n)if(null!=m&&null!=r&&null!=A)for(c=[],m=(A.maxDataValue-A.minDataValue)/5,r=0;6>r;r++)c.push(A.minDataValue+m*r);else c=[0,1E-6,3.5,7,10.5,14];A="flow_to"===b===("ocean_current_kn"===n||"ocean_current_m"===n)?0:Math.PI;m=e?.find(C=>"rotationInfo"===C.type);return{breakValues:c,dataRange:q,inputUnit:a,outputUnit:d,symbolTileSize:h,symbolPercentRange:v,style:n||"single_arrow",rotation:A,
rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":m?.rotationType||f.rotationType,type:"vectorField"}}};B.__decorate([N.property({json:{write:!0}})],F.prototype,"rendererJSON",void 0);B.__decorate([N.property({type:Z,json:{write:!0}})],F.prototype,"rasterInfo",void 0);B.__decorate([N.property({json:{write:!0}})],F.prototype,"lookup",void 0);B.__decorate([N.property()],F.prototype,"canRenderInWebGL",void 0);return F=B.__decorate([T.subclass("esri.renderers.support.RasterSymbolizer")],
F)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(B,F,M,N,z){function Q(t,p=256){p=Math.min(p,256);const {size:l,counts:g}=t;t=new Uint8Array(l);var y=g.reduce((e,h)=>e+h/p,0);let f=0;var n=0;let a=0,d=y;for(let e=0;e<l;e++)if(a+=g[e],!(e<l-1&&a+g[e+1]<d)){for(;f<p-1&&d<a;)f++,d+=y;for(;n<=e;n++)t[n]=f;n=e+1}for(y=n;y<l;y++)t[y]=p-
1;return t}function T(t,p){t=Math.min(Math.max(t,-100),100);p=Math.min(Math.max(p??0,-100),100);let l=0,g=0;const y=new Uint8Array(256);for(l=0;256>l;l++)0<t&&100>t?g=(200*l-25500+510*p)/(2*(100-t))+128:0>=t&&-100<t?g=(200*l-25500+510*p)*(100+t)/2E4+128:100===t?(g=200*l-25500+256*(100-t)+510*p,g=0<g?255:0):-100===t&&(g=128),y[l]=255<g?255:0>g?0:g;return y}function Z(t,p,l,g){g=Infinity;let y=-Infinity;var f=0,n=0,a=0,d=0;const e=t.length;var h=new Map,b=[];for(let c=0;c<e;c++){const q=t[c];if(!p||
p[c]){b.push(q);const v=(h.get(q)??0)+1;h.set(q,v);v>d&&(d=v,a=q);g=q<g?q:g;y=q>y?q:y;f+=q;n++}}if(0===n)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};f/=n;d=0;for(h=0;h<e;h++)if(!p||p[h])d+=(t[h]-f)**2;h=p?p.filter(c=>c).length:e;d=1>=h?0:Math.sqrt(d/(h-1));b.sort((c,q)=>c-q);h=n>>>1;a={min:g,max:y,avg:f,stddev:d,mode:a,median:n%2?b[Math.floor(h)]:(b[h-1]+b[h])/2};if(["u8","s8","u4","u2","u1"].includes(l)){n=y-g+1;l=new Uint32Array(n);for(b=0;b<e;b++)p&&!p[b]||l[t[b]-
g]++;return{statistics:a,histogram:{min:g-.5,max:y+.5,size:n,counts:l}}}l=new Uint32Array(256);b=(y-g)/256;if(0===b)return{statistics:a,histogram:{min:g,max:y,size:1,counts:(new Uint32Array(1)).fill(n)}};n=new Uint32Array(257);for(f=0;f<e;f++)p&&!p[f]||n[Math.floor((t[f]-g)/b)]++;for(t=0;255>t;t++)l[t]=n[t];l[255]=n[255]+n[256];return{statistics:a,histogram:{min:g,max:y,size:256,counts:l}}}function H(t){if(!t?.pixels?.length)return null;const {pixels:p,mask:l,bandMasks:g,pixelType:y}=t,f=t.width*
t.height,n=p.length,a=[],d=[];let e,h;for(let C=0;C<n;C++){var b=new Uint32Array(256);var c=p[C],q=g?.[C]??l;if("u8"===y){e=255;h=0;if(q)for(var v=0;v<f;v++){if(q[v]){var A=c[v];e=A<e?A:e;h=A>h?A:h;b[A]++}}else for(q=0;q<f;q++)v=c[q],e=v<e?v:e,h=v>h?v:h,b[v]++;b=b.slice(e,h+1)}else{A=!1;t.statistics||(t.updateStatistics(),A=!0);var m=t.statistics;e=m[C].minValue;h=m[C].maxValue;v=(h-e)/256;if(0===v)for(!m||t.validPixelCount||A||t.updateStatistics(),c=(t.validPixelCount||t.width*t.height)/256,q=0;256>
q;q++)b[q]=Math.round(c*(q+1))-Math.round(c*q);else{A=new Uint32Array(257);for(m=0;m<f;m++)q&&!q[m]||A[Math.floor((c[m]-e)/v)]++;for(c=0;255>c;c++)b[c]=A[c];b[255]=A[255]+A[256]}}v="u8"===y?e-.5:e;A="u8"===y?h+.5:h;a.push({min:v,max:A,size:b.length,counts:b});q=m=c=0;for(var r=0;r<b.length;r++)c+=b[r],m+=r*b[r];m/=c;for(r=0;r<b.length;r++)q+=b[r]*(r-m)**2;b=(A-v)/b.length;d.push({min:e,max:h,avg:(m+("u8"===y?0:.5))*b+e,stddev:Math.sqrt(q/(c-1))*b})}return{statistics:d,histograms:a}}function S(t,p){if(null==
p||0===p.length)return t;const l=Math.max.apply(null,p),{minCutOff:g,maxCutOff:y,outMin:f,outMax:n,histogramLut:a}=t;return g.length===p.length||g.length<=l?t:{minCutOff:p.map(d=>g[d]),maxCutOff:p.map(d=>y[d]),histogramLut:a?p.map(d=>a[d]):null,outMin:f,outMax:n}}function P(t,p){const l=new Float32Array(t);for(let g=0;g<t;g++)l[g]=1<p[g]?2<p[g]?6.5+(p[g]-2)**2.5:6.5+100*(2-p[g])**4:1;return l}const k=[.299,.587,.114];B.computeGammaCorrection=P;B.computeGammaValues=function(t,p,l){const g=[];for(let d=
0;d<p.length;d++){var y=0,f=0,n=0;"min"in p[d]?{min:y,max:f,avg:n}=p[d]:[y,f,n]=p[d];n=n??0;"u8"!==t&&(n=255*(n-y)/(f-y));l&&(n*=k[d]);y=g;f=y.push;if(0>=n||255<=n)n=1;else{var a=0;150!==n&&(a=150>=n?45*Math.cos(.01047*n):17*Math.sin(.021*n));a=Math.log((n+a)/255);0===a?n=1:(n=Math.log(n/255)/a,n=isNaN(n)?1:Math.min(9.9,Math.max(.01,n)))}f.call(y,n)}return g};B.computeStatisticsHistograms=function(t){const {pixels:p,mask:l,pixelType:g,bandMasks:y}=t;var f=p.map((n,a)=>Z(n,y?.[a]??l,g));t=f.map(({statistics:n})=>
n);f=f.map(({histogram:n})=>n);return{statistics:t,histograms:f}};B.createContrastBrightnessLUT=T;B.createHistogramEqualizationLUT=Q;B.createStretchLUT=function(t){const {minCutOff:p,maxCutOff:l,gamma:g,pixelType:y,rounding:f}=t,n=t.outMin||0,a=t.outMax||255;if(!["u8","u16","s8","s16"].includes(y))return null;const d=p.length;let e,h,b=0;"s8"===y?b=-127:"s16"===y&&(b=-32767);let c=256;["u16","s16"].includes(y)&&(c=65536);var q=[],v=[];const A=a-n;for(e=0;e<d;e++)v[e]=l[e]-p[e],q[e]=0===v[e]?0:A/v[e];
let m;const r=[];let C,E;if(g&&g.length>=d)for(q=P(d,g),e=0;e<d;e++){E=[];for(h=0;h<c;h++)if(0===v[e])E[h]=n;else{var I=h+b;m=(I-p[e])/v[e];C=1;1<g[e]&&(C-=(1/A)**(m*q[e]));I<l[e]&&I>p[e]?(I=C*A*m**(1/g[e])+n,E[h]="floor"===f?Math.floor(I):"round"===f?Math.round(I):I):E[h]=I>=l[e]?a:n}r[e]=E}else for(e=0;e<d;e++){E=[];for(h=0;h<c;h++)I=h+b,I<=p[e]?E[h]=n:I>=l[e]?E[h]=a:(v=(I-p[e])*q[e]+n,E[h]="floor"===f?Math.floor(v):"round"===f?Math.round(v):v);r[e]=E}if(null!=t.contrastOffset)for(t=T(t.contrastOffset,
t.brightnessOffset),e=0;e<d;e++)for(E=r[e],h=0;h<c;h++)E[h]=t[E[h]];return{lut:r,offset:b}};B.estimateStatisticsFromHistograms=function(t){const p=[];for(let f=0;f<t.length;f++){const {min:n,max:a,size:d,counts:e}=t[f];let h=0;var l=0;for(var g=0;g<d;g++)h+=e[g],l+=g*e[g];l/=h;g=0;for(var y=0;y<d;y++)g+=e[y]*(y-l)**2;y=(a-n)/d;p.push({min:n,max:a,avg:(l+.5)*y+n,stddev:Math.sqrt(g/(h-1))*y})}return p};B.estimateStatisticsHistograms=H;B.getStretchCutoff=function(t,p){const {pixelBlock:l,bandIds:g,returnHistogramLut:y,
rasterInfo:f}=p;var n=null;p=null;var a=t.stretchType;"number"===typeof a&&(a=z.stretchTypeFunctionEnum[a]);t.dra?"minMax"===a&&l?.statistics?n=l.statistics.map(I=>[I.minValue,I.maxValue,0,0]):(p=H(l),n=null!=p?p.statistics:null,p=null!=p?p.histograms:null):(n=t.statistics?.length?t.statistics:f.statistics,p="histograms"in t?t.histograms:void 0,p||(p=f.histograms));"percentClip"!==a&&"histogramEqualization"!==a||p?.length||(a="minMax");var d=n?.length||p?.length||f.bandCount;const e=[],h=[];let b,
c,q;n&&!Array.isArray(n[0])&&(n=n.map(I=>[I.min,I.max,I.avg,I.stddev]));const [v,A]=N.getPixelValueRange(f.pixelType);if(!n?.length){n=[];for(c=0;c<d;c++)n.push([v,A,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(c=0;c<d;c++)e[c]=v,h[c]=A;break;case "minMax":for(c=0;c<d;c++){var m=n[c];e[c]=m[0];h[c]=m[1]}break;case "standardDeviation":({numberOfStandardDeviations:m=2}=t);for(c=0;c<d;c++){var r=n[c];e[c]=r[2]-m*r[3];h[c]=r[2]+m*r[3];e[c]<r[0]&&(e[c]=r[0]);h[c]>r[1]&&(h[c]=r[1])}break;
case "histogramEqualization":F.assertIsSome(p);for(c=0;c<d;c++)e[c]=p[c].min,h[c]=p[c].max;break;case "percentClip":F.assertIsSome(p);for(c=0;c<p.length;c++){n=p[c];r=new Uint32Array(n.size);var C=[...n.counts];20<=C.length&&(C[0]=C[1]=C[2]=C[C.length-1]=C[C.length-2]=0);m=0;d=(n.max-n.min)/n.size;b=-.5===n.min&&1===d?.5:0;for(q=0;q<n.size;q++)m+=C[q],r[q]=m;C=(t.minPercent||0)*m/100;e[c]=n.min+b;for(q=0;q<n.size;q++)if(r[q]>C){e[c]=n.min+d*(q+b);break}C=(1-(t.maxPercent||0)/100)*m;h[c]=n.max+b;for(q=
n.size-2;0<=q;q--)if(r[q]<C){h[c]=n.min+d*(q+2-b);break}h[c]<e[c]&&(n=e[c],e[c]=h[c],h[c]=n)}break;default:for(c=0;c<d;c++)m=n[c],e[c]=m[0],h[c]=m[1]}let E;"histogramEqualization"===a?(F.assertIsSome(p),a=p[0].size||256,t=0,y&&(E=p.map(I=>Q(I)))):(a=t.max||255,t=t.min||0);return S({minCutOff:e,maxCutOff:h,outMax:a,outMin:t,histogramLut:E},g)};B.stretch=function(t,p){if(!t?.pixels?.length)return t;const {mask:l,bandMasks:g,width:y,height:f,pixels:n}=t,{minCutOff:a,maxCutOff:d,gamma:e}=p;var h=p.outMin||
0;const b=p.outMax||255,c=y*f,q=p.outputPixelType||"u8";t=t.pixels.map(()=>M.createEmptyBand(q,c));const v=t.length;var A=b-h,m=[],r=[];for(var C=0;C<v;C++)r[C]=d[C]-a[C],m[C]=0===r[C]?0:A/r[C];C=q.startsWith("u")||q.startsWith("s");p=!!p.isRenderer;if(e&&e.length>=v){m=P(v,e);for(var E=0;E<v;E++){var I=g?.[E]??l;for(let J=0;J<c;J++)if(null==I||I[J]){if(0===r[E]){t[E][J]=h;continue}var D=n[E][J];const u=(D-a[E])/r[E];let x=1;1<e[E]&&(x-=(1/A)**(u*m[E]));D<d[E]&&D>a[E]?(D=x*A*u**(1/e[E])+h,t[E][J]=
p?Math.floor(D):C?Math.round(D):D):t[E][J]=D>=d[E]?b:h}}}else for(A=0;A<v;A++)for(r=g?.[A]??l,E=0;E<c;E++)if(null==r||r[E])I=n[A][E],I<d[A]&&I>a[A]?(I=(I-a[A])*m[A]+h,t[A][E]=p?Math.floor(I):C?Math.round(I):I):t[A][E]=I>=d[A]?b:h;h=new M({width:y,height:f,mask:l,bandMasks:g,pixels:t,pixelType:q});h.updateStatistics();return h};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","../SimpleBandStatistics",
"./pixelUtils"],function(B,F,M,N){function z(H){let {altitude:S,azimuth:P}=H;const {hillshadeType:k,pixelSizePower:t=1,pixelSizeFactor:p=1,scalingType:l,isGCS:g,resolution:y}=H;var f="multi-directional"===k?2*H.zFactor:H.zFactor;const {x:n,y:a}=y;H=f/(8*n);var d=f/(8*a);g&&.001<f&&(H/=Z,d/=Z);"adjusted"===l&&(g?(H=n*Z,d=a*Z,H=(f+H**t*p)/(8*H),d=(f+d**t*p)/(8*d)):(H=(f+n**t*p)/(8*n),d=(f+a**t*p)/(8*a)));var e=(90-S)*Math.PI/180;f=Math.cos(e);let h=(360-P+90)*Math.PI/180,b=Math.sin(e)*Math.cos(h);e=
Math.sin(e)*Math.sin(h);const c=[315,270,225,360,180,0],q=[60,60,60,60,60,90];var v=new Float32Array([3,5,3,2,1,4]);const A=v.reduce((I,D)=>I+D);v=v.map(I=>I/A);const m="multi-directional"===k?c.length:1,r=new Float32Array(6),C=new Float32Array(6),E=new Float32Array(6);if("multi-directional"===k)for(let I=0;I<m;I++)S=q[I],P=c[I],e=(90-S)*Math.PI/180,f=Math.cos(e),h=(360-P+90)*Math.PI/180,b=Math.sin(e)*Math.cos(h),e=Math.sin(e)*Math.sin(h),r[I]=f,C[I]=b,E[I]=e;else r.fill(f),C.fill(b),E.fill(e);return{resolution:y,
factor:[H,d],sinZcosA:b,sinZsinA:e,cosZ:f,sinZcosAs:C,sinZsinAs:E,cosZs:r,weights:v,hillshadeType:["traditional","multi-directional"].indexOf(k)}}function Q(H,S){const {width:P,height:k}=H;var t=P*k;const p=new Uint8Array(t),l=null!=H.mask;let g;if(l){g=new Uint8Array(H.mask);for(var y=0;y<g.length;y++)g[y]&&(p[y]=1,g[y]=1)}H=H.pixels[0];y=new Float32Array(t);const f=new Float32Array(t);let n=0;if(S){({resolution:a}=S);var a=a?(a.x+a.y)/2:1;n=200*S.zFactor/(a*a);a=new Float32Array(t)}S=S?.curvatureType;
let d;let e;for(t=1;t<k-1;t++){const r=t*P;for(let C=1;C<P-1;C++){const E=r+C;if(!g||0!==g[E]){if(g){if(7>g[E-P-1]+g[E-P]+g[E-P+1]+g[E-1]+g[E+1]+g[E+P-1]+g[E+P]+g[E+P+1]){p[E]=0;continue}var h=g[E-P-1]?H[E-P-1]:H[E];var b=g[E-P]?H[E-P]:H[E];var c=g[E-P+1]?H[E-P+1]:H[E];var q=g[E-1]?H[E-1]:H[E];var v=g[E+1]?H[E+1]:H[E];d=g[E+P-1]?H[E+P-1]:H[E];var A=g[E+P]?H[E+P]:H[E];e=g[E+P+1]?H[E+P+1]:H[E]}else h=H[E-P-1],b=H[E-P],c=H[E-P+1],q=H[E-1],v=H[E+1],d=H[E+P-1],A=H[E+P],e=H[E+P+1];y[E]=c+v+v+e-(h+q+q+d);
f[E]=d+A+A+e-(h+b+b+c);if(null!=a){var m=H[E];const I=.5*(q+v)-m;m=.5*(b+A)-m;"standard"===S?a[E]=-n*(I+m):(h=(-h+c+d-e)/4,q=(-q+v)/2,b=(b-A)/2,A=q*q,v=b*b,(c=A+v)&&(a[E]="profile"===S?n*(I*A+m*v+h*q*b)/c:-n*(I*v+m*A-h*q*b)/c))}}}}return{outMask:l?p:null,dzxs:y,dzys:f,curvatures:a}}function T(H,S,P){for(var k=0;k<P;k++)H[k*S]=H[k*S+1],H[(k+1)*S-1]=H[(k+1)*S-2];for(k=1;k<S-1;k++)H[k]=H[k+S],H[k+(P-1)*S]=H[k+(P-2)*S]}const Z=1/111E3;B.aspect=function(H,S={}){if(!N.isValidPixelBlock(H))return H;var {resolution:P}=
S;S=P?1/P.x:1;P=P?1/P.y:1;const {dzxs:k,dzys:t,outMask:p}=Q(H),{width:l,height:g}=H,y=new Float32Array(l*g);for(let n=1;n<g-1;n++){const a=n*l;for(let d=1;d<l-1;d++){var f=a+d;if(!p||p[f]){const e=k[f]*S;f=t[f]*P;let h=-1;if(0!==e||0!==f)h=90-57.29578*Math.atan2(f,-e),0>h&&(h+=360),360===h?h=0:360<h&&(h%=360);y[a+d]=h}}}T(y,l,g);return new F({width:l,height:g,pixels:[y],mask:p,pixelType:"f32",validPixelCount:H.validPixelCount,statistics:[new M.SimpleBandStatistics(-1,360)]})};B.calculateHillshadeParams=
z;B.curvature=function(H,S){if(!N.isValidPixelBlock(H))return H;const {curvatures:P,outMask:k}=Q(H,S),{width:t,height:p}=H;T(P,t,p);H=new F({width:t,height:p,pixels:[P],mask:k,pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};B.gcsFactor=Z;B.getHillshadeOptions=function(H,S,P){const {hillshadeType:k,altitude:t,azimuth:p,zFactor:l,pixelSizeFactor:g,pixelSizePower:y,slopeType:f}=H;return{hillshadeType:k,altitude:t,azimuth:p,zFactor:l,pixelSizePower:y,pixelSizeFactor:g,
scalingType:"scaled"===f?"adjusted":"none",resolution:S,isGCS:P}};B.hillshade=function(H,S){if(!N.isValidPixelBlock(H))return H;const {factor:P,sinZcosA:k,sinZsinA:t,cosZ:p,sinZcosAs:l,sinZsinAs:g,cosZs:y,weights:f}=z(S),[n,a]=P;S="traditional"===S.hillshadeType;const {width:d,height:e}=H,h=new Uint8Array(d*e),{dzxs:b,dzys:c,outMask:q}=Q(H);for(let A=1;A<e-1;A++){const m=A*d;for(let r=1;r<d-1;r++){const C=m+r;if(!q||q[C]){var v=b[C]*n;const E=c[C]*a,I=Math.sqrt(1+v*v+E*E);let D=0;if(S)v=255*(p+t*
E-k*v)/I,0>v&&(v=0),D=v;else{const J=g.length;for(let u=0;u<J;u++){let x=255*(y[u]+g[u]*E-l[u]*v)/I;0>x&&(x=0);D+=x*f[u]}}h[C]=D&255}}}T(h,d,e);return new F({width:d,height:e,pixels:[h],mask:q,pixelType:"u8",validPixelCount:H.validPixelCount,statistics:[new M.SimpleBandStatistics(0,255)]})};B.slope=function(H,S){if(!N.isValidPixelBlock(H))return H;var P=S.zFactor,k=S.pixelSizePower??1,t=S.pixelSizeFactor??1;const p=S.slopeType;var l=S.isGCS;const {x:g,y}=S.resolution;S=P/(8*g);let f=P/(8*y);l&&1E-4>
Math.abs(P-1)&&(S/=Z,f/=Z);"adjusted"===p&&(S=(P+g**k*t)/(8*g),f=(P+y**k*t)/(8*y));const {dzxs:n,dzys:a,outMask:d}=Q(H),{width:e,height:h}=H;P=new Float32Array(e*h);for(k=1;k<h-1;k++)for(t=k*e,l=1;l<e-1;l++){var b=t+l;if(!d||d[b]){var c=n[b]*S;b=a[b]*f;c=Math.sqrt(c*c+b*b);P[t+l]="percent-rise"===p?100*c:57.2957795*Math.atan(c)}}T(P,e,h);H=new F({width:e,height:h,pixels:[P],mask:d,pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};B.tintHillshade=function(H,S,P,k){if(N.isValidPixelBlock(H)&&
N.isValidPixelBlock(S)){var {min:t,max:p}=k;k=H.pixels[0];var {pixels:l,mask:g}=S;S=l[0];var y=255.00001/(p-t),f=new Uint8ClampedArray(S.length),n=new Uint8ClampedArray(S.length),a=new Uint8ClampedArray(S.length),d=P.length-1;for(let b=0;b<S.length;b++){if(g&&0===g[b])continue;var e=Math.floor((S[b]-t)*y);const [c,q]=P[0>e?0:e>d?d:e];var h=k[b];e=h*q;const v=e*(1-Math.abs(c%2-1));h-=e;switch(Math.floor(c)){case 0:f[b]=e+h;n[b]=v+h;a[b]=h;break;case 1:f[b]=v+h;n[b]=e+h;a[b]=h;break;case 2:f[b]=h;n[b]=
e+h;a[b]=v+h;break;case 3:f[b]=h;n[b]=v+h;a[b]=e+h;break;case 4:f[b]=v+h;n[b]=h;a[b]=e+h;break;case 5:case 6:f[b]=e+h,n[b]=h,a[b]=v+h}}H.pixels=[f,n,a];H.updateStatistics()}};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/fetchRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ../../layers/support/RasterInfo ../../layers/support/RasterStorageInfo ../utils ../support/FeatureSet".split(" "),
function(B,F,M,N,z,Q,T,Z,H){async function S(P,k,t){P=Z.parseUrl(P);const {rasterFunction:p,sourceJSON:l}=k||{};k=p?JSON.stringify(p.rasterFunctionDefinition||p):null;k=Z.encode({...P.query,renderingRule:k,f:"json"});k=Z.asValidOptions(k,t);P=P.path;t=l||await F(P,k).then(v=>v.data);var g=t.hasRasterAttributeTable?F(`${P}/rasterAttributeTable`,k):null,y=t.hasColormap?F(`${P}/colormap`,k):null,f=t.hasHistograms?F(`${P}/histograms`,k):null,n=10.3<=t.currentVersion?F(`${P}/keyProperties`,k):null;P=t.hasMultidimensions?
F(`${P}/multidimensionalInfo`,k):null;f=await Promise.allSettled([g,y,f,n,P]);P=null;if(t.minValues&&t.minValues.length===t.bandCount)for(P=[],k=0;k<t.minValues.length;k++)P.push({min:t.minValues[k],max:t.maxValues[k],avg:t.meanValues[k],stddev:t.stdvValues[k]});g=M.fromJSON(t.extent);k=Math.ceil(g.width/t.pixelSizeX-.1);g=Math.ceil(g.height/t.pixelSizeY-.1);y=z.fromJSON(t.spatialReference||t.extent.spatialReference);n="fulfilled"===f[0].status?f[0].value?.data:null;n=n?.features?.length?H.fromJSON(n):
null;var a="fulfilled"===f[1].status?f[1].value?.data.colormap:null;a=a?.length?a:null;var d="fulfilled"===f[2].status?f[2].value?.data.histograms:null;d=d?.[0]?.counts?.length?d:null;const e="fulfilled"===f[3].status?f[3].value?.data??{}:{};f="fulfilled"===f[4].status?f[4].value?.data.multidimensionalInfo:null;(f=f?.variables?.length?f:null)&&f.variables.forEach(v=>{v.statistics?.length&&v.statistics.forEach(A=>{A.avg=A.mean;A.stddev=A.standardDeviation})});const {defaultVariable:h,serviceDataType:b}=
t;h&&h!==e.DefaultVariable&&(e.DefaultVariable=h);b?.includes("esriImageServiceDataTypeVector")&&!b.includes(e.DataType)&&(e.DataType=b.replace("esriImageServiceDataType",""));let c=t.noDataValue;t.noDataValues?.length&&t.noDataValues.some(v=>v!==c)&&(c=t.noDataValues);const q=t.transposeInfo?new T({blockWidth:256,blockHeight:256,pyramidBlockWidth:256,pyramidBlockHeight:256,pyramidScalingFactor:2,compression:"lerc",origin:new N({x:t.extent.xmin,y:t.extent.ymax,spatialReference:y}),firstPyramidLevel:1,
maximumPyramidLevel:Math.max(0,Math.round(Math.log(Math.max(k,g))/Math.LN2-8)),transposeInfo:t.transposeInfo}):void 0;return new Q({width:k,height:g,bandCount:t.bandCount,extent:M.fromJSON(t.extent),spatialReference:y,pixelSize:new N({x:t.pixelSizeX,y:t.pixelSizeY,spatialReference:y}),pixelType:t.pixelType.toLowerCase(),statistics:P,attributeTable:n,colormap:a,histograms:d,keyProperties:e,noDataValue:c,multidimensionalInfo:f,storageInfo:q})}B.fetchServiceRasterInfo=function(P,k,t){return S(P,{sourceJSON:k},
t)};B.generateRasterInfo=function(P,k,t){return S(P,{rasterFunction:k},t)};B.patchServiceInfo=function(P,k){P.attributeTable||(k.hasRasterAttributeTable=!1);P.histograms||(k.hasHistograms=!1);P.colormap||(k.hasColormap=!1);P.multidimensionalInfo||(k.hasMultidimensions=!1)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/rest/imageService/getCatalogItemRasterInfo":function(){define("exports ../../request ../../geometry/Extent ../../geometry/Point ../../layers/support/RasterInfo ../../layers/support/RasterStorageInfo ../utils".split(" "),
function(B,F,M,N,z,Q,T){B.getCatalogItemRasterInfo=async function(Z,H,S){Z=T.parseUrl(Z);var P=T.encode({...Z?.query,f:"json"});S=T.asValidOptions(P,S);Z=`${Z?.path}/${H}/info`;H=F(`${Z}`,S);S=F(`${Z}/keyProperties`,S);S=await Promise.allSettled([H,S]);H="fulfilled"===S[0].status?S[0].value.data:null;S="fulfilled"===S[1].status?S[1].value.data:null;Z=null;H.statistics?.length&&(Z=H.statistics.map(f=>({min:f[0],max:f[1],avg:f[2],stddev:f[3]})));P=M.fromJSON(H.extent);const k=Math.ceil(P.width/H.pixelSizeX-
.1),t=Math.ceil(P.height/H.pixelSizeY-.1),p=P.spatialReference,l=new N({x:H.pixelSizeX,y:H.pixelSizeY,spatialReference:p}),g=H.histograms?.length?H.histograms:null,y=new Q({origin:H.origin,blockWidth:H.blockWidth,blockHeight:H.blockHeight,firstPyramidLevel:H.firstPyramidLevel,maximumPyramidLevel:H.maxPyramidLevel});return new z({width:k,height:t,bandCount:H.bandCount,extent:P,spatialReference:p,pixelSize:l,pixelType:H.pixelType.toLowerCase(),statistics:Z,histograms:g,keyProperties:S,storageInfo:y})};
Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),function(B,F,M,N,z,Q,T,Z,H){function S(a,d){const e=t(d.data,d.width,d.height,a.smoothing);return a.interpolate?(h,b)=>{const c=Math.floor(h),
q=Math.floor(b);if(0>c||c>=d.width||0>q||q>=d.height)return[0,0];h-=c;b-=q;const v=c<d.width-1?c+1:c,A=q<d.height-1?q+1:q;return[(e[2*(q*d.width+c)]*(1-b)+e[2*(A*d.width+c)]*b)*(1-h)+(e[2*(q*d.width+v)]*(1-b)+e[2*(A*d.width+v)]*b)*h,(e[2*(q*d.width+c)+1]*(1-b)+e[2*(A*d.width+c)+1]*b)*(1-h)+(e[2*(q*d.width+v)+1]*(1-b)+e[2*(A*d.width+v)+1]*b)*h]}:(h,b)=>{h=Math.round(h);b=Math.round(b);return 0>h||h>=d.width||0>b||b>=d.height?[0,0]:[e[2*(b*d.width+h)],e[2*(b*d.width+h)+1]]}}function P(a,d,e,h,b,c,q,
v,A){const m=[];let r=0,[C,E]=d(e,h);C*=a.velocityScale;E*=a.velocityScale;m.push({x:e,y:h,t:r,speed:Math.sqrt(C*C+E*E)});for(let J=0;J<a.verticesPerLine;J++){let [u,x]=d(e,h);u*=a.velocityScale;x*=a.velocityScale;const K=Math.sqrt(u*u+x*x);if(K<a.minSpeedThreshold)break;const R=u/K,V=x/K;e+=R*a.segmentLength;h+=V*a.segmentLength;r+=a.segmentLength/K;if(Math.acos(R*I+V*D)>a.maxTurnAngle)break;if(a.collisions){var I=Math.round(e*A);var D=Math.round(h*A);if(0>I||I>q-1||0>D||D>v-1)break;const W=c[D*
q+I];if(-1!==W&&W!==b)break;c[D*q+I]=b}m.push({x:e,y:h,t:r,speed:K});I=R;D=V}return m}function k(a,d,e,h){const b=[],c=new T,q=1/Math.max(a.lineCollisionWidth,1),v=Math.round(e*q),A=Math.round(h*q),m=new Int32Array(v*A);for(var r=0;r<m.length;r++)m[r]=-1;r=[];for(let C=0;C<h;C+=a.lineSpacing)for(let E=0;E<e;E+=a.lineSpacing)r.push({x:E,y:C,sort:c.getFloat()});r.sort((C,E)=>C.sort-E.sort);for(const {x:C,y:E}of r)c.getFloat()<a.density&&(e=P(a,d,C,E,b.length,m,v,A,q),2>e.length||b.push(e));return b}
function t(a,d,e,h){if(0===h)return a;const b=Math.round(3*h),c=Array(2*b+1);var q=0;for(var v=-b;v<=b;v++){var A=Math.exp(-v*v/(h*h));c[v+b]=A;q+=A}for(h=-b;h<=b;h++)c[h+b]/=q;q=new Float32Array(a.length);for(h=0;h<e;h++)for(v=0;v<d;v++){var m=A=0;for(var r=-b;r<=b;r++)if(!(0>v+r||v+r>=d)){var C=c[r+b];A+=C*a[2*(h*d+(v+r))];m+=C*a[2*(h*d+(v+r))+1]}q[2*(h*d+v)]=A;q[2*(h*d+v)+1]=m}a=new Float32Array(a.length);for(h=0;h<d;h++)for(v=0;v<e;v++){m=A=0;for(r=-b;r<=b;r++)0>v+r||v+r>=e||(C=c[r+b],A+=C*q[2*
((v+r)*d+h)],m+=C*q[2*((v+r)*d+h)+1]);a[2*(v*d+h)]=A;a[2*(v*d+h)+1]=m}return a}function p(a,d){const e=new T;var h=a.reduce((v,A)=>v+A.length,0);h=new Float32Array(4*h);const b=Array(a.length);let c=0,q=0;for(const v of a){a=c;for(const A of v)h[4*c]=A.x,h[4*c+1]=A.y,h[4*c+2]=A.t,h[4*c+3]=A.speed,c++;b[q++]={startVertex:a,numberOfVertices:v.length,totalTime:v[v.length-1].t,timeSeed:d?e.getFloat():0}}return{lineVertices:h,lineDescriptors:b}}function l(a,d){function e(I,D,J,u,x,K,R,V){const W=9*A;let U=
0;v[W+U++]=I;v[W+U++]=D;v[W+U++]=1;v[W+U++]=J;v[W+U++]=K;v[W+U++]=R;v[W+U++]=u/2;v[W+U++]=x/2;v[W+U++]=V;A++;v[W+U++]=I;v[W+U++]=D;v[W+U++]=-1;v[W+U++]=J;v[W+U++]=K;v[W+U++]=R;v[W+U++]=-u/2;v[W+U++]=-x/2;v[W+U++]=V;A++}const {lineVertices:h,lineDescriptors:b}=a;var c=a=0;for(var q of b)a+=2*q.numberOfVertices,c+=6*(q.numberOfVertices-1);const v=new Float32Array(9*a);q=new Uint32Array(c);let A=0;a=0;for(const I of b){const {totalTime:D,timeSeed:J}=I;let u=c=null,x=null;var m=null,r=null,C=null;for(let K=
0;K<I.numberOfVertices;K++){m=h[4*(I.startVertex+K)];const R=h[4*(I.startVertex+K)+1],V=h[4*(I.startVertex+K)+2],W=h[4*(I.startVertex+K)+3];let U=null,L=null;var E=null;let O=null;0<K&&(U=m-c,L=R-u,E=Math.sqrt(U*U+L*L),U/=E,L/=E,1<K?(r=U+r,C=L+C,E=Math.sqrt(r*r+C*C),r/=E,C/=E,E=Math.min(1/(r*U+C*L),d),r*=E,C*=E,E=-C,O=r):(E=-L,O=U),null!==E&&null!==O&&(e(c,u,x,E,O,D,J,W),q[a++]=A-2,q[a++]=A,q[a++]=A-1,q[a++]=A,q[a++]=A+1,q[a++]=A-1));c=m;u=R;x=V;r=U;C=L;m=W}e(c,u,x,-C,r,D,J,m)}return{vertexData:v,
indexData:q}}function g(a){function d(aa,ba){var fa=V+U,ca=W+L,ka=Math.sqrt(fa*fa+ca*ca);fa/=ka;ca/=ka;var la=V*fa+W*ca,na=U+O,ea=L+X;ka=Math.sqrt(na*na+ea*ea);na/=ka;ea/=ka;var ia=U*na+L*ea;ka=E;var w=I,G=D,Y=J;ca=-(ca/la);fa/=la;la=u;var da=x,ja=K,ha=R;ea=-(ea/ia);na/=ia;ia=16*r;let oa=0;for(const ma of[1,2])for(const qa of[1,2,3,4])A[ia+oa++]=ka,A[ia+oa++]=w,A[ia+oa++]=G,A[ia+oa++]=Y,A[ia+oa++]=la,A[ia+oa++]=da,A[ia+oa++]=ja,A[ia+oa++]=ha,A[ia+oa++]=ma,A[ia+oa++]=qa,A[ia+oa++]=aa,A[ia+oa++]=ba,
A[ia+oa++]=ca/2,A[ia+oa++]=fa/2,A[ia+oa++]=ea/2,A[ia+oa++]=na/2,r++;m[C++]=r-8;m[C++]=r-7;m[C++]=r-6;m[C++]=r-7;m[C++]=r-5;m[C++]=r-6;m[C++]=r-4;m[C++]=r-3;m[C++]=r-2;m[C++]=r-3;m[C++]=r-1;m[C++]=r-2}function e(aa,ba,fa,ca,ka,la){V=U;W=L;U=O;L=X;null==V&&null==W&&(V=U,W=L);if(null!=u&&null!=x){O=aa-u;X=ba-x;const na=Math.sqrt(O*O+X*X);O/=na;X/=na}null!=V&&null!=W&&d(ka,la);E=u;I=x;D=K;J=R;u=aa;x=ba;K=fa;R=ca}function h(aa,ba){V=U;W=L;U=O;L=X;null==V&&null==W&&(V=U,W=L);null!=V&&null!=W&&d(aa,ba)}
const {lineVertices:b,lineDescriptors:c}=a;let q=a=0;for(var v of c){const aa=v.numberOfVertices-1;a+=8*aa;q+=12*aa}const A=new Float32Array(16*a),m=new Uint32Array(q);let r=0,C=0,E,I,D,J,u,x,K,R,V,W,U,L,O,X;for(const aa of c){X=O=L=U=W=V=R=K=x=u=J=D=I=E=null;const {totalTime:ba,timeSeed:fa}=aa;for(v=0;v<aa.numberOfVertices;v++)e(b[4*(aa.startVertex+v)],b[4*(aa.startVertex+v)+1],b[4*(aa.startVertex+v)+2],b[4*(aa.startVertex+v)+3],ba,fa);h(ba,fa)}return{vertexData:A,indexData:m}}function y(a,d){const e=
d.pixels,{width:h,height:b}=d,c=new Float32Array(h*b*2),q=d.mask||new Uint8Array(h*b*2);d.mask||q.fill(255);if("vector-uv"===a)for(a=0;a<h*b;a++)c[2*a]=e[0][a],c[2*a+1]=-e[1][a];else if("vector-magdir"===a)for(a=0;a<h*b;a++){d=e[0][a];const v=z.deg2rad(e[1][a]),A=Math.sin(v-Math.PI/2);c[2*a]=Math.cos(v-Math.PI/2)*d;c[2*a+1]=A*d}return{data:c,mask:q,width:h,height:b}}async function f(a,d,e,h,b,c){const q={requestProjectedLocalDirections:!0,signal:c};null!=b&&(q.timeExtent=b);if("imagery"===a.type)return await a.load({signal:c}),
b=a.rasterInfo.dataType,a=await a.fetchImage(d,e,h,q),null==a?.pixelData?.pixelBlock?{data:new Float32Array(e*h*2),mask:new Uint8Array(e*h),width:e,height:h}:y(b,a.pixelData.pixelBlock);await a.load({signal:c});b=a.serviceRasterInfo.dataType;a=await a.fetchPixels(d,e,h,q);return null==a?.pixelBlock?{data:new Float32Array(e*h*2),mask:new Uint8Array(e*h),width:e,height:h}:y(b,a.pixelBlock)}const n=()=>N.getLogger("esri.views.2d.engine.flow.dataUtils");B.createAnimatedLinesData=p;B.createFlowMesh=async function(a,
d,e,h){const b=performance.now();var c=S(d,e);const q=performance.now();e=k(d,c,e.width,e.height);d=performance.now();c=p(e,!0);e=performance.now();a="Streamlines"===a?l(c,10):g(c);c=performance.now();M("esri-2d-profiler")&&(n().info("I.1","_createFlowFieldFromData (ms)",Math.round(q-b)),n().info("I.2","_getStreamlines (ms)",Math.round(d-q)),n().info("I.3","createAnimatedLinesData (ms)",Math.round(e-d)),n().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(c-e)),n().info("I.5","createFlowMesh (ms)",
Math.round(c-b)),n().info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();Q.throwIfAborted(h);return a};B.createParticlesMesh=g;B.createStreamlinesMesh=l;B.loadImagery=async function(a,d,e,h,b,c){const q=performance.now();var v=Z.getInfo(d.spatialReference);if(!v)return e=await f(a,d,e,h,b,c),M("esri-2d-profiler")&&n().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-q)),M("esri-2d-profiler")&&n().info("I.9","Number of parts",
1),e;const [A,m]=v.valid,r=Math.ceil(d.width/(m-A)),C=d.width/r,E=Math.round(e/r);let I=d.xmin;const D=[];v=performance.now();for(let J=0;J<r;J++){const u=new H({xmin:I,xmax:I+C,ymin:d.ymin,ymax:d.ymax,spatialReference:d.spatialReference});D.push(f(a,u,E,h,b,c));I+=C}a=await Promise.all(D);M("esri-2d-profiler")&&n().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-v));M("esri-2d-profiler")&&n().info("I.9","Number of parts",a.length);h={data:new Float32Array(e*h*2),mask:new Uint8Array(e*
h),width:e,height:h};d=0;for(const J of a){for(a=0;a<J.height;a++)for(b=0;b<J.width;b++)d+b>=e||(h.data[2*(a*e+d+b)]=J.data[2*(a*J.width+b)],h.data[2*(a*e+d+b)+1]=J.data[2*(a*J.width+b)+1],h.mask[a*e+d+b]=J.mask[a*J.width+b]);d+=J.width}M("esri-2d-profiler")&&n().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-q));return h};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/RasterPresetRendererMixin":function(){define("exports ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/RasterPresetRenderer".split(" "),
function(B,F,M,N,z,Q,T,Z){B.RasterPresetRendererMixin=H=>{H=class extends H{constructor(){super(...arguments);this.presetRenderers=this.activePresetRendererName=null}};F.__decorate([M.property({type:String,json:{name:"layerDefinition.activePresetRendererName",write:{allowNull:!0}}})],H.prototype,"activePresetRendererName",void 0);F.__decorate([M.property({type:[Z],json:{name:"layerDefinition.presetRenderers",write:!0}})],H.prototype,"presetRenderers",void 0);return H=F.__decorate([T.subclass("esri.layers.mixins.RasterPresetRendererMixin")],
H)};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/RasterPresetRenderer":function(){define("../../chunks/tslib.es6 ../../rasterRenderers ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(B,F,M,N,z,Q,T,Z,H,S){M=class extends M.ClonableMixin(N.JSONSupport){constructor(P){super(P);
this.name=void 0;this.method="none";this.renderer=this.bandIds=this.value=void 0}};B.__decorate([z.property({type:String,json:{write:!0}})],M.prototype,"name",void 0);B.__decorate([z.property({type:["raster-function-template","variable","none"],json:{write:!0}}),H.enumeration({rasterFunctionTemplate:"raster-function-template",variable:"variable",none:"none"})],M.prototype,"method",void 0);B.__decorate([z.property({type:String,json:{write:!0}})],M.prototype,"value",void 0);B.__decorate([z.property({type:[Q.Integer],
json:{write:!0}})],M.prototype,"bandIds",void 0);B.__decorate([z.property({types:F.rasterRendererTypes,json:{write:!0,origins:{"web-scene":{types:F.websceneRasterRendererTypes,write:{overridePolicy(P){return{enabled:P&&"vector-field"!==P.type&&"flow"!==P.type}}}}}}})],M.prototype,"renderer",void 0);return M=B.__decorate([S.subclass("esri.renderers.support.RasterPresetRenderer")],M)})},"*noref":1}});
define("require ../chunks/tslib.es6 ../PopupTemplate ../core/Clonable ../core/Error ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./Layer ./mixins/ArcGISImageService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RasterPresetRendererMixin ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/commonProperties ./support/versionUtils ../support/popupUtils ../webdoc/interfaces".split(" "),function(B,
F,M,N,z,Q,T,Z,H,S,P,k,t,p,l,g,y,f,n,a,d,e,h,b,c,q,v,A){N=class extends y.BlendLayer(b.TemporalLayer(h.ScaleRangeLayer(n.OperationalLayer(a.PortalLayer(d.RasterPresetRendererMixin(l.ArcGISImageService(e.RefreshableLayer(f.CustomParametersMixin(g.ArcGISService(Q.MultiOriginJSONMixin(N.ClonableMixin(p)))))))))))){constructor(...m){super(...m);this.isReference=null;this.operationalLayerType="ArcGISImageServiceLayer";this.popupEnabled=!0;this.popupTemplate=null;this.type="imagery";this._debouncedSaveOperations=
T.debounce(async(r,C,E)=>{const {save:I,saveAs:D}=await new Promise((J,u)=>B(["./save/imageryUtils"],J,u));switch(r){case A.SaveOperationType.SAVE:return I(this,C);case A.SaveOperationType.SAVE_AS:return D(this,E,C)}})}normalizeCtorArgs(m,r){return"string"===typeof m?{url:m,...r}:m}load(m){const r=null!=m?m.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},m).catch(T.throwIfAbortError).then(()=>this._fetchService(r)));return Promise.resolve(this)}get legendEnabled(){return this._isPreviewLayer?
!1:this._get("legendEnabled")??!0}set legendEnabled(m){this._set("legendEnabled",m)}get listMode(){return this._isPreviewLayer?"hide":this._get("listMode")}set listMode(m){this._set("listMode",m)}writeOperationalLayerType(m,r,C){r[C]="vector-field"===this.renderer?.type?"ArcGISImageServiceVectorLayer":"ArcGISImageServiceLayer"}get defaultPopupTemplate(){return this.createPopupTemplate()}get _isPreviewLayer(){return!(!this.raster||!this.url?.toLowerCase().includes("/rasterrendering/imageserver"))}createPopupTemplate(m){const r=
this.rasterFields,C=this.title,E=new Set;var I=!1;let D=!1;this.capabilities&&(I=this.capabilities.operations.supportsQuery&&this.fields&&0<this.fields.length,D="esriImageServiceDataTypeVector-UV"===this.serviceDataType||"esriImageServiceDataTypeVector-MagDir"===this.serviceDataType);const J=new Set;I&&J.add("raster.itempixelvalue");for(const u of r)I=u.name.toLowerCase(),J.has(I)||I.includes("raster.servicepixelvalue.")||E.add(u.name);D&&E.add("raster.magnitude").add("raster.direction");m=v.createPopupTemplate({fields:r,
title:C},{...m,visibleFieldNames:E});m?.fieldInfos&&this.rasterInfo?.pixelType.startsWith("f")&&m.fieldInfos.forEach(({format:u,fieldName:x})=>{u&&x&&/^raster\.(item|service)pixelvalue/i.test(x)&&(u.places=2)});return m}queryFeatures(m,r){return this.queryRasters(m,r).then(C=>{if(C?.features)for(const E of C.features)E.layer=E.sourceLayer=this;return C})}queryFeatureCount(m,r){return this.queryRasterCount(m,r)}redraw(){this.emit("redraw")}async save(m){return this._debouncedSaveOperations(A.SaveOperationType.SAVE,
m)}async saveAs(m,r){return this._debouncedSaveOperations(A.SaveOperationType.SAVE_AS,r,m)}serviceSupportsSpatialReference(m){return q.serviceSupportsSpatialReference(this,m)}write(m,r){if(!this._isPreviewLayer)return super.write(m,r);r?.messages&&r.messages.push(new z("layer:unsupported",`Imagery preview layer (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${`${r.origin}/${r.layerContainerType||"operational-layers"}`}'`,{layer:this}));return null}};
F.__decorate([Z.property(c.legendEnabled)],N.prototype,"legendEnabled",null);F.__decorate([Z.property({type:["show","hide"]})],N.prototype,"listMode",null);F.__decorate([Z.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,"isReference",void 0);F.__decorate([Z.property({type:["ArcGISImageServiceLayer"],json:{origins:{"web-map":{type:["ArcGISImageServiceLayer","ArcGISImageServiceVectorLayer"],read:!1,write:{target:"layerType",ignoreOrigin:!0}}}}})],
N.prototype,"operationalLayerType",void 0);F.__decorate([t.writer("web-map","operationalLayerType")],N.prototype,"writeOperationalLayerType",null);F.__decorate([Z.property(c.popupEnabled)],N.prototype,"popupEnabled",void 0);F.__decorate([Z.property({type:M,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],N.prototype,"popupTemplate",void 0);F.__decorate([Z.property({readOnly:!0})],N.prototype,"defaultPopupTemplate",null);F.__decorate([Z.property({readOnly:!0,json:{read:!1}})],N.prototype,
"type",void 0);F.__decorate([Z.property({readOnly:!0})],N.prototype,"_isPreviewLayer",null);return N=F.__decorate([k.subclass("esri.layers.ImageryLayer")],N)});