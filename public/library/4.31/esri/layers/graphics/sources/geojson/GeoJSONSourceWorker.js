// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(e,l,x,D,t,N,a,p,k,y){function w(C,H){return C?H?4:3:H?3:2}function I(C,H,O,V){if(C){if(O)return H&&V?F:La;if(H&&V)return m}else if(H&&V)return La;return ab}function G({scale:C,
translate:H},O){return Math.round((O-H[0])/C[0])}function r({scale:C,translate:H},O){return Math.round((H[1]-O)/C[1])}function J({scale:C,translate:H},O,V){return O*C[V]+H[V]}function K(C){C=C.coords;return{x:C[0],y:C[1]}}function v(C,H){C.coords[0]=H.x;C.coords[1]=H.y;return C}function b(C){C=C.coords;return{x:C[0],y:C[1],z:C[2]}}function q(C,H){C.coords[0]=H.x;C.coords[1]=H.y;C.coords[2]=H.z;return C}function L(C){C=C.coords;return{x:C[0],y:C[1],m:C[2]}}function d(C,H){C.coords[0]=H.x;C.coords[1]=
H.y;C.coords[2]=H.m;return C}function z(C){C=C.coords;return{x:C[0],y:C[1],z:C[2],m:C[3]}}function M(C,H){C.coords[0]=H.x;C.coords[1]=H.y;C.coords[2]=H.z;C.coords[3]=H.m;return C}function Q(C,H){return C&&H?M:C?q:H?d:v}function Z(C,H,O,V,aa){O=Q(O,V);for(const {geometry:da,attributes:ea}of H)H=null!=da?O(new y,da):null,C.push(new p.OptimizedFeature(H,ea,null,aa?ea[aa]:void 0));return C}function U(C,H,O=Q(null!=H.z,null!=H.m)){return O(C,H)}function T(C,H,O,V){for(const {geometry:aa,attributes:da}of H)C.push({attributes:da,
geometry:null!=aa?u(aa,O,V):null});return C}function u(C,H,O){if(null==C)return null;const V=w(H,O),aa=[];for(let da=0;da<C.coords.length;da+=V){const ea=[];for(let la=0;la<V;la++)ea.push(C.coords[da+la]);aa.push(ea)}return H?O?{points:aa,hasZ:H,hasM:O}:{points:aa,hasZ:H}:O?{points:aa,hasM:O}:{points:aa}}function R(C,H,O,V,aa){O=w(O,V);for(const {geometry:da,attributes:ea}of H)H=null!=da?g(new y,da,O):null,C.push(new p.OptimizedFeature(H,ea,null,aa?ea[aa]:void 0));return C}function g(C,H,O=w(H.hasZ,
H.hasM)){C.lengths[0]=H.points.length;const V=C.coords;let aa=0;for(const da of H.points)for(H=0;H<O;H++)V[aa++]=da[H];return C}function f(C,H,O){if(!C)return null;const V=w(H,O),{coords:aa,lengths:da}=C;C=[];let ea=0;for(const la of da){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=0;ra<V;ra++)qa.push(aa[ea++]);ma.push(qa)}C.push(ma)}return H?O?{paths:C,hasZ:H,hasM:O}:{paths:C,hasZ:H}:O?{paths:C,hasM:O}:{paths:C}}function h(C,H,O,V,aa){O=w(O,V);for(const {geometry:da,attributes:ea,
centroid:la}of H)H=null!=da?A(new y,da,O):null,V=null!=la?U(new y,la):null,C.push(new p.OptimizedFeature(H,ea,V,aa?ea[aa]:void 0));return C}function A(C,H,O=w(H.hasZ,H.hasM)){const {lengths:V,coords:aa}=C;let da=0;for(const ea of H.paths){for(const la of ea)for(H=0;H<O;H++)aa[da++]=la[H];V.push(ea.length)}return C}function P(C,H,O){if(!C)return null;const V=w(H,O),{coords:aa,lengths:da}=C;C=[];let ea=0;for(const la of da){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=0;ra<V;ra++)qa.push(aa[ea++]);
ma.push(qa)}C.push(ma)}return H?O?{rings:C,hasZ:H,hasM:O}:{rings:C,hasZ:H}:O?{rings:C,hasM:O}:{rings:C}}function X(C,H,O=H.hasZ,V=H.hasM){return ca(C,H.rings,O,V)}function ca(C,H,O,V){O=w(O,V);const {lengths:aa,coords:da}=C;V=0;Da(C);for(const ea of H){for(const la of ea)for(H=0;H<O;H++)da[V++]=la[H];aa.push(ea.length)}return C}function ia(C,H,O,V,aa,da){Ea(C);if(!O){for(const ea of H)C.push(new p.OptimizedFeature(null,ea.attributes,null,da?ea.attributes[da]:void 0));return C}switch(O){case "esriGeometryPoint":return Z(C,
H,V,aa,da);case "esriGeometryMultipoint":return R(C,H,V,aa,da);case "esriGeometryPolyline":return h(C,H,V,aa,da);case "esriGeometryPolygon":case "esriGeometryMultiPatch":for(const {geometry:ea,centroid:la,attributes:ma}of H)H=null!=ea?X(new y,ea,V,aa):null,O=da?ma[da]:void 0,null!=la?C.push(new p.OptimizedFeature(H,ma,v(new y,la),O)):C.push(new p.OptimizedFeature(H,ma,null,O));break;default:Ja().error("convertToFeatureSet:unknown-geometry",new l(`Unable to parse unknown geometry type '${O}'`)),Ea(C)}return C}
function na(C,H,O,V){C=C&&("coords"in C?C:C.geometry);if(null==C)return null;switch(H){case "esriGeometryPoint":return H=K,O&&V?H=z:O?H=b:V&&(H=L),H(C);case "esriGeometryMultipoint":return u(C,O,V);case "esriGeometryPolyline":return f(C,O,V);case "esriGeometryPolygon":return P(C,O,V);default:return Ja().error("convertToGeometry:unknown-geometry",new l(`Unable to parse unknown geometry type '${H}'`)),null}}function oa(C,H,O,V,aa){Ea(C);if(null==O){for(const ea of H)C.push({attributes:ea.attributes});
return C}switch(O){case "esriGeometryPoint":O=K;V&&aa?O=z:V?O=b:aa&&(O=L);for(var da of H){const {geometry:ea,attributes:la}=da;V=null!=ea?O(ea):null;C.push({attributes:la,geometry:V})}break;case "esriGeometryMultipoint":return T(C,H,V,aa);case "esriGeometryPolyline":for(const {geometry:ea,attributes:la}of H)C.push({attributes:la,geometry:null!=ea?f(ea,V,aa):null});break;case "esriGeometryPolygon":for(const {geometry:ea,attributes:la,centroid:ma}of H)da=null!=ea?P(ea,V,aa):null,null!=ma?(H=K(ma),
C.push({attributes:la,centroid:H,geometry:da})):C.push({attributes:la,geometry:da});break;default:Ja().error("convertToFeatureSet:unknown-geometry",new l(`Unable to parse unknown geometry type '${O}'`))}return C}function pa(C,H,O,V,aa,da,ea=O,la=V){Da(C);if(!H?.coords.length)return null;aa=Sa[aa];const {coords:ma,lengths:ua}=H;H=w(O,V);const qa=w(O&&ea,V&&la);O=I(O,V,ea,la);if(!ua.length)return O(C.coords,ma,0,0,G(da,ma[0]),r(da,ma[1])),Da(C,H,0),C;let ra,Ba=0,ya,Aa=0;for(const Ca of ua){if(Ca<aa)continue;
let za=0;ya=Aa;la=V=G(da,ma[Ba]);ra=ea=r(da,ma[Ba+1]);O(C.coords,ma,ya,Ba,la,ra);za++;Ba+=H;ya+=qa;for(let Fa=1;Fa<Ca;Fa++,Ba+=H)if(la=G(da,ma[Ba]),ra=r(da,ma[Ba+1]),la!==V||ra!==ea)O(C.coords,ma,ya,Ba,la-V,ra-ea),ya+=qa,za++,V=la,ea=ra;za>=aa&&(C.lengths.push(za),Aa=ya)}Ea(C.coords,Aa);return C.coords.length?C:null}function sa(C,H,O,V,aa,da,ea){let la=V,ma=0;for(let qa=da+O;qa<ea;qa+=O){var ua=H[qa];const ra=H[qa+1],Ba=H[ea],ya=H[ea+1];let Aa=H[da],Ca=H[da+1],za=Ba-Aa,Fa=ya-Ca;if(0!==za||0!==Fa){const Ra=
((ua-Aa)*za+(ra-Ca)*Fa)/(za*za+Fa*Fa);1<Ra?(Aa=Ba,Ca=ya):0<Ra&&(Aa+=za*Ra,Ca+=Fa*Ra)}za=ua-Aa;Fa=ra-Ca;ua=za*za+Fa*Fa;ua>la&&(ma=qa,la=ua)}la>V&&(ma-da>O&&sa(C,H,O,V,aa,da,ma),aa(C,H,C.length,ma,H[ma],H[ma+1]),ea-ma>O&&sa(C,H,O,V,aa,ma,ea))}function wa(C,H,O,V,aa){const {coords:da,lengths:ea}=H;O=w(O,V);if(!da.length)return C!==H&&Da(C),C;D.assertIsSome(aa);const {originPosition:la,scale:ma,translate:ua}=aa;aa=ja;aa.originPosition=la;V=aa.scale;V[0]=ma[0]??1;V[1]=-(ma[1]??1);V[2]=ma[2]??1;V[3]=ma[3]??
1;var qa=aa.translate;qa[0]=ua[0]??0;qa[1]=ua[1]??0;qa[2]=ua[2]??0;qa[3]=ua[3]??0;if(!ea.length){for(V=0;V<O;++V)C.coords[V]=J(aa,da[V],V);C!==H&&Da(C,O,0);return C}qa=0;for(let Ba=0;Ba<ea.length;Ba++){const ya=ea[Ba];C.lengths[Ba]=ya;for(var ra=0;ra<O;++ra)C.coords[qa+ra]=J(aa,da[qa+ra],ra);ra=C.coords[qa];let Aa=C.coords[qa+1];qa+=O;for(let Ca=1;Ca<ya;Ca++,qa+=O){ra+=da[qa]*V[0];Aa+=da[qa+1]*V[1];C.coords[qa]=ra;C.coords[qa+1]=Aa;for(let za=2;za<O;++za)C.coords[qa+za]=J(aa,da[qa+za],za)}}C!==H&&
Da(C,da.length,ea.length);return C}function xa(C,H,O,V){let aa=0,da=C[V*H],ea=C[V*(H+1)];for(let la=1;la<O;la++){const ma=da+C[V*(H+la)],ua=ea+C[V*(H+la)+1],qa=(ma-da)*(ua+ea);da=ma;ea=ua;aa+=qa}return.5*aa}function Da(C,H=0,O=0){Ea(C.lengths,O);Ea(C.coords,H)}function Ea(C,H=0){C.length!==H&&(C.length=H)}const Ja=()=>x.getLogger("esri.layers.graphics.featureConversionUtils"),Sa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},
ab=(C,H,O,V,aa,da)=>{C[O]=aa;C[O+1]=da},La=(C,H,O,V,aa,da)=>{C[O]=aa;C[O+1]=da;C[O+2]=H[V+2]},m=(C,H,O,V,aa,da)=>{C[O]=aa;C[O+1]=da;C[O+2]=H[V+3]},F=(C,H,O,V,aa,da)=>{C[O]=aa;C[O+1]=da;C[O+2]=H[V+2];C[O+3]=H[V+3]},W=[],ba=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};e.convertFromFeature=function(C,H,O,V,aa){W[0]=C;[C]=ia(ba,W,H,O,V,aa);Ea(W);Ea(ba);return C};e.convertFromFeatureSet=function(C,H){const O=new k,{hasM:V,hasZ:aa,features:da,objectIdFieldName:ea,spatialReference:la,
geometryType:ma,exceededTransferLimit:ua,transform:qa,fields:ra}=C;ra&&(O.fields=ra);O.geometryType=ma??null;O.objectIdFieldName=ea??H??null;O.spatialReference=la??null;if(!O.objectIdFieldName)return Ja().error(new l("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),O;da&&ia(O.features,da,ma,aa,V,O.objectIdFieldName);ua&&(O.exceededTransferLimit=ua);V&&(O.hasM=V);aa&&(O.hasZ=aa);qa&&(O.transform=qa);return O};e.convertFromFeatures=ia;e.convertFromGeometry=function(C,
H,O){if(null==C)return null;const V=new y;"hasZ"in C&&null==H&&(H=C.hasZ);"hasM"in C&&null==O&&(O=C.hasM);if(a.isPoint(C))return Q(null!=H?H:null!=C.z,null!=O?O:null!=C.m)(V,C);if(a.isPolygon(C))return X(V,C,H,O);if(a.isPolyline(C))return A(V,C,w(H,O));if(a.isMultipoint(C))return g(V,C,w(H,O));Ja().error("convertFromGeometry:unknown-geometry",new l(`Unable to parse unknown geometry type '${C}'`))};e.convertFromMultipoint=g;e.convertFromMultipointFeatures=R;e.convertFromNestedArray=ca;e.convertFromPoint=
U;e.convertFromPointFeatures=Z;e.convertFromPolygon=X;e.convertFromPolyline=A;e.convertFromPolylineFeatures=h;e.convertToFeature=function(C,H,O,V){ba[0]=C;oa(W,ba,H,O,V);C=W[0];Ea(W);Ea(ba);return C};e.convertToFeatureSet=function(C){const {objectIdFieldName:H,spatialReference:O,transform:V,fields:aa,hasM:da,hasZ:ea,features:la,geometryType:ma,exceededTransferLimit:ua,uniqueIdField:qa,queryGeometry:ra,queryGeometryType:Ba}=C;C=oa([],la,ma,ea,da);const ya=na(ra,Ba,!1,!1);C={features:C,fields:aa,geometryType:ma,
objectIdFieldName:H,spatialReference:O,uniqueIdField:qa,queryGeometry:ya};V&&(C.transform=V);ua&&(C.exceededTransferLimit=ua);da&&(C.hasM=da);ea&&(C.hasZ=ea);return C};e.convertToFeatures=oa;e.convertToGeometry=na;e.convertToMultipoint=u;e.convertToMultipointFeatures=T;e.convertToPoint=function(C,H,O){return C?H?O?z(C):b(C):O?L(C):K(C):null};e.convertToPolygon=P;e.convertToPolyline=f;e.generalizeOptimizedGeometry=function(C,H,O,V,aa,da,ea=O,la=V){Da(C);if(!H?.coords.length)return null;aa=Sa[aa];const {coords:ma,
lengths:ua}=H;H=w(O,V);const qa=w(O&&ea,V&&la);O=I(O,V,ea,la);if(!ua.length)return O(C.coords,ma,0,0,ma[0],ma[1]),Da(C,H,0),C;V=0;da*=da;for(const ra of ua){if(ra<aa){V+=ra*H;continue}ea=C.coords.length/qa;la=V;const Ba=V+(ra-1)*H;O(C.coords,ma,C.coords.length,la,ma[la],ma[la+1]);sa(C.coords,ma,H,da,O,la,Ba);O(C.coords,ma,C.coords.length,Ba,ma[Ba],ma[Ba+1]);la=C.coords.length/qa-ea;la>=aa?C.lengths.push(la):Ea(C.coords,ea*qa);V+=ra*H}return C.coords.length?C:null};e.getBoundsOptimizedGeometry=function(C,
H,O,V){if(!H?.coords?.length)return null;O=w(O,V);let aa=V=Number.POSITIVE_INFINITY,da=Number.NEGATIVE_INFINITY,ea=Number.NEGATIVE_INFINITY;if(H&&H.coords){H=H.coords;for(let la=0;la<H.length;la+=O){const ma=H[la],ua=H[la+1];V=Math.min(V,ma);da=Math.max(da,ma);aa=Math.min(aa,ua);ea=Math.max(ea,ua)}}t.is(C)?t.fromRectValues(C,V,aa,da,ea):N.fromValues(V,aa,da,ea,C);return C};e.getQuantizedArea=function(C,H){const {coords:O,lengths:V}=C;let aa=C=0;for(let da=0;da<V.length;da++){const ea=V[da];aa+=xa(O,
C,ea,H);C+=ea}return Math.abs(aa)};e.getQuantizedBoundsOptimizedGeometry=function(C,H,O,V){O=w(O,V);const {lengths:aa,coords:da}=H;V=H=Number.POSITIVE_INFINITY;let ea=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,ma=0;for(const ua of aa){let qa=da[ma],ra=da[ma+1];H=Math.min(qa,H);V=Math.min(ra,V);ea=Math.max(qa,ea);la=Math.max(ra,la);ma+=O;for(let Ba=1;Ba<ua;Ba++,ma+=O){const ya=da[ma],Aa=da[ma+1];qa+=ya;ra+=Aa;0>ya&&(H=Math.min(H,qa));0<ya&&(ea=Math.max(ea,qa));0>Aa?V=Math.min(V,ra):0<Aa&&
(la=Math.max(la,ra))}}C[0]=H;C[1]=V;C[2]=ea;C[3]=la;return C};e.getSignedQuantizedRingArea=xa;e.quantizeOptimizedFeatureSet=function(C,H){const {geometryType:O,features:V,hasM:aa,hasZ:da}=H;if(!C)return H;for(let ea=0;ea<V.length;ea++){const la=V[ea],ma=la.weakClone();ma.geometry=new y;pa(ma.geometry,la.geometry,aa,da,O,C);la.centroid&&(ma.centroid=new y,pa(ma.centroid,la.centroid,aa,da,"esriGeometryPoint",C));V[ea]=ma}H.transform=C;return H};e.quantizeOptimizedGeometry=pa;e.quantizeX=G;e.quantizeY=
r;e.removeCollinearVertices=function(C,H,O,V,aa){if(!H?.coords?.length)return null;O=Sa[O];const {coords:da,lengths:ea}=H;H=I(V,aa,V,aa);V=w(V,aa);let la=aa=0,ma=0,ua=0;for(const Ba of ea){la=ua;H(C.coords,da,la,aa,da[aa],da[aa+1]);aa+=V;var qa=da[aa];let ya=da[aa+1],Aa=qa,Ca=ya;var ra=ya/qa;la+=V;H(C.coords,da,la,aa,Aa,Ca);aa+=V;for(let za=2;za<Ba;za++){qa=da[aa];ya=da[aa+1];const Fa=ya/qa,Ra=ra===Fa||!isFinite(ra)&&!isFinite(Fa);ra=Ra&&isFinite(Fa)?0<=ra&&0<=Fa||0>=ra&&0>=Fa:0<=Ca&&0<=ya||0>=Ca&&
0>=ya;Ra&&ra?(Aa+=qa,Ca+=ya):(Aa=qa,Ca=ya,la+=V);H(C.coords,da,la,aa,Aa,Ca);aa+=V;ra=Fa}la+=V;qa=(la-ua)/V;qa>=O&&(C.lengths[ma]=qa,ua=la,ma++)}C.coords.length>ua&&(C.coords.length=ua);C.lengths.length>ma&&(C.lengths.length=ma);return C.coords.length&&C.lengths.length?C:null};e.removeZMValues=function(C,H,O,V,aa,da){Da(C);C.lengths.push(...H.lengths);if(O===aa&&V===da)for(var ea=0;ea<H.coords.length;ea++)C.coords.push(H.coords[ea]);else for(ea=w(O,V),O=I(O,V,aa,da),H=H.coords,V=0;V<H.length;V+=ea)O(C.coords,
H,C.coords.length,V,H[V],H[V+1]);return C};e.unquantizeOptimizedFeatureSet=function(C){const {transform:H,features:O,hasM:V,hasZ:aa}=C;if(!H)return C;for(const da of O)null!=da.geometry&&wa(da.geometry,da.geometry,V,aa,H),null!=da.centroid&&wa(da.centroid,da.centroid,V,aa,H);C.transform=null;return C};e.unquantizeOptimizedGeometry=wa;e.unquantizeValue=J;e.unquantizeX=function(C,H){return J(C,H,0)};e.unquantizeY=function(C,H){return J(C,-H,1)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect","./DoubleArray"],function(e,l,x,D){function t(b=K){return[b[0],b[1],b[2],b[3],b[4],b[5]]}function N(b,q,L,d,z,M,Q=t()){Q[0]=b;Q[1]=q;Q[2]=L;Q[3]=d;Q[4]=z;Q[5]=M;return Q}function a(b,q,L,d=t()){G(d,J);p(d,b,q,L);return d}function p(b,q,L=0,d=q.length/3){let z=b[0],M=b[1],Q=b[2],Z=b[3],U=b[4],T=b[5];for(let u=0;u<d;u++)z=Math.min(z,q[L+3*u]),M=Math.min(M,q[L+3*u+1]),Q=Math.min(Q,q[L+3*u+2]),Z=Math.max(Z,
q[L+3*u]),U=Math.max(U,q[L+3*u+1]),T=Math.max(T,q[L+3*u+2]);b[0]=z;b[1]=M;b[2]=Q;b[3]=Z;b[4]=U;b[5]=T}function k(b){return b[0]>=b[3]?0:b[3]-b[0]}function y(b){return b[1]>=b[4]?0:b[4]-b[1]}function w(b){return b[2]>=b[5]?0:b[5]-b[2]}function I(b,q){return Math.max(q[0],b[0])<=Math.min(q[3],b[3])&&Math.max(q[1],b[1])<=Math.min(q[4],b[4])&&Math.max(q[2],b[2])<=Math.min(q[5],b[5])}function G(b,q){b[0]=q[0];b[1]=q[1];b[2]=q[2];b[3]=q[3];b[4]=q[4];b[5]=q[5];return b}function r(b){return 6===b.length}
const J=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],K=[0,0,0,0,0,0],v=t();e.allFinite=function(b){for(let q=0;6>q;q++)if(!isFinite(b[q]))return!1;return!0};e.center=function(b,q=[0,0,0]){q[0]=b[0]+k(b)/2;q[1]=b[1]+y(b)/2;q[2]=b[2]+w(b)/2;return q};e.contains=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[3]<=b[3]&&q[4]<=b[4]&&q[5]<=b[5]};e.containsPoint=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[0]<=b[3]&&q[1]<=b[4]&&q[2]<=b[5]};e.containsPointWithMargin=
function(b,q,L){return q[0]>=b[0]-L&&q[1]>=b[1]-L&&q[2]>=b[2]-L&&q[0]<=b[3]+L&&q[1]<=b[4]+L&&q[2]<=b[5]+L};e.create=t;e.depth=y;e.diameter=function(b){const q=k(b),L=w(b);b=y(b);return Math.sqrt(q*q+L*L+b*b)};e.empty=function(b){return b?G(b,J):t(J)};e.equals=function(b,q,L){if(null==b||null==q)return b===q;if(!r(b)||!r(q))return!1;if(L)for(let d=0;d<b.length;d++){if(!L(b[d],q[d]))return!1}else for(L=0;L<b.length;L++)if(b[L]!==q[L])return!1;return!0};e.expandWithAABB=function(b,q){b[0]=Math.min(b[0],
q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],q[3]);b[4]=Math.max(b[4],q[4]);b[5]=Math.max(b[5],q[5])};e.expandWithBuffer=p;e.expandWithNestedArray=function(b,q,L){const d=q.length;let z=b[0],M=b[1],Q=b[2],Z=b[3],U=b[4],T=b[5];if(L)for(L=0;L<d;L++){var u=q[L];z=Math.min(z,u[0]);M=Math.min(M,u[1]);Q=Math.min(Q,u[2]);Z=Math.max(Z,u[0]);U=Math.max(U,u[1]);T=Math.max(T,u[2])}else for(L=0;L<d;L++)u=q[L],z=Math.min(z,u[0]),M=Math.min(M,u[1]),Z=Math.max(Z,u[0]),U=Math.max(U,
u[1]);b[0]=z;b[1]=M;b[2]=Q;b[3]=Z;b[4]=U;b[5]=T};e.expandWithOffset=function(b,q,L,d){b[0]=Math.min(b[0],b[0]+q);b[3]=Math.max(b[3],b[3]+q);b[1]=Math.min(b[1],b[1]+L);b[4]=Math.max(b[4],b[4]+L);b[2]=Math.min(b[2],b[2]+d);b[5]=Math.max(b[5],b[5]+d)};e.expandWithRect=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[3]=Math.max(b[3],q[2]);b[4]=Math.max(b[4],q[3])};e.expandWithVec3=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],
q[0]);b[4]=Math.max(b[4],q[1]);b[5]=Math.max(b[5],q[2])};e.fromBuffer=function(b,q=t()){return a(b,0,b.length/3,q)};e.fromExtent=function(b,q=t()){q[0]=b.xmin;q[1]=b.ymin;q[2]=b.hasZ?b.zmin:-Infinity;q[3]=b.xmax;q[4]=b.ymax;q[5]=b.hasZ?b.zmax:Infinity;return q};e.fromMinMax=function(b,q,L=t()){L[0]=b[0];L[1]=b[1];L[2]=b[2];L[3]=q[0];L[4]=q[1];L[5]=q[2];return L};e.fromRect=function(b,q){b[0]=q[0];b[1]=q[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=q[2];b[4]=q[3];b[5]=Number.POSITIVE_INFINITY;return b};e.fromRectValues=
function(b,q,L,d,z){b[0]=q;b[1]=L;b[2]=Number.NEGATIVE_INFINITY;b[3]=d;b[4]=z;b[5]=Number.POSITIVE_INFINITY;return b};e.fromSubBuffer=a;e.fromValues=N;e.getMax=function(b,q){q[0]=b[3];q[1]=b[4];q[2]=b[5];return q};e.getMin=function(b,q){q[0]=b[0];q[1]=b[1];q[2]=b[2];return q};e.height=w;e.intersects=I;e.intersectsClippingArea=function(b,q){return null==q?!0:I(b,q)};e.is=r;e.isPoint=function(b){return 0===k(b)&&0===y(b)&&0===w(b)};e.maximumDimension=function(b){return Math.max(k(b),w(b),y(b))};e.negativeInfinity=
J;e.offset=function(b,q,L,d,z=b){z[0]=b[0]+q;z[1]=b[1]+L;z[2]=b[2]+d;z[3]=b[3]+q;z[4]=b[4]+L;z[5]=b[5]+d;return z};e.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];e.scale=function(b,q,L=b){const d=b[0]+k(b)/2,z=b[1]+y(b)/2,M=b[2]+w(b)/2;L[0]=d+(b[0]-d)*q;L[1]=z+(b[1]-z)*q;L[2]=M+(b[2]-M)*q;L[3]=d+(b[3]-d)*q;L[4]=z+(b[4]-z)*q;L[5]=M+(b[5]-M)*q;return L};e.set=G;e.setMax=function(b,q,L=b){L[3]=q[0];L[4]=q[1];L[5]=q[2];L!==b&&(L[0]=b[0],L[1]=b[1],L[2]=b[2]);return b};e.setMin=
function(b,q,L=b){L[0]=q[0];L[1]=q[1];L[2]=q[2];L!==b&&(L[3]=b[3],L[4]=b[4],L[5]=b[5]);return L};e.size=function(b,q=[0,0,0]){q[0]=k(b);q[1]=y(b);q[2]=w(b);return q};e.toCorners=function(b,q=D.newDoubleArray(24)){const [L,d,z,M,Q,Z]=b;q[0]=L;q[1]=d;q[2]=z;q[3]=L;q[4]=d;q[5]=Z;q[6]=L;q[7]=Q;q[8]=z;q[9]=L;q[10]=Q;q[11]=Z;q[12]=M;q[13]=d;q[14]=z;q[15]=M;q[16]=d;q[17]=Z;q[18]=M;q[19]=Q;q[20]=z;q[21]=M;q[22]=Q;q[23]=Z;return q};e.toExtent=function(b,q){return isFinite(b[2])||isFinite(b[5])?new l({xmin:b[0],
xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:q}):new l({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:q})};e.toRect=function(b,q){q||=x.create();q[0]=b[0];q[1]=b[1];q[2]=b[3];q[3]=b[4];return q};e.width=k;e.wrap=function(b,q,L,d,z,M){return N(b,q,L,d,z,M,v)};e.zero=K;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/DoubleArray":function(){define(["exports","../../core/typedArrayUtil"],function(e,l){e.copyInto=function(x,D){for(let t=
0;t<D.length;++t)x[t]=D[t];return x};e.doubleArrayFrom=function(x){return(l.isArray(x)?x.length:x.byteLength/8)<=l.nativeArrayMaxSize?Array.from(x):new Float64Array(x)};e.doubleSubArray=function(x,D,t){return Array.isArray(x)?x.slice(D,D+t):x.subarray(D,D+t)};e.newDoubleArray=function(x,D=!1){return x<=l.nativeArrayMaxSize?D?Array(x).fill(0):Array(x):new Float64Array(x)};e.toFloat64Array=function(x){return Array.isArray(x)?new Float64Array(x):x};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(e,l){class x{constructor(t=null,N={},a,p){this.geometry=t;this.attributes=N;this.centroid=a;this.objectId=p;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(t,N){const a=t.geometry?l.fromJSON(t.geometry):null,p=t.centroid?l.fromJSON(t.centroid):null;return new x(a,t.attributes,p,t.attributes[N])}weakClone(){const t=new x(this.geometry,this.attributes,this.centroid,this.objectId);t.displayId=
this.displayId;t.geohashX=this.geohashX;t.geohashY=this.geohashY;return t}clone(){var t=this.geometry?.clone();t=new x(t,{...this.attributes},this.centroid?.clone(),this.objectId);t.displayId=this.displayId;t.geohashX=this.geohashX;t.geohashY=this.geohashY;return t}}class D extends x{}e.OptimizedFeature=x;e.OptimizedFeatureWithGeometry=D;e.hasGeometry=function(t){return!!t.geometry?.coords?.length};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class e{constructor(l=
[],x=[]){this.lengths=l??[];this.coords=x??[]}static fromJSON(l){return new e(l.lengths,l.coords)}static fromRect(l){const [x,D,t,N]=l;l=t-x;const a=N-D;return new e([5],[x,D,l,0,0,a,-l,0,0,-a])}get isPoint(){return 0===this.lengths.length&&2<=this.coords.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((l,x)=>l+x)}forEachVertex(l){let x=0;this.lengths.length||l(this.coords[0],this.coords[1]);for(let D=0;D<this.lengths.length;D++){const t=this.lengths[D];
for(let N=0;N<t;N++)l(this.coords[2*(N+x)],this.coords[2*(N+x)+1]);x+=t}}deltaDecode(){const l=this.clone(),{coords:x,lengths:D}=l;let t=0;for(const N of D){for(let a=1;a<N;a++)x[2*(t+a)]+=x[2*(t+a)-2],x[2*(t+a)+1]+=x[2*(t+a)-1];t+=N}return l}clone(l){if(0===this.lengths.length)return new e([],[this.coords[0],this.coords[1]]);var x=2*(0===this.lengths.length?1:this.lengths.reduce((D,t)=>D+t));x=this.coords.slice(0,x);return l?(l.set(x),new e(this.lengths,l)):new e(Array.from(this.lengths),Array.from(x))}}
return e})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class e{constructor(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const l=new e;l.objectIdFieldName=this.objectIdFieldName;l.globalIdFieldName=
this.globalIdFieldName;l.geohashFieldName=this.geohashFieldName;l.geometryProperties=this.geometryProperties;l.geometryType=this.geometryType;l.spatialReference=this.spatialReference;l.hasZ=this.hasZ;l.hasM=this.hasM;l.features=this.features;l.fields=this.fields;l.transform=this.transform;l.exceededTransferLimit=this.exceededTransferLimit;l.uniqueIdField=this.uniqueIdField;l.queryGeometry=this.queryGeometry;l.queryGeometryType=this.queryGeometryType;return l}}return e})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(e,l,x,D,t,N,a,p,k,y){const w=t.create();class I{constructor(G){this.geometryInfo=G;this._boundsStore=new p.BoundsStore;this._featuresById=new Map;this.events=new x;this.featureAdapter=y.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let G=0;
this._featuresById.forEach(r=>{null!=r.geometry&&r.geometry.coords&&(G+=r.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:G/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(G){if(null==this.fullBounds)return null;const [r,J,K,v]=this.fullBounds;return{xmin:r,ymin:J,xmax:K,ymax:v,spatialReference:k.cleanFromGeometryEngine(G)}}add(G){this._add(G);this._emitChanged()}addMany(G){for(const r of G)this._add(r);this._emitChanged()}upsertMany(G){G=G.map(r=>this._upsert(r));
this._emitChanged();return G.filter(e.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(G){G=this._featuresById.get(G);if(!G)return null;this._remove(G);this._emitChanged();return G}removeManyById(G){this._boundsStore.invalidateIndex();for(const r of G)(G=this._featuresById.get(r))&&this._remove(G);this._emitChanged()}forEachBounds(G,r){for(const J of G)(G=this._boundsStore.get(J.objectId))&&r(t.fromRect(w,G))}getFeature(G){return this._featuresById.get(G)}has(G){return this._featuresById.has(G)}forEach(G){this._featuresById.forEach(r=>
G(r))}forEachInBounds(G,r){this._boundsStore.forEachInBounds(G,J=>{r(this._featuresById.get(J))})}_emitChanged(){this.events.emit("changed",void 0)}_add(G){if(G){var r=G.objectId;if(null==r)D.getLogger("esri.layers.graphics.data.FeatureStore").error(new l("featurestore:invalid-feature","feature id is missing",{feature:G}));else{var J=this._featuresById.get(r);if(J){G.displayId=J.displayId;var K=this._boundsStore.get(r);this._boundsStore.delete(r)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(G);
G.geometry?.coords?.length?(K=a.getBoundsOptimizedGeometry(null!=K?K:N.create(),G.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=K&&this._boundsStore.set(r,K)):this._boundsStore.set(r,null);this._featuresById.set(r,G)}}}_upsert(G){const r=G?.objectId;if(null==r)return D.getLogger("esri.layers.graphics.data.FeatureStore").error(new l("featurestore:invalid-feature","feature id is missing",{feature:G})),null;const J=this._featuresById.get(r);if(!J)return this._add(G),G;const {geometry:K,
attributes:v}=G;for(const b in v)J.attributes[b]=v[b];K&&(J.geometry=K,this._boundsStore.set(r,a.getBoundsOptimizedGeometry(N.create(),K,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return J}_remove(G){if(null!=this.onFeatureRemove)this.onFeatureRemove(G);const r=G.objectId;this._boundsStore.delete(r);this._featuresById.delete(r);return G}}return I})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],
function(e,l,x,D){function t(p,k,y){N.minX=k[0];N.minY=k[1];N.maxX=k[2];N.maxY=k[3];p.search(N,y)}const N={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new x.PooledRBush(9,l("esri-csp-restrictions")?p=>({minX:p[0],minY:p[1],maxX:p[2],maxY:p[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const p=Array(this._idByBounds.size);let k=0;this._idByBounds.forEach((y,
w)=>{p[k++]=w});this._indexInvalid=!1;this._index.clear();this._index.load(p)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(p=>this._idByBounds.has(p))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const p=D.empty();for(const k of this._boundsById.values())k&&(p[0]=Math.min(k[0],p[0]),p[1]=Math.min(k[1],p[1]),p[2]=Math.max(k[2],p[2]),p[3]=Math.max(k[3],p[3]));return p}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(p){const k=this._boundsById.get(p);this._boundsById.delete(p);k&&(this._idByBounds.delete(k),this._indexInvalid||this._index.remove(k))}forEachInBounds(p,k){this._loadIndex();t(this._index,p,y=>k(this._idByBounds.get(y)))}get(p){return this._boundsById.get(p)}has(p){return this._boundsById.has(p)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(p,
k){if(!this._indexInvalid){const y=this._boundsById.get(p);y&&(this._index.remove(y),this._idByBounds.delete(y))}this._boundsById.set(p,k);k&&(this._idByBounds.set(k,p),this._indexInvalid||(this._boundsToLoad.push(k),5E4<this._boundsToLoad.length&&this._loadIndex()))}}e.BoundsStore=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has","../../PooledArray","../../../chunks/quickselect"],function(e,
l,x,D,t){function N(U,T){for(q.clear();U;){if(!0===U.leaf)for(const u of U.children)T(u);else q.pushArray(U.children);U=q.pop()??null}}function a(U,T){p(U,0,U.children.length,T,U)}function p(U,T,u,R,g){g||=new Q([]);g.minX=Infinity;g.minY=Infinity;g.maxX=-Infinity;g.maxY=-Infinity;for(let f=T,h;f<u;f++)h=U.children[f],k(g,U.leaf?R(h):h);return g}function k(U,T){U.minX=Math.min(U.minX,T.minX);U.minY=Math.min(U.minY,T.minY);U.maxX=Math.max(U.maxX,T.maxX);U.maxY=Math.max(U.maxY,T.maxY)}function y(U,
T){return U.minX-T.minX}function w(U,T){return U.minY-T.minY}function I(U){return(U.maxX-U.minX)*(U.maxY-U.minY)}function G(U){return U.maxX-U.minX+(U.maxY-U.minY)}function r(U,T){return U.minX<=T.minX&&U.minY<=T.minY&&T.maxX<=U.maxX&&T.maxY<=U.maxY}function J(U,T){return T.minX<=U.maxX&&T.minY<=U.maxY&&T.maxX>=U.minX&&T.maxY>=U.minY}function K(U,T,u,R,g){for(T=[T,u];T.length;){u=T.pop();const f=T.pop();if(u-f<=R)continue;const h=f+Math.ceil((u-f)/R/2)*R;t.quickselect(U,h,f,u,g);T.push(f,h,h,u)}}
class v{constructor(U=9,T){this._compareMinX=y;this._compareMinY=w;this._toBBox=u=>u;this._maxEntries=Math.max(4,U||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));T&&("function"===typeof T?this._toBBox=T:this._initFormat(T));this.clear()}destroy(){this.clear();b.prune();q.prune();L.prune();d.prune()}all(U){N(this._data,U)}search(U,T){let u=this._data;const R=this._toBBox;if(J(U,u))for(b.clear();u;){for(let g=0,f=u.children.length;g<f;g++){const h=u.children[g],A=u.leaf?R(h):h;J(U,
A)&&(u.leaf?T(h):r(U,A)?N(h,T):b.push(h))}u=b.pop()}}collides(U){let T=this._data;const u=this._toBBox;if(!J(U,T))return!1;for(b.clear();T;){for(let R=0,g=T.children.length;R<g;R++){const f=T.children[R],h=T.leaf?u(f):f;if(J(U,h)){if(T.leaf||r(U,h))return!0;b.push(f)}}T=b.pop()}return!1}load(U){if(!U.length)return this;if(U.length<this._minEntries){for(let T=0,u=U.length;T<u;T++)this.insert(U[T]);return this}U=this._build(U.slice(),0,U.length-1,0);if(this._data.children.length)if(this._data.height===
U.height)this._splitRoot(this._data,U);else{if(this._data.height<U.height){const T=this._data;this._data=U;U=T}this._insert(U,this._data.height-U.height-1,!0)}else this._data=U;return this}insert(U){U&&this._insert(U,this._data.height-1);return this}clear(){this._data=new Q([]);return this}remove(U){if(!U)return this;let T=this._data,u=null,R=0,g=!1,f;const h=this._toBBox(U);L.clear();for(d.clear();T||0<L.length;){T||(T=L.pop(),u=L.data[L.length-1],R=d.pop()??0,g=!0);if(T.leaf&&(f=l.indexOf(T.children,
U,T.children.length,T.indexHint),-1!==f)){T.children.splice(f,1);L.push(T);this._condense(L);break}g||T.leaf||!r(T,h)?u?(R++,T=u.children[R],g=!1):T=null:(L.push(T),d.push(R),R=0,u=T,T=T.children[0])}return this}toJSON(){return this._data}fromJSON(U){this._data=U;return this}_build(U,T,u,R){var g=u-T+1,f=this._maxEntries;if(g<=f)return U=new Q(U.slice(T,u+1)),a(U,this._toBBox),U;R||(R=Math.ceil(Math.log(g)/Math.log(f)),f=Math.ceil(g/f**(R-1)));const h=new Z([]);h.height=R;g=Math.ceil(g/f);f=g*Math.ceil(Math.sqrt(f));
for(K(U,T,u,f,this._compareMinX);T<=u;T+=f){const A=Math.min(T+f-1,u);K(U,T,A,g,this._compareMinY);for(let P=T;P<=A;P+=g)h.children.push(this._build(U,P,Math.min(P+g-1,A),R-1))}a(h,this._toBBox);return h}_insert(U,T,u){var R=this._toBBox;u=u?U:R(U);L.clear();R=this._data;for(var g=T,f=L;;){f.push(R);if(!0===R.leaf||f.length-1===g)break;let h=Infinity,A=Infinity,P=void 0;for(let X=0,ca=R.children.length;X<ca;X++){const ia=R.children[X],na=I(ia),oa=(Math.max(ia.maxX,u.maxX)-Math.min(ia.minX,u.minX))*
(Math.max(ia.maxY,u.maxY)-Math.min(ia.minY,u.minY))-na;oa<A?(A=oa,h=na<h?na:h,P=ia):oa===A&&na<h&&(h=na,P=ia)}R=P||R.children[0]}R.children.push(U);for(k(R,u);0<=T;)if(L.data[T].children.length>this._maxEntries)this._split(L,T),T--;else break;for(U=L;0<=T;T--)k(U.data[T],u)}_split(U,T){const u=U.data[T];var R=u.children.length;const g=this._minEntries;this._chooseSplitAxis(u,g,R);if(R=this._chooseSplitIndex(u,g,R))R=u.children.splice(R,u.children.length-R),R=u.leaf?new Q(R):new Z(R),R.height=u.height,
a(u,this._toBBox),a(R,this._toBBox),T?U.data[T-1].children.push(R):this._splitRoot(u,R)}_splitRoot(U,T){this._data=new Z([U,T]);this._data.height=U.height+1;a(this._data,this._toBBox)}_chooseSplitIndex(U,T,u){let R,g,f=void 0;R=g=Infinity;for(let A=T;A<=u-T;A++){var h=p(U,0,A,this._toBBox);const P=p(U,A,u,this._toBBox),X=Math.max(0,Math.min(h.maxX,P.maxX)-Math.max(h.minX,P.minX))*Math.max(0,Math.min(h.maxY,P.maxY)-Math.max(h.minY,P.minY));h=I(h)+I(P);X<R?(R=X,f=A,g=h<g?h:g):X===R&&h<g&&(g=h,f=A)}return f}_chooseSplitAxis(U,
T,u){const R=U.leaf?this._compareMinX:y,g=U.leaf?this._compareMinY:w,f=this._allDistMargin(U,T,u,R);T=this._allDistMargin(U,T,u,g);f<T&&U.children.sort(R)}_allDistMargin(U,T,u,R){U.children.sort(R);R=this._toBBox;var g=p(U,0,T,R);const f=p(U,u-T,u,R);let h=G(g)+G(f);for(let A=T;A<u-T;A++){const P=U.children[A];k(g,U.leaf?R(P):P);h+=G(g)}for(u=u-T-1;u>=T;u--)g=U.children[u],k(f,U.leaf?R(g):g),h+=G(f);return h}_condense(U){for(let T=U.length-1;0<=T;T--){const u=U.data[T];if(0===u.children.length)if(0<
T){const R=U.data[T-1],g=R.children;g.splice(l.indexOf(g,u,g.length,R.indexHint),1)}else this.clear();else a(u,this._toBBox)}}_initFormat(U){const T=["return a"," - b",";"];this._compareMinX=new Function("a","b",T.join(U[0]));this._compareMinY=new Function("a","b",T.join(U[1]));this._toBBox=new Function("a","return {minX: a"+U[0]+", minY: a"+U[1]+", maxX: a"+U[2]+", maxY: a"+U[3]+"};")}}const b=new D,q=new D,L=new D,d=new D({deallocator:void 0});class z{constructor(){this.minY=this.minX=Infinity;
this.maxY=this.maxX=-Infinity}}class M extends z{constructor(){super(...arguments);this.height=1;this.indexHint=new l.PositionHint}}class Q extends M{constructor(U){super();this.children=U;this.leaf=!0}}class Z extends M{constructor(U){super();this.children=U;this.leaf=!1}}e.BBox=z;e.PooledRBush=v;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports"],function(e){function l(t,N,a,p,k){for(;p>a;){if(600<p-a){var y=p-a+1,w=N-a+1,I=Math.log(y),
G=.5*Math.exp(2*I/3);I=.5*Math.sqrt(I*G*(y-G)/y)*(0>w-y/2?-1:1);l(t,N,Math.max(a,Math.floor(N-w*G/y+I)),Math.min(p,Math.floor(N+(y-w)*G/y+I)),k)}y=t[N];w=a;G=p;x(t,a,N);for(0<k(t[p],y)&&x(t,a,p);w<G;){x(t,w,G);w++;for(G--;0>k(t[w],y);)w++;for(;0<k(t[G],y);)G--}0===k(t[a],y)?x(t,a,G):(G++,x(t,G,p));G<=N&&(a=G+1);N<=G&&(p=G-1)}}function x(t,N,a){var p=t[N];t[N]=t[a];t[a]=p}function D(t,N){return t<N?-1:t>N?1:0}e.quickselect=function(t,N,a,p,k){l(t,N,a||0,p||t.length-1,k||D)}})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports",
"../featureConversionUtils","../OptimizedGeometry"],function(e,l,x){const D=new x,t=new x,N=new x,a={esriGeometryPoint:l.convertToPoint,esriGeometryPolyline:l.convertToPolyline,esriGeometryPolygon:l.convertToPolygon,esriGeometryMultipoint:l.convertToMultipoint},p=(k,y)=>"_geVersion"!==k?y:void 0;e.cleanFromGeometryEngine=function(k){return k&&"_geVersion"in k?JSON.parse(JSON.stringify(k,p)):k};e.getGeometry=function(k,y,w,I,G,r,J=y,K=w){const v=y&&J,b=w&&K;I=null!=I?"coords"in I?I:I.geometry:null;
if(null==I)return null;if(G)return y=l.generalizeOptimizedGeometry(t,I,y,w,k,G,J,K),r&&(y=l.quantizeOptimizedGeometry(N,y,v,b,k,r)),a[k]?.(y,v,b)??null;if(r)return r=l.quantizeOptimizedGeometry(N,I,y,w,k,r,J,K),a[k]?.(r,v,b)??null;l.removeZMValues(D,I,y,w,J,K);return a[k]?.(D,v,b)??null};e.transformCentroid=function(k,y,w,I=k.hasZ,G=k.hasM){if(null==y)return null;const r=k.hasZ&&I,J=k.hasM&&G;return w?(k=l.quantizeOptimizedGeometry(N,y,k.hasZ,k.hasM,"esriGeometryPoint",w,I,G),l.convertToPoint(k,r,
J)):l.convertToPoint(y,r,J)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(e,l,x,D){e.optimizedFeatureQueryEngineAdapter={getObjectId(t){return t.objectId},getAttributes(t){return t.attributes},getAttribute(t,N){return t.attributes[N]},cloneWithGeometry(t,N){return new x.OptimizedFeature(N,t.attributes,null,t.objectId)},
getGeometry(t){return t.geometry},getCentroid(t,N){null==t.centroid&&(t.centroid=l.getCentroidOptimizedGeometry(new D,t.geometry,N.hasZ,N.hasM));return t.centroid}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(e){function l(D,t,N,a,p,k){k=p?k?4:3:k?3:2;let y=N,w=N+k,I=0,G=0,r=N=0,J=0;for(let K=0,v=a-1;K<v;K++,y+=k,w+=k){a=t[y];const b=t[y+1],q=t[y+2],L=t[w],d=t[w+1],z=t[w+2];let M=a*d-L*b;r+=M;I+=(a+L)*M;G+=
(b+d)*M;p&&(M=a*z-L*q,N+=(q+z)*M,J+=M);a<D[0]&&(D[0]=a);a>D[1]&&(D[1]=a);b<D[2]&&(D[2]=b);b>D[3]&&(D[3]=b);p&&(q<D[4]&&(D[4]=q),q>D[5]&&(D[5]=q))}0<r&&(r*=-1);0<J&&(J*=-1);if(!r)return null;D=[I,G,.5*r];p&&(D[3]=N,D[4]=.5*J);return D}function x(D,t,N,a,p){p=a?p?4:3:p?3:2;let k=t,y=t+p,w=0,I=0,G=0,r=0;for(let b=0,q=N-1;b<q;b++,k+=p,y+=p){var J=D[k];const L=D[k+1],d=D[k+2],z=D[y],M=D[y+1],Q=D[y+2];if(a){var K=z-J;var v=M-L;const Z=Q-d;K=Math.sqrt(K*K+v*v+Z*Z)}else K=z-J,v=M-L,K=Math.sqrt(K*K+v*v);K&&
(w+=K,a?(J=[J+.5*(z-J),L+.5*(M-L),d+.5*(Q-d)],I+=K*J[0],G+=K*J[1],r+=K*J[2]):(J=[J+.5*(z-J),L+.5*(M-L)],I+=K*J[0],G+=K*J[1]))}return 0<w?a?[I/w,G/w,r/w]:[I/w,G/w]:0<N?a?[D[t],D[t+1],D[t+2]]:[D[t],D[t+1]]:null}e.getCentroidOptimizedGeometry=function(D,t,N,a){if(!t?.lengths.length)return null;D.lengths.length&&(D.lengths.length=0);D.coords.length&&(D.coords.length=0);const p=D.coords,k=[],y=N?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:w,coords:I}=t;var G=N?a?4:3:a?3:2;let r=0;for(const J of w){const K=l(y,I,r,J,N,a);K&&k.push(K);r+=J*G}k.sort((J,K)=>{let v=J[2]-K[2];0===v&&N&&(v=J[4]-K[4]);return v});k.length&&(G=6*k[0][2],p[0]=k[0][0]/G,p[1]=k[0][1]/G,N&&(G=6*k[0][4],p[2]=0!==G?k[0][3]/G:0),p[0]<y[0]||p[0]>y[1]||p[1]<y[2]||p[1]>y[3]||N&&(p[2]<y[4]||p[2]>y[5]))&&(p.length=0);if(!p.length)if(t=
t.lengths[0]?x(I,0,w[0],N,a):null)p[0]=t[0],p[1]=t[1],N&&2<t.length&&(p[2]=t[2]);else return null;return D};e.lineCentroid=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(e,l,x,
D,t,N,a){function p(K,v){if(!v)return null;if("x"in v){var b={x:0,y:0};[b.x,b.y]=K(v.x,v.y,w);null!=v.z&&(b.z=v.z);null!=v.m&&(b.m=v.m);return b}return"xmin"in v?(b={xmin:0,ymin:0,xmax:0,ymax:0},[b.xmin,b.ymin]=K(v.xmin,v.ymin,w),[b.xmax,b.ymax]=K(v.xmax,v.ymax,w),v.hasZ&&(b.zmin=v.zmin,b.zmax=v.zmax,b.hasZ=!0),v.hasM&&(b.mmin=v.mmin,b.mmax=v.mmax,b.hasM=!0),b):"rings"in v?{rings:k(v.rings,K),hasM:v.hasM,hasZ:v.hasZ}:"paths"in v?{paths:k(v.paths,K),hasM:v.hasM,hasZ:v.hasZ}:"points"in v?{points:y(v.points,
K),hasM:v.hasM,hasZ:v.hasZ}:null}function k(K,v){const b=[];for(const q of K)b.push(y(q,v));return b}function y(K,v){const b=[];for(const q of K)K=v(q[0],q[1],[0,0]),b.push(K),2<q.length&&K.push(q[2]),3<q.length&&K.push(q[3]);return b}const w=[0,0],I=p.bind(null,a.lngLatToXY),G=p.bind(null,a.xyToLngLat);class r{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(K,v,b,q){if(!K?.length||!v||!b||N.equals(v,b))return K;K={geometries:K,inSpatialReference:v,outSpatialReference:b,
geographicTransformation:q,resolve:x.createResolver()};this._jobs.push(K);this._timer??(this._timer=setTimeout(this._process,10));return K.resolve.promise}_process(){this._timer=null;const K=this._jobs.shift();if(K){var {geometries:v,inSpatialReference:b,outSpatialReference:q,resolve:L,geographicTransformation:d}=K;a.canProject(b,q)?N.isWebMercator(q)?L(v.map(I)):L(v.map(G)):L(D.projectMany(t.jsonAdapter,v,b,q,d,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}}}const J=new r;
e.checkProjectionSupport=async function(K,v){K&&v&&(K=Array.isArray(K)?K.map(b=>null!=b.geometry?b.geometry.spatialReference:null).filter(l.isSome):[K],await D.initializeProjection(K.map(b=>({source:b,dest:v}))))};e.project=function(K,v,b,q){if(!K)return K;b||(b=v,v=K.spatialReference);return N.isValid(v)&&N.isValid(b)&&!N.equals(v,b)?a.canProject(v,b)?(K=N.isWebMercator(b)?I(K):G(K),K.spatialReference=b,K):D.projectMany(t.jsonAdapter,[K],v,b,null,q)[0]:K};e.projectMany=function(K,v,b,q){return J.push(K,
v,b,q)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(e){class l{constructor(a,p,k){this.x=a;this.y=p;this.spatialReference=k;this.m=this.z=void 0}}class x{constructor(a,p,k,y){this.rings=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class D{constructor(a,p,k,y){this.paths=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class t{constructor(a,
p,k,y){this.points=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class N{constructor(a,p,k,y,w){this.xmin=a;this.ymin=p;this.xmax=k;this.ymax=y;this.spatialReference=w;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}e.jsonAdapter={convertToGEGeometry:function(a,p){return null==p?null:a.convertJSONToGeometry(p)},exportPoint:function(a,p,k){k=new l(a.getPointX(p),a.getPointY(p),k);const y=a.hasZ(p),w=a.hasM(p);y&&(k.z=a.getPointZ(p));w&&(k.m=a.getPointM(p));
return k},exportPolygon:function(a,p,k){return new x(a.exportPaths(p),k,a.hasZ(p),a.hasM(p))},exportPolyline:function(a,p,k){return new D(a.exportPaths(p),k,a.hasZ(p),a.hasM(p))},exportMultipoint:function(a,p,k){return new t(a.exportPoints(p),k,a.hasZ(p),a.hasM(p))},exportExtent:function(a,p,k){var y=a.hasZ(p);const w=a.hasM(p);k=new N(a.getXMin(p),a.getYMin(p),a.getXMax(p),a.getYMax(p),k);y&&(y=a.getZExtent(p),k.zmin=y.vmin,k.zmax=y.vmax);w&&(a=a.getMExtent(p),k.mmin=a.vmin,k.mmax=a.vmax);return k}};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCache ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J,K,v,b,q,L,d,z,M,Q,Z,U,T,u){function R(h){if(Z.canQueryWithRBush(h)){if(G.isExtent(h))return[w.fromValues(Math.min(h.xmin,h.xmax),Math.min(h.ymin,h.ymax),Math.max(h.xmin,h.xmax),Math.max(h.ymin,h.ymax))];if(G.isPolygon(h))return h.rings.map(A=>w.fromValues(Math.min(A[0][0],A[2][0]),Math.min(A[0][1],A[2][1]),Math.max(A[0][0],A[2][0]),Math.max(A[0][1],A[2][1])))}return[I.getBoundsXY(w.create(),h)]}class g{constructor(h,A=null,P,X,ca){this.attributes=h;this.geometry=
P;this.centroid=X;this.filterFlags=ca;this.groupId=-1;this.displayId=A}}class f{constructor(h){this._cache=new L.QueryEngineCache;this._changeHandle=null;this.capabilities={query:d.queryCapabilities};this.geometryType=h.geometryType;this.hasM=!!h.hasM;this.hasZ=!!h.hasZ;this.objectIdField=h.objectIdField;this.spatialReference=h.spatialReference;this.definitionExpression=h.definitionExpression;this.featureStore=h.featureStore;this.aggregateAdapter=h.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",
()=>this.clearCache());this.timeInfo=h.timeInfo;this.fieldsIndex=D.isSerializable(h.fieldsIndex)?h.fieldsIndex:T.fromJSON(h.fieldsIndex);this.availableFields=!h.availableFields||1===h.availableFields.length&&"*"===h.availableFields[0]?new Set(this.fieldsIndex.fields.map(A=>A.name)):new Set(h.availableFields.map(A=>this.fieldsIndex.get(A)?.name).filter(A=>null!=A));h.scheduler&&h.priority&&(this._frameTask=h.scheduler.registerTask(h.priority))}destroy(){this._frameTask=N.removeMaybe(this._frameTask);
this.clearCache();N.destroyMaybe(this._cache);this._changeHandle=N.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._cache.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(h,A){A=a.signalFromSignalOrOptions(A);try{return await (await this._executeQuery(h,{},A)).createQueryResponse()}catch(P){if(P!==M.queryEngineEmptyResult)throw P;return(new z.QueryEngineResult([],h,this)).createQueryResponse()}}async executeQueryForCount(h=
{},A){A=a.signalFromSignalOrOptions(A);try{return(await this._executeQuery(h,{returnGeometry:!1,returnCentroid:!1,outSR:null},A)).createQueryResponseForCount()}catch(P){if(P!==M.queryEngineEmptyResult)throw P;return 0}}async executeQueryForExtent(h,A){A=a.signalFromSignalOrOptions(A);const P=h.outSR;try{const X=await this._executeQuery(h,{returnGeometry:!0,returnCentroid:!1,outSR:null},A),ca=X.size;if(!ca)return{count:0,extent:null};const ia=await this._getBounds(X.items,X.spatialReference,P||this.spatialReference);
return{count:ca,extent:ia}}catch(X){if(X===M.queryEngineEmptyResult)return{count:0,extent:null};throw X;}}async executeQueryForIds(h,A){return this.executeQueryForIdSet(h,A).then(P=>Array.from(P))}async executeQueryForIdSet(h,A){A=a.signalFromSignalOrOptions(A);try{const P=await this._executeQuery(h,{returnGeometry:!0,returnCentroid:!1,outSR:null},A),X=P.items,ca=new Set;await this._reschedule(()=>{for(const ia of X)ca.add(P.featureAdapter.getObjectId(ia))},A);return ca}catch(P){if(P===M.queryEngineEmptyResult)return new Set;
throw P;}}async executeQueryForSnapping(h,A){const P=a.signalFromSignalOrOptions(A),{point:X,distance:ca,returnEdge:ia,vertexMode:na}=h;if(!ia&&"none"===na)return{candidates:[]};let oa=t.clone(h.query);oa=await this._schedule(()=>M.normalizeQueryLike(oa,this.definitionExpression,this.spatialReference),P);oa=await this._reschedule(()=>Q.validateQuery(oa,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),P);(A=!J.equals(X.spatialReference,
this.spatialReference))&&await q.checkProjectionSupport(X.spatialReference,this.spatialReference);var pa="number"===typeof ca?ca:ca.x,sa="number"===typeof ca?ca:ca.y;pa={xmin:X.x-pa,xmax:X.x+pa,ymin:X.y-sa,ymax:X.y+sa,spatialReference:X.spatialReference};pa=A?q.project(pa,this.spatialReference):pa;if(!pa)return{candidates:[]};sa=(await r.normalizeCentralMeridian(G.fromJSON(X),null,{signal:P}))[0];const wa=(await r.normalizeCentralMeridian(G.fromJSON(pa),null,{signal:P}))[0];if(null==sa||null==wa)return{candidates:[]};
const xa=new z.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(R(wa.toJSON())),P),oa,this);await this._reschedule(()=>this._executeObjectIdsQuery(xa),P);await this._reschedule(()=>this._executeTimeQuery(xa),P);await this._reschedule(()=>this._executeAttributesQuery(xa),P);await this._reschedule(()=>this._executeGeometryQueryForSnapping(xa,P),P);sa=sa.toJSON();sa=A?q.project(sa,this.spatialReference):sa;return xa.createSnappingResponse({...h,point:sa,distance:A?Math.max(pa.xmax-pa.xmin,
pa.ymax-pa.ymin)/2:ca},X.spatialReference)}async executeQueryForLatestObservations(h,A){A=a.signalFromSignalOrOptions(A);if(!this.timeInfo?.trackIdField)throw new x("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:h,timeInfo:this.timeInfo});try{const P=await this._executeQuery(h,{},A);await this._reschedule(()=>this._filterLatest(P),A);return await P.createQueryResponse()}catch(P){if(P!==M.queryEngineEmptyResult)throw P;return(new z.QueryEngineResult([],h,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(h=
{},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ia}=A;return(await this._executeQueryForStatistics(h,{field:X,normalizationField:ca,valueExpression:ia},P)).createSummaryStatisticsResponse(A)}async executeQueryForUniqueValues(h={},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,field2:ca,field3:ia,valueExpression:na}=A;return(await this._executeQueryForStatistics(h,{field:X,field2:ca,field3:ia,valueExpression:na},P)).createUniqueValuesResponse(A)}async executeQueryForClassBreaks(h=
{},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ia}=A;return(await this._executeQueryForStatistics(h,{field:X,normalizationField:ca,valueExpression:ia},P)).createClassBreaksResponse(A)}async executeQueryForHistogram(h={},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ia}=A;return(await this._executeQueryForStatistics(h,{field:X,normalizationField:ca,valueExpression:ia},P)).createHistogramResponse(A)}async fetchRecomputedExtents(h){h=
a.signalFromSignalOrOptions(h);this._timeExtentPromise||(this._timeExtentPromise=U.getTimeExtent(this.timeInfo,this.featureStore));const [A,P]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);a.throwIfAborted(h);return{fullExtent:A,timeExtent:P}}async _getBounds(h,A,P){const X=y.set(y.create(),y.negativeInfinity);await this.featureStore.forEachBounds(h,ca=>y.expandWithAABB(X,ca));h={xmin:X[0],ymin:X[1],xmax:X[3],ymax:X[4],spatialReference:b.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(X[2])&&isFinite(X[5])&&(h.zmin=X[2],h.zmax=X[5],h.hasZ=!0);A=q.project(h,A,P);A.spatialReference=b.cleanFromGeometryEngine(P);0===A.xmax-A.xmin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.xmin-=P,A.xmax+=P);0===A.ymax-A.ymin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.ymin-=P,A.ymax+=P);this.hasZ&&null!=A.zmin&&null!=A.zmax&&0===A.zmax-A.zmin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.zmin-=P,A.zmax+=P);return A}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(h=>this._getBounds(h,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(h,A){return null!=this._frameTask?this._frameTask.schedule(h,A):h(u.noBudget)}async _reschedule(h,A){return null!=this._frameTask?this._frameTask.reschedule(h,A):h(u.noBudget)}async _getAllFeaturesQueryEngineResult(h){return new z.QueryEngineResult(await this._getAllFeatures(),
h,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const P=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(X=>P.push(X))})().then(()=>P)}const h=this._allFeaturesPromise,A=await h;return h===this._allFeaturesPromise?A.slice():this._getAllFeatures()}async _executeQuery(h,A,P){h=t.clone(h);h=await this._schedule(()=>M.normalizeQuery(h,this.definitionExpression,this.spatialReference),P);h=await this._reschedule(()=>Q.validateQuery(h,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),P);h={...h,...A};const X=await this._reschedule(()=>this._executeSceneFilterQuery(h,P),P),ca=await this._reschedule(()=>this._executeGeometryQuery(h,X,P),P);await this._reschedule(()=>this._executeAggregateIdsQuery(ca),P);await this._reschedule(()=>this._executeObjectIdsQuery(ca),P);await this._reschedule(()=>this._executeTimeQuery(ca),P);await this._reschedule(()=>this._executeAttributesQuery(ca),
P);return ca}async _executeSceneFilterQuery(h,A){if(null==h.sceneFilter)return null;const {outSR:P,returnGeometry:X,returnCentroid:ca}=h;var ia=this.featureStore.featureSpatialReference,na=h.sceneFilter.geometry;const oa=null==ia||J.equals(ia,na.spatialReference)?na:q.project(na,ia);if(!oa)return null;ia=X||ca;ia=J.isValid(P)&&!J.equals(this.spatialReference,P)&&ia?async xa=>this._project(xa,P):xa=>xa;const pa=this.featureAdapter;na=await this._reschedule(()=>this._searchFeatures(R(oa)),A);if("disjoint"===
h.sceneFilter.spatialRelationship){if(!na.length)return null;const xa=new Set;for(var sa of na)xa.add(pa.getObjectId(sa));const Da=await this._reschedule(()=>this._getAllFeatures(),A);sa=await this._reschedule(async()=>{const Ea=await Z.getSpatialQueryOperator("esriSpatialRelDisjoint",oa,this.geometryType,this.hasZ,this.hasM),Ja=await this._runSpatialFilter(Da,Sa=>!xa.has(pa.getObjectId(Sa))||Ea(pa.getGeometry(Sa)),A);return new z.QueryEngineResult(Ja,h,this)},A);return ia(sa)}if(!na.length)return new z.QueryEngineResult([],
h,this);if(this._canExecuteSinglePass(oa,h))return ia(new z.QueryEngineResult(na,h,this));const wa=await Z.getSpatialQueryOperator("esriSpatialRelContains",oa,this.geometryType,this.hasZ,this.hasM);sa=await this._runSpatialFilter(na,xa=>wa(pa.getGeometry(xa)),A);return ia(new z.QueryEngineResult(sa,h,this))}async _executeGeometryQuery(h,A,P){if(null!=A&&0===A.items.length)return A;h=null!=A?A.query:h;const {geometry:X,outSR:ca,spatialRel:ia,returnGeometry:na,returnCentroid:oa}=h;var pa=this.featureStore.featureSpatialReference;
const sa=!X||null==pa||J.equals(pa,X.spatialReference)?X:q.project(X,pa),wa=na||oa,xa=J.isValid(ca)&&!J.equals(this.spatialReference,ca),Da=null==A?this._getCacheKey(h):null;pa=Da?this._cache.get(Da):null;if(null!=pa)return new z.QueryEngineResult(pa,h,this);pa=async La=>{xa&&wa&&await this._project(La,ca);Da&&this._cache.put(Da,La.items);return La};if(!sa)return pa(null!=A?A:await this._getAllFeaturesQueryEngineResult(h));const Ea=this.featureAdapter;let Ja=await this._reschedule(()=>this._searchFeatures(R(X)),
P);if("esriSpatialRelDisjoint"===ia){if(!Ja.length)return pa(null!=A?A:await this._getAllFeaturesQueryEngineResult(h));const La=new Set;for(var Sa of Ja)La.add(Ea.getObjectId(Sa));const m=null!=A?A.items:await this._reschedule(()=>this._getAllFeatures(),P);Sa=await this._reschedule(async()=>{const F=await Z.getSpatialQueryOperator(ia,sa,this.geometryType,this.hasZ,this.hasM),W=await this._runSpatialFilter(m,ba=>!La.has(Ea.getObjectId(ba))||F(Ea.getGeometry(ba)),P);return new z.QueryEngineResult(W,
h,this)},P);return pa(Sa)}if(null!=A){const La=new l.PositionHint;Ja=Ja.filter(m=>0<=l.indexOf(A.items,m,A.items.length,La))}if(!Ja.length)return pa=new z.QueryEngineResult([],h,this),Da&&this._cache.put(Da,pa.items),pa;if(this._canExecuteSinglePass(sa,h))return pa(new z.QueryEngineResult(Ja,h,this));const ab=await Z.getSpatialQueryOperator(ia,sa,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Ja,La=>ab(Ea.getGeometry(La)),P);return pa(new z.QueryEngineResult(Sa,h,this))}async _executeGeometryQueryForSnapping(h,
A){const {query:P}=h,{spatialRel:X}=P;if(h?.items?.length&&P.geometry&&X){var ca=await Z.getSpatialQueryOperator(X,P.geometry,this.geometryType,this.hasZ,this.hasM);A=await this._runSpatialFilter(h.items,ia=>ca(ia.geometry),A);h.items=A}}_executeAggregateIdsQuery(h){if(0!==h.items.length&&h.query.aggregateIds?.length&&null!=this.aggregateAdapter){var A=new Set;for(const X of h.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(X).forEach(ca=>A.add(ca));var P=this.featureAdapter.getObjectId;
h.items=h.items.filter(X=>A.has(P(X)))}}_executeObjectIdsQuery(h){if(0!==h.items.length&&h.query.objectIds?.length){var A=new Set(h.query.objectIds),P=this.featureAdapter.getObjectId;h.items=h.items.filter(X=>A.has(P(X)))}}_executeTimeQuery(h){if(0!==h.items.length){var A=U.getTimeOperator(this.timeInfo,h.query.timeExtent,this.featureAdapter);null!=A&&(h.items=h.items.filter(A))}}_executeAttributesQuery(h){if(0!==h.items.length){var A=v.getWhereClause(h.query.where,this.fieldsIndex);if(A){if(!A.isStandardized)throw new TypeError("Where clause is not standardized");
h.items=h.items.filter(P=>A.testFeature(P,this.featureAdapter))}}}async _runSpatialFilter(h,A,P){if(!A)return h;if(null==this._frameTask)return h.filter(na=>A(na));let X=0;const ca=[],ia=async na=>{for(;X<h.length;){const oa=h[X++];A(oa)&&(ca.push(oa),na.madeProgress());na.done&&await this._reschedule(pa=>ia(pa),P)}};return this._reschedule(na=>ia(na),P).then(()=>ca)}_filterLatest(h){const {trackIdField:A,startTimeField:P,endTimeField:X}=this.timeInfo,ca=X||P,ia=new Map,na=this.featureAdapter.getAttribute;
for(const oa of h.items){const pa=na(oa,A),sa=na(oa,ca),wa=ia.get(pa);(!wa||sa>na(wa,ca))&&ia.set(pa,oa)}h.items=Array.from(ia.values())}_getCacheKey(h){const {geometry:A,spatialRel:P,returnGeometry:X,returnCentroid:ca,outSR:ia,resultType:na,cacheHint:oa}=h;if("tile"!==na&&!oa)return null;h=X||ca;return J.isValid(ia)&&!J.equals(this.spatialReference,ia)&&h?JSON.stringify([A,P,ia]):JSON.stringify([A,P])}_canExecuteSinglePass(h,A){({spatialRel:A}=A);return Z.canQueryWithRBush(h)&&("esriSpatialRelEnvelopeIntersects"===
A||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===A||"esriSpatialRelContains"===A))}async _project(h,A){if(!A||J.equals(this.spatialReference,A))return h;const P=this.featureAdapter;let X=void 0;try{const ca=await this._getFullExtent();X=k.getTransformation(this.spatialReference,A,ca)}catch{}A=await q.projectMany(h.items.map(ca=>b.getGeometry(this.geometryType,this.hasZ,this.hasM,P.getGeometry(ca))),this.spatialReference,A,X);h.items=A.map((ca,ia)=>P.cloneWithGeometry(h.items[ia],
K.convertFromGeometry(ca,this.hasZ,this.hasM)));return h}async _searchFeatures(h){const A=new Set;await Promise.all(h.map(P=>this.featureStore.forEachInBounds(P,X=>A.add(X))));h=Array.from(A.values());A.clear();return h}async _executeQueryForStatistics(h,A,P){h=t.clone(h);try{h=await this._schedule(()=>M.normalizeQuery(h,this.definitionExpression,this.spatialReference),P);h=await this._reschedule(()=>Q.validateStatisticsQuery(h,A,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,
geometryType:this.geometryType,spatialReference:this.spatialReference}),P);const X=await this._reschedule(()=>this._executeSceneFilterQuery(h,P),P),ca=await this._reschedule(()=>this._executeGeometryQuery(h,X,P),P);await this._reschedule(()=>this._executeAggregateIdsQuery(ca),P);await this._reschedule(()=>this._executeObjectIdsQuery(ca),P);await this._reschedule(()=>this._executeTimeQuery(ca),P);await this._reschedule(()=>this._executeAttributesQuery(ca),P);return ca}catch(X){if(X!==M.queryEngineEmptyResult)throw X;
return new z.QueryEngineResult([],h,this)}}}e.Feature=g;e.QueryEngine=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(e,l,x,D,t,N,a,p,k,y,w){function I(q){const L=[];let d=0,z=0;for(let M=0;M<
q.length;M++){const Q=q[M];let Z=null;for(let U=0;U<Q.length;U++)Z=Q[U],L.push(Z),0===U?z=d=Z[0]:(d=Math.min(d,Z[0]),z=Math.max(z,Z[0]));Z&&L.push([(d+z)/2,0])}return L}function G(q,L){if(!(q instanceof N||q instanceof t))throw b().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new x("straightLineDensify: the input geometry is neither polyline nor polygon");var d=a.getGeometryParts(q);const z=[];for(const Q of d){d=[];z.push(d);d.push([Q[0][0],Q[0][1]]);for(let Z=
0;Z<Q.length-1;Z++){const U=Q[Z][0],T=Q[Z][1],u=Q[Z+1][0],R=Q[Z+1][1];var M=Math.sqrt((u-U)*(u-U)+(R-T)*(R-T));const g=(R-T)/M,f=(u-U)/M,h=M/L;if(1<h){for(let A=1;A<=h-1;A++){const P=A*L;d.push([f*P+U,g*P+T])}M=(M+Math.floor(h-1)*L)/2;d.push([f*M+U,g*M+T])}d.push([u,R])}}return"polygon"===q.type?new t({rings:z,spatialReference:q.spatialReference}):new N({paths:z,spatialReference:q.spatialReference})}function r(q,L,d){L&&(q=G(q,1E6),q=k.webMercatorToGeographic(q,!0));d&&(q=a.updatePolyGeometry(q,d));
return q}function J(q,L,d){if(Array.isArray(q)){var z=q[0];z>L?(d=a.offsetMagnitude(z,L),q[0]=z+-2*d*L):z<d&&(L=a.offsetMagnitude(z,d),q[0]=z+-2*L*d)}else z=q.x,z>L?(d=a.offsetMagnitude(z,L),q=q.clone().offset(-2*d*L,0)):z<d&&(L=a.offsetMagnitude(z,d),q=q.clone().offset(-2*L*d,0));return q}function K(q,L){let d=-1;for(let z=0;z<L.cutIndexes.length;z++){const M=L.cutIndexes[z],Q=L.geometries[z],Z=a.getGeometryParts(Q);for(let U=0;U<Z.length;U++){const T=Z[U];T.some(u=>{if(180>u[0])return!0;u=0;for(var R=
0;R<T.length;R++){var g=T[R][0];u=g>u?g:u}u=Number(u.toFixed(9));u=-360*a.offsetMagnitude(u,180);for(R=0;R<T.length;R++)g=Q.getPoint(U,R),Q.setPoint(U,R,g.clone().offset(u,0));return!0})}if(M===d)if("polygon"===q[0].type)for(const U of a.getGeometryParts(Q))q[M]=q[M].addRing(U);else{if("polyline"===q[0].type)for(const U of a.getGeometryParts(Q))q[M]=q[M].addPath(U)}else d=M,q[M]=Q}return q}async function v(q,L,d){if(!Array.isArray(q))return v([q],L);L&&"string"!==typeof L&&b().warn("normalizeCentralMeridian()",
"The url object is deprecated, use the url string instead");var z="string"===typeof L?L:L?.url??l.geometryServiceUrl;let M,Q,Z;let U=0;var T=[];L=[];for(var u of q)if(null==u)L.push(u);else{if(!R){var R=u.spatialReference;var g=p.getInfo(R);var f=(M=R.isWebMercator)?102100:4326;Q=a.cutParams[f].maxX;Z=a.cutParams[f].minX;var h=a.cutParams[f].plus180Line;f=a.cutParams[f].minus180Line}if(g)if("mesh"===u.type)L.push(u);else if("point"===u.type)L.push(J(u.clone(),Q,Z));else if("multipoint"===u.type){var A=
u.clone();A.points=A.points.map(P=>J(P,Q,Z));L.push(A)}else if("extent"===u.type)A=u.clone()._normalize(!1,!1,g),L.push(A.rings?new t(A):A);else if(u.extent){A=u.extent;const P=2*a.offsetMagnitude(A.xmin,Z)*Q;let X=0===P?u.clone():a.updatePolyGeometry(u.clone(),P);A.offset(P,0);let {xmin:ca,xmax:ia}=A;ca=Number(ca.toFixed(9));ia=Number(ia.toFixed(9));A.intersects(h)&&ia!==Q?(U=ia>U?ia:U,X=r(X,M),T.push(X),L.push("cut")):A.intersects(f)&&ca!==Z?(U=2*ia*Q>U?2*ia*Q:U,X=r(X,M,360),T.push(X),L.push("cut")):
L.push(X)}else L.push(u.clone());else L.push(u)}R=a.offsetMagnitude(U,Q);g=-90;h=R;for(u=new N;0<R;)f=-180+360*R,u.addPath([[f,g],[f,-1*g]]),g*=-1,R--;if(0<T.length&&0<h){R=await y.cut(z,T,u,d);R=K(T,R);g=[];T=[];for(h=0;h<L.length;h++)u=L[h],"cut"!==u?T.push(u):(u=R.shift(),f=q[h],null!=f&&"polygon"===f.type&&f.rings&&1<f.rings.length&&u.rings.length>=f.rings.length?(g.push(u),T.push("simplify")):T.push(M?k.geographicToWebMercator(u):u));if(!g.length)return T;L=await w.simplify(z,g,d);q=[];for(d=
0;d<T.length;d++)z=T[d],"simplify"!==z?q.push(z):q.push(M?k.geographicToWebMercator(L.shift()):L.shift());return q}q=[];for(d=0;d<L.length;d++)z=L[d],"cut"!==z?q.push(z):(z=T.shift(),q.push(!0===M?k.geographicToWebMercator(z):z));return q}const b=()=>D.getLogger("esri.geometry.support.normalizeUtils");e.getClosestDenormalizedXToReference=function(q,L,d){d=p.getInfo(d);if(null==d)return q;const [z,M]=d.valid;d=2*M;let Q=0,Z=0;L>M?Q=Math.ceil(Math.abs(L-M)/d):L<z&&(Q=-Math.ceil(Math.abs(L-z)/d));q>
M?Z=Math.ceil(Math.abs(q-M)/d):q<z&&(Z=-Math.ceil(Math.abs(q-z)/d));q+=(Q-Z)*d;L=q-L;L>M?q-=d:L<z&&(q+=d);return q};e.getDenormalizedExtent=function(q){if(!q)return null;const L=q.extent;if(!L)return null;var d=q.spatialReference&&p.getInfo(q.spatialReference);if(!d)return L;const [z,M]=d.valid;({width:d}=L);let {xmin:Q,xmax:Z}=L;[Q,Z]=[Z,Q];if("extent"===q.type||0===d||d<=M||d>2*M||Q<z||Z>M)return L;let U;switch(q.type){case "polygon":if(1<q.rings.length)U=I(q.rings);else return L;break;case "polyline":if(1<
q.paths.length)U=I(q.paths);else return L;break;case "multipoint":U=q.points}q=L.clone();for(let T=0;T<U.length;T++){let u=U[T][0];0>u?(u+=M,Z=Math.max(u,Z)):(u-=M,Q=Math.min(u,Q))}q.xmin=Q;q.xmax=Z;return q.width<d?(q.xmin-=M,q.xmax-=M,q):L};e.normalizeCentralMeridian=v;e.normalizeMapX=function(q,L){if(L=p.getInfo(L)){const [d,z]=L.valid;L=z-d;if(q<d)for(;q<d;)q+=L;if(q>z)for(;q>z;)q-=L}return q};e.straightLineDensify=G;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports",
"../Polyline","../SpatialReference","./jsonUtils"],function(e,l,x,D){function t(N){return D.isPolygon(N)?N.rings:N.paths}l={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new l({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:x.WebMercator}),minus180Line:new l({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:x.WebMercator})},4326:{maxX:180,
minX:-180,plus180Line:new l({paths:[[[180,-180],[180,180]]],spatialReference:x.WGS84}),minus180Line:new l({paths:[[[-180,-180],[-180,180]]],spatialReference:x.WGS84})}};e.cutParams=l;e.getGeometryParts=t;e.offsetMagnitude=function(N,a){return Math.ceil((N-a)/(2*a))};e.updatePolyGeometry=function(N,a){const p=t(N);for(const k of p)for(const y of k)y[0]+=a;return N};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(e,l,x,D,t,N){e.cut=async function(a,p,k,y){a=N.parseUrl(a);const w=p[0].spatialReference;p={...y,responseType:"json",query:{...a.query,f:"json",sr:t.srToRESTValue(w),target:JSON.stringify({geometryType:D.getJsonType(p[0]),geometries:p}),cutter:JSON.stringify(k)}};p=await x(a.path+"/cut",p);const {cutIndexes:I,geometries:G=[]}=p.data;return{cutIndexes:I,geometries:G.map(r=>{r=D.fromJSON(r);r.spatialReference=w;return r})}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(e,l,x,D,t,N){function a(p,k,y){const w={};for(const G in p)if("declaredClass"!==G){var I=p[G];null!=I&&"function"!==typeof I&&(Array.isArray(I)?w[G]=I.map(r=>a(r)):"object"===typeof I?I.toJSON?(I=I.toJSON(y?.[G]),w[G]=k?I:JSON.stringify(I)):w[G]=k?I:JSON.stringify(I):w[G]=I)}return w}e.asValidOptions=function(p,k){return k?{...k,query:{...(p??{}),...k.query}}:{query:p}};e.encode=a;e.getToken=function(p,k){return p?N.isApiKeyApplicable(p,k)?k||l.apiKey:x.id?.findCredential(p)?.token:null};
e.parseUrl=function(p){return"string"===typeof p?t.urlToObject(p):D.clone(p)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(e,l,x,D,t,N){e.simplify=async function(a,p,k){const y="string"===typeof a?x.urlToObject(a):a;a=p[0].spatialReference;const w=D.getJsonType(p[0]);p={...k,query:{...y.query,
f:"json",sr:t.srToRESTValue(a),geometries:JSON.stringify(N.encodeGeometries(p))}};({data:p}=await l(y.path+"/simplify",p));return N.decodeGeometries(p.geometries,w,a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(e,l){e.decodeGeometries=function(x,D,t){const N=l.getGeometryType(D);return x.map(a=>{a=N.fromJSON(a);a.spatialReference=t;return a})};e.encodeGeometries=function(x){return{geometryType:l.getJsonType(x[0]),
geometries:x.map(D=>D.toJSON())}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(e,l,x,D){function t(r,J,K={}){const v=N(J,r);if(!v)throw K=w.getError(J,r),new l("unsupported-query","invalid SQL expression",{expression:J,error:K});r=K.expressionName||"expression";if(K.validateStandardized&&!v.isStandardized)throw new l("unsupported-query",
`${r} is not standard`,{expression:J});if(K.validateAggregate&&!v.isAggregate)throw new l("unsupported-query",`${r} does not contain a valid aggregate function`,{expression:J});return v.fieldNames}function N(r,J){return r?w.get(r,J):null}function a(r){return/\((.*?)\)/.test(r)?r:r.split(" as ")[0]}function p(r,J,K,v={}){const b=new Map;k(b,r,J,v.allowedFieldTypes??G,K);if(b.size)throw new l("unsupported-query",`${v.expressionName??"expression"} contains invalid or missing fields`,{errors:Array.from(b.values()),
query:v.query});}function k(r,J,K,v,b){b=b.includes("*")?[...K,...b.filter(q=>"*"!==q)]:b;for(const q of b)if(J.get(q))y(r,J,K,v,q);else try{const L=a(q),d=t(J,L,{validateStandardized:!0});for(const z of d)y(r,J,K,v,z)}catch(L){r.set(q,{type:"expression-error",expression:q,error:L})}}function y(r,J,K,v,b){(J=J.get(b))?K.has(J.name)?"all"!==v&&!1===v?.has(J.type)&&r.set(b,{type:"invalid-type",fieldName:J.name,fieldType:D.kebabDict.fromJSON(J.type),allowedFieldTypes:Array.from(v,q=>D.kebabDict.fromJSON(q))}):
r.set(b,{type:"missing-field",fieldName:J.name}):r.set(b,{type:"invalid-field",fieldName:b})}const w=new x.WhereClauseCache(50,500);x=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const I=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),G=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...x,
...I]);e.allDateAndTimeFieldTypes=I;e.getAliasFromFieldName=function(r){return r.split(" as ")[1]};e.getExpressionFromFieldName=a;e.getWhereClause=N;e.numericFieldTypes=x;e.validateFields=p;e.validateHaving=function(r,J,K,v,b){if(!K)return!0;const q=t(r,K,{validateAggregate:!0,expressionName:"having clause"});p(r,J,q,{expressionName:"having clause",query:b});if(!N(K,r)?.getExpressions().every(L=>{const {aggregateType:d,field:z}=L,M=r.get(z)?.name;return v.some(Q=>{const {onStatisticField:Z,statisticType:U}=
Q;return r.get(Z)?.name===M&&U.toLowerCase().trim()===d})}))throw new l("unsupported-query","expressions in having clause should also exist in outStatistics",{having:K});return!0};e.validateWhere=function(r,J,K,v){if(!K)return!0;K=t(r,K,{validateStandardized:!0,expressionName:"where clause"});p(r,J,K,{expressionName:"where clause",query:v});return!0};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],
function(e,l,x){class D{constructor(t,N){this._cache=new l.LRUCache(t);this._invalidCache=new l.LRUCache(N)}get(t,N){const a=`${N.uid}:${t}`,p=this._cache.get(a);if(p)return p;if(null!=this._invalidCache.get(a))return null;try{const k=x.WhereClause.create(t,{fieldsIndex:N});this._cache.put(a,k);return k}catch(k){return this._invalidCache.put(a,k),null}}getError(t,N){return this._invalidCache.get(`${N.uid}:${t}`)??null}}e.WhereClauseCache=D;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(e,l){class x{constructor(D,t){this._storage=new l.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=D;this._storage.register(this);t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(D,t,N=1){this._storage.put(this,D,t,N,1)}pop(D){return this._storage.pop(this,D)}get(D){return this._storage.get(this,D)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(D){this._storage.maxSize=
D}resetHitRate(){}}e.LRUCache=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(e,l){e.RemoveMode=void 0;(function(a){a[a.ALL=0]="ALL";a[a.SOME=1]="SOME"})(e.RemoveMode||(e.RemoveMode={}));class x{constructor(a,p,k){this.name=a;this._storage=p;this.id=`${t++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);k&&(this._storage.registerRemoveFunc(this.id,k),
this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(a){return this._storage.getSize(this,a)}resetHitRate(){this._hit=this._miss=0}put(a,p,k,y=0){this._storage.put(this,a,p,k,y)}pop(a){a=this._storage.pop(this,a);void 0===a?++this._miss:++this._hit;return a}get(a){a=this._storage.get(this,
a);void 0===a?++this._miss:++this._hit;return a}peek(a){return this._storage.peek(this,a)}updateSize(a,p,k){this._storage.updateSize(this,a,p,k)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class D{get size(){return this._size}constructor(a=10485760){this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new l;this._users=new l}destroy(){this.clearAll();
this._removeFuncs.clear();this._users.clear();this._db=null}register(a){this._users.push(a)}deregister(a){this._users.removeUnordered(a)}registerRemoveFunc(a,p){this._removeFuncs.push([a,p])}deregisterRemoveFunc(a){this._removeFuncs.filterInPlace(p=>p[0]!==a)}get maxSize(){return this._maxSize}set maxSize(a){this._maxSize=Math.max(a,-1);this._checkSize()}getSize(a,p){return this._db.get(a.id+p)?.size??0}put(a,p,k,y,w){p=a.id+p;const I=this._db.get(p);I&&(this._size-=I.size,a.size-=I.size,this._db.delete(p),
I.entry!==k&&this._notifyRemove(p,I.entry,I.size,e.RemoveMode.ALL));y>this._maxSize?this._notifyRemove(p,k,y,e.RemoveMode.ALL):void 0===k?console.warn("Refusing to cache undefined entry "):!y||0>y?(console.warn(`Refusing to cache entry with size ${y} for key ${p}`),this._notifyRemove(p,k,0,e.RemoveMode.ALL)):(this._db.set(p,new N(k,y,1+Math.max(w,-4)- -3)),this._size+=y,a.size+=y,this._checkSize())}updateSize(a,p,k,y){p=a.id+p;const w=this._db.get(p);if(w&&w.entry===k){this._size-=w.size;for(a.size-=
w.size;y>this._maxSize;)if(y=this._notifyRemove(p,k,y,e.RemoveMode.SOME),!(null!=y&&0<y)){this._db.delete(p);return}w.size=y;this._size+=y;a.size+=y;this._checkSize()}}pop(a,p){p=a.id+p;const k=this._db.get(p);if(k)return this._size-=k.size,a.size-=k.size,this._db.delete(p),++this._hit,k.entry;++this._miss}get(a,p){p=a.id+p;a=this._db.get(p);if(void 0===a)++this._miss;else return this._db.delete(p),a.lives=a.lifetime,this._db.set(p,a),++this._hit,a.entry}peek(a,p){(a=this._db.get(a.id+p))?++this._hit:
++this._miss;return a?.entry}get performanceInfo(){const a={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},p={},k=[];this._db.forEach((I,G)=>{const r=I.lifetime;k[r]=(k[r]||0)+I.size;this._users.forAll(J=>{const {id:K,name:v}=J;G.startsWith(K)&&(p[v]=(p[v]||0)+I.size)})});const y={};this._users.forAll(I=>{const G=I.name;"hitRate"in I&&"number"===typeof I.hitRate&&!isNaN(I.hitRate)&&
0<I.hitRate?(p[G]=p[G]||0,y[G]=Math.round(100*I.hitRate)+"%"):y[G]="0%"});var w=Object.keys(p);w.sort((I,G)=>p[G]-p[I]);w.forEach(I=>a[I]=Math.round(p[I]/2**20)+"MB / "+y[I]);for(w=k.length-1;0<=w;--w){const I=k[w];I&&(a["Priority "+(w+-3-1)]=Math.round(I/this._size*100)+"%")}return a}resetStats(){this._hit=this._miss=0;this._users.forAll(a=>a.resetHitRate())}clear(a){const p=a.id;this._db.forEach((k,y)=>{y.startsWith(p)&&(this._size-=k.size,this._db.delete(y),this._notifyRemove(y,k.entry,k.size,
e.RemoveMode.ALL))});a.size=0}clearAll(){this._db.forEach((a,p)=>this._notifyRemove(p,a.entry,a.size,e.RemoveMode.ALL));this._users.forAll(a=>a.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(a,p,k,y){let w;this._removeFuncs.some(I=>a.startsWith(I[0])?(I=I[1](p,y,k),"number"===typeof I&&(w=I),!0):!1);return w}_checkSize(){this._users.forAll(a=>this._checkSizeLimits(a));this._checkSizeLimits()}_checkSizeLimits(a){const p=a??this;if(!(0>p.maxSize||
p.size<=p.maxSize)){for(var k=a?.id,y=!0;y;){y=!1;for(const [w,I]of this._db)if(0===I.lifetime&&(!k||w.startsWith(k))){this._purgeItem(w,I,a);if(p.size<=.9*p.maxSize)return;y||=this._db.has(w)}}for(const [w,I]of this._db)if(!k||w.startsWith(k))if(this._purgeItem(w,I,a),p.size<=.9*p.maxSize)break}}_purgeItem(a,p,k=this._users.find(y=>a.startsWith(y.id))){this._db.delete(a);if(1>=p.lives){this._size-=p.size;k&&(k.size-=p.size);const y=this._notifyRemove(a,p.entry,p.size,e.RemoveMode.SOME);null!=y&&
0<y&&(this._size+=y,k&&(k.size+=y),p.lives=p.lifetime,p.size=y,this._db.set(a,p))}else--p.lives,this._db.set(a,p)}}let t=0;class N{constructor(a,p,k){this.entry=a;this.size=p;this.lives=this.lifetime=k}}e.MemCache=x;e.MemCacheStorage=D;e.MinPriority=-3;e.NoPriority=-4;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../has ./AggregateFunctions ./DateOnly ./errorSupport ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J){function K(u){return Array.isArray(u)?u:[u]}function v(u){return null!==u?!0!==u:null}function b(u,R){return null!=u&&null!=R?!0===u&&!0===R:!1===u||!1===R?!1:null}function q(u,R){return null!=u&&null!=R?!0===u||!0===R:!0===u||!0===R?!0:null}function L(u,R,g){if(null==u)return null;g=!1;for(const f of R)if(null==f)g=null;else if(u===f){g=!0;break}else if(p.isDateOrTimeValue(u)&&p.isDateOrTimeValue(f)&&(g=p.sqlCompare(u,f,"\x3d")))break;return g}function d(u,
R,g){if(null==u)return null;let f="",h=U.Normal;for(let A=0;A<R.length;A++){const P=R.charAt(A);switch(h){case U.Normal:P===g?h=U.Escaped:f="-[]/{}()*+?.\\^$|".includes(P)?f+("\\"+P):"%"===P?f+".*":"_"===P?f+".":f+P;break;case U.Escaped:f="-[]/{}()*+?.\\^$|".includes(P)?f+("\\"+P):f+P,h=U.Normal}}return(new RegExp("^"+f+"$","m")).test(u)}function z(u,R,g,f){u=f.getAttribute(u,R);R=g?.get(R);return null==u||"esriFieldTypeDate"!==R?.type&&"date"!==R?.type?null==u||"esriFieldTypeDateOnly"!==R?.type&&
"date-only"!==R?.type?null==u||"esriFieldTypeTimeOnly"!==R?.type&&"time-only"!==R?.type?null==u||"esriFieldTypeTimestampOffset"!==R?.type&&"timestamp-offset"!==R?.type?u:new w.SqlTimeStampOffset(u):G.TimeOnly.fromReader(u):t.DateOnly.fromReader(u):k.convertToExecutingTimeZone(new Date(u),g?.getLuxonTimeZone(R.name)??J.FixedOffsetZone.utcInstance)}const M=new Set(["current_timestamp","current_date","current_time"]);class Q{static makeBool(u){return!0===u}static featureValue(u,R,g,f){return z(u,R,g,
f)}static equalsNull(u){return null===u}static applyLike(u,R,g){return d(u,R,g)}static ensureArray(u){return K(u)}static applyIn(u,R,g){return L(u,R)}static currentTimestamp(u){return k.convertToExecutingTimeZone(new Date,u)}static currentDate(u){return t.DateOnly.fromNow(u)}static currentTime(u){u=k.convertToExecutingTimeZone(new Date,u);return G.TimeOnly.fromDateTime(u)}static makeSqlInterval(u,R,g){return y.SqlInterval.createFromValueAndQualifier(u,R,g)}static convertInterval(u){return u instanceof
y.SqlInterval?u.valueInMilliseconds():u}static compare(u,R,g,f){return p.sqlCompare(R,g,u)}static calculate(u,R,g,f){return a.sqlCalculateFunction(u,R,g,f)}static evaluateTime(u){return k.parseTime(u)}static evaluateTimestamp(u,R,g){return k.parseTimestamp(u,R,g)}static evaluateDate(u,R){return k.parseDate(u,R)}static evaluateFunction(u,R,g){return I.evaluateFunction(u,R,g)}static lookup(u,R){u=R[u];return void 0===u?null:u}static between(u,R,g){return null==u||null==R[0]||null==R[1]?null:p.sqlCompare(u,
R[0],"\x3e\x3d")&&p.sqlCompare(u,R[1],"\x3c\x3d")}static notbetween(u,R,g){return null==u||null==R[0]||null==R[1]?null:p.sqlCompare(u,R[0],"\x3c")||p.sqlCompare(u,R[1],"\x3e")}static ternaryNot(u){return v(u)}static ternaryAnd(u,R){return b(u,R)}static ternaryOr(u,R){return q(u,R)}}class Z{constructor(u,R,g="UTC",f=null){this.fieldsIndex=R;this.timeZone=g;this.currentUser=f;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=r.WhereGrammar.parse(u);const {isStandardized:h,isAggregate:A,
currentUserRequired:P,referencedFieldNames:X}=this._extractExpressionInfo(R);this._referencedFieldNames=X;this.isStandardized=h;this.isAggregate=A;this.currentUserRequired=P}static convertValueToStorageFormat(u,R=null){if(null===R)return k.isDate(u)?u.getTime():k.isDateTime(u)?u.toMillis():k.isTimestampOffset(u)?u.toStorageFormat():k.isTimeOnly(u)?u.toStorageString():k.isDateOnly(u)?u.toStorageFormat():u;switch(R){case "date":if(k.isDate(u))return u.getTime();if(k.isDateTime(u))return u.toMillis();
if(k.isTimestampOffset(u))return u.toMilliseconds();if(k.isDateOnly(u))return u.toNumber();break;case "date-only":if(k.isDate(u))return t.DateOnly.fromDateJS(u).toString();if(k.isTimestampOffset(u))return t.DateOnly.fromSqlTimeStampOffset(u).toString();if(k.isDateTime(u))return t.DateOnly.fromDateTime(u).toString();break;case "time-only":if(k.isDate(u))return G.TimeOnly.fromDateJS(u).toStorageString();if(k.isDateTime(u))return G.TimeOnly.fromDateTime(u).toStorageString();if(k.isTimestampOffset(u))return G.TimeOnly.fromSqlTimeStampOffset(u).toStorageString();
if(k.isTimeOnly(u))return u.toStorageString();break;case "timestamp-offset":if(k.isDate(u))return w.SqlTimeStampOffset.fromJSDate(u).toStorageFormat();if(k.isDateTime(u))return w.SqlTimeStampOffset.fromDateTime(u).toStorageFormat();if(k.isTimestampOffset(u))return u.toStorageFormat()}return u}static create(u,R={}){return new Z(u,R.fieldsIndex,R.timeZone??void 0,R.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(u,R=T,g=this.currentUser){return!!this._evaluateNode(this.parseTree,
null,R,u,g)}calculateValue(u,R=T,g=this.currentUser){u=this._evaluateNode(this.parseTree,u,R,null,g);return u instanceof y.SqlInterval?u.valueInMilliseconds()/864E5:u}calculateValueCompiled(u,R=T,g=this.currentUser){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(u,this.parameters,R,this.fieldsIndex,this.timeZone,g??null);if(x("esri-csp-restrictions"))return this.calculateValue(u,R);this._compileMe();return this.parseTree._compiledVersion(u,this.parameters,R,this.fieldsIndex,
this.timeZone,g??null)}testFeature(u,R=T,g=this.currentUser){return!!this._evaluateNode(this.parseTree,u,R,null,g)}testFeatureCompiled(u,R=T,g=this.currentUser){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(u,this.parameters,R,this.fieldsIndex,this.timeZone,g??null);if(x("esri-csp-restrictions"))return this.testFeature(u,R);this._compileMe();return!!this.parseTree._compiledVersion(u,this.parameters,R,this.fieldsIndex,this.timeZone,g??null)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;r.visitAll(this.parseTree,u=>{"current-time"===u.type?this._hasDateFunctions=!0:"function"===u.type&&(this._hasDateFunctions=this._hasDateFunctions||M.has(u.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const u=new Set;r.visitAll(this.parseTree,R=>{"function"===R.type&&u.add(R.name.toLowerCase())});return Array.from(u)}getExpressions(){const u=new Map;r.visitAll(this.parseTree,R=>{if("function"===
R.type){const g=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===R.type){R=R.column;const f=`${g}-${R}`;u.has(f)||u.set(f,{aggregateType:g,field:R})}}});return[...u.values()]}getVariables(){const u=new Set;r.visitAll(this.parseTree,R=>{"parameter"===R.type&&u.add(R.value.toLowerCase())});return Array.from(u)}_compileMe(){const u="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone","currentUser",u)).bind(Q)}_extractExpressionInfo(u){const R=[],g=new Set;let f=!0,h=!1,A=!1;r.visitAll(this.parseTree,P=>{switch(P.type){case "column-reference":var X=u?.get(P.column);let ca;X?X=ca=X.name??"":(ca=P.column,X=ca.toLowerCase());g.has(X)||(g.add(X),R.push(ca));P.column=ca;break;case "current-user":A=!0;break;case "function":const {name:ia,args:na}=P;P=na.value.length;f&&=I.isStandardized(ia,P);!1===h&&(h=D.isAggregate(ia,P))}});return{referencedFieldNames:Array.from(R),
isStandardized:f,isAggregate:h,currentUserRequired:A}}evaluateNodeToJavaScript(u){switch(u.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(u.value)+", "+JSON.stringify(u.qualifier)+","+JSON.stringify(u.op)+")";case "case-expression":var R="";if("simple"===u.format){var g=this.evaluateNodeToJavaScript(u.operand);R="( ";for(let f=0;f<u.clauses.length;f++)R+=" (this.compare('\x3d',"+g+","+this.evaluateNodeToJavaScript(u.clauses[f].operand)+") ? ("+this.evaluateNodeToJavaScript(u.clauses[f].value)+
") : "}else for(R="( ",g=0;g<u.clauses.length;g++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(u.clauses[g].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(u.clauses[g].value)+") : ";R=null!==u.else?R+this.evaluateNodeToJavaScript(u.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(u.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(g of u.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(g);return R+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(u.expr)+")";case "binary-expression":switch(u.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+" )";case "IS":if("null"!==u.right.type)throw new N.SqlError(N.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")";case "ISNOT":if("null"!==
u.right.type)throw new N.SqlError(N.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(u.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(u.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(u.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(u.left)+
","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+","+JSON.stringify(u.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(u.operator)+","+this.evaluateNodeToJavaScript(u.left)+","+this.evaluateNodeToJavaScript(u.right)+", timeZone)";default:throw new N.SqlError(N.SqlErrorCodes.UnsupportedOperator,{operator:u.operator});
}case "null":case "boolean":case "string":case "number":return JSON.stringify(u.value);case "time":return"this.evaluateTime("+JSON.stringify(u.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(u.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(u.value)+", 'unknown')";case "current-time":return"date"===u.mode?"this.currentDate(timeZone)":"time"===u.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case "current-user":return"currentUser";
case "column-reference":return"this.featureValue(feature,"+JSON.stringify(u.column)+",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(u.name)+","+this.evaluateNodeToJavaScript(u.args)+", timeZone)"}throw new N.SqlError(N.SqlErrorCodes.UnsupportedSyntax,{node:u.type});}_evaluateNode(u,R,g,f,h){switch(u.type){case "interval":return g=this._evaluateNode(u.value,R,g,f,h),y.SqlInterval.createFromValueAndQualifier(g,u.qualifier,u.op);case "case-expression":if("simple"===
u.format){var A=this._evaluateNode(u.operand,R,g,f,h);for(var P=0;P<u.clauses.length;P++)if(p.sqlCompare(A,this._evaluateNode(u.clauses[P].operand,R,g,f,h),"\x3d",this.timeZone))return this._evaluateNode(u.clauses[P].value,R,g,f,h)}else for(A=0;A<u.clauses.length;A++)if(!0===this._evaluateNode(u.clauses[A].operand,R,g,f,h))return this._evaluateNode(u.clauses[A].value,R,g,f,h);return null!==u.else?this._evaluateNode(u.else,R,g,f,h):null;case "parameter":return u=this.parameters[u.value.toLowerCase()],
k.isDate(u)?J.DateTime.fromJSDate(u):u instanceof l.ArcadeDate?u.toDateTime():u;case "expression-list":A=[];for(var X of u.value)A.push(this._evaluateNode(X,R,g,f,h));return A;case "unary-expression":return v(this._evaluateNode(u.expr,R,g,f,h));case "binary-expression":switch(u.operator){case "AND":return b(this._evaluateNode(u.left,R,g,f,h),this._evaluateNode(u.right,R,g,f,h));case "OR":return q(this._evaluateNode(u.left,R,g,f,h),this._evaluateNode(u.right,R,g,f,h));case "IS":if("null"!==u.right.type)throw new N.SqlError(N.SqlErrorCodes.UnsupportedIsRhs);
return null===this._evaluateNode(u.left,R,g,f,h);case "ISNOT":if("null"!==u.right.type)throw new N.SqlError(N.SqlErrorCodes.UnsupportedIsRhs);return null!==this._evaluateNode(u.left,R,g,f,h);case "IN":return A=K(this._evaluateNode(u.right,R,g,f,h)),L(this._evaluateNode(u.left,R,g,f,h),A,this.timeZone);case "NOT IN":return A=K(this._evaluateNode(u.right,R,g,f,h)),v(L(this._evaluateNode(u.left,R,g,f,h),A,this.timeZone));case "BETWEEN":return A=this._evaluateNode(u.left,R,g,f,h),u=this._evaluateNode(u.right,
R,g,f,h),null==A||null==u[0]||null==u[1]?null:p.sqlCompare(A,u[0],"\x3e\x3d",this.timeZone)&&p.sqlCompare(A,u[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return A=this._evaluateNode(u.left,R,g,f,h),u=this._evaluateNode(u.right,R,g,f,h),null==A||null==u[0]||null==u[1]?null:p.sqlCompare(A,u[0],"\x3c",this.timeZone)||p.sqlCompare(A,u[1],"\x3e",this.timeZone);case "LIKE":return d(this._evaluateNode(u.left,R,g,f,h),this._evaluateNode(u.right,R,g,f,h),u.escape);case "NOT LIKE":return v(d(this._evaluateNode(u.left,
R,g,f,h),this._evaluateNode(u.right,R,g,f,h),u.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return p.sqlCompare(this._evaluateNode(u.left,R,g,f,h),this._evaluateNode(u.right,R,g,f,h),u.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return a.sqlCalculateFunction(u.operator,this._evaluateNode(u.left,R,g,f,h),this._evaluateNode(u.right,R,g,f,h),this.timeZone)}case "null":case "boolean":case "string":case "number":return u.value;case "date":return u.parsedValue??
(u.parsedValue=k.parseDate(u.value,"unknown")),u.parsedValue;case "timestamp":return u.parsedValue??(u.parsedValue=k.parseTimestamp(u.value,"unknown")),u.parsedValue;case "time":return k.parseTime(u.value);case "current-time":return"date"===u.mode?Q.currentDate(this.timeZone):"time"===u.mode?Q.currentTime(this.timeZone):Q.currentTimestamp(this.timeZone);case "current-user":return h??null;case "column-reference":return z(R,u.column,this.fieldsIndex,g);case "data-type":return u.value;case "function":if(this.isAggregate&&
D.isAggregate(u.name,u.args.value.length)){R=[];for(A of u.args?.value||[]){X=[];for(P of f||[])X.push(this._evaluateNode(A,P,g,null,h));R.push(X)}return D.aggregateFunction(u.name,R)}g=this._evaluateNode(u.args,R,g,f,h);return I.evaluateFunction(u.name,g,this.timeZone)}throw new N.SqlError(N.SqlErrorCodes.UnsupportedSyntax,{node:u.type});}}var U;(function(u){u[u.Normal=0]="Normal";u[u.Escaped=1]="Escaped"})(U||={});const T={getAttribute(u,R){return(u&&"object"===typeof u.attributes?u.attributes:
u)[R]}};e.WhereClause=Z;e.defaultAttributeAdapter=T;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(e,l,x,D){function t(y,w,I){return y<w?y-w:y>I?y-I:0}function N(y,w=!0){if(y instanceof D.Zone)return y;if("system"===y.toLowerCase())return"system";if("utc"===y.toLowerCase())return"UTC";if("unknown"===y.toLowerCase())return x.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(y)){const I=
D.FixedOffsetZone.parseSpecifier("UTC"+(y.startsWith("+")||y.startsWith("-")?"":"+")+y);if(I)return I}y=D.IANAZone.create(y);if(!y.isValid){if(w)throw new p(e.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return y}e.ArcadeDateErrorCodes=void 0;(e.ArcadeDateErrorCodes||(e.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const a={[e.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class p extends Error{constructor(y,w){super(l.replace(a[y],
w));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,p)}}class k{constructor(y){this._date=y;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(y=0,w=1,I=1,G=0,r=0,J=0,K=0,v){if(isNaN(y)||isNaN(w)||isNaN(I)||isNaN(G)||isNaN(r)||isNaN(J)||isNaN(K))return null;const b=D.DateTime.local(y,w).daysInMonth;y=D.DateTime.fromObject({day:1>I?1:I>b?b:I,year:y,month:1>w?1:12<w?12:w,hour:0>G?0:23<G?23:G,minute:0>r?0:59<r?59:r,second:0>
J?0:59<J?59:J,millisecond:0>K?0:999<K?999:K},{zone:N(v)});y=y.plus({months:t(w,1,12),days:t(I,1,b),hours:t(G,0,23),minutes:t(r,0,59),seconds:t(J,0,59),milliseconds:t(K,0,999)});return new k(y)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(y,w){w=N(w);return y.isUnknownTimeZone||w===x.UnknownTimeZone.instance?k.fromParts(y.year,y.monthJS+1,y.day,y.hour,y.minute,y.second,y.millisecond,w):new k(y._date.setZone(w))}static dateJSToArcadeDate(y){return new k(D.DateTime.fromJSDate(y,
{zone:"system"}))}static dateJSAndZoneToArcadeDate(y,w="system"){w=N(w);return new k(D.DateTime.fromJSDate(y,{zone:w}))}static unknownEpochToArcadeDate(y){return new k(D.DateTime.fromMillis(y,{zone:x.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(y){return new k(D.DateTime.fromMillis(y.getTime(),{zone:x.UnknownTimeZone.instance}))}static epochToArcadeDate(y,w="system"){w=N(w);return new k(D.DateTime.fromMillis(y,{zone:w}))}static dateTimeToArcadeDate(y){return new k(y)}clone(){return new k(this._date)}changeTimeZone(y){y=
N(y);return k.dateTimeToArcadeDate(this._date.setZone(y))}static dateTimeAndZoneToArcadeDate(y,w){w=N(w);return y.zone===x.UnknownTimeZone.instance||w===x.UnknownTimeZone.instance?k.fromParts(y.year,y.month,y.day,y.hour,y.minute,y.second,y.millisecond,w):new k(y.setZone(w))}static nowToArcadeDate(y){y=N(y);return new k(D.DateTime.fromJSDate(new Date,{zone:y}))}static nowUTCToArcadeDate(){return new k(D.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===k.systemTimeZoneCanonicalName}equals(y){return this.isSystem&&
y.isSystem?this.toNumber()===y.toNumber():this.isUnknownTimeZone!==y.isUnknownTimeZone?!1:this._date.equals(y._date)}get isUnknownTimeZone(){return this._date.zone===x.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let y=this._date.weekday;6<y&&(y=0);return y}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-
1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const y=this.zone;return"fixed"===y.type?0===y.fixed?"UTC":y.formatOffset(0,"short"):y.name}stringify(){return JSON.stringify(this.toJSDate())}plus(y){return new k(this._date.plus(y))}diff(y,w="milliseconds"){return this._date.diff(y._date,
w)[w]}toISODate(){return this._date.toISODate()}toISOString(y){return y?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(y,w){return this._date.toISOTime({suppressMilliseconds:y,includeOffset:w&&!this.isUnknownTimeZone})}toFormat(y,w){this.isUnknownTimeZone&&(y=y.replaceAll("Z",""));return this._date.toFormat(y,w)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new k(this._date.toUTC())}toLocal(){return new k(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(y){if(!y)return null;
y=D.DateTime.fromISO(y,{setZone:!0});return new k(y)}}e.ArcadeDate=k;e.ArcadeDateError=p;e.arcadeDateErrorMessages=a;e.createDateTimeZone=N;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(e,l){function x(t){return t instanceof l.Zone?t===D.instance?!0:!1:"unknown"===t?.toString().toLowerCase()?!0:!1}class D{}D.instance=new l.IANAZone("Etc/UTC");e.UnknownTimeZone=D;e.adoptTimeZone=function(t,
N){return l.DateTime.fromObject({day:t.day,year:t.year,month:t.month,hour:t.hour,minute:t.minute,second:t.second,millisecond:t.millisecond},{zone:N})};e.isUnknownTimeZone=x;e.substituteUnknownTimezone=function(t){return x(t)?D.instance:t};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ./DateOnly ./errorSupport ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(e,l,x,D,t,N){function a(w){if(null===
w)return null;let I=0,G=0;for(let r=0;r<w.length;r++){const J=w[r];if(null!==J){if("number"!==typeof J)throw new x.SqlError(x.SqlErrorCodes.InvalidValueForAggregateFunction);G++;I+=J}}return 0===G?null:I/w.length}function p(w,I){if(null===w)return null;let G=null,r=null;for(const J of w)w=J,w=J instanceof l.DateOnly?J.toNumber():J instanceof t.TimeOnly?J.toNumber():J instanceof N.DateTime?J.toMillis():J instanceof D.SqlTimeStampOffset?J.toMilliseconds():J,null===G?(G=J,r=w):"max"===I&&null!==r&&null!==
w&&r<=w?(G=J,r=w):"min"===I&&null!==r&&null!==w&&r>=w&&(G=J,r=w);return G}function k(w){if(null===w)return null;w=w.filter(r=>null!==r);if(0===w.length)return null;const I=a(w);if(null===I)return null;let G=0;for(const r of w){if("number"!==typeof r)throw new x.SqlError(x.SqlErrorCodes.InvalidValueForAggregateFunction);G+=(I-r)**2}return G/(w.length-1)}const y={min:{minParams:1,maxParams:1,evaluate:w=>p(w[0],"min")},max:{minParams:1,maxParams:1,evaluate:w=>p(w[0],"max")},avg:{minParams:1,maxParams:1,
evaluate:w=>a(w[0])},sum:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];if(null===w)w=null;else{var I=0;for(let G=0;G<w.length;G++){const r=w[G];if(null!==r){if("number"!==typeof r)throw new x.SqlError(x.SqlErrorCodes.InvalidValueForAggregateFunction);I+=r}}w=I}return w}},stddev:{minParams:1,maxParams:1,evaluate:w=>{w=w[0];null===w?w=null:(w=k(w),w=null===w?null:Math.sqrt(w));return w}},count:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].length},var:{minParams:1,maxParams:1,evaluate:w=>
k(w[0])}};e.aggregateFunction=function(w,I){const G=y[w.toLowerCase()];if(null==G)throw new x.SqlError(x.SqlErrorCodes.FunctionNotRecognized);if(I.length<G.minParams||I.length>G.maxParams)throw new x.SqlError(x.SqlErrorCodes.InvalidParameterCount,{name:w.toUpperCase()});return G.evaluate(I)};e.isAggregate=function(w,I){w=y[w.toLowerCase()];return null!=w&&I>=w.minParams&&I<=w.maxParams};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(e,l,x,D){function t(a){a=a.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let p="";const k=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const y of a.match(k)||[])switch(y){case "D":p+="d";break;case "DD":p+="dd";break;case "DDD":p+="o";break;case "d":p+="c";break;case "ddd":p+=
"ccc";break;case "dddd":p+="cccc";break;case "M":p+="L";break;case "MM":p+="LL";break;case "MMM":p+="LLL";break;case "MMMM":p+="LLLL";break;case "YY":p+="yy";break;case "Y":case "YYYY":p+="yyyy";break;case "Q":p+="q";break;case "X":case "x":p+=y;break;default:p=2<=y.length&&"["===y.slice(0,1)&&"]"===y.slice(-1)?p+`'${y.slice(1,-1)}'`:p+`'${y}'`}return p}class N{constructor(a,p,k){this._year=a;this._month=p;this._day=k;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(a){return a instanceof N&&a.day===this.day&&a.month===this.month&&a.year===this.year}clone(){return new N(this._year,this._month,this._day)}toDateTime(a){return D.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:l.createDateTimeZone(a)})}toDateTimeLuxon(a){return D.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:l.createDateTimeZone(a)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(a=null,p=!0){if(null===a||""===a)return this.toString();p&&(a=t(a));if(!a)return"";p=this.toDateTime("unknown");return l.ArcadeDate.dateTimeToArcadeDate(p).toFormat(a,{locale:x.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const a=this.toDateTime("unknown");return l.ArcadeDate.dateTimeToArcadeDate(a)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(a,p){return N.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}toUTCDateTime(){return D.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(a){a=D.DateTime.fromMillis(a,{zone:D.FixedOffsetZone.utcInstance});return a.isValid?N.fromParts(a.year,a.month,a.day):null}static fromSeconds(a){a=D.DateTime.fromSeconds(a,{zone:D.FixedOffsetZone.utcInstance});return a.isValid?N.fromParts(a.year,a.month,a.day):null}static fromReader(a){if(!a)return null;a=a.split("-");return 3!==a.length?null:new N(parseInt(a[0],10),parseInt(a[1],
10),parseInt(a[2],10))}static fromParts(a,p,k){a=new N(a,p,k);return!1===a.isValid?null:a}static fromDateJS(a){return N.fromParts(a.getFullYear(),a.getMonth()+1,a.getDay())}static fromDateTime(a){return N.fromParts(a.year,a.month,a.day)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;var k=[];if(p)(p=t(p))&&k.push(p);else if(null===p||""===p)return a=D.DateTime.fromISO(a,{setZone:!0}),a.isValid?N.fromParts(a.year,
a.month,a.day):null;for(const y of k)if(k=D.DateTime.fromFormat(a,p??y),k.isValid)return new N(k.year,k.month,k.day);return null}static fromNow(a="system"){a=D.DateTime.fromJSDate(new Date).setZone(l.createDateTimeZone(a));return new N(a.year,a.month,a.day)}}e.DateOnly=N;e.standardizeDateOnlyFormat=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/errorSupport":function(){define(["exports","../string"],function(e,l){e.SqlErrorCodes=void 0;(function(t){t.InvalidFunctionParameters=
"InvalidFunctionParameters";t.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";t.UnsupportedSqlFunction="UnsupportedSqlFunction";t.UnsupportedOperator="UnsupportedOperator";t.UnsupportedSyntax="UnsupportedSyntax";t.UnsupportedIsRhs="UnsupportedIsRhs";t.UnsupportedIsLhs="UnsupportedIsLhs";t.InvalidDataType="InvalidDataType";t.CannotCastValue="CannotCastValue";t.FunctionNotRecognized="FunctionNotRecognized";t.InvalidTime="InvalidTime";t.InvalidParameterCount="InvalidParameterCount";
t.InvalidTimeStamp="InvalidTimeStamp";t.InvalidDate="InvalidDate";t.InvalidOperator="InvalidOperator";t.IllegalInterval="IllegalInterval";t.YearMonthIntervals="YearMonthIntervals";t.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";t.MissingStatisticParameters="MissingStatisticParameters"})(e.SqlErrorCodes||(e.SqlErrorCodes={}));const x={[e.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[e.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[e.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[e.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[e.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[e.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[e.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[e.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[e.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[e.SqlErrorCodes.InvalidDate]:"Invalid date encountered",[e.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[e.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[e.SqlErrorCodes.IllegalInterval]:"Illegal interval",[e.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[e.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[e.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[e.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",
[e.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",[e.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class D extends Error{constructor(t,N){super(l.replace(x[t],N));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,D)}}e.SqlError=D;e.sqlErrorMessages=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports",
"../../chunks/datetime"],function(e,l){function x(t){return Number.isNaN(t)||0===t?t:Math.trunc(t)}class D{constructor(t){this._timeStampOffset=t;this._date=null}toDateTime(){this._date??(this._date=l.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return x(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return x(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return D.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(t){return new D(l.DateTime.fromJSDate(t).toISO({includeOffset:!0}))}static fromDateTime(t){return new D(t.toISO({includeOffset:!0}))}static fromParts(t,
N,a=0,p=0,k=0,y=0,w=0,I=!1,G=0,r=0){t=`${t.toString().padStart(4,"0")}-${N.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}`;N="";10>y&&(N="0");p=`${p.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}:${N+y.toString()}`;0!==w&&(p+="."+w.toString().padStart(3,"0"));w=`${I?"-":"+"}${G.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return new D(t+"T"+p+w)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let t=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});t&&=t.replace(".000","");return t}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(t){t=this.toDateTime().plus(t);return D.fromDateTime(t)}}e.SqlTimeStampOffset=D;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(e,l,x,D){function t(a){if(!a)return"";const p=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let k="";for(const y of a.match(p)||
[])switch(y){case "SSS":k+=y;break;case "A":case "a":k+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":k+=y;break;default:k+=`'${y}'`}return k}class N{constructor(a,p,k,y){this._hour=a;this._minute=p;this._second=k;this._millisecond=y;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(a){return a instanceof N&&a.hour===
this.hour&&a.minute===this.minute&&a.second===this.second&&a.millisecond===this.millisecond}clone(){return new N(this.hour,this.minute,this.second,this.millisecond)}isValid(){return l.isInteger(this.hour)&&l.isInteger(this.minute)&&l.isInteger(this.second)&&l.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(a=null){return null===a||""===a?this.toString():(a=t(a))?D.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(a,{locale:x.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(a,p,k,y){a=new N(a,p,k,y);return a.isValid()?a:null}static fromReader(a){if(!a)return null;a=a.split(":");return 3!==a.length?null:new N(parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],
10),0)}static fromMilliseconds(a){return 864E5<a||0>a?null:new N(Math.floor(a/36E5%24),Math.floor(a/6E4%60),Math.floor(a/1E3%60),Math.floor(a%1E3))}static fromDateJS(a){return new N(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}static fromDateTime(a){return new N(a.hour,a.minute,a.second,a.millisecond)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;const k=[];if(p)(p=t(p))&&k.push(p);else if(null===
p||""===p)k.push("HH:mm:ss"),k.push("HH:mm:ss.SSS"),k.push("hh:mm:ss a"),k.push("hh:mm:ss.SSS a"),k.push("HH:mm"),k.push("hh:mm a"),k.push("H:mm"),k.push("h:mm a"),k.push("H:mm:ss"),k.push("h:mm:ss a"),k.push("H:mm:ss.SSS"),k.push("h:mm:ss.SSS a");for(const y of k)if(p=D.DateTime.fromFormat(a,y),p.isValid)return new N(p.hour,p.minute,p.second,p.millisecond);return null}plus(a,p){switch(a){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return N.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}return null}toUTCDateTime(){return D.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}}e.TimeOnly=N;e.standardizeTimeFormat=t;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(e,l){e.cloneGeometry=function(x){if(null==x)return null;const D=x.clone();void 0!==x.cache._geVersion&&(D.cache._geVersion=x.cache._geVersion);return D};e.convertLinearUnitsToCode=function(x){if(null==x)return null;if("number"===typeof x)return x;x=x.toLowerCase();x=x.replaceAll(/\s/g,"");x=x.replaceAll("-","");switch(x){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};e.convertSquareUnitsToCode=
function(x){if(null==x)return null;if("number"===typeof x)return x;x=x.toLowerCase();x=x.replaceAll(/\s/g,"");x=x.replaceAll("-","");switch(x){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};e.isInteger=function(x){return"number"===typeof x&&isFinite(x)&&Math.floor(x)===x};e.sameGeomType=function(x,D){return x===D||"point"===x&&"esriGeometryPoint"===D||"polyline"===x&&"esriGeometryPolyline"===
D||"polygon"===x&&"esriGeometryPolygon"===D||"extent"===x&&"esriGeometryEnvelope"===D||"multipoint"===x&&"esriGeometryMultipoint"===D||"point"===D&&"esriGeometryPoint"===x||"polyline"===D&&"esriGeometryPolyline"===x||"polygon"===D&&"esriGeometryPolygon"===x||"extent"===D&&"esriGeometryEnvelope"===x||"multipoint"===D&&"esriGeometryMultipoint"===x?!0:!1};e.shapeExtent=function(x){if(null==x)return null;switch(x.type){case "polygon":case "multipoint":case "polyline":return x.extent;case "point":return new l({xmin:x.x,
ymin:x.y,xmax:x.x,ymax:x.y,spatialReference:x.spatialReference});case "extent":return x}return null};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(e,l,x,D,t){function N(C,H,O){switch(O){case "+":return C+H;case "-":return C-H;case "*":return C*H;case "/":return C/H}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function a(C,
H,O){switch(O){case "+":return H.plus({milliseconds:C.valueInMilliseconds()});case "-":return C.valueInMilliseconds()-H.toMillis()}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function p(C,H,O){switch(O){case "+":return H.plus("milliseconds",C.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function k(C,H,O){switch(O){case "+":return H.plus("milliseconds",C.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function y(C,H,O){switch(O){case "+":return C.plus("milliseconds",
H.valueInMilliseconds());case "-":return C.plus("milliseconds",-1*H.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function w(C,H,O){switch(O){case "+":return H.addMilliseconds(C.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function I(C,H,O){switch(O){case "+":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()+H.valueInMilliseconds());case "-":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()-H.valueInMilliseconds());
case "*":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()*H.valueInMilliseconds());case "/":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()/H.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function G(C,H,O){switch(O){case "+":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()+H);case "-":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()-H);case "*":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()*
H);case "/":return D.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()/H)}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function r(C,H,O){switch(O){case "+":return D.SqlInterval.createFromMilliseconds(C+H.valueInMilliseconds());case "-":return D.SqlInterval.createFromMilliseconds(C-H.valueInMilliseconds());case "*":return D.SqlInterval.createFromMilliseconds(C*H.valueInMilliseconds());case "/":return D.SqlInterval.createFromMilliseconds(C/H.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function J(C,H,O){switch(O){case "+":return C.plus("milliseconds",H.valueInMilliseconds());case "-":return C.plus("milliseconds",-1*H.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function K(C,H,O){switch(O){case "+":return C.plus({milliseconds:H.valueInMilliseconds()});case "-":return C.minus({milliseconds:H.valueInMilliseconds()})}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function v(C,H,O){switch(O){case "+":return C.addMilliseconds(H.valueInMilliseconds());
case "-":return C.addMilliseconds(-1*H.valueInMilliseconds())}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function b(C,H,O){H*=864E5;switch(O){case "+":return C.plus({milliseconds:H});case "-":return C.minus({milliseconds:H})}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function q(C,H,O){H*=864E5;switch(O){case "+":return C.plus("milliseconds",H);case "-":return C.plus("milliseconds",-1*H)}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function L(C,H,O){H*=864E5;switch(O){case "+":return C.plus("milliseconds",
H);case "-":return C.plus("milliseconds",-1*H)}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function d(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function z(C,H,O){H*=864E5;switch(O){case "+":return C.addMilliseconds(H);case "-":return C.addMilliseconds(-1*H)}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function M(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function Q(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function Z(C,
H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function U(C,H,O){H=parseFloat(H);if(isNaN(H))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);return N(C,H,O)}function T(C,H,O){C=parseFloat(C);if(isNaN(C))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);return N(C,H,O)}function u(C,H,O){switch(O){case "+":return C+H}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function R(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function g(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function f(C,H,O){switch(O){case "-":return C.toDateTimeLuxon(H.zone).diff(H).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function h(C,H,O){switch(O){case "-":return C.toDateTimeLuxon(H.toDateTime().zone).diff(H.toDateTime()).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function A(C,H,O){switch(O){case "-":return C.toDateTimeLuxon("UTC").diff(H.toDateTimeLuxon("UTC")).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function P(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function X(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function ca(C,H,O){switch(O){case "-":return C.toDateTime().diff(H.toDateTimeLuxon(C.toDateTime().zone)).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function ia(C,H,O){switch(O){case "-":return C.toDateTime().diff(H).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function na(C,H,O){switch(O){case "-":return C.toDateTime().diff(H.toDateTime()).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function oa(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function pa(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function sa(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function wa(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function xa(C,H,O){switch(O){case "-":return C.diff(H).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function Da(C,H,O){switch(O){case "-":return C.diff(H.toDateTimeLuxon(C.zone)).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function Ea(C,H,O){switch(O){case "-":return C.diff(H.toDateTime()).as("days")}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function Ja(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function Sa(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function ab(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function La(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function m(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}function F(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function W(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function ba(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}function ja(C,H,O){throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}e.calculateDateOnlyAndDateOnly=A;e.calculateDateOnlyAndDateTime=f;e.calculateDateOnlyAndNumber=q;e.calculateDateOnlyAndSqlInterval=J;e.calculateDateOnlyAndString=Sa;e.calculateDateOnlyAndTimeOnly=P;e.calculateDateOnlyAndTimestamp=
h;e.calculateDateTimeAndDateOnly=Da;e.calculateDateTimeAndDateTime=xa;e.calculateDateTimeAndNumber=b;e.calculateDateTimeAndSqlInterval=K;e.calculateDateTimeAndString=La;e.calculateDateTimeAndTimeOnly=Ja;e.calculateDateTimeAndTimestamp=Ea;e.calculateNumberAndDateOnly=Z;e.calculateNumberAndDateTime=d;e.calculateNumberAndNumber=N;e.calculateNumberAndSqlInterval=r;e.calculateNumberAndString=U;e.calculateNumberAndTimeOnly=Q;e.calculateNumberAndTimestamp=M;e.calculateSqlIntervalAndDateOnly=k;e.calculateSqlIntervalAndDateTime=
a;e.calculateSqlIntervalAndNumber=G;e.calculateSqlIntervalAndSqlInterval=I;e.calculateSqlIntervalAndString=R;e.calculateSqlIntervalAndTimeOnly=p;e.calculateSqlIntervalAndTimestamp=w;e.calculateStringAndDateOnly=W;e.calculateStringAndDateTime=ba;e.calculateStringAndNumber=T;e.calculateStringAndSqlInterval=g;e.calculateStringAndString=u;e.calculateStringAndTimeOnly=F;e.calculateStringAndTimestamp=ja;e.calculateTimeOnlyAndDateOnly=pa;e.calculateTimeOnlyAndDateTime=oa;e.calculateTimeOnlyAndNumber=L;e.calculateTimeOnlyAndSqlInterval=
y;e.calculateTimeOnlyAndString=ab;e.calculateTimeOnlyAndTimeOnly=wa;e.calculateTimeOnlyAndTimestamp=sa;e.calculateTimestampAndDateOnly=ca;e.calculateTimestampAndDateTime=ia;e.calculateTimestampAndNumber=z;e.calculateTimestampAndSqlInterval=v;e.calculateTimestampAndString=m;e.calculateTimestampAndTimeOnly=X;e.calculateTimestampAndTimestamp=na;e.sqlCalculateFunction=function(C,H,O,V){if("||"===C)return t.evaluateFunction("concat",[H,O],V);if(null===H||null===O)return null;if(x.isNumber(H)){if(x.isNumber(O))return N(H,
O,C);if(x.isSqlInterval(O))return r(H,O,C);if(x.isTimeOnly(O))return Q();if(x.isDateOnly(O))return Z();if(x.isTimestampOffset(O))return M();if(x.isDateTime(O))return d();if(x.isString(O))return U(H,O,C)}else if(x.isDateOnly(H)){if(x.isNumber(O))return q(H,O,C);if(x.isSqlInterval(O))return J(H,O,C);if(x.isTimeOnly(O))return P();if(x.isDateOnly(O))return A(H,O,C);if(x.isTimestampOffset(O))return h(H,O,C);if(x.isDateTime(O))return f(H,O,C);if(x.isString(O))return Sa()}else if(x.isTimeOnly(H)){if(x.isNumber(O))return L(H,
O,C);if(x.isSqlInterval(O))return y(H,O,C);if(x.isTimeOnly(O))return wa();if(x.isDateOnly(O))return pa();if(x.isTimestampOffset(O))return sa();if(x.isDateTime(O))return oa();if(x.isString(O))return ab()}else if(x.isSqlInterval(H)){if(x.isNumber(O))return G(H,O,C);if(x.isSqlInterval(O))return I(H,O,C);if(x.isTimeOnly(O))return p(H,O,C);if(x.isDateOnly(O))return k(H,O,C);if(x.isTimestampOffset(O))return w(H,O,C);if(x.isDateTime(O))return a(H,O,C);if(x.isString(O))return R()}else if(x.isDateTime(H)){if(x.isNumber(O))return b(H,
O,C);if(x.isSqlInterval(O))return K(H,O,C);if(x.isTimeOnly(O))return Ja();if(x.isDateOnly(O))return Da(H,O,C);if(x.isTimestampOffset(O))return Ea(H,O,C);if(x.isDateTime(O))return xa(H,O,C);if(x.isString(O))return La()}else if(x.isTimestampOffset(H)){if(x.isNumber(O))return z(H,O,C);if(x.isSqlInterval(O))return v(H,O,C);if(x.isTimeOnly(O))return X();if(x.isDateOnly(O))return ca(H,O,C);if(x.isTimestampOffset(O))return na(H,O,C);if(x.isDateTime(O))return ia(H,O,C);if(x.isString(O))return m()}else if(x.isString(H)){if(x.isNumber(O))return T(H,
O,C);if(x.isSqlInterval(O))return g();if(x.isTimeOnly(O))return F();if(x.isDateOnly(O))return W();if(x.isTimestampOffset(O))return ja();if(x.isDateTime(O))return ba();if(x.isString(O))return u(H,O,C)}throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ./DateOnly ./errorSupport ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(e,l,x,D,t,N,a,p){function k(b,q,L){L=r.exec(b);if(null!==L){const [,d,z,M,Q,Z,U,T]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(z,10),day:parseInt(M,10),hour:parseInt(Q,10),minute:parseInt(Z,10),second:parseInt(U,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);return b}L=J.exec(b);if(null!==L){const [,d,z,M,Q,Z,U,T,u,R,g]=L;b=t.SqlTimeStampOffset.fromParts(parseInt(d,
10),parseInt(z,10),parseInt(M,10),parseInt(Q,10),parseInt(Z,10),parseInt(U,10),T?parseInt(T.replace(".",""),10):0,"-"===u,parseInt(R,10),parseInt(g,10));if(!1===b.isValid)throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);return b}L=K.exec(b);if(null!==L){const [,d,z,M,Q,Z,U,T,u]=L;b=t.SqlTimeStampOffset.fromParts(parseInt(d,10),parseInt(z,10),parseInt(M,10),parseInt(Q,10),parseInt(Z,10),0,0,"-"===U,parseInt(T,10),parseInt(u,10));if(!1===b.isValid)throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);
return b}L=v.exec(b);if(null!==L){const [,d,z,M,Q,Z]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(z,10),day:parseInt(M,10),hour:parseInt(Q,10),minute:parseInt(Z,10),second:0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);return b}L=G.exec(b);if(null!==L){const [,d,z,M]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(z,10),day:parseInt(M,10),hour:0,minute:0,second:0},{zone:a.substituteUnknownTimezone(q)});
if(!1===b.isValid)throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);return b}throw new x.SqlError(x.SqlErrorCodes.InvalidTimeStamp);}const y=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,w=/^(\d{1,2}):(\d{1,2})$/,I=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,G=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,r=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,J=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,K=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
v=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;e.convertToExecutingTimeZone=function(b,q){if(q instanceof p.Zone)return q===a.UnknownTimeZone.instance?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q});switch(q){case "system":case "local":case null:return p.DateTime.fromJSDate(b);default:return"unknown"===q?.toLowerCase()?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q})}};e.isDate=function(b){return b instanceof
Date};e.isDateOnly=function(b){return b instanceof l.DateOnly};e.isDateTime=function(b){return b instanceof p.DateTime};e.isNumber=function(b){return"number"===typeof b};e.isSqlInterval=function(b){return b instanceof D.SqlInterval};e.isString=function(b){return"string"===typeof b||b instanceof String};e.isTimeOnly=function(b){return b instanceof N.TimeOnly};e.isTimestampOffset=function(b){return b instanceof t.SqlTimeStampOffset};e.parseDate=function(b,q){const L=G.exec(b);if(null===L)try{return k(b,
q)}catch{throw new x.SqlError(x.SqlErrorCodes.InvalidDate);}const [,d,z,M]=L;b=l.DateOnly.fromParts(parseInt(d,10),parseInt(z,10),parseInt(M,10));if(null===b)throw new x.SqlError(x.SqlErrorCodes.InvalidDate);return b};e.parseTime=function(b){let q=y.exec(b);if(null!==q){const [,L,d,z]=q;b=N.TimeOnly.fromParts(parseInt(L,10),parseInt(d,10),parseInt(z,10),0);if(null!==b)return b;throw new x.SqlError(x.SqlErrorCodes.InvalidTime);}q=w.exec(b);if(null!==q){const [,L,d]=q;b=N.TimeOnly.fromParts(parseInt(L,
10),parseInt(d,10),0,0);if(null!==b)return b;throw new x.SqlError(x.SqlErrorCodes.InvalidTime);}q=I.exec(b);if(null!==q){const [,L,d,z,M]=q;b=N.TimeOnly.fromParts(parseInt(L,10),parseInt(d,10),parseInt(z,10),parseInt(M,10));if(null!==b)return b}throw new x.SqlError(x.SqlErrorCodes.InvalidTime);};e.parseTimestamp=k;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","./errorSupport"],function(e,l){class x{constructor(){this.op="+";
this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(D){if(null!==D.precision||null!==D.secondary)throw new l.SqlError(l.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(D,t){t.includes(".")?(t=t.split("."),D.second=parseFloat(t[0]),D.millis=parseInt(t[1],10)):D.second=parseFloat(t)}static createFromMilliseconds(D){const t=new x;t.second=D/1E3;return t}static createFromValueAndQualifier(D,t,N){let a=null;const p=new x;p.op="-"===
N?"-":"+";if("interval-period"===t.type){x._fixDefaults(t);N=RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new l.SqlError(l.SqlErrorCodes.YearMonthIntervals);if("second"===t.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(D))x._parseSecondsComponent(p,D);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);else if(N.test(D))p[t.period]=parseFloat(D);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);}else{x._fixDefaults(t.start);x._fixDefaults(t.end);if("year"===
t.start.period||"month"===t.start.period||"year"===t.end.period||"month"===t.end.period)throw new l.SqlError(l.SqlErrorCodes.YearMonthIntervals);switch(t.start.period){case "day":switch(t.end.period){case "hour":a=RegExp("^[0-9]{1,} [0-9]{1,}$");if(a.test(D))p[t.start.period]=parseFloat(D.split(" ")[0]),p[t.end.period]=parseFloat(D.split(" ")[1]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;case "minute":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(a.test(D))p[t.start.period]=
parseFloat(D.split(" ")[0]),D=D.split(" ")[1].split(":"),p.hour=parseFloat(D[0]),p.minute=parseFloat(D[1]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(D))p[t.start.period]=parseFloat(D.split(" ")[0]),D=D.split(" ")[1].split(":"),p.hour=parseFloat(D[0]),p.minute=parseFloat(D[1]),x._parseSecondsComponent(p,D[2]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;default:throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(t.end.period){case "minute":a=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(a.test(D))p.hour=parseFloat(D.split(":")[0]),p.minute=parseFloat(D.split(":")[1]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(D))D=D.split(":"),p.hour=parseFloat(D[0]),p.minute=parseFloat(D[1]),x._parseSecondsComponent(p,D[2]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;default:throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(t.end.period){case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(D))D=D.split(":"),p.minute=parseFloat(D[0]),x._parseSecondsComponent(p,D[1]);else throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);break;default:throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);}break;default:throw new l.SqlError(l.SqlErrorCodes.IllegalInterval);}}return p}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}e.SqlInterval=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../mathUtils ../string ./DateOnly ./errorSupport ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(e,l,x,D,t,N,a,p,k){function y(v){return"string"===typeof v||v instanceof String}function w(v){return a.isDate(v)||a.isDateOnly(v)||a.isDateTime(v)||
a.isTimeOnly(v)||a.isTimestampOffset(v)?!1:!0}function I(v){return a.isDateOnly(v)||a.isTimeOnly(v)?v.toString():a.isTimestampOffset(v)?v.toSQLValue():a.isDateTime(v)?0===v.millisecond?v.toFormat("yyyy-LL-dd HH:mm:ss"):v.toSQL({includeOffset:!1}):a.isDate(v)?I(k.DateTime.fromJSDate(v)):v.toString()}function G(v){if(a.isDate(v))return D.DateOnly.fromDateJS(v);if(a.isDateTime(v))return D.DateOnly.fromParts(v.year,v.month,v.day);if(a.isDateOnly(v))return v;if(a.isTimeOnly(v))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);
if(a.isTimestampOffset(v)&&null===D.DateOnly.fromParts(v.year,v.month,v.day))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);if(y(v)&&(v=D.DateOnly.fromReader(v),null!==v&&v.isValid))return v;throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);}function r(v,b,q){if(a.isDate(v))return a.convertToExecutingTimeZone(v,b);if(a.isDateTime(v))return v;if(a.isDateOnly(v))return v.toDateTimeLuxon("unknown");if(a.isTimeOnly(v))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);if(a.isTimestampOffset(v))return v;
if(y(v))return a.parseTimestamp(v,"unknown",q);throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);}function J(v){if(a.isDate(v))return p.TimeOnly.fromDateJS(v);if(a.isDateTime(v))return p.TimeOnly.fromDateTime(v);if(a.isDateOnly(v))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);if(a.isTimeOnly(v))return v;if(a.isTimestampOffset(v))return p.TimeOnly.fromSqlTimeStampOffset(v);if(y(v))return a.parseTime(v);throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);}const K={extract:{minParams:2,
maxParams:2,evaluate:([v,b])=>{if(null==b)return null;if(a.isDate(b))switch(v.toUpperCase()){case "SECOND":return b.getSeconds();case "MINUTE":return b.getMinutes();case "HOUR":return b.getHours();case "DAY":return b.getDate();case "MONTH":return b.getMonth()+1;case "YEAR":return b.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(a.isDateTime(b))switch(v.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;
case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isDateOnly(b))switch(v.toUpperCase()){case "DAY":return b.day;case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isTimeOnly(b))switch(v.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour}else if(a.isTimestampOffset(b))switch(v.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;case "MONTH":return b.month;
case "YEAR":return b.year;case "TIMEZONE_HOUR":return b.timezoneOffsetHour;case "TIMEZONE_MINUTE":return b.timezoneOffsetMinutes}throw new t.SqlError(t.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:v=>{if(2===v.length){const [b,q]=v;return null==b||null==q?null:b.toString().substring(q-1)}if(3===v.length){const [b,q,L]=v;return null==b||null==q||null==L?null:0>=L?"":b.toString().substring(q-1,q+L-1)}}},position:{minParams:2,maxParams:2,
evaluate:([v,b])=>null==v||null==b?null:b.indexOf(v)+1},trim:{minParams:2,maxParams:3,evaluate:v=>{var b=3===v.length,q=b?v[1]:" ";b=b?v[2]:v[1];if(null==q||null==b)return null;q=`(${x.escapeRegExpString(q)})`;switch(v[0]){case "BOTH":return b.replaceAll(new RegExp(`^${q}*|${q}*$`,"g"),"");case "LEADING":return b.replaceAll(new RegExp(`^${q}*`,"g"),"");case "TRAILING":return b.replaceAll(new RegExp(`${q}*$`,"g"),"")}throw new t.SqlError(t.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.abs(v[0])},ceiling:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.ceil(v[0])},floor:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.floor(v[0])},log:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])},log10:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.log(v[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sin(v[0])},cos:{minParams:1,maxParams:1,evaluate:v=>
null==v[0]?null:Math.cos(v[0])},tan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.tan(v[0])},asin:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.asin(v[0])},acos:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.acos(v[0])},atan:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.atan(v[0])},sign:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:0<v[0]?1:0>v[0]?-1:0},power:{minParams:2,maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]**v[1]},mod:{minParams:2,
maxParams:2,evaluate:v=>null==v[0]||null==v[1]?null:v[0]%v[1]},round:{minParams:1,maxParams:2,evaluate:v=>{const b=v[0];v=2===v.length?10**v[1]:1;return null==b?null:Math.round(b*v)/v}},truncate:{minParams:1,maxParams:2,evaluate:v=>null==v[0]?null:1===v.length||0===v[1]?Math.trunc(v[0]):l.decimalAdjust("trunc",v[0],-Number(v[1]))},char_length:{minParams:1,maxParams:1,evaluate:v=>y(v[0])?v[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:v=>{let b="";for(let q=0;q<v.length;q++){if(null==
v[q])return null;b+=v[q].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:v=>{for(const b of v)if(null!==b)return b;return null}},cosh:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.cosh(v[0])},sinh:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:Math.sinh(v[0])},tanh:{minParams:1,
maxParams:1,evaluate:v=>null==v[0]?null:Math.tanh(v[0])},nullif:{minParams:2,maxParams:2,evaluate:(v,b)=>N.sqlCompare(v[0],v[1],"\x3d")?null:v[0]},cast:{minParams:2,maxParams:2,evaluate:(v,b)=>{const q=v[0];v=v[1];if(null===q)return null;switch(v.type){case "integer":if(!w(q))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);b=parseInt(q,10);if(isNaN(b))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return b;case "smallint":if(!w(q))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);
b=parseInt(q,10);if(isNaN(b))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);if(32767<b||-32767>b)throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return b;case "float":case "real":if(!w(q))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);b=parseFloat(q);if(isNaN(b))throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);return b;case "time":return J(q);case "date":return G(q);case "timestamp":return r(q,b,!0===v.withtimezone);case "varchar":b=I(q);if(b.length>v.size)throw new t.SqlError(t.SqlErrorCodes.CannotCastValue);
return b;default:throw new t.SqlError(t.SqlErrorCodes.InvalidDataType);}}}};e.evaluateFunction=function(v,b,q){const L=K[v.toLowerCase()];if(null==L)throw new t.SqlError(t.SqlErrorCodes.FunctionNotRecognized);if(b.length<L.minParams||b.length>L.maxParams)throw new t.SqlError(t.SqlErrorCodes.InvalidParameterCount,{name:v.toUpperCase()});return L.evaluate(b,q)};e.isStandardized=function(v,b){v=K[v.toLowerCase()];return null!=v&&b>=v.minParams&&b<=v.maxParams};Object.defineProperty(e,Symbol.toStringTag,
{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ./errorSupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),function(e,l,x,D,t,N){function a(K){return x.isDateTime(K)||x.isTimestampOffset(K)?!0:!1}function p(K){return x.isDateTime(K)||x.isDateOnly(K)||x.isTimestampOffset(K)||x.isTimeOnly(K)?!0:!1}function k(K){if(x.isDateTime(K))return K.toMillis();if(x.isDateOnly(K))return K.toNumber();if(x.isTimestampOffset(K))return K.toMilliseconds();
throw new l.SqlError(l.SqlErrorCodes.InvalidDataType);}function y(K,v,b){switch(b){case "\x3c\x3e":return K!==v;case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}}function w(K,v,b){const q=parseFloat(v);if(!isNaN(q))return y(K,q,b);K=K.toString();switch(b){case "\x3c\x3e":return K!==v;case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}}function I(K,
v,b){const q=parseFloat(K);if(!isNaN(q))return y(q,v,b);v=v.toString();switch(b){case "\x3c\x3e":return K!==v;case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}}function G(K,v,b){switch(b){case "\x3c\x3e":return K!==v;case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}}function r(K,v,b){K instanceof D.SqlTimeStampOffset&&(K=K.toDateTime());v instanceof
D.SqlTimeStampOffset&&(v=v.toDateTime());K=J(K);v=J(v);switch(b){case "\x3c\x3e":return K!==v;case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}}function J(K){return 321408E5*K.year+26784E5*K.month+864E5*K.day+36E5*K.hour+6E4*K.minute+1E3*K.second+K.millisecond}e.dateValueInMilliseconds=k;e.isDateOrTimeValue=p;e.isDateTimeComparableValue=a;e.sqlCompare=function(K,v,b,q){if(null==K||null==v)return null;if(x.isNumber(K)){if(x.isNumber(v))return y(K,
v,b);if(x.isString(v))return w(K,v,b);if(p(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isDateOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}else if(x.isString(K)){if(x.isNumber(v))return I(K,v,b);if(x.isString(v))return G(K,v,b);if(x.isDateTime(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isDateOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isTimeOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isTimestampOffset(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}else if(x.isDateTime(K)){if(a(v)){if(K instanceof N.DateTime&&t.isUnknownTimeZone(K.zone)){if(v instanceof N.DateTime&&!1===t.isUnknownTimeZone(v.zone)||v instanceof D.SqlTimeStampOffset)return r(K,v,b)}else if(v instanceof N.DateTime&&t.isUnknownTimeZone(v.zone)&&(K instanceof N.DateTime&&!1===t.isUnknownTimeZone(K.zone)||K instanceof D.SqlTimeStampOffset))return r(K,v,b);return y(k(K),k(v),b)}if(x.isString(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isDateOnly(v))return v=v.toDateTimeLuxon(K.zone),
K=K.startOf("day"),y(K.toMillis(),v.toMillis(),b);if(x.isTimeOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isNumber(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}else if(x.isDateOnly(K)){if(x.isTimestampOffset(v))return K=K.toDateTimeLuxon(v.toDateTime().zone),v=v.startOfDay(),y(K.toMillis(),v.toMilliseconds(),b);if(x.isDateTime(v))return K=K.toDateTimeLuxon(v.zone),v=v.startOf("day"),y(K.toMillis(),v.toMillis(),b);if(x.isString(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
if(x.isDateOnly(v))return y(K.toNumber(),v.toNumber(),b);if(x.isTimeOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isNumber(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}else if(x.isTimeOnly(K)){if(x.isTimeOnly(v))return y(K.toNumber(),v.toNumber(),b);if(x.isString(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isNumber(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isDateOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(a(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);
}else if(x.isTimestampOffset(K)){if(a(v))return v instanceof N.DateTime&&t.isUnknownTimeZone(v.zone)?r(K,v,b):y(k(K),k(v),b);if(x.isString(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isDateOnly(v))return v=v.toDateTimeLuxon(K.toDateTime().zone),K=K.startOfDay(),y(K.toMilliseconds(),v.toMillis(),b);if(x.isTimeOnly(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);if(x.isNumber(v))throw new l.SqlError(l.SqlErrorCodes.InvalidOperator);}switch(b){case "\x3c\x3e":return K!==v;
case "\x3d":return K===v;case "\x3e":return K>v;case "\x3c":return K<v;case "\x3e\x3d":return K>=v;case "\x3c\x3d":return K<=v}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports"],function(e){function l(a,p,k,y){a=Error.call(this,a);Object.setPrototypeOf&&Object.setPrototypeOf(a,l.prototype);a.expected=p;a.found=k;a.location=y;a.name="SyntaxError";return a}function x(a,p,k){k=k||" ";if(a.length>p)return a;p-=a.length;k+=k.repeat(p);
return a+k.slice(0,p)}function D(a,p){function k(){return r(ka,n)}function y(B,E){E=void 0!==E?E:r(ka,n);throw new l(B,null,null,E);}function w(B,E){return{type:"literal",text:B,ignoreCase:E}}function I(B,E,S){return{type:"class",parts:B,inverted:E,ignoreCase:S}}function G(B){var E=Eb[B];if(!E){if(B>=Eb.length)var S=Eb.length-1;else for(S=B;!Eb[--S];);E=Eb[S];for(E={line:E.line,column:E.column};S<B;)10===a.charCodeAt(S)?(E.line++,E.column=1):E.column++,S++;Eb[B]=E}return E}function r(B,E,S){S=G(B);
var Y=G(E);return{source:Hd,start:{offset:B,line:S.line,column:S.column},end:{offset:E,line:Y.line,column:Y.column}}}function J(B){n<hb||(n>hb&&(hb=n,jc=[]),jc.push(B))}function K(){var B=n;ha();var E=b();E!==c?(ha(),ka=B,B=E):(n=B,B=c);return B}function v(){var B;var E=n;if(Ma()!==c){ha();var S=[];for(B=b();B!==c;){S.push(B);var Y=B=n;var ta=ha();var va=Xa();va!==c?(Y=ha(),Y=ta=[ta,va,Y]):(n=Y,Y=c);Y!==c?(Y=b(),Y===c?(n=B,B=c):B=Y):B=Y}B=ha();Y=Na();Y!==c?(ka=E,E=Ia(k(),...S)):(n=E,E=c)}else n=E,
E=c;return E}function b(){var B=n;var E=q();if(E!==c){var S=[];var Y=n;ha();var ta=V();if(ta!==c){ha();var va=q();va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)S.push(Y),Y=n,ha(),ta=V(),ta!==c?(ha(),va=q(),va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)):(n=Y,Y=c);ka=B;B=Ib(E,S)}else n=B,B=c;return B}function q(){var B=n;var E=L();if(E!==c){var S=[];var Y=n;ha();var ta=O();if(ta!==c){ha();var va=L();va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)}else n=
Y,Y=c;for(;Y!==c;)S.push(Y),Y=n,ha(),ta=O(),ta!==c?(ha(),va=L(),va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)):(n=Y,Y=c);ka=B;B=Ib(E,S)}else n=B,B=c;return B}function L(){var B=n;var E=H();if(E===c){E=n;if(33===a.charCodeAt(n)){var S=Id;n++}else S=c,0===fa&&J(Jd);if(S!==c){var Y=n;fa++;if(61===a.charCodeAt(n)){var ta=Kd;n++}else ta=c,0===fa&&J(Ld);fa--;ta===c?Y=void 0:(n=Y,Y=c);Y!==c?E=S=[S,Y]:(n=E,E=c)}else n=E,E=c}E!==c?(S=ha(),Y=L(),Y!==c?(ka=B,B={type:"unary-expression",location:k(),
operator:"NOT",expr:Y}):(n=B,B=c)):(n=B,B=c);if(B===c){E=n;B=Q();if(B!==c){S=n;ha();Y=n;ta=[];var va=n;ha();var Ga=d();if(Ga!==c){ha();var Ta=Q();Ta!==c?(ka=va,va={op:Ga,expr:Ta,location:k()}):(n=va,va=c)}else n=va,va=c;if(va!==c)for(;va!==c;)ta.push(va),va=n,ha(),Ga=d(),Ga!==c?(ha(),Ta=Q(),Ta!==c?(ka=va,va={op:Ga,expr:Ta,location:k()}):(n=va,va=c)):(n=va,va=c);else ta=c;ta!==c&&(ka=Y,ta={type:"arithmetic",tail:ta});Y=ta;if(Y===c&&(Y=n,ta=M(),ta!==c?(ha(),va=v(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=
Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=M(),ta!==c?(ha(),va=X(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c)),Y===c)){Y=n;ta=H();if(ta!==c)if(ha(),va=aa(),va!==c){var Jb=ha();Ga=n;Ta=Q();if(Ta!==c){ha();var db=O();db!==c?(ha(),ta=Q(),ta!==c?(ka=Ga,Ga=Ta,Ga=Ia(k(),Ga,ta)):(n=Ga,Ga=c)):(n=Ga,Ga=c)}else n=Ga,Ga=c;Ga!==c?(ka=Y,Y={op:"NOT"+va,right:Ga}):(n=Y,Y=c)}else n=Y,Y=c;else n=Y,Y=c;Y===c&&(Y=n,ta=aa(),ta!==c?(ha(),va=n,Jb=Q(),Jb!==c?(Ga=ha(),Ta=O(),Ta!==c?(ha(),db=Q(),db!==c?(ka=va,va=Jb,Ga=db,
va=Ia(k(),va,Ga)):(n=va,va=c)):(n=va,va=c)):(n=va,va=c),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c));Y===c&&(Y=n,ta=ja(),ta!==c?(ha(),va=H(),va!==c?(ha(),va=Q(),va!==c?(ka=Y,Y={op:ta+"NOT",right:va}):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=ja(),ta!==c?(ha(),va=Q(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c)),Y===c&&(Y=n,ta=z(),ta!==c?(ha(),va=xa(),va!==c?(ha(),Ga=n,Ta=a.substr(n,6),Ta.toLowerCase()===Md?n+=6:(Ta=c,0===fa&&J(Nd)),Ta!==c?(Ta=n,fa++,db=f(),fa--,db===c?Ta=void 0:
(n=Ta,Ta=c),Ta!==c?(ka=Ga,Ga="ESCAPE"):(n=Ga,Ga=c)):(n=Ga,Ga=c),Ga!==c?(ha(),Ga=Da(),Ga!==c?(ka=Y,Y={op:ta,right:va,escape:Ga.value}):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=z(),ta!==c?(ha(),va=xa(),va!==c?(ka=Y,Y={op:ta,right:va,escape:""}):(n=Y,Y=c)):(n=Y,Y=c))))}Y!==c?S=Y:(n=S,S=c);S===c&&(S=null);ka=E;E=S;""==E||void 0==E||null==E?E=B:(S=null,E=S="arithmetic"==E.type?Ib(B,E.tail):Kb(E.op,B,E.right,E.escape,k()))}else n=E,E=c;B=E}return B}function d(){if(a.substr(n,2)===fd){var B=
fd;n+=2}else B=c,0===fa&&J(Od);B===c&&(62===a.charCodeAt(n)?(B=Pd,n++):(B=c,0===fa&&J(Qd)),B===c&&(a.substr(n,2)===gd?(B=gd,n+=2):(B=c,0===fa&&J(Rd)),B===c&&(a.substr(n,2)===hd?(B=hd,n+=2):(B=c,0===fa&&J(Sd)),B===c&&(B=a.charAt(n),Td.test(B)?n++:(B=c,0===fa&&J(Ud)),B===c&&(a.substr(n,2)===id?(B=id,n+=2):(B=c,0===fa&&J(Vd)))))));return B}function z(){var B;var E=B=n;var S=H();if(S!==c){var Y=ha();var ta=C();ta!==c?E=S=[S,Y,ta]:(n=E,E=c)}else n=E,E=c;E!==c&&(ka=B,E=E[0]+" "+E[2]);B=E;B===c&&(B=C());
return B}function M(){var B;var E=B=n;var S=H();if(S!==c){var Y=ha();var ta=ba();ta!==c?E=S=[S,Y,ta]:(n=E,E=c)}else n=E,E=c;E!==c&&(ka=B,E=E[0]+" "+E[2]);B=E;B===c&&(B=ba());return B}function Q(){var B=n;var E=U();if(E!==c){var S=[];var Y=n;ha();var ta=Z();if(ta!==c){ha();var va=U();va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)S.push(Y),Y=n,ha(),ta=Z(),ta!==c?(ha(),va=U(),va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)):(n=Y,Y=c);ka=B;B=Ib(E,S)}else n=B,B=
c;return B}function Z(){var B=a.charAt(n);kc.test(B)?n++:(B=c,0===fa&&J(lc));B===c&&(a.substr(n,2)===jd?(B=jd,n+=2):(B=c,0===fa&&J(Wd)));return B}function U(){var B=n;var E=u();if(E!==c){var S=[];var Y=n;ha();var ta=T();if(ta!==c){ha();var va=u();va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)S.push(Y),Y=n,ha(),ta=T(),ta!==c?(ha(),va=u(),va!==c?(ka=Y,Y={op:ta,expr:va,location:k()}):(n=Y,Y=c)):(n=Y,Y=c);ka=B;B=Ib(E,S)}else n=B,B=c;return B}function T(){var B=a.charAt(n);
Xd.test(B)?n++:(B=c,0===fa&&J(Yd));return B}function u(){var B=Da();if(B===c){var E=n;var S=n;var Y=ab();if(Y!==c){var ta=La();if(ta!==c){var va=m();va!==c?(ka=S,S=parseFloat(Y+ta+va)):(n=S,S=c)}else n=S,S=c}else n=S,S=c;S===c&&(S=n,Y=ab(),Y!==c?(ta=La(),ta!==c?(ka=S,S=parseFloat(Y+ta)):(n=S,S=c)):(n=S,S=c),S===c&&(S=n,Y=ab(),Y!==c?(ta=m(),ta!==c?(ka=S,S=parseFloat(Y+ta)):(n=S,S=c)):(n=S,S=c),S===c&&(S=n,Y=ab(),Y!==c&&(ka=S,Y=parseFloat(Y)),S=Y)));var Ga=S;if(Ga!==c){var Ta=n;fa++;var Jb=g();fa--;
Jb===c?Ta=void 0:(n=Ta,Ta=c);Ta!==c?(ka=E,E={type:"number",location:k(),value:Ga}):(n=E,E=c)}else n=E,E=c;B=E;if(B===c){var db=n;var Fb=n;var Lb=a.substr(n,4);Lb.toLowerCase()===Zd?n+=4:(Lb=c,0===fa&&J($d));if(Lb!==c){var Mb=n;fa++;var ae=f();fa--;ae===c?Mb=void 0:(n=Mb,Mb=c);Mb!==c?Fb=Lb=[Lb,Mb]:(n=Fb,Fb=c)}else n=Fb,Fb=c;var mb=Fb;mb!==c&&(ka=db,mb={type:"boolean",location:k(),value:!0});db=mb;if(db===c){db=n;var Gb=n;var Nb=a.substr(n,5);Nb.toLowerCase()===be?n+=5:(Nb=c,0===fa&&J(ce));if(Nb!==
c){var Ob=n;fa++;var de=f();fa--;de===c?Ob=void 0:(n=Ob,Ob=c);Ob!==c?Gb=Nb=[Nb,Ob]:(n=Gb,Gb=c)}else n=Gb,Gb=c;mb=Gb;mb!==c&&(ka=db,mb={type:"boolean",location:k(),value:!1});db=mb}B=db;if(B===c){var ee=n;var Hb=n;var Pb=a.substr(n,4);Pb.toLowerCase()===fe?n+=4:(Pb=c,0===fa&&J(ge));if(Pb!==c){var Qb=n;fa++;var he=f();fa--;he===c?Qb=void 0:(n=Qb,Qb=c);Qb!==c?Hb=Pb=[Pb,Qb]:(n=Hb,Hb=c)}else n=Hb,Hb=c;var Ec=Hb;Ec!==c&&(ka=ee,Ec={type:"null",location:k(),value:null});B=Ec;if(B===c){var nb=n;if(ma()!==
c){ha();var mc=xa();mc!==c?(ka=nb,"string"===mc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(mc.value)&&y("Date literal is invalid"),nb={type:"date",location:k(),value:mc.value}):(n=nb,nb=
c)}else n=nb,nb=c;B=nb;if(B===c){var ob=n;if(la()!==c){ha();var nc=xa();nc!==c?(ka=ob,"string"===nc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(nc.value)&&y("Timestamp literal is invalid"),
ob={type:"timestamp",location:k(),value:nc.value}):(n=ob,ob=c)}else n=ob,ob=c;B=ob;if(B===c){var Ya=n;var Fc=qa();if(Fc!==c){ha();var pb=a.charAt(n);kc.test(pb)?n++:(pb=c,0===fa&&J(lc));if(pb!==c){ha();var Rb=xa();if(Rb!==c){ha();var kd=oa();if(kd!==c){ka=Ya;var ie=pb,je=Rb;Ya={type:"interval",location:k(),value:je,qualifier:kd,op:ie}}else n=Ya,Ya=c}else n=Ya,Ya=c}else n=Ya,Ya=c}else n=Ya,Ya=c;if(Ya===c)if(Ya=n,Fc=qa(),Fc!==c)if(ha(),pb=xa(),pb!==c)if(ha(),Rb=oa(),Rb!==c){ka=Ya;var ke=pb,le=Rb;Ya=
{type:"interval",location:k(),value:ke,qualifier:le,op:""}}else n=Ya,Ya=c;else n=Ya,Ya=c;else n=Ya,Ya=c;B=Ya;if(B===c){var qb=n;if(ua()!==c){ha();var oc=xa();oc!==c?(ka=qb,"string"===oc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(oc.value)&&y("Time literal is invalid"),qb={type:"time",location:k(),value:oc.value}):(n=qb,qb=c)}else n=qb,qb=c;B=qb}}}}}}}var Ka=B;if(Ka===c){var rb=n;if(ea()!==c){ha();var Oa=n;var Gc=Ma();if(Gc!==c){ha();
var Sb=na();if(Sb!==c){ha();var Hc=da();if(Hc!==c){ha();var Tb=b();if(Tb!==c){ha();var Ic=Na();if(Ic!==c){ka=Oa;var me=Sb,ne=Tb;Oa=Ia(k(),me,ne)}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c;if(Oa===c)if(Oa=n,Gc=Ma(),Gc!==c)if(ha(),Sb=na(),Sb!==c)if(ha(),Hc=Xa(),Hc!==c)if(ha(),Tb=b(),Tb!==c)if(ha(),Ic=Na(),Ic!==c){ka=Oa;var oe=Sb,pe=Tb;Oa=Ia(k(),oe,pe)}else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;if(Oa!==c){ka=rb;var qe=Oa;rb={type:"function",
location:k(),name:"extract",args:qe}}else n=rb,rb=c}else n=rb,rb=c;Ka=rb;if(Ka===c){var sb=n;var tb=n;var Jc=a.substr(n,9);Jc.toLowerCase()===re?n+=9:(Jc=c,0===fa&&J(se));if(Jc!==c){var pc=n;fa++;var te=f();fa--;te===c?pc=void 0:(n=pc,pc=c);pc!==c?(ka=tb,tb="SUBSTRING"):(n=tb,tb=c)}else n=tb,tb=c;if(tb!==c){ha();var Ha=n;var Kc=Ma();if(Kc!==c){ha();var Ub=b();if(Ub!==c){ha();var Lc=da();if(Lc!==c){ha();var Vb=b();if(Vb!==c){ha();var jb=n;var ub=n;var Mc=a.substr(n,3);Mc.toLowerCase()===ue?n+=3:(Mc=
c,0===fa&&J(ve));if(Mc!==c){var qc=n;fa++;var we=f();fa--;we===c?qc=void 0:(n=qc,qc=c);qc!==c?(ka=ub,ub="FOR"):(n=ub,ub=c)}else n=ub,ub=c;var rc=ub;if(rc!==c){var Nc=ha();var sc=b();sc!==c?(ha(),jb=sc):(n=jb,jb=c)}else n=jb,jb=c;jb===c&&(jb=null);rc=Na();if(rc!==c){ka=Ha;var xe=Ub,ye=Vb,ld=jb;Ha=Ia(k(),xe,ye,...(ld?[ld]:[]))}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c;if(Ha===c)if(Ha=n,Kc=Ma(),Kc!==c)if(ha(),Ub=b(),Ub!==c)if(ha(),Lc=Xa(),Lc!==c)if(ha(),Vb=b(),Vb!==c)if(ha(),
jb=Xa(),jb!==c)if(rc=ha(),Nc=b(),Nc!==c)if(sc=Na(),sc!==c){ka=Ha;var ze=Ub,Ae=Vb,Be=Nc;Ha=Ia(k(),ze,Ae,Be)}else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;if(Ha!==c){ka=sb;var Ce=Ha;sb={type:"function",location:k(),name:"substring",args:Ce}}else n=sb,sb=c}else n=sb,sb=c;Ka=sb;if(Ka===c){var vb=n;var wb=n;var Oc=a.substr(n,4);Oc.toLowerCase()===De?n+=4:(Oc=c,0===fa&&J(Ee));if(Oc!==c){var tc=n;fa++;var Fe=f();fa--;Fe===c?tc=void 0:(n=tc,tc=c);
tc!==c?(ka=wb,wb="TRIM"):(n=wb,wb=c)}else n=wb,wb=c;if(wb!==c){ha();var Ua=n;var Pc=Ma();if(Pc!==c){ha();var Qc=ia();ha();var Wb=b();if(Wb!==c){ha();var Rc=da();if(Rc!==c){ha();var md=b();if(md!==c){ha();var Ge=Na();if(Ge!==c){ka=Ua;var He=Qc,Ie=Wb;Ua=Ia(k(),He,Ie,md)}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c;if(Ua===c)if(Ua=n,Pc=Ma(),Pc!==c)if(ha(),Qc=ia(),ha(),Wb=b(),Wb!==c)if(ha(),Rc=Na(),Rc!==c){ka=Ua;var Je=Qc,Ke=Wb;Ua=Ia(k(),Je,Ke)}else n=Ua,Ua=c;else n=Ua,Ua=
c;else n=Ua,Ua=c;if(Ua!==c){ka=vb;var Le=Ua;vb={type:"function",location:k(),name:"trim",args:Le}}else n=vb,vb=c}else n=vb,vb=c;Ka=vb;if(Ka===c){var xb=n;var yb=n;var Sc=a.substr(n,8);Sc.toLowerCase()===Me?n+=8:(Sc=c,0===fa&&J(Ne));if(Sc!==c){var uc=n;fa++;var Oe=f();fa--;Oe===c?uc=void 0:(n=uc,uc=c);uc!==c?(ka=yb,yb="POSITION"):(n=yb,yb=c)}else n=yb,yb=c;if(yb!==c){ha();var Pa=n;var Tc=Ma();if(Tc!==c){ha();var Xb=b();if(Xb!==c){ha();var Uc=ba();if(Uc!==c){ha();var Yb=b();if(Yb!==c){ha();var Vc=Na();
if(Vc!==c){ka=Pa;var Pe=Xb,Qe=Yb;Pa=Ia(k(),Pe,Qe)}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c;if(Pa===c)if(Pa=n,Tc=Ma(),Tc!==c)if(ha(),Xb=b(),Xb!==c)if(ha(),Uc=Xa(),Uc!==c)if(ha(),Yb=b(),Yb!==c)if(ha(),Vc=Na(),Vc!==c){ka=Pa;var Re=Xb,Se=Yb;Pa=Ia(k(),Re,Se)}else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;if(Pa!==c){ka=xb;var Te=Pa;xb={type:"function",location:k(),name:"position",args:Te}}else n=xb,xb=c}else n=xb,xb=c;Ka=xb;if(Ka===c){var zb=
n;var Ab=n;var Wc=a.substr(n,4);Wc.toLowerCase()===Ue?n+=4:(Wc=c,0===fa&&J(Ve));if(Wc!==c){var vc=n;fa++;var We=f();fa--;We===c?vc=void 0:(n=vc,vc=c);vc!==c?(ka=Ab,Ab="CAST"):(n=Ab,Ab=c)}else n=Ab,Ab=c;if(Ab!==c){ha();var Qa=n;var Xc=Ma();if(Xc!==c){ha();var Zb=b();if(Zb!==c){ha();var Bb=n;var Yc=a.substr(n,2);Yc.toLowerCase()===Xe?n+=2:(Yc=c,0===fa&&J(Ye));if(Yc!==c){var wc=n;fa++;var Ze=f();fa--;Ze===c?wc=void 0:(n=wc,wc=c);wc!==c?(ka=Bb,Bb="AS"):(n=Bb,Bb=c)}else n=Bb,Bb=c;var Zc=Bb;if(Zc!==c){ha();
var $b=ca();if($b!==c){ha();var $c=Na();if($c!==c){ka=Qa;var $e=Zb,af=$b;Qa=Ia(k(),$e,af)}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c;if(Qa===c)if(Qa=n,Xc=Ma(),Xc!==c)if(ha(),Zb=b(),Zb!==c)if(ha(),Zc=Xa(),Zc!==c)if(ha(),$b=ca(),$b!==c)if(ha(),$c=Na(),$c!==c){ka=Qa;var bf=Zb,cf=$b;Qa=Ia(k(),bf,cf)}else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;if(Qa!==c){ka=zb;var df=Qa;zb={type:"function",location:k(),name:"cast",args:df}}else n=zb,zb=c}else n=
zb,zb=c;Ka=zb;if(Ka===c){var kb;var xc=kb=n;fa++;var yc=ea();fa--;yc===c?xc=void 0:(n=xc,xc=c);if(xc!==c){var eb=n;var ac=R();ac!==c&&(ka=eb);eb=ac;if(eb===c)if(eb=n,96===a.charCodeAt(n)?(ac=nd,n++):(ac=c,0===fa&&J(od)),ac!==c){var zc=[];var ib=a.charAt(n);pd.test(ib)?n++:(ib=c,0===fa&&J(qd));if(ib!==c)for(;ib!==c;)zc.push(ib),ib=a.charAt(n),pd.test(ib)?n++:(ib=c,0===fa&&J(qd));else zc=c;zc!==c?(96===a.charCodeAt(n)?(ib=nd,n++):(ib=c,0===fa&&J(od)),ib!==c?(ka=eb,eb=zc.join("")):(n=eb,eb=c)):(n=eb,
eb=c)}else n=eb,eb=c;yc=eb;if(yc!==c){ha();var rd=v();if(rd!==c){ka=kb;var ef=yc;kb={type:"function",location:k(),name:ef,args:rd}}else n=kb,kb=c}else n=kb,kb=c}else n=kb,kb=c;Ka=kb;if(Ka===c){var Za=n;var ad=Fa();if(ad!==c){ha();var bc=b();if(bc!==c){ha();var cc=[];var Va=n;var fb=Ja();if(fb!==c){var dc=ha();Va=fb}else n=Va,Va=c;for(;Va!==c;)cc.push(Va),Va=n,fb=Ja(),fb!==c?(dc=ha(),Va=fb):(n=Va,Va=c);Va=Ra();if(Va!==c){ka=Za;var ff=bc,gf=cc;Za={type:"case-expression",location:k(),format:"simple",
operand:ff,clauses:gf,else:null,elseLocation:null}}else n=Za,Za=c}else n=Za,Za=c}else n=Za,Za=c;if(Za===c)if(Za=n,ad=Fa(),ad!==c)if(ha(),bc=b(),bc!==c){ha();cc=[];Va=n;fb=Ja();fb!==c?(dc=ha(),Va=fb):(n=Va,Va=c);for(;Va!==c;)cc.push(Va),Va=n,fb=Ja(),fb!==c?(dc=ha(),Va=fb):(n=Va,Va=c);Va=Sa();if(Va!==c)if(fb=ha(),dc=Ra(),dc!==c){ka=Za;var hf=bc,jf=cc,sd=Va;Za={type:"case-expression",location:k(),format:"simple",operand:hf,clauses:jf,else:sd.value,elseLocation:sd.location}}else n=Za,Za=c;else n=Za,Za=
c}else n=Za,Za=c;else n=Za,Za=c;var bd=Za;if(bd===c){var $a=n;var cd=Fa();if(cd!==c){ha();var ec=[];var Wa=n;var gb=Ea();if(gb!==c){var fc=ha();Wa=gb}else n=Wa,Wa=c;for(;Wa!==c;)ec.push(Wa),Wa=n,gb=Ea(),gb!==c?(fc=ha(),Wa=gb):(n=Wa,Wa=c);Wa=Ra();if(Wa!==c){ka=$a;var kf=ec;$a={type:"case-expression",location:k(),format:"searched",clauses:kf,else:null,elseLocation:null}}else n=$a,$a=c}else n=$a,$a=c;if($a===c)if($a=n,cd=Fa(),cd!==c){ha();ec=[];Wa=n;gb=Ea();gb!==c?(fc=ha(),Wa=gb):(n=Wa,Wa=c);for(;Wa!==
c;)ec.push(Wa),Wa=n,gb=Ea(),gb!==c?(fc=ha(),Wa=gb):(n=Wa,Wa=c);Wa=Sa();if(Wa!==c)if(gb=ha(),fc=Ra(),fc!==c){ka=$a;var lf=ec,td=Wa;$a={type:"case-expression",location:k(),format:"searched",clauses:lf,else:td.value,elseLocation:td.location}}else n=$a,$a=c;else n=$a,$a=c}else n=$a,$a=c;bd=$a}Ka=bd;if(Ka===c){var Cb=n;var mf=n;var Ac;var gc=n;var ud=g();if(ud!==c){var vd=[];for(Ac=h();Ac!==c;)vd.push(Ac),Ac=h();ka=gc;gc=ud+vd.join("")}else n=gc,gc=c;var wd=gc;wd!==c&&(ka=mf);var lb=wd;if(lb!==c){ka=Cb;
var hc=lb;lb=/^CURRENT_DATE$/i.test(hc)?{type:"current-time",location:k(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(hc)?{type:"current-time",location:k(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(hc)?{type:"current-time",location:k(),mode:"time"}:/^CURRENT_USER$/i.test(hc)?{type:"current-user",location:k()}:{type:"column-reference",location:k(),table:"",column:hc}}Cb=lb;if(Cb===c){Cb=n;var Db=n;if(P()!==c){var Bc;var nf=n;var dd=[];for(Bc=A();Bc!==c;)dd.push(Bc),Bc=A();ka=nf;var of=dd=dd.join("");var pf=
P();pf!==c?(ka=Db,Db=of):(n=Db,Db=c)}else n=Db,Db=c;lb=Db;if(lb!==c){ka=Cb;var qf=lb;lb={type:"column-reference",location:k(),table:"",column:qf,delimited:!0}}Cb=lb}Ka=Cb;if(Ka===c&&(Ka=X(),Ka===c)){Ka=n;var rf=Ma();if(rf!==c){ha();var ed=b();if(ed!==c){ha();var sf=Na();sf!==c?(ka=Ka,ed.paren=!0,Ka=ed):(n=Ka,Ka=c)}else n=Ka,Ka=c}else n=Ka,Ka=c}}}}}}}}}return Ka}function R(){var B;var E=n;var S=g();if(S!==c){var Y=[];for(B=f();B!==c;)Y.push(B),B=f();ka=E;E=S+Y.join("")}else n=E,E=c;return E}function g(){var B=
a.charAt(n);tf.test(B)?n++:(B=c,0===fa&&J(uf));return B}function f(){var B=a.charAt(n);vf.test(B)?n++:(B=c,0===fa&&J(wf));return B}function h(){var B=a.charAt(n);xd.test(B)?n++:(B=c,0===fa&&J(yd));return B}function A(){var B=a.charAt(n);xd.test(B)?n++:(B=c,0===fa&&J(yd));if(B===c)if(B=n,P()!==c){var E=P();E!==c?(ka=B,B='"'):(n=B,B=c)}else n=B,B=c;return B}function P(){var B=a.charAt(n);xf.test(B)?n++:(B=c,0===fa&&J(yf));return B}function X(){var B;var E=B=n;if(64===a.charCodeAt(n)){var S=zf;n++}else S=
c,0===fa&&J(Af);if(S!==c){var Y=R();Y!==c?E=S=[S,Y]:(n=E,E=c)}else n=E,E=c;E!==c&&(ka=B,B=E,E={type:"parameter",location:k(),value:B[1]});return E}function ca(){var B=n;var E=n;var S=a.substr(n,7);S.toLowerCase()===Bf?n+=7:(S=c,0===fa&&J(Cf));if(S!==c){S=n;fa++;var Y=f();fa--;Y===c?S=void 0:(n=S,S=c);S!==c?(ka=E,E="INTEGER"):(n=E,E=c)}else n=E,E=c;E===c&&(E=n,S=a.substr(n,3),S.toLowerCase()===Df?n+=3:(S=c,0===fa&&J(Ef)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="INT"):(n=E,
E=c)):(n=E,E=c));E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"integer"}});B=E;B===c&&(E=B=n,S=a.substr(n,8),S.toLowerCase()===Ff?n+=8:(S=c,0===fa&&J(Gf)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="SMALLINT"):(n=E,E=c)):(n=E,E=c),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"smallint"}}),B=E,B===c&&(E=B=n,S=a.substr(n,5),S.toLowerCase()===Hf?n+=5:(S=c,0===fa&&J(If)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="FLOAT"):(n=E,E=
c)):(n=E,E=c),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"float"}}),B=E,B===c&&(E=B=n,S=a.substr(n,4),S.toLowerCase()===Jf?n+=4:(S=c,0===fa&&J(Kf)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="REAL"):(n=E,E=c)):(n=E,E=c),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"real"}}),B=E,B===c&&(B=n,E=ma(),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"date"}}),B=E,B===c&&(B=n,E=la(),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"timestamp"}}),
B=E,B===c&&(B=n,E=ua(),E!==c&&(ka=B,E={type:"data-type",location:k(),value:{type:"time"}}),B=E,B===c&&(E=B=n,S=a.substr(n,7),S.toLowerCase()===Lf?n+=7:(S=c,0===fa&&J(Mf)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="VARCHAR"):(n=E,E=c)):(n=E,E=c),E!==c?(ha(),E=Ma(),E!==c?(ha(),E=F(),E!==c?(ha(),S=Na(),S!==c?(ka=B,B={type:"data-type",location:k(),value:{type:"varchar",size:parseInt(E)}}):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c))))))));return B}function ia(){var B=n;var E=n;
var S=a.substr(n,7);S.toLowerCase()===Nf?n+=7:(S=c,0===fa&&J(Of));if(S!==c){S=n;fa++;var Y=f();fa--;Y===c?S=void 0:(n=S,S=c);S!==c?(ka=E,E="LEADING"):(n=E,E=c)}else n=E,E=c;E===c&&(E=n,S=a.substr(n,8),S.toLowerCase()===Pf?n+=8:(S=c,0===fa&&J(Qf)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="TRAILING"):(n=E,E=c)):(n=E,E=c),E===c&&(E=n,S=a.substr(n,4),S.toLowerCase()===Rf?n+=4:(S=c,0===fa&&J(Sf)),S!==c?(S=n,fa++,Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="BOTH"):(n=E,E=
c)):(n=E,E=c)));E===c&&(E=null);ka=B;B=E;return E={type:"string",location:k(),value:null==B?"BOTH":B}}function na(){var B=n;var E=ra();if(E===c&&(E=Ba(),E===c&&(E=ya(),E===c&&(E=Aa(),E===c&&(E=Ca(),E===c&&(E=za(),E===c)))))){E=n;var S=a.substr(n,13);S.toLowerCase()===Tf?n+=13:(S=c,0===fa&&J(Uf));if(S!==c){S=n;fa++;var Y=f();fa--;Y===c?S=void 0:(n=S,S=c);S!==c?(ka=E,E="TIMEZONE_HOUR"):(n=E,E=c)}else n=E,E=c;E===c&&(E=n,S=a.substr(n,15),S.toLowerCase()===Vf?n+=15:(S=c,0===fa&&J(Wf)),S!==c?(S=n,fa++,
Y=f(),fa--,Y===c?S=void 0:(n=S,S=c),S!==c?(ka=E,E="TIMEZONE_MINUTE"):(n=E,E=c)):(n=E,E=c))}E!==c&&(ka=B,B=E,E={type:"string",location:k(),value:B});return E}function oa(){var B=n;var E=n;var S=pa();if(S!==c){ha();var Y=Ma();if(Y!==c)if(ha(),Y=wa(),Y!==c){ha();var ta=Na();ta!==c?(ka=E,E=S,E={type:"interval-period",location:k(),period:E.value,precision:Y,secondary:null}):(n=E,E=c)}else n=E,E=c;else n=E,E=c}else n=E,E=c;E===c&&(E=n,S=pa(),S!==c&&(ka=E,E=S,S={type:"interval-period",location:k(),period:E.value,
precision:null,secondary:null}),E=S);if(E!==c)if(ha(),S=n,Y=a.substr(n,2),Y.toLowerCase()===Xf?n+=2:(Y=c,0===fa&&J(Yf)),Y!==c?(Y=n,fa++,ta=f(),fa--,ta===c?Y=void 0:(n=Y,Y=c),Y!==c?(ka=S,S="TO"):(n=S,S=c)):(n=S,S=c),S!==c){ha();S=n;Y=pa();Y!==c&&(ka=S,S=Y,Y={type:"interval-period",location:k(),period:S.value,precision:null,secondary:null});S=Y;if(S===c){S=n;Y=za();if(Y!==c)if(ha(),Y=Ma(),Y!==c)if(ha(),Y=wa(),Y!==c)if(ha(),ta=Xa(),ta!==c)if(ha(),ta=sa(),ta!==c){ha();var va=Na();va!==c?(ka=S,S=Y,S={type:"interval-period",
location:k(),period:"second",precision:S,secondary:ta}):(n=S,S=c)}else n=S,S=c;else n=S,S=c;else n=S,S=c;else n=S,S=c;else n=S,S=c;S===c&&(S=n,Y=za(),Y!==c?(ha(),Y=Ma(),Y!==c?(ha(),Y=wa(),Y!==c?(ha(),ta=Na(),ta!==c?(ka=S,S=Y,S={type:"interval-period",location:k(),period:"second",precision:S,secondary:null}):(n=S,S=c)):(n=S,S=c)):(n=S,S=c)):(n=S,S=c),S===c&&(S=n,Y=za(),Y!==c&&(ka=S,Y={type:"interval-period",location:k(),period:"second",precision:null,secondary:null}),S=Y))}S!==c?(ka=B,B={type:"interval-qualifier",
location:k(),start:E,end:S}):(n=B,B=c)}else n=B,B=c;else n=B,B=c;B===c&&(B=n,S=pa(),S!==c?(ha(),E=Ma(),E!==c?(ha(),E=sa(),E!==c?(ha(),Y=Na(),Y!==c?(ka=B,B=S,B={type:"interval-period",location:k(),period:B.value,precision:E,secondary:null}):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c),B===c&&(B=n,S=pa(),S!==c&&(ka=B,B=S,S={type:"interval-period",location:k(),period:B.value,precision:null,secondary:null}),B=S,B===c&&(B=n,S=za(),S!==c?(ha(),E=Ma(),E!==c?(ha(),E=wa(),E!==c?(ha(),Y=Xa(),Y!==c?(ha(),S=sa(),
S!==c?(ha(),Y=Na(),Y!==c?(ka=B,B=E,B={type:"interval-period",location:k(),period:"second",precision:B,secondary:S}):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c),B===c&&(B=n,S=za(),S!==c?(ha(),E=Ma(),E!==c?(ha(),E=sa(),E!==c?(ha(),Y=Na(),Y!==c?(ka=B,B=E,B={type:"interval-period",location:k(),period:"second",precision:B,secondary:null}):(n=B,B=c)):(n=B,B=c)):(n=B,B=c)):(n=B,B=c),B===c&&(B=n,S=za(),S!==c&&(ka=B,S={type:"interval-period",location:k(),period:"second",precision:null,
secondary:null}),B=S)))));return B}function pa(){var B=n;var E=ya();E!==c&&(ka=B,E={type:"string",location:k(),value:"day"});B=E;B===c&&(B=n,E=Aa(),E!==c&&(ka=B,E={type:"string",location:k(),value:"hour"}),B=E,B===c&&(B=n,E=Ca(),E!==c&&(ka=B,E={type:"string",location:k(),value:"minute"}),B=E,B===c&&(B=n,E=Ba(),E!==c&&(ka=B,E={type:"string",location:k(),value:"month"}),B=E,B===c&&(B=n,E=ra(),E!==c&&(ka=B,E={type:"string",location:k(),value:"year"}),B=E))));return B}function sa(){var B=n;var E=F();
E!==c&&(ka=B,E=parseFloat(E));return E}function wa(){var B=n;var E=F();E!==c&&(ka=B,E=parseFloat(E));return E}function xa(){var B=Da();B===c&&(B=X());return B}function Da(){var B=n;if(39===a.charCodeAt(n)){var E=zd;n++}else E=c,0===fa&&J(Ad);E===c&&(a.substr(n,2)===Bd?(E=Bd,n+=2):(E=c,0===fa&&J(Zf)));if(E!==c){E=[];var S=n;if(a.substr(n,2)===Cc){var Y=Cc;n+=2}else Y=c,0===fa&&J(Cd);Y!==c&&(ka=S,Y="'");S=Y;S===c&&(S=a.charAt(n),Dd.test(S)?n++:(S=c,0===fa&&J(Ed)));for(;S!==c;)E.push(S),S=n,a.substr(n,
2)===Cc?(Y=Cc,n+=2):(Y=c,0===fa&&J(Cd)),Y!==c&&(ka=S,Y="'"),S=Y,S===c&&(S=a.charAt(n),Dd.test(S)?n++:(S=c,0===fa&&J(Ed)));39===a.charCodeAt(n)?(S=zd,n++):(S=c,0===fa&&J(Ad));S!==c?(ka=B,B={type:"string",location:k(),value:E.join("")}):(n=B,B=c)}else n=B,B=c;return B}function Ea(){var B=n;if(bb()!==c){ha();var E=b();if(E!==c){ha();var S=cb();S!==c?(ha(),S=b(),S!==c?(ka=B,B={type:"when-clause",location:k(),operand:E,value:S}):(n=B,B=c)):(n=B,B=c)}else n=B,B=c}else n=B,B=c;return B}function Ja(){var B=
n;if(bb()!==c){ha();var E=b();if(E!==c){ha();var S=cb();S!==c?(ha(),S=b(),S!==c?(ka=B,B={type:"when-clause",location:k(),operand:E,value:S}):(n=B,B=c)):(n=B,B=c)}else n=B,B=c}else n=B,B=c;return B}function Sa(){var B=n;var E=n;var S=a.substr(n,4);S.toLowerCase()===$f?n+=4:(S=c,0===fa&&J(ag));if(S!==c){S=n;fa++;var Y=f();fa--;Y===c?S=void 0:(n=S,S=c);S!==c?(ka=E,E="ELSE"):(n=E,E=c)}else n=E,E=c;E!==c?(ha(),E=b(),E!==c?(ka=B,B={type:"else-clause",location:k(),value:E}):(n=B,B=c)):(n=B,B=c);return B}
function ab(){var B=F();if(B===c){B=n;var E=a.charAt(n);kc.test(E)?n++:(E=c,0===fa&&J(lc));if(E!==c){var S=F();S!==c?(ka=B,B=E[0]+S):(n=B,B=c)}else n=B,B=c}return B}function La(){var B=n;if(46===a.charCodeAt(n)){var E=bg;n++}else E=c,0===fa&&J(cg);E!==c?(E=F(),E===c&&(E=null),ka=B,B="."+(null!=E?E:"")):(n=B,B=c);return B}function m(){var B;var E=B=n;var S=a.charAt(n);dg.test(S)?n++:(S=c,0===fa&&J(eg));S!==c?(S=a.charAt(n),kc.test(S)?n++:(S=c,0===fa&&J(lc)),S===c&&(S=null),ka=E,E="e"+(null===S?"":
S)):(n=E,E=c);E!==c?(S=F(),S!==c?(ka=B,B=E+S):(n=B,B=c)):(n=B,B=c);return B}function F(){var B=n;var E=[];var S=W();if(S!==c)for(;S!==c;)E.push(S),S=W();else E=c;E!==c&&(ka=B,E=E.join(""));return E}function W(){var B=a.charAt(n);fg.test(B)?n++:(B=c,0===fa&&J(gg));return B}function ba(){var B=n;var E=a.substr(n,2);E.toLowerCase()===hg?n+=2:(E=c,0===fa&&J(ig));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="IN"):(n=B,B=c)}else n=B,B=c;return B}function ja(){var B=n;var E=a.substr(n,
2);E.toLowerCase()===jg?n+=2:(E=c,0===fa&&J(kg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="IS"):(n=B,B=c)}else n=B,B=c;return B}function C(){var B=n;var E=a.substr(n,4);E.toLowerCase()===lg?n+=4:(E=c,0===fa&&J(mg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="LIKE"):(n=B,B=c)}else n=B,B=c;return B}function H(){var B=n;var E=a.substr(n,3);E.toLowerCase()===ng?n+=3:(E=c,0===fa&&J(og));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,
E=c);E!==c?(ka=B,B="NOT"):(n=B,B=c)}else n=B,B=c;return B}function O(){var B=n;var E=a.substr(n,3);E.toLowerCase()===pg?n+=3:(E=c,0===fa&&J(qg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="AND"):(n=B,B=c)}else n=B,B=c;return B}function V(){var B=n;var E=a.substr(n,2);E.toLowerCase()===rg?n+=2:(E=c,0===fa&&J(sg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="OR"):(n=B,B=c)}else n=B,B=c;return B}function aa(){var B=n;var E=a.substr(n,7);E.toLowerCase()===
tg?n+=7:(E=c,0===fa&&J(ug));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="BETWEEN"):(n=B,B=c)}else n=B,B=c;return B}function da(){var B=n;var E=a.substr(n,4);E.toLowerCase()===vg?n+=4:(E=c,0===fa&&J(wg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="FROM"):(n=B,B=c)}else n=B,B=c;return B}function ea(){var B=n;var E=a.substr(n,7);E.toLowerCase()===xg?n+=7:(E=c,0===fa&&J(yg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=
B,B="EXTRACT"):(n=B,B=c)}else n=B,B=c;return B}function la(){var B=n;var E=a.substr(n,9);E.toLowerCase()===zg?n+=9:(E=c,0===fa&&J(Ag));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="TIMESTAMP"):(n=B,B=c)}else n=B,B=c;return B}function ma(){var B=n;var E=a.substr(n,4);E.toLowerCase()===Bg?n+=4:(E=c,0===fa&&J(Cg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="DATE"):(n=B,B=c)}else n=B,B=c;return B}function ua(){var B=n;var E=a.substr(n,4);E.toLowerCase()===
Dg?n+=4:(E=c,0===fa&&J(Eg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="TIME"):(n=B,B=c)}else n=B,B=c;return B}function qa(){var B=n;var E=a.substr(n,8);E.toLowerCase()===Fg?n+=8:(E=c,0===fa&&J(Gg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="INTERVAL"):(n=B,B=c)}else n=B,B=c;return B}function ra(){var B=n;var E=a.substr(n,4);E.toLowerCase()===Hg?n+=4:(E=c,0===fa&&J(Ig));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=
B,B="YEAR"):(n=B,B=c)}else n=B,B=c;return B}function Ba(){var B=n;var E=a.substr(n,5);E.toLowerCase()===Jg?n+=5:(E=c,0===fa&&J(Kg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="MONTH"):(n=B,B=c)}else n=B,B=c;return B}function ya(){var B=n;var E=a.substr(n,3);E.toLowerCase()===Lg?n+=3:(E=c,0===fa&&J(Mg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="DAY"):(n=B,B=c)}else n=B,B=c;return B}function Aa(){var B=n;var E=a.substr(n,4);E.toLowerCase()===
Ng?n+=4:(E=c,0===fa&&J(Og));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="HOUR"):(n=B,B=c)}else n=B,B=c;return B}function Ca(){var B=n;var E=a.substr(n,6);E.toLowerCase()===Pg?n+=6:(E=c,0===fa&&J(Qg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="MINUTE"):(n=B,B=c)}else n=B,B=c;return B}function za(){var B=n;var E=a.substr(n,6);E.toLowerCase()===Rg?n+=6:(E=c,0===fa&&J(Sg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=
B,B="SECOND"):(n=B,B=c)}else n=B,B=c;return B}function Fa(){var B=n;var E=a.substr(n,4);E.toLowerCase()===Tg?n+=4:(E=c,0===fa&&J(Ug));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="CASE"):(n=B,B=c)}else n=B,B=c;return B}function Ra(){var B=n;var E=a.substr(n,3);E.toLowerCase()===Vg?n+=3:(E=c,0===fa&&J(Wg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="END"):(n=B,B=c)}else n=B,B=c;return B}function bb(){var B=n;var E=a.substr(n,4);E.toLowerCase()===
Xg?n+=4:(E=c,0===fa&&J(Yg));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="WHEN"):(n=B,B=c)}else n=B,B=c;return B}function cb(){var B=n;var E=a.substr(n,4);E.toLowerCase()===Zg?n+=4:(E=c,0===fa&&J($g));if(E!==c){E=n;fa++;var S=f();fa--;S===c?E=void 0:(n=E,E=c);E!==c?(ka=B,B="THEN"):(n=B,B=c)}else n=B,B=c;return B}function Xa(){if(44===a.charCodeAt(n)){var B=ah;n++}else B=c,0===fa&&J(bh);return B}function Ma(){if(40===a.charCodeAt(n)){var B=ch;n++}else B=c,0===fa&&J(dh);
return B}function Na(){if(41===a.charCodeAt(n)){var B=eh;n++}else B=c,0===fa&&J(fh);return B}function ha(){var B;var E=[];for(B=ic();B!==c;)E.push(B),B=ic();return E}function ic(){var B=a.charAt(n);gh.test(B)?n++:(B=c,0===fa&&J(hh));return B}function Kb(B,E,S,Y,ta){B={type:"binary-expression",location:ta,operator:B,left:E,right:S};void 0!==Y&&(B.escape=Y);return B}function Ia(B,...E){return{type:"expression-list",location:B,value:E}}function Ib(B,E){for(const {op:S,expr:Y,location:{end:ta}}of E)B=
Kb(S,B,Y,void 0,{...B.location,end:ta});return B}p=void 0!==p?p:{};var c={},Hd=p.grammarSource,Fd={start:K},Gd=K,Id="!",Kd="\x3d",fd="\x3e\x3d",Pd="\x3e",gd="\x3c\x3d",hd="\x3c\x3e",id="!\x3d",jd="||",zf="@",zd="'",Bd="N'",Cc="''",bg=".",fe="null",Zd="true",be="false",hg="in",jg="is",lg="like",Md="escape",ng="not",pg="and",rg="or",tg="between",vg="from",ue="for",re="substring",xg="extract",De="trim",Me="position",zg="timestamp",Bg="date",Dg="time",Nf="leading",Pf="trailing",Rf="both",Ue="cast",Xe=
"as",Bf="integer",Df="int",Ff="smallint",Hf="float",Jf="real",Lf="varchar",Xf="to",Fg="interval",Hg="year",Tf="timezone_hour",Vf="timezone_minute",Jg="month",Lg="day",Ng="hour",Pg="minute",Rg="second",Tg="case",Vg="end",Xg="when",Zg="then",$f="else",ah=",",ch="(",eh=")",nd="`",Td=/^[<-=]/,kc=/^[+\-]/,Xd=/^[*\/]/,tf=/^[A-Za-z_\x80-\uFFFF]/,vf=/^[A-Za-z0-9_]/,xd=/^[A-Za-z0-9_.\x80-\uFFFF]/,xf=/^["]/,Dd=/^[^']/,fg=/^[0-9]/,dg=/^[eE]/,gh=/^[ \t\n\r]/,pd=/^[^`]/,Jd=w("!",!1),Ld=w("\x3d",!1),Od=w("\x3e\x3d",
!1),Qd=w("\x3e",!1),Rd=w("\x3c\x3d",!1),Sd=w("\x3c\x3e",!1),Ud=I([["\x3c","\x3d"]],!1,!1),Vd=w("!\x3d",!1),lc=I(["+","-"],!1,!1),Wd=w("||",!1),Yd=I(["*","/"],!1,!1),uf=I([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),wf=I([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),yd=I([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),yf=I(['"'],!1,!1),Af=w("@",!1),Ad=w("'",!1),Zf=w("N'",!1),Cd=w("''",!1),Ed=I(["'"],!0,!1),cg=w(".",!1),gg=I([["0","9"]],!1,!1),eg=I(["e","E"],!1,!1),ge=w("NULL",
!0),$d=w("TRUE",!0),ce=w("FALSE",!0),ig=w("IN",!0),kg=w("IS",!0),mg=w("LIKE",!0),Nd=w("ESCAPE",!0),og=w("NOT",!0),qg=w("AND",!0),sg=w("OR",!0),ug=w("BETWEEN",!0),wg=w("FROM",!0),ve=w("FOR",!0),se=w("SUBSTRING",!0),yg=w("EXTRACT",!0),Ee=w("TRIM",!0),Ne=w("POSITION",!0),Ag=w("TIMESTAMP",!0),Cg=w("DATE",!0),Eg=w("TIME",!0),Of=w("LEADING",!0),Qf=w("TRAILING",!0),Sf=w("BOTH",!0),Ve=w("CAST",!0),Ye=w("AS",!0),Cf=w("INTEGER",!0),Ef=w("INT",!0),Gf=w("SMALLINT",!0),If=w("FLOAT",!0),Kf=w("REAL",!0),Mf=w("VARCHAR",
!0),Yf=w("TO",!0),Gg=w("INTERVAL",!0),Ig=w("YEAR",!0),Uf=w("TIMEZONE_HOUR",!0),Wf=w("TIMEZONE_MINUTE",!0),Kg=w("MONTH",!0),Mg=w("DAY",!0),Og=w("HOUR",!0),Qg=w("MINUTE",!0),Sg=w("SECOND",!0),Ug=w("CASE",!0),Wg=w("END",!0),Yg=w("WHEN",!0),$g=w("THEN",!0),ag=w("ELSE",!0),bh=w(",",!1),dh=w("(",!1),fh=w(")",!1),hh=I([" ","\t","\n","\r"],!1,!1),od=w("`",!1),qd=I(["`"],!0,!1),n=p.peg$currPos|0,ka=n,Eb=[{line:1,column:1}],hb=n,jc=p.peg$maxFailExpected||[],fa=p.peg$silentFails|0;if(p.startRule){if(!(p.startRule in
Fd))throw Error("Can't start parsing from rule \""+p.startRule+'".');Gd=Fd[p.startRule]}var Dc=Gd();if(p.peg$library)return{peg$result:Dc,peg$currPos:n,peg$FAILED:c,peg$maxFailExpected:jc,peg$maxFailPos:hb};if(Dc!==c&&n===a.length)return Dc;Dc!==c&&n<a.length&&J({type:"end"});throw function(B,E,S){return new l(l.buildMessage(B,E),B,E,S)}(jc,hb<a.length?a.charAt(hb):null,hb<a.length?r(hb,hb+1):r(hb,hb));}function t(a,p){if(null!=a)switch(p(a),a.type){case "when-clause":t(a.operand,p);t(a.value,p);
break;case "case-expression":for(const k of a.clauses)t(k,p);"simple"===a.format&&t(a.operand,p);null!==a.else&&t(a.else,p);break;case "expression-list":for(const k of a.value)t(k,p);break;case "unary-expression":t(a.expr,p);break;case "binary-expression":t(a.left,p);t(a.right,p);break;case "function":t(a.args,p);break;case "interval":t(a.value,p);t(a.qualifier,p);break;case "interval-qualifier":t(a.start,p),t(a.end,p)}}(function(a,p){function k(){this.constructor=a}k.prototype=p.prototype;a.prototype=
new k})(l,Error);l.prototype.format=function(a){var p="Error: "+this.message;if(this.location){var k=null,y;for(y=0;y<a.length;y++)if(a[y].source===this.location.source){k=a[y].text.split(/\r\n|\n|\r/g);break}a=this.location.start;y=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(a):a;var w=this.location.source+":"+y.line+":"+y.column;if(k){var I=this.location.end,G=x("",y.line.toString().length," ");k=k[a.line-1];I=(a.line===I.line?I.column:k.length+
1)-a.column||1;p+="\n --\x3e "+w+"\n"+G+" |\n"+y.line+" | "+k+"\n"+G+" | "+x("",a.column-1," ")+x("",I,"^")}else p+="\n at "+w}return p};l.buildMessage=function(a,p){function k(r){return r.charCodeAt(0).toString(16).toUpperCase()}function y(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+k(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+k(J)})}function w(r){return r.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+k(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+k(J)})}function I(r){return G[r.type](r)}var G={literal:function(r){return'"'+y(r.text)+'"'},class:function(r){var J=r.parts.map(function(K){return Array.isArray(K)?w(K[0])+"-"+w(K[1]):w(K)});return"["+(r.inverted?"^":"")+J.join("")+"]"},
any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};return"Expected "+function(r){r=r.map(I);var J,K;r.sort();if(0<r.length){for(K=J=1;J<r.length;J++)r[J-1]!==r[J]&&(r[K]=r[J],K++);r.length=K}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(a)+" but "+(p?'"'+y(p)+'"':"end of input")+" found."};class N{static parse(a){return D(a)}}e.WhereGrammar=N;e.visitAll=
t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(e,l){l=new l.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});e.kebabDict=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCache":function(){define(["exports"],function(e){class l{constructor(){this._storage=new Map;this._purgeInterval=5;this._sweep=()=>{this._timer=void 0;if(this._storage){var t=
1E3*this._purgeInterval,N=performance.now()-t;for(const [a,p]of this._storage)if(p.time<N)this._storage.delete(a);else{0<this._storage.size&&(this._timer=setTimeout(this._sweep,t));break}}}}destroy(){this._storage?.clear();this._storage=null;clearTimeout(this._timer)}get size(){return this._storage?.size??0}put(t,N){this._storage?.set(t,new D(N));this._scheduleSweep()}get(t){if(this._storage){var N=this._storage?.get(t);if(N)return this._storage?.delete(t),N.time=performance.now(),this._storage?.set(t,
N),N.items}}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??(this._timer=setTimeout(this._sweep,1E3*this._purgeInterval)))}}let x=0;class D{constructor(t){this.items=t;this.time=performance.now();this.id=x++}}e.QueryEngineCache=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(e){e.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,
supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G){function r(b,q,L,d){const z=d.x-L.x;d=d.y-L.y;q=Math.min(1,Math.max(0,((q.x-L.x)*z+(q.y-L.y)*d)/(z*z+d*d)));b.x=L.x+z*q;b.y=L.y+d*q}function J(b,q){return b?q?4:3:q?3:2}class K{constructor(b,q,L){this.items=b;this.query=q;this.geometryType=L.geometryType;this.hasM=L.hasM;this.hasZ=L.hasZ;this.fieldsIndex=L.fieldsIndex;this.objectIdField=L.objectIdField;this.spatialReference=L.spatialReference;this.featureAdapter=L.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const b=
new p(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return b.countDistinctValues(this.items);const {groupByFieldsForStatistics:q,having:L,outStatistics:d}=this.query;if(!q?.length)return 1;const z=new Map,M=new Map,Q=new Set;for(const T of d){var {statisticType:Z}=T;Z="exceedslimit"!==Z?T.onStatisticField:void 0;if(!M.has(Z)){var U=[];for(const u of q){const R=this._getAttributeValues(b,u,z);U.push(R)}M.set(Z,this._calculateUniqueValues(U,b.returnDistinctValues))}Z=
M.get(Z);for(const u in Z){const {data:R,items:g}=Z[u];U=R.join(",");L&&!b.validateItems(g,L)||Q.add(U)}}return Q.size}async createQueryResponse(){let b;b=this.query.outStatistics?this.query.outStatistics.some(q=>"exceedslimit"===q.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const q=this.query.geometry;a.isValid(this.query.outSR)&&!a.equals(q.spatialReference,
this.query.outSR)?b.queryGeometry=k.cleanFromGeometryEngine({spatialReference:this.query.outSR,...y.project(q,q.spatialReference,this.query.outSR)}):b.queryGeometry=k.cleanFromGeometryEngine({spatialReference:this.query.outSR,...q})}return b}createSnappingResponse(b,q){const L=this.featureAdapter,d=J(this.hasZ,this.hasM),{point:z,mode:M}=b,Q="number"===typeof b.distance?b.distance:b.distance.x,Z="number"===typeof b.distance?b.distance:b.distance.y,U={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
q=this._getPointCreator(M,this.spatialReference,q);const u=new v(null,0),R=new v(null,0),g={x:0,y:0,z:0};for(const ia of this.items){var f=L.getGeometry(ia);if(null==f)continue;const {coords:na,lengths:oa}=f;u.coords=na;R.coords=na;if(b.returnEdge){f=0;for(var h=0;h<oa.length;h++){var A=oa[h];for(var P=0;P<A;P++,f+=d){var X=u;X.coordsIndex=f;if(P!==A-1){const pa=R;pa.coordsIndex=f+d;const sa=g;r(g,z,X,pa);var ca=(z.x-sa.x)/Q;const wa=(z.y-sa.y)/Z;ca=ca*ca+wa*wa;1>=ca&&U.candidates.push(w.makeEdgeCandidate(L.getObjectId(ia),
q(sa),Math.sqrt(ca),q(X),q(pa)))}}}}if("none"!==b.vertexMode)if(f=T?na.length-d:na.length,"all"===b.vertexMode)for(h=0;h<f;h+=d)A=u,A.coordsIndex=h,P=(z.x-A.x)/Q,X=(z.y-A.y)/Z,P=P*P+X*X,1>=P&&U.candidates.push(w.makeVertexCandidate(L.getObjectId(ia),q(A),Math.sqrt(P)));else if("ends"===b.vertexMode){f=[0];T||f.push(na.length-d);for(const pa of f)f=u,f.coordsIndex=pa,h=(z.x-f.x)/Q,A=(z.y-f.y)/Z,h=h*h+A*A,1>=h&&U.candidates.push(w.makeVertexCandidate(L.getObjectId(ia),q(f),Math.sqrt(h)))}}U.candidates.sort((ia,
na)=>ia.distance-na.distance);return U}_getPointCreator(b,q,L){const d=null==L||a.equals(q,L)?M=>M:M=>y.project(M,q,L),{hasZ:z}=this;return"3d"===b?z?({x:M,y:Q,z:Z})=>d({x:M,y:Q,z:Z}):({x:M,y:Q})=>d({x:M,y:Q,z:0}):({x:M,y:Q})=>d({x:M,y:Q})}async createSummaryStatisticsResponse(b){const {field:q,valueExpression:L,normalizationField:d,normalizationType:z,normalizationTotal:M,minValue:Q,maxValue:Z,scale:U,timeZone:T,outStatisticTypes:u}=b;var R=this.fieldsIndex.get(q);b=I.isDateField(R)||I.isDateOnlyField(R)||
I.isTimestampOffsetField(R);const g=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:z,normalizationTotal:M,scale:U,timeZone:T}),f=G.isNullCountSupported({normalizationType:z,normalizationField:d,minValue:Q,maxValue:Z}),h={value:.5,fieldType:R?.type};R=I.isStringField(R)?G.calculateStringStatistics({values:g,supportsNullCount:f,percentileParams:h,outStatisticTypes:u}):G.calculateStatistics({values:g,minValue:Q,maxValue:Z,useSampleStdDev:!z,supportsNullCount:f,
percentileParams:h,outStatisticTypes:u});return G.processSummaryStatisticsResult(R,u,b)}async createUniqueValuesResponse(b){const {field:q,valueExpression:L,domains:d,returnAllCodedValues:z,scale:M,timeZone:Q}=b;var Z=await this._getDataValues({field:q,field2:b.field2,field3:b.field3,fieldDelimiter:b.fieldDelimiter,valueExpression:L,scale:M,timeZone:Q},!1);Z=G.calculateUniqueValuesCount(Z);return G.createUVResult(Z,d,z,b.fieldDelimiter)}async createClassBreaksResponse(b){const {field:q,valueExpression:L,
normalizationField:d,normalizationType:z,normalizationTotal:M,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numClasses:u,scale:R,timeZone:g}=b;b=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:z,normalizationTotal:M,scale:R,timeZone:g});b=G.calculateClassBreaks(b,{field:q,normalizationField:d,normalizationType:z,normalizationTotal:M,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numClasses:u});return G.resolveCBResult(b,
Q)}async createHistogramResponse(b){const {field:q,valueExpression:L,normalizationField:d,normalizationType:z,normalizationTotal:M,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numBins:u,scale:R,timeZone:g}=b;b=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:z,normalizationTotal:M,scale:R,timeZone:g});return G.calculateHistogram(b,{field:q,normalizationField:d,normalizationType:z,normalizationTotal:M,classificationMethod:Q,standardDeviationInterval:Z,
minValue:U,maxValue:T,numBins:u})}_sortFeatures(b,q,L){if(1<b.length&&q?.length)for(const d of q.reverse()){q=d.split(" ");const z=q[0],M=this.fieldsIndex.get(z);q=q[1]?"desc"===q[1].toLowerCase():!1;const Q=G.getAttributeComparator(M?.type,q);b.sort((Z,U)=>{Z=L(Z,z,M);U=L(U,z,M);return Q(Z,U)})}}_createFeatureQueryResponse(b){const q=this.items,{geometryType:L,hasM:d,hasZ:z,objectIdField:M,spatialReference:Q}=this,{outFields:Z,outSR:U,quantizationParameters:T,resultRecordCount:u,resultOffset:R,returnZ:g,
returnM:f}=b,h=null!=u?q.length>(R||0)+u:!1,A=Z&&(Z.includes("*")?[...this.fieldsIndex.fields]:Z.map(P=>this.fieldsIndex.get(P)));return{exceededTransferLimit:h,features:this._createFeatures(b,q),fields:A,geometryType:L,hasM:d&&f,hasZ:z&&g,objectIdFieldName:M,spatialReference:k.cleanFromGeometryEngine(U||Q),transform:T&&N.toQuantizationTransform(T)||null}}_createFeatures(b,q){const L=new p(b,this.featureAdapter,this.fieldsIndex),{hasM:d,hasZ:z}=this,{orderByFields:M,quantizationParameters:Q,returnGeometry:Z,
returnCentroid:U,maxAllowableOffset:T,resultOffset:u,resultRecordCount:R,returnZ:g=!1,returnM:f=!1}=b,h=z&&g,A=d&&f;b=[];var P=0;const X=[...q];this._sortFeatures(X,M,(pa,sa,wa)=>L.getFieldValue(pa,sa,wa));if(this.geometryType&&(Z||U)){var ca=N.toQuantizationTransform(Q)??void 0;q="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(Z&&!U)for(var ia of X){var na=this.featureAdapter.getGeometry(ia),oa={attributes:L.getAttributes(ia),geometry:k.getGeometry(this.geometryType,
this.hasZ,this.hasM,na,T,ca,h,A)};q&&na&&!oa.geometry&&(oa.centroid=k.transformCentroid(this,this.featureAdapter.getCentroid(ia,this),ca));b[P++]=oa}else if(!Z&&U)for(na of X)b[P++]={attributes:L.getAttributes(na),centroid:k.transformCentroid(this,this.featureAdapter.getCentroid(na,this),ca)};else for(oa of X)b[P++]={attributes:L.getAttributes(oa),centroid:k.transformCentroid(this,this.featureAdapter.getCentroid(oa,this),ca),geometry:k.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(oa),
T,ca,h,A)}}else for(ca of X)(ia=L.getAttributes(ca))&&(b[P++]={attributes:ia});P=u||0;null!=R&&(b=b.slice(P,Math.min(b.length,P+R)));return b}_createExceedsLimitQueryResponse(b){var q=!1;let L=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY;q=Number.POSITIVE_INFINITY;for(const z of b.outStatistics??[])if("exceedslimit"===z.statisticType){L=null!=z.maxPointCount?z.maxPointCount:Number.POSITIVE_INFINITY;d=null!=z.maxRecordCount?z.maxRecordCount:Number.POSITIVE_INFINITY;q=null!=z.maxVertexCount?
z.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)q=this.items.length>L;else if(this.items.length>d)q=!0;else{b=J(this.hasZ,this.hasM);const z=this.featureAdapter;q=this.items.reduce((M,Q)=>{Q=z.getGeometry(Q);return M+(null!=Q&&Q.coords.length||0)},0)/b>q}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(q)}}]}}async _createStatisticsQueryResponse(b){var q=
{attributes:{}};const L=[],d=new Map,z=new Map,M=new Map,Q=new Map,Z=new p(b,this.featureAdapter,this.fieldsIndex);var U=b.outStatistics;const {groupByFieldsForStatistics:T,having:u,orderByFields:R,resultRecordCount:g}=b;b=T?.length;const f=!!b,h=f?T[0]:null,A=f&&!this.fieldsIndex.get(h);for(const na of U??[]){const {outStatisticFieldName:oa,statisticType:pa}=na;U=na;const sa="exceedslimit"!==pa?na.onStatisticField:void 0,wa="percentile_disc"===pa||"percentile_cont"===pa;var P="EnvelopeAggregate"===
pa||"CentroidAggregate"===pa||"ConvexHullAggregate"===pa;const xa=f&&1===b&&(sa===h||A)&&"count"===pa;if(f){if(!M.has(sa)){var X=[];for(const Da of T){var ca=this._getAttributeValues(Z,Da,d);X.push(ca)}M.set(sa,this._calculateUniqueValues(X,P?!1:Z.returnDistinctValues))}X=M.get(sa);if(!X)continue;ca=Object.keys(X);for(const Da of ca){const {count:Ea,data:Ja,items:Sa,itemPositions:ab}=X[Da];ca=Ja.join(",");if(!u||Z.validateItems(Sa,u)){const La=Q.get(ca)||{attributes:{}};if(P){La.aggregateGeometries||
(La.aggregateGeometries={});const {aggregateGeometries:F,outStatisticFieldName:W}=await this._getAggregateGeometry(U,Sa);La.aggregateGeometries[W]=F}else{var ia=null;if(xa)ia=Ea;else{const F=this._getAttributeValues(Z,sa,d);ia=ab.map(W=>F[W]);ia=wa&&"statisticParameters"in U?this._getPercentileValue(U,ia):this._getStatisticValue(U,ia,null,Z.returnDistinctValues)}La.attributes[oa]=ia}let m=0;T.forEach((F,W)=>La.attributes[this.fieldsIndex.get(F)?F:`EXPR_${++m}`]=Ja[W]);Q.set(ca,La)}}}else if(P){q.aggregateGeometries||
(q.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ea}=await this._getAggregateGeometry(U,this.items);q.aggregateGeometries[Ea]=Da}else P=this._getAttributeValues(Z,sa,d),q.attributes[oa]=wa&&"statisticParameters"in U?this._getPercentileValue(U,P):this._getStatisticValue(U,P,z,Z.returnDistinctValues);U="min"!==pa&&"max"!==pa||!I.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;L.push({name:oa,alias:oa,type:U||"esriFieldTypeDouble"})}q=
f?Array.from(Q.values()):[q];this._sortFeatures(q,R,(na,oa)=>na.attributes[oa]);g&&(q.length=Math.min(g,q.length));return{fields:L,features:q}}_isAnyDateField(b){b=this.fieldsIndex.get(b);return I.isDateField(b)||I.isDateOnlyField(b)||I.isTimestampOffsetField(b)||I.isTimeOnlyField(b)}async _getAggregateGeometry(b,q){const {convexHull:L,union:d}=await new Promise((g,f)=>e(["../../../geometry/geometryEngineJSON"],g,f)),{statisticType:z,outStatisticFieldName:M}=b,{featureAdapter:Q,spatialReference:Z,
geometryType:U,hasZ:T,hasM:u}=this;q=q.map(g=>k.getGeometry(U,T,u,Q.getGeometry(g)));const R=L(Z,q,!0)[0];b={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===z?(q=R?t.getPolygonExtent(R):t.getGeometryExtent(d(Z,q)),b.aggregateGeometries={...q,spatialReference:Z},b.outStatisticFieldName=M||"extent"):"CentroidAggregate"===z?(q=R?D.polygonCentroid(R):D.extentCentroid(t.getGeometryExtent(d(Z,q))),b.aggregateGeometries={x:q[0],y:q[1],spatialReference:Z},b.outStatisticFieldName=
M||"centroid"):"ConvexHullAggregate"===z&&(b.aggregateGeometries=R,b.outStatisticFieldName=M||"convexHull");return b}_getStatisticValue(b,q,L,d){const {onStatisticField:z,statisticType:M}=b;b=null;b=L?.has(z)?L.get(z):I.isStringField(this.fieldsIndex.get(z))||this._isAnyDateField(z)?G.calculateStringStatistics({values:q,returnDistinct:d}):G.calculateStatistics({values:d?[...(new Set(q))]:q,minValue:null,maxValue:null,useSampleStdDev:!0});L&&L.set(z,b);return b["var"===M?"variance":M]}_getPercentileValue(b,
q){const {onStatisticField:L,statisticParameters:d,statisticType:z}=b,{value:M,orderBy:Q}=d;b=this.fieldsIndex.get(L);return G.calculatePercentile(q,{value:M,orderBy:Q,fieldType:b?.type,isDiscrete:"percentile_disc"===z})}_getAttributeValues(b,q,L){if(L.has(q))return L.get(q);const d=this.fieldsIndex.get(q),z=this.items.map(M=>b.getFieldValue(M,q,d));L.set(q,z);return z}_calculateUniqueValues(b,q){const L={},d=this.items,z=d.length;for(let M=0;M<z;M++){const Q=d[M],Z=[];for(const T of b)Z.push(T[M]);
const U=Z.join(",");null==L[U]?L[U]={count:1,data:Z,items:[Q],itemPositions:[M]}:(q||L[U].count++,L[U].items.push(Q),L[U].itemPositions.push(M))}return L}async _getDataValues(b,q=!0){const L=new p(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:d,scale:z,timeZone:M}=b;return d?L.getExpressionValues(this.items,d,{viewingMode:"map",scale:z,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},M):L.getDataValues(this.items,
x.clone(b),q)}}class v{constructor(b,q){this.coords=b;this.coordsIndex=q}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}l.QueryEngineResult=K;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(e,l){function x(g){if("lowerLeft"===g.originPosition&&4===g.scale.length&&4===g.translate.length)return g;const {originPosition:f,
scale:h,translate:A}=g;g=h[1]??1;return{originPosition:"lowerLeft",scale:[h[0]??1,"lowerLeft"===f?g:-g,h[2]??1,h[3]??1],translate:[A[0]??0,A[1]??0,A[2]??0,A[3]??0]}}function D({scale:g,translate:f},h){return Math.round((h-f[0])/g[0])}function t({scale:g,translate:f},h){return Math.round((h-f[1])/g[1])}function N({scale:g,translate:f},h){return Math.round(((h??0)-f[2])/g[2])}function a({scale:g,translate:f},h){return h?Math.round((h-f[3])/g[3]):0}function p(g,f){return g&&f?Z:g&&!f?M:!g&&f?Q:z}function k({scale:g,
translate:f},h){return h*g[0]+f[0]}function y({scale:g,translate:f},h){return h*g[1]+f[1]}function w({scale:g,translate:f},h){return(h??0)*g[2]+f[2]}function I({scale:g,translate:f},h){return h?h*g[3]+f[3]:0}function G(g,f){return g&&f?R:g&&!f?T:!g&&f?u:U}function r(g,f,h){const A=Array(h.length);for(let P=0;P<h.length;P++)A[P]=f(g,h[P]);return A}function J(g,f,h){let [A,P]=h[0],X=Math.min(A,f[0]),ca=Math.min(P,f[1]),ia=Math.max(A,f[2]);f=Math.max(P,f[3]);for(let na=1;na<h.length;na++){const [oa,
pa]=h[na];A+=oa;P+=pa;0>oa&&(X=Math.min(X,A));0<oa&&(ia=Math.max(ia,A));0>pa?ca=Math.min(ca,P):0<pa&&(f=Math.max(f,P))}g[0]=X;g[1]=ca;g[2]=ia;g[3]=f;return g}function K(g,f){if(!f.length)return null;g[0]=g[1]=Number.POSITIVE_INFINITY;g[2]=g[3]=Number.NEGATIVE_INFINITY;for(let h=0;h<f.length;h++)J(g,g,f[h]);return g}function v(g,f,h){g=x(g);f.xmin=D(g,h.xmin);f.ymin=t(g,h.ymin);f.xmax=D(g,h.xmax);f.ymax=t(g,h.ymax);h.hasZ&&(f.zmin=N(g,h.zmin),f.zmax=N(g,h.zmax));h.hasM&&(f.mmin=a(g,h.mmin),f.mmax=
a(g,h.mmax));f.hasZ=h.hasZ??!1;f.hasM=h.hasM??!1;return f}function b(g,f,h){g=x(g);f.points=p(h.hasZ,h.hasM)(g,h.points)??[];f.hasZ=h.hasZ??!1;f.hasM=h.hasM??!1;return f}function q(g,f,h){g=x(g);f.x=D(g,h.x);f.y=t(g,h.y);null!=h.z&&(f.z=N(g,h.z));null!=h.m&&(f.m=a(g,h.m));return f}function L(g,f,h){{g=x(g);var A=h.rings;const P=[],X=p(h.hasZ,h.hasM);for(let ca=0;ca<A.length;ca++){const ia=X(g,A[ca]);ia&&3<=ia.length&&P.push(ia)}g=P.length?P:null}if(!g)return null;f.rings=g;f.hasZ=h.hasZ??!1;f.hasM=
h.hasM??!1;return f}function d(g,f,h){{g=x(g);var A=h.paths;const P=[],X=p(h.hasZ,h.hasM);for(let ca=0;ca<A.length;ca++){const ia=X(g,A[ca]);ia&&2<=ia.length&&P.push(ia)}g=P.length?P:null}if(!g)return null;f.paths=g;f.hasZ=h.hasZ??!1;f.hasM=h.hasM??!1;return f}const z=(g,f)=>{const h=[];if(!f.length)return null;var A=f[0];let P=D(g,A[0]);A=t(g,A[1]);h.push([P,A]);for(let X=1;X<f.length;X++){const [ca,ia]=f[X],na=D(g,ca),oa=t(g,ia);na===P&&oa===A||h.push([na-P,oa-A]);P=na;A=oa}return h},M=(g,f)=>{const h=
[];if(!f.length)return null;var A=f[0];let P=D(g,A[0]),X=t(g,A[1]);A=N(g,A[2]);h.push([P,X,A]);for(let ca=1;ca<f.length;ca++){const [ia,na,oa]=f[ca],pa=D(g,ia),sa=t(g,na),wa=N(g,oa);pa===P&&sa===X&&wa===A||h.push([pa-P,sa-X,wa]);P=pa;X=sa;A=wa}return h},Q=(g,f)=>{const h=[];if(!f.length)return null;var A=f[0];let P=D(g,A[0]),X=t(g,A[1]);A=a(g,A[2]);h.push([P,X,A]);for(let ca=1;ca<f.length;ca++){const [ia,na,oa]=f[ca],pa=D(g,ia),sa=t(g,na),wa=a(g,oa);pa===P&&sa===X&&wa===A||h.push([pa-P,sa-X,wa]);
P=pa;X=sa;A=wa}return h},Z=(g,f)=>{const h=[];if(!f.length)return null;var A=f[0];let P=D(g,A[0]),X=t(g,A[1]),ca=N(g,A[2]);A=a(g,A[3]);h.push([P,X,ca,A]);for(let ia=1;ia<f.length;ia++){const [na,oa,pa,sa]=f[ia],wa=D(g,na),xa=t(g,oa),Da=N(g,pa),Ea=a(g,sa);wa===P&&xa===X&&Da===ca&&Ea===A||h.push([wa-P,xa-X,Da,Ea]);P=wa;X=xa;ca=Da;A=Ea}return h},U=(g,f)=>{const h=Array(f.length);if(!f.length)return h;var A=f[0];let P=k(g,A[0]);A=y(g,A[1]);h[0]=[P,A];const {scale:X,originPosition:ca}=g;g=X[0];const ia=
"lowerLeft"===ca?X[1]:-X[1];for(let na=1;na<f.length;na++){const [oa,pa]=f[na];P+=g*oa;A+=ia*pa;h[na]=[P,A]}return h},T=(g,f)=>{const h=Array(f.length);if(!f.length)return h;var A=f[0];let P=k(g,A[0]),X=y(g,A[1]);h[0]=[P,X,w(g,A[2])];const {scale:ca,originPosition:ia}=g;A=ca[0];const na="lowerLeft"===ia?ca[1]:-ca[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa]=f[oa];P+=A*pa;X+=na*sa;h[oa]=[P,X,w(g,wa)]}return h},u=(g,f)=>{const h=Array(f.length);if(!f.length)return h;var A=f[0];let P=k(g,A[0]),
X=y(g,A[1]);h[0]=[P,X,I(g,A[2])];const {scale:ca,originPosition:ia}=g;A=ca[0];const na="lowerLeft"===ia?ca[1]:-ca[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa]=f[oa];P+=A*pa;X+=na*sa;h[oa]=[P,X,I(g,wa)]}return h},R=(g,f)=>{const h=Array(f.length);if(!f.length)return h;var A=f[0];let P=k(g,A[0]),X=y(g,A[1]);h[0]=[P,X,w(g,A[2]),I(g,A[3])];const {scale:ca,originPosition:ia}=g;A=ca[0];const na="lowerLeft"===ia?ca[1]:-ca[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa,xa]=f[oa];P+=A*pa;X+=na*sa;
h[oa]=[P,X,w(g,wa),I(g,xa)]}return h};e.getQuantizedBoundsCoordsArray=J;e.getQuantizedBoundsCoordsArrayArray=K;e.getQuantizedBoundsPaths=function(g){return K([0,0,0,0],g)};e.getQuantizedBoundsPoints=function(g){const f=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return J(f,f,g)};e.getQuantizedBoundsRings=function(g){return K([0,0,0,0],g)};e.normalizeTransform=x;e.quantizeBounds=function(g,f,h){g=x(g);f[0]=D(g,h[0]);f[3]=t(g,h[1]);f[2]=D(g,
h[2]);f[1]=t(g,h[3]);return f};e.quantizeCoordsArrayXY=z;e.quantizeCoordsArrayXYM=Q;e.quantizeCoordsArrayXYZ=M;e.quantizeCoordsArrayXYZM=Z;e.quantizeExtent=v;e.quantizeGeometry=function(g,f){return g&&f?l.isPoint(f)?q(g,{},f):l.isPolyline(f)?d(g,{},f):l.isPolygon(f)?L(g,{},f):l.isMultipoint(f)?b(g,{},f):l.isExtent(f)?v(g,{},f):null:null};e.quantizeM=a;e.quantizeMultipoint=b;e.quantizePoint=q;e.quantizePolygon=L;e.quantizePolyline=d;e.quantizeX=D;e.quantizeY=t;e.quantizeZ=N;e.toQuantizationTransform=
function(g){return g?{originPosition:"upper-left"===g.originPosition?"upperLeft":"lower-left"===g.originPosition?"lowerLeft":g.originPosition,scale:g.tolerance?[g.tolerance,g.tolerance,1,1]:[1,1,1,1],translate:null!=g.extent?[g.extent.xmin,g.extent.ymax,g.extent.zmin??0,g.extent.mmin??0]:[0,0,0,0]}:null};e.unquantizeBounds=function(g,f,h){g=x(g);return h?(f[0]=k(g,h[0]),f[1]=y(g,h[3]),f[2]=k(g,h[2]),f[3]=y(g,h[1]),f):[k(g,f[0]),y(g,f[3]),k(g,f[2]),y(g,f[1])]};e.unquantizeCoordsArrayArray=r;e.unquantizeCoordsArrayXY=
U;e.unquantizeCoordsArrayXYM=u;e.unquantizeCoordsArrayXYZ=T;e.unquantizeCoordsArrayXYZM=R;e.unquantizeExtent=function(g,f,h,A=h.hasZ??!1,P=h.hasM??!1){g=x(g);f.xmin=k(g,h.xmin);f.xmax=k(g,h.xmax);f.ymin=y(g,h.ymin);f.ymax=y(g,h.ymax);A&&(f.zmin=w(g,h.zmin),f.zmax=w(g,h.zmax));P&&(f.mmin=I(g,h.mmin),f.mmax=I(g,h.mmax));f.hasZ=A;f.hasM=P;return f};e.unquantizeM=I;e.unquantizeMultipoint=function(g,f,h,A=h?.hasZ??!1,P=h?.hasM??!1){null!=h&&(g=x(g),f.points=G(A,P)(g,h.points),f.hasZ=A,f.hasM=P);return f};
e.unquantizePoint=function(g,f,h,A=null!=h?.z,P=null!=h?.m){if(null==h)return f;g=x(g);f.x=k(g,h.x);f.y=y(g,h.y);A&&(f.z=w(g,h.z));P&&(f.m=I(g,h.m));return f};e.unquantizePolygon=function(g,f,h,A=h?.hasZ??!1,P=h?.hasM??!1){null!=h&&(g=x(g),f.rings=r(g,G(A,P),h.rings),f.hasZ=A,f.hasM=P);return f};e.unquantizePolyline=function(g,f,h,A=h?.hasZ??!1,P=h?.hasM??!1){null!=h&&(g=x(g),f.paths=r(g,G(A,P),h.paths),f.hasZ=A,f.hasM=P);return f};e.unquantizeX=k;e.unquantizeY=y;e.unquantizeZ=w;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),function(e,l,x,D,t,N){class a{constructor(p,k,y){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=p.returnDistinctValues??!1;this.fieldsIndex=y;this.featureAdapter=k;if((k=p.outFields)&&
!k.includes("*")){this.outFields=k;p=0;for(const I of k){var w=e.getExpressionFromFieldName(I);w=(k=this.fieldsIndex.get(w))?null:e.getWhereClause(w,y);k=k?k.name:e.getAliasFromFieldName(I)||`FIELD_EXP_${p++}`;this._fieldDataCache.set(I,{alias:k,clause:w})}}}countDistinctValues(p){if(!this.returnDistinctValues)return p.length;p.forEach(k=>this.getAttributes(k));return this._returnDistinctMap.size}getAttributes(p){p=this._processAttributesForOutFields(p);return this._processAttributesForDistinctValues(p)}getFieldValue(p,
k,y){const w=y?y.name:k;let I=null;this._fieldDataCache.has(w)?I=this._fieldDataCache.get(w)?.clause:y||(I=e.getWhereClause(k,this.fieldsIndex),this._fieldDataCache.set(w,{alias:w,clause:I}));return y?this.featureAdapter.getAttribute(p,w):I?.calculateValue(p,this.featureAdapter)}getDataValues(p,k,y=!0){const w=k.normalizationType,I=k.normalizationTotal,G=this.fieldsIndex.get(k.field),r=x.isDateOnlyField(G)||x.isTimestampOffsetField(G),J=x.isTimeOnlyField(G);return p.map(K=>{let v=k.field&&this.getFieldValue(K,
k.field,this.fieldsIndex.get(k.field));k.field2?(v=`${t.processNullValue(v)}${k.fieldDelimiter}${t.processNullValue(this.getFieldValue(K,k.field2,this.fieldsIndex.get(k.field2)))}`,k.field3&&(v=`${v}${k.fieldDelimiter}${t.processNullValue(this.getFieldValue(K,k.field3,this.fieldsIndex.get(k.field3)))}`)):"string"===typeof v&&y&&(r?v=v?(new Date(v)).getTime():null:J&&(v=v?D.timeOnlyToMilliseconds(v):null));w&&Number.isFinite(v)&&(K="field"===w&&k.normalizationField?this.getFieldValue(K,k.normalizationField,
this.fieldsIndex.get(k.normalizationField)):null,v=t.getNormalizedValue(v,w,K,I));return v})}async getExpressionValues(p,k,y,w,I){const {arcadeUtils:G}=await N.loadArcade(),r=G.hasGeometryOperations(k);r&&await G.enableGeometryOperations();const J=G.createFunction(k),K=G.getViewInfo(y),v={fields:this.fieldsIndex.fields};return p.map(b=>{b={attributes:this.featureAdapter.getAttributes(b),layer:v,geometry:r?{...l.getGeometry(w.geometryType,w.hasZ,w.hasM,this.featureAdapter.getGeometry(b)),spatialReference:y?.spatialReference}:
null};b=G.createExecContext(b,K,I);return G.executeFunction(J,b)})}validateItem(p,k){this._fieldDataCache.has(k)||this._fieldDataCache.set(k,{alias:k,clause:e.getWhereClause(k,this.fieldsIndex)});return this._fieldDataCache.get(k)?.clause?.testFeature(p,this.featureAdapter)??!1}validateItems(p,k){this._fieldDataCache.has(k)||this._fieldDataCache.set(k,{alias:k,clause:e.getWhereClause(k,this.fieldsIndex)});return this._fieldDataCache.get(k)?.clause?.testSet(p,this.featureAdapter)??!1}_processAttributesForOutFields(p){const k=
this.outFields;if(!k?.length)return this.featureAdapter.getAttributes(p);const y={};for(const w of k){const {alias:I,clause:G}=this._fieldDataCache.get(w);y[I]=G?G.calculateValue(p,this.featureAdapter):this.featureAdapter.getAttribute(p,I)}return y}_processAttributesForDistinctValues(p){if(null==p||!this.returnDistinctValues)return p;var k=this.outFields,y=[];if(k)for(const I of k){var {alias:w}=this._fieldDataCache.get(I);y.push(p[w])}else for(w in p)y.push(p[w]);k=`${(k||["*"]).join(",")}=${y.join(",")}`;
y=this._returnDistinctMap.get(k)||0;this._returnDistinctMap.set(k,++y);return 1<y?null:p}}return a})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r){function J(d){d=L.exec(d);if(!d)return null;const {hh:z,mm:M,ss:Q,ms:Z}=d.groups;return Number(z)*t.millisecondsPerTimeUnit.hours+Number(M)*t.millisecondsPerTimeUnit.minutes+Number(Q)*t.millisecondsPerTimeUnit.seconds+Number(Z||0)}function K(d,z){d=null!=d?d:"";null!=z&&z&&(d=d?"("+d+") AND ("+z+")":z);return d}function v(d){const z=d.layer;return d.fields.filter(M=>!z.getField(M))}function b(d){const z=d.layer;return d.fields.filter(M=>{M=z.getFieldUsageInfo(M);
return!M||!M.supportsStatistics})}let q=null;const L=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;e.calculateHeatmapStats=function(d,z=18,M,Q,Z){const U=new Float64Array(Q*Z);z=Math.round(D.pt2px(z));let T=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;M=y.createValueFunction(M);for(const {geometry:f,attributes:h}of d){const {x:A,y:P}=f;d=Math.max(0,A-z);var R=Math.max(0,P-z);const X=Math.min(Z,P+z),ca=Math.min(Q,A+z),ia=+M(h);for(;R<X;R++)for(let na=
d;na<ca;na++){var g=R*Q+na;const oa=y.evaluateDensityKernel(na-A,R-P,z)*ia;g=U[g]+=oa;T=Math.min(T,g);u=Math.max(u,g)}}return{min:T,max:u}};e.getDataValues=async function(d,z,M=!0){if(!z)return[];const {field:Q,field2:Z,field3:U,fieldDelimiter:T,fieldInfos:u,timeZone:R}=d;var g=Q&&u?.find(sa=>sa.name.toLowerCase()===Q.toLowerCase());const f=g?k.isTimeOnlyField(g):!1,h=g?w.isAnyDateField(g):!1,A=d.valueExpression,P=d.normalizationType,X=d.normalizationField,ca=d.normalizationTotal,ia=[];g=d.viewInfoParams;
let na=null,oa=null;if(A){if(!q){const {arcadeUtils:sa}=await G.loadArcade();q=sa}q.hasGeometryOperations(A)&&await q.enableGeometryOperations();na=q.createFunction(A);oa=g?q.getViewInfo({viewingMode:g.viewingMode,scale:g.scale,spatialReference:new N(g.spatialReference)}):null}d=d.fieldInfos;const pa=z[0]&&"declaredClass"in z[0]&&"esri.Graphic"===z[0].declaredClass||!d?null:{fields:d};z.forEach(sa=>{var wa=sa.attributes;if(A){var xa=q.createExecContext(pa?{...sa,layer:pa}:sa,oa,R);xa=q.executeFunction(na,
xa)}else wa&&(xa=wa[Q],Z?(xa=`${I.processNullValue(xa)}${T}${I.processNullValue(wa[Z])}`,U&&(xa=`${xa}${T}${I.processNullValue(wa[U])}`)):"string"===typeof xa&&M&&(h?xa=xa?(new Date(xa)).getTime():null:f&&(xa=xa?J(xa):null)));P&&"number"===typeof xa&&isFinite(xa)&&(wa=wa&&parseFloat(wa[X]),xa=I.getNormalizedValue(xa,P,wa,ca));ia.push(xa)});return ia};e.getRangeExpr=function(d,z,M){z=null!=z?d+" \x3e\x3d "+z:"";d=null!=M?d+" \x3c\x3d "+M:"";M="";return(M=z&&d?K(z,d):z||d)?"("+M+")":""};e.getSQLFilterForNormalization=
function(d){const z=d.field,M=d.normalizationType;d=d.normalizationField;let Q;if("field"===M)Q="(NOT "+d+" \x3d 0)";else if("log"===M||"natural-log"===M||"square-root"===M)Q=`(${z} > 0)`;return Q};e.getSumOfAttributesExpr=function(d,z,M){const Q=[],Z=[],U=[],T=[],u=[];d.forEach((g,f)=>{const h=g.field?"field":"expression",A=g.field||g.valueExpression;g.field?(u.push(A),Z.push(`var ${h}${f} = Number($feature["${A}"]);`)):(Q.push(`function getValueForExpr${f}() {\n  ${A} \n}`),Z.push(`var ${h}${f} = Number(getValueForExpr${f}());`));
M||U.push(`${h}${f} = IIf(${h}${f} < 0, 0, ${h}${f});`);T.push(`${h}${f}`)});d=Q.length?null:u.reduce((g,f)=>`${g} + ${f}`);let R=null;z||M?z?M||d&&(R=`(( ${d} ) >= 0)`):d&&(R=`(( ${d} ) <> 0)`):d&&(R=`(( ${d} ) > 0)`);return{valueExpression:[Q.length?Q.join("\n"):"",Z.join("\n"),U.join("\n"),`var total = ${T.join(" + ")};`,"return total;"].filter(Boolean).join("\n\n"),sqlExpression:d,sqlWhere:R}};e.mergeWhereClauses=K;e.quantizeFeatures=function(d,z,M,Q){const Z=p.isWrappable(M)?p.getInfo(M):null,
U=Z?Math.round((Z.valid[1]-Z.valid[0])/z.scale[0]):null;return d.map(T=>{const u=new r(T.geometry);a.quantizePoint(z,u,u);if(Z){var R=U??0,g=Q[0];0>u.x?u.x+=R:u.x>g&&(u.x-=R)}T.geometry=u;return T})};e.timeOnlyToMilliseconds=J;e.verifyBasicFieldValidity=function(d,z,M){const Q=v({layer:d,fields:z});if(Q.length)return new x(M,"Unknown fields: "+Q.join(", ")+". You can only use fields defined in the layer schema");d=b({layer:d,fields:z});if(d.length)return new x(M,"Unsupported fields: "+d.join(", ")+
". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};e.verifyFieldType=function(d,z,M,Q){let Z;z?z.name!==d.objectIdField&&Q.includes(z.type)||(Z=new x(M,"'field' should be one of these types: "+Q.join(","))):Z=new x(M,"'field' is not defined in the layer schema");return Z};e.verifyFilterValidity=function(d,z){if(d&&"intersects"!==d.spatialRelationship)return new x(z,"Only 'intersects' spatialRelationship is supported for featureFilter")};e.verifyNumericField=
function(d,z,M){let Q;z?z.name!==d.objectIdField&&k.isNumericField(z)||(Q=new x(M,"'field' should be one of these numeric types: "+k.numericTypes.join(","))):Q=new x(M,"'field' is not defined in the layer schema");return Q};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(e){function l(t){return t?72*t/96:0}function x(t=0,N=0){return{x:t,y:N}}const D=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;e.castRenderScreenPointArray=function(t){return t};
e.castRenderScreenPointArray3=function(t){return t};e.castScreenPointArray=function(t){return t};e.cloneScreenPoint=function(t){return t?x(t.x,t.y):null};e.createRenderScreenPoint=function(t=0,N=0){return{x:t,y:N}};e.createRenderScreenPointArray=function(t=0,N=0){return[t,N]};e.createRenderScreenPointArray3=function(t=0,N=0,a=0){return[t,N,a]};e.createScreenPoint=x;e.createScreenPointArray=function(t=0,N=0){return[t,N]};e.pt2px=function(t){return t?t/72*96:0};e.px2pt=l;e.screenPointArrayToObject=
function(t,N){return N?(N.x=t[0],N.y=t[1],N):{x:t[0],y:t[1]}};e.screenPointObjectToArray=function(t,N){return N?(N[0]=t.x,N[1]=t.y,2<N.length&&(N[2]=0),N):[t.x,t.y]};e.toPt=function(t){if("string"===typeof t){var N=t.match(D);if(N){var a=Number(N[1]);N=N[3]&&N[3].toLowerCase();t="-"===t.charAt(0);a="px"===N?l(a):a;return t?-a:a}console.warn("screenUtils.toPt: input not recognized!");return null}return t};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(e,l,x,D){function t(p,k,y){return 0===p?0:p*a[k]/a[y]}function N(p){switch(p){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const a={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};e.convertTime=t;e.isValidDate=function(p){return p instanceof Date&&!isNaN(p.getTime())};e.makeUTCTime=function(p,k,y="milliseconds"){k=new Date(t(k,y,"milliseconds"));k.setUTCFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate());return k};e.mergeTimeExtents=function(p,k){return p&&k?p.intersection(k):p||k};e.millisecondsPerTimeUnit=a;e.offsetDate=function(p,k,y,w=x.system){w=new D.IANAZone(l.resolveTimeZone(w));p=D.DateTime.fromJSDate(p,{zone:w});w="decades"===y||"centuries"===
y?"year":N(y);"decades"===y&&(k*=10);"centuries"===y&&(k*=100);return p.plus({[w]:k}).toJSDate()};e.offsetDateUTC=function(p,k,y="milliseconds"){p=p.getTime();k=t(k,y,"milliseconds");return new Date(p+k)};e.resetUTCDate=function(p,k){p=new Date(p.getTime());p.setUTCFullYear(k.getFullYear(),k.getMonth(),k.getDate());return p};e.timeSinceUTCMidnight=function(p,k="milliseconds"){const y=t(p.getUTCHours(),"hours","milliseconds"),w=t(p.getUTCMinutes(),"minutes","milliseconds"),I=t(p.getUTCSeconds(),"seconds",
"milliseconds");p=p.getUTCMilliseconds();return t(y+w+I+p,"milliseconds",k)};e.truncateDate=function(p,k,y=x.system){y=new D.IANAZone(l.resolveTimeZone(y));p=D.DateTime.fromJSDate(p,{zone:y});if("decades"===k||"centuries"===k)return p=p.startOf("year"),{year:y}=p,p.set({year:y-y%("decades"===k?10:100)}).toJSDate();k=N(k);return p.startOf(k).toJSDate()};e.truncateLocalTime=function(p){const k=new Date(0);k.setHours(0);k.setMinutes(0);k.setSeconds(0);k.setMilliseconds(0);k.setFullYear(p.getUTCFullYear(),
p.getUTCMonth(),p.getUTCDate());return k};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(e,l,x,D,t){function N(a,p,k,y){let {color:w,ratio:I}=p,{color:G,ratio:r}=k;r===I&&(1===r?I-=1E-6:r+=1E-6);p=l.clamp((y-I)/(r-I),0,1);D.lerp(a,w.toArray(),G.toArray(),p)}e.createValueFunction=function(a){return"function"===
typeof a?a:a?p=>+p[a]:()=>1};e.evaluateDensityKernel=function(a,p,k){a=Math.sqrt(a**2+p**2)/k;return 1<a?0:3/(Math.PI*k**2)*(1-a**2)**2};e.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(a){return x.px2pt(2.4*a)};e.generateGradient=function(a){const p=new Uint8ClampedArray(2048);a=a.filter(({ratio:G})=>0<=G&&1>=G).sort((G,r)=>G.ratio-r.ratio).map(({color:G,ratio:r})=>({color:G,ratio:Math.max(r,.001)}));if(1>a.length)return p;let k=a[0],y=a[0],w=1;const I=t.create();for(let G=0;512>G;G++){const r=
(G+.5)/512;for(;r>y.ratio&&w<a.length;)k=y,y=a[w++];N(I,k,y,r);p.set(I,4*G)}return p};e.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(a){return x.pt2px(a)/2.4};e.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(e,l,x,D,t,N){function a(r){return String(r).padStart(2,
"0")}function p(r,J,K){if("date"===J||"number"===J){"number"===J&&(r=new Date(r));J=K?r.getFullYear():r.getUTCFullYear();const v=a((K?r.getMonth():r.getUTCMonth())+1),b=a(K?r.getDate():r.getUTCDate()),q=a(K?r.getHours():r.getUTCHours()),L=a(K?r.getMinutes():r.getUTCMinutes());r=a(K?r.getSeconds():r.getUTCSeconds());r=`TIMESTAMP'${J}-${v}-${b} ${q}:${L}:${r}'`}return r}function k(r,J){if(J instanceof Date)return"date";if("number"===typeof J)return"number";if("string"===typeof J&&(r=r.getField(J),"\x3cnow\x3e"!==
J.toLowerCase()&&x.isDateField(r)))return"field"}const y={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},I=new Set(["integer","small-integer"]);let G=null;e.castIntegerFieldToFloat=function(r){return`cast(${r} as float)`};e.dateTypes=
["date","date-only","timestamp-offset"];e.defaultBasemapGroups=y;e.defaultStatisticTypes={exclude:["median"]};e.fieldDelimiter=",";e.formatAnyDate=function(r,J){const {format:K,timeZoneOptions:v,fieldType:b}=J??{};let q;v&&({timeZone:L,timeZoneName:q}=N.getTimeZoneFormattingOptions(v.layerTimeZone,v.datesInUnknownTimezone,v.viewTimeZone,l.convertDateFormatToIntlOptions(K||"short-date-short-time"),b));if("string"===typeof r&&isNaN(Date.parse("time-only"===b?`1970-01-01T${r}Z`:r)))return r;switch(b){case "date-only":var L=
l.convertDateFormatToIntlOptions(K||"short-date");return"string"===typeof r?l.formatDateOnly(r,{...L}):l.formatDate(r,{...L,timeZone:N.utc});case "time-only":return L=l.convertDateFormatToIntlOptions(K||"short-time"),"string"===typeof r?l.formatTimeOnly(r,L):l.formatDate(r,{...L,timeZone:N.utc});case "timestamp-offset":if(!L&&"string"===typeof r&&(new Date(r)).toISOString()!==r)return r;L=(J=K||v?l.convertDateFormatToIntlOptions(K||"short-date-short-time"):void 0)?{...J,timeZone:L,timeZoneName:q}:
void 0;return"string"===typeof r?l.formatTimestamp(r,L):l.formatDate(r,L);default:return J=K||v?l.convertDateFormatToIntlOptions(K||"short-date-short-time"):void 0,l.formatDate("string"===typeof r?new Date(r):r,J?{...J,timeZone:L,timeZoneName:q}:void 0)}};e.getBasemapGroup=function(r,J=y){for(const K in J)if(J[K].includes(r))return K};e.getBasemapId=function(r,J,K=!0){let v=null;r&&("string"===typeof r?J.includes(r)&&(v=r):v=t.getWellKnownBasemapId(r));return K?v||"gray":v};e.getDateDiffSQL=function(r,
J,K,v){const {hasQueryEngine:b}=r;K=p(K,k(r,K),b);r=p(J,k(r,J),b);r=`(${K} - ${r})`;v=w[v];J="/";1>v&&(v=1/v,J="*");return{sqlExpression:1===v?r:`(${r} ${J} ${v})`,sqlWhere:null}};e.getDateType=k;e.getFieldsList=async function(r){const {field:J,field2:K,field3:v,normalizationField:b,valueExpression:q}=r;r=[];q&&(G||({arcadeUtils:r}=await D.loadArcade(),G=r),r=G.extractFieldNames(q));J&&r.push(J);K&&r.push(K);v&&r.push(v);b&&r.push(b);return r};e.getNormalizationType=function(r){let J=r.normalizationType;
J||(r.normalizationField?J="field":null!=r.normalizationTotal&&(J="percent-of-total"));return J??void 0};e.isAnyDateField=function(r){return x.isDateField(r)||x.isDateOnlyField(r)||x.isTimestampOffsetField(r)};e.isIntegerField=function(r,J){r=J&&r.getField(J);return!!r&&I.has(r.type)};e.unitValueInDays=w;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(e,l,x,D,t,N,a,p,k,y){function w(g,f){let h;if("string"===typeof g){const A=g in y.esriBasemapDefinitions,P=!A&&g.includes("/");if(!A&&!P)return x.apiKey?T().warn(`Unable to find basemap definition for: ${g}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`):(f=Object.entries(y.esriBasemapDefinitions).filter(([,X])=>X.classic||X.is3d).map(([X])=>`"${X}"`).sort().join(", "),T().warn(`Unable to find basemap definition for: ${g}. Try one of these: ${f}`)),null;f&&(h=
f[g]);h||(h=A?l.fromId(g):new l({style:{id:g}}),f&&(f[g]=h))}else h=p.ensureType(l,g);h?.destroyed&&(T().warn("The provided basemap is already destroyed",{basemap:h}),h=null);return h}function I(g){if(u)return u(g);let f=null;g=K(g);const h=!g?.baseLayers.length;for(const P in y.esriBasemapDefinitions){var A=L(y.esriBasemapDefinitions[P]);A=z(g,A,{mustMatchReferences:h});if("equal"===A){f=P;break}"base-layers-equal"===A&&(f=P)}return f}function G(g,f){const h=new D;g.forEach(A=>{const P=f.find(X=>
"scene"!==X.type&&Q(b(A),b(X)))||A;h.includes(P)?h.push(A):h.push(P)});return h}function r(g){if(J(g.url))return!0;if("vector-tile"===g.type)for(const f in g.sourceNameToSource)if(J(g.sourceNameToSource[f]?.sourceUrl))return!0;return!1}function J(g){if(!g)return!1;g=new a.Url(a.makeAbsolute(g));return!!g.authority&&R.test(g.authority)}function K(g){return g?!g.loaded&&g.resourceInfo?L(g.resourceInfo.data):{baseLayers:v(g.baseLayers),referenceLayers:v(g.referenceLayers)}:null}function v(g){return(D.isCollection(g)?
g.toArray():g).map(b)}function b(g){return{type:g.type,effect:"effect"in g?g.effect:void 0,url:Z("urlTemplate"in g&&g.urlTemplate||g.url||"styleUrl"in g&&g.styleUrl||""),minScale:"minScale"in g&&null!=g.minScale?g.minScale:0,maxScale:"maxScale"in g&&null!=g.maxScale?g.maxScale:0,opacity:null!=g.opacity?g.opacity:1,visible:null!=g.visible?!!g.visible:!0,sublayers:"map-image"!==g.type&&"wms"!==g.type||null==g.sublayers?void 0:g.sublayers?.map(f=>({id:f.id,visible:f.visible})),activeLayerId:"wmts"===
g.type?g.activeLayer?.id:void 0}}function q(g){return g.isReference||"ArcGISSceneServiceLayer"===g.layerType}function L(g){return g?{baseLayers:d((g.baseMapLayers??[]).filter(f=>!q(f))),referenceLayers:d((g.baseMapLayers??[]).filter(f=>q(f)))}:null}function d(g){return g.map(f=>{let h;switch(f.layerType){case "VectorTileLayer":h="vector-tile";break;case "ArcGISTiledMapServiceLayer":h="tile";break;case "ArcGISSceneServiceLayer":h="scene";break;default:h="unknown"}return{type:h,effect:f.effect,url:Z(f.templateUrl||
f.urlTemplate||f.styleUrl||f.url),minScale:f.minScale??0,maxScale:f.maxScale??0,opacity:f.opacity??1,visible:null!=f.visibility?!!f.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function z(g,f,h){return null!=g!==(null!=f)?"not-equal":g&&f?M(g.baseLayers,f.baseLayers)?M(g.referenceLayers,f.referenceLayers)?"equal":h.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function M(g,f){if(g.length!==f.length)return!1;for(let h=0;h<g.length;h++)if(!Q(g[h],f[h]))return!1;return!0}
function Q(g,f){if(g.type!==f.type||g.url!==f.url||g.minScale!==f.minScale||g.maxScale!==f.maxScale||g.visible!==f.visible||g.opacity!==f.opacity||!k.effectEquals(g.effect,f.effect))return!1;if(null!=g.activeLayerId||null!=f.activeLayerId)return g.activeLayerId===f.activeLayerId;if(null!=g.sublayers||null!=f.sublayers){if(null==g.sublayers||null==f.sublayers||g.sublayers.length!==f.sublayers.length)return!1;for(let h=0;h<g.sublayers.length;h++){const A=g.sublayers.at(h),P=f.sublayers.at(h);if(A?.id!==
P?.id||A?.visible!==P?.visible)return!1}}return!0}function Z(g){return g?a.normalize(g).replace(/^\s*https?:/i,"").toLowerCase():""}function U(g){return"portalItem"in g?g.portalItem?.thumbnailUrl:void 0}const T=()=>t.getLogger("esri.support.basemapUtils");let u;const R=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;e.clonePreservingTiledLayers=function(g,f=null){g=w(g);if(!g)return null;g=g.clone();f&&(g.baseLayers=G(g.baseLayers,f.baseLayers),g.referenceLayers=G(g.referenceLayers,f.referenceLayers));
return g};e.contentEquals=function(g,f){if(g===f||null!=g?.portalItem?.id&&g.portalItem.id===f?.portalItem?.id)return!0;g=K(g);f=K(f);return"equal"===z(g,f,{mustMatchReferences:!0})};e.createCache=function(){return{}};e.destroyCache=function(g){for(const f in g)N.destroyMaybe(g[f]),delete g[f]};e.ensureType=w;e.findSpatialReference=function(g,f){if(null==f||null==g)return{spatialReference:null,updating:!1};if("not-loaded"===f.loadStatus)return f.load(),{spatialReference:null,updating:!0};if(f.spatialReference)return{spatialReference:f.spatialReference,
updating:!1};if(0===f.baseLayers.length)return{spatialReference:null,updating:!1};f=f.baseLayers.at(0);switch(f.loadStatus){case "not-loaded":f.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}f=(("supportedSpatialReferences"in f?f.supportedSpatialReferences:null)||["tileInfo"in f?f.tileInfo?.spatialReference:f.spatialReference]).filter(Boolean);const h=g.spatialReference;return h?{spatialReference:f.find(A=>h.equals(A))??f[0]??
null,updating:!1}:{spatialReference:f[0],updating:!1}};e.getBasemapThumbnailUrl=function(g){if(!g)return null;var {thumbnailUrl:f}=g;return f?f:(f=I(g))?y.esriBasemapDefinitions[f].thumbnailUrl:N.mappedFind(g.baseLayers,U)};e.getWellKnownBasemapId=I;e.hasDeveloperBasemapLayer=function(g){return!!g?.baseLayers.concat(g.referenceLayers).some(r)};e.isBasemap3D=function(g){return"Web Scene"===g.portalItem?.type||g.referenceLayers.some(f=>"scene"===f.type)};e.isBasemapInBeta=function(g){return!!g?.portalItem?.tags?.some(f=>
"beta"===f.toLowerCase())};e.isBasemapLayer=function(g,f){return g.basemap?.referenceLayers?.some(h=>h.uid===f)||g.basemap?.baseLayers?.some(h=>h.uid===f)};e.isDeveloperBasemapLayer=r;e.overrideGetWellKnownBasemapId=function(g){u=g};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J,K,v,b,q,L,d,z,M){var Q;let Z=0;N=Q=class extends N.JSONSupportMixin(p){constructor(u){super(u);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+Z++;this.baseLayers=new D;this.referenceLayers=new D;const R=g=>{g.parent&&g.parent!==this&&"remove"in g.parent&&g.parent.remove(g);g.parent=this;"elevation"===g.type&&y.getLogger(this).error(`Layer '${g.title}, id:${g.id}' of type '${g.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",g=>R(g.item)),this.referenceLayers.on("after-add",g=>R(g.item)),this.baseLayers.on("after-remove",g=>{g.item.parent=null}),this.referenceLayers.on("after-remove",g=>{g.item.parent=null})])}initialize(){this.when().catch(u=>{y.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,u)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var u=this.baseLayers.toArray();for(const R of u)R.destroy();
u=this.referenceLayers.toArray();for(const R of u)R.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=w.destroyMaybe(this.portalItem)}normalizeCtorArgs(u){u&&"resourceInfo"in u&&(this._set("resourceInfo",u.resourceInfo),u={...u},delete u.resourceInfo);return u}set baseLayers(u){this._set("baseLayers",t.referenceSetter(u,this._get("baseLayers")))}_writeBaseLayers(u,R,g){const f=[];u&&(g={...g,layerContainerType:"basemap"},this.baseLayers.forEach(h=>{h=M.getLayerJSON(h,
g.webmap?g.webmap.getLayerJSONFromResourceInfo(h):null,g);null!=h&&f.push(h)}),this.referenceLayers.forEach(h=>{const A=M.getLayerJSON(h,g.webmap?g.webmap.getLayerJSONFromResourceInfo(h):null,g);null!=A&&("scene"!==h.type&&(A.isReference=!0),f.push(A))}));R.baseMapLayers=f}set referenceLayers(u){this._set("referenceLayers",t.referenceSetter(u,this._get("referenceLayers")))}writeTitle(u,R){R.title=u||"Basemap"}load(u){this.addResolvingPromise(this._loadFromSource(u));return Promise.resolve(this)}loadAll(){return k.loadAll(this,
u=>{u(this.baseLayers,this.referenceLayers)})}clone(){const u={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(R=>a.isClonable(R)?R.clone():R),referenceLayers:this.referenceLayers.map(R=>a.isClonable(R)?R.clone():R)};this.loaded&&(u.loadStatus="loaded");return(new Q({resourceInfo:this.resourceInfo})).set(u)}read(u,R){this.resourceInfo||this._set("resourceInfo",{data:u,context:R});super.read(u,R)}write(u,R){u=u||{};R?.origin||(R={origin:"web-map",...R});super.write(u,
R);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(u.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(g=>{g=a.clone(g);g.url&&G.isProtocolRelative(g.url)&&(g.url=`https:${g.url}`);g.templateUrl&&G.isProtocolRelative(g.templateUrl)&&(g.templateUrl=`https:${g.templateUrl}`);return g}));return u}async _loadFromSource(u){const {resourceInfo:R,portalItem:g,style:f}=this;I.throwIfAborted(u);const h=[];R?(h.push(this._loadLayersFromJSON(R.data,R.context?R.context.url:null,u)),R.data.id&&!R.data.title&&
h.push(d.getBasemapTitle(R.data.id).then(A=>{A&&this.read({title:A},R.context)}))):g?h.push(this._loadFromItem(g,u)):f&&h.push(this._loadFromStylesService(f,u));await Promise.all(h)}async _loadLayersFromJSON(u,R,g){const f=this.resourceInfo?.context,h=this.portalItem?.portal||f?.portal||null,A=T[f?.origin||""]??"web-map",{populateOperationalLayers:P}=await new Promise((ca,ia)=>e(["./layers/support/layersCreator"],ca,ia)),X=[];I.throwIfAborted(g);if(u.baseMapLayers&&Array.isArray(u.baseMapLayers)){R=
{context:{...f,origin:A,url:R,portal:h,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ca=ia=>"web-scene"===A&&"ArcGISSceneServiceLayer"===ia.layerType||ia.isReference;g=P(this.baseLayers,u.baseMapLayers.filter(ia=>!ca(ia)),R);X.push(g);u=P(this.referenceLayers,u.baseMapLayers.filter(ca),R);X.push(u)}await Promise.allSettled(X)}async _loadFromItem(u,R){const g=await (await u.load(R)).fetchData("json",R),f=G.urlToObject(u.itemUrl??"");this._set("resourceInfo",{data:g.baseMap??
{},context:{origin:U[u.type||""]??"web-map",portal:u.portal||q.getDefault(),url:f}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:g.spatialReference},this.resourceInfo.context);this.read({title:u.title,thumbnailUrl:u.thumbnailUrl},{origin:"portal-item",portal:u.portal||q.getDefault(),url:f});return this._loadLayersFromJSON(this.resourceInfo.data,f,R)}async _loadFromStylesService(u,R){var g=`${u.serviceUrl}/${u.id}`;const f=(await x(g,{query:{language:u.getLanguageParamValue(),
places:u.places,worldview:u.worldview,token:u.apiKey},signal:R?.signal})).data;g=G.urlToObject(g);this._set("resourceInfo",{data:f.baseMap??{},context:{origin:"web-map",url:g}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:f.spatialReference},this.resourceInfo.context);await this._loadLayersFromJSON(this.resourceInfo.data,g,R);if(u.apiKey)for(const h of[...this.baseLayers,...this.referenceLayers])"apiKey"in h&&(h.apiKey=u.apiKey)}static fromId(u){return(u=
d.esriBasemapDefinitions[u])?u.itemId?new Q({portalItem:{id:u.itemId,portal:{url:"https://www.arcgis.com"}}}):Q.fromJSON(u,{origin:u.is3d?"web-scene":"web-map"}):null}};l.__decorate([r.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(u,R,g,f){this._writeBaseLayers(u,R,f)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:D}},writer(u,R,g,f){this._writeBaseLayers(u,R,f)}}}}}})],N.prototype,"baseLayers",null);l.__decorate([r.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],
N.prototype,"id",void 0);l.__decorate([r.property({type:L})],N.prototype,"portalItem",void 0);l.__decorate([r.property()],N.prototype,"referenceLayers",null);l.__decorate([r.property({readOnly:!0})],N.prototype,"resourceInfo",void 0);l.__decorate([r.property({type:b})],N.prototype,"spatialReference",void 0);l.__decorate([r.property({type:z})],N.prototype,"style",void 0);l.__decorate([r.property()],N.prototype,"thumbnailUrl",void 0);l.__decorate([r.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],
N.prototype,"title",void 0);l.__decorate([v.writer("title")],N.prototype,"writeTitle",null);N=Q=l.__decorate([K.subclass("esri.Basemap")],N);const U={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return N})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(e,l){e.castForReferenceSetter=function(x){return x};e.referenceSetter=function(x,D,t=l){D||=new t;if(D===x)return D;
D.removeAll();x&&(Array.isArray(x)||"items"in x&&Array.isArray(x.items))?D.addMany(x):x&&D.add(x);return D};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(e,l,x,D,t,N,a,p){const k=y=>{y=class extends y{constructor(...w){super(...w);this.loadError=this._loadController=null;this.loadStatus=
"not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(I=>{const G=this.load.bind(this);this.load=r=>{const J=new Promise((K,v)=>{const b=t.onAbortOrThrow(r,v);this.destroyed&&v(new l("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(K,v).finally(()=>{b&&b.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const K=this._loadController=new AbortController;G({signal:K.signal})}I();
return J}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},I=>{this._set("loadStatus","failed");this._set("loadError",I);this._loadController=null})}destroy(){this._loadController&&(this._loadController=x.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new l("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};e.__decorate([a.property({readOnly:!0})],y.prototype,"loaded",null);e.__decorate([a.property({readOnly:!0})],y.prototype,"loadError",void 0);e.__decorate([a.property({clonable:!1})],y.prototype,"loadStatus",void 0);e.__decorate([a.property({type:[N],readOnly:!0})],y.prototype,"loadWarnings",null);return y=e.__decorate([p.subclass("esri.core.Loadable")],y)};D=class extends k(D.EsriPromise){};
D=e.__decorate([p.subclass("esri.core.Loadable")],D);(function(y){y.LoadableMixin=k;y.isLoadable=function(w){return!(!w||!w.load)}})(D||={});return D})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(e,l,x,D,t){var N;(function(k){k[k.PENDING=0]="PENDING";k[k.RESOLVED=1]="RESOLVED";k[k.REJECTED=2]="REJECTED"})(N||={});class a{constructor(){this._resolver=D.createResolver();this._status=N.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=N.RESOLVED;this._cleanUp()},()=>{this._status=N.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(k){this._resolvingPromises.push(k);this._tryResolve()}isResolved(){return this._status===N.RESOLVED}isRejected(){return this._status===N.REJECTED}isFulfilled(){return this._status!==N.PENDING}abort(){this._resolver.reject(D.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var k=D.createResolver(),y=[...this._resolvingPromises,k.promise],w=this._allPromise=Promise.all(y);w.then(()=>{this.isFulfilled()||this._allPromise!==w||this._resolver.resolve()},I=>{this.isFulfilled()||this._allPromise!==w||D.isAbortError(I)||this._resolver.reject(I)});k.resolve()}}}const p=k=>{k=class extends k{constructor(...y){super(...y);this._promiseProps=new a;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(y,
w){return this._promiseProps.promise.then(()=>this).then(y,w)}catch(y){return this.when(null,y)}addResolvingPromise(y){y&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in y?y.when():y)}};return k=l.__decorate([t.subclass("esri.core.Promise")],k)};e.EsriPromise=class extends p(x){};e.EsriPromise=l.__decorate([t.subclass("esri.core.Promise")],e.EsriPromise);e.EsriPromiseMixin=p;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(e,l,x,D){async function t(N,a){const p=[],k=(...w)=>{for(const I of w)null!=I&&(Array.isArray(I)?k(...I):x.isCollection(I)?I.forEach(G=>k(G)):D.isLoadable(I)&&p.push(I))};a(k);let y=null;await l.map(p,async w=>{w=await l.result("loadAll"in w&&"function"===typeof w.loadAll?w.loadAll():w.load());!1!==w.ok||y||(y=w)});if(y)throw y.error;return N}e.loadAll=async function(N,a){await N.load();return t(N,a)};e.loadAllChildren=t;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J,K,v,b,q,L,d,z,M,Q){function Z(f){const h=D.id;return()=>{const A=f.deref();A&&h.findCredential(A.restUrl)&&A.signIn().catch(()=>{})}}const U=f=>Object.freeze(Object.defineProperty({__proto__:null,default:f},Symbol.toStringTag,{value:"Module"}));var T;let u;const R={PortalGroup:()=>Promise.resolve({default:L}),PortalItem:()=>new Promise((f,h)=>e(["./PortalItem"],A=>f(U(A)),h)),PortalUser:()=>Promise.resolve({default:M})};a=T=class extends a.JSONSupportMixin(p){constructor(f){super(f);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.default3DBasemapQuery=this.customBaseUrl=this.culture=this.created=null;this.hasClassificationSchema=this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=
null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=x.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=
this.useDefault3dBasemap=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(f){return"string"===typeof f?{url:f}:f}destroy(){g.unregister(this);this.defaultBasemap=k.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=k.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=k.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=k.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(f){if(f)for(const h of f)x.request.trustedServers.includes(h)||
x.request.trustedServers.push(h);return f}readDefaultBasemap(f){return this._readBasemap(f)}readDefaultDevBasemap(f){return this._readBasemap(f)}readDefaultVectorBasemap(f){return this._readBasemap(f)}get extraQuery(){const f=!this.user?.orgId||this.canSearchPublic;return this.id&&!f?` AND orgid:${this.id}`:null}get hasAPIKey(){return Q.isApiKeyApplicable(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let f=this.url;
if(f){const h=f.indexOf("/sharing");f=0<h?f.slice(0,h):this.url.replace(/\/+$/,"");f+="/sharing/rest"}return f}get thumbnailUrl(){const f=this.restUrl,h=this.thumbnail;return f&&h?this._normalizeSSL(f+"/portals/self/resources/"+h):null}readUrlKey(f){return f?f.toLowerCase():f}readUser(f){let h=null;f&&(h=M.fromJSON(f),h.portal=this);return h}load(f){const h=(new Promise((A,P)=>e(["../Basemap"],X=>A(U(X)),P))).then(({default:A})=>{y.throwIfAborted(f);u=A}).then(()=>this.sourceJSON?this.sourceJSON:
this.fetchSelf(this.authMode,!1,f)).then(A=>{if(!this.hasAPIKey&&D.id){const P=D.id;this.credential=P.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO&&this.authMode!==T.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=P.on("credential-create",Z(new WeakRef(this))),g.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=A;this.read(A)});this.addResolvingPromise(h);return Promise.resolve(this)}async createElevationLayers(){await this.load();
const f=this._getHelperService("defaultElevationLayers"),h=(await new Promise((A,P)=>e(["../layers/ElevationLayer"],X=>A(U(X)),P))).default;return f?f.map(A=>new h({id:A.id,url:A.url})):[]}async fetchBasemaps(f,h){const A=await this._fetchBasemaps(f,h);!0===h?.include3d&&!1!==this.use3dBasemaps&&(f=await this._fetchBasemaps3D(f,h),A.unshift(...f));return A}async fetchDefault3DBasemap(f){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||"none"===this.default3DBasemapQuery)return null;const h=
new d;h.query=this.default3DBasemapQuery;h.disableExtraQuery=!0;return(f=(await this.queryItems(h,f)).results.find(A=>"Web Scene"===A.type))?new u({portalItem:f}):null}fetchCategorySchema(f){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",f).then(h=>h.categorySchema):y.isAborted(f)?Promise.reject(y.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(f){const h=this.featuredGroups,A=new d({num:100,sortField:"title"});if(h?.length){const P=[];for(const X of h)P.push(`(title:"${X.title}" AND owner:${X.owner})`);
A.query=P.join(" OR ");return this.queryGroups(A,f).then(X=>X.results)}return y.isAborted(f)?Promise.reject(y.createAbortError()):Promise.resolve([])}fetchRegions(f){const h=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/regions",{...f,query:{culture:h}})}fetchSettings(f){const h=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...f,query:{culture:h}})}static getDefault(){return q.ensureDefaultPortalInstance(()=>
new T)}queryGroups(f,h){return this.queryPortal("/community/groups",f,"PortalGroup",h)}queryItems(f,h){return this.queryPortal("/search",f,"PortalItem",h)}queryUsers(f,h){f.sortField||(f.sortField="username");return this.queryPortal("/community/users",f,"PortalUser",h)}fetchSelf(f=this.authMode,h=!1,A){const P=this.restUrl+"/portals/self";f={authMode:f,query:{culture:b.getLocale().toLowerCase()},withCredentials:!0,...A};"auto"===f.authMode&&(f.authMode="no-prompt");h&&(f.query.default=!0);return this.request(P,
f)}queryPortal(f,h,A,P){const X=I.ensureType(d,h),ca=ia=>this.request(this.restUrl+f,{...X.toRequestOptions(this),...P}).then(na=>{const oa=X.clone();oa.start=na.nextStart;return new z({nextQueryParams:oa,queryParams:X,total:na.total,results:T._resultsToTypedArray(ia,{portal:this},na,P)})}).then(na=>Promise.all(na.results.map(oa=>"function"===typeof oa.when?oa.when():na)).then(()=>na,oa=>{y.throwIfAbortError(oa);return na}));return A&&R[A]?R[A]().then(({default:ia})=>{y.throwIfAborted(P);return ca(ia)}):
ca()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new N("portal:not-authenticated","Unable to authenticate user. Portal.user is missing");});if(this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT&&!D.id)return Promise.reject(new N("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const f=h=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return h||
(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=h;return this.fetchSelf("immediate")});if(this.user&&this.credential===h)return null;this.credential=h;return this.fetchSelf("immediate")}).then(A=>{A&&(this.sourceJSON=A,this.read(A))});return D.id?D.id.getCredential(this.restUrl,{prompt:this.authMode!==T.AUTH_MODE_NO_PROMPT}).then(h=>f(h)):f(this.credential)}normalizeUrl(f){const h=this.credential?.token;
return this._normalizeSSL(h?f+(f.includes("?")?"\x26":"?")+"token\x3d"+h:f)}requestToTypedArray(f,h,A){return this.request(f,h).then(P=>{const X=T._resultsToTypedArray(A,{portal:this},P);return Promise.all(X.map(ca=>"function"===typeof ca.when?ca.when():P)).then(()=>X,()=>X)})}request(f,h={}){var A={f:"json",...h.query};const {authMode:P=this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:X=null,cacheBust:ca=!1,method:ia="auto",responseType:na="json",
signal:oa}=h;A={authMode:P,body:X,cacheBust:ca,method:ia,query:A,responseType:na,timeout:0,signal:oa};h.withCredentials&&(A.withCredentials=!0);return t(this._normalizeSSL(f),A).then(pa=>pa.data)}toJSON(){throw new N("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(f){if(!f)return null;if(f.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:f})}_getHelperService(f){const h=this.helperServices&&this.helperServices[f];if(!h)throw new N("portal:service-not-found",
`The \`helperServices\` do not include an entry named "${f}"`);return h}async _fetchBasemaps(f,h){const A=new d;A.query=f||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);A.disableExtraQuery=!0;f=await this.queryGroups(A,h);if(!f.total)return[];f=f.results[0];A.num=100;A.query='type:"Web Map" -type:"Web Application"';A.sortField=f.sortField||"name";A.sortOrder=f.sortOrder||"desc";h=await f.queryItems(A,h);return h.total?
h.results.filter(P=>"Web Map"===P.type).map(P=>new u({portalItem:P})):[]}async _fetchBasemaps3D(f,h){f=f||this.basemapGalleryGroupQuery3D;if(!f)return[];f=new d({query:f,disableExtraQuery:!0});var A=await this.queryGroups(f,h);if(!A.total)return[];A=A.results[0];f.num=100;f.query='type:"Web Scene"';f.sortField=A.sortField||"name";f.sortOrder=A.sortOrder||"desc";h=await A.queryItems(f,h);return h.total?h.results.filter(P=>"Web Scene"===P.type).map(P=>new u({portalItem:P})):[]}_normalizeSSL(f){return f.replace(/^http:/i,
"https:").replace(":7080",":7443")}_readBasemap(f){return f?(f=u.fromJSON(f),f.portalItem={portal:this},f):null}static _resultsToTypedArray(f,h,A,P){if(A){const X=null!=P?P.signal:null;A=A.listings||A.notifications||A.userInvitations||A.tags||A.items||A.groups||A.comments||A.provisions||A.results||A.relatedItems||A;if(f||h)A=A.map(ca=>{ca=Object.assign(f?f.fromJSON(ca):ca,h);"function"===typeof ca.load&&ca.load(X);return ca})}else A=[];return A}};a.AUTH_MODE_ANONYMOUS="anonymous";a.AUTH_MODE_AUTO=
"auto";a.AUTH_MODE_IMMEDIATE="immediate";a.AUTH_MODE_NO_PROMPT="no-prompt";l.__decorate([w.property()],a.prototype,"access",void 0);l.__decorate([w.property()],a.prototype,"allSSL",void 0);l.__decorate([w.property()],a.prototype,"authMode",void 0);l.__decorate([w.property()],a.prototype,"authorizedCrossOriginDomains",void 0);l.__decorate([J.reader("authorizedCrossOriginDomains")],a.prototype,"readAuthorizedCrossOriginDomains",null);l.__decorate([w.property()],a.prototype,"basemapGalleryGroupQuery",
void 0);l.__decorate([w.property({json:{name:"3DBasemapGalleryGroupQuery"}})],a.prototype,"basemapGalleryGroupQuery3D",void 0);l.__decorate([w.property()],a.prototype,"bingKey",void 0);l.__decorate([w.property()],a.prototype,"canListApps",void 0);l.__decorate([w.property()],a.prototype,"canListData",void 0);l.__decorate([w.property()],a.prototype,"canListPreProvisionedItems",void 0);l.__decorate([w.property()],a.prototype,"canProvisionDirectPurchase",void 0);l.__decorate([w.property()],a.prototype,
"canSearchPublic",void 0);l.__decorate([w.property()],a.prototype,"canShareBingPublic",void 0);l.__decorate([w.property()],a.prototype,"canSharePublic",void 0);l.__decorate([w.property()],a.prototype,"canSignInArcGIS",void 0);l.__decorate([w.property()],a.prototype,"canSignInIDP",void 0);l.__decorate([w.property()],a.prototype,"colorSetsGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"commentsEnabled",void 0);l.__decorate([w.property({type:Date})],a.prototype,"created",void 0);l.__decorate([w.property()],
a.prototype,"credential",void 0);l.__decorate([w.property()],a.prototype,"culture",void 0);l.__decorate([w.property()],a.prototype,"currentVersion",void 0);l.__decorate([w.property()],a.prototype,"customBaseUrl",void 0);l.__decorate([w.property()],a.prototype,"default3DBasemapQuery",void 0);l.__decorate([w.property()],a.prototype,"defaultBasemap",void 0);l.__decorate([J.reader("defaultBasemap")],a.prototype,"readDefaultBasemap",null);l.__decorate([w.property()],a.prototype,"defaultDevBasemap",void 0);
l.__decorate([J.reader("defaultDevBasemap")],a.prototype,"readDefaultDevBasemap",null);l.__decorate([w.property({type:v})],a.prototype,"defaultExtent",void 0);l.__decorate([w.property()],a.prototype,"defaultVectorBasemap",void 0);l.__decorate([J.reader("defaultVectorBasemap")],a.prototype,"readDefaultVectorBasemap",null);l.__decorate([w.property()],a.prototype,"description",void 0);l.__decorate([w.property()],a.prototype,"devBasemapGalleryGroupQuery",void 0);l.__decorate([w.property()],a.prototype,
"eueiEnabled",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,"extraQuery",null);l.__decorate([w.property()],a.prototype,"featuredGroups",void 0);l.__decorate([w.property()],a.prototype,"featuredItemsGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"galleryTemplatesGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"layoutGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"livingAtlasGroupQuery",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,
"hasAPIKey",null);l.__decorate([w.property()],a.prototype,"hasCategorySchema",void 0);l.__decorate([w.property()],a.prototype,"hasClassificationSchema",void 0);l.__decorate([w.property()],a.prototype,"helpBase",void 0);l.__decorate([w.property()],a.prototype,"helperServices",void 0);l.__decorate([w.property()],a.prototype,"helpMap",void 0);l.__decorate([w.property()],a.prototype,"homePageFeaturedContent",void 0);l.__decorate([w.property()],a.prototype,"homePageFeaturedContentCount",void 0);l.__decorate([w.property()],
a.prototype,"httpPort",void 0);l.__decorate([w.property()],a.prototype,"httpsPort",void 0);l.__decorate([w.property()],a.prototype,"id",void 0);l.__decorate([w.property()],a.prototype,"ipCntryCode",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,"isOrganization",null);l.__decorate([w.property()],a.prototype,"isPortal",void 0);l.__decorate([w.property()],a.prototype,"isReadOnly",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,"itemPageUrl",null);l.__decorate([w.property()],
a.prototype,"layerTemplatesGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"maxTokenExpirationMinutes",void 0);l.__decorate([w.property({type:Date})],a.prototype,"modified",void 0);l.__decorate([w.property()],a.prototype,"name",void 0);l.__decorate([w.property()],a.prototype,"portalHostname",void 0);l.__decorate([w.property()],a.prototype,"portalMode",void 0);l.__decorate([w.property()],a.prototype,"portalProperties",void 0);l.__decorate([w.property()],a.prototype,"region",void 0);l.__decorate([w.property()],
a.prototype,"recycleBinEnabled",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,"restUrl",null);l.__decorate([w.property()],a.prototype,"rotatorPanels",void 0);l.__decorate([w.property()],a.prototype,"showHomePageDescription",void 0);l.__decorate([w.property()],a.prototype,"sourceJSON",void 0);l.__decorate([w.property()],a.prototype,"staticImagesUrl",void 0);l.__decorate([w.property({json:{name:"2DStylesGroupQuery"}})],a.prototype,"stylesGroupQuery2d",void 0);l.__decorate([w.property({json:{name:"stylesGroupQuery"}})],
a.prototype,"stylesGroupQuery3d",void 0);l.__decorate([w.property()],a.prototype,"supportsHostedServices",void 0);l.__decorate([w.property()],a.prototype,"symbolSetsGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"templatesGroupQuery",void 0);l.__decorate([w.property()],a.prototype,"thumbnail",void 0);l.__decorate([w.property({readOnly:!0})],a.prototype,"thumbnailUrl",null);l.__decorate([w.property()],a.prototype,"units",void 0);l.__decorate([w.property()],a.prototype,"url",void 0);l.__decorate([w.property()],
a.prototype,"urlKey",void 0);l.__decorate([J.reader("urlKey")],a.prototype,"readUrlKey",null);l.__decorate([w.property()],a.prototype,"user",void 0);l.__decorate([J.reader("user")],a.prototype,"readUser",null);l.__decorate([w.property()],a.prototype,"use3dBasemaps",void 0);l.__decorate([w.property()],a.prototype,"useDefault3dBasemap",void 0);l.__decorate([w.property()],a.prototype,"useStandardizedQuery",void 0);l.__decorate([w.property()],a.prototype,"useVectorBasemaps",void 0);l.__decorate([w.property()],
a.prototype,"vectorBasemapGalleryGroupQuery",void 0);l=a=T=l.__decorate([K.subclass("esri.portal.Portal")],a);const g=new FinalizationRegistry(f=>{f.remove()});return l})},"esri/portal/portalDefault":function(){define(["exports"],function(e){let l;e.clearDefaultPortalInstance=function(){l=void 0};e.ensureDefaultPortalInstance=function(x){if(!l||l.destroyed)l=x();return l};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(e,l,x,D,t,N,a,p,k){var y;x=y=class extends x.JSONSupport{constructor(w){super(w);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const w=this.url,I=this.thumbnail;return w&&I&&this.portal?this.portal?.normalizeUrl(`${w}/info/${I}?f=json`):null}get url(){const w=this.portal?.restUrl;return w?w+"/community/groups/"+this.id:
null}fetchCategorySchema(w){return this.portal.request(this.url+"/categorySchema",w).then(I=>{I=I.categorySchema||[];return I.some(G=>"contentCategorySetsGroupQuery.LivingAtlas"===G.source)?this._fetchCategorySchemaSet("LivingAtlas",w):I})}fetchMembers(w){return this.portal.request(this.url+"/users",w)}getThumbnailUrl(w){let I=this.thumbnailUrl;I&&w&&(I+=`&w=${w}`);return I}toJSON(){throw new l("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(w){if(!w)return null;
if(w.declaredClass)throw Error("JSON object is already hydrated");const I=new y({sourceJSON:w});I.read(w);return I}queryItems(w,I){w=t.ensureType(k,w);const G=this.portal;if(5<parseFloat(G.currentVersion))return w=w||new k,G.queryPortal(`/content/groups/${this.id}/search`,w,"PortalItem",I);w=w?w.clone():new k;w.query="group:"+this.id+(w.query?" "+w.query:"");return G.queryItems(w,I)}_fetchCategorySchemaSet(w,I){const G=this.portal;return G.fetchSelf(G.authMode,!0,I).then(r=>{if(r=r.contentCategorySetsGroupQuery)return r=
new k({disableExtraQuery:!0,num:1,query:r}),G.queryGroups(r,I);throw new l("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(r=>{if(r.total){r=r.results[0];const J=new k({num:1,query:`typekeywords:"${w}"`});return r.queryItems(J,I)}throw new l("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(r=>r.total?r.results[0].fetchData("json",I).then(J=>{J=J?.categorySchema;return J?.length?J:[]}):[])}};e.__decorate([D.property()],
x.prototype,"access",void 0);e.__decorate([D.property({type:Date})],x.prototype,"created",void 0);e.__decorate([D.property()],x.prototype,"description",void 0);e.__decorate([D.property()],x.prototype,"id",void 0);e.__decorate([D.property()],x.prototype,"isInvitationOnly",void 0);e.__decorate([D.property({type:Date})],x.prototype,"modified",void 0);e.__decorate([D.property()],x.prototype,"owner",void 0);e.__decorate([D.property()],x.prototype,"portal",void 0);e.__decorate([D.property()],x.prototype,
"snippet",void 0);e.__decorate([D.property()],x.prototype,"sortField",void 0);e.__decorate([D.property()],x.prototype,"sortOrder",void 0);e.__decorate([D.property()],x.prototype,"sourceJSON",void 0);e.__decorate([D.property()],x.prototype,"tags",void 0);e.__decorate([D.property()],x.prototype,"thumbnail",void 0);e.__decorate([D.property({readOnly:!0})],x.prototype,"thumbnailUrl",null);e.__decorate([D.property()],x.prototype,"title",void 0);e.__decorate([D.property({readOnly:!0})],x.prototype,"url",
null);return x=y=e.__decorate([p.subclass("esri.portal.PortalGroup")],x)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(e,l,x,D,t,N,a,p,k,y,w){var I;const G=new x.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});l=I=class extends l{constructor(r){super(r);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(r){"asc"!==r&&"desc"!==r||this._set("sortOrder",r)}clone(){return new I({categories:this.categories?D.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(r,J){let K=[];this.categories&&(K=this.categories.map(q=>Array.isArray(q)?JSON.stringify(q):q));let v="";if(this.extent){var b=w.project(this.extent,y.WGS84);null!=b&&(v=`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`)}b=this.query;!this.disableExtraQuery&&r.extraQuery&&(b="("+b+")"+r.extraQuery);r={categories:K,bbox:v,q:b,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(r.sortField=this.sortField.split(",").map(q=>G.toJSON(q.trim())).join(","),r.sortOrder=this.sortOrder);return{query:{...J,...r}}}};e.__decorate([t.property()],l.prototype,"categories",void 0);e.__decorate([t.property()],l.prototype,"disableExtraQuery",void 0);e.__decorate([t.property({type:k})],l.prototype,"extent",void 0);e.__decorate([t.property()],l.prototype,"filter",void 0);e.__decorate([t.property()],l.prototype,"num",void 0);e.__decorate([t.property()],
l.prototype,"query",void 0);e.__decorate([t.property()],l.prototype,"sortField",void 0);e.__decorate([t.property()],l.prototype,"sortOrder",null);e.__decorate([t.property()],l.prototype,"start",void 0);return l=I=e.__decorate([p.subclass("esri.portal.PortalQueryParams")],l)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,x,D,t,N,a){l=class extends l{constructor(p){super(p);this.total=this.results=this.queryParams=this.nextQueryParams=null}};e.__decorate([x.property()],l.prototype,"nextQueryParams",void 0);e.__decorate([x.property()],l.prototype,"queryParams",void 0);e.__decorate([x.property()],l.prototype,"results",void 0);e.__decorate([x.property()],l.prototype,"total",void 0);return l=e.__decorate([a.subclass("esri.portal.PortalQueryResult")],l)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w){var I;D=I=class extends D.JSONSupport{constructor(G){super(G);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const G=this.url,r=this.thumbnail;return G&&r?this.portal.normalizeUrl(`${G}/info/${r}?f=json`):null}get userContentUrl(){const G=
this.portal?.restUrl;return G?`${G}/content/users/${this.username}`:null}get url(){const G=this.portal?.restUrl;return G?`${G}/community/users/${this.username}`:null}addItem(G){const r=G&&G.item;var J=G?.data;G=G?.folder;const K={method:"post"};r&&(K.query=r.createPostQuery(),null!=J&&("string"===typeof J?K.query.text=J:"object"===typeof J&&(K.query.text=JSON.stringify(J))));J=this.userContentUrl;G&&(J+="/"+("string"===typeof G?G:G.id));return this.portal.request(J+"/addItem",K).then(v=>{r.id=v.id;
r.portal=this.portal;return r.loaded?r.reload():r.load()})}async deleteItem(G,r=!1){let J=this.userContentUrl;G.ownerFolder&&(J+="/"+G.ownerFolder);await this.portal.request(J+`/items/${G.id}/delete`,{method:"post",query:r?{permanentDelete:!0}:{}});G.id=null;G.portal=null}async deleteItems(G,r=!1){G=G.slice();var J=this.userContentUrl+"/deleteItems";const K=[];var v=G.map(b=>b.id);if(v.length){r={method:"post",query:{items:v.join(","),permanentDelete:r}};J=await this.portal.request(J,r);for(const b of J.results)J=
G.find(q=>b.itemId===q.id),r=b.success,v=null,r?(J.id=null,J.portal=null):b.error&&(v=new x("portal:delete-item-failed",b.error.message,b.error)),K.push({item:J,success:r,error:v})}return K}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(G=>G&&G.folders?G.folders.map(r=>{r=y.fromJSON(r);r.portal=this.portal;return r}):[])}fetchGroups(){return this.portal.request(this.url??"").then(G=>G&&G.groups?G.groups.map(r=>{r=w.fromJSON(r);r.portal=this.portal;return r}):
[])}async fetchItems(G){G??={};var r=this.userContentUrl??"";G.folder&&(r+="/"+G.folder.id);const {default:J}=await new Promise((K,v)=>e(["./PortalItem"],b=>K(Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}))),v));G=await this.portal.request(r,{query:{folders:!1,inRecycleBin:G.inRecycleBin?!0:null,foldersContent:!G.folder&&G.includeSubfolderItems?!0:null,num:G.num||10,start:G.start||1,sortField:G.sortField||"created",sortOrder:G.sortOrder||"asc"}});
return G?.items?(r=G.items.map(K=>{K=J.fromJSON(K);K.portal=this.portal;return K}),await Promise.all(r.map(K=>K.load())),{items:r,nextStart:G.nextStart,total:G.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(G=>G.tags)}getThumbnailUrl(G){let r=this.thumbnailUrl;r&&G&&(r+=`&w=${G}`);return r}queryFavorites(G){return this.favGroupId?(this._favGroup||(this._favGroup=new w({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(G)):Promise.reject(new x("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(G,r){await this.portal.request(this.userContentUrl+`/items/${G.id}/restore`,{method:"post",query:r?{folderID:"string"===typeof r?r:r.id}:null})}toJSON(){throw new x("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(G){if(!G)return null;if(G.declaredClass)throw Error("JSON object is already hydrated");const r=new I({sourceJSON:G});r.read(G);return r}};l.__decorate([t.property()],
D.prototype,"access",void 0);l.__decorate([t.property({type:Date})],D.prototype,"created",void 0);l.__decorate([t.property()],D.prototype,"culture",void 0);l.__decorate([t.property()],D.prototype,"description",void 0);l.__decorate([t.property()],D.prototype,"email",void 0);l.__decorate([t.property()],D.prototype,"favGroupId",void 0);l.__decorate([t.property()],D.prototype,"fullName",void 0);l.__decorate([t.property({type:Date})],D.prototype,"modified",void 0);l.__decorate([t.property()],D.prototype,
"orgId",void 0);l.__decorate([t.property()],D.prototype,"portal",void 0);l.__decorate([t.property()],D.prototype,"preferredView",void 0);l.__decorate([t.property()],D.prototype,"privileges",void 0);l.__decorate([t.property()],D.prototype,"region",void 0);l.__decorate([t.property()],D.prototype,"role",void 0);l.__decorate([t.property()],D.prototype,"roleId",void 0);l.__decorate([t.property()],D.prototype,"sourceJSON",void 0);l.__decorate([t.property()],D.prototype,"thumbnail",void 0);l.__decorate([t.property({readOnly:!0})],
D.prototype,"thumbnailUrl",null);l.__decorate([t.property()],D.prototype,"units",void 0);l.__decorate([t.property({readOnly:!0})],D.prototype,"userContentUrl",null);l.__decorate([t.property({readOnly:!0})],D.prototype,"url",null);l.__decorate([t.property()],D.prototype,"username",void 0);l.__decorate([t.property()],D.prototype,"userLicenseTypeId",void 0);l.__decorate([t.property()],D.prototype,"userType",void 0);return D=I=l.__decorate([k.subclass("esri.portal.PortalUser")],D)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,x,D,t,N,a,p){x=class extends x.JSONSupport{constructor(k){super(k);this.username=this.title=this.portal=this.id=this.created=null}get url(){const k=this.portal?.restUrl;return k?`${k}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new l("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};e.__decorate([D.property({type:Date})],x.prototype,"created",void 0);e.__decorate([D.property()],x.prototype,"id",void 0);e.__decorate([D.property()],x.prototype,
"portal",void 0);e.__decorate([D.property()],x.prototype,"title",void 0);e.__decorate([D.property({readOnly:!0})],x.prototype,"url",null);e.__decorate([D.property()],x.prototype,"username",void 0);return x=e.__decorate([p.subclass("esri.portal.PortalFolder")],x)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J,K,v){var b;const q=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),L=new Set(["KML","GeoJson","CSV"]);t=b=class extends t.JSONSupportMixin(a){static from(d){return y.ensureClass(b,d)}constructor(d){super(d);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.classification=
this.categories=this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const d=this.type,z=this.typeKeywords||
[];let M=d;"Feature Service"===d||"Feature Collection"===d?M=z.includes("Table")?"Table":z.includes("Route Layer")?"Route Layer":z.includes("Markup")?"Markup":"Feature Layer":"Image Service"===d?M=z.includes("Elevation 3D Layer")?"Elevation Layer":z.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===d?M="Scene Layer":"Video Service"===d?M="Video Layer":"Scene Package"===d?M="Scene Layer Package":"Stream Service"===d?M="Feature Layer":"Geoprocessing Service"===d?M=z.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===d?M="GeoEnrichment Service":"Geocoding Service"===d?M="Locator":"Microsoft Powerpoint"===d?M="Microsoft PowerPoint":"GeoJson"===d?M="GeoJSON":"Globe Service"===d?M="Globe Layer":"Vector Tile Service"===d?M="Tile Layer":"netCDF"===d?M="NetCDF":"Map Service"===d?M=z.includes("Spatiotemporal")||!z.includes("Hosted Service")&&!z.includes("Tiled")||z.includes("Relational")?"Map Image Layer":"Tile Layer":d?.toLowerCase().includes("add in")?M=d.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===d?M="Big Data File Share":"Compact Tile Package"===d?M="Tile Package (tpkx)":"Raster function template"===d?M="Raster Function Template":"OGCFeatureServer"===d?M="OGC Feature Layer":"web mapping application"===d&&z.includes("configurableApp")?M="Instant App":"Insights Page"===d?M="Insights Report":"Excalibur Imagery Project"===d?M="Excalibur Project":"3DTiles Service"===d?M="3D tiles layer":"3DTiles Package"===d&&(M="3D tiles package");return M}readExtent(d){return d&&
d.length?new G(d[0][0],d[0][1],d[1][0],d[1][1]):null}get iconUrl(){var d=this.type?.toLowerCase()||"";const z=this.typeKeywords||[];var M=!1,Q=!1;let Z=!1,U=!1,T=!1,u=!1;M=Q=!1;0<d.indexOf("service")||"feature collection"===d||"kml"===d||"wms"===d||"wmts"===d||"wfs"===d?(M=z.includes("Hosted Service"),"feature service"===d||"feature collection"===d||"kml"===d||"wfs"===d?(Q=z.includes("Table"),Z=z.includes("Route Layer"),U=z.includes("Markup"),T=z.includes("Spatiotemporal"),u=z.includes("UtilityNetwork"),
d=T&&Q?"spatiotemporaltable":Q?"table":Z?"routelayer":U?"markup":T?"spatiotemporal":u?"utilitynetwork":M?"featureshosted":"features"):"map service"===d||"wms"===d||"wmts"===d?(T=z.includes("Spatiotemporal"),Q=z.includes("Relational"),d=T||Q?"mapimages":M||z.includes("Tiled")||"wmts"===d?"maptiles":"mapimages"):d="scene service"===d?z.includes("Line")?"sceneweblayerline":z.includes("3DObject")?"sceneweblayermultipatch":z.includes("Point")?"sceneweblayerpoint":z.includes("IntegratedMesh")?"sceneweblayermesh":
z.includes("PointCloud")?"sceneweblayerpointcloud":z.includes("Polygon")?"sceneweblayerpolygon":z.includes("Building")?"sceneweblayerbuilding":z.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===d?z.includes("Elevation 3D Layer")?"elevationlayer":z.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===d?"streamlayer":"vector tile service"===d?"vectortile":"datastore catalog service"===d?"datastorecollection":"geocoding service"===d?"geocodeservice":"video service"===
d?z.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===d?z.includes("Web Tool")?"tool":"layers":"geodata service"===d?"geodataservice":"3dtiles service"===d?z.includes("3DObject")?"3dobjecttileslayer":z.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):d="web map"===d||"cityengine web scene"===d?"maps":"web scene"===d?z.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===d&&z.includes("configurableApp")?
"instantapps":"web mapping application"===d||"mobile application"===d||"application"===d||"operation view"===d||"desktop application"===d?"apps":"map document"===d||"map package"===d||"published map"===d||"scene document"===d||"globe document"===d||"basemap package"===d||"mobile basemap package"===d||"mobile map package"===d||"project package"===d||"project template"===d||"pro map"===d||"layout"===d||"layer"===d&&z.includes("ArcGIS Pro")||"explorer map"===d&&z.indexOf("Explorer Document")?"mapsgray":
"service definition"===d||"shapefile"===d||"cad drawing"===d||"geojson"===d||"netcdf"===d||"administrative report"===d?"datafiles":"360 vr experience"===d?"360vr":"explorer add in"===d||"desktop add in"===d||"windows viewer add in"===d||"windows viewer configuration"===d?"appsgray":"arcgis pro add in"===d||"arcgis pro configuration"===d?"addindesktop":"pdf"===d?"pdf":"microsoft word"===d?"word":"microsoft excel"===d?"excel":"microsoft powerpoint"===d?"ppt":"rule package"===d||"file geodatabase"===
d||"sqlite geodatabase"===d||"csv collection"===d||"kml collection"===d||"windows mobile package"===d||"map template"===d||"desktop application template"===d||"gml"===d||"arcpad package"===d||"code sample"===d||"document link"===d||"earth configuration"===d||"operations dashboard add in"===d||"rules package"===d||"workflow manager package"===d||"explorer map"===d&&z.includes("Explorer Mapping Application")||z.includes("Document")?"datafilesgray":"network analysis service"===d||"geoprocessing service"===
d||"geodata service"===d||"geometry service"===d||"geoprocessing package"===d||"locator package"===d||"geoprocessing sample"===d||"workflow manager service"===d?"toolsgray":"layer"===d||"layer package"===d||"explorer layer"===d?"layersgray":"analysis model"===d?"analysismodel":"scene package"===d?"scenepackage":"3dtiles package"===d?"3dtileslayerpackage":"3dtiles service"===d?"3dtileslayer":"mobile scene package"===d?"mobilescenepackage":"tile package"===d||"compact tile package"===d?"tilepackage":
"task file"===d?"taskfile":"report template"===d?"report-template":"statistical data collection"===d?"statisticaldatacollection":"insights workbook"===d?"workbook":"insights model"===d?"insightsmodel":"insights page"===d?"insightspage":"insights theme"===d?"insightstheme":"hub initiative"===d?"hubinitiative":"hub page"===d?"hubpage":"hub site application"===d?"hubsite":"hub event"===d?"hubevent":"hub project"===d?"hubproject":"relational database connection"===d?"relationaldatabaseconnection":"big data file share"===
d?"datastorecollection":"image collection"===d?"imagecollection":"desktop style"===d?"desktopstyle":"style"===d?z.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===d?"dashboard":"raster function template"===d?"rasterprocessingtemplate":"vector tile package"===d?"vectortilepackage":"ortho mapping project"===d?"orthomappingproject":"ortho mapping template"===d?"orthomappingtemplate":"solution"===d?"solutions":"geopackage"===d?"geopackage":"deep learning package"===d?"deeplearningpackage":
"real time analytic"===d?"realtimeanalytics":"reality mapping project"===d?"realitymappingproject":"big data analytic"===d?"bigdataanalytics":"feed"===d?"feed":"excalibur imagery project"===d?"excaliburimageryproject":"notebook"===d?"notebook":"storymap"===d?"storymap":"survey123 add in"===d?"survey123addin":"mission"===d?"mission":"mission report"===d?"missionreport":"mission template"===d?"missiontemplate":"quickcapture project"===d?"quickcaptureproject":"pro report"===d?"proreport":"pro report template"===
d?"proreporttemplate":"urban model"===d?"urbanmodel":"urban project"===d?"urbanproject":"web experience"===d?"experiencebuilder":"web experience template"===d?"webexperiencetemplate":"experience builder widget"===d?"experiencebuilderwidget":"experience builder widget package"===d?"experiencebuilderwidgetpackage":"workflow"===d?"workflow":"kernel gateway connection"===d?"kernelgatewayconnection":"insights script"===d?"insightsscript":"hub initiative template"===d?"hubinitiativetemplate":"storymap theme"===
d?"storymaptheme":"knowledge graph"===d?"knowledgegraph":"knowledge graph layer"===d?"knowledgegraphlayer":"knowledge studio project"===d?"knowledgestudio":"native application"===d?"nativeapp":"native application installer"===d?"nativeappinstaller":"web link chart"===d?"linkchart":"knowledge graph web investigation"===d?"investigation":"ogcfeatureserver"===d?"features":"pro presentation"===d?"propresentation":"pro project"===d?"proproject":"insights workbook package"===d?"insightsworkbookpackage":
"apache parquet"===d?"apacheparquet":"notebook code snippet library"===d?"notebookcodesnippets":"suitability model"===d?"suitabilitymodel":"esri classifier definition"===d?"classifierdefinition":"esri classification schema"===d?"classificationschema":"insights data engineering workbook"===d?"dataengineeringworkbook":"insights data engineering model"===d?"dataengineeringmodel":"deep learning studio project"===d?"deeplearningproject":"discussion"===d?"discussion":"allsource project"===d?"allsourceproject":
"api key"===d?"apikey":"data pipeline"===d?"datapipelines":"group layer"===d?(M=z.includes("Map"))?"layergroup2d":"layergroup":"media layer"===d?"onlinemedialayer":"form"===d?z.includes("Survey123")?"survey":"datafilesgray":"csv"===d?"csv":"image"===d?"image":"maps";return d?x.getAssetUrl("esri/images/portal/"+d+"16.png"):null}get isLayer(){return null!=this.type&&q.has(this.type)}get itemCdnUrl(){return v.toCDNUrl(this.itemUrl)}get itemPageUrl(){const d=this.portal?.itemPageUrl;return d&&this.id?
`${d}?id=${this.id}`:null}get itemUrl(){const d=this.portal?.restUrl;return d&&this.id?`${d}/content/items/${this.id}`:null}get thumbnailUrl(){const d=this.itemUrl,z=this.thumbnail;return d&&z?this.portal?.normalizeUrl(`${d}/info/${z}?f=json`)??null:null}get userItemUrl(){const d=this.portal?.restUrl;if(!d)return null;const z=this.owner||this.portal?.user?.username;return z?`${d}/content/users/${this.ownerFolder?`${z}/${this.ownerFolder}`:z}/items/${this.id}`:null}load(d){const z=this.portal??(this.portal=
r.getDefault()),M=z.load(d).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?z.request(this.itemUrl,{signal:null!=d?d.signal:null,query:{token:this.apiKey}}):{}).then(Q=>{this.sourceJSON=Q;this.read(Q)});this.addResolvingPromise(M);return Promise.resolve(this)}async addRating(d){const z={method:"post",query:{}};d instanceof K&&(d=d.rating);null==d||isNaN(d)||"number"!==typeof d||(z.query.rating=d);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",z);return new K({rating:d,
created:new Date})}clone(){var d={access:this.access,accessInformation:this.accessInformation,applicationProxies:N.clone(this.applicationProxies),avgRating:this.avgRating,categories:N.clone(this.categories),classification:N.clone(this.classification),created:N.clone(this.created),culture:this.culture,description:this.description,extent:N.clone(this.extent),groupCategories:N.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:N.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:N.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:N.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:N.clone(this.typeKeywords),url:this.url};this.loaded&&(d.loadStatus="loaded");d=(new b({sourceJSON:this.sourceJSON})).set(d);
d._set("isOrgItem",this.isOrgItem);return d}createPostQuery(){const d=this.toJSON();for(var z of["tags","typeKeywords","categories"])d[z]=d[z]?.join(", ");for(const M of["extent","classification"])(z=d[M])&&(d[M]=JSON.stringify(z));return d}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(d="json",z){return this.portal.request(this.itemUrl+"/data",{responseType:d,...z,query:{token:this.apiKey}})}async fetchRating(d){d=await this.portal.request(this.itemUrl+
"/rating",{query:{token:this.apiKey},...d});return null!=d.rating?(d.created=new Date(d.created),new K(d)):null}fetchRelatedItems(d,z){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...d,token:this.apiKey},...z},b)}getThumbnailUrl(d){let z=this.thumbnailUrl;z&&d&&(z+=`&w=${d}`);return z}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(d=>{this.applicationProxies&&!Object.hasOwn(d,"appProxies")&&(this.applicationProxies=
null);this.sourceJSON=d;this.read(d);return this})}update(d){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const z=d?.data,M={method:"post"};M.query=this.createPostQuery();for(const Q in M.query)null===M.query[Q]&&(M.query[Q]="");M.query.clearEmptyFields=!0;null!=z&&("string"===typeof z?M.query.text=z:"object"===typeof z&&(M.query.text=JSON.stringify(z)));return this.portal.request(`${this.userItemUrl}/update`,M).then(()=>this.reload())}):Promise.reject(new D("portal:item-does-not-exist",
"The item does not exist yet and cannot be updated"))}async copy(d){if(!this.id)throw new D("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:z,itemUrl:M}=this;await z.signIn();const {copyResources:Q,folder:Z,tags:U,title:T}=d||{};d={method:"post",query:{copyPrivateResources:"all"===Q,folder:"string"===typeof Z?Z:Z?.id,includeResources:!!Q,tags:U?.join(","),title:T}};({itemId:d}=await z.request(`${M}/copy`,d));return new b({id:d,portal:z})}updateThumbnail(d){return this.id?
this.load().then(()=>this.portal.signIn()).then(()=>{const z=d.thumbnail,M=d.filename,Q={method:"post"};if("string"===typeof z)p.isDataProtocol(z)?Q.query={data:z}:Q.query={url:p.makeAbsolute(z)},null!=M&&(Q.query.filename=M);else{const Z=new FormData;null!=M?Z.append("file",z,M):Z.append("file",z);Q.body=Z}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,Q).then(()=>this.reload())}):Promise.reject(new D("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(d=
{},z){const {fetchResources:M}=await new Promise((Q,Z)=>e(["./support/resourceUtils"],Q,Z));return M(this,d,z)}async addResource(d,z,M){const {addOrUpdateResources:Q}=await new Promise((Z,U)=>e(["./support/resourceUtils"],Z,U));d.portalItem=this;await Q(this,[{resource:d,content:z,compress:M?.compress,access:M?.access}],"add",M);return d}async removeResource(d,z){const {removeResource:M}=await new Promise((Q,Z)=>e(["./support/resourceUtils"],Q,Z));if(d.portalItem&&d.portalItem.itemUrl!==this.itemUrl)throw new D("removeresource:portal-item-mismatch",
"The portal item associated with the provided resource does not match the item");return M(this,d,z)}async removeAllResources(d){const {removeAllResources:z}=await new Promise((M,Q)=>e(["./support/resourceUtils"],M,Q));return z(this,d)}resourceFromPath(d){return new J({portalItem:this,path:d})}toJSON(){var d=this.extent;d={accessInformation:this.accessInformation,categories:N.clone(this.categories),classification:N.clone(this.classification),created:this.created?.getTime(),description:this.description,
extent:d&&[[d.xmin,d.ymin],[d.xmax,d.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:N.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:N.clone(this.typeKeywords),url:this.url};return N.fixJson(d)}static fromJSON(d){if(!d)return null;if(d.declaredClass)throw Error("JSON object is already hydrated");
return new b({sourceJSON:d})}_getPostQuery(){const d=this.toJSON();for(const z in d)"tags"===z&&null!==d[z]&&(d[z]=d[z].join(", ")),"typeKeywords"===z&&null!==d[z]&&(d[z]=d[z].join(", ")),"extent"===z&&d[z]&&(d[z]=JSON.stringify(d[z]));return d}};l.__decorate([k.property({type:["private","shared","org","public"]})],t.prototype,"access",void 0);l.__decorate([k.property()],t.prototype,"accessInformation",void 0);l.__decorate([k.property({type:String})],t.prototype,"apiKey",void 0);l.__decorate([k.property({json:{read:{source:"appProxies"}}})],
t.prototype,"applicationProxies",void 0);l.__decorate([k.property()],t.prototype,"avgRating",void 0);l.__decorate([k.property()],t.prototype,"categories",void 0);l.__decorate([k.property()],t.prototype,"classification",void 0);l.__decorate([k.property({type:Date})],t.prototype,"created",void 0);l.__decorate([k.property()],t.prototype,"culture",void 0);l.__decorate([k.property()],t.prototype,"description",void 0);l.__decorate([k.property({readOnly:!0})],t.prototype,"displayName",null);l.__decorate([k.property({type:G})],
t.prototype,"extent",void 0);l.__decorate([w.reader("extent")],t.prototype,"readExtent",null);l.__decorate([k.property()],t.prototype,"groupCategories",void 0);l.__decorate([k.property({readOnly:!0})],t.prototype,"iconUrl",null);l.__decorate([k.property()],t.prototype,"id",void 0);l.__decorate([k.property({readOnly:!0})],t.prototype,"isLayer",null);l.__decorate([k.property({type:Boolean,readOnly:!0})],t.prototype,"isOrgItem",void 0);l.__decorate([k.property()],t.prototype,"itemControl",void 0);l.__decorate([k.property({readOnly:!0})],
t.prototype,"itemPageUrl",null);l.__decorate([k.property({readOnly:!0})],t.prototype,"itemUrl",null);l.__decorate([k.property()],t.prototype,"licenseInfo",void 0);l.__decorate([k.property({type:Date})],t.prototype,"modified",void 0);l.__decorate([k.property()],t.prototype,"name",void 0);l.__decorate([k.property()],t.prototype,"numComments",void 0);l.__decorate([k.property()],t.prototype,"numRatings",void 0);l.__decorate([k.property()],t.prototype,"numViews",void 0);l.__decorate([k.property()],t.prototype,
"owner",void 0);l.__decorate([k.property()],t.prototype,"ownerFolder",void 0);l.__decorate([k.property({type:r})],t.prototype,"portal",void 0);l.__decorate([k.property()],t.prototype,"screenshots",void 0);l.__decorate([k.property()],t.prototype,"size",void 0);l.__decorate([k.property()],t.prototype,"snippet",void 0);l.__decorate([k.property()],t.prototype,"sourceJSON",void 0);l.__decorate([k.property({type:String})],t.prototype,"sourceUrl",void 0);l.__decorate([k.property({type:String})],t.prototype,
"spatialReference",void 0);l.__decorate([k.property()],t.prototype,"tags",void 0);l.__decorate([k.property()],t.prototype,"thumbnail",void 0);l.__decorate([k.property({readOnly:!0})],t.prototype,"thumbnailUrl",null);l.__decorate([k.property()],t.prototype,"title",void 0);l.__decorate([k.property()],t.prototype,"type",void 0);l.__decorate([k.property()],t.prototype,"typeKeywords",void 0);l.__decorate([k.property({type:String,json:{read(d,z){L.has(z.type)&&(z=this.portal?.restUrl,d||=z&&this.id?`${z}/content/items/${this.id}/data`:
null);return d}}})],t.prototype,"url",void 0);l.__decorate([k.property({readOnly:!0})],t.prototype,"userItemUrl",null);return t=b=l.__decorate([I.subclass("esri.portal.PortalItem")],t)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w){function I(G,r){if(null==G)return G;G=G.replace(/^\/+/,"");null!=r&&N.isAbsolute(G)&&(G=N.makeRelative(G,r.itemUrl));return G?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}x=class extends x{constructor(G){super(G);this.portalItem=null}normalizeCtorArgs(G){return G?.portalItem&&G.path?{...G,path:I(G.path,G.portalItem)}:G}set path(G){null!=G&&N.isAbsolute(G)?t.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",G)}_castPath(G){return I(G,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(G="json",r){const J=this.cdnUrl;if(null==J)throw new D("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(J,{responseType:G,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(G,r){const {addOrUpdateResources:J}=await new Promise((K,v)=>e(["./support/resourceUtils"],K,v));await J(this.portalItem,[{resource:this,content:G,compress:r?.compress,access:r?.access}],"update",r);return this}hasPath(){return null!=this.path}};l.__decorate([a.property()],x.prototype,"portalItem",void 0);l.__decorate([a.property({type:String,
value:null})],x.prototype,"path",null);l.__decorate([p.cast("path")],x.prototype,"_castPath",null);l.__decorate([a.property({type:String,readOnly:!0})],x.prototype,"url",null);l.__decorate([a.property({type:String,readOnly:!0})],x.prototype,"cdnUrl",null);l.__decorate([a.property({type:String,readOnly:!0})],x.prototype,"itemRelativeUrl",null);return x=l.__decorate([w.subclass("esri.portal.PortalItemResource")],x)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,x,D,t,N,a){l=class extends l{constructor(p){super(p);this.rating=this.created=null}};e.__decorate([x.property()],l.prototype,"created",void 0);e.__decorate([x.property()],l.prototype,"rating",void 0);return l=e.__decorate([a.subclass("esri.portal.PortalRating")],l)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(e,l,x,D){function t(b,q){var L=q?.url?.path;b&&L&&(b=x.makeAbsolute(b,L,{preserveProtocolRelative:!0}),
q.portalItem&&q.readResourcePaths&&(L=x.makeRelative(b,q.portalItem.itemUrl),null!=L&&K.test(L)&&q.readResourcePaths.push(q.portalItem.resourceFromPath(L).path)));return(b=I(b,q?.portal))&&J.test(b)?G(b):b}function N(b,q,L=e.MarkKeep.YES){b=b&&J.test(b)?r(b):b;if(null==b)return b;!x.isAbsolute(b)&&q?.blockedRelativeUrls&&q.blockedRelativeUrls.push(b);let d=x.makeAbsolute(b);if(q){var z=q.verifyItemRelativeUrls?.rootPath||q.url?.path;if(z){z=I(z,q.portal);const M=I(d,q.portal);d=x.makeRelative(M,z,
z);null!=d&&d!==M&&d!==b&&q.verifyItemRelativeUrls&&q.verifyItemRelativeUrls.writtenUrls.push(d)}}d=w(d,q?.portal);x.isAbsolute(d)&&(d=x.normalize(d));q?.resources&&q?.portalItem&&!x.isAbsolute(d)&&!x.isDataProtocol(d)&&L===e.MarkKeep.YES&&q.resources.toKeep.push({resource:q.portalItem.resourceFromPath(d),compress:!1});return d}function a(b,q,L){return t(b,L)}function p(b,q,L,d){b=N(b,d);void 0!==b&&(q[L]=b)}function k(b){return(b?.match(J)??null)?.[1]??null}function y(b){b=b?.match(J)??null;if(null==
b)return null;b=b[2];const q=b.lastIndexOf("/");if(-1===q){const {path:z,extension:M}=x.splitPathExtension(b);return{prefix:null,filename:z,extension:M}}const {path:L,extension:d}=x.splitPathExtension(b.slice(q+1));return{prefix:b.slice(0,q),filename:L,extension:d}}function w(b,q){return q&&!q.isPortal&&q.urlKey&&q.customBaseUrl?x.changeDomain(b,`${q.urlKey}.${q.customBaseUrl}`,q.portalHostname):b}function I(b,q){if(!q||q.isPortal||!q.urlKey||!q.customBaseUrl)return b;const L=`${q.urlKey}.${q.customBaseUrl}`,
d=x.getAppUrl();return x.hasSameOrigin(d,`${d.scheme}://${L}`)?x.changeDomain(b,q.portalHostname,L):x.changeDomain(b,L,q.portalHostname)}function G(b){if(!b)return b||null;b&&l.id&&!l.id.findCredential(b)&&(b=D.normalizeArcGISOnlineOrgDomain(b),b=b.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),b=b.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),b=b.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return b}function r(b){if(!b)return b||
null;b=b.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");b=b.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(b=b.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&l.id&&!l.id.findCredential(b)&&(b=D.normalizeArcGISOnlineOrgDomain(b));return b}const J=/\/items\/([^/]+)\/resources\/(.*)/,K=/^\.\/resources\//;e.MarkKeep=void 0;(function(b){b[b.YES=0]="YES";b[b.NO=1]="NO"})(e.MarkKeep||(e.MarkKeep={}));const v=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return e.MarkKeep},ensureMainOnlineDomain:w,fromCDNUrl:r,fromJSON:t,itemIdFromResourceUrl:k,prefixAndFilenameFromResourceUrl:y,read:a,toCDNUrl:G,toJSON:N,write:p},Symbol.toStringTag,{value:"Module"}));e.ensureMainOnlineDomain=w;e.fromCDNUrl=r;e.fromJSON=t;e.itemIdFromResourceUrl=k;e.persistableUrlUtils=v;e.prefixAndFilenameFromResourceUrl=y;e.read=a;e.toCDNUrl=G;e.toJSON=N;e.write=p})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(e,
l,x){e.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return l.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};e.getBasemapTitle=async function(D){if(D){var t=D.includes("-vector")?D.slice(0,D.indexOf("-vector")):
D.includes("-3d")?D.slice(0,D.indexOf("-3d")):D,N=await x.fetchMessageBundle("esri/t9n/basemaps");return N[D]||N[t]}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(e,l,x,D,t,N,a,p){const k=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
l=class extends l{constructor(y){super(y);this.places=this.language=this.id=this.apiKey=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var y=p.getLocale().toLowerCase();switch(y){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}y=p.getLanguage(y);return"pt"===y?"pt-BR":y&&k.has(y)?
y:"global"}};e.__decorate([x.property()],l.prototype,"apiKey",void 0);e.__decorate([x.property()],l.prototype,"id",void 0);e.__decorate([x.property()],l.prototype,"language",void 0);e.__decorate([x.property()],l.prototype,"places",void 0);e.__decorate([x.property()],l.prototype,"serviceUrl",void 0);e.__decorate([x.property()],l.prototype,"worldview",void 0);return l=e.__decorate([a.subclass("esri.support.BasemapStyle")],l)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(e,l,x,D,t,N){function a(y,w){"maxScale"in y&&(w.maxScale=t.numberToJSON(y.maxScale)??void 0);"minScale"in y&&(w.minScale=t.numberToJSON(y.minScale)??void 0)}const p=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),k=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
e.disableRestrictedWriting=function(y){p.add(y);k.add(y)};e.enableRestrictedWriting=function(y){p.delete(y);k.delete(y)};e.getLayerJSON=function(y,w,I){if(!y.persistenceEnabled)return null;if(!("write"in y&&y.write))return I?.messages&&I.messages.push(new l("layer:unsupported",`Layers (${y.title}, ${y.id}) of type '${y.declaredClass}' cannot be persisted`,{layer:y})),null;if(N.isFeatureCollectionLayer(y)&&!y.isTable)w=y.resourceInfo;else{if(I.restrictedWebMapWriting){var G="basemap"===I.layerContainerType?
p:"operational-layers"===I.layerContainerType?k:null;G=null!=G?G.has(y.type)&&!N.isFeatureCollectionLayer(y):!0}else G=!0;if(G)return w={},y.write(w,I)?w:null}if(null!=w){w=x.clone(w);if(I=w)N.isFeatureCollectionLayer(y)?(G=D.getDeepValue("featureCollection.layers",I)?.[0]?.layerDefinition)&&a(y,G):"group"!==y.type&&a(y,I);if(I&&(I.id=y.id,"blendMode"in y&&(I.blendMode=y.blendMode,"normal"===I.blendMode&&delete I.blendMode),I.opacity=t.numberToJSON(y.opacity)??void 0,I.title=y.title||"Layer",I.visibility=
y.visible,"legendEnabled"in y&&"wmts"!==y.type))if(N.isFeatureCollectionLayer(y)){if(I=I.featureCollection)I.showLegend=y.legendEnabled}else I.showLegend=y.legendEnabled}return w};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(e,l,x){function D(a){return"scene"===a?.type}function t(a){return null!=a&&"object"===typeof a&&"type"in a&&"subtype-group"===a.type&&"sublayers"in a}function N(a){a=
a?.type;return"imagery-tile"===a||"tile"===a||"open-street-map"===a||"vector-tile"===a||"web-tile"===a||"wmts"===a}e.getEffectiveEditingEnabled=function(a){a:if("editingEnabled"in a)switch(a.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveEditingEnabled"in a?a.effectiveEditingEnabled:a.editingEnabled:!1};e.getEffectiveLayerCapabilities=function(a){a:if("capabilities"in
a)switch(a.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveCapabilities"in a?a.effectiveCapabilities:a.capabilities:null};e.getOwningPortalUrl=async function(a,p){var k=l.id?.findServerInfo(a);if(null!=k?.currentVersion)return k.owningSystemUrl||
null;k=a.toLowerCase().indexOf("/rest/services");if(-1===k)return null;a=`${a.slice(0,k)}/rest/info`;({data:p}=await x(a,{query:{f:"json"},responseType:"json",signal:null!=p?p.signal:null}));return p?.owningSystemUrl||null};e.getSubtypesFromLayer=function(a){return a?("subtypes"in a?a.subtypes:t(a.parent)?a.parent.subtypes:[])??[]:[]};e.getTileMaxtrixSetFromActiveLayer=function(a){if(a.activeLayer){const p=a.activeLayer.tileMatrixSet;if(p)return p;if(a=a.activeLayer.tileMatrixSets)return a}return null};
e.isBaseLayer=function(a){return null!=a?.parent&&"declaredClass"in a.parent&&"esri.Basemap"===a.parent.declaredClass&&a.parent.baseLayers.includes(a)};e.isBasemap3DSupportedLayer=function(a){return N(a)||D(a)};e.isBasemapSupportedTiledLayer=N;e.isFeatureCollectionLayer=function(a){return"feature"===a?.type&&!a.url&&"memory"===a.source?.type};e.isFeatureLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"feature"===a.type};e.isFeatureServiceLayer=function(a){return"feature"===a?.type&&
"feature-layer"===a.source?.type};e.isGraphicsLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"graphics"===a.type};e.isGroupLayer=function(a){return null!=a&&"type"in a&&"group"===a.type};e.isImageryTileLayer=function(a){return"imagery-tile"===a?.type};e.isIntegratedMeshLayer=function(a){return"integrated-mesh"===a||"integrated-mesh-3dtiles"===a};e.isIntegratedMeshOperationalLayer=function(a){return"IntegratedMeshLayer"===a||"IntegratedMesh3DTilesLayer"===a};e.isKnowledgeGraphLayer=
function(a){return null!=a&&"object"===typeof a&&"type"in a&&"knowledge-graph"===a.type&&"layers"in a};e.isLayerWithFeatureLayerSource=function(a){const p=a?.type;return("feature"===p||"subtype-group"===p||"oriented-imagery"===p)&&"feature-layer"===a.source?.type};e.isLinkChartLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"link-chart"===a.type&&"layers"in a};e.isMapNotesLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"map-notes"===a.type&&"sublayers"in a};e.isSceneLayer=
D;e.isSceneServiceLayer=function(a){a=a?.type;return"building-scene"===a||"integrated-mesh"===a||"point-cloud"===a||"scene"===a};e.isSubtypeGroupLayer=t;e.isSubtypeSublayer=function(a){return"subtype-sublayer"===a?.type};e.isTable=function(a){return null!=a&&"object"===typeof a&&"isTable"in a&&!!a.isTable};e.isTiledLayer=function(a){a=a?.type;return"base-tile"===a||"tile"===a||"elevation"===a||"imagery-tile"===a||"base-elevation"===a||"open-street-map"===a||"wcs"===a||"web-tile"===a||"wmts"===a||
"vector-tile"===a};e.isVoxelLayer=function(a){return"voxel"===a?.type};e.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};e.serializeLayerDefinitions=function(a){const p=/[:;]/,k=[];let y=!1;if(a&&(a.forEach((w,I)=>{k.push([I,w]);!y&&p.test(w)&&(y=!0)}),0<k.length)){if(y){const w={};k.forEach(I=>{w[I[0]]=I[1]});a=JSON.stringify(w)}else{const w=[];k.forEach(I=>{w.push(I[0]+":"+
I[1])});a=w.join(";")}return a}return null};e.serializeTimeOptions=function(a){if(a){var p=[];a.forEach((k,y)=>{p.push('"'+y+'":'+JSON.stringify(k))});if(p.length)return"{"+p.join(",")+"}"}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(e,l){e.canInterpolateEffects=function(x,D){const t=x.length>D.length?x:D;return(x.length>D.length?D:x).every((N,a)=>N.type===t[a].type)};e.effectEquals=function(x,D){x=
JSON.stringify(x??null);D=JSON.stringify(D??null);return x===D};e.isEffectFunctions=function(x){return(x=x[0])?"type"in x:!1};e.normalizeEffects=function(x,D){const t=x.length>D.length?x:D;x=x.length>D.length?D:x;for(D=x.length;D<t.length;D++)x.push(l.createEffectWithInitialValues(t[D]))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32",
"./colorMatrixFunctions"],function(e,l,x,D,t){function N(r,J,K){return r+(J-r)*K}function a(r){return Math.round(1E3*x.px2pt(r))/1E3}class p{constructor(r,J,K){this.strength=r;this.radius=J;this.threshold=K;this.type="bloom"}interpolate(r,J,K){this.strength=N(r.strength,J.strength,K);this.radius=N(r.radius,J.radius,K);this.threshold=N(r.threshold,J.threshold,K)}clone(){return new p(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:a(this.radius),strength:this.strength,
threshold:this.threshold}}}class k{constructor(r){this.radius=r;this.type="blur"}interpolate(r,J,K){this.radius=Math.round(N(r.radius,J.radius,K))}clone(){return new k(this.radius)}toJSON(){return{type:"blur",radius:a(this.radius)}}}class y{constructor(r,J){this.type=r;this.amount=J;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(r,J,K){this.amount=
N(r.amount,J.amount,K);this._updateMatrix()}clone(){return new y(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const r=this._colorMatrix||D.create();switch(this.type){case "brightness":this._colorMatrix=t.brightness(r,this.amount);break;case "contrast":this._colorMatrix=t.contrast(r,this.amount);break;case "grayscale":this._colorMatrix=t.grayscale(r,this.amount);break;case "invert":this._colorMatrix=t.invert(r,this.amount);break;case "saturate":this._colorMatrix=
t.saturate(r,this.amount);break;case "sepia":this._colorMatrix=t.sepia(r,this.amount)}}}class w{constructor(r,J,K,v){this.offsetX=r;this.offsetY=J;this.blurRadius=K;this.color=v;this.type="drop-shadow"}interpolate(r,J,K){this.offsetX=N(r.offsetX,J.offsetX,K);this.offsetY=N(r.offsetY,J.offsetY,K);this.blurRadius=N(r.blurRadius,J.blurRadius,K);this.color[0]=Math.round(N(r.color[0],J.color[0],K));this.color[1]=Math.round(N(r.color[1],J.color[1],K));this.color[2]=Math.round(N(r.color[2],J.color[2],K));
this.color[3]=N(r.color[3],J.color[3],K)}clone(){return new w(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const r=[...this.color];r[3]*=255;return{type:"drop-shadow",xoffset:a(this.offsetX),yoffset:a(this.offsetY),blurRadius:a(this.blurRadius),color:r}}}class I{constructor(r){this.angle=r;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(r,J,K){this.angle=N(r.angle,J.angle,K);this._updateMatrix()}clone(){return new I(this.angle)}toJSON(){return{type:"hue-rotate",
angle:this.angle}}_updateMatrix(){const r=this._colorMatrix||D.create();this._colorMatrix=t.rotateHue(r,this.angle)}}class G{constructor(r){this.amount=r;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(r,J,K){this.amount=N(r.amount,J.amount,K)}clone(){return new G(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}e.BloomEffect=p;e.BlurEffect=k;e.ColorMatrixEffect=y;e.DropShadowEffect=w;e.HueRotateEffect=I;e.OpacityEffect=G;e.createEffectWithInitialValues=function(r){switch(r.type){case "grayscale":case "sepia":case "invert":return new y(r.type,
0);case "saturate":case "brightness":case "contrast":return new y(r.type,1);case "opacity":return new G(1);case "hue-rotate":return new I(0);case "blur":return new k(0);case "drop-shadow":return new w(0,0,0,[...l.getNamedColor("transparent")]);case "bloom":return new p(0,0,1)}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(e){function l(){const p=new Float32Array(16);p[0]=1;p[5]=1;p[10]=1;p[15]=
1;return p}function x(p){const k=new Float32Array(16);k[0]=p[0];k[1]=p[1];k[2]=p[2];k[3]=p[3];k[4]=p[4];k[5]=p[5];k[6]=p[6];k[7]=p[7];k[8]=p[8];k[9]=p[9];k[10]=p[10];k[11]=p[11];k[12]=p[12];k[13]=p[13];k[14]=p[14];k[15]=p[15];return k}function D(p,k,y,w,I,G,r,J,K,v,b,q,L,d,z,M){const Q=new Float32Array(16);Q[0]=p;Q[1]=k;Q[2]=y;Q[3]=w;Q[4]=I;Q[5]=G;Q[6]=r;Q[7]=J;Q[8]=K;Q[9]=v;Q[10]=b;Q[11]=q;Q[12]=L;Q[13]=d;Q[14]=z;Q[15]=M;return Q}function t(p,k){return new Float32Array(p,k,16)}const N=l(),a=Object.freeze(Object.defineProperty({__proto__:null,
IDENTITY:N,clone:x,create:l,createView:t,fromValues:D},Symbol.toStringTag,{value:"Module"}));e.IDENTITY=N;e.clone=x;e.create=l;e.createView=t;e.fromValues=D;e.mat4f32=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(e,l){e.brightness=(x,D)=>{x=l.set(x,D,0,0,0,0,D,0,0,0,0,D,0,0,0,0,1);return l.transpose(x,x)};e.contrast=(x,D)=>{x=l.set(x,D,0,0,.5-.5*D,0,D,0,.5-
.5*D,0,0,D,.5-.5*D,0,0,0,1);return l.transpose(x,x)};e.grayscale=(x,D)=>{D=1-D;x=l.set(x,.2126+.7874*D,.7152-.7152*D,.0722-.0722*D,0,.2126-.2126*D,.7152+.2848*D,.0722-.0722*D,0,.2126-.2126*D,.7152-.7152*D,.0722+.9278*D,0,0,0,0,1);return l.transpose(x,x)};e.invert=(x,D)=>{const t=1-2*D;x=l.set(x,t,0,0,D,0,t,0,D,0,0,t,D,0,0,0,1);return l.transpose(x,x)};e.rotateHue=(x,D)=>{const t=Math.sin(D*Math.PI/180);D=Math.cos(D*Math.PI/180);x=l.set(x,.213+.787*D-.213*t,.715-.715*D-.715*t,.072-.072*D+.928*t,0,
.213-.213*D+.143*t,.715+.285*D+.14*t,.072-.072*D-.283*t,0,.213-.213*D-.787*t,.715-.715*D+.715*t,.072+.928*D+.072*t,0,0,0,0,1);return l.transpose(x,x)};e.saturate=(x,D)=>{x=l.set(x,.213+.787*D,.715-.715*D,.072-.072*D,0,.213-.213*D,.715+.285*D,.072-.072*D,0,.213-.213*D,.715-.715*D,.072+.928*D,0,0,0,0,1);return l.transpose(x,x)};e.sepia=(x,D)=>{D=1-D;x=l.set(x,.393+.607*D,.769-.769*D,.189-.189*D,0,.349-.349*D,.686+.314*D,.168-.168*D,0,.272-.272*D,.534-.534*D,.131+.869*D,0,0,0,0,1);return l.transpose(x,
x)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(e,l,x){function D(m,F){m[0]=F[0];m[1]=F[1];m[2]=F[2];m[3]=F[3];m[4]=F[4];m[5]=F[5];m[6]=F[6];m[7]=F[7];m[8]=F[8];m[9]=F[9];m[10]=F[10];m[11]=F[11];m[12]=F[12];m[13]=F[13];m[14]=F[14];m[15]=F[15];return m}function t(m,F,W,ba,ja,C,H,O,V,aa,da,ea,la,ma,ua,qa,ra){m[0]=F;m[1]=W;m[2]=ba;m[3]=ja;m[4]=C;m[5]=H;m[6]=O;m[7]=V;m[8]=
aa;m[9]=da;m[10]=ea;m[11]=la;m[12]=ma;m[13]=ua;m[14]=qa;m[15]=ra;return m}function N(m){m[0]=1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function a(m,F){if(m===F){const W=F[1],ba=F[2],ja=F[3],C=F[6],H=F[7],O=F[11];m[1]=F[4];m[2]=F[8];m[3]=F[12];m[4]=W;m[6]=F[9];m[7]=F[13];m[8]=ba;m[9]=C;m[11]=F[14];m[12]=ja;m[13]=H;m[14]=O}else m[0]=F[0],m[1]=F[4],m[2]=F[8],m[3]=F[12],m[4]=F[1],m[5]=F[5],m[6]=F[9],m[7]=F[13],m[8]=F[2],m[9]=
F[6],m[10]=F[10],m[11]=F[14],m[12]=F[3],m[13]=F[7],m[14]=F[11],m[15]=F[15];return m}function p(m,F){k(m,F)||N(m);return m}function k(m,F){const W=F[0],ba=F[1],ja=F[2],C=F[3],H=F[4],O=F[5],V=F[6],aa=F[7],da=F[8],ea=F[9],la=F[10],ma=F[11],ua=F[12],qa=F[13],ra=F[14];F=F[15];const Ba=W*O-ba*H,ya=W*V-ja*H,Aa=W*aa-C*H,Ca=ba*V-ja*O,za=ba*aa-C*O,Fa=ja*aa-C*V,Ra=da*qa-ea*ua,bb=da*ra-la*ua,cb=da*F-ma*ua,Xa=ea*ra-la*qa,Ma=ea*F-ma*qa,Na=la*F-ma*ra;let ha=Ba*Na-ya*Ma+Aa*Xa+Ca*cb-za*bb+Fa*Ra;if(!ha)return null;
ha=1/ha;m[0]=(O*Na-V*Ma+aa*Xa)*ha;m[1]=(ja*Ma-ba*Na-C*Xa)*ha;m[2]=(qa*Fa-ra*za+F*Ca)*ha;m[3]=(la*za-ea*Fa-ma*Ca)*ha;m[4]=(V*cb-H*Na-aa*bb)*ha;m[5]=(W*Na-ja*cb+C*bb)*ha;m[6]=(ra*Aa-ua*Fa-F*ya)*ha;m[7]=(da*Fa-la*Aa+ma*ya)*ha;m[8]=(H*Ma-O*cb+aa*Ra)*ha;m[9]=(ba*cb-W*Ma-C*Ra)*ha;m[10]=(ua*za-qa*Aa+F*Ba)*ha;m[11]=(ea*Aa-da*za-ma*Ba)*ha;m[12]=(O*bb-H*Xa-V*Ra)*ha;m[13]=(W*Xa-ba*bb+ja*Ra)*ha;m[14]=(qa*ya-ua*Ca-ra*Ba)*ha;m[15]=(da*Ca-ea*ya+la*Ba)*ha;return m}function y(m,F){const W=F[0],ba=F[1],ja=F[2],C=F[3],
H=F[4],O=F[5],V=F[6],aa=F[7],da=F[8],ea=F[9],la=F[10],ma=F[11],ua=F[12],qa=F[13],ra=F[14];F=F[15];m[0]=O*(la*F-ma*ra)-ea*(V*F-aa*ra)+qa*(V*ma-aa*la);m[1]=-(ba*(la*F-ma*ra)-ea*(ja*F-C*ra)+qa*(ja*ma-C*la));m[2]=ba*(V*F-aa*ra)-O*(ja*F-C*ra)+qa*(ja*aa-C*V);m[3]=-(ba*(V*ma-aa*la)-O*(ja*ma-C*la)+ea*(ja*aa-C*V));m[4]=-(H*(la*F-ma*ra)-da*(V*F-aa*ra)+ua*(V*ma-aa*la));m[5]=W*(la*F-ma*ra)-da*(ja*F-C*ra)+ua*(ja*ma-C*la);m[6]=-(W*(V*F-aa*ra)-H*(ja*F-C*ra)+ua*(ja*aa-C*V));m[7]=W*(V*ma-aa*la)-H*(ja*ma-C*la)+da*
(ja*aa-C*V);m[8]=H*(ea*F-ma*qa)-da*(O*F-aa*qa)+ua*(O*ma-aa*ea);m[9]=-(W*(ea*F-ma*qa)-da*(ba*F-C*qa)+ua*(ba*ma-C*ea));m[10]=W*(O*F-aa*qa)-H*(ba*F-C*qa)+ua*(ba*aa-C*O);m[11]=-(W*(O*ma-aa*ea)-H*(ba*ma-C*ea)+da*(ba*aa-C*O));m[12]=-(H*(ea*ra-la*qa)-da*(O*ra-V*qa)+ua*(O*la-V*ea));m[13]=W*(ea*ra-la*qa)-da*(ba*ra-ja*qa)+ua*(ba*la-ja*ea);m[14]=-(W*(O*ra-V*qa)-H*(ba*ra-ja*qa)+ua*(ba*V-ja*O));m[15]=W*(O*la-V*ea)-H*(ba*la-ja*ea)+da*(ba*V-ja*O);return m}function w(m){const F=m[0],W=m[1],ba=m[2],ja=m[3],C=m[4],
H=m[5],O=m[6],V=m[7],aa=m[8],da=m[9],ea=m[10],la=m[11],ma=m[12],ua=m[13],qa=m[14];m=m[15];return(F*H-W*C)*(ea*m-la*qa)-(F*O-ba*C)*(da*m-la*ua)+(F*V-ja*C)*(da*qa-ea*ua)+(W*O-ba*H)*(aa*m-la*ma)-(W*V-ja*H)*(aa*qa-ea*ma)+(ba*V-ja*O)*(aa*ua-da*ma)}function I(m,F,W){const ba=F[0],ja=F[1],C=F[2],H=F[3],O=F[4],V=F[5],aa=F[6],da=F[7],ea=F[8],la=F[9],ma=F[10],ua=F[11],qa=F[12],ra=F[13],Ba=F[14];F=F[15];let ya=W[0],Aa=W[1],Ca=W[2],za=W[3];m[0]=ya*ba+Aa*O+Ca*ea+za*qa;m[1]=ya*ja+Aa*V+Ca*la+za*ra;m[2]=ya*C+Aa*
aa+Ca*ma+za*Ba;m[3]=ya*H+Aa*da+Ca*ua+za*F;ya=W[4];Aa=W[5];Ca=W[6];za=W[7];m[4]=ya*ba+Aa*O+Ca*ea+za*qa;m[5]=ya*ja+Aa*V+Ca*la+za*ra;m[6]=ya*C+Aa*aa+Ca*ma+za*Ba;m[7]=ya*H+Aa*da+Ca*ua+za*F;ya=W[8];Aa=W[9];Ca=W[10];za=W[11];m[8]=ya*ba+Aa*O+Ca*ea+za*qa;m[9]=ya*ja+Aa*V+Ca*la+za*ra;m[10]=ya*C+Aa*aa+Ca*ma+za*Ba;m[11]=ya*H+Aa*da+Ca*ua+za*F;ya=W[12];Aa=W[13];Ca=W[14];za=W[15];m[12]=ya*ba+Aa*O+Ca*ea+za*qa;m[13]=ya*ja+Aa*V+Ca*la+za*ra;m[14]=ya*C+Aa*aa+Ca*ma+za*Ba;m[15]=ya*H+Aa*da+Ca*ua+za*F;return m}function G(m,
F,W){const ba=W[0],ja=W[1];W=W[2];if(F===m)m[12]=F[0]*ba+F[4]*ja+F[8]*W+F[12],m[13]=F[1]*ba+F[5]*ja+F[9]*W+F[13],m[14]=F[2]*ba+F[6]*ja+F[10]*W+F[14],m[15]=F[3]*ba+F[7]*ja+F[11]*W+F[15];else{const C=F[0],H=F[1],O=F[2],V=F[3],aa=F[4],da=F[5],ea=F[6],la=F[7],ma=F[8],ua=F[9],qa=F[10],ra=F[11];m[0]=C;m[1]=H;m[2]=O;m[3]=V;m[4]=aa;m[5]=da;m[6]=ea;m[7]=la;m[8]=ma;m[9]=ua;m[10]=qa;m[11]=ra;m[12]=C*ba+aa*ja+ma*W+F[12];m[13]=H*ba+da*ja+ua*W+F[13];m[14]=O*ba+ea*ja+qa*W+F[14];m[15]=V*ba+la*ja+ra*W+F[15]}return m}
function r(m,F,W){const ba=W[0],ja=W[1];W=W[2];m[0]=F[0]*ba;m[1]=F[1]*ba;m[2]=F[2]*ba;m[3]=F[3]*ba;m[4]=F[4]*ja;m[5]=F[5]*ja;m[6]=F[6]*ja;m[7]=F[7]*ja;m[8]=F[8]*W;m[9]=F[9]*W;m[10]=F[10]*W;m[11]=F[11]*W;m[12]=F[12];m[13]=F[13];m[14]=F[14];m[15]=F[15];return m}function J(m,F,W,ba){var ja=ba[0],C=ba[1];ba=ba[2];var H=Math.sqrt(ja*ja+C*C+ba*ba);if(H<=x.getEpsilon())D(m,F);else{H=1/H;ja*=H;C*=H;ba*=H;var O=Math.sin(W),V=Math.cos(W),aa=1-V;W=F[0];H=F[1];var da=F[2],ea=F[3],la=F[4],ma=F[5],ua=F[6],qa=F[7],
ra=F[8],Ba=F[9],ya=F[10],Aa=F[11],Ca=ja*ja*aa+V,za=C*ja*aa+ba*O,Fa=ba*ja*aa-C*O,Ra=ja*C*aa-ba*O,bb=C*C*aa+V,cb=ba*C*aa+ja*O,Xa=ja*ba*aa+C*O;ja=C*ba*aa-ja*O;C=ba*ba*aa+V;m[0]=W*Ca+la*za+ra*Fa;m[1]=H*Ca+ma*za+Ba*Fa;m[2]=da*Ca+ua*za+ya*Fa;m[3]=ea*Ca+qa*za+Aa*Fa;m[4]=W*Ra+la*bb+ra*cb;m[5]=H*Ra+ma*bb+Ba*cb;m[6]=da*Ra+ua*bb+ya*cb;m[7]=ea*Ra+qa*bb+Aa*cb;m[8]=W*Xa+la*ja+ra*C;m[9]=H*Xa+ma*ja+Ba*C;m[10]=da*Xa+ua*ja+ya*C;m[11]=ea*Xa+qa*ja+Aa*C;F!==m&&(m[12]=F[12],m[13]=F[13],m[14]=F[14],m[15]=F[15])}}function K(m,
F,W){const ba=Math.sin(W);W=Math.cos(W);const ja=F[4],C=F[5],H=F[6],O=F[7],V=F[8],aa=F[9],da=F[10],ea=F[11];F!==m&&(m[0]=F[0],m[1]=F[1],m[2]=F[2],m[3]=F[3],m[12]=F[12],m[13]=F[13],m[14]=F[14],m[15]=F[15]);m[4]=ja*W+V*ba;m[5]=C*W+aa*ba;m[6]=H*W+da*ba;m[7]=O*W+ea*ba;m[8]=V*W-ja*ba;m[9]=aa*W-C*ba;m[10]=da*W-H*ba;m[11]=ea*W-O*ba;return m}function v(m,F,W){const ba=Math.sin(W);W=Math.cos(W);const ja=F[0],C=F[1],H=F[2],O=F[3],V=F[8],aa=F[9],da=F[10],ea=F[11];F!==m&&(m[4]=F[4],m[5]=F[5],m[6]=F[6],m[7]=F[7],
m[12]=F[12],m[13]=F[13],m[14]=F[14],m[15]=F[15]);m[0]=ja*W-V*ba;m[1]=C*W-aa*ba;m[2]=H*W-da*ba;m[3]=O*W-ea*ba;m[8]=ja*ba+V*W;m[9]=C*ba+aa*W;m[10]=H*ba+da*W;m[11]=O*ba+ea*W;return m}function b(m,F,W){const ba=Math.sin(W);W=Math.cos(W);const ja=F[0],C=F[1],H=F[2],O=F[3],V=F[4],aa=F[5],da=F[6],ea=F[7];F!==m&&(m[8]=F[8],m[9]=F[9],m[10]=F[10],m[11]=F[11],m[12]=F[12],m[13]=F[13],m[14]=F[14],m[15]=F[15]);m[0]=ja*W+V*ba;m[1]=C*W+aa*ba;m[2]=H*W+da*ba;m[3]=O*W+ea*ba;m[4]=V*W-ja*ba;m[5]=aa*W-C*ba;m[6]=da*W-H*
ba;m[7]=ea*W-O*ba;return m}function q(m,F){m[0]=1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=F[0];m[13]=F[1];m[14]=F[2];m[15]=1;return m}function L(m,F){m[0]=F[0];m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=F[1];m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=F[2];m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function d(m,F,W){if(0===F)return N(m);let ba=W[0],ja=W[1];W=W[2];var C=Math.sqrt(ba*ba+ja*ja+W*W);if(C<=x.getEpsilon())return null;C=1/C;ba*=C;ja*=C;W*=C;C=Math.sin(F);F=
Math.cos(F);const H=1-F;m[0]=ba*ba*H+F;m[1]=ja*ba*H+W*C;m[2]=W*ba*H-ja*C;m[3]=0;m[4]=ba*ja*H-W*C;m[5]=ja*ja*H+F;m[6]=W*ja*H+ba*C;m[7]=0;m[8]=ba*W*H+ja*C;m[9]=ja*W*H-ba*C;m[10]=W*W*H+F;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function z(m,F){const W=Math.sin(F);F=Math.cos(F);m[0]=1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=F;m[6]=W;m[7]=0;m[8]=0;m[9]=-W;m[10]=F;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function M(m,F){const W=Math.sin(F);F=Math.cos(F);m[0]=F;m[1]=0;m[2]=-W;m[3]=0;m[4]=0;m[5]=
1;m[6]=0;m[7]=0;m[8]=W;m[9]=0;m[10]=F;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function Q(m,F){const W=Math.sin(F);F=Math.cos(F);m[0]=F;m[1]=W;m[2]=0;m[3]=0;m[4]=-W;m[5]=F;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function Z(m,F,W){var ba=F[0],ja=F[1],C=F[2],H=F[3],O=ba+ba,V=ja+ja;const aa=C+C;F=ba*O;const da=ba*V;ba*=aa;const ea=ja*V;ja*=aa;C*=aa;O*=H;V*=H;H*=aa;m[0]=1-(ea+C);m[1]=da+H;m[2]=ba-V;m[3]=0;m[4]=da-H;m[5]=1-(F+C);m[6]=ja+O;m[7]=0;m[8]=
ba+V;m[9]=ja-O;m[10]=1-(F+ea);m[11]=0;m[12]=W[0];m[13]=W[1];m[14]=W[2];m[15]=1;return m}function U(m,F){const W=La,ba=-F[0],ja=-F[1],C=-F[2],H=F[3],O=F[4],V=F[5],aa=F[6],da=F[7],ea=ba*ba+ja*ja+C*C+H*H;0<ea?(W[0]=2*(O*H+da*ba+V*C-aa*ja)/ea,W[1]=2*(V*H+da*ja+aa*ba-O*C)/ea,W[2]=2*(aa*H+da*C+O*ja-V*ba)/ea):(W[0]=2*(O*H+da*ba+V*C-aa*ja),W[1]=2*(V*H+da*ja+aa*ba-O*C),W[2]=2*(aa*H+da*C+O*ja-V*ba));Z(m,F,W);return m}function T(m,F){m[0]=F[12];m[1]=F[13];m[2]=F[14];return m}function u(m,F){const W=F[0],ba=
F[1],ja=F[2],C=F[4],H=F[5],O=F[6],V=F[8],aa=F[9];F=F[10];m[0]=Math.sqrt(W*W+ba*ba+ja*ja);m[1]=Math.sqrt(C*C+H*H+O*O);m[2]=Math.sqrt(V*V+aa*aa+F*F);return m}function R(m,F){const W=F[0]+F[5]+F[10];let ba=0;0<W?(ba=2*Math.sqrt(W+1),m[3]=.25*ba,m[0]=(F[6]-F[9])/ba,m[1]=(F[8]-F[2])/ba,m[2]=(F[1]-F[4])/ba):F[0]>F[5]&&F[0]>F[10]?(ba=2*Math.sqrt(1+F[0]-F[5]-F[10]),m[3]=(F[6]-F[9])/ba,m[0]=.25*ba,m[1]=(F[1]+F[4])/ba,m[2]=(F[8]+F[2])/ba):F[5]>F[10]?(ba=2*Math.sqrt(1+F[5]-F[0]-F[10]),m[3]=(F[8]-F[2])/ba,m[0]=
(F[1]+F[4])/ba,m[1]=.25*ba,m[2]=(F[6]+F[9])/ba):(ba=2*Math.sqrt(1+F[10]-F[0]-F[5]),m[3]=(F[1]-F[4])/ba,m[0]=(F[8]+F[2])/ba,m[1]=(F[6]+F[9])/ba,m[2]=.25*ba);return m}function g(m,F,W,ba){var ja=F[0],C=F[1],H=F[2],O=F[3],V=ja+ja,aa=C+C,da=H+H;F=ja*V;const ea=ja*aa;ja*=da;const la=C*aa;C*=da;H*=da;V*=O;aa*=O;O*=da;da=ba[0];const ma=ba[1];ba=ba[2];m[0]=(1-(la+H))*da;m[1]=(ea+O)*da;m[2]=(ja-aa)*da;m[3]=0;m[4]=(ea-O)*ma;m[5]=(1-(F+H))*ma;m[6]=(C+V)*ma;m[7]=0;m[8]=(ja+aa)*ba;m[9]=(C-V)*ba;m[10]=(1-(F+la))*
ba;m[11]=0;m[12]=W[0];m[13]=W[1];m[14]=W[2];m[15]=1;return m}function f(m,F,W,ba,ja){var C=F[0],H=F[1],O=F[2],V=F[3],aa=C+C,da=H+H,ea=O+O;F=C*aa;var la=C*da,ma=C*ea;C=H*da;H*=ea;var ua=O*ea;O=V*aa;da*=V;const qa=V*ea;var ra=ba[0],Ba=ba[1];ea=ba[2];ba=ja[0];V=ja[1];ja=ja[2];aa=(1-(C+ua))*ra;const ya=(la+qa)*ra;ra*=ma-da;la=(la-qa)*Ba;ua=(1-(F+ua))*Ba;Ba*=H+O;ma=(ma+da)*ea;H=(H-O)*ea;F=(1-(F+C))*ea;m[0]=aa;m[1]=ya;m[2]=ra;m[3]=0;m[4]=la;m[5]=ua;m[6]=Ba;m[7]=0;m[8]=ma;m[9]=H;m[10]=F;m[11]=0;m[12]=W[0]+
ba-(aa*ba+la*V+ma*ja);m[13]=W[1]+V-(ya*ba+ua*V+H*ja);m[14]=W[2]+ja-(ra*ba+Ba*V+F*ja);m[15]=1;return m}function h(m,F){var W=F[0],ba=F[1],ja=F[2];F=F[3];var C=W+W,H=ba+ba;const O=ja+ja;W*=C;const V=ba*C;ba*=H;const aa=ja*C,da=ja*H;ja*=O;C*=F;H*=F;F*=O;m[0]=1-ba-ja;m[1]=V+F;m[2]=aa-H;m[3]=0;m[4]=V-F;m[5]=1-W-ja;m[6]=da+C;m[7]=0;m[8]=aa+H;m[9]=da-C;m[10]=1-W-ba;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function A(m,F,W,ba,ja,C,H){const O=1/(W-F),V=1/(ja-ba),aa=1/(C-H);m[0]=2*C*O;m[1]=0;m[2]=0;
m[3]=0;m[4]=0;m[5]=2*C*V;m[6]=0;m[7]=0;m[8]=(W+F)*O;m[9]=(ja+ba)*V;m[10]=(H+C)*aa;m[11]=-1;m[12]=0;m[13]=0;m[14]=H*C*2*aa;m[15]=0;return m}function P(m,F,W,ba,ja){F=1/Math.tan(F/2);let C=void 0;m[0]=F/W;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=F;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[11]=-1;m[12]=0;m[13]=0;m[15]=0;null!=ja&&Infinity!==ja?(C=1/(ba-ja),m[10]=(ja+ba)*C,m[14]=2*ja*ba*C):(m[10]=-1,m[14]=-2*ba);return m}function X(m,F,W,ba){const ja=Math.tan(F.upDegrees*Math.PI/180),C=Math.tan(F.downDegrees*Math.PI/180),
H=Math.tan(F.leftDegrees*Math.PI/180);F=Math.tan(F.rightDegrees*Math.PI/180);const O=2/(H+F),V=2/(ja+C);m[0]=O;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=V;m[6]=0;m[7]=0;m[8]=-((H-F)*O*.5);m[9]=(ja-C)*V*.5;m[10]=ba/(W-ba);m[11]=-1;m[12]=0;m[13]=0;m[14]=ba*W/(W-ba);m[15]=0;return m}function ca(m,F,W,ba,ja,C,H){const O=1/(F-W),V=1/(ba-ja),aa=1/(C-H);m[0]=-2*O;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=-2*V;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=2*aa;m[11]=0;m[12]=(F+W)*O;m[13]=(ja+ba)*V;m[14]=(H+C)*aa;m[15]=1;return m}function ia(m,
F,W,ba){const ja=F[0],C=F[1];F=F[2];let H=ja-W[0],O=C-W[1];W=F-W[2];var V=x.getEpsilon();if(Math.abs(H)<V&&Math.abs(O)<V&&Math.abs(W)<V)N(m);else{var aa=1/Math.sqrt(H*H+O*O+W*W);H*=aa;O*=aa;W*=aa;aa=ba[0];var da=ba[1];V=ba[2];ba=da*W-V*O;V=V*H-aa*W;da=aa*O-da*H;(aa=Math.sqrt(ba*ba+V*V+da*da))?(aa=1/aa,ba*=aa,V*=aa,da*=aa):da=V=ba=0;var ea=O*da-W*V,la=W*ba-H*da,ma=H*V-O*ba;(aa=Math.sqrt(ea*ea+la*la+ma*ma))?(aa=1/aa,ea*=aa,la*=aa,ma*=aa):ma=la=ea=0;m[0]=ba;m[1]=ea;m[2]=H;m[3]=0;m[4]=V;m[5]=la;m[6]=
O;m[7]=0;m[8]=da;m[9]=ma;m[10]=W;m[11]=0;m[12]=-(ba*ja+V*C+da*F);m[13]=-(ea*ja+la*C+ma*F);m[14]=-(H*ja+O*C+W*F);m[15]=1}}function na(m,F,W,ba){const ja=F[0],C=F[1];F=F[2];var H=ba[0];const O=ba[1];var V=ba[2];ba=ja-W[0];let aa=C-W[1];W=F-W[2];let da=ba*ba+aa*aa+W*W;0<da&&(da=1/Math.sqrt(da),ba*=da,aa*=da,W*=da);let ea=O*W-V*aa;V=V*ba-H*W;H=H*aa-O*ba;da=ea*ea+V*V+H*H;0<da&&(da=1/Math.sqrt(da),ea*=da,V*=da,H*=da);m[0]=ea;m[1]=V;m[2]=H;m[3]=0;m[4]=aa*H-W*V;m[5]=W*ea-ba*H;m[6]=ba*V-aa*ea;m[7]=0;m[8]=
ba;m[9]=aa;m[10]=W;m[11]=0;m[12]=ja;m[13]=C;m[14]=F;m[15]=1;return m}function oa(m){return"mat4("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+", "+m[9]+", "+m[10]+", "+m[11]+", "+m[12]+", "+m[13]+", "+m[14]+", "+m[15]+")"}function pa(m){return Math.sqrt(m[0]**2+m[1]**2+m[2]**2+m[3]**2+m[4]**2+m[5]**2+m[6]**2+m[7]**2+m[8]**2+m[9]**2+m[10]**2+m[11]**2+m[12]**2+m[13]**2+m[14]**2+m[15]**2)}function sa(m,F,W){m[0]=F[0]+W[0];m[1]=F[1]+W[1];m[2]=F[2]+W[2];m[3]=F[3]+
W[3];m[4]=F[4]+W[4];m[5]=F[5]+W[5];m[6]=F[6]+W[6];m[7]=F[7]+W[7];m[8]=F[8]+W[8];m[9]=F[9]+W[9];m[10]=F[10]+W[10];m[11]=F[11]+W[11];m[12]=F[12]+W[12];m[13]=F[13]+W[13];m[14]=F[14]+W[14];m[15]=F[15]+W[15];return m}function wa(m,F,W){m[0]=F[0]-W[0];m[1]=F[1]-W[1];m[2]=F[2]-W[2];m[3]=F[3]-W[3];m[4]=F[4]-W[4];m[5]=F[5]-W[5];m[6]=F[6]-W[6];m[7]=F[7]-W[7];m[8]=F[8]-W[8];m[9]=F[9]-W[9];m[10]=F[10]-W[10];m[11]=F[11]-W[11];m[12]=F[12]-W[12];m[13]=F[13]-W[13];m[14]=F[14]-W[14];m[15]=F[15]-W[15];return m}function xa(m,
F,W){m[0]=F[0]*W;m[1]=F[1]*W;m[2]=F[2]*W;m[3]=F[3]*W;m[4]=F[4]*W;m[5]=F[5]*W;m[6]=F[6]*W;m[7]=F[7]*W;m[8]=F[8]*W;m[9]=F[9]*W;m[10]=F[10]*W;m[11]=F[11]*W;m[12]=F[12]*W;m[13]=F[13]*W;m[14]=F[14]*W;m[15]=F[15]*W;return m}function Da(m,F,W,ba){m[0]=F[0]+W[0]*ba;m[1]=F[1]+W[1]*ba;m[2]=F[2]+W[2]*ba;m[3]=F[3]+W[3]*ba;m[4]=F[4]+W[4]*ba;m[5]=F[5]+W[5]*ba;m[6]=F[6]+W[6]*ba;m[7]=F[7]+W[7]*ba;m[8]=F[8]+W[8]*ba;m[9]=F[9]+W[9]*ba;m[10]=F[10]+W[10]*ba;m[11]=F[11]+W[11]*ba;m[12]=F[12]+W[12]*ba;m[13]=F[13]+W[13]*
ba;m[14]=F[14]+W[14]*ba;m[15]=F[15]+W[15]*ba;return m}function Ea(m,F){return m[0]===F[0]&&m[1]===F[1]&&m[2]===F[2]&&m[3]===F[3]&&m[4]===F[4]&&m[5]===F[5]&&m[6]===F[6]&&m[7]===F[7]&&m[8]===F[8]&&m[9]===F[9]&&m[10]===F[10]&&m[11]===F[11]&&m[12]===F[12]&&m[13]===F[13]&&m[14]===F[14]&&m[15]===F[15]}function Ja(m,F){if(m===F)return!0;const W=m[0],ba=m[1],ja=m[2],C=m[3],H=m[4],O=m[5],V=m[6],aa=m[7],da=m[8],ea=m[9],la=m[10],ma=m[11],ua=m[12],qa=m[13],ra=m[14];m=m[15];const Ba=F[0],ya=F[1],Aa=F[2],Ca=F[3],
za=F[4],Fa=F[5],Ra=F[6],bb=F[7],cb=F[8],Xa=F[9],Ma=F[10],Na=F[11],ha=F[12],ic=F[13],Kb=F[14];F=F[15];const Ia=x.getEpsilon();return Math.abs(W-Ba)<=Ia*Math.max(1,Math.abs(W),Math.abs(Ba))&&Math.abs(ba-ya)<=Ia*Math.max(1,Math.abs(ba),Math.abs(ya))&&Math.abs(ja-Aa)<=Ia*Math.max(1,Math.abs(ja),Math.abs(Aa))&&Math.abs(C-Ca)<=Ia*Math.max(1,Math.abs(C),Math.abs(Ca))&&Math.abs(H-za)<=Ia*Math.max(1,Math.abs(H),Math.abs(za))&&Math.abs(O-Fa)<=Ia*Math.max(1,Math.abs(O),Math.abs(Fa))&&Math.abs(V-Ra)<=Ia*Math.max(1,
Math.abs(V),Math.abs(Ra))&&Math.abs(aa-bb)<=Ia*Math.max(1,Math.abs(aa),Math.abs(bb))&&Math.abs(da-cb)<=Ia*Math.max(1,Math.abs(da),Math.abs(cb))&&Math.abs(ea-Xa)<=Ia*Math.max(1,Math.abs(ea),Math.abs(Xa))&&Math.abs(la-Ma)<=Ia*Math.max(1,Math.abs(la),Math.abs(Ma))&&Math.abs(ma-Na)<=Ia*Math.max(1,Math.abs(ma),Math.abs(Na))&&Math.abs(ua-ha)<=Ia*Math.max(1,Math.abs(ua),Math.abs(ha))&&Math.abs(qa-ic)<=Ia*Math.max(1,Math.abs(qa),Math.abs(ic))&&Math.abs(ra-Kb)<=Ia*Math.max(1,Math.abs(ra),Math.abs(Kb))&&Math.abs(m-
F)<=Ia*Math.max(1,Math.abs(m),Math.abs(F))}function Sa(m){const F=x.getEpsilon(),W=m[0],ba=m[1],ja=m[2],C=m[4],H=m[5],O=m[6],V=m[8],aa=m[9];m=m[10];return Math.abs(1-(W*W+C*C+V*V))<=F&&Math.abs(1-(ba*ba+H*H+aa*aa))<=F&&Math.abs(1-(ja*ja+O*O+m*m))<=F}function ab(m){return 1===m[0]&&0===m[1]&&0===m[2]&&0===m[4]&&1===m[5]&&0===m[6]&&0===m[8]&&0===m[9]&&1===m[10]}const La=l.create();l=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:y,copy:D,determinant:w,equals:Ja,exactEquals:Ea,frob:pa,
fromQuat:h,fromQuat2:U,fromRotation:d,fromRotationTranslation:Z,fromRotationTranslationScale:g,fromRotationTranslationScaleOrigin:f,fromScaling:L,fromTranslation:q,fromXRotation:z,fromYRotation:M,fromZRotation:Q,frustum:A,getRotation:R,getScaling:u,getTranslation:T,hasIdentityRotation:ab,identity:N,invert:k,invertOrIdentity:p,isOrthoNormal:Sa,lookAt:ia,mul:I,multiply:I,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:ca,perspective:P,perspectiveFromFieldOfView:X,rotate:J,rotateX:K,rotateY:v,rotateZ:b,
scale:r,set:t,str:oa,sub:wa,subtract:wa,targetTo:na,translate:G,transpose:a},Symbol.toStringTag,{value:"Module"}));e.add=sa;e.adjoint=y;e.copy=D;e.determinant=w;e.equals=Ja;e.exactEquals=Ea;e.frob=pa;e.fromQuat=h;e.fromQuat2=U;e.fromRotation=d;e.fromRotationTranslation=Z;e.fromRotationTranslationScale=g;e.fromRotationTranslationScaleOrigin=f;e.fromScaling=L;e.fromTranslation=q;e.fromXRotation=z;e.fromYRotation=M;e.fromZRotation=Q;e.frustum=A;e.getRotation=R;e.getScaling=u;e.getTranslation=T;e.hasIdentityRotation=
ab;e.identity=N;e.invert=k;e.invertOrIdentity=p;e.isOrthoNormal=Sa;e.lookAt=ia;e.mat4=l;e.mul=I;e.multiply=I;e.multiplyScalar=xa;e.multiplyScalarAndAdd=Da;e.ortho=ca;e.perspective=P;e.perspectiveFromFieldOfView=X;e.rotate=J;e.rotateX=K;e.rotateY=v;e.rotateZ=b;e.scale=r;e.set=t;e.str=oa;e.sub=wa;e.subtract=wa;e.targetTo=na;e.translate=G;e.transpose=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(e,l,x){function D(g){return null==g||"string"===typeof g&&!g?"\x3cNull\x3e":g}function t(g){const f=null!=g.minValue||null!=g.maxValue,h=!!g.sqlExpression&&g.supportsSQLExpression;return!(null!=g.normalizationField||null!=g.normalizationType)&&!f&&!h}function N(g){const {values:f,useSampleStdDev:h,supportsNullCount:A,outStatisticTypes:P}=g;var X=Number.POSITIVE_INFINITY;let ca=Number.NEGATIVE_INFINITY,ia=null,na=null;var oa=null;let pa=null,sa=0;const wa=
null==g.minValue?-Infinity:g.minValue,xa=null==g.maxValue?Infinity:g.maxValue;for(const Da of f)Number.isFinite(Da)?Da>=wa&&Da<=xa&&(ia=null===ia?Da:ia+Da,X=Math.min(X,Da),ca=Math.max(ca,Da),sa++):"string"===typeof Da&&sa++;if(sa&&null!=ia){na=ia/sa;oa=0;for(const Da of f)Number.isFinite(Da)&&Da>=wa&&Da<=xa&&(oa+=(Da-na)**2);pa=h?1<sa?oa/(sa-1):0:0<sa?oa/sa:0;oa=Math.sqrt(pa)}else ca=X=null;X={avg:na,count:sa,max:ca,min:X,stddev:oa,sum:ia,variance:pa};A&&(X.nullcount=f.length-sa);!g.percentileParams||
P?.include?.length&&!P.include.includes("median")||P?.exclude?.length&&P.exclude.includes("median")||(X.median=a(f,g.percentileParams));return X}function a(g,f){const {fieldType:h,value:A,orderBy:P,isDiscrete:X}=f,ca=p(h,"desc"===P);g=[...g].filter(pa=>null!=pa).sort((pa,sa)=>ca(pa,sa));if(0===g.length)return null;if(0>=A)return g[0];if(1<=A)return g[g.length-1];var ia=(g.length-1)*A,na=Math.floor(ia);f=na+1;ia%=1;na=g[na];const oa=g[f];return f>=g.length||X||"string"===typeof na||"string"===typeof oa?
na:na*(1-ia)+oa*ia}function p(g,f){if(g){if(q.has(g))return f?u:R;if(L.has(g))return k(f,!1);if("esriFieldTypeTimestampOffset"===g)return f?Z:Q;const ca=k(f,!0);if("esriFieldTypeString"===g)return ca;if("esriFieldTypeGUID"===g||"esriFieldTypeGlobalID"===g)return(ia,na)=>ca(y(ia),y(na))}const h=f?1:-1,A=f?u:R,P=k(f,!0),X=f?z:M;return(ca,ia)=>"number"===typeof ca&&"number"===typeof ia?A(ca,ia):"string"===typeof ca&&"string"===typeof ia?P(ca,ia):X(ca,ia)??h}function k(g,f){if(!f)return g?T:U;const h=
g?z:M;return g?(A,P)=>{const X=h(A,P);if(null!=X)return X;A=A.toUpperCase();P=P.toUpperCase();return A>P?-1:A<P?1:0}:(A,P)=>{const X=h(A,P);if(null!=X)return X;A=A.toUpperCase();P=P.toUpperCase();return A<P?-1:A>P?1:0}}function y(g){return g.slice(24,36)+g.slice(19,23)+g.slice(16,18)+g.slice(14,16)+g.slice(11,13)+g.slice(9,11)+g.slice(6,8)+g.slice(4,6)+g.slice(2,4)+g.slice(0,2)}function w(g){return"coded-value"!==g?.type?[]:g.codedValues.map(f=>f.code)}function I(g,f){const h=r({field:f.field,normalizationType:f.normalizationType,
normalizationField:f.normalizationField,classificationMethod:f.classificationMethod,standardDeviationInterval:f.standardDeviationInterval,breakCount:f.numClasses||5});g=G(g,f.minValue,f.maxValue);return x.createGenerateRendererClassBreaks({definition:h,values:g,normalizationTotal:f.normalizationTotal})}function G(g,f,h){const A=null==f?-Infinity:f,P=null==h?Infinity:h;return g.filter(X=>Number.isFinite(X)&&X>=A&&X<=P)}function r(g){const {breakCount:f,field:h,normalizationField:A,normalizationType:P}=
g,X=g.classificationMethod||"equal-interval";return new l({breakCount:f,classificationField:h,classificationMethod:X,normalizationField:"field"===P?A:void 0,normalizationType:P,standardDeviationInterval:"standard-deviation"===X?g.standardDeviationInterval||1:void 0,definedInterval:"defined-interval"===X?g.definedInterval:void 0})}function J(g,f){const {field:h,classificationMethod:A,standardDeviationInterval:P,normalizationType:X,normalizationField:ca,normalizationTotal:ia,minValue:na,maxValue:oa}=
f,pa=f.numBins||10;let sa=f=null,wa=null;A&&"equal-interval"!==A||X?({classBreaks:g}=I(g,{field:h,normalizationType:X,normalizationField:ca,normalizationTotal:ia,classificationMethod:A,standardDeviationInterval:P,minValue:na,maxValue:oa,numClasses:pa}),f=g[0].minValue,sa=g[g.length-1].maxValue,wa=g.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=oa?(f=na,sa=oa):(g=N({values:g,minValue:na,maxValue:oa,useSampleStdDev:!X,supportsNullCount:t({normalizationType:X,normalizationField:ca,minValue:na,
maxValue:oa})}),f=g.min??null,sa=g.max??null),wa=v(f??0,sa??0,pa));return{min:f,max:sa,intervals:wa}}function K(g,f){let h=-1;for(let A=g.length-1;0<=A;A--)if(f>=g[A][0]){h=A;break}return h}function v(g,f,h){const A=(f-g)/h,P=[];let X;for(let ca=1;ca<=h;ca++)X=g+A,X=Number(X.toFixed(16)),P.push([g,ca===h?f:X]),g=X;return P}const b=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,q=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
L=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),d="min max avg stddev count sum variance nullcount median".split(" "),z=(g,f)=>null==g?null==f?0:1:null==f?-1:null,M=(g,f)=>null==g?null==f?0:-1:null==f?1:null,Q=(g,f)=>M(g,f)??(g===f?0:(new Date(g)).getTime()-(new Date(f)).getTime()),Z=(g,f)=>z(g,f)??(g===f?0:(new Date(f)).getTime()-(new Date(g)).getTime()),U=(g,f)=>M(g,f)??(g===f?0:g<f?-1:1),T=(g,f)=>z(g,f)??(g===f?0:g<f?1:-1),u=(g,f)=>z(g,f)??f-g,R=(g,f)=>M(g,f)??g-f;e.calculateClassBreaks=
I;e.calculateHistogram=function(g,f){var h=J(g,f);if(null==h.min&&null==h.max)return{bins:[],minValue:h.min,maxValue:h.max,normalizationTotal:f.normalizationTotal};const A=h.intervals,P=h.min??0;h=h.max??0;const X=A.map((ca,ia)=>({minValue:A[ia][0],maxValue:A[ia][1],count:0}));for(const ca of g)null!=ca&&ca>=P&&ca<=h&&(g=K(A,ca),-1<g&&X[g].count++);return{bins:X,minValue:P,maxValue:h,normalizationTotal:f.normalizationTotal}};e.calculatePercentile=a;e.calculateStatistics=N;e.calculateStringStatistics=
function(g){const {outStatisticTypes:f}=g,h=g.returnDistinct?[...(new Set(g.values))]:g.values;var A=h.filter(X=>null!=X).sort();const P=A.length;A={count:P,min:A[0],max:A[P-1]};g.supportsNullCount&&(A.nullcount=h.length-P);!g.percentileParams||f?.include?.length&&!f.include.includes("median")||f?.exclude?.length&&f.exclude.includes("median")||(A.median=a(h,g.percentileParams));return A};e.calculateUniqueValuesCount=function(g){const f={};for(let h of g){if(null==h||"string"===typeof h&&""===h.trim())h=
null;null==f[h]?f[h]={count:1,data:h}:f[h].count++}return{count:f}};e.createClassBreaksDefinition=r;e.createUVResult=function(g,f,h,A){g=g.count;const P=[];if(h&&f){h=[];var X=w(f[0]);for(const ca of X)if(f[1]){X=w(f[1]);for(const ia of X)if(f[2]){X=w(f[2]);for(const na of X)h.push(`${D(ca)}${A}${D(ia)}${A}${D(na)}`)}else h.push(`${D(ca)}${A}${D(ia)}`)}else h.push(ca);for(const ca of h)g.hasOwnProperty(ca)||(g[ca]={data:ca,count:0})}for(const ca in g)f=g[ca],P.push({value:f.data,count:f.count,label:f.label});
return{uniqueValueInfos:P}};e.getAttributeComparator=p;e.getEqualIntervalBins=v;e.getNormalizedValue=function(g,f,h,A){let P=null;switch(f){case "log":0!==g&&(P=Math.log(g)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(A)&&0!==A&&(P=g/A*100);break;case "field":Number.isFinite(h)&&0!==h&&(P=g/h);break;case "natural-log":0<g&&(P=Math.log(g));break;case "square-root":0<g&&(P=g**.5)}return P};e.isNullCountSupported=t;e.processNullValue=D;e.processSummaryStatisticsResult=function(g,f,h){let A;
for(A in g)f?.include?.length&&!f.include.includes(A)||f?.exclude?.length&&f.exclude.includes(A)?delete g[A]:d.includes(A)&&(Number.isFinite(g[A])||(g[A]=null));if(!h)return g;["avg","stddev","variance"].forEach(P=>{null!=g[P]&&(g[P]=Math.ceil(g[P]??0))});return g};e.resolveCBResult=function(g,f){let h=g.classBreaks;const A=h[0]?.minValue,P=h[h.length-1]?.maxValue,X="standard-deviation"===f;h=h.map(ca=>{const ia=ca.label;ca={minValue:ca.minValue,maxValue:ca.maxValue,label:ia};if(X&&ia){const na=ia.match(b)?.map(oa=>
+oa.trim())??[];2===na.length?(ca.minStdDev=na[0],ca.maxStdDev=na[1],0>na[0]&&0<na[1]&&(ca.hasAvg=!0)):1===na.length&&(ia.includes("\x3c")?(ca.minStdDev=null,ca.maxStdDev=na[0]):ia.includes("\x3e")&&(ca.minStdDev=na[0],ca.maxStdDev=null))}return ca});return{minValue:A,maxValue:P,classBreakInfos:h,normalizationTotal:g.normalizationTotal}};e.statisticTypes=d;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,l,x,D,t,N,a,p,k){t=new l.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});l=new l.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});x=class extends x.JSONSupport{constructor(y){super(y);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(y){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",y)}set definedInterval(y){"defined-interval"===this.classificationMethod&&this._set("definedInterval",y)}};e.__decorate([p.enumeration({classBreaksDef:"class-breaks-definition"})],x.prototype,"type",void 0);e.__decorate([D.property({json:{write:!0}})],x.prototype,
"breakCount",void 0);e.__decorate([D.property({json:{write:!0}})],x.prototype,"classificationField",void 0);e.__decorate([D.property({type:String,json:{read:t.read,write:t.write}})],x.prototype,"classificationMethod",void 0);e.__decorate([D.property({json:{write:!0}})],x.prototype,"normalizationField",void 0);e.__decorate([D.property({json:{read:l.read,write:l.write}})],x.prototype,"normalizationType",void 0);e.__decorate([D.property({value:null,json:{write:!0}})],x.prototype,"standardDeviationInterval",
null);e.__decorate([D.property({value:null,json:{write:!0}})],x.prototype,"definedInterval",null);return x=e.__decorate([k.subclass("esri.rest.support.ClassBreaksDefinition")],x)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(e,l,x){e.enumeration=function(D,t={}){D=D instanceof l.JSONMap?D:new l.JSONMap(D,t);const {alwaysWriteDefaults:N,default:a,ignoreUnknown:p=!0,name:k,nonNullable:y,readOnly:w=!1}=t;return x.property({type:p?
D.apiValues:String,json:{type:D.jsonValues,default:a,name:k,read:w?!1:{reader:D.read},write:{writer:D.write,alwaysWriteDefaults:N}},nonNullable:y,readOnly:w})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(e,l){function x(I){var G=I.definition;const {classificationMethod:r,normalizationType:J,definedInterval:K}=G;G=G.breakCount??1;const v=[];var b=I.values;if(0===b.length)return[];
b=b.sort((Q,Z)=>Q-Z);var q=b[0],L=b[b.length-1];if("equal-interval"===r)if(b.length>=G){b=(L-q)/G;I=q;for(var d=1;d<G;d++){var z=Number((q+d*b).toFixed(6));v.push({minValue:I,maxValue:z,label:D(I,z,J)});I=z}v.push({minValue:I,maxValue:L,label:D(I,L,J)})}else b.forEach(Q=>{v.push({minValue:Q,maxValue:Q,label:D(Q,Q,J)})});else if("natural-breaks"===r){b=t(b);I=N(b.uniqueValues,I.valueFrequency||b.valueFrequency,G);for(d=1;d<G;d++)b.uniqueValues.length>d&&(z=Number(b.uniqueValues[I[d]].toFixed(6)),v.push({minValue:q,
maxValue:z,label:D(q,z,J)}),q=z);v.push({minValue:q,maxValue:L,label:D(q,L,J)})}else if("quantile"===r)if(b.length>=G&&q!==L){I=Math.ceil(b.length/G);d=0;for(z=1;z<G;z++){var M=I+d-1;M>b.length&&(M=b.length-1);0>M&&(M=0);v.push({minValue:q,maxValue:b[M],label:D(q,b[M],J)});q=b[M];d+=I;I=Math.ceil((b.length-d)/(G-z))}v.push({minValue:q,maxValue:L,label:D(q,L,J)})}else for(G=-1,L=0;L<b.length;L++)q=b[L],q!==G&&(G=q,v.push({minValue:G,maxValue:q,label:D(G,q,J)}),G=q);else if("standard-deviation"===r)if(I=
k(b),d=y(b,I),0===d)v.push({minValue:b[0],maxValue:b[0],label:D(b[0],b[0],J)});else{b=p(q,L,G,I,d)*d;d=0;for(z=G;1<=z;z--)M=Number((I-(z-.5)*b).toFixed(6)),v.push({minValue:q,maxValue:M,label:D(q,M,J)}),q=M,d++;z=Number((I+.5*b).toFixed(6));v.push({minValue:q,maxValue:z,label:D(q,z,J)});q=z;d++;for(M=1;M<=G;M++)z=d===2*G?L:Number((I+(M+.5)*b).toFixed(6)),v.push({minValue:q,maxValue:z,label:D(q,z,J)}),q=z,d++}else if("defined-interval"===r){if(!K)return v;G=b[0];L=b[b.length-1];b=Math.ceil((L-G)/K);
q=G;for(I=1;I<b;I++)d=Number((G+I*K).toFixed(6)),v.push({minValue:q,maxValue:d,label:D(q,d,J)}),q=d;v.push({minValue:q,maxValue:L,label:D(q,L,J)})}return v}function D(I,G,r){let J=null;return J=I===G?r&&"percent-of-total"===r?I+"%":I.toString():r&&"percent-of-total"===r?I+"% - "+G+"%":I+" - "+G}function t(I){const G=[],r=[];let J=Number.MIN_VALUE,K=1,v=-1;for(let b=0;b<I.length;b++){const q=I[b];q===J?(K++,r[v]=K):null!==q&&(G.push(q),J=q,K=1,r.push(K),v++)}return{uniqueValues:G,valueFrequency:r}}
function N(I,G,r){var J=I.length;const K=[];r>J&&(r=J);for(var v=0;v<r;v++)K.push(Math.round(v*J/r-1));K.push(J-1);v=a(K,I,G,r);J=v.mean;v=v.sdcm;var b=r,q=0,L=0;let d=0,z=0,M=!0;for(let Z=0;2>Z&&M;Z++){0===Z&&(M=!1);for(var Q=0;Q<b-1;Q++)for(;K[Q+1]+1!==K[Q+2];)if(K[Q+1]+=1,q=w(Q,K,I,G),d=q.sbMean,q=q.sbSdcm,L=w(Q+1,K,I,G),z=L.sbMean,L=L.sbSdcm,q+L<v[Q]+v[Q+1])v[Q]=q,v[Q+1]=L,J[Q]=d,J[Q+1]=z,M=!0;else{--K[Q+1];break}for(Q=b-1;0<Q;Q--)for(;K[Q]!==K[Q-1]+1;)if(--K[Q],q=w(Q-1,K,I,G),d=q.sbMean,q=q.sbSdcm,
L=w(Q,K,I,G),z=L.sbMean,L=L.sbSdcm,q+L<v[Q-1]+v[Q])v[Q-1]=q,v[Q]=L,J[Q-1]=d,J[Q]=z,M=!0;else{K[Q]+=1;break}}M&&(v=a(K,I,G,r));return K}function a(I,G,r,J){let K=[];var v=[],b=[];let q=0;const L=[],d=[];for(var z=0;z<J;z++){var M=w(z,I,G,r);L.push(M.sbMean);d.push(M.sbSdcm);q+=d[z]}M=q;for(z=!0;z||q<M;){z=!1;K=[];for(v=0;v<J;v++)K.push(I[v]);for(b=0;b<J;b++)for(M=I[b]+1;M<=I[b+1];M++)if(v=G[M],0<b&&M!==I[b+1]&&Math.abs(v-L[b])>Math.abs(v-L[b-1]))I[b]=M;else if(b<J-1&&I[b]!==M-1&&Math.abs(v-L[b])>Math.abs(v-
L[b+1])){I[b+1]=M-1;break}M=q;q=0;v=[];b=[];for(let Q=0;Q<J;Q++){v.push(L[Q]);b.push(d[Q]);const Z=w(Q,I,G,r);L[Q]=Z.sbMean;d[Q]=Z.sbSdcm;q+=d[Q]}}if(q>M){for(G=0;G<J;G++)I[G]=K[G],L[G]=v[G],d[G]=b[G];q=M}return{mean:L,sdcm:d}}function p(I,G,r,J,K){I=Math.max(J-I,G-J)/K/r;return 1<=I?1:.5<=I?.5:.25}function k(I){let G=0;for(let r=0;r<I.length;r++)G+=I[r];return G/=I.length}function y(I,G){let r=0;for(let J=0;J<I.length;J++){const K=I[J];r+=(K-G)*(K-G)}r/=I.length;return Math.sqrt(r)}function w(I,
G,r,J){var K=0,v=0;for(var b=G[I]+1;b<=G[I+1];b++){const q=J[b];K+=r[b]*q;v+=q}0>=v&&l.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");K/=v;v=0;for(b=G[I]+1;b<=G[I+1];b++)v+=J[b]*(r[b]-K)**2;return{sbMean:K,sbSdcm:v}}e.createGenerateRendererClassBreaks=function(I){const {normalizationTotal:G}=I;return{classBreaks:x(I),normalizationTotal:G}};e.createGenerateRendererUniqueValues=function(I){I=t(I);const G=[],r=I.uniqueValues.length;for(let J=0;J<
r;J++){const K=I.uniqueValues[J];G.push({value:K,count:I.valueFrequency[J],label:K.toString()})}return{uniqueValues:G}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(e){e.makeEdgeCandidate=function(l,x,D,t,N,a=!1){return{objectId:l,target:x,distance:D,type:"edge",start:t,end:N,draped:a}};e.makeVertexCandidate=function(l,x,D){return{objectId:l,target:x,distance:D,type:"vertex"}};Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(e,l,x,D,t,N,a,p,k,y){async function w(v,b,q){if(!v)return null;var {where:L}=v;v.where=L=L?.trim();if(!L||/^1 *= *1$/.test(L)||
b&&b===L)v.where=null;if(!v.geometry)return v;b=await G(v);v.distance=0;v.units=null;"esriSpatialRelEnvelopeIntersects"===v.spatialRel&&({spatialReference:L}=v.geometry,b=N.getGeometryExtent(b),b.spatialReference=L);if(b){await y.checkProjectionSupport(b.spatialReference,q);L=b.spatialReference;b=I(b,q)&&a.isExtent(b)?{spatialReference:L,rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}:b;L=(await p.normalizeCentralMeridian(a.fromJSON(b)))[0];if(null==L)throw K;
const d="quantizationParameters"in v&&v.quantizationParameters?.tolerance||"maxAllowableOffset"in v&&v.maxAllowableOffset||0;b=d&&I(b,q)?{densificationStep:8*d}:void 0;L=L.toJSON();b=y.project(L,L.spatialReference,q,b);if(!b)throw K;b.spatialReference=q;v.geometry=b}return v}function I(v,b){if(!v)return!1;const q=v.spatialReference;return(a.isExtent(v)||a.isPolygon(v)||a.isPolyline(v))&&!k.equals(q,b)&&!t.canProjectWithoutEngine(q,b)}async function G(v){const {distance:b,units:q}=v,L=v.geometry;if(null==
b||"vertexAttributes"in L)return L;var d=L.spatialReference;v=q?J.fromJSON(q):D.getUnitString(d);d=d&&(k.isGeographic(d)||k.isWebMercator(d))?L:await y.checkProjectionSupport(d,k.wgs84).then(()=>y.project(L,k.wgs84));return(await r())(d.spatialReference,d,b,v)}async function r(){return(await new Promise((v,b)=>e(["../../../geometry/geometryEngineJSON"],v,b))).geodesicBuffer}const J=new x.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),K=Object.freeze({});l.normalizeQuery=async function(v,b,q){const {outFields:L,orderByFields:d,groupByFieldsForStatistics:z,outStatistics:M}=v;if(L)for(var Q=0;Q<L.length;Q++)L[Q]=L[Q].trim();if(d)for(Q=0;Q<d.length;Q++)d[Q]=d[Q].trim();if(z)for(Q=0;Q<z.length;Q++)z[Q]=z[Q].trim();if(M)for(Q=0;Q<M.length;Q++)M[Q].onStatisticField&&(M[Q].onStatisticField=M[Q].onStatisticField.trim());v.geometry&&!v.outSR&&(v.outSR=
v.geometry.spatialReference);return w(v,b,q)};l.normalizeQueryLike=w;l.queryEngineEmptyResult=K;l.unitsKebabDict=J;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(e,l,x,D,t,N){function a(I,G,r){const {outFields:J,orderByFields:K,returnDistinctValues:v,outStatistics:b}=r,q=b?
b.map(L=>L.outStatisticFieldName&&L.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(K&&0<K.length){const L=K.map(d=>{const z=d.toLowerCase();return z.includes(" asc")?z.split(" asc")[0]:z.includes(" desc")?z.split(" desc")[0]:d}).filter(d=>!q.includes(d));x.validateFields(I,G,L,{expressionName:"orderByFields",query:r})}if(J&&0<J.length)x.validateFields(I,G,J,{expressionName:"outFields",query:r,allowedFieldTypes:"all"});else if(v)throw new l("unsupported-query","outFields should be specified for returnDistinctValues",
{query:r});x.validateWhere(I,G,r.where,r)}function p(I,G,r){const {outStatistics:J,groupByFieldsForStatistics:K,having:v}=r;var b=K?.length,q=J?.length;if(v){if(!b||!q)throw new l("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});x.validateHaving(I,G,v,J,r)}if(q&&y(J)){q=J.map(L=>L.onStatisticField).filter(Boolean);x.validateFields(I,G,q,{expressionName:"onStatisticFields",query:r});b&&x.validateFields(I,G,K,{expressionName:"groupByFieldsForStatistics",
query:r});for(const L of J){const {onStatisticField:d,statisticType:z}=L;if(("percentile_disc"===z||"percentile_cont"===z)&&"statisticParameters"in L){if({statisticParameters:b}=L,!b)throw new l("unsupported-query","statisticParameters should be set for percentile type",{definition:L,query:r});}else I.get(d)&&"count"!==z&&"min"!==z&&"max"!==z&&x.validateFields(I,G,[d],{expressionName:`outStatistics with '${z}' statistic type`,allowedFieldTypes:w,query:r})}}}async function k(I,G,r,J){var K=[];r.valueExpression&&
({arcadeUtils:K}=await N.loadArcade(),K=K.extractFieldNames(r.valueExpression));r.field&&K.push(r.field);r.field2&&K.push(r.field2);r.field3&&K.push(r.field3);r.normalizationField&&K.push(r.normalizationField);if(!K.length&&!r.valueExpression)throw new l("unsupported-query","field or valueExpression is required",{params:r});x.validateFields(I,G,K,{expressionName:"statistics",query:J})}function y(I){return null!=I&&I.every(G=>"exceedslimit"!==G.statisticType)}const w=new Set([...x.numericFieldTypes,
...x.allDateAndTimeFieldTypes]);e.validateQuery=async function(I,{fieldsIndex:G,geometryType:r,spatialReference:J,availableFields:K}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption&&"xyFootprint"!==I.multipatchOption||I.pixelSize||I.relationParam||I.text)throw new l("unsupported-query","Unsupported query options",{query:I});a(G,K,I);p(G,K,I);return Promise.all([t.checkSpatialQuerySupport(I,r,J),D.checkProjectionSupport(J,I.outSR)]).then(()=>I)};e.validateStatisticsQuery=async function(I,
G,{fieldsIndex:r,geometryType:J,spatialReference:K,availableFields:v}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text||I.outStatistics||I.groupByFieldsForStatistics||I.having||I.orderByFields)throw new l("unsupported-query","Unsupported query options",{query:I});a(r,v,I);return Promise.all([k(r,v,G,I),t.checkSpatialQuerySupport(I,J,K),D.checkProjectionSupport(K,I.outSR)]).then(()=>I)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(e,l,x,D,t,N,a,p,k,y,w,I){function G(){return new Promise((b,q)=>e(["../../../geometry/geometryEngineJSON"],b,q))}const r={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var J={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},K={esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},v={esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};l.canQueryWithRBush=function(b){if(N.isExtent(b))return!0;if(N.isPolygon(b)){for(const q of b.rings)if(5!==q.length||q[0][0]!==q[1][0]||q[0][0]!==
q[4][0]||q[2][0]!==q[3][0]||q[0][1]!==q[3][1]||q[0][1]!==q[4][1]||q[1][1]!==q[2][1])return!1;return!0}return!1};l.checkSpatialQuerySupport=async function(b,q,L){const {spatialRel:d,geometry:z}=b;if(z){if(null==d||!0!==J[d])throw new x("unsupported-query","Unsupported query spatial relationship",{query:b});if(a.isValid(z.spatialReference)&&a.isValid(L)){if(null==z||!0!==K[N.getJsonType(z)])throw new x("unsupported-query","Unsupported query geometry type",{query:b});if(null==q||!0!==v[q])throw new x("unsupported-query",
"Unsupported layer geometry type",{query:b});if(b.outSR)return I.checkProjectionSupport(b.geometry?.spatialReference,b.outSR)}}};l.getSpatialQueryOperator=function(b,q,L,d,z){if(N.isPolygon(q)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b)){const M=k.convertFromPolygon(new y,q,!1,!1);return Promise.resolve(Q=>p.polygonContainsPoint(M,!1,!1,Q))}if(N.isPolygon(q)&&"esriGeometryMultipoint"===L){const M=k.convertFromPolygon(new y,q,!1,!1);if("esriSpatialRelContains"===
b)return Promise.resolve(Q=>p.polygonContainsMultipoint(M,!1,!1,Q,d,z))}if(N.isExtent(q)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b))return Promise.resolve(M=>D.extentContainsPoint(q,w.getGeometry(L,d,z,M)));if(N.isExtent(q)&&"esriGeometryMultipoint"===L&&"esriSpatialRelContains"===b)return Promise.resolve(M=>D.extentContainsMultipoint(q,w.getGeometry(L,d,z,M)));if(N.isExtent(q)&&"esriSpatialRelIntersects"===b){const M=t.getExtentIntersector(L);return Promise.resolve(Q=>
M(q,w.getGeometry(L,d,z,Q)))}return G().then(M=>{const Q=M[r[b]].bind(null,q.spatialReference,q);return Z=>Q(w.getGeometry(L,d,z,Z))})};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(e,l){e.extentIntersectsExtent=l.extentIntersectsExtent;e.extentIntersectsMultipoint=l.extentIntersectsMultipoint;e.extentIntersectsPoint=l.extentIntersectsPoint;e.extentIntersectsPolygon=l.extentIntersectsPolygon;
e.extentIntersectsPolyline=l.extentIntersectsPolyline;e.getFeatureExtentIntersector=l.getFeatureExtentIntersector;e.isSelfIntersecting=l.isSelfIntersecting;e.segmentIntersects=l.segmentIntersects;e.getExtentIntersector=function(x){return"mesh"===x?l.extentIntersectsExtent:l.getFeatureExtentIntersector(x)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(e){function l(x,D,t,N,a){if(!x)return!1;D=D?t?4:3:t?3:2;const {coords:p,
lengths:k}=x;t=!1;x=0;for(const w of k){var y=x;for(let I=x,G=x+w*D;I<G;I+=D){y=I+D;y===G&&(y=x);const r=p[I],J=p[I+1],K=p[y];y=p[y+1];(J<a&&y>=a||y<a&&J>=a)&&r+(a-J)/(y-J)*(K-r)<N&&(t=!t)}x+=w*D}return t}e.polygonContainsCoords=l;e.polygonContainsMultipoint=function(x,D,t,N,a,p){a=a?p?4:3:p?3:2;const {coords:k,lengths:y}=N;if(!y)return!1;for(let w=0,I=0;w<y.length;w++,I+=a)if(!l(x,D,t,k[I],k[I+1]))return!1;return!0};e.polygonContainsPoint=function(x,D,t,N){return l(x,D,t,N.coords[0],N.coords[1])};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(e){function l(t,N,a,p,k){if(null!=p&&null!=k)return y=>{const w=t(y,N);y=t(y,a);return(null==w||w<=k)&&(null==y||y>=p)};if(null!=p)return y=>{y=t(y,a);return null==y||y>=p};if(null!=k)return y=>{y=t(y,N);return null==y||y<=k}}function x(t,N,a,p){if(null!=a&&null!=p&&a===p)return k=>t(k,N)===a;if(null!=a&&null!=p)return k=>{k=t(k,N);return null!=k&&k>=a&&k<=
p};if(null!=a)return k=>{k=t(k,N);return null!=k&&k>=a};if(null!=p)return k=>{k=t(k,N);return null!=k&&k<=p}}function D(){return()=>!1}e.getTimeExtent=async function(t,N){if(!t)return null;const a=N.featureAdapter,{startTimeField:p,endTimeField:k}=t;let y=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;if(p&&k)await N.forEach(I=>{const G=a.getAttribute(I,p);I=a.getAttribute(I,k);null==G||isNaN(G)||(y=Math.min(y,G));null==I||isNaN(I)||(w=Math.max(w,I))});else{const I=p||k;await N.forEach(G=>{G=
a.getAttribute(G,I);null==G||isNaN(G)||(y=Math.min(y,G),w=Math.max(w,G))})}return{start:y,end:w}};e.getTimeOperator=function(t,N,a){if(!N||!t)return null;const {startTimeField:p,endTimeField:k}=t;if(!p&&!k)return null;const {start:y,end:w}=N;if(null===y&&null===w)return null;if(void 0===y&&void 0===w)return D();t=a.getAttributeAsTimestamp?.bind(a)??a.getAttribute.bind(a);return p&&k?l(t,p,k,y,w):x(t,p||k,y,w)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(e,l,x,D,t,N,a,p){function k(r){return r.trim().toLowerCase()}function y(r){const J=new Map;if(!r.fields)return J;const K=!0===r.datesInUnknownTimezone,{timeInfo:v,editFieldsInfo:b}=r;var q=(v?"startField"in v?v.startField:v.startTimeField:"")??"";const L=(v?"endField"in v?v.endField:v.endTimeField:"")??"",d="dateFieldsTimeZone"in r?r.dateFieldsTimeZone??null:r.dateFieldsTimeReference?a.fromTimeReference(r.dateFieldsTimeReference):null,z=b?"timeZone"in b?b.timeZone??d:b.dateFieldsTimeReference?
a.fromTimeReference(b.dateFieldsTimeReference):d??a.utc:null,M=v?"timeZone"in v?v.timeZone??d:v.timeReference?a.fromTimeReference(v.timeReference):d:null;q=new Map([[k(b?.creationDateField??""),z],[k(b?.editDateField??""),z],[k(q),M],[k(L),M]]);for(const {name:Q,type:Z}of r.fields)G.has(Z)?J.set(Q,a.unknown):"date"!==Z&&"esriFieldTypeDate"!==Z?J.set(Q,null):K?J.set(Q,a.unknown):(r=q.get(k(Q??""))??d,J.set(Q,r));return J}const w=new Map;class I{static fromJSON(r){return new I(r.fields,r.timeZoneByFieldName)}static fromLayer(r){return new I(r.fields??
[],y(r))}static fromLayerJSON(r){return new I(r.fields??[],y(r))}constructor(r=[],J){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=r||[];this._timeZoneByFieldName=J?new Map(J):null;r=[];for(const K of this.fields){J=K?.name;const v=N.normalizeFieldName(J)?.toLowerCase()??"";if(J&&v){const b=k(J);this._fieldsMap.set(J,K);this._fieldsMap.set(b,K);this._normalizedFieldsMap.set(v,
K);r.push(`${b}:${K.type}:${this._timeZoneByFieldName?.get(J)}`);N.isDateField(K)?(this.dateFields.push(K),this._dateFieldsSet.add(K)):N.isNumericField(K)&&(this._numericFieldsSet.add(K),this.numericFields.push(K));N.isObjectIDField(K)||N.isGlobalIDField(K)||(K.editable=null==K.editable||!!K.editable,K.nullable=null==K.nullable||!!K.nullable)}}r.sort();this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const r of this.fields)N.isObjectIDField(r)||N.isGlobalIDField(r)||
r.nullable||void 0!==N.getFieldDefaultValue(r)||this._requiredFields.push(r)}return this._requiredFields}equals(r){return this.uid===r?.uid}has(r){return null!=this.get(r)}get(r){if(r){var J=this._fieldsMap.get(r);if(J)return J;(J=this._fieldsMap.get(k(r))??this._normalizedFieldsMap.get(N.normalizeFieldName(r)?.toLowerCase()??""))&&this._fieldsMap.set(r,J);return J}}getTimeZone(r){r=this.get(r&&"string"!==typeof r?r.name:r);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):
"date"===r.type||"esriFieldTypeDate"===r.type?(x.getLogger("esri.layers.support.FieldsIndex").error(new e("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),a.utc):G.has(r.type)?a.unknown:null:null}getLuxonTimeZone(r){const J=this.getTimeZone(r);return J?J===a.unknown?t.UnknownTimeZone.instance:J===a.utc?p.FixedOffsetZone.utcInstance:D.getOrCreateMapValue(w,J,()=>p.IANAZone.create(J)):null}isDateField(r){return this._dateFieldsSet.has(this.get(r))}isTimeOnlyField(r){return N.isTimeOnlyField(this.get(r))}isNumericField(r){return this._numericFieldsSet.has(this.get(r))}normalizeFieldName(r){return this.get(r)?.name??
void 0}toJSON(){return{fields:this.fields.map(r=>l.isSerializable(r)?r.toJSON():r),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const G=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return I})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(e,l,x,D,t,N,a,p,k,y,w,I,G,r,J){function K(T){return v.has(T)?v.get(T):"number"===typeof T?T:1}e.TaskPriority=void 0;(function(T){T.RESOURCE_CONTROLLER_IMMEDIATE="immediate";T.RESOURCE_CONTROLLER="schedule";T.SLIDE="slide";T.STREAM_DATA_LOADER="stream loader";T.ELEVATION_QUERY="elevation query";T.TERRAIN_SURFACE="terrain";T.SURFACE_GEOMETRY_UPDATES="surface geometry updates";T.LOD_RENDERER="LoD renderer";T.GRAPHICS_CORE="Graphics3D";T.I3S_CONTROLLER="I3S";T.POINT_CLOUD_LAYER="point cloud";
T.FEATURE_TILE_FETCHER="feature fetcher";T.OVERLAY="overlay";T.STAGE="stage";T.GRAPHICS_DECONFLICTOR="graphics deconflictor";T.FILTER_VISIBILITY="Graphics3D filter visibility";T.SCALE_VISIBILITY="Graphics3D scale visibility";T.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";T.POINT_OF_INTEREST_FREQUENT="POI frequent";T.POINT_OF_INTEREST_INFREQUENT="POI infrequent";T.LABELER="labeler";T.FEATURE_QUERY_ENGINE="feature query";T.FEATURE_TILE_TREE="feature tile tree";T.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
T.ELEVATION_ALIGNMENT="elevation alignment";T.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";T.TEXT_TEXTURE_ATLAS="text texture atlas";T.TEXTURE_UNLOAD="texture unload";T.LINE_OF_SIGHT_TOOL="line of sight tool";T.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";T.ELEVATION_PROFILE="elevation profile";T.SNAPPING="snapping";T.SHADOW_ACCUMULATOR="shadow accumulator";T.CLOUDS_GENERATOR="clouds generator";T.MAPVIEW_FETCH_QUEUE="mapview fetch queue";T.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update";
T.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue";T[T.NONE=0]="NONE";T[T.TEST_PRIO=1]="TEST_PRIO"})(e.TaskPriority||(e.TaskPriority={}));const v=new Map([[e.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[e.TaskPriority.RESOURCE_CONTROLLER,4],[e.TaskPriority.SLIDE,0],[e.TaskPriority.STREAM_DATA_LOADER,0],[e.TaskPriority.ELEVATION_QUERY,0],[e.TaskPriority.TERRAIN_SURFACE,1],[e.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[e.TaskPriority.LOD_RENDERER,2],[e.TaskPriority.GRAPHICS_CORE,
2],[e.TaskPriority.I3S_CONTROLLER,2],[e.TaskPriority.POINT_CLOUD_LAYER,2],[e.TaskPriority.FEATURE_TILE_FETCHER,2],[e.TaskPriority.CLOUDS_GENERATOR,2],[e.TaskPriority.OVERLAY,4],[e.TaskPriority.STAGE,4],[e.TaskPriority.GRAPHICS_DECONFLICTOR,4],[e.TaskPriority.FILTER_VISIBILITY,4],[e.TaskPriority.SCALE_VISIBILITY,4],[e.TaskPriority.FRUSTUM_VISIBILITY,4],[e.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[e.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[e.TaskPriority.LABELER,8],[e.TaskPriority.FEATURE_QUERY_ENGINE,
8],[e.TaskPriority.FEATURE_TILE_TREE,16],[e.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[e.TaskPriority.ELEVATION_ALIGNMENT,12],[e.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[e.TaskPriority.TEXT_TEXTURE_ATLAS,12],[e.TaskPriority.TEXTURE_UNLOAD,12],[e.TaskPriority.LINE_OF_SIGHT_TOOL,16],[e.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[e.TaskPriority.SNAPPING,0],[e.TaskPriority.SHADOW_ACCUMULATOR,30],[e.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[e.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[e.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,
0]]),b=w.Milliseconds(6.5),q=w.Milliseconds(1),L=w.Milliseconds(30),d=w.Milliseconds(1E3/30),z=w.Milliseconds(100);var M;(function(T){class u{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(f=>f.needsUpdate)}constructor(){this._updating=y.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new N("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new g;this._state=r.RenderState.INTERACTING;this._tasks=
new a;this._runQueue=new a;this._load=0;this._idleStateCallbacks=new a;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=k.watch(()=>G.SCHEDULER_LOG_SLOW_TASKS,f=>this._debug=f,k.initial);for(const f of Object.keys(e.TaskPriority))this.performanceInfo.tasks.set(e.TaskPriority[f],new N(e.TaskPriority[f]))}destroy(){this._tasks.toArray().forEach(f=>f.remove());this._tasks.clear();t.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(f){this._updatingChanged();
f&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(f,h){h=new R(this,f,h);this._tasks.push(h);this._updatingChanged();this.performanceInfo.tasks.has(f)||this.performanceInfo.tasks.set(f,new N(f));return h}registerIdleStateCallbacks(f,h){const A={idleBegin:f,idleEnd:h};this._idleStateCallbacks.push(A);this.state===r.RenderState.IDLE&&
this._idleUpdatesStartFired&&A.idleBegin();const P=this;return{remove:()=>this._removeIdleStateCallbacks(A),set idleBegin(X){P._idleUpdatesStartFired&&(A.idleEnd(),P._state===r.RenderState.IDLE&&X());A.idleBegin=X},set idleEnd(X){A.idleEnd=X}}}get load(){return this._load}set state(f){this._state!==f&&(this._state=f,this.state!==r.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(h=>h.idleEnd())))}get state(){return this._state}updateBudget(f){this._test&&
(this._test.usedBudget=0);++this._frameNumber;let h=b,A=f.frameDuration,P=q;switch(this.state){case r.RenderState.IDLE:h=w.Milliseconds(0);A=w.Milliseconds(Math.max(z,f.frameDuration));P=L;break;case r.RenderState.INTERACTING:A=w.Milliseconds(Math.max(d,f.frameDuration))}A=w.Milliseconds(A-f.elapsedFrameTime-h);if(this.state!==r.RenderState.IDLE&&A<q&&!this._forceTask)return this._forceTask=!0,!1;A=w.Milliseconds(Math.max(A,P));this._budget.reset(A,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=
this._forceTask=!1;switch(this.state){case r.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(f=>f.idleBegin()));this._runIdle();break;case r.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(w.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(f){this._idleUpdatesStartFired&&f.idleEnd();
this._idleStateCallbacks.removeUnordered(f)}removeTask(f){this._tasks.removeUnordered(f);this._runQueue.removeUnordered(f);this._updatingChanged()}_updateTask(f){this._tasks.forAll(h=>{h.name===f&&h.setPriority(f)})}_getState(f){if(this._runQueue.some(A=>A.name===f))return e.TaskState.SCHEDULED;let h=e.TaskState.IDLE;this._tasks.forAll(A=>{A.name===f&&A.needsUpdate&&(1>=A.schedulePriority?h=e.TaskState.READY:h!==e.TaskState.READY&&(h=e.TaskState.WAITING))});return h}_getRuntime(f){let h=0;this._tasks.forAll(A=>
{A.name===f&&(h+=A.runtime)});return h}_resetRuntimes(){this._tasks.forAll(f=>f.runtime=0)}_getRunning(){const f=new Map;this._tasks.forAll(A=>{A.needsUpdate&&f.set(A.name,(f.get(A.name)||0)+1)});if(0===f.size)return null;let h="";f.forEach((A,P)=>{h=1<A?h+` ${A}x ${P}`:h+` ${P}`});return h}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const f=this._tasks.reduce((h,A)=>A.needsUpdate?++h:h,0);this._load=.9*this._load+f*(1-.9)}_schedule(){this._runQueue.filterInPlace(f=>
{if(f.needsUpdate)return!0;f.schedulePriority=f.basePriority;return!1});for(this._tasks.forAll(f=>{0===f.basePriority&&f.needsUpdate&&!this._runQueue.includes(f)&&f.blockFrame!==this._frameNumber&&this._runQueue.unshift(f)});0===this._runQueue.length;){let f=!1;this._tasks.forAll(h=>{if(h.needsUpdate&&0!==h.schedulePriority&&0!==h.basePriority&&h.blockFrame!==this._frameNumber)switch(f=!0,h.schedulePriority){case 1:h.schedulePriority=0;this._runQueue.push(h);break;default:--h.schedulePriority}});
if(!f)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const f=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var h=this._budget.now();const A=this._runQueue.pop();this._budget.resetProgress();try{A.task.runTask(this._budget)===J.Yield&&(A.blockFrame=this._frameNumber)}catch(P){D.getLogger("esri.views.support.Scheduler").error(`Exception in task "${A.name}"`,P),A.blockFrame=this._frameNumber}!this._budget.hasProgressed&&A.blockFrame!==this._frameNumber&&
A.needsUpdate&&(A.blockFrame=this._frameNumber);A.schedulePriority=A.basePriority;h=this._budget.now()-h;A.runtime+=h;this._frameTaskTimes.set(A.priority,this._frameTaskTimes.get(A.priority)+h);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-f);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-f)}_startFrameTaskTimes(){for(const f of Object.keys(e.TaskPriority))this._frameTaskTimes.set(e.TaskPriority[f],
0)}_recordFrameTaskTimes(f){this._frameTaskTimes.forEach((h,A)=>this.performanceInfo.tasks.get(A).push(h));this.performanceInfo.total.push(f)}get test(){return this._test}}T.Scheduler=u;class R{get task(){return this._task.value}get updating(){return this._queue.running}constructor(f,h,A){this._scheduler=f;this.name=h;this.runtime=this.blockFrame=0;this._queue=new I.PromiseQueue;this._handles=new l;this.schedulePriority=this._basePriority=K(h);this._task=y.signal(null!=A?A:this._queue);this._handles.add(k.when(()=>
this.task.running,P=>f.taskRunningChanged(P)))}remove(){this.processQueue(Q);this._scheduler.removeTask(this);this.schedule=U.schedule;this.reschedule=U.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(f){if(this.name!==f){this.name=f;f=K(f);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=f;this._basePriority=f}}get priority(){return this.name}set priority(f){this.setPriority(f)}get needsUpdate(){return this.updating||this.task.running}schedule(f,
h,A){return this._queue.push(f,h,A)}reschedule(f,h,A){return this._queue.unshift(f,h,A)}processQueue(f){return this._queue.runTask(f)}}class g{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=r.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(f){if(this.done)return!1;!0===f()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(f){this._enabled=f}reset(f,h){this._begin=this.now();this._budget=f;this._state=h;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}T.Budget=g})(M||={});e.TaskState=void 0;(function(T){T.SCHEDULED=
"s";T.READY="r";T.WAITING="w";T.IDLE="i"})(e.TaskState||(e.TaskState={}));const Q=(()=>{const T=new M.Budget;T.enabled=!1;return T})();class Z{remove(){}processQueue(){}schedule(T,u,R){try{if(p.isAborted(u)){const g=p.createAbortError();return R?Promise.resolve(R(g)):Promise.reject(g)}return p.when(T(Q))}catch(g){return Promise.reject(g)}}reschedule(T,u,R){return this.schedule(T,u,R)}}const U=new Z;e.ImmediateTask=U;e.getTaskPriority=K;e.newScheduler=function(){return new M.Scheduler};e.noBudget=
Q;e.taskPriorities=v;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(e,l,x,D){class t{constructor(N,a){this._observable=new D.SimpleObservable;this._value=N;this._equalityFunction=a}get value(){x.trackAccess(this._observable);return this._value}set value(N){this._equalityFunction(N,this._value)||(this._value=N,this._observable.notify())}mutate(N){N(this._value);
this._observable.notify()}}e.signal=function(N,a=l.equalsShallow){return new t(N,a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(e,l,x,D){class t{constructor(){this._tasks=[];this._runningTasks=x.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(a){if(0===
this.length)return D.Yield;for(;!a.done&&this._process(a);)a.madeProgress()}push(a,p,k){++this._runningTasks.value;return(new Promise((y,w)=>this._tasks.push(new N(y,w,a,p,k)))).finally(()=>--this._runningTasks.value)}unshift(a,p,k){++this._runningTasks.value;return(new Promise((y,w)=>this._tasks.unshift(new N(y,w,a,p,k)))).finally(()=>--this._runningTasks.value)}_process(a){if(0===this._tasks.length)return!1;const p=this._tasks.shift();try{const k=l.isAborted(p.signal);if(k&&!p.abortCallback)p.reject(l.createAbortError());
else{const y=k?p.abortCallback?.(l.createAbortError()):p.callback(a);l.isPromiseLike(y)?y.then(p.resolve,p.reject):p.resolve(y)}}catch(k){p.reject(k)}return!0}cancelAll(){const a=l.createAbortError();for(const p of this._tasks)if(p.abortCallback){const k=p.abortCallback(a);p.resolve(k)}else p.reject(a);this._tasks.length=0}}class N{constructor(a,p,k,y,w){this.resolve=a;this.reject=p;this.callback=k;this.signal=y;this.abortCallback=w}}e.PromiseQueue=t;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(e){const l=Symbol("Yield");e.Yield=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(e,l,x,D,t,N,a){l=class extends l{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};e.__decorate([x.property()],l.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);e.__decorate([x.property()],l.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);l=e.__decorate([a.subclass("esri.views.support.debugFlags")],l);return new l})},"esri/views/support/RenderState":function(){define(["exports"],function(e){e.RenderState=void 0;var l=e.RenderState||(e.RenderState={});l[l.ANIMATING=0]="ANIMATING";l[l.INTERACTING=1]="INTERACTING";l[l.IDLE=2]=
"IDLE";Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),function(e,l,x,D,t,N,a){function*p(z){switch(z.type){case "Feature":yield z;break;case "FeatureCollection":for(const M of z.features)M&&(yield M)}}function*k(z){if(z)switch(z.type){case "Point":yield z.coordinates;
break;case "LineString":case "MultiPoint":yield*z.coordinates;break;case "MultiLineString":case "Polygon":for(const M of z.coordinates)yield*M;break;case "MultiPolygon":for(const M of z.coordinates)for(const Q of M)yield*Q}}function*y(z,M={}){const {geometryType:Q,objectIdField:Z}=M;for(const U of z){const {geometry:T,properties:u,id:R}=U;if(T&&d[T.type]!==Q)continue;z=u||{};let g=void 0;Z&&(g=z[Z],null==R||g||(z[Z]=g=R));yield new t.OptimizedFeature(T?r(new N,T,M):null,z,null,g??void 0)}}function w(z){for(const M of z)if(2<
M.length)return!0;return!1}function I(z){let M=0;for(let Q=0;Q<z.length;Q++){const Z=z[Q],U=z[(Q+1)%z.length];M+=Z[0]*U[1]-U[0]*Z[1]}return 0>=M}function G(z){const M=z[0],Q=z[z.length-1];M[0]===Q[0]&&M[1]===Q[1]&&M[2]===Q[2]||z.push(M);return z}function r(z,M,Q){switch(M.type){case "LineString":return v(z,M.coordinates,Q),z;case "MultiLineString":for(const U of M.coordinates)v(z,U,Q);return z;case "MultiPoint":return v(z,M.coordinates,Q),z;case "MultiPolygon":for(var Z of M.coordinates)for(J(z,Z[0],
Q),M=1;M<Z.length;M++)K(z,Z[M],Q);return z;case "Point":return q(z,M.coordinates,Q),z;case "Polygon":Z=M.coordinates;J(z,Z[0],Q);for(M=1;M<Z.length;M++)K(z,Z[M],Q);return z}}function J(z,M,Q){M=G(M);I(M)?v(z,M,Q):b(z,M,Q)}function K(z,M,Q){M=G(M);I(M)?b(z,M,Q):v(z,M,Q)}function v(z,M,Q){for(const Z of M)q(z,Z,Q);z.lengths.push(M.length)}function b(z,M,Q){for(let Z=M.length-1;0<=Z;Z--)q(z,M[Z],Q);z.lengths.push(M.length)}function q(z,M,Q){const [Z,U,T]=M;z.coords.push(Z,U);Q.hasZ&&z.coords.push(T||
0)}function L(z){switch(typeof z){case "string":return l.isISO8601Date(z)?"esriFieldTypeDate":"esriFieldTypeString";case "number":return"esriFieldTypeDouble";default:return"unknown"}}const d={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};e.createOptimizedFeatures=function(z,M){return Array.from(y(p(z),M))};e.getGeometryType=function(z){return d[z]};
e.inferLayerProperties=function(z,M={}){const Q=[];var Z=new Set;const U=new Set;var T=!1;let u=null,R=!1,g=void 0;({geometryType:M=null}=M);for(const f of p(z)){const {geometry:h,properties:A,id:P}=f;if(h&&(M||=d[h.type],d[h.type]!==M))continue;T||(T=k(h),T=w(T));!R&&(R=null!=P)&&(g=typeof P,A&&(u=Object.keys(A).filter(X=>A[X]===P)));A&&u&&R&&null!=P&&(1<u.length?u=u.filter(X=>A[X]===P):1===u.length&&(u=A[u[0]]===P?u:[]));if(A)for(const X in A){if(Z.has(X))continue;z=L(A[X]);if("unknown"===z){U.add(X);
continue}U.delete(X);Z.add(X);const ca=a.normalizeFieldName(X);ca&&Q.push({name:ca,alias:X,type:z})}}if(Z=a.normalizeFieldName(1===u?.length&&u[0]||null)??void 0)for(const f of Q)if(f.name===Z&&a.isNumericField(f)){f.type="esriFieldTypeOID";break}return{fields:Q,geometryType:M,hasZ:T,objectIdFieldName:Z,objectIdFieldType:g,unknownFields:Array.from(U)}};e.validateGeoJSON=function(z,M=4326){if(!z)throw new x("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==z.type&&"FeatureCollection"!==
z.type)throw new x("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:z});({crs:z}=z);if(z){var Q="string"===typeof z?z:"name"===z.type?z.properties.name:"EPSG"===z.type?z.properties.code:null;M=D.isWGS84({wkid:M})?RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${M})$`,"i");if(!Q||!M.test(Q))throw new x("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:z});}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],
function(e){function l(a){const p=new Date(a);if(Number.isNaN(p.getTime()))a=!1;else{var k=!0;if(N&&/\d+\W*$/.test(a)&&(a=a.match(/[a-zA-Z]{2,}/))){k=!1;let y=0;for(;!k&&y<=a.length;)k=!t.test(a[y]),y++;k=!k}a=k}return a?Number.isNaN(p.getTime())?null:p.getTime()-6E4*p.getTimezoneOffset():null}function x(a){a=D.exec(a);if(!a?.groups)return null;a=a.groups;const p=+a.year,k=+a.month-1,y=+a.day,w=+(a.hours??0),I=+(a.minutes??0),G=+(a.seconds??0);if(23<w||59<I||59<G)return null;var r=a.ms??"0";r=r?+r.padEnd(3,
"0").slice(0,3):0;a=a.isUTC||!a.offsetSign?Date.UTC(p,k,y,w,I,G,r):6E4*("+"===a.offsetSign?-1:1)*(60*+a.offsetHours+ +a.offsetMinutes)+Date.UTC(p,k,y,w,I,G,r);return Number.isNaN(a)?null:a}const D=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,t=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,
N=!Number.isNaN((new Date("technology 10")).getTime());e.isDateString=function(a){return null!=x(a)||null!=l(a)};e.isISO8601Date=function(a){return D.test(a)};e.parseDate=function(a){return x(a)??l(a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("exports ../../../../core/has ../../../../core/lang ../../data/QueryEngineCapabilities ../../../support/capabilities ../../../../symbols/support/defaultsJSON".split(" "),
function(e,l,x,D,t,N){function a(y){return p.test(y)?`.${y}`:`["${y}"]`}const p=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let k=1;e.createCapabilities=function(y,w){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:y},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:w,supportsDelete:w,supportsEditing:w,supportsChangeTracking:!1,supportsQuery:!0,
supportsQueryBins:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:w,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:D.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:t.zeroQueryBins,editing:{supportsGeometryUpdate:w,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,
supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}};e.createDefaultAttributesFunction=function(y,w){if(l("esri-csp-restrictions"))return()=>({[w]:null,...y});try{let I=`this${a(w)} = null;`;for(const r in y){const J=a(r);I+=`this${J} = ${JSON.stringify(y[r])};`}const G=(new Function(`\n      return class AttributesClass$${k++} {\n        constructor() {\n          ${I};\n        }\n      }\n    `))();
return()=>new G}catch(I){return()=>({[w]:null,...y})}};e.createDefaultTemplate=function(y={}){return[{name:"New Feature",description:"",prototype:{attributes:x.clone(y)}}]};e.createDrawingInfo=function(y){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===y||"esriGeometryMultipoint"===y?N.defaultPointSymbolJSON:"esriGeometryPolyline"===y?N.defaultPolylineSymbolJSON:N.defaultPolygonSymbolJSON}}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/capabilities":function(){define(["exports"],
function(e){const l={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportedStatistics:void 0};e.zeroCapabilities={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,
supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,
supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:l,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,
supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,
supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};e.zeroQueryBins=l;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(e){const l=[252,146,31,255],x={type:"esriSMS",style:"esriSMSCircle",size:6,color:l,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,
153,255]}},D={type:"esriSLS",style:"esriSLSSolid",width:.75,color:l};e.defaultColor=l;e.defaultOutlineColor=[153,153,153,255];e.defaultPointSymbolJSON=x;e.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};e.defaultPolylineSymbolJSON=D;e.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,
haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};e.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};e.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};e.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require",
"exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(e,l,x,D,t){function N(G){return new k(G)}async function a(){null==I&&(I=await new Promise((G,r)=>e(["../../../../geometry/geometryEngineJSON"],G,r)));return I}class p{constructor(){this.description=this.code=null}}class k{constructor(G){this.error=new p;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=G}}class y{constructor(G){this.globalId=
null;this.success=!0;this.objectId=this.uniqueId=G}}const w=new Set;let I;l.createFeatureEditErrorResult=N;l.createFeatureEditSuccessResult=function(G){return new y(G)};l.loadGeometryEngineForSimplify=async function(G,r){!D.isValid(G)||"esriGeometryPolygon"!==r&&"esriGeometryPolyline"!==r||await a()};l.mixAttributes=function(G,r,J,K=!1){w.clear();for(const q in J){const L=G.get(q);if(!L)continue;var v=L,b=J[q];let d=b;t.isNumericField(v)&&"string"===typeof b?d=parseFloat(b):t.isStringField(v)&&null!=
b&&"string"!==typeof b?d=String(b):t.isDateField(v)&&"string"===typeof b&&(d=x.parseDate(b));v=t.sanitizeNullFieldValue(d);w.add(L.name);if(L&&(K||L.editable)){if(b=t.validateFieldValue(L,v))return N(t.validationErrorToString(b,L,v));r[L.name]=v}}for(const q of G.requiredFields??[])if(!w.has(q.name))return N(`missing required field "${q.name}"`);return null};l.simplify=function(G,r){if(!G||!D.isValid(r))return G;if("rings"in G||"paths"in G){if(null==I)throw new TypeError("geometry engine not loaded");
return I.simplify(r,G)}return G};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../request ../../../../core/asyncUtils ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils ../../../../time/timeZoneUtils".split(" "),function(e,
l,x,D,t,N,a,p,k,y,w,I,G,r,J,K,v,b){const q={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsQueryWithCacheHint:!0,supportsQueryWithDistance:!0,supportsQueryWithResultType:!0,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class L{constructor(){this._queryEngine=null;this._snapshotFeatures=async d=>{d=await this._fetch(d);return this._createFeatures(d)}}destroy(){this._queryEngine?.destroy();this._queryEngine=this._createDefaultAttributes=null}async load(d,z={}){this._loadOptions={url:d.url,customParameters:d.customParameters};var M=[];[z]=await Promise.all([d.url?this._fetch(z?.signal):null,this._checkProjection(d.spatialReference)]);
var Q=I.inferLayerProperties(z,{geometryType:d.geometryType}),Z=d.fields||Q.fields||[];const U=null!=d.hasZ?d.hasZ:Q.hasZ,T=Q.geometryType;let u=d.objectIdField||Q.objectIdFieldName||"__OBJECTID";const R=d.spatialReference||a.wgs84;d=d.timeInfo;Z===Q.fields&&0<Q.unknownFields.length&&M.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:Q.unknownFields}});var g=new J(Z);let f=g.get(u);f?("esriFieldTypeString"!==
f.type&&(f.type="esriFieldTypeOID"),f.editable=!1,f.nullable=!1,u=f.name):(f={alias:u,name:u,type:"string"===Q.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},Z.unshift(f));Q={};for(var h of Z){null==h.name&&(h.name=h.alias);null==h.alias&&(h.alias=h.name);if(!h.name)throw new x("geojson-layer:invalid-field-name","field name is missing",{field:h});if(!K.kebabDict.jsonValues.includes(h.type))throw new x("geojson-layer:invalid-field-type",`invalid type for field "${h.name}"`,
{field:h});if(h.name!==f.name){const X=v.getFieldDefaultValue(h);void 0!==X&&(Q[h.name]=X)}null==h.length&&(h.length=v.getFieldDefaultLength(h))}d&&(d.startTimeField&&((h=g.get(d.startTimeField))?(d.startTimeField=h.name,h.type="esriFieldTypeDate"):d.startTimeField=null),d.endTimeField&&((h=g.get(d.endTimeField))?(d.endTimeField=h.name,h.type="esriFieldTypeDate"):d.endTimeField=null),d.trackIdField&&((h=g.get(d.trackIdField))?d.trackIdField=h.name:(d.trackIdField=null,M.push({name:"geojson-layer:invalid-timeInfo-trackIdField",
message:"trackIdField is missing",details:{timeInfo:d}}))),d.startTimeField||d.endTimeField||(M.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:d}}),d=null));h=T?G.createDrawingInfo(T):void 0;g=g.dateFields.length?{timeZoneIANA:b.utc}:null;M={warnings:M,featureErrors:[],layerDefinition:{...q,drawingInfo:h??void 0,templates:G.createDefaultTemplate(Q),extent:void 0,geometryType:T,objectIdField:u,fields:Z,hasZ:!!U,timeInfo:d,dateFieldsTimeReference:g}};
this._queryEngine=new w.QueryEngine({fieldsIndex:J.fromLayerJSON({fields:Z,timeInfo:d,dateFieldsTimeReference:g}),geometryType:T,hasM:!1,hasZ:U,objectIdField:u,spatialReference:R,timeInfo:d,featureStore:new k({geometryType:T,hasM:!1,hasZ:U})});Z=this._queryEngine.fieldsIndex.requiredFields.indexOf(f);-1<Z&&this._queryEngine.fieldsIndex.requiredFields.splice(Z,1);this._createDefaultAttributes=G.createDefaultAttributesFunction(Q,u);z=await this._createFeatures(z);this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,
z);z=this._normalizeFeatures(z,M.featureErrors);this._queryEngine.featureStore.addMany(z);const {fullExtent:A,timeExtent:P}=await this._queryEngine.fetchRecomputedExtents();M.layerDefinition.extent=A;if(P){const {start:X,end:ca}=P;M.layerDefinition.timeInfo.timeExtent=[X,ca]}return M}async applyEdits(d){const {spatialReference:z,geometryType:M}=this._queryEngine;await Promise.all([r.loadGeometryEngineForSimplify(z,M),y.checkProjectionSupport(d.adds,z),y.checkProjectionSupport(d.updates,z)]);await this._waitSnapshotComplete();
return this._applyEdits(d)}async queryFeatures(d={},z={}){await this._waitSnapshotComplete();return this._queryEngine.executeQuery(d,z.signal)}async queryFeatureCount(d={},z={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForCount(d,z.signal)}async queryObjectIds(d={},z={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForIds(d,z.signal)}async queryExtent(d={},z={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForExtent(d,
z.signal)}async querySnapping(d,z={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForSnapping(d,z.signal)}async refresh(d){this._loadOptions.customParameters=d;this._snapshotTask?.abort();this._snapshotTask=l.createTask(this._snapshotFeatures);this._snapshotTask.promise.then(Q=>{this._queryEngine.featureStore.clear();this._objectIdGenerator=this._createObjectIdGenerator(this._queryEngine,Q);(Q=this._normalizeFeatures(Q))&&this._queryEngine.featureStore.addMany(Q)},Q=>{this._queryEngine.featureStore.clear();
t.isAbortError(Q)||D.getLogger("esri.layers.GeoJSONLayer").error(new x("geojson-layer:refresh","An error occurred during refresh",{error:Q}))});await this._waitSnapshotComplete();const {fullExtent:z,timeExtent:M}=await this._queryEngine.fetchRecomputedExtents();return{extent:z,timeExtent:M}}async _createFeatures(d){if(null==d)return[];const {geometryType:z,hasZ:M,objectIdField:Q}=this._queryEngine;d=I.createOptimizedFeatures(d,{geometryType:z,hasZ:M,objectIdField:Q});if(!a.equals(this._queryEngine.spatialReference,
a.wgs84))for(const Z of d)null!=Z.geometry&&(Z.geometry=p.convertFromGeometry(y.project(p.convertToGeometry(Z.geometry,this._queryEngine.geometryType,this._queryEngine.hasZ,!1),a.wgs84,this._queryEngine.spatialReference)));return d}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _fetch(d){const {url:z,customParameters:M}=this._loadOptions;d=(await e(z??"",{responseType:"json",
query:{...M},signal:d})).data;I.validateGeoJSON(d);return d}_normalizeFeatures(d,z){const {objectIdField:M,fieldsIndex:Q}=this._queryEngine,Z=[];for(const U of d){d=this._createDefaultAttributes();const T=r.mixAttributes(Q,d,U.attributes,!0);T?z?.push(T):(this._assignObjectId(d,U.attributes,!0),U.attributes=d,U.objectId=d[M],Z.push(U))}return Z}async _applyEdits(d){const {adds:z,updates:M,deletes:Q}=d;d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};z?.length&&this._applyAddEdits(d,
z);M?.length&&this._applyUpdateEdits(d,M);if(Q?.length){for(const T of Q)d.deleteResults.push(r.createFeatureEditSuccessResult(T));this._queryEngine.featureStore.removeManyById(Q)}const {fullExtent:Z,timeExtent:U}=await this._queryEngine.fetchRecomputedExtents();return{extent:Z,timeExtent:U,featureEditResults:d}}_applyAddEdits(d,z){const {addResults:M}=d,{geometryType:Q,hasM:Z,hasZ:U,objectIdField:T,spatialReference:u,featureStore:R,fieldsIndex:g}=this._queryEngine,f=[];for(const h of z){if(h.geometry&&
Q!==N.getJsonType(h.geometry)){M.push(r.createFeatureEditErrorResult("Incorrect geometry type."));continue}z=this._createDefaultAttributes();const A=r.mixAttributes(g,z,h.attributes);A?M.push(A):(this._assignObjectId(z,h.attributes),h.attributes=z,null!=h.uid&&(d.uidToObjectId[h.uid]=h.attributes[T]),null!=h.geometry&&(z=h.geometry.spatialReference??u,h.geometry=y.project(r.simplify(h.geometry,z),z,u)),f.push(h),M.push(r.createFeatureEditSuccessResult(h.attributes[T])))}R.addMany(p.convertFromFeatures([],
f,Q,U,Z,T))}_applyUpdateEdits({updateResults:d},z){const {geometryType:M,hasM:Q,hasZ:Z,objectIdField:U,spatialReference:T,featureStore:u,fieldsIndex:R}=this._queryEngine;for(const f of z){const {attributes:h,geometry:A}=f;z=h?.[U];if(null==z){d.push(r.createFeatureEditErrorResult(`Identifier field ${U} missing`));continue}if(!u.has(z)){d.push(r.createFeatureEditErrorResult(`Feature with object id ${z} missing`));continue}const P=p.convertToFeature(u.getFeature(z),M,Z,Q);if(null!=A){if(M!==N.getJsonType(A)){d.push(r.createFeatureEditErrorResult("Incorrect geometry type."));
continue}var g=A.spatialReference??T;P.geometry=y.project(r.simplify(A,g),g,T)}if(h&&(g=r.mixAttributes(R,P.attributes,h))){d.push(g);continue}u.add(p.convertFromFeature(P,M,Z,Q,U));d.push(r.createFeatureEditSuccessResult(z))}}_createObjectIdGenerator(d,z){const M=d.fieldsIndex.get(d.objectIdField);if("esriFieldTypeString"===M.type)return()=>M.name+"-"+Date.now().toString(16);let Q=Number.NEGATIVE_INFINITY;for(const Z of z)Z.objectId&&(Q=Math.max(Q,Z.objectId));Q=Math.max(0,Q)+1;return()=>Q++}_assignObjectId(d,
z,M=!1){const Q=this._queryEngine.objectIdField;d[Q]=M&&Q in z?z[Q]:this._objectIdGenerator()}async _checkProjection(d){try{await y.checkProjectionSupport(a.wgs84,d)}catch{throw new x("geojson-layer","Projection not supported");}}}return L});