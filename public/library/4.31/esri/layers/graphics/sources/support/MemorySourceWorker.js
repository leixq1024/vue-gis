// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(e,k,y,C,r,M,a,p,h,w){function x(B,H){return B?H?4:3:H?3:2}function I(B,H,N,V){if(B){if(N)return H&&V?E:La;if(H&&V)return m}else if(H&&V)return La;return ab}function F({scale:B,
translate:H},N){return Math.round((N-H[0])/B[0])}function t({scale:B,translate:H},N){return Math.round((H[1]-N)/B[1])}function J({scale:B,translate:H},N,V){return N*B[V]+H[V]}function K(B){B=B.coords;return{x:B[0],y:B[1]}}function u(B,H){B.coords[0]=H.x;B.coords[1]=H.y;return B}function b(B){B=B.coords;return{x:B[0],y:B[1],z:B[2]}}function q(B,H){B.coords[0]=H.x;B.coords[1]=H.y;B.coords[2]=H.z;return B}function L(B){B=B.coords;return{x:B[0],y:B[1],m:B[2]}}function d(B,H){B.coords[0]=H.x;B.coords[1]=
H.y;B.coords[2]=H.m;return B}function G(B){B=B.coords;return{x:B[0],y:B[1],z:B[2],m:B[3]}}function P(B,H){B.coords[0]=H.x;B.coords[1]=H.y;B.coords[2]=H.z;B.coords[3]=H.m;return B}function S(B,H){return B&&H?P:B?q:H?d:u}function ca(B,H,N,V,Z){N=S(N,V);for(const {geometry:da,attributes:ea}of H)H=null!=da?N(new w,da):null,B.push(new p.OptimizedFeature(H,ea,null,Z?ea[Z]:void 0));return B}function U(B,H,N=S(null!=H.z,null!=H.m)){return N(B,H)}function T(B,H,N,V){for(const {geometry:Z,attributes:da}of H)B.push({attributes:da,
geometry:null!=Z?v(Z,N,V):null});return B}function v(B,H,N){if(null==B)return null;const V=x(H,N),Z=[];for(let da=0;da<B.coords.length;da+=V){const ea=[];for(let la=0;la<V;la++)ea.push(B.coords[da+la]);Z.push(ea)}return H?N?{points:Z,hasZ:H,hasM:N}:{points:Z,hasZ:H}:N?{points:Z,hasM:N}:{points:Z}}function Q(B,H,N,V,Z){N=x(N,V);for(const {geometry:da,attributes:ea}of H)H=null!=da?g(new w,da,N):null,B.push(new p.OptimizedFeature(H,ea,null,Z?ea[Z]:void 0));return B}function g(B,H,N=x(H.hasZ,H.hasM)){B.lengths[0]=
H.points.length;const V=B.coords;let Z=0;for(const da of H.points)for(H=0;H<N;H++)V[Z++]=da[H];return B}function f(B,H,N){if(!B)return null;const V=x(H,N),{coords:Z,lengths:da}=B;B=[];let ea=0;for(const la of da){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=0;ra<V;ra++)qa.push(Z[ea++]);ma.push(qa)}B.push(ma)}return H?N?{paths:B,hasZ:H,hasM:N}:{paths:B,hasZ:H}:N?{paths:B,hasM:N}:{paths:B}}function l(B,H,N,V,Z){N=x(N,V);for(const {geometry:da,attributes:ea,centroid:la}of H)H=null!=da?
z(new w,da,N):null,V=null!=la?U(new w,la):null,B.push(new p.OptimizedFeature(H,ea,V,Z?ea[Z]:void 0));return B}function z(B,H,N=x(H.hasZ,H.hasM)){const {lengths:V,coords:Z}=B;let da=0;for(const ea of H.paths){for(const la of ea)for(H=0;H<N;H++)Z[da++]=la[H];V.push(ea.length)}return B}function O(B,H,N){if(!B)return null;const V=x(H,N),{coords:Z,lengths:da}=B;B=[];let ea=0;for(const la of da){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=0;ra<V;ra++)qa.push(Z[ea++]);ma.push(qa)}B.push(ma)}return H?
N?{rings:B,hasZ:H,hasM:N}:{rings:B,hasZ:H}:N?{rings:B,hasM:N}:{rings:B}}function X(B,H,N=H.hasZ,V=H.hasM){return ba(B,H.rings,N,V)}function ba(B,H,N,V){N=x(N,V);const {lengths:Z,coords:da}=B;V=0;Da(B);for(const ea of H){for(const la of ea)for(H=0;H<N;H++)da[V++]=la[H];Z.push(ea.length)}return B}function fa(B,H,N,V,Z,da){Ea(B);if(!N){for(const ea of H)B.push(new p.OptimizedFeature(null,ea.attributes,null,da?ea.attributes[da]:void 0));return B}switch(N){case "esriGeometryPoint":return ca(B,H,V,Z,da);
case "esriGeometryMultipoint":return Q(B,H,V,Z,da);case "esriGeometryPolyline":return l(B,H,V,Z,da);case "esriGeometryPolygon":case "esriGeometryMultiPatch":for(const {geometry:ea,centroid:la,attributes:ma}of H)H=null!=ea?X(new w,ea,V,Z):null,N=da?ma[da]:void 0,null!=la?B.push(new p.OptimizedFeature(H,ma,u(new w,la),N)):B.push(new p.OptimizedFeature(H,ma,null,N));break;default:Ja().error("convertToFeatureSet:unknown-geometry",new k(`Unable to parse unknown geometry type '${N}'`)),Ea(B)}return B}function na(B,
H,N,V){B=B&&("coords"in B?B:B.geometry);if(null==B)return null;switch(H){case "esriGeometryPoint":return H=K,N&&V?H=G:N?H=b:V&&(H=L),H(B);case "esriGeometryMultipoint":return v(B,N,V);case "esriGeometryPolyline":return f(B,N,V);case "esriGeometryPolygon":return O(B,N,V);default:return Ja().error("convertToGeometry:unknown-geometry",new k(`Unable to parse unknown geometry type '${H}'`)),null}}function oa(B,H,N,V,Z){Ea(B);if(null==N){for(const ea of H)B.push({attributes:ea.attributes});return B}switch(N){case "esriGeometryPoint":N=
K;V&&Z?N=G:V?N=b:Z&&(N=L);for(var da of H){const {geometry:ea,attributes:la}=da;V=null!=ea?N(ea):null;B.push({attributes:la,geometry:V})}break;case "esriGeometryMultipoint":return T(B,H,V,Z);case "esriGeometryPolyline":for(const {geometry:ea,attributes:la}of H)B.push({attributes:la,geometry:null!=ea?f(ea,V,Z):null});break;case "esriGeometryPolygon":for(const {geometry:ea,attributes:la,centroid:ma}of H)da=null!=ea?O(ea,V,Z):null,null!=ma?(H=K(ma),B.push({attributes:la,centroid:H,geometry:da})):B.push({attributes:la,
geometry:da});break;default:Ja().error("convertToFeatureSet:unknown-geometry",new k(`Unable to parse unknown geometry type '${N}'`))}return B}function pa(B,H,N,V,Z,da,ea=N,la=V){Da(B);if(!H?.coords.length)return null;Z=Sa[Z];const {coords:ma,lengths:ua}=H;H=x(N,V);const qa=x(N&&ea,V&&la);N=I(N,V,ea,la);if(!ua.length)return N(B.coords,ma,0,0,F(da,ma[0]),t(da,ma[1])),Da(B,H,0),B;let ra,Ba=0,ya,Aa=0;for(const Ca of ua){if(Ca<Z)continue;let za=0;ya=Aa;la=V=F(da,ma[Ba]);ra=ea=t(da,ma[Ba+1]);N(B.coords,
ma,ya,Ba,la,ra);za++;Ba+=H;ya+=qa;for(let Fa=1;Fa<Ca;Fa++,Ba+=H)if(la=F(da,ma[Ba]),ra=t(da,ma[Ba+1]),la!==V||ra!==ea)N(B.coords,ma,ya,Ba,la-V,ra-ea),ya+=qa,za++,V=la,ea=ra;za>=Z&&(B.lengths.push(za),Aa=ya)}Ea(B.coords,Aa);return B.coords.length?B:null}function sa(B,H,N,V,Z,da,ea){let la=V,ma=0;for(let qa=da+N;qa<ea;qa+=N){var ua=H[qa];const ra=H[qa+1],Ba=H[ea],ya=H[ea+1];let Aa=H[da],Ca=H[da+1],za=Ba-Aa,Fa=ya-Ca;if(0!==za||0!==Fa){const Ra=((ua-Aa)*za+(ra-Ca)*Fa)/(za*za+Fa*Fa);1<Ra?(Aa=Ba,Ca=ya):
0<Ra&&(Aa+=za*Ra,Ca+=Fa*Ra)}za=ua-Aa;Fa=ra-Ca;ua=za*za+Fa*Fa;ua>la&&(ma=qa,la=ua)}la>V&&(ma-da>N&&sa(B,H,N,V,Z,da,ma),Z(B,H,B.length,ma,H[ma],H[ma+1]),ea-ma>N&&sa(B,H,N,V,Z,ma,ea))}function wa(B,H,N,V,Z){const {coords:da,lengths:ea}=H;N=x(N,V);if(!da.length)return B!==H&&Da(B),B;C.assertIsSome(Z);const {originPosition:la,scale:ma,translate:ua}=Z;Z=ja;Z.originPosition=la;V=Z.scale;V[0]=ma[0]??1;V[1]=-(ma[1]??1);V[2]=ma[2]??1;V[3]=ma[3]??1;var qa=Z.translate;qa[0]=ua[0]??0;qa[1]=ua[1]??0;qa[2]=ua[2]??
0;qa[3]=ua[3]??0;if(!ea.length){for(V=0;V<N;++V)B.coords[V]=J(Z,da[V],V);B!==H&&Da(B,N,0);return B}qa=0;for(let Ba=0;Ba<ea.length;Ba++){const ya=ea[Ba];B.lengths[Ba]=ya;for(var ra=0;ra<N;++ra)B.coords[qa+ra]=J(Z,da[qa+ra],ra);ra=B.coords[qa];let Aa=B.coords[qa+1];qa+=N;for(let Ca=1;Ca<ya;Ca++,qa+=N){ra+=da[qa]*V[0];Aa+=da[qa+1]*V[1];B.coords[qa]=ra;B.coords[qa+1]=Aa;for(let za=2;za<N;++za)B.coords[qa+za]=J(Z,da[qa+za],za)}}B!==H&&Da(B,da.length,ea.length);return B}function xa(B,H,N,V){let Z=0,da=
B[V*H],ea=B[V*(H+1)];for(let la=1;la<N;la++){const ma=da+B[V*(H+la)],ua=ea+B[V*(H+la)+1],qa=(ma-da)*(ua+ea);da=ma;ea=ua;Z+=qa}return.5*Z}function Da(B,H=0,N=0){Ea(B.lengths,N);Ea(B.coords,H)}function Ea(B,H=0){B.length!==H&&(B.length=H)}const Ja=()=>y.getLogger("esri.layers.graphics.featureConversionUtils"),Sa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},ab=(B,H,N,V,Z,da)=>{B[N]=Z;B[N+1]=da},La=(B,H,N,V,
Z,da)=>{B[N]=Z;B[N+1]=da;B[N+2]=H[V+2]},m=(B,H,N,V,Z,da)=>{B[N]=Z;B[N+1]=da;B[N+2]=H[V+3]},E=(B,H,N,V,Z,da)=>{B[N]=Z;B[N+1]=da;B[N+2]=H[V+2];B[N+3]=H[V+3]},W=[],aa=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};e.convertFromFeature=function(B,H,N,V,Z){W[0]=B;[B]=fa(aa,W,H,N,V,Z);Ea(W);Ea(aa);return B};e.convertFromFeatureSet=function(B,H){const N=new h,{hasM:V,hasZ:Z,features:da,objectIdFieldName:ea,spatialReference:la,geometryType:ma,exceededTransferLimit:ua,transform:qa,
fields:ra}=B;ra&&(N.fields=ra);N.geometryType=ma??null;N.objectIdFieldName=ea??H??null;N.spatialReference=la??null;if(!N.objectIdFieldName)return Ja().error(new k("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),N;da&&fa(N.features,da,ma,Z,V,N.objectIdFieldName);ua&&(N.exceededTransferLimit=ua);V&&(N.hasM=V);Z&&(N.hasZ=Z);qa&&(N.transform=qa);return N};e.convertFromFeatures=fa;e.convertFromGeometry=function(B,H,N){if(null==B)return null;const V=new w;"hasZ"in B&&null==
H&&(H=B.hasZ);"hasM"in B&&null==N&&(N=B.hasM);if(a.isPoint(B))return S(null!=H?H:null!=B.z,null!=N?N:null!=B.m)(V,B);if(a.isPolygon(B))return X(V,B,H,N);if(a.isPolyline(B))return z(V,B,x(H,N));if(a.isMultipoint(B))return g(V,B,x(H,N));Ja().error("convertFromGeometry:unknown-geometry",new k(`Unable to parse unknown geometry type '${B}'`))};e.convertFromMultipoint=g;e.convertFromMultipointFeatures=Q;e.convertFromNestedArray=ba;e.convertFromPoint=U;e.convertFromPointFeatures=ca;e.convertFromPolygon=
X;e.convertFromPolyline=z;e.convertFromPolylineFeatures=l;e.convertToFeature=function(B,H,N,V){aa[0]=B;oa(W,aa,H,N,V);B=W[0];Ea(W);Ea(aa);return B};e.convertToFeatureSet=function(B){const {objectIdFieldName:H,spatialReference:N,transform:V,fields:Z,hasM:da,hasZ:ea,features:la,geometryType:ma,exceededTransferLimit:ua,uniqueIdField:qa,queryGeometry:ra,queryGeometryType:Ba}=B;B=oa([],la,ma,ea,da);const ya=na(ra,Ba,!1,!1);B={features:B,fields:Z,geometryType:ma,objectIdFieldName:H,spatialReference:N,uniqueIdField:qa,
queryGeometry:ya};V&&(B.transform=V);ua&&(B.exceededTransferLimit=ua);da&&(B.hasM=da);ea&&(B.hasZ=ea);return B};e.convertToFeatures=oa;e.convertToGeometry=na;e.convertToMultipoint=v;e.convertToMultipointFeatures=T;e.convertToPoint=function(B,H,N){return B?H?N?G(B):b(B):N?L(B):K(B):null};e.convertToPolygon=O;e.convertToPolyline=f;e.generalizeOptimizedGeometry=function(B,H,N,V,Z,da,ea=N,la=V){Da(B);if(!H?.coords.length)return null;Z=Sa[Z];const {coords:ma,lengths:ua}=H;H=x(N,V);const qa=x(N&&ea,V&&
la);N=I(N,V,ea,la);if(!ua.length)return N(B.coords,ma,0,0,ma[0],ma[1]),Da(B,H,0),B;V=0;da*=da;for(const ra of ua){if(ra<Z){V+=ra*H;continue}ea=B.coords.length/qa;la=V;const Ba=V+(ra-1)*H;N(B.coords,ma,B.coords.length,la,ma[la],ma[la+1]);sa(B.coords,ma,H,da,N,la,Ba);N(B.coords,ma,B.coords.length,Ba,ma[Ba],ma[Ba+1]);la=B.coords.length/qa-ea;la>=Z?B.lengths.push(la):Ea(B.coords,ea*qa);V+=ra*H}return B.coords.length?B:null};e.getBoundsOptimizedGeometry=function(B,H,N,V){if(!H?.coords?.length)return null;
N=x(N,V);let Z=V=Number.POSITIVE_INFINITY,da=Number.NEGATIVE_INFINITY,ea=Number.NEGATIVE_INFINITY;if(H&&H.coords){H=H.coords;for(let la=0;la<H.length;la+=N){const ma=H[la],ua=H[la+1];V=Math.min(V,ma);da=Math.max(da,ma);Z=Math.min(Z,ua);ea=Math.max(ea,ua)}}r.is(B)?r.fromRectValues(B,V,Z,da,ea):M.fromValues(V,Z,da,ea,B);return B};e.getQuantizedArea=function(B,H){const {coords:N,lengths:V}=B;let Z=B=0;for(let da=0;da<V.length;da++){const ea=V[da];Z+=xa(N,B,ea,H);B+=ea}return Math.abs(Z)};e.getQuantizedBoundsOptimizedGeometry=
function(B,H,N,V){N=x(N,V);const {lengths:Z,coords:da}=H;V=H=Number.POSITIVE_INFINITY;let ea=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,ma=0;for(const ua of Z){let qa=da[ma],ra=da[ma+1];H=Math.min(qa,H);V=Math.min(ra,V);ea=Math.max(qa,ea);la=Math.max(ra,la);ma+=N;for(let Ba=1;Ba<ua;Ba++,ma+=N){const ya=da[ma],Aa=da[ma+1];qa+=ya;ra+=Aa;0>ya&&(H=Math.min(H,qa));0<ya&&(ea=Math.max(ea,qa));0>Aa?V=Math.min(V,ra):0<Aa&&(la=Math.max(la,ra))}}B[0]=H;B[1]=V;B[2]=ea;B[3]=la;return B};e.getSignedQuantizedRingArea=
xa;e.quantizeOptimizedFeatureSet=function(B,H){const {geometryType:N,features:V,hasM:Z,hasZ:da}=H;if(!B)return H;for(let ea=0;ea<V.length;ea++){const la=V[ea],ma=la.weakClone();ma.geometry=new w;pa(ma.geometry,la.geometry,Z,da,N,B);la.centroid&&(ma.centroid=new w,pa(ma.centroid,la.centroid,Z,da,"esriGeometryPoint",B));V[ea]=ma}H.transform=B;return H};e.quantizeOptimizedGeometry=pa;e.quantizeX=F;e.quantizeY=t;e.removeCollinearVertices=function(B,H,N,V,Z){if(!H?.coords?.length)return null;N=Sa[N];const {coords:da,
lengths:ea}=H;H=I(V,Z,V,Z);V=x(V,Z);let la=Z=0,ma=0,ua=0;for(const Ba of ea){la=ua;H(B.coords,da,la,Z,da[Z],da[Z+1]);Z+=V;var qa=da[Z];let ya=da[Z+1],Aa=qa,Ca=ya;var ra=ya/qa;la+=V;H(B.coords,da,la,Z,Aa,Ca);Z+=V;for(let za=2;za<Ba;za++){qa=da[Z];ya=da[Z+1];const Fa=ya/qa,Ra=ra===Fa||!isFinite(ra)&&!isFinite(Fa);ra=Ra&&isFinite(Fa)?0<=ra&&0<=Fa||0>=ra&&0>=Fa:0<=Ca&&0<=ya||0>=Ca&&0>=ya;Ra&&ra?(Aa+=qa,Ca+=ya):(Aa=qa,Ca=ya,la+=V);H(B.coords,da,la,Z,Aa,Ca);Z+=V;ra=Fa}la+=V;qa=(la-ua)/V;qa>=N&&(B.lengths[ma]=
qa,ua=la,ma++)}B.coords.length>ua&&(B.coords.length=ua);B.lengths.length>ma&&(B.lengths.length=ma);return B.coords.length&&B.lengths.length?B:null};e.removeZMValues=function(B,H,N,V,Z,da){Da(B);B.lengths.push(...H.lengths);if(N===Z&&V===da)for(var ea=0;ea<H.coords.length;ea++)B.coords.push(H.coords[ea]);else for(ea=x(N,V),N=I(N,V,Z,da),H=H.coords,V=0;V<H.length;V+=ea)N(B.coords,H,B.coords.length,V,H[V],H[V+1]);return B};e.unquantizeOptimizedFeatureSet=function(B){const {transform:H,features:N,hasM:V,
hasZ:Z}=B;if(!H)return B;for(const da of N)null!=da.geometry&&wa(da.geometry,da.geometry,V,Z,H),null!=da.centroid&&wa(da.centroid,da.centroid,V,Z,H);B.transform=null;return B};e.unquantizeOptimizedGeometry=wa;e.unquantizeValue=J;e.unquantizeX=function(B,H){return J(B,H,0)};e.unquantizeY=function(B,H){return J(B,-H,1)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect","./DoubleArray"],function(e,
k,y,C){function r(b=K){return[b[0],b[1],b[2],b[3],b[4],b[5]]}function M(b,q,L,d,G,P,S=r()){S[0]=b;S[1]=q;S[2]=L;S[3]=d;S[4]=G;S[5]=P;return S}function a(b,q,L,d=r()){F(d,J);p(d,b,q,L);return d}function p(b,q,L=0,d=q.length/3){let G=b[0],P=b[1],S=b[2],ca=b[3],U=b[4],T=b[5];for(let v=0;v<d;v++)G=Math.min(G,q[L+3*v]),P=Math.min(P,q[L+3*v+1]),S=Math.min(S,q[L+3*v+2]),ca=Math.max(ca,q[L+3*v]),U=Math.max(U,q[L+3*v+1]),T=Math.max(T,q[L+3*v+2]);b[0]=G;b[1]=P;b[2]=S;b[3]=ca;b[4]=U;b[5]=T}function h(b){return b[0]>=
b[3]?0:b[3]-b[0]}function w(b){return b[1]>=b[4]?0:b[4]-b[1]}function x(b){return b[2]>=b[5]?0:b[5]-b[2]}function I(b,q){return Math.max(q[0],b[0])<=Math.min(q[3],b[3])&&Math.max(q[1],b[1])<=Math.min(q[4],b[4])&&Math.max(q[2],b[2])<=Math.min(q[5],b[5])}function F(b,q){b[0]=q[0];b[1]=q[1];b[2]=q[2];b[3]=q[3];b[4]=q[4];b[5]=q[5];return b}function t(b){return 6===b.length}const J=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],K=[0,0,0,0,0,0],u=r();e.allFinite=function(b){for(let q=0;6>q;q++)if(!isFinite(b[q]))return!1;
return!0};e.center=function(b,q=[0,0,0]){q[0]=b[0]+h(b)/2;q[1]=b[1]+w(b)/2;q[2]=b[2]+x(b)/2;return q};e.contains=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[3]<=b[3]&&q[4]<=b[4]&&q[5]<=b[5]};e.containsPoint=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[0]<=b[3]&&q[1]<=b[4]&&q[2]<=b[5]};e.containsPointWithMargin=function(b,q,L){return q[0]>=b[0]-L&&q[1]>=b[1]-L&&q[2]>=b[2]-L&&q[0]<=b[3]+L&&q[1]<=b[4]+L&&q[2]<=b[5]+L};e.create=r;e.depth=w;e.diameter=function(b){const q=h(b),
L=x(b);b=w(b);return Math.sqrt(q*q+L*L+b*b)};e.empty=function(b){return b?F(b,J):r(J)};e.equals=function(b,q,L){if(null==b||null==q)return b===q;if(!t(b)||!t(q))return!1;if(L)for(let d=0;d<b.length;d++){if(!L(b[d],q[d]))return!1}else for(L=0;L<b.length;L++)if(b[L]!==q[L])return!1;return!0};e.expandWithAABB=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],q[3]);b[4]=Math.max(b[4],q[4]);b[5]=Math.max(b[5],q[5])};e.expandWithBuffer=p;e.expandWithNestedArray=
function(b,q,L){const d=q.length;let G=b[0],P=b[1],S=b[2],ca=b[3],U=b[4],T=b[5];if(L)for(L=0;L<d;L++){var v=q[L];G=Math.min(G,v[0]);P=Math.min(P,v[1]);S=Math.min(S,v[2]);ca=Math.max(ca,v[0]);U=Math.max(U,v[1]);T=Math.max(T,v[2])}else for(L=0;L<d;L++)v=q[L],G=Math.min(G,v[0]),P=Math.min(P,v[1]),ca=Math.max(ca,v[0]),U=Math.max(U,v[1]);b[0]=G;b[1]=P;b[2]=S;b[3]=ca;b[4]=U;b[5]=T};e.expandWithOffset=function(b,q,L,d){b[0]=Math.min(b[0],b[0]+q);b[3]=Math.max(b[3],b[3]+q);b[1]=Math.min(b[1],b[1]+L);b[4]=
Math.max(b[4],b[4]+L);b[2]=Math.min(b[2],b[2]+d);b[5]=Math.max(b[5],b[5]+d)};e.expandWithRect=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[3]=Math.max(b[3],q[2]);b[4]=Math.max(b[4],q[3])};e.expandWithVec3=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],q[0]);b[4]=Math.max(b[4],q[1]);b[5]=Math.max(b[5],q[2])};e.fromBuffer=function(b,q=r()){return a(b,0,b.length/3,q)};e.fromExtent=function(b,q=r()){q[0]=b.xmin;q[1]=b.ymin;
q[2]=b.hasZ?b.zmin:-Infinity;q[3]=b.xmax;q[4]=b.ymax;q[5]=b.hasZ?b.zmax:Infinity;return q};e.fromMinMax=function(b,q,L=r()){L[0]=b[0];L[1]=b[1];L[2]=b[2];L[3]=q[0];L[4]=q[1];L[5]=q[2];return L};e.fromRect=function(b,q){b[0]=q[0];b[1]=q[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=q[2];b[4]=q[3];b[5]=Number.POSITIVE_INFINITY;return b};e.fromRectValues=function(b,q,L,d,G){b[0]=q;b[1]=L;b[2]=Number.NEGATIVE_INFINITY;b[3]=d;b[4]=G;b[5]=Number.POSITIVE_INFINITY;return b};e.fromSubBuffer=a;e.fromValues=M;e.getMax=
function(b,q){q[0]=b[3];q[1]=b[4];q[2]=b[5];return q};e.getMin=function(b,q){q[0]=b[0];q[1]=b[1];q[2]=b[2];return q};e.height=x;e.intersects=I;e.intersectsClippingArea=function(b,q){return null==q?!0:I(b,q)};e.is=t;e.isPoint=function(b){return 0===h(b)&&0===w(b)&&0===x(b)};e.maximumDimension=function(b){return Math.max(h(b),x(b),w(b))};e.negativeInfinity=J;e.offset=function(b,q,L,d,G=b){G[0]=b[0]+q;G[1]=b[1]+L;G[2]=b[2]+d;G[3]=b[3]+q;G[4]=b[4]+L;G[5]=b[5]+d;return G};e.positiveInfinity=[-Infinity,
-Infinity,-Infinity,Infinity,Infinity,Infinity];e.scale=function(b,q,L=b){const d=b[0]+h(b)/2,G=b[1]+w(b)/2,P=b[2]+x(b)/2;L[0]=d+(b[0]-d)*q;L[1]=G+(b[1]-G)*q;L[2]=P+(b[2]-P)*q;L[3]=d+(b[3]-d)*q;L[4]=G+(b[4]-G)*q;L[5]=P+(b[5]-P)*q;return L};e.set=F;e.setMax=function(b,q,L=b){L[3]=q[0];L[4]=q[1];L[5]=q[2];L!==b&&(L[0]=b[0],L[1]=b[1],L[2]=b[2]);return b};e.setMin=function(b,q,L=b){L[0]=q[0];L[1]=q[1];L[2]=q[2];L!==b&&(L[3]=b[3],L[4]=b[4],L[5]=b[5]);return L};e.size=function(b,q=[0,0,0]){q[0]=h(b);q[1]=
w(b);q[2]=x(b);return q};e.toCorners=function(b,q=C.newDoubleArray(24)){const [L,d,G,P,S,ca]=b;q[0]=L;q[1]=d;q[2]=G;q[3]=L;q[4]=d;q[5]=ca;q[6]=L;q[7]=S;q[8]=G;q[9]=L;q[10]=S;q[11]=ca;q[12]=P;q[13]=d;q[14]=G;q[15]=P;q[16]=d;q[17]=ca;q[18]=P;q[19]=S;q[20]=G;q[21]=P;q[22]=S;q[23]=ca;return q};e.toExtent=function(b,q){return isFinite(b[2])||isFinite(b[5])?new k({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:q}):new k({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:q})};
e.toRect=function(b,q){q||=y.create();q[0]=b[0];q[1]=b[1];q[2]=b[3];q[3]=b[4];return q};e.width=h;e.wrap=function(b,q,L,d,G,P){return M(b,q,L,d,G,P,u)};e.zero=K;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/DoubleArray":function(){define(["exports","../../core/typedArrayUtil"],function(e,k){e.copyInto=function(y,C){for(let r=0;r<C.length;++r)y[r]=C[r];return y};e.doubleArrayFrom=function(y){return(k.isArray(y)?y.length:y.byteLength/8)<=k.nativeArrayMaxSize?
Array.from(y):new Float64Array(y)};e.doubleSubArray=function(y,C,r){return Array.isArray(y)?y.slice(C,C+r):y.subarray(C,C+r)};e.newDoubleArray=function(y,C=!1){return y<=k.nativeArrayMaxSize?C?Array(y).fill(0):Array(y):new Float64Array(y)};e.toFloat64Array=function(y){return Array.isArray(y)?new Float64Array(y):y};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(e,k){class y{constructor(r=
null,M={},a,p){this.geometry=r;this.attributes=M;this.centroid=a;this.objectId=p;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(r,M){const a=r.geometry?k.fromJSON(r.geometry):null,p=r.centroid?k.fromJSON(r.centroid):null;return new y(a,r.attributes,p,r.attributes[M])}weakClone(){const r=new y(this.geometry,this.attributes,this.centroid,this.objectId);r.displayId=this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}clone(){var r=this.geometry?.clone();r=new y(r,{...this.attributes},
this.centroid?.clone(),this.objectId);r.displayId=this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}}class C extends y{}e.OptimizedFeature=y;e.OptimizedFeatureWithGeometry=C;e.hasGeometry=function(r){return!!r.geometry?.coords?.length};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class e{constructor(k=[],y=[]){this.lengths=k??[];this.coords=y??[]}static fromJSON(k){return new e(k.lengths,
k.coords)}static fromRect(k){const [y,C,r,M]=k;k=r-y;const a=M-C;return new e([5],[y,C,k,0,0,a,-k,0,0,-a])}get isPoint(){return 0===this.lengths.length&&2<=this.coords.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((k,y)=>k+y)}forEachVertex(k){let y=0;this.lengths.length||k(this.coords[0],this.coords[1]);for(let C=0;C<this.lengths.length;C++){const r=this.lengths[C];for(let M=0;M<r;M++)k(this.coords[2*(M+y)],this.coords[2*(M+y)+1]);y+=r}}deltaDecode(){const k=
this.clone(),{coords:y,lengths:C}=k;let r=0;for(const M of C){for(let a=1;a<M;a++)y[2*(r+a)]+=y[2*(r+a)-2],y[2*(r+a)+1]+=y[2*(r+a)-1];r+=M}return k}clone(k){if(0===this.lengths.length)return new e([],[this.coords[0],this.coords[1]]);var y=2*(0===this.lengths.length?1:this.lengths.reduce((C,r)=>C+r));y=this.coords.slice(0,y);return k?(k.set(y),new e(this.lengths,k)):new e(Array.from(this.lengths),Array.from(y))}}return e})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class e{constructor(){this.spatialReference=
this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const k=new e;k.objectIdFieldName=this.objectIdFieldName;k.globalIdFieldName=this.globalIdFieldName;k.geohashFieldName=this.geohashFieldName;k.geometryProperties=this.geometryProperties;k.geometryType=this.geometryType;
k.spatialReference=this.spatialReference;k.hasZ=this.hasZ;k.hasM=this.hasM;k.features=this.features;k.fields=this.fields;k.transform=this.transform;k.exceededTransferLimit=this.exceededTransferLimit;k.uniqueIdField=this.uniqueIdField;k.queryGeometry=this.queryGeometry;k.queryGeometryType=this.queryGeometryType;return k}}return e})},"esri/layers/graphics/objectIdUtils":function(){define(["exports"],function(e){e.findLastObjectIdFromFeatures=function(k,y){let C=0;for(const r of y)y=r.attributes?.[k],
"number"===typeof y&&isFinite(y)&&(C=Math.max(C,y));return C};e.initialObjectId=1;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),function(e,k,y,C,r,M,
a,p,h,w){const x=r.create();class I{constructor(F){this.geometryInfo=F;this._boundsStore=new p.BoundsStore;this._featuresById=new Map;this.events=new y;this.featureAdapter=w.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let F=0;this._featuresById.forEach(t=>
{null!=t.geometry&&t.geometry.coords&&(F+=t.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:F/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(F){if(null==this.fullBounds)return null;const [t,J,K,u]=this.fullBounds;return{xmin:t,ymin:J,xmax:K,ymax:u,spatialReference:h.cleanFromGeometryEngine(F)}}add(F){this._add(F);this._emitChanged()}addMany(F){for(const t of F)this._add(t);this._emitChanged()}upsertMany(F){F=F.map(t=>this._upsert(t));this._emitChanged();return F.filter(e.isSome)}clear(){this._featuresById.clear();
this._boundsStore.clear();this._emitChanged()}removeById(F){F=this._featuresById.get(F);if(!F)return null;this._remove(F);this._emitChanged();return F}removeManyById(F){this._boundsStore.invalidateIndex();for(const t of F)(F=this._featuresById.get(t))&&this._remove(F);this._emitChanged()}forEachBounds(F,t){for(const J of F)(F=this._boundsStore.get(J.objectId))&&t(r.fromRect(x,F))}getFeature(F){return this._featuresById.get(F)}has(F){return this._featuresById.has(F)}forEach(F){this._featuresById.forEach(t=>
F(t))}forEachInBounds(F,t){this._boundsStore.forEachInBounds(F,J=>{t(this._featuresById.get(J))})}_emitChanged(){this.events.emit("changed",void 0)}_add(F){if(F){var t=F.objectId;if(null==t)C.getLogger("esri.layers.graphics.data.FeatureStore").error(new k("featurestore:invalid-feature","feature id is missing",{feature:F}));else{var J=this._featuresById.get(t);if(J){F.displayId=J.displayId;var K=this._boundsStore.get(t);this._boundsStore.delete(t)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(F);
F.geometry?.coords?.length?(K=a.getBoundsOptimizedGeometry(null!=K?K:M.create(),F.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=K&&this._boundsStore.set(t,K)):this._boundsStore.set(t,null);this._featuresById.set(t,F)}}}_upsert(F){const t=F?.objectId;if(null==t)return C.getLogger("esri.layers.graphics.data.FeatureStore").error(new k("featurestore:invalid-feature","feature id is missing",{feature:F})),null;const J=this._featuresById.get(t);if(!J)return this._add(F),F;const {geometry:K,
attributes:u}=F;for(const b in u)J.attributes[b]=u[b];K&&(J.geometry=K,this._boundsStore.set(t,a.getBoundsOptimizedGeometry(M.create(),K,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return J}_remove(F){if(null!=this.onFeatureRemove)this.onFeatureRemove(F);const t=F.objectId;this._boundsStore.delete(t);this._featuresById.delete(t);return F}}return I})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],
function(e,k,y,C){function r(p,h,w){M.minX=h[0];M.minY=h[1];M.maxX=h[2];M.maxY=h[3];p.search(M,w)}const M={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new y.PooledRBush(9,k("esri-csp-restrictions")?p=>({minX:p[0],minY:p[1],maxX:p[2],maxY:p[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const p=Array(this._idByBounds.size);let h=0;this._idByBounds.forEach((w,
x)=>{p[h++]=x});this._indexInvalid=!1;this._index.clear();this._index.load(p)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(p=>this._idByBounds.has(p))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const p=C.empty();for(const h of this._boundsById.values())h&&(p[0]=Math.min(h[0],p[0]),p[1]=Math.min(h[1],p[1]),p[2]=Math.max(h[2],p[2]),p[3]=Math.max(h[3],p[3]));return p}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(p){const h=this._boundsById.get(p);this._boundsById.delete(p);h&&(this._idByBounds.delete(h),this._indexInvalid||this._index.remove(h))}forEachInBounds(p,h){this._loadIndex();r(this._index,p,w=>h(this._idByBounds.get(w)))}get(p){return this._boundsById.get(p)}has(p){return this._boundsById.has(p)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(p,
h){if(!this._indexInvalid){const w=this._boundsById.get(p);w&&(this._index.remove(w),this._idByBounds.delete(w))}this._boundsById.set(p,h);h&&(this._idByBounds.set(h,p),this._indexInvalid||(this._boundsToLoad.push(h),5E4<this._boundsToLoad.length&&this._loadIndex()))}}e.BoundsStore=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has","../../PooledArray","../../../chunks/quickselect"],function(e,
k,y,C,r){function M(U,T){for(q.clear();U;){if(!0===U.leaf)for(const v of U.children)T(v);else q.pushArray(U.children);U=q.pop()??null}}function a(U,T){p(U,0,U.children.length,T,U)}function p(U,T,v,Q,g){g||=new S([]);g.minX=Infinity;g.minY=Infinity;g.maxX=-Infinity;g.maxY=-Infinity;for(let f=T,l;f<v;f++)l=U.children[f],h(g,U.leaf?Q(l):l);return g}function h(U,T){U.minX=Math.min(U.minX,T.minX);U.minY=Math.min(U.minY,T.minY);U.maxX=Math.max(U.maxX,T.maxX);U.maxY=Math.max(U.maxY,T.maxY)}function w(U,
T){return U.minX-T.minX}function x(U,T){return U.minY-T.minY}function I(U){return(U.maxX-U.minX)*(U.maxY-U.minY)}function F(U){return U.maxX-U.minX+(U.maxY-U.minY)}function t(U,T){return U.minX<=T.minX&&U.minY<=T.minY&&T.maxX<=U.maxX&&T.maxY<=U.maxY}function J(U,T){return T.minX<=U.maxX&&T.minY<=U.maxY&&T.maxX>=U.minX&&T.maxY>=U.minY}function K(U,T,v,Q,g){for(T=[T,v];T.length;){v=T.pop();const f=T.pop();if(v-f<=Q)continue;const l=f+Math.ceil((v-f)/Q/2)*Q;r.quickselect(U,l,f,v,g);T.push(f,l,l,v)}}
class u{constructor(U=9,T){this._compareMinX=w;this._compareMinY=x;this._toBBox=v=>v;this._maxEntries=Math.max(4,U||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));T&&("function"===typeof T?this._toBBox=T:this._initFormat(T));this.clear()}destroy(){this.clear();b.prune();q.prune();L.prune();d.prune()}all(U){M(this._data,U)}search(U,T){let v=this._data;const Q=this._toBBox;if(J(U,v))for(b.clear();v;){for(let g=0,f=v.children.length;g<f;g++){const l=v.children[g],z=v.leaf?Q(l):l;J(U,
z)&&(v.leaf?T(l):t(U,z)?M(l,T):b.push(l))}v=b.pop()}}collides(U){let T=this._data;const v=this._toBBox;if(!J(U,T))return!1;for(b.clear();T;){for(let Q=0,g=T.children.length;Q<g;Q++){const f=T.children[Q],l=T.leaf?v(f):f;if(J(U,l)){if(T.leaf||t(U,l))return!0;b.push(f)}}T=b.pop()}return!1}load(U){if(!U.length)return this;if(U.length<this._minEntries){for(let T=0,v=U.length;T<v;T++)this.insert(U[T]);return this}U=this._build(U.slice(),0,U.length-1,0);if(this._data.children.length)if(this._data.height===
U.height)this._splitRoot(this._data,U);else{if(this._data.height<U.height){const T=this._data;this._data=U;U=T}this._insert(U,this._data.height-U.height-1,!0)}else this._data=U;return this}insert(U){U&&this._insert(U,this._data.height-1);return this}clear(){this._data=new S([]);return this}remove(U){if(!U)return this;let T=this._data,v=null,Q=0,g=!1,f;const l=this._toBBox(U);L.clear();for(d.clear();T||0<L.length;){T||(T=L.pop(),v=L.data[L.length-1],Q=d.pop()??0,g=!0);if(T.leaf&&(f=k.indexOf(T.children,
U,T.children.length,T.indexHint),-1!==f)){T.children.splice(f,1);L.push(T);this._condense(L);break}g||T.leaf||!t(T,l)?v?(Q++,T=v.children[Q],g=!1):T=null:(L.push(T),d.push(Q),Q=0,v=T,T=T.children[0])}return this}toJSON(){return this._data}fromJSON(U){this._data=U;return this}_build(U,T,v,Q){var g=v-T+1,f=this._maxEntries;if(g<=f)return U=new S(U.slice(T,v+1)),a(U,this._toBBox),U;Q||(Q=Math.ceil(Math.log(g)/Math.log(f)),f=Math.ceil(g/f**(Q-1)));const l=new ca([]);l.height=Q;g=Math.ceil(g/f);f=g*Math.ceil(Math.sqrt(f));
for(K(U,T,v,f,this._compareMinX);T<=v;T+=f){const z=Math.min(T+f-1,v);K(U,T,z,g,this._compareMinY);for(let O=T;O<=z;O+=g)l.children.push(this._build(U,O,Math.min(O+g-1,z),Q-1))}a(l,this._toBBox);return l}_insert(U,T,v){var Q=this._toBBox;v=v?U:Q(U);L.clear();Q=this._data;for(var g=T,f=L;;){f.push(Q);if(!0===Q.leaf||f.length-1===g)break;let l=Infinity,z=Infinity,O=void 0;for(let X=0,ba=Q.children.length;X<ba;X++){const fa=Q.children[X],na=I(fa),oa=(Math.max(fa.maxX,v.maxX)-Math.min(fa.minX,v.minX))*
(Math.max(fa.maxY,v.maxY)-Math.min(fa.minY,v.minY))-na;oa<z?(z=oa,l=na<l?na:l,O=fa):oa===z&&na<l&&(l=na,O=fa)}Q=O||Q.children[0]}Q.children.push(U);for(h(Q,v);0<=T;)if(L.data[T].children.length>this._maxEntries)this._split(L,T),T--;else break;for(U=L;0<=T;T--)h(U.data[T],v)}_split(U,T){const v=U.data[T];var Q=v.children.length;const g=this._minEntries;this._chooseSplitAxis(v,g,Q);if(Q=this._chooseSplitIndex(v,g,Q))Q=v.children.splice(Q,v.children.length-Q),Q=v.leaf?new S(Q):new ca(Q),Q.height=v.height,
a(v,this._toBBox),a(Q,this._toBBox),T?U.data[T-1].children.push(Q):this._splitRoot(v,Q)}_splitRoot(U,T){this._data=new ca([U,T]);this._data.height=U.height+1;a(this._data,this._toBBox)}_chooseSplitIndex(U,T,v){let Q,g,f=void 0;Q=g=Infinity;for(let z=T;z<=v-T;z++){var l=p(U,0,z,this._toBBox);const O=p(U,z,v,this._toBBox),X=Math.max(0,Math.min(l.maxX,O.maxX)-Math.max(l.minX,O.minX))*Math.max(0,Math.min(l.maxY,O.maxY)-Math.max(l.minY,O.minY));l=I(l)+I(O);X<Q?(Q=X,f=z,g=l<g?l:g):X===Q&&l<g&&(g=l,f=z)}return f}_chooseSplitAxis(U,
T,v){const Q=U.leaf?this._compareMinX:w,g=U.leaf?this._compareMinY:x,f=this._allDistMargin(U,T,v,Q);T=this._allDistMargin(U,T,v,g);f<T&&U.children.sort(Q)}_allDistMargin(U,T,v,Q){U.children.sort(Q);Q=this._toBBox;var g=p(U,0,T,Q);const f=p(U,v-T,v,Q);let l=F(g)+F(f);for(let z=T;z<v-T;z++){const O=U.children[z];h(g,U.leaf?Q(O):O);l+=F(g)}for(v=v-T-1;v>=T;v--)g=U.children[v],h(f,U.leaf?Q(g):g),l+=F(f);return l}_condense(U){for(let T=U.length-1;0<=T;T--){const v=U.data[T];if(0===v.children.length)if(0<
T){const Q=U.data[T-1],g=Q.children;g.splice(k.indexOf(g,v,g.length,Q.indexHint),1)}else this.clear();else a(v,this._toBBox)}}_initFormat(U){const T=["return a"," - b",";"];this._compareMinX=new Function("a","b",T.join(U[0]));this._compareMinY=new Function("a","b",T.join(U[1]));this._toBBox=new Function("a","return {minX: a"+U[0]+", minY: a"+U[1]+", maxX: a"+U[2]+", maxY: a"+U[3]+"};")}}const b=new C,q=new C,L=new C,d=new C({deallocator:void 0});class G{constructor(){this.minY=this.minX=Infinity;
this.maxY=this.maxX=-Infinity}}class P extends G{constructor(){super(...arguments);this.height=1;this.indexHint=new k.PositionHint}}class S extends P{constructor(U){super();this.children=U;this.leaf=!0}}class ca extends P{constructor(U){super();this.children=U;this.leaf=!1}}e.BBox=G;e.PooledRBush=u;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports"],function(e){function k(r,M,a,p,h){for(;p>a;){if(600<p-a){var w=p-a+1,x=M-a+1,I=Math.log(w),
F=.5*Math.exp(2*I/3);I=.5*Math.sqrt(I*F*(w-F)/w)*(0>x-w/2?-1:1);k(r,M,Math.max(a,Math.floor(M-x*F/w+I)),Math.min(p,Math.floor(M+(w-x)*F/w+I)),h)}w=r[M];x=a;F=p;y(r,a,M);for(0<h(r[p],w)&&y(r,a,p);x<F;){y(r,x,F);x++;for(F--;0>h(r[x],w);)x++;for(;0<h(r[F],w);)F--}0===h(r[a],w)?y(r,a,F):(F++,y(r,F,p));F<=M&&(a=F+1);M<=F&&(p=F-1)}}function y(r,M,a){var p=r[M];r[M]=r[a];r[a]=p}function C(r,M){return r<M?-1:r>M?1:0}e.quickselect=function(r,M,a,p,h){k(r,M,a||0,p||r.length-1,h||C)}})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports",
"../featureConversionUtils","../OptimizedGeometry"],function(e,k,y){const C=new y,r=new y,M=new y,a={esriGeometryPoint:k.convertToPoint,esriGeometryPolyline:k.convertToPolyline,esriGeometryPolygon:k.convertToPolygon,esriGeometryMultipoint:k.convertToMultipoint},p=(h,w)=>"_geVersion"!==h?w:void 0;e.cleanFromGeometryEngine=function(h){return h&&"_geVersion"in h?JSON.parse(JSON.stringify(h,p)):h};e.getGeometry=function(h,w,x,I,F,t,J=w,K=x){const u=w&&J,b=x&&K;I=null!=I?"coords"in I?I:I.geometry:null;
if(null==I)return null;if(F)return w=k.generalizeOptimizedGeometry(r,I,w,x,h,F,J,K),t&&(w=k.quantizeOptimizedGeometry(M,w,u,b,h,t)),a[h]?.(w,u,b)??null;if(t)return t=k.quantizeOptimizedGeometry(M,I,w,x,h,t,J,K),a[h]?.(t,u,b)??null;k.removeZMValues(C,I,w,x,J,K);return a[h]?.(C,u,b)??null};e.transformCentroid=function(h,w,x,I=h.hasZ,F=h.hasM){if(null==w)return null;const t=h.hasZ&&I,J=h.hasM&&F;return x?(h=k.quantizeOptimizedGeometry(M,w,h.hasZ,h.hasM,"esriGeometryPoint",x,I,F),k.convertToPoint(h,t,
J)):k.convertToPoint(w,t,J)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(e,k,y,C){e.optimizedFeatureQueryEngineAdapter={getObjectId(r){return r.objectId},getAttributes(r){return r.attributes},getAttribute(r,M){return r.attributes[M]},cloneWithGeometry(r,M){return new y.OptimizedFeature(M,r.attributes,null,r.objectId)},
getGeometry(r){return r.geometry},getCentroid(r,M){null==r.centroid&&(r.centroid=k.getCentroidOptimizedGeometry(new C,r.geometry,M.hasZ,M.hasM));return r.centroid}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(e){function k(C,r,M,a,p,h){h=p?h?4:3:h?3:2;let w=M,x=M+h,I=0,F=0,t=M=0,J=0;for(let K=0,u=a-1;K<u;K++,w+=h,x+=h){a=r[w];const b=r[w+1],q=r[w+2],L=r[x],d=r[x+1],G=r[x+2];let P=a*d-L*b;t+=P;I+=(a+L)*P;F+=
(b+d)*P;p&&(P=a*G-L*q,M+=(q+G)*P,J+=P);a<C[0]&&(C[0]=a);a>C[1]&&(C[1]=a);b<C[2]&&(C[2]=b);b>C[3]&&(C[3]=b);p&&(q<C[4]&&(C[4]=q),q>C[5]&&(C[5]=q))}0<t&&(t*=-1);0<J&&(J*=-1);if(!t)return null;C=[I,F,.5*t];p&&(C[3]=M,C[4]=.5*J);return C}function y(C,r,M,a,p){p=a?p?4:3:p?3:2;let h=r,w=r+p,x=0,I=0,F=0,t=0;for(let b=0,q=M-1;b<q;b++,h+=p,w+=p){var J=C[h];const L=C[h+1],d=C[h+2],G=C[w],P=C[w+1],S=C[w+2];if(a){var K=G-J;var u=P-L;const ca=S-d;K=Math.sqrt(K*K+u*u+ca*ca)}else K=G-J,u=P-L,K=Math.sqrt(K*K+u*u);
K&&(x+=K,a?(J=[J+.5*(G-J),L+.5*(P-L),d+.5*(S-d)],I+=K*J[0],F+=K*J[1],t+=K*J[2]):(J=[J+.5*(G-J),L+.5*(P-L)],I+=K*J[0],F+=K*J[1]))}return 0<x?a?[I/x,F/x,t/x]:[I/x,F/x]:0<M?a?[C[r],C[r+1],C[r+2]]:[C[r],C[r+1]]:null}e.getCentroidOptimizedGeometry=function(C,r,M,a){if(!r?.lengths.length)return null;C.lengths.length&&(C.lengths.length=0);C.coords.length&&(C.coords.length=0);const p=C.coords,h=[],w=M?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:x,coords:I}=r;var F=M?a?4:3:a?3:2;let t=0;for(const J of x){const K=k(w,I,t,J,M,a);K&&h.push(K);t+=J*F}h.sort((J,K)=>{let u=J[2]-K[2];0===u&&M&&(u=J[4]-K[4]);return u});h.length&&(F=6*h[0][2],p[0]=h[0][0]/F,p[1]=h[0][1]/F,M&&(F=6*h[0][4],p[2]=0!==F?h[0][3]/F:0),p[0]<w[0]||p[0]>w[1]||p[1]<w[2]||p[1]>w[3]||M&&(p[2]<w[4]||p[2]>w[5]))&&(p.length=0);if(!p.length)if(r=
r.lengths[0]?y(I,0,x[0],M,a):null)p[0]=r[0],p[1]=r[1],M&&2<r.length&&(p[2]=r[2]);else return null;return C};e.lineCentroid=y;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(e,k,y,
C,r,M,a){function p(K,u){if(!u)return null;if("x"in u){var b={x:0,y:0};[b.x,b.y]=K(u.x,u.y,x);null!=u.z&&(b.z=u.z);null!=u.m&&(b.m=u.m);return b}return"xmin"in u?(b={xmin:0,ymin:0,xmax:0,ymax:0},[b.xmin,b.ymin]=K(u.xmin,u.ymin,x),[b.xmax,b.ymax]=K(u.xmax,u.ymax,x),u.hasZ&&(b.zmin=u.zmin,b.zmax=u.zmax,b.hasZ=!0),u.hasM&&(b.mmin=u.mmin,b.mmax=u.mmax,b.hasM=!0),b):"rings"in u?{rings:h(u.rings,K),hasM:u.hasM,hasZ:u.hasZ}:"paths"in u?{paths:h(u.paths,K),hasM:u.hasM,hasZ:u.hasZ}:"points"in u?{points:w(u.points,
K),hasM:u.hasM,hasZ:u.hasZ}:null}function h(K,u){const b=[];for(const q of K)b.push(w(q,u));return b}function w(K,u){const b=[];for(const q of K)K=u(q[0],q[1],[0,0]),b.push(K),2<q.length&&K.push(q[2]),3<q.length&&K.push(q[3]);return b}const x=[0,0],I=p.bind(null,a.lngLatToXY),F=p.bind(null,a.xyToLngLat);class t{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(K,u,b,q){if(!K?.length||!u||!b||M.equals(u,b))return K;K={geometries:K,inSpatialReference:u,outSpatialReference:b,
geographicTransformation:q,resolve:y.createResolver()};this._jobs.push(K);this._timer??(this._timer=setTimeout(this._process,10));return K.resolve.promise}_process(){this._timer=null;const K=this._jobs.shift();if(K){var {geometries:u,inSpatialReference:b,outSpatialReference:q,resolve:L,geographicTransformation:d}=K;a.canProject(b,q)?M.isWebMercator(q)?L(u.map(I)):L(u.map(F)):L(C.projectMany(r.jsonAdapter,u,b,q,d,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}}}const J=new t;
e.checkProjectionSupport=async function(K,u){K&&u&&(K=Array.isArray(K)?K.map(b=>null!=b.geometry?b.geometry.spatialReference:null).filter(k.isSome):[K],await C.initializeProjection(K.map(b=>({source:b,dest:u}))))};e.project=function(K,u,b,q){if(!K)return K;b||(b=u,u=K.spatialReference);return M.isValid(u)&&M.isValid(b)&&!M.equals(u,b)?a.canProject(u,b)?(K=M.isWebMercator(b)?I(K):F(K),K.spatialReference=b,K):C.projectMany(r.jsonAdapter,[K],u,b,null,q)[0]:K};e.projectMany=function(K,u,b,q){return J.push(K,
u,b,q)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(e){class k{constructor(a,p,h){this.x=a;this.y=p;this.spatialReference=h;this.m=this.z=void 0}}class y{constructor(a,p,h,w){this.rings=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);w&&(this.hasM=w)}}class C{constructor(a,p,h,w){this.paths=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);w&&(this.hasM=w)}}class r{constructor(a,
p,h,w){this.points=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;h&&(this.hasZ=h);w&&(this.hasM=w)}}class M{constructor(a,p,h,w,x){this.xmin=a;this.ymin=p;this.xmax=h;this.ymax=w;this.spatialReference=x;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}e.jsonAdapter={convertToGEGeometry:function(a,p){return null==p?null:a.convertJSONToGeometry(p)},exportPoint:function(a,p,h){h=new k(a.getPointX(p),a.getPointY(p),h);const w=a.hasZ(p),x=a.hasM(p);w&&(h.z=a.getPointZ(p));x&&(h.m=a.getPointM(p));
return h},exportPolygon:function(a,p,h){return new y(a.exportPaths(p),h,a.hasZ(p),a.hasM(p))},exportPolyline:function(a,p,h){return new C(a.exportPaths(p),h,a.hasZ(p),a.hasM(p))},exportMultipoint:function(a,p,h){return new r(a.exportPoints(p),h,a.hasZ(p),a.hasM(p))},exportExtent:function(a,p,h){var w=a.hasZ(p);const x=a.hasM(p);h=new M(a.getXMin(p),a.getYMin(p),a.getXMax(p),a.getYMax(p),h);w&&(w=a.getZExtent(p),h.zmin=w.vmin,h.zmax=w.vmax);x&&(a=a.getMExtent(p),h.mmin=a.vmin,h.mmax=a.vmax);return h}};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCache ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J,K,u,b,q,L,d,G,P,S,ca,U,T,v){function Q(l){if(ca.canQueryWithRBush(l)){if(F.isExtent(l))return[x.fromValues(Math.min(l.xmin,l.xmax),Math.min(l.ymin,l.ymax),Math.max(l.xmin,l.xmax),Math.max(l.ymin,l.ymax))];if(F.isPolygon(l))return l.rings.map(z=>x.fromValues(Math.min(z[0][0],z[2][0]),Math.min(z[0][1],z[2][1]),Math.max(z[0][0],z[2][0]),Math.max(z[0][1],z[2][1])))}return[I.getBoundsXY(x.create(),l)]}class g{constructor(l,z=null,O,X,ba){this.attributes=l;this.geometry=
O;this.centroid=X;this.filterFlags=ba;this.groupId=-1;this.displayId=z}}class f{constructor(l){this._cache=new L.QueryEngineCache;this._changeHandle=null;this.capabilities={query:d.queryCapabilities};this.geometryType=l.geometryType;this.hasM=!!l.hasM;this.hasZ=!!l.hasZ;this.objectIdField=l.objectIdField;this.spatialReference=l.spatialReference;this.definitionExpression=l.definitionExpression;this.featureStore=l.featureStore;this.aggregateAdapter=l.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",
()=>this.clearCache());this.timeInfo=l.timeInfo;this.fieldsIndex=C.isSerializable(l.fieldsIndex)?l.fieldsIndex:T.fromJSON(l.fieldsIndex);this.availableFields=!l.availableFields||1===l.availableFields.length&&"*"===l.availableFields[0]?new Set(this.fieldsIndex.fields.map(z=>z.name)):new Set(l.availableFields.map(z=>this.fieldsIndex.get(z)?.name).filter(z=>null!=z));l.scheduler&&l.priority&&(this._frameTask=l.scheduler.registerTask(l.priority))}destroy(){this._frameTask=M.removeMaybe(this._frameTask);
this.clearCache();M.destroyMaybe(this._cache);this._changeHandle=M.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._cache.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(l,z){z=a.signalFromSignalOrOptions(z);try{return await (await this._executeQuery(l,{},z)).createQueryResponse()}catch(O){if(O!==P.queryEngineEmptyResult)throw O;return(new G.QueryEngineResult([],l,this)).createQueryResponse()}}async executeQueryForCount(l=
{},z){z=a.signalFromSignalOrOptions(z);try{return(await this._executeQuery(l,{returnGeometry:!1,returnCentroid:!1,outSR:null},z)).createQueryResponseForCount()}catch(O){if(O!==P.queryEngineEmptyResult)throw O;return 0}}async executeQueryForExtent(l,z){z=a.signalFromSignalOrOptions(z);const O=l.outSR;try{const X=await this._executeQuery(l,{returnGeometry:!0,returnCentroid:!1,outSR:null},z),ba=X.size;if(!ba)return{count:0,extent:null};const fa=await this._getBounds(X.items,X.spatialReference,O||this.spatialReference);
return{count:ba,extent:fa}}catch(X){if(X===P.queryEngineEmptyResult)return{count:0,extent:null};throw X;}}async executeQueryForIds(l,z){return this.executeQueryForIdSet(l,z).then(O=>Array.from(O))}async executeQueryForIdSet(l,z){z=a.signalFromSignalOrOptions(z);try{const O=await this._executeQuery(l,{returnGeometry:!0,returnCentroid:!1,outSR:null},z),X=O.items,ba=new Set;await this._reschedule(()=>{for(const fa of X)ba.add(O.featureAdapter.getObjectId(fa))},z);return ba}catch(O){if(O===P.queryEngineEmptyResult)return new Set;
throw O;}}async executeQueryForSnapping(l,z){const O=a.signalFromSignalOrOptions(z),{point:X,distance:ba,returnEdge:fa,vertexMode:na}=l;if(!fa&&"none"===na)return{candidates:[]};let oa=r.clone(l.query);oa=await this._schedule(()=>P.normalizeQueryLike(oa,this.definitionExpression,this.spatialReference),O);oa=await this._reschedule(()=>S.validateQuery(oa,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),O);(z=!J.equals(X.spatialReference,
this.spatialReference))&&await q.checkProjectionSupport(X.spatialReference,this.spatialReference);var pa="number"===typeof ba?ba:ba.x,sa="number"===typeof ba?ba:ba.y;pa={xmin:X.x-pa,xmax:X.x+pa,ymin:X.y-sa,ymax:X.y+sa,spatialReference:X.spatialReference};pa=z?q.project(pa,this.spatialReference):pa;if(!pa)return{candidates:[]};sa=(await t.normalizeCentralMeridian(F.fromJSON(X),null,{signal:O}))[0];const wa=(await t.normalizeCentralMeridian(F.fromJSON(pa),null,{signal:O}))[0];if(null==sa||null==wa)return{candidates:[]};
const xa=new G.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(Q(wa.toJSON())),O),oa,this);await this._reschedule(()=>this._executeObjectIdsQuery(xa),O);await this._reschedule(()=>this._executeTimeQuery(xa),O);await this._reschedule(()=>this._executeAttributesQuery(xa),O);await this._reschedule(()=>this._executeGeometryQueryForSnapping(xa,O),O);sa=sa.toJSON();sa=z?q.project(sa,this.spatialReference):sa;return xa.createSnappingResponse({...l,point:sa,distance:z?Math.max(pa.xmax-pa.xmin,
pa.ymax-pa.ymin)/2:ba},X.spatialReference)}async executeQueryForLatestObservations(l,z){z=a.signalFromSignalOrOptions(z);if(!this.timeInfo?.trackIdField)throw new y("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:l,timeInfo:this.timeInfo});try{const O=await this._executeQuery(l,{},z);await this._reschedule(()=>this._filterLatest(O),z);return await O.createQueryResponse()}catch(O){if(O!==P.queryEngineEmptyResult)throw O;return(new G.QueryEngineResult([],l,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(l=
{},z,O){O=a.signalFromSignalOrOptions(O);const {field:X,normalizationField:ba,valueExpression:fa}=z;return(await this._executeQueryForStatistics(l,{field:X,normalizationField:ba,valueExpression:fa},O)).createSummaryStatisticsResponse(z)}async executeQueryForUniqueValues(l={},z,O){O=a.signalFromSignalOrOptions(O);const {field:X,field2:ba,field3:fa,valueExpression:na}=z;return(await this._executeQueryForStatistics(l,{field:X,field2:ba,field3:fa,valueExpression:na},O)).createUniqueValuesResponse(z)}async executeQueryForClassBreaks(l=
{},z,O){O=a.signalFromSignalOrOptions(O);const {field:X,normalizationField:ba,valueExpression:fa}=z;return(await this._executeQueryForStatistics(l,{field:X,normalizationField:ba,valueExpression:fa},O)).createClassBreaksResponse(z)}async executeQueryForHistogram(l={},z,O){O=a.signalFromSignalOrOptions(O);const {field:X,normalizationField:ba,valueExpression:fa}=z;return(await this._executeQueryForStatistics(l,{field:X,normalizationField:ba,valueExpression:fa},O)).createHistogramResponse(z)}async fetchRecomputedExtents(l){l=
a.signalFromSignalOrOptions(l);this._timeExtentPromise||(this._timeExtentPromise=U.getTimeExtent(this.timeInfo,this.featureStore));const [z,O]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);a.throwIfAborted(l);return{fullExtent:z,timeExtent:O}}async _getBounds(l,z,O){const X=w.set(w.create(),w.negativeInfinity);await this.featureStore.forEachBounds(l,ba=>w.expandWithAABB(X,ba));l={xmin:X[0],ymin:X[1],xmax:X[3],ymax:X[4],spatialReference:b.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(X[2])&&isFinite(X[5])&&(l.zmin=X[2],l.zmax=X[5],l.hasZ=!0);z=q.project(l,z,O);z.spatialReference=b.cleanFromGeometryEngine(O);0===z.xmax-z.xmin&&(O=p.getMetersPerUnitForSR(z.spatialReference),z.xmin-=O,z.xmax+=O);0===z.ymax-z.ymin&&(O=p.getMetersPerUnitForSR(z.spatialReference),z.ymin-=O,z.ymax+=O);this.hasZ&&null!=z.zmin&&null!=z.zmax&&0===z.zmax-z.zmin&&(O=p.getMetersPerUnitForSR(z.spatialReference),z.zmin-=O,z.zmax+=O);return z}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(l=>this._getBounds(l,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(l,z){return null!=this._frameTask?this._frameTask.schedule(l,z):l(v.noBudget)}async _reschedule(l,z){return null!=this._frameTask?this._frameTask.reschedule(l,z):l(v.noBudget)}async _getAllFeaturesQueryEngineResult(l){return new G.QueryEngineResult(await this._getAllFeatures(),
l,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const O=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(X=>O.push(X))})().then(()=>O)}const l=this._allFeaturesPromise,z=await l;return l===this._allFeaturesPromise?z.slice():this._getAllFeatures()}async _executeQuery(l,z,O){l=r.clone(l);l=await this._schedule(()=>P.normalizeQuery(l,this.definitionExpression,this.spatialReference),O);l=await this._reschedule(()=>S.validateQuery(l,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),O);l={...l,...z};const X=await this._reschedule(()=>this._executeSceneFilterQuery(l,O),O),ba=await this._reschedule(()=>this._executeGeometryQuery(l,X,O),O);await this._reschedule(()=>this._executeAggregateIdsQuery(ba),O);await this._reschedule(()=>this._executeObjectIdsQuery(ba),O);await this._reschedule(()=>this._executeTimeQuery(ba),O);await this._reschedule(()=>this._executeAttributesQuery(ba),
O);return ba}async _executeSceneFilterQuery(l,z){if(null==l.sceneFilter)return null;const {outSR:O,returnGeometry:X,returnCentroid:ba}=l;var fa=this.featureStore.featureSpatialReference,na=l.sceneFilter.geometry;const oa=null==fa||J.equals(fa,na.spatialReference)?na:q.project(na,fa);if(!oa)return null;fa=X||ba;fa=J.isValid(O)&&!J.equals(this.spatialReference,O)&&fa?async xa=>this._project(xa,O):xa=>xa;const pa=this.featureAdapter;na=await this._reschedule(()=>this._searchFeatures(Q(oa)),z);if("disjoint"===
l.sceneFilter.spatialRelationship){if(!na.length)return null;const xa=new Set;for(var sa of na)xa.add(pa.getObjectId(sa));const Da=await this._reschedule(()=>this._getAllFeatures(),z);sa=await this._reschedule(async()=>{const Ea=await ca.getSpatialQueryOperator("esriSpatialRelDisjoint",oa,this.geometryType,this.hasZ,this.hasM),Ja=await this._runSpatialFilter(Da,Sa=>!xa.has(pa.getObjectId(Sa))||Ea(pa.getGeometry(Sa)),z);return new G.QueryEngineResult(Ja,l,this)},z);return fa(sa)}if(!na.length)return new G.QueryEngineResult([],
l,this);if(this._canExecuteSinglePass(oa,l))return fa(new G.QueryEngineResult(na,l,this));const wa=await ca.getSpatialQueryOperator("esriSpatialRelContains",oa,this.geometryType,this.hasZ,this.hasM);sa=await this._runSpatialFilter(na,xa=>wa(pa.getGeometry(xa)),z);return fa(new G.QueryEngineResult(sa,l,this))}async _executeGeometryQuery(l,z,O){if(null!=z&&0===z.items.length)return z;l=null!=z?z.query:l;const {geometry:X,outSR:ba,spatialRel:fa,returnGeometry:na,returnCentroid:oa}=l;var pa=this.featureStore.featureSpatialReference;
const sa=!X||null==pa||J.equals(pa,X.spatialReference)?X:q.project(X,pa),wa=na||oa,xa=J.isValid(ba)&&!J.equals(this.spatialReference,ba),Da=null==z?this._getCacheKey(l):null;pa=Da?this._cache.get(Da):null;if(null!=pa)return new G.QueryEngineResult(pa,l,this);pa=async La=>{xa&&wa&&await this._project(La,ba);Da&&this._cache.put(Da,La.items);return La};if(!sa)return pa(null!=z?z:await this._getAllFeaturesQueryEngineResult(l));const Ea=this.featureAdapter;let Ja=await this._reschedule(()=>this._searchFeatures(Q(X)),
O);if("esriSpatialRelDisjoint"===fa){if(!Ja.length)return pa(null!=z?z:await this._getAllFeaturesQueryEngineResult(l));const La=new Set;for(var Sa of Ja)La.add(Ea.getObjectId(Sa));const m=null!=z?z.items:await this._reschedule(()=>this._getAllFeatures(),O);Sa=await this._reschedule(async()=>{const E=await ca.getSpatialQueryOperator(fa,sa,this.geometryType,this.hasZ,this.hasM),W=await this._runSpatialFilter(m,aa=>!La.has(Ea.getObjectId(aa))||E(Ea.getGeometry(aa)),O);return new G.QueryEngineResult(W,
l,this)},O);return pa(Sa)}if(null!=z){const La=new k.PositionHint;Ja=Ja.filter(m=>0<=k.indexOf(z.items,m,z.items.length,La))}if(!Ja.length)return pa=new G.QueryEngineResult([],l,this),Da&&this._cache.put(Da,pa.items),pa;if(this._canExecuteSinglePass(sa,l))return pa(new G.QueryEngineResult(Ja,l,this));const ab=await ca.getSpatialQueryOperator(fa,sa,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Ja,La=>ab(Ea.getGeometry(La)),O);return pa(new G.QueryEngineResult(Sa,l,this))}async _executeGeometryQueryForSnapping(l,
z){const {query:O}=l,{spatialRel:X}=O;if(l?.items?.length&&O.geometry&&X){var ba=await ca.getSpatialQueryOperator(X,O.geometry,this.geometryType,this.hasZ,this.hasM);z=await this._runSpatialFilter(l.items,fa=>ba(fa.geometry),z);l.items=z}}_executeAggregateIdsQuery(l){if(0!==l.items.length&&l.query.aggregateIds?.length&&null!=this.aggregateAdapter){var z=new Set;for(const X of l.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(X).forEach(ba=>z.add(ba));var O=this.featureAdapter.getObjectId;
l.items=l.items.filter(X=>z.has(O(X)))}}_executeObjectIdsQuery(l){if(0!==l.items.length&&l.query.objectIds?.length){var z=new Set(l.query.objectIds),O=this.featureAdapter.getObjectId;l.items=l.items.filter(X=>z.has(O(X)))}}_executeTimeQuery(l){if(0!==l.items.length){var z=U.getTimeOperator(this.timeInfo,l.query.timeExtent,this.featureAdapter);null!=z&&(l.items=l.items.filter(z))}}_executeAttributesQuery(l){if(0!==l.items.length){var z=u.getWhereClause(l.query.where,this.fieldsIndex);if(z){if(!z.isStandardized)throw new TypeError("Where clause is not standardized");
l.items=l.items.filter(O=>z.testFeature(O,this.featureAdapter))}}}async _runSpatialFilter(l,z,O){if(!z)return l;if(null==this._frameTask)return l.filter(na=>z(na));let X=0;const ba=[],fa=async na=>{for(;X<l.length;){const oa=l[X++];z(oa)&&(ba.push(oa),na.madeProgress());na.done&&await this._reschedule(pa=>fa(pa),O)}};return this._reschedule(na=>fa(na),O).then(()=>ba)}_filterLatest(l){const {trackIdField:z,startTimeField:O,endTimeField:X}=this.timeInfo,ba=X||O,fa=new Map,na=this.featureAdapter.getAttribute;
for(const oa of l.items){const pa=na(oa,z),sa=na(oa,ba),wa=fa.get(pa);(!wa||sa>na(wa,ba))&&fa.set(pa,oa)}l.items=Array.from(fa.values())}_getCacheKey(l){const {geometry:z,spatialRel:O,returnGeometry:X,returnCentroid:ba,outSR:fa,resultType:na,cacheHint:oa}=l;if("tile"!==na&&!oa)return null;l=X||ba;return J.isValid(fa)&&!J.equals(this.spatialReference,fa)&&l?JSON.stringify([z,O,fa]):JSON.stringify([z,O])}_canExecuteSinglePass(l,z){({spatialRel:z}=z);return ca.canQueryWithRBush(l)&&("esriSpatialRelEnvelopeIntersects"===
z||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===z||"esriSpatialRelContains"===z))}async _project(l,z){if(!z||J.equals(this.spatialReference,z))return l;const O=this.featureAdapter;let X=void 0;try{const ba=await this._getFullExtent();X=h.getTransformation(this.spatialReference,z,ba)}catch{}z=await q.projectMany(l.items.map(ba=>b.getGeometry(this.geometryType,this.hasZ,this.hasM,O.getGeometry(ba))),this.spatialReference,z,X);l.items=z.map((ba,fa)=>O.cloneWithGeometry(l.items[fa],
K.convertFromGeometry(ba,this.hasZ,this.hasM)));return l}async _searchFeatures(l){const z=new Set;await Promise.all(l.map(O=>this.featureStore.forEachInBounds(O,X=>z.add(X))));l=Array.from(z.values());z.clear();return l}async _executeQueryForStatistics(l,z,O){l=r.clone(l);try{l=await this._schedule(()=>P.normalizeQuery(l,this.definitionExpression,this.spatialReference),O);l=await this._reschedule(()=>S.validateStatisticsQuery(l,z,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,
geometryType:this.geometryType,spatialReference:this.spatialReference}),O);const X=await this._reschedule(()=>this._executeSceneFilterQuery(l,O),O),ba=await this._reschedule(()=>this._executeGeometryQuery(l,X,O),O);await this._reschedule(()=>this._executeAggregateIdsQuery(ba),O);await this._reschedule(()=>this._executeObjectIdsQuery(ba),O);await this._reschedule(()=>this._executeTimeQuery(ba),O);await this._reschedule(()=>this._executeAttributesQuery(ba),O);return ba}catch(X){if(X!==P.queryEngineEmptyResult)throw X;
return new G.QueryEngineResult([],l,this)}}}e.Feature=g;e.QueryEngine=f;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(e,k,y,C,r,M,a,p,h,w,x){function I(q){const L=[];let d=0,G=0;for(let P=0;P<
q.length;P++){const S=q[P];let ca=null;for(let U=0;U<S.length;U++)ca=S[U],L.push(ca),0===U?G=d=ca[0]:(d=Math.min(d,ca[0]),G=Math.max(G,ca[0]));ca&&L.push([(d+G)/2,0])}return L}function F(q,L){if(!(q instanceof M||q instanceof r))throw b().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new y("straightLineDensify: the input geometry is neither polyline nor polygon");var d=a.getGeometryParts(q);const G=[];for(const S of d){d=[];G.push(d);d.push([S[0][0],S[0][1]]);for(let ca=
0;ca<S.length-1;ca++){const U=S[ca][0],T=S[ca][1],v=S[ca+1][0],Q=S[ca+1][1];var P=Math.sqrt((v-U)*(v-U)+(Q-T)*(Q-T));const g=(Q-T)/P,f=(v-U)/P,l=P/L;if(1<l){for(let z=1;z<=l-1;z++){const O=z*L;d.push([f*O+U,g*O+T])}P=(P+Math.floor(l-1)*L)/2;d.push([f*P+U,g*P+T])}d.push([v,Q])}}return"polygon"===q.type?new r({rings:G,spatialReference:q.spatialReference}):new M({paths:G,spatialReference:q.spatialReference})}function t(q,L,d){L&&(q=F(q,1E6),q=h.webMercatorToGeographic(q,!0));d&&(q=a.updatePolyGeometry(q,
d));return q}function J(q,L,d){if(Array.isArray(q)){var G=q[0];G>L?(d=a.offsetMagnitude(G,L),q[0]=G+-2*d*L):G<d&&(L=a.offsetMagnitude(G,d),q[0]=G+-2*L*d)}else G=q.x,G>L?(d=a.offsetMagnitude(G,L),q=q.clone().offset(-2*d*L,0)):G<d&&(L=a.offsetMagnitude(G,d),q=q.clone().offset(-2*L*d,0));return q}function K(q,L){let d=-1;for(let G=0;G<L.cutIndexes.length;G++){const P=L.cutIndexes[G],S=L.geometries[G],ca=a.getGeometryParts(S);for(let U=0;U<ca.length;U++){const T=ca[U];T.some(v=>{if(180>v[0])return!0;
v=0;for(var Q=0;Q<T.length;Q++){var g=T[Q][0];v=g>v?g:v}v=Number(v.toFixed(9));v=-360*a.offsetMagnitude(v,180);for(Q=0;Q<T.length;Q++)g=S.getPoint(U,Q),S.setPoint(U,Q,g.clone().offset(v,0));return!0})}if(P===d)if("polygon"===q[0].type)for(const U of a.getGeometryParts(S))q[P]=q[P].addRing(U);else{if("polyline"===q[0].type)for(const U of a.getGeometryParts(S))q[P]=q[P].addPath(U)}else d=P,q[P]=S}return q}async function u(q,L,d){if(!Array.isArray(q))return u([q],L);L&&"string"!==typeof L&&b().warn("normalizeCentralMeridian()",
"The url object is deprecated, use the url string instead");var G="string"===typeof L?L:L?.url??k.geometryServiceUrl;let P,S,ca;let U=0;var T=[];L=[];for(var v of q)if(null==v)L.push(v);else{if(!Q){var Q=v.spatialReference;var g=p.getInfo(Q);var f=(P=Q.isWebMercator)?102100:4326;S=a.cutParams[f].maxX;ca=a.cutParams[f].minX;var l=a.cutParams[f].plus180Line;f=a.cutParams[f].minus180Line}if(g)if("mesh"===v.type)L.push(v);else if("point"===v.type)L.push(J(v.clone(),S,ca));else if("multipoint"===v.type){var z=
v.clone();z.points=z.points.map(O=>J(O,S,ca));L.push(z)}else if("extent"===v.type)z=v.clone()._normalize(!1,!1,g),L.push(z.rings?new r(z):z);else if(v.extent){z=v.extent;const O=2*a.offsetMagnitude(z.xmin,ca)*S;let X=0===O?v.clone():a.updatePolyGeometry(v.clone(),O);z.offset(O,0);let {xmin:ba,xmax:fa}=z;ba=Number(ba.toFixed(9));fa=Number(fa.toFixed(9));z.intersects(l)&&fa!==S?(U=fa>U?fa:U,X=t(X,P),T.push(X),L.push("cut")):z.intersects(f)&&ba!==ca?(U=2*fa*S>U?2*fa*S:U,X=t(X,P,360),T.push(X),L.push("cut")):
L.push(X)}else L.push(v.clone());else L.push(v)}Q=a.offsetMagnitude(U,S);g=-90;l=Q;for(v=new M;0<Q;)f=-180+360*Q,v.addPath([[f,g],[f,-1*g]]),g*=-1,Q--;if(0<T.length&&0<l){Q=await w.cut(G,T,v,d);Q=K(T,Q);g=[];T=[];for(l=0;l<L.length;l++)v=L[l],"cut"!==v?T.push(v):(v=Q.shift(),f=q[l],null!=f&&"polygon"===f.type&&f.rings&&1<f.rings.length&&v.rings.length>=f.rings.length?(g.push(v),T.push("simplify")):T.push(P?h.geographicToWebMercator(v):v));if(!g.length)return T;L=await x.simplify(G,g,d);q=[];for(d=
0;d<T.length;d++)G=T[d],"simplify"!==G?q.push(G):q.push(P?h.geographicToWebMercator(L.shift()):L.shift());return q}q=[];for(d=0;d<L.length;d++)G=L[d],"cut"!==G?q.push(G):(G=T.shift(),q.push(!0===P?h.geographicToWebMercator(G):G));return q}const b=()=>C.getLogger("esri.geometry.support.normalizeUtils");e.getClosestDenormalizedXToReference=function(q,L,d){d=p.getInfo(d);if(null==d)return q;const [G,P]=d.valid;d=2*P;let S=0,ca=0;L>P?S=Math.ceil(Math.abs(L-P)/d):L<G&&(S=-Math.ceil(Math.abs(L-G)/d));q>
P?ca=Math.ceil(Math.abs(q-P)/d):q<G&&(ca=-Math.ceil(Math.abs(q-G)/d));q+=(S-ca)*d;L=q-L;L>P?q-=d:L<G&&(q+=d);return q};e.getDenormalizedExtent=function(q){if(!q)return null;const L=q.extent;if(!L)return null;var d=q.spatialReference&&p.getInfo(q.spatialReference);if(!d)return L;const [G,P]=d.valid;({width:d}=L);let {xmin:S,xmax:ca}=L;[S,ca]=[ca,S];if("extent"===q.type||0===d||d<=P||d>2*P||S<G||ca>P)return L;let U;switch(q.type){case "polygon":if(1<q.rings.length)U=I(q.rings);else return L;break;case "polyline":if(1<
q.paths.length)U=I(q.paths);else return L;break;case "multipoint":U=q.points}q=L.clone();for(let T=0;T<U.length;T++){let v=U[T][0];0>v?(v+=P,ca=Math.max(v,ca)):(v-=P,S=Math.min(v,S))}q.xmin=S;q.xmax=ca;return q.width<d?(q.xmin-=P,q.xmax-=P,q):L};e.normalizeCentralMeridian=u;e.normalizeMapX=function(q,L){if(L=p.getInfo(L)){const [d,G]=L.valid;L=G-d;if(q<d)for(;q<d;)q+=L;if(q>G)for(;q>G;)q-=L}return q};e.straightLineDensify=F;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports",
"../Polyline","../SpatialReference","./jsonUtils"],function(e,k,y,C){function r(M){return C.isPolygon(M)?M.rings:M.paths}k={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new k({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:y.WebMercator}),minus180Line:new k({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:y.WebMercator})},4326:{maxX:180,
minX:-180,plus180Line:new k({paths:[[[180,-180],[180,180]]],spatialReference:y.WGS84}),minus180Line:new k({paths:[[[-180,-180],[-180,180]]],spatialReference:y.WGS84})}};e.cutParams=k;e.getGeometryParts=r;e.offsetMagnitude=function(M,a){return Math.ceil((M-a)/(2*a))};e.updatePolyGeometry=function(M,a){const p=r(M);for(const h of p)for(const w of h)w[0]+=a;return M};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(e,k,y,C,r,M){e.cut=async function(a,p,h,w){a=M.parseUrl(a);const x=p[0].spatialReference;p={...w,responseType:"json",query:{...a.query,f:"json",sr:r.srToRESTValue(x),target:JSON.stringify({geometryType:C.getJsonType(p[0]),geometries:p}),cutter:JSON.stringify(h)}};p=await y(a.path+"/cut",p);const {cutIndexes:I,geometries:F=[]}=p.data;return{cutIndexes:I,geometries:F.map(t=>{t=C.fromJSON(t);t.spatialReference=x;return t})}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(e,k,y,C,r,M){function a(p,h,w){const x={};for(const F in p)if("declaredClass"!==F){var I=p[F];null!=I&&"function"!==typeof I&&(Array.isArray(I)?x[F]=I.map(t=>a(t)):"object"===typeof I?I.toJSON?(I=I.toJSON(w?.[F]),x[F]=h?I:JSON.stringify(I)):x[F]=h?I:JSON.stringify(I):x[F]=I)}return x}e.asValidOptions=function(p,h){return h?{...h,query:{...(p??{}),...h.query}}:{query:p}};e.encode=a;e.getToken=function(p,h){return p?M.isApiKeyApplicable(p,h)?h||k.apiKey:y.id?.findCredential(p)?.token:null};
e.parseUrl=function(p){return"string"===typeof p?r.urlToObject(p):C.clone(p)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(e,k,y,C,r,M){e.simplify=async function(a,p,h){const w="string"===typeof a?y.urlToObject(a):a;a=p[0].spatialReference;const x=C.getJsonType(p[0]);p={...h,query:{...w.query,
f:"json",sr:r.srToRESTValue(a),geometries:JSON.stringify(M.encodeGeometries(p))}};({data:p}=await k(w.path+"/simplify",p));return M.decodeGeometries(p.geometries,x,a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(e,k){e.decodeGeometries=function(y,C,r){const M=k.getGeometryType(C);return y.map(a=>{a=M.fromJSON(a);a.spatialReference=r;return a})};e.encodeGeometries=function(y){return{geometryType:k.getJsonType(y[0]),
geometries:y.map(C=>C.toJSON())}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(e,k,y,C){function r(t,J,K={}){const u=M(J,t);if(!u)throw K=x.getError(J,t),new k("unsupported-query","invalid SQL expression",{expression:J,error:K});t=K.expressionName||"expression";if(K.validateStandardized&&!u.isStandardized)throw new k("unsupported-query",
`${t} is not standard`,{expression:J});if(K.validateAggregate&&!u.isAggregate)throw new k("unsupported-query",`${t} does not contain a valid aggregate function`,{expression:J});return u.fieldNames}function M(t,J){return t?x.get(t,J):null}function a(t){return/\((.*?)\)/.test(t)?t:t.split(" as ")[0]}function p(t,J,K,u={}){const b=new Map;h(b,t,J,u.allowedFieldTypes??F,K);if(b.size)throw new k("unsupported-query",`${u.expressionName??"expression"} contains invalid or missing fields`,{errors:Array.from(b.values()),
query:u.query});}function h(t,J,K,u,b){b=b.includes("*")?[...K,...b.filter(q=>"*"!==q)]:b;for(const q of b)if(J.get(q))w(t,J,K,u,q);else try{const L=a(q),d=r(J,L,{validateStandardized:!0});for(const G of d)w(t,J,K,u,G)}catch(L){t.set(q,{type:"expression-error",expression:q,error:L})}}function w(t,J,K,u,b){(J=J.get(b))?K.has(J.name)?"all"!==u&&!1===u?.has(J.type)&&t.set(b,{type:"invalid-type",fieldName:J.name,fieldType:C.kebabDict.fromJSON(J.type),allowedFieldTypes:Array.from(u,q=>C.kebabDict.fromJSON(q))}):
t.set(b,{type:"missing-field",fieldName:J.name}):t.set(b,{type:"invalid-field",fieldName:b})}const x=new y.WhereClauseCache(50,500);y=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const I=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),F=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...y,
...I]);e.allDateAndTimeFieldTypes=I;e.getAliasFromFieldName=function(t){return t.split(" as ")[1]};e.getExpressionFromFieldName=a;e.getWhereClause=M;e.numericFieldTypes=y;e.validateFields=p;e.validateHaving=function(t,J,K,u,b){if(!K)return!0;const q=r(t,K,{validateAggregate:!0,expressionName:"having clause"});p(t,J,q,{expressionName:"having clause",query:b});if(!M(K,t)?.getExpressions().every(L=>{const {aggregateType:d,field:G}=L,P=t.get(G)?.name;return u.some(S=>{const {onStatisticField:ca,statisticType:U}=
S;return t.get(ca)?.name===P&&U.toLowerCase().trim()===d})}))throw new k("unsupported-query","expressions in having clause should also exist in outStatistics",{having:K});return!0};e.validateWhere=function(t,J,K,u){if(!K)return!0;K=r(t,K,{validateStandardized:!0,expressionName:"where clause"});p(t,J,K,{expressionName:"where clause",query:u});return!0};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],
function(e,k,y){class C{constructor(r,M){this._cache=new k.LRUCache(r);this._invalidCache=new k.LRUCache(M)}get(r,M){const a=`${M.uid}:${r}`,p=this._cache.get(a);if(p)return p;if(null!=this._invalidCache.get(a))return null;try{const h=y.WhereClause.create(r,{fieldsIndex:M});this._cache.put(a,h);return h}catch(h){return this._invalidCache.put(a,h),null}}getError(r,M){return this._invalidCache.get(`${M.uid}:${r}`)??null}}e.WhereClauseCache=C;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(e,k){class y{constructor(C,r){this._storage=new k.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=C;this._storage.register(this);r&&this._storage.registerRemoveFunc("",r)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(C,r,M=1){this._storage.put(this,C,r,M,1)}pop(C){return this._storage.pop(this,C)}get(C){return this._storage.get(this,C)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(C){this._storage.maxSize=
C}resetHitRate(){}}e.LRUCache=y;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(e,k){e.RemoveMode=void 0;(function(a){a[a.ALL=0]="ALL";a[a.SOME=1]="SOME"})(e.RemoveMode||(e.RemoveMode={}));class y{constructor(a,p,h){this.name=a;this._storage=p;this.id=`${r++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);h&&(this._storage.registerRemoveFunc(this.id,h),
this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(a){return this._storage.getSize(this,a)}resetHitRate(){this._hit=this._miss=0}put(a,p,h,w=0){this._storage.put(this,a,p,h,w)}pop(a){a=this._storage.pop(this,a);void 0===a?++this._miss:++this._hit;return a}get(a){a=this._storage.get(this,
a);void 0===a?++this._miss:++this._hit;return a}peek(a){return this._storage.peek(this,a)}updateSize(a,p,h){this._storage.updateSize(this,a,p,h)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class C{get size(){return this._size}constructor(a=10485760){this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new k;this._users=new k}destroy(){this.clearAll();
this._removeFuncs.clear();this._users.clear();this._db=null}register(a){this._users.push(a)}deregister(a){this._users.removeUnordered(a)}registerRemoveFunc(a,p){this._removeFuncs.push([a,p])}deregisterRemoveFunc(a){this._removeFuncs.filterInPlace(p=>p[0]!==a)}get maxSize(){return this._maxSize}set maxSize(a){this._maxSize=Math.max(a,-1);this._checkSize()}getSize(a,p){return this._db.get(a.id+p)?.size??0}put(a,p,h,w,x){p=a.id+p;const I=this._db.get(p);I&&(this._size-=I.size,a.size-=I.size,this._db.delete(p),
I.entry!==h&&this._notifyRemove(p,I.entry,I.size,e.RemoveMode.ALL));w>this._maxSize?this._notifyRemove(p,h,w,e.RemoveMode.ALL):void 0===h?console.warn("Refusing to cache undefined entry "):!w||0>w?(console.warn(`Refusing to cache entry with size ${w} for key ${p}`),this._notifyRemove(p,h,0,e.RemoveMode.ALL)):(this._db.set(p,new M(h,w,1+Math.max(x,-4)- -3)),this._size+=w,a.size+=w,this._checkSize())}updateSize(a,p,h,w){p=a.id+p;const x=this._db.get(p);if(x&&x.entry===h){this._size-=x.size;for(a.size-=
x.size;w>this._maxSize;)if(w=this._notifyRemove(p,h,w,e.RemoveMode.SOME),!(null!=w&&0<w)){this._db.delete(p);return}x.size=w;this._size+=w;a.size+=w;this._checkSize()}}pop(a,p){p=a.id+p;const h=this._db.get(p);if(h)return this._size-=h.size,a.size-=h.size,this._db.delete(p),++this._hit,h.entry;++this._miss}get(a,p){p=a.id+p;a=this._db.get(p);if(void 0===a)++this._miss;else return this._db.delete(p),a.lives=a.lifetime,this._db.set(p,a),++this._hit,a.entry}peek(a,p){(a=this._db.get(a.id+p))?++this._hit:
++this._miss;return a?.entry}get performanceInfo(){const a={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},p={},h=[];this._db.forEach((I,F)=>{const t=I.lifetime;h[t]=(h[t]||0)+I.size;this._users.forAll(J=>{const {id:K,name:u}=J;F.startsWith(K)&&(p[u]=(p[u]||0)+I.size)})});const w={};this._users.forAll(I=>{const F=I.name;"hitRate"in I&&"number"===typeof I.hitRate&&!isNaN(I.hitRate)&&
0<I.hitRate?(p[F]=p[F]||0,w[F]=Math.round(100*I.hitRate)+"%"):w[F]="0%"});var x=Object.keys(p);x.sort((I,F)=>p[F]-p[I]);x.forEach(I=>a[I]=Math.round(p[I]/2**20)+"MB / "+w[I]);for(x=h.length-1;0<=x;--x){const I=h[x];I&&(a["Priority "+(x+-3-1)]=Math.round(I/this._size*100)+"%")}return a}resetStats(){this._hit=this._miss=0;this._users.forAll(a=>a.resetHitRate())}clear(a){const p=a.id;this._db.forEach((h,w)=>{w.startsWith(p)&&(this._size-=h.size,this._db.delete(w),this._notifyRemove(w,h.entry,h.size,
e.RemoveMode.ALL))});a.size=0}clearAll(){this._db.forEach((a,p)=>this._notifyRemove(p,a.entry,a.size,e.RemoveMode.ALL));this._users.forAll(a=>a.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(a,p,h,w){let x;this._removeFuncs.some(I=>a.startsWith(I[0])?(I=I[1](p,w,h),"number"===typeof I&&(x=I),!0):!1);return x}_checkSize(){this._users.forAll(a=>this._checkSizeLimits(a));this._checkSizeLimits()}_checkSizeLimits(a){const p=a??this;if(!(0>p.maxSize||
p.size<=p.maxSize)){for(var h=a?.id,w=!0;w;){w=!1;for(const [x,I]of this._db)if(0===I.lifetime&&(!h||x.startsWith(h))){this._purgeItem(x,I,a);if(p.size<=.9*p.maxSize)return;w||=this._db.has(x)}}for(const [x,I]of this._db)if(!h||x.startsWith(h))if(this._purgeItem(x,I,a),p.size<=.9*p.maxSize)break}}_purgeItem(a,p,h=this._users.find(w=>a.startsWith(w.id))){this._db.delete(a);if(1>=p.lives){this._size-=p.size;h&&(h.size-=p.size);const w=this._notifyRemove(a,p.entry,p.size,e.RemoveMode.SOME);null!=w&&
0<w&&(this._size+=w,h&&(h.size+=w),p.lives=p.lifetime,p.size=w,this._db.set(a,p))}else--p.lives,this._db.set(a,p)}}let r=0;class M{constructor(a,p,h){this.entry=a;this.size=p;this.lives=this.lifetime=h}}e.MemCache=y;e.MemCacheStorage=C;e.MinPriority=-3;e.NoPriority=-4;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../has ./AggregateFunctions ./DateOnly ./errorSupport ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J){function K(v){return Array.isArray(v)?v:[v]}function u(v){return null!==v?!0!==v:null}function b(v,Q){return null!=v&&null!=Q?!0===v&&!0===Q:!1===v||!1===Q?!1:null}function q(v,Q){return null!=v&&null!=Q?!0===v||!0===Q:!0===v||!0===Q?!0:null}function L(v,Q,g){if(null==v)return null;g=!1;for(const f of Q)if(null==f)g=null;else if(v===f){g=!0;break}else if(p.isDateOrTimeValue(v)&&p.isDateOrTimeValue(f)&&(g=p.sqlCompare(v,f,"\x3d")))break;return g}function d(v,
Q,g){if(null==v)return null;let f="",l=U.Normal;for(let z=0;z<Q.length;z++){const O=Q.charAt(z);switch(l){case U.Normal:O===g?l=U.Escaped:f="-[]/{}()*+?.\\^$|".includes(O)?f+("\\"+O):"%"===O?f+".*":"_"===O?f+".":f+O;break;case U.Escaped:f="-[]/{}()*+?.\\^$|".includes(O)?f+("\\"+O):f+O,l=U.Normal}}return(new RegExp("^"+f+"$","m")).test(v)}function G(v,Q,g,f){v=f.getAttribute(v,Q);Q=g?.get(Q);return null==v||"esriFieldTypeDate"!==Q?.type&&"date"!==Q?.type?null==v||"esriFieldTypeDateOnly"!==Q?.type&&
"date-only"!==Q?.type?null==v||"esriFieldTypeTimeOnly"!==Q?.type&&"time-only"!==Q?.type?null==v||"esriFieldTypeTimestampOffset"!==Q?.type&&"timestamp-offset"!==Q?.type?v:new x.SqlTimeStampOffset(v):F.TimeOnly.fromReader(v):r.DateOnly.fromReader(v):h.convertToExecutingTimeZone(new Date(v),g?.getLuxonTimeZone(Q.name)??J.FixedOffsetZone.utcInstance)}const P=new Set(["current_timestamp","current_date","current_time"]);class S{static makeBool(v){return!0===v}static featureValue(v,Q,g,f){return G(v,Q,g,
f)}static equalsNull(v){return null===v}static applyLike(v,Q,g){return d(v,Q,g)}static ensureArray(v){return K(v)}static applyIn(v,Q,g){return L(v,Q)}static currentTimestamp(v){return h.convertToExecutingTimeZone(new Date,v)}static currentDate(v){return r.DateOnly.fromNow(v)}static currentTime(v){v=h.convertToExecutingTimeZone(new Date,v);return F.TimeOnly.fromDateTime(v)}static makeSqlInterval(v,Q,g){return w.SqlInterval.createFromValueAndQualifier(v,Q,g)}static convertInterval(v){return v instanceof
w.SqlInterval?v.valueInMilliseconds():v}static compare(v,Q,g,f){return p.sqlCompare(Q,g,v)}static calculate(v,Q,g,f){return a.sqlCalculateFunction(v,Q,g,f)}static evaluateTime(v){return h.parseTime(v)}static evaluateTimestamp(v,Q,g){return h.parseTimestamp(v,Q,g)}static evaluateDate(v,Q){return h.parseDate(v,Q)}static evaluateFunction(v,Q,g){return I.evaluateFunction(v,Q,g)}static lookup(v,Q){v=Q[v];return void 0===v?null:v}static between(v,Q,g){return null==v||null==Q[0]||null==Q[1]?null:p.sqlCompare(v,
Q[0],"\x3e\x3d")&&p.sqlCompare(v,Q[1],"\x3c\x3d")}static notbetween(v,Q,g){return null==v||null==Q[0]||null==Q[1]?null:p.sqlCompare(v,Q[0],"\x3c")||p.sqlCompare(v,Q[1],"\x3e")}static ternaryNot(v){return u(v)}static ternaryAnd(v,Q){return b(v,Q)}static ternaryOr(v,Q){return q(v,Q)}}class ca{constructor(v,Q,g="UTC",f=null){this.fieldsIndex=Q;this.timeZone=g;this.currentUser=f;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=t.WhereGrammar.parse(v);const {isStandardized:l,isAggregate:z,
currentUserRequired:O,referencedFieldNames:X}=this._extractExpressionInfo(Q);this._referencedFieldNames=X;this.isStandardized=l;this.isAggregate=z;this.currentUserRequired=O}static convertValueToStorageFormat(v,Q=null){if(null===Q)return h.isDate(v)?v.getTime():h.isDateTime(v)?v.toMillis():h.isTimestampOffset(v)?v.toStorageFormat():h.isTimeOnly(v)?v.toStorageString():h.isDateOnly(v)?v.toStorageFormat():v;switch(Q){case "date":if(h.isDate(v))return v.getTime();if(h.isDateTime(v))return v.toMillis();
if(h.isTimestampOffset(v))return v.toMilliseconds();if(h.isDateOnly(v))return v.toNumber();break;case "date-only":if(h.isDate(v))return r.DateOnly.fromDateJS(v).toString();if(h.isTimestampOffset(v))return r.DateOnly.fromSqlTimeStampOffset(v).toString();if(h.isDateTime(v))return r.DateOnly.fromDateTime(v).toString();break;case "time-only":if(h.isDate(v))return F.TimeOnly.fromDateJS(v).toStorageString();if(h.isDateTime(v))return F.TimeOnly.fromDateTime(v).toStorageString();if(h.isTimestampOffset(v))return F.TimeOnly.fromSqlTimeStampOffset(v).toStorageString();
if(h.isTimeOnly(v))return v.toStorageString();break;case "timestamp-offset":if(h.isDate(v))return x.SqlTimeStampOffset.fromJSDate(v).toStorageFormat();if(h.isDateTime(v))return x.SqlTimeStampOffset.fromDateTime(v).toStorageFormat();if(h.isTimestampOffset(v))return v.toStorageFormat()}return v}static create(v,Q={}){return new ca(v,Q.fieldsIndex,Q.timeZone??void 0,Q.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(v,Q=T,g=this.currentUser){return!!this._evaluateNode(this.parseTree,
null,Q,v,g)}calculateValue(v,Q=T,g=this.currentUser){v=this._evaluateNode(this.parseTree,v,Q,null,g);return v instanceof w.SqlInterval?v.valueInMilliseconds()/864E5:v}calculateValueCompiled(v,Q=T,g=this.currentUser){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(v,this.parameters,Q,this.fieldsIndex,this.timeZone,g??null);if(y("esri-csp-restrictions"))return this.calculateValue(v,Q);this._compileMe();return this.parseTree._compiledVersion(v,this.parameters,Q,this.fieldsIndex,
this.timeZone,g??null)}testFeature(v,Q=T,g=this.currentUser){return!!this._evaluateNode(this.parseTree,v,Q,null,g)}testFeatureCompiled(v,Q=T,g=this.currentUser){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(v,this.parameters,Q,this.fieldsIndex,this.timeZone,g??null);if(y("esri-csp-restrictions"))return this.testFeature(v,Q);this._compileMe();return!!this.parseTree._compiledVersion(v,this.parameters,Q,this.fieldsIndex,this.timeZone,g??null)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;t.visitAll(this.parseTree,v=>{"current-time"===v.type?this._hasDateFunctions=!0:"function"===v.type&&(this._hasDateFunctions=this._hasDateFunctions||P.has(v.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const v=new Set;t.visitAll(this.parseTree,Q=>{"function"===Q.type&&v.add(Q.name.toLowerCase())});return Array.from(v)}getExpressions(){const v=new Map;t.visitAll(this.parseTree,Q=>{if("function"===
Q.type){const g=Q.name.toLowerCase();Q=Q.args.value[0];if("column-reference"===Q.type){Q=Q.column;const f=`${g}-${Q}`;v.has(f)||v.set(f,{aggregateType:g,field:Q})}}});return[...v.values()]}getVariables(){const v=new Set;t.visitAll(this.parseTree,Q=>{"parameter"===Q.type&&v.add(Q.value.toLowerCase())});return Array.from(v)}_compileMe(){const v="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone","currentUser",v)).bind(S)}_extractExpressionInfo(v){const Q=[],g=new Set;let f=!0,l=!1,z=!1;t.visitAll(this.parseTree,O=>{switch(O.type){case "column-reference":var X=v?.get(O.column);let ba;X?X=ba=X.name??"":(ba=O.column,X=ba.toLowerCase());g.has(X)||(g.add(X),Q.push(ba));O.column=ba;break;case "current-user":z=!0;break;case "function":const {name:fa,args:na}=O;O=na.value.length;f&&=I.isStandardized(fa,O);!1===l&&(l=C.isAggregate(fa,O))}});return{referencedFieldNames:Array.from(Q),
isStandardized:f,isAggregate:l,currentUserRequired:z}}evaluateNodeToJavaScript(v){switch(v.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(v.value)+", "+JSON.stringify(v.qualifier)+","+JSON.stringify(v.op)+")";case "case-expression":var Q="";if("simple"===v.format){var g=this.evaluateNodeToJavaScript(v.operand);Q="( ";for(let f=0;f<v.clauses.length;f++)Q+=" (this.compare('\x3d',"+g+","+this.evaluateNodeToJavaScript(v.clauses[f].operand)+") ? ("+this.evaluateNodeToJavaScript(v.clauses[f].value)+
") : "}else for(Q="( ",g=0;g<v.clauses.length;g++)Q+=" this.makeBool("+this.evaluateNodeToJavaScript(v.clauses[g].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(v.clauses[g].value)+") : ";Q=null!==v.else?Q+this.evaluateNodeToJavaScript(v.else):Q+"null";return Q+" )";case "parameter":return"this.lookup("+JSON.stringify(v.value.toLowerCase())+",lookups)";case "expression-list":Q="[";for(g of v.value)"["!==Q&&(Q+=","),Q+=this.evaluateNodeToJavaScript(g);return Q+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(v.expr)+")";case "binary-expression":switch(v.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+" )";case "IS":if("null"!==v.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(v.left)+")";case "ISNOT":if("null"!==
v.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(v.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(v.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(v.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(v.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(v.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(v.left)+
","+this.evaluateNodeToJavaScript(v.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+","+JSON.stringify(v.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+","+JSON.stringify(v.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(v.operator)+","+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(v.operator)+","+this.evaluateNodeToJavaScript(v.left)+","+this.evaluateNodeToJavaScript(v.right)+", timeZone)";default:throw new M.SqlError(M.SqlErrorCodes.UnsupportedOperator,{operator:v.operator});
}case "null":case "boolean":case "string":case "number":return JSON.stringify(v.value);case "time":return"this.evaluateTime("+JSON.stringify(v.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(v.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(v.value)+", 'unknown')";case "current-time":return"date"===v.mode?"this.currentDate(timeZone)":"time"===v.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case "current-user":return"currentUser";
case "column-reference":return"this.featureValue(feature,"+JSON.stringify(v.column)+",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(v.name)+","+this.evaluateNodeToJavaScript(v.args)+", timeZone)"}throw new M.SqlError(M.SqlErrorCodes.UnsupportedSyntax,{node:v.type});}_evaluateNode(v,Q,g,f,l){switch(v.type){case "interval":return g=this._evaluateNode(v.value,Q,g,f,l),w.SqlInterval.createFromValueAndQualifier(g,v.qualifier,v.op);case "case-expression":if("simple"===
v.format){var z=this._evaluateNode(v.operand,Q,g,f,l);for(var O=0;O<v.clauses.length;O++)if(p.sqlCompare(z,this._evaluateNode(v.clauses[O].operand,Q,g,f,l),"\x3d",this.timeZone))return this._evaluateNode(v.clauses[O].value,Q,g,f,l)}else for(z=0;z<v.clauses.length;z++)if(!0===this._evaluateNode(v.clauses[z].operand,Q,g,f,l))return this._evaluateNode(v.clauses[z].value,Q,g,f,l);return null!==v.else?this._evaluateNode(v.else,Q,g,f,l):null;case "parameter":return v=this.parameters[v.value.toLowerCase()],
h.isDate(v)?J.DateTime.fromJSDate(v):v instanceof k.ArcadeDate?v.toDateTime():v;case "expression-list":z=[];for(var X of v.value)z.push(this._evaluateNode(X,Q,g,f,l));return z;case "unary-expression":return u(this._evaluateNode(v.expr,Q,g,f,l));case "binary-expression":switch(v.operator){case "AND":return b(this._evaluateNode(v.left,Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l));case "OR":return q(this._evaluateNode(v.left,Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l));case "IS":if("null"!==v.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);
return null===this._evaluateNode(v.left,Q,g,f,l);case "ISNOT":if("null"!==v.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return null!==this._evaluateNode(v.left,Q,g,f,l);case "IN":return z=K(this._evaluateNode(v.right,Q,g,f,l)),L(this._evaluateNode(v.left,Q,g,f,l),z,this.timeZone);case "NOT IN":return z=K(this._evaluateNode(v.right,Q,g,f,l)),u(L(this._evaluateNode(v.left,Q,g,f,l),z,this.timeZone));case "BETWEEN":return z=this._evaluateNode(v.left,Q,g,f,l),v=this._evaluateNode(v.right,
Q,g,f,l),null==z||null==v[0]||null==v[1]?null:p.sqlCompare(z,v[0],"\x3e\x3d",this.timeZone)&&p.sqlCompare(z,v[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return z=this._evaluateNode(v.left,Q,g,f,l),v=this._evaluateNode(v.right,Q,g,f,l),null==z||null==v[0]||null==v[1]?null:p.sqlCompare(z,v[0],"\x3c",this.timeZone)||p.sqlCompare(z,v[1],"\x3e",this.timeZone);case "LIKE":return d(this._evaluateNode(v.left,Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l),v.escape);case "NOT LIKE":return u(d(this._evaluateNode(v.left,
Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l),v.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return p.sqlCompare(this._evaluateNode(v.left,Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l),v.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return a.sqlCalculateFunction(v.operator,this._evaluateNode(v.left,Q,g,f,l),this._evaluateNode(v.right,Q,g,f,l),this.timeZone)}case "null":case "boolean":case "string":case "number":return v.value;case "date":return v.parsedValue??
(v.parsedValue=h.parseDate(v.value,"unknown")),v.parsedValue;case "timestamp":return v.parsedValue??(v.parsedValue=h.parseTimestamp(v.value,"unknown")),v.parsedValue;case "time":return h.parseTime(v.value);case "current-time":return"date"===v.mode?S.currentDate(this.timeZone):"time"===v.mode?S.currentTime(this.timeZone):S.currentTimestamp(this.timeZone);case "current-user":return l??null;case "column-reference":return G(Q,v.column,this.fieldsIndex,g);case "data-type":return v.value;case "function":if(this.isAggregate&&
C.isAggregate(v.name,v.args.value.length)){Q=[];for(z of v.args?.value||[]){X=[];for(O of f||[])X.push(this._evaluateNode(z,O,g,null,l));Q.push(X)}return C.aggregateFunction(v.name,Q)}g=this._evaluateNode(v.args,Q,g,f,l);return I.evaluateFunction(v.name,g,this.timeZone)}throw new M.SqlError(M.SqlErrorCodes.UnsupportedSyntax,{node:v.type});}}var U;(function(v){v[v.Normal=0]="Normal";v[v.Escaped=1]="Escaped"})(U||={});const T={getAttribute(v,Q){return(v&&"object"===typeof v.attributes?v.attributes:
v)[Q]}};e.WhereClause=ca;e.defaultAttributeAdapter=T;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(e,k,y,C){function r(w,x,I){return w<x?w-x:w>I?w-I:0}function M(w,x=!0){if(w instanceof C.Zone)return w;if("system"===w.toLowerCase())return"system";if("utc"===w.toLowerCase())return"UTC";if("unknown"===w.toLowerCase())return y.UnknownTimeZone.instance;
if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(w)){const I=C.FixedOffsetZone.parseSpecifier("UTC"+(w.startsWith("+")||w.startsWith("-")?"":"+")+w);if(I)return I}w=C.IANAZone.create(w);if(!w.isValid){if(x)throw new p(e.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return w}e.ArcadeDateErrorCodes=void 0;(e.ArcadeDateErrorCodes||(e.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const a={[e.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};
class p extends Error{constructor(w,x){super(k.replace(a[w],x));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,p)}}class h{constructor(w){this._date=w;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(w=0,x=1,I=1,F=0,t=0,J=0,K=0,u){if(isNaN(w)||isNaN(x)||isNaN(I)||isNaN(F)||isNaN(t)||isNaN(J)||isNaN(K))return null;const b=C.DateTime.local(w,x).daysInMonth;w=C.DateTime.fromObject({day:1>I?1:I>b?b:I,year:w,month:1>x?1:12<
x?12:x,hour:0>F?0:23<F?23:F,minute:0>t?0:59<t?59:t,second:0>J?0:59<J?59:J,millisecond:0>K?0:999<K?999:K},{zone:M(u)});w=w.plus({months:r(x,1,12),days:r(I,1,b),hours:r(F,0,23),minutes:r(t,0,59),seconds:r(J,0,59),milliseconds:r(K,0,999)});return new h(w)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(w,x){x=M(x);return w.isUnknownTimeZone||x===y.UnknownTimeZone.instance?h.fromParts(w.year,w.monthJS+1,w.day,
w.hour,w.minute,w.second,w.millisecond,x):new h(w._date.setZone(x))}static dateJSToArcadeDate(w){return new h(C.DateTime.fromJSDate(w,{zone:"system"}))}static dateJSAndZoneToArcadeDate(w,x="system"){x=M(x);return new h(C.DateTime.fromJSDate(w,{zone:x}))}static unknownEpochToArcadeDate(w){return new h(C.DateTime.fromMillis(w,{zone:y.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(w){return new h(C.DateTime.fromMillis(w.getTime(),{zone:y.UnknownTimeZone.instance}))}static epochToArcadeDate(w,
x="system"){x=M(x);return new h(C.DateTime.fromMillis(w,{zone:x}))}static dateTimeToArcadeDate(w){return new h(w)}clone(){return new h(this._date)}changeTimeZone(w){w=M(w);return h.dateTimeToArcadeDate(this._date.setZone(w))}static dateTimeAndZoneToArcadeDate(w,x){x=M(x);return w.zone===y.UnknownTimeZone.instance||x===y.UnknownTimeZone.instance?h.fromParts(w.year,w.month,w.day,w.hour,w.minute,w.second,w.millisecond,x):new h(w.setZone(x))}static nowToArcadeDate(w){w=M(w);return new h(C.DateTime.fromJSDate(new Date,
{zone:w}))}static nowUTCToArcadeDate(){return new h(C.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===h.systemTimeZoneCanonicalName}equals(w){return this.isSystem&&w.isSystem?this.toNumber()===w.toNumber():this.isUnknownTimeZone!==w.isUnknownTimeZone?!1:this._date.equals(w._date)}get isUnknownTimeZone(){return this._date.zone===y.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let w=
this._date.weekday;6<w&&(w=0);return w}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const w=this.zone;return"fixed"===w.type?0===w.fixed?"UTC":w.formatOffset(0,"short"):w.name}stringify(){return JSON.stringify(this.toJSDate())}plus(w){return new h(this._date.plus(w))}diff(w,x="milliseconds"){return this._date.diff(w._date,x)[x]}toISODate(){return this._date.toISODate()}toISOString(w){return w?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(w,x){return this._date.toISOTime({suppressMilliseconds:w,
includeOffset:x&&!this.isUnknownTimeZone})}toFormat(w,x){this.isUnknownTimeZone&&(w=w.replaceAll("Z",""));return this._date.toFormat(w,x)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new h(this._date.toUTC())}toLocal(){return new h(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(w){if(!w)return null;
w=C.DateTime.fromISO(w,{setZone:!0});return new h(w)}}e.ArcadeDate=h;e.ArcadeDateError=p;e.arcadeDateErrorMessages=a;e.createDateTimeZone=M;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(e,k){function y(r){return r instanceof k.Zone?r===C.instance?!0:!1:"unknown"===r?.toString().toLowerCase()?!0:!1}class C{}C.instance=new k.IANAZone("Etc/UTC");e.UnknownTimeZone=C;e.adoptTimeZone=function(r,
M){return k.DateTime.fromObject({day:r.day,year:r.year,month:r.month,hour:r.hour,minute:r.minute,second:r.second,millisecond:r.millisecond},{zone:M})};e.isUnknownTimeZone=y;e.substituteUnknownTimezone=function(r){return y(r)?C.instance:r};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ./DateOnly ./errorSupport ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(e,k,y,C,r,M){function a(x){if(null===
x)return null;let I=0,F=0;for(let t=0;t<x.length;t++){const J=x[t];if(null!==J){if("number"!==typeof J)throw new y.SqlError(y.SqlErrorCodes.InvalidValueForAggregateFunction);F++;I+=J}}return 0===F?null:I/x.length}function p(x,I){if(null===x)return null;let F=null,t=null;for(const J of x)x=J,x=J instanceof k.DateOnly?J.toNumber():J instanceof r.TimeOnly?J.toNumber():J instanceof M.DateTime?J.toMillis():J instanceof C.SqlTimeStampOffset?J.toMilliseconds():J,null===F?(F=J,t=x):"max"===I&&null!==t&&null!==
x&&t<=x?(F=J,t=x):"min"===I&&null!==t&&null!==x&&t>=x&&(F=J,t=x);return F}function h(x){if(null===x)return null;x=x.filter(t=>null!==t);if(0===x.length)return null;const I=a(x);if(null===I)return null;let F=0;for(const t of x){if("number"!==typeof t)throw new y.SqlError(y.SqlErrorCodes.InvalidValueForAggregateFunction);F+=(I-t)**2}return F/(x.length-1)}const w={min:{minParams:1,maxParams:1,evaluate:x=>p(x[0],"min")},max:{minParams:1,maxParams:1,evaluate:x=>p(x[0],"max")},avg:{minParams:1,maxParams:1,
evaluate:x=>a(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];if(null===x)x=null;else{var I=0;for(let F=0;F<x.length;F++){const t=x[F];if(null!==t){if("number"!==typeof t)throw new y.SqlError(y.SqlErrorCodes.InvalidValueForAggregateFunction);I+=t}}x=I}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];null===x?x=null:(x=h(x),x=null===x?null:Math.sqrt(x));return x}},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>
h(x[0])}};e.aggregateFunction=function(x,I){const F=w[x.toLowerCase()];if(null==F)throw new y.SqlError(y.SqlErrorCodes.FunctionNotRecognized);if(I.length<F.minParams||I.length>F.maxParams)throw new y.SqlError(y.SqlErrorCodes.InvalidParameterCount,{name:x.toUpperCase()});return F.evaluate(I)};e.isAggregate=function(x,I){x=w[x.toLowerCase()];return null!=x&&I>=x.minParams&&I<=x.maxParams};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(e,k,y,C){function r(a){a=a.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let p="";const h=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const w of a.match(h)||[])switch(w){case "D":p+="d";break;case "DD":p+="dd";break;case "DDD":p+="o";break;case "d":p+="c";break;case "ddd":p+=
"ccc";break;case "dddd":p+="cccc";break;case "M":p+="L";break;case "MM":p+="LL";break;case "MMM":p+="LLL";break;case "MMMM":p+="LLLL";break;case "YY":p+="yy";break;case "Y":case "YYYY":p+="yyyy";break;case "Q":p+="q";break;case "X":case "x":p+=w;break;default:p=2<=w.length&&"["===w.slice(0,1)&&"]"===w.slice(-1)?p+`'${w.slice(1,-1)}'`:p+`'${w}'`}return p}class M{constructor(a,p,h){this._year=a;this._month=p;this._day=h;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(a){return a instanceof M&&a.day===this.day&&a.month===this.month&&a.year===this.year}clone(){return new M(this._year,this._month,this._day)}toDateTime(a){return C.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:k.createDateTimeZone(a)})}toDateTimeLuxon(a){return C.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:k.createDateTimeZone(a)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(a=null,p=!0){if(null===a||""===a)return this.toString();p&&(a=r(a));if(!a)return"";p=this.toDateTime("unknown");return k.ArcadeDate.dateTimeToArcadeDate(p).toFormat(a,{locale:y.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const a=this.toDateTime("unknown");return k.ArcadeDate.dateTimeToArcadeDate(a)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(a,p){return M.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}toUTCDateTime(){return C.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(a){a=C.DateTime.fromMillis(a,{zone:C.FixedOffsetZone.utcInstance});return a.isValid?M.fromParts(a.year,a.month,a.day):null}static fromSeconds(a){a=C.DateTime.fromSeconds(a,{zone:C.FixedOffsetZone.utcInstance});return a.isValid?M.fromParts(a.year,a.month,a.day):null}static fromReader(a){if(!a)return null;a=a.split("-");return 3!==a.length?null:new M(parseInt(a[0],10),parseInt(a[1],
10),parseInt(a[2],10))}static fromParts(a,p,h){a=new M(a,p,h);return!1===a.isValid?null:a}static fromDateJS(a){return M.fromParts(a.getFullYear(),a.getMonth()+1,a.getDay())}static fromDateTime(a){return M.fromParts(a.year,a.month,a.day)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;var h=[];if(p)(p=r(p))&&h.push(p);else if(null===p||""===p)return a=C.DateTime.fromISO(a,{setZone:!0}),a.isValid?M.fromParts(a.year,
a.month,a.day):null;for(const w of h)if(h=C.DateTime.fromFormat(a,p??w),h.isValid)return new M(h.year,h.month,h.day);return null}static fromNow(a="system"){a=C.DateTime.fromJSDate(new Date).setZone(k.createDateTimeZone(a));return new M(a.year,a.month,a.day)}}e.DateOnly=M;e.standardizeDateOnlyFormat=r;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/errorSupport":function(){define(["exports","../string"],function(e,k){e.SqlErrorCodes=void 0;(function(r){r.InvalidFunctionParameters=
"InvalidFunctionParameters";r.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";r.UnsupportedSqlFunction="UnsupportedSqlFunction";r.UnsupportedOperator="UnsupportedOperator";r.UnsupportedSyntax="UnsupportedSyntax";r.UnsupportedIsRhs="UnsupportedIsRhs";r.UnsupportedIsLhs="UnsupportedIsLhs";r.InvalidDataType="InvalidDataType";r.CannotCastValue="CannotCastValue";r.FunctionNotRecognized="FunctionNotRecognized";r.InvalidTime="InvalidTime";r.InvalidParameterCount="InvalidParameterCount";
r.InvalidTimeStamp="InvalidTimeStamp";r.InvalidDate="InvalidDate";r.InvalidOperator="InvalidOperator";r.IllegalInterval="IllegalInterval";r.YearMonthIntervals="YearMonthIntervals";r.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";r.MissingStatisticParameters="MissingStatisticParameters"})(e.SqlErrorCodes||(e.SqlErrorCodes={}));const y={[e.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[e.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[e.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[e.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[e.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[e.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[e.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[e.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[e.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[e.SqlErrorCodes.InvalidDate]:"Invalid date encountered",[e.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[e.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[e.SqlErrorCodes.IllegalInterval]:"Illegal interval",[e.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[e.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[e.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[e.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",
[e.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",[e.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class C extends Error{constructor(r,M){super(k.replace(y[r],M));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,C)}}e.SqlError=C;e.sqlErrorMessages=y;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports",
"../../chunks/datetime"],function(e,k){function y(r){return Number.isNaN(r)||0===r?r:Math.trunc(r)}class C{constructor(r){this._timeStampOffset=r;this._date=null}toDateTime(){this._date??(this._date=k.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return y(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return y(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return C.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(r){return new C(k.DateTime.fromJSDate(r).toISO({includeOffset:!0}))}static fromDateTime(r){return new C(r.toISO({includeOffset:!0}))}static fromParts(r,
M,a=0,p=0,h=0,w=0,x=0,I=!1,F=0,t=0){r=`${r.toString().padStart(4,"0")}-${M.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}`;M="";10>w&&(M="0");p=`${p.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}:${M+w.toString()}`;0!==x&&(p+="."+x.toString().padStart(3,"0"));x=`${I?"-":"+"}${F.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return new C(r+"T"+p+x)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let r=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});r&&=r.replace(".000","");return r}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(r){r=this.toDateTime().plus(r);return C.fromDateTime(r)}}e.SqlTimeStampOffset=C;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(e,k,y,C){function r(a){if(!a)return"";const p=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let h="";for(const w of a.match(p)||
[])switch(w){case "SSS":h+=w;break;case "A":case "a":h+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":h+=w;break;default:h+=`'${w}'`}return h}class M{constructor(a,p,h,w){this._hour=a;this._minute=p;this._second=h;this._millisecond=w;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(a){return a instanceof M&&a.hour===
this.hour&&a.minute===this.minute&&a.second===this.second&&a.millisecond===this.millisecond}clone(){return new M(this.hour,this.minute,this.second,this.millisecond)}isValid(){return k.isInteger(this.hour)&&k.isInteger(this.minute)&&k.isInteger(this.second)&&k.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(a=null){return null===a||""===a?this.toString():(a=r(a))?C.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(a,{locale:y.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(a,p,h,w){a=new M(a,p,h,w);return a.isValid()?a:null}static fromReader(a){if(!a)return null;a=a.split(":");return 3!==a.length?null:new M(parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],
10),0)}static fromMilliseconds(a){return 864E5<a||0>a?null:new M(Math.floor(a/36E5%24),Math.floor(a/6E4%60),Math.floor(a/1E3%60),Math.floor(a%1E3))}static fromDateJS(a){return new M(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}static fromDateTime(a){return new M(a.hour,a.minute,a.second,a.millisecond)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;const h=[];if(p)(p=r(p))&&h.push(p);else if(null===
p||""===p)h.push("HH:mm:ss"),h.push("HH:mm:ss.SSS"),h.push("hh:mm:ss a"),h.push("hh:mm:ss.SSS a"),h.push("HH:mm"),h.push("hh:mm a"),h.push("H:mm"),h.push("h:mm a"),h.push("H:mm:ss"),h.push("h:mm:ss a"),h.push("H:mm:ss.SSS"),h.push("h:mm:ss.SSS a");for(const w of h)if(p=C.DateTime.fromFormat(a,w),p.isValid)return new M(p.hour,p.minute,p.second,p.millisecond);return null}plus(a,p){switch(a){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return M.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}return null}toUTCDateTime(){return C.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}}e.TimeOnly=M;e.standardizeTimeFormat=r;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(e,k){e.cloneGeometry=function(y){if(null==y)return null;const C=y.clone();void 0!==y.cache._geVersion&&(C.cache._geVersion=y.cache._geVersion);return C};e.convertLinearUnitsToCode=function(y){if(null==y)return null;if("number"===typeof y)return y;y=y.toLowerCase();y=y.replaceAll(/\s/g,"");y=y.replaceAll("-","");switch(y){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};e.convertSquareUnitsToCode=
function(y){if(null==y)return null;if("number"===typeof y)return y;y=y.toLowerCase();y=y.replaceAll(/\s/g,"");y=y.replaceAll("-","");switch(y){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};e.isInteger=function(y){return"number"===typeof y&&isFinite(y)&&Math.floor(y)===y};e.sameGeomType=function(y,C){return y===C||"point"===y&&"esriGeometryPoint"===C||"polyline"===y&&"esriGeometryPolyline"===
C||"polygon"===y&&"esriGeometryPolygon"===C||"extent"===y&&"esriGeometryEnvelope"===C||"multipoint"===y&&"esriGeometryMultipoint"===C||"point"===C&&"esriGeometryPoint"===y||"polyline"===C&&"esriGeometryPolyline"===y||"polygon"===C&&"esriGeometryPolygon"===y||"extent"===C&&"esriGeometryEnvelope"===y||"multipoint"===C&&"esriGeometryMultipoint"===y?!0:!1};e.shapeExtent=function(y){if(null==y)return null;switch(y.type){case "polygon":case "multipoint":case "polyline":return y.extent;case "point":return new k({xmin:y.x,
ymin:y.y,xmax:y.x,ymax:y.y,spatialReference:y.spatialReference});case "extent":return y}return null};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(e,k,y,C,r){function M(B,H,N){switch(N){case "+":return B+H;case "-":return B-H;case "*":return B*H;case "/":return B/H}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function a(B,
H,N){switch(N){case "+":return H.plus({milliseconds:B.valueInMilliseconds()});case "-":return B.valueInMilliseconds()-H.toMillis()}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function p(B,H,N){switch(N){case "+":return H.plus("milliseconds",B.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function h(B,H,N){switch(N){case "+":return H.plus("milliseconds",B.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function w(B,H,N){switch(N){case "+":return B.plus("milliseconds",
H.valueInMilliseconds());case "-":return B.plus("milliseconds",-1*H.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function x(B,H,N){switch(N){case "+":return H.addMilliseconds(B.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function I(B,H,N){switch(N){case "+":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()+H.valueInMilliseconds());case "-":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()-H.valueInMilliseconds());
case "*":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()*H.valueInMilliseconds());case "/":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()/H.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function F(B,H,N){switch(N){case "+":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()+H);case "-":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()-H);case "*":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()*
H);case "/":return C.SqlInterval.createFromMilliseconds(B.valueInMilliseconds()/H)}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function t(B,H,N){switch(N){case "+":return C.SqlInterval.createFromMilliseconds(B+H.valueInMilliseconds());case "-":return C.SqlInterval.createFromMilliseconds(B-H.valueInMilliseconds());case "*":return C.SqlInterval.createFromMilliseconds(B*H.valueInMilliseconds());case "/":return C.SqlInterval.createFromMilliseconds(B/H.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function J(B,H,N){switch(N){case "+":return B.plus("milliseconds",H.valueInMilliseconds());case "-":return B.plus("milliseconds",-1*H.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function K(B,H,N){switch(N){case "+":return B.plus({milliseconds:H.valueInMilliseconds()});case "-":return B.minus({milliseconds:H.valueInMilliseconds()})}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function u(B,H,N){switch(N){case "+":return B.addMilliseconds(H.valueInMilliseconds());
case "-":return B.addMilliseconds(-1*H.valueInMilliseconds())}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function b(B,H,N){H*=864E5;switch(N){case "+":return B.plus({milliseconds:H});case "-":return B.minus({milliseconds:H})}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function q(B,H,N){H*=864E5;switch(N){case "+":return B.plus("milliseconds",H);case "-":return B.plus("milliseconds",-1*H)}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function L(B,H,N){H*=864E5;switch(N){case "+":return B.plus("milliseconds",
H);case "-":return B.plus("milliseconds",-1*H)}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function d(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function G(B,H,N){H*=864E5;switch(N){case "+":return B.addMilliseconds(H);case "-":return B.addMilliseconds(-1*H)}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function P(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function S(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function ca(B,
H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function U(B,H,N){H=parseFloat(H);if(isNaN(H))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);return M(B,H,N)}function T(B,H,N){B=parseFloat(B);if(isNaN(B))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);return M(B,H,N)}function v(B,H,N){switch(N){case "+":return B+H}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function Q(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function g(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function f(B,H,N){switch(N){case "-":return B.toDateTimeLuxon(H.zone).diff(H).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function l(B,H,N){switch(N){case "-":return B.toDateTimeLuxon(H.toDateTime().zone).diff(H.toDateTime()).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function z(B,H,N){switch(N){case "-":return B.toDateTimeLuxon("UTC").diff(H.toDateTimeLuxon("UTC")).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function O(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function X(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function ba(B,H,N){switch(N){case "-":return B.toDateTime().diff(H.toDateTimeLuxon(B.toDateTime().zone)).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function fa(B,H,N){switch(N){case "-":return B.toDateTime().diff(H).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function na(B,H,N){switch(N){case "-":return B.toDateTime().diff(H.toDateTime()).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function oa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function pa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function sa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function wa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function xa(B,H,N){switch(N){case "-":return B.diff(H).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function Da(B,H,N){switch(N){case "-":return B.diff(H.toDateTimeLuxon(B.zone)).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function Ea(B,H,N){switch(N){case "-":return B.diff(H.toDateTime()).as("days")}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function Ja(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function Sa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function ab(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function La(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function m(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}function E(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function W(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function aa(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}function ja(B,H,N){throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}e.calculateDateOnlyAndDateOnly=z;e.calculateDateOnlyAndDateTime=f;e.calculateDateOnlyAndNumber=q;e.calculateDateOnlyAndSqlInterval=J;e.calculateDateOnlyAndString=Sa;e.calculateDateOnlyAndTimeOnly=O;e.calculateDateOnlyAndTimestamp=
l;e.calculateDateTimeAndDateOnly=Da;e.calculateDateTimeAndDateTime=xa;e.calculateDateTimeAndNumber=b;e.calculateDateTimeAndSqlInterval=K;e.calculateDateTimeAndString=La;e.calculateDateTimeAndTimeOnly=Ja;e.calculateDateTimeAndTimestamp=Ea;e.calculateNumberAndDateOnly=ca;e.calculateNumberAndDateTime=d;e.calculateNumberAndNumber=M;e.calculateNumberAndSqlInterval=t;e.calculateNumberAndString=U;e.calculateNumberAndTimeOnly=S;e.calculateNumberAndTimestamp=P;e.calculateSqlIntervalAndDateOnly=h;e.calculateSqlIntervalAndDateTime=
a;e.calculateSqlIntervalAndNumber=F;e.calculateSqlIntervalAndSqlInterval=I;e.calculateSqlIntervalAndString=Q;e.calculateSqlIntervalAndTimeOnly=p;e.calculateSqlIntervalAndTimestamp=x;e.calculateStringAndDateOnly=W;e.calculateStringAndDateTime=aa;e.calculateStringAndNumber=T;e.calculateStringAndSqlInterval=g;e.calculateStringAndString=v;e.calculateStringAndTimeOnly=E;e.calculateStringAndTimestamp=ja;e.calculateTimeOnlyAndDateOnly=pa;e.calculateTimeOnlyAndDateTime=oa;e.calculateTimeOnlyAndNumber=L;e.calculateTimeOnlyAndSqlInterval=
w;e.calculateTimeOnlyAndString=ab;e.calculateTimeOnlyAndTimeOnly=wa;e.calculateTimeOnlyAndTimestamp=sa;e.calculateTimestampAndDateOnly=ba;e.calculateTimestampAndDateTime=fa;e.calculateTimestampAndNumber=G;e.calculateTimestampAndSqlInterval=u;e.calculateTimestampAndString=m;e.calculateTimestampAndTimeOnly=X;e.calculateTimestampAndTimestamp=na;e.sqlCalculateFunction=function(B,H,N,V){if("||"===B)return r.evaluateFunction("concat",[H,N],V);if(null===H||null===N)return null;if(y.isNumber(H)){if(y.isNumber(N))return M(H,
N,B);if(y.isSqlInterval(N))return t(H,N,B);if(y.isTimeOnly(N))return S();if(y.isDateOnly(N))return ca();if(y.isTimestampOffset(N))return P();if(y.isDateTime(N))return d();if(y.isString(N))return U(H,N,B)}else if(y.isDateOnly(H)){if(y.isNumber(N))return q(H,N,B);if(y.isSqlInterval(N))return J(H,N,B);if(y.isTimeOnly(N))return O();if(y.isDateOnly(N))return z(H,N,B);if(y.isTimestampOffset(N))return l(H,N,B);if(y.isDateTime(N))return f(H,N,B);if(y.isString(N))return Sa()}else if(y.isTimeOnly(H)){if(y.isNumber(N))return L(H,
N,B);if(y.isSqlInterval(N))return w(H,N,B);if(y.isTimeOnly(N))return wa();if(y.isDateOnly(N))return pa();if(y.isTimestampOffset(N))return sa();if(y.isDateTime(N))return oa();if(y.isString(N))return ab()}else if(y.isSqlInterval(H)){if(y.isNumber(N))return F(H,N,B);if(y.isSqlInterval(N))return I(H,N,B);if(y.isTimeOnly(N))return p(H,N,B);if(y.isDateOnly(N))return h(H,N,B);if(y.isTimestampOffset(N))return x(H,N,B);if(y.isDateTime(N))return a(H,N,B);if(y.isString(N))return Q()}else if(y.isDateTime(H)){if(y.isNumber(N))return b(H,
N,B);if(y.isSqlInterval(N))return K(H,N,B);if(y.isTimeOnly(N))return Ja();if(y.isDateOnly(N))return Da(H,N,B);if(y.isTimestampOffset(N))return Ea(H,N,B);if(y.isDateTime(N))return xa(H,N,B);if(y.isString(N))return La()}else if(y.isTimestampOffset(H)){if(y.isNumber(N))return G(H,N,B);if(y.isSqlInterval(N))return u(H,N,B);if(y.isTimeOnly(N))return X();if(y.isDateOnly(N))return ba(H,N,B);if(y.isTimestampOffset(N))return na(H,N,B);if(y.isDateTime(N))return fa(H,N,B);if(y.isString(N))return m()}else if(y.isString(H)){if(y.isNumber(N))return T(H,
N,B);if(y.isSqlInterval(N))return g();if(y.isTimeOnly(N))return E();if(y.isDateOnly(N))return W();if(y.isTimestampOffset(N))return ja();if(y.isDateTime(N))return aa();if(y.isString(N))return v(H,N,B)}throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ./DateOnly ./errorSupport ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(e,k,y,C,r,M,a,p){function h(b,q,L){L=t.exec(b);if(null!==L){const [,d,G,P,S,ca,U,T]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(P,10),hour:parseInt(S,10),minute:parseInt(ca,10),second:parseInt(U,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);return b}L=J.exec(b);if(null!==L){const [,d,G,P,S,ca,U,T,v,Q,g]=L;b=r.SqlTimeStampOffset.fromParts(parseInt(d,
10),parseInt(G,10),parseInt(P,10),parseInt(S,10),parseInt(ca,10),parseInt(U,10),T?parseInt(T.replace(".",""),10):0,"-"===v,parseInt(Q,10),parseInt(g,10));if(!1===b.isValid)throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);return b}L=K.exec(b);if(null!==L){const [,d,G,P,S,ca,U,T,v]=L;b=r.SqlTimeStampOffset.fromParts(parseInt(d,10),parseInt(G,10),parseInt(P,10),parseInt(S,10),parseInt(ca,10),0,0,"-"===U,parseInt(T,10),parseInt(v,10));if(!1===b.isValid)throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);
return b}L=u.exec(b);if(null!==L){const [,d,G,P,S,ca]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(P,10),hour:parseInt(S,10),minute:parseInt(ca,10),second:0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);return b}L=F.exec(b);if(null!==L){const [,d,G,P]=L;b=p.DateTime.fromObject({year:parseInt(d,10),month:parseInt(G,10),day:parseInt(P,10),hour:0,minute:0,second:0},{zone:a.substituteUnknownTimezone(q)});
if(!1===b.isValid)throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);return b}throw new y.SqlError(y.SqlErrorCodes.InvalidTimeStamp);}const w=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,x=/^(\d{1,2}):(\d{1,2})$/,I=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,t=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,J=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,K=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;e.convertToExecutingTimeZone=function(b,q){if(q instanceof p.Zone)return q===a.UnknownTimeZone.instance?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q});switch(q){case "system":case "local":case null:return p.DateTime.fromJSDate(b);default:return"unknown"===q?.toLowerCase()?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q})}};e.isDate=function(b){return b instanceof
Date};e.isDateOnly=function(b){return b instanceof k.DateOnly};e.isDateTime=function(b){return b instanceof p.DateTime};e.isNumber=function(b){return"number"===typeof b};e.isSqlInterval=function(b){return b instanceof C.SqlInterval};e.isString=function(b){return"string"===typeof b||b instanceof String};e.isTimeOnly=function(b){return b instanceof M.TimeOnly};e.isTimestampOffset=function(b){return b instanceof r.SqlTimeStampOffset};e.parseDate=function(b,q){const L=F.exec(b);if(null===L)try{return h(b,
q)}catch{throw new y.SqlError(y.SqlErrorCodes.InvalidDate);}const [,d,G,P]=L;b=k.DateOnly.fromParts(parseInt(d,10),parseInt(G,10),parseInt(P,10));if(null===b)throw new y.SqlError(y.SqlErrorCodes.InvalidDate);return b};e.parseTime=function(b){let q=w.exec(b);if(null!==q){const [,L,d,G]=q;b=M.TimeOnly.fromParts(parseInt(L,10),parseInt(d,10),parseInt(G,10),0);if(null!==b)return b;throw new y.SqlError(y.SqlErrorCodes.InvalidTime);}q=x.exec(b);if(null!==q){const [,L,d]=q;b=M.TimeOnly.fromParts(parseInt(L,
10),parseInt(d,10),0,0);if(null!==b)return b;throw new y.SqlError(y.SqlErrorCodes.InvalidTime);}q=I.exec(b);if(null!==q){const [,L,d,G,P]=q;b=M.TimeOnly.fromParts(parseInt(L,10),parseInt(d,10),parseInt(G,10),parseInt(P,10));if(null!==b)return b}throw new y.SqlError(y.SqlErrorCodes.InvalidTime);};e.parseTimestamp=h;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","./errorSupport"],function(e,k){class y{constructor(){this.op="+";
this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(C){if(null!==C.precision||null!==C.secondary)throw new k.SqlError(k.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(C,r){r.includes(".")?(r=r.split("."),C.second=parseFloat(r[0]),C.millis=parseInt(r[1],10)):C.second=parseFloat(r)}static createFromMilliseconds(C){const r=new y;r.second=C/1E3;return r}static createFromValueAndQualifier(C,r,M){let a=null;const p=new y;p.op="-"===
M?"-":"+";if("interval-period"===r.type){y._fixDefaults(r);M=RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new k.SqlError(k.SqlErrorCodes.YearMonthIntervals);if("second"===r.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(C))y._parseSecondsComponent(p,C);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);else if(M.test(C))p[r.period]=parseFloat(C);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);}else{y._fixDefaults(r.start);y._fixDefaults(r.end);if("year"===
r.start.period||"month"===r.start.period||"year"===r.end.period||"month"===r.end.period)throw new k.SqlError(k.SqlErrorCodes.YearMonthIntervals);switch(r.start.period){case "day":switch(r.end.period){case "hour":a=RegExp("^[0-9]{1,} [0-9]{1,}$");if(a.test(C))p[r.start.period]=parseFloat(C.split(" ")[0]),p[r.end.period]=parseFloat(C.split(" ")[1]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;case "minute":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(a.test(C))p[r.start.period]=
parseFloat(C.split(" ")[0]),C=C.split(" ")[1].split(":"),p.hour=parseFloat(C[0]),p.minute=parseFloat(C[1]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(C))p[r.start.period]=parseFloat(C.split(" ")[0]),C=C.split(" ")[1].split(":"),p.hour=parseFloat(C[0]),p.minute=parseFloat(C[1]),y._parseSecondsComponent(p,C[2]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;default:throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(r.end.period){case "minute":a=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(a.test(C))p.hour=parseFloat(C.split(":")[0]),p.minute=parseFloat(C.split(":")[1]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(C))C=C.split(":"),p.hour=parseFloat(C[0]),p.minute=parseFloat(C[1]),y._parseSecondsComponent(p,C[2]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;default:throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(r.end.period){case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(C))C=C.split(":"),p.minute=parseFloat(C[0]),y._parseSecondsComponent(p,C[1]);else throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);break;default:throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);}break;default:throw new k.SqlError(k.SqlErrorCodes.IllegalInterval);}}return p}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}e.SqlInterval=y;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../mathUtils ../string ./DateOnly ./errorSupport ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(e,k,y,C,r,M,a,p,h){function w(u){return"string"===typeof u||u instanceof String}function x(u){return a.isDate(u)||a.isDateOnly(u)||a.isDateTime(u)||
a.isTimeOnly(u)||a.isTimestampOffset(u)?!1:!0}function I(u){return a.isDateOnly(u)||a.isTimeOnly(u)?u.toString():a.isTimestampOffset(u)?u.toSQLValue():a.isDateTime(u)?0===u.millisecond?u.toFormat("yyyy-LL-dd HH:mm:ss"):u.toSQL({includeOffset:!1}):a.isDate(u)?I(h.DateTime.fromJSDate(u)):u.toString()}function F(u){if(a.isDate(u))return C.DateOnly.fromDateJS(u);if(a.isDateTime(u))return C.DateOnly.fromParts(u.year,u.month,u.day);if(a.isDateOnly(u))return u;if(a.isTimeOnly(u))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
if(a.isTimestampOffset(u)&&null===C.DateOnly.fromParts(u.year,u.month,u.day))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(w(u)&&(u=C.DateOnly.fromReader(u),null!==u&&u.isValid))return u;throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function t(u,b,q){if(a.isDate(u))return a.convertToExecutingTimeZone(u,b);if(a.isDateTime(u))return u;if(a.isDateOnly(u))return u.toDateTimeLuxon("unknown");if(a.isTimeOnly(u))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(a.isTimestampOffset(u))return u;
if(w(u))return a.parseTimestamp(u,"unknown",q);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function J(u){if(a.isDate(u))return p.TimeOnly.fromDateJS(u);if(a.isDateTime(u))return p.TimeOnly.fromDateTime(u);if(a.isDateOnly(u))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(a.isTimeOnly(u))return u;if(a.isTimestampOffset(u))return p.TimeOnly.fromSqlTimeStampOffset(u);if(w(u))return a.parseTime(u);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}const K={extract:{minParams:2,
maxParams:2,evaluate:([u,b])=>{if(null==b)return null;if(a.isDate(b))switch(u.toUpperCase()){case "SECOND":return b.getSeconds();case "MINUTE":return b.getMinutes();case "HOUR":return b.getHours();case "DAY":return b.getDate();case "MONTH":return b.getMonth()+1;case "YEAR":return b.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(a.isDateTime(b))switch(u.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;
case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isDateOnly(b))switch(u.toUpperCase()){case "DAY":return b.day;case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isTimeOnly(b))switch(u.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour}else if(a.isTimestampOffset(b))switch(u.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;case "MONTH":return b.month;
case "YEAR":return b.year;case "TIMEZONE_HOUR":return b.timezoneOffsetHour;case "TIMEZONE_MINUTE":return b.timezoneOffsetMinutes}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:u=>{if(2===u.length){const [b,q]=u;return null==b||null==q?null:b.toString().substring(q-1)}if(3===u.length){const [b,q,L]=u;return null==b||null==q||null==L?null:0>=L?"":b.toString().substring(q-1,q+L-1)}}},position:{minParams:2,maxParams:2,
evaluate:([u,b])=>null==u||null==b?null:b.indexOf(u)+1},trim:{minParams:2,maxParams:3,evaluate:u=>{var b=3===u.length,q=b?u[1]:" ";b=b?u[2]:u[1];if(null==q||null==b)return null;q=`(${y.escapeRegExpString(q)})`;switch(u[0]){case "BOTH":return b.replaceAll(new RegExp(`^${q}*|${q}*$`,"g"),"");case "LEADING":return b.replaceAll(new RegExp(`^${q}*`,"g"),"");case "TRAILING":return b.replaceAll(new RegExp(`${q}*$`,"g"),"")}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.abs(u[0])},ceiling:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.ceil(u[0])},floor:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.floor(u[0])},log:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.log(u[0])},log10:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.log(u[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.sin(u[0])},cos:{minParams:1,maxParams:1,evaluate:u=>
null==u[0]?null:Math.cos(u[0])},tan:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.tan(u[0])},asin:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.asin(u[0])},acos:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.acos(u[0])},atan:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.atan(u[0])},sign:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:0<u[0]?1:0>u[0]?-1:0},power:{minParams:2,maxParams:2,evaluate:u=>null==u[0]||null==u[1]?null:u[0]**u[1]},mod:{minParams:2,
maxParams:2,evaluate:u=>null==u[0]||null==u[1]?null:u[0]%u[1]},round:{minParams:1,maxParams:2,evaluate:u=>{const b=u[0];u=2===u.length?10**u[1]:1;return null==b?null:Math.round(b*u)/u}},truncate:{minParams:1,maxParams:2,evaluate:u=>null==u[0]?null:1===u.length||0===u[1]?Math.trunc(u[0]):k.decimalAdjust("trunc",u[0],-Number(u[1]))},char_length:{minParams:1,maxParams:1,evaluate:u=>w(u[0])?u[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:u=>{let b="";for(let q=0;q<u.length;q++){if(null==
u[q])return null;b+=u[q].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:u[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:u=>{for(const b of u)if(null!==b)return b;return null}},cosh:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.cosh(u[0])},sinh:{minParams:1,maxParams:1,evaluate:u=>null==u[0]?null:Math.sinh(u[0])},tanh:{minParams:1,
maxParams:1,evaluate:u=>null==u[0]?null:Math.tanh(u[0])},nullif:{minParams:2,maxParams:2,evaluate:(u,b)=>M.sqlCompare(u[0],u[1],"\x3d")?null:u[0]},cast:{minParams:2,maxParams:2,evaluate:(u,b)=>{const q=u[0];u=u[1];if(null===q)return null;switch(u.type){case "integer":if(!x(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);b=parseInt(q,10);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "smallint":if(!x(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
b=parseInt(q,10);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(32767<b||-32767>b)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "float":case "real":if(!x(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);b=parseFloat(q);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "time":return J(q);case "date":return F(q);case "timestamp":return t(q,b,!0===u.withtimezone);case "varchar":b=I(q);if(b.length>u.size)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
return b;default:throw new r.SqlError(r.SqlErrorCodes.InvalidDataType);}}}};e.evaluateFunction=function(u,b,q){const L=K[u.toLowerCase()];if(null==L)throw new r.SqlError(r.SqlErrorCodes.FunctionNotRecognized);if(b.length<L.minParams||b.length>L.maxParams)throw new r.SqlError(r.SqlErrorCodes.InvalidParameterCount,{name:u.toUpperCase()});return L.evaluate(b,q)};e.isStandardized=function(u,b){u=K[u.toLowerCase()];return null!=u&&b>=u.minParams&&b<=u.maxParams};Object.defineProperty(e,Symbol.toStringTag,
{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ./errorSupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),function(e,k,y,C,r,M){function a(K){return y.isDateTime(K)||y.isTimestampOffset(K)?!0:!1}function p(K){return y.isDateTime(K)||y.isDateOnly(K)||y.isTimestampOffset(K)||y.isTimeOnly(K)?!0:!1}function h(K){if(y.isDateTime(K))return K.toMillis();if(y.isDateOnly(K))return K.toNumber();if(y.isTimestampOffset(K))return K.toMilliseconds();
throw new k.SqlError(k.SqlErrorCodes.InvalidDataType);}function w(K,u,b){switch(b){case "\x3c\x3e":return K!==u;case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}}function x(K,u,b){const q=parseFloat(u);if(!isNaN(q))return w(K,q,b);K=K.toString();switch(b){case "\x3c\x3e":return K!==u;case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}}function I(K,
u,b){const q=parseFloat(K);if(!isNaN(q))return w(q,u,b);u=u.toString();switch(b){case "\x3c\x3e":return K!==u;case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}}function F(K,u,b){switch(b){case "\x3c\x3e":return K!==u;case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}}function t(K,u,b){K instanceof C.SqlTimeStampOffset&&(K=K.toDateTime());u instanceof
C.SqlTimeStampOffset&&(u=u.toDateTime());K=J(K);u=J(u);switch(b){case "\x3c\x3e":return K!==u;case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}}function J(K){return 321408E5*K.year+26784E5*K.month+864E5*K.day+36E5*K.hour+6E4*K.minute+1E3*K.second+K.millisecond}e.dateValueInMilliseconds=h;e.isDateOrTimeValue=p;e.isDateTimeComparableValue=a;e.sqlCompare=function(K,u,b,q){if(null==K||null==u)return null;if(y.isNumber(K)){if(y.isNumber(u))return w(K,
u,b);if(y.isString(u))return x(K,u,b);if(p(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}else if(y.isString(K)){if(y.isNumber(u))return I(K,u,b);if(y.isString(u))return F(K,u,b);if(y.isDateTime(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isTimeOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isTimestampOffset(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}else if(y.isDateTime(K)){if(a(u)){if(K instanceof M.DateTime&&r.isUnknownTimeZone(K.zone)){if(u instanceof M.DateTime&&!1===r.isUnknownTimeZone(u.zone)||u instanceof C.SqlTimeStampOffset)return t(K,u,b)}else if(u instanceof M.DateTime&&r.isUnknownTimeZone(u.zone)&&(K instanceof M.DateTime&&!1===r.isUnknownTimeZone(K.zone)||K instanceof C.SqlTimeStampOffset))return t(K,u,b);return w(h(K),h(u),b)}if(y.isString(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(u))return u=u.toDateTimeLuxon(K.zone),
K=K.startOf("day"),w(K.toMillis(),u.toMillis(),b);if(y.isTimeOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isNumber(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}else if(y.isDateOnly(K)){if(y.isTimestampOffset(u))return K=K.toDateTimeLuxon(u.toDateTime().zone),u=u.startOfDay(),w(K.toMillis(),u.toMilliseconds(),b);if(y.isDateTime(u))return K=K.toDateTimeLuxon(u.zone),u=u.startOf("day"),w(K.toMillis(),u.toMillis(),b);if(y.isString(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
if(y.isDateOnly(u))return w(K.toNumber(),u.toNumber(),b);if(y.isTimeOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isNumber(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}else if(y.isTimeOnly(K)){if(y.isTimeOnly(u))return w(K.toNumber(),u.toNumber(),b);if(y.isString(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isNumber(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(a(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);
}else if(y.isTimestampOffset(K)){if(a(u))return u instanceof M.DateTime&&r.isUnknownTimeZone(u.zone)?t(K,u,b):w(h(K),h(u),b);if(y.isString(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isDateOnly(u))return u=u.toDateTimeLuxon(K.toDateTime().zone),K=K.startOfDay(),w(K.toMilliseconds(),u.toMillis(),b);if(y.isTimeOnly(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);if(y.isNumber(u))throw new k.SqlError(k.SqlErrorCodes.InvalidOperator);}switch(b){case "\x3c\x3e":return K!==u;
case "\x3d":return K===u;case "\x3e":return K>u;case "\x3c":return K<u;case "\x3e\x3d":return K>=u;case "\x3c\x3d":return K<=u}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports"],function(e){function k(a,p,h,w){a=Error.call(this,a);Object.setPrototypeOf&&Object.setPrototypeOf(a,k.prototype);a.expected=p;a.found=h;a.location=w;a.name="SyntaxError";return a}function y(a,p,h){h=h||" ";if(a.length>p)return a;p-=a.length;h+=h.repeat(p);
return a+h.slice(0,p)}function C(a,p){function h(){return t(ka,n)}function w(A,D){D=void 0!==D?D:t(ka,n);throw new k(A,null,null,D);}function x(A,D){return{type:"literal",text:A,ignoreCase:D}}function I(A,D,R){return{type:"class",parts:A,inverted:D,ignoreCase:R}}function F(A){var D=Eb[A];if(!D){if(A>=Eb.length)var R=Eb.length-1;else for(R=A;!Eb[--R];);D=Eb[R];for(D={line:D.line,column:D.column};R<A;)10===a.charCodeAt(R)?(D.line++,D.column=1):D.column++,R++;Eb[A]=D}return D}function t(A,D,R){R=F(A);
var Y=F(D);return{source:Hd,start:{offset:A,line:R.line,column:R.column},end:{offset:D,line:Y.line,column:Y.column}}}function J(A){n<hb||(n>hb&&(hb=n,jc=[]),jc.push(A))}function K(){var A=n;ia();var D=b();D!==c?(ia(),ka=A,A=D):(n=A,A=c);return A}function u(){var A;var D=n;if(Ma()!==c){ia();var R=[];for(A=b();A!==c;){R.push(A);var Y=A=n;var ta=ia();var va=Xa();va!==c?(Y=ia(),Y=ta=[ta,va,Y]):(n=Y,Y=c);Y!==c?(Y=b(),Y===c?(n=A,A=c):A=Y):A=Y}A=ia();Y=Na();Y!==c?(ka=D,D=Ia(h(),...R)):(n=D,D=c)}else n=D,
D=c;return D}function b(){var A=n;var D=q();if(D!==c){var R=[];var Y=n;ia();var ta=V();if(ta!==c){ia();var va=q();va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)R.push(Y),Y=n,ia(),ta=V(),ta!==c?(ia(),va=q(),va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)):(n=Y,Y=c);ka=A;A=Ib(D,R)}else n=A,A=c;return A}function q(){var A=n;var D=L();if(D!==c){var R=[];var Y=n;ia();var ta=N();if(ta!==c){ia();var va=L();va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)}else n=
Y,Y=c;for(;Y!==c;)R.push(Y),Y=n,ia(),ta=N(),ta!==c?(ia(),va=L(),va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)):(n=Y,Y=c);ka=A;A=Ib(D,R)}else n=A,A=c;return A}function L(){var A=n;var D=H();if(D===c){D=n;if(33===a.charCodeAt(n)){var R=Id;n++}else R=c,0===ha&&J(Jd);if(R!==c){var Y=n;ha++;if(61===a.charCodeAt(n)){var ta=Kd;n++}else ta=c,0===ha&&J(Ld);ha--;ta===c?Y=void 0:(n=Y,Y=c);Y!==c?D=R=[R,Y]:(n=D,D=c)}else n=D,D=c}D!==c?(R=ia(),Y=L(),Y!==c?(ka=A,A={type:"unary-expression",location:h(),
operator:"NOT",expr:Y}):(n=A,A=c)):(n=A,A=c);if(A===c){D=n;A=S();if(A!==c){R=n;ia();Y=n;ta=[];var va=n;ia();var Ga=d();if(Ga!==c){ia();var Ta=S();Ta!==c?(ka=va,va={op:Ga,expr:Ta,location:h()}):(n=va,va=c)}else n=va,va=c;if(va!==c)for(;va!==c;)ta.push(va),va=n,ia(),Ga=d(),Ga!==c?(ia(),Ta=S(),Ta!==c?(ka=va,va={op:Ga,expr:Ta,location:h()}):(n=va,va=c)):(n=va,va=c);else ta=c;ta!==c&&(ka=Y,ta={type:"arithmetic",tail:ta});Y=ta;if(Y===c&&(Y=n,ta=P(),ta!==c?(ia(),va=u(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=
Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=P(),ta!==c?(ia(),va=X(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c)),Y===c)){Y=n;ta=H();if(ta!==c)if(ia(),va=Z(),va!==c){var Jb=ia();Ga=n;Ta=S();if(Ta!==c){ia();var db=N();db!==c?(ia(),ta=S(),ta!==c?(ka=Ga,Ga=Ta,Ga=Ia(h(),Ga,ta)):(n=Ga,Ga=c)):(n=Ga,Ga=c)}else n=Ga,Ga=c;Ga!==c?(ka=Y,Y={op:"NOT"+va,right:Ga}):(n=Y,Y=c)}else n=Y,Y=c;else n=Y,Y=c;Y===c&&(Y=n,ta=Z(),ta!==c?(ia(),va=n,Jb=S(),Jb!==c?(Ga=ia(),Ta=N(),Ta!==c?(ia(),db=S(),db!==c?(ka=va,va=Jb,Ga=db,
va=Ia(h(),va,Ga)):(n=va,va=c)):(n=va,va=c)):(n=va,va=c),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c));Y===c&&(Y=n,ta=ja(),ta!==c?(ia(),va=H(),va!==c?(ia(),va=S(),va!==c?(ka=Y,Y={op:ta+"NOT",right:va}):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=ja(),ta!==c?(ia(),va=S(),va!==c?(ka=Y,Y={op:ta,right:va}):(n=Y,Y=c)):(n=Y,Y=c)),Y===c&&(Y=n,ta=G(),ta!==c?(ia(),va=xa(),va!==c?(ia(),Ga=n,Ta=a.substr(n,6),Ta.toLowerCase()===Md?n+=6:(Ta=c,0===ha&&J(Nd)),Ta!==c?(Ta=n,ha++,db=f(),ha--,db===c?Ta=void 0:
(n=Ta,Ta=c),Ta!==c?(ka=Ga,Ga="ESCAPE"):(n=Ga,Ga=c)):(n=Ga,Ga=c),Ga!==c?(ia(),Ga=Da(),Ga!==c?(ka=Y,Y={op:ta,right:va,escape:Ga.value}):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c)):(n=Y,Y=c),Y===c&&(Y=n,ta=G(),ta!==c?(ia(),va=xa(),va!==c?(ka=Y,Y={op:ta,right:va,escape:""}):(n=Y,Y=c)):(n=Y,Y=c))))}Y!==c?R=Y:(n=R,R=c);R===c&&(R=null);ka=D;D=R;""==D||void 0==D||null==D?D=A:(R=null,D=R="arithmetic"==D.type?Ib(A,D.tail):Kb(D.op,A,D.right,D.escape,h()))}else n=D,D=c;A=D}return A}function d(){if(a.substr(n,2)===fd){var A=
fd;n+=2}else A=c,0===ha&&J(Od);A===c&&(62===a.charCodeAt(n)?(A=Pd,n++):(A=c,0===ha&&J(Qd)),A===c&&(a.substr(n,2)===gd?(A=gd,n+=2):(A=c,0===ha&&J(Rd)),A===c&&(a.substr(n,2)===hd?(A=hd,n+=2):(A=c,0===ha&&J(Sd)),A===c&&(A=a.charAt(n),Td.test(A)?n++:(A=c,0===ha&&J(Ud)),A===c&&(a.substr(n,2)===id?(A=id,n+=2):(A=c,0===ha&&J(Vd)))))));return A}function G(){var A;var D=A=n;var R=H();if(R!==c){var Y=ia();var ta=B();ta!==c?D=R=[R,Y,ta]:(n=D,D=c)}else n=D,D=c;D!==c&&(ka=A,D=D[0]+" "+D[2]);A=D;A===c&&(A=B());
return A}function P(){var A;var D=A=n;var R=H();if(R!==c){var Y=ia();var ta=aa();ta!==c?D=R=[R,Y,ta]:(n=D,D=c)}else n=D,D=c;D!==c&&(ka=A,D=D[0]+" "+D[2]);A=D;A===c&&(A=aa());return A}function S(){var A=n;var D=U();if(D!==c){var R=[];var Y=n;ia();var ta=ca();if(ta!==c){ia();var va=U();va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)R.push(Y),Y=n,ia(),ta=ca(),ta!==c?(ia(),va=U(),va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)):(n=Y,Y=c);ka=A;A=Ib(D,R)}else n=A,
A=c;return A}function ca(){var A=a.charAt(n);kc.test(A)?n++:(A=c,0===ha&&J(lc));A===c&&(a.substr(n,2)===jd?(A=jd,n+=2):(A=c,0===ha&&J(Wd)));return A}function U(){var A=n;var D=v();if(D!==c){var R=[];var Y=n;ia();var ta=T();if(ta!==c){ia();var va=v();va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)}else n=Y,Y=c;for(;Y!==c;)R.push(Y),Y=n,ia(),ta=T(),ta!==c?(ia(),va=v(),va!==c?(ka=Y,Y={op:ta,expr:va,location:h()}):(n=Y,Y=c)):(n=Y,Y=c);ka=A;A=Ib(D,R)}else n=A,A=c;return A}function T(){var A=a.charAt(n);
Xd.test(A)?n++:(A=c,0===ha&&J(Yd));return A}function v(){var A=Da();if(A===c){var D=n;var R=n;var Y=ab();if(Y!==c){var ta=La();if(ta!==c){var va=m();va!==c?(ka=R,R=parseFloat(Y+ta+va)):(n=R,R=c)}else n=R,R=c}else n=R,R=c;R===c&&(R=n,Y=ab(),Y!==c?(ta=La(),ta!==c?(ka=R,R=parseFloat(Y+ta)):(n=R,R=c)):(n=R,R=c),R===c&&(R=n,Y=ab(),Y!==c?(ta=m(),ta!==c?(ka=R,R=parseFloat(Y+ta)):(n=R,R=c)):(n=R,R=c),R===c&&(R=n,Y=ab(),Y!==c&&(ka=R,Y=parseFloat(Y)),R=Y)));var Ga=R;if(Ga!==c){var Ta=n;ha++;var Jb=g();ha--;
Jb===c?Ta=void 0:(n=Ta,Ta=c);Ta!==c?(ka=D,D={type:"number",location:h(),value:Ga}):(n=D,D=c)}else n=D,D=c;A=D;if(A===c){var db=n;var Fb=n;var Lb=a.substr(n,4);Lb.toLowerCase()===Zd?n+=4:(Lb=c,0===ha&&J($d));if(Lb!==c){var Mb=n;ha++;var ae=f();ha--;ae===c?Mb=void 0:(n=Mb,Mb=c);Mb!==c?Fb=Lb=[Lb,Mb]:(n=Fb,Fb=c)}else n=Fb,Fb=c;var mb=Fb;mb!==c&&(ka=db,mb={type:"boolean",location:h(),value:!0});db=mb;if(db===c){db=n;var Gb=n;var Nb=a.substr(n,5);Nb.toLowerCase()===be?n+=5:(Nb=c,0===ha&&J(ce));if(Nb!==
c){var Ob=n;ha++;var de=f();ha--;de===c?Ob=void 0:(n=Ob,Ob=c);Ob!==c?Gb=Nb=[Nb,Ob]:(n=Gb,Gb=c)}else n=Gb,Gb=c;mb=Gb;mb!==c&&(ka=db,mb={type:"boolean",location:h(),value:!1});db=mb}A=db;if(A===c){var ee=n;var Hb=n;var Pb=a.substr(n,4);Pb.toLowerCase()===fe?n+=4:(Pb=c,0===ha&&J(ge));if(Pb!==c){var Qb=n;ha++;var he=f();ha--;he===c?Qb=void 0:(n=Qb,Qb=c);Qb!==c?Hb=Pb=[Pb,Qb]:(n=Hb,Hb=c)}else n=Hb,Hb=c;var Ec=Hb;Ec!==c&&(ka=ee,Ec={type:"null",location:h(),value:null});A=Ec;if(A===c){var nb=n;if(ma()!==
c){ia();var mc=xa();mc!==c?(ka=nb,"string"===mc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(mc.value)&&w("Date literal is invalid"),nb={type:"date",location:h(),value:mc.value}):(n=nb,nb=
c)}else n=nb,nb=c;A=nb;if(A===c){var ob=n;if(la()!==c){ia();var nc=xa();nc!==c?(ka=ob,"string"===nc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(nc.value)&&w("Timestamp literal is invalid"),
ob={type:"timestamp",location:h(),value:nc.value}):(n=ob,ob=c)}else n=ob,ob=c;A=ob;if(A===c){var Ya=n;var Fc=qa();if(Fc!==c){ia();var pb=a.charAt(n);kc.test(pb)?n++:(pb=c,0===ha&&J(lc));if(pb!==c){ia();var Rb=xa();if(Rb!==c){ia();var kd=oa();if(kd!==c){ka=Ya;var ie=pb,je=Rb;Ya={type:"interval",location:h(),value:je,qualifier:kd,op:ie}}else n=Ya,Ya=c}else n=Ya,Ya=c}else n=Ya,Ya=c}else n=Ya,Ya=c;if(Ya===c)if(Ya=n,Fc=qa(),Fc!==c)if(ia(),pb=xa(),pb!==c)if(ia(),Rb=oa(),Rb!==c){ka=Ya;var ke=pb,le=Rb;Ya=
{type:"interval",location:h(),value:ke,qualifier:le,op:""}}else n=Ya,Ya=c;else n=Ya,Ya=c;else n=Ya,Ya=c;A=Ya;if(A===c){var qb=n;if(ua()!==c){ia();var oc=xa();oc!==c?(ka=qb,"string"===oc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(oc.value)&&w("Time literal is invalid"),qb={type:"time",location:h(),value:oc.value}):(n=qb,qb=c)}else n=qb,qb=c;A=qb}}}}}}}var Ka=A;if(Ka===c){var rb=n;if(ea()!==c){ia();var Oa=n;var Gc=Ma();if(Gc!==c){ia();
var Sb=na();if(Sb!==c){ia();var Hc=da();if(Hc!==c){ia();var Tb=b();if(Tb!==c){ia();var Ic=Na();if(Ic!==c){ka=Oa;var me=Sb,ne=Tb;Oa=Ia(h(),me,ne)}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c}else n=Oa,Oa=c;if(Oa===c)if(Oa=n,Gc=Ma(),Gc!==c)if(ia(),Sb=na(),Sb!==c)if(ia(),Hc=Xa(),Hc!==c)if(ia(),Tb=b(),Tb!==c)if(ia(),Ic=Na(),Ic!==c){ka=Oa;var oe=Sb,pe=Tb;Oa=Ia(h(),oe,pe)}else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;else n=Oa,Oa=c;if(Oa!==c){ka=rb;var qe=Oa;rb={type:"function",
location:h(),name:"extract",args:qe}}else n=rb,rb=c}else n=rb,rb=c;Ka=rb;if(Ka===c){var sb=n;var tb=n;var Jc=a.substr(n,9);Jc.toLowerCase()===re?n+=9:(Jc=c,0===ha&&J(se));if(Jc!==c){var pc=n;ha++;var te=f();ha--;te===c?pc=void 0:(n=pc,pc=c);pc!==c?(ka=tb,tb="SUBSTRING"):(n=tb,tb=c)}else n=tb,tb=c;if(tb!==c){ia();var Ha=n;var Kc=Ma();if(Kc!==c){ia();var Ub=b();if(Ub!==c){ia();var Lc=da();if(Lc!==c){ia();var Vb=b();if(Vb!==c){ia();var jb=n;var ub=n;var Mc=a.substr(n,3);Mc.toLowerCase()===ue?n+=3:(Mc=
c,0===ha&&J(ve));if(Mc!==c){var qc=n;ha++;var we=f();ha--;we===c?qc=void 0:(n=qc,qc=c);qc!==c?(ka=ub,ub="FOR"):(n=ub,ub=c)}else n=ub,ub=c;var rc=ub;if(rc!==c){var Nc=ia();var sc=b();sc!==c?(ia(),jb=sc):(n=jb,jb=c)}else n=jb,jb=c;jb===c&&(jb=null);rc=Na();if(rc!==c){ka=Ha;var xe=Ub,ye=Vb,ld=jb;Ha=Ia(h(),xe,ye,...(ld?[ld]:[]))}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c}else n=Ha,Ha=c;if(Ha===c)if(Ha=n,Kc=Ma(),Kc!==c)if(ia(),Ub=b(),Ub!==c)if(ia(),Lc=Xa(),Lc!==c)if(ia(),Vb=b(),Vb!==c)if(ia(),
jb=Xa(),jb!==c)if(rc=ia(),Nc=b(),Nc!==c)if(sc=Na(),sc!==c){ka=Ha;var ze=Ub,Ae=Vb,Be=Nc;Ha=Ia(h(),ze,Ae,Be)}else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;else n=Ha,Ha=c;if(Ha!==c){ka=sb;var Ce=Ha;sb={type:"function",location:h(),name:"substring",args:Ce}}else n=sb,sb=c}else n=sb,sb=c;Ka=sb;if(Ka===c){var vb=n;var wb=n;var Oc=a.substr(n,4);Oc.toLowerCase()===De?n+=4:(Oc=c,0===ha&&J(Ee));if(Oc!==c){var tc=n;ha++;var Fe=f();ha--;Fe===c?tc=void 0:(n=tc,tc=c);
tc!==c?(ka=wb,wb="TRIM"):(n=wb,wb=c)}else n=wb,wb=c;if(wb!==c){ia();var Ua=n;var Pc=Ma();if(Pc!==c){ia();var Qc=fa();ia();var Wb=b();if(Wb!==c){ia();var Rc=da();if(Rc!==c){ia();var md=b();if(md!==c){ia();var Ge=Na();if(Ge!==c){ka=Ua;var He=Qc,Ie=Wb;Ua=Ia(h(),He,Ie,md)}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c}else n=Ua,Ua=c;if(Ua===c)if(Ua=n,Pc=Ma(),Pc!==c)if(ia(),Qc=fa(),ia(),Wb=b(),Wb!==c)if(ia(),Rc=Na(),Rc!==c){ka=Ua;var Je=Qc,Ke=Wb;Ua=Ia(h(),Je,Ke)}else n=Ua,Ua=c;else n=Ua,Ua=
c;else n=Ua,Ua=c;if(Ua!==c){ka=vb;var Le=Ua;vb={type:"function",location:h(),name:"trim",args:Le}}else n=vb,vb=c}else n=vb,vb=c;Ka=vb;if(Ka===c){var xb=n;var yb=n;var Sc=a.substr(n,8);Sc.toLowerCase()===Me?n+=8:(Sc=c,0===ha&&J(Ne));if(Sc!==c){var uc=n;ha++;var Oe=f();ha--;Oe===c?uc=void 0:(n=uc,uc=c);uc!==c?(ka=yb,yb="POSITION"):(n=yb,yb=c)}else n=yb,yb=c;if(yb!==c){ia();var Pa=n;var Tc=Ma();if(Tc!==c){ia();var Xb=b();if(Xb!==c){ia();var Uc=aa();if(Uc!==c){ia();var Yb=b();if(Yb!==c){ia();var Vc=Na();
if(Vc!==c){ka=Pa;var Pe=Xb,Qe=Yb;Pa=Ia(h(),Pe,Qe)}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c}else n=Pa,Pa=c;if(Pa===c)if(Pa=n,Tc=Ma(),Tc!==c)if(ia(),Xb=b(),Xb!==c)if(ia(),Uc=Xa(),Uc!==c)if(ia(),Yb=b(),Yb!==c)if(ia(),Vc=Na(),Vc!==c){ka=Pa;var Re=Xb,Se=Yb;Pa=Ia(h(),Re,Se)}else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;else n=Pa,Pa=c;if(Pa!==c){ka=xb;var Te=Pa;xb={type:"function",location:h(),name:"position",args:Te}}else n=xb,xb=c}else n=xb,xb=c;Ka=xb;if(Ka===c){var zb=
n;var Ab=n;var Wc=a.substr(n,4);Wc.toLowerCase()===Ue?n+=4:(Wc=c,0===ha&&J(Ve));if(Wc!==c){var vc=n;ha++;var We=f();ha--;We===c?vc=void 0:(n=vc,vc=c);vc!==c?(ka=Ab,Ab="CAST"):(n=Ab,Ab=c)}else n=Ab,Ab=c;if(Ab!==c){ia();var Qa=n;var Xc=Ma();if(Xc!==c){ia();var Zb=b();if(Zb!==c){ia();var Bb=n;var Yc=a.substr(n,2);Yc.toLowerCase()===Xe?n+=2:(Yc=c,0===ha&&J(Ye));if(Yc!==c){var wc=n;ha++;var Ze=f();ha--;Ze===c?wc=void 0:(n=wc,wc=c);wc!==c?(ka=Bb,Bb="AS"):(n=Bb,Bb=c)}else n=Bb,Bb=c;var Zc=Bb;if(Zc!==c){ia();
var $b=ba();if($b!==c){ia();var $c=Na();if($c!==c){ka=Qa;var $e=Zb,af=$b;Qa=Ia(h(),$e,af)}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c}else n=Qa,Qa=c;if(Qa===c)if(Qa=n,Xc=Ma(),Xc!==c)if(ia(),Zb=b(),Zb!==c)if(ia(),Zc=Xa(),Zc!==c)if(ia(),$b=ba(),$b!==c)if(ia(),$c=Na(),$c!==c){ka=Qa;var bf=Zb,cf=$b;Qa=Ia(h(),bf,cf)}else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;else n=Qa,Qa=c;if(Qa!==c){ka=zb;var df=Qa;zb={type:"function",location:h(),name:"cast",args:df}}else n=zb,zb=c}else n=
zb,zb=c;Ka=zb;if(Ka===c){var kb;var xc=kb=n;ha++;var yc=ea();ha--;yc===c?xc=void 0:(n=xc,xc=c);if(xc!==c){var eb=n;var ac=Q();ac!==c&&(ka=eb);eb=ac;if(eb===c)if(eb=n,96===a.charCodeAt(n)?(ac=nd,n++):(ac=c,0===ha&&J(od)),ac!==c){var zc=[];var ib=a.charAt(n);pd.test(ib)?n++:(ib=c,0===ha&&J(qd));if(ib!==c)for(;ib!==c;)zc.push(ib),ib=a.charAt(n),pd.test(ib)?n++:(ib=c,0===ha&&J(qd));else zc=c;zc!==c?(96===a.charCodeAt(n)?(ib=nd,n++):(ib=c,0===ha&&J(od)),ib!==c?(ka=eb,eb=zc.join("")):(n=eb,eb=c)):(n=eb,
eb=c)}else n=eb,eb=c;yc=eb;if(yc!==c){ia();var rd=u();if(rd!==c){ka=kb;var ef=yc;kb={type:"function",location:h(),name:ef,args:rd}}else n=kb,kb=c}else n=kb,kb=c}else n=kb,kb=c;Ka=kb;if(Ka===c){var Za=n;var ad=Fa();if(ad!==c){ia();var bc=b();if(bc!==c){ia();var cc=[];var Va=n;var fb=Ja();if(fb!==c){var dc=ia();Va=fb}else n=Va,Va=c;for(;Va!==c;)cc.push(Va),Va=n,fb=Ja(),fb!==c?(dc=ia(),Va=fb):(n=Va,Va=c);Va=Ra();if(Va!==c){ka=Za;var ff=bc,gf=cc;Za={type:"case-expression",location:h(),format:"simple",
operand:ff,clauses:gf,else:null,elseLocation:null}}else n=Za,Za=c}else n=Za,Za=c}else n=Za,Za=c;if(Za===c)if(Za=n,ad=Fa(),ad!==c)if(ia(),bc=b(),bc!==c){ia();cc=[];Va=n;fb=Ja();fb!==c?(dc=ia(),Va=fb):(n=Va,Va=c);for(;Va!==c;)cc.push(Va),Va=n,fb=Ja(),fb!==c?(dc=ia(),Va=fb):(n=Va,Va=c);Va=Sa();if(Va!==c)if(fb=ia(),dc=Ra(),dc!==c){ka=Za;var hf=bc,jf=cc,sd=Va;Za={type:"case-expression",location:h(),format:"simple",operand:hf,clauses:jf,else:sd.value,elseLocation:sd.location}}else n=Za,Za=c;else n=Za,Za=
c}else n=Za,Za=c;else n=Za,Za=c;var bd=Za;if(bd===c){var $a=n;var cd=Fa();if(cd!==c){ia();var ec=[];var Wa=n;var gb=Ea();if(gb!==c){var fc=ia();Wa=gb}else n=Wa,Wa=c;for(;Wa!==c;)ec.push(Wa),Wa=n,gb=Ea(),gb!==c?(fc=ia(),Wa=gb):(n=Wa,Wa=c);Wa=Ra();if(Wa!==c){ka=$a;var kf=ec;$a={type:"case-expression",location:h(),format:"searched",clauses:kf,else:null,elseLocation:null}}else n=$a,$a=c}else n=$a,$a=c;if($a===c)if($a=n,cd=Fa(),cd!==c){ia();ec=[];Wa=n;gb=Ea();gb!==c?(fc=ia(),Wa=gb):(n=Wa,Wa=c);for(;Wa!==
c;)ec.push(Wa),Wa=n,gb=Ea(),gb!==c?(fc=ia(),Wa=gb):(n=Wa,Wa=c);Wa=Sa();if(Wa!==c)if(gb=ia(),fc=Ra(),fc!==c){ka=$a;var lf=ec,td=Wa;$a={type:"case-expression",location:h(),format:"searched",clauses:lf,else:td.value,elseLocation:td.location}}else n=$a,$a=c;else n=$a,$a=c}else n=$a,$a=c;bd=$a}Ka=bd;if(Ka===c){var Cb=n;var mf=n;var Ac;var gc=n;var ud=g();if(ud!==c){var vd=[];for(Ac=l();Ac!==c;)vd.push(Ac),Ac=l();ka=gc;gc=ud+vd.join("")}else n=gc,gc=c;var wd=gc;wd!==c&&(ka=mf);var lb=wd;if(lb!==c){ka=Cb;
var hc=lb;lb=/^CURRENT_DATE$/i.test(hc)?{type:"current-time",location:h(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(hc)?{type:"current-time",location:h(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(hc)?{type:"current-time",location:h(),mode:"time"}:/^CURRENT_USER$/i.test(hc)?{type:"current-user",location:h()}:{type:"column-reference",location:h(),table:"",column:hc}}Cb=lb;if(Cb===c){Cb=n;var Db=n;if(O()!==c){var Bc;var nf=n;var dd=[];for(Bc=z();Bc!==c;)dd.push(Bc),Bc=z();ka=nf;var of=dd=dd.join("");var pf=
O();pf!==c?(ka=Db,Db=of):(n=Db,Db=c)}else n=Db,Db=c;lb=Db;if(lb!==c){ka=Cb;var qf=lb;lb={type:"column-reference",location:h(),table:"",column:qf,delimited:!0}}Cb=lb}Ka=Cb;if(Ka===c&&(Ka=X(),Ka===c)){Ka=n;var rf=Ma();if(rf!==c){ia();var ed=b();if(ed!==c){ia();var sf=Na();sf!==c?(ka=Ka,ed.paren=!0,Ka=ed):(n=Ka,Ka=c)}else n=Ka,Ka=c}else n=Ka,Ka=c}}}}}}}}}return Ka}function Q(){var A;var D=n;var R=g();if(R!==c){var Y=[];for(A=f();A!==c;)Y.push(A),A=f();ka=D;D=R+Y.join("")}else n=D,D=c;return D}function g(){var A=
a.charAt(n);tf.test(A)?n++:(A=c,0===ha&&J(uf));return A}function f(){var A=a.charAt(n);vf.test(A)?n++:(A=c,0===ha&&J(wf));return A}function l(){var A=a.charAt(n);xd.test(A)?n++:(A=c,0===ha&&J(yd));return A}function z(){var A=a.charAt(n);xd.test(A)?n++:(A=c,0===ha&&J(yd));if(A===c)if(A=n,O()!==c){var D=O();D!==c?(ka=A,A='"'):(n=A,A=c)}else n=A,A=c;return A}function O(){var A=a.charAt(n);xf.test(A)?n++:(A=c,0===ha&&J(yf));return A}function X(){var A;var D=A=n;if(64===a.charCodeAt(n)){var R=zf;n++}else R=
c,0===ha&&J(Af);if(R!==c){var Y=Q();Y!==c?D=R=[R,Y]:(n=D,D=c)}else n=D,D=c;D!==c&&(ka=A,A=D,D={type:"parameter",location:h(),value:A[1]});return D}function ba(){var A=n;var D=n;var R=a.substr(n,7);R.toLowerCase()===Bf?n+=7:(R=c,0===ha&&J(Cf));if(R!==c){R=n;ha++;var Y=f();ha--;Y===c?R=void 0:(n=R,R=c);R!==c?(ka=D,D="INTEGER"):(n=D,D=c)}else n=D,D=c;D===c&&(D=n,R=a.substr(n,3),R.toLowerCase()===Df?n+=3:(R=c,0===ha&&J(Ef)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="INT"):(n=D,
D=c)):(n=D,D=c));D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"integer"}});A=D;A===c&&(D=A=n,R=a.substr(n,8),R.toLowerCase()===Ff?n+=8:(R=c,0===ha&&J(Gf)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="SMALLINT"):(n=D,D=c)):(n=D,D=c),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"smallint"}}),A=D,A===c&&(D=A=n,R=a.substr(n,5),R.toLowerCase()===Hf?n+=5:(R=c,0===ha&&J(If)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="FLOAT"):(n=D,D=
c)):(n=D,D=c),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"float"}}),A=D,A===c&&(D=A=n,R=a.substr(n,4),R.toLowerCase()===Jf?n+=4:(R=c,0===ha&&J(Kf)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="REAL"):(n=D,D=c)):(n=D,D=c),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"real"}}),A=D,A===c&&(A=n,D=ma(),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"date"}}),A=D,A===c&&(A=n,D=la(),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"timestamp"}}),
A=D,A===c&&(A=n,D=ua(),D!==c&&(ka=A,D={type:"data-type",location:h(),value:{type:"time"}}),A=D,A===c&&(D=A=n,R=a.substr(n,7),R.toLowerCase()===Lf?n+=7:(R=c,0===ha&&J(Mf)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="VARCHAR"):(n=D,D=c)):(n=D,D=c),D!==c?(ia(),D=Ma(),D!==c?(ia(),D=E(),D!==c?(ia(),R=Na(),R!==c?(ka=A,A={type:"data-type",location:h(),value:{type:"varchar",size:parseInt(D)}}):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c))))))));return A}function fa(){var A=n;var D=n;
var R=a.substr(n,7);R.toLowerCase()===Nf?n+=7:(R=c,0===ha&&J(Of));if(R!==c){R=n;ha++;var Y=f();ha--;Y===c?R=void 0:(n=R,R=c);R!==c?(ka=D,D="LEADING"):(n=D,D=c)}else n=D,D=c;D===c&&(D=n,R=a.substr(n,8),R.toLowerCase()===Pf?n+=8:(R=c,0===ha&&J(Qf)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="TRAILING"):(n=D,D=c)):(n=D,D=c),D===c&&(D=n,R=a.substr(n,4),R.toLowerCase()===Rf?n+=4:(R=c,0===ha&&J(Sf)),R!==c?(R=n,ha++,Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="BOTH"):(n=D,D=
c)):(n=D,D=c)));D===c&&(D=null);ka=A;A=D;return D={type:"string",location:h(),value:null==A?"BOTH":A}}function na(){var A=n;var D=ra();if(D===c&&(D=Ba(),D===c&&(D=ya(),D===c&&(D=Aa(),D===c&&(D=Ca(),D===c&&(D=za(),D===c)))))){D=n;var R=a.substr(n,13);R.toLowerCase()===Tf?n+=13:(R=c,0===ha&&J(Uf));if(R!==c){R=n;ha++;var Y=f();ha--;Y===c?R=void 0:(n=R,R=c);R!==c?(ka=D,D="TIMEZONE_HOUR"):(n=D,D=c)}else n=D,D=c;D===c&&(D=n,R=a.substr(n,15),R.toLowerCase()===Vf?n+=15:(R=c,0===ha&&J(Wf)),R!==c?(R=n,ha++,
Y=f(),ha--,Y===c?R=void 0:(n=R,R=c),R!==c?(ka=D,D="TIMEZONE_MINUTE"):(n=D,D=c)):(n=D,D=c))}D!==c&&(ka=A,A=D,D={type:"string",location:h(),value:A});return D}function oa(){var A=n;var D=n;var R=pa();if(R!==c){ia();var Y=Ma();if(Y!==c)if(ia(),Y=wa(),Y!==c){ia();var ta=Na();ta!==c?(ka=D,D=R,D={type:"interval-period",location:h(),period:D.value,precision:Y,secondary:null}):(n=D,D=c)}else n=D,D=c;else n=D,D=c}else n=D,D=c;D===c&&(D=n,R=pa(),R!==c&&(ka=D,D=R,R={type:"interval-period",location:h(),period:D.value,
precision:null,secondary:null}),D=R);if(D!==c)if(ia(),R=n,Y=a.substr(n,2),Y.toLowerCase()===Xf?n+=2:(Y=c,0===ha&&J(Yf)),Y!==c?(Y=n,ha++,ta=f(),ha--,ta===c?Y=void 0:(n=Y,Y=c),Y!==c?(ka=R,R="TO"):(n=R,R=c)):(n=R,R=c),R!==c){ia();R=n;Y=pa();Y!==c&&(ka=R,R=Y,Y={type:"interval-period",location:h(),period:R.value,precision:null,secondary:null});R=Y;if(R===c){R=n;Y=za();if(Y!==c)if(ia(),Y=Ma(),Y!==c)if(ia(),Y=wa(),Y!==c)if(ia(),ta=Xa(),ta!==c)if(ia(),ta=sa(),ta!==c){ia();var va=Na();va!==c?(ka=R,R=Y,R={type:"interval-period",
location:h(),period:"second",precision:R,secondary:ta}):(n=R,R=c)}else n=R,R=c;else n=R,R=c;else n=R,R=c;else n=R,R=c;else n=R,R=c;R===c&&(R=n,Y=za(),Y!==c?(ia(),Y=Ma(),Y!==c?(ia(),Y=wa(),Y!==c?(ia(),ta=Na(),ta!==c?(ka=R,R=Y,R={type:"interval-period",location:h(),period:"second",precision:R,secondary:null}):(n=R,R=c)):(n=R,R=c)):(n=R,R=c)):(n=R,R=c),R===c&&(R=n,Y=za(),Y!==c&&(ka=R,Y={type:"interval-period",location:h(),period:"second",precision:null,secondary:null}),R=Y))}R!==c?(ka=A,A={type:"interval-qualifier",
location:h(),start:D,end:R}):(n=A,A=c)}else n=A,A=c;else n=A,A=c;A===c&&(A=n,R=pa(),R!==c?(ia(),D=Ma(),D!==c?(ia(),D=sa(),D!==c?(ia(),Y=Na(),Y!==c?(ka=A,A=R,A={type:"interval-period",location:h(),period:A.value,precision:D,secondary:null}):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c),A===c&&(A=n,R=pa(),R!==c&&(ka=A,A=R,R={type:"interval-period",location:h(),period:A.value,precision:null,secondary:null}),A=R,A===c&&(A=n,R=za(),R!==c?(ia(),D=Ma(),D!==c?(ia(),D=wa(),D!==c?(ia(),Y=Xa(),Y!==c?(ia(),R=sa(),
R!==c?(ia(),Y=Na(),Y!==c?(ka=A,A=D,A={type:"interval-period",location:h(),period:"second",precision:A,secondary:R}):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c),A===c&&(A=n,R=za(),R!==c?(ia(),D=Ma(),D!==c?(ia(),D=sa(),D!==c?(ia(),Y=Na(),Y!==c?(ka=A,A=D,A={type:"interval-period",location:h(),period:"second",precision:A,secondary:null}):(n=A,A=c)):(n=A,A=c)):(n=A,A=c)):(n=A,A=c),A===c&&(A=n,R=za(),R!==c&&(ka=A,R={type:"interval-period",location:h(),period:"second",precision:null,
secondary:null}),A=R)))));return A}function pa(){var A=n;var D=ya();D!==c&&(ka=A,D={type:"string",location:h(),value:"day"});A=D;A===c&&(A=n,D=Aa(),D!==c&&(ka=A,D={type:"string",location:h(),value:"hour"}),A=D,A===c&&(A=n,D=Ca(),D!==c&&(ka=A,D={type:"string",location:h(),value:"minute"}),A=D,A===c&&(A=n,D=Ba(),D!==c&&(ka=A,D={type:"string",location:h(),value:"month"}),A=D,A===c&&(A=n,D=ra(),D!==c&&(ka=A,D={type:"string",location:h(),value:"year"}),A=D))));return A}function sa(){var A=n;var D=E();
D!==c&&(ka=A,D=parseFloat(D));return D}function wa(){var A=n;var D=E();D!==c&&(ka=A,D=parseFloat(D));return D}function xa(){var A=Da();A===c&&(A=X());return A}function Da(){var A=n;if(39===a.charCodeAt(n)){var D=zd;n++}else D=c,0===ha&&J(Ad);D===c&&(a.substr(n,2)===Bd?(D=Bd,n+=2):(D=c,0===ha&&J(Zf)));if(D!==c){D=[];var R=n;if(a.substr(n,2)===Cc){var Y=Cc;n+=2}else Y=c,0===ha&&J(Cd);Y!==c&&(ka=R,Y="'");R=Y;R===c&&(R=a.charAt(n),Dd.test(R)?n++:(R=c,0===ha&&J(Ed)));for(;R!==c;)D.push(R),R=n,a.substr(n,
2)===Cc?(Y=Cc,n+=2):(Y=c,0===ha&&J(Cd)),Y!==c&&(ka=R,Y="'"),R=Y,R===c&&(R=a.charAt(n),Dd.test(R)?n++:(R=c,0===ha&&J(Ed)));39===a.charCodeAt(n)?(R=zd,n++):(R=c,0===ha&&J(Ad));R!==c?(ka=A,A={type:"string",location:h(),value:D.join("")}):(n=A,A=c)}else n=A,A=c;return A}function Ea(){var A=n;if(bb()!==c){ia();var D=b();if(D!==c){ia();var R=cb();R!==c?(ia(),R=b(),R!==c?(ka=A,A={type:"when-clause",location:h(),operand:D,value:R}):(n=A,A=c)):(n=A,A=c)}else n=A,A=c}else n=A,A=c;return A}function Ja(){var A=
n;if(bb()!==c){ia();var D=b();if(D!==c){ia();var R=cb();R!==c?(ia(),R=b(),R!==c?(ka=A,A={type:"when-clause",location:h(),operand:D,value:R}):(n=A,A=c)):(n=A,A=c)}else n=A,A=c}else n=A,A=c;return A}function Sa(){var A=n;var D=n;var R=a.substr(n,4);R.toLowerCase()===$f?n+=4:(R=c,0===ha&&J(ag));if(R!==c){R=n;ha++;var Y=f();ha--;Y===c?R=void 0:(n=R,R=c);R!==c?(ka=D,D="ELSE"):(n=D,D=c)}else n=D,D=c;D!==c?(ia(),D=b(),D!==c?(ka=A,A={type:"else-clause",location:h(),value:D}):(n=A,A=c)):(n=A,A=c);return A}
function ab(){var A=E();if(A===c){A=n;var D=a.charAt(n);kc.test(D)?n++:(D=c,0===ha&&J(lc));if(D!==c){var R=E();R!==c?(ka=A,A=D[0]+R):(n=A,A=c)}else n=A,A=c}return A}function La(){var A=n;if(46===a.charCodeAt(n)){var D=bg;n++}else D=c,0===ha&&J(cg);D!==c?(D=E(),D===c&&(D=null),ka=A,A="."+(null!=D?D:"")):(n=A,A=c);return A}function m(){var A;var D=A=n;var R=a.charAt(n);dg.test(R)?n++:(R=c,0===ha&&J(eg));R!==c?(R=a.charAt(n),kc.test(R)?n++:(R=c,0===ha&&J(lc)),R===c&&(R=null),ka=D,D="e"+(null===R?"":
R)):(n=D,D=c);D!==c?(R=E(),R!==c?(ka=A,A=D+R):(n=A,A=c)):(n=A,A=c);return A}function E(){var A=n;var D=[];var R=W();if(R!==c)for(;R!==c;)D.push(R),R=W();else D=c;D!==c&&(ka=A,D=D.join(""));return D}function W(){var A=a.charAt(n);fg.test(A)?n++:(A=c,0===ha&&J(gg));return A}function aa(){var A=n;var D=a.substr(n,2);D.toLowerCase()===hg?n+=2:(D=c,0===ha&&J(ig));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="IN"):(n=A,A=c)}else n=A,A=c;return A}function ja(){var A=n;var D=a.substr(n,
2);D.toLowerCase()===jg?n+=2:(D=c,0===ha&&J(kg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="IS"):(n=A,A=c)}else n=A,A=c;return A}function B(){var A=n;var D=a.substr(n,4);D.toLowerCase()===lg?n+=4:(D=c,0===ha&&J(mg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="LIKE"):(n=A,A=c)}else n=A,A=c;return A}function H(){var A=n;var D=a.substr(n,3);D.toLowerCase()===ng?n+=3:(D=c,0===ha&&J(og));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,
D=c);D!==c?(ka=A,A="NOT"):(n=A,A=c)}else n=A,A=c;return A}function N(){var A=n;var D=a.substr(n,3);D.toLowerCase()===pg?n+=3:(D=c,0===ha&&J(qg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="AND"):(n=A,A=c)}else n=A,A=c;return A}function V(){var A=n;var D=a.substr(n,2);D.toLowerCase()===rg?n+=2:(D=c,0===ha&&J(sg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="OR"):(n=A,A=c)}else n=A,A=c;return A}function Z(){var A=n;var D=a.substr(n,7);D.toLowerCase()===
tg?n+=7:(D=c,0===ha&&J(ug));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="BETWEEN"):(n=A,A=c)}else n=A,A=c;return A}function da(){var A=n;var D=a.substr(n,4);D.toLowerCase()===vg?n+=4:(D=c,0===ha&&J(wg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="FROM"):(n=A,A=c)}else n=A,A=c;return A}function ea(){var A=n;var D=a.substr(n,7);D.toLowerCase()===xg?n+=7:(D=c,0===ha&&J(yg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=
A,A="EXTRACT"):(n=A,A=c)}else n=A,A=c;return A}function la(){var A=n;var D=a.substr(n,9);D.toLowerCase()===zg?n+=9:(D=c,0===ha&&J(Ag));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="TIMESTAMP"):(n=A,A=c)}else n=A,A=c;return A}function ma(){var A=n;var D=a.substr(n,4);D.toLowerCase()===Bg?n+=4:(D=c,0===ha&&J(Cg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="DATE"):(n=A,A=c)}else n=A,A=c;return A}function ua(){var A=n;var D=a.substr(n,4);D.toLowerCase()===
Dg?n+=4:(D=c,0===ha&&J(Eg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="TIME"):(n=A,A=c)}else n=A,A=c;return A}function qa(){var A=n;var D=a.substr(n,8);D.toLowerCase()===Fg?n+=8:(D=c,0===ha&&J(Gg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="INTERVAL"):(n=A,A=c)}else n=A,A=c;return A}function ra(){var A=n;var D=a.substr(n,4);D.toLowerCase()===Hg?n+=4:(D=c,0===ha&&J(Ig));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=
A,A="YEAR"):(n=A,A=c)}else n=A,A=c;return A}function Ba(){var A=n;var D=a.substr(n,5);D.toLowerCase()===Jg?n+=5:(D=c,0===ha&&J(Kg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="MONTH"):(n=A,A=c)}else n=A,A=c;return A}function ya(){var A=n;var D=a.substr(n,3);D.toLowerCase()===Lg?n+=3:(D=c,0===ha&&J(Mg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="DAY"):(n=A,A=c)}else n=A,A=c;return A}function Aa(){var A=n;var D=a.substr(n,4);D.toLowerCase()===
Ng?n+=4:(D=c,0===ha&&J(Og));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="HOUR"):(n=A,A=c)}else n=A,A=c;return A}function Ca(){var A=n;var D=a.substr(n,6);D.toLowerCase()===Pg?n+=6:(D=c,0===ha&&J(Qg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="MINUTE"):(n=A,A=c)}else n=A,A=c;return A}function za(){var A=n;var D=a.substr(n,6);D.toLowerCase()===Rg?n+=6:(D=c,0===ha&&J(Sg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=
A,A="SECOND"):(n=A,A=c)}else n=A,A=c;return A}function Fa(){var A=n;var D=a.substr(n,4);D.toLowerCase()===Tg?n+=4:(D=c,0===ha&&J(Ug));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="CASE"):(n=A,A=c)}else n=A,A=c;return A}function Ra(){var A=n;var D=a.substr(n,3);D.toLowerCase()===Vg?n+=3:(D=c,0===ha&&J(Wg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="END"):(n=A,A=c)}else n=A,A=c;return A}function bb(){var A=n;var D=a.substr(n,4);D.toLowerCase()===
Xg?n+=4:(D=c,0===ha&&J(Yg));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="WHEN"):(n=A,A=c)}else n=A,A=c;return A}function cb(){var A=n;var D=a.substr(n,4);D.toLowerCase()===Zg?n+=4:(D=c,0===ha&&J($g));if(D!==c){D=n;ha++;var R=f();ha--;R===c?D=void 0:(n=D,D=c);D!==c?(ka=A,A="THEN"):(n=A,A=c)}else n=A,A=c;return A}function Xa(){if(44===a.charCodeAt(n)){var A=ah;n++}else A=c,0===ha&&J(bh);return A}function Ma(){if(40===a.charCodeAt(n)){var A=ch;n++}else A=c,0===ha&&J(dh);
return A}function Na(){if(41===a.charCodeAt(n)){var A=eh;n++}else A=c,0===ha&&J(fh);return A}function ia(){var A;var D=[];for(A=ic();A!==c;)D.push(A),A=ic();return D}function ic(){var A=a.charAt(n);gh.test(A)?n++:(A=c,0===ha&&J(hh));return A}function Kb(A,D,R,Y,ta){A={type:"binary-expression",location:ta,operator:A,left:D,right:R};void 0!==Y&&(A.escape=Y);return A}function Ia(A,...D){return{type:"expression-list",location:A,value:D}}function Ib(A,D){for(const {op:R,expr:Y,location:{end:ta}}of D)A=
Kb(R,A,Y,void 0,{...A.location,end:ta});return A}p=void 0!==p?p:{};var c={},Hd=p.grammarSource,Fd={start:K},Gd=K,Id="!",Kd="\x3d",fd="\x3e\x3d",Pd="\x3e",gd="\x3c\x3d",hd="\x3c\x3e",id="!\x3d",jd="||",zf="@",zd="'",Bd="N'",Cc="''",bg=".",fe="null",Zd="true",be="false",hg="in",jg="is",lg="like",Md="escape",ng="not",pg="and",rg="or",tg="between",vg="from",ue="for",re="substring",xg="extract",De="trim",Me="position",zg="timestamp",Bg="date",Dg="time",Nf="leading",Pf="trailing",Rf="both",Ue="cast",Xe=
"as",Bf="integer",Df="int",Ff="smallint",Hf="float",Jf="real",Lf="varchar",Xf="to",Fg="interval",Hg="year",Tf="timezone_hour",Vf="timezone_minute",Jg="month",Lg="day",Ng="hour",Pg="minute",Rg="second",Tg="case",Vg="end",Xg="when",Zg="then",$f="else",ah=",",ch="(",eh=")",nd="`",Td=/^[<-=]/,kc=/^[+\-]/,Xd=/^[*\/]/,tf=/^[A-Za-z_\x80-\uFFFF]/,vf=/^[A-Za-z0-9_]/,xd=/^[A-Za-z0-9_.\x80-\uFFFF]/,xf=/^["]/,Dd=/^[^']/,fg=/^[0-9]/,dg=/^[eE]/,gh=/^[ \t\n\r]/,pd=/^[^`]/,Jd=x("!",!1),Ld=x("\x3d",!1),Od=x("\x3e\x3d",
!1),Qd=x("\x3e",!1),Rd=x("\x3c\x3d",!1),Sd=x("\x3c\x3e",!1),Ud=I([["\x3c","\x3d"]],!1,!1),Vd=x("!\x3d",!1),lc=I(["+","-"],!1,!1),Wd=x("||",!1),Yd=I(["*","/"],!1,!1),uf=I([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),wf=I([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),yd=I([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),yf=I(['"'],!1,!1),Af=x("@",!1),Ad=x("'",!1),Zf=x("N'",!1),Cd=x("''",!1),Ed=I(["'"],!0,!1),cg=x(".",!1),gg=I([["0","9"]],!1,!1),eg=I(["e","E"],!1,!1),ge=x("NULL",
!0),$d=x("TRUE",!0),ce=x("FALSE",!0),ig=x("IN",!0),kg=x("IS",!0),mg=x("LIKE",!0),Nd=x("ESCAPE",!0),og=x("NOT",!0),qg=x("AND",!0),sg=x("OR",!0),ug=x("BETWEEN",!0),wg=x("FROM",!0),ve=x("FOR",!0),se=x("SUBSTRING",!0),yg=x("EXTRACT",!0),Ee=x("TRIM",!0),Ne=x("POSITION",!0),Ag=x("TIMESTAMP",!0),Cg=x("DATE",!0),Eg=x("TIME",!0),Of=x("LEADING",!0),Qf=x("TRAILING",!0),Sf=x("BOTH",!0),Ve=x("CAST",!0),Ye=x("AS",!0),Cf=x("INTEGER",!0),Ef=x("INT",!0),Gf=x("SMALLINT",!0),If=x("FLOAT",!0),Kf=x("REAL",!0),Mf=x("VARCHAR",
!0),Yf=x("TO",!0),Gg=x("INTERVAL",!0),Ig=x("YEAR",!0),Uf=x("TIMEZONE_HOUR",!0),Wf=x("TIMEZONE_MINUTE",!0),Kg=x("MONTH",!0),Mg=x("DAY",!0),Og=x("HOUR",!0),Qg=x("MINUTE",!0),Sg=x("SECOND",!0),Ug=x("CASE",!0),Wg=x("END",!0),Yg=x("WHEN",!0),$g=x("THEN",!0),ag=x("ELSE",!0),bh=x(",",!1),dh=x("(",!1),fh=x(")",!1),hh=I([" ","\t","\n","\r"],!1,!1),od=x("`",!1),qd=I(["`"],!0,!1),n=p.peg$currPos|0,ka=n,Eb=[{line:1,column:1}],hb=n,jc=p.peg$maxFailExpected||[],ha=p.peg$silentFails|0;if(p.startRule){if(!(p.startRule in
Fd))throw Error("Can't start parsing from rule \""+p.startRule+'".');Gd=Fd[p.startRule]}var Dc=Gd();if(p.peg$library)return{peg$result:Dc,peg$currPos:n,peg$FAILED:c,peg$maxFailExpected:jc,peg$maxFailPos:hb};if(Dc!==c&&n===a.length)return Dc;Dc!==c&&n<a.length&&J({type:"end"});throw function(A,D,R){return new k(k.buildMessage(A,D),A,D,R)}(jc,hb<a.length?a.charAt(hb):null,hb<a.length?t(hb,hb+1):t(hb,hb));}function r(a,p){if(null!=a)switch(p(a),a.type){case "when-clause":r(a.operand,p);r(a.value,p);
break;case "case-expression":for(const h of a.clauses)r(h,p);"simple"===a.format&&r(a.operand,p);null!==a.else&&r(a.else,p);break;case "expression-list":for(const h of a.value)r(h,p);break;case "unary-expression":r(a.expr,p);break;case "binary-expression":r(a.left,p);r(a.right,p);break;case "function":r(a.args,p);break;case "interval":r(a.value,p);r(a.qualifier,p);break;case "interval-qualifier":r(a.start,p),r(a.end,p)}}(function(a,p){function h(){this.constructor=a}h.prototype=p.prototype;a.prototype=
new h})(k,Error);k.prototype.format=function(a){var p="Error: "+this.message;if(this.location){var h=null,w;for(w=0;w<a.length;w++)if(a[w].source===this.location.source){h=a[w].text.split(/\r\n|\n|\r/g);break}a=this.location.start;w=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(a):a;var x=this.location.source+":"+w.line+":"+w.column;if(h){var I=this.location.end,F=y("",w.line.toString().length," ");h=h[a.line-1];I=(a.line===I.line?I.column:h.length+
1)-a.column||1;p+="\n --\x3e "+x+"\n"+F+" |\n"+w.line+" | "+h+"\n"+F+" | "+y("",a.column-1," ")+y("",I,"^")}else p+="\n at "+x}return p};k.buildMessage=function(a,p){function h(t){return t.charCodeAt(0).toString(16).toUpperCase()}function w(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+h(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+h(J)})}function x(t){return t.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+h(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+h(J)})}function I(t){return F[t.type](t)}var F={literal:function(t){return'"'+w(t.text)+'"'},class:function(t){var J=t.parts.map(function(K){return Array.isArray(K)?x(K[0])+"-"+x(K[1]):x(K)});return"["+(t.inverted?"^":"")+J.join("")+"]"},
any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};return"Expected "+function(t){t=t.map(I);var J,K;t.sort();if(0<t.length){for(K=J=1;J<t.length;J++)t[J-1]!==t[J]&&(t[K]=t[J],K++);t.length=K}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(a)+" but "+(p?'"'+w(p)+'"':"end of input")+" found."};class M{static parse(a){return C(a)}}e.WhereGrammar=M;e.visitAll=
r;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(e,k){k=new k.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});e.kebabDict=k;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCache":function(){define(["exports"],function(e){class k{constructor(){this._storage=new Map;this._purgeInterval=5;this._sweep=()=>{this._timer=void 0;if(this._storage){var r=
1E3*this._purgeInterval,M=performance.now()-r;for(const [a,p]of this._storage)if(p.time<M)this._storage.delete(a);else{0<this._storage.size&&(this._timer=setTimeout(this._sweep,r));break}}}}destroy(){this._storage?.clear();this._storage=null;clearTimeout(this._timer)}get size(){return this._storage?.size??0}put(r,M){this._storage?.set(r,new C(M));this._scheduleSweep()}get(r){if(this._storage){var M=this._storage?.get(r);if(M)return this._storage?.delete(r),M.time=performance.now(),this._storage?.set(r,
M),M.items}}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??(this._timer=setTimeout(this._sweep,1E3*this._purgeInterval)))}}let y=0;class C{constructor(r){this.items=r;this.time=performance.now();this.id=y++}}e.QueryEngineCache=k;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(e){e.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,
supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F){function t(b,q,L,d){const G=d.x-L.x;d=d.y-L.y;q=Math.min(1,Math.max(0,((q.x-L.x)*G+(q.y-L.y)*d)/(G*G+d*d)));b.x=L.x+G*q;b.y=L.y+d*q}function J(b,q){return b?q?4:3:q?3:2}class K{constructor(b,q,L){this.items=b;this.query=q;this.geometryType=L.geometryType;this.hasM=L.hasM;this.hasZ=L.hasZ;this.fieldsIndex=L.fieldsIndex;this.objectIdField=L.objectIdField;this.spatialReference=L.spatialReference;this.featureAdapter=L.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const b=
new p(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return b.countDistinctValues(this.items);const {groupByFieldsForStatistics:q,having:L,outStatistics:d}=this.query;if(!q?.length)return 1;const G=new Map,P=new Map,S=new Set;for(const T of d){var {statisticType:ca}=T;ca="exceedslimit"!==ca?T.onStatisticField:void 0;if(!P.has(ca)){var U=[];for(const v of q){const Q=this._getAttributeValues(b,v,G);U.push(Q)}P.set(ca,this._calculateUniqueValues(U,b.returnDistinctValues))}ca=
P.get(ca);for(const v in ca){const {data:Q,items:g}=ca[v];U=Q.join(",");L&&!b.validateItems(g,L)||S.add(U)}}return S.size}async createQueryResponse(){let b;b=this.query.outStatistics?this.query.outStatistics.some(q=>"exceedslimit"===q.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const q=this.query.geometry;a.isValid(this.query.outSR)&&!a.equals(q.spatialReference,
this.query.outSR)?b.queryGeometry=h.cleanFromGeometryEngine({spatialReference:this.query.outSR,...w.project(q,q.spatialReference,this.query.outSR)}):b.queryGeometry=h.cleanFromGeometryEngine({spatialReference:this.query.outSR,...q})}return b}createSnappingResponse(b,q){const L=this.featureAdapter,d=J(this.hasZ,this.hasM),{point:G,mode:P}=b,S="number"===typeof b.distance?b.distance:b.distance.x,ca="number"===typeof b.distance?b.distance:b.distance.y,U={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
q=this._getPointCreator(P,this.spatialReference,q);const v=new u(null,0),Q=new u(null,0),g={x:0,y:0,z:0};for(const fa of this.items){var f=L.getGeometry(fa);if(null==f)continue;const {coords:na,lengths:oa}=f;v.coords=na;Q.coords=na;if(b.returnEdge){f=0;for(var l=0;l<oa.length;l++){var z=oa[l];for(var O=0;O<z;O++,f+=d){var X=v;X.coordsIndex=f;if(O!==z-1){const pa=Q;pa.coordsIndex=f+d;const sa=g;t(g,G,X,pa);var ba=(G.x-sa.x)/S;const wa=(G.y-sa.y)/ca;ba=ba*ba+wa*wa;1>=ba&&U.candidates.push(x.makeEdgeCandidate(L.getObjectId(fa),
q(sa),Math.sqrt(ba),q(X),q(pa)))}}}}if("none"!==b.vertexMode)if(f=T?na.length-d:na.length,"all"===b.vertexMode)for(l=0;l<f;l+=d)z=v,z.coordsIndex=l,O=(G.x-z.x)/S,X=(G.y-z.y)/ca,O=O*O+X*X,1>=O&&U.candidates.push(x.makeVertexCandidate(L.getObjectId(fa),q(z),Math.sqrt(O)));else if("ends"===b.vertexMode){f=[0];T||f.push(na.length-d);for(const pa of f)f=v,f.coordsIndex=pa,l=(G.x-f.x)/S,z=(G.y-f.y)/ca,l=l*l+z*z,1>=l&&U.candidates.push(x.makeVertexCandidate(L.getObjectId(fa),q(f),Math.sqrt(l)))}}U.candidates.sort((fa,
na)=>fa.distance-na.distance);return U}_getPointCreator(b,q,L){const d=null==L||a.equals(q,L)?P=>P:P=>w.project(P,q,L),{hasZ:G}=this;return"3d"===b?G?({x:P,y:S,z:ca})=>d({x:P,y:S,z:ca}):({x:P,y:S})=>d({x:P,y:S,z:0}):({x:P,y:S})=>d({x:P,y:S})}async createSummaryStatisticsResponse(b){const {field:q,valueExpression:L,normalizationField:d,normalizationType:G,normalizationTotal:P,minValue:S,maxValue:ca,scale:U,timeZone:T,outStatisticTypes:v}=b;var Q=this.fieldsIndex.get(q);b=I.isDateField(Q)||I.isDateOnlyField(Q)||
I.isTimestampOffsetField(Q);const g=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:G,normalizationTotal:P,scale:U,timeZone:T}),f=F.isNullCountSupported({normalizationType:G,normalizationField:d,minValue:S,maxValue:ca}),l={value:.5,fieldType:Q?.type};Q=I.isStringField(Q)?F.calculateStringStatistics({values:g,supportsNullCount:f,percentileParams:l,outStatisticTypes:v}):F.calculateStatistics({values:g,minValue:S,maxValue:ca,useSampleStdDev:!G,supportsNullCount:f,
percentileParams:l,outStatisticTypes:v});return F.processSummaryStatisticsResult(Q,v,b)}async createUniqueValuesResponse(b){const {field:q,valueExpression:L,domains:d,returnAllCodedValues:G,scale:P,timeZone:S}=b;var ca=await this._getDataValues({field:q,field2:b.field2,field3:b.field3,fieldDelimiter:b.fieldDelimiter,valueExpression:L,scale:P,timeZone:S},!1);ca=F.calculateUniqueValuesCount(ca);return F.createUVResult(ca,d,G,b.fieldDelimiter)}async createClassBreaksResponse(b){const {field:q,valueExpression:L,
normalizationField:d,normalizationType:G,normalizationTotal:P,classificationMethod:S,standardDeviationInterval:ca,minValue:U,maxValue:T,numClasses:v,scale:Q,timeZone:g}=b;b=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:G,normalizationTotal:P,scale:Q,timeZone:g});b=F.calculateClassBreaks(b,{field:q,normalizationField:d,normalizationType:G,normalizationTotal:P,classificationMethod:S,standardDeviationInterval:ca,minValue:U,maxValue:T,numClasses:v});return F.resolveCBResult(b,
S)}async createHistogramResponse(b){const {field:q,valueExpression:L,normalizationField:d,normalizationType:G,normalizationTotal:P,classificationMethod:S,standardDeviationInterval:ca,minValue:U,maxValue:T,numBins:v,scale:Q,timeZone:g}=b;b=await this._getDataValues({field:q,valueExpression:L,normalizationField:d,normalizationType:G,normalizationTotal:P,scale:Q,timeZone:g});return F.calculateHistogram(b,{field:q,normalizationField:d,normalizationType:G,normalizationTotal:P,classificationMethod:S,standardDeviationInterval:ca,
minValue:U,maxValue:T,numBins:v})}_sortFeatures(b,q,L){if(1<b.length&&q?.length)for(const d of q.reverse()){q=d.split(" ");const G=q[0],P=this.fieldsIndex.get(G);q=q[1]?"desc"===q[1].toLowerCase():!1;const S=F.getAttributeComparator(P?.type,q);b.sort((ca,U)=>{ca=L(ca,G,P);U=L(U,G,P);return S(ca,U)})}}_createFeatureQueryResponse(b){const q=this.items,{geometryType:L,hasM:d,hasZ:G,objectIdField:P,spatialReference:S}=this,{outFields:ca,outSR:U,quantizationParameters:T,resultRecordCount:v,resultOffset:Q,
returnZ:g,returnM:f}=b,l=null!=v?q.length>(Q||0)+v:!1,z=ca&&(ca.includes("*")?[...this.fieldsIndex.fields]:ca.map(O=>this.fieldsIndex.get(O)));return{exceededTransferLimit:l,features:this._createFeatures(b,q),fields:z,geometryType:L,hasM:d&&f,hasZ:G&&g,objectIdFieldName:P,spatialReference:h.cleanFromGeometryEngine(U||S),transform:T&&M.toQuantizationTransform(T)||null}}_createFeatures(b,q){const L=new p(b,this.featureAdapter,this.fieldsIndex),{hasM:d,hasZ:G}=this,{orderByFields:P,quantizationParameters:S,
returnGeometry:ca,returnCentroid:U,maxAllowableOffset:T,resultOffset:v,resultRecordCount:Q,returnZ:g=!1,returnM:f=!1}=b,l=G&&g,z=d&&f;b=[];var O=0;const X=[...q];this._sortFeatures(X,P,(pa,sa,wa)=>L.getFieldValue(pa,sa,wa));if(this.geometryType&&(ca||U)){var ba=M.toQuantizationTransform(S)??void 0;q="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(ca&&!U)for(var fa of X){var na=this.featureAdapter.getGeometry(fa),oa={attributes:L.getAttributes(fa),geometry:h.getGeometry(this.geometryType,
this.hasZ,this.hasM,na,T,ba,l,z)};q&&na&&!oa.geometry&&(oa.centroid=h.transformCentroid(this,this.featureAdapter.getCentroid(fa,this),ba));b[O++]=oa}else if(!ca&&U)for(na of X)b[O++]={attributes:L.getAttributes(na),centroid:h.transformCentroid(this,this.featureAdapter.getCentroid(na,this),ba)};else for(oa of X)b[O++]={attributes:L.getAttributes(oa),centroid:h.transformCentroid(this,this.featureAdapter.getCentroid(oa,this),ba),geometry:h.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(oa),
T,ba,l,z)}}else for(ba of X)(fa=L.getAttributes(ba))&&(b[O++]={attributes:fa});O=v||0;null!=Q&&(b=b.slice(O,Math.min(b.length,O+Q)));return b}_createExceedsLimitQueryResponse(b){var q=!1;let L=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY;q=Number.POSITIVE_INFINITY;for(const G of b.outStatistics??[])if("exceedslimit"===G.statisticType){L=null!=G.maxPointCount?G.maxPointCount:Number.POSITIVE_INFINITY;d=null!=G.maxRecordCount?G.maxRecordCount:Number.POSITIVE_INFINITY;q=null!=G.maxVertexCount?
G.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)q=this.items.length>L;else if(this.items.length>d)q=!0;else{b=J(this.hasZ,this.hasM);const G=this.featureAdapter;q=this.items.reduce((P,S)=>{S=G.getGeometry(S);return P+(null!=S&&S.coords.length||0)},0)/b>q}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(q)}}]}}async _createStatisticsQueryResponse(b){var q=
{attributes:{}};const L=[],d=new Map,G=new Map,P=new Map,S=new Map,ca=new p(b,this.featureAdapter,this.fieldsIndex);var U=b.outStatistics;const {groupByFieldsForStatistics:T,having:v,orderByFields:Q,resultRecordCount:g}=b;b=T?.length;const f=!!b,l=f?T[0]:null,z=f&&!this.fieldsIndex.get(l);for(const na of U??[]){const {outStatisticFieldName:oa,statisticType:pa}=na;U=na;const sa="exceedslimit"!==pa?na.onStatisticField:void 0,wa="percentile_disc"===pa||"percentile_cont"===pa;var O="EnvelopeAggregate"===
pa||"CentroidAggregate"===pa||"ConvexHullAggregate"===pa;const xa=f&&1===b&&(sa===l||z)&&"count"===pa;if(f){if(!P.has(sa)){var X=[];for(const Da of T){var ba=this._getAttributeValues(ca,Da,d);X.push(ba)}P.set(sa,this._calculateUniqueValues(X,O?!1:ca.returnDistinctValues))}X=P.get(sa);if(!X)continue;ba=Object.keys(X);for(const Da of ba){const {count:Ea,data:Ja,items:Sa,itemPositions:ab}=X[Da];ba=Ja.join(",");if(!v||ca.validateItems(Sa,v)){const La=S.get(ba)||{attributes:{}};if(O){La.aggregateGeometries||
(La.aggregateGeometries={});const {aggregateGeometries:E,outStatisticFieldName:W}=await this._getAggregateGeometry(U,Sa);La.aggregateGeometries[W]=E}else{var fa=null;if(xa)fa=Ea;else{const E=this._getAttributeValues(ca,sa,d);fa=ab.map(W=>E[W]);fa=wa&&"statisticParameters"in U?this._getPercentileValue(U,fa):this._getStatisticValue(U,fa,null,ca.returnDistinctValues)}La.attributes[oa]=fa}let m=0;T.forEach((E,W)=>La.attributes[this.fieldsIndex.get(E)?E:`EXPR_${++m}`]=Ja[W]);S.set(ba,La)}}}else if(O){q.aggregateGeometries||
(q.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ea}=await this._getAggregateGeometry(U,this.items);q.aggregateGeometries[Ea]=Da}else O=this._getAttributeValues(ca,sa,d),q.attributes[oa]=wa&&"statisticParameters"in U?this._getPercentileValue(U,O):this._getStatisticValue(U,O,G,ca.returnDistinctValues);U="min"!==pa&&"max"!==pa||!I.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;L.push({name:oa,alias:oa,type:U||"esriFieldTypeDouble"})}q=
f?Array.from(S.values()):[q];this._sortFeatures(q,Q,(na,oa)=>na.attributes[oa]);g&&(q.length=Math.min(g,q.length));return{fields:L,features:q}}_isAnyDateField(b){b=this.fieldsIndex.get(b);return I.isDateField(b)||I.isDateOnlyField(b)||I.isTimestampOffsetField(b)||I.isTimeOnlyField(b)}async _getAggregateGeometry(b,q){const {convexHull:L,union:d}=await new Promise((g,f)=>e(["../../../geometry/geometryEngineJSON"],g,f)),{statisticType:G,outStatisticFieldName:P}=b,{featureAdapter:S,spatialReference:ca,
geometryType:U,hasZ:T,hasM:v}=this;q=q.map(g=>h.getGeometry(U,T,v,S.getGeometry(g)));const Q=L(ca,q,!0)[0];b={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===G?(q=Q?r.getPolygonExtent(Q):r.getGeometryExtent(d(ca,q)),b.aggregateGeometries={...q,spatialReference:ca},b.outStatisticFieldName=P||"extent"):"CentroidAggregate"===G?(q=Q?C.polygonCentroid(Q):C.extentCentroid(r.getGeometryExtent(d(ca,q))),b.aggregateGeometries={x:q[0],y:q[1],spatialReference:ca},b.outStatisticFieldName=
P||"centroid"):"ConvexHullAggregate"===G&&(b.aggregateGeometries=Q,b.outStatisticFieldName=P||"convexHull");return b}_getStatisticValue(b,q,L,d){const {onStatisticField:G,statisticType:P}=b;b=null;b=L?.has(G)?L.get(G):I.isStringField(this.fieldsIndex.get(G))||this._isAnyDateField(G)?F.calculateStringStatistics({values:q,returnDistinct:d}):F.calculateStatistics({values:d?[...(new Set(q))]:q,minValue:null,maxValue:null,useSampleStdDev:!0});L&&L.set(G,b);return b["var"===P?"variance":P]}_getPercentileValue(b,
q){const {onStatisticField:L,statisticParameters:d,statisticType:G}=b,{value:P,orderBy:S}=d;b=this.fieldsIndex.get(L);return F.calculatePercentile(q,{value:P,orderBy:S,fieldType:b?.type,isDiscrete:"percentile_disc"===G})}_getAttributeValues(b,q,L){if(L.has(q))return L.get(q);const d=this.fieldsIndex.get(q),G=this.items.map(P=>b.getFieldValue(P,q,d));L.set(q,G);return G}_calculateUniqueValues(b,q){const L={},d=this.items,G=d.length;for(let P=0;P<G;P++){const S=d[P],ca=[];for(const T of b)ca.push(T[P]);
const U=ca.join(",");null==L[U]?L[U]={count:1,data:ca,items:[S],itemPositions:[P]}:(q||L[U].count++,L[U].items.push(S),L[U].itemPositions.push(P))}return L}async _getDataValues(b,q=!0){const L=new p(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:d,scale:G,timeZone:P}=b;return d?L.getExpressionValues(this.items,d,{viewingMode:"map",scale:G,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},P):L.getDataValues(this.items,
y.clone(b),q)}}class u{constructor(b,q){this.coords=b;this.coordsIndex=q}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}k.QueryEngineResult=K;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(e,k){function y(g){if("lowerLeft"===g.originPosition&&4===g.scale.length&&4===g.translate.length)return g;const {originPosition:f,
scale:l,translate:z}=g;g=l[1]??1;return{originPosition:"lowerLeft",scale:[l[0]??1,"lowerLeft"===f?g:-g,l[2]??1,l[3]??1],translate:[z[0]??0,z[1]??0,z[2]??0,z[3]??0]}}function C({scale:g,translate:f},l){return Math.round((l-f[0])/g[0])}function r({scale:g,translate:f},l){return Math.round((l-f[1])/g[1])}function M({scale:g,translate:f},l){return Math.round(((l??0)-f[2])/g[2])}function a({scale:g,translate:f},l){return l?Math.round((l-f[3])/g[3]):0}function p(g,f){return g&&f?ca:g&&!f?P:!g&&f?S:G}function h({scale:g,
translate:f},l){return l*g[0]+f[0]}function w({scale:g,translate:f},l){return l*g[1]+f[1]}function x({scale:g,translate:f},l){return(l??0)*g[2]+f[2]}function I({scale:g,translate:f},l){return l?l*g[3]+f[3]:0}function F(g,f){return g&&f?Q:g&&!f?T:!g&&f?v:U}function t(g,f,l){const z=Array(l.length);for(let O=0;O<l.length;O++)z[O]=f(g,l[O]);return z}function J(g,f,l){let [z,O]=l[0],X=Math.min(z,f[0]),ba=Math.min(O,f[1]),fa=Math.max(z,f[2]);f=Math.max(O,f[3]);for(let na=1;na<l.length;na++){const [oa,
pa]=l[na];z+=oa;O+=pa;0>oa&&(X=Math.min(X,z));0<oa&&(fa=Math.max(fa,z));0>pa?ba=Math.min(ba,O):0<pa&&(f=Math.max(f,O))}g[0]=X;g[1]=ba;g[2]=fa;g[3]=f;return g}function K(g,f){if(!f.length)return null;g[0]=g[1]=Number.POSITIVE_INFINITY;g[2]=g[3]=Number.NEGATIVE_INFINITY;for(let l=0;l<f.length;l++)J(g,g,f[l]);return g}function u(g,f,l){g=y(g);f.xmin=C(g,l.xmin);f.ymin=r(g,l.ymin);f.xmax=C(g,l.xmax);f.ymax=r(g,l.ymax);l.hasZ&&(f.zmin=M(g,l.zmin),f.zmax=M(g,l.zmax));l.hasM&&(f.mmin=a(g,l.mmin),f.mmax=
a(g,l.mmax));f.hasZ=l.hasZ??!1;f.hasM=l.hasM??!1;return f}function b(g,f,l){g=y(g);f.points=p(l.hasZ,l.hasM)(g,l.points)??[];f.hasZ=l.hasZ??!1;f.hasM=l.hasM??!1;return f}function q(g,f,l){g=y(g);f.x=C(g,l.x);f.y=r(g,l.y);null!=l.z&&(f.z=M(g,l.z));null!=l.m&&(f.m=a(g,l.m));return f}function L(g,f,l){{g=y(g);var z=l.rings;const O=[],X=p(l.hasZ,l.hasM);for(let ba=0;ba<z.length;ba++){const fa=X(g,z[ba]);fa&&3<=fa.length&&O.push(fa)}g=O.length?O:null}if(!g)return null;f.rings=g;f.hasZ=l.hasZ??!1;f.hasM=
l.hasM??!1;return f}function d(g,f,l){{g=y(g);var z=l.paths;const O=[],X=p(l.hasZ,l.hasM);for(let ba=0;ba<z.length;ba++){const fa=X(g,z[ba]);fa&&2<=fa.length&&O.push(fa)}g=O.length?O:null}if(!g)return null;f.paths=g;f.hasZ=l.hasZ??!1;f.hasM=l.hasM??!1;return f}const G=(g,f)=>{const l=[];if(!f.length)return null;var z=f[0];let O=C(g,z[0]);z=r(g,z[1]);l.push([O,z]);for(let X=1;X<f.length;X++){const [ba,fa]=f[X],na=C(g,ba),oa=r(g,fa);na===O&&oa===z||l.push([na-O,oa-z]);O=na;z=oa}return l},P=(g,f)=>{const l=
[];if(!f.length)return null;var z=f[0];let O=C(g,z[0]),X=r(g,z[1]);z=M(g,z[2]);l.push([O,X,z]);for(let ba=1;ba<f.length;ba++){const [fa,na,oa]=f[ba],pa=C(g,fa),sa=r(g,na),wa=M(g,oa);pa===O&&sa===X&&wa===z||l.push([pa-O,sa-X,wa]);O=pa;X=sa;z=wa}return l},S=(g,f)=>{const l=[];if(!f.length)return null;var z=f[0];let O=C(g,z[0]),X=r(g,z[1]);z=a(g,z[2]);l.push([O,X,z]);for(let ba=1;ba<f.length;ba++){const [fa,na,oa]=f[ba],pa=C(g,fa),sa=r(g,na),wa=a(g,oa);pa===O&&sa===X&&wa===z||l.push([pa-O,sa-X,wa]);
O=pa;X=sa;z=wa}return l},ca=(g,f)=>{const l=[];if(!f.length)return null;var z=f[0];let O=C(g,z[0]),X=r(g,z[1]),ba=M(g,z[2]);z=a(g,z[3]);l.push([O,X,ba,z]);for(let fa=1;fa<f.length;fa++){const [na,oa,pa,sa]=f[fa],wa=C(g,na),xa=r(g,oa),Da=M(g,pa),Ea=a(g,sa);wa===O&&xa===X&&Da===ba&&Ea===z||l.push([wa-O,xa-X,Da,Ea]);O=wa;X=xa;ba=Da;z=Ea}return l},U=(g,f)=>{const l=Array(f.length);if(!f.length)return l;var z=f[0];let O=h(g,z[0]);z=w(g,z[1]);l[0]=[O,z];const {scale:X,originPosition:ba}=g;g=X[0];const fa=
"lowerLeft"===ba?X[1]:-X[1];for(let na=1;na<f.length;na++){const [oa,pa]=f[na];O+=g*oa;z+=fa*pa;l[na]=[O,z]}return l},T=(g,f)=>{const l=Array(f.length);if(!f.length)return l;var z=f[0];let O=h(g,z[0]),X=w(g,z[1]);l[0]=[O,X,x(g,z[2])];const {scale:ba,originPosition:fa}=g;z=ba[0];const na="lowerLeft"===fa?ba[1]:-ba[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa]=f[oa];O+=z*pa;X+=na*sa;l[oa]=[O,X,x(g,wa)]}return l},v=(g,f)=>{const l=Array(f.length);if(!f.length)return l;var z=f[0];let O=h(g,z[0]),
X=w(g,z[1]);l[0]=[O,X,I(g,z[2])];const {scale:ba,originPosition:fa}=g;z=ba[0];const na="lowerLeft"===fa?ba[1]:-ba[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa]=f[oa];O+=z*pa;X+=na*sa;l[oa]=[O,X,I(g,wa)]}return l},Q=(g,f)=>{const l=Array(f.length);if(!f.length)return l;var z=f[0];let O=h(g,z[0]),X=w(g,z[1]);l[0]=[O,X,x(g,z[2]),I(g,z[3])];const {scale:ba,originPosition:fa}=g;z=ba[0];const na="lowerLeft"===fa?ba[1]:-ba[1];for(let oa=1;oa<f.length;oa++){const [pa,sa,wa,xa]=f[oa];O+=z*pa;X+=na*sa;
l[oa]=[O,X,x(g,wa),I(g,xa)]}return l};e.getQuantizedBoundsCoordsArray=J;e.getQuantizedBoundsCoordsArrayArray=K;e.getQuantizedBoundsPaths=function(g){return K([0,0,0,0],g)};e.getQuantizedBoundsPoints=function(g){const f=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return J(f,f,g)};e.getQuantizedBoundsRings=function(g){return K([0,0,0,0],g)};e.normalizeTransform=y;e.quantizeBounds=function(g,f,l){g=y(g);f[0]=C(g,l[0]);f[3]=r(g,l[1]);f[2]=C(g,
l[2]);f[1]=r(g,l[3]);return f};e.quantizeCoordsArrayXY=G;e.quantizeCoordsArrayXYM=S;e.quantizeCoordsArrayXYZ=P;e.quantizeCoordsArrayXYZM=ca;e.quantizeExtent=u;e.quantizeGeometry=function(g,f){return g&&f?k.isPoint(f)?q(g,{},f):k.isPolyline(f)?d(g,{},f):k.isPolygon(f)?L(g,{},f):k.isMultipoint(f)?b(g,{},f):k.isExtent(f)?u(g,{},f):null:null};e.quantizeM=a;e.quantizeMultipoint=b;e.quantizePoint=q;e.quantizePolygon=L;e.quantizePolyline=d;e.quantizeX=C;e.quantizeY=r;e.quantizeZ=M;e.toQuantizationTransform=
function(g){return g?{originPosition:"upper-left"===g.originPosition?"upperLeft":"lower-left"===g.originPosition?"lowerLeft":g.originPosition,scale:g.tolerance?[g.tolerance,g.tolerance,1,1]:[1,1,1,1],translate:null!=g.extent?[g.extent.xmin,g.extent.ymax,g.extent.zmin??0,g.extent.mmin??0]:[0,0,0,0]}:null};e.unquantizeBounds=function(g,f,l){g=y(g);return l?(f[0]=h(g,l[0]),f[1]=w(g,l[3]),f[2]=h(g,l[2]),f[3]=w(g,l[1]),f):[h(g,f[0]),w(g,f[3]),h(g,f[2]),w(g,f[1])]};e.unquantizeCoordsArrayArray=t;e.unquantizeCoordsArrayXY=
U;e.unquantizeCoordsArrayXYM=v;e.unquantizeCoordsArrayXYZ=T;e.unquantizeCoordsArrayXYZM=Q;e.unquantizeExtent=function(g,f,l,z=l.hasZ??!1,O=l.hasM??!1){g=y(g);f.xmin=h(g,l.xmin);f.xmax=h(g,l.xmax);f.ymin=w(g,l.ymin);f.ymax=w(g,l.ymax);z&&(f.zmin=x(g,l.zmin),f.zmax=x(g,l.zmax));O&&(f.mmin=I(g,l.mmin),f.mmax=I(g,l.mmax));f.hasZ=z;f.hasM=O;return f};e.unquantizeM=I;e.unquantizeMultipoint=function(g,f,l,z=l?.hasZ??!1,O=l?.hasM??!1){null!=l&&(g=y(g),f.points=F(z,O)(g,l.points),f.hasZ=z,f.hasM=O);return f};
e.unquantizePoint=function(g,f,l,z=null!=l?.z,O=null!=l?.m){if(null==l)return f;g=y(g);f.x=h(g,l.x);f.y=w(g,l.y);z&&(f.z=x(g,l.z));O&&(f.m=I(g,l.m));return f};e.unquantizePolygon=function(g,f,l,z=l?.hasZ??!1,O=l?.hasM??!1){null!=l&&(g=y(g),f.rings=t(g,F(z,O),l.rings),f.hasZ=z,f.hasM=O);return f};e.unquantizePolyline=function(g,f,l,z=l?.hasZ??!1,O=l?.hasM??!1){null!=l&&(g=y(g),f.paths=t(g,F(z,O),l.paths),f.hasZ=z,f.hasM=O);return f};e.unquantizeX=h;e.unquantizeY=w;e.unquantizeZ=x;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),function(e,k,y,C,r,M){class a{constructor(p,h,w){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=p.returnDistinctValues??!1;this.fieldsIndex=w;this.featureAdapter=h;if((h=p.outFields)&&
!h.includes("*")){this.outFields=h;p=0;for(const I of h){var x=e.getExpressionFromFieldName(I);x=(h=this.fieldsIndex.get(x))?null:e.getWhereClause(x,w);h=h?h.name:e.getAliasFromFieldName(I)||`FIELD_EXP_${p++}`;this._fieldDataCache.set(I,{alias:h,clause:x})}}}countDistinctValues(p){if(!this.returnDistinctValues)return p.length;p.forEach(h=>this.getAttributes(h));return this._returnDistinctMap.size}getAttributes(p){p=this._processAttributesForOutFields(p);return this._processAttributesForDistinctValues(p)}getFieldValue(p,
h,w){const x=w?w.name:h;let I=null;this._fieldDataCache.has(x)?I=this._fieldDataCache.get(x)?.clause:w||(I=e.getWhereClause(h,this.fieldsIndex),this._fieldDataCache.set(x,{alias:x,clause:I}));return w?this.featureAdapter.getAttribute(p,x):I?.calculateValue(p,this.featureAdapter)}getDataValues(p,h,w=!0){const x=h.normalizationType,I=h.normalizationTotal,F=this.fieldsIndex.get(h.field),t=y.isDateOnlyField(F)||y.isTimestampOffsetField(F),J=y.isTimeOnlyField(F);return p.map(K=>{let u=h.field&&this.getFieldValue(K,
h.field,this.fieldsIndex.get(h.field));h.field2?(u=`${r.processNullValue(u)}${h.fieldDelimiter}${r.processNullValue(this.getFieldValue(K,h.field2,this.fieldsIndex.get(h.field2)))}`,h.field3&&(u=`${u}${h.fieldDelimiter}${r.processNullValue(this.getFieldValue(K,h.field3,this.fieldsIndex.get(h.field3)))}`)):"string"===typeof u&&w&&(t?u=u?(new Date(u)).getTime():null:J&&(u=u?C.timeOnlyToMilliseconds(u):null));x&&Number.isFinite(u)&&(K="field"===x&&h.normalizationField?this.getFieldValue(K,h.normalizationField,
this.fieldsIndex.get(h.normalizationField)):null,u=r.getNormalizedValue(u,x,K,I));return u})}async getExpressionValues(p,h,w,x,I){const {arcadeUtils:F}=await M.loadArcade(),t=F.hasGeometryOperations(h);t&&await F.enableGeometryOperations();const J=F.createFunction(h),K=F.getViewInfo(w),u={fields:this.fieldsIndex.fields};return p.map(b=>{b={attributes:this.featureAdapter.getAttributes(b),layer:u,geometry:t?{...k.getGeometry(x.geometryType,x.hasZ,x.hasM,this.featureAdapter.getGeometry(b)),spatialReference:w?.spatialReference}:
null};b=F.createExecContext(b,K,I);return F.executeFunction(J,b)})}validateItem(p,h){this._fieldDataCache.has(h)||this._fieldDataCache.set(h,{alias:h,clause:e.getWhereClause(h,this.fieldsIndex)});return this._fieldDataCache.get(h)?.clause?.testFeature(p,this.featureAdapter)??!1}validateItems(p,h){this._fieldDataCache.has(h)||this._fieldDataCache.set(h,{alias:h,clause:e.getWhereClause(h,this.fieldsIndex)});return this._fieldDataCache.get(h)?.clause?.testSet(p,this.featureAdapter)??!1}_processAttributesForOutFields(p){const h=
this.outFields;if(!h?.length)return this.featureAdapter.getAttributes(p);const w={};for(const x of h){const {alias:I,clause:F}=this._fieldDataCache.get(x);w[I]=F?F.calculateValue(p,this.featureAdapter):this.featureAdapter.getAttribute(p,I)}return w}_processAttributesForDistinctValues(p){if(null==p||!this.returnDistinctValues)return p;var h=this.outFields,w=[];if(h)for(const I of h){var {alias:x}=this._fieldDataCache.get(I);w.push(p[x])}else for(x in p)w.push(p[x]);h=`${(h||["*"]).join(",")}=${w.join(",")}`;
w=this._returnDistinctMap.get(h)||0;this._returnDistinctMap.set(h,++w);return 1<w?null:p}}return a})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t){function J(d){d=L.exec(d);if(!d)return null;const {hh:G,mm:P,ss:S,ms:ca}=d.groups;return Number(G)*r.millisecondsPerTimeUnit.hours+Number(P)*r.millisecondsPerTimeUnit.minutes+Number(S)*r.millisecondsPerTimeUnit.seconds+Number(ca||0)}function K(d,G){d=null!=d?d:"";null!=G&&G&&(d=d?"("+d+") AND ("+G+")":G);return d}function u(d){const G=d.layer;return d.fields.filter(P=>!G.getField(P))}function b(d){const G=d.layer;return d.fields.filter(P=>{P=G.getFieldUsageInfo(P);
return!P||!P.supportsStatistics})}let q=null;const L=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;e.calculateHeatmapStats=function(d,G=18,P,S,ca){const U=new Float64Array(S*ca);G=Math.round(C.pt2px(G));let T=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;P=w.createValueFunction(P);for(const {geometry:f,attributes:l}of d){const {x:z,y:O}=f;d=Math.max(0,z-G);var Q=Math.max(0,O-G);const X=Math.min(ca,O+G),ba=Math.min(S,z+G),fa=+P(l);for(;Q<X;Q++)for(let na=
d;na<ba;na++){var g=Q*S+na;const oa=w.evaluateDensityKernel(na-z,Q-O,G)*fa;g=U[g]+=oa;T=Math.min(T,g);v=Math.max(v,g)}}return{min:T,max:v}};e.getDataValues=async function(d,G,P=!0){if(!G)return[];const {field:S,field2:ca,field3:U,fieldDelimiter:T,fieldInfos:v,timeZone:Q}=d;var g=S&&v?.find(sa=>sa.name.toLowerCase()===S.toLowerCase());const f=g?h.isTimeOnlyField(g):!1,l=g?x.isAnyDateField(g):!1,z=d.valueExpression,O=d.normalizationType,X=d.normalizationField,ba=d.normalizationTotal,fa=[];g=d.viewInfoParams;
let na=null,oa=null;if(z){if(!q){const {arcadeUtils:sa}=await F.loadArcade();q=sa}q.hasGeometryOperations(z)&&await q.enableGeometryOperations();na=q.createFunction(z);oa=g?q.getViewInfo({viewingMode:g.viewingMode,scale:g.scale,spatialReference:new M(g.spatialReference)}):null}d=d.fieldInfos;const pa=G[0]&&"declaredClass"in G[0]&&"esri.Graphic"===G[0].declaredClass||!d?null:{fields:d};G.forEach(sa=>{var wa=sa.attributes;if(z){var xa=q.createExecContext(pa?{...sa,layer:pa}:sa,oa,Q);xa=q.executeFunction(na,
xa)}else wa&&(xa=wa[S],ca?(xa=`${I.processNullValue(xa)}${T}${I.processNullValue(wa[ca])}`,U&&(xa=`${xa}${T}${I.processNullValue(wa[U])}`)):"string"===typeof xa&&P&&(l?xa=xa?(new Date(xa)).getTime():null:f&&(xa=xa?J(xa):null)));O&&"number"===typeof xa&&isFinite(xa)&&(wa=wa&&parseFloat(wa[X]),xa=I.getNormalizedValue(xa,O,wa,ba));fa.push(xa)});return fa};e.getRangeExpr=function(d,G,P){G=null!=G?d+" \x3e\x3d "+G:"";d=null!=P?d+" \x3c\x3d "+P:"";P="";return(P=G&&d?K(G,d):G||d)?"("+P+")":""};e.getSQLFilterForNormalization=
function(d){const G=d.field,P=d.normalizationType;d=d.normalizationField;let S;if("field"===P)S="(NOT "+d+" \x3d 0)";else if("log"===P||"natural-log"===P||"square-root"===P)S=`(${G} > 0)`;return S};e.getSumOfAttributesExpr=function(d,G,P){const S=[],ca=[],U=[],T=[],v=[];d.forEach((g,f)=>{const l=g.field?"field":"expression",z=g.field||g.valueExpression;g.field?(v.push(z),ca.push(`var ${l}${f} = Number($feature["${z}"]);`)):(S.push(`function getValueForExpr${f}() {\n  ${z} \n}`),ca.push(`var ${l}${f} = Number(getValueForExpr${f}());`));
P||U.push(`${l}${f} = IIf(${l}${f} < 0, 0, ${l}${f});`);T.push(`${l}${f}`)});d=S.length?null:v.reduce((g,f)=>`${g} + ${f}`);let Q=null;G||P?G?P||d&&(Q=`(( ${d} ) >= 0)`):d&&(Q=`(( ${d} ) <> 0)`):d&&(Q=`(( ${d} ) > 0)`);return{valueExpression:[S.length?S.join("\n"):"",ca.join("\n"),U.join("\n"),`var total = ${T.join(" + ")};`,"return total;"].filter(Boolean).join("\n\n"),sqlExpression:d,sqlWhere:Q}};e.mergeWhereClauses=K;e.quantizeFeatures=function(d,G,P,S){const ca=p.isWrappable(P)?p.getInfo(P):null,
U=ca?Math.round((ca.valid[1]-ca.valid[0])/G.scale[0]):null;return d.map(T=>{const v=new t(T.geometry);a.quantizePoint(G,v,v);if(ca){var Q=U??0,g=S[0];0>v.x?v.x+=Q:v.x>g&&(v.x-=Q)}T.geometry=v;return T})};e.timeOnlyToMilliseconds=J;e.verifyBasicFieldValidity=function(d,G,P){const S=u({layer:d,fields:G});if(S.length)return new y(P,"Unknown fields: "+S.join(", ")+". You can only use fields defined in the layer schema");d=b({layer:d,fields:G});if(d.length)return new y(P,"Unsupported fields: "+d.join(", ")+
". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};e.verifyFieldType=function(d,G,P,S){let ca;G?G.name!==d.objectIdField&&S.includes(G.type)||(ca=new y(P,"'field' should be one of these types: "+S.join(","))):ca=new y(P,"'field' is not defined in the layer schema");return ca};e.verifyFilterValidity=function(d,G){if(d&&"intersects"!==d.spatialRelationship)return new y(G,"Only 'intersects' spatialRelationship is supported for featureFilter")};
e.verifyNumericField=function(d,G,P){let S;G?G.name!==d.objectIdField&&h.isNumericField(G)||(S=new y(P,"'field' should be one of these numeric types: "+h.numericTypes.join(","))):S=new y(P,"'field' is not defined in the layer schema");return S};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(e){function k(r){return r?72*r/96:0}function y(r=0,M=0){return{x:r,y:M}}const C=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;e.castRenderScreenPointArray=
function(r){return r};e.castRenderScreenPointArray3=function(r){return r};e.castScreenPointArray=function(r){return r};e.cloneScreenPoint=function(r){return r?y(r.x,r.y):null};e.createRenderScreenPoint=function(r=0,M=0){return{x:r,y:M}};e.createRenderScreenPointArray=function(r=0,M=0){return[r,M]};e.createRenderScreenPointArray3=function(r=0,M=0,a=0){return[r,M,a]};e.createScreenPoint=y;e.createScreenPointArray=function(r=0,M=0){return[r,M]};e.pt2px=function(r){return r?r/72*96:0};e.px2pt=k;e.screenPointArrayToObject=
function(r,M){return M?(M.x=r[0],M.y=r[1],M):{x:r[0],y:r[1]}};e.screenPointObjectToArray=function(r,M){return M?(M[0]=r.x,M[1]=r.y,2<M.length&&(M[2]=0),M):[r.x,r.y]};e.toPt=function(r){if("string"===typeof r){var M=r.match(C);if(M){var a=Number(M[1]);M=M[3]&&M[3].toLowerCase();r="-"===r.charAt(0);a="px"===M?k(a):a;return r?-a:a}console.warn("screenUtils.toPt: input not recognized!");return null}return r};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(e,k,y,C){function r(p,h,w){return 0===p?0:p*a[h]/a[w]}function M(p){switch(p){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const a={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};e.convertTime=r;e.isValidDate=function(p){return p instanceof Date&&!isNaN(p.getTime())};e.makeUTCTime=function(p,h,w="milliseconds"){h=new Date(r(h,w,"milliseconds"));h.setUTCFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate());return h};e.mergeTimeExtents=function(p,h){return p&&h?p.intersection(h):p||h};e.millisecondsPerTimeUnit=a;e.offsetDate=function(p,h,w,x=y.system){x=new C.IANAZone(k.resolveTimeZone(x));p=C.DateTime.fromJSDate(p,{zone:x});x="decades"===w||"centuries"===
w?"year":M(w);"decades"===w&&(h*=10);"centuries"===w&&(h*=100);return p.plus({[x]:h}).toJSDate()};e.offsetDateUTC=function(p,h,w="milliseconds"){p=p.getTime();h=r(h,w,"milliseconds");return new Date(p+h)};e.resetUTCDate=function(p,h){p=new Date(p.getTime());p.setUTCFullYear(h.getFullYear(),h.getMonth(),h.getDate());return p};e.timeSinceUTCMidnight=function(p,h="milliseconds"){const w=r(p.getUTCHours(),"hours","milliseconds"),x=r(p.getUTCMinutes(),"minutes","milliseconds"),I=r(p.getUTCSeconds(),"seconds",
"milliseconds");p=p.getUTCMilliseconds();return r(w+x+I+p,"milliseconds",h)};e.truncateDate=function(p,h,w=y.system){w=new C.IANAZone(k.resolveTimeZone(w));p=C.DateTime.fromJSDate(p,{zone:w});if("decades"===h||"centuries"===h)return p=p.startOf("year"),{year:w}=p,p.set({year:w-w%("decades"===h?10:100)}).toJSDate();h=M(h);return p.startOf(h).toJSDate()};e.truncateLocalTime=function(p){const h=new Date(0);h.setHours(0);h.setMinutes(0);h.setSeconds(0);h.setMilliseconds(0);h.setFullYear(p.getUTCFullYear(),
p.getUTCMonth(),p.getUTCDate());return h};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(e,k,y,C,r){function M(a,p,h,w){let {color:x,ratio:I}=p,{color:F,ratio:t}=h;t===I&&(1===t?I-=1E-6:t+=1E-6);p=k.clamp((w-I)/(t-I),0,1);C.lerp(a,x.toArray(),F.toArray(),p)}e.createValueFunction=function(a){return"function"===
typeof a?a:a?p=>+p[a]:()=>1};e.evaluateDensityKernel=function(a,p,h){a=Math.sqrt(a**2+p**2)/h;return 1<a?0:3/(Math.PI*h**2)*(1-a**2)**2};e.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(a){return y.px2pt(2.4*a)};e.generateGradient=function(a){const p=new Uint8ClampedArray(2048);a=a.filter(({ratio:F})=>0<=F&&1>=F).sort((F,t)=>F.ratio-t.ratio).map(({color:F,ratio:t})=>({color:F,ratio:Math.max(t,.001)}));if(1>a.length)return p;let h=a[0],w=a[0],x=1;const I=r.create();for(let F=0;512>F;F++){const t=
(F+.5)/512;for(;t>w.ratio&&x<a.length;)h=w,w=a[x++];M(I,h,w,t);p.set(I,4*F)}return p};e.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(a){return y.pt2px(a)/2.4};e.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(e,k,y,C,r,M){function a(t){return String(t).padStart(2,
"0")}function p(t,J,K){if("date"===J||"number"===J){"number"===J&&(t=new Date(t));J=K?t.getFullYear():t.getUTCFullYear();const u=a((K?t.getMonth():t.getUTCMonth())+1),b=a(K?t.getDate():t.getUTCDate()),q=a(K?t.getHours():t.getUTCHours()),L=a(K?t.getMinutes():t.getUTCMinutes());t=a(K?t.getSeconds():t.getUTCSeconds());t=`TIMESTAMP'${J}-${u}-${b} ${q}:${L}:${t}'`}return t}function h(t,J){if(J instanceof Date)return"date";if("number"===typeof J)return"number";if("string"===typeof J&&(t=t.getField(J),"\x3cnow\x3e"!==
J.toLowerCase()&&y.isDateField(t)))return"field"}const w={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},x={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},I=new Set(["integer","small-integer"]);let F=null;e.castIntegerFieldToFloat=function(t){return`cast(${t} as float)`};e.dateTypes=
["date","date-only","timestamp-offset"];e.defaultBasemapGroups=w;e.defaultStatisticTypes={exclude:["median"]};e.fieldDelimiter=",";e.formatAnyDate=function(t,J){const {format:K,timeZoneOptions:u,fieldType:b}=J??{};let q;u&&({timeZone:L,timeZoneName:q}=M.getTimeZoneFormattingOptions(u.layerTimeZone,u.datesInUnknownTimezone,u.viewTimeZone,k.convertDateFormatToIntlOptions(K||"short-date-short-time"),b));if("string"===typeof t&&isNaN(Date.parse("time-only"===b?`1970-01-01T${t}Z`:t)))return t;switch(b){case "date-only":var L=
k.convertDateFormatToIntlOptions(K||"short-date");return"string"===typeof t?k.formatDateOnly(t,{...L}):k.formatDate(t,{...L,timeZone:M.utc});case "time-only":return L=k.convertDateFormatToIntlOptions(K||"short-time"),"string"===typeof t?k.formatTimeOnly(t,L):k.formatDate(t,{...L,timeZone:M.utc});case "timestamp-offset":if(!L&&"string"===typeof t&&(new Date(t)).toISOString()!==t)return t;L=(J=K||u?k.convertDateFormatToIntlOptions(K||"short-date-short-time"):void 0)?{...J,timeZone:L,timeZoneName:q}:
void 0;return"string"===typeof t?k.formatTimestamp(t,L):k.formatDate(t,L);default:return J=K||u?k.convertDateFormatToIntlOptions(K||"short-date-short-time"):void 0,k.formatDate("string"===typeof t?new Date(t):t,J?{...J,timeZone:L,timeZoneName:q}:void 0)}};e.getBasemapGroup=function(t,J=w){for(const K in J)if(J[K].includes(t))return K};e.getBasemapId=function(t,J,K=!0){let u=null;t&&("string"===typeof t?J.includes(t)&&(u=t):u=r.getWellKnownBasemapId(t));return K?u||"gray":u};e.getDateDiffSQL=function(t,
J,K,u){const {hasQueryEngine:b}=t;K=p(K,h(t,K),b);t=p(J,h(t,J),b);t=`(${K} - ${t})`;u=x[u];J="/";1>u&&(u=1/u,J="*");return{sqlExpression:1===u?t:`(${t} ${J} ${u})`,sqlWhere:null}};e.getDateType=h;e.getFieldsList=async function(t){const {field:J,field2:K,field3:u,normalizationField:b,valueExpression:q}=t;t=[];q&&(F||({arcadeUtils:t}=await C.loadArcade(),F=t),t=F.extractFieldNames(q));J&&t.push(J);K&&t.push(K);u&&t.push(u);b&&t.push(b);return t};e.getNormalizationType=function(t){let J=t.normalizationType;
J||(t.normalizationField?J="field":null!=t.normalizationTotal&&(J="percent-of-total"));return J??void 0};e.isAnyDateField=function(t){return y.isDateField(t)||y.isDateOnlyField(t)||y.isTimestampOffsetField(t)};e.isIntegerField=function(t,J){t=J&&t.getField(J);return!!t&&I.has(t.type)};e.unitValueInDays=x;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(e,k,y,C,r,M,a,p,h,w){function x(g,f){let l;if("string"===typeof g){const z=g in w.esriBasemapDefinitions,O=!z&&g.includes("/");if(!z&&!O)return y.apiKey?T().warn(`Unable to find basemap definition for: ${g}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`):(f=Object.entries(w.esriBasemapDefinitions).filter(([,X])=>X.classic||X.is3d).map(([X])=>`"${X}"`).sort().join(", "),T().warn(`Unable to find basemap definition for: ${g}. Try one of these: ${f}`)),null;f&&(l=
f[g]);l||(l=z?k.fromId(g):new k({style:{id:g}}),f&&(f[g]=l))}else l=p.ensureType(k,g);l?.destroyed&&(T().warn("The provided basemap is already destroyed",{basemap:l}),l=null);return l}function I(g){if(v)return v(g);let f=null;g=K(g);const l=!g?.baseLayers.length;for(const O in w.esriBasemapDefinitions){var z=L(w.esriBasemapDefinitions[O]);z=G(g,z,{mustMatchReferences:l});if("equal"===z){f=O;break}"base-layers-equal"===z&&(f=O)}return f}function F(g,f){const l=new C;g.forEach(z=>{const O=f.find(X=>
"scene"!==X.type&&S(b(z),b(X)))||z;l.includes(O)?l.push(z):l.push(O)});return l}function t(g){if(J(g.url))return!0;if("vector-tile"===g.type)for(const f in g.sourceNameToSource)if(J(g.sourceNameToSource[f]?.sourceUrl))return!0;return!1}function J(g){if(!g)return!1;g=new a.Url(a.makeAbsolute(g));return!!g.authority&&Q.test(g.authority)}function K(g){return g?!g.loaded&&g.resourceInfo?L(g.resourceInfo.data):{baseLayers:u(g.baseLayers),referenceLayers:u(g.referenceLayers)}:null}function u(g){return(C.isCollection(g)?
g.toArray():g).map(b)}function b(g){return{type:g.type,effect:"effect"in g?g.effect:void 0,url:ca("urlTemplate"in g&&g.urlTemplate||g.url||"styleUrl"in g&&g.styleUrl||""),minScale:"minScale"in g&&null!=g.minScale?g.minScale:0,maxScale:"maxScale"in g&&null!=g.maxScale?g.maxScale:0,opacity:null!=g.opacity?g.opacity:1,visible:null!=g.visible?!!g.visible:!0,sublayers:"map-image"!==g.type&&"wms"!==g.type||null==g.sublayers?void 0:g.sublayers?.map(f=>({id:f.id,visible:f.visible})),activeLayerId:"wmts"===
g.type?g.activeLayer?.id:void 0}}function q(g){return g.isReference||"ArcGISSceneServiceLayer"===g.layerType}function L(g){return g?{baseLayers:d((g.baseMapLayers??[]).filter(f=>!q(f))),referenceLayers:d((g.baseMapLayers??[]).filter(f=>q(f)))}:null}function d(g){return g.map(f=>{let l;switch(f.layerType){case "VectorTileLayer":l="vector-tile";break;case "ArcGISTiledMapServiceLayer":l="tile";break;case "ArcGISSceneServiceLayer":l="scene";break;default:l="unknown"}return{type:l,effect:f.effect,url:ca(f.templateUrl||
f.urlTemplate||f.styleUrl||f.url),minScale:f.minScale??0,maxScale:f.maxScale??0,opacity:f.opacity??1,visible:null!=f.visibility?!!f.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function G(g,f,l){return null!=g!==(null!=f)?"not-equal":g&&f?P(g.baseLayers,f.baseLayers)?P(g.referenceLayers,f.referenceLayers)?"equal":l.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function P(g,f){if(g.length!==f.length)return!1;for(let l=0;l<g.length;l++)if(!S(g[l],f[l]))return!1;return!0}
function S(g,f){if(g.type!==f.type||g.url!==f.url||g.minScale!==f.minScale||g.maxScale!==f.maxScale||g.visible!==f.visible||g.opacity!==f.opacity||!h.effectEquals(g.effect,f.effect))return!1;if(null!=g.activeLayerId||null!=f.activeLayerId)return g.activeLayerId===f.activeLayerId;if(null!=g.sublayers||null!=f.sublayers){if(null==g.sublayers||null==f.sublayers||g.sublayers.length!==f.sublayers.length)return!1;for(let l=0;l<g.sublayers.length;l++){const z=g.sublayers.at(l),O=f.sublayers.at(l);if(z?.id!==
O?.id||z?.visible!==O?.visible)return!1}}return!0}function ca(g){return g?a.normalize(g).replace(/^\s*https?:/i,"").toLowerCase():""}function U(g){return"portalItem"in g?g.portalItem?.thumbnailUrl:void 0}const T=()=>r.getLogger("esri.support.basemapUtils");let v;const Q=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;e.clonePreservingTiledLayers=function(g,f=null){g=x(g);if(!g)return null;g=g.clone();f&&(g.baseLayers=F(g.baseLayers,f.baseLayers),g.referenceLayers=F(g.referenceLayers,f.referenceLayers));
return g};e.contentEquals=function(g,f){if(g===f||null!=g?.portalItem?.id&&g.portalItem.id===f?.portalItem?.id)return!0;g=K(g);f=K(f);return"equal"===G(g,f,{mustMatchReferences:!0})};e.createCache=function(){return{}};e.destroyCache=function(g){for(const f in g)M.destroyMaybe(g[f]),delete g[f]};e.ensureType=x;e.findSpatialReference=function(g,f){if(null==f||null==g)return{spatialReference:null,updating:!1};if("not-loaded"===f.loadStatus)return f.load(),{spatialReference:null,updating:!0};if(f.spatialReference)return{spatialReference:f.spatialReference,
updating:!1};if(0===f.baseLayers.length)return{spatialReference:null,updating:!1};f=f.baseLayers.at(0);switch(f.loadStatus){case "not-loaded":f.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}f=(("supportedSpatialReferences"in f?f.supportedSpatialReferences:null)||["tileInfo"in f?f.tileInfo?.spatialReference:f.spatialReference]).filter(Boolean);const l=g.spatialReference;return l?{spatialReference:f.find(z=>l.equals(z))??f[0]??
null,updating:!1}:{spatialReference:f[0],updating:!1}};e.getBasemapThumbnailUrl=function(g){if(!g)return null;var {thumbnailUrl:f}=g;return f?f:(f=I(g))?w.esriBasemapDefinitions[f].thumbnailUrl:M.mappedFind(g.baseLayers,U)};e.getWellKnownBasemapId=I;e.hasDeveloperBasemapLayer=function(g){return!!g?.baseLayers.concat(g.referenceLayers).some(t)};e.isBasemap3D=function(g){return"Web Scene"===g.portalItem?.type||g.referenceLayers.some(f=>"scene"===f.type)};e.isBasemapInBeta=function(g){return!!g?.portalItem?.tags?.some(f=>
"beta"===f.toLowerCase())};e.isBasemapLayer=function(g,f){return g.basemap?.referenceLayers?.some(l=>l.uid===f)||g.basemap?.baseLayers?.some(l=>l.uid===f)};e.isDeveloperBasemapLayer=t;e.overrideGetWellKnownBasemapId=function(g){v=g};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J,K,u,b,q,L,d,G,P){var S;let ca=0;M=S=class extends M.JSONSupportMixin(p){constructor(v){super(v);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+ca++;this.baseLayers=new C;this.referenceLayers=new C;const Q=g=>{g.parent&&g.parent!==this&&"remove"in g.parent&&g.parent.remove(g);g.parent=this;"elevation"===g.type&&w.getLogger(this).error(`Layer '${g.title}, id:${g.id}' of type '${g.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",g=>Q(g.item)),this.referenceLayers.on("after-add",g=>Q(g.item)),this.baseLayers.on("after-remove",g=>{g.item.parent=null}),this.referenceLayers.on("after-remove",g=>{g.item.parent=null})])}initialize(){this.when().catch(v=>{w.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,v)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var v=this.baseLayers.toArray();for(const Q of v)Q.destroy();
v=this.referenceLayers.toArray();for(const Q of v)Q.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=x.destroyMaybe(this.portalItem)}normalizeCtorArgs(v){v&&"resourceInfo"in v&&(this._set("resourceInfo",v.resourceInfo),v={...v},delete v.resourceInfo);return v}set baseLayers(v){this._set("baseLayers",r.referenceSetter(v,this._get("baseLayers")))}_writeBaseLayers(v,Q,g){const f=[];v&&(g={...g,layerContainerType:"basemap"},this.baseLayers.forEach(l=>{l=P.getLayerJSON(l,
g.webmap?g.webmap.getLayerJSONFromResourceInfo(l):null,g);null!=l&&f.push(l)}),this.referenceLayers.forEach(l=>{const z=P.getLayerJSON(l,g.webmap?g.webmap.getLayerJSONFromResourceInfo(l):null,g);null!=z&&("scene"!==l.type&&(z.isReference=!0),f.push(z))}));Q.baseMapLayers=f}set referenceLayers(v){this._set("referenceLayers",r.referenceSetter(v,this._get("referenceLayers")))}writeTitle(v,Q){Q.title=v||"Basemap"}load(v){this.addResolvingPromise(this._loadFromSource(v));return Promise.resolve(this)}loadAll(){return h.loadAll(this,
v=>{v(this.baseLayers,this.referenceLayers)})}clone(){const v={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(Q=>a.isClonable(Q)?Q.clone():Q),referenceLayers:this.referenceLayers.map(Q=>a.isClonable(Q)?Q.clone():Q)};this.loaded&&(v.loadStatus="loaded");return(new S({resourceInfo:this.resourceInfo})).set(v)}read(v,Q){this.resourceInfo||this._set("resourceInfo",{data:v,context:Q});super.read(v,Q)}write(v,Q){v=v||{};Q?.origin||(Q={origin:"web-map",...Q});super.write(v,
Q);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(v.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(g=>{g=a.clone(g);g.url&&F.isProtocolRelative(g.url)&&(g.url=`https:${g.url}`);g.templateUrl&&F.isProtocolRelative(g.templateUrl)&&(g.templateUrl=`https:${g.templateUrl}`);return g}));return v}async _loadFromSource(v){const {resourceInfo:Q,portalItem:g,style:f}=this;I.throwIfAborted(v);const l=[];Q?(l.push(this._loadLayersFromJSON(Q.data,Q.context?Q.context.url:null,v)),Q.data.id&&!Q.data.title&&
l.push(d.getBasemapTitle(Q.data.id).then(z=>{z&&this.read({title:z},Q.context)}))):g?l.push(this._loadFromItem(g,v)):f&&l.push(this._loadFromStylesService(f,v));await Promise.all(l)}async _loadLayersFromJSON(v,Q,g){const f=this.resourceInfo?.context,l=this.portalItem?.portal||f?.portal||null,z=T[f?.origin||""]??"web-map",{populateOperationalLayers:O}=await new Promise((ba,fa)=>e(["./layers/support/layersCreator"],ba,fa)),X=[];I.throwIfAborted(g);if(v.baseMapLayers&&Array.isArray(v.baseMapLayers)){Q=
{context:{...f,origin:z,url:Q,portal:l,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ba=fa=>"web-scene"===z&&"ArcGISSceneServiceLayer"===fa.layerType||fa.isReference;g=O(this.baseLayers,v.baseMapLayers.filter(fa=>!ba(fa)),Q);X.push(g);v=O(this.referenceLayers,v.baseMapLayers.filter(ba),Q);X.push(v)}await Promise.allSettled(X)}async _loadFromItem(v,Q){const g=await (await v.load(Q)).fetchData("json",Q),f=F.urlToObject(v.itemUrl??"");this._set("resourceInfo",{data:g.baseMap??
{},context:{origin:U[v.type||""]??"web-map",portal:v.portal||q.getDefault(),url:f}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:g.spatialReference},this.resourceInfo.context);this.read({title:v.title,thumbnailUrl:v.thumbnailUrl},{origin:"portal-item",portal:v.portal||q.getDefault(),url:f});return this._loadLayersFromJSON(this.resourceInfo.data,f,Q)}async _loadFromStylesService(v,Q){var g=`${v.serviceUrl}/${v.id}`;const f=(await y(g,{query:{language:v.getLanguageParamValue(),
places:v.places,worldview:v.worldview,token:v.apiKey},signal:Q?.signal})).data;g=F.urlToObject(g);this._set("resourceInfo",{data:f.baseMap??{},context:{origin:"web-map",url:g}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:f.spatialReference},this.resourceInfo.context);await this._loadLayersFromJSON(this.resourceInfo.data,g,Q);if(v.apiKey)for(const l of[...this.baseLayers,...this.referenceLayers])"apiKey"in l&&(l.apiKey=v.apiKey)}static fromId(v){return(v=
d.esriBasemapDefinitions[v])?v.itemId?new S({portalItem:{id:v.itemId,portal:{url:"https://www.arcgis.com"}}}):S.fromJSON(v,{origin:v.is3d?"web-scene":"web-map"}):null}};k.__decorate([t.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(v,Q,g,f){this._writeBaseLayers(v,Q,f)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:C}},writer(v,Q,g,f){this._writeBaseLayers(v,Q,f)}}}}}})],M.prototype,"baseLayers",null);k.__decorate([t.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],
M.prototype,"id",void 0);k.__decorate([t.property({type:L})],M.prototype,"portalItem",void 0);k.__decorate([t.property()],M.prototype,"referenceLayers",null);k.__decorate([t.property({readOnly:!0})],M.prototype,"resourceInfo",void 0);k.__decorate([t.property({type:b})],M.prototype,"spatialReference",void 0);k.__decorate([t.property({type:G})],M.prototype,"style",void 0);k.__decorate([t.property()],M.prototype,"thumbnailUrl",void 0);k.__decorate([t.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],
M.prototype,"title",void 0);k.__decorate([u.writer("title")],M.prototype,"writeTitle",null);M=S=k.__decorate([K.subclass("esri.Basemap")],M);const U={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return M})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(e,k){e.castForReferenceSetter=function(y){return y};e.referenceSetter=function(y,C,r=k){C||=new r;if(C===y)return C;
C.removeAll();y&&(Array.isArray(y)||"items"in y&&Array.isArray(y.items))?C.addMany(y):y&&C.add(y);return C};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(e,k,y,C,r,M,a,p){const h=w=>{w=class extends w{constructor(...x){super(...x);this.loadError=this._loadController=null;this.loadStatus=
"not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(I=>{const F=this.load.bind(this);this.load=t=>{const J=new Promise((K,u)=>{const b=r.onAbortOrThrow(t,u);this.destroyed&&u(new k("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(K,u).finally(()=>{b&&b.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const K=this._loadController=new AbortController;F({signal:K.signal})}I();
return J}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},I=>{this._set("loadStatus","failed");this._set("loadError",I);this._loadController=null})}destroy(){this._loadController&&(this._loadController=y.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new k("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};e.__decorate([a.property({readOnly:!0})],w.prototype,"loaded",null);e.__decorate([a.property({readOnly:!0})],w.prototype,"loadError",void 0);e.__decorate([a.property({clonable:!1})],w.prototype,"loadStatus",void 0);e.__decorate([a.property({type:[M],readOnly:!0})],w.prototype,"loadWarnings",null);return w=e.__decorate([p.subclass("esri.core.Loadable")],w)};C=class extends h(C.EsriPromise){};
C=e.__decorate([p.subclass("esri.core.Loadable")],C);(function(w){w.LoadableMixin=h;w.isLoadable=function(x){return!(!x||!x.load)}})(C||={});return C})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(e,k,y,C,r){var M;(function(h){h[h.PENDING=0]="PENDING";h[h.RESOLVED=1]="RESOLVED";h[h.REJECTED=2]="REJECTED"})(M||={});class a{constructor(){this._resolver=C.createResolver();this._status=M.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=M.RESOLVED;this._cleanUp()},()=>{this._status=M.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(h){this._resolvingPromises.push(h);this._tryResolve()}isResolved(){return this._status===M.RESOLVED}isRejected(){return this._status===M.REJECTED}isFulfilled(){return this._status!==M.PENDING}abort(){this._resolver.reject(C.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var h=C.createResolver(),w=[...this._resolvingPromises,h.promise],x=this._allPromise=Promise.all(w);x.then(()=>{this.isFulfilled()||this._allPromise!==x||this._resolver.resolve()},I=>{this.isFulfilled()||this._allPromise!==x||C.isAbortError(I)||this._resolver.reject(I)});h.resolve()}}}const p=h=>{h=class extends h{constructor(...w){super(...w);this._promiseProps=new a;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(w,
x){return this._promiseProps.promise.then(()=>this).then(w,x)}catch(w){return this.when(null,w)}addResolvingPromise(w){w&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in w?w.when():w)}};return h=k.__decorate([r.subclass("esri.core.Promise")],h)};e.EsriPromise=class extends p(y){};e.EsriPromise=k.__decorate([r.subclass("esri.core.Promise")],e.EsriPromise);e.EsriPromiseMixin=p;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(e,k,y,C){async function r(M,a){const p=[],h=(...x)=>{for(const I of x)null!=I&&(Array.isArray(I)?h(...I):y.isCollection(I)?I.forEach(F=>h(F)):C.isLoadable(I)&&p.push(I))};a(h);let w=null;await k.map(p,async x=>{x=await k.result("loadAll"in x&&"function"===typeof x.loadAll?x.loadAll():x.load());!1!==x.ok||w||(w=x)});if(w)throw w.error;return M}e.loadAll=async function(M,a){await M.load();return r(M,a)};e.loadAllChildren=r;Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J,K,u,b,q,L,d,G,P,S){function ca(f){const l=C.id;return()=>{const z=f.deref();z&&l.findCredential(z.restUrl)&&z.signIn().catch(()=>{})}}const U=f=>Object.freeze(Object.defineProperty({__proto__:null,default:f},Symbol.toStringTag,{value:"Module"}));var T;let v;const Q={PortalGroup:()=>Promise.resolve({default:L}),PortalItem:()=>new Promise((f,l)=>e(["./PortalItem"],z=>f(U(z)),l)),PortalUser:()=>Promise.resolve({default:P})};a=T=class extends a.JSONSupportMixin(p){constructor(f){super(f);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.default3DBasemapQuery=this.customBaseUrl=this.culture=this.created=null;this.hasClassificationSchema=this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=
null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=y.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=
this.useDefault3dBasemap=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(f){return"string"===typeof f?{url:f}:f}destroy(){g.unregister(this);this.defaultBasemap=h.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=h.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=h.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=h.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(f){if(f)for(const l of f)y.request.trustedServers.includes(l)||
y.request.trustedServers.push(l);return f}readDefaultBasemap(f){return this._readBasemap(f)}readDefaultDevBasemap(f){return this._readBasemap(f)}readDefaultVectorBasemap(f){return this._readBasemap(f)}get extraQuery(){const f=!this.user?.orgId||this.canSearchPublic;return this.id&&!f?` AND orgid:${this.id}`:null}get hasAPIKey(){return S.isApiKeyApplicable(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let f=this.url;
if(f){const l=f.indexOf("/sharing");f=0<l?f.slice(0,l):this.url.replace(/\/+$/,"");f+="/sharing/rest"}return f}get thumbnailUrl(){const f=this.restUrl,l=this.thumbnail;return f&&l?this._normalizeSSL(f+"/portals/self/resources/"+l):null}readUrlKey(f){return f?f.toLowerCase():f}readUser(f){let l=null;f&&(l=P.fromJSON(f),l.portal=this);return l}load(f){const l=(new Promise((z,O)=>e(["../Basemap"],X=>z(U(X)),O))).then(({default:z})=>{w.throwIfAborted(f);v=z}).then(()=>this.sourceJSON?this.sourceJSON:
this.fetchSelf(this.authMode,!1,f)).then(z=>{if(!this.hasAPIKey&&C.id){const O=C.id;this.credential=O.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO&&this.authMode!==T.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=O.on("credential-create",ca(new WeakRef(this))),g.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=z;this.read(z)});this.addResolvingPromise(l);return Promise.resolve(this)}async createElevationLayers(){await this.load();
const f=this._getHelperService("defaultElevationLayers"),l=(await new Promise((z,O)=>e(["../layers/ElevationLayer"],X=>z(U(X)),O))).default;return f?f.map(z=>new l({id:z.id,url:z.url})):[]}async fetchBasemaps(f,l){const z=await this._fetchBasemaps(f,l);!0===l?.include3d&&!1!==this.use3dBasemaps&&(f=await this._fetchBasemaps3D(f,l),z.unshift(...f));return z}async fetchDefault3DBasemap(f){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||"none"===this.default3DBasemapQuery)return null;const l=
new d;l.query=this.default3DBasemapQuery;l.disableExtraQuery=!0;return(f=(await this.queryItems(l,f)).results.find(z=>"Web Scene"===z.type))?new v({portalItem:f}):null}fetchCategorySchema(f){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",f).then(l=>l.categorySchema):w.isAborted(f)?Promise.reject(w.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(f){const l=this.featuredGroups,z=new d({num:100,sortField:"title"});if(l?.length){const O=[];for(const X of l)O.push(`(title:"${X.title}" AND owner:${X.owner})`);
z.query=O.join(" OR ");return this.queryGroups(z,f).then(X=>X.results)}return w.isAborted(f)?Promise.reject(w.createAbortError()):Promise.resolve([])}fetchRegions(f){const l=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/regions",{...f,query:{culture:l}})}fetchSettings(f){const l=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...f,query:{culture:l}})}static getDefault(){return q.ensureDefaultPortalInstance(()=>
new T)}queryGroups(f,l){return this.queryPortal("/community/groups",f,"PortalGroup",l)}queryItems(f,l){return this.queryPortal("/search",f,"PortalItem",l)}queryUsers(f,l){f.sortField||(f.sortField="username");return this.queryPortal("/community/users",f,"PortalUser",l)}fetchSelf(f=this.authMode,l=!1,z){const O=this.restUrl+"/portals/self";f={authMode:f,query:{culture:b.getLocale().toLowerCase()},withCredentials:!0,...z};"auto"===f.authMode&&(f.authMode="no-prompt");l&&(f.query.default=!0);return this.request(O,
f)}queryPortal(f,l,z,O){const X=I.ensureType(d,l),ba=fa=>this.request(this.restUrl+f,{...X.toRequestOptions(this),...O}).then(na=>{const oa=X.clone();oa.start=na.nextStart;return new G({nextQueryParams:oa,queryParams:X,total:na.total,results:T._resultsToTypedArray(fa,{portal:this},na,O)})}).then(na=>Promise.all(na.results.map(oa=>"function"===typeof oa.when?oa.when():na)).then(()=>na,oa=>{w.throwIfAbortError(oa);return na}));return z&&Q[z]?Q[z]().then(({default:fa})=>{w.throwIfAborted(O);return ba(fa)}):
ba()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new M("portal:not-authenticated","Unable to authenticate user. Portal.user is missing");});if(this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT&&!C.id)return Promise.reject(new M("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const f=l=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return l||
(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=l;return this.fetchSelf("immediate")});if(this.user&&this.credential===l)return null;this.credential=l;return this.fetchSelf("immediate")}).then(z=>{z&&(this.sourceJSON=z,this.read(z))});return C.id?C.id.getCredential(this.restUrl,{prompt:this.authMode!==T.AUTH_MODE_NO_PROMPT}).then(l=>f(l)):f(this.credential)}normalizeUrl(f){const l=this.credential?.token;
return this._normalizeSSL(l?f+(f.includes("?")?"\x26":"?")+"token\x3d"+l:f)}requestToTypedArray(f,l,z){return this.request(f,l).then(O=>{const X=T._resultsToTypedArray(z,{portal:this},O);return Promise.all(X.map(ba=>"function"===typeof ba.when?ba.when():O)).then(()=>X,()=>X)})}request(f,l={}){var z={f:"json",...l.query};const {authMode:O=this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:X=null,cacheBust:ba=!1,method:fa="auto",responseType:na="json",
signal:oa}=l;z={authMode:O,body:X,cacheBust:ba,method:fa,query:z,responseType:na,timeout:0,signal:oa};l.withCredentials&&(z.withCredentials=!0);return r(this._normalizeSSL(f),z).then(pa=>pa.data)}toJSON(){throw new M("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(f){if(!f)return null;if(f.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:f})}_getHelperService(f){const l=this.helperServices&&this.helperServices[f];if(!l)throw new M("portal:service-not-found",
`The \`helperServices\` do not include an entry named "${f}"`);return l}async _fetchBasemaps(f,l){const z=new d;z.query=f||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);z.disableExtraQuery=!0;f=await this.queryGroups(z,l);if(!f.total)return[];f=f.results[0];z.num=100;z.query='type:"Web Map" -type:"Web Application"';z.sortField=f.sortField||"name";z.sortOrder=f.sortOrder||"desc";l=await f.queryItems(z,l);return l.total?
l.results.filter(O=>"Web Map"===O.type).map(O=>new v({portalItem:O})):[]}async _fetchBasemaps3D(f,l){f=f||this.basemapGalleryGroupQuery3D;if(!f)return[];f=new d({query:f,disableExtraQuery:!0});var z=await this.queryGroups(f,l);if(!z.total)return[];z=z.results[0];f.num=100;f.query='type:"Web Scene"';f.sortField=z.sortField||"name";f.sortOrder=z.sortOrder||"desc";l=await z.queryItems(f,l);return l.total?l.results.filter(O=>"Web Scene"===O.type).map(O=>new v({portalItem:O})):[]}_normalizeSSL(f){return f.replace(/^http:/i,
"https:").replace(":7080",":7443")}_readBasemap(f){return f?(f=v.fromJSON(f),f.portalItem={portal:this},f):null}static _resultsToTypedArray(f,l,z,O){if(z){const X=null!=O?O.signal:null;z=z.listings||z.notifications||z.userInvitations||z.tags||z.items||z.groups||z.comments||z.provisions||z.results||z.relatedItems||z;if(f||l)z=z.map(ba=>{ba=Object.assign(f?f.fromJSON(ba):ba,l);"function"===typeof ba.load&&ba.load(X);return ba})}else z=[];return z}};a.AUTH_MODE_ANONYMOUS="anonymous";a.AUTH_MODE_AUTO=
"auto";a.AUTH_MODE_IMMEDIATE="immediate";a.AUTH_MODE_NO_PROMPT="no-prompt";k.__decorate([x.property()],a.prototype,"access",void 0);k.__decorate([x.property()],a.prototype,"allSSL",void 0);k.__decorate([x.property()],a.prototype,"authMode",void 0);k.__decorate([x.property()],a.prototype,"authorizedCrossOriginDomains",void 0);k.__decorate([J.reader("authorizedCrossOriginDomains")],a.prototype,"readAuthorizedCrossOriginDomains",null);k.__decorate([x.property()],a.prototype,"basemapGalleryGroupQuery",
void 0);k.__decorate([x.property({json:{name:"3DBasemapGalleryGroupQuery"}})],a.prototype,"basemapGalleryGroupQuery3D",void 0);k.__decorate([x.property()],a.prototype,"bingKey",void 0);k.__decorate([x.property()],a.prototype,"canListApps",void 0);k.__decorate([x.property()],a.prototype,"canListData",void 0);k.__decorate([x.property()],a.prototype,"canListPreProvisionedItems",void 0);k.__decorate([x.property()],a.prototype,"canProvisionDirectPurchase",void 0);k.__decorate([x.property()],a.prototype,
"canSearchPublic",void 0);k.__decorate([x.property()],a.prototype,"canShareBingPublic",void 0);k.__decorate([x.property()],a.prototype,"canSharePublic",void 0);k.__decorate([x.property()],a.prototype,"canSignInArcGIS",void 0);k.__decorate([x.property()],a.prototype,"canSignInIDP",void 0);k.__decorate([x.property()],a.prototype,"colorSetsGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"commentsEnabled",void 0);k.__decorate([x.property({type:Date})],a.prototype,"created",void 0);k.__decorate([x.property()],
a.prototype,"credential",void 0);k.__decorate([x.property()],a.prototype,"culture",void 0);k.__decorate([x.property()],a.prototype,"currentVersion",void 0);k.__decorate([x.property()],a.prototype,"customBaseUrl",void 0);k.__decorate([x.property()],a.prototype,"default3DBasemapQuery",void 0);k.__decorate([x.property()],a.prototype,"defaultBasemap",void 0);k.__decorate([J.reader("defaultBasemap")],a.prototype,"readDefaultBasemap",null);k.__decorate([x.property()],a.prototype,"defaultDevBasemap",void 0);
k.__decorate([J.reader("defaultDevBasemap")],a.prototype,"readDefaultDevBasemap",null);k.__decorate([x.property({type:u})],a.prototype,"defaultExtent",void 0);k.__decorate([x.property()],a.prototype,"defaultVectorBasemap",void 0);k.__decorate([J.reader("defaultVectorBasemap")],a.prototype,"readDefaultVectorBasemap",null);k.__decorate([x.property()],a.prototype,"description",void 0);k.__decorate([x.property()],a.prototype,"devBasemapGalleryGroupQuery",void 0);k.__decorate([x.property()],a.prototype,
"eueiEnabled",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,"extraQuery",null);k.__decorate([x.property()],a.prototype,"featuredGroups",void 0);k.__decorate([x.property()],a.prototype,"featuredItemsGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"galleryTemplatesGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"layoutGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"livingAtlasGroupQuery",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,
"hasAPIKey",null);k.__decorate([x.property()],a.prototype,"hasCategorySchema",void 0);k.__decorate([x.property()],a.prototype,"hasClassificationSchema",void 0);k.__decorate([x.property()],a.prototype,"helpBase",void 0);k.__decorate([x.property()],a.prototype,"helperServices",void 0);k.__decorate([x.property()],a.prototype,"helpMap",void 0);k.__decorate([x.property()],a.prototype,"homePageFeaturedContent",void 0);k.__decorate([x.property()],a.prototype,"homePageFeaturedContentCount",void 0);k.__decorate([x.property()],
a.prototype,"httpPort",void 0);k.__decorate([x.property()],a.prototype,"httpsPort",void 0);k.__decorate([x.property()],a.prototype,"id",void 0);k.__decorate([x.property()],a.prototype,"ipCntryCode",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,"isOrganization",null);k.__decorate([x.property()],a.prototype,"isPortal",void 0);k.__decorate([x.property()],a.prototype,"isReadOnly",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,"itemPageUrl",null);k.__decorate([x.property()],
a.prototype,"layerTemplatesGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"maxTokenExpirationMinutes",void 0);k.__decorate([x.property({type:Date})],a.prototype,"modified",void 0);k.__decorate([x.property()],a.prototype,"name",void 0);k.__decorate([x.property()],a.prototype,"portalHostname",void 0);k.__decorate([x.property()],a.prototype,"portalMode",void 0);k.__decorate([x.property()],a.prototype,"portalProperties",void 0);k.__decorate([x.property()],a.prototype,"region",void 0);k.__decorate([x.property()],
a.prototype,"recycleBinEnabled",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,"restUrl",null);k.__decorate([x.property()],a.prototype,"rotatorPanels",void 0);k.__decorate([x.property()],a.prototype,"showHomePageDescription",void 0);k.__decorate([x.property()],a.prototype,"sourceJSON",void 0);k.__decorate([x.property()],a.prototype,"staticImagesUrl",void 0);k.__decorate([x.property({json:{name:"2DStylesGroupQuery"}})],a.prototype,"stylesGroupQuery2d",void 0);k.__decorate([x.property({json:{name:"stylesGroupQuery"}})],
a.prototype,"stylesGroupQuery3d",void 0);k.__decorate([x.property()],a.prototype,"supportsHostedServices",void 0);k.__decorate([x.property()],a.prototype,"symbolSetsGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"templatesGroupQuery",void 0);k.__decorate([x.property()],a.prototype,"thumbnail",void 0);k.__decorate([x.property({readOnly:!0})],a.prototype,"thumbnailUrl",null);k.__decorate([x.property()],a.prototype,"units",void 0);k.__decorate([x.property()],a.prototype,"url",void 0);k.__decorate([x.property()],
a.prototype,"urlKey",void 0);k.__decorate([J.reader("urlKey")],a.prototype,"readUrlKey",null);k.__decorate([x.property()],a.prototype,"user",void 0);k.__decorate([J.reader("user")],a.prototype,"readUser",null);k.__decorate([x.property()],a.prototype,"use3dBasemaps",void 0);k.__decorate([x.property()],a.prototype,"useDefault3dBasemap",void 0);k.__decorate([x.property()],a.prototype,"useStandardizedQuery",void 0);k.__decorate([x.property()],a.prototype,"useVectorBasemaps",void 0);k.__decorate([x.property()],
a.prototype,"vectorBasemapGalleryGroupQuery",void 0);k=a=T=k.__decorate([K.subclass("esri.portal.Portal")],a);const g=new FinalizationRegistry(f=>{f.remove()});return k})},"esri/portal/portalDefault":function(){define(["exports"],function(e){let k;e.clearDefaultPortalInstance=function(){k=void 0};e.ensureDefaultPortalInstance=function(y){if(!k||k.destroyed)k=y();return k};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(e,k,y,C,r,M,a,p,h){var w;y=w=class extends y.JSONSupport{constructor(x){super(x);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const x=this.url,I=this.thumbnail;return x&&I&&this.portal?this.portal?.normalizeUrl(`${x}/info/${I}?f=json`):null}get url(){const x=this.portal?.restUrl;return x?x+"/community/groups/"+this.id:
null}fetchCategorySchema(x){return this.portal.request(this.url+"/categorySchema",x).then(I=>{I=I.categorySchema||[];return I.some(F=>"contentCategorySetsGroupQuery.LivingAtlas"===F.source)?this._fetchCategorySchemaSet("LivingAtlas",x):I})}fetchMembers(x){return this.portal.request(this.url+"/users",x)}getThumbnailUrl(x){let I=this.thumbnailUrl;I&&x&&(I+=`&w=${x}`);return I}toJSON(){throw new k("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(x){if(!x)return null;
if(x.declaredClass)throw Error("JSON object is already hydrated");const I=new w({sourceJSON:x});I.read(x);return I}queryItems(x,I){x=r.ensureType(h,x);const F=this.portal;if(5<parseFloat(F.currentVersion))return x=x||new h,F.queryPortal(`/content/groups/${this.id}/search`,x,"PortalItem",I);x=x?x.clone():new h;x.query="group:"+this.id+(x.query?" "+x.query:"");return F.queryItems(x,I)}_fetchCategorySchemaSet(x,I){const F=this.portal;return F.fetchSelf(F.authMode,!0,I).then(t=>{if(t=t.contentCategorySetsGroupQuery)return t=
new h({disableExtraQuery:!0,num:1,query:t}),F.queryGroups(t,I);throw new k("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(t=>{if(t.total){t=t.results[0];const J=new h({num:1,query:`typekeywords:"${x}"`});return t.queryItems(J,I)}throw new k("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(t=>t.total?t.results[0].fetchData("json",I).then(J=>{J=J?.categorySchema;return J?.length?J:[]}):[])}};e.__decorate([C.property()],
y.prototype,"access",void 0);e.__decorate([C.property({type:Date})],y.prototype,"created",void 0);e.__decorate([C.property()],y.prototype,"description",void 0);e.__decorate([C.property()],y.prototype,"id",void 0);e.__decorate([C.property()],y.prototype,"isInvitationOnly",void 0);e.__decorate([C.property({type:Date})],y.prototype,"modified",void 0);e.__decorate([C.property()],y.prototype,"owner",void 0);e.__decorate([C.property()],y.prototype,"portal",void 0);e.__decorate([C.property()],y.prototype,
"snippet",void 0);e.__decorate([C.property()],y.prototype,"sortField",void 0);e.__decorate([C.property()],y.prototype,"sortOrder",void 0);e.__decorate([C.property()],y.prototype,"sourceJSON",void 0);e.__decorate([C.property()],y.prototype,"tags",void 0);e.__decorate([C.property()],y.prototype,"thumbnail",void 0);e.__decorate([C.property({readOnly:!0})],y.prototype,"thumbnailUrl",null);e.__decorate([C.property()],y.prototype,"title",void 0);e.__decorate([C.property({readOnly:!0})],y.prototype,"url",
null);return y=w=e.__decorate([p.subclass("esri.portal.PortalGroup")],y)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(e,k,y,C,r,M,a,p,h,w,x){var I;const F=new y.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});k=I=class extends k{constructor(t){super(t);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new I({categories:this.categories?C.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,J){let K=[];this.categories&&(K=this.categories.map(q=>Array.isArray(q)?JSON.stringify(q):q));let u="";if(this.extent){var b=x.project(this.extent,w.WGS84);null!=b&&(u=`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`)}b=this.query;!this.disableExtraQuery&&t.extraQuery&&(b="("+b+")"+t.extraQuery);t={categories:K,bbox:u,q:b,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(t.sortField=this.sortField.split(",").map(q=>F.toJSON(q.trim())).join(","),t.sortOrder=this.sortOrder);return{query:{...J,...t}}}};e.__decorate([r.property()],k.prototype,"categories",void 0);e.__decorate([r.property()],k.prototype,"disableExtraQuery",void 0);e.__decorate([r.property({type:h})],k.prototype,"extent",void 0);e.__decorate([r.property()],k.prototype,"filter",void 0);e.__decorate([r.property()],k.prototype,"num",void 0);e.__decorate([r.property()],
k.prototype,"query",void 0);e.__decorate([r.property()],k.prototype,"sortField",void 0);e.__decorate([r.property()],k.prototype,"sortOrder",null);e.__decorate([r.property()],k.prototype,"start",void 0);return k=I=e.__decorate([p.subclass("esri.portal.PortalQueryParams")],k)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,k,y,C,r,M,a){k=class extends k{constructor(p){super(p);this.total=this.results=this.queryParams=this.nextQueryParams=null}};e.__decorate([y.property()],k.prototype,"nextQueryParams",void 0);e.__decorate([y.property()],k.prototype,"queryParams",void 0);e.__decorate([y.property()],k.prototype,"results",void 0);e.__decorate([y.property()],k.prototype,"total",void 0);return k=e.__decorate([a.subclass("esri.portal.PortalQueryResult")],k)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x){var I;C=I=class extends C.JSONSupport{constructor(F){super(F);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const F=this.url,t=this.thumbnail;return F&&t?this.portal.normalizeUrl(`${F}/info/${t}?f=json`):null}get userContentUrl(){const F=
this.portal?.restUrl;return F?`${F}/content/users/${this.username}`:null}get url(){const F=this.portal?.restUrl;return F?`${F}/community/users/${this.username}`:null}addItem(F){const t=F&&F.item;var J=F?.data;F=F?.folder;const K={method:"post"};t&&(K.query=t.createPostQuery(),null!=J&&("string"===typeof J?K.query.text=J:"object"===typeof J&&(K.query.text=JSON.stringify(J))));J=this.userContentUrl;F&&(J+="/"+("string"===typeof F?F:F.id));return this.portal.request(J+"/addItem",K).then(u=>{t.id=u.id;
t.portal=this.portal;return t.loaded?t.reload():t.load()})}async deleteItem(F,t=!1){let J=this.userContentUrl;F.ownerFolder&&(J+="/"+F.ownerFolder);await this.portal.request(J+`/items/${F.id}/delete`,{method:"post",query:t?{permanentDelete:!0}:{}});F.id=null;F.portal=null}async deleteItems(F,t=!1){F=F.slice();var J=this.userContentUrl+"/deleteItems";const K=[];var u=F.map(b=>b.id);if(u.length){t={method:"post",query:{items:u.join(","),permanentDelete:t}};J=await this.portal.request(J,t);for(const b of J.results)J=
F.find(q=>b.itemId===q.id),t=b.success,u=null,t?(J.id=null,J.portal=null):b.error&&(u=new y("portal:delete-item-failed",b.error.message,b.error)),K.push({item:J,success:t,error:u})}return K}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(F=>F&&F.folders?F.folders.map(t=>{t=w.fromJSON(t);t.portal=this.portal;return t}):[])}fetchGroups(){return this.portal.request(this.url??"").then(F=>F&&F.groups?F.groups.map(t=>{t=x.fromJSON(t);t.portal=this.portal;return t}):
[])}async fetchItems(F){F??={};var t=this.userContentUrl??"";F.folder&&(t+="/"+F.folder.id);const {default:J}=await new Promise((K,u)=>e(["./PortalItem"],b=>K(Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}))),u));F=await this.portal.request(t,{query:{folders:!1,inRecycleBin:F.inRecycleBin?!0:null,foldersContent:!F.folder&&F.includeSubfolderItems?!0:null,num:F.num||10,start:F.start||1,sortField:F.sortField||"created",sortOrder:F.sortOrder||"asc"}});
return F?.items?(t=F.items.map(K=>{K=J.fromJSON(K);K.portal=this.portal;return K}),await Promise.all(t.map(K=>K.load())),{items:t,nextStart:F.nextStart,total:F.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(F=>F.tags)}getThumbnailUrl(F){let t=this.thumbnailUrl;t&&F&&(t+=`&w=${F}`);return t}queryFavorites(F){return this.favGroupId?(this._favGroup||(this._favGroup=new x({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(F)):Promise.reject(new y("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(F,t){await this.portal.request(this.userContentUrl+`/items/${F.id}/restore`,{method:"post",query:t?{folderID:"string"===typeof t?t:t.id}:null})}toJSON(){throw new y("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(F){if(!F)return null;if(F.declaredClass)throw Error("JSON object is already hydrated");const t=new I({sourceJSON:F});t.read(F);return t}};k.__decorate([r.property()],
C.prototype,"access",void 0);k.__decorate([r.property({type:Date})],C.prototype,"created",void 0);k.__decorate([r.property()],C.prototype,"culture",void 0);k.__decorate([r.property()],C.prototype,"description",void 0);k.__decorate([r.property()],C.prototype,"email",void 0);k.__decorate([r.property()],C.prototype,"favGroupId",void 0);k.__decorate([r.property()],C.prototype,"fullName",void 0);k.__decorate([r.property({type:Date})],C.prototype,"modified",void 0);k.__decorate([r.property()],C.prototype,
"orgId",void 0);k.__decorate([r.property()],C.prototype,"portal",void 0);k.__decorate([r.property()],C.prototype,"preferredView",void 0);k.__decorate([r.property()],C.prototype,"privileges",void 0);k.__decorate([r.property()],C.prototype,"region",void 0);k.__decorate([r.property()],C.prototype,"role",void 0);k.__decorate([r.property()],C.prototype,"roleId",void 0);k.__decorate([r.property()],C.prototype,"sourceJSON",void 0);k.__decorate([r.property()],C.prototype,"thumbnail",void 0);k.__decorate([r.property({readOnly:!0})],
C.prototype,"thumbnailUrl",null);k.__decorate([r.property()],C.prototype,"units",void 0);k.__decorate([r.property({readOnly:!0})],C.prototype,"userContentUrl",null);k.__decorate([r.property({readOnly:!0})],C.prototype,"url",null);k.__decorate([r.property()],C.prototype,"username",void 0);k.__decorate([r.property()],C.prototype,"userLicenseTypeId",void 0);k.__decorate([r.property()],C.prototype,"userType",void 0);return C=I=k.__decorate([h.subclass("esri.portal.PortalUser")],C)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,k,y,C,r,M,a,p){y=class extends y.JSONSupport{constructor(h){super(h);this.username=this.title=this.portal=this.id=this.created=null}get url(){const h=this.portal?.restUrl;return h?`${h}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new k("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};e.__decorate([C.property({type:Date})],y.prototype,"created",void 0);e.__decorate([C.property()],y.prototype,"id",void 0);e.__decorate([C.property()],y.prototype,
"portal",void 0);e.__decorate([C.property()],y.prototype,"title",void 0);e.__decorate([C.property({readOnly:!0})],y.prototype,"url",null);e.__decorate([C.property()],y.prototype,"username",void 0);return y=e.__decorate([p.subclass("esri.portal.PortalFolder")],y)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J,K,u){var b;const q=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),L=new Set(["KML","GeoJson","CSV"]);r=b=class extends r.JSONSupportMixin(a){static from(d){return w.ensureClass(b,d)}constructor(d){super(d);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.classification=
this.categories=this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const d=this.type,G=this.typeKeywords||
[];let P=d;"Feature Service"===d||"Feature Collection"===d?P=G.includes("Table")?"Table":G.includes("Route Layer")?"Route Layer":G.includes("Markup")?"Markup":"Feature Layer":"Image Service"===d?P=G.includes("Elevation 3D Layer")?"Elevation Layer":G.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===d?P="Scene Layer":"Video Service"===d?P="Video Layer":"Scene Package"===d?P="Scene Layer Package":"Stream Service"===d?P="Feature Layer":"Geoprocessing Service"===d?P=G.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===d?P="GeoEnrichment Service":"Geocoding Service"===d?P="Locator":"Microsoft Powerpoint"===d?P="Microsoft PowerPoint":"GeoJson"===d?P="GeoJSON":"Globe Service"===d?P="Globe Layer":"Vector Tile Service"===d?P="Tile Layer":"netCDF"===d?P="NetCDF":"Map Service"===d?P=G.includes("Spatiotemporal")||!G.includes("Hosted Service")&&!G.includes("Tiled")||G.includes("Relational")?"Map Image Layer":"Tile Layer":d?.toLowerCase().includes("add in")?P=d.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===d?P="Big Data File Share":"Compact Tile Package"===d?P="Tile Package (tpkx)":"Raster function template"===d?P="Raster Function Template":"OGCFeatureServer"===d?P="OGC Feature Layer":"web mapping application"===d&&G.includes("configurableApp")?P="Instant App":"Insights Page"===d?P="Insights Report":"Excalibur Imagery Project"===d?P="Excalibur Project":"3DTiles Service"===d?P="3D tiles layer":"3DTiles Package"===d&&(P="3D tiles package");return P}readExtent(d){return d&&
d.length?new F(d[0][0],d[0][1],d[1][0],d[1][1]):null}get iconUrl(){var d=this.type?.toLowerCase()||"";const G=this.typeKeywords||[];var P=!1,S=!1;let ca=!1,U=!1,T=!1,v=!1;P=S=!1;0<d.indexOf("service")||"feature collection"===d||"kml"===d||"wms"===d||"wmts"===d||"wfs"===d?(P=G.includes("Hosted Service"),"feature service"===d||"feature collection"===d||"kml"===d||"wfs"===d?(S=G.includes("Table"),ca=G.includes("Route Layer"),U=G.includes("Markup"),T=G.includes("Spatiotemporal"),v=G.includes("UtilityNetwork"),
d=T&&S?"spatiotemporaltable":S?"table":ca?"routelayer":U?"markup":T?"spatiotemporal":v?"utilitynetwork":P?"featureshosted":"features"):"map service"===d||"wms"===d||"wmts"===d?(T=G.includes("Spatiotemporal"),S=G.includes("Relational"),d=T||S?"mapimages":P||G.includes("Tiled")||"wmts"===d?"maptiles":"mapimages"):d="scene service"===d?G.includes("Line")?"sceneweblayerline":G.includes("3DObject")?"sceneweblayermultipatch":G.includes("Point")?"sceneweblayerpoint":G.includes("IntegratedMesh")?"sceneweblayermesh":
G.includes("PointCloud")?"sceneweblayerpointcloud":G.includes("Polygon")?"sceneweblayerpolygon":G.includes("Building")?"sceneweblayerbuilding":G.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===d?G.includes("Elevation 3D Layer")?"elevationlayer":G.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===d?"streamlayer":"vector tile service"===d?"vectortile":"datastore catalog service"===d?"datastorecollection":"geocoding service"===d?"geocodeservice":"video service"===
d?G.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===d?G.includes("Web Tool")?"tool":"layers":"geodata service"===d?"geodataservice":"3dtiles service"===d?G.includes("3DObject")?"3dobjecttileslayer":G.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):d="web map"===d||"cityengine web scene"===d?"maps":"web scene"===d?G.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===d&&G.includes("configurableApp")?
"instantapps":"web mapping application"===d||"mobile application"===d||"application"===d||"operation view"===d||"desktop application"===d?"apps":"map document"===d||"map package"===d||"published map"===d||"scene document"===d||"globe document"===d||"basemap package"===d||"mobile basemap package"===d||"mobile map package"===d||"project package"===d||"project template"===d||"pro map"===d||"layout"===d||"layer"===d&&G.includes("ArcGIS Pro")||"explorer map"===d&&G.indexOf("Explorer Document")?"mapsgray":
"service definition"===d||"shapefile"===d||"cad drawing"===d||"geojson"===d||"netcdf"===d||"administrative report"===d?"datafiles":"360 vr experience"===d?"360vr":"explorer add in"===d||"desktop add in"===d||"windows viewer add in"===d||"windows viewer configuration"===d?"appsgray":"arcgis pro add in"===d||"arcgis pro configuration"===d?"addindesktop":"pdf"===d?"pdf":"microsoft word"===d?"word":"microsoft excel"===d?"excel":"microsoft powerpoint"===d?"ppt":"rule package"===d||"file geodatabase"===
d||"sqlite geodatabase"===d||"csv collection"===d||"kml collection"===d||"windows mobile package"===d||"map template"===d||"desktop application template"===d||"gml"===d||"arcpad package"===d||"code sample"===d||"document link"===d||"earth configuration"===d||"operations dashboard add in"===d||"rules package"===d||"workflow manager package"===d||"explorer map"===d&&G.includes("Explorer Mapping Application")||G.includes("Document")?"datafilesgray":"network analysis service"===d||"geoprocessing service"===
d||"geodata service"===d||"geometry service"===d||"geoprocessing package"===d||"locator package"===d||"geoprocessing sample"===d||"workflow manager service"===d?"toolsgray":"layer"===d||"layer package"===d||"explorer layer"===d?"layersgray":"analysis model"===d?"analysismodel":"scene package"===d?"scenepackage":"3dtiles package"===d?"3dtileslayerpackage":"3dtiles service"===d?"3dtileslayer":"mobile scene package"===d?"mobilescenepackage":"tile package"===d||"compact tile package"===d?"tilepackage":
"task file"===d?"taskfile":"report template"===d?"report-template":"statistical data collection"===d?"statisticaldatacollection":"insights workbook"===d?"workbook":"insights model"===d?"insightsmodel":"insights page"===d?"insightspage":"insights theme"===d?"insightstheme":"hub initiative"===d?"hubinitiative":"hub page"===d?"hubpage":"hub site application"===d?"hubsite":"hub event"===d?"hubevent":"hub project"===d?"hubproject":"relational database connection"===d?"relationaldatabaseconnection":"big data file share"===
d?"datastorecollection":"image collection"===d?"imagecollection":"desktop style"===d?"desktopstyle":"style"===d?G.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===d?"dashboard":"raster function template"===d?"rasterprocessingtemplate":"vector tile package"===d?"vectortilepackage":"ortho mapping project"===d?"orthomappingproject":"ortho mapping template"===d?"orthomappingtemplate":"solution"===d?"solutions":"geopackage"===d?"geopackage":"deep learning package"===d?"deeplearningpackage":
"real time analytic"===d?"realtimeanalytics":"reality mapping project"===d?"realitymappingproject":"big data analytic"===d?"bigdataanalytics":"feed"===d?"feed":"excalibur imagery project"===d?"excaliburimageryproject":"notebook"===d?"notebook":"storymap"===d?"storymap":"survey123 add in"===d?"survey123addin":"mission"===d?"mission":"mission report"===d?"missionreport":"mission template"===d?"missiontemplate":"quickcapture project"===d?"quickcaptureproject":"pro report"===d?"proreport":"pro report template"===
d?"proreporttemplate":"urban model"===d?"urbanmodel":"urban project"===d?"urbanproject":"web experience"===d?"experiencebuilder":"web experience template"===d?"webexperiencetemplate":"experience builder widget"===d?"experiencebuilderwidget":"experience builder widget package"===d?"experiencebuilderwidgetpackage":"workflow"===d?"workflow":"kernel gateway connection"===d?"kernelgatewayconnection":"insights script"===d?"insightsscript":"hub initiative template"===d?"hubinitiativetemplate":"storymap theme"===
d?"storymaptheme":"knowledge graph"===d?"knowledgegraph":"knowledge graph layer"===d?"knowledgegraphlayer":"knowledge studio project"===d?"knowledgestudio":"native application"===d?"nativeapp":"native application installer"===d?"nativeappinstaller":"web link chart"===d?"linkchart":"knowledge graph web investigation"===d?"investigation":"ogcfeatureserver"===d?"features":"pro presentation"===d?"propresentation":"pro project"===d?"proproject":"insights workbook package"===d?"insightsworkbookpackage":
"apache parquet"===d?"apacheparquet":"notebook code snippet library"===d?"notebookcodesnippets":"suitability model"===d?"suitabilitymodel":"esri classifier definition"===d?"classifierdefinition":"esri classification schema"===d?"classificationschema":"insights data engineering workbook"===d?"dataengineeringworkbook":"insights data engineering model"===d?"dataengineeringmodel":"deep learning studio project"===d?"deeplearningproject":"discussion"===d?"discussion":"allsource project"===d?"allsourceproject":
"api key"===d?"apikey":"data pipeline"===d?"datapipelines":"group layer"===d?(P=G.includes("Map"))?"layergroup2d":"layergroup":"media layer"===d?"onlinemedialayer":"form"===d?G.includes("Survey123")?"survey":"datafilesgray":"csv"===d?"csv":"image"===d?"image":"maps";return d?y.getAssetUrl("esri/images/portal/"+d+"16.png"):null}get isLayer(){return null!=this.type&&q.has(this.type)}get itemCdnUrl(){return u.toCDNUrl(this.itemUrl)}get itemPageUrl(){const d=this.portal?.itemPageUrl;return d&&this.id?
`${d}?id=${this.id}`:null}get itemUrl(){const d=this.portal?.restUrl;return d&&this.id?`${d}/content/items/${this.id}`:null}get thumbnailUrl(){const d=this.itemUrl,G=this.thumbnail;return d&&G?this.portal?.normalizeUrl(`${d}/info/${G}?f=json`)??null:null}get userItemUrl(){const d=this.portal?.restUrl;if(!d)return null;const G=this.owner||this.portal?.user?.username;return G?`${d}/content/users/${this.ownerFolder?`${G}/${this.ownerFolder}`:G}/items/${this.id}`:null}load(d){const G=this.portal??(this.portal=
t.getDefault()),P=G.load(d).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?G.request(this.itemUrl,{signal:null!=d?d.signal:null,query:{token:this.apiKey}}):{}).then(S=>{this.sourceJSON=S;this.read(S)});this.addResolvingPromise(P);return Promise.resolve(this)}async addRating(d){const G={method:"post",query:{}};d instanceof K&&(d=d.rating);null==d||isNaN(d)||"number"!==typeof d||(G.query.rating=d);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",G);return new K({rating:d,
created:new Date})}clone(){var d={access:this.access,accessInformation:this.accessInformation,applicationProxies:M.clone(this.applicationProxies),avgRating:this.avgRating,categories:M.clone(this.categories),classification:M.clone(this.classification),created:M.clone(this.created),culture:this.culture,description:this.description,extent:M.clone(this.extent),groupCategories:M.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:M.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:M.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:M.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:M.clone(this.typeKeywords),url:this.url};this.loaded&&(d.loadStatus="loaded");d=(new b({sourceJSON:this.sourceJSON})).set(d);
d._set("isOrgItem",this.isOrgItem);return d}createPostQuery(){const d=this.toJSON();for(var G of["tags","typeKeywords","categories"])d[G]=d[G]?.join(", ");for(const P of["extent","classification"])(G=d[P])&&(d[P]=JSON.stringify(G));return d}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(d="json",G){return this.portal.request(this.itemUrl+"/data",{responseType:d,...G,query:{token:this.apiKey}})}async fetchRating(d){d=await this.portal.request(this.itemUrl+
"/rating",{query:{token:this.apiKey},...d});return null!=d.rating?(d.created=new Date(d.created),new K(d)):null}fetchRelatedItems(d,G){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...d,token:this.apiKey},...G},b)}getThumbnailUrl(d){let G=this.thumbnailUrl;G&&d&&(G+=`&w=${d}`);return G}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(d=>{this.applicationProxies&&!Object.hasOwn(d,"appProxies")&&(this.applicationProxies=
null);this.sourceJSON=d;this.read(d);return this})}update(d){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const G=d?.data,P={method:"post"};P.query=this.createPostQuery();for(const S in P.query)null===P.query[S]&&(P.query[S]="");P.query.clearEmptyFields=!0;null!=G&&("string"===typeof G?P.query.text=G:"object"===typeof G&&(P.query.text=JSON.stringify(G)));return this.portal.request(`${this.userItemUrl}/update`,P).then(()=>this.reload())}):Promise.reject(new C("portal:item-does-not-exist",
"The item does not exist yet and cannot be updated"))}async copy(d){if(!this.id)throw new C("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:G,itemUrl:P}=this;await G.signIn();const {copyResources:S,folder:ca,tags:U,title:T}=d||{};d={method:"post",query:{copyPrivateResources:"all"===S,folder:"string"===typeof ca?ca:ca?.id,includeResources:!!S,tags:U?.join(","),title:T}};({itemId:d}=await G.request(`${P}/copy`,d));return new b({id:d,portal:G})}updateThumbnail(d){return this.id?
this.load().then(()=>this.portal.signIn()).then(()=>{const G=d.thumbnail,P=d.filename,S={method:"post"};if("string"===typeof G)p.isDataProtocol(G)?S.query={data:G}:S.query={url:p.makeAbsolute(G)},null!=P&&(S.query.filename=P);else{const ca=new FormData;null!=P?ca.append("file",G,P):ca.append("file",G);S.body=ca}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,S).then(()=>this.reload())}):Promise.reject(new C("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(d=
{},G){const {fetchResources:P}=await new Promise((S,ca)=>e(["./support/resourceUtils"],S,ca));return P(this,d,G)}async addResource(d,G,P){const {addOrUpdateResources:S}=await new Promise((ca,U)=>e(["./support/resourceUtils"],ca,U));d.portalItem=this;await S(this,[{resource:d,content:G,compress:P?.compress,access:P?.access}],"add",P);return d}async removeResource(d,G){const {removeResource:P}=await new Promise((S,ca)=>e(["./support/resourceUtils"],S,ca));if(d.portalItem&&d.portalItem.itemUrl!==this.itemUrl)throw new C("removeresource:portal-item-mismatch",
"The portal item associated with the provided resource does not match the item");return P(this,d,G)}async removeAllResources(d){const {removeAllResources:G}=await new Promise((P,S)=>e(["./support/resourceUtils"],P,S));return G(this,d)}resourceFromPath(d){return new J({portalItem:this,path:d})}toJSON(){var d=this.extent;d={accessInformation:this.accessInformation,categories:M.clone(this.categories),classification:M.clone(this.classification),created:this.created?.getTime(),description:this.description,
extent:d&&[[d.xmin,d.ymin],[d.xmax,d.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:M.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:M.clone(this.typeKeywords),url:this.url};return M.fixJson(d)}static fromJSON(d){if(!d)return null;if(d.declaredClass)throw Error("JSON object is already hydrated");
return new b({sourceJSON:d})}_getPostQuery(){const d=this.toJSON();for(const G in d)"tags"===G&&null!==d[G]&&(d[G]=d[G].join(", ")),"typeKeywords"===G&&null!==d[G]&&(d[G]=d[G].join(", ")),"extent"===G&&d[G]&&(d[G]=JSON.stringify(d[G]));return d}};k.__decorate([h.property({type:["private","shared","org","public"]})],r.prototype,"access",void 0);k.__decorate([h.property()],r.prototype,"accessInformation",void 0);k.__decorate([h.property({type:String})],r.prototype,"apiKey",void 0);k.__decorate([h.property({json:{read:{source:"appProxies"}}})],
r.prototype,"applicationProxies",void 0);k.__decorate([h.property()],r.prototype,"avgRating",void 0);k.__decorate([h.property()],r.prototype,"categories",void 0);k.__decorate([h.property()],r.prototype,"classification",void 0);k.__decorate([h.property({type:Date})],r.prototype,"created",void 0);k.__decorate([h.property()],r.prototype,"culture",void 0);k.__decorate([h.property()],r.prototype,"description",void 0);k.__decorate([h.property({readOnly:!0})],r.prototype,"displayName",null);k.__decorate([h.property({type:F})],
r.prototype,"extent",void 0);k.__decorate([x.reader("extent")],r.prototype,"readExtent",null);k.__decorate([h.property()],r.prototype,"groupCategories",void 0);k.__decorate([h.property({readOnly:!0})],r.prototype,"iconUrl",null);k.__decorate([h.property()],r.prototype,"id",void 0);k.__decorate([h.property({readOnly:!0})],r.prototype,"isLayer",null);k.__decorate([h.property({type:Boolean,readOnly:!0})],r.prototype,"isOrgItem",void 0);k.__decorate([h.property()],r.prototype,"itemControl",void 0);k.__decorate([h.property({readOnly:!0})],
r.prototype,"itemPageUrl",null);k.__decorate([h.property({readOnly:!0})],r.prototype,"itemUrl",null);k.__decorate([h.property()],r.prototype,"licenseInfo",void 0);k.__decorate([h.property({type:Date})],r.prototype,"modified",void 0);k.__decorate([h.property()],r.prototype,"name",void 0);k.__decorate([h.property()],r.prototype,"numComments",void 0);k.__decorate([h.property()],r.prototype,"numRatings",void 0);k.__decorate([h.property()],r.prototype,"numViews",void 0);k.__decorate([h.property()],r.prototype,
"owner",void 0);k.__decorate([h.property()],r.prototype,"ownerFolder",void 0);k.__decorate([h.property({type:t})],r.prototype,"portal",void 0);k.__decorate([h.property()],r.prototype,"screenshots",void 0);k.__decorate([h.property()],r.prototype,"size",void 0);k.__decorate([h.property()],r.prototype,"snippet",void 0);k.__decorate([h.property()],r.prototype,"sourceJSON",void 0);k.__decorate([h.property({type:String})],r.prototype,"sourceUrl",void 0);k.__decorate([h.property({type:String})],r.prototype,
"spatialReference",void 0);k.__decorate([h.property()],r.prototype,"tags",void 0);k.__decorate([h.property()],r.prototype,"thumbnail",void 0);k.__decorate([h.property({readOnly:!0})],r.prototype,"thumbnailUrl",null);k.__decorate([h.property()],r.prototype,"title",void 0);k.__decorate([h.property()],r.prototype,"type",void 0);k.__decorate([h.property()],r.prototype,"typeKeywords",void 0);k.__decorate([h.property({type:String,json:{read(d,G){L.has(G.type)&&(G=this.portal?.restUrl,d||=G&&this.id?`${G}/content/items/${this.id}/data`:
null);return d}}})],r.prototype,"url",void 0);k.__decorate([h.property({readOnly:!0})],r.prototype,"userItemUrl",null);return r=b=k.__decorate([I.subclass("esri.portal.PortalItem")],r)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x){function I(F,t){if(null==F)return F;F=F.replace(/^\/+/,"");null!=t&&M.isAbsolute(F)&&(F=M.makeRelative(F,t.itemUrl));return F?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}y=class extends y{constructor(F){super(F);this.portalItem=null}normalizeCtorArgs(F){return F?.portalItem&&F.path?{...F,path:I(F.path,F.portalItem)}:F}set path(F){null!=F&&M.isAbsolute(F)?r.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",F)}_castPath(F){return I(F,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(F="json",t){const J=this.cdnUrl;if(null==J)throw new C("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(J,{responseType:F,query:{token:this.portalItem.apiKey,_ts:t?.cacheBust?Date.now():null},signal:t?.signal})}async update(F,t){const {addOrUpdateResources:J}=await new Promise((K,u)=>e(["./support/resourceUtils"],K,u));await J(this.portalItem,[{resource:this,content:F,compress:t?.compress,access:t?.access}],"update",t);return this}hasPath(){return null!=this.path}};k.__decorate([a.property()],y.prototype,"portalItem",void 0);k.__decorate([a.property({type:String,
value:null})],y.prototype,"path",null);k.__decorate([p.cast("path")],y.prototype,"_castPath",null);k.__decorate([a.property({type:String,readOnly:!0})],y.prototype,"url",null);k.__decorate([a.property({type:String,readOnly:!0})],y.prototype,"cdnUrl",null);k.__decorate([a.property({type:String,readOnly:!0})],y.prototype,"itemRelativeUrl",null);return y=k.__decorate([x.subclass("esri.portal.PortalItemResource")],y)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(e,k,y,C,r,M,a){k=class extends k{constructor(p){super(p);this.rating=this.created=null}};e.__decorate([y.property()],k.prototype,"created",void 0);e.__decorate([y.property()],k.prototype,"rating",void 0);return k=e.__decorate([a.subclass("esri.portal.PortalRating")],k)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(e,k,y,C){function r(b,q){var L=q?.url?.path;b&&L&&(b=y.makeAbsolute(b,L,{preserveProtocolRelative:!0}),
q.portalItem&&q.readResourcePaths&&(L=y.makeRelative(b,q.portalItem.itemUrl),null!=L&&K.test(L)&&q.readResourcePaths.push(q.portalItem.resourceFromPath(L).path)));return(b=I(b,q?.portal))&&J.test(b)?F(b):b}function M(b,q,L=e.MarkKeep.YES){b=b&&J.test(b)?t(b):b;if(null==b)return b;!y.isAbsolute(b)&&q?.blockedRelativeUrls&&q.blockedRelativeUrls.push(b);let d=y.makeAbsolute(b);if(q){var G=q.verifyItemRelativeUrls?.rootPath||q.url?.path;if(G){G=I(G,q.portal);const P=I(d,q.portal);d=y.makeRelative(P,G,
G);null!=d&&d!==P&&d!==b&&q.verifyItemRelativeUrls&&q.verifyItemRelativeUrls.writtenUrls.push(d)}}d=x(d,q?.portal);y.isAbsolute(d)&&(d=y.normalize(d));q?.resources&&q?.portalItem&&!y.isAbsolute(d)&&!y.isDataProtocol(d)&&L===e.MarkKeep.YES&&q.resources.toKeep.push({resource:q.portalItem.resourceFromPath(d),compress:!1});return d}function a(b,q,L){return r(b,L)}function p(b,q,L,d){b=M(b,d);void 0!==b&&(q[L]=b)}function h(b){return(b?.match(J)??null)?.[1]??null}function w(b){b=b?.match(J)??null;if(null==
b)return null;b=b[2];const q=b.lastIndexOf("/");if(-1===q){const {path:G,extension:P}=y.splitPathExtension(b);return{prefix:null,filename:G,extension:P}}const {path:L,extension:d}=y.splitPathExtension(b.slice(q+1));return{prefix:b.slice(0,q),filename:L,extension:d}}function x(b,q){return q&&!q.isPortal&&q.urlKey&&q.customBaseUrl?y.changeDomain(b,`${q.urlKey}.${q.customBaseUrl}`,q.portalHostname):b}function I(b,q){if(!q||q.isPortal||!q.urlKey||!q.customBaseUrl)return b;const L=`${q.urlKey}.${q.customBaseUrl}`,
d=y.getAppUrl();return y.hasSameOrigin(d,`${d.scheme}://${L}`)?y.changeDomain(b,q.portalHostname,L):y.changeDomain(b,L,q.portalHostname)}function F(b){if(!b)return b||null;b&&k.id&&!k.id.findCredential(b)&&(b=C.normalizeArcGISOnlineOrgDomain(b),b=b.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),b=b.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),b=b.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return b}function t(b){if(!b)return b||
null;b=b.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");b=b.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(b=b.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&k.id&&!k.id.findCredential(b)&&(b=C.normalizeArcGISOnlineOrgDomain(b));return b}const J=/\/items\/([^/]+)\/resources\/(.*)/,K=/^\.\/resources\//;e.MarkKeep=void 0;(function(b){b[b.YES=0]="YES";b[b.NO=1]="NO"})(e.MarkKeep||(e.MarkKeep={}));const u=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return e.MarkKeep},ensureMainOnlineDomain:x,fromCDNUrl:t,fromJSON:r,itemIdFromResourceUrl:h,prefixAndFilenameFromResourceUrl:w,read:a,toCDNUrl:F,toJSON:M,write:p},Symbol.toStringTag,{value:"Module"}));e.ensureMainOnlineDomain=x;e.fromCDNUrl=t;e.fromJSON=r;e.itemIdFromResourceUrl=h;e.persistableUrlUtils=u;e.prefixAndFilenameFromResourceUrl=w;e.read=a;e.toCDNUrl=F;e.toJSON=M;e.write=p})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(e,
k,y){e.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return k.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};e.getBasemapTitle=async function(C){if(C){var r=C.includes("-vector")?C.slice(0,C.indexOf("-vector")):
C.includes("-3d")?C.slice(0,C.indexOf("-3d")):C,M=await y.fetchMessageBundle("esri/t9n/basemaps");return M[C]||M[r]}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(e,k,y,C,r,M,a,p){const h=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
k=class extends k{constructor(w){super(w);this.places=this.language=this.id=this.apiKey=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var w=p.getLocale().toLowerCase();switch(w){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}w=p.getLanguage(w);return"pt"===w?"pt-BR":w&&h.has(w)?
w:"global"}};e.__decorate([y.property()],k.prototype,"apiKey",void 0);e.__decorate([y.property()],k.prototype,"id",void 0);e.__decorate([y.property()],k.prototype,"language",void 0);e.__decorate([y.property()],k.prototype,"places",void 0);e.__decorate([y.property()],k.prototype,"serviceUrl",void 0);e.__decorate([y.property()],k.prototype,"worldview",void 0);return k=e.__decorate([a.subclass("esri.support.BasemapStyle")],k)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(e,k,y,C,r,M){function a(w,x){"maxScale"in w&&(x.maxScale=r.numberToJSON(w.maxScale)??void 0);"minScale"in w&&(x.minScale=r.numberToJSON(w.minScale)??void 0)}const p=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),h=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
e.disableRestrictedWriting=function(w){p.add(w);h.add(w)};e.enableRestrictedWriting=function(w){p.delete(w);h.delete(w)};e.getLayerJSON=function(w,x,I){if(!w.persistenceEnabled)return null;if(!("write"in w&&w.write))return I?.messages&&I.messages.push(new k("layer:unsupported",`Layers (${w.title}, ${w.id}) of type '${w.declaredClass}' cannot be persisted`,{layer:w})),null;if(M.isFeatureCollectionLayer(w)&&!w.isTable)x=w.resourceInfo;else{if(I.restrictedWebMapWriting){var F="basemap"===I.layerContainerType?
p:"operational-layers"===I.layerContainerType?h:null;F=null!=F?F.has(w.type)&&!M.isFeatureCollectionLayer(w):!0}else F=!0;if(F)return x={},w.write(x,I)?x:null}if(null!=x){x=y.clone(x);if(I=x)M.isFeatureCollectionLayer(w)?(F=C.getDeepValue("featureCollection.layers",I)?.[0]?.layerDefinition)&&a(w,F):"group"!==w.type&&a(w,I);if(I&&(I.id=w.id,"blendMode"in w&&(I.blendMode=w.blendMode,"normal"===I.blendMode&&delete I.blendMode),I.opacity=r.numberToJSON(w.opacity)??void 0,I.title=w.title||"Layer",I.visibility=
w.visible,"legendEnabled"in w&&"wmts"!==w.type))if(M.isFeatureCollectionLayer(w)){if(I=I.featureCollection)I.showLegend=w.legendEnabled}else I.showLegend=w.legendEnabled}return x};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(e,k,y){function C(a){return"scene"===a?.type}function r(a){return null!=a&&"object"===typeof a&&"type"in a&&"subtype-group"===a.type&&"sublayers"in a}function M(a){a=
a?.type;return"imagery-tile"===a||"tile"===a||"open-street-map"===a||"vector-tile"===a||"web-tile"===a||"wmts"===a}e.getEffectiveEditingEnabled=function(a){a:if("editingEnabled"in a)switch(a.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveEditingEnabled"in a?a.effectiveEditingEnabled:a.editingEnabled:!1};e.getEffectiveLayerCapabilities=function(a){a:if("capabilities"in
a)switch(a.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveCapabilities"in a?a.effectiveCapabilities:a.capabilities:null};e.getOwningPortalUrl=async function(a,p){var h=k.id?.findServerInfo(a);if(null!=h?.currentVersion)return h.owningSystemUrl||
null;h=a.toLowerCase().indexOf("/rest/services");if(-1===h)return null;a=`${a.slice(0,h)}/rest/info`;({data:p}=await y(a,{query:{f:"json"},responseType:"json",signal:null!=p?p.signal:null}));return p?.owningSystemUrl||null};e.getSubtypesFromLayer=function(a){return a?("subtypes"in a?a.subtypes:r(a.parent)?a.parent.subtypes:[])??[]:[]};e.getTileMaxtrixSetFromActiveLayer=function(a){if(a.activeLayer){const p=a.activeLayer.tileMatrixSet;if(p)return p;if(a=a.activeLayer.tileMatrixSets)return a}return null};
e.isBaseLayer=function(a){return null!=a?.parent&&"declaredClass"in a.parent&&"esri.Basemap"===a.parent.declaredClass&&a.parent.baseLayers.includes(a)};e.isBasemap3DSupportedLayer=function(a){return M(a)||C(a)};e.isBasemapSupportedTiledLayer=M;e.isFeatureCollectionLayer=function(a){return"feature"===a?.type&&!a.url&&"memory"===a.source?.type};e.isFeatureLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"feature"===a.type};e.isFeatureServiceLayer=function(a){return"feature"===a?.type&&
"feature-layer"===a.source?.type};e.isGraphicsLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"graphics"===a.type};e.isGroupLayer=function(a){return null!=a&&"type"in a&&"group"===a.type};e.isImageryTileLayer=function(a){return"imagery-tile"===a?.type};e.isIntegratedMeshLayer=function(a){return"integrated-mesh"===a||"integrated-mesh-3dtiles"===a};e.isIntegratedMeshOperationalLayer=function(a){return"IntegratedMeshLayer"===a||"IntegratedMesh3DTilesLayer"===a};e.isKnowledgeGraphLayer=
function(a){return null!=a&&"object"===typeof a&&"type"in a&&"knowledge-graph"===a.type&&"layers"in a};e.isLayerWithFeatureLayerSource=function(a){const p=a?.type;return("feature"===p||"subtype-group"===p||"oriented-imagery"===p)&&"feature-layer"===a.source?.type};e.isLinkChartLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"link-chart"===a.type&&"layers"in a};e.isMapNotesLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"map-notes"===a.type&&"sublayers"in a};e.isSceneLayer=
C;e.isSceneServiceLayer=function(a){a=a?.type;return"building-scene"===a||"integrated-mesh"===a||"point-cloud"===a||"scene"===a};e.isSubtypeGroupLayer=r;e.isSubtypeSublayer=function(a){return"subtype-sublayer"===a?.type};e.isTable=function(a){return null!=a&&"object"===typeof a&&"isTable"in a&&!!a.isTable};e.isTiledLayer=function(a){a=a?.type;return"base-tile"===a||"tile"===a||"elevation"===a||"imagery-tile"===a||"base-elevation"===a||"open-street-map"===a||"wcs"===a||"web-tile"===a||"wmts"===a||
"vector-tile"===a};e.isVoxelLayer=function(a){return"voxel"===a?.type};e.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};e.serializeLayerDefinitions=function(a){const p=/[:;]/,h=[];let w=!1;if(a&&(a.forEach((x,I)=>{h.push([I,x]);!w&&p.test(x)&&(w=!0)}),0<h.length)){if(w){const x={};h.forEach(I=>{x[I[0]]=I[1]});a=JSON.stringify(x)}else{const x=[];h.forEach(I=>{x.push(I[0]+":"+
I[1])});a=x.join(";")}return a}return null};e.serializeTimeOptions=function(a){if(a){var p=[];a.forEach((h,w)=>{p.push('"'+w+'":'+JSON.stringify(h))});if(p.length)return"{"+p.join(",")+"}"}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(e,k){e.canInterpolateEffects=function(y,C){const r=y.length>C.length?y:C;return(y.length>C.length?C:y).every((M,a)=>M.type===r[a].type)};e.effectEquals=function(y,C){y=
JSON.stringify(y??null);C=JSON.stringify(C??null);return y===C};e.isEffectFunctions=function(y){return(y=y[0])?"type"in y:!1};e.normalizeEffects=function(y,C){const r=y.length>C.length?y:C;y=y.length>C.length?C:y;for(C=y.length;C<r.length;C++)y.push(k.createEffectWithInitialValues(r[C]))};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32",
"./colorMatrixFunctions"],function(e,k,y,C,r){function M(t,J,K){return t+(J-t)*K}function a(t){return Math.round(1E3*y.px2pt(t))/1E3}class p{constructor(t,J,K){this.strength=t;this.radius=J;this.threshold=K;this.type="bloom"}interpolate(t,J,K){this.strength=M(t.strength,J.strength,K);this.radius=M(t.radius,J.radius,K);this.threshold=M(t.threshold,J.threshold,K)}clone(){return new p(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:a(this.radius),strength:this.strength,
threshold:this.threshold}}}class h{constructor(t){this.radius=t;this.type="blur"}interpolate(t,J,K){this.radius=Math.round(M(t.radius,J.radius,K))}clone(){return new h(this.radius)}toJSON(){return{type:"blur",radius:a(this.radius)}}}class w{constructor(t,J){this.type=t;this.amount=J;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(t,J,K){this.amount=
M(t.amount,J.amount,K);this._updateMatrix()}clone(){return new w(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||C.create();switch(this.type){case "brightness":this._colorMatrix=r.brightness(t,this.amount);break;case "contrast":this._colorMatrix=r.contrast(t,this.amount);break;case "grayscale":this._colorMatrix=r.grayscale(t,this.amount);break;case "invert":this._colorMatrix=r.invert(t,this.amount);break;case "saturate":this._colorMatrix=
r.saturate(t,this.amount);break;case "sepia":this._colorMatrix=r.sepia(t,this.amount)}}}class x{constructor(t,J,K,u){this.offsetX=t;this.offsetY=J;this.blurRadius=K;this.color=u;this.type="drop-shadow"}interpolate(t,J,K){this.offsetX=M(t.offsetX,J.offsetX,K);this.offsetY=M(t.offsetY,J.offsetY,K);this.blurRadius=M(t.blurRadius,J.blurRadius,K);this.color[0]=Math.round(M(t.color[0],J.color[0],K));this.color[1]=Math.round(M(t.color[1],J.color[1],K));this.color[2]=Math.round(M(t.color[2],J.color[2],K));
this.color[3]=M(t.color[3],J.color[3],K)}clone(){return new x(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];t[3]*=255;return{type:"drop-shadow",xoffset:a(this.offsetX),yoffset:a(this.offsetY),blurRadius:a(this.blurRadius),color:t}}}class I{constructor(t){this.angle=t;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(t,J,K){this.angle=M(t.angle,J.angle,K);this._updateMatrix()}clone(){return new I(this.angle)}toJSON(){return{type:"hue-rotate",
angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||C.create();this._colorMatrix=r.rotateHue(t,this.angle)}}class F{constructor(t){this.amount=t;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(t,J,K){this.amount=M(t.amount,J.amount,K)}clone(){return new F(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}e.BloomEffect=p;e.BlurEffect=h;e.ColorMatrixEffect=w;e.DropShadowEffect=x;e.HueRotateEffect=I;e.OpacityEffect=F;e.createEffectWithInitialValues=function(t){switch(t.type){case "grayscale":case "sepia":case "invert":return new w(t.type,
0);case "saturate":case "brightness":case "contrast":return new w(t.type,1);case "opacity":return new F(1);case "hue-rotate":return new I(0);case "blur":return new h(0);case "drop-shadow":return new x(0,0,0,[...k.getNamedColor("transparent")]);case "bloom":return new p(0,0,1)}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(e){function k(){const p=new Float32Array(16);p[0]=1;p[5]=1;p[10]=1;p[15]=
1;return p}function y(p){const h=new Float32Array(16);h[0]=p[0];h[1]=p[1];h[2]=p[2];h[3]=p[3];h[4]=p[4];h[5]=p[5];h[6]=p[6];h[7]=p[7];h[8]=p[8];h[9]=p[9];h[10]=p[10];h[11]=p[11];h[12]=p[12];h[13]=p[13];h[14]=p[14];h[15]=p[15];return h}function C(p,h,w,x,I,F,t,J,K,u,b,q,L,d,G,P){const S=new Float32Array(16);S[0]=p;S[1]=h;S[2]=w;S[3]=x;S[4]=I;S[5]=F;S[6]=t;S[7]=J;S[8]=K;S[9]=u;S[10]=b;S[11]=q;S[12]=L;S[13]=d;S[14]=G;S[15]=P;return S}function r(p,h){return new Float32Array(p,h,16)}const M=k(),a=Object.freeze(Object.defineProperty({__proto__:null,
IDENTITY:M,clone:y,create:k,createView:r,fromValues:C},Symbol.toStringTag,{value:"Module"}));e.IDENTITY=M;e.clone=y;e.create=k;e.createView=r;e.fromValues=C;e.mat4f32=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(e,k){e.brightness=(y,C)=>{y=k.set(y,C,0,0,0,0,C,0,0,0,0,C,0,0,0,0,1);return k.transpose(y,y)};e.contrast=(y,C)=>{y=k.set(y,C,0,0,.5-.5*C,0,C,0,.5-
.5*C,0,0,C,.5-.5*C,0,0,0,1);return k.transpose(y,y)};e.grayscale=(y,C)=>{C=1-C;y=k.set(y,.2126+.7874*C,.7152-.7152*C,.0722-.0722*C,0,.2126-.2126*C,.7152+.2848*C,.0722-.0722*C,0,.2126-.2126*C,.7152-.7152*C,.0722+.9278*C,0,0,0,0,1);return k.transpose(y,y)};e.invert=(y,C)=>{const r=1-2*C;y=k.set(y,r,0,0,C,0,r,0,C,0,0,r,C,0,0,0,1);return k.transpose(y,y)};e.rotateHue=(y,C)=>{const r=Math.sin(C*Math.PI/180);C=Math.cos(C*Math.PI/180);y=k.set(y,.213+.787*C-.213*r,.715-.715*C-.715*r,.072-.072*C+.928*r,0,
.213-.213*C+.143*r,.715+.285*C+.14*r,.072-.072*C-.283*r,0,.213-.213*C-.787*r,.715-.715*C+.715*r,.072+.928*C+.072*r,0,0,0,0,1);return k.transpose(y,y)};e.saturate=(y,C)=>{y=k.set(y,.213+.787*C,.715-.715*C,.072-.072*C,0,.213-.213*C,.715+.285*C,.072-.072*C,0,.213-.213*C,.715-.715*C,.072+.928*C,0,0,0,0,1);return k.transpose(y,y)};e.sepia=(y,C)=>{C=1-C;y=k.set(y,.393+.607*C,.769-.769*C,.189-.189*C,0,.349-.349*C,.686+.314*C,.168-.168*C,0,.272-.272*C,.534-.534*C,.131+.869*C,0,0,0,0,1);return k.transpose(y,
y)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(e,k,y){function C(m,E){m[0]=E[0];m[1]=E[1];m[2]=E[2];m[3]=E[3];m[4]=E[4];m[5]=E[5];m[6]=E[6];m[7]=E[7];m[8]=E[8];m[9]=E[9];m[10]=E[10];m[11]=E[11];m[12]=E[12];m[13]=E[13];m[14]=E[14];m[15]=E[15];return m}function r(m,E,W,aa,ja,B,H,N,V,Z,da,ea,la,ma,ua,qa,ra){m[0]=E;m[1]=W;m[2]=aa;m[3]=ja;m[4]=B;m[5]=H;m[6]=N;m[7]=V;m[8]=
Z;m[9]=da;m[10]=ea;m[11]=la;m[12]=ma;m[13]=ua;m[14]=qa;m[15]=ra;return m}function M(m){m[0]=1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function a(m,E){if(m===E){const W=E[1],aa=E[2],ja=E[3],B=E[6],H=E[7],N=E[11];m[1]=E[4];m[2]=E[8];m[3]=E[12];m[4]=W;m[6]=E[9];m[7]=E[13];m[8]=aa;m[9]=B;m[11]=E[14];m[12]=ja;m[13]=H;m[14]=N}else m[0]=E[0],m[1]=E[4],m[2]=E[8],m[3]=E[12],m[4]=E[1],m[5]=E[5],m[6]=E[9],m[7]=E[13],m[8]=E[2],m[9]=
E[6],m[10]=E[10],m[11]=E[14],m[12]=E[3],m[13]=E[7],m[14]=E[11],m[15]=E[15];return m}function p(m,E){h(m,E)||M(m);return m}function h(m,E){const W=E[0],aa=E[1],ja=E[2],B=E[3],H=E[4],N=E[5],V=E[6],Z=E[7],da=E[8],ea=E[9],la=E[10],ma=E[11],ua=E[12],qa=E[13],ra=E[14];E=E[15];const Ba=W*N-aa*H,ya=W*V-ja*H,Aa=W*Z-B*H,Ca=aa*V-ja*N,za=aa*Z-B*N,Fa=ja*Z-B*V,Ra=da*qa-ea*ua,bb=da*ra-la*ua,cb=da*E-ma*ua,Xa=ea*ra-la*qa,Ma=ea*E-ma*qa,Na=la*E-ma*ra;let ia=Ba*Na-ya*Ma+Aa*Xa+Ca*cb-za*bb+Fa*Ra;if(!ia)return null;ia=
1/ia;m[0]=(N*Na-V*Ma+Z*Xa)*ia;m[1]=(ja*Ma-aa*Na-B*Xa)*ia;m[2]=(qa*Fa-ra*za+E*Ca)*ia;m[3]=(la*za-ea*Fa-ma*Ca)*ia;m[4]=(V*cb-H*Na-Z*bb)*ia;m[5]=(W*Na-ja*cb+B*bb)*ia;m[6]=(ra*Aa-ua*Fa-E*ya)*ia;m[7]=(da*Fa-la*Aa+ma*ya)*ia;m[8]=(H*Ma-N*cb+Z*Ra)*ia;m[9]=(aa*cb-W*Ma-B*Ra)*ia;m[10]=(ua*za-qa*Aa+E*Ba)*ia;m[11]=(ea*Aa-da*za-ma*Ba)*ia;m[12]=(N*bb-H*Xa-V*Ra)*ia;m[13]=(W*Xa-aa*bb+ja*Ra)*ia;m[14]=(qa*ya-ua*Ca-ra*Ba)*ia;m[15]=(da*Ca-ea*ya+la*Ba)*ia;return m}function w(m,E){const W=E[0],aa=E[1],ja=E[2],B=E[3],H=
E[4],N=E[5],V=E[6],Z=E[7],da=E[8],ea=E[9],la=E[10],ma=E[11],ua=E[12],qa=E[13],ra=E[14];E=E[15];m[0]=N*(la*E-ma*ra)-ea*(V*E-Z*ra)+qa*(V*ma-Z*la);m[1]=-(aa*(la*E-ma*ra)-ea*(ja*E-B*ra)+qa*(ja*ma-B*la));m[2]=aa*(V*E-Z*ra)-N*(ja*E-B*ra)+qa*(ja*Z-B*V);m[3]=-(aa*(V*ma-Z*la)-N*(ja*ma-B*la)+ea*(ja*Z-B*V));m[4]=-(H*(la*E-ma*ra)-da*(V*E-Z*ra)+ua*(V*ma-Z*la));m[5]=W*(la*E-ma*ra)-da*(ja*E-B*ra)+ua*(ja*ma-B*la);m[6]=-(W*(V*E-Z*ra)-H*(ja*E-B*ra)+ua*(ja*Z-B*V));m[7]=W*(V*ma-Z*la)-H*(ja*ma-B*la)+da*(ja*Z-B*V);m[8]=
H*(ea*E-ma*qa)-da*(N*E-Z*qa)+ua*(N*ma-Z*ea);m[9]=-(W*(ea*E-ma*qa)-da*(aa*E-B*qa)+ua*(aa*ma-B*ea));m[10]=W*(N*E-Z*qa)-H*(aa*E-B*qa)+ua*(aa*Z-B*N);m[11]=-(W*(N*ma-Z*ea)-H*(aa*ma-B*ea)+da*(aa*Z-B*N));m[12]=-(H*(ea*ra-la*qa)-da*(N*ra-V*qa)+ua*(N*la-V*ea));m[13]=W*(ea*ra-la*qa)-da*(aa*ra-ja*qa)+ua*(aa*la-ja*ea);m[14]=-(W*(N*ra-V*qa)-H*(aa*ra-ja*qa)+ua*(aa*V-ja*N));m[15]=W*(N*la-V*ea)-H*(aa*la-ja*ea)+da*(aa*V-ja*N);return m}function x(m){const E=m[0],W=m[1],aa=m[2],ja=m[3],B=m[4],H=m[5],N=m[6],V=m[7],Z=
m[8],da=m[9],ea=m[10],la=m[11],ma=m[12],ua=m[13],qa=m[14];m=m[15];return(E*H-W*B)*(ea*m-la*qa)-(E*N-aa*B)*(da*m-la*ua)+(E*V-ja*B)*(da*qa-ea*ua)+(W*N-aa*H)*(Z*m-la*ma)-(W*V-ja*H)*(Z*qa-ea*ma)+(aa*V-ja*N)*(Z*ua-da*ma)}function I(m,E,W){const aa=E[0],ja=E[1],B=E[2],H=E[3],N=E[4],V=E[5],Z=E[6],da=E[7],ea=E[8],la=E[9],ma=E[10],ua=E[11],qa=E[12],ra=E[13],Ba=E[14];E=E[15];let ya=W[0],Aa=W[1],Ca=W[2],za=W[3];m[0]=ya*aa+Aa*N+Ca*ea+za*qa;m[1]=ya*ja+Aa*V+Ca*la+za*ra;m[2]=ya*B+Aa*Z+Ca*ma+za*Ba;m[3]=ya*H+Aa*da+
Ca*ua+za*E;ya=W[4];Aa=W[5];Ca=W[6];za=W[7];m[4]=ya*aa+Aa*N+Ca*ea+za*qa;m[5]=ya*ja+Aa*V+Ca*la+za*ra;m[6]=ya*B+Aa*Z+Ca*ma+za*Ba;m[7]=ya*H+Aa*da+Ca*ua+za*E;ya=W[8];Aa=W[9];Ca=W[10];za=W[11];m[8]=ya*aa+Aa*N+Ca*ea+za*qa;m[9]=ya*ja+Aa*V+Ca*la+za*ra;m[10]=ya*B+Aa*Z+Ca*ma+za*Ba;m[11]=ya*H+Aa*da+Ca*ua+za*E;ya=W[12];Aa=W[13];Ca=W[14];za=W[15];m[12]=ya*aa+Aa*N+Ca*ea+za*qa;m[13]=ya*ja+Aa*V+Ca*la+za*ra;m[14]=ya*B+Aa*Z+Ca*ma+za*Ba;m[15]=ya*H+Aa*da+Ca*ua+za*E;return m}function F(m,E,W){const aa=W[0],ja=W[1];W=W[2];
if(E===m)m[12]=E[0]*aa+E[4]*ja+E[8]*W+E[12],m[13]=E[1]*aa+E[5]*ja+E[9]*W+E[13],m[14]=E[2]*aa+E[6]*ja+E[10]*W+E[14],m[15]=E[3]*aa+E[7]*ja+E[11]*W+E[15];else{const B=E[0],H=E[1],N=E[2],V=E[3],Z=E[4],da=E[5],ea=E[6],la=E[7],ma=E[8],ua=E[9],qa=E[10],ra=E[11];m[0]=B;m[1]=H;m[2]=N;m[3]=V;m[4]=Z;m[5]=da;m[6]=ea;m[7]=la;m[8]=ma;m[9]=ua;m[10]=qa;m[11]=ra;m[12]=B*aa+Z*ja+ma*W+E[12];m[13]=H*aa+da*ja+ua*W+E[13];m[14]=N*aa+ea*ja+qa*W+E[14];m[15]=V*aa+la*ja+ra*W+E[15]}return m}function t(m,E,W){const aa=W[0],ja=
W[1];W=W[2];m[0]=E[0]*aa;m[1]=E[1]*aa;m[2]=E[2]*aa;m[3]=E[3]*aa;m[4]=E[4]*ja;m[5]=E[5]*ja;m[6]=E[6]*ja;m[7]=E[7]*ja;m[8]=E[8]*W;m[9]=E[9]*W;m[10]=E[10]*W;m[11]=E[11]*W;m[12]=E[12];m[13]=E[13];m[14]=E[14];m[15]=E[15];return m}function J(m,E,W,aa){var ja=aa[0],B=aa[1];aa=aa[2];var H=Math.sqrt(ja*ja+B*B+aa*aa);if(H<=y.getEpsilon())C(m,E);else{H=1/H;ja*=H;B*=H;aa*=H;var N=Math.sin(W),V=Math.cos(W),Z=1-V;W=E[0];H=E[1];var da=E[2],ea=E[3],la=E[4],ma=E[5],ua=E[6],qa=E[7],ra=E[8],Ba=E[9],ya=E[10],Aa=E[11],
Ca=ja*ja*Z+V,za=B*ja*Z+aa*N,Fa=aa*ja*Z-B*N,Ra=ja*B*Z-aa*N,bb=B*B*Z+V,cb=aa*B*Z+ja*N,Xa=ja*aa*Z+B*N;ja=B*aa*Z-ja*N;B=aa*aa*Z+V;m[0]=W*Ca+la*za+ra*Fa;m[1]=H*Ca+ma*za+Ba*Fa;m[2]=da*Ca+ua*za+ya*Fa;m[3]=ea*Ca+qa*za+Aa*Fa;m[4]=W*Ra+la*bb+ra*cb;m[5]=H*Ra+ma*bb+Ba*cb;m[6]=da*Ra+ua*bb+ya*cb;m[7]=ea*Ra+qa*bb+Aa*cb;m[8]=W*Xa+la*ja+ra*B;m[9]=H*Xa+ma*ja+Ba*B;m[10]=da*Xa+ua*ja+ya*B;m[11]=ea*Xa+qa*ja+Aa*B;E!==m&&(m[12]=E[12],m[13]=E[13],m[14]=E[14],m[15]=E[15])}}function K(m,E,W){const aa=Math.sin(W);W=Math.cos(W);
const ja=E[4],B=E[5],H=E[6],N=E[7],V=E[8],Z=E[9],da=E[10],ea=E[11];E!==m&&(m[0]=E[0],m[1]=E[1],m[2]=E[2],m[3]=E[3],m[12]=E[12],m[13]=E[13],m[14]=E[14],m[15]=E[15]);m[4]=ja*W+V*aa;m[5]=B*W+Z*aa;m[6]=H*W+da*aa;m[7]=N*W+ea*aa;m[8]=V*W-ja*aa;m[9]=Z*W-B*aa;m[10]=da*W-H*aa;m[11]=ea*W-N*aa;return m}function u(m,E,W){const aa=Math.sin(W);W=Math.cos(W);const ja=E[0],B=E[1],H=E[2],N=E[3],V=E[8],Z=E[9],da=E[10],ea=E[11];E!==m&&(m[4]=E[4],m[5]=E[5],m[6]=E[6],m[7]=E[7],m[12]=E[12],m[13]=E[13],m[14]=E[14],m[15]=
E[15]);m[0]=ja*W-V*aa;m[1]=B*W-Z*aa;m[2]=H*W-da*aa;m[3]=N*W-ea*aa;m[8]=ja*aa+V*W;m[9]=B*aa+Z*W;m[10]=H*aa+da*W;m[11]=N*aa+ea*W;return m}function b(m,E,W){const aa=Math.sin(W);W=Math.cos(W);const ja=E[0],B=E[1],H=E[2],N=E[3],V=E[4],Z=E[5],da=E[6],ea=E[7];E!==m&&(m[8]=E[8],m[9]=E[9],m[10]=E[10],m[11]=E[11],m[12]=E[12],m[13]=E[13],m[14]=E[14],m[15]=E[15]);m[0]=ja*W+V*aa;m[1]=B*W+Z*aa;m[2]=H*W+da*aa;m[3]=N*W+ea*aa;m[4]=V*W-ja*aa;m[5]=Z*W-B*aa;m[6]=da*W-H*aa;m[7]=ea*W-N*aa;return m}function q(m,E){m[0]=
1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=E[0];m[13]=E[1];m[14]=E[2];m[15]=1;return m}function L(m,E){m[0]=E[0];m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=E[1];m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=E[2];m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function d(m,E,W){if(0===E)return M(m);let aa=W[0],ja=W[1];W=W[2];var B=Math.sqrt(aa*aa+ja*ja+W*W);if(B<=y.getEpsilon())return null;B=1/B;aa*=B;ja*=B;W*=B;B=Math.sin(E);E=Math.cos(E);const H=1-E;m[0]=aa*aa*H+E;m[1]=ja*
aa*H+W*B;m[2]=W*aa*H-ja*B;m[3]=0;m[4]=aa*ja*H-W*B;m[5]=ja*ja*H+E;m[6]=W*ja*H+aa*B;m[7]=0;m[8]=aa*W*H+ja*B;m[9]=ja*W*H-aa*B;m[10]=W*W*H+E;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function G(m,E){const W=Math.sin(E);E=Math.cos(E);m[0]=1;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=E;m[6]=W;m[7]=0;m[8]=0;m[9]=-W;m[10]=E;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function P(m,E){const W=Math.sin(E);E=Math.cos(E);m[0]=E;m[1]=0;m[2]=-W;m[3]=0;m[4]=0;m[5]=1;m[6]=0;m[7]=0;m[8]=W;m[9]=0;m[10]=E;m[11]=0;
m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function S(m,E){const W=Math.sin(E);E=Math.cos(E);m[0]=E;m[1]=W;m[2]=0;m[3]=0;m[4]=-W;m[5]=E;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=1;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function ca(m,E,W){var aa=E[0],ja=E[1],B=E[2],H=E[3],N=aa+aa,V=ja+ja;const Z=B+B;E=aa*N;const da=aa*V;aa*=Z;const ea=ja*V;ja*=Z;B*=Z;N*=H;V*=H;H*=Z;m[0]=1-(ea+B);m[1]=da+H;m[2]=aa-V;m[3]=0;m[4]=da-H;m[5]=1-(E+B);m[6]=ja+N;m[7]=0;m[8]=aa+V;m[9]=ja-N;m[10]=1-(E+ea);m[11]=0;m[12]=W[0];
m[13]=W[1];m[14]=W[2];m[15]=1;return m}function U(m,E){const W=La,aa=-E[0],ja=-E[1],B=-E[2],H=E[3],N=E[4],V=E[5],Z=E[6],da=E[7],ea=aa*aa+ja*ja+B*B+H*H;0<ea?(W[0]=2*(N*H+da*aa+V*B-Z*ja)/ea,W[1]=2*(V*H+da*ja+Z*aa-N*B)/ea,W[2]=2*(Z*H+da*B+N*ja-V*aa)/ea):(W[0]=2*(N*H+da*aa+V*B-Z*ja),W[1]=2*(V*H+da*ja+Z*aa-N*B),W[2]=2*(Z*H+da*B+N*ja-V*aa));ca(m,E,W);return m}function T(m,E){m[0]=E[12];m[1]=E[13];m[2]=E[14];return m}function v(m,E){const W=E[0],aa=E[1],ja=E[2],B=E[4],H=E[5],N=E[6],V=E[8],Z=E[9];E=E[10];
m[0]=Math.sqrt(W*W+aa*aa+ja*ja);m[1]=Math.sqrt(B*B+H*H+N*N);m[2]=Math.sqrt(V*V+Z*Z+E*E);return m}function Q(m,E){const W=E[0]+E[5]+E[10];let aa=0;0<W?(aa=2*Math.sqrt(W+1),m[3]=.25*aa,m[0]=(E[6]-E[9])/aa,m[1]=(E[8]-E[2])/aa,m[2]=(E[1]-E[4])/aa):E[0]>E[5]&&E[0]>E[10]?(aa=2*Math.sqrt(1+E[0]-E[5]-E[10]),m[3]=(E[6]-E[9])/aa,m[0]=.25*aa,m[1]=(E[1]+E[4])/aa,m[2]=(E[8]+E[2])/aa):E[5]>E[10]?(aa=2*Math.sqrt(1+E[5]-E[0]-E[10]),m[3]=(E[8]-E[2])/aa,m[0]=(E[1]+E[4])/aa,m[1]=.25*aa,m[2]=(E[6]+E[9])/aa):(aa=2*Math.sqrt(1+
E[10]-E[0]-E[5]),m[3]=(E[1]-E[4])/aa,m[0]=(E[8]+E[2])/aa,m[1]=(E[6]+E[9])/aa,m[2]=.25*aa);return m}function g(m,E,W,aa){var ja=E[0],B=E[1],H=E[2],N=E[3],V=ja+ja,Z=B+B,da=H+H;E=ja*V;const ea=ja*Z;ja*=da;const la=B*Z;B*=da;H*=da;V*=N;Z*=N;N*=da;da=aa[0];const ma=aa[1];aa=aa[2];m[0]=(1-(la+H))*da;m[1]=(ea+N)*da;m[2]=(ja-Z)*da;m[3]=0;m[4]=(ea-N)*ma;m[5]=(1-(E+H))*ma;m[6]=(B+V)*ma;m[7]=0;m[8]=(ja+Z)*aa;m[9]=(B-V)*aa;m[10]=(1-(E+la))*aa;m[11]=0;m[12]=W[0];m[13]=W[1];m[14]=W[2];m[15]=1;return m}function f(m,
E,W,aa,ja){var B=E[0],H=E[1],N=E[2],V=E[3],Z=B+B,da=H+H,ea=N+N;E=B*Z;var la=B*da,ma=B*ea;B=H*da;H*=ea;var ua=N*ea;N=V*Z;da*=V;const qa=V*ea;var ra=aa[0],Ba=aa[1];ea=aa[2];aa=ja[0];V=ja[1];ja=ja[2];Z=(1-(B+ua))*ra;const ya=(la+qa)*ra;ra*=ma-da;la=(la-qa)*Ba;ua=(1-(E+ua))*Ba;Ba*=H+N;ma=(ma+da)*ea;H=(H-N)*ea;E=(1-(E+B))*ea;m[0]=Z;m[1]=ya;m[2]=ra;m[3]=0;m[4]=la;m[5]=ua;m[6]=Ba;m[7]=0;m[8]=ma;m[9]=H;m[10]=E;m[11]=0;m[12]=W[0]+aa-(Z*aa+la*V+ma*ja);m[13]=W[1]+V-(ya*aa+ua*V+H*ja);m[14]=W[2]+ja-(ra*aa+Ba*
V+E*ja);m[15]=1;return m}function l(m,E){var W=E[0],aa=E[1],ja=E[2];E=E[3];var B=W+W,H=aa+aa;const N=ja+ja;W*=B;const V=aa*B;aa*=H;const Z=ja*B,da=ja*H;ja*=N;B*=E;H*=E;E*=N;m[0]=1-aa-ja;m[1]=V+E;m[2]=Z-H;m[3]=0;m[4]=V-E;m[5]=1-W-ja;m[6]=da+B;m[7]=0;m[8]=Z+H;m[9]=da-B;m[10]=1-W-aa;m[11]=0;m[12]=0;m[13]=0;m[14]=0;m[15]=1;return m}function z(m,E,W,aa,ja,B,H){const N=1/(W-E),V=1/(ja-aa),Z=1/(B-H);m[0]=2*B*N;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=2*B*V;m[6]=0;m[7]=0;m[8]=(W+E)*N;m[9]=(ja+aa)*V;m[10]=(H+B)*Z;
m[11]=-1;m[12]=0;m[13]=0;m[14]=H*B*2*Z;m[15]=0;return m}function O(m,E,W,aa,ja){E=1/Math.tan(E/2);let B=void 0;m[0]=E/W;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=E;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[11]=-1;m[12]=0;m[13]=0;m[15]=0;null!=ja&&Infinity!==ja?(B=1/(aa-ja),m[10]=(ja+aa)*B,m[14]=2*ja*aa*B):(m[10]=-1,m[14]=-2*aa);return m}function X(m,E,W,aa){const ja=Math.tan(E.upDegrees*Math.PI/180),B=Math.tan(E.downDegrees*Math.PI/180),H=Math.tan(E.leftDegrees*Math.PI/180);E=Math.tan(E.rightDegrees*Math.PI/180);const N=
2/(H+E),V=2/(ja+B);m[0]=N;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=V;m[6]=0;m[7]=0;m[8]=-((H-E)*N*.5);m[9]=(ja-B)*V*.5;m[10]=aa/(W-aa);m[11]=-1;m[12]=0;m[13]=0;m[14]=aa*W/(W-aa);m[15]=0;return m}function ba(m,E,W,aa,ja,B,H){const N=1/(E-W),V=1/(aa-ja),Z=1/(B-H);m[0]=-2*N;m[1]=0;m[2]=0;m[3]=0;m[4]=0;m[5]=-2*V;m[6]=0;m[7]=0;m[8]=0;m[9]=0;m[10]=2*Z;m[11]=0;m[12]=(E+W)*N;m[13]=(ja+aa)*V;m[14]=(H+B)*Z;m[15]=1;return m}function fa(m,E,W,aa){const ja=E[0],B=E[1];E=E[2];let H=ja-W[0],N=B-W[1];W=E-W[2];var V=y.getEpsilon();
if(Math.abs(H)<V&&Math.abs(N)<V&&Math.abs(W)<V)M(m);else{var Z=1/Math.sqrt(H*H+N*N+W*W);H*=Z;N*=Z;W*=Z;Z=aa[0];var da=aa[1];V=aa[2];aa=da*W-V*N;V=V*H-Z*W;da=Z*N-da*H;(Z=Math.sqrt(aa*aa+V*V+da*da))?(Z=1/Z,aa*=Z,V*=Z,da*=Z):da=V=aa=0;var ea=N*da-W*V,la=W*aa-H*da,ma=H*V-N*aa;(Z=Math.sqrt(ea*ea+la*la+ma*ma))?(Z=1/Z,ea*=Z,la*=Z,ma*=Z):ma=la=ea=0;m[0]=aa;m[1]=ea;m[2]=H;m[3]=0;m[4]=V;m[5]=la;m[6]=N;m[7]=0;m[8]=da;m[9]=ma;m[10]=W;m[11]=0;m[12]=-(aa*ja+V*B+da*E);m[13]=-(ea*ja+la*B+ma*E);m[14]=-(H*ja+N*B+W*
E);m[15]=1}}function na(m,E,W,aa){const ja=E[0],B=E[1];E=E[2];var H=aa[0];const N=aa[1];var V=aa[2];aa=ja-W[0];let Z=B-W[1];W=E-W[2];let da=aa*aa+Z*Z+W*W;0<da&&(da=1/Math.sqrt(da),aa*=da,Z*=da,W*=da);let ea=N*W-V*Z;V=V*aa-H*W;H=H*Z-N*aa;da=ea*ea+V*V+H*H;0<da&&(da=1/Math.sqrt(da),ea*=da,V*=da,H*=da);m[0]=ea;m[1]=V;m[2]=H;m[3]=0;m[4]=Z*H-W*V;m[5]=W*ea-aa*H;m[6]=aa*V-Z*ea;m[7]=0;m[8]=aa;m[9]=Z;m[10]=W;m[11]=0;m[12]=ja;m[13]=B;m[14]=E;m[15]=1;return m}function oa(m){return"mat4("+m[0]+", "+m[1]+", "+
m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+", "+m[9]+", "+m[10]+", "+m[11]+", "+m[12]+", "+m[13]+", "+m[14]+", "+m[15]+")"}function pa(m){return Math.sqrt(m[0]**2+m[1]**2+m[2]**2+m[3]**2+m[4]**2+m[5]**2+m[6]**2+m[7]**2+m[8]**2+m[9]**2+m[10]**2+m[11]**2+m[12]**2+m[13]**2+m[14]**2+m[15]**2)}function sa(m,E,W){m[0]=E[0]+W[0];m[1]=E[1]+W[1];m[2]=E[2]+W[2];m[3]=E[3]+W[3];m[4]=E[4]+W[4];m[5]=E[5]+W[5];m[6]=E[6]+W[6];m[7]=E[7]+W[7];m[8]=E[8]+W[8];m[9]=E[9]+W[9];m[10]=E[10]+W[10];m[11]=
E[11]+W[11];m[12]=E[12]+W[12];m[13]=E[13]+W[13];m[14]=E[14]+W[14];m[15]=E[15]+W[15];return m}function wa(m,E,W){m[0]=E[0]-W[0];m[1]=E[1]-W[1];m[2]=E[2]-W[2];m[3]=E[3]-W[3];m[4]=E[4]-W[4];m[5]=E[5]-W[5];m[6]=E[6]-W[6];m[7]=E[7]-W[7];m[8]=E[8]-W[8];m[9]=E[9]-W[9];m[10]=E[10]-W[10];m[11]=E[11]-W[11];m[12]=E[12]-W[12];m[13]=E[13]-W[13];m[14]=E[14]-W[14];m[15]=E[15]-W[15];return m}function xa(m,E,W){m[0]=E[0]*W;m[1]=E[1]*W;m[2]=E[2]*W;m[3]=E[3]*W;m[4]=E[4]*W;m[5]=E[5]*W;m[6]=E[6]*W;m[7]=E[7]*W;m[8]=E[8]*
W;m[9]=E[9]*W;m[10]=E[10]*W;m[11]=E[11]*W;m[12]=E[12]*W;m[13]=E[13]*W;m[14]=E[14]*W;m[15]=E[15]*W;return m}function Da(m,E,W,aa){m[0]=E[0]+W[0]*aa;m[1]=E[1]+W[1]*aa;m[2]=E[2]+W[2]*aa;m[3]=E[3]+W[3]*aa;m[4]=E[4]+W[4]*aa;m[5]=E[5]+W[5]*aa;m[6]=E[6]+W[6]*aa;m[7]=E[7]+W[7]*aa;m[8]=E[8]+W[8]*aa;m[9]=E[9]+W[9]*aa;m[10]=E[10]+W[10]*aa;m[11]=E[11]+W[11]*aa;m[12]=E[12]+W[12]*aa;m[13]=E[13]+W[13]*aa;m[14]=E[14]+W[14]*aa;m[15]=E[15]+W[15]*aa;return m}function Ea(m,E){return m[0]===E[0]&&m[1]===E[1]&&m[2]===
E[2]&&m[3]===E[3]&&m[4]===E[4]&&m[5]===E[5]&&m[6]===E[6]&&m[7]===E[7]&&m[8]===E[8]&&m[9]===E[9]&&m[10]===E[10]&&m[11]===E[11]&&m[12]===E[12]&&m[13]===E[13]&&m[14]===E[14]&&m[15]===E[15]}function Ja(m,E){if(m===E)return!0;const W=m[0],aa=m[1],ja=m[2],B=m[3],H=m[4],N=m[5],V=m[6],Z=m[7],da=m[8],ea=m[9],la=m[10],ma=m[11],ua=m[12],qa=m[13],ra=m[14];m=m[15];const Ba=E[0],ya=E[1],Aa=E[2],Ca=E[3],za=E[4],Fa=E[5],Ra=E[6],bb=E[7],cb=E[8],Xa=E[9],Ma=E[10],Na=E[11],ia=E[12],ic=E[13],Kb=E[14];E=E[15];const Ia=
y.getEpsilon();return Math.abs(W-Ba)<=Ia*Math.max(1,Math.abs(W),Math.abs(Ba))&&Math.abs(aa-ya)<=Ia*Math.max(1,Math.abs(aa),Math.abs(ya))&&Math.abs(ja-Aa)<=Ia*Math.max(1,Math.abs(ja),Math.abs(Aa))&&Math.abs(B-Ca)<=Ia*Math.max(1,Math.abs(B),Math.abs(Ca))&&Math.abs(H-za)<=Ia*Math.max(1,Math.abs(H),Math.abs(za))&&Math.abs(N-Fa)<=Ia*Math.max(1,Math.abs(N),Math.abs(Fa))&&Math.abs(V-Ra)<=Ia*Math.max(1,Math.abs(V),Math.abs(Ra))&&Math.abs(Z-bb)<=Ia*Math.max(1,Math.abs(Z),Math.abs(bb))&&Math.abs(da-cb)<=Ia*
Math.max(1,Math.abs(da),Math.abs(cb))&&Math.abs(ea-Xa)<=Ia*Math.max(1,Math.abs(ea),Math.abs(Xa))&&Math.abs(la-Ma)<=Ia*Math.max(1,Math.abs(la),Math.abs(Ma))&&Math.abs(ma-Na)<=Ia*Math.max(1,Math.abs(ma),Math.abs(Na))&&Math.abs(ua-ia)<=Ia*Math.max(1,Math.abs(ua),Math.abs(ia))&&Math.abs(qa-ic)<=Ia*Math.max(1,Math.abs(qa),Math.abs(ic))&&Math.abs(ra-Kb)<=Ia*Math.max(1,Math.abs(ra),Math.abs(Kb))&&Math.abs(m-E)<=Ia*Math.max(1,Math.abs(m),Math.abs(E))}function Sa(m){const E=y.getEpsilon(),W=m[0],aa=m[1],ja=
m[2],B=m[4],H=m[5],N=m[6],V=m[8],Z=m[9];m=m[10];return Math.abs(1-(W*W+B*B+V*V))<=E&&Math.abs(1-(aa*aa+H*H+Z*Z))<=E&&Math.abs(1-(ja*ja+N*N+m*m))<=E}function ab(m){return 1===m[0]&&0===m[1]&&0===m[2]&&0===m[4]&&1===m[5]&&0===m[6]&&0===m[8]&&0===m[9]&&1===m[10]}const La=k.create();k=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:w,copy:C,determinant:x,equals:Ja,exactEquals:Ea,frob:pa,fromQuat:l,fromQuat2:U,fromRotation:d,fromRotationTranslation:ca,fromRotationTranslationScale:g,
fromRotationTranslationScaleOrigin:f,fromScaling:L,fromTranslation:q,fromXRotation:G,fromYRotation:P,fromZRotation:S,frustum:z,getRotation:Q,getScaling:v,getTranslation:T,hasIdentityRotation:ab,identity:M,invert:h,invertOrIdentity:p,isOrthoNormal:Sa,lookAt:fa,mul:I,multiply:I,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:ba,perspective:O,perspectiveFromFieldOfView:X,rotate:J,rotateX:K,rotateY:u,rotateZ:b,scale:t,set:r,str:oa,sub:wa,subtract:wa,targetTo:na,translate:F,transpose:a},Symbol.toStringTag,
{value:"Module"}));e.add=sa;e.adjoint=w;e.copy=C;e.determinant=x;e.equals=Ja;e.exactEquals=Ea;e.frob=pa;e.fromQuat=l;e.fromQuat2=U;e.fromRotation=d;e.fromRotationTranslation=ca;e.fromRotationTranslationScale=g;e.fromRotationTranslationScaleOrigin=f;e.fromScaling=L;e.fromTranslation=q;e.fromXRotation=G;e.fromYRotation=P;e.fromZRotation=S;e.frustum=z;e.getRotation=Q;e.getScaling=v;e.getTranslation=T;e.hasIdentityRotation=ab;e.identity=M;e.invert=h;e.invertOrIdentity=p;e.isOrthoNormal=Sa;e.lookAt=fa;
e.mat4=k;e.mul=I;e.multiply=I;e.multiplyScalar=xa;e.multiplyScalarAndAdd=Da;e.ortho=ba;e.perspective=O;e.perspectiveFromFieldOfView=X;e.rotate=J;e.rotateX=K;e.rotateY=u;e.rotateZ=b;e.scale=t;e.set=r;e.str=oa;e.sub=wa;e.subtract=wa;e.targetTo=na;e.translate=F;e.transpose=a;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition","../rest/support/generateRendererUtils"],function(e,k,y){function C(g){return null==
g||"string"===typeof g&&!g?"\x3cNull\x3e":g}function r(g){const f=null!=g.minValue||null!=g.maxValue,l=!!g.sqlExpression&&g.supportsSQLExpression;return!(null!=g.normalizationField||null!=g.normalizationType)&&!f&&!l}function M(g){const {values:f,useSampleStdDev:l,supportsNullCount:z,outStatisticTypes:O}=g;var X=Number.POSITIVE_INFINITY;let ba=Number.NEGATIVE_INFINITY,fa=null,na=null;var oa=null;let pa=null,sa=0;const wa=null==g.minValue?-Infinity:g.minValue,xa=null==g.maxValue?Infinity:g.maxValue;
for(const Da of f)Number.isFinite(Da)?Da>=wa&&Da<=xa&&(fa=null===fa?Da:fa+Da,X=Math.min(X,Da),ba=Math.max(ba,Da),sa++):"string"===typeof Da&&sa++;if(sa&&null!=fa){na=fa/sa;oa=0;for(const Da of f)Number.isFinite(Da)&&Da>=wa&&Da<=xa&&(oa+=(Da-na)**2);pa=l?1<sa?oa/(sa-1):0:0<sa?oa/sa:0;oa=Math.sqrt(pa)}else ba=X=null;X={avg:na,count:sa,max:ba,min:X,stddev:oa,sum:fa,variance:pa};z&&(X.nullcount=f.length-sa);!g.percentileParams||O?.include?.length&&!O.include.includes("median")||O?.exclude?.length&&O.exclude.includes("median")||
(X.median=a(f,g.percentileParams));return X}function a(g,f){const {fieldType:l,value:z,orderBy:O,isDiscrete:X}=f,ba=p(l,"desc"===O);g=[...g].filter(pa=>null!=pa).sort((pa,sa)=>ba(pa,sa));if(0===g.length)return null;if(0>=z)return g[0];if(1<=z)return g[g.length-1];var fa=(g.length-1)*z,na=Math.floor(fa);f=na+1;fa%=1;na=g[na];const oa=g[f];return f>=g.length||X||"string"===typeof na||"string"===typeof oa?na:na*(1-fa)+oa*fa}function p(g,f){if(g){if(q.has(g))return f?v:Q;if(L.has(g))return h(f,!1);if("esriFieldTypeTimestampOffset"===
g)return f?ca:S;const ba=h(f,!0);if("esriFieldTypeString"===g)return ba;if("esriFieldTypeGUID"===g||"esriFieldTypeGlobalID"===g)return(fa,na)=>ba(w(fa),w(na))}const l=f?1:-1,z=f?v:Q,O=h(f,!0),X=f?G:P;return(ba,fa)=>"number"===typeof ba&&"number"===typeof fa?z(ba,fa):"string"===typeof ba&&"string"===typeof fa?O(ba,fa):X(ba,fa)??l}function h(g,f){if(!f)return g?T:U;const l=g?G:P;return g?(z,O)=>{const X=l(z,O);if(null!=X)return X;z=z.toUpperCase();O=O.toUpperCase();return z>O?-1:z<O?1:0}:(z,O)=>{const X=
l(z,O);if(null!=X)return X;z=z.toUpperCase();O=O.toUpperCase();return z<O?-1:z>O?1:0}}function w(g){return g.slice(24,36)+g.slice(19,23)+g.slice(16,18)+g.slice(14,16)+g.slice(11,13)+g.slice(9,11)+g.slice(6,8)+g.slice(4,6)+g.slice(2,4)+g.slice(0,2)}function x(g){return"coded-value"!==g?.type?[]:g.codedValues.map(f=>f.code)}function I(g,f){const l=t({field:f.field,normalizationType:f.normalizationType,normalizationField:f.normalizationField,classificationMethod:f.classificationMethod,standardDeviationInterval:f.standardDeviationInterval,
breakCount:f.numClasses||5});g=F(g,f.minValue,f.maxValue);return y.createGenerateRendererClassBreaks({definition:l,values:g,normalizationTotal:f.normalizationTotal})}function F(g,f,l){const z=null==f?-Infinity:f,O=null==l?Infinity:l;return g.filter(X=>Number.isFinite(X)&&X>=z&&X<=O)}function t(g){const {breakCount:f,field:l,normalizationField:z,normalizationType:O}=g,X=g.classificationMethod||"equal-interval";return new k({breakCount:f,classificationField:l,classificationMethod:X,normalizationField:"field"===
O?z:void 0,normalizationType:O,standardDeviationInterval:"standard-deviation"===X?g.standardDeviationInterval||1:void 0,definedInterval:"defined-interval"===X?g.definedInterval:void 0})}function J(g,f){const {field:l,classificationMethod:z,standardDeviationInterval:O,normalizationType:X,normalizationField:ba,normalizationTotal:fa,minValue:na,maxValue:oa}=f,pa=f.numBins||10;let sa=f=null,wa=null;z&&"equal-interval"!==z||X?({classBreaks:g}=I(g,{field:l,normalizationType:X,normalizationField:ba,normalizationTotal:fa,
classificationMethod:z,standardDeviationInterval:O,minValue:na,maxValue:oa,numClasses:pa}),f=g[0].minValue,sa=g[g.length-1].maxValue,wa=g.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=oa?(f=na,sa=oa):(g=M({values:g,minValue:na,maxValue:oa,useSampleStdDev:!X,supportsNullCount:r({normalizationType:X,normalizationField:ba,minValue:na,maxValue:oa})}),f=g.min??null,sa=g.max??null),wa=u(f??0,sa??0,pa));return{min:f,max:sa,intervals:wa}}function K(g,f){let l=-1;for(let z=g.length-1;0<=z;z--)if(f>=
g[z][0]){l=z;break}return l}function u(g,f,l){const z=(f-g)/l,O=[];let X;for(let ba=1;ba<=l;ba++)X=g+z,X=Number(X.toFixed(16)),O.push([g,ba===l?f:X]),g=X;return O}const b=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,q=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),L=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),d="min max avg stddev count sum variance nullcount median".split(" "),
G=(g,f)=>null==g?null==f?0:1:null==f?-1:null,P=(g,f)=>null==g?null==f?0:-1:null==f?1:null,S=(g,f)=>P(g,f)??(g===f?0:(new Date(g)).getTime()-(new Date(f)).getTime()),ca=(g,f)=>G(g,f)??(g===f?0:(new Date(f)).getTime()-(new Date(g)).getTime()),U=(g,f)=>P(g,f)??(g===f?0:g<f?-1:1),T=(g,f)=>G(g,f)??(g===f?0:g<f?1:-1),v=(g,f)=>G(g,f)??f-g,Q=(g,f)=>P(g,f)??g-f;e.calculateClassBreaks=I;e.calculateHistogram=function(g,f){var l=J(g,f);if(null==l.min&&null==l.max)return{bins:[],minValue:l.min,maxValue:l.max,
normalizationTotal:f.normalizationTotal};const z=l.intervals,O=l.min??0;l=l.max??0;const X=z.map((ba,fa)=>({minValue:z[fa][0],maxValue:z[fa][1],count:0}));for(const ba of g)null!=ba&&ba>=O&&ba<=l&&(g=K(z,ba),-1<g&&X[g].count++);return{bins:X,minValue:O,maxValue:l,normalizationTotal:f.normalizationTotal}};e.calculatePercentile=a;e.calculateStatistics=M;e.calculateStringStatistics=function(g){const {outStatisticTypes:f}=g,l=g.returnDistinct?[...(new Set(g.values))]:g.values;var z=l.filter(X=>null!=
X).sort();const O=z.length;z={count:O,min:z[0],max:z[O-1]};g.supportsNullCount&&(z.nullcount=l.length-O);!g.percentileParams||f?.include?.length&&!f.include.includes("median")||f?.exclude?.length&&f.exclude.includes("median")||(z.median=a(l,g.percentileParams));return z};e.calculateUniqueValuesCount=function(g){const f={};for(let l of g){if(null==l||"string"===typeof l&&""===l.trim())l=null;null==f[l]?f[l]={count:1,data:l}:f[l].count++}return{count:f}};e.createClassBreaksDefinition=t;e.createUVResult=
function(g,f,l,z){g=g.count;const O=[];if(l&&f){l=[];var X=x(f[0]);for(const ba of X)if(f[1]){X=x(f[1]);for(const fa of X)if(f[2]){X=x(f[2]);for(const na of X)l.push(`${C(ba)}${z}${C(fa)}${z}${C(na)}`)}else l.push(`${C(ba)}${z}${C(fa)}`)}else l.push(ba);for(const ba of l)g.hasOwnProperty(ba)||(g[ba]={data:ba,count:0})}for(const ba in g)f=g[ba],O.push({value:f.data,count:f.count,label:f.label});return{uniqueValueInfos:O}};e.getAttributeComparator=p;e.getEqualIntervalBins=u;e.getNormalizedValue=function(g,
f,l,z){let O=null;switch(f){case "log":0!==g&&(O=Math.log(g)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(z)&&0!==z&&(O=g/z*100);break;case "field":Number.isFinite(l)&&0!==l&&(O=g/l);break;case "natural-log":0<g&&(O=Math.log(g));break;case "square-root":0<g&&(O=g**.5)}return O};e.isNullCountSupported=r;e.processNullValue=C;e.processSummaryStatisticsResult=function(g,f,l){let z;for(z in g)f?.include?.length&&!f.include.includes(z)||f?.exclude?.length&&f.exclude.includes(z)?delete g[z]:
d.includes(z)&&(Number.isFinite(g[z])||(g[z]=null));if(!l)return g;["avg","stddev","variance"].forEach(O=>{null!=g[O]&&(g[O]=Math.ceil(g[O]??0))});return g};e.resolveCBResult=function(g,f){let l=g.classBreaks;const z=l[0]?.minValue,O=l[l.length-1]?.maxValue,X="standard-deviation"===f;l=l.map(ba=>{const fa=ba.label;ba={minValue:ba.minValue,maxValue:ba.maxValue,label:fa};if(X&&fa){const na=fa.match(b)?.map(oa=>+oa.trim())??[];2===na.length?(ba.minStdDev=na[0],ba.maxStdDev=na[1],0>na[0]&&0<na[1]&&(ba.hasAvg=
!0)):1===na.length&&(fa.includes("\x3c")?(ba.minStdDev=null,ba.maxStdDev=na[0]):fa.includes("\x3e")&&(ba.minStdDev=na[0],ba.maxStdDev=null))}return ba});return{minValue:z,maxValue:O,classBreakInfos:l,normalizationTotal:g.normalizationTotal}};e.statisticTypes=d;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(e,k,y,C,r,M,a,p,h){r=new k.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});k=new k.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});y=class extends y.JSONSupport{constructor(w){super(w);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(w){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",w)}set definedInterval(w){"defined-interval"===this.classificationMethod&&this._set("definedInterval",w)}};e.__decorate([p.enumeration({classBreaksDef:"class-breaks-definition"})],y.prototype,"type",void 0);e.__decorate([C.property({json:{write:!0}})],y.prototype,
"breakCount",void 0);e.__decorate([C.property({json:{write:!0}})],y.prototype,"classificationField",void 0);e.__decorate([C.property({type:String,json:{read:r.read,write:r.write}})],y.prototype,"classificationMethod",void 0);e.__decorate([C.property({json:{write:!0}})],y.prototype,"normalizationField",void 0);e.__decorate([C.property({json:{read:k.read,write:k.write}})],y.prototype,"normalizationType",void 0);e.__decorate([C.property({value:null,json:{write:!0}})],y.prototype,"standardDeviationInterval",
null);e.__decorate([C.property({value:null,json:{write:!0}})],y.prototype,"definedInterval",null);return y=e.__decorate([h.subclass("esri.rest.support.ClassBreaksDefinition")],y)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(e,k,y){e.enumeration=function(C,r={}){C=C instanceof k.JSONMap?C:new k.JSONMap(C,r);const {alwaysWriteDefaults:M,default:a,ignoreUnknown:p=!0,name:h,nonNullable:w,readOnly:x=!1}=r;return y.property({type:p?
C.apiValues:String,json:{type:C.jsonValues,default:a,name:h,read:x?!1:{reader:C.read},write:{writer:C.write,alwaysWriteDefaults:M}},nonNullable:w,readOnly:x})};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(e,k){function y(I){var F=I.definition;const {classificationMethod:t,normalizationType:J,definedInterval:K}=F;F=F.breakCount??1;const u=[];var b=I.values;if(0===b.length)return[];
b=b.sort((S,ca)=>S-ca);var q=b[0],L=b[b.length-1];if("equal-interval"===t)if(b.length>=F){b=(L-q)/F;I=q;for(var d=1;d<F;d++){var G=Number((q+d*b).toFixed(6));u.push({minValue:I,maxValue:G,label:C(I,G,J)});I=G}u.push({minValue:I,maxValue:L,label:C(I,L,J)})}else b.forEach(S=>{u.push({minValue:S,maxValue:S,label:C(S,S,J)})});else if("natural-breaks"===t){b=r(b);I=M(b.uniqueValues,I.valueFrequency||b.valueFrequency,F);for(d=1;d<F;d++)b.uniqueValues.length>d&&(G=Number(b.uniqueValues[I[d]].toFixed(6)),
u.push({minValue:q,maxValue:G,label:C(q,G,J)}),q=G);u.push({minValue:q,maxValue:L,label:C(q,L,J)})}else if("quantile"===t)if(b.length>=F&&q!==L){I=Math.ceil(b.length/F);d=0;for(G=1;G<F;G++){var P=I+d-1;P>b.length&&(P=b.length-1);0>P&&(P=0);u.push({minValue:q,maxValue:b[P],label:C(q,b[P],J)});q=b[P];d+=I;I=Math.ceil((b.length-d)/(F-G))}u.push({minValue:q,maxValue:L,label:C(q,L,J)})}else for(F=-1,L=0;L<b.length;L++)q=b[L],q!==F&&(F=q,u.push({minValue:F,maxValue:q,label:C(F,q,J)}),F=q);else if("standard-deviation"===
t)if(I=h(b),d=w(b,I),0===d)u.push({minValue:b[0],maxValue:b[0],label:C(b[0],b[0],J)});else{b=p(q,L,F,I,d)*d;d=0;for(G=F;1<=G;G--)P=Number((I-(G-.5)*b).toFixed(6)),u.push({minValue:q,maxValue:P,label:C(q,P,J)}),q=P,d++;G=Number((I+.5*b).toFixed(6));u.push({minValue:q,maxValue:G,label:C(q,G,J)});q=G;d++;for(P=1;P<=F;P++)G=d===2*F?L:Number((I+(P+.5)*b).toFixed(6)),u.push({minValue:q,maxValue:G,label:C(q,G,J)}),q=G,d++}else if("defined-interval"===t){if(!K)return u;F=b[0];L=b[b.length-1];b=Math.ceil((L-
F)/K);q=F;for(I=1;I<b;I++)d=Number((F+I*K).toFixed(6)),u.push({minValue:q,maxValue:d,label:C(q,d,J)}),q=d;u.push({minValue:q,maxValue:L,label:C(q,L,J)})}return u}function C(I,F,t){let J=null;return J=I===F?t&&"percent-of-total"===t?I+"%":I.toString():t&&"percent-of-total"===t?I+"% - "+F+"%":I+" - "+F}function r(I){const F=[],t=[];let J=Number.MIN_VALUE,K=1,u=-1;for(let b=0;b<I.length;b++){const q=I[b];q===J?(K++,t[u]=K):null!==q&&(F.push(q),J=q,K=1,t.push(K),u++)}return{uniqueValues:F,valueFrequency:t}}
function M(I,F,t){var J=I.length;const K=[];t>J&&(t=J);for(var u=0;u<t;u++)K.push(Math.round(u*J/t-1));K.push(J-1);u=a(K,I,F,t);J=u.mean;u=u.sdcm;var b=t,q=0,L=0;let d=0,G=0,P=!0;for(let ca=0;2>ca&&P;ca++){0===ca&&(P=!1);for(var S=0;S<b-1;S++)for(;K[S+1]+1!==K[S+2];)if(K[S+1]+=1,q=x(S,K,I,F),d=q.sbMean,q=q.sbSdcm,L=x(S+1,K,I,F),G=L.sbMean,L=L.sbSdcm,q+L<u[S]+u[S+1])u[S]=q,u[S+1]=L,J[S]=d,J[S+1]=G,P=!0;else{--K[S+1];break}for(S=b-1;0<S;S--)for(;K[S]!==K[S-1]+1;)if(--K[S],q=x(S-1,K,I,F),d=q.sbMean,
q=q.sbSdcm,L=x(S,K,I,F),G=L.sbMean,L=L.sbSdcm,q+L<u[S-1]+u[S])u[S-1]=q,u[S]=L,J[S-1]=d,J[S]=G,P=!0;else{K[S]+=1;break}}P&&(u=a(K,I,F,t));return K}function a(I,F,t,J){let K=[];var u=[],b=[];let q=0;const L=[],d=[];for(var G=0;G<J;G++){var P=x(G,I,F,t);L.push(P.sbMean);d.push(P.sbSdcm);q+=d[G]}P=q;for(G=!0;G||q<P;){G=!1;K=[];for(u=0;u<J;u++)K.push(I[u]);for(b=0;b<J;b++)for(P=I[b]+1;P<=I[b+1];P++)if(u=F[P],0<b&&P!==I[b+1]&&Math.abs(u-L[b])>Math.abs(u-L[b-1]))I[b]=P;else if(b<J-1&&I[b]!==P-1&&Math.abs(u-
L[b])>Math.abs(u-L[b+1])){I[b+1]=P-1;break}P=q;q=0;u=[];b=[];for(let S=0;S<J;S++){u.push(L[S]);b.push(d[S]);const ca=x(S,I,F,t);L[S]=ca.sbMean;d[S]=ca.sbSdcm;q+=d[S]}}if(q>P){for(F=0;F<J;F++)I[F]=K[F],L[F]=u[F],d[F]=b[F];q=P}return{mean:L,sdcm:d}}function p(I,F,t,J,K){I=Math.max(J-I,F-J)/K/t;return 1<=I?1:.5<=I?.5:.25}function h(I){let F=0;for(let t=0;t<I.length;t++)F+=I[t];return F/=I.length}function w(I,F){let t=0;for(let J=0;J<I.length;J++){const K=I[J];t+=(K-F)*(K-F)}t/=I.length;return Math.sqrt(t)}
function x(I,F,t,J){var K=0,u=0;for(var b=F[I]+1;b<=F[I+1];b++){const q=J[b];K+=t[b]*q;u+=q}0>=u&&k.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");K/=u;u=0;for(b=F[I]+1;b<=F[I+1];b++)u+=J[b]*(t[b]-K)**2;return{sbMean:K,sbSdcm:u}}e.createGenerateRendererClassBreaks=function(I){const {normalizationTotal:F}=I;return{classBreaks:y(I),normalizationTotal:F}};e.createGenerateRendererUniqueValues=function(I){I=r(I);const F=[],t=I.uniqueValues.length;for(let J=
0;J<t;J++){const K=I.uniqueValues[J];F.push({value:K,count:I.valueFrequency[J],label:K.toString()})}return{uniqueValues:F}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(e){e.makeEdgeCandidate=function(k,y,C,r,M,a=!1){return{objectId:k,target:y,distance:C,type:"edge",start:r,end:M,draped:a}};e.makeVertexCandidate=function(k,y,C){return{objectId:k,target:y,distance:C,type:"vertex"}};Object.defineProperty(e,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(e,k,y,C,r,M,a,p,h,w){async function x(u,b,q){if(!u)return null;var {where:L}=u;u.where=L=L?.trim();if(!L||/^1 *= *1$/.test(L)||
b&&b===L)u.where=null;if(!u.geometry)return u;b=await F(u);u.distance=0;u.units=null;"esriSpatialRelEnvelopeIntersects"===u.spatialRel&&({spatialReference:L}=u.geometry,b=M.getGeometryExtent(b),b.spatialReference=L);if(b){await w.checkProjectionSupport(b.spatialReference,q);L=b.spatialReference;b=I(b,q)&&a.isExtent(b)?{spatialReference:L,rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}:b;L=(await p.normalizeCentralMeridian(a.fromJSON(b)))[0];if(null==L)throw K;
const d="quantizationParameters"in u&&u.quantizationParameters?.tolerance||"maxAllowableOffset"in u&&u.maxAllowableOffset||0;b=d&&I(b,q)?{densificationStep:8*d}:void 0;L=L.toJSON();b=w.project(L,L.spatialReference,q,b);if(!b)throw K;b.spatialReference=q;u.geometry=b}return u}function I(u,b){if(!u)return!1;const q=u.spatialReference;return(a.isExtent(u)||a.isPolygon(u)||a.isPolyline(u))&&!h.equals(q,b)&&!r.canProjectWithoutEngine(q,b)}async function F(u){const {distance:b,units:q}=u,L=u.geometry;if(null==
b||"vertexAttributes"in L)return L;var d=L.spatialReference;u=q?J.fromJSON(q):C.getUnitString(d);d=d&&(h.isGeographic(d)||h.isWebMercator(d))?L:await w.checkProjectionSupport(d,h.wgs84).then(()=>w.project(L,h.wgs84));return(await t())(d.spatialReference,d,b,u)}async function t(){return(await new Promise((u,b)=>e(["../../../geometry/geometryEngineJSON"],u,b))).geodesicBuffer}const J=new y.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),K=Object.freeze({});k.normalizeQuery=async function(u,b,q){const {outFields:L,orderByFields:d,groupByFieldsForStatistics:G,outStatistics:P}=u;if(L)for(var S=0;S<L.length;S++)L[S]=L[S].trim();if(d)for(S=0;S<d.length;S++)d[S]=d[S].trim();if(G)for(S=0;S<G.length;S++)G[S]=G[S].trim();if(P)for(S=0;S<P.length;S++)P[S].onStatisticField&&(P[S].onStatisticField=P[S].onStatisticField.trim());u.geometry&&!u.outSR&&(u.outSR=
u.geometry.spatialReference);return x(u,b,q)};k.normalizeQueryLike=x;k.queryEngineEmptyResult=K;k.unitsKebabDict=J;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(e,k,y,C,r,M){function a(I,F,t){const {outFields:J,orderByFields:K,returnDistinctValues:u,outStatistics:b}=t,q=b?
b.map(L=>L.outStatisticFieldName&&L.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(K&&0<K.length){const L=K.map(d=>{const G=d.toLowerCase();return G.includes(" asc")?G.split(" asc")[0]:G.includes(" desc")?G.split(" desc")[0]:d}).filter(d=>!q.includes(d));y.validateFields(I,F,L,{expressionName:"orderByFields",query:t})}if(J&&0<J.length)y.validateFields(I,F,J,{expressionName:"outFields",query:t,allowedFieldTypes:"all"});else if(u)throw new k("unsupported-query","outFields should be specified for returnDistinctValues",
{query:t});y.validateWhere(I,F,t.where,t)}function p(I,F,t){const {outStatistics:J,groupByFieldsForStatistics:K,having:u}=t;var b=K?.length,q=J?.length;if(u){if(!b||!q)throw new k("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});y.validateHaving(I,F,u,J,t)}if(q&&w(J)){q=J.map(L=>L.onStatisticField).filter(Boolean);y.validateFields(I,F,q,{expressionName:"onStatisticFields",query:t});b&&y.validateFields(I,F,K,{expressionName:"groupByFieldsForStatistics",
query:t});for(const L of J){const {onStatisticField:d,statisticType:G}=L;if(("percentile_disc"===G||"percentile_cont"===G)&&"statisticParameters"in L){if({statisticParameters:b}=L,!b)throw new k("unsupported-query","statisticParameters should be set for percentile type",{definition:L,query:t});}else I.get(d)&&"count"!==G&&"min"!==G&&"max"!==G&&y.validateFields(I,F,[d],{expressionName:`outStatistics with '${G}' statistic type`,allowedFieldTypes:x,query:t})}}}async function h(I,F,t,J){var K=[];t.valueExpression&&
({arcadeUtils:K}=await M.loadArcade(),K=K.extractFieldNames(t.valueExpression));t.field&&K.push(t.field);t.field2&&K.push(t.field2);t.field3&&K.push(t.field3);t.normalizationField&&K.push(t.normalizationField);if(!K.length&&!t.valueExpression)throw new k("unsupported-query","field or valueExpression is required",{params:t});y.validateFields(I,F,K,{expressionName:"statistics",query:J})}function w(I){return null!=I&&I.every(F=>"exceedslimit"!==F.statisticType)}const x=new Set([...y.numericFieldTypes,
...y.allDateAndTimeFieldTypes]);e.validateQuery=async function(I,{fieldsIndex:F,geometryType:t,spatialReference:J,availableFields:K}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption&&"xyFootprint"!==I.multipatchOption||I.pixelSize||I.relationParam||I.text)throw new k("unsupported-query","Unsupported query options",{query:I});a(F,K,I);p(F,K,I);return Promise.all([r.checkSpatialQuerySupport(I,t,J),C.checkProjectionSupport(J,I.outSR)]).then(()=>I)};e.validateStatisticsQuery=async function(I,
F,{fieldsIndex:t,geometryType:J,spatialReference:K,availableFields:u}){if(0>(I.distance??0)||null!=I.geometryPrecision||I.multipatchOption||I.pixelSize||I.relationParam||I.text||I.outStatistics||I.groupByFieldsForStatistics||I.having||I.orderByFields)throw new k("unsupported-query","Unsupported query options",{query:I});a(t,u,I);return Promise.all([h(t,u,F,I),r.checkSpatialQuerySupport(I,J,K),C.checkProjectionSupport(K,I.outSR)]).then(()=>I)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(e,k,y,C,r,M,a,p,h,w,x,I){function F(){return new Promise((b,q)=>e(["../../../geometry/geometryEngineJSON"],b,q))}const t={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var J={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},K={esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},u={esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};k.canQueryWithRBush=function(b){if(M.isExtent(b))return!0;if(M.isPolygon(b)){for(const q of b.rings)if(5!==q.length||q[0][0]!==q[1][0]||q[0][0]!==
q[4][0]||q[2][0]!==q[3][0]||q[0][1]!==q[3][1]||q[0][1]!==q[4][1]||q[1][1]!==q[2][1])return!1;return!0}return!1};k.checkSpatialQuerySupport=async function(b,q,L){const {spatialRel:d,geometry:G}=b;if(G){if(null==d||!0!==J[d])throw new y("unsupported-query","Unsupported query spatial relationship",{query:b});if(a.isValid(G.spatialReference)&&a.isValid(L)){if(null==G||!0!==K[M.getJsonType(G)])throw new y("unsupported-query","Unsupported query geometry type",{query:b});if(null==q||!0!==u[q])throw new y("unsupported-query",
"Unsupported layer geometry type",{query:b});if(b.outSR)return I.checkProjectionSupport(b.geometry?.spatialReference,b.outSR)}}};k.getSpatialQueryOperator=function(b,q,L,d,G){if(M.isPolygon(q)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b)){const P=h.convertFromPolygon(new w,q,!1,!1);return Promise.resolve(S=>p.polygonContainsPoint(P,!1,!1,S))}if(M.isPolygon(q)&&"esriGeometryMultipoint"===L){const P=h.convertFromPolygon(new w,q,!1,!1);if("esriSpatialRelContains"===
b)return Promise.resolve(S=>p.polygonContainsMultipoint(P,!1,!1,S,d,G))}if(M.isExtent(q)&&"esriGeometryPoint"===L&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b))return Promise.resolve(P=>C.extentContainsPoint(q,x.getGeometry(L,d,G,P)));if(M.isExtent(q)&&"esriGeometryMultipoint"===L&&"esriSpatialRelContains"===b)return Promise.resolve(P=>C.extentContainsMultipoint(q,x.getGeometry(L,d,G,P)));if(M.isExtent(q)&&"esriSpatialRelIntersects"===b){const P=r.getExtentIntersector(L);return Promise.resolve(S=>
P(q,x.getGeometry(L,d,G,S)))}return F().then(P=>{const S=P[t[b]].bind(null,q.spatialReference,q);return ca=>S(x.getGeometry(L,d,G,ca))})};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(e,k){e.extentIntersectsExtent=k.extentIntersectsExtent;e.extentIntersectsMultipoint=k.extentIntersectsMultipoint;e.extentIntersectsPoint=k.extentIntersectsPoint;e.extentIntersectsPolygon=k.extentIntersectsPolygon;
e.extentIntersectsPolyline=k.extentIntersectsPolyline;e.getFeatureExtentIntersector=k.getFeatureExtentIntersector;e.isSelfIntersecting=k.isSelfIntersecting;e.segmentIntersects=k.segmentIntersects;e.getExtentIntersector=function(y){return"mesh"===y?k.extentIntersectsExtent:k.getFeatureExtentIntersector(y)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(e){function k(y,C,r,M,a){if(!y)return!1;C=C?r?4:3:r?3:2;const {coords:p,
lengths:h}=y;r=!1;y=0;for(const x of h){var w=y;for(let I=y,F=y+x*C;I<F;I+=C){w=I+C;w===F&&(w=y);const t=p[I],J=p[I+1],K=p[w];w=p[w+1];(J<a&&w>=a||w<a&&J>=a)&&t+(a-J)/(w-J)*(K-t)<M&&(r=!r)}y+=x*C}return r}e.polygonContainsCoords=k;e.polygonContainsMultipoint=function(y,C,r,M,a,p){a=a?p?4:3:p?3:2;const {coords:h,lengths:w}=M;if(!w)return!1;for(let x=0,I=0;x<w.length;x++,I+=a)if(!k(y,C,r,h[I],h[I+1]))return!1;return!0};e.polygonContainsPoint=function(y,C,r,M){return k(y,C,r,M.coords[0],M.coords[1])};
Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(e){function k(r,M,a,p,h){if(null!=p&&null!=h)return w=>{const x=r(w,M);w=r(w,a);return(null==x||x<=h)&&(null==w||w>=p)};if(null!=p)return w=>{w=r(w,a);return null==w||w>=p};if(null!=h)return w=>{w=r(w,M);return null==w||w<=h}}function y(r,M,a,p){if(null!=a&&null!=p&&a===p)return h=>r(h,M)===a;if(null!=a&&null!=p)return h=>{h=r(h,M);return null!=h&&h>=a&&h<=
p};if(null!=a)return h=>{h=r(h,M);return null!=h&&h>=a};if(null!=p)return h=>{h=r(h,M);return null!=h&&h<=p}}function C(){return()=>!1}e.getTimeExtent=async function(r,M){if(!r)return null;const a=M.featureAdapter,{startTimeField:p,endTimeField:h}=r;let w=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;if(p&&h)await M.forEach(I=>{const F=a.getAttribute(I,p);I=a.getAttribute(I,h);null==F||isNaN(F)||(w=Math.min(w,F));null==I||isNaN(I)||(x=Math.max(x,I))});else{const I=p||h;await M.forEach(F=>{F=
a.getAttribute(F,I);null==F||isNaN(F)||(w=Math.min(w,F),x=Math.max(x,F))})}return{start:w,end:x}};e.getTimeOperator=function(r,M,a){if(!M||!r)return null;const {startTimeField:p,endTimeField:h}=r;if(!p&&!h)return null;const {start:w,end:x}=M;if(null===w&&null===x)return null;if(void 0===w&&void 0===x)return C();r=a.getAttributeAsTimestamp?.bind(a)??a.getAttribute.bind(a);return p&&h?k(r,p,h,w,x):y(r,p||h,w,x)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(e,k,y,C,r,M,a,p){function h(t){return t.trim().toLowerCase()}function w(t){const J=new Map;if(!t.fields)return J;const K=!0===t.datesInUnknownTimezone,{timeInfo:u,editFieldsInfo:b}=t;var q=(u?"startField"in u?u.startField:u.startTimeField:"")??"";const L=(u?"endField"in u?u.endField:u.endTimeField:"")??"",d="dateFieldsTimeZone"in t?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?a.fromTimeReference(t.dateFieldsTimeReference):null,G=b?"timeZone"in b?b.timeZone??d:b.dateFieldsTimeReference?
a.fromTimeReference(b.dateFieldsTimeReference):d??a.utc:null,P=u?"timeZone"in u?u.timeZone??d:u.timeReference?a.fromTimeReference(u.timeReference):d:null;q=new Map([[h(b?.creationDateField??""),G],[h(b?.editDateField??""),G],[h(q),P],[h(L),P]]);for(const {name:S,type:ca}of t.fields)F.has(ca)?J.set(S,a.unknown):"date"!==ca&&"esriFieldTypeDate"!==ca?J.set(S,null):K?J.set(S,a.unknown):(t=q.get(h(S??""))??d,J.set(S,t));return J}const x=new Map;class I{static fromJSON(t){return new I(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new I(t.fields??
[],w(t))}static fromLayerJSON(t){return new I(t.fields??[],w(t))}constructor(t=[],J){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=t||[];this._timeZoneByFieldName=J?new Map(J):null;t=[];for(const K of this.fields){J=K?.name;const u=M.normalizeFieldName(J)?.toLowerCase()??"";if(J&&u){const b=h(J);this._fieldsMap.set(J,K);this._fieldsMap.set(b,K);this._normalizedFieldsMap.set(u,
K);t.push(`${b}:${K.type}:${this._timeZoneByFieldName?.get(J)}`);M.isDateField(K)?(this.dateFields.push(K),this._dateFieldsSet.add(K)):M.isNumericField(K)&&(this._numericFieldsSet.add(K),this.numericFields.push(K));M.isObjectIDField(K)||M.isGlobalIDField(K)||(K.editable=null==K.editable||!!K.editable,K.nullable=null==K.nullable||!!K.nullable)}}t.sort();this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)M.isObjectIDField(t)||M.isGlobalIDField(t)||
t.nullable||void 0!==M.getFieldDefaultValue(t)||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return null!=this.get(t)}get(t){if(t){var J=this._fieldsMap.get(t);if(J)return J;(J=this._fieldsMap.get(h(t))??this._normalizedFieldsMap.get(M.normalizeFieldName(t)?.toLowerCase()??""))&&this._fieldsMap.set(t,J);return J}}getTimeZone(t){t=this.get(t&&"string"!==typeof t?t.name:t);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):
"date"===t.type||"esriFieldTypeDate"===t.type?(y.getLogger("esri.layers.support.FieldsIndex").error(new e("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),a.utc):F.has(t.type)?a.unknown:null:null}getLuxonTimeZone(t){const J=this.getTimeZone(t);return J?J===a.unknown?r.UnknownTimeZone.instance:J===a.utc?p.FixedOffsetZone.utcInstance:C.getOrCreateMapValue(x,J,()=>p.IANAZone.create(J)):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return M.isTimeOnlyField(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??
void 0}toJSON(){return{fields:this.fields.map(t=>k.isSerializable(t)?t.toJSON():t),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const F=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return I})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(e,k,y,C,r,M,a,p,h,w,x,I,F,t,J){function K(T){return u.has(T)?u.get(T):"number"===typeof T?T:1}e.TaskPriority=void 0;(function(T){T.RESOURCE_CONTROLLER_IMMEDIATE="immediate";T.RESOURCE_CONTROLLER="schedule";T.SLIDE="slide";T.STREAM_DATA_LOADER="stream loader";T.ELEVATION_QUERY="elevation query";T.TERRAIN_SURFACE="terrain";T.SURFACE_GEOMETRY_UPDATES="surface geometry updates";T.LOD_RENDERER="LoD renderer";T.GRAPHICS_CORE="Graphics3D";T.I3S_CONTROLLER="I3S";T.POINT_CLOUD_LAYER="point cloud";
T.FEATURE_TILE_FETCHER="feature fetcher";T.OVERLAY="overlay";T.STAGE="stage";T.GRAPHICS_DECONFLICTOR="graphics deconflictor";T.FILTER_VISIBILITY="Graphics3D filter visibility";T.SCALE_VISIBILITY="Graphics3D scale visibility";T.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";T.POINT_OF_INTEREST_FREQUENT="POI frequent";T.POINT_OF_INTEREST_INFREQUENT="POI infrequent";T.LABELER="labeler";T.FEATURE_QUERY_ENGINE="feature query";T.FEATURE_TILE_TREE="feature tile tree";T.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
T.ELEVATION_ALIGNMENT="elevation alignment";T.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";T.TEXT_TEXTURE_ATLAS="text texture atlas";T.TEXTURE_UNLOAD="texture unload";T.LINE_OF_SIGHT_TOOL="line of sight tool";T.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";T.ELEVATION_PROFILE="elevation profile";T.SNAPPING="snapping";T.SHADOW_ACCUMULATOR="shadow accumulator";T.CLOUDS_GENERATOR="clouds generator";T.MAPVIEW_FETCH_QUEUE="mapview fetch queue";T.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update";
T.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue";T[T.NONE=0]="NONE";T[T.TEST_PRIO=1]="TEST_PRIO"})(e.TaskPriority||(e.TaskPriority={}));const u=new Map([[e.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[e.TaskPriority.RESOURCE_CONTROLLER,4],[e.TaskPriority.SLIDE,0],[e.TaskPriority.STREAM_DATA_LOADER,0],[e.TaskPriority.ELEVATION_QUERY,0],[e.TaskPriority.TERRAIN_SURFACE,1],[e.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[e.TaskPriority.LOD_RENDERER,2],[e.TaskPriority.GRAPHICS_CORE,
2],[e.TaskPriority.I3S_CONTROLLER,2],[e.TaskPriority.POINT_CLOUD_LAYER,2],[e.TaskPriority.FEATURE_TILE_FETCHER,2],[e.TaskPriority.CLOUDS_GENERATOR,2],[e.TaskPriority.OVERLAY,4],[e.TaskPriority.STAGE,4],[e.TaskPriority.GRAPHICS_DECONFLICTOR,4],[e.TaskPriority.FILTER_VISIBILITY,4],[e.TaskPriority.SCALE_VISIBILITY,4],[e.TaskPriority.FRUSTUM_VISIBILITY,4],[e.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[e.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[e.TaskPriority.LABELER,8],[e.TaskPriority.FEATURE_QUERY_ENGINE,
8],[e.TaskPriority.FEATURE_TILE_TREE,16],[e.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[e.TaskPriority.ELEVATION_ALIGNMENT,12],[e.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[e.TaskPriority.TEXT_TEXTURE_ATLAS,12],[e.TaskPriority.TEXTURE_UNLOAD,12],[e.TaskPriority.LINE_OF_SIGHT_TOOL,16],[e.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[e.TaskPriority.SNAPPING,0],[e.TaskPriority.SHADOW_ACCUMULATOR,30],[e.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[e.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[e.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,
0]]),b=x.Milliseconds(6.5),q=x.Milliseconds(1),L=x.Milliseconds(30),d=x.Milliseconds(1E3/30),G=x.Milliseconds(100);var P;(function(T){class v{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(f=>f.needsUpdate)}constructor(){this._updating=w.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new M("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new g;this._state=t.RenderState.INTERACTING;this._tasks=
new a;this._runQueue=new a;this._load=0;this._idleStateCallbacks=new a;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=h.watch(()=>F.SCHEDULER_LOG_SLOW_TASKS,f=>this._debug=f,h.initial);for(const f of Object.keys(e.TaskPriority))this.performanceInfo.tasks.set(e.TaskPriority[f],new M(e.TaskPriority[f]))}destroy(){this._tasks.toArray().forEach(f=>f.remove());this._tasks.clear();r.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(f){this._updatingChanged();
f&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(f,l){l=new Q(this,f,l);this._tasks.push(l);this._updatingChanged();this.performanceInfo.tasks.has(f)||this.performanceInfo.tasks.set(f,new M(f));return l}registerIdleStateCallbacks(f,l){const z={idleBegin:f,idleEnd:l};this._idleStateCallbacks.push(z);this.state===t.RenderState.IDLE&&
this._idleUpdatesStartFired&&z.idleBegin();const O=this;return{remove:()=>this._removeIdleStateCallbacks(z),set idleBegin(X){O._idleUpdatesStartFired&&(z.idleEnd(),O._state===t.RenderState.IDLE&&X());z.idleBegin=X},set idleEnd(X){z.idleEnd=X}}}get load(){return this._load}set state(f){this._state!==f&&(this._state=f,this.state!==t.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(l=>l.idleEnd())))}get state(){return this._state}updateBudget(f){this._test&&
(this._test.usedBudget=0);++this._frameNumber;let l=b,z=f.frameDuration,O=q;switch(this.state){case t.RenderState.IDLE:l=x.Milliseconds(0);z=x.Milliseconds(Math.max(G,f.frameDuration));O=L;break;case t.RenderState.INTERACTING:z=x.Milliseconds(Math.max(d,f.frameDuration))}z=x.Milliseconds(z-f.elapsedFrameTime-l);if(this.state!==t.RenderState.IDLE&&z<q&&!this._forceTask)return this._forceTask=!0,!1;z=x.Milliseconds(Math.max(z,O));this._budget.reset(z,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=
this._forceTask=!1;switch(this.state){case t.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(f=>f.idleBegin()));this._runIdle();break;case t.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(x.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(f){this._idleUpdatesStartFired&&f.idleEnd();
this._idleStateCallbacks.removeUnordered(f)}removeTask(f){this._tasks.removeUnordered(f);this._runQueue.removeUnordered(f);this._updatingChanged()}_updateTask(f){this._tasks.forAll(l=>{l.name===f&&l.setPriority(f)})}_getState(f){if(this._runQueue.some(z=>z.name===f))return e.TaskState.SCHEDULED;let l=e.TaskState.IDLE;this._tasks.forAll(z=>{z.name===f&&z.needsUpdate&&(1>=z.schedulePriority?l=e.TaskState.READY:l!==e.TaskState.READY&&(l=e.TaskState.WAITING))});return l}_getRuntime(f){let l=0;this._tasks.forAll(z=>
{z.name===f&&(l+=z.runtime)});return l}_resetRuntimes(){this._tasks.forAll(f=>f.runtime=0)}_getRunning(){const f=new Map;this._tasks.forAll(z=>{z.needsUpdate&&f.set(z.name,(f.get(z.name)||0)+1)});if(0===f.size)return null;let l="";f.forEach((z,O)=>{l=1<z?l+` ${z}x ${O}`:l+` ${O}`});return l}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const f=this._tasks.reduce((l,z)=>z.needsUpdate?++l:l,0);this._load=.9*this._load+f*(1-.9)}_schedule(){this._runQueue.filterInPlace(f=>
{if(f.needsUpdate)return!0;f.schedulePriority=f.basePriority;return!1});for(this._tasks.forAll(f=>{0===f.basePriority&&f.needsUpdate&&!this._runQueue.includes(f)&&f.blockFrame!==this._frameNumber&&this._runQueue.unshift(f)});0===this._runQueue.length;){let f=!1;this._tasks.forAll(l=>{if(l.needsUpdate&&0!==l.schedulePriority&&0!==l.basePriority&&l.blockFrame!==this._frameNumber)switch(f=!0,l.schedulePriority){case 1:l.schedulePriority=0;this._runQueue.push(l);break;default:--l.schedulePriority}});
if(!f)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const f=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var l=this._budget.now();const z=this._runQueue.pop();this._budget.resetProgress();try{z.task.runTask(this._budget)===J.Yield&&(z.blockFrame=this._frameNumber)}catch(O){C.getLogger("esri.views.support.Scheduler").error(`Exception in task "${z.name}"`,O),z.blockFrame=this._frameNumber}!this._budget.hasProgressed&&z.blockFrame!==this._frameNumber&&
z.needsUpdate&&(z.blockFrame=this._frameNumber);z.schedulePriority=z.basePriority;l=this._budget.now()-l;z.runtime+=l;this._frameTaskTimes.set(z.priority,this._frameTaskTimes.get(z.priority)+l);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-f);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-f)}_startFrameTaskTimes(){for(const f of Object.keys(e.TaskPriority))this._frameTaskTimes.set(e.TaskPriority[f],
0)}_recordFrameTaskTimes(f){this._frameTaskTimes.forEach((l,z)=>this.performanceInfo.tasks.get(z).push(l));this.performanceInfo.total.push(f)}get test(){return this._test}}T.Scheduler=v;class Q{get task(){return this._task.value}get updating(){return this._queue.running}constructor(f,l,z){this._scheduler=f;this.name=l;this.runtime=this.blockFrame=0;this._queue=new I.PromiseQueue;this._handles=new k;this.schedulePriority=this._basePriority=K(l);this._task=w.signal(null!=z?z:this._queue);this._handles.add(h.when(()=>
this.task.running,O=>f.taskRunningChanged(O)))}remove(){this.processQueue(S);this._scheduler.removeTask(this);this.schedule=U.schedule;this.reschedule=U.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(f){if(this.name!==f){this.name=f;f=K(f);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=f;this._basePriority=f}}get priority(){return this.name}set priority(f){this.setPriority(f)}get needsUpdate(){return this.updating||this.task.running}schedule(f,
l,z){return this._queue.push(f,l,z)}reschedule(f,l,z){return this._queue.unshift(f,l,z)}processQueue(f){return this._queue.runTask(f)}}class g{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=t.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(f){if(this.done)return!1;!0===f()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(f){this._enabled=f}reset(f,l){this._begin=this.now();this._budget=f;this._state=l;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}T.Budget=g})(P||={});e.TaskState=void 0;(function(T){T.SCHEDULED=
"s";T.READY="r";T.WAITING="w";T.IDLE="i"})(e.TaskState||(e.TaskState={}));const S=(()=>{const T=new P.Budget;T.enabled=!1;return T})();class ca{remove(){}processQueue(){}schedule(T,v,Q){try{if(p.isAborted(v)){const g=p.createAbortError();return Q?Promise.resolve(Q(g)):Promise.reject(g)}return p.when(T(S))}catch(g){return Promise.reject(g)}}reschedule(T,v,Q){return this.schedule(T,v,Q)}}const U=new ca;e.ImmediateTask=U;e.getTaskPriority=K;e.newScheduler=function(){return new P.Scheduler};e.noBudget=
S;e.taskPriorities=u;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(e,k,y,C){class r{constructor(M,a){this._observable=new C.SimpleObservable;this._value=M;this._equalityFunction=a}get value(){y.trackAccess(this._observable);return this._value}set value(M){this._equalityFunction(M,this._value)||(this._value=M,this._observable.notify())}mutate(M){M(this._value);
this._observable.notify()}}e.signal=function(M,a=k.equalsShallow){return new r(M,a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(e,k,y,C){class r{constructor(){this._tasks=[];this._runningTasks=y.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(a){if(0===
this.length)return C.Yield;for(;!a.done&&this._process(a);)a.madeProgress()}push(a,p,h){++this._runningTasks.value;return(new Promise((w,x)=>this._tasks.push(new M(w,x,a,p,h)))).finally(()=>--this._runningTasks.value)}unshift(a,p,h){++this._runningTasks.value;return(new Promise((w,x)=>this._tasks.unshift(new M(w,x,a,p,h)))).finally(()=>--this._runningTasks.value)}_process(a){if(0===this._tasks.length)return!1;const p=this._tasks.shift();try{const h=k.isAborted(p.signal);if(h&&!p.abortCallback)p.reject(k.createAbortError());
else{const w=h?p.abortCallback?.(k.createAbortError()):p.callback(a);k.isPromiseLike(w)?w.then(p.resolve,p.reject):p.resolve(w)}}catch(h){p.reject(h)}return!0}cancelAll(){const a=k.createAbortError();for(const p of this._tasks)if(p.abortCallback){const h=p.abortCallback(a);p.resolve(h)}else p.reject(a);this._tasks.length=0}}class M{constructor(a,p,h,w,x){this.resolve=a;this.reject=p;this.callback=h;this.signal=w;this.abortCallback=x}}e.PromiseQueue=r;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(e){const k=Symbol("Yield");e.Yield=k;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(e,k,y,C,r,M,a){k=class extends k{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};e.__decorate([y.property()],k.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);e.__decorate([y.property()],k.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);k=e.__decorate([a.subclass("esri.views.support.debugFlags")],k);return new k})},"esri/views/support/RenderState":function(){define(["exports"],function(e){e.RenderState=void 0;var k=e.RenderState||(e.RenderState={});k[k.ANIMATING=0]="ANIMATING";k[k.INTERACTING=1]="INTERACTING";k[k.IDLE=2]=
"IDLE";Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("exports ../../../../core/has ../../../../core/lang ../../data/QueryEngineCapabilities ../../../support/capabilities ../../../../symbols/support/defaultsJSON".split(" "),function(e,k,y,C,r,M){function a(w){return p.test(w)?`.${w}`:`["${w}"]`}const p=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let h=1;e.createCapabilities=function(w,x){return{analytics:{supportsCacheHint:!1},
attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:w},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:x,supportsDelete:x,supportsEditing:x,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:x,supportsExceedsLimitStatistics:!0,
supportsAsyncConvert3D:!1},query:C.queryCapabilities,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:r.zeroQueryBins,editing:{supportsGeometryUpdate:x,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,
supportsAsyncApplyEdits:!1,zDefault:void 0}}};e.createDefaultAttributesFunction=function(w,x){if(k("esri-csp-restrictions"))return()=>({[x]:null,...w});try{let I=`this${a(x)} = null;`;for(const t in w){const J=a(t);I+=`this${J} = ${JSON.stringify(w[t])};`}const F=(new Function(`\n      return class AttributesClass$${h++} {\n        constructor() {\n          ${I};\n        }\n      }\n    `))();return()=>new F}catch(I){return()=>({[x]:null,...w})}};e.createDefaultTemplate=function(w={}){return[{name:"New Feature",
description:"",prototype:{attributes:y.clone(w)}}]};e.createDrawingInfo=function(w){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===w||"esriGeometryMultipoint"===w?M.defaultPointSymbolJSON:"esriGeometryPolyline"===w?M.defaultPolylineSymbolJSON:M.defaultPolygonSymbolJSON}}};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/capabilities":function(){define(["exports"],function(e){const k={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,
supportsFixedBoundaries:!1,supportedStatistics:void 0};e.zeroCapabilities={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,
supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,
supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:k,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,
supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,
supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}};e.zeroQueryBins=k;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/defaultsJSON":function(){define(["exports"],function(e){const k=[252,146,31,255],y={type:"esriSMS",style:"esriSMSCircle",size:6,color:k,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},C={type:"esriSLS",
style:"esriSLSSolid",width:.75,color:k};e.defaultColor=k;e.defaultOutlineColor=[153,153,153,255];e.defaultPointSymbolJSON=y;e.defaultPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};e.defaultPolylineSymbolJSON=C;e.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],
haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};e.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};e.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};e.errorPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require","exports",
"../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(e,k,y,C,r){function M(F){return new h(F)}async function a(){null==I&&(I=await new Promise((F,t)=>e(["../../../../geometry/geometryEngineJSON"],F,t)));return I}class p{constructor(){this.description=this.code=null}}class h{constructor(F){this.error=new p;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=F}}class w{constructor(F){this.globalId=
null;this.success=!0;this.objectId=this.uniqueId=F}}const x=new Set;let I;k.createFeatureEditErrorResult=M;k.createFeatureEditSuccessResult=function(F){return new w(F)};k.loadGeometryEngineForSimplify=async function(F,t){!C.isValid(F)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await a()};k.mixAttributes=function(F,t,J,K=!1){x.clear();for(const q in J){const L=F.get(q);if(!L)continue;var u=L,b=J[q];let d=b;r.isNumericField(u)&&"string"===typeof b?d=parseFloat(b):r.isStringField(u)&&null!=
b&&"string"!==typeof b?d=String(b):r.isDateField(u)&&"string"===typeof b&&(d=y.parseDate(b));u=r.sanitizeNullFieldValue(d);x.add(L.name);if(L&&(K||L.editable)){if(b=r.validateFieldValue(L,u))return M(r.validationErrorToString(b,L,u));t[L.name]=u}}for(const q of F.requiredFields??[])if(!x.has(q.name))return M(`missing required field "${q.name}"`);return null};k.simplify=function(F,t){if(!F||!C.isValid(t))return F;if("rings"in F||"paths"in F){if(null==I)throw new TypeError("geometry engine not loaded");
return I.simplify(t,F)}return F};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],function(e){function k(a){const p=new Date(a);if(Number.isNaN(p.getTime()))a=!1;else{var h=!0;if(M&&/\d+\W*$/.test(a)&&(a=a.match(/[a-zA-Z]{2,}/))){h=!1;let w=0;for(;!h&&w<=a.length;)h=!r.test(a[w]),w++;h=!h}a=h}return a?Number.isNaN(p.getTime())?null:p.getTime()-6E4*p.getTimezoneOffset():null}function y(a){a=C.exec(a);if(!a?.groups)return null;a=a.groups;
const p=+a.year,h=+a.month-1,w=+a.day,x=+(a.hours??0),I=+(a.minutes??0),F=+(a.seconds??0);if(23<x||59<I||59<F)return null;var t=a.ms??"0";t=t?+t.padEnd(3,"0").slice(0,3):0;a=a.isUTC||!a.offsetSign?Date.UTC(p,h,w,x,I,F,t):6E4*("+"===a.offsetSign?-1:1)*(60*+a.offsetHours+ +a.offsetMinutes)+Date.UTC(p,h,w,x,I,F,t);return Number.isNaN(a)?null:a}const C=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,
r=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,M=!Number.isNaN((new Date("technology 10")).getTime());e.isDateString=function(a){return null!=y(a)||null!=k(a)};e.isISO8601Date=function(a){return C.test(a)};e.parseDate=function(a){return y(a)??k(a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../core/Error ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../objectIdUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils ../../../../time/timeZoneUtils".split(" "),function(e,k,y,C,r,M,a,p,h,w,x,I,F,t){function J(d){return k.isPoint(d)?null!=d.z:!!d.hasZ}function K(d){return k.isPoint(d)?
null!=d.m:!!d.hasM}const u=y.wgs84,b={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:y.wgs84},q={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!0,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0,supportsQueryWithCacheHint:!0}};class L{constructor(){this._nextObjectId=this._queryEngine=null}destroy(){this._queryEngine?.destroy();this._queryEngine=this._createDefaultAttributes=null}async load(d){var G=[];const {features:P}=d;var S=this._inferLayerProperties(P,d.fields);const ca=d.fields||[],U=null!=d.hasM?d.hasM:!!S.hasM,T=null!=d.hasZ?d.hasZ:
!!S.hasZ,v=!d.spatialReference&&!S.spatialReference,Q=v?u:d.spatialReference||S.spatialReference,g=v?b:null,f=d.geometryType||S.geometryType,l=!f;let z=d.objectIdField||S.objectIdField,O=d.timeInfo;const X=new x(ca);if(!l&&(v&&G.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!f))throw new e("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!z)throw new e("feature-layer:missing-property",
"objectIdField not set and couldn't be found in the provided fields");S.objectIdField&&z!==S.objectIdField&&(G.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${z}" doesn't match the field name "${S.objectIdField}", found in the provided fields`}),z=S.objectIdField);z&&!S.objectIdField&&((S=X.get(z))?(z=S.name,S.type="esriFieldTypeOID",S.editable=!1,S.nullable=!1):ca.unshift({alias:z,name:z,type:"esriFieldTypeOID",editable:!1,nullable:!1}));for(var ba of ca){null==
ba.name&&(ba.name=ba.alias);null==ba.alias&&(ba.alias=ba.name);if(!ba.name)throw new e("feature-layer:invalid-field-name","field name is missing",{field:ba});ba.name===z&&(ba.type="esriFieldTypeOID");if(!I.kebabDict.jsonValues.includes(ba.type))throw new e("feature-layer:invalid-field-type",`invalid type for field "${ba.name}"`,{field:ba});null==ba.length&&(ba.length=F.getFieldDefaultLength(ba))}ba={};for(var fa of ca)"esriFieldTypeOID"!==fa.type&&"esriFieldTypeGlobalID"!==fa.type&&(S=F.getFieldDefaultValue(fa),
void 0!==S&&(ba[fa.name]=S));O&&(O.startTimeField&&((fa=X.get(O.startTimeField))?(O.startTimeField=fa.name,fa.type="esriFieldTypeDate"):O.startTimeField=null),O.endTimeField&&((fa=X.get(O.endTimeField))?(O.endTimeField=fa.name,fa.type="esriFieldTypeDate"):O.endTimeField=null),O.trackIdField&&((fa=X.get(O.trackIdField))?O.trackIdField=fa.name:(O.trackIdField=null,G.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:O}}))),O.startTimeField||
O.endTimeField||(G.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:O}}),O=null));d=X.dateFields.length?{timeZoneIANA:d.dateFieldsTimeZone??t.utc}:null;this._createDefaultAttributes=h.createDefaultAttributesFunction(ba,z);G={warnings:G,featureErrors:[],layerDefinition:{...q,drawingInfo:h.createDrawingInfo(f),templates:h.createDefaultTemplate(ba),extent:g,geometryType:f,objectIdField:z,fields:ca,hasZ:T,hasM:U,timeInfo:O,
dateFieldsTimeReference:d},assignedObjectIds:{}};this._queryEngine=new p.QueryEngine({fieldsIndex:x.fromLayerJSON({fields:ca,timeInfo:O,dateFieldsTimeReference:d}),geometryType:f,hasM:U,hasZ:T,objectIdField:z,spatialReference:Q,featureStore:new M({geometryType:f,hasM:U,hasZ:T}),timeInfo:O});if(!P?.length)return this._nextObjectId=r.initialObjectId,G;this._nextObjectId=r.findLastObjectIdFromFeatures(z,P)+1;await a.checkProjectionSupport(P,Q);return this._loadInitialFeatures(G,P)}async applyEdits(d){const {spatialReference:G,
geometryType:P}=this._queryEngine;await Promise.all([w.loadGeometryEngineForSimplify(G,P),a.checkProjectionSupport(d.adds,G),a.checkProjectionSupport(d.updates,G)]);return this._applyEdits(d)}queryFeatures(d,G={}){return this._queryEngine.executeQuery(d,G.signal)}queryFeatureCount(d,G={}){return this._queryEngine.executeQueryForCount(d,G.signal)}queryObjectIds(d,G={}){return this._queryEngine.executeQueryForIds(d,G.signal)}queryExtent(d,G={}){return this._queryEngine.executeQueryForExtent(d,G.signal)}querySnapping(d,
G={}){return this._queryEngine.executeQueryForSnapping(d,G.signal)}_inferLayerProperties(d,G){let P=void 0,S=void 0,ca=null,U=null,T=null;for(const v of d)if(d=v.geometry,null!=d&&(ca||=k.getJsonType(d),U||(U=d.spatialReference),null==P&&(P=J(d)),null==S&&(S=K(d)),ca&&U&&null!=P&&null!=S))break;if(G&&G.length){let v=null;G.some(Q=>{const g="esriFieldTypeOID"===Q.type,f=!Q.type&&Q.name&&"objectid"===Q.name.toLowerCase();v=Q;return g||f})&&(T=v.name)}return{geometryType:ca,spatialReference:U,objectIdField:T,
hasM:S,hasZ:P}}async _loadInitialFeatures(d,G){const {geometryType:P,hasM:S,hasZ:ca,objectIdField:U,spatialReference:T,featureStore:v,fieldsIndex:Q}=this._queryEngine,g=[];for(const z of G){null!=z.uid&&(d.assignedObjectIds[z.uid]=-1);if(z.geometry&&P!==k.getJsonType(z.geometry)){d.featureErrors.push(w.createFeatureEditErrorResult("Incorrect geometry type."));continue}G=this._createDefaultAttributes();const O=w.mixAttributes(Q,G,z.attributes,!0);O?d.featureErrors.push(O):(this._assignObjectId(G,z.attributes,
!0),z.attributes=G,null!=z.uid&&(d.assignedObjectIds[z.uid]=z.attributes[U]),null!=z.geometry&&(z.geometry=a.project(z.geometry,z.geometry.spatialReference,T)),g.push(z))}v.addMany(C.convertFromFeatures([],g,P,ca,S,U));const {fullExtent:f,timeExtent:l}=await this._queryEngine.fetchRecomputedExtents();d.layerDefinition.extent=f;if(l){const {start:z,end:O}=l;d.layerDefinition.timeInfo.timeExtent=[z,O]}return d}async _applyEdits(d){const {adds:G,updates:P,deletes:S}=d;d={addResults:[],deleteResults:[],
updateResults:[],uidToObjectId:{}};G?.length&&this._applyAddEdits(d,G);P?.length&&this._applyUpdateEdits(d,P);if(S?.length){for(const T of S)d.deleteResults.push(w.createFeatureEditSuccessResult(T));this._queryEngine.featureStore.removeManyById(S)}const {fullExtent:ca,timeExtent:U}=await this._queryEngine.fetchRecomputedExtents();return{extent:ca,timeExtent:U,featureEditResults:d}}_applyAddEdits(d,G){const {addResults:P}=d,{geometryType:S,hasM:ca,hasZ:U,objectIdField:T,spatialReference:v,featureStore:Q,
fieldsIndex:g}=this._queryEngine,f=[];for(const l of G){if(l.geometry&&S!==k.getJsonType(l.geometry)){P.push(w.createFeatureEditErrorResult("Incorrect geometry type."));continue}G=this._createDefaultAttributes();const z=w.mixAttributes(g,G,l.attributes);z?P.push(z):(this._assignObjectId(G,l.attributes),l.attributes=G,null!=l.uid&&(d.uidToObjectId[l.uid]=l.attributes[T]),null!=l.geometry&&(G=l.geometry.spatialReference??v,l.geometry=a.project(w.simplify(l.geometry,G),G,v)),f.push(l),P.push(w.createFeatureEditSuccessResult(l.attributes[T])))}Q.addMany(C.convertFromFeatures([],
f,S,U,ca,T))}_applyUpdateEdits({updateResults:d},G){const {geometryType:P,hasM:S,hasZ:ca,objectIdField:U,spatialReference:T,featureStore:v,fieldsIndex:Q}=this._queryEngine;for(const f of G){const {attributes:l,geometry:z}=f;G=l?.[U];if(null==G){d.push(w.createFeatureEditErrorResult(`Identifier field ${U} missing`));continue}if(!v.has(G)){d.push(w.createFeatureEditErrorResult(`Feature with object id ${G} missing`));continue}const O=C.convertToFeature(v.getFeature(G),P,ca,S);if(null!=z){if(P!==k.getJsonType(z)){d.push(w.createFeatureEditErrorResult("Incorrect geometry type."));
continue}var g=z.spatialReference??T;O.geometry=a.project(w.simplify(z,g),g,T)}if(l&&(g=w.mixAttributes(Q,O.attributes,l))){d.push(g);continue}v.add(C.convertFromFeature(O,P,ca,S,U));d.push(w.createFeatureEditSuccessResult(G))}}_assignObjectId(d,G,P=!1){const S=this._queryEngine.objectIdField;P?G&&isFinite(G[S])?d[S]=G[S]:d[S]=this._nextObjectId++:d[S]=this._nextObjectId++}}return L});