// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(d,g,u,z,r,M,a,p,k,y){function v(C,K){return C?K?4:3:K?3:2}function D(C,K,N,V){if(C){if(N)return K&&V?H:Ga;if(K&&V)return l}else if(K&&V)return Ga;return Ka}function F({scale:C,
translate:K},N){return Math.round((N-K[0])/C[0])}function t({scale:C,translate:K},N){return Math.round((K[1]-N)/C[1])}function J({scale:C,translate:K},N,V){return N*C[V]+K[V]}function L(C){C=C.coords;return{x:C[0],y:C[1]}}function w(C,K){C.coords[0]=K.x;C.coords[1]=K.y;return C}function b(C){C=C.coords;return{x:C[0],y:C[1],z:C[2]}}function q(C,K){C.coords[0]=K.x;C.coords[1]=K.y;C.coords[2]=K.z;return C}function I(C){C=C.coords;return{x:C[0],y:C[1],m:C[2]}}function f(C,K){C.coords[0]=K.x;C.coords[1]=
K.y;C.coords[2]=K.m;return C}function G(C){C=C.coords;return{x:C[0],y:C[1],z:C[2],m:C[3]}}function O(C,K){C.coords[0]=K.x;C.coords[1]=K.y;C.coords[2]=K.z;C.coords[3]=K.m;return C}function Q(C,K){return C&&K?O:C?q:K?f:w}function Z(C,K,N,V,aa){N=Q(N,V);for(const {geometry:ea,attributes:ha}of K)K=null!=ea?N(new y,ea):null,C.push(new p.OptimizedFeature(K,ha,null,aa?ha[aa]:void 0));return C}function U(C,K,N=Q(null!=K.z,null!=K.m)){return N(C,K)}function T(C,K,N,V){for(const {geometry:aa,attributes:ea}of K)C.push({attributes:ea,
geometry:null!=aa?x(aa,N,V):null});return C}function x(C,K,N){if(null==C)return null;const V=v(K,N),aa=[];for(let ea=0;ea<C.coords.length;ea+=V){const ha=[];for(let oa=0;oa<V;oa++)ha.push(C.coords[ea+oa]);aa.push(ha)}return K?N?{points:aa,hasZ:K,hasM:N}:{points:aa,hasZ:K}:N?{points:aa,hasM:N}:{points:aa}}function R(C,K,N,V,aa){N=v(N,V);for(const {geometry:ea,attributes:ha}of K)K=null!=ea?h(new y,ea,N):null,C.push(new p.OptimizedFeature(K,ha,null,aa?ha[aa]:void 0));return C}function h(C,K,N=v(K.hasZ,
K.hasM)){C.lengths[0]=K.points.length;const V=C.coords;let aa=0;for(const ea of K.points)for(K=0;K<N;K++)V[aa++]=ea[K];return C}function e(C,K,N){if(!C)return null;const V=v(K,N),{coords:aa,lengths:ea}=C;C=[];let ha=0;for(const oa of ea){const pa=[];for(let xa=0;xa<oa;xa++){const ua=[];for(let va=0;va<V;va++)ua.push(aa[ha++]);pa.push(ua)}C.push(pa)}return K?N?{paths:C,hasZ:K,hasM:N}:{paths:C,hasZ:K}:N?{paths:C,hasM:N}:{paths:C}}function n(C,K,N,V,aa){N=v(N,V);for(const {geometry:ea,attributes:ha,
centroid:oa}of K)K=null!=ea?A(new y,ea,N):null,V=null!=oa?U(new y,oa):null,C.push(new p.OptimizedFeature(K,ha,V,aa?ha[aa]:void 0));return C}function A(C,K,N=v(K.hasZ,K.hasM)){const {lengths:V,coords:aa}=C;let ea=0;for(const ha of K.paths){for(const oa of ha)for(K=0;K<N;K++)aa[ea++]=oa[K];V.push(ha.length)}return C}function P(C,K,N){if(!C)return null;const V=v(K,N),{coords:aa,lengths:ea}=C;C=[];let ha=0;for(const oa of ea){const pa=[];for(let xa=0;xa<oa;xa++){const ua=[];for(let va=0;va<V;va++)ua.push(aa[ha++]);
pa.push(ua)}C.push(pa)}return K?N?{rings:C,hasZ:K,hasM:N}:{rings:C,hasZ:K}:N?{rings:C,hasM:N}:{rings:C}}function X(C,K,N=K.hasZ,V=K.hasM){return ca(C,K.rings,N,V)}function ca(C,K,N,V){N=v(N,V);const {lengths:aa,coords:ea}=C;V=0;ta(C);for(const ha of K){for(const oa of ha)for(K=0;K<N;K++)ea[V++]=oa[K];aa.push(ha.length)}return C}function ja(C,K,N,V,aa,ea){za(C);if(!N){for(const ha of K)C.push(new p.OptimizedFeature(null,ha.attributes,null,ea?ha.attributes[ea]:void 0));return C}switch(N){case "esriGeometryPoint":return Z(C,
K,V,aa,ea);case "esriGeometryMultipoint":return R(C,K,V,aa,ea);case "esriGeometryPolyline":return n(C,K,V,aa,ea);case "esriGeometryPolygon":case "esriGeometryMultiPatch":for(const {geometry:ha,centroid:oa,attributes:pa}of K)K=null!=ha?X(new y,ha,V,aa):null,N=ea?pa[ea]:void 0,null!=oa?C.push(new p.OptimizedFeature(K,pa,w(new y,oa),N)):C.push(new p.OptimizedFeature(K,pa,null,N));break;default:Aa().error("convertToFeatureSet:unknown-geometry",new g(`Unable to parse unknown geometry type '${N}'`)),za(C)}return C}
function qa(C,K,N,V){C=C&&("coords"in C?C:C.geometry);if(null==C)return null;switch(K){case "esriGeometryPoint":return K=L,N&&V?K=G:N?K=b:V&&(K=I),K(C);case "esriGeometryMultipoint":return x(C,N,V);case "esriGeometryPolyline":return e(C,N,V);case "esriGeometryPolygon":return P(C,N,V);default:return Aa().error("convertToGeometry:unknown-geometry",new g(`Unable to parse unknown geometry type '${K}'`)),null}}function sa(C,K,N,V,aa){za(C);if(null==N){for(const ha of K)C.push({attributes:ha.attributes});
return C}switch(N){case "esriGeometryPoint":N=L;V&&aa?N=G:V?N=b:aa&&(N=I);for(var ea of K){const {geometry:ha,attributes:oa}=ea;V=null!=ha?N(ha):null;C.push({attributes:oa,geometry:V})}break;case "esriGeometryMultipoint":return T(C,K,V,aa);case "esriGeometryPolyline":for(const {geometry:ha,attributes:oa}of K)C.push({attributes:oa,geometry:null!=ha?e(ha,V,aa):null});break;case "esriGeometryPolygon":for(const {geometry:ha,attributes:oa,centroid:pa}of K)ea=null!=ha?P(ha,V,aa):null,null!=pa?(K=L(pa),
C.push({attributes:oa,centroid:K,geometry:ea})):C.push({attributes:oa,geometry:ea});break;default:Aa().error("convertToFeatureSet:unknown-geometry",new g(`Unable to parse unknown geometry type '${N}'`))}return C}function da(C,K,N,V,aa,ea,ha=N,oa=V){ta(C);if(!K?.coords.length)return null;aa=Ha[aa];const {coords:pa,lengths:xa}=K;K=v(N,V);const ua=v(N&&ha,V&&oa);N=D(N,V,ha,oa);if(!xa.length)return N(C.coords,pa,0,0,F(ea,pa[0]),t(ea,pa[1])),ta(C,K,0),C;let va,Ea=0,Ba,Da=0;for(const Fa of xa){if(Fa<aa)continue;
let Ca=0;Ba=Da;oa=V=F(ea,pa[Ea]);va=ha=t(ea,pa[Ea+1]);N(C.coords,pa,Ba,Ea,oa,va);Ca++;Ea+=K;Ba+=ua;for(let Ia=1;Ia<Fa;Ia++,Ea+=K)if(oa=F(ea,pa[Ea]),va=t(ea,pa[Ea+1]),oa!==V||va!==ha)N(C.coords,pa,Ba,Ea,oa-V,va-ha),Ba+=ua,Ca++,V=oa,ha=va;Ca>=aa&&(C.lengths.push(Ca),Da=Ba)}za(C.coords,Da);return C.coords.length?C:null}function fa(C,K,N,V,aa,ea,ha){let oa=V,pa=0;for(let ua=ea+N;ua<ha;ua+=N){var xa=K[ua];const va=K[ua+1],Ea=K[ha],Ba=K[ha+1];let Da=K[ea],Fa=K[ea+1],Ca=Ea-Da,Ia=Ba-Fa;if(0!==Ca||0!==Ia){const Ta=
((xa-Da)*Ca+(va-Fa)*Ia)/(Ca*Ca+Ia*Ia);1<Ta?(Da=Ea,Fa=Ba):0<Ta&&(Da+=Ca*Ta,Fa+=Ia*Ta)}Ca=xa-Da;Ia=va-Fa;xa=Ca*Ca+Ia*Ia;xa>oa&&(pa=ua,oa=xa)}oa>V&&(pa-ea>N&&fa(C,K,N,V,aa,ea,pa),aa(C,K,C.length,pa,K[pa],K[pa+1]),ha-pa>N&&fa(C,K,N,V,aa,pa,ha))}function na(C,K,N,V,aa){const {coords:ea,lengths:ha}=K;N=v(N,V);if(!ea.length)return C!==K&&ta(C),C;z.assertIsSome(aa);const {originPosition:oa,scale:pa,translate:xa}=aa;aa=la;aa.originPosition=oa;V=aa.scale;V[0]=pa[0]??1;V[1]=-(pa[1]??1);V[2]=pa[2]??1;V[3]=pa[3]??
1;var ua=aa.translate;ua[0]=xa[0]??0;ua[1]=xa[1]??0;ua[2]=xa[2]??0;ua[3]=xa[3]??0;if(!ha.length){for(V=0;V<N;++V)C.coords[V]=J(aa,ea[V],V);C!==K&&ta(C,N,0);return C}ua=0;for(let Ea=0;Ea<ha.length;Ea++){const Ba=ha[Ea];C.lengths[Ea]=Ba;for(var va=0;va<N;++va)C.coords[ua+va]=J(aa,ea[ua+va],va);va=C.coords[ua];let Da=C.coords[ua+1];ua+=N;for(let Fa=1;Fa<Ba;Fa++,ua+=N){va+=ea[ua]*V[0];Da+=ea[ua+1]*V[1];C.coords[ua]=va;C.coords[ua+1]=Da;for(let Ca=2;Ca<N;++Ca)C.coords[ua+Ca]=J(aa,ea[ua+Ca],Ca)}}C!==K&&
ta(C,ea.length,ha.length);return C}function ra(C,K,N,V){let aa=0,ea=C[V*K],ha=C[V*(K+1)];for(let oa=1;oa<N;oa++){const pa=ea+C[V*(K+oa)],xa=ha+C[V*(K+oa)+1],ua=(pa-ea)*(xa+ha);ea=pa;ha=xa;aa+=ua}return.5*aa}function ta(C,K=0,N=0){za(C.lengths,N);za(C.coords,K)}function za(C,K=0){C.length!==K&&(C.length=K)}const Aa=()=>u.getLogger("esri.layers.graphics.featureConversionUtils"),Ha={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},
Ka=(C,K,N,V,aa,ea)=>{C[N]=aa;C[N+1]=ea},Ga=(C,K,N,V,aa,ea)=>{C[N]=aa;C[N+1]=ea;C[N+2]=K[V+2]},l=(C,K,N,V,aa,ea)=>{C[N]=aa;C[N+1]=ea;C[N+2]=K[V+3]},H=(C,K,N,V,aa,ea)=>{C[N]=aa;C[N+1]=ea;C[N+2]=K[V+2];C[N+3]=K[V+3]},W=[],ba=[],la={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};d.convertFromFeature=function(C,K,N,V,aa){W[0]=C;[C]=ja(ba,W,K,N,V,aa);za(W);za(ba);return C};d.convertFromFeatureSet=function(C,K){const N=new k,{hasM:V,hasZ:aa,features:ea,objectIdFieldName:ha,spatialReference:oa,
geometryType:pa,exceededTransferLimit:xa,transform:ua,fields:va}=C;va&&(N.fields=va);N.geometryType=pa??null;N.objectIdFieldName=ha??K??null;N.spatialReference=oa??null;if(!N.objectIdFieldName)return Aa().error(new g("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),N;ea&&ja(N.features,ea,pa,aa,V,N.objectIdFieldName);xa&&(N.exceededTransferLimit=xa);V&&(N.hasM=V);aa&&(N.hasZ=aa);ua&&(N.transform=ua);return N};d.convertFromFeatures=ja;d.convertFromGeometry=function(C,
K,N){if(null==C)return null;const V=new y;"hasZ"in C&&null==K&&(K=C.hasZ);"hasM"in C&&null==N&&(N=C.hasM);if(a.isPoint(C))return Q(null!=K?K:null!=C.z,null!=N?N:null!=C.m)(V,C);if(a.isPolygon(C))return X(V,C,K,N);if(a.isPolyline(C))return A(V,C,v(K,N));if(a.isMultipoint(C))return h(V,C,v(K,N));Aa().error("convertFromGeometry:unknown-geometry",new g(`Unable to parse unknown geometry type '${C}'`))};d.convertFromMultipoint=h;d.convertFromMultipointFeatures=R;d.convertFromNestedArray=ca;d.convertFromPoint=
U;d.convertFromPointFeatures=Z;d.convertFromPolygon=X;d.convertFromPolyline=A;d.convertFromPolylineFeatures=n;d.convertToFeature=function(C,K,N,V){ba[0]=C;sa(W,ba,K,N,V);C=W[0];za(W);za(ba);return C};d.convertToFeatureSet=function(C){const {objectIdFieldName:K,spatialReference:N,transform:V,fields:aa,hasM:ea,hasZ:ha,features:oa,geometryType:pa,exceededTransferLimit:xa,uniqueIdField:ua,queryGeometry:va,queryGeometryType:Ea}=C;C=sa([],oa,pa,ha,ea);const Ba=qa(va,Ea,!1,!1);C={features:C,fields:aa,geometryType:pa,
objectIdFieldName:K,spatialReference:N,uniqueIdField:ua,queryGeometry:Ba};V&&(C.transform=V);xa&&(C.exceededTransferLimit=xa);ea&&(C.hasM=ea);ha&&(C.hasZ=ha);return C};d.convertToFeatures=sa;d.convertToGeometry=qa;d.convertToMultipoint=x;d.convertToMultipointFeatures=T;d.convertToPoint=function(C,K,N){return C?K?N?G(C):b(C):N?I(C):L(C):null};d.convertToPolygon=P;d.convertToPolyline=e;d.generalizeOptimizedGeometry=function(C,K,N,V,aa,ea,ha=N,oa=V){ta(C);if(!K?.coords.length)return null;aa=Ha[aa];const {coords:pa,
lengths:xa}=K;K=v(N,V);const ua=v(N&&ha,V&&oa);N=D(N,V,ha,oa);if(!xa.length)return N(C.coords,pa,0,0,pa[0],pa[1]),ta(C,K,0),C;V=0;ea*=ea;for(const va of xa){if(va<aa){V+=va*K;continue}ha=C.coords.length/ua;oa=V;const Ea=V+(va-1)*K;N(C.coords,pa,C.coords.length,oa,pa[oa],pa[oa+1]);fa(C.coords,pa,K,ea,N,oa,Ea);N(C.coords,pa,C.coords.length,Ea,pa[Ea],pa[Ea+1]);oa=C.coords.length/ua-ha;oa>=aa?C.lengths.push(oa):za(C.coords,ha*ua);V+=va*K}return C.coords.length?C:null};d.getBoundsOptimizedGeometry=function(C,
K,N,V){if(!K?.coords?.length)return null;N=v(N,V);let aa=V=Number.POSITIVE_INFINITY,ea=Number.NEGATIVE_INFINITY,ha=Number.NEGATIVE_INFINITY;if(K&&K.coords){K=K.coords;for(let oa=0;oa<K.length;oa+=N){const pa=K[oa],xa=K[oa+1];V=Math.min(V,pa);ea=Math.max(ea,pa);aa=Math.min(aa,xa);ha=Math.max(ha,xa)}}r.is(C)?r.fromRectValues(C,V,aa,ea,ha):M.fromValues(V,aa,ea,ha,C);return C};d.getQuantizedArea=function(C,K){const {coords:N,lengths:V}=C;let aa=C=0;for(let ea=0;ea<V.length;ea++){const ha=V[ea];aa+=ra(N,
C,ha,K);C+=ha}return Math.abs(aa)};d.getQuantizedBoundsOptimizedGeometry=function(C,K,N,V){N=v(N,V);const {lengths:aa,coords:ea}=K;V=K=Number.POSITIVE_INFINITY;let ha=Number.NEGATIVE_INFINITY,oa=Number.NEGATIVE_INFINITY,pa=0;for(const xa of aa){let ua=ea[pa],va=ea[pa+1];K=Math.min(ua,K);V=Math.min(va,V);ha=Math.max(ua,ha);oa=Math.max(va,oa);pa+=N;for(let Ea=1;Ea<xa;Ea++,pa+=N){const Ba=ea[pa],Da=ea[pa+1];ua+=Ba;va+=Da;0>Ba&&(K=Math.min(K,ua));0<Ba&&(ha=Math.max(ha,ua));0>Da?V=Math.min(V,va):0<Da&&
(oa=Math.max(oa,va))}}C[0]=K;C[1]=V;C[2]=ha;C[3]=oa;return C};d.getSignedQuantizedRingArea=ra;d.quantizeOptimizedFeatureSet=function(C,K){const {geometryType:N,features:V,hasM:aa,hasZ:ea}=K;if(!C)return K;for(let ha=0;ha<V.length;ha++){const oa=V[ha],pa=oa.weakClone();pa.geometry=new y;da(pa.geometry,oa.geometry,aa,ea,N,C);oa.centroid&&(pa.centroid=new y,da(pa.centroid,oa.centroid,aa,ea,"esriGeometryPoint",C));V[ha]=pa}K.transform=C;return K};d.quantizeOptimizedGeometry=da;d.quantizeX=F;d.quantizeY=
t;d.removeCollinearVertices=function(C,K,N,V,aa){if(!K?.coords?.length)return null;N=Ha[N];const {coords:ea,lengths:ha}=K;K=D(V,aa,V,aa);V=v(V,aa);let oa=aa=0,pa=0,xa=0;for(const Ea of ha){oa=xa;K(C.coords,ea,oa,aa,ea[aa],ea[aa+1]);aa+=V;var ua=ea[aa];let Ba=ea[aa+1],Da=ua,Fa=Ba;var va=Ba/ua;oa+=V;K(C.coords,ea,oa,aa,Da,Fa);aa+=V;for(let Ca=2;Ca<Ea;Ca++){ua=ea[aa];Ba=ea[aa+1];const Ia=Ba/ua,Ta=va===Ia||!isFinite(va)&&!isFinite(Ia);va=Ta&&isFinite(Ia)?0<=va&&0<=Ia||0>=va&&0>=Ia:0<=Fa&&0<=Ba||0>=Fa&&
0>=Ba;Ta&&va?(Da+=ua,Fa+=Ba):(Da=ua,Fa=Ba,oa+=V);K(C.coords,ea,oa,aa,Da,Fa);aa+=V;va=Ia}oa+=V;ua=(oa-xa)/V;ua>=N&&(C.lengths[pa]=ua,xa=oa,pa++)}C.coords.length>xa&&(C.coords.length=xa);C.lengths.length>pa&&(C.lengths.length=pa);return C.coords.length&&C.lengths.length?C:null};d.removeZMValues=function(C,K,N,V,aa,ea){ta(C);C.lengths.push(...K.lengths);if(N===aa&&V===ea)for(var ha=0;ha<K.coords.length;ha++)C.coords.push(K.coords[ha]);else for(ha=v(N,V),N=D(N,V,aa,ea),K=K.coords,V=0;V<K.length;V+=ha)N(C.coords,
K,C.coords.length,V,K[V],K[V+1]);return C};d.unquantizeOptimizedFeatureSet=function(C){const {transform:K,features:N,hasM:V,hasZ:aa}=C;if(!K)return C;for(const ea of N)null!=ea.geometry&&na(ea.geometry,ea.geometry,V,aa,K),null!=ea.centroid&&na(ea.centroid,ea.centroid,V,aa,K);C.transform=null;return C};d.unquantizeOptimizedGeometry=na;d.unquantizeValue=J;d.unquantizeX=function(C,K){return J(C,K,0)};d.unquantizeY=function(C,K){return J(C,-K,1)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect","./DoubleArray"],function(d,g,u,z){function r(b=L){return[b[0],b[1],b[2],b[3],b[4],b[5]]}function M(b,q,I,f,G,O,Q=r()){Q[0]=b;Q[1]=q;Q[2]=I;Q[3]=f;Q[4]=G;Q[5]=O;return Q}function a(b,q,I,f=r()){F(f,J);p(f,b,q,I);return f}function p(b,q,I=0,f=q.length/3){let G=b[0],O=b[1],Q=b[2],Z=b[3],U=b[4],T=b[5];for(let x=0;x<f;x++)G=Math.min(G,q[I+3*x]),O=Math.min(O,q[I+3*x+1]),Q=Math.min(Q,q[I+3*x+2]),Z=Math.max(Z,
q[I+3*x]),U=Math.max(U,q[I+3*x+1]),T=Math.max(T,q[I+3*x+2]);b[0]=G;b[1]=O;b[2]=Q;b[3]=Z;b[4]=U;b[5]=T}function k(b){return b[0]>=b[3]?0:b[3]-b[0]}function y(b){return b[1]>=b[4]?0:b[4]-b[1]}function v(b){return b[2]>=b[5]?0:b[5]-b[2]}function D(b,q){return Math.max(q[0],b[0])<=Math.min(q[3],b[3])&&Math.max(q[1],b[1])<=Math.min(q[4],b[4])&&Math.max(q[2],b[2])<=Math.min(q[5],b[5])}function F(b,q){b[0]=q[0];b[1]=q[1];b[2]=q[2];b[3]=q[3];b[4]=q[4];b[5]=q[5];return b}function t(b){return 6===b.length}
const J=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],L=[0,0,0,0,0,0],w=r();d.allFinite=function(b){for(let q=0;6>q;q++)if(!isFinite(b[q]))return!1;return!0};d.center=function(b,q=[0,0,0]){q[0]=b[0]+k(b)/2;q[1]=b[1]+y(b)/2;q[2]=b[2]+v(b)/2;return q};d.contains=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[3]<=b[3]&&q[4]<=b[4]&&q[5]<=b[5]};d.containsPoint=function(b,q){return q[0]>=b[0]&&q[1]>=b[1]&&q[2]>=b[2]&&q[0]<=b[3]&&q[1]<=b[4]&&q[2]<=b[5]};d.containsPointWithMargin=
function(b,q,I){return q[0]>=b[0]-I&&q[1]>=b[1]-I&&q[2]>=b[2]-I&&q[0]<=b[3]+I&&q[1]<=b[4]+I&&q[2]<=b[5]+I};d.create=r;d.depth=y;d.diameter=function(b){const q=k(b),I=v(b);b=y(b);return Math.sqrt(q*q+I*I+b*b)};d.empty=function(b){return b?F(b,J):r(J)};d.equals=function(b,q,I){if(null==b||null==q)return b===q;if(!t(b)||!t(q))return!1;if(I)for(let f=0;f<b.length;f++){if(!I(b[f],q[f]))return!1}else for(I=0;I<b.length;I++)if(b[I]!==q[I])return!1;return!0};d.expandWithAABB=function(b,q){b[0]=Math.min(b[0],
q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],q[3]);b[4]=Math.max(b[4],q[4]);b[5]=Math.max(b[5],q[5])};d.expandWithBuffer=p;d.expandWithNestedArray=function(b,q,I){const f=q.length;let G=b[0],O=b[1],Q=b[2],Z=b[3],U=b[4],T=b[5];if(I)for(I=0;I<f;I++){var x=q[I];G=Math.min(G,x[0]);O=Math.min(O,x[1]);Q=Math.min(Q,x[2]);Z=Math.max(Z,x[0]);U=Math.max(U,x[1]);T=Math.max(T,x[2])}else for(I=0;I<f;I++)x=q[I],G=Math.min(G,x[0]),O=Math.min(O,x[1]),Z=Math.max(Z,x[0]),U=Math.max(U,
x[1]);b[0]=G;b[1]=O;b[2]=Q;b[3]=Z;b[4]=U;b[5]=T};d.expandWithOffset=function(b,q,I,f){b[0]=Math.min(b[0],b[0]+q);b[3]=Math.max(b[3],b[3]+q);b[1]=Math.min(b[1],b[1]+I);b[4]=Math.max(b[4],b[4]+I);b[2]=Math.min(b[2],b[2]+f);b[5]=Math.max(b[5],b[5]+f)};d.expandWithRect=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[3]=Math.max(b[3],q[2]);b[4]=Math.max(b[4],q[3])};d.expandWithVec3=function(b,q){b[0]=Math.min(b[0],q[0]);b[1]=Math.min(b[1],q[1]);b[2]=Math.min(b[2],q[2]);b[3]=Math.max(b[3],
q[0]);b[4]=Math.max(b[4],q[1]);b[5]=Math.max(b[5],q[2])};d.fromBuffer=function(b,q=r()){return a(b,0,b.length/3,q)};d.fromExtent=function(b,q=r()){q[0]=b.xmin;q[1]=b.ymin;q[2]=b.hasZ?b.zmin:-Infinity;q[3]=b.xmax;q[4]=b.ymax;q[5]=b.hasZ?b.zmax:Infinity;return q};d.fromMinMax=function(b,q,I=r()){I[0]=b[0];I[1]=b[1];I[2]=b[2];I[3]=q[0];I[4]=q[1];I[5]=q[2];return I};d.fromRect=function(b,q){b[0]=q[0];b[1]=q[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=q[2];b[4]=q[3];b[5]=Number.POSITIVE_INFINITY;return b};d.fromRectValues=
function(b,q,I,f,G){b[0]=q;b[1]=I;b[2]=Number.NEGATIVE_INFINITY;b[3]=f;b[4]=G;b[5]=Number.POSITIVE_INFINITY;return b};d.fromSubBuffer=a;d.fromValues=M;d.getMax=function(b,q){q[0]=b[3];q[1]=b[4];q[2]=b[5];return q};d.getMin=function(b,q){q[0]=b[0];q[1]=b[1];q[2]=b[2];return q};d.height=v;d.intersects=D;d.intersectsClippingArea=function(b,q){return null==q?!0:D(b,q)};d.is=t;d.isPoint=function(b){return 0===k(b)&&0===y(b)&&0===v(b)};d.maximumDimension=function(b){return Math.max(k(b),v(b),y(b))};d.negativeInfinity=
J;d.offset=function(b,q,I,f,G=b){G[0]=b[0]+q;G[1]=b[1]+I;G[2]=b[2]+f;G[3]=b[3]+q;G[4]=b[4]+I;G[5]=b[5]+f;return G};d.positiveInfinity=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];d.scale=function(b,q,I=b){const f=b[0]+k(b)/2,G=b[1]+y(b)/2,O=b[2]+v(b)/2;I[0]=f+(b[0]-f)*q;I[1]=G+(b[1]-G)*q;I[2]=O+(b[2]-O)*q;I[3]=f+(b[3]-f)*q;I[4]=G+(b[4]-G)*q;I[5]=O+(b[5]-O)*q;return I};d.set=F;d.setMax=function(b,q,I=b){I[3]=q[0];I[4]=q[1];I[5]=q[2];I!==b&&(I[0]=b[0],I[1]=b[1],I[2]=b[2]);return b};d.setMin=
function(b,q,I=b){I[0]=q[0];I[1]=q[1];I[2]=q[2];I!==b&&(I[3]=b[3],I[4]=b[4],I[5]=b[5]);return I};d.size=function(b,q=[0,0,0]){q[0]=k(b);q[1]=y(b);q[2]=v(b);return q};d.toCorners=function(b,q=z.newDoubleArray(24)){const [I,f,G,O,Q,Z]=b;q[0]=I;q[1]=f;q[2]=G;q[3]=I;q[4]=f;q[5]=Z;q[6]=I;q[7]=Q;q[8]=G;q[9]=I;q[10]=Q;q[11]=Z;q[12]=O;q[13]=f;q[14]=G;q[15]=O;q[16]=f;q[17]=Z;q[18]=O;q[19]=Q;q[20]=G;q[21]=O;q[22]=Q;q[23]=Z;return q};d.toExtent=function(b,q){return isFinite(b[2])||isFinite(b[5])?new g({xmin:b[0],
xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:q}):new g({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:q})};d.toRect=function(b,q){q||=u.create();q[0]=b[0];q[1]=b[1];q[2]=b[3];q[3]=b[4];return q};d.width=k;d.wrap=function(b,q,I,f,G,O){return M(b,q,I,f,G,O,w)};d.zero=L;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/DoubleArray":function(){define(["exports","../../core/typedArrayUtil"],function(d,g){d.copyInto=function(u,z){for(let r=
0;r<z.length;++r)u[r]=z[r];return u};d.doubleArrayFrom=function(u){return(g.isArray(u)?u.length:u.byteLength/8)<=g.nativeArrayMaxSize?Array.from(u):new Float64Array(u)};d.doubleSubArray=function(u,z,r){return Array.isArray(u)?u.slice(z,z+r):u.subarray(z,z+r)};d.newDoubleArray=function(u,z=!1){return u<=g.nativeArrayMaxSize?z?Array(u).fill(0):Array(u):new Float64Array(u)};d.toFloat64Array=function(u){return Array.isArray(u)?new Float64Array(u):u};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(d,g){class u{constructor(r=null,M={},a,p){this.geometry=r;this.attributes=M;this.centroid=a;this.objectId=p;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(r,M){const a=r.geometry?g.fromJSON(r.geometry):null,p=r.centroid?g.fromJSON(r.centroid):null;return new u(a,r.attributes,p,r.attributes[M])}weakClone(){const r=new u(this.geometry,this.attributes,this.centroid,this.objectId);r.displayId=
this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}clone(){var r=this.geometry?.clone();r=new u(r,{...this.attributes},this.centroid?.clone(),this.objectId);r.displayId=this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}}class z extends u{}d.OptimizedFeature=u;d.OptimizedFeatureWithGeometry=z;d.hasGeometry=function(r){return!!r.geometry?.coords?.length};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class d{constructor(g=
[],u=[]){this.lengths=g??[];this.coords=u??[]}static fromJSON(g){return new d(g.lengths,g.coords)}static fromRect(g){const [u,z,r,M]=g;g=r-u;const a=M-z;return new d([5],[u,z,g,0,0,a,-g,0,0,-a])}get isPoint(){return 0===this.lengths.length&&2<=this.coords.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((g,u)=>g+u)}forEachVertex(g){let u=0;this.lengths.length||g(this.coords[0],this.coords[1]);for(let z=0;z<this.lengths.length;z++){const r=this.lengths[z];
for(let M=0;M<r;M++)g(this.coords[2*(M+u)],this.coords[2*(M+u)+1]);u+=r}}deltaDecode(){const g=this.clone(),{coords:u,lengths:z}=g;let r=0;for(const M of z){for(let a=1;a<M;a++)u[2*(r+a)]+=u[2*(r+a)-2],u[2*(r+a)+1]+=u[2*(r+a)-1];r+=M}return g}clone(g){if(0===this.lengths.length)return new d([],[this.coords[0],this.coords[1]]);var u=2*(0===this.lengths.length?1:this.lengths.reduce((z,r)=>z+r));u=this.coords.slice(0,u);return g?(g.set(u),new d(this.lengths,g)):new d(Array.from(this.lengths),Array.from(u))}}
return d})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class d{constructor(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=this.queryGeometryType=this.uniqueIdField=null}weakClone(){const g=new d;g.objectIdFieldName=this.objectIdFieldName;g.globalIdFieldName=
this.globalIdFieldName;g.geohashFieldName=this.geohashFieldName;g.geometryProperties=this.geometryProperties;g.geometryType=this.geometryType;g.spatialReference=this.spatialReference;g.hasZ=this.hasZ;g.hasM=this.hasM;g.features=this.features;g.fields=this.fields;g.transform=this.transform;g.exceededTransferLimit=this.exceededTransferLimit;g.uniqueIdField=this.uniqueIdField;g.queryGeometry=this.queryGeometry;g.queryGeometryType=this.queryGeometryType;return g}}return d})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(d,g,u,z,r,M,a,p,k,y){const v=r.create();class D{constructor(F){this.geometryInfo=F;this._boundsStore=new p.BoundsStore;this._featuresById=new Map;this.events=new u;this.featureAdapter=y.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let F=0;
this._featuresById.forEach(t=>{null!=t.geometry&&t.geometry.coords&&(F+=t.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:F/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(F){if(null==this.fullBounds)return null;const [t,J,L,w]=this.fullBounds;return{xmin:t,ymin:J,xmax:L,ymax:w,spatialReference:k.cleanFromGeometryEngine(F)}}add(F){this._add(F);this._emitChanged()}addMany(F){for(const t of F)this._add(t);this._emitChanged()}upsertMany(F){F=F.map(t=>this._upsert(t));
this._emitChanged();return F.filter(d.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(F){F=this._featuresById.get(F);if(!F)return null;this._remove(F);this._emitChanged();return F}removeManyById(F){this._boundsStore.invalidateIndex();for(const t of F)(F=this._featuresById.get(t))&&this._remove(F);this._emitChanged()}forEachBounds(F,t){for(const J of F)(F=this._boundsStore.get(J.objectId))&&t(r.fromRect(v,F))}getFeature(F){return this._featuresById.get(F)}has(F){return this._featuresById.has(F)}forEach(F){this._featuresById.forEach(t=>
F(t))}forEachInBounds(F,t){this._boundsStore.forEachInBounds(F,J=>{t(this._featuresById.get(J))})}_emitChanged(){this.events.emit("changed",void 0)}_add(F){if(F){var t=F.objectId;if(null==t)z.getLogger("esri.layers.graphics.data.FeatureStore").error(new g("featurestore:invalid-feature","feature id is missing",{feature:F}));else{var J=this._featuresById.get(t);if(J){F.displayId=J.displayId;var L=this._boundsStore.get(t);this._boundsStore.delete(t)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(F);
F.geometry?.coords?.length?(L=a.getBoundsOptimizedGeometry(null!=L?L:M.create(),F.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=L&&this._boundsStore.set(t,L)):this._boundsStore.set(t,null);this._featuresById.set(t,F)}}}_upsert(F){const t=F?.objectId;if(null==t)return z.getLogger("esri.layers.graphics.data.FeatureStore").error(new g("featurestore:invalid-feature","feature id is missing",{feature:F})),null;const J=this._featuresById.get(t);if(!J)return this._add(F),F;const {geometry:L,
attributes:w}=F;for(const b in w)J.attributes[b]=w[b];L&&(J.geometry=L,this._boundsStore.set(t,a.getBoundsOptimizedGeometry(M.create(),L,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return J}_remove(F){if(null!=this.onFeatureRemove)this.onFeatureRemove(F);const t=F.objectId;this._boundsStore.delete(t);this._featuresById.delete(t);return F}}return D})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],
function(d,g,u,z){function r(p,k,y){M.minX=k[0];M.minY=k[1];M.maxX=k[2];M.maxY=k[3];p.search(M,y)}const M={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new u.PooledRBush(9,g("esri-csp-restrictions")?p=>({minX:p[0],minY:p[1],maxX:p[2],maxY:p[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const p=Array(this._idByBounds.size);let k=0;this._idByBounds.forEach((y,
v)=>{p[k++]=v});this._indexInvalid=!1;this._index.clear();this._index.load(p)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(p=>this._idByBounds.has(p))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const p=z.empty();for(const k of this._boundsById.values())k&&(p[0]=Math.min(k[0],p[0]),p[1]=Math.min(k[1],p[1]),p[2]=Math.max(k[2],p[2]),p[3]=Math.max(k[3],p[3]));return p}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(p){const k=this._boundsById.get(p);this._boundsById.delete(p);k&&(this._idByBounds.delete(k),this._indexInvalid||this._index.remove(k))}forEachInBounds(p,k){this._loadIndex();r(this._index,p,y=>k(this._idByBounds.get(y)))}get(p){return this._boundsById.get(p)}has(p){return this._boundsById.has(p)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(p,
k){if(!this._indexInvalid){const y=this._boundsById.get(p);y&&(this._index.remove(y),this._idByBounds.delete(y))}this._boundsById.set(p,k);k&&(this._idByBounds.set(k,p),this._indexInvalid||(this._boundsToLoad.push(k),5E4<this._boundsToLoad.length&&this._loadIndex()))}}d.BoundsStore=a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has","../../PooledArray","../../../chunks/quickselect"],function(d,
g,u,z,r){function M(U,T){for(q.clear();U;){if(!0===U.leaf)for(const x of U.children)T(x);else q.pushArray(U.children);U=q.pop()??null}}function a(U,T){p(U,0,U.children.length,T,U)}function p(U,T,x,R,h){h||=new Q([]);h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(let e=T,n;e<x;e++)n=U.children[e],k(h,U.leaf?R(n):n);return h}function k(U,T){U.minX=Math.min(U.minX,T.minX);U.minY=Math.min(U.minY,T.minY);U.maxX=Math.max(U.maxX,T.maxX);U.maxY=Math.max(U.maxY,T.maxY)}function y(U,
T){return U.minX-T.minX}function v(U,T){return U.minY-T.minY}function D(U){return(U.maxX-U.minX)*(U.maxY-U.minY)}function F(U){return U.maxX-U.minX+(U.maxY-U.minY)}function t(U,T){return U.minX<=T.minX&&U.minY<=T.minY&&T.maxX<=U.maxX&&T.maxY<=U.maxY}function J(U,T){return T.minX<=U.maxX&&T.minY<=U.maxY&&T.maxX>=U.minX&&T.maxY>=U.minY}function L(U,T,x,R,h){for(T=[T,x];T.length;){x=T.pop();const e=T.pop();if(x-e<=R)continue;const n=e+Math.ceil((x-e)/R/2)*R;r.quickselect(U,n,e,x,h);T.push(e,n,n,x)}}
class w{constructor(U=9,T){this._compareMinX=y;this._compareMinY=v;this._toBBox=x=>x;this._maxEntries=Math.max(4,U||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));T&&("function"===typeof T?this._toBBox=T:this._initFormat(T));this.clear()}destroy(){this.clear();b.prune();q.prune();I.prune();f.prune()}all(U){M(this._data,U)}search(U,T){let x=this._data;const R=this._toBBox;if(J(U,x))for(b.clear();x;){for(let h=0,e=x.children.length;h<e;h++){const n=x.children[h],A=x.leaf?R(n):n;J(U,
A)&&(x.leaf?T(n):t(U,A)?M(n,T):b.push(n))}x=b.pop()}}collides(U){let T=this._data;const x=this._toBBox;if(!J(U,T))return!1;for(b.clear();T;){for(let R=0,h=T.children.length;R<h;R++){const e=T.children[R],n=T.leaf?x(e):e;if(J(U,n)){if(T.leaf||t(U,n))return!0;b.push(e)}}T=b.pop()}return!1}load(U){if(!U.length)return this;if(U.length<this._minEntries){for(let T=0,x=U.length;T<x;T++)this.insert(U[T]);return this}U=this._build(U.slice(),0,U.length-1,0);if(this._data.children.length)if(this._data.height===
U.height)this._splitRoot(this._data,U);else{if(this._data.height<U.height){const T=this._data;this._data=U;U=T}this._insert(U,this._data.height-U.height-1,!0)}else this._data=U;return this}insert(U){U&&this._insert(U,this._data.height-1);return this}clear(){this._data=new Q([]);return this}remove(U){if(!U)return this;let T=this._data,x=null,R=0,h=!1,e;const n=this._toBBox(U);I.clear();for(f.clear();T||0<I.length;){T||(T=I.pop(),x=I.data[I.length-1],R=f.pop()??0,h=!0);if(T.leaf&&(e=g.indexOf(T.children,
U,T.children.length,T.indexHint),-1!==e)){T.children.splice(e,1);I.push(T);this._condense(I);break}h||T.leaf||!t(T,n)?x?(R++,T=x.children[R],h=!1):T=null:(I.push(T),f.push(R),R=0,x=T,T=T.children[0])}return this}toJSON(){return this._data}fromJSON(U){this._data=U;return this}_build(U,T,x,R){var h=x-T+1,e=this._maxEntries;if(h<=e)return U=new Q(U.slice(T,x+1)),a(U,this._toBBox),U;R||(R=Math.ceil(Math.log(h)/Math.log(e)),e=Math.ceil(h/e**(R-1)));const n=new Z([]);n.height=R;h=Math.ceil(h/e);e=h*Math.ceil(Math.sqrt(e));
for(L(U,T,x,e,this._compareMinX);T<=x;T+=e){const A=Math.min(T+e-1,x);L(U,T,A,h,this._compareMinY);for(let P=T;P<=A;P+=h)n.children.push(this._build(U,P,Math.min(P+h-1,A),R-1))}a(n,this._toBBox);return n}_insert(U,T,x){var R=this._toBBox;x=x?U:R(U);I.clear();R=this._data;for(var h=T,e=I;;){e.push(R);if(!0===R.leaf||e.length-1===h)break;let n=Infinity,A=Infinity,P=void 0;for(let X=0,ca=R.children.length;X<ca;X++){const ja=R.children[X],qa=D(ja),sa=(Math.max(ja.maxX,x.maxX)-Math.min(ja.minX,x.minX))*
(Math.max(ja.maxY,x.maxY)-Math.min(ja.minY,x.minY))-qa;sa<A?(A=sa,n=qa<n?qa:n,P=ja):sa===A&&qa<n&&(n=qa,P=ja)}R=P||R.children[0]}R.children.push(U);for(k(R,x);0<=T;)if(I.data[T].children.length>this._maxEntries)this._split(I,T),T--;else break;for(U=I;0<=T;T--)k(U.data[T],x)}_split(U,T){const x=U.data[T];var R=x.children.length;const h=this._minEntries;this._chooseSplitAxis(x,h,R);if(R=this._chooseSplitIndex(x,h,R))R=x.children.splice(R,x.children.length-R),R=x.leaf?new Q(R):new Z(R),R.height=x.height,
a(x,this._toBBox),a(R,this._toBBox),T?U.data[T-1].children.push(R):this._splitRoot(x,R)}_splitRoot(U,T){this._data=new Z([U,T]);this._data.height=U.height+1;a(this._data,this._toBBox)}_chooseSplitIndex(U,T,x){let R,h,e=void 0;R=h=Infinity;for(let A=T;A<=x-T;A++){var n=p(U,0,A,this._toBBox);const P=p(U,A,x,this._toBBox),X=Math.max(0,Math.min(n.maxX,P.maxX)-Math.max(n.minX,P.minX))*Math.max(0,Math.min(n.maxY,P.maxY)-Math.max(n.minY,P.minY));n=D(n)+D(P);X<R?(R=X,e=A,h=n<h?n:h):X===R&&n<h&&(h=n,e=A)}return e}_chooseSplitAxis(U,
T,x){const R=U.leaf?this._compareMinX:y,h=U.leaf?this._compareMinY:v,e=this._allDistMargin(U,T,x,R);T=this._allDistMargin(U,T,x,h);e<T&&U.children.sort(R)}_allDistMargin(U,T,x,R){U.children.sort(R);R=this._toBBox;var h=p(U,0,T,R);const e=p(U,x-T,x,R);let n=F(h)+F(e);for(let A=T;A<x-T;A++){const P=U.children[A];k(h,U.leaf?R(P):P);n+=F(h)}for(x=x-T-1;x>=T;x--)h=U.children[x],k(e,U.leaf?R(h):h),n+=F(e);return n}_condense(U){for(let T=U.length-1;0<=T;T--){const x=U.data[T];if(0===x.children.length)if(0<
T){const R=U.data[T-1],h=R.children;h.splice(g.indexOf(h,x,h.length,R.indexHint),1)}else this.clear();else a(x,this._toBBox)}}_initFormat(U){const T=["return a"," - b",";"];this._compareMinX=new Function("a","b",T.join(U[0]));this._compareMinY=new Function("a","b",T.join(U[1]));this._toBBox=new Function("a","return {minX: a"+U[0]+", minY: a"+U[1]+", maxX: a"+U[2]+", maxY: a"+U[3]+"};")}}const b=new z,q=new z,I=new z,f=new z({deallocator:void 0});class G{constructor(){this.minY=this.minX=Infinity;
this.maxY=this.maxX=-Infinity}}class O extends G{constructor(){super(...arguments);this.height=1;this.indexHint=new g.PositionHint}}class Q extends O{constructor(U){super();this.children=U;this.leaf=!0}}class Z extends O{constructor(U){super();this.children=U;this.leaf=!1}}d.BBox=G;d.PooledRBush=w;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports"],function(d){function g(r,M,a,p,k){for(;p>a;){if(600<p-a){var y=p-a+1,v=M-a+1,D=Math.log(y),
F=.5*Math.exp(2*D/3);D=.5*Math.sqrt(D*F*(y-F)/y)*(0>v-y/2?-1:1);g(r,M,Math.max(a,Math.floor(M-v*F/y+D)),Math.min(p,Math.floor(M+(y-v)*F/y+D)),k)}y=r[M];v=a;F=p;u(r,a,M);for(0<k(r[p],y)&&u(r,a,p);v<F;){u(r,v,F);v++;for(F--;0>k(r[v],y);)v++;for(;0<k(r[F],y);)F--}0===k(r[a],y)?u(r,a,F):(F++,u(r,F,p));F<=M&&(a=F+1);M<=F&&(p=F-1)}}function u(r,M,a){var p=r[M];r[M]=r[a];r[a]=p}function z(r,M){return r<M?-1:r>M?1:0}d.quickselect=function(r,M,a,p,k){g(r,M,a||0,p||r.length-1,k||z)}})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports",
"../featureConversionUtils","../OptimizedGeometry"],function(d,g,u){const z=new u,r=new u,M=new u,a={esriGeometryPoint:g.convertToPoint,esriGeometryPolyline:g.convertToPolyline,esriGeometryPolygon:g.convertToPolygon,esriGeometryMultipoint:g.convertToMultipoint},p=(k,y)=>"_geVersion"!==k?y:void 0;d.cleanFromGeometryEngine=function(k){return k&&"_geVersion"in k?JSON.parse(JSON.stringify(k,p)):k};d.getGeometry=function(k,y,v,D,F,t,J=y,L=v){const w=y&&J,b=v&&L;D=null!=D?"coords"in D?D:D.geometry:null;
if(null==D)return null;if(F)return y=g.generalizeOptimizedGeometry(r,D,y,v,k,F,J,L),t&&(y=g.quantizeOptimizedGeometry(M,y,w,b,k,t)),a[k]?.(y,w,b)??null;if(t)return t=g.quantizeOptimizedGeometry(M,D,y,v,k,t,J,L),a[k]?.(t,w,b)??null;g.removeZMValues(z,D,y,v,J,L);return a[k]?.(z,w,b)??null};d.transformCentroid=function(k,y,v,D=k.hasZ,F=k.hasM){if(null==y)return null;const t=k.hasZ&&D,J=k.hasM&&F;return v?(k=g.quantizeOptimizedGeometry(M,y,k.hasZ,k.hasM,"esriGeometryPoint",v,D,F),g.convertToPoint(k,t,
J)):g.convertToPoint(y,t,J)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(d,g,u,z){d.optimizedFeatureQueryEngineAdapter={getObjectId(r){return r.objectId},getAttributes(r){return r.attributes},getAttribute(r,M){return r.attributes[M]},cloneWithGeometry(r,M){return new u.OptimizedFeature(M,r.attributes,null,r.objectId)},
getGeometry(r){return r.geometry},getCentroid(r,M){null==r.centroid&&(r.centroid=g.getCentroidOptimizedGeometry(new z,r.geometry,M.hasZ,M.hasM));return r.centroid}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],function(d){function g(z,r,M,a,p,k){k=p?k?4:3:k?3:2;let y=M,v=M+k,D=0,F=0,t=M=0,J=0;for(let L=0,w=a-1;L<w;L++,y+=k,v+=k){a=r[y];const b=r[y+1],q=r[y+2],I=r[v],f=r[v+1],G=r[v+2];let O=a*f-I*b;t+=O;D+=(a+I)*O;F+=
(b+f)*O;p&&(O=a*G-I*q,M+=(q+G)*O,J+=O);a<z[0]&&(z[0]=a);a>z[1]&&(z[1]=a);b<z[2]&&(z[2]=b);b>z[3]&&(z[3]=b);p&&(q<z[4]&&(z[4]=q),q>z[5]&&(z[5]=q))}0<t&&(t*=-1);0<J&&(J*=-1);if(!t)return null;z=[D,F,.5*t];p&&(z[3]=M,z[4]=.5*J);return z}function u(z,r,M,a,p){p=a?p?4:3:p?3:2;let k=r,y=r+p,v=0,D=0,F=0,t=0;for(let b=0,q=M-1;b<q;b++,k+=p,y+=p){var J=z[k];const I=z[k+1],f=z[k+2],G=z[y],O=z[y+1],Q=z[y+2];if(a){var L=G-J;var w=O-I;const Z=Q-f;L=Math.sqrt(L*L+w*w+Z*Z)}else L=G-J,w=O-I,L=Math.sqrt(L*L+w*w);L&&
(v+=L,a?(J=[J+.5*(G-J),I+.5*(O-I),f+.5*(Q-f)],D+=L*J[0],F+=L*J[1],t+=L*J[2]):(J=[J+.5*(G-J),I+.5*(O-I)],D+=L*J[0],F+=L*J[1]))}return 0<v?a?[D/v,F/v,t/v]:[D/v,F/v]:0<M?a?[z[r],z[r+1],z[r+2]]:[z[r],z[r+1]]:null}d.getCentroidOptimizedGeometry=function(z,r,M,a){if(!r?.lengths.length)return null;z.lengths.length&&(z.lengths.length=0);z.coords.length&&(z.coords.length=0);const p=z.coords,k=[],y=M?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:v,coords:D}=r;var F=M?a?4:3:a?3:2;let t=0;for(const J of v){const L=g(y,D,t,J,M,a);L&&k.push(L);t+=J*F}k.sort((J,L)=>{let w=J[2]-L[2];0===w&&M&&(w=J[4]-L[4]);return w});k.length&&(F=6*k[0][2],p[0]=k[0][0]/F,p[1]=k[0][1]/F,M&&(F=6*k[0][4],p[2]=0!==F?k[0][3]/F:0),p[0]<y[0]||p[0]>y[1]||p[1]<y[2]||p[1]>y[3]||M&&(p[2]<y[4]||p[2]>y[5]))&&(p.length=0);if(!p.length)if(r=
r.lengths[0]?u(D,0,v[0],M,a):null)p[0]=r[0],p[1]=r[1],M&&2<r.length&&(p[2]=r[2]);else return null;return z};d.lineCentroid=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(d,g,u,
z,r,M,a){function p(L,w){if(!w)return null;if("x"in w){var b={x:0,y:0};[b.x,b.y]=L(w.x,w.y,v);null!=w.z&&(b.z=w.z);null!=w.m&&(b.m=w.m);return b}return"xmin"in w?(b={xmin:0,ymin:0,xmax:0,ymax:0},[b.xmin,b.ymin]=L(w.xmin,w.ymin,v),[b.xmax,b.ymax]=L(w.xmax,w.ymax,v),w.hasZ&&(b.zmin=w.zmin,b.zmax=w.zmax,b.hasZ=!0),w.hasM&&(b.mmin=w.mmin,b.mmax=w.mmax,b.hasM=!0),b):"rings"in w?{rings:k(w.rings,L),hasM:w.hasM,hasZ:w.hasZ}:"paths"in w?{paths:k(w.paths,L),hasM:w.hasM,hasZ:w.hasZ}:"points"in w?{points:y(w.points,
L),hasM:w.hasM,hasZ:w.hasZ}:null}function k(L,w){const b=[];for(const q of L)b.push(y(q,w));return b}function y(L,w){const b=[];for(const q of L)L=w(q[0],q[1],[0,0]),b.push(L),2<q.length&&L.push(q[2]),3<q.length&&L.push(q[3]);return b}const v=[0,0],D=p.bind(null,a.lngLatToXY),F=p.bind(null,a.xyToLngLat);class t{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(L,w,b,q){if(!L?.length||!w||!b||M.equals(w,b))return L;L={geometries:L,inSpatialReference:w,outSpatialReference:b,
geographicTransformation:q,resolve:u.createResolver()};this._jobs.push(L);this._timer??(this._timer=setTimeout(this._process,10));return L.resolve.promise}_process(){this._timer=null;const L=this._jobs.shift();if(L){var {geometries:w,inSpatialReference:b,outSpatialReference:q,resolve:I,geographicTransformation:f}=L;a.canProject(b,q)?M.isWebMercator(q)?I(w.map(D)):I(w.map(F)):I(z.projectMany(r.jsonAdapter,w,b,q,f,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}}}const J=new t;
d.checkProjectionSupport=async function(L,w){L&&w&&(L=Array.isArray(L)?L.map(b=>null!=b.geometry?b.geometry.spatialReference:null).filter(g.isSome):[L],await z.initializeProjection(L.map(b=>({source:b,dest:w}))))};d.project=function(L,w,b,q){if(!L)return L;b||(b=w,w=L.spatialReference);return M.isValid(w)&&M.isValid(b)&&!M.equals(w,b)?a.canProject(w,b)?(L=M.isWebMercator(b)?D(L):F(L),L.spatialReference=b,L):z.projectMany(r.jsonAdapter,[L],w,b,null,q)[0]:L};d.projectMany=function(L,w,b,q){return J.push(L,
w,b,q)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(d){class g{constructor(a,p,k){this.x=a;this.y=p;this.spatialReference=k;this.m=this.z=void 0}}class u{constructor(a,p,k,y){this.rings=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class z{constructor(a,p,k,y){this.paths=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class r{constructor(a,
p,k,y){this.points=a;this.spatialReference=p;this.hasM=this.hasZ=void 0;k&&(this.hasZ=k);y&&(this.hasM=y)}}class M{constructor(a,p,k,y,v){this.xmin=a;this.ymin=p;this.xmax=k;this.ymax=y;this.spatialReference=v;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}d.jsonAdapter={convertToGEGeometry:function(a,p){return null==p?null:a.convertJSONToGeometry(p)},exportPoint:function(a,p,k){k=new g(a.getPointX(p),a.getPointY(p),k);const y=a.hasZ(p),v=a.hasM(p);y&&(k.z=a.getPointZ(p));v&&(k.m=a.getPointM(p));
return k},exportPolygon:function(a,p,k){return new u(a.exportPaths(p),k,a.hasZ(p),a.hasM(p))},exportPolyline:function(a,p,k){return new z(a.exportPaths(p),k,a.hasZ(p),a.hasM(p))},exportMultipoint:function(a,p,k){return new r(a.exportPoints(p),k,a.hasZ(p),a.hasM(p))},exportExtent:function(a,p,k){var y=a.hasZ(p);const v=a.hasM(p);k=new M(a.getXMin(p),a.getYMin(p),a.getXMax(p),a.getYMax(p),k);y&&(y=a.getZExtent(p),k.zmin=y.vmin,k.zmax=y.vmax);v&&(a=a.getMExtent(p),k.mmin=a.vmin,k.mmax=a.vmax);return k}};
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCache ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J,L,w,b,q,I,f,G,O,Q,Z,U,T,x){function R(n){if(Z.canQueryWithRBush(n)){if(F.isExtent(n))return[v.fromValues(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),Math.max(n.xmin,n.xmax),Math.max(n.ymin,n.ymax))];if(F.isPolygon(n))return n.rings.map(A=>v.fromValues(Math.min(A[0][0],A[2][0]),Math.min(A[0][1],A[2][1]),Math.max(A[0][0],A[2][0]),Math.max(A[0][1],A[2][1])))}return[D.getBoundsXY(v.create(),n)]}class h{constructor(n,A=null,P,X,ca){this.attributes=n;this.geometry=
P;this.centroid=X;this.filterFlags=ca;this.groupId=-1;this.displayId=A}}class e{constructor(n){this._cache=new I.QueryEngineCache;this._changeHandle=null;this.capabilities={query:f.queryCapabilities};this.geometryType=n.geometryType;this.hasM=!!n.hasM;this.hasZ=!!n.hasZ;this.objectIdField=n.objectIdField;this.spatialReference=n.spatialReference;this.definitionExpression=n.definitionExpression;this.featureStore=n.featureStore;this.aggregateAdapter=n.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",
()=>this.clearCache());this.timeInfo=n.timeInfo;this.fieldsIndex=z.isSerializable(n.fieldsIndex)?n.fieldsIndex:T.fromJSON(n.fieldsIndex);this.availableFields=!n.availableFields||1===n.availableFields.length&&"*"===n.availableFields[0]?new Set(this.fieldsIndex.fields.map(A=>A.name)):new Set(n.availableFields.map(A=>this.fieldsIndex.get(A)?.name).filter(A=>null!=A));n.scheduler&&n.priority&&(this._frameTask=n.scheduler.registerTask(n.priority))}destroy(){this._frameTask=M.removeMaybe(this._frameTask);
this.clearCache();M.destroyMaybe(this._cache);this._changeHandle=M.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._cache.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(n,A){A=a.signalFromSignalOrOptions(A);try{return await (await this._executeQuery(n,{},A)).createQueryResponse()}catch(P){if(P!==O.queryEngineEmptyResult)throw P;return(new G.QueryEngineResult([],n,this)).createQueryResponse()}}async executeQueryForCount(n=
{},A){A=a.signalFromSignalOrOptions(A);try{return(await this._executeQuery(n,{returnGeometry:!1,returnCentroid:!1,outSR:null},A)).createQueryResponseForCount()}catch(P){if(P!==O.queryEngineEmptyResult)throw P;return 0}}async executeQueryForExtent(n,A){A=a.signalFromSignalOrOptions(A);const P=n.outSR;try{const X=await this._executeQuery(n,{returnGeometry:!0,returnCentroid:!1,outSR:null},A),ca=X.size;if(!ca)return{count:0,extent:null};const ja=await this._getBounds(X.items,X.spatialReference,P||this.spatialReference);
return{count:ca,extent:ja}}catch(X){if(X===O.queryEngineEmptyResult)return{count:0,extent:null};throw X;}}async executeQueryForIds(n,A){return this.executeQueryForIdSet(n,A).then(P=>Array.from(P))}async executeQueryForIdSet(n,A){A=a.signalFromSignalOrOptions(A);try{const P=await this._executeQuery(n,{returnGeometry:!0,returnCentroid:!1,outSR:null},A),X=P.items,ca=new Set;await this._reschedule(()=>{for(const ja of X)ca.add(P.featureAdapter.getObjectId(ja))},A);return ca}catch(P){if(P===O.queryEngineEmptyResult)return new Set;
throw P;}}async executeQueryForSnapping(n,A){const P=a.signalFromSignalOrOptions(A),{point:X,distance:ca,returnEdge:ja,vertexMode:qa}=n;if(!ja&&"none"===qa)return{candidates:[]};let sa=r.clone(n.query);sa=await this._schedule(()=>O.normalizeQueryLike(sa,this.definitionExpression,this.spatialReference),P);sa=await this._reschedule(()=>Q.validateQuery(sa,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),P);(A=!J.equals(X.spatialReference,
this.spatialReference))&&await q.checkProjectionSupport(X.spatialReference,this.spatialReference);var da="number"===typeof ca?ca:ca.x,fa="number"===typeof ca?ca:ca.y;da={xmin:X.x-da,xmax:X.x+da,ymin:X.y-fa,ymax:X.y+fa,spatialReference:X.spatialReference};da=A?q.project(da,this.spatialReference):da;if(!da)return{candidates:[]};fa=(await t.normalizeCentralMeridian(F.fromJSON(X),null,{signal:P}))[0];const na=(await t.normalizeCentralMeridian(F.fromJSON(da),null,{signal:P}))[0];if(null==fa||null==na)return{candidates:[]};
const ra=new G.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(R(na.toJSON())),P),sa,this);await this._reschedule(()=>this._executeObjectIdsQuery(ra),P);await this._reschedule(()=>this._executeTimeQuery(ra),P);await this._reschedule(()=>this._executeAttributesQuery(ra),P);await this._reschedule(()=>this._executeGeometryQueryForSnapping(ra,P),P);fa=fa.toJSON();fa=A?q.project(fa,this.spatialReference):fa;return ra.createSnappingResponse({...n,point:fa,distance:A?Math.max(da.xmax-da.xmin,
da.ymax-da.ymin)/2:ca},X.spatialReference)}async executeQueryForLatestObservations(n,A){A=a.signalFromSignalOrOptions(A);if(!this.timeInfo?.trackIdField)throw new u("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:n,timeInfo:this.timeInfo});try{const P=await this._executeQuery(n,{},A);await this._reschedule(()=>this._filterLatest(P),A);return await P.createQueryResponse()}catch(P){if(P!==O.queryEngineEmptyResult)throw P;return(new G.QueryEngineResult([],n,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(n=
{},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ja}=A;return(await this._executeQueryForStatistics(n,{field:X,normalizationField:ca,valueExpression:ja},P)).createSummaryStatisticsResponse(A)}async executeQueryForUniqueValues(n={},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,field2:ca,field3:ja,valueExpression:qa}=A;return(await this._executeQueryForStatistics(n,{field:X,field2:ca,field3:ja,valueExpression:qa},P)).createUniqueValuesResponse(A)}async executeQueryForClassBreaks(n=
{},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ja}=A;return(await this._executeQueryForStatistics(n,{field:X,normalizationField:ca,valueExpression:ja},P)).createClassBreaksResponse(A)}async executeQueryForHistogram(n={},A,P){P=a.signalFromSignalOrOptions(P);const {field:X,normalizationField:ca,valueExpression:ja}=A;return(await this._executeQueryForStatistics(n,{field:X,normalizationField:ca,valueExpression:ja},P)).createHistogramResponse(A)}async fetchRecomputedExtents(n){n=
a.signalFromSignalOrOptions(n);this._timeExtentPromise||(this._timeExtentPromise=U.getTimeExtent(this.timeInfo,this.featureStore));const [A,P]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);a.throwIfAborted(n);return{fullExtent:A,timeExtent:P}}async _getBounds(n,A,P){const X=y.set(y.create(),y.negativeInfinity);await this.featureStore.forEachBounds(n,ca=>y.expandWithAABB(X,ca));n={xmin:X[0],ymin:X[1],xmax:X[3],ymax:X[4],spatialReference:b.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(X[2])&&isFinite(X[5])&&(n.zmin=X[2],n.zmax=X[5],n.hasZ=!0);A=q.project(n,A,P);A.spatialReference=b.cleanFromGeometryEngine(P);0===A.xmax-A.xmin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.xmin-=P,A.xmax+=P);0===A.ymax-A.ymin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.ymin-=P,A.ymax+=P);this.hasZ&&null!=A.zmin&&null!=A.zmax&&0===A.zmax-A.zmin&&(P=p.getMetersPerUnitForSR(A.spatialReference),A.zmin-=P,A.zmax+=P);return A}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(n=>this._getBounds(n,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(n,A){return null!=this._frameTask?this._frameTask.schedule(n,A):n(x.noBudget)}async _reschedule(n,A){return null!=this._frameTask?this._frameTask.reschedule(n,A):n(x.noBudget)}async _getAllFeaturesQueryEngineResult(n){return new G.QueryEngineResult(await this._getAllFeatures(),
n,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const P=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(X=>P.push(X))})().then(()=>P)}const n=this._allFeaturesPromise,A=await n;return n===this._allFeaturesPromise?A.slice():this._getAllFeatures()}async _executeQuery(n,A,P){n=r.clone(n);n=await this._schedule(()=>O.normalizeQuery(n,this.definitionExpression,this.spatialReference),P);n=await this._reschedule(()=>Q.validateQuery(n,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),P);n={...n,...A};const X=await this._reschedule(()=>this._executeSceneFilterQuery(n,P),P),ca=await this._reschedule(()=>this._executeGeometryQuery(n,X,P),P);await this._reschedule(()=>this._executeAggregateIdsQuery(ca),P);await this._reschedule(()=>this._executeObjectIdsQuery(ca),P);await this._reschedule(()=>this._executeTimeQuery(ca),P);await this._reschedule(()=>this._executeAttributesQuery(ca),
P);return ca}async _executeSceneFilterQuery(n,A){if(null==n.sceneFilter)return null;const {outSR:P,returnGeometry:X,returnCentroid:ca}=n;var ja=this.featureStore.featureSpatialReference,qa=n.sceneFilter.geometry;const sa=null==ja||J.equals(ja,qa.spatialReference)?qa:q.project(qa,ja);if(!sa)return null;ja=X||ca;ja=J.isValid(P)&&!J.equals(this.spatialReference,P)&&ja?async ra=>this._project(ra,P):ra=>ra;const da=this.featureAdapter;qa=await this._reschedule(()=>this._searchFeatures(R(sa)),A);if("disjoint"===
n.sceneFilter.spatialRelationship){if(!qa.length)return null;const ra=new Set;for(var fa of qa)ra.add(da.getObjectId(fa));const ta=await this._reschedule(()=>this._getAllFeatures(),A);fa=await this._reschedule(async()=>{const za=await Z.getSpatialQueryOperator("esriSpatialRelDisjoint",sa,this.geometryType,this.hasZ,this.hasM),Aa=await this._runSpatialFilter(ta,Ha=>!ra.has(da.getObjectId(Ha))||za(da.getGeometry(Ha)),A);return new G.QueryEngineResult(Aa,n,this)},A);return ja(fa)}if(!qa.length)return new G.QueryEngineResult([],
n,this);if(this._canExecuteSinglePass(sa,n))return ja(new G.QueryEngineResult(qa,n,this));const na=await Z.getSpatialQueryOperator("esriSpatialRelContains",sa,this.geometryType,this.hasZ,this.hasM);fa=await this._runSpatialFilter(qa,ra=>na(da.getGeometry(ra)),A);return ja(new G.QueryEngineResult(fa,n,this))}async _executeGeometryQuery(n,A,P){if(null!=A&&0===A.items.length)return A;n=null!=A?A.query:n;const {geometry:X,outSR:ca,spatialRel:ja,returnGeometry:qa,returnCentroid:sa}=n;var da=this.featureStore.featureSpatialReference;
const fa=!X||null==da||J.equals(da,X.spatialReference)?X:q.project(X,da),na=qa||sa,ra=J.isValid(ca)&&!J.equals(this.spatialReference,ca),ta=null==A?this._getCacheKey(n):null;da=ta?this._cache.get(ta):null;if(null!=da)return new G.QueryEngineResult(da,n,this);da=async Ga=>{ra&&na&&await this._project(Ga,ca);ta&&this._cache.put(ta,Ga.items);return Ga};if(!fa)return da(null!=A?A:await this._getAllFeaturesQueryEngineResult(n));const za=this.featureAdapter;let Aa=await this._reschedule(()=>this._searchFeatures(R(X)),
P);if("esriSpatialRelDisjoint"===ja){if(!Aa.length)return da(null!=A?A:await this._getAllFeaturesQueryEngineResult(n));const Ga=new Set;for(var Ha of Aa)Ga.add(za.getObjectId(Ha));const l=null!=A?A.items:await this._reschedule(()=>this._getAllFeatures(),P);Ha=await this._reschedule(async()=>{const H=await Z.getSpatialQueryOperator(ja,fa,this.geometryType,this.hasZ,this.hasM),W=await this._runSpatialFilter(l,ba=>!Ga.has(za.getObjectId(ba))||H(za.getGeometry(ba)),P);return new G.QueryEngineResult(W,
n,this)},P);return da(Ha)}if(null!=A){const Ga=new g.PositionHint;Aa=Aa.filter(l=>0<=g.indexOf(A.items,l,A.items.length,Ga))}if(!Aa.length)return da=new G.QueryEngineResult([],n,this),ta&&this._cache.put(ta,da.items),da;if(this._canExecuteSinglePass(fa,n))return da(new G.QueryEngineResult(Aa,n,this));const Ka=await Z.getSpatialQueryOperator(ja,fa,this.geometryType,this.hasZ,this.hasM);Ha=await this._runSpatialFilter(Aa,Ga=>Ka(za.getGeometry(Ga)),P);return da(new G.QueryEngineResult(Ha,n,this))}async _executeGeometryQueryForSnapping(n,
A){const {query:P}=n,{spatialRel:X}=P;if(n?.items?.length&&P.geometry&&X){var ca=await Z.getSpatialQueryOperator(X,P.geometry,this.geometryType,this.hasZ,this.hasM);A=await this._runSpatialFilter(n.items,ja=>ca(ja.geometry),A);n.items=A}}_executeAggregateIdsQuery(n){if(0!==n.items.length&&n.query.aggregateIds?.length&&null!=this.aggregateAdapter){var A=new Set;for(const X of n.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(X).forEach(ca=>A.add(ca));var P=this.featureAdapter.getObjectId;
n.items=n.items.filter(X=>A.has(P(X)))}}_executeObjectIdsQuery(n){if(0!==n.items.length&&n.query.objectIds?.length){var A=new Set(n.query.objectIds),P=this.featureAdapter.getObjectId;n.items=n.items.filter(X=>A.has(P(X)))}}_executeTimeQuery(n){if(0!==n.items.length){var A=U.getTimeOperator(this.timeInfo,n.query.timeExtent,this.featureAdapter);null!=A&&(n.items=n.items.filter(A))}}_executeAttributesQuery(n){if(0!==n.items.length){var A=w.getWhereClause(n.query.where,this.fieldsIndex);if(A){if(!A.isStandardized)throw new TypeError("Where clause is not standardized");
n.items=n.items.filter(P=>A.testFeature(P,this.featureAdapter))}}}async _runSpatialFilter(n,A,P){if(!A)return n;if(null==this._frameTask)return n.filter(qa=>A(qa));let X=0;const ca=[],ja=async qa=>{for(;X<n.length;){const sa=n[X++];A(sa)&&(ca.push(sa),qa.madeProgress());qa.done&&await this._reschedule(da=>ja(da),P)}};return this._reschedule(qa=>ja(qa),P).then(()=>ca)}_filterLatest(n){const {trackIdField:A,startTimeField:P,endTimeField:X}=this.timeInfo,ca=X||P,ja=new Map,qa=this.featureAdapter.getAttribute;
for(const sa of n.items){const da=qa(sa,A),fa=qa(sa,ca),na=ja.get(da);(!na||fa>qa(na,ca))&&ja.set(da,sa)}n.items=Array.from(ja.values())}_getCacheKey(n){const {geometry:A,spatialRel:P,returnGeometry:X,returnCentroid:ca,outSR:ja,resultType:qa,cacheHint:sa}=n;if("tile"!==qa&&!sa)return null;n=X||ca;return J.isValid(ja)&&!J.equals(this.spatialReference,ja)&&n?JSON.stringify([A,P,ja]):JSON.stringify([A,P])}_canExecuteSinglePass(n,A){({spatialRel:A}=A);return Z.canQueryWithRBush(n)&&("esriSpatialRelEnvelopeIntersects"===
A||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===A||"esriSpatialRelContains"===A))}async _project(n,A){if(!A||J.equals(this.spatialReference,A))return n;const P=this.featureAdapter;let X=void 0;try{const ca=await this._getFullExtent();X=k.getTransformation(this.spatialReference,A,ca)}catch{}A=await q.projectMany(n.items.map(ca=>b.getGeometry(this.geometryType,this.hasZ,this.hasM,P.getGeometry(ca))),this.spatialReference,A,X);n.items=A.map((ca,ja)=>P.cloneWithGeometry(n.items[ja],
L.convertFromGeometry(ca,this.hasZ,this.hasM)));return n}async _searchFeatures(n){const A=new Set;await Promise.all(n.map(P=>this.featureStore.forEachInBounds(P,X=>A.add(X))));n=Array.from(A.values());A.clear();return n}async _executeQueryForStatistics(n,A,P){n=r.clone(n);try{n=await this._schedule(()=>O.normalizeQuery(n,this.definitionExpression,this.spatialReference),P);n=await this._reschedule(()=>Q.validateStatisticsQuery(n,A,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,
geometryType:this.geometryType,spatialReference:this.spatialReference}),P);const X=await this._reschedule(()=>this._executeSceneFilterQuery(n,P),P),ca=await this._reschedule(()=>this._executeGeometryQuery(n,X,P),P);await this._reschedule(()=>this._executeAggregateIdsQuery(ca),P);await this._reschedule(()=>this._executeObjectIdsQuery(ca),P);await this._reschedule(()=>this._executeTimeQuery(ca),P);await this._reschedule(()=>this._executeAttributesQuery(ca),P);return ca}catch(X){if(X!==O.queryEngineEmptyResult)throw X;
return new G.QueryEngineResult([],n,this)}}}d.Feature=h;d.QueryEngine=e;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(d,g,u,z,r,M,a,p,k,y,v){function D(q){const I=[];let f=0,G=0;for(let O=0;O<
q.length;O++){const Q=q[O];let Z=null;for(let U=0;U<Q.length;U++)Z=Q[U],I.push(Z),0===U?G=f=Z[0]:(f=Math.min(f,Z[0]),G=Math.max(G,Z[0]));Z&&I.push([(f+G)/2,0])}return I}function F(q,I){if(!(q instanceof M||q instanceof r))throw b().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new u("straightLineDensify: the input geometry is neither polyline nor polygon");var f=a.getGeometryParts(q);const G=[];for(const Q of f){f=[];G.push(f);f.push([Q[0][0],Q[0][1]]);for(let Z=
0;Z<Q.length-1;Z++){const U=Q[Z][0],T=Q[Z][1],x=Q[Z+1][0],R=Q[Z+1][1];var O=Math.sqrt((x-U)*(x-U)+(R-T)*(R-T));const h=(R-T)/O,e=(x-U)/O,n=O/I;if(1<n){for(let A=1;A<=n-1;A++){const P=A*I;f.push([e*P+U,h*P+T])}O=(O+Math.floor(n-1)*I)/2;f.push([e*O+U,h*O+T])}f.push([x,R])}}return"polygon"===q.type?new r({rings:G,spatialReference:q.spatialReference}):new M({paths:G,spatialReference:q.spatialReference})}function t(q,I,f){I&&(q=F(q,1E6),q=k.webMercatorToGeographic(q,!0));f&&(q=a.updatePolyGeometry(q,f));
return q}function J(q,I,f){if(Array.isArray(q)){var G=q[0];G>I?(f=a.offsetMagnitude(G,I),q[0]=G+-2*f*I):G<f&&(I=a.offsetMagnitude(G,f),q[0]=G+-2*I*f)}else G=q.x,G>I?(f=a.offsetMagnitude(G,I),q=q.clone().offset(-2*f*I,0)):G<f&&(I=a.offsetMagnitude(G,f),q=q.clone().offset(-2*I*f,0));return q}function L(q,I){let f=-1;for(let G=0;G<I.cutIndexes.length;G++){const O=I.cutIndexes[G],Q=I.geometries[G],Z=a.getGeometryParts(Q);for(let U=0;U<Z.length;U++){const T=Z[U];T.some(x=>{if(180>x[0])return!0;x=0;for(var R=
0;R<T.length;R++){var h=T[R][0];x=h>x?h:x}x=Number(x.toFixed(9));x=-360*a.offsetMagnitude(x,180);for(R=0;R<T.length;R++)h=Q.getPoint(U,R),Q.setPoint(U,R,h.clone().offset(x,0));return!0})}if(O===f)if("polygon"===q[0].type)for(const U of a.getGeometryParts(Q))q[O]=q[O].addRing(U);else{if("polyline"===q[0].type)for(const U of a.getGeometryParts(Q))q[O]=q[O].addPath(U)}else f=O,q[O]=Q}return q}async function w(q,I,f){if(!Array.isArray(q))return w([q],I);I&&"string"!==typeof I&&b().warn("normalizeCentralMeridian()",
"The url object is deprecated, use the url string instead");var G="string"===typeof I?I:I?.url??g.geometryServiceUrl;let O,Q,Z;let U=0;var T=[];I=[];for(var x of q)if(null==x)I.push(x);else{if(!R){var R=x.spatialReference;var h=p.getInfo(R);var e=(O=R.isWebMercator)?102100:4326;Q=a.cutParams[e].maxX;Z=a.cutParams[e].minX;var n=a.cutParams[e].plus180Line;e=a.cutParams[e].minus180Line}if(h)if("mesh"===x.type)I.push(x);else if("point"===x.type)I.push(J(x.clone(),Q,Z));else if("multipoint"===x.type){var A=
x.clone();A.points=A.points.map(P=>J(P,Q,Z));I.push(A)}else if("extent"===x.type)A=x.clone()._normalize(!1,!1,h),I.push(A.rings?new r(A):A);else if(x.extent){A=x.extent;const P=2*a.offsetMagnitude(A.xmin,Z)*Q;let X=0===P?x.clone():a.updatePolyGeometry(x.clone(),P);A.offset(P,0);let {xmin:ca,xmax:ja}=A;ca=Number(ca.toFixed(9));ja=Number(ja.toFixed(9));A.intersects(n)&&ja!==Q?(U=ja>U?ja:U,X=t(X,O),T.push(X),I.push("cut")):A.intersects(e)&&ca!==Z?(U=2*ja*Q>U?2*ja*Q:U,X=t(X,O,360),T.push(X),I.push("cut")):
I.push(X)}else I.push(x.clone());else I.push(x)}R=a.offsetMagnitude(U,Q);h=-90;n=R;for(x=new M;0<R;)e=-180+360*R,x.addPath([[e,h],[e,-1*h]]),h*=-1,R--;if(0<T.length&&0<n){R=await y.cut(G,T,x,f);R=L(T,R);h=[];T=[];for(n=0;n<I.length;n++)x=I[n],"cut"!==x?T.push(x):(x=R.shift(),e=q[n],null!=e&&"polygon"===e.type&&e.rings&&1<e.rings.length&&x.rings.length>=e.rings.length?(h.push(x),T.push("simplify")):T.push(O?k.geographicToWebMercator(x):x));if(!h.length)return T;I=await v.simplify(G,h,f);q=[];for(f=
0;f<T.length;f++)G=T[f],"simplify"!==G?q.push(G):q.push(O?k.geographicToWebMercator(I.shift()):I.shift());return q}q=[];for(f=0;f<I.length;f++)G=I[f],"cut"!==G?q.push(G):(G=T.shift(),q.push(!0===O?k.geographicToWebMercator(G):G));return q}const b=()=>z.getLogger("esri.geometry.support.normalizeUtils");d.getClosestDenormalizedXToReference=function(q,I,f){f=p.getInfo(f);if(null==f)return q;const [G,O]=f.valid;f=2*O;let Q=0,Z=0;I>O?Q=Math.ceil(Math.abs(I-O)/f):I<G&&(Q=-Math.ceil(Math.abs(I-G)/f));q>
O?Z=Math.ceil(Math.abs(q-O)/f):q<G&&(Z=-Math.ceil(Math.abs(q-G)/f));q+=(Q-Z)*f;I=q-I;I>O?q-=f:I<G&&(q+=f);return q};d.getDenormalizedExtent=function(q){if(!q)return null;const I=q.extent;if(!I)return null;var f=q.spatialReference&&p.getInfo(q.spatialReference);if(!f)return I;const [G,O]=f.valid;({width:f}=I);let {xmin:Q,xmax:Z}=I;[Q,Z]=[Z,Q];if("extent"===q.type||0===f||f<=O||f>2*O||Q<G||Z>O)return I;let U;switch(q.type){case "polygon":if(1<q.rings.length)U=D(q.rings);else return I;break;case "polyline":if(1<
q.paths.length)U=D(q.paths);else return I;break;case "multipoint":U=q.points}q=I.clone();for(let T=0;T<U.length;T++){let x=U[T][0];0>x?(x+=O,Z=Math.max(x,Z)):(x-=O,Q=Math.min(x,Q))}q.xmin=Q;q.xmax=Z;return q.width<f?(q.xmin-=O,q.xmax-=O,q):I};d.normalizeCentralMeridian=w;d.normalizeMapX=function(q,I){if(I=p.getInfo(I)){const [f,G]=I.valid;I=G-f;if(q<f)for(;q<f;)q+=I;if(q>G)for(;q>G;)q-=I}return q};d.straightLineDensify=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports",
"../Polyline","../SpatialReference","./jsonUtils"],function(d,g,u,z){function r(M){return z.isPolygon(M)?M.rings:M.paths}g={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new g({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:u.WebMercator}),minus180Line:new g({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:u.WebMercator})},4326:{maxX:180,
minX:-180,plus180Line:new g({paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84}),minus180Line:new g({paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84})}};d.cutParams=g;d.getGeometryParts=r;d.offsetMagnitude=function(M,a){return Math.ceil((M-a)/(2*a))};d.updatePolyGeometry=function(M,a){const p=r(M);for(const k of p)for(const y of k)y[0]+=a;return M};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(d,g,u,z,r,M){d.cut=async function(a,p,k,y){a=M.parseUrl(a);const v=p[0].spatialReference;p={...y,responseType:"json",query:{...a.query,f:"json",sr:r.srToRESTValue(v),target:JSON.stringify({geometryType:z.getJsonType(p[0]),geometries:p}),cutter:JSON.stringify(k)}};p=await u(a.path+"/cut",p);const {cutIndexes:D,geometries:F=[]}=p.data;return{cutIndexes:D,geometries:F.map(t=>{t=z.fromJSON(t);t.spatialReference=v;return t})}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(d,g,u,z,r,M){function a(p,k,y){const v={};for(const F in p)if("declaredClass"!==F){var D=p[F];null!=D&&"function"!==typeof D&&(Array.isArray(D)?v[F]=D.map(t=>a(t)):"object"===typeof D?D.toJSON?(D=D.toJSON(y?.[F]),v[F]=k?D:JSON.stringify(D)):v[F]=k?D:JSON.stringify(D):v[F]=D)}return v}d.asValidOptions=function(p,k){return k?{...k,query:{...(p??{}),...k.query}}:{query:p}};d.encode=a;d.getToken=function(p,k){return p?M.isApiKeyApplicable(p,k)?k||g.apiKey:u.id?.findCredential(p)?.token:null};
d.parseUrl=function(p){return"string"===typeof p?r.urlToObject(p):z.clone(p)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(d,g,u,z,r,M){d.simplify=async function(a,p,k){const y="string"===typeof a?u.urlToObject(a):a;a=p[0].spatialReference;const v=z.getJsonType(p[0]);p={...k,query:{...y.query,
f:"json",sr:r.srToRESTValue(a),geometries:JSON.stringify(M.encodeGeometries(p))}};({data:p}=await g(y.path+"/simplify",p));return M.decodeGeometries(p.geometries,v,a)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(d,g){d.decodeGeometries=function(u,z,r){const M=g.getGeometryType(z);return u.map(a=>{a=M.fromJSON(a);a.spatialReference=r;return a})};d.encodeGeometries=function(u){return{geometryType:g.getJsonType(u[0]),
geometries:u.map(z=>z.toJSON())}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(d,g,u,z){function r(t,J,L={}){const w=M(J,t);if(!w)throw L=v.getError(J,t),new g("unsupported-query","invalid SQL expression",{expression:J,error:L});t=L.expressionName||"expression";if(L.validateStandardized&&!w.isStandardized)throw new g("unsupported-query",
`${t} is not standard`,{expression:J});if(L.validateAggregate&&!w.isAggregate)throw new g("unsupported-query",`${t} does not contain a valid aggregate function`,{expression:J});return w.fieldNames}function M(t,J){return t?v.get(t,J):null}function a(t){return/\((.*?)\)/.test(t)?t:t.split(" as ")[0]}function p(t,J,L,w={}){const b=new Map;k(b,t,J,w.allowedFieldTypes??F,L);if(b.size)throw new g("unsupported-query",`${w.expressionName??"expression"} contains invalid or missing fields`,{errors:Array.from(b.values()),
query:w.query});}function k(t,J,L,w,b){b=b.includes("*")?[...L,...b.filter(q=>"*"!==q)]:b;for(const q of b)if(J.get(q))y(t,J,L,w,q);else try{const I=a(q),f=r(J,I,{validateStandardized:!0});for(const G of f)y(t,J,L,w,G)}catch(I){t.set(q,{type:"expression-error",expression:q,error:I})}}function y(t,J,L,w,b){(J=J.get(b))?L.has(J.name)?"all"!==w&&!1===w?.has(J.type)&&t.set(b,{type:"invalid-type",fieldName:J.name,fieldType:z.kebabDict.fromJSON(J.type),allowedFieldTypes:Array.from(w,q=>z.kebabDict.fromJSON(q))}):
t.set(b,{type:"missing-field",fieldName:J.name}):t.set(b,{type:"invalid-field",fieldName:b})}const v=new u.WhereClauseCache(50,500);u=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const D=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),F=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...u,
...D]);d.allDateAndTimeFieldTypes=D;d.getAliasFromFieldName=function(t){return t.split(" as ")[1]};d.getExpressionFromFieldName=a;d.getWhereClause=M;d.numericFieldTypes=u;d.validateFields=p;d.validateHaving=function(t,J,L,w,b){if(!L)return!0;const q=r(t,L,{validateAggregate:!0,expressionName:"having clause"});p(t,J,q,{expressionName:"having clause",query:b});if(!M(L,t)?.getExpressions().every(I=>{const {aggregateType:f,field:G}=I,O=t.get(G)?.name;return w.some(Q=>{const {onStatisticField:Z,statisticType:U}=
Q;return t.get(Z)?.name===O&&U.toLowerCase().trim()===f})}))throw new g("unsupported-query","expressions in having clause should also exist in outStatistics",{having:L});return!0};d.validateWhere=function(t,J,L,w){if(!L)return!0;L=r(t,L,{validateStandardized:!0,expressionName:"where clause"});p(t,J,L,{expressionName:"where clause",query:w});return!0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],
function(d,g,u){class z{constructor(r,M){this._cache=new g.LRUCache(r);this._invalidCache=new g.LRUCache(M)}get(r,M){const a=`${M.uid}:${r}`,p=this._cache.get(a);if(p)return p;if(null!=this._invalidCache.get(a))return null;try{const k=u.WhereClause.create(r,{fieldsIndex:M});this._cache.put(a,k);return k}catch(k){return this._invalidCache.put(a,k),null}}getError(r,M){return this._invalidCache.get(`${M.uid}:${r}`)??null}}d.WhereClauseCache=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(d,g){class u{constructor(z,r){this._storage=new g.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=z;this._storage.register(this);r&&this._storage.registerRemoveFunc("",r)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(z,r,M=1){this._storage.put(this,z,r,M,1)}pop(z){return this._storage.pop(this,z)}get(z){return this._storage.get(this,z)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(z){this._storage.maxSize=
z}resetHitRate(){}}d.LRUCache=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(d,g){d.RemoveMode=void 0;(function(a){a[a.ALL=0]="ALL";a[a.SOME=1]="SOME"})(d.RemoveMode||(d.RemoveMode={}));class u{constructor(a,p,k){this.name=a;this._storage=p;this.id=`${r++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);k&&(this._storage.registerRemoveFunc(this.id,k),
this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(a){return this._storage.getSize(this,a)}resetHitRate(){this._hit=this._miss=0}put(a,p,k,y=0){this._storage.put(this,a,p,k,y)}pop(a){a=this._storage.pop(this,a);void 0===a?++this._miss:++this._hit;return a}get(a){a=this._storage.get(this,
a);void 0===a?++this._miss:++this._hit;return a}peek(a){return this._storage.peek(this,a)}updateSize(a,p,k){this._storage.updateSize(this,a,p,k)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class z{get size(){return this._size}constructor(a=10485760){this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new g;this._users=new g}destroy(){this.clearAll();
this._removeFuncs.clear();this._users.clear();this._db=null}register(a){this._users.push(a)}deregister(a){this._users.removeUnordered(a)}registerRemoveFunc(a,p){this._removeFuncs.push([a,p])}deregisterRemoveFunc(a){this._removeFuncs.filterInPlace(p=>p[0]!==a)}get maxSize(){return this._maxSize}set maxSize(a){this._maxSize=Math.max(a,-1);this._checkSize()}getSize(a,p){return this._db.get(a.id+p)?.size??0}put(a,p,k,y,v){p=a.id+p;const D=this._db.get(p);D&&(this._size-=D.size,a.size-=D.size,this._db.delete(p),
D.entry!==k&&this._notifyRemove(p,D.entry,D.size,d.RemoveMode.ALL));y>this._maxSize?this._notifyRemove(p,k,y,d.RemoveMode.ALL):void 0===k?console.warn("Refusing to cache undefined entry "):!y||0>y?(console.warn(`Refusing to cache entry with size ${y} for key ${p}`),this._notifyRemove(p,k,0,d.RemoveMode.ALL)):(this._db.set(p,new M(k,y,1+Math.max(v,-4)- -3)),this._size+=y,a.size+=y,this._checkSize())}updateSize(a,p,k,y){p=a.id+p;const v=this._db.get(p);if(v&&v.entry===k){this._size-=v.size;for(a.size-=
v.size;y>this._maxSize;)if(y=this._notifyRemove(p,k,y,d.RemoveMode.SOME),!(null!=y&&0<y)){this._db.delete(p);return}v.size=y;this._size+=y;a.size+=y;this._checkSize()}}pop(a,p){p=a.id+p;const k=this._db.get(p);if(k)return this._size-=k.size,a.size-=k.size,this._db.delete(p),++this._hit,k.entry;++this._miss}get(a,p){p=a.id+p;a=this._db.get(p);if(void 0===a)++this._miss;else return this._db.delete(p),a.lives=a.lifetime,this._db.set(p,a),++this._hit,a.entry}peek(a,p){(a=this._db.get(a.id+p))?++this._hit:
++this._miss;return a?.entry}get performanceInfo(){const a={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},p={},k=[];this._db.forEach((D,F)=>{const t=D.lifetime;k[t]=(k[t]||0)+D.size;this._users.forAll(J=>{const {id:L,name:w}=J;F.startsWith(L)&&(p[w]=(p[w]||0)+D.size)})});const y={};this._users.forAll(D=>{const F=D.name;"hitRate"in D&&"number"===typeof D.hitRate&&!isNaN(D.hitRate)&&
0<D.hitRate?(p[F]=p[F]||0,y[F]=Math.round(100*D.hitRate)+"%"):y[F]="0%"});var v=Object.keys(p);v.sort((D,F)=>p[F]-p[D]);v.forEach(D=>a[D]=Math.round(p[D]/2**20)+"MB / "+y[D]);for(v=k.length-1;0<=v;--v){const D=k[v];D&&(a["Priority "+(v+-3-1)]=Math.round(D/this._size*100)+"%")}return a}resetStats(){this._hit=this._miss=0;this._users.forAll(a=>a.resetHitRate())}clear(a){const p=a.id;this._db.forEach((k,y)=>{y.startsWith(p)&&(this._size-=k.size,this._db.delete(y),this._notifyRemove(y,k.entry,k.size,
d.RemoveMode.ALL))});a.size=0}clearAll(){this._db.forEach((a,p)=>this._notifyRemove(p,a.entry,a.size,d.RemoveMode.ALL));this._users.forAll(a=>a.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(a,p,k,y){let v;this._removeFuncs.some(D=>a.startsWith(D[0])?(D=D[1](p,y,k),"number"===typeof D&&(v=D),!0):!1);return v}_checkSize(){this._users.forAll(a=>this._checkSizeLimits(a));this._checkSizeLimits()}_checkSizeLimits(a){const p=a??this;if(!(0>p.maxSize||
p.size<=p.maxSize)){for(var k=a?.id,y=!0;y;){y=!1;for(const [v,D]of this._db)if(0===D.lifetime&&(!k||v.startsWith(k))){this._purgeItem(v,D,a);if(p.size<=.9*p.maxSize)return;y||=this._db.has(v)}}for(const [v,D]of this._db)if(!k||v.startsWith(k))if(this._purgeItem(v,D,a),p.size<=.9*p.maxSize)break}}_purgeItem(a,p,k=this._users.find(y=>a.startsWith(y.id))){this._db.delete(a);if(1>=p.lives){this._size-=p.size;k&&(k.size-=p.size);const y=this._notifyRemove(a,p.entry,p.size,d.RemoveMode.SOME);null!=y&&
0<y&&(this._size+=y,k&&(k.size+=y),p.lives=p.lifetime,p.size=y,this._db.set(a,p))}else--p.lives,this._db.set(a,p)}}let r=0;class M{constructor(a,p,k){this.entry=a;this.size=p;this.lives=this.lifetime=k}}d.MemCache=u;d.MemCacheStorage=z;d.MinPriority=-3;d.NoPriority=-4;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../has ./AggregateFunctions ./DateOnly ./errorSupport ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J){function L(x){return Array.isArray(x)?x:[x]}function w(x){return null!==x?!0!==x:null}function b(x,R){return null!=x&&null!=R?!0===x&&!0===R:!1===x||!1===R?!1:null}function q(x,R){return null!=x&&null!=R?!0===x||!0===R:!0===x||!0===R?!0:null}function I(x,R,h){if(null==x)return null;h=!1;for(const e of R)if(null==e)h=null;else if(x===e){h=!0;break}else if(p.isDateOrTimeValue(x)&&p.isDateOrTimeValue(e)&&(h=p.sqlCompare(x,e,"\x3d")))break;return h}function f(x,
R,h){if(null==x)return null;let e="",n=U.Normal;for(let A=0;A<R.length;A++){const P=R.charAt(A);switch(n){case U.Normal:P===h?n=U.Escaped:e="-[]/{}()*+?.\\^$|".includes(P)?e+("\\"+P):"%"===P?e+".*":"_"===P?e+".":e+P;break;case U.Escaped:e="-[]/{}()*+?.\\^$|".includes(P)?e+("\\"+P):e+P,n=U.Normal}}return(new RegExp("^"+e+"$","m")).test(x)}function G(x,R,h,e){x=e.getAttribute(x,R);R=h?.get(R);return null==x||"esriFieldTypeDate"!==R?.type&&"date"!==R?.type?null==x||"esriFieldTypeDateOnly"!==R?.type&&
"date-only"!==R?.type?null==x||"esriFieldTypeTimeOnly"!==R?.type&&"time-only"!==R?.type?null==x||"esriFieldTypeTimestampOffset"!==R?.type&&"timestamp-offset"!==R?.type?x:new v.SqlTimeStampOffset(x):F.TimeOnly.fromReader(x):r.DateOnly.fromReader(x):k.convertToExecutingTimeZone(new Date(x),h?.getLuxonTimeZone(R.name)??J.FixedOffsetZone.utcInstance)}const O=new Set(["current_timestamp","current_date","current_time"]);class Q{static makeBool(x){return!0===x}static featureValue(x,R,h,e){return G(x,R,h,
e)}static equalsNull(x){return null===x}static applyLike(x,R,h){return f(x,R,h)}static ensureArray(x){return L(x)}static applyIn(x,R,h){return I(x,R)}static currentTimestamp(x){return k.convertToExecutingTimeZone(new Date,x)}static currentDate(x){return r.DateOnly.fromNow(x)}static currentTime(x){x=k.convertToExecutingTimeZone(new Date,x);return F.TimeOnly.fromDateTime(x)}static makeSqlInterval(x,R,h){return y.SqlInterval.createFromValueAndQualifier(x,R,h)}static convertInterval(x){return x instanceof
y.SqlInterval?x.valueInMilliseconds():x}static compare(x,R,h,e){return p.sqlCompare(R,h,x)}static calculate(x,R,h,e){return a.sqlCalculateFunction(x,R,h,e)}static evaluateTime(x){return k.parseTime(x)}static evaluateTimestamp(x,R,h){return k.parseTimestamp(x,R,h)}static evaluateDate(x,R){return k.parseDate(x,R)}static evaluateFunction(x,R,h){return D.evaluateFunction(x,R,h)}static lookup(x,R){x=R[x];return void 0===x?null:x}static between(x,R,h){return null==x||null==R[0]||null==R[1]?null:p.sqlCompare(x,
R[0],"\x3e\x3d")&&p.sqlCompare(x,R[1],"\x3c\x3d")}static notbetween(x,R,h){return null==x||null==R[0]||null==R[1]?null:p.sqlCompare(x,R[0],"\x3c")||p.sqlCompare(x,R[1],"\x3e")}static ternaryNot(x){return w(x)}static ternaryAnd(x,R){return b(x,R)}static ternaryOr(x,R){return q(x,R)}}class Z{constructor(x,R,h="UTC",e=null){this.fieldsIndex=R;this.timeZone=h;this.currentUser=e;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=t.WhereGrammar.parse(x);const {isStandardized:n,isAggregate:A,
currentUserRequired:P,referencedFieldNames:X}=this._extractExpressionInfo(R);this._referencedFieldNames=X;this.isStandardized=n;this.isAggregate=A;this.currentUserRequired=P}static convertValueToStorageFormat(x,R=null){if(null===R)return k.isDate(x)?x.getTime():k.isDateTime(x)?x.toMillis():k.isTimestampOffset(x)?x.toStorageFormat():k.isTimeOnly(x)?x.toStorageString():k.isDateOnly(x)?x.toStorageFormat():x;switch(R){case "date":if(k.isDate(x))return x.getTime();if(k.isDateTime(x))return x.toMillis();
if(k.isTimestampOffset(x))return x.toMilliseconds();if(k.isDateOnly(x))return x.toNumber();break;case "date-only":if(k.isDate(x))return r.DateOnly.fromDateJS(x).toString();if(k.isTimestampOffset(x))return r.DateOnly.fromSqlTimeStampOffset(x).toString();if(k.isDateTime(x))return r.DateOnly.fromDateTime(x).toString();break;case "time-only":if(k.isDate(x))return F.TimeOnly.fromDateJS(x).toStorageString();if(k.isDateTime(x))return F.TimeOnly.fromDateTime(x).toStorageString();if(k.isTimestampOffset(x))return F.TimeOnly.fromSqlTimeStampOffset(x).toStorageString();
if(k.isTimeOnly(x))return x.toStorageString();break;case "timestamp-offset":if(k.isDate(x))return v.SqlTimeStampOffset.fromJSDate(x).toStorageFormat();if(k.isDateTime(x))return v.SqlTimeStampOffset.fromDateTime(x).toStorageFormat();if(k.isTimestampOffset(x))return x.toStorageFormat()}return x}static create(x,R={}){return new Z(x,R.fieldsIndex,R.timeZone??void 0,R.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(x,R=T,h=this.currentUser){return!!this._evaluateNode(this.parseTree,
null,R,x,h)}calculateValue(x,R=T,h=this.currentUser){x=this._evaluateNode(this.parseTree,x,R,null,h);return x instanceof y.SqlInterval?x.valueInMilliseconds()/864E5:x}calculateValueCompiled(x,R=T,h=this.currentUser){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(x,this.parameters,R,this.fieldsIndex,this.timeZone,h??null);if(u("esri-csp-restrictions"))return this.calculateValue(x,R);this._compileMe();return this.parseTree._compiledVersion(x,this.parameters,R,this.fieldsIndex,
this.timeZone,h??null)}testFeature(x,R=T,h=this.currentUser){return!!this._evaluateNode(this.parseTree,x,R,null,h)}testFeatureCompiled(x,R=T,h=this.currentUser){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(x,this.parameters,R,this.fieldsIndex,this.timeZone,h??null);if(u("esri-csp-restrictions"))return this.testFeature(x,R);this._compileMe();return!!this.parseTree._compiledVersion(x,this.parameters,R,this.fieldsIndex,this.timeZone,h??null)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;t.visitAll(this.parseTree,x=>{"current-time"===x.type?this._hasDateFunctions=!0:"function"===x.type&&(this._hasDateFunctions=this._hasDateFunctions||O.has(x.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const x=new Set;t.visitAll(this.parseTree,R=>{"function"===R.type&&x.add(R.name.toLowerCase())});return Array.from(x)}getExpressions(){const x=new Map;t.visitAll(this.parseTree,R=>{if("function"===
R.type){const h=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===R.type){R=R.column;const e=`${h}-${R}`;x.has(e)||x.set(e,{aggregateType:h,field:R})}}});return[...x.values()]}getVariables(){const x=new Set;t.visitAll(this.parseTree,R=>{"parameter"===R.type&&x.add(R.value.toLowerCase())});return Array.from(x)}_compileMe(){const x="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone","currentUser",x)).bind(Q)}_extractExpressionInfo(x){const R=[],h=new Set;let e=!0,n=!1,A=!1;t.visitAll(this.parseTree,P=>{switch(P.type){case "column-reference":var X=x?.get(P.column);let ca;X?X=ca=X.name??"":(ca=P.column,X=ca.toLowerCase());h.has(X)||(h.add(X),R.push(ca));P.column=ca;break;case "current-user":A=!0;break;case "function":const {name:ja,args:qa}=P;P=qa.value.length;e&&=D.isStandardized(ja,P);!1===n&&(n=z.isAggregate(ja,P))}});return{referencedFieldNames:Array.from(R),
isStandardized:e,isAggregate:n,currentUserRequired:A}}evaluateNodeToJavaScript(x){switch(x.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(x.value)+", "+JSON.stringify(x.qualifier)+","+JSON.stringify(x.op)+")";case "case-expression":var R="";if("simple"===x.format){var h=this.evaluateNodeToJavaScript(x.operand);R="( ";for(let e=0;e<x.clauses.length;e++)R+=" (this.compare('\x3d',"+h+","+this.evaluateNodeToJavaScript(x.clauses[e].operand)+") ? ("+this.evaluateNodeToJavaScript(x.clauses[e].value)+
") : "}else for(R="( ",h=0;h<x.clauses.length;h++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(x.clauses[h].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(x.clauses[h].value)+") : ";R=null!==x.else?R+this.evaluateNodeToJavaScript(x.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(x.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(h of x.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(h);return R+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(x.expr)+")";case "binary-expression":switch(x.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+" )";case "IS":if("null"!==x.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(x.left)+")";case "ISNOT":if("null"!==
x.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(x.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(x.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(x.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(x.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(x.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(x.left)+
","+this.evaluateNodeToJavaScript(x.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+","+JSON.stringify(x.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+","+JSON.stringify(x.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(x.operator)+","+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(x.operator)+","+this.evaluateNodeToJavaScript(x.left)+","+this.evaluateNodeToJavaScript(x.right)+", timeZone)";default:throw new M.SqlError(M.SqlErrorCodes.UnsupportedOperator,{operator:x.operator});
}case "null":case "boolean":case "string":case "number":return JSON.stringify(x.value);case "time":return"this.evaluateTime("+JSON.stringify(x.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(x.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(x.value)+", 'unknown')";case "current-time":return"date"===x.mode?"this.currentDate(timeZone)":"time"===x.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case "current-user":return"currentUser";
case "column-reference":return"this.featureValue(feature,"+JSON.stringify(x.column)+",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(x.name)+","+this.evaluateNodeToJavaScript(x.args)+", timeZone)"}throw new M.SqlError(M.SqlErrorCodes.UnsupportedSyntax,{node:x.type});}_evaluateNode(x,R,h,e,n){switch(x.type){case "interval":return h=this._evaluateNode(x.value,R,h,e,n),y.SqlInterval.createFromValueAndQualifier(h,x.qualifier,x.op);case "case-expression":if("simple"===
x.format){var A=this._evaluateNode(x.operand,R,h,e,n);for(var P=0;P<x.clauses.length;P++)if(p.sqlCompare(A,this._evaluateNode(x.clauses[P].operand,R,h,e,n),"\x3d",this.timeZone))return this._evaluateNode(x.clauses[P].value,R,h,e,n)}else for(A=0;A<x.clauses.length;A++)if(!0===this._evaluateNode(x.clauses[A].operand,R,h,e,n))return this._evaluateNode(x.clauses[A].value,R,h,e,n);return null!==x.else?this._evaluateNode(x.else,R,h,e,n):null;case "parameter":return x=this.parameters[x.value.toLowerCase()],
k.isDate(x)?J.DateTime.fromJSDate(x):x instanceof g.ArcadeDate?x.toDateTime():x;case "expression-list":A=[];for(var X of x.value)A.push(this._evaluateNode(X,R,h,e,n));return A;case "unary-expression":return w(this._evaluateNode(x.expr,R,h,e,n));case "binary-expression":switch(x.operator){case "AND":return b(this._evaluateNode(x.left,R,h,e,n),this._evaluateNode(x.right,R,h,e,n));case "OR":return q(this._evaluateNode(x.left,R,h,e,n),this._evaluateNode(x.right,R,h,e,n));case "IS":if("null"!==x.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);
return null===this._evaluateNode(x.left,R,h,e,n);case "ISNOT":if("null"!==x.right.type)throw new M.SqlError(M.SqlErrorCodes.UnsupportedIsRhs);return null!==this._evaluateNode(x.left,R,h,e,n);case "IN":return A=L(this._evaluateNode(x.right,R,h,e,n)),I(this._evaluateNode(x.left,R,h,e,n),A,this.timeZone);case "NOT IN":return A=L(this._evaluateNode(x.right,R,h,e,n)),w(I(this._evaluateNode(x.left,R,h,e,n),A,this.timeZone));case "BETWEEN":return A=this._evaluateNode(x.left,R,h,e,n),x=this._evaluateNode(x.right,
R,h,e,n),null==A||null==x[0]||null==x[1]?null:p.sqlCompare(A,x[0],"\x3e\x3d",this.timeZone)&&p.sqlCompare(A,x[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return A=this._evaluateNode(x.left,R,h,e,n),x=this._evaluateNode(x.right,R,h,e,n),null==A||null==x[0]||null==x[1]?null:p.sqlCompare(A,x[0],"\x3c",this.timeZone)||p.sqlCompare(A,x[1],"\x3e",this.timeZone);case "LIKE":return f(this._evaluateNode(x.left,R,h,e,n),this._evaluateNode(x.right,R,h,e,n),x.escape);case "NOT LIKE":return w(f(this._evaluateNode(x.left,
R,h,e,n),this._evaluateNode(x.right,R,h,e,n),x.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return p.sqlCompare(this._evaluateNode(x.left,R,h,e,n),this._evaluateNode(x.right,R,h,e,n),x.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return a.sqlCalculateFunction(x.operator,this._evaluateNode(x.left,R,h,e,n),this._evaluateNode(x.right,R,h,e,n),this.timeZone)}case "null":case "boolean":case "string":case "number":return x.value;case "date":return x.parsedValue??
(x.parsedValue=k.parseDate(x.value,"unknown")),x.parsedValue;case "timestamp":return x.parsedValue??(x.parsedValue=k.parseTimestamp(x.value,"unknown")),x.parsedValue;case "time":return k.parseTime(x.value);case "current-time":return"date"===x.mode?Q.currentDate(this.timeZone):"time"===x.mode?Q.currentTime(this.timeZone):Q.currentTimestamp(this.timeZone);case "current-user":return n??null;case "column-reference":return G(R,x.column,this.fieldsIndex,h);case "data-type":return x.value;case "function":if(this.isAggregate&&
z.isAggregate(x.name,x.args.value.length)){R=[];for(A of x.args?.value||[]){X=[];for(P of e||[])X.push(this._evaluateNode(A,P,h,null,n));R.push(X)}return z.aggregateFunction(x.name,R)}h=this._evaluateNode(x.args,R,h,e,n);return D.evaluateFunction(x.name,h,this.timeZone)}throw new M.SqlError(M.SqlErrorCodes.UnsupportedSyntax,{node:x.type});}}var U;(function(x){x[x.Normal=0]="Normal";x[x.Escaped=1]="Escaped"})(U||={});const T={getAttribute(x,R){return(x&&"object"===typeof x.attributes?x.attributes:
x)[R]}};d.WhereClause=Z;d.defaultAttributeAdapter=T;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(d,g,u,z){function r(y,v,D){return y<v?y-v:y>D?y-D:0}function M(y,v=!0){if(y instanceof z.Zone)return y;if("system"===y.toLowerCase())return"system";if("utc"===y.toLowerCase())return"UTC";if("unknown"===y.toLowerCase())return u.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(y)){const D=
z.FixedOffsetZone.parseSpecifier("UTC"+(y.startsWith("+")||y.startsWith("-")?"":"+")+y);if(D)return D}y=z.IANAZone.create(y);if(!y.isValid){if(v)throw new p(d.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return y}d.ArcadeDateErrorCodes=void 0;(d.ArcadeDateErrorCodes||(d.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const a={[d.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class p extends Error{constructor(y,v){super(g.replace(a[y],
v));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,p)}}class k{constructor(y){this._date=y;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(y=0,v=1,D=1,F=0,t=0,J=0,L=0,w){if(isNaN(y)||isNaN(v)||isNaN(D)||isNaN(F)||isNaN(t)||isNaN(J)||isNaN(L))return null;const b=z.DateTime.local(y,v).daysInMonth;y=z.DateTime.fromObject({day:1>D?1:D>b?b:D,year:y,month:1>v?1:12<v?12:v,hour:0>F?0:23<F?23:F,minute:0>t?0:59<t?59:t,second:0>
J?0:59<J?59:J,millisecond:0>L?0:999<L?999:L},{zone:M(w)});y=y.plus({months:r(v,1,12),days:r(D,1,b),hours:r(F,0,23),minutes:r(t,0,59),seconds:r(J,0,59),milliseconds:r(L,0,999)});return new k(y)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(y,v){v=M(v);return y.isUnknownTimeZone||v===u.UnknownTimeZone.instance?k.fromParts(y.year,y.monthJS+1,y.day,y.hour,y.minute,y.second,y.millisecond,v):new k(y._date.setZone(v))}static dateJSToArcadeDate(y){return new k(z.DateTime.fromJSDate(y,
{zone:"system"}))}static dateJSAndZoneToArcadeDate(y,v="system"){v=M(v);return new k(z.DateTime.fromJSDate(y,{zone:v}))}static unknownEpochToArcadeDate(y){return new k(z.DateTime.fromMillis(y,{zone:u.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(y){return new k(z.DateTime.fromMillis(y.getTime(),{zone:u.UnknownTimeZone.instance}))}static epochToArcadeDate(y,v="system"){v=M(v);return new k(z.DateTime.fromMillis(y,{zone:v}))}static dateTimeToArcadeDate(y){return new k(y)}clone(){return new k(this._date)}changeTimeZone(y){y=
M(y);return k.dateTimeToArcadeDate(this._date.setZone(y))}static dateTimeAndZoneToArcadeDate(y,v){v=M(v);return y.zone===u.UnknownTimeZone.instance||v===u.UnknownTimeZone.instance?k.fromParts(y.year,y.month,y.day,y.hour,y.minute,y.second,y.millisecond,v):new k(y.setZone(v))}static nowToArcadeDate(y){y=M(y);return new k(z.DateTime.fromJSDate(new Date,{zone:y}))}static nowUTCToArcadeDate(){return new k(z.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===k.systemTimeZoneCanonicalName}equals(y){return this.isSystem&&
y.isSystem?this.toNumber()===y.toNumber():this.isUnknownTimeZone!==y.isUnknownTimeZone?!1:this._date.equals(y._date)}get isUnknownTimeZone(){return this._date.zone===u.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let y=this._date.weekday;6<y&&(y=0);return y}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-
1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const y=this.zone;return"fixed"===y.type?0===y.fixed?"UTC":y.formatOffset(0,"short"):y.name}stringify(){return JSON.stringify(this.toJSDate())}plus(y){return new k(this._date.plus(y))}diff(y,v="milliseconds"){return this._date.diff(y._date,
v)[v]}toISODate(){return this._date.toISODate()}toISOString(y){return y?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(y,v){return this._date.toISOTime({suppressMilliseconds:y,includeOffset:v&&!this.isUnknownTimeZone})}toFormat(y,v){this.isUnknownTimeZone&&(y=y.replaceAll("Z",""));return this._date.toFormat(y,v)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new k(this._date.toUTC())}toLocal(){return new k(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(y){if(!y)return null;
y=z.DateTime.fromISO(y,{setZone:!0});return new k(y)}}d.ArcadeDate=k;d.ArcadeDateError=p;d.arcadeDateErrorMessages=a;d.createDateTimeZone=M;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(d,g){function u(r){return r instanceof g.Zone?r===z.instance?!0:!1:"unknown"===r?.toString().toLowerCase()?!0:!1}class z{}z.instance=new g.IANAZone("Etc/UTC");d.UnknownTimeZone=z;d.adoptTimeZone=function(r,
M){return g.DateTime.fromObject({day:r.day,year:r.year,month:r.month,hour:r.hour,minute:r.minute,second:r.second,millisecond:r.millisecond},{zone:M})};d.isUnknownTimeZone=u;d.substituteUnknownTimezone=function(r){return u(r)?z.instance:r};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ./DateOnly ./errorSupport ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(d,g,u,z,r,M){function a(v){if(null===
v)return null;let D=0,F=0;for(let t=0;t<v.length;t++){const J=v[t];if(null!==J){if("number"!==typeof J)throw new u.SqlError(u.SqlErrorCodes.InvalidValueForAggregateFunction);F++;D+=J}}return 0===F?null:D/v.length}function p(v,D){if(null===v)return null;let F=null,t=null;for(const J of v)v=J,v=J instanceof g.DateOnly?J.toNumber():J instanceof r.TimeOnly?J.toNumber():J instanceof M.DateTime?J.toMillis():J instanceof z.SqlTimeStampOffset?J.toMilliseconds():J,null===F?(F=J,t=v):"max"===D&&null!==t&&null!==
v&&t<=v?(F=J,t=v):"min"===D&&null!==t&&null!==v&&t>=v&&(F=J,t=v);return F}function k(v){if(null===v)return null;v=v.filter(t=>null!==t);if(0===v.length)return null;const D=a(v);if(null===D)return null;let F=0;for(const t of v){if("number"!==typeof t)throw new u.SqlError(u.SqlErrorCodes.InvalidValueForAggregateFunction);F+=(D-t)**2}return F/(v.length-1)}const y={min:{minParams:1,maxParams:1,evaluate:v=>p(v[0],"min")},max:{minParams:1,maxParams:1,evaluate:v=>p(v[0],"max")},avg:{minParams:1,maxParams:1,
evaluate:v=>a(v[0])},sum:{minParams:1,maxParams:1,evaluate:v=>{v=v[0];if(null===v)v=null;else{var D=0;for(let F=0;F<v.length;F++){const t=v[F];if(null!==t){if("number"!==typeof t)throw new u.SqlError(u.SqlErrorCodes.InvalidValueForAggregateFunction);D+=t}}v=D}return v}},stddev:{minParams:1,maxParams:1,evaluate:v=>{v=v[0];null===v?v=null:(v=k(v),v=null===v?null:Math.sqrt(v));return v}},count:{minParams:1,maxParams:1,evaluate:v=>null==v[0]?null:v[0].length},var:{minParams:1,maxParams:1,evaluate:v=>
k(v[0])}};d.aggregateFunction=function(v,D){const F=y[v.toLowerCase()];if(null==F)throw new u.SqlError(u.SqlErrorCodes.FunctionNotRecognized);if(D.length<F.minParams||D.length>F.maxParams)throw new u.SqlError(u.SqlErrorCodes.InvalidParameterCount,{name:v.toUpperCase()});return F.evaluate(D)};d.isAggregate=function(v,D){v=y[v.toLowerCase()];return null!=v&&D>=v.minParams&&D<=v.maxParams};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(d,g,u,z){function r(a){a=a.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let p="";const k=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const y of a.match(k)||[])switch(y){case "D":p+="d";break;case "DD":p+="dd";break;case "DDD":p+="o";break;case "d":p+="c";break;case "ddd":p+=
"ccc";break;case "dddd":p+="cccc";break;case "M":p+="L";break;case "MM":p+="LL";break;case "MMM":p+="LLL";break;case "MMMM":p+="LLLL";break;case "YY":p+="yy";break;case "Y":case "YYYY":p+="yyyy";break;case "Q":p+="q";break;case "X":case "x":p+=y;break;default:p=2<=y.length&&"["===y.slice(0,1)&&"]"===y.slice(-1)?p+`'${y.slice(1,-1)}'`:p+`'${y}'`}return p}class M{constructor(a,p,k){this._year=a;this._month=p;this._day=k;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(a){return a instanceof M&&a.day===this.day&&a.month===this.month&&a.year===this.year}clone(){return new M(this._year,this._month,this._day)}toDateTime(a){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:g.createDateTimeZone(a)})}toDateTimeLuxon(a){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:g.createDateTimeZone(a)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(a=null,p=!0){if(null===a||""===a)return this.toString();p&&(a=r(a));if(!a)return"";p=this.toDateTime("unknown");return g.ArcadeDate.dateTimeToArcadeDate(p).toFormat(a,{locale:u.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const a=this.toDateTime("unknown");return g.ArcadeDate.dateTimeToArcadeDate(a)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(a,p){return M.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}toUTCDateTime(){return z.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(a){a=z.DateTime.fromMillis(a,{zone:z.FixedOffsetZone.utcInstance});return a.isValid?M.fromParts(a.year,a.month,a.day):null}static fromSeconds(a){a=z.DateTime.fromSeconds(a,{zone:z.FixedOffsetZone.utcInstance});return a.isValid?M.fromParts(a.year,a.month,a.day):null}static fromReader(a){if(!a)return null;a=a.split("-");return 3!==a.length?null:new M(parseInt(a[0],10),parseInt(a[1],
10),parseInt(a[2],10))}static fromParts(a,p,k){a=new M(a,p,k);return!1===a.isValid?null:a}static fromDateJS(a){return M.fromParts(a.getFullYear(),a.getMonth()+1,a.getDay())}static fromDateTime(a){return M.fromParts(a.year,a.month,a.day)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;var k=[];if(p)(p=r(p))&&k.push(p);else if(null===p||""===p)return a=z.DateTime.fromISO(a,{setZone:!0}),a.isValid?M.fromParts(a.year,
a.month,a.day):null;for(const y of k)if(k=z.DateTime.fromFormat(a,p??y),k.isValid)return new M(k.year,k.month,k.day);return null}static fromNow(a="system"){a=z.DateTime.fromJSDate(new Date).setZone(g.createDateTimeZone(a));return new M(a.year,a.month,a.day)}}d.DateOnly=M;d.standardizeDateOnlyFormat=r;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/errorSupport":function(){define(["exports","../string"],function(d,g){d.SqlErrorCodes=void 0;(function(r){r.InvalidFunctionParameters=
"InvalidFunctionParameters";r.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";r.UnsupportedSqlFunction="UnsupportedSqlFunction";r.UnsupportedOperator="UnsupportedOperator";r.UnsupportedSyntax="UnsupportedSyntax";r.UnsupportedIsRhs="UnsupportedIsRhs";r.UnsupportedIsLhs="UnsupportedIsLhs";r.InvalidDataType="InvalidDataType";r.CannotCastValue="CannotCastValue";r.FunctionNotRecognized="FunctionNotRecognized";r.InvalidTime="InvalidTime";r.InvalidParameterCount="InvalidParameterCount";
r.InvalidTimeStamp="InvalidTimeStamp";r.InvalidDate="InvalidDate";r.InvalidOperator="InvalidOperator";r.IllegalInterval="IllegalInterval";r.YearMonthIntervals="YearMonthIntervals";r.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";r.MissingStatisticParameters="MissingStatisticParameters"})(d.SqlErrorCodes||(d.SqlErrorCodes={}));const u={[d.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[d.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[d.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[d.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[d.SqlErrorCodes.InvalidDate]:"Invalid date encountered",[d.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[d.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[d.SqlErrorCodes.IllegalInterval]:"Illegal interval",[d.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[d.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[d.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",
[d.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",[d.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class z extends Error{constructor(r,M){super(g.replace(u[r],M));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,z)}}d.SqlError=z;d.sqlErrorMessages=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports",
"../../chunks/datetime"],function(d,g){function u(r){return Number.isNaN(r)||0===r?r:Math.trunc(r)}class z{constructor(r){this._timeStampOffset=r;this._date=null}toDateTime(){this._date??(this._date=g.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return u(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return u(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return z.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(r){return new z(g.DateTime.fromJSDate(r).toISO({includeOffset:!0}))}static fromDateTime(r){return new z(r.toISO({includeOffset:!0}))}static fromParts(r,
M,a=0,p=0,k=0,y=0,v=0,D=!1,F=0,t=0){r=`${r.toString().padStart(4,"0")}-${M.toString().padStart(2,"0")}-${a.toString().padStart(2,"0")}`;M="";10>y&&(M="0");p=`${p.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}:${M+y.toString()}`;0!==v&&(p+="."+v.toString().padStart(3,"0"));v=`${D?"-":"+"}${F.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`;return new z(r+"T"+p+v)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let r=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});r&&=r.replace(".000","");return r}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(r){r=this.toDateTime().plus(r);return z.fromDateTime(r)}}d.SqlTimeStampOffset=z;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(d,g,u,z){function r(a){if(!a)return"";const p=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let k="";for(const y of a.match(p)||
[])switch(y){case "SSS":k+=y;break;case "A":case "a":k+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":k+=y;break;default:k+=`'${y}'`}return k}class M{constructor(a,p,k,y){this._hour=a;this._minute=p;this._second=k;this._millisecond=y;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(a){return a instanceof M&&a.hour===
this.hour&&a.minute===this.minute&&a.second===this.second&&a.millisecond===this.millisecond}clone(){return new M(this.hour,this.minute,this.second,this.millisecond)}isValid(){return g.isInteger(this.hour)&&g.isInteger(this.minute)&&g.isInteger(this.second)&&g.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(a=null){return null===a||""===a?this.toString():(a=r(a))?z.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(a,{locale:u.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(a,p,k,y){a=new M(a,p,k,y);return a.isValid()?a:null}static fromReader(a){if(!a)return null;a=a.split(":");return 3!==a.length?null:new M(parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],
10),0)}static fromMilliseconds(a){return 864E5<a||0>a?null:new M(Math.floor(a/36E5%24),Math.floor(a/6E4%60),Math.floor(a/1E3%60),Math.floor(a%1E3))}static fromDateJS(a){return new M(a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())}static fromDateTime(a){return new M(a.hour,a.minute,a.second,a.millisecond)}static fromSqlTimeStampOffset(a){return this.fromDateTime(a.toDateTime())}static fromString(a,p=null){if(""===a||null===a)return null;const k=[];if(p)(p=r(p))&&k.push(p);else if(null===
p||""===p)k.push("HH:mm:ss"),k.push("HH:mm:ss.SSS"),k.push("hh:mm:ss a"),k.push("hh:mm:ss.SSS a"),k.push("HH:mm"),k.push("hh:mm a"),k.push("H:mm"),k.push("h:mm a"),k.push("H:mm:ss"),k.push("h:mm:ss a"),k.push("H:mm:ss.SSS"),k.push("h:mm:ss.SSS a");for(const y of k)if(p=z.DateTime.fromFormat(a,y),p.isValid)return new M(p.hour,p.minute,p.second,p.millisecond);return null}plus(a,p){switch(a){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return M.fromDateTime(this.toUTCDateTime().plus({[a]:p}))}return null}toUTCDateTime(){return z.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(a,p){switch(p.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(a.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===p?this.toUTCDateTime().diff(a.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(a.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(a.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(a.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(a.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(a.toUTCDateTime(),"milliseconds").milliseconds}}}d.TimeOnly=M;d.standardizeTimeFormat=r;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(d,g){d.cloneGeometry=function(u){if(null==u)return null;const z=u.clone();void 0!==u.cache._geVersion&&(z.cache._geVersion=u.cache._geVersion);return z};d.convertLinearUnitsToCode=function(u){if(null==u)return null;if("number"===typeof u)return u;u=u.toLowerCase();u=u.replaceAll(/\s/g,"");u=u.replaceAll("-","");switch(u){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};d.convertSquareUnitsToCode=
function(u){if(null==u)return null;if("number"===typeof u)return u;u=u.toLowerCase();u=u.replaceAll(/\s/g,"");u=u.replaceAll("-","");switch(u){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};d.isInteger=function(u){return"number"===typeof u&&isFinite(u)&&Math.floor(u)===u};d.sameGeomType=function(u,z){return u===z||"point"===u&&"esriGeometryPoint"===z||"polyline"===u&&"esriGeometryPolyline"===
z||"polygon"===u&&"esriGeometryPolygon"===z||"extent"===u&&"esriGeometryEnvelope"===z||"multipoint"===u&&"esriGeometryMultipoint"===z||"point"===z&&"esriGeometryPoint"===u||"polyline"===z&&"esriGeometryPolyline"===u||"polygon"===z&&"esriGeometryPolygon"===u||"extent"===z&&"esriGeometryEnvelope"===u||"multipoint"===z&&"esriGeometryMultipoint"===u?!0:!1};d.shapeExtent=function(u){if(null==u)return null;switch(u.type){case "polygon":case "multipoint":case "polyline":return u.extent;case "point":return new g({xmin:u.x,
ymin:u.y,xmax:u.x,ymax:u.y,spatialReference:u.spatialReference});case "extent":return u}return null};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(d,g,u,z,r){function M(C,K,N){switch(N){case "+":return C+K;case "-":return C-K;case "*":return C*K;case "/":return C/K}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function a(C,
K,N){switch(N){case "+":return K.plus({milliseconds:C.valueInMilliseconds()});case "-":return C.valueInMilliseconds()-K.toMillis()}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function p(C,K,N){switch(N){case "+":return K.plus("milliseconds",C.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function k(C,K,N){switch(N){case "+":return K.plus("milliseconds",C.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function y(C,K,N){switch(N){case "+":return C.plus("milliseconds",
K.valueInMilliseconds());case "-":return C.plus("milliseconds",-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function v(C,K,N){switch(N){case "+":return K.addMilliseconds(C.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function D(C,K,N){switch(N){case "+":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()+K.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()-K.valueInMilliseconds());
case "*":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()*K.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()/K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function F(C,K,N){switch(N){case "+":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()+K);case "-":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()-K);case "*":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()*
K);case "/":return z.SqlInterval.createFromMilliseconds(C.valueInMilliseconds()/K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function t(C,K,N){switch(N){case "+":return z.SqlInterval.createFromMilliseconds(C+K.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(C-K.valueInMilliseconds());case "*":return z.SqlInterval.createFromMilliseconds(C*K.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(C/K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function J(C,K,N){switch(N){case "+":return C.plus("milliseconds",K.valueInMilliseconds());case "-":return C.plus("milliseconds",-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function L(C,K,N){switch(N){case "+":return C.plus({milliseconds:K.valueInMilliseconds()});case "-":return C.minus({milliseconds:K.valueInMilliseconds()})}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function w(C,K,N){switch(N){case "+":return C.addMilliseconds(K.valueInMilliseconds());
case "-":return C.addMilliseconds(-1*K.valueInMilliseconds())}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function b(C,K,N){K*=864E5;switch(N){case "+":return C.plus({milliseconds:K});case "-":return C.minus({milliseconds:K})}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function q(C,K,N){K*=864E5;switch(N){case "+":return C.plus("milliseconds",K);case "-":return C.plus("milliseconds",-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function I(C,K,N){K*=864E5;switch(N){case "+":return C.plus("milliseconds",
K);case "-":return C.plus("milliseconds",-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function f(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function G(C,K,N){K*=864E5;switch(N){case "+":return C.addMilliseconds(K);case "-":return C.addMilliseconds(-1*K)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function O(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Q(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Z(C,
K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function U(C,K,N){K=parseFloat(K);if(isNaN(K))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);return M(C,K,N)}function T(C,K,N){C=parseFloat(C);if(isNaN(C))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);return M(C,K,N)}function x(C,K,N){switch(N){case "+":return C+K}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function R(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function h(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function e(C,K,N){switch(N){case "-":return C.toDateTimeLuxon(K.zone).diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function n(C,K,N){switch(N){case "-":return C.toDateTimeLuxon(K.toDateTime().zone).diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function A(C,K,N){switch(N){case "-":return C.toDateTimeLuxon("UTC").diff(K.toDateTimeLuxon("UTC")).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function P(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function X(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ca(C,K,N){switch(N){case "-":return C.toDateTime().diff(K.toDateTimeLuxon(C.toDateTime().zone)).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ja(C,K,N){switch(N){case "-":return C.toDateTime().diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function qa(C,K,N){switch(N){case "-":return C.toDateTime().diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function sa(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function da(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function fa(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function na(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ra(C,K,N){switch(N){case "-":return C.diff(K).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ta(C,K,N){switch(N){case "-":return C.diff(K.toDateTimeLuxon(C.zone)).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function za(C,K,N){switch(N){case "-":return C.diff(K.toDateTime()).as("days")}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Aa(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Ha(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Ka(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function Ga(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function l(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}function H(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function W(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function ba(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}function la(C,K,N){throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}d.calculateDateOnlyAndDateOnly=A;d.calculateDateOnlyAndDateTime=e;d.calculateDateOnlyAndNumber=q;d.calculateDateOnlyAndSqlInterval=J;d.calculateDateOnlyAndString=Ha;d.calculateDateOnlyAndTimeOnly=P;d.calculateDateOnlyAndTimestamp=
n;d.calculateDateTimeAndDateOnly=ta;d.calculateDateTimeAndDateTime=ra;d.calculateDateTimeAndNumber=b;d.calculateDateTimeAndSqlInterval=L;d.calculateDateTimeAndString=Ga;d.calculateDateTimeAndTimeOnly=Aa;d.calculateDateTimeAndTimestamp=za;d.calculateNumberAndDateOnly=Z;d.calculateNumberAndDateTime=f;d.calculateNumberAndNumber=M;d.calculateNumberAndSqlInterval=t;d.calculateNumberAndString=U;d.calculateNumberAndTimeOnly=Q;d.calculateNumberAndTimestamp=O;d.calculateSqlIntervalAndDateOnly=k;d.calculateSqlIntervalAndDateTime=
a;d.calculateSqlIntervalAndNumber=F;d.calculateSqlIntervalAndSqlInterval=D;d.calculateSqlIntervalAndString=R;d.calculateSqlIntervalAndTimeOnly=p;d.calculateSqlIntervalAndTimestamp=v;d.calculateStringAndDateOnly=W;d.calculateStringAndDateTime=ba;d.calculateStringAndNumber=T;d.calculateStringAndSqlInterval=h;d.calculateStringAndString=x;d.calculateStringAndTimeOnly=H;d.calculateStringAndTimestamp=la;d.calculateTimeOnlyAndDateOnly=da;d.calculateTimeOnlyAndDateTime=sa;d.calculateTimeOnlyAndNumber=I;d.calculateTimeOnlyAndSqlInterval=
y;d.calculateTimeOnlyAndString=Ka;d.calculateTimeOnlyAndTimeOnly=na;d.calculateTimeOnlyAndTimestamp=fa;d.calculateTimestampAndDateOnly=ca;d.calculateTimestampAndDateTime=ja;d.calculateTimestampAndNumber=G;d.calculateTimestampAndSqlInterval=w;d.calculateTimestampAndString=l;d.calculateTimestampAndTimeOnly=X;d.calculateTimestampAndTimestamp=qa;d.sqlCalculateFunction=function(C,K,N,V){if("||"===C)return r.evaluateFunction("concat",[K,N],V);if(null===K||null===N)return null;if(u.isNumber(K)){if(u.isNumber(N))return M(K,
N,C);if(u.isSqlInterval(N))return t(K,N,C);if(u.isTimeOnly(N))return Q();if(u.isDateOnly(N))return Z();if(u.isTimestampOffset(N))return O();if(u.isDateTime(N))return f();if(u.isString(N))return U(K,N,C)}else if(u.isDateOnly(K)){if(u.isNumber(N))return q(K,N,C);if(u.isSqlInterval(N))return J(K,N,C);if(u.isTimeOnly(N))return P();if(u.isDateOnly(N))return A(K,N,C);if(u.isTimestampOffset(N))return n(K,N,C);if(u.isDateTime(N))return e(K,N,C);if(u.isString(N))return Ha()}else if(u.isTimeOnly(K)){if(u.isNumber(N))return I(K,
N,C);if(u.isSqlInterval(N))return y(K,N,C);if(u.isTimeOnly(N))return na();if(u.isDateOnly(N))return da();if(u.isTimestampOffset(N))return fa();if(u.isDateTime(N))return sa();if(u.isString(N))return Ka()}else if(u.isSqlInterval(K)){if(u.isNumber(N))return F(K,N,C);if(u.isSqlInterval(N))return D(K,N,C);if(u.isTimeOnly(N))return p(K,N,C);if(u.isDateOnly(N))return k(K,N,C);if(u.isTimestampOffset(N))return v(K,N,C);if(u.isDateTime(N))return a(K,N,C);if(u.isString(N))return R()}else if(u.isDateTime(K)){if(u.isNumber(N))return b(K,
N,C);if(u.isSqlInterval(N))return L(K,N,C);if(u.isTimeOnly(N))return Aa();if(u.isDateOnly(N))return ta(K,N,C);if(u.isTimestampOffset(N))return za(K,N,C);if(u.isDateTime(N))return ra(K,N,C);if(u.isString(N))return Ga()}else if(u.isTimestampOffset(K)){if(u.isNumber(N))return G(K,N,C);if(u.isSqlInterval(N))return w(K,N,C);if(u.isTimeOnly(N))return X();if(u.isDateOnly(N))return ca(K,N,C);if(u.isTimestampOffset(N))return qa(K,N,C);if(u.isDateTime(N))return ja(K,N,C);if(u.isString(N))return l()}else if(u.isString(K)){if(u.isNumber(N))return T(K,
N,C);if(u.isSqlInterval(N))return h();if(u.isTimeOnly(N))return H();if(u.isDateOnly(N))return W();if(u.isTimestampOffset(N))return la();if(u.isDateTime(N))return ba();if(u.isString(N))return x(K,N,C)}throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ./DateOnly ./errorSupport ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(d,g,u,z,r,M,a,p){function k(b,q,I){I=t.exec(b);if(null!==I){const [,f,G,O,Q,Z,U,T]=I;b=p.DateTime.fromObject({year:parseInt(f,10),month:parseInt(G,10),day:parseInt(O,10),hour:parseInt(Q,10),minute:parseInt(Z,10),second:parseInt(U,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);return b}I=J.exec(b);if(null!==I){const [,f,G,O,Q,Z,U,T,x,R,h]=I;b=r.SqlTimeStampOffset.fromParts(parseInt(f,
10),parseInt(G,10),parseInt(O,10),parseInt(Q,10),parseInt(Z,10),parseInt(U,10),T?parseInt(T.replace(".",""),10):0,"-"===x,parseInt(R,10),parseInt(h,10));if(!1===b.isValid)throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);return b}I=L.exec(b);if(null!==I){const [,f,G,O,Q,Z,U,T,x]=I;b=r.SqlTimeStampOffset.fromParts(parseInt(f,10),parseInt(G,10),parseInt(O,10),parseInt(Q,10),parseInt(Z,10),0,0,"-"===U,parseInt(T,10),parseInt(x,10));if(!1===b.isValid)throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);
return b}I=w.exec(b);if(null!==I){const [,f,G,O,Q,Z]=I;b=p.DateTime.fromObject({year:parseInt(f,10),month:parseInt(G,10),day:parseInt(O,10),hour:parseInt(Q,10),minute:parseInt(Z,10),second:0},{zone:a.substituteUnknownTimezone(q)});if(!1===b.isValid)throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);return b}I=F.exec(b);if(null!==I){const [,f,G,O]=I;b=p.DateTime.fromObject({year:parseInt(f,10),month:parseInt(G,10),day:parseInt(O,10),hour:0,minute:0,second:0},{zone:a.substituteUnknownTimezone(q)});
if(!1===b.isValid)throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);return b}throw new u.SqlError(u.SqlErrorCodes.InvalidTimeStamp);}const y=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,v=/^(\d{1,2}):(\d{1,2})$/,D=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,t=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,J=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,L=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;d.convertToExecutingTimeZone=function(b,q){if(q instanceof p.Zone)return q===a.UnknownTimeZone.instance?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q});switch(q){case "system":case "local":case null:return p.DateTime.fromJSDate(b);default:return"unknown"===q?.toLowerCase()?p.DateTime.fromMillis(b.getTime(),{zone:a.UnknownTimeZone.instance}):p.DateTime.fromJSDate(b,{zone:q})}};d.isDate=function(b){return b instanceof
Date};d.isDateOnly=function(b){return b instanceof g.DateOnly};d.isDateTime=function(b){return b instanceof p.DateTime};d.isNumber=function(b){return"number"===typeof b};d.isSqlInterval=function(b){return b instanceof z.SqlInterval};d.isString=function(b){return"string"===typeof b||b instanceof String};d.isTimeOnly=function(b){return b instanceof M.TimeOnly};d.isTimestampOffset=function(b){return b instanceof r.SqlTimeStampOffset};d.parseDate=function(b,q){const I=F.exec(b);if(null===I)try{return k(b,
q)}catch{throw new u.SqlError(u.SqlErrorCodes.InvalidDate);}const [,f,G,O]=I;b=g.DateOnly.fromParts(parseInt(f,10),parseInt(G,10),parseInt(O,10));if(null===b)throw new u.SqlError(u.SqlErrorCodes.InvalidDate);return b};d.parseTime=function(b){let q=y.exec(b);if(null!==q){const [,I,f,G]=q;b=M.TimeOnly.fromParts(parseInt(I,10),parseInt(f,10),parseInt(G,10),0);if(null!==b)return b;throw new u.SqlError(u.SqlErrorCodes.InvalidTime);}q=v.exec(b);if(null!==q){const [,I,f]=q;b=M.TimeOnly.fromParts(parseInt(I,
10),parseInt(f,10),0,0);if(null!==b)return b;throw new u.SqlError(u.SqlErrorCodes.InvalidTime);}q=D.exec(b);if(null!==q){const [,I,f,G,O]=q;b=M.TimeOnly.fromParts(parseInt(I,10),parseInt(f,10),parseInt(G,10),parseInt(O,10));if(null!==b)return b}throw new u.SqlError(u.SqlErrorCodes.InvalidTime);};d.parseTimestamp=k;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","./errorSupport"],function(d,g){class u{constructor(){this.op="+";
this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(z){if(null!==z.precision||null!==z.secondary)throw new g.SqlError(g.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(z,r){r.includes(".")?(r=r.split("."),z.second=parseFloat(r[0]),z.millis=parseInt(r[1],10)):z.second=parseFloat(r)}static createFromMilliseconds(z){const r=new u;r.second=z/1E3;return r}static createFromValueAndQualifier(z,r,M){let a=null;const p=new u;p.op="-"===
M?"-":"+";if("interval-period"===r.type){u._fixDefaults(r);M=RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new g.SqlError(g.SqlErrorCodes.YearMonthIntervals);if("second"===r.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(z))u._parseSecondsComponent(p,z);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);else if(M.test(z))p[r.period]=parseFloat(z);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}else{u._fixDefaults(r.start);u._fixDefaults(r.end);if("year"===
r.start.period||"month"===r.start.period||"year"===r.end.period||"month"===r.end.period)throw new g.SqlError(g.SqlErrorCodes.YearMonthIntervals);switch(r.start.period){case "day":switch(r.end.period){case "hour":a=RegExp("^[0-9]{1,} [0-9]{1,}$");if(a.test(z))p[r.start.period]=parseFloat(z.split(" ")[0]),p[r.end.period]=parseFloat(z.split(" ")[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "minute":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(a.test(z))p[r.start.period]=
parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),p.hour=parseFloat(z[0]),p.minute=parseFloat(z[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(z))p[r.start.period]=parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),p.hour=parseFloat(z[0]),p.minute=parseFloat(z[1]),u._parseSecondsComponent(p,z[2]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(r.end.period){case "minute":a=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(a.test(z))p.hour=parseFloat(z.split(":")[0]),p.minute=parseFloat(z.split(":")[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(z))z=z.split(":"),p.hour=parseFloat(z[0]),p.minute=parseFloat(z[1]),u._parseSecondsComponent(p,z[2]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(r.end.period){case "second":a=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(a.test(z))z=z.split(":"),p.minute=parseFloat(z[0]),u._parseSecondsComponent(p,z[1]);else throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}break;default:throw new g.SqlError(g.SqlErrorCodes.IllegalInterval);}}return p}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}d.SqlInterval=u;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../mathUtils ../string ./DateOnly ./errorSupport ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(d,g,u,z,r,M,a,p,k){function y(w){return"string"===typeof w||w instanceof String}function v(w){return a.isDate(w)||a.isDateOnly(w)||a.isDateTime(w)||
a.isTimeOnly(w)||a.isTimestampOffset(w)?!1:!0}function D(w){return a.isDateOnly(w)||a.isTimeOnly(w)?w.toString():a.isTimestampOffset(w)?w.toSQLValue():a.isDateTime(w)?0===w.millisecond?w.toFormat("yyyy-LL-dd HH:mm:ss"):w.toSQL({includeOffset:!1}):a.isDate(w)?D(k.DateTime.fromJSDate(w)):w.toString()}function F(w){if(a.isDate(w))return z.DateOnly.fromDateJS(w);if(a.isDateTime(w))return z.DateOnly.fromParts(w.year,w.month,w.day);if(a.isDateOnly(w))return w;if(a.isTimeOnly(w))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
if(a.isTimestampOffset(w)&&null===z.DateOnly.fromParts(w.year,w.month,w.day))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(y(w)&&(w=z.DateOnly.fromReader(w),null!==w&&w.isValid))return w;throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function t(w,b,q){if(a.isDate(w))return a.convertToExecutingTimeZone(w,b);if(a.isDateTime(w))return w;if(a.isDateOnly(w))return w.toDateTimeLuxon("unknown");if(a.isTimeOnly(w))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(a.isTimestampOffset(w))return w;
if(y(w))return a.parseTimestamp(w,"unknown",q);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function J(w){if(a.isDate(w))return p.TimeOnly.fromDateJS(w);if(a.isDateTime(w))return p.TimeOnly.fromDateTime(w);if(a.isDateOnly(w))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(a.isTimeOnly(w))return w;if(a.isTimestampOffset(w))return p.TimeOnly.fromSqlTimeStampOffset(w);if(y(w))return a.parseTime(w);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}const L={extract:{minParams:2,
maxParams:2,evaluate:([w,b])=>{if(null==b)return null;if(a.isDate(b))switch(w.toUpperCase()){case "SECOND":return b.getSeconds();case "MINUTE":return b.getMinutes();case "HOUR":return b.getHours();case "DAY":return b.getDate();case "MONTH":return b.getMonth()+1;case "YEAR":return b.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(a.isDateTime(b))switch(w.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;
case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isDateOnly(b))switch(w.toUpperCase()){case "DAY":return b.day;case "MONTH":return b.month;case "YEAR":return b.year}else if(a.isTimeOnly(b))switch(w.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour}else if(a.isTimestampOffset(b))switch(w.toUpperCase()){case "SECOND":return b.second;case "MINUTE":return b.minute;case "HOUR":return b.hour;case "DAY":return b.day;case "MONTH":return b.month;
case "YEAR":return b.year;case "TIMEZONE_HOUR":return b.timezoneOffsetHour;case "TIMEZONE_MINUTE":return b.timezoneOffsetMinutes}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:w=>{if(2===w.length){const [b,q]=w;return null==b||null==q?null:b.toString().substring(q-1)}if(3===w.length){const [b,q,I]=w;return null==b||null==q||null==I?null:0>=I?"":b.toString().substring(q-1,q+I-1)}}},position:{minParams:2,maxParams:2,
evaluate:([w,b])=>null==w||null==b?null:b.indexOf(w)+1},trim:{minParams:2,maxParams:3,evaluate:w=>{var b=3===w.length,q=b?w[1]:" ";b=b?w[2]:w[1];if(null==q||null==b)return null;q=`(${u.escapeRegExpString(q)})`;switch(w[0]){case "BOTH":return b.replaceAll(new RegExp(`^${q}*|${q}*$`,"g"),"");case "LEADING":return b.replaceAll(new RegExp(`^${q}*`,"g"),"");case "TRAILING":return b.replaceAll(new RegExp(`${q}*$`,"g"),"")}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.abs(w[0])},ceiling:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.ceil(w[0])},floor:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.floor(w[0])},log:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.log(w[0])},log10:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.log(w[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.sin(w[0])},cos:{minParams:1,maxParams:1,evaluate:w=>
null==w[0]?null:Math.cos(w[0])},tan:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.tan(w[0])},asin:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.asin(w[0])},acos:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.acos(w[0])},atan:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.atan(w[0])},sign:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:0<w[0]?1:0>w[0]?-1:0},power:{minParams:2,maxParams:2,evaluate:w=>null==w[0]||null==w[1]?null:w[0]**w[1]},mod:{minParams:2,
maxParams:2,evaluate:w=>null==w[0]||null==w[1]?null:w[0]%w[1]},round:{minParams:1,maxParams:2,evaluate:w=>{const b=w[0];w=2===w.length?10**w[1]:1;return null==b?null:Math.round(b*w)/w}},truncate:{minParams:1,maxParams:2,evaluate:w=>null==w[0]?null:1===w.length||0===w[1]?Math.trunc(w[0]):g.decimalAdjust("trunc",w[0],-Number(w[1]))},char_length:{minParams:1,maxParams:1,evaluate:w=>y(w[0])?w[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:w=>{let b="";for(let q=0;q<w.length;q++){if(null==
w[q])return null;b+=w[q].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:w[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:w=>{for(const b of w)if(null!==b)return b;return null}},cosh:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.cosh(w[0])},sinh:{minParams:1,maxParams:1,evaluate:w=>null==w[0]?null:Math.sinh(w[0])},tanh:{minParams:1,
maxParams:1,evaluate:w=>null==w[0]?null:Math.tanh(w[0])},nullif:{minParams:2,maxParams:2,evaluate:(w,b)=>M.sqlCompare(w[0],w[1],"\x3d")?null:w[0]},cast:{minParams:2,maxParams:2,evaluate:(w,b)=>{const q=w[0];w=w[1];if(null===q)return null;switch(w.type){case "integer":if(!v(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);b=parseInt(q,10);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "smallint":if(!v(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
b=parseInt(q,10);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(32767<b||-32767>b)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "float":case "real":if(!v(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);b=parseFloat(q);if(isNaN(b))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return b;case "time":return J(q);case "date":return F(q);case "timestamp":return t(q,b,!0===w.withtimezone);case "varchar":b=D(q);if(b.length>w.size)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
return b;default:throw new r.SqlError(r.SqlErrorCodes.InvalidDataType);}}}};d.evaluateFunction=function(w,b,q){const I=L[w.toLowerCase()];if(null==I)throw new r.SqlError(r.SqlErrorCodes.FunctionNotRecognized);if(b.length<I.minParams||b.length>I.maxParams)throw new r.SqlError(r.SqlErrorCodes.InvalidParameterCount,{name:w.toUpperCase()});return I.evaluate(b,q)};d.isStandardized=function(w,b){w=L[w.toLowerCase()];return null!=w&&b>=w.minParams&&b<=w.maxParams};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ./errorSupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),function(d,g,u,z,r,M){function a(L){return u.isDateTime(L)||u.isTimestampOffset(L)?!0:!1}function p(L){return u.isDateTime(L)||u.isDateOnly(L)||u.isTimestampOffset(L)||u.isTimeOnly(L)?!0:!1}function k(L){if(u.isDateTime(L))return L.toMillis();if(u.isDateOnly(L))return L.toNumber();if(u.isTimestampOffset(L))return L.toMilliseconds();
throw new g.SqlError(g.SqlErrorCodes.InvalidDataType);}function y(L,w,b){switch(b){case "\x3c\x3e":return L!==w;case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}}function v(L,w,b){const q=parseFloat(w);if(!isNaN(q))return y(L,q,b);L=L.toString();switch(b){case "\x3c\x3e":return L!==w;case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}}function D(L,
w,b){const q=parseFloat(L);if(!isNaN(q))return y(q,w,b);w=w.toString();switch(b){case "\x3c\x3e":return L!==w;case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}}function F(L,w,b){switch(b){case "\x3c\x3e":return L!==w;case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}}function t(L,w,b){L instanceof z.SqlTimeStampOffset&&(L=L.toDateTime());w instanceof
z.SqlTimeStampOffset&&(w=w.toDateTime());L=J(L);w=J(w);switch(b){case "\x3c\x3e":return L!==w;case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}}function J(L){return 321408E5*L.year+26784E5*L.month+864E5*L.day+36E5*L.hour+6E4*L.minute+1E3*L.second+L.millisecond}d.dateValueInMilliseconds=k;d.isDateOrTimeValue=p;d.isDateTimeComparableValue=a;d.sqlCompare=function(L,w,b,q){if(null==L||null==w)return null;if(u.isNumber(L)){if(u.isNumber(w))return y(L,
w,b);if(u.isString(w))return v(L,w,b);if(p(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isDateOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(u.isString(L)){if(u.isNumber(w))return D(L,w,b);if(u.isString(w))return F(L,w,b);if(u.isDateTime(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isDateOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isTimeOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isTimestampOffset(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}else if(u.isDateTime(L)){if(a(w)){if(L instanceof M.DateTime&&r.isUnknownTimeZone(L.zone)){if(w instanceof M.DateTime&&!1===r.isUnknownTimeZone(w.zone)||w instanceof z.SqlTimeStampOffset)return t(L,w,b)}else if(w instanceof M.DateTime&&r.isUnknownTimeZone(w.zone)&&(L instanceof M.DateTime&&!1===r.isUnknownTimeZone(L.zone)||L instanceof z.SqlTimeStampOffset))return t(L,w,b);return y(k(L),k(w),b)}if(u.isString(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isDateOnly(w))return w=w.toDateTimeLuxon(L.zone),
L=L.startOf("day"),y(L.toMillis(),w.toMillis(),b);if(u.isTimeOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isNumber(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(u.isDateOnly(L)){if(u.isTimestampOffset(w))return L=L.toDateTimeLuxon(w.toDateTime().zone),w=w.startOfDay(),y(L.toMillis(),w.toMilliseconds(),b);if(u.isDateTime(w))return L=L.toDateTimeLuxon(w.zone),w=w.startOf("day"),y(L.toMillis(),w.toMillis(),b);if(u.isString(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
if(u.isDateOnly(w))return y(L.toNumber(),w.toNumber(),b);if(u.isTimeOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isNumber(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}else if(u.isTimeOnly(L)){if(u.isTimeOnly(w))return y(L.toNumber(),w.toNumber(),b);if(u.isString(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isNumber(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isDateOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(a(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);
}else if(u.isTimestampOffset(L)){if(a(w))return w instanceof M.DateTime&&r.isUnknownTimeZone(w.zone)?t(L,w,b):y(k(L),k(w),b);if(u.isString(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isDateOnly(w))return w=w.toDateTimeLuxon(L.toDateTime().zone),L=L.startOfDay(),y(L.toMilliseconds(),w.toMillis(),b);if(u.isTimeOnly(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);if(u.isNumber(w))throw new g.SqlError(g.SqlErrorCodes.InvalidOperator);}switch(b){case "\x3c\x3e":return L!==w;
case "\x3d":return L===w;case "\x3e":return L>w;case "\x3c":return L<w;case "\x3e\x3d":return L>=w;case "\x3c\x3d":return L<=w}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports"],function(d){function g(a,p,k,y){a=Error.call(this,a);Object.setPrototypeOf&&Object.setPrototypeOf(a,g.prototype);a.expected=p;a.found=k;a.location=y;a.name="SyntaxError";return a}function u(a,p,k){k=k||" ";if(a.length>p)return a;p-=a.length;k+=k.repeat(p);
return a+k.slice(0,p)}function z(a,p){function k(){return t(ma,m)}function y(B,E){E=void 0!==E?E:t(ma,m);throw new g(B,null,null,E);}function v(B,E){return{type:"literal",text:B,ignoreCase:E}}function D(B,E,S){return{type:"class",parts:B,inverted:E,ignoreCase:S}}function F(B){var E=Eb[B];if(!E){if(B>=Eb.length)var S=Eb.length-1;else for(S=B;!Eb[--S];);E=Eb[S];for(E={line:E.line,column:E.column};S<B;)10===a.charCodeAt(S)?(E.line++,E.column=1):E.column++,S++;Eb[B]=E}return E}function t(B,E,S){S=F(B);
var Y=F(E);return{source:Hd,start:{offset:B,line:S.line,column:S.column},end:{offset:E,line:Y.line,column:Y.column}}}function J(B){m<hb||(m>hb&&(hb=m,jc=[]),jc.push(B))}function L(){var B=m;ka();var E=b();E!==c?(ka(),ma=B,B=E):(m=B,B=c);return B}function w(){var B;var E=m;if(Oa()!==c){ka();var S=[];for(B=b();B!==c;){S.push(B);var Y=B=m;var wa=ka();var ya=Ya();ya!==c?(Y=ka(),Y=wa=[wa,ya,Y]):(m=Y,Y=c);Y!==c?(Y=b(),Y===c?(m=B,B=c):B=Y):B=Y}B=ka();Y=Pa();Y!==c?(ma=E,E=Ma(k(),...S)):(m=E,E=c)}else m=E,
E=c;return E}function b(){var B=m;var E=q();if(E!==c){var S=[];var Y=m;ka();var wa=V();if(wa!==c){ka();var ya=q();ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)}else m=Y,Y=c;for(;Y!==c;)S.push(Y),Y=m,ka(),wa=V(),wa!==c?(ka(),ya=q(),ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)):(m=Y,Y=c);ma=B;B=Ib(E,S)}else m=B,B=c;return B}function q(){var B=m;var E=I();if(E!==c){var S=[];var Y=m;ka();var wa=N();if(wa!==c){ka();var ya=I();ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)}else m=
Y,Y=c;for(;Y!==c;)S.push(Y),Y=m,ka(),wa=N(),wa!==c?(ka(),ya=I(),ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)):(m=Y,Y=c);ma=B;B=Ib(E,S)}else m=B,B=c;return B}function I(){var B=m;var E=K();if(E===c){E=m;if(33===a.charCodeAt(m)){var S=Id;m++}else S=c,0===ia&&J(Jd);if(S!==c){var Y=m;ia++;if(61===a.charCodeAt(m)){var wa=Kd;m++}else wa=c,0===ia&&J(Ld);ia--;wa===c?Y=void 0:(m=Y,Y=c);Y!==c?E=S=[S,Y]:(m=E,E=c)}else m=E,E=c}E!==c?(S=ka(),Y=I(),Y!==c?(ma=B,B={type:"unary-expression",location:k(),
operator:"NOT",expr:Y}):(m=B,B=c)):(m=B,B=c);if(B===c){E=m;B=Q();if(B!==c){S=m;ka();Y=m;wa=[];var ya=m;ka();var Ja=f();if(Ja!==c){ka();var Ua=Q();Ua!==c?(ma=ya,ya={op:Ja,expr:Ua,location:k()}):(m=ya,ya=c)}else m=ya,ya=c;if(ya!==c)for(;ya!==c;)wa.push(ya),ya=m,ka(),Ja=f(),Ja!==c?(ka(),Ua=Q(),Ua!==c?(ma=ya,ya={op:Ja,expr:Ua,location:k()}):(m=ya,ya=c)):(m=ya,ya=c);else wa=c;wa!==c&&(ma=Y,wa={type:"arithmetic",tail:wa});Y=wa;if(Y===c&&(Y=m,wa=O(),wa!==c?(ka(),ya=w(),ya!==c?(ma=Y,Y={op:wa,right:ya}):(m=
Y,Y=c)):(m=Y,Y=c),Y===c&&(Y=m,wa=O(),wa!==c?(ka(),ya=X(),ya!==c?(ma=Y,Y={op:wa,right:ya}):(m=Y,Y=c)):(m=Y,Y=c)),Y===c)){Y=m;wa=K();if(wa!==c)if(ka(),ya=aa(),ya!==c){var Jb=ka();Ja=m;Ua=Q();if(Ua!==c){ka();var db=N();db!==c?(ka(),wa=Q(),wa!==c?(ma=Ja,Ja=Ua,Ja=Ma(k(),Ja,wa)):(m=Ja,Ja=c)):(m=Ja,Ja=c)}else m=Ja,Ja=c;Ja!==c?(ma=Y,Y={op:"NOT"+ya,right:Ja}):(m=Y,Y=c)}else m=Y,Y=c;else m=Y,Y=c;Y===c&&(Y=m,wa=aa(),wa!==c?(ka(),ya=m,Jb=Q(),Jb!==c?(Ja=ka(),Ua=N(),Ua!==c?(ka(),db=Q(),db!==c?(ma=ya,ya=Jb,Ja=db,
ya=Ma(k(),ya,Ja)):(m=ya,ya=c)):(m=ya,ya=c)):(m=ya,ya=c),ya!==c?(ma=Y,Y={op:wa,right:ya}):(m=Y,Y=c)):(m=Y,Y=c));Y===c&&(Y=m,wa=la(),wa!==c?(ka(),ya=K(),ya!==c?(ka(),ya=Q(),ya!==c?(ma=Y,Y={op:wa+"NOT",right:ya}):(m=Y,Y=c)):(m=Y,Y=c)):(m=Y,Y=c),Y===c&&(Y=m,wa=la(),wa!==c?(ka(),ya=Q(),ya!==c?(ma=Y,Y={op:wa,right:ya}):(m=Y,Y=c)):(m=Y,Y=c)),Y===c&&(Y=m,wa=G(),wa!==c?(ka(),ya=ra(),ya!==c?(ka(),Ja=m,Ua=a.substr(m,6),Ua.toLowerCase()===Md?m+=6:(Ua=c,0===ia&&J(Nd)),Ua!==c?(Ua=m,ia++,db=e(),ia--,db===c?Ua=void 0:
(m=Ua,Ua=c),Ua!==c?(ma=Ja,Ja="ESCAPE"):(m=Ja,Ja=c)):(m=Ja,Ja=c),Ja!==c?(ka(),Ja=ta(),Ja!==c?(ma=Y,Y={op:wa,right:ya,escape:Ja.value}):(m=Y,Y=c)):(m=Y,Y=c)):(m=Y,Y=c)):(m=Y,Y=c),Y===c&&(Y=m,wa=G(),wa!==c?(ka(),ya=ra(),ya!==c?(ma=Y,Y={op:wa,right:ya,escape:""}):(m=Y,Y=c)):(m=Y,Y=c))))}Y!==c?S=Y:(m=S,S=c);S===c&&(S=null);ma=E;E=S;""==E||void 0==E||null==E?E=B:(S=null,E=S="arithmetic"==E.type?Ib(B,E.tail):Kb(E.op,B,E.right,E.escape,k()))}else m=E,E=c;B=E}return B}function f(){if(a.substr(m,2)===fd){var B=
fd;m+=2}else B=c,0===ia&&J(Od);B===c&&(62===a.charCodeAt(m)?(B=Pd,m++):(B=c,0===ia&&J(Qd)),B===c&&(a.substr(m,2)===gd?(B=gd,m+=2):(B=c,0===ia&&J(Rd)),B===c&&(a.substr(m,2)===hd?(B=hd,m+=2):(B=c,0===ia&&J(Sd)),B===c&&(B=a.charAt(m),Td.test(B)?m++:(B=c,0===ia&&J(Ud)),B===c&&(a.substr(m,2)===id?(B=id,m+=2):(B=c,0===ia&&J(Vd)))))));return B}function G(){var B;var E=B=m;var S=K();if(S!==c){var Y=ka();var wa=C();wa!==c?E=S=[S,Y,wa]:(m=E,E=c)}else m=E,E=c;E!==c&&(ma=B,E=E[0]+" "+E[2]);B=E;B===c&&(B=C());
return B}function O(){var B;var E=B=m;var S=K();if(S!==c){var Y=ka();var wa=ba();wa!==c?E=S=[S,Y,wa]:(m=E,E=c)}else m=E,E=c;E!==c&&(ma=B,E=E[0]+" "+E[2]);B=E;B===c&&(B=ba());return B}function Q(){var B=m;var E=U();if(E!==c){var S=[];var Y=m;ka();var wa=Z();if(wa!==c){ka();var ya=U();ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)}else m=Y,Y=c;for(;Y!==c;)S.push(Y),Y=m,ka(),wa=Z(),wa!==c?(ka(),ya=U(),ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)):(m=Y,Y=c);ma=B;B=Ib(E,S)}else m=B,B=
c;return B}function Z(){var B=a.charAt(m);kc.test(B)?m++:(B=c,0===ia&&J(lc));B===c&&(a.substr(m,2)===jd?(B=jd,m+=2):(B=c,0===ia&&J(Wd)));return B}function U(){var B=m;var E=x();if(E!==c){var S=[];var Y=m;ka();var wa=T();if(wa!==c){ka();var ya=x();ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)}else m=Y,Y=c;for(;Y!==c;)S.push(Y),Y=m,ka(),wa=T(),wa!==c?(ka(),ya=x(),ya!==c?(ma=Y,Y={op:wa,expr:ya,location:k()}):(m=Y,Y=c)):(m=Y,Y=c);ma=B;B=Ib(E,S)}else m=B,B=c;return B}function T(){var B=a.charAt(m);
Xd.test(B)?m++:(B=c,0===ia&&J(Yd));return B}function x(){var B=ta();if(B===c){var E=m;var S=m;var Y=Ka();if(Y!==c){var wa=Ga();if(wa!==c){var ya=l();ya!==c?(ma=S,S=parseFloat(Y+wa+ya)):(m=S,S=c)}else m=S,S=c}else m=S,S=c;S===c&&(S=m,Y=Ka(),Y!==c?(wa=Ga(),wa!==c?(ma=S,S=parseFloat(Y+wa)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,Y=Ka(),Y!==c?(wa=l(),wa!==c?(ma=S,S=parseFloat(Y+wa)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,Y=Ka(),Y!==c&&(ma=S,Y=parseFloat(Y)),S=Y)));var Ja=S;if(Ja!==c){var Ua=m;ia++;var Jb=h();ia--;
Jb===c?Ua=void 0:(m=Ua,Ua=c);Ua!==c?(ma=E,E={type:"number",location:k(),value:Ja}):(m=E,E=c)}else m=E,E=c;B=E;if(B===c){var db=m;var Fb=m;var Lb=a.substr(m,4);Lb.toLowerCase()===Zd?m+=4:(Lb=c,0===ia&&J($d));if(Lb!==c){var Mb=m;ia++;var ae=e();ia--;ae===c?Mb=void 0:(m=Mb,Mb=c);Mb!==c?Fb=Lb=[Lb,Mb]:(m=Fb,Fb=c)}else m=Fb,Fb=c;var mb=Fb;mb!==c&&(ma=db,mb={type:"boolean",location:k(),value:!0});db=mb;if(db===c){db=m;var Gb=m;var Nb=a.substr(m,5);Nb.toLowerCase()===be?m+=5:(Nb=c,0===ia&&J(ce));if(Nb!==
c){var Ob=m;ia++;var de=e();ia--;de===c?Ob=void 0:(m=Ob,Ob=c);Ob!==c?Gb=Nb=[Nb,Ob]:(m=Gb,Gb=c)}else m=Gb,Gb=c;mb=Gb;mb!==c&&(ma=db,mb={type:"boolean",location:k(),value:!1});db=mb}B=db;if(B===c){var ee=m;var Hb=m;var Pb=a.substr(m,4);Pb.toLowerCase()===fe?m+=4:(Pb=c,0===ia&&J(ge));if(Pb!==c){var Qb=m;ia++;var he=e();ia--;he===c?Qb=void 0:(m=Qb,Qb=c);Qb!==c?Hb=Pb=[Pb,Qb]:(m=Hb,Hb=c)}else m=Hb,Hb=c;var Ec=Hb;Ec!==c&&(ma=ee,Ec={type:"null",location:k(),value:null});B=Ec;if(B===c){var nb=m;if(pa()!==
c){ka();var mc=ra();mc!==c?(ma=nb,"string"===mc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(mc.value)&&y("Date literal is invalid"),nb={type:"date",location:k(),value:mc.value}):(m=nb,nb=
c)}else m=nb,nb=c;B=nb;if(B===c){var ob=m;if(oa()!==c){ka();var nc=ra();nc!==c?(ma=ob,"string"===nc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(nc.value)&&y("Timestamp literal is invalid"),
ob={type:"timestamp",location:k(),value:nc.value}):(m=ob,ob=c)}else m=ob,ob=c;B=ob;if(B===c){var Za=m;var Fc=ua();if(Fc!==c){ka();var pb=a.charAt(m);kc.test(pb)?m++:(pb=c,0===ia&&J(lc));if(pb!==c){ka();var Rb=ra();if(Rb!==c){ka();var kd=sa();if(kd!==c){ma=Za;var ie=pb,je=Rb;Za={type:"interval",location:k(),value:je,qualifier:kd,op:ie}}else m=Za,Za=c}else m=Za,Za=c}else m=Za,Za=c}else m=Za,Za=c;if(Za===c)if(Za=m,Fc=ua(),Fc!==c)if(ka(),pb=ra(),pb!==c)if(ka(),Rb=sa(),Rb!==c){ma=Za;var ke=pb,le=Rb;Za=
{type:"interval",location:k(),value:ke,qualifier:le,op:""}}else m=Za,Za=c;else m=Za,Za=c;else m=Za,Za=c;B=Za;if(B===c){var qb=m;if(xa()!==c){ka();var oc=ra();oc!==c?(ma=qb,"string"===oc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(oc.value)&&y("Time literal is invalid"),qb={type:"time",location:k(),value:oc.value}):(m=qb,qb=c)}else m=qb,qb=c;B=qb}}}}}}}var Na=B;if(Na===c){var rb=m;if(ha()!==c){ka();var Qa=m;var Gc=Oa();if(Gc!==c){ka();
var Sb=qa();if(Sb!==c){ka();var Hc=ea();if(Hc!==c){ka();var Tb=b();if(Tb!==c){ka();var Ic=Pa();if(Ic!==c){ma=Qa;var me=Sb,ne=Tb;Qa=Ma(k(),me,ne)}else m=Qa,Qa=c}else m=Qa,Qa=c}else m=Qa,Qa=c}else m=Qa,Qa=c}else m=Qa,Qa=c;if(Qa===c)if(Qa=m,Gc=Oa(),Gc!==c)if(ka(),Sb=qa(),Sb!==c)if(ka(),Hc=Ya(),Hc!==c)if(ka(),Tb=b(),Tb!==c)if(ka(),Ic=Pa(),Ic!==c){ma=Qa;var oe=Sb,pe=Tb;Qa=Ma(k(),oe,pe)}else m=Qa,Qa=c;else m=Qa,Qa=c;else m=Qa,Qa=c;else m=Qa,Qa=c;else m=Qa,Qa=c;if(Qa!==c){ma=rb;var qe=Qa;rb={type:"function",
location:k(),name:"extract",args:qe}}else m=rb,rb=c}else m=rb,rb=c;Na=rb;if(Na===c){var sb=m;var tb=m;var Jc=a.substr(m,9);Jc.toLowerCase()===re?m+=9:(Jc=c,0===ia&&J(se));if(Jc!==c){var pc=m;ia++;var te=e();ia--;te===c?pc=void 0:(m=pc,pc=c);pc!==c?(ma=tb,tb="SUBSTRING"):(m=tb,tb=c)}else m=tb,tb=c;if(tb!==c){ka();var La=m;var Kc=Oa();if(Kc!==c){ka();var Ub=b();if(Ub!==c){ka();var Lc=ea();if(Lc!==c){ka();var Vb=b();if(Vb!==c){ka();var jb=m;var ub=m;var Mc=a.substr(m,3);Mc.toLowerCase()===ue?m+=3:(Mc=
c,0===ia&&J(ve));if(Mc!==c){var qc=m;ia++;var we=e();ia--;we===c?qc=void 0:(m=qc,qc=c);qc!==c?(ma=ub,ub="FOR"):(m=ub,ub=c)}else m=ub,ub=c;var rc=ub;if(rc!==c){var Nc=ka();var sc=b();sc!==c?(ka(),jb=sc):(m=jb,jb=c)}else m=jb,jb=c;jb===c&&(jb=null);rc=Pa();if(rc!==c){ma=La;var xe=Ub,ye=Vb,ld=jb;La=Ma(k(),xe,ye,...(ld?[ld]:[]))}else m=La,La=c}else m=La,La=c}else m=La,La=c}else m=La,La=c}else m=La,La=c;if(La===c)if(La=m,Kc=Oa(),Kc!==c)if(ka(),Ub=b(),Ub!==c)if(ka(),Lc=Ya(),Lc!==c)if(ka(),Vb=b(),Vb!==c)if(ka(),
jb=Ya(),jb!==c)if(rc=ka(),Nc=b(),Nc!==c)if(sc=Pa(),sc!==c){ma=La;var ze=Ub,Ae=Vb,Be=Nc;La=Ma(k(),ze,Ae,Be)}else m=La,La=c;else m=La,La=c;else m=La,La=c;else m=La,La=c;else m=La,La=c;else m=La,La=c;else m=La,La=c;if(La!==c){ma=sb;var Ce=La;sb={type:"function",location:k(),name:"substring",args:Ce}}else m=sb,sb=c}else m=sb,sb=c;Na=sb;if(Na===c){var vb=m;var wb=m;var Oc=a.substr(m,4);Oc.toLowerCase()===De?m+=4:(Oc=c,0===ia&&J(Ee));if(Oc!==c){var tc=m;ia++;var Fe=e();ia--;Fe===c?tc=void 0:(m=tc,tc=c);
tc!==c?(ma=wb,wb="TRIM"):(m=wb,wb=c)}else m=wb,wb=c;if(wb!==c){ka();var Va=m;var Pc=Oa();if(Pc!==c){ka();var Qc=ja();ka();var Wb=b();if(Wb!==c){ka();var Rc=ea();if(Rc!==c){ka();var md=b();if(md!==c){ka();var Ge=Pa();if(Ge!==c){ma=Va;var He=Qc,Ie=Wb;Va=Ma(k(),He,Ie,md)}else m=Va,Va=c}else m=Va,Va=c}else m=Va,Va=c}else m=Va,Va=c}else m=Va,Va=c;if(Va===c)if(Va=m,Pc=Oa(),Pc!==c)if(ka(),Qc=ja(),ka(),Wb=b(),Wb!==c)if(ka(),Rc=Pa(),Rc!==c){ma=Va;var Je=Qc,Ke=Wb;Va=Ma(k(),Je,Ke)}else m=Va,Va=c;else m=Va,Va=
c;else m=Va,Va=c;if(Va!==c){ma=vb;var Le=Va;vb={type:"function",location:k(),name:"trim",args:Le}}else m=vb,vb=c}else m=vb,vb=c;Na=vb;if(Na===c){var xb=m;var yb=m;var Sc=a.substr(m,8);Sc.toLowerCase()===Me?m+=8:(Sc=c,0===ia&&J(Ne));if(Sc!==c){var uc=m;ia++;var Oe=e();ia--;Oe===c?uc=void 0:(m=uc,uc=c);uc!==c?(ma=yb,yb="POSITION"):(m=yb,yb=c)}else m=yb,yb=c;if(yb!==c){ka();var Ra=m;var Tc=Oa();if(Tc!==c){ka();var Xb=b();if(Xb!==c){ka();var Uc=ba();if(Uc!==c){ka();var Yb=b();if(Yb!==c){ka();var Vc=Pa();
if(Vc!==c){ma=Ra;var Pe=Xb,Qe=Yb;Ra=Ma(k(),Pe,Qe)}else m=Ra,Ra=c}else m=Ra,Ra=c}else m=Ra,Ra=c}else m=Ra,Ra=c}else m=Ra,Ra=c;if(Ra===c)if(Ra=m,Tc=Oa(),Tc!==c)if(ka(),Xb=b(),Xb!==c)if(ka(),Uc=Ya(),Uc!==c)if(ka(),Yb=b(),Yb!==c)if(ka(),Vc=Pa(),Vc!==c){ma=Ra;var Re=Xb,Se=Yb;Ra=Ma(k(),Re,Se)}else m=Ra,Ra=c;else m=Ra,Ra=c;else m=Ra,Ra=c;else m=Ra,Ra=c;else m=Ra,Ra=c;if(Ra!==c){ma=xb;var Te=Ra;xb={type:"function",location:k(),name:"position",args:Te}}else m=xb,xb=c}else m=xb,xb=c;Na=xb;if(Na===c){var zb=
m;var Ab=m;var Wc=a.substr(m,4);Wc.toLowerCase()===Ue?m+=4:(Wc=c,0===ia&&J(Ve));if(Wc!==c){var vc=m;ia++;var We=e();ia--;We===c?vc=void 0:(m=vc,vc=c);vc!==c?(ma=Ab,Ab="CAST"):(m=Ab,Ab=c)}else m=Ab,Ab=c;if(Ab!==c){ka();var Sa=m;var Xc=Oa();if(Xc!==c){ka();var Zb=b();if(Zb!==c){ka();var Bb=m;var Yc=a.substr(m,2);Yc.toLowerCase()===Xe?m+=2:(Yc=c,0===ia&&J(Ye));if(Yc!==c){var wc=m;ia++;var Ze=e();ia--;Ze===c?wc=void 0:(m=wc,wc=c);wc!==c?(ma=Bb,Bb="AS"):(m=Bb,Bb=c)}else m=Bb,Bb=c;var Zc=Bb;if(Zc!==c){ka();
var $b=ca();if($b!==c){ka();var $c=Pa();if($c!==c){ma=Sa;var $e=Zb,af=$b;Sa=Ma(k(),$e,af)}else m=Sa,Sa=c}else m=Sa,Sa=c}else m=Sa,Sa=c}else m=Sa,Sa=c}else m=Sa,Sa=c;if(Sa===c)if(Sa=m,Xc=Oa(),Xc!==c)if(ka(),Zb=b(),Zb!==c)if(ka(),Zc=Ya(),Zc!==c)if(ka(),$b=ca(),$b!==c)if(ka(),$c=Pa(),$c!==c){ma=Sa;var bf=Zb,cf=$b;Sa=Ma(k(),bf,cf)}else m=Sa,Sa=c;else m=Sa,Sa=c;else m=Sa,Sa=c;else m=Sa,Sa=c;else m=Sa,Sa=c;if(Sa!==c){ma=zb;var df=Sa;zb={type:"function",location:k(),name:"cast",args:df}}else m=zb,zb=c}else m=
zb,zb=c;Na=zb;if(Na===c){var kb;var xc=kb=m;ia++;var yc=ha();ia--;yc===c?xc=void 0:(m=xc,xc=c);if(xc!==c){var eb=m;var ac=R();ac!==c&&(ma=eb);eb=ac;if(eb===c)if(eb=m,96===a.charCodeAt(m)?(ac=nd,m++):(ac=c,0===ia&&J(od)),ac!==c){var zc=[];var ib=a.charAt(m);pd.test(ib)?m++:(ib=c,0===ia&&J(qd));if(ib!==c)for(;ib!==c;)zc.push(ib),ib=a.charAt(m),pd.test(ib)?m++:(ib=c,0===ia&&J(qd));else zc=c;zc!==c?(96===a.charCodeAt(m)?(ib=nd,m++):(ib=c,0===ia&&J(od)),ib!==c?(ma=eb,eb=zc.join("")):(m=eb,eb=c)):(m=eb,
eb=c)}else m=eb,eb=c;yc=eb;if(yc!==c){ka();var rd=w();if(rd!==c){ma=kb;var ef=yc;kb={type:"function",location:k(),name:ef,args:rd}}else m=kb,kb=c}else m=kb,kb=c}else m=kb,kb=c;Na=kb;if(Na===c){var $a=m;var ad=Ia();if(ad!==c){ka();var bc=b();if(bc!==c){ka();var cc=[];var Wa=m;var fb=Aa();if(fb!==c){var dc=ka();Wa=fb}else m=Wa,Wa=c;for(;Wa!==c;)cc.push(Wa),Wa=m,fb=Aa(),fb!==c?(dc=ka(),Wa=fb):(m=Wa,Wa=c);Wa=Ta();if(Wa!==c){ma=$a;var ff=bc,gf=cc;$a={type:"case-expression",location:k(),format:"simple",
operand:ff,clauses:gf,else:null,elseLocation:null}}else m=$a,$a=c}else m=$a,$a=c}else m=$a,$a=c;if($a===c)if($a=m,ad=Ia(),ad!==c)if(ka(),bc=b(),bc!==c){ka();cc=[];Wa=m;fb=Aa();fb!==c?(dc=ka(),Wa=fb):(m=Wa,Wa=c);for(;Wa!==c;)cc.push(Wa),Wa=m,fb=Aa(),fb!==c?(dc=ka(),Wa=fb):(m=Wa,Wa=c);Wa=Ha();if(Wa!==c)if(fb=ka(),dc=Ta(),dc!==c){ma=$a;var hf=bc,jf=cc,sd=Wa;$a={type:"case-expression",location:k(),format:"simple",operand:hf,clauses:jf,else:sd.value,elseLocation:sd.location}}else m=$a,$a=c;else m=$a,$a=
c}else m=$a,$a=c;else m=$a,$a=c;var bd=$a;if(bd===c){var ab=m;var cd=Ia();if(cd!==c){ka();var ec=[];var Xa=m;var gb=za();if(gb!==c){var fc=ka();Xa=gb}else m=Xa,Xa=c;for(;Xa!==c;)ec.push(Xa),Xa=m,gb=za(),gb!==c?(fc=ka(),Xa=gb):(m=Xa,Xa=c);Xa=Ta();if(Xa!==c){ma=ab;var kf=ec;ab={type:"case-expression",location:k(),format:"searched",clauses:kf,else:null,elseLocation:null}}else m=ab,ab=c}else m=ab,ab=c;if(ab===c)if(ab=m,cd=Ia(),cd!==c){ka();ec=[];Xa=m;gb=za();gb!==c?(fc=ka(),Xa=gb):(m=Xa,Xa=c);for(;Xa!==
c;)ec.push(Xa),Xa=m,gb=za(),gb!==c?(fc=ka(),Xa=gb):(m=Xa,Xa=c);Xa=Ha();if(Xa!==c)if(gb=ka(),fc=Ta(),fc!==c){ma=ab;var lf=ec,td=Xa;ab={type:"case-expression",location:k(),format:"searched",clauses:lf,else:td.value,elseLocation:td.location}}else m=ab,ab=c;else m=ab,ab=c}else m=ab,ab=c;bd=ab}Na=bd;if(Na===c){var Cb=m;var mf=m;var Ac;var gc=m;var ud=h();if(ud!==c){var vd=[];for(Ac=n();Ac!==c;)vd.push(Ac),Ac=n();ma=gc;gc=ud+vd.join("")}else m=gc,gc=c;var wd=gc;wd!==c&&(ma=mf);var lb=wd;if(lb!==c){ma=Cb;
var hc=lb;lb=/^CURRENT_DATE$/i.test(hc)?{type:"current-time",location:k(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(hc)?{type:"current-time",location:k(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(hc)?{type:"current-time",location:k(),mode:"time"}:/^CURRENT_USER$/i.test(hc)?{type:"current-user",location:k()}:{type:"column-reference",location:k(),table:"",column:hc}}Cb=lb;if(Cb===c){Cb=m;var Db=m;if(P()!==c){var Bc;var nf=m;var dd=[];for(Bc=A();Bc!==c;)dd.push(Bc),Bc=A();ma=nf;var of=dd=dd.join("");var pf=
P();pf!==c?(ma=Db,Db=of):(m=Db,Db=c)}else m=Db,Db=c;lb=Db;if(lb!==c){ma=Cb;var qf=lb;lb={type:"column-reference",location:k(),table:"",column:qf,delimited:!0}}Cb=lb}Na=Cb;if(Na===c&&(Na=X(),Na===c)){Na=m;var rf=Oa();if(rf!==c){ka();var ed=b();if(ed!==c){ka();var sf=Pa();sf!==c?(ma=Na,ed.paren=!0,Na=ed):(m=Na,Na=c)}else m=Na,Na=c}else m=Na,Na=c}}}}}}}}}return Na}function R(){var B;var E=m;var S=h();if(S!==c){var Y=[];for(B=e();B!==c;)Y.push(B),B=e();ma=E;E=S+Y.join("")}else m=E,E=c;return E}function h(){var B=
a.charAt(m);tf.test(B)?m++:(B=c,0===ia&&J(uf));return B}function e(){var B=a.charAt(m);vf.test(B)?m++:(B=c,0===ia&&J(wf));return B}function n(){var B=a.charAt(m);xd.test(B)?m++:(B=c,0===ia&&J(yd));return B}function A(){var B=a.charAt(m);xd.test(B)?m++:(B=c,0===ia&&J(yd));if(B===c)if(B=m,P()!==c){var E=P();E!==c?(ma=B,B='"'):(m=B,B=c)}else m=B,B=c;return B}function P(){var B=a.charAt(m);xf.test(B)?m++:(B=c,0===ia&&J(yf));return B}function X(){var B;var E=B=m;if(64===a.charCodeAt(m)){var S=zf;m++}else S=
c,0===ia&&J(Af);if(S!==c){var Y=R();Y!==c?E=S=[S,Y]:(m=E,E=c)}else m=E,E=c;E!==c&&(ma=B,B=E,E={type:"parameter",location:k(),value:B[1]});return E}function ca(){var B=m;var E=m;var S=a.substr(m,7);S.toLowerCase()===Bf?m+=7:(S=c,0===ia&&J(Cf));if(S!==c){S=m;ia++;var Y=e();ia--;Y===c?S=void 0:(m=S,S=c);S!==c?(ma=E,E="INTEGER"):(m=E,E=c)}else m=E,E=c;E===c&&(E=m,S=a.substr(m,3),S.toLowerCase()===Df?m+=3:(S=c,0===ia&&J(Ef)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="INT"):(m=E,
E=c)):(m=E,E=c));E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"integer"}});B=E;B===c&&(E=B=m,S=a.substr(m,8),S.toLowerCase()===Ff?m+=8:(S=c,0===ia&&J(Gf)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="SMALLINT"):(m=E,E=c)):(m=E,E=c),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"smallint"}}),B=E,B===c&&(E=B=m,S=a.substr(m,5),S.toLowerCase()===Hf?m+=5:(S=c,0===ia&&J(If)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="FLOAT"):(m=E,E=
c)):(m=E,E=c),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"float"}}),B=E,B===c&&(E=B=m,S=a.substr(m,4),S.toLowerCase()===Jf?m+=4:(S=c,0===ia&&J(Kf)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="REAL"):(m=E,E=c)):(m=E,E=c),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"real"}}),B=E,B===c&&(B=m,E=pa(),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"date"}}),B=E,B===c&&(B=m,E=oa(),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"timestamp"}}),
B=E,B===c&&(B=m,E=xa(),E!==c&&(ma=B,E={type:"data-type",location:k(),value:{type:"time"}}),B=E,B===c&&(E=B=m,S=a.substr(m,7),S.toLowerCase()===Lf?m+=7:(S=c,0===ia&&J(Mf)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="VARCHAR"):(m=E,E=c)):(m=E,E=c),E!==c?(ka(),E=Oa(),E!==c?(ka(),E=H(),E!==c?(ka(),S=Pa(),S!==c?(ma=B,B={type:"data-type",location:k(),value:{type:"varchar",size:parseInt(E)}}):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c))))))));return B}function ja(){var B=m;var E=m;
var S=a.substr(m,7);S.toLowerCase()===Nf?m+=7:(S=c,0===ia&&J(Of));if(S!==c){S=m;ia++;var Y=e();ia--;Y===c?S=void 0:(m=S,S=c);S!==c?(ma=E,E="LEADING"):(m=E,E=c)}else m=E,E=c;E===c&&(E=m,S=a.substr(m,8),S.toLowerCase()===Pf?m+=8:(S=c,0===ia&&J(Qf)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="TRAILING"):(m=E,E=c)):(m=E,E=c),E===c&&(E=m,S=a.substr(m,4),S.toLowerCase()===Rf?m+=4:(S=c,0===ia&&J(Sf)),S!==c?(S=m,ia++,Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="BOTH"):(m=E,E=
c)):(m=E,E=c)));E===c&&(E=null);ma=B;B=E;return E={type:"string",location:k(),value:null==B?"BOTH":B}}function qa(){var B=m;var E=va();if(E===c&&(E=Ea(),E===c&&(E=Ba(),E===c&&(E=Da(),E===c&&(E=Fa(),E===c&&(E=Ca(),E===c)))))){E=m;var S=a.substr(m,13);S.toLowerCase()===Tf?m+=13:(S=c,0===ia&&J(Uf));if(S!==c){S=m;ia++;var Y=e();ia--;Y===c?S=void 0:(m=S,S=c);S!==c?(ma=E,E="TIMEZONE_HOUR"):(m=E,E=c)}else m=E,E=c;E===c&&(E=m,S=a.substr(m,15),S.toLowerCase()===Vf?m+=15:(S=c,0===ia&&J(Wf)),S!==c?(S=m,ia++,
Y=e(),ia--,Y===c?S=void 0:(m=S,S=c),S!==c?(ma=E,E="TIMEZONE_MINUTE"):(m=E,E=c)):(m=E,E=c))}E!==c&&(ma=B,B=E,E={type:"string",location:k(),value:B});return E}function sa(){var B=m;var E=m;var S=da();if(S!==c){ka();var Y=Oa();if(Y!==c)if(ka(),Y=na(),Y!==c){ka();var wa=Pa();wa!==c?(ma=E,E=S,E={type:"interval-period",location:k(),period:E.value,precision:Y,secondary:null}):(m=E,E=c)}else m=E,E=c;else m=E,E=c}else m=E,E=c;E===c&&(E=m,S=da(),S!==c&&(ma=E,E=S,S={type:"interval-period",location:k(),period:E.value,
precision:null,secondary:null}),E=S);if(E!==c)if(ka(),S=m,Y=a.substr(m,2),Y.toLowerCase()===Xf?m+=2:(Y=c,0===ia&&J(Yf)),Y!==c?(Y=m,ia++,wa=e(),ia--,wa===c?Y=void 0:(m=Y,Y=c),Y!==c?(ma=S,S="TO"):(m=S,S=c)):(m=S,S=c),S!==c){ka();S=m;Y=da();Y!==c&&(ma=S,S=Y,Y={type:"interval-period",location:k(),period:S.value,precision:null,secondary:null});S=Y;if(S===c){S=m;Y=Ca();if(Y!==c)if(ka(),Y=Oa(),Y!==c)if(ka(),Y=na(),Y!==c)if(ka(),wa=Ya(),wa!==c)if(ka(),wa=fa(),wa!==c){ka();var ya=Pa();ya!==c?(ma=S,S=Y,S={type:"interval-period",
location:k(),period:"second",precision:S,secondary:wa}):(m=S,S=c)}else m=S,S=c;else m=S,S=c;else m=S,S=c;else m=S,S=c;else m=S,S=c;S===c&&(S=m,Y=Ca(),Y!==c?(ka(),Y=Oa(),Y!==c?(ka(),Y=na(),Y!==c?(ka(),wa=Pa(),wa!==c?(ma=S,S=Y,S={type:"interval-period",location:k(),period:"second",precision:S,secondary:null}):(m=S,S=c)):(m=S,S=c)):(m=S,S=c)):(m=S,S=c),S===c&&(S=m,Y=Ca(),Y!==c&&(ma=S,Y={type:"interval-period",location:k(),period:"second",precision:null,secondary:null}),S=Y))}S!==c?(ma=B,B={type:"interval-qualifier",
location:k(),start:E,end:S}):(m=B,B=c)}else m=B,B=c;else m=B,B=c;B===c&&(B=m,S=da(),S!==c?(ka(),E=Oa(),E!==c?(ka(),E=fa(),E!==c?(ka(),Y=Pa(),Y!==c?(ma=B,B=S,B={type:"interval-period",location:k(),period:B.value,precision:E,secondary:null}):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c),B===c&&(B=m,S=da(),S!==c&&(ma=B,B=S,S={type:"interval-period",location:k(),period:B.value,precision:null,secondary:null}),B=S,B===c&&(B=m,S=Ca(),S!==c?(ka(),E=Oa(),E!==c?(ka(),E=na(),E!==c?(ka(),Y=Ya(),Y!==c?(ka(),S=fa(),
S!==c?(ka(),Y=Pa(),Y!==c?(ma=B,B=E,B={type:"interval-period",location:k(),period:"second",precision:B,secondary:S}):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c),B===c&&(B=m,S=Ca(),S!==c?(ka(),E=Oa(),E!==c?(ka(),E=fa(),E!==c?(ka(),Y=Pa(),Y!==c?(ma=B,B=E,B={type:"interval-period",location:k(),period:"second",precision:B,secondary:null}):(m=B,B=c)):(m=B,B=c)):(m=B,B=c)):(m=B,B=c),B===c&&(B=m,S=Ca(),S!==c&&(ma=B,S={type:"interval-period",location:k(),period:"second",precision:null,
secondary:null}),B=S)))));return B}function da(){var B=m;var E=Ba();E!==c&&(ma=B,E={type:"string",location:k(),value:"day"});B=E;B===c&&(B=m,E=Da(),E!==c&&(ma=B,E={type:"string",location:k(),value:"hour"}),B=E,B===c&&(B=m,E=Fa(),E!==c&&(ma=B,E={type:"string",location:k(),value:"minute"}),B=E,B===c&&(B=m,E=Ea(),E!==c&&(ma=B,E={type:"string",location:k(),value:"month"}),B=E,B===c&&(B=m,E=va(),E!==c&&(ma=B,E={type:"string",location:k(),value:"year"}),B=E))));return B}function fa(){var B=m;var E=H();
E!==c&&(ma=B,E=parseFloat(E));return E}function na(){var B=m;var E=H();E!==c&&(ma=B,E=parseFloat(E));return E}function ra(){var B=ta();B===c&&(B=X());return B}function ta(){var B=m;if(39===a.charCodeAt(m)){var E=zd;m++}else E=c,0===ia&&J(Ad);E===c&&(a.substr(m,2)===Bd?(E=Bd,m+=2):(E=c,0===ia&&J(Zf)));if(E!==c){E=[];var S=m;if(a.substr(m,2)===Cc){var Y=Cc;m+=2}else Y=c,0===ia&&J(Cd);Y!==c&&(ma=S,Y="'");S=Y;S===c&&(S=a.charAt(m),Dd.test(S)?m++:(S=c,0===ia&&J(Ed)));for(;S!==c;)E.push(S),S=m,a.substr(m,
2)===Cc?(Y=Cc,m+=2):(Y=c,0===ia&&J(Cd)),Y!==c&&(ma=S,Y="'"),S=Y,S===c&&(S=a.charAt(m),Dd.test(S)?m++:(S=c,0===ia&&J(Ed)));39===a.charCodeAt(m)?(S=zd,m++):(S=c,0===ia&&J(Ad));S!==c?(ma=B,B={type:"string",location:k(),value:E.join("")}):(m=B,B=c)}else m=B,B=c;return B}function za(){var B=m;if(bb()!==c){ka();var E=b();if(E!==c){ka();var S=cb();S!==c?(ka(),S=b(),S!==c?(ma=B,B={type:"when-clause",location:k(),operand:E,value:S}):(m=B,B=c)):(m=B,B=c)}else m=B,B=c}else m=B,B=c;return B}function Aa(){var B=
m;if(bb()!==c){ka();var E=b();if(E!==c){ka();var S=cb();S!==c?(ka(),S=b(),S!==c?(ma=B,B={type:"when-clause",location:k(),operand:E,value:S}):(m=B,B=c)):(m=B,B=c)}else m=B,B=c}else m=B,B=c;return B}function Ha(){var B=m;var E=m;var S=a.substr(m,4);S.toLowerCase()===$f?m+=4:(S=c,0===ia&&J(ag));if(S!==c){S=m;ia++;var Y=e();ia--;Y===c?S=void 0:(m=S,S=c);S!==c?(ma=E,E="ELSE"):(m=E,E=c)}else m=E,E=c;E!==c?(ka(),E=b(),E!==c?(ma=B,B={type:"else-clause",location:k(),value:E}):(m=B,B=c)):(m=B,B=c);return B}
function Ka(){var B=H();if(B===c){B=m;var E=a.charAt(m);kc.test(E)?m++:(E=c,0===ia&&J(lc));if(E!==c){var S=H();S!==c?(ma=B,B=E[0]+S):(m=B,B=c)}else m=B,B=c}return B}function Ga(){var B=m;if(46===a.charCodeAt(m)){var E=bg;m++}else E=c,0===ia&&J(cg);E!==c?(E=H(),E===c&&(E=null),ma=B,B="."+(null!=E?E:"")):(m=B,B=c);return B}function l(){var B;var E=B=m;var S=a.charAt(m);dg.test(S)?m++:(S=c,0===ia&&J(eg));S!==c?(S=a.charAt(m),kc.test(S)?m++:(S=c,0===ia&&J(lc)),S===c&&(S=null),ma=E,E="e"+(null===S?"":
S)):(m=E,E=c);E!==c?(S=H(),S!==c?(ma=B,B=E+S):(m=B,B=c)):(m=B,B=c);return B}function H(){var B=m;var E=[];var S=W();if(S!==c)for(;S!==c;)E.push(S),S=W();else E=c;E!==c&&(ma=B,E=E.join(""));return E}function W(){var B=a.charAt(m);fg.test(B)?m++:(B=c,0===ia&&J(gg));return B}function ba(){var B=m;var E=a.substr(m,2);E.toLowerCase()===hg?m+=2:(E=c,0===ia&&J(ig));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="IN"):(m=B,B=c)}else m=B,B=c;return B}function la(){var B=m;var E=a.substr(m,
2);E.toLowerCase()===jg?m+=2:(E=c,0===ia&&J(kg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="IS"):(m=B,B=c)}else m=B,B=c;return B}function C(){var B=m;var E=a.substr(m,4);E.toLowerCase()===lg?m+=4:(E=c,0===ia&&J(mg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="LIKE"):(m=B,B=c)}else m=B,B=c;return B}function K(){var B=m;var E=a.substr(m,3);E.toLowerCase()===ng?m+=3:(E=c,0===ia&&J(og));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,
E=c);E!==c?(ma=B,B="NOT"):(m=B,B=c)}else m=B,B=c;return B}function N(){var B=m;var E=a.substr(m,3);E.toLowerCase()===pg?m+=3:(E=c,0===ia&&J(qg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="AND"):(m=B,B=c)}else m=B,B=c;return B}function V(){var B=m;var E=a.substr(m,2);E.toLowerCase()===rg?m+=2:(E=c,0===ia&&J(sg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="OR"):(m=B,B=c)}else m=B,B=c;return B}function aa(){var B=m;var E=a.substr(m,7);E.toLowerCase()===
tg?m+=7:(E=c,0===ia&&J(ug));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="BETWEEN"):(m=B,B=c)}else m=B,B=c;return B}function ea(){var B=m;var E=a.substr(m,4);E.toLowerCase()===vg?m+=4:(E=c,0===ia&&J(wg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="FROM"):(m=B,B=c)}else m=B,B=c;return B}function ha(){var B=m;var E=a.substr(m,7);E.toLowerCase()===xg?m+=7:(E=c,0===ia&&J(yg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=
B,B="EXTRACT"):(m=B,B=c)}else m=B,B=c;return B}function oa(){var B=m;var E=a.substr(m,9);E.toLowerCase()===zg?m+=9:(E=c,0===ia&&J(Ag));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="TIMESTAMP"):(m=B,B=c)}else m=B,B=c;return B}function pa(){var B=m;var E=a.substr(m,4);E.toLowerCase()===Bg?m+=4:(E=c,0===ia&&J(Cg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="DATE"):(m=B,B=c)}else m=B,B=c;return B}function xa(){var B=m;var E=a.substr(m,4);E.toLowerCase()===
Dg?m+=4:(E=c,0===ia&&J(Eg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="TIME"):(m=B,B=c)}else m=B,B=c;return B}function ua(){var B=m;var E=a.substr(m,8);E.toLowerCase()===Fg?m+=8:(E=c,0===ia&&J(Gg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="INTERVAL"):(m=B,B=c)}else m=B,B=c;return B}function va(){var B=m;var E=a.substr(m,4);E.toLowerCase()===Hg?m+=4:(E=c,0===ia&&J(Ig));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=
B,B="YEAR"):(m=B,B=c)}else m=B,B=c;return B}function Ea(){var B=m;var E=a.substr(m,5);E.toLowerCase()===Jg?m+=5:(E=c,0===ia&&J(Kg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="MONTH"):(m=B,B=c)}else m=B,B=c;return B}function Ba(){var B=m;var E=a.substr(m,3);E.toLowerCase()===Lg?m+=3:(E=c,0===ia&&J(Mg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="DAY"):(m=B,B=c)}else m=B,B=c;return B}function Da(){var B=m;var E=a.substr(m,4);E.toLowerCase()===
Ng?m+=4:(E=c,0===ia&&J(Og));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="HOUR"):(m=B,B=c)}else m=B,B=c;return B}function Fa(){var B=m;var E=a.substr(m,6);E.toLowerCase()===Pg?m+=6:(E=c,0===ia&&J(Qg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="MINUTE"):(m=B,B=c)}else m=B,B=c;return B}function Ca(){var B=m;var E=a.substr(m,6);E.toLowerCase()===Rg?m+=6:(E=c,0===ia&&J(Sg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=
B,B="SECOND"):(m=B,B=c)}else m=B,B=c;return B}function Ia(){var B=m;var E=a.substr(m,4);E.toLowerCase()===Tg?m+=4:(E=c,0===ia&&J(Ug));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="CASE"):(m=B,B=c)}else m=B,B=c;return B}function Ta(){var B=m;var E=a.substr(m,3);E.toLowerCase()===Vg?m+=3:(E=c,0===ia&&J(Wg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="END"):(m=B,B=c)}else m=B,B=c;return B}function bb(){var B=m;var E=a.substr(m,4);E.toLowerCase()===
Xg?m+=4:(E=c,0===ia&&J(Yg));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="WHEN"):(m=B,B=c)}else m=B,B=c;return B}function cb(){var B=m;var E=a.substr(m,4);E.toLowerCase()===Zg?m+=4:(E=c,0===ia&&J($g));if(E!==c){E=m;ia++;var S=e();ia--;S===c?E=void 0:(m=E,E=c);E!==c?(ma=B,B="THEN"):(m=B,B=c)}else m=B,B=c;return B}function Ya(){if(44===a.charCodeAt(m)){var B=ah;m++}else B=c,0===ia&&J(bh);return B}function Oa(){if(40===a.charCodeAt(m)){var B=ch;m++}else B=c,0===ia&&J(dh);
return B}function Pa(){if(41===a.charCodeAt(m)){var B=eh;m++}else B=c,0===ia&&J(fh);return B}function ka(){var B;var E=[];for(B=ic();B!==c;)E.push(B),B=ic();return E}function ic(){var B=a.charAt(m);gh.test(B)?m++:(B=c,0===ia&&J(hh));return B}function Kb(B,E,S,Y,wa){B={type:"binary-expression",location:wa,operator:B,left:E,right:S};void 0!==Y&&(B.escape=Y);return B}function Ma(B,...E){return{type:"expression-list",location:B,value:E}}function Ib(B,E){for(const {op:S,expr:Y,location:{end:wa}}of E)B=
Kb(S,B,Y,void 0,{...B.location,end:wa});return B}p=void 0!==p?p:{};var c={},Hd=p.grammarSource,Fd={start:L},Gd=L,Id="!",Kd="\x3d",fd="\x3e\x3d",Pd="\x3e",gd="\x3c\x3d",hd="\x3c\x3e",id="!\x3d",jd="||",zf="@",zd="'",Bd="N'",Cc="''",bg=".",fe="null",Zd="true",be="false",hg="in",jg="is",lg="like",Md="escape",ng="not",pg="and",rg="or",tg="between",vg="from",ue="for",re="substring",xg="extract",De="trim",Me="position",zg="timestamp",Bg="date",Dg="time",Nf="leading",Pf="trailing",Rf="both",Ue="cast",Xe=
"as",Bf="integer",Df="int",Ff="smallint",Hf="float",Jf="real",Lf="varchar",Xf="to",Fg="interval",Hg="year",Tf="timezone_hour",Vf="timezone_minute",Jg="month",Lg="day",Ng="hour",Pg="minute",Rg="second",Tg="case",Vg="end",Xg="when",Zg="then",$f="else",ah=",",ch="(",eh=")",nd="`",Td=/^[<-=]/,kc=/^[+\-]/,Xd=/^[*\/]/,tf=/^[A-Za-z_\x80-\uFFFF]/,vf=/^[A-Za-z0-9_]/,xd=/^[A-Za-z0-9_.\x80-\uFFFF]/,xf=/^["]/,Dd=/^[^']/,fg=/^[0-9]/,dg=/^[eE]/,gh=/^[ \t\n\r]/,pd=/^[^`]/,Jd=v("!",!1),Ld=v("\x3d",!1),Od=v("\x3e\x3d",
!1),Qd=v("\x3e",!1),Rd=v("\x3c\x3d",!1),Sd=v("\x3c\x3e",!1),Ud=D([["\x3c","\x3d"]],!1,!1),Vd=v("!\x3d",!1),lc=D(["+","-"],!1,!1),Wd=v("||",!1),Yd=D(["*","/"],!1,!1),uf=D([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),wf=D([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),yd=D([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),yf=D(['"'],!1,!1),Af=v("@",!1),Ad=v("'",!1),Zf=v("N'",!1),Cd=v("''",!1),Ed=D(["'"],!0,!1),cg=v(".",!1),gg=D([["0","9"]],!1,!1),eg=D(["e","E"],!1,!1),ge=v("NULL",
!0),$d=v("TRUE",!0),ce=v("FALSE",!0),ig=v("IN",!0),kg=v("IS",!0),mg=v("LIKE",!0),Nd=v("ESCAPE",!0),og=v("NOT",!0),qg=v("AND",!0),sg=v("OR",!0),ug=v("BETWEEN",!0),wg=v("FROM",!0),ve=v("FOR",!0),se=v("SUBSTRING",!0),yg=v("EXTRACT",!0),Ee=v("TRIM",!0),Ne=v("POSITION",!0),Ag=v("TIMESTAMP",!0),Cg=v("DATE",!0),Eg=v("TIME",!0),Of=v("LEADING",!0),Qf=v("TRAILING",!0),Sf=v("BOTH",!0),Ve=v("CAST",!0),Ye=v("AS",!0),Cf=v("INTEGER",!0),Ef=v("INT",!0),Gf=v("SMALLINT",!0),If=v("FLOAT",!0),Kf=v("REAL",!0),Mf=v("VARCHAR",
!0),Yf=v("TO",!0),Gg=v("INTERVAL",!0),Ig=v("YEAR",!0),Uf=v("TIMEZONE_HOUR",!0),Wf=v("TIMEZONE_MINUTE",!0),Kg=v("MONTH",!0),Mg=v("DAY",!0),Og=v("HOUR",!0),Qg=v("MINUTE",!0),Sg=v("SECOND",!0),Ug=v("CASE",!0),Wg=v("END",!0),Yg=v("WHEN",!0),$g=v("THEN",!0),ag=v("ELSE",!0),bh=v(",",!1),dh=v("(",!1),fh=v(")",!1),hh=D([" ","\t","\n","\r"],!1,!1),od=v("`",!1),qd=D(["`"],!0,!1),m=p.peg$currPos|0,ma=m,Eb=[{line:1,column:1}],hb=m,jc=p.peg$maxFailExpected||[],ia=p.peg$silentFails|0;if(p.startRule){if(!(p.startRule in
Fd))throw Error("Can't start parsing from rule \""+p.startRule+'".');Gd=Fd[p.startRule]}var Dc=Gd();if(p.peg$library)return{peg$result:Dc,peg$currPos:m,peg$FAILED:c,peg$maxFailExpected:jc,peg$maxFailPos:hb};if(Dc!==c&&m===a.length)return Dc;Dc!==c&&m<a.length&&J({type:"end"});throw function(B,E,S){return new g(g.buildMessage(B,E),B,E,S)}(jc,hb<a.length?a.charAt(hb):null,hb<a.length?t(hb,hb+1):t(hb,hb));}function r(a,p){if(null!=a)switch(p(a),a.type){case "when-clause":r(a.operand,p);r(a.value,p);
break;case "case-expression":for(const k of a.clauses)r(k,p);"simple"===a.format&&r(a.operand,p);null!==a.else&&r(a.else,p);break;case "expression-list":for(const k of a.value)r(k,p);break;case "unary-expression":r(a.expr,p);break;case "binary-expression":r(a.left,p);r(a.right,p);break;case "function":r(a.args,p);break;case "interval":r(a.value,p);r(a.qualifier,p);break;case "interval-qualifier":r(a.start,p),r(a.end,p)}}(function(a,p){function k(){this.constructor=a}k.prototype=p.prototype;a.prototype=
new k})(g,Error);g.prototype.format=function(a){var p="Error: "+this.message;if(this.location){var k=null,y;for(y=0;y<a.length;y++)if(a[y].source===this.location.source){k=a[y].text.split(/\r\n|\n|\r/g);break}a=this.location.start;y=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(a):a;var v=this.location.source+":"+y.line+":"+y.column;if(k){var D=this.location.end,F=u("",y.line.toString().length," ");k=k[a.line-1];D=(a.line===D.line?D.column:k.length+
1)-a.column||1;p+="\n --\x3e "+v+"\n"+F+" |\n"+y.line+" | "+k+"\n"+F+" | "+u("",a.column-1," ")+u("",D,"^")}else p+="\n at "+v}return p};g.buildMessage=function(a,p){function k(t){return t.charCodeAt(0).toString(16).toUpperCase()}function y(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+k(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+k(J)})}function v(t){return t.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(J){return"\\x0"+k(J)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(J){return"\\x"+k(J)})}function D(t){return F[t.type](t)}var F={literal:function(t){return'"'+y(t.text)+'"'},class:function(t){var J=t.parts.map(function(L){return Array.isArray(L)?v(L[0])+"-"+v(L[1]):v(L)});return"["+(t.inverted?"^":"")+J.join("")+"]"},
any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};return"Expected "+function(t){t=t.map(D);var J,L;t.sort();if(0<t.length){for(L=J=1;J<t.length;J++)t[J-1]!==t[J]&&(t[L]=t[J],L++);t.length=L}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(a)+" but "+(p?'"'+y(p)+'"':"end of input")+" found."};class M{static parse(a){return z(a)}}d.WhereGrammar=M;d.visitAll=
r;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(d,g){g=new g.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});d.kebabDict=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCache":function(){define(["exports"],function(d){class g{constructor(){this._storage=new Map;this._purgeInterval=5;this._sweep=()=>{this._timer=void 0;if(this._storage){var r=
1E3*this._purgeInterval,M=performance.now()-r;for(const [a,p]of this._storage)if(p.time<M)this._storage.delete(a);else{0<this._storage.size&&(this._timer=setTimeout(this._sweep,r));break}}}}destroy(){this._storage?.clear();this._storage=null;clearTimeout(this._timer)}get size(){return this._storage?.size??0}put(r,M){this._storage?.set(r,new z(M));this._scheduleSweep()}get(r){if(this._storage){var M=this._storage?.get(r);if(M)return this._storage?.delete(r),M.time=performance.now(),this._storage?.set(r,
M),M.items}}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??(this._timer=setTimeout(this._sweep,1E3*this._purgeInterval)))}}let u=0;class z{constructor(r){this.items=r;this.time=performance.now();this.id=u++}}d.QueryEngineCache=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(d){d.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,
supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,
supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F){function t(b,q,I,f){const G=f.x-I.x;f=f.y-I.y;q=Math.min(1,Math.max(0,((q.x-I.x)*G+(q.y-I.y)*f)/(G*G+f*f)));b.x=I.x+G*q;b.y=I.y+f*q}function J(b,q){return b?q?4:3:q?3:2}class L{constructor(b,q,I){this.items=b;this.query=q;this.geometryType=I.geometryType;this.hasM=I.hasM;this.hasZ=I.hasZ;this.fieldsIndex=I.fieldsIndex;this.objectIdField=I.objectIdField;this.spatialReference=I.spatialReference;this.featureAdapter=I.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const b=
new p(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return b.countDistinctValues(this.items);const {groupByFieldsForStatistics:q,having:I,outStatistics:f}=this.query;if(!q?.length)return 1;const G=new Map,O=new Map,Q=new Set;for(const T of f){var {statisticType:Z}=T;Z="exceedslimit"!==Z?T.onStatisticField:void 0;if(!O.has(Z)){var U=[];for(const x of q){const R=this._getAttributeValues(b,x,G);U.push(R)}O.set(Z,this._calculateUniqueValues(U,b.returnDistinctValues))}Z=
O.get(Z);for(const x in Z){const {data:R,items:h}=Z[x];U=R.join(",");I&&!b.validateItems(h,I)||Q.add(U)}}return Q.size}async createQueryResponse(){let b;b=this.query.outStatistics?this.query.outStatistics.some(q=>"exceedslimit"===q.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const q=this.query.geometry;a.isValid(this.query.outSR)&&!a.equals(q.spatialReference,
this.query.outSR)?b.queryGeometry=k.cleanFromGeometryEngine({spatialReference:this.query.outSR,...y.project(q,q.spatialReference,this.query.outSR)}):b.queryGeometry=k.cleanFromGeometryEngine({spatialReference:this.query.outSR,...q})}return b}createSnappingResponse(b,q){const I=this.featureAdapter,f=J(this.hasZ,this.hasM),{point:G,mode:O}=b,Q="number"===typeof b.distance?b.distance:b.distance.x,Z="number"===typeof b.distance?b.distance:b.distance.y,U={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
q=this._getPointCreator(O,this.spatialReference,q);const x=new w(null,0),R=new w(null,0),h={x:0,y:0,z:0};for(const ja of this.items){var e=I.getGeometry(ja);if(null==e)continue;const {coords:qa,lengths:sa}=e;x.coords=qa;R.coords=qa;if(b.returnEdge){e=0;for(var n=0;n<sa.length;n++){var A=sa[n];for(var P=0;P<A;P++,e+=f){var X=x;X.coordsIndex=e;if(P!==A-1){const da=R;da.coordsIndex=e+f;const fa=h;t(h,G,X,da);var ca=(G.x-fa.x)/Q;const na=(G.y-fa.y)/Z;ca=ca*ca+na*na;1>=ca&&U.candidates.push(v.makeEdgeCandidate(I.getObjectId(ja),
q(fa),Math.sqrt(ca),q(X),q(da)))}}}}if("none"!==b.vertexMode)if(e=T?qa.length-f:qa.length,"all"===b.vertexMode)for(n=0;n<e;n+=f)A=x,A.coordsIndex=n,P=(G.x-A.x)/Q,X=(G.y-A.y)/Z,P=P*P+X*X,1>=P&&U.candidates.push(v.makeVertexCandidate(I.getObjectId(ja),q(A),Math.sqrt(P)));else if("ends"===b.vertexMode){e=[0];T||e.push(qa.length-f);for(const da of e)e=x,e.coordsIndex=da,n=(G.x-e.x)/Q,A=(G.y-e.y)/Z,n=n*n+A*A,1>=n&&U.candidates.push(v.makeVertexCandidate(I.getObjectId(ja),q(e),Math.sqrt(n)))}}U.candidates.sort((ja,
qa)=>ja.distance-qa.distance);return U}_getPointCreator(b,q,I){const f=null==I||a.equals(q,I)?O=>O:O=>y.project(O,q,I),{hasZ:G}=this;return"3d"===b?G?({x:O,y:Q,z:Z})=>f({x:O,y:Q,z:Z}):({x:O,y:Q})=>f({x:O,y:Q,z:0}):({x:O,y:Q})=>f({x:O,y:Q})}async createSummaryStatisticsResponse(b){const {field:q,valueExpression:I,normalizationField:f,normalizationType:G,normalizationTotal:O,minValue:Q,maxValue:Z,scale:U,timeZone:T,outStatisticTypes:x}=b;var R=this.fieldsIndex.get(q);b=D.isDateField(R)||D.isDateOnlyField(R)||
D.isTimestampOffsetField(R);const h=await this._getDataValues({field:q,valueExpression:I,normalizationField:f,normalizationType:G,normalizationTotal:O,scale:U,timeZone:T}),e=F.isNullCountSupported({normalizationType:G,normalizationField:f,minValue:Q,maxValue:Z}),n={value:.5,fieldType:R?.type};R=D.isStringField(R)?F.calculateStringStatistics({values:h,supportsNullCount:e,percentileParams:n,outStatisticTypes:x}):F.calculateStatistics({values:h,minValue:Q,maxValue:Z,useSampleStdDev:!G,supportsNullCount:e,
percentileParams:n,outStatisticTypes:x});return F.processSummaryStatisticsResult(R,x,b)}async createUniqueValuesResponse(b){const {field:q,valueExpression:I,domains:f,returnAllCodedValues:G,scale:O,timeZone:Q}=b;var Z=await this._getDataValues({field:q,field2:b.field2,field3:b.field3,fieldDelimiter:b.fieldDelimiter,valueExpression:I,scale:O,timeZone:Q},!1);Z=F.calculateUniqueValuesCount(Z);return F.createUVResult(Z,f,G,b.fieldDelimiter)}async createClassBreaksResponse(b){const {field:q,valueExpression:I,
normalizationField:f,normalizationType:G,normalizationTotal:O,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numClasses:x,scale:R,timeZone:h}=b;b=await this._getDataValues({field:q,valueExpression:I,normalizationField:f,normalizationType:G,normalizationTotal:O,scale:R,timeZone:h});b=F.calculateClassBreaks(b,{field:q,normalizationField:f,normalizationType:G,normalizationTotal:O,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numClasses:x});return F.resolveCBResult(b,
Q)}async createHistogramResponse(b){const {field:q,valueExpression:I,normalizationField:f,normalizationType:G,normalizationTotal:O,classificationMethod:Q,standardDeviationInterval:Z,minValue:U,maxValue:T,numBins:x,scale:R,timeZone:h}=b;b=await this._getDataValues({field:q,valueExpression:I,normalizationField:f,normalizationType:G,normalizationTotal:O,scale:R,timeZone:h});return F.calculateHistogram(b,{field:q,normalizationField:f,normalizationType:G,normalizationTotal:O,classificationMethod:Q,standardDeviationInterval:Z,
minValue:U,maxValue:T,numBins:x})}_sortFeatures(b,q,I){if(1<b.length&&q?.length)for(const f of q.reverse()){q=f.split(" ");const G=q[0],O=this.fieldsIndex.get(G);q=q[1]?"desc"===q[1].toLowerCase():!1;const Q=F.getAttributeComparator(O?.type,q);b.sort((Z,U)=>{Z=I(Z,G,O);U=I(U,G,O);return Q(Z,U)})}}_createFeatureQueryResponse(b){const q=this.items,{geometryType:I,hasM:f,hasZ:G,objectIdField:O,spatialReference:Q}=this,{outFields:Z,outSR:U,quantizationParameters:T,resultRecordCount:x,resultOffset:R,returnZ:h,
returnM:e}=b,n=null!=x?q.length>(R||0)+x:!1,A=Z&&(Z.includes("*")?[...this.fieldsIndex.fields]:Z.map(P=>this.fieldsIndex.get(P)));return{exceededTransferLimit:n,features:this._createFeatures(b,q),fields:A,geometryType:I,hasM:f&&e,hasZ:G&&h,objectIdFieldName:O,spatialReference:k.cleanFromGeometryEngine(U||Q),transform:T&&M.toQuantizationTransform(T)||null}}_createFeatures(b,q){const I=new p(b,this.featureAdapter,this.fieldsIndex),{hasM:f,hasZ:G}=this,{orderByFields:O,quantizationParameters:Q,returnGeometry:Z,
returnCentroid:U,maxAllowableOffset:T,resultOffset:x,resultRecordCount:R,returnZ:h=!1,returnM:e=!1}=b,n=G&&h,A=f&&e;b=[];var P=0;const X=[...q];this._sortFeatures(X,O,(da,fa,na)=>I.getFieldValue(da,fa,na));if(this.geometryType&&(Z||U)){var ca=M.toQuantizationTransform(Q)??void 0;q="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(Z&&!U)for(var ja of X){var qa=this.featureAdapter.getGeometry(ja),sa={attributes:I.getAttributes(ja),geometry:k.getGeometry(this.geometryType,
this.hasZ,this.hasM,qa,T,ca,n,A)};q&&qa&&!sa.geometry&&(sa.centroid=k.transformCentroid(this,this.featureAdapter.getCentroid(ja,this),ca));b[P++]=sa}else if(!Z&&U)for(qa of X)b[P++]={attributes:I.getAttributes(qa),centroid:k.transformCentroid(this,this.featureAdapter.getCentroid(qa,this),ca)};else for(sa of X)b[P++]={attributes:I.getAttributes(sa),centroid:k.transformCentroid(this,this.featureAdapter.getCentroid(sa,this),ca),geometry:k.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(sa),
T,ca,n,A)}}else for(ca of X)(ja=I.getAttributes(ca))&&(b[P++]={attributes:ja});P=x||0;null!=R&&(b=b.slice(P,Math.min(b.length,P+R)));return b}_createExceedsLimitQueryResponse(b){var q=!1;let I=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY;q=Number.POSITIVE_INFINITY;for(const G of b.outStatistics??[])if("exceedslimit"===G.statisticType){I=null!=G.maxPointCount?G.maxPointCount:Number.POSITIVE_INFINITY;f=null!=G.maxRecordCount?G.maxRecordCount:Number.POSITIVE_INFINITY;q=null!=G.maxVertexCount?
G.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)q=this.items.length>I;else if(this.items.length>f)q=!0;else{b=J(this.hasZ,this.hasM);const G=this.featureAdapter;q=this.items.reduce((O,Q)=>{Q=G.getGeometry(Q);return O+(null!=Q&&Q.coords.length||0)},0)/b>q}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(q)}}]}}async _createStatisticsQueryResponse(b){var q=
{attributes:{}};const I=[],f=new Map,G=new Map,O=new Map,Q=new Map,Z=new p(b,this.featureAdapter,this.fieldsIndex);var U=b.outStatistics;const {groupByFieldsForStatistics:T,having:x,orderByFields:R,resultRecordCount:h}=b;b=T?.length;const e=!!b,n=e?T[0]:null,A=e&&!this.fieldsIndex.get(n);for(const qa of U??[]){const {outStatisticFieldName:sa,statisticType:da}=qa;U=qa;const fa="exceedslimit"!==da?qa.onStatisticField:void 0,na="percentile_disc"===da||"percentile_cont"===da;var P="EnvelopeAggregate"===
da||"CentroidAggregate"===da||"ConvexHullAggregate"===da;const ra=e&&1===b&&(fa===n||A)&&"count"===da;if(e){if(!O.has(fa)){var X=[];for(const ta of T){var ca=this._getAttributeValues(Z,ta,f);X.push(ca)}O.set(fa,this._calculateUniqueValues(X,P?!1:Z.returnDistinctValues))}X=O.get(fa);if(!X)continue;ca=Object.keys(X);for(const ta of ca){const {count:za,data:Aa,items:Ha,itemPositions:Ka}=X[ta];ca=Aa.join(",");if(!x||Z.validateItems(Ha,x)){const Ga=Q.get(ca)||{attributes:{}};if(P){Ga.aggregateGeometries||
(Ga.aggregateGeometries={});const {aggregateGeometries:H,outStatisticFieldName:W}=await this._getAggregateGeometry(U,Ha);Ga.aggregateGeometries[W]=H}else{var ja=null;if(ra)ja=za;else{const H=this._getAttributeValues(Z,fa,f);ja=Ka.map(W=>H[W]);ja=na&&"statisticParameters"in U?this._getPercentileValue(U,ja):this._getStatisticValue(U,ja,null,Z.returnDistinctValues)}Ga.attributes[sa]=ja}let l=0;T.forEach((H,W)=>Ga.attributes[this.fieldsIndex.get(H)?H:`EXPR_${++l}`]=Aa[W]);Q.set(ca,Ga)}}}else if(P){q.aggregateGeometries||
(q.aggregateGeometries={});const {aggregateGeometries:ta,outStatisticFieldName:za}=await this._getAggregateGeometry(U,this.items);q.aggregateGeometries[za]=ta}else P=this._getAttributeValues(Z,fa,f),q.attributes[sa]=na&&"statisticParameters"in U?this._getPercentileValue(U,P):this._getStatisticValue(U,P,G,Z.returnDistinctValues);U="min"!==da&&"max"!==da||!D.isStringField(this.fieldsIndex.get(fa))&&!this._isAnyDateField(fa)?null:this.fieldsIndex.get(fa)?.type;I.push({name:sa,alias:sa,type:U||"esriFieldTypeDouble"})}q=
e?Array.from(Q.values()):[q];this._sortFeatures(q,R,(qa,sa)=>qa.attributes[sa]);h&&(q.length=Math.min(h,q.length));return{fields:I,features:q}}_isAnyDateField(b){b=this.fieldsIndex.get(b);return D.isDateField(b)||D.isDateOnlyField(b)||D.isTimestampOffsetField(b)||D.isTimeOnlyField(b)}async _getAggregateGeometry(b,q){const {convexHull:I,union:f}=await new Promise((h,e)=>d(["../../../geometry/geometryEngineJSON"],h,e)),{statisticType:G,outStatisticFieldName:O}=b,{featureAdapter:Q,spatialReference:Z,
geometryType:U,hasZ:T,hasM:x}=this;q=q.map(h=>k.getGeometry(U,T,x,Q.getGeometry(h)));const R=I(Z,q,!0)[0];b={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===G?(q=R?r.getPolygonExtent(R):r.getGeometryExtent(f(Z,q)),b.aggregateGeometries={...q,spatialReference:Z},b.outStatisticFieldName=O||"extent"):"CentroidAggregate"===G?(q=R?z.polygonCentroid(R):z.extentCentroid(r.getGeometryExtent(f(Z,q))),b.aggregateGeometries={x:q[0],y:q[1],spatialReference:Z},b.outStatisticFieldName=
O||"centroid"):"ConvexHullAggregate"===G&&(b.aggregateGeometries=R,b.outStatisticFieldName=O||"convexHull");return b}_getStatisticValue(b,q,I,f){const {onStatisticField:G,statisticType:O}=b;b=null;b=I?.has(G)?I.get(G):D.isStringField(this.fieldsIndex.get(G))||this._isAnyDateField(G)?F.calculateStringStatistics({values:q,returnDistinct:f}):F.calculateStatistics({values:f?[...(new Set(q))]:q,minValue:null,maxValue:null,useSampleStdDev:!0});I&&I.set(G,b);return b["var"===O?"variance":O]}_getPercentileValue(b,
q){const {onStatisticField:I,statisticParameters:f,statisticType:G}=b,{value:O,orderBy:Q}=f;b=this.fieldsIndex.get(I);return F.calculatePercentile(q,{value:O,orderBy:Q,fieldType:b?.type,isDiscrete:"percentile_disc"===G})}_getAttributeValues(b,q,I){if(I.has(q))return I.get(q);const f=this.fieldsIndex.get(q),G=this.items.map(O=>b.getFieldValue(O,q,f));I.set(q,G);return G}_calculateUniqueValues(b,q){const I={},f=this.items,G=f.length;for(let O=0;O<G;O++){const Q=f[O],Z=[];for(const T of b)Z.push(T[O]);
const U=Z.join(",");null==I[U]?I[U]={count:1,data:Z,items:[Q],itemPositions:[O]}:(q||I[U].count++,I[U].items.push(Q),I[U].itemPositions.push(O))}return I}async _getDataValues(b,q=!0){const I=new p(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:f,scale:G,timeZone:O}=b;return f?I.getExpressionValues(this.items,f,{viewingMode:"map",scale:G,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},O):I.getDataValues(this.items,
u.clone(b),q)}}class w{constructor(b,q){this.coords=b;this.coordsIndex=q}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}g.QueryEngineResult=L;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(d,g){function u(h){if("lowerLeft"===h.originPosition&&4===h.scale.length&&4===h.translate.length)return h;const {originPosition:e,
scale:n,translate:A}=h;h=n[1]??1;return{originPosition:"lowerLeft",scale:[n[0]??1,"lowerLeft"===e?h:-h,n[2]??1,n[3]??1],translate:[A[0]??0,A[1]??0,A[2]??0,A[3]??0]}}function z({scale:h,translate:e},n){return Math.round((n-e[0])/h[0])}function r({scale:h,translate:e},n){return Math.round((n-e[1])/h[1])}function M({scale:h,translate:e},n){return Math.round(((n??0)-e[2])/h[2])}function a({scale:h,translate:e},n){return n?Math.round((n-e[3])/h[3]):0}function p(h,e){return h&&e?Z:h&&!e?O:!h&&e?Q:G}function k({scale:h,
translate:e},n){return n*h[0]+e[0]}function y({scale:h,translate:e},n){return n*h[1]+e[1]}function v({scale:h,translate:e},n){return(n??0)*h[2]+e[2]}function D({scale:h,translate:e},n){return n?n*h[3]+e[3]:0}function F(h,e){return h&&e?R:h&&!e?T:!h&&e?x:U}function t(h,e,n){const A=Array(n.length);for(let P=0;P<n.length;P++)A[P]=e(h,n[P]);return A}function J(h,e,n){let [A,P]=n[0],X=Math.min(A,e[0]),ca=Math.min(P,e[1]),ja=Math.max(A,e[2]);e=Math.max(P,e[3]);for(let qa=1;qa<n.length;qa++){const [sa,
da]=n[qa];A+=sa;P+=da;0>sa&&(X=Math.min(X,A));0<sa&&(ja=Math.max(ja,A));0>da?ca=Math.min(ca,P):0<da&&(e=Math.max(e,P))}h[0]=X;h[1]=ca;h[2]=ja;h[3]=e;return h}function L(h,e){if(!e.length)return null;h[0]=h[1]=Number.POSITIVE_INFINITY;h[2]=h[3]=Number.NEGATIVE_INFINITY;for(let n=0;n<e.length;n++)J(h,h,e[n]);return h}function w(h,e,n){h=u(h);e.xmin=z(h,n.xmin);e.ymin=r(h,n.ymin);e.xmax=z(h,n.xmax);e.ymax=r(h,n.ymax);n.hasZ&&(e.zmin=M(h,n.zmin),e.zmax=M(h,n.zmax));n.hasM&&(e.mmin=a(h,n.mmin),e.mmax=
a(h,n.mmax));e.hasZ=n.hasZ??!1;e.hasM=n.hasM??!1;return e}function b(h,e,n){h=u(h);e.points=p(n.hasZ,n.hasM)(h,n.points)??[];e.hasZ=n.hasZ??!1;e.hasM=n.hasM??!1;return e}function q(h,e,n){h=u(h);e.x=z(h,n.x);e.y=r(h,n.y);null!=n.z&&(e.z=M(h,n.z));null!=n.m&&(e.m=a(h,n.m));return e}function I(h,e,n){{h=u(h);var A=n.rings;const P=[],X=p(n.hasZ,n.hasM);for(let ca=0;ca<A.length;ca++){const ja=X(h,A[ca]);ja&&3<=ja.length&&P.push(ja)}h=P.length?P:null}if(!h)return null;e.rings=h;e.hasZ=n.hasZ??!1;e.hasM=
n.hasM??!1;return e}function f(h,e,n){{h=u(h);var A=n.paths;const P=[],X=p(n.hasZ,n.hasM);for(let ca=0;ca<A.length;ca++){const ja=X(h,A[ca]);ja&&2<=ja.length&&P.push(ja)}h=P.length?P:null}if(!h)return null;e.paths=h;e.hasZ=n.hasZ??!1;e.hasM=n.hasM??!1;return e}const G=(h,e)=>{const n=[];if(!e.length)return null;var A=e[0];let P=z(h,A[0]);A=r(h,A[1]);n.push([P,A]);for(let X=1;X<e.length;X++){const [ca,ja]=e[X],qa=z(h,ca),sa=r(h,ja);qa===P&&sa===A||n.push([qa-P,sa-A]);P=qa;A=sa}return n},O=(h,e)=>{const n=
[];if(!e.length)return null;var A=e[0];let P=z(h,A[0]),X=r(h,A[1]);A=M(h,A[2]);n.push([P,X,A]);for(let ca=1;ca<e.length;ca++){const [ja,qa,sa]=e[ca],da=z(h,ja),fa=r(h,qa),na=M(h,sa);da===P&&fa===X&&na===A||n.push([da-P,fa-X,na]);P=da;X=fa;A=na}return n},Q=(h,e)=>{const n=[];if(!e.length)return null;var A=e[0];let P=z(h,A[0]),X=r(h,A[1]);A=a(h,A[2]);n.push([P,X,A]);for(let ca=1;ca<e.length;ca++){const [ja,qa,sa]=e[ca],da=z(h,ja),fa=r(h,qa),na=a(h,sa);da===P&&fa===X&&na===A||n.push([da-P,fa-X,na]);
P=da;X=fa;A=na}return n},Z=(h,e)=>{const n=[];if(!e.length)return null;var A=e[0];let P=z(h,A[0]),X=r(h,A[1]),ca=M(h,A[2]);A=a(h,A[3]);n.push([P,X,ca,A]);for(let ja=1;ja<e.length;ja++){const [qa,sa,da,fa]=e[ja],na=z(h,qa),ra=r(h,sa),ta=M(h,da),za=a(h,fa);na===P&&ra===X&&ta===ca&&za===A||n.push([na-P,ra-X,ta,za]);P=na;X=ra;ca=ta;A=za}return n},U=(h,e)=>{const n=Array(e.length);if(!e.length)return n;var A=e[0];let P=k(h,A[0]);A=y(h,A[1]);n[0]=[P,A];const {scale:X,originPosition:ca}=h;h=X[0];const ja=
"lowerLeft"===ca?X[1]:-X[1];for(let qa=1;qa<e.length;qa++){const [sa,da]=e[qa];P+=h*sa;A+=ja*da;n[qa]=[P,A]}return n},T=(h,e)=>{const n=Array(e.length);if(!e.length)return n;var A=e[0];let P=k(h,A[0]),X=y(h,A[1]);n[0]=[P,X,v(h,A[2])];const {scale:ca,originPosition:ja}=h;A=ca[0];const qa="lowerLeft"===ja?ca[1]:-ca[1];for(let sa=1;sa<e.length;sa++){const [da,fa,na]=e[sa];P+=A*da;X+=qa*fa;n[sa]=[P,X,v(h,na)]}return n},x=(h,e)=>{const n=Array(e.length);if(!e.length)return n;var A=e[0];let P=k(h,A[0]),
X=y(h,A[1]);n[0]=[P,X,D(h,A[2])];const {scale:ca,originPosition:ja}=h;A=ca[0];const qa="lowerLeft"===ja?ca[1]:-ca[1];for(let sa=1;sa<e.length;sa++){const [da,fa,na]=e[sa];P+=A*da;X+=qa*fa;n[sa]=[P,X,D(h,na)]}return n},R=(h,e)=>{const n=Array(e.length);if(!e.length)return n;var A=e[0];let P=k(h,A[0]),X=y(h,A[1]);n[0]=[P,X,v(h,A[2]),D(h,A[3])];const {scale:ca,originPosition:ja}=h;A=ca[0];const qa="lowerLeft"===ja?ca[1]:-ca[1];for(let sa=1;sa<e.length;sa++){const [da,fa,na,ra]=e[sa];P+=A*da;X+=qa*fa;
n[sa]=[P,X,v(h,na),D(h,ra)]}return n};d.getQuantizedBoundsCoordsArray=J;d.getQuantizedBoundsCoordsArrayArray=L;d.getQuantizedBoundsPaths=function(h){return L([0,0,0,0],h)};d.getQuantizedBoundsPoints=function(h){const e=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return J(e,e,h)};d.getQuantizedBoundsRings=function(h){return L([0,0,0,0],h)};d.normalizeTransform=u;d.quantizeBounds=function(h,e,n){h=u(h);e[0]=z(h,n[0]);e[3]=r(h,n[1]);e[2]=z(h,
n[2]);e[1]=r(h,n[3]);return e};d.quantizeCoordsArrayXY=G;d.quantizeCoordsArrayXYM=Q;d.quantizeCoordsArrayXYZ=O;d.quantizeCoordsArrayXYZM=Z;d.quantizeExtent=w;d.quantizeGeometry=function(h,e){return h&&e?g.isPoint(e)?q(h,{},e):g.isPolyline(e)?f(h,{},e):g.isPolygon(e)?I(h,{},e):g.isMultipoint(e)?b(h,{},e):g.isExtent(e)?w(h,{},e):null:null};d.quantizeM=a;d.quantizeMultipoint=b;d.quantizePoint=q;d.quantizePolygon=I;d.quantizePolyline=f;d.quantizeX=z;d.quantizeY=r;d.quantizeZ=M;d.toQuantizationTransform=
function(h){return h?{originPosition:"upper-left"===h.originPosition?"upperLeft":"lower-left"===h.originPosition?"lowerLeft":h.originPosition,scale:h.tolerance?[h.tolerance,h.tolerance,1,1]:[1,1,1,1],translate:null!=h.extent?[h.extent.xmin,h.extent.ymax,h.extent.zmin??0,h.extent.mmin??0]:[0,0,0,0]}:null};d.unquantizeBounds=function(h,e,n){h=u(h);return n?(e[0]=k(h,n[0]),e[1]=y(h,n[3]),e[2]=k(h,n[2]),e[3]=y(h,n[1]),e):[k(h,e[0]),y(h,e[3]),k(h,e[2]),y(h,e[1])]};d.unquantizeCoordsArrayArray=t;d.unquantizeCoordsArrayXY=
U;d.unquantizeCoordsArrayXYM=x;d.unquantizeCoordsArrayXYZ=T;d.unquantizeCoordsArrayXYZM=R;d.unquantizeExtent=function(h,e,n,A=n.hasZ??!1,P=n.hasM??!1){h=u(h);e.xmin=k(h,n.xmin);e.xmax=k(h,n.xmax);e.ymin=y(h,n.ymin);e.ymax=y(h,n.ymax);A&&(e.zmin=v(h,n.zmin),e.zmax=v(h,n.zmax));P&&(e.mmin=D(h,n.mmin),e.mmax=D(h,n.mmax));e.hasZ=A;e.hasM=P;return e};d.unquantizeM=D;d.unquantizeMultipoint=function(h,e,n,A=n?.hasZ??!1,P=n?.hasM??!1){null!=n&&(h=u(h),e.points=F(A,P)(h,n.points),e.hasZ=A,e.hasM=P);return e};
d.unquantizePoint=function(h,e,n,A=null!=n?.z,P=null!=n?.m){if(null==n)return e;h=u(h);e.x=k(h,n.x);e.y=y(h,n.y);A&&(e.z=v(h,n.z));P&&(e.m=D(h,n.m));return e};d.unquantizePolygon=function(h,e,n,A=n?.hasZ??!1,P=n?.hasM??!1){null!=n&&(h=u(h),e.rings=t(h,F(A,P),n.rings),e.hasZ=A,e.hasM=P);return e};d.unquantizePolyline=function(h,e,n,A=n?.hasZ??!1,P=n?.hasM??!1){null!=n&&(h=u(h),e.paths=t(h,F(A,P),n.paths),e.hasZ=A,e.hasM=P);return e};d.unquantizeX=k;d.unquantizeY=y;d.unquantizeZ=v;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),function(d,g,u,z,r,M){class a{constructor(p,k,y){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=p.returnDistinctValues??!1;this.fieldsIndex=y;this.featureAdapter=k;if((k=p.outFields)&&
!k.includes("*")){this.outFields=k;p=0;for(const D of k){var v=d.getExpressionFromFieldName(D);v=(k=this.fieldsIndex.get(v))?null:d.getWhereClause(v,y);k=k?k.name:d.getAliasFromFieldName(D)||`FIELD_EXP_${p++}`;this._fieldDataCache.set(D,{alias:k,clause:v})}}}countDistinctValues(p){if(!this.returnDistinctValues)return p.length;p.forEach(k=>this.getAttributes(k));return this._returnDistinctMap.size}getAttributes(p){p=this._processAttributesForOutFields(p);return this._processAttributesForDistinctValues(p)}getFieldValue(p,
k,y){const v=y?y.name:k;let D=null;this._fieldDataCache.has(v)?D=this._fieldDataCache.get(v)?.clause:y||(D=d.getWhereClause(k,this.fieldsIndex),this._fieldDataCache.set(v,{alias:v,clause:D}));return y?this.featureAdapter.getAttribute(p,v):D?.calculateValue(p,this.featureAdapter)}getDataValues(p,k,y=!0){const v=k.normalizationType,D=k.normalizationTotal,F=this.fieldsIndex.get(k.field),t=u.isDateOnlyField(F)||u.isTimestampOffsetField(F),J=u.isTimeOnlyField(F);return p.map(L=>{let w=k.field&&this.getFieldValue(L,
k.field,this.fieldsIndex.get(k.field));k.field2?(w=`${r.processNullValue(w)}${k.fieldDelimiter}${r.processNullValue(this.getFieldValue(L,k.field2,this.fieldsIndex.get(k.field2)))}`,k.field3&&(w=`${w}${k.fieldDelimiter}${r.processNullValue(this.getFieldValue(L,k.field3,this.fieldsIndex.get(k.field3)))}`)):"string"===typeof w&&y&&(t?w=w?(new Date(w)).getTime():null:J&&(w=w?z.timeOnlyToMilliseconds(w):null));v&&Number.isFinite(w)&&(L="field"===v&&k.normalizationField?this.getFieldValue(L,k.normalizationField,
this.fieldsIndex.get(k.normalizationField)):null,w=r.getNormalizedValue(w,v,L,D));return w})}async getExpressionValues(p,k,y,v,D){const {arcadeUtils:F}=await M.loadArcade(),t=F.hasGeometryOperations(k);t&&await F.enableGeometryOperations();const J=F.createFunction(k),L=F.getViewInfo(y),w={fields:this.fieldsIndex.fields};return p.map(b=>{b={attributes:this.featureAdapter.getAttributes(b),layer:w,geometry:t?{...g.getGeometry(v.geometryType,v.hasZ,v.hasM,this.featureAdapter.getGeometry(b)),spatialReference:y?.spatialReference}:
null};b=F.createExecContext(b,L,D);return F.executeFunction(J,b)})}validateItem(p,k){this._fieldDataCache.has(k)||this._fieldDataCache.set(k,{alias:k,clause:d.getWhereClause(k,this.fieldsIndex)});return this._fieldDataCache.get(k)?.clause?.testFeature(p,this.featureAdapter)??!1}validateItems(p,k){this._fieldDataCache.has(k)||this._fieldDataCache.set(k,{alias:k,clause:d.getWhereClause(k,this.fieldsIndex)});return this._fieldDataCache.get(k)?.clause?.testSet(p,this.featureAdapter)??!1}_processAttributesForOutFields(p){const k=
this.outFields;if(!k?.length)return this.featureAdapter.getAttributes(p);const y={};for(const v of k){const {alias:D,clause:F}=this._fieldDataCache.get(v);y[D]=F?F.calculateValue(p,this.featureAdapter):this.featureAdapter.getAttribute(p,D)}return y}_processAttributesForDistinctValues(p){if(null==p||!this.returnDistinctValues)return p;var k=this.outFields,y=[];if(k)for(const D of k){var {alias:v}=this._fieldDataCache.get(D);y.push(p[v])}else for(v in p)y.push(p[v]);k=`${(k||["*"]).join(",")}=${y.join(",")}`;
y=this._returnDistinctMap.get(k)||0;this._returnDistinctMap.set(k,++y);return 1<y?null:p}}return a})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t){function J(f){f=I.exec(f);if(!f)return null;const {hh:G,mm:O,ss:Q,ms:Z}=f.groups;return Number(G)*r.millisecondsPerTimeUnit.hours+Number(O)*r.millisecondsPerTimeUnit.minutes+Number(Q)*r.millisecondsPerTimeUnit.seconds+Number(Z||0)}function L(f,G){f=null!=f?f:"";null!=G&&G&&(f=f?"("+f+") AND ("+G+")":G);return f}function w(f){const G=f.layer;return f.fields.filter(O=>!G.getField(O))}function b(f){const G=f.layer;return f.fields.filter(O=>{O=G.getFieldUsageInfo(O);
return!O||!O.supportsStatistics})}let q=null;const I=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;d.calculateHeatmapStats=function(f,G=18,O,Q,Z){const U=new Float64Array(Q*Z);G=Math.round(z.pt2px(G));let T=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;O=y.createValueFunction(O);for(const {geometry:e,attributes:n}of f){const {x:A,y:P}=e;f=Math.max(0,A-G);var R=Math.max(0,P-G);const X=Math.min(Z,P+G),ca=Math.min(Q,A+G),ja=+O(n);for(;R<X;R++)for(let qa=
f;qa<ca;qa++){var h=R*Q+qa;const sa=y.evaluateDensityKernel(qa-A,R-P,G)*ja;h=U[h]+=sa;T=Math.min(T,h);x=Math.max(x,h)}}return{min:T,max:x}};d.getDataValues=async function(f,G,O=!0){if(!G)return[];const {field:Q,field2:Z,field3:U,fieldDelimiter:T,fieldInfos:x,timeZone:R}=f;var h=Q&&x?.find(fa=>fa.name.toLowerCase()===Q.toLowerCase());const e=h?k.isTimeOnlyField(h):!1,n=h?v.isAnyDateField(h):!1,A=f.valueExpression,P=f.normalizationType,X=f.normalizationField,ca=f.normalizationTotal,ja=[];h=f.viewInfoParams;
let qa=null,sa=null;if(A){if(!q){const {arcadeUtils:fa}=await F.loadArcade();q=fa}q.hasGeometryOperations(A)&&await q.enableGeometryOperations();qa=q.createFunction(A);sa=h?q.getViewInfo({viewingMode:h.viewingMode,scale:h.scale,spatialReference:new M(h.spatialReference)}):null}f=f.fieldInfos;const da=G[0]&&"declaredClass"in G[0]&&"esri.Graphic"===G[0].declaredClass||!f?null:{fields:f};G.forEach(fa=>{var na=fa.attributes;if(A){var ra=q.createExecContext(da?{...fa,layer:da}:fa,sa,R);ra=q.executeFunction(qa,
ra)}else na&&(ra=na[Q],Z?(ra=`${D.processNullValue(ra)}${T}${D.processNullValue(na[Z])}`,U&&(ra=`${ra}${T}${D.processNullValue(na[U])}`)):"string"===typeof ra&&O&&(n?ra=ra?(new Date(ra)).getTime():null:e&&(ra=ra?J(ra):null)));P&&"number"===typeof ra&&isFinite(ra)&&(na=na&&parseFloat(na[X]),ra=D.getNormalizedValue(ra,P,na,ca));ja.push(ra)});return ja};d.getRangeExpr=function(f,G,O){G=null!=G?f+" \x3e\x3d "+G:"";f=null!=O?f+" \x3c\x3d "+O:"";O="";return(O=G&&f?L(G,f):G||f)?"("+O+")":""};d.getSQLFilterForNormalization=
function(f){const G=f.field,O=f.normalizationType;f=f.normalizationField;let Q;if("field"===O)Q="(NOT "+f+" \x3d 0)";else if("log"===O||"natural-log"===O||"square-root"===O)Q=`(${G} > 0)`;return Q};d.getSumOfAttributesExpr=function(f,G,O){const Q=[],Z=[],U=[],T=[],x=[];f.forEach((h,e)=>{const n=h.field?"field":"expression",A=h.field||h.valueExpression;h.field?(x.push(A),Z.push(`var ${n}${e} = Number($feature["${A}"]);`)):(Q.push(`function getValueForExpr${e}() {\n  ${A} \n}`),Z.push(`var ${n}${e} = Number(getValueForExpr${e}());`));
O||U.push(`${n}${e} = IIf(${n}${e} < 0, 0, ${n}${e});`);T.push(`${n}${e}`)});f=Q.length?null:x.reduce((h,e)=>`${h} + ${e}`);let R=null;G||O?G?O||f&&(R=`(( ${f} ) >= 0)`):f&&(R=`(( ${f} ) <> 0)`):f&&(R=`(( ${f} ) > 0)`);return{valueExpression:[Q.length?Q.join("\n"):"",Z.join("\n"),U.join("\n"),`var total = ${T.join(" + ")};`,"return total;"].filter(Boolean).join("\n\n"),sqlExpression:f,sqlWhere:R}};d.mergeWhereClauses=L;d.quantizeFeatures=function(f,G,O,Q){const Z=p.isWrappable(O)?p.getInfo(O):null,
U=Z?Math.round((Z.valid[1]-Z.valid[0])/G.scale[0]):null;return f.map(T=>{const x=new t(T.geometry);a.quantizePoint(G,x,x);if(Z){var R=U??0,h=Q[0];0>x.x?x.x+=R:x.x>h&&(x.x-=R)}T.geometry=x;return T})};d.timeOnlyToMilliseconds=J;d.verifyBasicFieldValidity=function(f,G,O){const Q=w({layer:f,fields:G});if(Q.length)return new u(O,"Unknown fields: "+Q.join(", ")+". You can only use fields defined in the layer schema");f=b({layer:f,fields:G});if(f.length)return new u(O,"Unsupported fields: "+f.join(", ")+
". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};d.verifyFieldType=function(f,G,O,Q){let Z;G?G.name!==f.objectIdField&&Q.includes(G.type)||(Z=new u(O,"'field' should be one of these types: "+Q.join(","))):Z=new u(O,"'field' is not defined in the layer schema");return Z};d.verifyFilterValidity=function(f,G){if(f&&"intersects"!==f.spatialRelationship)return new u(G,"Only 'intersects' spatialRelationship is supported for featureFilter")};d.verifyNumericField=
function(f,G,O){let Q;G?G.name!==f.objectIdField&&k.isNumericField(G)||(Q=new u(O,"'field' should be one of these numeric types: "+k.numericTypes.join(","))):Q=new u(O,"'field' is not defined in the layer schema");return Q};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(d){function g(r){return r?72*r/96:0}function u(r=0,M=0){return{x:r,y:M}}const z=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;d.castRenderScreenPointArray=function(r){return r};
d.castRenderScreenPointArray3=function(r){return r};d.castScreenPointArray=function(r){return r};d.cloneScreenPoint=function(r){return r?u(r.x,r.y):null};d.createRenderScreenPoint=function(r=0,M=0){return{x:r,y:M}};d.createRenderScreenPointArray=function(r=0,M=0){return[r,M]};d.createRenderScreenPointArray3=function(r=0,M=0,a=0){return[r,M,a]};d.createScreenPoint=u;d.createScreenPointArray=function(r=0,M=0){return[r,M]};d.pt2px=function(r){return r?r/72*96:0};d.px2pt=g;d.screenPointArrayToObject=
function(r,M){return M?(M.x=r[0],M.y=r[1],M):{x:r[0],y:r[1]}};d.screenPointObjectToArray=function(r,M){return M?(M[0]=r.x,M[1]=r.y,2<M.length&&(M[2]=0),M):[r.x,r.y]};d.toPt=function(r){if("string"===typeof r){var M=r.match(z);if(M){var a=Number(M[1]);M=M[3]&&M[3].toLowerCase();r="-"===r.charAt(0);a="px"===M?g(a):a;return r?-a:a}console.warn("screenUtils.toPt: input not recognized!");return null}return r};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(d,g,u,z){function r(p,k,y){return 0===p?0:p*a[k]/a[y]}function M(p){switch(p){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const a={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};d.convertTime=r;d.isValidDate=function(p){return p instanceof Date&&!isNaN(p.getTime())};d.makeUTCTime=function(p,k,y="milliseconds"){k=new Date(r(k,y,"milliseconds"));k.setUTCFullYear(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate());return k};d.mergeTimeExtents=function(p,k){return p&&k?p.intersection(k):p||k};d.millisecondsPerTimeUnit=a;d.offsetDate=function(p,k,y,v=u.system){v=new z.IANAZone(g.resolveTimeZone(v));p=z.DateTime.fromJSDate(p,{zone:v});v="decades"===y||"centuries"===
y?"year":M(y);"decades"===y&&(k*=10);"centuries"===y&&(k*=100);return p.plus({[v]:k}).toJSDate()};d.offsetDateUTC=function(p,k,y="milliseconds"){p=p.getTime();k=r(k,y,"milliseconds");return new Date(p+k)};d.resetUTCDate=function(p,k){p=new Date(p.getTime());p.setUTCFullYear(k.getFullYear(),k.getMonth(),k.getDate());return p};d.timeSinceUTCMidnight=function(p,k="milliseconds"){const y=r(p.getUTCHours(),"hours","milliseconds"),v=r(p.getUTCMinutes(),"minutes","milliseconds"),D=r(p.getUTCSeconds(),"seconds",
"milliseconds");p=p.getUTCMilliseconds();return r(y+v+D+p,"milliseconds",k)};d.truncateDate=function(p,k,y=u.system){y=new z.IANAZone(g.resolveTimeZone(y));p=z.DateTime.fromJSDate(p,{zone:y});if("decades"===k||"centuries"===k)return p=p.startOf("year"),{year:y}=p,p.set({year:y-y%("decades"===k?10:100)}).toJSDate();k=M(k);return p.startOf(k).toJSDate()};d.truncateLocalTime=function(p){const k=new Date(0);k.setHours(0);k.setMinutes(0);k.setSeconds(0);k.setMilliseconds(0);k.setFullYear(p.getUTCFullYear(),
p.getUTCMonth(),p.getUTCDate());return k};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(d,g,u,z,r){function M(a,p,k,y){let {color:v,ratio:D}=p,{color:F,ratio:t}=k;t===D&&(1===t?D-=1E-6:t+=1E-6);p=g.clamp((y-D)/(t-D),0,1);z.lerp(a,v.toArray(),F.toArray(),p)}d.createValueFunction=function(a){return"function"===
typeof a?a:a?p=>+p[a]:()=>1};d.evaluateDensityKernel=function(a,p,k){a=Math.sqrt(a**2+p**2)/k;return 1<a?0:3/(Math.PI*k**2)*(1-a**2)**2};d.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(a){return u.px2pt(2.4*a)};d.generateGradient=function(a){const p=new Uint8ClampedArray(2048);a=a.filter(({ratio:F})=>0<=F&&1>=F).sort((F,t)=>F.ratio-t.ratio).map(({color:F,ratio:t})=>({color:F,ratio:Math.max(t,.001)}));if(1>a.length)return p;let k=a[0],y=a[0],v=1;const D=r.create();for(let F=0;512>F;F++){const t=
(F+.5)/512;for(;t>y.ratio&&v<a.length;)k=y,y=a[v++];M(D,k,y,t);p.set(D,4*F)}return p};d.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(a){return u.pt2px(a)/2.4};d.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(d,g,u,z,r,M){function a(t){return String(t).padStart(2,
"0")}function p(t,J,L){if("date"===J||"number"===J){"number"===J&&(t=new Date(t));J=L?t.getFullYear():t.getUTCFullYear();const w=a((L?t.getMonth():t.getUTCMonth())+1),b=a(L?t.getDate():t.getUTCDate()),q=a(L?t.getHours():t.getUTCHours()),I=a(L?t.getMinutes():t.getUTCMinutes());t=a(L?t.getSeconds():t.getUTCSeconds());t=`TIMESTAMP'${J}-${w}-${b} ${q}:${I}:${t}'`}return t}function k(t,J){if(J instanceof Date)return"date";if("number"===typeof J)return"number";if("string"===typeof J&&(t=t.getField(J),"\x3cnow\x3e"!==
J.toLowerCase()&&u.isDateField(t)))return"field"}const y={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},v={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},D=new Set(["integer","small-integer"]);let F=null;d.castIntegerFieldToFloat=function(t){return`cast(${t} as float)`};d.dateTypes=
["date","date-only","timestamp-offset"];d.defaultBasemapGroups=y;d.defaultStatisticTypes={exclude:["median"]};d.fieldDelimiter=",";d.formatAnyDate=function(t,J){const {format:L,timeZoneOptions:w,fieldType:b}=J??{};let q;w&&({timeZone:I,timeZoneName:q}=M.getTimeZoneFormattingOptions(w.layerTimeZone,w.datesInUnknownTimezone,w.viewTimeZone,g.convertDateFormatToIntlOptions(L||"short-date-short-time"),b));if("string"===typeof t&&isNaN(Date.parse("time-only"===b?`1970-01-01T${t}Z`:t)))return t;switch(b){case "date-only":var I=
g.convertDateFormatToIntlOptions(L||"short-date");return"string"===typeof t?g.formatDateOnly(t,{...I}):g.formatDate(t,{...I,timeZone:M.utc});case "time-only":return I=g.convertDateFormatToIntlOptions(L||"short-time"),"string"===typeof t?g.formatTimeOnly(t,I):g.formatDate(t,{...I,timeZone:M.utc});case "timestamp-offset":if(!I&&"string"===typeof t&&(new Date(t)).toISOString()!==t)return t;I=(J=L||w?g.convertDateFormatToIntlOptions(L||"short-date-short-time"):void 0)?{...J,timeZone:I,timeZoneName:q}:
void 0;return"string"===typeof t?g.formatTimestamp(t,I):g.formatDate(t,I);default:return J=L||w?g.convertDateFormatToIntlOptions(L||"short-date-short-time"):void 0,g.formatDate("string"===typeof t?new Date(t):t,J?{...J,timeZone:I,timeZoneName:q}:void 0)}};d.getBasemapGroup=function(t,J=y){for(const L in J)if(J[L].includes(t))return L};d.getBasemapId=function(t,J,L=!0){let w=null;t&&("string"===typeof t?J.includes(t)&&(w=t):w=r.getWellKnownBasemapId(t));return L?w||"gray":w};d.getDateDiffSQL=function(t,
J,L,w){const {hasQueryEngine:b}=t;L=p(L,k(t,L),b);t=p(J,k(t,J),b);t=`(${L} - ${t})`;w=v[w];J="/";1>w&&(w=1/w,J="*");return{sqlExpression:1===w?t:`(${t} ${J} ${w})`,sqlWhere:null}};d.getDateType=k;d.getFieldsList=async function(t){const {field:J,field2:L,field3:w,normalizationField:b,valueExpression:q}=t;t=[];q&&(F||({arcadeUtils:t}=await z.loadArcade(),F=t),t=F.extractFieldNames(q));J&&t.push(J);L&&t.push(L);w&&t.push(w);b&&t.push(b);return t};d.getNormalizationType=function(t){let J=t.normalizationType;
J||(t.normalizationField?J="field":null!=t.normalizationTotal&&(J="percent-of-total"));return J??void 0};d.isAnyDateField=function(t){return u.isDateField(t)||u.isDateOnlyField(t)||u.isTimestampOffsetField(t)};d.isIntegerField=function(t,J){t=J&&t.getField(J);return!!t&&D.has(t.type)};d.unitValueInDays=v;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(d,g,u,z,r,M,a,p,k,y){function v(h,e){let n;if("string"===typeof h){const A=h in y.esriBasemapDefinitions,P=!A&&h.includes("/");if(!A&&!P)return u.apiKey?T().warn(`Unable to find basemap definition for: ${h}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`):(e=Object.entries(y.esriBasemapDefinitions).filter(([,X])=>X.classic||X.is3d).map(([X])=>`"${X}"`).sort().join(", "),T().warn(`Unable to find basemap definition for: ${h}. Try one of these: ${e}`)),null;e&&(n=
e[h]);n||(n=A?g.fromId(h):new g({style:{id:h}}),e&&(e[h]=n))}else n=p.ensureType(g,h);n?.destroyed&&(T().warn("The provided basemap is already destroyed",{basemap:n}),n=null);return n}function D(h){if(x)return x(h);let e=null;h=L(h);const n=!h?.baseLayers.length;for(const P in y.esriBasemapDefinitions){var A=I(y.esriBasemapDefinitions[P]);A=G(h,A,{mustMatchReferences:n});if("equal"===A){e=P;break}"base-layers-equal"===A&&(e=P)}return e}function F(h,e){const n=new z;h.forEach(A=>{const P=e.find(X=>
"scene"!==X.type&&Q(b(A),b(X)))||A;n.includes(P)?n.push(A):n.push(P)});return n}function t(h){if(J(h.url))return!0;if("vector-tile"===h.type)for(const e in h.sourceNameToSource)if(J(h.sourceNameToSource[e]?.sourceUrl))return!0;return!1}function J(h){if(!h)return!1;h=new a.Url(a.makeAbsolute(h));return!!h.authority&&R.test(h.authority)}function L(h){return h?!h.loaded&&h.resourceInfo?I(h.resourceInfo.data):{baseLayers:w(h.baseLayers),referenceLayers:w(h.referenceLayers)}:null}function w(h){return(z.isCollection(h)?
h.toArray():h).map(b)}function b(h){return{type:h.type,effect:"effect"in h?h.effect:void 0,url:Z("urlTemplate"in h&&h.urlTemplate||h.url||"styleUrl"in h&&h.styleUrl||""),minScale:"minScale"in h&&null!=h.minScale?h.minScale:0,maxScale:"maxScale"in h&&null!=h.maxScale?h.maxScale:0,opacity:null!=h.opacity?h.opacity:1,visible:null!=h.visible?!!h.visible:!0,sublayers:"map-image"!==h.type&&"wms"!==h.type||null==h.sublayers?void 0:h.sublayers?.map(e=>({id:e.id,visible:e.visible})),activeLayerId:"wmts"===
h.type?h.activeLayer?.id:void 0}}function q(h){return h.isReference||"ArcGISSceneServiceLayer"===h.layerType}function I(h){return h?{baseLayers:f((h.baseMapLayers??[]).filter(e=>!q(e))),referenceLayers:f((h.baseMapLayers??[]).filter(e=>q(e)))}:null}function f(h){return h.map(e=>{let n;switch(e.layerType){case "VectorTileLayer":n="vector-tile";break;case "ArcGISTiledMapServiceLayer":n="tile";break;case "ArcGISSceneServiceLayer":n="scene";break;default:n="unknown"}return{type:n,effect:e.effect,url:Z(e.templateUrl||
e.urlTemplate||e.styleUrl||e.url),minScale:e.minScale??0,maxScale:e.maxScale??0,opacity:e.opacity??1,visible:null!=e.visibility?!!e.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function G(h,e,n){return null!=h!==(null!=e)?"not-equal":h&&e?O(h.baseLayers,e.baseLayers)?O(h.referenceLayers,e.referenceLayers)?"equal":n.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function O(h,e){if(h.length!==e.length)return!1;for(let n=0;n<h.length;n++)if(!Q(h[n],e[n]))return!1;return!0}
function Q(h,e){if(h.type!==e.type||h.url!==e.url||h.minScale!==e.minScale||h.maxScale!==e.maxScale||h.visible!==e.visible||h.opacity!==e.opacity||!k.effectEquals(h.effect,e.effect))return!1;if(null!=h.activeLayerId||null!=e.activeLayerId)return h.activeLayerId===e.activeLayerId;if(null!=h.sublayers||null!=e.sublayers){if(null==h.sublayers||null==e.sublayers||h.sublayers.length!==e.sublayers.length)return!1;for(let n=0;n<h.sublayers.length;n++){const A=h.sublayers.at(n),P=e.sublayers.at(n);if(A?.id!==
P?.id||A?.visible!==P?.visible)return!1}}return!0}function Z(h){return h?a.normalize(h).replace(/^\s*https?:/i,"").toLowerCase():""}function U(h){return"portalItem"in h?h.portalItem?.thumbnailUrl:void 0}const T=()=>r.getLogger("esri.support.basemapUtils");let x;const R=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;d.clonePreservingTiledLayers=function(h,e=null){h=v(h);if(!h)return null;h=h.clone();e&&(h.baseLayers=F(h.baseLayers,e.baseLayers),h.referenceLayers=F(h.referenceLayers,e.referenceLayers));
return h};d.contentEquals=function(h,e){if(h===e||null!=h?.portalItem?.id&&h.portalItem.id===e?.portalItem?.id)return!0;h=L(h);e=L(e);return"equal"===G(h,e,{mustMatchReferences:!0})};d.createCache=function(){return{}};d.destroyCache=function(h){for(const e in h)M.destroyMaybe(h[e]),delete h[e]};d.ensureType=v;d.findSpatialReference=function(h,e){if(null==e||null==h)return{spatialReference:null,updating:!1};if("not-loaded"===e.loadStatus)return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,
updating:!1};if(0===e.baseLayers.length)return{spatialReference:null,updating:!1};e=e.baseLayers.at(0);switch(e.loadStatus){case "not-loaded":e.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}e=(("supportedSpatialReferences"in e?e.supportedSpatialReferences:null)||["tileInfo"in e?e.tileInfo?.spatialReference:e.spatialReference]).filter(Boolean);const n=h.spatialReference;return n?{spatialReference:e.find(A=>n.equals(A))??e[0]??
null,updating:!1}:{spatialReference:e[0],updating:!1}};d.getBasemapThumbnailUrl=function(h){if(!h)return null;var {thumbnailUrl:e}=h;return e?e:(e=D(h))?y.esriBasemapDefinitions[e].thumbnailUrl:M.mappedFind(h.baseLayers,U)};d.getWellKnownBasemapId=D;d.hasDeveloperBasemapLayer=function(h){return!!h?.baseLayers.concat(h.referenceLayers).some(t)};d.isBasemap3D=function(h){return"Web Scene"===h.portalItem?.type||h.referenceLayers.some(e=>"scene"===e.type)};d.isBasemapInBeta=function(h){return!!h?.portalItem?.tags?.some(e=>
"beta"===e.toLowerCase())};d.isBasemapLayer=function(h,e){return h.basemap?.referenceLayers?.some(n=>n.uid===e)||h.basemap?.baseLayers?.some(n=>n.uid===e)};d.isDeveloperBasemapLayer=t;d.overrideGetWellKnownBasemapId=function(h){x=h};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J,L,w,b,q,I,f,G,O){var Q;let Z=0;M=Q=class extends M.JSONSupportMixin(p){constructor(x){super(x);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+Z++;this.baseLayers=new z;this.referenceLayers=new z;const R=h=>{h.parent&&h.parent!==this&&"remove"in h.parent&&h.parent.remove(h);h.parent=this;"elevation"===h.type&&y.getLogger(this).error(`Layer '${h.title}, id:${h.id}' of type '${h.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",h=>R(h.item)),this.referenceLayers.on("after-add",h=>R(h.item)),this.baseLayers.on("after-remove",h=>{h.item.parent=null}),this.referenceLayers.on("after-remove",h=>{h.item.parent=null})])}initialize(){this.when().catch(x=>{y.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,x)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var x=this.baseLayers.toArray();for(const R of x)R.destroy();
x=this.referenceLayers.toArray();for(const R of x)R.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=v.destroyMaybe(this.portalItem)}normalizeCtorArgs(x){x&&"resourceInfo"in x&&(this._set("resourceInfo",x.resourceInfo),x={...x},delete x.resourceInfo);return x}set baseLayers(x){this._set("baseLayers",r.referenceSetter(x,this._get("baseLayers")))}_writeBaseLayers(x,R,h){const e=[];x&&(h={...h,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{n=O.getLayerJSON(n,
h.webmap?h.webmap.getLayerJSONFromResourceInfo(n):null,h);null!=n&&e.push(n)}),this.referenceLayers.forEach(n=>{const A=O.getLayerJSON(n,h.webmap?h.webmap.getLayerJSONFromResourceInfo(n):null,h);null!=A&&("scene"!==n.type&&(A.isReference=!0),e.push(A))}));R.baseMapLayers=e}set referenceLayers(x){this._set("referenceLayers",r.referenceSetter(x,this._get("referenceLayers")))}writeTitle(x,R){R.title=x||"Basemap"}load(x){this.addResolvingPromise(this._loadFromSource(x));return Promise.resolve(this)}loadAll(){return k.loadAll(this,
x=>{x(this.baseLayers,this.referenceLayers)})}clone(){const x={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(R=>a.isClonable(R)?R.clone():R),referenceLayers:this.referenceLayers.map(R=>a.isClonable(R)?R.clone():R)};this.loaded&&(x.loadStatus="loaded");return(new Q({resourceInfo:this.resourceInfo})).set(x)}read(x,R){this.resourceInfo||this._set("resourceInfo",{data:x,context:R});super.read(x,R)}write(x,R){x=x||{};R?.origin||(R={origin:"web-map",...R});super.write(x,
R);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(x.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(h=>{h=a.clone(h);h.url&&F.isProtocolRelative(h.url)&&(h.url=`https:${h.url}`);h.templateUrl&&F.isProtocolRelative(h.templateUrl)&&(h.templateUrl=`https:${h.templateUrl}`);return h}));return x}async _loadFromSource(x){const {resourceInfo:R,portalItem:h,style:e}=this;D.throwIfAborted(x);const n=[];R?(n.push(this._loadLayersFromJSON(R.data,R.context?R.context.url:null,x)),R.data.id&&!R.data.title&&
n.push(f.getBasemapTitle(R.data.id).then(A=>{A&&this.read({title:A},R.context)}))):h?n.push(this._loadFromItem(h,x)):e&&n.push(this._loadFromStylesService(e,x));await Promise.all(n)}async _loadLayersFromJSON(x,R,h){const e=this.resourceInfo?.context,n=this.portalItem?.portal||e?.portal||null,A=T[e?.origin||""]??"web-map",{populateOperationalLayers:P}=await new Promise((ca,ja)=>d(["./layers/support/layersCreator"],ca,ja)),X=[];D.throwIfAborted(h);if(x.baseMapLayers&&Array.isArray(x.baseMapLayers)){R=
{context:{...e,origin:A,url:R,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const ca=ja=>"web-scene"===A&&"ArcGISSceneServiceLayer"===ja.layerType||ja.isReference;h=P(this.baseLayers,x.baseMapLayers.filter(ja=>!ca(ja)),R);X.push(h);x=P(this.referenceLayers,x.baseMapLayers.filter(ca),R);X.push(x)}await Promise.allSettled(X)}async _loadFromItem(x,R){const h=await (await x.load(R)).fetchData("json",R),e=F.urlToObject(x.itemUrl??"");this._set("resourceInfo",{data:h.baseMap??
{},context:{origin:U[x.type||""]??"web-map",portal:x.portal||q.getDefault(),url:e}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:h.spatialReference},this.resourceInfo.context);this.read({title:x.title,thumbnailUrl:x.thumbnailUrl},{origin:"portal-item",portal:x.portal||q.getDefault(),url:e});return this._loadLayersFromJSON(this.resourceInfo.data,e,R)}async _loadFromStylesService(x,R){var h=`${x.serviceUrl}/${x.id}`;const e=(await u(h,{query:{language:x.getLanguageParamValue(),
places:x.places,worldview:x.worldview,token:x.apiKey},signal:R?.signal})).data;h=F.urlToObject(h);this._set("resourceInfo",{data:e.baseMap??{},context:{origin:"web-map",url:h}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:e.spatialReference},this.resourceInfo.context);await this._loadLayersFromJSON(this.resourceInfo.data,h,R);if(x.apiKey)for(const n of[...this.baseLayers,...this.referenceLayers])"apiKey"in n&&(n.apiKey=x.apiKey)}static fromId(x){return(x=
f.esriBasemapDefinitions[x])?x.itemId?new Q({portalItem:{id:x.itemId,portal:{url:"https://www.arcgis.com"}}}):Q.fromJSON(x,{origin:x.is3d?"web-scene":"web-map"}):null}};g.__decorate([t.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(x,R,h,e){this._writeBaseLayers(x,R,e)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:z}},writer(x,R,h,e){this._writeBaseLayers(x,R,e)}}}}}})],M.prototype,"baseLayers",null);g.__decorate([t.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],
M.prototype,"id",void 0);g.__decorate([t.property({type:I})],M.prototype,"portalItem",void 0);g.__decorate([t.property()],M.prototype,"referenceLayers",null);g.__decorate([t.property({readOnly:!0})],M.prototype,"resourceInfo",void 0);g.__decorate([t.property({type:b})],M.prototype,"spatialReference",void 0);g.__decorate([t.property({type:G})],M.prototype,"style",void 0);g.__decorate([t.property()],M.prototype,"thumbnailUrl",void 0);g.__decorate([t.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],
M.prototype,"title",void 0);g.__decorate([w.writer("title")],M.prototype,"writeTitle",null);M=Q=g.__decorate([L.subclass("esri.Basemap")],M);const U={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return M})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(d,g){d.castForReferenceSetter=function(u){return u};d.referenceSetter=function(u,z,r=g){z||=new r;if(z===u)return z;
z.removeAll();u&&(Array.isArray(u)||"items"in u&&Array.isArray(u.items))?z.addMany(u):u&&z.add(u);return z};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(d,g,u,z,r,M,a,p){const k=y=>{y=class extends y{constructor(...v){super(...v);this.loadError=this._loadController=null;this.loadStatus=
"not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(D=>{const F=this.load.bind(this);this.load=t=>{const J=new Promise((L,w)=>{const b=r.onAbortOrThrow(t,w);this.destroyed&&w(new g("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(L,w).finally(()=>{b&&b.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const L=this._loadController=new AbortController;F({signal:L.signal})}D();
return J}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},D=>{this._set("loadStatus","failed");this._set("loadError",D);this._loadController=null})}destroy(){this._loadController&&(this._loadController=u.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new g("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};d.__decorate([a.property({readOnly:!0})],y.prototype,"loaded",null);d.__decorate([a.property({readOnly:!0})],y.prototype,"loadError",void 0);d.__decorate([a.property({clonable:!1})],y.prototype,"loadStatus",void 0);d.__decorate([a.property({type:[M],readOnly:!0})],y.prototype,"loadWarnings",null);return y=d.__decorate([p.subclass("esri.core.Loadable")],y)};z=class extends k(z.EsriPromise){};
z=d.__decorate([p.subclass("esri.core.Loadable")],z);(function(y){y.LoadableMixin=k;y.isLoadable=function(v){return!(!v||!v.load)}})(z||={});return z})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(d,g,u,z,r){var M;(function(k){k[k.PENDING=0]="PENDING";k[k.RESOLVED=1]="RESOLVED";k[k.REJECTED=2]="REJECTED"})(M||={});class a{constructor(){this._resolver=z.createResolver();this._status=M.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=M.RESOLVED;this._cleanUp()},()=>{this._status=M.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(k){this._resolvingPromises.push(k);this._tryResolve()}isResolved(){return this._status===M.RESOLVED}isRejected(){return this._status===M.REJECTED}isFulfilled(){return this._status!==M.PENDING}abort(){this._resolver.reject(z.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var k=z.createResolver(),y=[...this._resolvingPromises,k.promise],v=this._allPromise=Promise.all(y);v.then(()=>{this.isFulfilled()||this._allPromise!==v||this._resolver.resolve()},D=>{this.isFulfilled()||this._allPromise!==v||z.isAbortError(D)||this._resolver.reject(D)});k.resolve()}}}const p=k=>{k=class extends k{constructor(...y){super(...y);this._promiseProps=new a;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(y,
v){return this._promiseProps.promise.then(()=>this).then(y,v)}catch(y){return this.when(null,y)}addResolvingPromise(y){y&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in y?y.when():y)}};return k=g.__decorate([r.subclass("esri.core.Promise")],k)};d.EsriPromise=class extends p(u){};d.EsriPromise=g.__decorate([r.subclass("esri.core.Promise")],d.EsriPromise);d.EsriPromiseMixin=p;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(d,g,u,z){async function r(M,a){const p=[],k=(...v)=>{for(const D of v)null!=D&&(Array.isArray(D)?k(...D):u.isCollection(D)?D.forEach(F=>k(F)):z.isLoadable(D)&&p.push(D))};a(k);let y=null;await g.map(p,async v=>{v=await g.result("loadAll"in v&&"function"===typeof v.loadAll?v.loadAll():v.load());!1!==v.ok||y||(y=v)});if(y)throw y.error;return M}d.loadAll=async function(M,a){await M.load();return r(M,a)};d.loadAllChildren=r;Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J,L,w,b,q,I,f,G,O,Q){function Z(e){const n=z.id;return()=>{const A=e.deref();A&&n.findCredential(A.restUrl)&&A.signIn().catch(()=>{})}}const U=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));var T;let x;const R={PortalGroup:()=>Promise.resolve({default:I}),PortalItem:()=>new Promise((e,n)=>d(["./PortalItem"],A=>e(U(A)),n)),PortalUser:()=>Promise.resolve({default:O})};a=T=class extends a.JSONSupportMixin(p){constructor(e){super(e);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.default3DBasemapQuery=this.customBaseUrl=this.culture=this.created=null;this.hasClassificationSchema=this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=
null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=u.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=
this.useDefault3dBasemap=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return"string"===typeof e?{url:e}:e}destroy(){h.unregister(this);this.defaultBasemap=k.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=k.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=k.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=k.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const n of e)u.request.trustedServers.includes(n)||
u.request.trustedServers.push(n);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){const e=!this.user?.orgId||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get hasAPIKey(){return Q.isApiKeyApplicable(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let e=this.url;
if(e){const n=e.indexOf("/sharing");e=0<n?e.slice(0,n):this.url.replace(/\/+$/,"");e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,n=this.thumbnail;return e&&n?this._normalizeSSL(e+"/portals/self/resources/"+n):null}readUrlKey(e){return e?e.toLowerCase():e}readUser(e){let n=null;e&&(n=O.fromJSON(e),n.portal=this);return n}load(e){const n=(new Promise((A,P)=>d(["../Basemap"],X=>A(U(X)),P))).then(({default:A})=>{y.throwIfAborted(e);x=A}).then(()=>this.sourceJSON?this.sourceJSON:
this.fetchSelf(this.authMode,!1,e)).then(A=>{if(!this.hasAPIKey&&z.id){const P=z.id;this.credential=P.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO&&this.authMode!==T.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=P.on("credential-create",Z(new WeakRef(this))),h.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=A;this.read(A)});this.addResolvingPromise(n);return Promise.resolve(this)}async createElevationLayers(){await this.load();
const e=this._getHelperService("defaultElevationLayers"),n=(await new Promise((A,P)=>d(["../layers/ElevationLayer"],X=>A(U(X)),P))).default;return e?e.map(A=>new n({id:A.id,url:A.url})):[]}async fetchBasemaps(e,n){const A=await this._fetchBasemaps(e,n);!0===n?.include3d&&!1!==this.use3dBasemaps&&(e=await this._fetchBasemaps3D(e,n),A.unshift(...e));return A}async fetchDefault3DBasemap(e){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||"none"===this.default3DBasemapQuery)return null;const n=
new f;n.query=this.default3DBasemapQuery;n.disableExtraQuery=!0;return(e=(await this.queryItems(n,e)).results.find(A=>"Web Scene"===A.type))?new x({portalItem:e}):null}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(n=>n.categorySchema):y.isAborted(e)?Promise.reject(y.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(e){const n=this.featuredGroups,A=new f({num:100,sortField:"title"});if(n?.length){const P=[];for(const X of n)P.push(`(title:"${X.title}" AND owner:${X.owner})`);
A.query=P.join(" OR ");return this.queryGroups(A,e).then(X=>X.results)}return y.isAborted(e)?Promise.reject(y.createAbortError()):Promise.resolve([])}fetchRegions(e){const n=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:n}})}fetchSettings(e){const n=this.user?.culture||this.culture||b.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:n}})}static getDefault(){return q.ensureDefaultPortalInstance(()=>
new T)}queryGroups(e,n){return this.queryPortal("/community/groups",e,"PortalGroup",n)}queryItems(e,n){return this.queryPortal("/search",e,"PortalItem",n)}queryUsers(e,n){e.sortField||(e.sortField="username");return this.queryPortal("/community/users",e,"PortalUser",n)}fetchSelf(e=this.authMode,n=!1,A){const P=this.restUrl+"/portals/self";e={authMode:e,query:{culture:b.getLocale().toLowerCase()},withCredentials:!0,...A};"auto"===e.authMode&&(e.authMode="no-prompt");n&&(e.query.default=!0);return this.request(P,
e)}queryPortal(e,n,A,P){const X=D.ensureType(f,n),ca=ja=>this.request(this.restUrl+e,{...X.toRequestOptions(this),...P}).then(qa=>{const sa=X.clone();sa.start=qa.nextStart;return new G({nextQueryParams:sa,queryParams:X,total:qa.total,results:T._resultsToTypedArray(ja,{portal:this},qa,P)})}).then(qa=>Promise.all(qa.results.map(sa=>"function"===typeof sa.when?sa.when():qa)).then(()=>qa,sa=>{y.throwIfAbortError(sa);return qa}));return A&&R[A]?R[A]().then(({default:ja})=>{y.throwIfAborted(P);return ca(ja)}):
ca()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new M("portal:not-authenticated","Unable to authenticate user. Portal.user is missing");});if(this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT&&!z.id)return Promise.reject(new M("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const e=n=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return n||
(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=n;return this.fetchSelf("immediate")});if(this.user&&this.credential===n)return null;this.credential=n;return this.fetchSelf("immediate")}).then(A=>{A&&(this.sourceJSON=A,this.read(A))});return z.id?z.id.getCredential(this.restUrl,{prompt:this.authMode!==T.AUTH_MODE_NO_PROMPT}).then(n=>e(n)):e(this.credential)}normalizeUrl(e){const n=this.credential?.token;
return this._normalizeSSL(n?e+(e.includes("?")?"\x26":"?")+"token\x3d"+n:e)}requestToTypedArray(e,n,A){return this.request(e,n).then(P=>{const X=T._resultsToTypedArray(A,{portal:this},P);return Promise.all(X.map(ca=>"function"===typeof ca.when?ca.when():P)).then(()=>X,()=>X)})}request(e,n={}){var A={f:"json",...n.query};const {authMode:P=this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:X=null,cacheBust:ca=!1,method:ja="auto",responseType:qa="json",
signal:sa}=n;A={authMode:P,body:X,cacheBust:ca,method:ja,query:A,responseType:qa,timeout:0,signal:sa};n.withCredentials&&(A.withCredentials=!0);return r(this._normalizeSSL(e),A).then(da=>da.data)}toJSON(){throw new M("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:e})}_getHelperService(e){const n=this.helperServices&&this.helperServices[e];if(!n)throw new M("portal:service-not-found",
`The \`helperServices\` do not include an entry named "${e}"`);return n}async _fetchBasemaps(e,n){const A=new f;A.query=e||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);A.disableExtraQuery=!0;e=await this.queryGroups(A,n);if(!e.total)return[];e=e.results[0];A.num=100;A.query='type:"Web Map" -type:"Web Application"';A.sortField=e.sortField||"name";A.sortOrder=e.sortOrder||"desc";n=await e.queryItems(A,n);return n.total?
n.results.filter(P=>"Web Map"===P.type).map(P=>new x({portalItem:P})):[]}async _fetchBasemaps3D(e,n){e=e||this.basemapGalleryGroupQuery3D;if(!e)return[];e=new f({query:e,disableExtraQuery:!0});var A=await this.queryGroups(e,n);if(!A.total)return[];A=A.results[0];e.num=100;e.query='type:"Web Scene"';e.sortField=A.sortField||"name";e.sortOrder=A.sortOrder||"desc";n=await A.queryItems(e,n);return n.total?n.results.filter(P=>"Web Scene"===P.type).map(P=>new x({portalItem:P})):[]}_normalizeSSL(e){return e.replace(/^http:/i,
"https:").replace(":7080",":7443")}_readBasemap(e){return e?(e=x.fromJSON(e),e.portalItem={portal:this},e):null}static _resultsToTypedArray(e,n,A,P){if(A){const X=null!=P?P.signal:null;A=A.listings||A.notifications||A.userInvitations||A.tags||A.items||A.groups||A.comments||A.provisions||A.results||A.relatedItems||A;if(e||n)A=A.map(ca=>{ca=Object.assign(e?e.fromJSON(ca):ca,n);"function"===typeof ca.load&&ca.load(X);return ca})}else A=[];return A}};a.AUTH_MODE_ANONYMOUS="anonymous";a.AUTH_MODE_AUTO=
"auto";a.AUTH_MODE_IMMEDIATE="immediate";a.AUTH_MODE_NO_PROMPT="no-prompt";g.__decorate([v.property()],a.prototype,"access",void 0);g.__decorate([v.property()],a.prototype,"allSSL",void 0);g.__decorate([v.property()],a.prototype,"authMode",void 0);g.__decorate([v.property()],a.prototype,"authorizedCrossOriginDomains",void 0);g.__decorate([J.reader("authorizedCrossOriginDomains")],a.prototype,"readAuthorizedCrossOriginDomains",null);g.__decorate([v.property()],a.prototype,"basemapGalleryGroupQuery",
void 0);g.__decorate([v.property({json:{name:"3DBasemapGalleryGroupQuery"}})],a.prototype,"basemapGalleryGroupQuery3D",void 0);g.__decorate([v.property()],a.prototype,"bingKey",void 0);g.__decorate([v.property()],a.prototype,"canListApps",void 0);g.__decorate([v.property()],a.prototype,"canListData",void 0);g.__decorate([v.property()],a.prototype,"canListPreProvisionedItems",void 0);g.__decorate([v.property()],a.prototype,"canProvisionDirectPurchase",void 0);g.__decorate([v.property()],a.prototype,
"canSearchPublic",void 0);g.__decorate([v.property()],a.prototype,"canShareBingPublic",void 0);g.__decorate([v.property()],a.prototype,"canSharePublic",void 0);g.__decorate([v.property()],a.prototype,"canSignInArcGIS",void 0);g.__decorate([v.property()],a.prototype,"canSignInIDP",void 0);g.__decorate([v.property()],a.prototype,"colorSetsGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"commentsEnabled",void 0);g.__decorate([v.property({type:Date})],a.prototype,"created",void 0);g.__decorate([v.property()],
a.prototype,"credential",void 0);g.__decorate([v.property()],a.prototype,"culture",void 0);g.__decorate([v.property()],a.prototype,"currentVersion",void 0);g.__decorate([v.property()],a.prototype,"customBaseUrl",void 0);g.__decorate([v.property()],a.prototype,"default3DBasemapQuery",void 0);g.__decorate([v.property()],a.prototype,"defaultBasemap",void 0);g.__decorate([J.reader("defaultBasemap")],a.prototype,"readDefaultBasemap",null);g.__decorate([v.property()],a.prototype,"defaultDevBasemap",void 0);
g.__decorate([J.reader("defaultDevBasemap")],a.prototype,"readDefaultDevBasemap",null);g.__decorate([v.property({type:w})],a.prototype,"defaultExtent",void 0);g.__decorate([v.property()],a.prototype,"defaultVectorBasemap",void 0);g.__decorate([J.reader("defaultVectorBasemap")],a.prototype,"readDefaultVectorBasemap",null);g.__decorate([v.property()],a.prototype,"description",void 0);g.__decorate([v.property()],a.prototype,"devBasemapGalleryGroupQuery",void 0);g.__decorate([v.property()],a.prototype,
"eueiEnabled",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,"extraQuery",null);g.__decorate([v.property()],a.prototype,"featuredGroups",void 0);g.__decorate([v.property()],a.prototype,"featuredItemsGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"galleryTemplatesGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"layoutGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"livingAtlasGroupQuery",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,
"hasAPIKey",null);g.__decorate([v.property()],a.prototype,"hasCategorySchema",void 0);g.__decorate([v.property()],a.prototype,"hasClassificationSchema",void 0);g.__decorate([v.property()],a.prototype,"helpBase",void 0);g.__decorate([v.property()],a.prototype,"helperServices",void 0);g.__decorate([v.property()],a.prototype,"helpMap",void 0);g.__decorate([v.property()],a.prototype,"homePageFeaturedContent",void 0);g.__decorate([v.property()],a.prototype,"homePageFeaturedContentCount",void 0);g.__decorate([v.property()],
a.prototype,"httpPort",void 0);g.__decorate([v.property()],a.prototype,"httpsPort",void 0);g.__decorate([v.property()],a.prototype,"id",void 0);g.__decorate([v.property()],a.prototype,"ipCntryCode",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,"isOrganization",null);g.__decorate([v.property()],a.prototype,"isPortal",void 0);g.__decorate([v.property()],a.prototype,"isReadOnly",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,"itemPageUrl",null);g.__decorate([v.property()],
a.prototype,"layerTemplatesGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"maxTokenExpirationMinutes",void 0);g.__decorate([v.property({type:Date})],a.prototype,"modified",void 0);g.__decorate([v.property()],a.prototype,"name",void 0);g.__decorate([v.property()],a.prototype,"portalHostname",void 0);g.__decorate([v.property()],a.prototype,"portalMode",void 0);g.__decorate([v.property()],a.prototype,"portalProperties",void 0);g.__decorate([v.property()],a.prototype,"region",void 0);g.__decorate([v.property()],
a.prototype,"recycleBinEnabled",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,"restUrl",null);g.__decorate([v.property()],a.prototype,"rotatorPanels",void 0);g.__decorate([v.property()],a.prototype,"showHomePageDescription",void 0);g.__decorate([v.property()],a.prototype,"sourceJSON",void 0);g.__decorate([v.property()],a.prototype,"staticImagesUrl",void 0);g.__decorate([v.property({json:{name:"2DStylesGroupQuery"}})],a.prototype,"stylesGroupQuery2d",void 0);g.__decorate([v.property({json:{name:"stylesGroupQuery"}})],
a.prototype,"stylesGroupQuery3d",void 0);g.__decorate([v.property()],a.prototype,"supportsHostedServices",void 0);g.__decorate([v.property()],a.prototype,"symbolSetsGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"templatesGroupQuery",void 0);g.__decorate([v.property()],a.prototype,"thumbnail",void 0);g.__decorate([v.property({readOnly:!0})],a.prototype,"thumbnailUrl",null);g.__decorate([v.property()],a.prototype,"units",void 0);g.__decorate([v.property()],a.prototype,"url",void 0);g.__decorate([v.property()],
a.prototype,"urlKey",void 0);g.__decorate([J.reader("urlKey")],a.prototype,"readUrlKey",null);g.__decorate([v.property()],a.prototype,"user",void 0);g.__decorate([J.reader("user")],a.prototype,"readUser",null);g.__decorate([v.property()],a.prototype,"use3dBasemaps",void 0);g.__decorate([v.property()],a.prototype,"useDefault3dBasemap",void 0);g.__decorate([v.property()],a.prototype,"useStandardizedQuery",void 0);g.__decorate([v.property()],a.prototype,"useVectorBasemaps",void 0);g.__decorate([v.property()],
a.prototype,"vectorBasemapGalleryGroupQuery",void 0);g=a=T=g.__decorate([L.subclass("esri.portal.Portal")],a);const h=new FinalizationRegistry(e=>{e.remove()});return g})},"esri/portal/portalDefault":function(){define(["exports"],function(d){let g;d.clearDefaultPortalInstance=function(){g=void 0};d.ensureDefaultPortalInstance=function(u){if(!g||g.destroyed)g=u();return g};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(d,g,u,z,r,M,a,p,k){var y;u=y=class extends u.JSONSupport{constructor(v){super(v);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const v=this.url,D=this.thumbnail;return v&&D&&this.portal?this.portal?.normalizeUrl(`${v}/info/${D}?f=json`):null}get url(){const v=this.portal?.restUrl;return v?v+"/community/groups/"+this.id:
null}fetchCategorySchema(v){return this.portal.request(this.url+"/categorySchema",v).then(D=>{D=D.categorySchema||[];return D.some(F=>"contentCategorySetsGroupQuery.LivingAtlas"===F.source)?this._fetchCategorySchemaSet("LivingAtlas",v):D})}fetchMembers(v){return this.portal.request(this.url+"/users",v)}getThumbnailUrl(v){let D=this.thumbnailUrl;D&&v&&(D+=`&w=${v}`);return D}toJSON(){throw new g("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(v){if(!v)return null;
if(v.declaredClass)throw Error("JSON object is already hydrated");const D=new y({sourceJSON:v});D.read(v);return D}queryItems(v,D){v=r.ensureType(k,v);const F=this.portal;if(5<parseFloat(F.currentVersion))return v=v||new k,F.queryPortal(`/content/groups/${this.id}/search`,v,"PortalItem",D);v=v?v.clone():new k;v.query="group:"+this.id+(v.query?" "+v.query:"");return F.queryItems(v,D)}_fetchCategorySchemaSet(v,D){const F=this.portal;return F.fetchSelf(F.authMode,!0,D).then(t=>{if(t=t.contentCategorySetsGroupQuery)return t=
new k({disableExtraQuery:!0,num:1,query:t}),F.queryGroups(t,D);throw new g("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(t=>{if(t.total){t=t.results[0];const J=new k({num:1,query:`typekeywords:"${v}"`});return t.queryItems(J,D)}throw new g("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(t=>t.total?t.results[0].fetchData("json",D).then(J=>{J=J?.categorySchema;return J?.length?J:[]}):[])}};d.__decorate([z.property()],
u.prototype,"access",void 0);d.__decorate([z.property({type:Date})],u.prototype,"created",void 0);d.__decorate([z.property()],u.prototype,"description",void 0);d.__decorate([z.property()],u.prototype,"id",void 0);d.__decorate([z.property()],u.prototype,"isInvitationOnly",void 0);d.__decorate([z.property({type:Date})],u.prototype,"modified",void 0);d.__decorate([z.property()],u.prototype,"owner",void 0);d.__decorate([z.property()],u.prototype,"portal",void 0);d.__decorate([z.property()],u.prototype,
"snippet",void 0);d.__decorate([z.property()],u.prototype,"sortField",void 0);d.__decorate([z.property()],u.prototype,"sortOrder",void 0);d.__decorate([z.property()],u.prototype,"sourceJSON",void 0);d.__decorate([z.property()],u.prototype,"tags",void 0);d.__decorate([z.property()],u.prototype,"thumbnail",void 0);d.__decorate([z.property({readOnly:!0})],u.prototype,"thumbnailUrl",null);d.__decorate([z.property()],u.prototype,"title",void 0);d.__decorate([z.property({readOnly:!0})],u.prototype,"url",
null);return u=y=d.__decorate([p.subclass("esri.portal.PortalGroup")],u)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(d,g,u,z,r,M,a,p,k,y,v){var D;const F=new u.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});g=D=class extends g{constructor(t){super(t);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new D({categories:this.categories?z.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,J){let L=[];this.categories&&(L=this.categories.map(q=>Array.isArray(q)?JSON.stringify(q):q));let w="";if(this.extent){var b=v.project(this.extent,y.WGS84);null!=b&&(w=`${b.xmin},${b.ymin},${b.xmax},${b.ymax}`)}b=this.query;!this.disableExtraQuery&&t.extraQuery&&(b="("+b+")"+t.extraQuery);t={categories:L,bbox:w,q:b,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(t.sortField=this.sortField.split(",").map(q=>F.toJSON(q.trim())).join(","),t.sortOrder=this.sortOrder);return{query:{...J,...t}}}};d.__decorate([r.property()],g.prototype,"categories",void 0);d.__decorate([r.property()],g.prototype,"disableExtraQuery",void 0);d.__decorate([r.property({type:k})],g.prototype,"extent",void 0);d.__decorate([r.property()],g.prototype,"filter",void 0);d.__decorate([r.property()],g.prototype,"num",void 0);d.__decorate([r.property()],
g.prototype,"query",void 0);d.__decorate([r.property()],g.prototype,"sortField",void 0);d.__decorate([r.property()],g.prototype,"sortOrder",null);d.__decorate([r.property()],g.prototype,"start",void 0);return g=D=d.__decorate([p.subclass("esri.portal.PortalQueryParams")],g)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a){g=class extends g{constructor(p){super(p);this.total=this.results=this.queryParams=this.nextQueryParams=null}};d.__decorate([u.property()],g.prototype,"nextQueryParams",void 0);d.__decorate([u.property()],g.prototype,"queryParams",void 0);d.__decorate([u.property()],g.prototype,"results",void 0);d.__decorate([u.property()],g.prototype,"total",void 0);return g=d.__decorate([a.subclass("esri.portal.PortalQueryResult")],g)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v){var D;z=D=class extends z.JSONSupport{constructor(F){super(F);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const F=this.url,t=this.thumbnail;return F&&t?this.portal.normalizeUrl(`${F}/info/${t}?f=json`):null}get userContentUrl(){const F=
this.portal?.restUrl;return F?`${F}/content/users/${this.username}`:null}get url(){const F=this.portal?.restUrl;return F?`${F}/community/users/${this.username}`:null}addItem(F){const t=F&&F.item;var J=F?.data;F=F?.folder;const L={method:"post"};t&&(L.query=t.createPostQuery(),null!=J&&("string"===typeof J?L.query.text=J:"object"===typeof J&&(L.query.text=JSON.stringify(J))));J=this.userContentUrl;F&&(J+="/"+("string"===typeof F?F:F.id));return this.portal.request(J+"/addItem",L).then(w=>{t.id=w.id;
t.portal=this.portal;return t.loaded?t.reload():t.load()})}async deleteItem(F,t=!1){let J=this.userContentUrl;F.ownerFolder&&(J+="/"+F.ownerFolder);await this.portal.request(J+`/items/${F.id}/delete`,{method:"post",query:t?{permanentDelete:!0}:{}});F.id=null;F.portal=null}async deleteItems(F,t=!1){F=F.slice();var J=this.userContentUrl+"/deleteItems";const L=[];var w=F.map(b=>b.id);if(w.length){t={method:"post",query:{items:w.join(","),permanentDelete:t}};J=await this.portal.request(J,t);for(const b of J.results)J=
F.find(q=>b.itemId===q.id),t=b.success,w=null,t?(J.id=null,J.portal=null):b.error&&(w=new u("portal:delete-item-failed",b.error.message,b.error)),L.push({item:J,success:t,error:w})}return L}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(F=>F&&F.folders?F.folders.map(t=>{t=y.fromJSON(t);t.portal=this.portal;return t}):[])}fetchGroups(){return this.portal.request(this.url??"").then(F=>F&&F.groups?F.groups.map(t=>{t=v.fromJSON(t);t.portal=this.portal;return t}):
[])}async fetchItems(F){F??={};var t=this.userContentUrl??"";F.folder&&(t+="/"+F.folder.id);const {default:J}=await new Promise((L,w)=>d(["./PortalItem"],b=>L(Object.freeze(Object.defineProperty({__proto__:null,default:b},Symbol.toStringTag,{value:"Module"}))),w));F=await this.portal.request(t,{query:{folders:!1,inRecycleBin:F.inRecycleBin?!0:null,foldersContent:!F.folder&&F.includeSubfolderItems?!0:null,num:F.num||10,start:F.start||1,sortField:F.sortField||"created",sortOrder:F.sortOrder||"asc"}});
return F?.items?(t=F.items.map(L=>{L=J.fromJSON(L);L.portal=this.portal;return L}),await Promise.all(t.map(L=>L.load())),{items:t,nextStart:F.nextStart,total:F.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(F=>F.tags)}getThumbnailUrl(F){let t=this.thumbnailUrl;t&&F&&(t+=`&w=${F}`);return t}queryFavorites(F){return this.favGroupId?(this._favGroup||(this._favGroup=new v({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(F)):Promise.reject(new u("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(F,t){await this.portal.request(this.userContentUrl+`/items/${F.id}/restore`,{method:"post",query:t?{folderID:"string"===typeof t?t:t.id}:null})}toJSON(){throw new u("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(F){if(!F)return null;if(F.declaredClass)throw Error("JSON object is already hydrated");const t=new D({sourceJSON:F});t.read(F);return t}};g.__decorate([r.property()],
z.prototype,"access",void 0);g.__decorate([r.property({type:Date})],z.prototype,"created",void 0);g.__decorate([r.property()],z.prototype,"culture",void 0);g.__decorate([r.property()],z.prototype,"description",void 0);g.__decorate([r.property()],z.prototype,"email",void 0);g.__decorate([r.property()],z.prototype,"favGroupId",void 0);g.__decorate([r.property()],z.prototype,"fullName",void 0);g.__decorate([r.property({type:Date})],z.prototype,"modified",void 0);g.__decorate([r.property()],z.prototype,
"orgId",void 0);g.__decorate([r.property()],z.prototype,"portal",void 0);g.__decorate([r.property()],z.prototype,"preferredView",void 0);g.__decorate([r.property()],z.prototype,"privileges",void 0);g.__decorate([r.property()],z.prototype,"region",void 0);g.__decorate([r.property()],z.prototype,"role",void 0);g.__decorate([r.property()],z.prototype,"roleId",void 0);g.__decorate([r.property()],z.prototype,"sourceJSON",void 0);g.__decorate([r.property()],z.prototype,"thumbnail",void 0);g.__decorate([r.property({readOnly:!0})],
z.prototype,"thumbnailUrl",null);g.__decorate([r.property()],z.prototype,"units",void 0);g.__decorate([r.property({readOnly:!0})],z.prototype,"userContentUrl",null);g.__decorate([r.property({readOnly:!0})],z.prototype,"url",null);g.__decorate([r.property()],z.prototype,"username",void 0);g.__decorate([r.property()],z.prototype,"userLicenseTypeId",void 0);g.__decorate([r.property()],z.prototype,"userType",void 0);return z=D=g.__decorate([k.subclass("esri.portal.PortalUser")],z)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a,p){u=class extends u.JSONSupport{constructor(k){super(k);this.username=this.title=this.portal=this.id=this.created=null}get url(){const k=this.portal?.restUrl;return k?`${k}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new g("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};d.__decorate([z.property({type:Date})],u.prototype,"created",void 0);d.__decorate([z.property()],u.prototype,"id",void 0);d.__decorate([z.property()],u.prototype,
"portal",void 0);d.__decorate([z.property()],u.prototype,"title",void 0);d.__decorate([z.property({readOnly:!0})],u.prototype,"url",null);d.__decorate([z.property()],u.prototype,"username",void 0);return u=d.__decorate([p.subclass("esri.portal.PortalFolder")],u)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J,L,w){var b;const q=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),I=new Set(["KML","GeoJson","CSV"]);r=b=class extends r.JSONSupportMixin(a){static from(f){return y.ensureClass(b,f)}constructor(f){super(f);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.classification=
this.categories=this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const f=this.type,G=this.typeKeywords||
[];let O=f;"Feature Service"===f||"Feature Collection"===f?O=G.includes("Table")?"Table":G.includes("Route Layer")?"Route Layer":G.includes("Markup")?"Markup":"Feature Layer":"Image Service"===f?O=G.includes("Elevation 3D Layer")?"Elevation Layer":G.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===f?O="Scene Layer":"Video Service"===f?O="Video Layer":"Scene Package"===f?O="Scene Layer Package":"Stream Service"===f?O="Feature Layer":"Geoprocessing Service"===f?O=G.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===f?O="GeoEnrichment Service":"Geocoding Service"===f?O="Locator":"Microsoft Powerpoint"===f?O="Microsoft PowerPoint":"GeoJson"===f?O="GeoJSON":"Globe Service"===f?O="Globe Layer":"Vector Tile Service"===f?O="Tile Layer":"netCDF"===f?O="NetCDF":"Map Service"===f?O=G.includes("Spatiotemporal")||!G.includes("Hosted Service")&&!G.includes("Tiled")||G.includes("Relational")?"Map Image Layer":"Tile Layer":f?.toLowerCase().includes("add in")?O=f.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===f?O="Big Data File Share":"Compact Tile Package"===f?O="Tile Package (tpkx)":"Raster function template"===f?O="Raster Function Template":"OGCFeatureServer"===f?O="OGC Feature Layer":"web mapping application"===f&&G.includes("configurableApp")?O="Instant App":"Insights Page"===f?O="Insights Report":"Excalibur Imagery Project"===f?O="Excalibur Project":"3DTiles Service"===f?O="3D tiles layer":"3DTiles Package"===f&&(O="3D tiles package");return O}readExtent(f){return f&&
f.length?new F(f[0][0],f[0][1],f[1][0],f[1][1]):null}get iconUrl(){var f=this.type?.toLowerCase()||"";const G=this.typeKeywords||[];var O=!1,Q=!1;let Z=!1,U=!1,T=!1,x=!1;O=Q=!1;0<f.indexOf("service")||"feature collection"===f||"kml"===f||"wms"===f||"wmts"===f||"wfs"===f?(O=G.includes("Hosted Service"),"feature service"===f||"feature collection"===f||"kml"===f||"wfs"===f?(Q=G.includes("Table"),Z=G.includes("Route Layer"),U=G.includes("Markup"),T=G.includes("Spatiotemporal"),x=G.includes("UtilityNetwork"),
f=T&&Q?"spatiotemporaltable":Q?"table":Z?"routelayer":U?"markup":T?"spatiotemporal":x?"utilitynetwork":O?"featureshosted":"features"):"map service"===f||"wms"===f||"wmts"===f?(T=G.includes("Spatiotemporal"),Q=G.includes("Relational"),f=T||Q?"mapimages":O||G.includes("Tiled")||"wmts"===f?"maptiles":"mapimages"):f="scene service"===f?G.includes("Line")?"sceneweblayerline":G.includes("3DObject")?"sceneweblayermultipatch":G.includes("Point")?"sceneweblayerpoint":G.includes("IntegratedMesh")?"sceneweblayermesh":
G.includes("PointCloud")?"sceneweblayerpointcloud":G.includes("Polygon")?"sceneweblayerpolygon":G.includes("Building")?"sceneweblayerbuilding":G.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===f?G.includes("Elevation 3D Layer")?"elevationlayer":G.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===f?"streamlayer":"vector tile service"===f?"vectortile":"datastore catalog service"===f?"datastorecollection":"geocoding service"===f?"geocodeservice":"video service"===
f?G.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===f?G.includes("Web Tool")?"tool":"layers":"geodata service"===f?"geodataservice":"3dtiles service"===f?G.includes("3DObject")?"3dobjecttileslayer":G.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):f="web map"===f||"cityengine web scene"===f?"maps":"web scene"===f?G.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===f&&G.includes("configurableApp")?
"instantapps":"web mapping application"===f||"mobile application"===f||"application"===f||"operation view"===f||"desktop application"===f?"apps":"map document"===f||"map package"===f||"published map"===f||"scene document"===f||"globe document"===f||"basemap package"===f||"mobile basemap package"===f||"mobile map package"===f||"project package"===f||"project template"===f||"pro map"===f||"layout"===f||"layer"===f&&G.includes("ArcGIS Pro")||"explorer map"===f&&G.indexOf("Explorer Document")?"mapsgray":
"service definition"===f||"shapefile"===f||"cad drawing"===f||"geojson"===f||"netcdf"===f||"administrative report"===f?"datafiles":"360 vr experience"===f?"360vr":"explorer add in"===f||"desktop add in"===f||"windows viewer add in"===f||"windows viewer configuration"===f?"appsgray":"arcgis pro add in"===f||"arcgis pro configuration"===f?"addindesktop":"pdf"===f?"pdf":"microsoft word"===f?"word":"microsoft excel"===f?"excel":"microsoft powerpoint"===f?"ppt":"rule package"===f||"file geodatabase"===
f||"sqlite geodatabase"===f||"csv collection"===f||"kml collection"===f||"windows mobile package"===f||"map template"===f||"desktop application template"===f||"gml"===f||"arcpad package"===f||"code sample"===f||"document link"===f||"earth configuration"===f||"operations dashboard add in"===f||"rules package"===f||"workflow manager package"===f||"explorer map"===f&&G.includes("Explorer Mapping Application")||G.includes("Document")?"datafilesgray":"network analysis service"===f||"geoprocessing service"===
f||"geodata service"===f||"geometry service"===f||"geoprocessing package"===f||"locator package"===f||"geoprocessing sample"===f||"workflow manager service"===f?"toolsgray":"layer"===f||"layer package"===f||"explorer layer"===f?"layersgray":"analysis model"===f?"analysismodel":"scene package"===f?"scenepackage":"3dtiles package"===f?"3dtileslayerpackage":"3dtiles service"===f?"3dtileslayer":"mobile scene package"===f?"mobilescenepackage":"tile package"===f||"compact tile package"===f?"tilepackage":
"task file"===f?"taskfile":"report template"===f?"report-template":"statistical data collection"===f?"statisticaldatacollection":"insights workbook"===f?"workbook":"insights model"===f?"insightsmodel":"insights page"===f?"insightspage":"insights theme"===f?"insightstheme":"hub initiative"===f?"hubinitiative":"hub page"===f?"hubpage":"hub site application"===f?"hubsite":"hub event"===f?"hubevent":"hub project"===f?"hubproject":"relational database connection"===f?"relationaldatabaseconnection":"big data file share"===
f?"datastorecollection":"image collection"===f?"imagecollection":"desktop style"===f?"desktopstyle":"style"===f?G.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===f?"dashboard":"raster function template"===f?"rasterprocessingtemplate":"vector tile package"===f?"vectortilepackage":"ortho mapping project"===f?"orthomappingproject":"ortho mapping template"===f?"orthomappingtemplate":"solution"===f?"solutions":"geopackage"===f?"geopackage":"deep learning package"===f?"deeplearningpackage":
"real time analytic"===f?"realtimeanalytics":"reality mapping project"===f?"realitymappingproject":"big data analytic"===f?"bigdataanalytics":"feed"===f?"feed":"excalibur imagery project"===f?"excaliburimageryproject":"notebook"===f?"notebook":"storymap"===f?"storymap":"survey123 add in"===f?"survey123addin":"mission"===f?"mission":"mission report"===f?"missionreport":"mission template"===f?"missiontemplate":"quickcapture project"===f?"quickcaptureproject":"pro report"===f?"proreport":"pro report template"===
f?"proreporttemplate":"urban model"===f?"urbanmodel":"urban project"===f?"urbanproject":"web experience"===f?"experiencebuilder":"web experience template"===f?"webexperiencetemplate":"experience builder widget"===f?"experiencebuilderwidget":"experience builder widget package"===f?"experiencebuilderwidgetpackage":"workflow"===f?"workflow":"kernel gateway connection"===f?"kernelgatewayconnection":"insights script"===f?"insightsscript":"hub initiative template"===f?"hubinitiativetemplate":"storymap theme"===
f?"storymaptheme":"knowledge graph"===f?"knowledgegraph":"knowledge graph layer"===f?"knowledgegraphlayer":"knowledge studio project"===f?"knowledgestudio":"native application"===f?"nativeapp":"native application installer"===f?"nativeappinstaller":"web link chart"===f?"linkchart":"knowledge graph web investigation"===f?"investigation":"ogcfeatureserver"===f?"features":"pro presentation"===f?"propresentation":"pro project"===f?"proproject":"insights workbook package"===f?"insightsworkbookpackage":
"apache parquet"===f?"apacheparquet":"notebook code snippet library"===f?"notebookcodesnippets":"suitability model"===f?"suitabilitymodel":"esri classifier definition"===f?"classifierdefinition":"esri classification schema"===f?"classificationschema":"insights data engineering workbook"===f?"dataengineeringworkbook":"insights data engineering model"===f?"dataengineeringmodel":"deep learning studio project"===f?"deeplearningproject":"discussion"===f?"discussion":"allsource project"===f?"allsourceproject":
"api key"===f?"apikey":"data pipeline"===f?"datapipelines":"group layer"===f?(O=G.includes("Map"))?"layergroup2d":"layergroup":"media layer"===f?"onlinemedialayer":"form"===f?G.includes("Survey123")?"survey":"datafilesgray":"csv"===f?"csv":"image"===f?"image":"maps";return f?u.getAssetUrl("esri/images/portal/"+f+"16.png"):null}get isLayer(){return null!=this.type&&q.has(this.type)}get itemCdnUrl(){return w.toCDNUrl(this.itemUrl)}get itemPageUrl(){const f=this.portal?.itemPageUrl;return f&&this.id?
`${f}?id=${this.id}`:null}get itemUrl(){const f=this.portal?.restUrl;return f&&this.id?`${f}/content/items/${this.id}`:null}get thumbnailUrl(){const f=this.itemUrl,G=this.thumbnail;return f&&G?this.portal?.normalizeUrl(`${f}/info/${G}?f=json`)??null:null}get userItemUrl(){const f=this.portal?.restUrl;if(!f)return null;const G=this.owner||this.portal?.user?.username;return G?`${f}/content/users/${this.ownerFolder?`${G}/${this.ownerFolder}`:G}/items/${this.id}`:null}load(f){const G=this.portal??(this.portal=
t.getDefault()),O=G.load(f).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?G.request(this.itemUrl,{signal:null!=f?f.signal:null,query:{token:this.apiKey}}):{}).then(Q=>{this.sourceJSON=Q;this.read(Q)});this.addResolvingPromise(O);return Promise.resolve(this)}async addRating(f){const G={method:"post",query:{}};f instanceof L&&(f=f.rating);null==f||isNaN(f)||"number"!==typeof f||(G.query.rating=f);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",G);return new L({rating:f,
created:new Date})}clone(){var f={access:this.access,accessInformation:this.accessInformation,applicationProxies:M.clone(this.applicationProxies),avgRating:this.avgRating,categories:M.clone(this.categories),classification:M.clone(this.classification),created:M.clone(this.created),culture:this.culture,description:this.description,extent:M.clone(this.extent),groupCategories:M.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:M.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:M.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:M.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:M.clone(this.typeKeywords),url:this.url};this.loaded&&(f.loadStatus="loaded");f=(new b({sourceJSON:this.sourceJSON})).set(f);
f._set("isOrgItem",this.isOrgItem);return f}createPostQuery(){const f=this.toJSON();for(var G of["tags","typeKeywords","categories"])f[G]=f[G]?.join(", ");for(const O of["extent","classification"])(G=f[O])&&(f[O]=JSON.stringify(G));return f}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(f="json",G){return this.portal.request(this.itemUrl+"/data",{responseType:f,...G,query:{token:this.apiKey}})}async fetchRating(f){f=await this.portal.request(this.itemUrl+
"/rating",{query:{token:this.apiKey},...f});return null!=f.rating?(f.created=new Date(f.created),new L(f)):null}fetchRelatedItems(f,G){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...f,token:this.apiKey},...G},b)}getThumbnailUrl(f){let G=this.thumbnailUrl;G&&f&&(G+=`&w=${f}`);return G}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(f=>{this.applicationProxies&&!Object.hasOwn(f,"appProxies")&&(this.applicationProxies=
null);this.sourceJSON=f;this.read(f);return this})}update(f){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const G=f?.data,O={method:"post"};O.query=this.createPostQuery();for(const Q in O.query)null===O.query[Q]&&(O.query[Q]="");O.query.clearEmptyFields=!0;null!=G&&("string"===typeof G?O.query.text=G:"object"===typeof G&&(O.query.text=JSON.stringify(G)));return this.portal.request(`${this.userItemUrl}/update`,O).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist",
"The item does not exist yet and cannot be updated"))}async copy(f){if(!this.id)throw new z("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:G,itemUrl:O}=this;await G.signIn();const {copyResources:Q,folder:Z,tags:U,title:T}=f||{};f={method:"post",query:{copyPrivateResources:"all"===Q,folder:"string"===typeof Z?Z:Z?.id,includeResources:!!Q,tags:U?.join(","),title:T}};({itemId:f}=await G.request(`${O}/copy`,f));return new b({id:f,portal:G})}updateThumbnail(f){return this.id?
this.load().then(()=>this.portal.signIn()).then(()=>{const G=f.thumbnail,O=f.filename,Q={method:"post"};if("string"===typeof G)p.isDataProtocol(G)?Q.query={data:G}:Q.query={url:p.makeAbsolute(G)},null!=O&&(Q.query.filename=O);else{const Z=new FormData;null!=O?Z.append("file",G,O):Z.append("file",G);Q.body=Z}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,Q).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(f=
{},G){const {fetchResources:O}=await new Promise((Q,Z)=>d(["./support/resourceUtils"],Q,Z));return O(this,f,G)}async addResource(f,G,O){const {addOrUpdateResources:Q}=await new Promise((Z,U)=>d(["./support/resourceUtils"],Z,U));f.portalItem=this;await Q(this,[{resource:f,content:G,compress:O?.compress,access:O?.access}],"add",O);return f}async removeResource(f,G){const {removeResource:O}=await new Promise((Q,Z)=>d(["./support/resourceUtils"],Q,Z));if(f.portalItem&&f.portalItem.itemUrl!==this.itemUrl)throw new z("removeresource:portal-item-mismatch",
"The portal item associated with the provided resource does not match the item");return O(this,f,G)}async removeAllResources(f){const {removeAllResources:G}=await new Promise((O,Q)=>d(["./support/resourceUtils"],O,Q));return G(this,f)}resourceFromPath(f){return new J({portalItem:this,path:f})}toJSON(){var f=this.extent;f={accessInformation:this.accessInformation,categories:M.clone(this.categories),classification:M.clone(this.classification),created:this.created?.getTime(),description:this.description,
extent:f&&[[f.xmin,f.ymin],[f.xmax,f.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:M.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:M.clone(this.typeKeywords),url:this.url};return M.fixJson(f)}static fromJSON(f){if(!f)return null;if(f.declaredClass)throw Error("JSON object is already hydrated");
return new b({sourceJSON:f})}_getPostQuery(){const f=this.toJSON();for(const G in f)"tags"===G&&null!==f[G]&&(f[G]=f[G].join(", ")),"typeKeywords"===G&&null!==f[G]&&(f[G]=f[G].join(", ")),"extent"===G&&f[G]&&(f[G]=JSON.stringify(f[G]));return f}};g.__decorate([k.property({type:["private","shared","org","public"]})],r.prototype,"access",void 0);g.__decorate([k.property()],r.prototype,"accessInformation",void 0);g.__decorate([k.property({type:String})],r.prototype,"apiKey",void 0);g.__decorate([k.property({json:{read:{source:"appProxies"}}})],
r.prototype,"applicationProxies",void 0);g.__decorate([k.property()],r.prototype,"avgRating",void 0);g.__decorate([k.property()],r.prototype,"categories",void 0);g.__decorate([k.property()],r.prototype,"classification",void 0);g.__decorate([k.property({type:Date})],r.prototype,"created",void 0);g.__decorate([k.property()],r.prototype,"culture",void 0);g.__decorate([k.property()],r.prototype,"description",void 0);g.__decorate([k.property({readOnly:!0})],r.prototype,"displayName",null);g.__decorate([k.property({type:F})],
r.prototype,"extent",void 0);g.__decorate([v.reader("extent")],r.prototype,"readExtent",null);g.__decorate([k.property()],r.prototype,"groupCategories",void 0);g.__decorate([k.property({readOnly:!0})],r.prototype,"iconUrl",null);g.__decorate([k.property()],r.prototype,"id",void 0);g.__decorate([k.property({readOnly:!0})],r.prototype,"isLayer",null);g.__decorate([k.property({type:Boolean,readOnly:!0})],r.prototype,"isOrgItem",void 0);g.__decorate([k.property()],r.prototype,"itemControl",void 0);g.__decorate([k.property({readOnly:!0})],
r.prototype,"itemPageUrl",null);g.__decorate([k.property({readOnly:!0})],r.prototype,"itemUrl",null);g.__decorate([k.property()],r.prototype,"licenseInfo",void 0);g.__decorate([k.property({type:Date})],r.prototype,"modified",void 0);g.__decorate([k.property()],r.prototype,"name",void 0);g.__decorate([k.property()],r.prototype,"numComments",void 0);g.__decorate([k.property()],r.prototype,"numRatings",void 0);g.__decorate([k.property()],r.prototype,"numViews",void 0);g.__decorate([k.property()],r.prototype,
"owner",void 0);g.__decorate([k.property()],r.prototype,"ownerFolder",void 0);g.__decorate([k.property({type:t})],r.prototype,"portal",void 0);g.__decorate([k.property()],r.prototype,"screenshots",void 0);g.__decorate([k.property()],r.prototype,"size",void 0);g.__decorate([k.property()],r.prototype,"snippet",void 0);g.__decorate([k.property()],r.prototype,"sourceJSON",void 0);g.__decorate([k.property({type:String})],r.prototype,"sourceUrl",void 0);g.__decorate([k.property({type:String})],r.prototype,
"spatialReference",void 0);g.__decorate([k.property()],r.prototype,"tags",void 0);g.__decorate([k.property()],r.prototype,"thumbnail",void 0);g.__decorate([k.property({readOnly:!0})],r.prototype,"thumbnailUrl",null);g.__decorate([k.property()],r.prototype,"title",void 0);g.__decorate([k.property()],r.prototype,"type",void 0);g.__decorate([k.property()],r.prototype,"typeKeywords",void 0);g.__decorate([k.property({type:String,json:{read(f,G){I.has(G.type)&&(G=this.portal?.restUrl,f||=G&&this.id?`${G}/content/items/${this.id}/data`:
null);return f}}})],r.prototype,"url",void 0);g.__decorate([k.property({readOnly:!0})],r.prototype,"userItemUrl",null);return r=b=g.__decorate([D.subclass("esri.portal.PortalItem")],r)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v){function D(F,t){if(null==F)return F;F=F.replace(/^\/+/,"");null!=t&&M.isAbsolute(F)&&(F=M.makeRelative(F,t.itemUrl));return F?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}u=class extends u{constructor(F){super(F);this.portalItem=null}normalizeCtorArgs(F){return F?.portalItem&&F.path?{...F,path:D(F.path,F.portalItem)}:F}set path(F){null!=F&&M.isAbsolute(F)?r.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",F)}_castPath(F){return D(F,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(F="json",t){const J=this.cdnUrl;if(null==J)throw new z("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(J,{responseType:F,query:{token:this.portalItem.apiKey,_ts:t?.cacheBust?Date.now():null},signal:t?.signal})}async update(F,t){const {addOrUpdateResources:J}=await new Promise((L,w)=>d(["./support/resourceUtils"],L,w));await J(this.portalItem,[{resource:this,content:F,compress:t?.compress,access:t?.access}],"update",t);return this}hasPath(){return null!=this.path}};g.__decorate([a.property()],u.prototype,"portalItem",void 0);g.__decorate([a.property({type:String,
value:null})],u.prototype,"path",null);g.__decorate([p.cast("path")],u.prototype,"_castPath",null);g.__decorate([a.property({type:String,readOnly:!0})],u.prototype,"url",null);g.__decorate([a.property({type:String,readOnly:!0})],u.prototype,"cdnUrl",null);g.__decorate([a.property({type:String,readOnly:!0})],u.prototype,"itemRelativeUrl",null);return u=g.__decorate([v.subclass("esri.portal.PortalItemResource")],u)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a){g=class extends g{constructor(p){super(p);this.rating=this.created=null}};d.__decorate([u.property()],g.prototype,"created",void 0);d.__decorate([u.property()],g.prototype,"rating",void 0);return g=d.__decorate([a.subclass("esri.portal.PortalRating")],g)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(d,g,u,z){function r(b,q){var I=q?.url?.path;b&&I&&(b=u.makeAbsolute(b,I,{preserveProtocolRelative:!0}),
q.portalItem&&q.readResourcePaths&&(I=u.makeRelative(b,q.portalItem.itemUrl),null!=I&&L.test(I)&&q.readResourcePaths.push(q.portalItem.resourceFromPath(I).path)));return(b=D(b,q?.portal))&&J.test(b)?F(b):b}function M(b,q,I=d.MarkKeep.YES){b=b&&J.test(b)?t(b):b;if(null==b)return b;!u.isAbsolute(b)&&q?.blockedRelativeUrls&&q.blockedRelativeUrls.push(b);let f=u.makeAbsolute(b);if(q){var G=q.verifyItemRelativeUrls?.rootPath||q.url?.path;if(G){G=D(G,q.portal);const O=D(f,q.portal);f=u.makeRelative(O,G,
G);null!=f&&f!==O&&f!==b&&q.verifyItemRelativeUrls&&q.verifyItemRelativeUrls.writtenUrls.push(f)}}f=v(f,q?.portal);u.isAbsolute(f)&&(f=u.normalize(f));q?.resources&&q?.portalItem&&!u.isAbsolute(f)&&!u.isDataProtocol(f)&&I===d.MarkKeep.YES&&q.resources.toKeep.push({resource:q.portalItem.resourceFromPath(f),compress:!1});return f}function a(b,q,I){return r(b,I)}function p(b,q,I,f){b=M(b,f);void 0!==b&&(q[I]=b)}function k(b){return(b?.match(J)??null)?.[1]??null}function y(b){b=b?.match(J)??null;if(null==
b)return null;b=b[2];const q=b.lastIndexOf("/");if(-1===q){const {path:G,extension:O}=u.splitPathExtension(b);return{prefix:null,filename:G,extension:O}}const {path:I,extension:f}=u.splitPathExtension(b.slice(q+1));return{prefix:b.slice(0,q),filename:I,extension:f}}function v(b,q){return q&&!q.isPortal&&q.urlKey&&q.customBaseUrl?u.changeDomain(b,`${q.urlKey}.${q.customBaseUrl}`,q.portalHostname):b}function D(b,q){if(!q||q.isPortal||!q.urlKey||!q.customBaseUrl)return b;const I=`${q.urlKey}.${q.customBaseUrl}`,
f=u.getAppUrl();return u.hasSameOrigin(f,`${f.scheme}://${I}`)?u.changeDomain(b,q.portalHostname,I):u.changeDomain(b,I,q.portalHostname)}function F(b){if(!b)return b||null;b&&g.id&&!g.id.findCredential(b)&&(b=z.normalizeArcGISOnlineOrgDomain(b),b=b.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),b=b.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),b=b.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return b}function t(b){if(!b)return b||
null;b=b.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");b=b.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(b=b.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&g.id&&!g.id.findCredential(b)&&(b=z.normalizeArcGISOnlineOrgDomain(b));return b}const J=/\/items\/([^/]+)\/resources\/(.*)/,L=/^\.\/resources\//;d.MarkKeep=void 0;(function(b){b[b.YES=0]="YES";b[b.NO=1]="NO"})(d.MarkKeep||(d.MarkKeep={}));const w=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return d.MarkKeep},ensureMainOnlineDomain:v,fromCDNUrl:t,fromJSON:r,itemIdFromResourceUrl:k,prefixAndFilenameFromResourceUrl:y,read:a,toCDNUrl:F,toJSON:M,write:p},Symbol.toStringTag,{value:"Module"}));d.ensureMainOnlineDomain=v;d.fromCDNUrl=t;d.fromJSON=r;d.itemIdFromResourceUrl=k;d.persistableUrlUtils=w;d.prefixAndFilenameFromResourceUrl=y;d.read=a;d.toCDNUrl=F;d.toJSON=M;d.write=p})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(d,
g,u){d.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return g.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};d.getBasemapTitle=async function(z){if(z){var r=z.includes("-vector")?z.slice(0,z.indexOf("-vector")):
z.includes("-3d")?z.slice(0,z.indexOf("-3d")):z,M=await u.fetchMessageBundle("esri/t9n/basemaps");return M[z]||M[r]}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(d,g,u,z,r,M,a,p){const k=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
g=class extends g{constructor(y){super(y);this.places=this.language=this.id=this.apiKey=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var y=p.getLocale().toLowerCase();switch(y){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}y=p.getLanguage(y);return"pt"===y?"pt-BR":y&&k.has(y)?
y:"global"}};d.__decorate([u.property()],g.prototype,"apiKey",void 0);d.__decorate([u.property()],g.prototype,"id",void 0);d.__decorate([u.property()],g.prototype,"language",void 0);d.__decorate([u.property()],g.prototype,"places",void 0);d.__decorate([u.property()],g.prototype,"serviceUrl",void 0);d.__decorate([u.property()],g.prototype,"worldview",void 0);return g=d.__decorate([a.subclass("esri.support.BasemapStyle")],g)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(d,g,u,z,r,M){function a(y,v){"maxScale"in y&&(v.maxScale=r.numberToJSON(y.maxScale)??void 0);"minScale"in y&&(v.minScale=r.numberToJSON(y.minScale)??void 0)}const p=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),k=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
d.disableRestrictedWriting=function(y){p.add(y);k.add(y)};d.enableRestrictedWriting=function(y){p.delete(y);k.delete(y)};d.getLayerJSON=function(y,v,D){if(!y.persistenceEnabled)return null;if(!("write"in y&&y.write))return D?.messages&&D.messages.push(new g("layer:unsupported",`Layers (${y.title}, ${y.id}) of type '${y.declaredClass}' cannot be persisted`,{layer:y})),null;if(M.isFeatureCollectionLayer(y)&&!y.isTable)v=y.resourceInfo;else{if(D.restrictedWebMapWriting){var F="basemap"===D.layerContainerType?
p:"operational-layers"===D.layerContainerType?k:null;F=null!=F?F.has(y.type)&&!M.isFeatureCollectionLayer(y):!0}else F=!0;if(F)return v={},y.write(v,D)?v:null}if(null!=v){v=u.clone(v);if(D=v)M.isFeatureCollectionLayer(y)?(F=z.getDeepValue("featureCollection.layers",D)?.[0]?.layerDefinition)&&a(y,F):"group"!==y.type&&a(y,D);if(D&&(D.id=y.id,"blendMode"in y&&(D.blendMode=y.blendMode,"normal"===D.blendMode&&delete D.blendMode),D.opacity=r.numberToJSON(y.opacity)??void 0,D.title=y.title||"Layer",D.visibility=
y.visible,"legendEnabled"in y&&"wmts"!==y.type))if(M.isFeatureCollectionLayer(y)){if(D=D.featureCollection)D.showLegend=y.legendEnabled}else D.showLegend=y.legendEnabled}return v};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(d,g,u){function z(a){return"scene"===a?.type}function r(a){return null!=a&&"object"===typeof a&&"type"in a&&"subtype-group"===a.type&&"sublayers"in a}function M(a){a=
a?.type;return"imagery-tile"===a||"tile"===a||"open-street-map"===a||"vector-tile"===a||"web-tile"===a||"wmts"===a}d.getEffectiveEditingEnabled=function(a){a:if("editingEnabled"in a)switch(a.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveEditingEnabled"in a?a.effectiveEditingEnabled:a.editingEnabled:!1};d.getEffectiveLayerCapabilities=function(a){a:if("capabilities"in
a)switch(a.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var p=!0;break a;default:p=!1}else p=!1;return p?"effectiveCapabilities"in a?a.effectiveCapabilities:a.capabilities:null};d.getOwningPortalUrl=async function(a,p){var k=g.id?.findServerInfo(a);if(null!=k?.currentVersion)return k.owningSystemUrl||
null;k=a.toLowerCase().indexOf("/rest/services");if(-1===k)return null;a=`${a.slice(0,k)}/rest/info`;({data:p}=await u(a,{query:{f:"json"},responseType:"json",signal:null!=p?p.signal:null}));return p?.owningSystemUrl||null};d.getSubtypesFromLayer=function(a){return a?("subtypes"in a?a.subtypes:r(a.parent)?a.parent.subtypes:[])??[]:[]};d.getTileMaxtrixSetFromActiveLayer=function(a){if(a.activeLayer){const p=a.activeLayer.tileMatrixSet;if(p)return p;if(a=a.activeLayer.tileMatrixSets)return a}return null};
d.isBaseLayer=function(a){return null!=a?.parent&&"declaredClass"in a.parent&&"esri.Basemap"===a.parent.declaredClass&&a.parent.baseLayers.includes(a)};d.isBasemap3DSupportedLayer=function(a){return M(a)||z(a)};d.isBasemapSupportedTiledLayer=M;d.isFeatureCollectionLayer=function(a){return"feature"===a?.type&&!a.url&&"memory"===a.source?.type};d.isFeatureLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"feature"===a.type};d.isFeatureServiceLayer=function(a){return"feature"===a?.type&&
"feature-layer"===a.source?.type};d.isGraphicsLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"graphics"===a.type};d.isGroupLayer=function(a){return null!=a&&"type"in a&&"group"===a.type};d.isImageryTileLayer=function(a){return"imagery-tile"===a?.type};d.isIntegratedMeshLayer=function(a){return"integrated-mesh"===a||"integrated-mesh-3dtiles"===a};d.isIntegratedMeshOperationalLayer=function(a){return"IntegratedMeshLayer"===a||"IntegratedMesh3DTilesLayer"===a};d.isKnowledgeGraphLayer=
function(a){return null!=a&&"object"===typeof a&&"type"in a&&"knowledge-graph"===a.type&&"layers"in a};d.isLayerWithFeatureLayerSource=function(a){const p=a?.type;return("feature"===p||"subtype-group"===p||"oriented-imagery"===p)&&"feature-layer"===a.source?.type};d.isLinkChartLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"link-chart"===a.type&&"layers"in a};d.isMapNotesLayer=function(a){return null!=a&&"object"===typeof a&&"type"in a&&"map-notes"===a.type&&"sublayers"in a};d.isSceneLayer=
z;d.isSceneServiceLayer=function(a){a=a?.type;return"building-scene"===a||"integrated-mesh"===a||"point-cloud"===a||"scene"===a};d.isSubtypeGroupLayer=r;d.isSubtypeSublayer=function(a){return"subtype-sublayer"===a?.type};d.isTable=function(a){return null!=a&&"object"===typeof a&&"isTable"in a&&!!a.isTable};d.isTiledLayer=function(a){a=a?.type;return"base-tile"===a||"tile"===a||"elevation"===a||"imagery-tile"===a||"base-elevation"===a||"open-street-map"===a||"wcs"===a||"web-tile"===a||"wmts"===a||
"vector-tile"===a};d.isVoxelLayer=function(a){return"voxel"===a?.type};d.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};d.serializeLayerDefinitions=function(a){const p=/[:;]/,k=[];let y=!1;if(a&&(a.forEach((v,D)=>{k.push([D,v]);!y&&p.test(v)&&(y=!0)}),0<k.length)){if(y){const v={};k.forEach(D=>{v[D[0]]=D[1]});a=JSON.stringify(v)}else{const v=[];k.forEach(D=>{v.push(D[0]+":"+
D[1])});a=v.join(";")}return a}return null};d.serializeTimeOptions=function(a){if(a){var p=[];a.forEach((k,y)=>{p.push('"'+y+'":'+JSON.stringify(k))});if(p.length)return"{"+p.join(",")+"}"}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(d,g){d.canInterpolateEffects=function(u,z){const r=u.length>z.length?u:z;return(u.length>z.length?z:u).every((M,a)=>M.type===r[a].type)};d.effectEquals=function(u,z){u=
JSON.stringify(u??null);z=JSON.stringify(z??null);return u===z};d.isEffectFunctions=function(u){return(u=u[0])?"type"in u:!1};d.normalizeEffects=function(u,z){const r=u.length>z.length?u:z;u=u.length>z.length?z:u;for(z=u.length;z<r.length;z++)u.push(g.createEffectWithInitialValues(r[z]))};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32",
"./colorMatrixFunctions"],function(d,g,u,z,r){function M(t,J,L){return t+(J-t)*L}function a(t){return Math.round(1E3*u.px2pt(t))/1E3}class p{constructor(t,J,L){this.strength=t;this.radius=J;this.threshold=L;this.type="bloom"}interpolate(t,J,L){this.strength=M(t.strength,J.strength,L);this.radius=M(t.radius,J.radius,L);this.threshold=M(t.threshold,J.threshold,L)}clone(){return new p(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:a(this.radius),strength:this.strength,
threshold:this.threshold}}}class k{constructor(t){this.radius=t;this.type="blur"}interpolate(t,J,L){this.radius=Math.round(M(t.radius,J.radius,L))}clone(){return new k(this.radius)}toJSON(){return{type:"blur",radius:a(this.radius)}}}class y{constructor(t,J){this.type=t;this.amount=J;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(t,J,L){this.amount=
M(t.amount,J.amount,L);this._updateMatrix()}clone(){return new y(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||z.create();switch(this.type){case "brightness":this._colorMatrix=r.brightness(t,this.amount);break;case "contrast":this._colorMatrix=r.contrast(t,this.amount);break;case "grayscale":this._colorMatrix=r.grayscale(t,this.amount);break;case "invert":this._colorMatrix=r.invert(t,this.amount);break;case "saturate":this._colorMatrix=
r.saturate(t,this.amount);break;case "sepia":this._colorMatrix=r.sepia(t,this.amount)}}}class v{constructor(t,J,L,w){this.offsetX=t;this.offsetY=J;this.blurRadius=L;this.color=w;this.type="drop-shadow"}interpolate(t,J,L){this.offsetX=M(t.offsetX,J.offsetX,L);this.offsetY=M(t.offsetY,J.offsetY,L);this.blurRadius=M(t.blurRadius,J.blurRadius,L);this.color[0]=Math.round(M(t.color[0],J.color[0],L));this.color[1]=Math.round(M(t.color[1],J.color[1],L));this.color[2]=Math.round(M(t.color[2],J.color[2],L));
this.color[3]=M(t.color[3],J.color[3],L)}clone(){return new v(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];t[3]*=255;return{type:"drop-shadow",xoffset:a(this.offsetX),yoffset:a(this.offsetY),blurRadius:a(this.blurRadius),color:t}}}class D{constructor(t){this.angle=t;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(t,J,L){this.angle=M(t.angle,J.angle,L);this._updateMatrix()}clone(){return new D(this.angle)}toJSON(){return{type:"hue-rotate",
angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||z.create();this._colorMatrix=r.rotateHue(t,this.angle)}}class F{constructor(t){this.amount=t;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(t,J,L){this.amount=M(t.amount,J.amount,L)}clone(){return new F(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}d.BloomEffect=p;d.BlurEffect=k;d.ColorMatrixEffect=y;d.DropShadowEffect=v;d.HueRotateEffect=D;d.OpacityEffect=F;d.createEffectWithInitialValues=function(t){switch(t.type){case "grayscale":case "sepia":case "invert":return new y(t.type,
0);case "saturate":case "brightness":case "contrast":return new y(t.type,1);case "opacity":return new F(1);case "hue-rotate":return new D(0);case "blur":return new k(0);case "drop-shadow":return new v(0,0,0,[...g.getNamedColor("transparent")]);case "bloom":return new p(0,0,1)}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(d){function g(){const p=new Float32Array(16);p[0]=1;p[5]=1;p[10]=1;p[15]=
1;return p}function u(p){const k=new Float32Array(16);k[0]=p[0];k[1]=p[1];k[2]=p[2];k[3]=p[3];k[4]=p[4];k[5]=p[5];k[6]=p[6];k[7]=p[7];k[8]=p[8];k[9]=p[9];k[10]=p[10];k[11]=p[11];k[12]=p[12];k[13]=p[13];k[14]=p[14];k[15]=p[15];return k}function z(p,k,y,v,D,F,t,J,L,w,b,q,I,f,G,O){const Q=new Float32Array(16);Q[0]=p;Q[1]=k;Q[2]=y;Q[3]=v;Q[4]=D;Q[5]=F;Q[6]=t;Q[7]=J;Q[8]=L;Q[9]=w;Q[10]=b;Q[11]=q;Q[12]=I;Q[13]=f;Q[14]=G;Q[15]=O;return Q}function r(p,k){return new Float32Array(p,k,16)}const M=g(),a=Object.freeze(Object.defineProperty({__proto__:null,
IDENTITY:M,clone:u,create:g,createView:r,fromValues:z},Symbol.toStringTag,{value:"Module"}));d.IDENTITY=M;d.clone=u;d.create=g;d.createView=r;d.fromValues=z;d.mat4f32=a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(d,g){d.brightness=(u,z)=>{u=g.set(u,z,0,0,0,0,z,0,0,0,0,z,0,0,0,0,1);return g.transpose(u,u)};d.contrast=(u,z)=>{u=g.set(u,z,0,0,.5-.5*z,0,z,0,.5-
.5*z,0,0,z,.5-.5*z,0,0,0,1);return g.transpose(u,u)};d.grayscale=(u,z)=>{z=1-z;u=g.set(u,.2126+.7874*z,.7152-.7152*z,.0722-.0722*z,0,.2126-.2126*z,.7152+.2848*z,.0722-.0722*z,0,.2126-.2126*z,.7152-.7152*z,.0722+.9278*z,0,0,0,0,1);return g.transpose(u,u)};d.invert=(u,z)=>{const r=1-2*z;u=g.set(u,r,0,0,z,0,r,0,z,0,0,r,z,0,0,0,1);return g.transpose(u,u)};d.rotateHue=(u,z)=>{const r=Math.sin(z*Math.PI/180);z=Math.cos(z*Math.PI/180);u=g.set(u,.213+.787*z-.213*r,.715-.715*z-.715*r,.072-.072*z+.928*r,0,
.213-.213*z+.143*r,.715+.285*z+.14*r,.072-.072*z-.283*r,0,.213-.213*z-.787*r,.715-.715*z+.715*r,.072+.928*z+.072*r,0,0,0,0,1);return g.transpose(u,u)};d.saturate=(u,z)=>{u=g.set(u,.213+.787*z,.715-.715*z,.072-.072*z,0,.213-.213*z,.715+.285*z,.072-.072*z,0,.213-.213*z,.715-.715*z,.072+.928*z,0,0,0,0,1);return g.transpose(u,u)};d.sepia=(u,z)=>{z=1-z;u=g.set(u,.393+.607*z,.769-.769*z,.189-.189*z,0,.349-.349*z,.686+.314*z,.168-.168*z,0,.272-.272*z,.534-.534*z,.131+.869*z,0,0,0,0,1);return g.transpose(u,
u)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(d,g,u){function z(l,H){l[0]=H[0];l[1]=H[1];l[2]=H[2];l[3]=H[3];l[4]=H[4];l[5]=H[5];l[6]=H[6];l[7]=H[7];l[8]=H[8];l[9]=H[9];l[10]=H[10];l[11]=H[11];l[12]=H[12];l[13]=H[13];l[14]=H[14];l[15]=H[15];return l}function r(l,H,W,ba,la,C,K,N,V,aa,ea,ha,oa,pa,xa,ua,va){l[0]=H;l[1]=W;l[2]=ba;l[3]=la;l[4]=C;l[5]=K;l[6]=N;l[7]=V;l[8]=
aa;l[9]=ea;l[10]=ha;l[11]=oa;l[12]=pa;l[13]=xa;l[14]=ua;l[15]=va;return l}function M(l){l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=1;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function a(l,H){if(l===H){const W=H[1],ba=H[2],la=H[3],C=H[6],K=H[7],N=H[11];l[1]=H[4];l[2]=H[8];l[3]=H[12];l[4]=W;l[6]=H[9];l[7]=H[13];l[8]=ba;l[9]=C;l[11]=H[14];l[12]=la;l[13]=K;l[14]=N}else l[0]=H[0],l[1]=H[4],l[2]=H[8],l[3]=H[12],l[4]=H[1],l[5]=H[5],l[6]=H[9],l[7]=H[13],l[8]=H[2],l[9]=
H[6],l[10]=H[10],l[11]=H[14],l[12]=H[3],l[13]=H[7],l[14]=H[11],l[15]=H[15];return l}function p(l,H){k(l,H)||M(l);return l}function k(l,H){const W=H[0],ba=H[1],la=H[2],C=H[3],K=H[4],N=H[5],V=H[6],aa=H[7],ea=H[8],ha=H[9],oa=H[10],pa=H[11],xa=H[12],ua=H[13],va=H[14];H=H[15];const Ea=W*N-ba*K,Ba=W*V-la*K,Da=W*aa-C*K,Fa=ba*V-la*N,Ca=ba*aa-C*N,Ia=la*aa-C*V,Ta=ea*ua-ha*xa,bb=ea*va-oa*xa,cb=ea*H-pa*xa,Ya=ha*va-oa*ua,Oa=ha*H-pa*ua,Pa=oa*H-pa*va;let ka=Ea*Pa-Ba*Oa+Da*Ya+Fa*cb-Ca*bb+Ia*Ta;if(!ka)return null;
ka=1/ka;l[0]=(N*Pa-V*Oa+aa*Ya)*ka;l[1]=(la*Oa-ba*Pa-C*Ya)*ka;l[2]=(ua*Ia-va*Ca+H*Fa)*ka;l[3]=(oa*Ca-ha*Ia-pa*Fa)*ka;l[4]=(V*cb-K*Pa-aa*bb)*ka;l[5]=(W*Pa-la*cb+C*bb)*ka;l[6]=(va*Da-xa*Ia-H*Ba)*ka;l[7]=(ea*Ia-oa*Da+pa*Ba)*ka;l[8]=(K*Oa-N*cb+aa*Ta)*ka;l[9]=(ba*cb-W*Oa-C*Ta)*ka;l[10]=(xa*Ca-ua*Da+H*Ea)*ka;l[11]=(ha*Da-ea*Ca-pa*Ea)*ka;l[12]=(N*bb-K*Ya-V*Ta)*ka;l[13]=(W*Ya-ba*bb+la*Ta)*ka;l[14]=(ua*Ba-xa*Fa-va*Ea)*ka;l[15]=(ea*Fa-ha*Ba+oa*Ea)*ka;return l}function y(l,H){const W=H[0],ba=H[1],la=H[2],C=H[3],
K=H[4],N=H[5],V=H[6],aa=H[7],ea=H[8],ha=H[9],oa=H[10],pa=H[11],xa=H[12],ua=H[13],va=H[14];H=H[15];l[0]=N*(oa*H-pa*va)-ha*(V*H-aa*va)+ua*(V*pa-aa*oa);l[1]=-(ba*(oa*H-pa*va)-ha*(la*H-C*va)+ua*(la*pa-C*oa));l[2]=ba*(V*H-aa*va)-N*(la*H-C*va)+ua*(la*aa-C*V);l[3]=-(ba*(V*pa-aa*oa)-N*(la*pa-C*oa)+ha*(la*aa-C*V));l[4]=-(K*(oa*H-pa*va)-ea*(V*H-aa*va)+xa*(V*pa-aa*oa));l[5]=W*(oa*H-pa*va)-ea*(la*H-C*va)+xa*(la*pa-C*oa);l[6]=-(W*(V*H-aa*va)-K*(la*H-C*va)+xa*(la*aa-C*V));l[7]=W*(V*pa-aa*oa)-K*(la*pa-C*oa)+ea*
(la*aa-C*V);l[8]=K*(ha*H-pa*ua)-ea*(N*H-aa*ua)+xa*(N*pa-aa*ha);l[9]=-(W*(ha*H-pa*ua)-ea*(ba*H-C*ua)+xa*(ba*pa-C*ha));l[10]=W*(N*H-aa*ua)-K*(ba*H-C*ua)+xa*(ba*aa-C*N);l[11]=-(W*(N*pa-aa*ha)-K*(ba*pa-C*ha)+ea*(ba*aa-C*N));l[12]=-(K*(ha*va-oa*ua)-ea*(N*va-V*ua)+xa*(N*oa-V*ha));l[13]=W*(ha*va-oa*ua)-ea*(ba*va-la*ua)+xa*(ba*oa-la*ha);l[14]=-(W*(N*va-V*ua)-K*(ba*va-la*ua)+xa*(ba*V-la*N));l[15]=W*(N*oa-V*ha)-K*(ba*oa-la*ha)+ea*(ba*V-la*N);return l}function v(l){const H=l[0],W=l[1],ba=l[2],la=l[3],C=l[4],
K=l[5],N=l[6],V=l[7],aa=l[8],ea=l[9],ha=l[10],oa=l[11],pa=l[12],xa=l[13],ua=l[14];l=l[15];return(H*K-W*C)*(ha*l-oa*ua)-(H*N-ba*C)*(ea*l-oa*xa)+(H*V-la*C)*(ea*ua-ha*xa)+(W*N-ba*K)*(aa*l-oa*pa)-(W*V-la*K)*(aa*ua-ha*pa)+(ba*V-la*N)*(aa*xa-ea*pa)}function D(l,H,W){const ba=H[0],la=H[1],C=H[2],K=H[3],N=H[4],V=H[5],aa=H[6],ea=H[7],ha=H[8],oa=H[9],pa=H[10],xa=H[11],ua=H[12],va=H[13],Ea=H[14];H=H[15];let Ba=W[0],Da=W[1],Fa=W[2],Ca=W[3];l[0]=Ba*ba+Da*N+Fa*ha+Ca*ua;l[1]=Ba*la+Da*V+Fa*oa+Ca*va;l[2]=Ba*C+Da*
aa+Fa*pa+Ca*Ea;l[3]=Ba*K+Da*ea+Fa*xa+Ca*H;Ba=W[4];Da=W[5];Fa=W[6];Ca=W[7];l[4]=Ba*ba+Da*N+Fa*ha+Ca*ua;l[5]=Ba*la+Da*V+Fa*oa+Ca*va;l[6]=Ba*C+Da*aa+Fa*pa+Ca*Ea;l[7]=Ba*K+Da*ea+Fa*xa+Ca*H;Ba=W[8];Da=W[9];Fa=W[10];Ca=W[11];l[8]=Ba*ba+Da*N+Fa*ha+Ca*ua;l[9]=Ba*la+Da*V+Fa*oa+Ca*va;l[10]=Ba*C+Da*aa+Fa*pa+Ca*Ea;l[11]=Ba*K+Da*ea+Fa*xa+Ca*H;Ba=W[12];Da=W[13];Fa=W[14];Ca=W[15];l[12]=Ba*ba+Da*N+Fa*ha+Ca*ua;l[13]=Ba*la+Da*V+Fa*oa+Ca*va;l[14]=Ba*C+Da*aa+Fa*pa+Ca*Ea;l[15]=Ba*K+Da*ea+Fa*xa+Ca*H;return l}function F(l,
H,W){const ba=W[0],la=W[1];W=W[2];if(H===l)l[12]=H[0]*ba+H[4]*la+H[8]*W+H[12],l[13]=H[1]*ba+H[5]*la+H[9]*W+H[13],l[14]=H[2]*ba+H[6]*la+H[10]*W+H[14],l[15]=H[3]*ba+H[7]*la+H[11]*W+H[15];else{const C=H[0],K=H[1],N=H[2],V=H[3],aa=H[4],ea=H[5],ha=H[6],oa=H[7],pa=H[8],xa=H[9],ua=H[10],va=H[11];l[0]=C;l[1]=K;l[2]=N;l[3]=V;l[4]=aa;l[5]=ea;l[6]=ha;l[7]=oa;l[8]=pa;l[9]=xa;l[10]=ua;l[11]=va;l[12]=C*ba+aa*la+pa*W+H[12];l[13]=K*ba+ea*la+xa*W+H[13];l[14]=N*ba+ha*la+ua*W+H[14];l[15]=V*ba+oa*la+va*W+H[15]}return l}
function t(l,H,W){const ba=W[0],la=W[1];W=W[2];l[0]=H[0]*ba;l[1]=H[1]*ba;l[2]=H[2]*ba;l[3]=H[3]*ba;l[4]=H[4]*la;l[5]=H[5]*la;l[6]=H[6]*la;l[7]=H[7]*la;l[8]=H[8]*W;l[9]=H[9]*W;l[10]=H[10]*W;l[11]=H[11]*W;l[12]=H[12];l[13]=H[13];l[14]=H[14];l[15]=H[15];return l}function J(l,H,W,ba){var la=ba[0],C=ba[1];ba=ba[2];var K=Math.sqrt(la*la+C*C+ba*ba);if(K<=u.getEpsilon())z(l,H);else{K=1/K;la*=K;C*=K;ba*=K;var N=Math.sin(W),V=Math.cos(W),aa=1-V;W=H[0];K=H[1];var ea=H[2],ha=H[3],oa=H[4],pa=H[5],xa=H[6],ua=H[7],
va=H[8],Ea=H[9],Ba=H[10],Da=H[11],Fa=la*la*aa+V,Ca=C*la*aa+ba*N,Ia=ba*la*aa-C*N,Ta=la*C*aa-ba*N,bb=C*C*aa+V,cb=ba*C*aa+la*N,Ya=la*ba*aa+C*N;la=C*ba*aa-la*N;C=ba*ba*aa+V;l[0]=W*Fa+oa*Ca+va*Ia;l[1]=K*Fa+pa*Ca+Ea*Ia;l[2]=ea*Fa+xa*Ca+Ba*Ia;l[3]=ha*Fa+ua*Ca+Da*Ia;l[4]=W*Ta+oa*bb+va*cb;l[5]=K*Ta+pa*bb+Ea*cb;l[6]=ea*Ta+xa*bb+Ba*cb;l[7]=ha*Ta+ua*bb+Da*cb;l[8]=W*Ya+oa*la+va*C;l[9]=K*Ya+pa*la+Ea*C;l[10]=ea*Ya+xa*la+Ba*C;l[11]=ha*Ya+ua*la+Da*C;H!==l&&(l[12]=H[12],l[13]=H[13],l[14]=H[14],l[15]=H[15])}}function L(l,
H,W){const ba=Math.sin(W);W=Math.cos(W);const la=H[4],C=H[5],K=H[6],N=H[7],V=H[8],aa=H[9],ea=H[10],ha=H[11];H!==l&&(l[0]=H[0],l[1]=H[1],l[2]=H[2],l[3]=H[3],l[12]=H[12],l[13]=H[13],l[14]=H[14],l[15]=H[15]);l[4]=la*W+V*ba;l[5]=C*W+aa*ba;l[6]=K*W+ea*ba;l[7]=N*W+ha*ba;l[8]=V*W-la*ba;l[9]=aa*W-C*ba;l[10]=ea*W-K*ba;l[11]=ha*W-N*ba;return l}function w(l,H,W){const ba=Math.sin(W);W=Math.cos(W);const la=H[0],C=H[1],K=H[2],N=H[3],V=H[8],aa=H[9],ea=H[10],ha=H[11];H!==l&&(l[4]=H[4],l[5]=H[5],l[6]=H[6],l[7]=H[7],
l[12]=H[12],l[13]=H[13],l[14]=H[14],l[15]=H[15]);l[0]=la*W-V*ba;l[1]=C*W-aa*ba;l[2]=K*W-ea*ba;l[3]=N*W-ha*ba;l[8]=la*ba+V*W;l[9]=C*ba+aa*W;l[10]=K*ba+ea*W;l[11]=N*ba+ha*W;return l}function b(l,H,W){const ba=Math.sin(W);W=Math.cos(W);const la=H[0],C=H[1],K=H[2],N=H[3],V=H[4],aa=H[5],ea=H[6],ha=H[7];H!==l&&(l[8]=H[8],l[9]=H[9],l[10]=H[10],l[11]=H[11],l[12]=H[12],l[13]=H[13],l[14]=H[14],l[15]=H[15]);l[0]=la*W+V*ba;l[1]=C*W+aa*ba;l[2]=K*W+ea*ba;l[3]=N*W+ha*ba;l[4]=V*W-la*ba;l[5]=aa*W-C*ba;l[6]=ea*W-K*
ba;l[7]=ha*W-N*ba;return l}function q(l,H){l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=1;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=H[0];l[13]=H[1];l[14]=H[2];l[15]=1;return l}function I(l,H){l[0]=H[0];l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=H[1];l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=H[2];l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function f(l,H,W){if(0===H)return M(l);let ba=W[0],la=W[1];W=W[2];var C=Math.sqrt(ba*ba+la*la+W*W);if(C<=u.getEpsilon())return null;C=1/C;ba*=C;la*=C;W*=C;C=Math.sin(H);H=
Math.cos(H);const K=1-H;l[0]=ba*ba*K+H;l[1]=la*ba*K+W*C;l[2]=W*ba*K-la*C;l[3]=0;l[4]=ba*la*K-W*C;l[5]=la*la*K+H;l[6]=W*la*K+ba*C;l[7]=0;l[8]=ba*W*K+la*C;l[9]=la*W*K-ba*C;l[10]=W*W*K+H;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function G(l,H){const W=Math.sin(H);H=Math.cos(H);l[0]=1;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=H;l[6]=W;l[7]=0;l[8]=0;l[9]=-W;l[10]=H;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function O(l,H){const W=Math.sin(H);H=Math.cos(H);l[0]=H;l[1]=0;l[2]=-W;l[3]=0;l[4]=0;l[5]=
1;l[6]=0;l[7]=0;l[8]=W;l[9]=0;l[10]=H;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function Q(l,H){const W=Math.sin(H);H=Math.cos(H);l[0]=H;l[1]=W;l[2]=0;l[3]=0;l[4]=-W;l[5]=H;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=1;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function Z(l,H,W){var ba=H[0],la=H[1],C=H[2],K=H[3],N=ba+ba,V=la+la;const aa=C+C;H=ba*N;const ea=ba*V;ba*=aa;const ha=la*V;la*=aa;C*=aa;N*=K;V*=K;K*=aa;l[0]=1-(ha+C);l[1]=ea+K;l[2]=ba-V;l[3]=0;l[4]=ea-K;l[5]=1-(H+C);l[6]=la+N;l[7]=0;l[8]=
ba+V;l[9]=la-N;l[10]=1-(H+ha);l[11]=0;l[12]=W[0];l[13]=W[1];l[14]=W[2];l[15]=1;return l}function U(l,H){const W=Ga,ba=-H[0],la=-H[1],C=-H[2],K=H[3],N=H[4],V=H[5],aa=H[6],ea=H[7],ha=ba*ba+la*la+C*C+K*K;0<ha?(W[0]=2*(N*K+ea*ba+V*C-aa*la)/ha,W[1]=2*(V*K+ea*la+aa*ba-N*C)/ha,W[2]=2*(aa*K+ea*C+N*la-V*ba)/ha):(W[0]=2*(N*K+ea*ba+V*C-aa*la),W[1]=2*(V*K+ea*la+aa*ba-N*C),W[2]=2*(aa*K+ea*C+N*la-V*ba));Z(l,H,W);return l}function T(l,H){l[0]=H[12];l[1]=H[13];l[2]=H[14];return l}function x(l,H){const W=H[0],ba=
H[1],la=H[2],C=H[4],K=H[5],N=H[6],V=H[8],aa=H[9];H=H[10];l[0]=Math.sqrt(W*W+ba*ba+la*la);l[1]=Math.sqrt(C*C+K*K+N*N);l[2]=Math.sqrt(V*V+aa*aa+H*H);return l}function R(l,H){const W=H[0]+H[5]+H[10];let ba=0;0<W?(ba=2*Math.sqrt(W+1),l[3]=.25*ba,l[0]=(H[6]-H[9])/ba,l[1]=(H[8]-H[2])/ba,l[2]=(H[1]-H[4])/ba):H[0]>H[5]&&H[0]>H[10]?(ba=2*Math.sqrt(1+H[0]-H[5]-H[10]),l[3]=(H[6]-H[9])/ba,l[0]=.25*ba,l[1]=(H[1]+H[4])/ba,l[2]=(H[8]+H[2])/ba):H[5]>H[10]?(ba=2*Math.sqrt(1+H[5]-H[0]-H[10]),l[3]=(H[8]-H[2])/ba,l[0]=
(H[1]+H[4])/ba,l[1]=.25*ba,l[2]=(H[6]+H[9])/ba):(ba=2*Math.sqrt(1+H[10]-H[0]-H[5]),l[3]=(H[1]-H[4])/ba,l[0]=(H[8]+H[2])/ba,l[1]=(H[6]+H[9])/ba,l[2]=.25*ba);return l}function h(l,H,W,ba){var la=H[0],C=H[1],K=H[2],N=H[3],V=la+la,aa=C+C,ea=K+K;H=la*V;const ha=la*aa;la*=ea;const oa=C*aa;C*=ea;K*=ea;V*=N;aa*=N;N*=ea;ea=ba[0];const pa=ba[1];ba=ba[2];l[0]=(1-(oa+K))*ea;l[1]=(ha+N)*ea;l[2]=(la-aa)*ea;l[3]=0;l[4]=(ha-N)*pa;l[5]=(1-(H+K))*pa;l[6]=(C+V)*pa;l[7]=0;l[8]=(la+aa)*ba;l[9]=(C-V)*ba;l[10]=(1-(H+oa))*
ba;l[11]=0;l[12]=W[0];l[13]=W[1];l[14]=W[2];l[15]=1;return l}function e(l,H,W,ba,la){var C=H[0],K=H[1],N=H[2],V=H[3],aa=C+C,ea=K+K,ha=N+N;H=C*aa;var oa=C*ea,pa=C*ha;C=K*ea;K*=ha;var xa=N*ha;N=V*aa;ea*=V;const ua=V*ha;var va=ba[0],Ea=ba[1];ha=ba[2];ba=la[0];V=la[1];la=la[2];aa=(1-(C+xa))*va;const Ba=(oa+ua)*va;va*=pa-ea;oa=(oa-ua)*Ea;xa=(1-(H+xa))*Ea;Ea*=K+N;pa=(pa+ea)*ha;K=(K-N)*ha;H=(1-(H+C))*ha;l[0]=aa;l[1]=Ba;l[2]=va;l[3]=0;l[4]=oa;l[5]=xa;l[6]=Ea;l[7]=0;l[8]=pa;l[9]=K;l[10]=H;l[11]=0;l[12]=W[0]+
ba-(aa*ba+oa*V+pa*la);l[13]=W[1]+V-(Ba*ba+xa*V+K*la);l[14]=W[2]+la-(va*ba+Ea*V+H*la);l[15]=1;return l}function n(l,H){var W=H[0],ba=H[1],la=H[2];H=H[3];var C=W+W,K=ba+ba;const N=la+la;W*=C;const V=ba*C;ba*=K;const aa=la*C,ea=la*K;la*=N;C*=H;K*=H;H*=N;l[0]=1-ba-la;l[1]=V+H;l[2]=aa-K;l[3]=0;l[4]=V-H;l[5]=1-W-la;l[6]=ea+C;l[7]=0;l[8]=aa+K;l[9]=ea-C;l[10]=1-W-ba;l[11]=0;l[12]=0;l[13]=0;l[14]=0;l[15]=1;return l}function A(l,H,W,ba,la,C,K){const N=1/(W-H),V=1/(la-ba),aa=1/(C-K);l[0]=2*C*N;l[1]=0;l[2]=0;
l[3]=0;l[4]=0;l[5]=2*C*V;l[6]=0;l[7]=0;l[8]=(W+H)*N;l[9]=(la+ba)*V;l[10]=(K+C)*aa;l[11]=-1;l[12]=0;l[13]=0;l[14]=K*C*2*aa;l[15]=0;return l}function P(l,H,W,ba,la){H=1/Math.tan(H/2);let C=void 0;l[0]=H/W;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=H;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[11]=-1;l[12]=0;l[13]=0;l[15]=0;null!=la&&Infinity!==la?(C=1/(ba-la),l[10]=(la+ba)*C,l[14]=2*la*ba*C):(l[10]=-1,l[14]=-2*ba);return l}function X(l,H,W,ba){const la=Math.tan(H.upDegrees*Math.PI/180),C=Math.tan(H.downDegrees*Math.PI/180),
K=Math.tan(H.leftDegrees*Math.PI/180);H=Math.tan(H.rightDegrees*Math.PI/180);const N=2/(K+H),V=2/(la+C);l[0]=N;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=V;l[6]=0;l[7]=0;l[8]=-((K-H)*N*.5);l[9]=(la-C)*V*.5;l[10]=ba/(W-ba);l[11]=-1;l[12]=0;l[13]=0;l[14]=ba*W/(W-ba);l[15]=0;return l}function ca(l,H,W,ba,la,C,K){const N=1/(H-W),V=1/(ba-la),aa=1/(C-K);l[0]=-2*N;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=-2*V;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=2*aa;l[11]=0;l[12]=(H+W)*N;l[13]=(la+ba)*V;l[14]=(K+C)*aa;l[15]=1;return l}function ja(l,
H,W,ba){const la=H[0],C=H[1];H=H[2];let K=la-W[0],N=C-W[1];W=H-W[2];var V=u.getEpsilon();if(Math.abs(K)<V&&Math.abs(N)<V&&Math.abs(W)<V)M(l);else{var aa=1/Math.sqrt(K*K+N*N+W*W);K*=aa;N*=aa;W*=aa;aa=ba[0];var ea=ba[1];V=ba[2];ba=ea*W-V*N;V=V*K-aa*W;ea=aa*N-ea*K;(aa=Math.sqrt(ba*ba+V*V+ea*ea))?(aa=1/aa,ba*=aa,V*=aa,ea*=aa):ea=V=ba=0;var ha=N*ea-W*V,oa=W*ba-K*ea,pa=K*V-N*ba;(aa=Math.sqrt(ha*ha+oa*oa+pa*pa))?(aa=1/aa,ha*=aa,oa*=aa,pa*=aa):pa=oa=ha=0;l[0]=ba;l[1]=ha;l[2]=K;l[3]=0;l[4]=V;l[5]=oa;l[6]=
N;l[7]=0;l[8]=ea;l[9]=pa;l[10]=W;l[11]=0;l[12]=-(ba*la+V*C+ea*H);l[13]=-(ha*la+oa*C+pa*H);l[14]=-(K*la+N*C+W*H);l[15]=1}}function qa(l,H,W,ba){const la=H[0],C=H[1];H=H[2];var K=ba[0];const N=ba[1];var V=ba[2];ba=la-W[0];let aa=C-W[1];W=H-W[2];let ea=ba*ba+aa*aa+W*W;0<ea&&(ea=1/Math.sqrt(ea),ba*=ea,aa*=ea,W*=ea);let ha=N*W-V*aa;V=V*ba-K*W;K=K*aa-N*ba;ea=ha*ha+V*V+K*K;0<ea&&(ea=1/Math.sqrt(ea),ha*=ea,V*=ea,K*=ea);l[0]=ha;l[1]=V;l[2]=K;l[3]=0;l[4]=aa*K-W*V;l[5]=W*ha-ba*K;l[6]=ba*V-aa*ha;l[7]=0;l[8]=
ba;l[9]=aa;l[10]=W;l[11]=0;l[12]=la;l[13]=C;l[14]=H;l[15]=1;return l}function sa(l){return"mat4("+l[0]+", "+l[1]+", "+l[2]+", "+l[3]+", "+l[4]+", "+l[5]+", "+l[6]+", "+l[7]+", "+l[8]+", "+l[9]+", "+l[10]+", "+l[11]+", "+l[12]+", "+l[13]+", "+l[14]+", "+l[15]+")"}function da(l){return Math.sqrt(l[0]**2+l[1]**2+l[2]**2+l[3]**2+l[4]**2+l[5]**2+l[6]**2+l[7]**2+l[8]**2+l[9]**2+l[10]**2+l[11]**2+l[12]**2+l[13]**2+l[14]**2+l[15]**2)}function fa(l,H,W){l[0]=H[0]+W[0];l[1]=H[1]+W[1];l[2]=H[2]+W[2];l[3]=H[3]+
W[3];l[4]=H[4]+W[4];l[5]=H[5]+W[5];l[6]=H[6]+W[6];l[7]=H[7]+W[7];l[8]=H[8]+W[8];l[9]=H[9]+W[9];l[10]=H[10]+W[10];l[11]=H[11]+W[11];l[12]=H[12]+W[12];l[13]=H[13]+W[13];l[14]=H[14]+W[14];l[15]=H[15]+W[15];return l}function na(l,H,W){l[0]=H[0]-W[0];l[1]=H[1]-W[1];l[2]=H[2]-W[2];l[3]=H[3]-W[3];l[4]=H[4]-W[4];l[5]=H[5]-W[5];l[6]=H[6]-W[6];l[7]=H[7]-W[7];l[8]=H[8]-W[8];l[9]=H[9]-W[9];l[10]=H[10]-W[10];l[11]=H[11]-W[11];l[12]=H[12]-W[12];l[13]=H[13]-W[13];l[14]=H[14]-W[14];l[15]=H[15]-W[15];return l}function ra(l,
H,W){l[0]=H[0]*W;l[1]=H[1]*W;l[2]=H[2]*W;l[3]=H[3]*W;l[4]=H[4]*W;l[5]=H[5]*W;l[6]=H[6]*W;l[7]=H[7]*W;l[8]=H[8]*W;l[9]=H[9]*W;l[10]=H[10]*W;l[11]=H[11]*W;l[12]=H[12]*W;l[13]=H[13]*W;l[14]=H[14]*W;l[15]=H[15]*W;return l}function ta(l,H,W,ba){l[0]=H[0]+W[0]*ba;l[1]=H[1]+W[1]*ba;l[2]=H[2]+W[2]*ba;l[3]=H[3]+W[3]*ba;l[4]=H[4]+W[4]*ba;l[5]=H[5]+W[5]*ba;l[6]=H[6]+W[6]*ba;l[7]=H[7]+W[7]*ba;l[8]=H[8]+W[8]*ba;l[9]=H[9]+W[9]*ba;l[10]=H[10]+W[10]*ba;l[11]=H[11]+W[11]*ba;l[12]=H[12]+W[12]*ba;l[13]=H[13]+W[13]*
ba;l[14]=H[14]+W[14]*ba;l[15]=H[15]+W[15]*ba;return l}function za(l,H){return l[0]===H[0]&&l[1]===H[1]&&l[2]===H[2]&&l[3]===H[3]&&l[4]===H[4]&&l[5]===H[5]&&l[6]===H[6]&&l[7]===H[7]&&l[8]===H[8]&&l[9]===H[9]&&l[10]===H[10]&&l[11]===H[11]&&l[12]===H[12]&&l[13]===H[13]&&l[14]===H[14]&&l[15]===H[15]}function Aa(l,H){if(l===H)return!0;const W=l[0],ba=l[1],la=l[2],C=l[3],K=l[4],N=l[5],V=l[6],aa=l[7],ea=l[8],ha=l[9],oa=l[10],pa=l[11],xa=l[12],ua=l[13],va=l[14];l=l[15];const Ea=H[0],Ba=H[1],Da=H[2],Fa=H[3],
Ca=H[4],Ia=H[5],Ta=H[6],bb=H[7],cb=H[8],Ya=H[9],Oa=H[10],Pa=H[11],ka=H[12],ic=H[13],Kb=H[14];H=H[15];const Ma=u.getEpsilon();return Math.abs(W-Ea)<=Ma*Math.max(1,Math.abs(W),Math.abs(Ea))&&Math.abs(ba-Ba)<=Ma*Math.max(1,Math.abs(ba),Math.abs(Ba))&&Math.abs(la-Da)<=Ma*Math.max(1,Math.abs(la),Math.abs(Da))&&Math.abs(C-Fa)<=Ma*Math.max(1,Math.abs(C),Math.abs(Fa))&&Math.abs(K-Ca)<=Ma*Math.max(1,Math.abs(K),Math.abs(Ca))&&Math.abs(N-Ia)<=Ma*Math.max(1,Math.abs(N),Math.abs(Ia))&&Math.abs(V-Ta)<=Ma*Math.max(1,
Math.abs(V),Math.abs(Ta))&&Math.abs(aa-bb)<=Ma*Math.max(1,Math.abs(aa),Math.abs(bb))&&Math.abs(ea-cb)<=Ma*Math.max(1,Math.abs(ea),Math.abs(cb))&&Math.abs(ha-Ya)<=Ma*Math.max(1,Math.abs(ha),Math.abs(Ya))&&Math.abs(oa-Oa)<=Ma*Math.max(1,Math.abs(oa),Math.abs(Oa))&&Math.abs(pa-Pa)<=Ma*Math.max(1,Math.abs(pa),Math.abs(Pa))&&Math.abs(xa-ka)<=Ma*Math.max(1,Math.abs(xa),Math.abs(ka))&&Math.abs(ua-ic)<=Ma*Math.max(1,Math.abs(ua),Math.abs(ic))&&Math.abs(va-Kb)<=Ma*Math.max(1,Math.abs(va),Math.abs(Kb))&&Math.abs(l-
H)<=Ma*Math.max(1,Math.abs(l),Math.abs(H))}function Ha(l){const H=u.getEpsilon(),W=l[0],ba=l[1],la=l[2],C=l[4],K=l[5],N=l[6],V=l[8],aa=l[9];l=l[10];return Math.abs(1-(W*W+C*C+V*V))<=H&&Math.abs(1-(ba*ba+K*K+aa*aa))<=H&&Math.abs(1-(la*la+N*N+l*l))<=H}function Ka(l){return 1===l[0]&&0===l[1]&&0===l[2]&&0===l[4]&&1===l[5]&&0===l[6]&&0===l[8]&&0===l[9]&&1===l[10]}const Ga=g.create();g=Object.freeze(Object.defineProperty({__proto__:null,add:fa,adjoint:y,copy:z,determinant:v,equals:Aa,exactEquals:za,frob:da,
fromQuat:n,fromQuat2:U,fromRotation:f,fromRotationTranslation:Z,fromRotationTranslationScale:h,fromRotationTranslationScaleOrigin:e,fromScaling:I,fromTranslation:q,fromXRotation:G,fromYRotation:O,fromZRotation:Q,frustum:A,getRotation:R,getScaling:x,getTranslation:T,hasIdentityRotation:Ka,identity:M,invert:k,invertOrIdentity:p,isOrthoNormal:Ha,lookAt:ja,mul:D,multiply:D,multiplyScalar:ra,multiplyScalarAndAdd:ta,ortho:ca,perspective:P,perspectiveFromFieldOfView:X,rotate:J,rotateX:L,rotateY:w,rotateZ:b,
scale:t,set:r,str:sa,sub:na,subtract:na,targetTo:qa,translate:F,transpose:a},Symbol.toStringTag,{value:"Module"}));d.add=fa;d.adjoint=y;d.copy=z;d.determinant=v;d.equals=Aa;d.exactEquals=za;d.frob=da;d.fromQuat=n;d.fromQuat2=U;d.fromRotation=f;d.fromRotationTranslation=Z;d.fromRotationTranslationScale=h;d.fromRotationTranslationScaleOrigin=e;d.fromScaling=I;d.fromTranslation=q;d.fromXRotation=G;d.fromYRotation=O;d.fromZRotation=Q;d.frustum=A;d.getRotation=R;d.getScaling=x;d.getTranslation=T;d.hasIdentityRotation=
Ka;d.identity=M;d.invert=k;d.invertOrIdentity=p;d.isOrthoNormal=Ha;d.lookAt=ja;d.mat4=g;d.mul=D;d.multiply=D;d.multiplyScalar=ra;d.multiplyScalarAndAdd=ta;d.ortho=ca;d.perspective=P;d.perspectiveFromFieldOfView=X;d.rotate=J;d.rotateX=L;d.rotateY=w;d.rotateZ=b;d.scale=t;d.set=r;d.str=sa;d.sub=na;d.subtract=na;d.targetTo=qa;d.translate=F;d.transpose=a;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(d,g,u){function z(h){return null==h||"string"===typeof h&&!h?"\x3cNull\x3e":h}function r(h){const e=null!=h.minValue||null!=h.maxValue,n=!!h.sqlExpression&&h.supportsSQLExpression;return!(null!=h.normalizationField||null!=h.normalizationType)&&!e&&!n}function M(h){const {values:e,useSampleStdDev:n,supportsNullCount:A,outStatisticTypes:P}=h;var X=Number.POSITIVE_INFINITY;let ca=Number.NEGATIVE_INFINITY,ja=null,qa=null;var sa=null;let da=null,fa=0;const na=
null==h.minValue?-Infinity:h.minValue,ra=null==h.maxValue?Infinity:h.maxValue;for(const ta of e)Number.isFinite(ta)?ta>=na&&ta<=ra&&(ja=null===ja?ta:ja+ta,X=Math.min(X,ta),ca=Math.max(ca,ta),fa++):"string"===typeof ta&&fa++;if(fa&&null!=ja){qa=ja/fa;sa=0;for(const ta of e)Number.isFinite(ta)&&ta>=na&&ta<=ra&&(sa+=(ta-qa)**2);da=n?1<fa?sa/(fa-1):0:0<fa?sa/fa:0;sa=Math.sqrt(da)}else ca=X=null;X={avg:qa,count:fa,max:ca,min:X,stddev:sa,sum:ja,variance:da};A&&(X.nullcount=e.length-fa);!h.percentileParams||
P?.include?.length&&!P.include.includes("median")||P?.exclude?.length&&P.exclude.includes("median")||(X.median=a(e,h.percentileParams));return X}function a(h,e){const {fieldType:n,value:A,orderBy:P,isDiscrete:X}=e,ca=p(n,"desc"===P);h=[...h].filter(da=>null!=da).sort((da,fa)=>ca(da,fa));if(0===h.length)return null;if(0>=A)return h[0];if(1<=A)return h[h.length-1];var ja=(h.length-1)*A,qa=Math.floor(ja);e=qa+1;ja%=1;qa=h[qa];const sa=h[e];return e>=h.length||X||"string"===typeof qa||"string"===typeof sa?
qa:qa*(1-ja)+sa*ja}function p(h,e){if(h){if(q.has(h))return e?x:R;if(I.has(h))return k(e,!1);if("esriFieldTypeTimestampOffset"===h)return e?Z:Q;const ca=k(e,!0);if("esriFieldTypeString"===h)return ca;if("esriFieldTypeGUID"===h||"esriFieldTypeGlobalID"===h)return(ja,qa)=>ca(y(ja),y(qa))}const n=e?1:-1,A=e?x:R,P=k(e,!0),X=e?G:O;return(ca,ja)=>"number"===typeof ca&&"number"===typeof ja?A(ca,ja):"string"===typeof ca&&"string"===typeof ja?P(ca,ja):X(ca,ja)??n}function k(h,e){if(!e)return h?T:U;const n=
h?G:O;return h?(A,P)=>{const X=n(A,P);if(null!=X)return X;A=A.toUpperCase();P=P.toUpperCase();return A>P?-1:A<P?1:0}:(A,P)=>{const X=n(A,P);if(null!=X)return X;A=A.toUpperCase();P=P.toUpperCase();return A<P?-1:A>P?1:0}}function y(h){return h.slice(24,36)+h.slice(19,23)+h.slice(16,18)+h.slice(14,16)+h.slice(11,13)+h.slice(9,11)+h.slice(6,8)+h.slice(4,6)+h.slice(2,4)+h.slice(0,2)}function v(h){return"coded-value"!==h?.type?[]:h.codedValues.map(e=>e.code)}function D(h,e){const n=t({field:e.field,normalizationType:e.normalizationType,
normalizationField:e.normalizationField,classificationMethod:e.classificationMethod,standardDeviationInterval:e.standardDeviationInterval,breakCount:e.numClasses||5});h=F(h,e.minValue,e.maxValue);return u.createGenerateRendererClassBreaks({definition:n,values:h,normalizationTotal:e.normalizationTotal})}function F(h,e,n){const A=null==e?-Infinity:e,P=null==n?Infinity:n;return h.filter(X=>Number.isFinite(X)&&X>=A&&X<=P)}function t(h){const {breakCount:e,field:n,normalizationField:A,normalizationType:P}=
h,X=h.classificationMethod||"equal-interval";return new g({breakCount:e,classificationField:n,classificationMethod:X,normalizationField:"field"===P?A:void 0,normalizationType:P,standardDeviationInterval:"standard-deviation"===X?h.standardDeviationInterval||1:void 0,definedInterval:"defined-interval"===X?h.definedInterval:void 0})}function J(h,e){const {field:n,classificationMethod:A,standardDeviationInterval:P,normalizationType:X,normalizationField:ca,normalizationTotal:ja,minValue:qa,maxValue:sa}=
e,da=e.numBins||10;let fa=e=null,na=null;A&&"equal-interval"!==A||X?({classBreaks:h}=D(h,{field:n,normalizationType:X,normalizationField:ca,normalizationTotal:ja,classificationMethod:A,standardDeviationInterval:P,minValue:qa,maxValue:sa,numClasses:da}),e=h[0].minValue,fa=h[h.length-1].maxValue,na=h.map(ra=>[ra.minValue,ra.maxValue])):(null!=qa&&null!=sa?(e=qa,fa=sa):(h=M({values:h,minValue:qa,maxValue:sa,useSampleStdDev:!X,supportsNullCount:r({normalizationType:X,normalizationField:ca,minValue:qa,
maxValue:sa})}),e=h.min??null,fa=h.max??null),na=w(e??0,fa??0,da));return{min:e,max:fa,intervals:na}}function L(h,e){let n=-1;for(let A=h.length-1;0<=A;A--)if(e>=h[A][0]){n=A;break}return n}function w(h,e,n){const A=(e-h)/n,P=[];let X;for(let ca=1;ca<=n;ca++)X=h+A,X=Number(X.toFixed(16)),P.push([h,ca===n?e:X]),h=X;return P}const b=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,q=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
I=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),f="min max avg stddev count sum variance nullcount median".split(" "),G=(h,e)=>null==h?null==e?0:1:null==e?-1:null,O=(h,e)=>null==h?null==e?0:-1:null==e?1:null,Q=(h,e)=>O(h,e)??(h===e?0:(new Date(h)).getTime()-(new Date(e)).getTime()),Z=(h,e)=>G(h,e)??(h===e?0:(new Date(e)).getTime()-(new Date(h)).getTime()),U=(h,e)=>O(h,e)??(h===e?0:h<e?-1:1),T=(h,e)=>G(h,e)??(h===e?0:h<e?1:-1),x=(h,e)=>G(h,e)??e-h,R=(h,e)=>O(h,e)??h-e;d.calculateClassBreaks=
D;d.calculateHistogram=function(h,e){var n=J(h,e);if(null==n.min&&null==n.max)return{bins:[],minValue:n.min,maxValue:n.max,normalizationTotal:e.normalizationTotal};const A=n.intervals,P=n.min??0;n=n.max??0;const X=A.map((ca,ja)=>({minValue:A[ja][0],maxValue:A[ja][1],count:0}));for(const ca of h)null!=ca&&ca>=P&&ca<=n&&(h=L(A,ca),-1<h&&X[h].count++);return{bins:X,minValue:P,maxValue:n,normalizationTotal:e.normalizationTotal}};d.calculatePercentile=a;d.calculateStatistics=M;d.calculateStringStatistics=
function(h){const {outStatisticTypes:e}=h,n=h.returnDistinct?[...(new Set(h.values))]:h.values;var A=n.filter(X=>null!=X).sort();const P=A.length;A={count:P,min:A[0],max:A[P-1]};h.supportsNullCount&&(A.nullcount=n.length-P);!h.percentileParams||e?.include?.length&&!e.include.includes("median")||e?.exclude?.length&&e.exclude.includes("median")||(A.median=a(n,h.percentileParams));return A};d.calculateUniqueValuesCount=function(h){const e={};for(let n of h){if(null==n||"string"===typeof n&&""===n.trim())n=
null;null==e[n]?e[n]={count:1,data:n}:e[n].count++}return{count:e}};d.createClassBreaksDefinition=t;d.createUVResult=function(h,e,n,A){h=h.count;const P=[];if(n&&e){n=[];var X=v(e[0]);for(const ca of X)if(e[1]){X=v(e[1]);for(const ja of X)if(e[2]){X=v(e[2]);for(const qa of X)n.push(`${z(ca)}${A}${z(ja)}${A}${z(qa)}`)}else n.push(`${z(ca)}${A}${z(ja)}`)}else n.push(ca);for(const ca of n)h.hasOwnProperty(ca)||(h[ca]={data:ca,count:0})}for(const ca in h)e=h[ca],P.push({value:e.data,count:e.count,label:e.label});
return{uniqueValueInfos:P}};d.getAttributeComparator=p;d.getEqualIntervalBins=w;d.getNormalizedValue=function(h,e,n,A){let P=null;switch(e){case "log":0!==h&&(P=Math.log(h)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(A)&&0!==A&&(P=h/A*100);break;case "field":Number.isFinite(n)&&0!==n&&(P=h/n);break;case "natural-log":0<h&&(P=Math.log(h));break;case "square-root":0<h&&(P=h**.5)}return P};d.isNullCountSupported=r;d.processNullValue=z;d.processSummaryStatisticsResult=function(h,e,n){let A;
for(A in h)e?.include?.length&&!e.include.includes(A)||e?.exclude?.length&&e.exclude.includes(A)?delete h[A]:f.includes(A)&&(Number.isFinite(h[A])||(h[A]=null));if(!n)return h;["avg","stddev","variance"].forEach(P=>{null!=h[P]&&(h[P]=Math.ceil(h[P]??0))});return h};d.resolveCBResult=function(h,e){let n=h.classBreaks;const A=n[0]?.minValue,P=n[n.length-1]?.maxValue,X="standard-deviation"===e;n=n.map(ca=>{const ja=ca.label;ca={minValue:ca.minValue,maxValue:ca.maxValue,label:ja};if(X&&ja){const qa=ja.match(b)?.map(sa=>
+sa.trim())??[];2===qa.length?(ca.minStdDev=qa[0],ca.maxStdDev=qa[1],0>qa[0]&&0<qa[1]&&(ca.hasAvg=!0)):1===qa.length&&(ja.includes("\x3c")?(ca.minStdDev=null,ca.maxStdDev=qa[0]):ja.includes("\x3e")&&(ca.minStdDev=qa[0],ca.maxStdDev=null))}return ca});return{minValue:A,maxValue:P,classBreakInfos:n,normalizationTotal:h.normalizationTotal}};d.statisticTypes=f;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a,p,k){r=new g.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});g=new g.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});u=class extends u.JSONSupport{constructor(y){super(y);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(y){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",y)}set definedInterval(y){"defined-interval"===this.classificationMethod&&this._set("definedInterval",y)}};d.__decorate([p.enumeration({classBreaksDef:"class-breaks-definition"})],u.prototype,"type",void 0);d.__decorate([z.property({json:{write:!0}})],u.prototype,
"breakCount",void 0);d.__decorate([z.property({json:{write:!0}})],u.prototype,"classificationField",void 0);d.__decorate([z.property({type:String,json:{read:r.read,write:r.write}})],u.prototype,"classificationMethod",void 0);d.__decorate([z.property({json:{write:!0}})],u.prototype,"normalizationField",void 0);d.__decorate([z.property({json:{read:g.read,write:g.write}})],u.prototype,"normalizationType",void 0);d.__decorate([z.property({value:null,json:{write:!0}})],u.prototype,"standardDeviationInterval",
null);d.__decorate([z.property({value:null,json:{write:!0}})],u.prototype,"definedInterval",null);return u=d.__decorate([k.subclass("esri.rest.support.ClassBreaksDefinition")],u)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(d,g,u){d.enumeration=function(z,r={}){z=z instanceof g.JSONMap?z:new g.JSONMap(z,r);const {alwaysWriteDefaults:M,default:a,ignoreUnknown:p=!0,name:k,nonNullable:y,readOnly:v=!1}=r;return u.property({type:p?
z.apiValues:String,json:{type:z.jsonValues,default:a,name:k,read:v?!1:{reader:z.read},write:{writer:z.write,alwaysWriteDefaults:M}},nonNullable:y,readOnly:v})};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(d,g){function u(D){var F=D.definition;const {classificationMethod:t,normalizationType:J,definedInterval:L}=F;F=F.breakCount??1;const w=[];var b=D.values;if(0===b.length)return[];
b=b.sort((Q,Z)=>Q-Z);var q=b[0],I=b[b.length-1];if("equal-interval"===t)if(b.length>=F){b=(I-q)/F;D=q;for(var f=1;f<F;f++){var G=Number((q+f*b).toFixed(6));w.push({minValue:D,maxValue:G,label:z(D,G,J)});D=G}w.push({minValue:D,maxValue:I,label:z(D,I,J)})}else b.forEach(Q=>{w.push({minValue:Q,maxValue:Q,label:z(Q,Q,J)})});else if("natural-breaks"===t){b=r(b);D=M(b.uniqueValues,D.valueFrequency||b.valueFrequency,F);for(f=1;f<F;f++)b.uniqueValues.length>f&&(G=Number(b.uniqueValues[D[f]].toFixed(6)),w.push({minValue:q,
maxValue:G,label:z(q,G,J)}),q=G);w.push({minValue:q,maxValue:I,label:z(q,I,J)})}else if("quantile"===t)if(b.length>=F&&q!==I){D=Math.ceil(b.length/F);f=0;for(G=1;G<F;G++){var O=D+f-1;O>b.length&&(O=b.length-1);0>O&&(O=0);w.push({minValue:q,maxValue:b[O],label:z(q,b[O],J)});q=b[O];f+=D;D=Math.ceil((b.length-f)/(F-G))}w.push({minValue:q,maxValue:I,label:z(q,I,J)})}else for(F=-1,I=0;I<b.length;I++)q=b[I],q!==F&&(F=q,w.push({minValue:F,maxValue:q,label:z(F,q,J)}),F=q);else if("standard-deviation"===t)if(D=
k(b),f=y(b,D),0===f)w.push({minValue:b[0],maxValue:b[0],label:z(b[0],b[0],J)});else{b=p(q,I,F,D,f)*f;f=0;for(G=F;1<=G;G--)O=Number((D-(G-.5)*b).toFixed(6)),w.push({minValue:q,maxValue:O,label:z(q,O,J)}),q=O,f++;G=Number((D+.5*b).toFixed(6));w.push({minValue:q,maxValue:G,label:z(q,G,J)});q=G;f++;for(O=1;O<=F;O++)G=f===2*F?I:Number((D+(O+.5)*b).toFixed(6)),w.push({minValue:q,maxValue:G,label:z(q,G,J)}),q=G,f++}else if("defined-interval"===t){if(!L)return w;F=b[0];I=b[b.length-1];b=Math.ceil((I-F)/L);
q=F;for(D=1;D<b;D++)f=Number((F+D*L).toFixed(6)),w.push({minValue:q,maxValue:f,label:z(q,f,J)}),q=f;w.push({minValue:q,maxValue:I,label:z(q,I,J)})}return w}function z(D,F,t){let J=null;return J=D===F?t&&"percent-of-total"===t?D+"%":D.toString():t&&"percent-of-total"===t?D+"% - "+F+"%":D+" - "+F}function r(D){const F=[],t=[];let J=Number.MIN_VALUE,L=1,w=-1;for(let b=0;b<D.length;b++){const q=D[b];q===J?(L++,t[w]=L):null!==q&&(F.push(q),J=q,L=1,t.push(L),w++)}return{uniqueValues:F,valueFrequency:t}}
function M(D,F,t){var J=D.length;const L=[];t>J&&(t=J);for(var w=0;w<t;w++)L.push(Math.round(w*J/t-1));L.push(J-1);w=a(L,D,F,t);J=w.mean;w=w.sdcm;var b=t,q=0,I=0;let f=0,G=0,O=!0;for(let Z=0;2>Z&&O;Z++){0===Z&&(O=!1);for(var Q=0;Q<b-1;Q++)for(;L[Q+1]+1!==L[Q+2];)if(L[Q+1]+=1,q=v(Q,L,D,F),f=q.sbMean,q=q.sbSdcm,I=v(Q+1,L,D,F),G=I.sbMean,I=I.sbSdcm,q+I<w[Q]+w[Q+1])w[Q]=q,w[Q+1]=I,J[Q]=f,J[Q+1]=G,O=!0;else{--L[Q+1];break}for(Q=b-1;0<Q;Q--)for(;L[Q]!==L[Q-1]+1;)if(--L[Q],q=v(Q-1,L,D,F),f=q.sbMean,q=q.sbSdcm,
I=v(Q,L,D,F),G=I.sbMean,I=I.sbSdcm,q+I<w[Q-1]+w[Q])w[Q-1]=q,w[Q]=I,J[Q-1]=f,J[Q]=G,O=!0;else{L[Q]+=1;break}}O&&(w=a(L,D,F,t));return L}function a(D,F,t,J){let L=[];var w=[],b=[];let q=0;const I=[],f=[];for(var G=0;G<J;G++){var O=v(G,D,F,t);I.push(O.sbMean);f.push(O.sbSdcm);q+=f[G]}O=q;for(G=!0;G||q<O;){G=!1;L=[];for(w=0;w<J;w++)L.push(D[w]);for(b=0;b<J;b++)for(O=D[b]+1;O<=D[b+1];O++)if(w=F[O],0<b&&O!==D[b+1]&&Math.abs(w-I[b])>Math.abs(w-I[b-1]))D[b]=O;else if(b<J-1&&D[b]!==O-1&&Math.abs(w-I[b])>Math.abs(w-
I[b+1])){D[b+1]=O-1;break}O=q;q=0;w=[];b=[];for(let Q=0;Q<J;Q++){w.push(I[Q]);b.push(f[Q]);const Z=v(Q,D,F,t);I[Q]=Z.sbMean;f[Q]=Z.sbSdcm;q+=f[Q]}}if(q>O){for(F=0;F<J;F++)D[F]=L[F],I[F]=w[F],f[F]=b[F];q=O}return{mean:I,sdcm:f}}function p(D,F,t,J,L){D=Math.max(J-D,F-J)/L/t;return 1<=D?1:.5<=D?.5:.25}function k(D){let F=0;for(let t=0;t<D.length;t++)F+=D[t];return F/=D.length}function y(D,F){let t=0;for(let J=0;J<D.length;J++){const L=D[J];t+=(L-F)*(L-F)}t/=D.length;return Math.sqrt(t)}function v(D,
F,t,J){var L=0,w=0;for(var b=F[D]+1;b<=F[D+1];b++){const q=J[b];L+=t[b]*q;w+=q}0>=w&&g.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");L/=w;w=0;for(b=F[D]+1;b<=F[D+1];b++)w+=J[b]*(t[b]-L)**2;return{sbMean:L,sbSdcm:w}}d.createGenerateRendererClassBreaks=function(D){const {normalizationTotal:F}=D;return{classBreaks:u(D),normalizationTotal:F}};d.createGenerateRendererUniqueValues=function(D){D=r(D);const F=[],t=D.uniqueValues.length;for(let J=0;J<
t;J++){const L=D.uniqueValues[J];F.push({value:L,count:D.valueFrequency[J],label:L.toString()})}return{uniqueValues:F}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(d){d.makeEdgeCandidate=function(g,u,z,r,M,a=!1){return{objectId:g,target:u,distance:z,type:"edge",start:r,end:M,draped:a}};d.makeVertexCandidate=function(g,u,z){return{objectId:g,target:u,distance:z,type:"vertex"}};Object.defineProperty(d,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(d,g,u,z,r,M,a,p,k,y){async function v(w,b,q){if(!w)return null;var {where:I}=w;w.where=I=I?.trim();if(!I||/^1 *= *1$/.test(I)||
b&&b===I)w.where=null;if(!w.geometry)return w;b=await F(w);w.distance=0;w.units=null;"esriSpatialRelEnvelopeIntersects"===w.spatialRel&&({spatialReference:I}=w.geometry,b=M.getGeometryExtent(b),b.spatialReference=I);if(b){await y.checkProjectionSupport(b.spatialReference,q);I=b.spatialReference;b=D(b,q)&&a.isExtent(b)?{spatialReference:I,rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}:b;I=(await p.normalizeCentralMeridian(a.fromJSON(b)))[0];if(null==I)throw L;
const f="quantizationParameters"in w&&w.quantizationParameters?.tolerance||"maxAllowableOffset"in w&&w.maxAllowableOffset||0;b=f&&D(b,q)?{densificationStep:8*f}:void 0;I=I.toJSON();b=y.project(I,I.spatialReference,q,b);if(!b)throw L;b.spatialReference=q;w.geometry=b}return w}function D(w,b){if(!w)return!1;const q=w.spatialReference;return(a.isExtent(w)||a.isPolygon(w)||a.isPolyline(w))&&!k.equals(q,b)&&!r.canProjectWithoutEngine(q,b)}async function F(w){const {distance:b,units:q}=w,I=w.geometry;if(null==
b||"vertexAttributes"in I)return I;var f=I.spatialReference;w=q?J.fromJSON(q):z.getUnitString(f);f=f&&(k.isGeographic(f)||k.isWebMercator(f))?I:await y.checkProjectionSupport(f,k.wgs84).then(()=>y.project(I,k.wgs84));return(await t())(f.spatialReference,f,b,w)}async function t(){return(await new Promise((w,b)=>d(["../../../geometry/geometryEngineJSON"],w,b))).geodesicBuffer}const J=new u.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),L=Object.freeze({});g.normalizeQuery=async function(w,b,q){const {outFields:I,orderByFields:f,groupByFieldsForStatistics:G,outStatistics:O}=w;if(I)for(var Q=0;Q<I.length;Q++)I[Q]=I[Q].trim();if(f)for(Q=0;Q<f.length;Q++)f[Q]=f[Q].trim();if(G)for(Q=0;Q<G.length;Q++)G[Q]=G[Q].trim();if(O)for(Q=0;Q<O.length;Q++)O[Q].onStatisticField&&(O[Q].onStatisticField=O[Q].onStatisticField.trim());w.geometry&&!w.outSR&&(w.outSR=
w.geometry.spatialReference);return v(w,b,q)};g.normalizeQueryLike=v;g.queryEngineEmptyResult=L;g.unitsKebabDict=J;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(d,g,u,z,r,M){function a(D,F,t){const {outFields:J,orderByFields:L,returnDistinctValues:w,outStatistics:b}=t,q=b?
b.map(I=>I.outStatisticFieldName&&I.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(L&&0<L.length){const I=L.map(f=>{const G=f.toLowerCase();return G.includes(" asc")?G.split(" asc")[0]:G.includes(" desc")?G.split(" desc")[0]:f}).filter(f=>!q.includes(f));u.validateFields(D,F,I,{expressionName:"orderByFields",query:t})}if(J&&0<J.length)u.validateFields(D,F,J,{expressionName:"outFields",query:t,allowedFieldTypes:"all"});else if(w)throw new g("unsupported-query","outFields should be specified for returnDistinctValues",
{query:t});u.validateWhere(D,F,t.where,t)}function p(D,F,t){const {outStatistics:J,groupByFieldsForStatistics:L,having:w}=t;var b=L?.length,q=J?.length;if(w){if(!b||!q)throw new g("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});u.validateHaving(D,F,w,J,t)}if(q&&y(J)){q=J.map(I=>I.onStatisticField).filter(Boolean);u.validateFields(D,F,q,{expressionName:"onStatisticFields",query:t});b&&u.validateFields(D,F,L,{expressionName:"groupByFieldsForStatistics",
query:t});for(const I of J){const {onStatisticField:f,statisticType:G}=I;if(("percentile_disc"===G||"percentile_cont"===G)&&"statisticParameters"in I){if({statisticParameters:b}=I,!b)throw new g("unsupported-query","statisticParameters should be set for percentile type",{definition:I,query:t});}else D.get(f)&&"count"!==G&&"min"!==G&&"max"!==G&&u.validateFields(D,F,[f],{expressionName:`outStatistics with '${G}' statistic type`,allowedFieldTypes:v,query:t})}}}async function k(D,F,t,J){var L=[];t.valueExpression&&
({arcadeUtils:L}=await M.loadArcade(),L=L.extractFieldNames(t.valueExpression));t.field&&L.push(t.field);t.field2&&L.push(t.field2);t.field3&&L.push(t.field3);t.normalizationField&&L.push(t.normalizationField);if(!L.length&&!t.valueExpression)throw new g("unsupported-query","field or valueExpression is required",{params:t});u.validateFields(D,F,L,{expressionName:"statistics",query:J})}function y(D){return null!=D&&D.every(F=>"exceedslimit"!==F.statisticType)}const v=new Set([...u.numericFieldTypes,
...u.allDateAndTimeFieldTypes]);d.validateQuery=async function(D,{fieldsIndex:F,geometryType:t,spatialReference:J,availableFields:L}){if(0>(D.distance??0)||null!=D.geometryPrecision||D.multipatchOption&&"xyFootprint"!==D.multipatchOption||D.pixelSize||D.relationParam||D.text)throw new g("unsupported-query","Unsupported query options",{query:D});a(F,L,D);p(F,L,D);return Promise.all([r.checkSpatialQuerySupport(D,t,J),z.checkProjectionSupport(J,D.outSR)]).then(()=>D)};d.validateStatisticsQuery=async function(D,
F,{fieldsIndex:t,geometryType:J,spatialReference:L,availableFields:w}){if(0>(D.distance??0)||null!=D.geometryPrecision||D.multipatchOption||D.pixelSize||D.relationParam||D.text||D.outStatistics||D.groupByFieldsForStatistics||D.having||D.orderByFields)throw new g("unsupported-query","Unsupported query options",{query:D});a(t,w,D);return Promise.all([k(t,w,F,D),r.checkSpatialQuerySupport(D,J,L),z.checkProjectionSupport(L,D.outSR)]).then(()=>D)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(d,g,u,z,r,M,a,p,k,y,v,D){function F(){return new Promise((b,q)=>d(["../../../geometry/geometryEngineJSON"],b,q))}const t={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var J={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},L={esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},w={esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};g.canQueryWithRBush=function(b){if(M.isExtent(b))return!0;if(M.isPolygon(b)){for(const q of b.rings)if(5!==q.length||q[0][0]!==q[1][0]||q[0][0]!==
q[4][0]||q[2][0]!==q[3][0]||q[0][1]!==q[3][1]||q[0][1]!==q[4][1]||q[1][1]!==q[2][1])return!1;return!0}return!1};g.checkSpatialQuerySupport=async function(b,q,I){const {spatialRel:f,geometry:G}=b;if(G){if(null==f||!0!==J[f])throw new u("unsupported-query","Unsupported query spatial relationship",{query:b});if(a.isValid(G.spatialReference)&&a.isValid(I)){if(null==G||!0!==L[M.getJsonType(G)])throw new u("unsupported-query","Unsupported query geometry type",{query:b});if(null==q||!0!==w[q])throw new u("unsupported-query",
"Unsupported layer geometry type",{query:b});if(b.outSR)return D.checkProjectionSupport(b.geometry?.spatialReference,b.outSR)}}};g.getSpatialQueryOperator=function(b,q,I,f,G){if(M.isPolygon(q)&&"esriGeometryPoint"===I&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b)){const O=k.convertFromPolygon(new y,q,!1,!1);return Promise.resolve(Q=>p.polygonContainsPoint(O,!1,!1,Q))}if(M.isPolygon(q)&&"esriGeometryMultipoint"===I){const O=k.convertFromPolygon(new y,q,!1,!1);if("esriSpatialRelContains"===
b)return Promise.resolve(Q=>p.polygonContainsMultipoint(O,!1,!1,Q,f,G))}if(M.isExtent(q)&&"esriGeometryPoint"===I&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b))return Promise.resolve(O=>z.extentContainsPoint(q,v.getGeometry(I,f,G,O)));if(M.isExtent(q)&&"esriGeometryMultipoint"===I&&"esriSpatialRelContains"===b)return Promise.resolve(O=>z.extentContainsMultipoint(q,v.getGeometry(I,f,G,O)));if(M.isExtent(q)&&"esriSpatialRelIntersects"===b){const O=r.getExtentIntersector(I);return Promise.resolve(Q=>
O(q,v.getGeometry(I,f,G,Q)))}return F().then(O=>{const Q=O[t[b]].bind(null,q.spatialReference,q);return Z=>Q(v.getGeometry(I,f,G,Z))})};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(d,g){d.extentIntersectsExtent=g.extentIntersectsExtent;d.extentIntersectsMultipoint=g.extentIntersectsMultipoint;d.extentIntersectsPoint=g.extentIntersectsPoint;d.extentIntersectsPolygon=g.extentIntersectsPolygon;
d.extentIntersectsPolyline=g.extentIntersectsPolyline;d.getFeatureExtentIntersector=g.getFeatureExtentIntersector;d.isSelfIntersecting=g.isSelfIntersecting;d.segmentIntersects=g.segmentIntersects;d.getExtentIntersector=function(u){return"mesh"===u?g.extentIntersectsExtent:g.getFeatureExtentIntersector(u)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(d){function g(u,z,r,M,a){if(!u)return!1;z=z?r?4:3:r?3:2;const {coords:p,
lengths:k}=u;r=!1;u=0;for(const v of k){var y=u;for(let D=u,F=u+v*z;D<F;D+=z){y=D+z;y===F&&(y=u);const t=p[D],J=p[D+1],L=p[y];y=p[y+1];(J<a&&y>=a||y<a&&J>=a)&&t+(a-J)/(y-J)*(L-t)<M&&(r=!r)}u+=v*z}return r}d.polygonContainsCoords=g;d.polygonContainsMultipoint=function(u,z,r,M,a,p){a=a?p?4:3:p?3:2;const {coords:k,lengths:y}=M;if(!y)return!1;for(let v=0,D=0;v<y.length;v++,D+=a)if(!g(u,z,r,k[D],k[D+1]))return!1;return!0};d.polygonContainsPoint=function(u,z,r,M){return g(u,z,r,M.coords[0],M.coords[1])};
Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(d){function g(r,M,a,p,k){if(null!=p&&null!=k)return y=>{const v=r(y,M);y=r(y,a);return(null==v||v<=k)&&(null==y||y>=p)};if(null!=p)return y=>{y=r(y,a);return null==y||y>=p};if(null!=k)return y=>{y=r(y,M);return null==y||y<=k}}function u(r,M,a,p){if(null!=a&&null!=p&&a===p)return k=>r(k,M)===a;if(null!=a&&null!=p)return k=>{k=r(k,M);return null!=k&&k>=a&&k<=
p};if(null!=a)return k=>{k=r(k,M);return null!=k&&k>=a};if(null!=p)return k=>{k=r(k,M);return null!=k&&k<=p}}function z(){return()=>!1}d.getTimeExtent=async function(r,M){if(!r)return null;const a=M.featureAdapter,{startTimeField:p,endTimeField:k}=r;let y=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;if(p&&k)await M.forEach(D=>{const F=a.getAttribute(D,p);D=a.getAttribute(D,k);null==F||isNaN(F)||(y=Math.min(y,F));null==D||isNaN(D)||(v=Math.max(v,D))});else{const D=p||k;await M.forEach(F=>{F=
a.getAttribute(F,D);null==F||isNaN(F)||(y=Math.min(y,F),v=Math.max(v,F))})}return{start:y,end:v}};d.getTimeOperator=function(r,M,a){if(!M||!r)return null;const {startTimeField:p,endTimeField:k}=r;if(!p&&!k)return null;const {start:y,end:v}=M;if(null===y&&null===v)return null;if(void 0===y&&void 0===v)return z();r=a.getAttributeAsTimestamp?.bind(a)??a.getAttribute.bind(a);return p&&k?g(r,p,k,y,v):u(r,p||k,y,v)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(d,g,u,z,r,M,a,p){function k(t){return t.trim().toLowerCase()}function y(t){const J=new Map;if(!t.fields)return J;const L=!0===t.datesInUnknownTimezone,{timeInfo:w,editFieldsInfo:b}=t;var q=(w?"startField"in w?w.startField:w.startTimeField:"")??"";const I=(w?"endField"in w?w.endField:w.endTimeField:"")??"",f="dateFieldsTimeZone"in t?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?a.fromTimeReference(t.dateFieldsTimeReference):null,G=b?"timeZone"in b?b.timeZone??f:b.dateFieldsTimeReference?
a.fromTimeReference(b.dateFieldsTimeReference):f??a.utc:null,O=w?"timeZone"in w?w.timeZone??f:w.timeReference?a.fromTimeReference(w.timeReference):f:null;q=new Map([[k(b?.creationDateField??""),G],[k(b?.editDateField??""),G],[k(q),O],[k(I),O]]);for(const {name:Q,type:Z}of t.fields)F.has(Z)?J.set(Q,a.unknown):"date"!==Z&&"esriFieldTypeDate"!==Z?J.set(Q,null):L?J.set(Q,a.unknown):(t=q.get(k(Q??""))??f,J.set(Q,t));return J}const v=new Map;class D{static fromJSON(t){return new D(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new D(t.fields??
[],y(t))}static fromLayerJSON(t){return new D(t.fields??[],y(t))}constructor(t=[],J){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=t||[];this._timeZoneByFieldName=J?new Map(J):null;t=[];for(const L of this.fields){J=L?.name;const w=M.normalizeFieldName(J)?.toLowerCase()??"";if(J&&w){const b=k(J);this._fieldsMap.set(J,L);this._fieldsMap.set(b,L);this._normalizedFieldsMap.set(w,
L);t.push(`${b}:${L.type}:${this._timeZoneByFieldName?.get(J)}`);M.isDateField(L)?(this.dateFields.push(L),this._dateFieldsSet.add(L)):M.isNumericField(L)&&(this._numericFieldsSet.add(L),this.numericFields.push(L));M.isObjectIDField(L)||M.isGlobalIDField(L)||(L.editable=null==L.editable||!!L.editable,L.nullable=null==L.nullable||!!L.nullable)}}t.sort();this.uid=t.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)M.isObjectIDField(t)||M.isGlobalIDField(t)||
t.nullable||void 0!==M.getFieldDefaultValue(t)||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===t?.uid}has(t){return null!=this.get(t)}get(t){if(t){var J=this._fieldsMap.get(t);if(J)return J;(J=this._fieldsMap.get(k(t))??this._normalizedFieldsMap.get(M.normalizeFieldName(t)?.toLowerCase()??""))&&this._fieldsMap.set(t,J);return J}}getTimeZone(t){t=this.get(t&&"string"!==typeof t?t.name:t);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):
"date"===t.type||"esriFieldTypeDate"===t.type?(u.getLogger("esri.layers.support.FieldsIndex").error(new d("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),a.utc):F.has(t.type)?a.unknown:null:null}getLuxonTimeZone(t){const J=this.getTimeZone(t);return J?J===a.unknown?r.UnknownTimeZone.instance:J===a.utc?p.FixedOffsetZone.utcInstance:z.getOrCreateMapValue(v,J,()=>p.IANAZone.create(J)):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return M.isTimeOnlyField(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){return this.get(t)?.name??
void 0}toJSON(){return{fields:this.fields.map(t=>g.isSerializable(t)?t.toJSON():t),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const F=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return D})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J){function L(T){return w.has(T)?w.get(T):"number"===typeof T?T:1}d.TaskPriority=void 0;(function(T){T.RESOURCE_CONTROLLER_IMMEDIATE="immediate";T.RESOURCE_CONTROLLER="schedule";T.SLIDE="slide";T.STREAM_DATA_LOADER="stream loader";T.ELEVATION_QUERY="elevation query";T.TERRAIN_SURFACE="terrain";T.SURFACE_GEOMETRY_UPDATES="surface geometry updates";T.LOD_RENDERER="LoD renderer";T.GRAPHICS_CORE="Graphics3D";T.I3S_CONTROLLER="I3S";T.POINT_CLOUD_LAYER="point cloud";
T.FEATURE_TILE_FETCHER="feature fetcher";T.OVERLAY="overlay";T.STAGE="stage";T.GRAPHICS_DECONFLICTOR="graphics deconflictor";T.FILTER_VISIBILITY="Graphics3D filter visibility";T.SCALE_VISIBILITY="Graphics3D scale visibility";T.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";T.POINT_OF_INTEREST_FREQUENT="POI frequent";T.POINT_OF_INTEREST_INFREQUENT="POI infrequent";T.LABELER="labeler";T.FEATURE_QUERY_ENGINE="feature query";T.FEATURE_TILE_TREE="feature tile tree";T.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
T.ELEVATION_ALIGNMENT="elevation alignment";T.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";T.TEXT_TEXTURE_ATLAS="text texture atlas";T.TEXTURE_UNLOAD="texture unload";T.LINE_OF_SIGHT_TOOL="line of sight tool";T.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";T.ELEVATION_PROFILE="elevation profile";T.SNAPPING="snapping";T.SHADOW_ACCUMULATOR="shadow accumulator";T.CLOUDS_GENERATOR="clouds generator";T.MAPVIEW_FETCH_QUEUE="mapview fetch queue";T.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update";
T.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue";T[T.NONE=0]="NONE";T[T.TEST_PRIO=1]="TEST_PRIO"})(d.TaskPriority||(d.TaskPriority={}));const w=new Map([[d.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[d.TaskPriority.RESOURCE_CONTROLLER,4],[d.TaskPriority.SLIDE,0],[d.TaskPriority.STREAM_DATA_LOADER,0],[d.TaskPriority.ELEVATION_QUERY,0],[d.TaskPriority.TERRAIN_SURFACE,1],[d.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[d.TaskPriority.LOD_RENDERER,2],[d.TaskPriority.GRAPHICS_CORE,
2],[d.TaskPriority.I3S_CONTROLLER,2],[d.TaskPriority.POINT_CLOUD_LAYER,2],[d.TaskPriority.FEATURE_TILE_FETCHER,2],[d.TaskPriority.CLOUDS_GENERATOR,2],[d.TaskPriority.OVERLAY,4],[d.TaskPriority.STAGE,4],[d.TaskPriority.GRAPHICS_DECONFLICTOR,4],[d.TaskPriority.FILTER_VISIBILITY,4],[d.TaskPriority.SCALE_VISIBILITY,4],[d.TaskPriority.FRUSTUM_VISIBILITY,4],[d.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[d.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[d.TaskPriority.LABELER,8],[d.TaskPriority.FEATURE_QUERY_ENGINE,
8],[d.TaskPriority.FEATURE_TILE_TREE,16],[d.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[d.TaskPriority.ELEVATION_ALIGNMENT,12],[d.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[d.TaskPriority.TEXT_TEXTURE_ATLAS,12],[d.TaskPriority.TEXTURE_UNLOAD,12],[d.TaskPriority.LINE_OF_SIGHT_TOOL,16],[d.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[d.TaskPriority.SNAPPING,0],[d.TaskPriority.SHADOW_ACCUMULATOR,30],[d.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[d.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[d.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,
0]]),b=v.Milliseconds(6.5),q=v.Milliseconds(1),I=v.Milliseconds(30),f=v.Milliseconds(1E3/30),G=v.Milliseconds(100);var O;(function(T){class x{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(e=>e.needsUpdate)}constructor(){this._updating=y.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new M("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new h;this._state=t.RenderState.INTERACTING;this._tasks=
new a;this._runQueue=new a;this._load=0;this._idleStateCallbacks=new a;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=k.watch(()=>F.SCHEDULER_LOG_SLOW_TASKS,e=>this._debug=e,k.initial);for(const e of Object.keys(d.TaskPriority))this.performanceInfo.tasks.set(d.TaskPriority[e],new M(d.TaskPriority[e]))}destroy(){this._tasks.toArray().forEach(e=>e.remove());this._tasks.clear();r.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(e){this._updatingChanged();
e&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(e,n){n=new R(this,e,n);this._tasks.push(n);this._updatingChanged();this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new M(e));return n}registerIdleStateCallbacks(e,n){const A={idleBegin:e,idleEnd:n};this._idleStateCallbacks.push(A);this.state===t.RenderState.IDLE&&
this._idleUpdatesStartFired&&A.idleBegin();const P=this;return{remove:()=>this._removeIdleStateCallbacks(A),set idleBegin(X){P._idleUpdatesStartFired&&(A.idleEnd(),P._state===t.RenderState.IDLE&&X());A.idleBegin=X},set idleEnd(X){A.idleEnd=X}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==t.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(n=>n.idleEnd())))}get state(){return this._state}updateBudget(e){this._test&&
(this._test.usedBudget=0);++this._frameNumber;let n=b,A=e.frameDuration,P=q;switch(this.state){case t.RenderState.IDLE:n=v.Milliseconds(0);A=v.Milliseconds(Math.max(G,e.frameDuration));P=I;break;case t.RenderState.INTERACTING:A=v.Milliseconds(Math.max(f,e.frameDuration))}A=v.Milliseconds(A-e.elapsedFrameTime-n);if(this.state!==t.RenderState.IDLE&&A<q&&!this._forceTask)return this._forceTask=!0,!1;A=v.Milliseconds(Math.max(A,P));this._budget.reset(A,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=
this._forceTask=!1;switch(this.state){case t.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(e=>e.idleBegin()));this._runIdle();break;case t.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(v.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd();
this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e);this._runQueue.removeUnordered(e);this._updatingChanged()}_updateTask(e){this._tasks.forAll(n=>{n.name===e&&n.setPriority(e)})}_getState(e){if(this._runQueue.some(A=>A.name===e))return d.TaskState.SCHEDULED;let n=d.TaskState.IDLE;this._tasks.forAll(A=>{A.name===e&&A.needsUpdate&&(1>=A.schedulePriority?n=d.TaskState.READY:n!==d.TaskState.READY&&(n=d.TaskState.WAITING))});return n}_getRuntime(e){let n=0;this._tasks.forAll(A=>
{A.name===e&&(n+=A.runtime)});return n}_resetRuntimes(){this._tasks.forAll(e=>e.runtime=0)}_getRunning(){const e=new Map;this._tasks.forAll(A=>{A.needsUpdate&&e.set(A.name,(e.get(A.name)||0)+1)});if(0===e.size)return null;let n="";e.forEach((A,P)=>{n=1<A?n+` ${A}x ${P}`:n+` ${P}`});return n}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce((n,A)=>A.needsUpdate?++n:n,0);this._load=.9*this._load+e*(1-.9)}_schedule(){this._runQueue.filterInPlace(e=>
{if(e.needsUpdate)return!0;e.schedulePriority=e.basePriority;return!1});for(this._tasks.forAll(e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)});0===this._runQueue.length;){let e=!1;this._tasks.forAll(n=>{if(n.needsUpdate&&0!==n.schedulePriority&&0!==n.basePriority&&n.blockFrame!==this._frameNumber)switch(e=!0,n.schedulePriority){case 1:n.schedulePriority=0;this._runQueue.push(n);break;default:--n.schedulePriority}});
if(!e)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var n=this._budget.now();const A=this._runQueue.pop();this._budget.resetProgress();try{A.task.runTask(this._budget)===J.Yield&&(A.blockFrame=this._frameNumber)}catch(P){z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${A.name}"`,P),A.blockFrame=this._frameNumber}!this._budget.hasProgressed&&A.blockFrame!==this._frameNumber&&
A.needsUpdate&&(A.blockFrame=this._frameNumber);A.schedulePriority=A.basePriority;n=this._budget.now()-n;A.runtime+=n;this._frameTaskTimes.set(A.priority,this._frameTaskTimes.get(A.priority)+n);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-e);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(d.TaskPriority))this._frameTaskTimes.set(d.TaskPriority[e],
0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach((n,A)=>this.performanceInfo.tasks.get(A).push(n));this.performanceInfo.total.push(e)}get test(){return this._test}}T.Scheduler=x;class R{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,n,A){this._scheduler=e;this.name=n;this.runtime=this.blockFrame=0;this._queue=new D.PromiseQueue;this._handles=new g;this.schedulePriority=this._basePriority=L(n);this._task=y.signal(null!=A?A:this._queue);this._handles.add(k.when(()=>
this.task.running,P=>e.taskRunningChanged(P)))}remove(){this.processQueue(Q);this._scheduler.removeTask(this);this.schedule=U.schedule;this.reschedule=U.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name!==e){this.name=e;e=L(e);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=e;this._basePriority=e}}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,
n,A){return this._queue.push(e,n,A)}reschedule(e,n,A){return this._queue.unshift(e,n,A)}processQueue(e){return this._queue.runTask(e)}}class h{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=t.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(e){if(this.done)return!1;!0===e()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,n){this._begin=this.now();this._budget=e;this._state=n;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}T.Budget=h})(O||={});d.TaskState=void 0;(function(T){T.SCHEDULED=
"s";T.READY="r";T.WAITING="w";T.IDLE="i"})(d.TaskState||(d.TaskState={}));const Q=(()=>{const T=new O.Budget;T.enabled=!1;return T})();class Z{remove(){}processQueue(){}schedule(T,x,R){try{if(p.isAborted(x)){const h=p.createAbortError();return R?Promise.resolve(R(h)):Promise.reject(h)}return p.when(T(Q))}catch(h){return Promise.reject(h)}}reschedule(T,x,R){return this.schedule(T,x,R)}}const U=new Z;d.ImmediateTask=U;d.getTaskPriority=L;d.newScheduler=function(){return new O.Scheduler};d.noBudget=
Q;d.taskPriorities=w;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(d,g,u,z){class r{constructor(M,a){this._observable=new z.SimpleObservable;this._value=M;this._equalityFunction=a}get value(){u.trackAccess(this._observable);return this._value}set value(M){this._equalityFunction(M,this._value)||(this._value=M,this._observable.notify())}mutate(M){M(this._value);
this._observable.notify()}}d.signal=function(M,a=g.equalsShallow){return new r(M,a)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(d,g,u,z){class r{constructor(){this._tasks=[];this._runningTasks=u.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(a){if(0===
this.length)return z.Yield;for(;!a.done&&this._process(a);)a.madeProgress()}push(a,p,k){++this._runningTasks.value;return(new Promise((y,v)=>this._tasks.push(new M(y,v,a,p,k)))).finally(()=>--this._runningTasks.value)}unshift(a,p,k){++this._runningTasks.value;return(new Promise((y,v)=>this._tasks.unshift(new M(y,v,a,p,k)))).finally(()=>--this._runningTasks.value)}_process(a){if(0===this._tasks.length)return!1;const p=this._tasks.shift();try{const k=g.isAborted(p.signal);if(k&&!p.abortCallback)p.reject(g.createAbortError());
else{const y=k?p.abortCallback?.(g.createAbortError()):p.callback(a);g.isPromiseLike(y)?y.then(p.resolve,p.reject):p.resolve(y)}}catch(k){p.reject(k)}return!0}cancelAll(){const a=g.createAbortError();for(const p of this._tasks)if(p.abortCallback){const k=p.abortCallback(a);p.resolve(k)}else p.reject(a);this._tasks.length=0}}class M{constructor(a,p,k,y,v){this.resolve=a;this.reject=p;this.callback=k;this.signal=y;this.abortCallback=v}}d.PromiseQueue=r;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(d){const g=Symbol("Yield");d.Yield=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(d,g,u,z,r,M,a){g=class extends g{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};d.__decorate([u.property()],g.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);d.__decorate([u.property()],g.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);g=d.__decorate([a.subclass("esri.views.support.debugFlags")],g);return new g})},"esri/views/support/RenderState":function(){define(["exports"],function(d){d.RenderState=void 0;var g=d.RenderState||(d.RenderState={});g[g.ANIMATING=0]="ANIMATING";g[g.INTERACTING=1]="INTERACTING";g[g.IDLE=2]=
"IDLE";Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/geojson/geojson":function(){define("exports ../../../../core/date ../../../../core/Error ../../../../geometry/support/spatialReferenceUtils ../../OptimizedFeature ../../OptimizedGeometry ../../../support/fieldUtils".split(" "),function(d,g,u,z,r,M,a){function*p(G){switch(G.type){case "Feature":yield G;break;case "FeatureCollection":for(const O of G.features)O&&(yield O)}}function*k(G){if(G)switch(G.type){case "Point":yield G.coordinates;
break;case "LineString":case "MultiPoint":yield*G.coordinates;break;case "MultiLineString":case "Polygon":for(const O of G.coordinates)yield*O;break;case "MultiPolygon":for(const O of G.coordinates)for(const Q of O)yield*Q}}function*y(G,O={}){const {geometryType:Q,objectIdField:Z}=O;for(const U of G){const {geometry:T,properties:x,id:R}=U;if(T&&f[T.type]!==Q)continue;G=x||{};let h=void 0;Z&&(h=G[Z],null==R||h||(G[Z]=h=R));yield new r.OptimizedFeature(T?t(new M,T,O):null,G,null,h??void 0)}}function v(G){for(const O of G)if(2<
O.length)return!0;return!1}function D(G){let O=0;for(let Q=0;Q<G.length;Q++){const Z=G[Q],U=G[(Q+1)%G.length];O+=Z[0]*U[1]-U[0]*Z[1]}return 0>=O}function F(G){const O=G[0],Q=G[G.length-1];O[0]===Q[0]&&O[1]===Q[1]&&O[2]===Q[2]||G.push(O);return G}function t(G,O,Q){switch(O.type){case "LineString":return w(G,O.coordinates,Q),G;case "MultiLineString":for(const U of O.coordinates)w(G,U,Q);return G;case "MultiPoint":return w(G,O.coordinates,Q),G;case "MultiPolygon":for(var Z of O.coordinates)for(J(G,Z[0],
Q),O=1;O<Z.length;O++)L(G,Z[O],Q);return G;case "Point":return q(G,O.coordinates,Q),G;case "Polygon":Z=O.coordinates;J(G,Z[0],Q);for(O=1;O<Z.length;O++)L(G,Z[O],Q);return G}}function J(G,O,Q){O=F(O);D(O)?w(G,O,Q):b(G,O,Q)}function L(G,O,Q){O=F(O);D(O)?b(G,O,Q):w(G,O,Q)}function w(G,O,Q){for(const Z of O)q(G,Z,Q);G.lengths.push(O.length)}function b(G,O,Q){for(let Z=O.length-1;0<=Z;Z--)q(G,O[Z],Q);G.lengths.push(O.length)}function q(G,O,Q){const [Z,U,T]=O;G.coords.push(Z,U);Q.hasZ&&G.coords.push(T||
0)}function I(G){switch(typeof G){case "string":return g.isISO8601Date(G)?"esriFieldTypeDate":"esriFieldTypeString";case "number":return"esriFieldTypeDouble";default:return"unknown"}}const f={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};d.createOptimizedFeatures=function(G,O){return Array.from(y(p(G),O))};d.getGeometryType=function(G){return f[G]};
d.inferLayerProperties=function(G,O={}){const Q=[];var Z=new Set;const U=new Set;var T=!1;let x=null,R=!1,h=void 0;({geometryType:O=null}=O);for(const e of p(G)){const {geometry:n,properties:A,id:P}=e;if(n&&(O||=f[n.type],f[n.type]!==O))continue;T||(T=k(n),T=v(T));!R&&(R=null!=P)&&(h=typeof P,A&&(x=Object.keys(A).filter(X=>A[X]===P)));A&&x&&R&&null!=P&&(1<x.length?x=x.filter(X=>A[X]===P):1===x.length&&(x=A[x[0]]===P?x:[]));if(A)for(const X in A){if(Z.has(X))continue;G=I(A[X]);if("unknown"===G){U.add(X);
continue}U.delete(X);Z.add(X);const ca=a.normalizeFieldName(X);ca&&Q.push({name:ca,alias:X,type:G})}}if(Z=a.normalizeFieldName(1===x?.length&&x[0]||null)??void 0)for(const e of Q)if(e.name===Z&&a.isNumericField(e)){e.type="esriFieldTypeOID";break}return{fields:Q,geometryType:O,hasZ:T,objectIdFieldName:Z,objectIdFieldType:h,unknownFields:Array.from(U)}};d.validateGeoJSON=function(G,O=4326){if(!G)throw new u("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==G.type&&"FeatureCollection"!==
G.type)throw new u("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:G});({crs:G}=G);if(G){var Q="string"===typeof G?G:"name"===G.type?G.properties.name:"EPSG"===G.type?G.properties.code:null;O=z.isWGS84({wkid:O})?RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${O})$`,"i");if(!Q||!O.test(Q))throw new u("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:G});}};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/core/date":function(){define(["exports"],
function(d){function g(a){const p=new Date(a);if(Number.isNaN(p.getTime()))a=!1;else{var k=!0;if(M&&/\d+\W*$/.test(a)&&(a=a.match(/[a-zA-Z]{2,}/))){k=!1;let y=0;for(;!k&&y<=a.length;)k=!r.test(a[y]),y++;k=!k}a=k}return a?Number.isNaN(p.getTime())?null:p.getTime()-6E4*p.getTimezoneOffset():null}function u(a){a=z.exec(a);if(!a?.groups)return null;a=a.groups;const p=+a.year,k=+a.month-1,y=+a.day,v=+(a.hours??0),D=+(a.minutes??0),F=+(a.seconds??0);if(23<v||59<D||59<F)return null;var t=a.ms??"0";t=t?+t.padEnd(3,
"0").slice(0,3):0;a=a.isUTC||!a.offsetSign?Date.UTC(p,k,y,v,D,F,t):6E4*("+"===a.offsetSign?-1:1)*(60*+a.offsetHours+ +a.offsetMinutes)+Date.UTC(p,k,y,v,D,F,t);return Number.isNaN(a)?null:a}const z=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,r=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,
M=!Number.isNaN((new Date("technology 10")).getTime());d.isDateString=function(a){return null!=u(a)||null!=g(a)};d.isISO8601Date=function(a){return z.test(a)};d.parseDate=function(a){return u(a)??g(a)};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/sourceUtils":function(){define(["require","exports","../../../../core/date","../../../../geometry/support/spatialReferenceUtils","../../../support/fieldUtils"],function(d,g,u,z,r){function M(F){return new k(F)}
async function a(){null==D&&(D=await new Promise((F,t)=>d(["../../../../geometry/geometryEngineJSON"],F,t)));return D}class p{constructor(){this.description=this.code=null}}class k{constructor(F){this.error=new p;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=F}}class y{constructor(F){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=F}}const v=new Set;let D;g.createFeatureEditErrorResult=M;g.createFeatureEditSuccessResult=function(F){return new y(F)};
g.loadGeometryEngineForSimplify=async function(F,t){!z.isValid(F)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await a()};g.mixAttributes=function(F,t,J,L=!1){v.clear();for(const q in J){const I=F.get(q);if(!I)continue;var w=I,b=J[q];let f=b;r.isNumericField(w)&&"string"===typeof b?f=parseFloat(b):r.isStringField(w)&&null!=b&&"string"!==typeof b?f=String(b):r.isDateField(w)&&"string"===typeof b&&(f=u.parseDate(b));w=r.sanitizeNullFieldValue(f);v.add(I.name);if(I&&(L||I.editable)){if(b=
r.validateFieldValue(I,w))return M(r.validationErrorToString(b,I,w));t[I.name]=w}}for(const q of F.requiredFields??[])if(!v.has(q.name))return M(`missing required field "${q.name}"`);return null};g.simplify=function(F,t){if(!F||!z.isValid(t))return F;if("rings"in F||"paths"in F){if(null==D)throw new TypeError("geometry engine not loaded");return D.simplify(t,F)}return F};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/wfsUtils":function(){define("exports ../../geometry ../../request ../../core/Error ../../core/iteratorUtils ../../core/urlUtils ../../geometry/projection ../../geometry/support/spatialReferenceUtils ../../geometry/support/typeUtils ../graphics/sources/geojson/geojson ./xmlUtils ../support/arcgisLayerUrl ../support/Field ../support/fieldUtils ../../geometry/Extent ../../geometry/SpatialReference".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J,L){function w(da){da=A(da);X(da);ca(da);da=da.firstElementChild;const fa=r.cache(f(da));return{operations:q(da),get featureTypes(){return Array.from(fa())},readFeatureTypes:fa}}function b(da){for(const fa of qa){const na=da.findIndex(ra=>ra.toLowerCase()===fa);if(0<=na)return da[na]}return null}function q(da){let fa=!1;const na={GetCapabilities:{url:""},DescribeFeatureType:{url:""},GetFeature:{url:"",outputFormat:null,supportsPagination:!1}},ra=[],ta=[];v.visitXML(da,
{OperationsMetadata:{Parameter:za=>{if("outputFormat"===za.getAttribute("name"))return{AllowedValues:{Value:({textContent:Aa})=>{Aa&&ra.push(Aa)}}}},Operation:za=>{switch(za.getAttribute("name")){case "GetCapabilities":return{DCP:{HTTP:{Get:Aa=>{na.GetCapabilities.url=Aa.getAttribute("xlink:href")}}}};case "DescribeFeatureType":return{DCP:{HTTP:{Get:Aa=>{na.DescribeFeatureType.url=Aa.getAttribute("xlink:href")}}}};case "GetFeature":return{DCP:{HTTP:{Get:Aa=>{na.GetFeature.url=Aa.getAttribute("xlink:href")}}},
Parameter:Aa=>{if("outputFormat"===Aa.getAttribute("name"))return{AllowedValues:{Value:({textContent:Ha})=>{Ha&&ta.push(Ha)}}}}}}},Constraint:za=>{switch(za.getAttribute("name")){case "KVPEncoding":return{DefaultValue:Aa=>{fa="true"===Aa.textContent.toLowerCase()}};case "ImplementsResultPaging":return{DefaultValue:Aa=>{na.GetFeature.supportsPagination="true"===Aa.textContent.toLowerCase()}}}}}});na.GetFeature.outputFormat=b(ta)??b(ra);if(!fa)throw new z("wfs-layer:kvp-encoding-not-supported","WFS service doesn't support key/value pair (KVP) encoding");
if(null==na.GetFeature.outputFormat)throw new z("wfs-layer:geojson-not-supported","WFS service doesn't support GeoJSON output format");return na}function I(da){da=parseInt(da.textContent?.match(/(?<wkid>\d+$)/i)?.groups?.wkid??"",10);if(!Number.isNaN(da))return da}function f(da){return v.iterateXML(da,{FeatureTypeList:{FeatureType:fa=>{const na={typeName:"undefined:undefined",name:"",title:"",description:"",extent:null,namespacePrefix:"",namespaceUri:"",defaultSpatialReference:4326,supportedSpatialReferences:[]},
ra=new Set;v.visitXML(fa,{Name:ta=>{const {name:za,prefix:Aa}=P(ta.textContent);na.typeName=`${Aa}:${za}`;na.name=za;na.namespacePrefix=Aa;na.namespaceUri=ta.lookupNamespaceURI(Aa)},Abstract:ta=>{na.description=ta.textContent},Title:ta=>{na.title=ta.textContent},WGS84BoundingBox:ta=>{na.extent=J.fromJSON(G(ta))},DefaultCRS:ta=>{if(ta=I(ta))na.defaultSpatialReference=ta,ra.add(ta)},OtherCRS:ta=>{(ta=I(ta))&&ra.add(ta)}});na.title||(na.title=na.name);ra.add(4326);na.supportedSpatialReferences.push(...ra);
return na}}})}function G(da){let fa,na,ra,ta;for(const za of da.children)switch(za.localName){case "LowerCorner":[fa,na]=za.textContent.split(" ").map(Aa=>Number.parseFloat(Aa));break;case "UpperCorner":[ra,ta]=za.textContent.split(" ").map(Aa=>Number.parseFloat(Aa))}return{xmin:fa,ymin:na,xmax:ra,ymax:ta,spatialReference:p.wgs84}}function O(da,fa,na){return r.find(da,ra=>na?ra.name===fa&&ra.namespaceUri===na:ra.typeName===fa||ra.name===fa)}async function Q(da,fa,na,ra={}){da=da.readFeatureTypes();
na=fa?O(da,fa,na):da.next().value;({spatialReference:da=new L({wkid:na?.defaultSpatialReference})}=ra);if(null==na){if(fa)throw new z("wfs-layer:feature-type-not-found",`The type '${fa}' could not be found in the service`);throw new z("wfs-layer:empty-service","The service is empty");}if((fa=na.extent)&&!p.equals(fa.spatialReference,da))try{await a.initializeProjection(fa.spatialReference,da,void 0,ra),fa=a.project(fa,da)}catch{throw new z("wfs-layer:unsupported-spatial-reference","Projection not supported");
}return{extent:fa,spatialReference:da,featureType:na}}async function Z(da,fa,na,ra={}){const {typeName:ta}=fa,[za,Aa]=await Promise.allSettled([x(da.operations.DescribeFeatureType.url,ta,ra),T(da,ta,na,ra)]);da=Ga=>new z("wfs-layer:getWFSLayerTypeInfo-error",`An error occurred while getting info about the feature type '${ta}'`,{error:Ga});if("rejected"===za.status)throw da(za.reason);if("rejected"===Aa.status)throw da(Aa.reason);const {fields:Ha,errors:Ka}=za.value??{};da=za.value?.geometryType||
Aa.value?.geometryType;fa=Aa.value?.swapXY??!1;if(null==da)throw new z("wfs-layer:unknown-geometry-type",`The geometry type could not be determined for type '${ta}`,{typeName:ta,geometryType:da,fields:Ha,errors:Ka});return{...U(Ha??[]),geometryType:da,swapXY:fa}}function U(da){const fa=da.find(ra=>"geometry"===ra.type);let na=da.find(ra=>"oid"===ra.type);da=da.filter(ra=>"geometry"!==ra.type);na||(na=new F({name:"__esri_wfs_id__",type:"oid",alias:"__esri_wfs_id__"}),da.unshift(na));return{geometryField:fa?.name??
null,objectIdField:na.name,fields:da}}async function T(da,fa,na,ra={}){let ta,za=!1;const [Aa,Ha]=await Promise.all([e(da.operations.GetFeature.url,fa,na,da.operations.GetFeature.outputFormat,{...ra,count:1}),u(da.operations.GetFeature.url,{responseType:"text",query:n(fa,na,void 0,{...ra,count:1}),signal:ra?.signal})]);if(da="FeatureCollection"===Aa.type&&Aa.features[0]?.geometry){ta=k.featureGeometryTypeKebabDictionary.fromJSON(y.getGeometryType(da.type));switch(da.type){case "Point":var Ka=da.coordinates;
break;case "LineString":case "MultiPoint":Ka=da.coordinates[0];break;case "MultiLineString":case "Polygon":Ka=da.coordinates[0][0];break;case "MultiPolygon":Ka=da.coordinates[0][0][0]}if(fa=/<[^>]*pos[^>]*> *(-?\d+(?:\.\d+)?) (-?\d+(?:\.\d+)?)/.exec(Ha.data))da=Ka[0].toFixed(3),Ka=Ka[1].toFixed(3),na=parseFloat(fa[1]).toFixed(3),fa=parseFloat(fa[2]).toFixed(3),da===fa&&Ka===na&&(za=!0)}return{geometryType:ta,swapXY:za}}async function x(da,fa,na){da=await u(da,{responseType:"text",query:{SERVICE:"WFS",
REQUEST:"DescribeFeatureType",VERSION:"2.0.0",TYPENAME:fa,TYPENAMES:fa,...na?.customParameters},signal:na?.signal});return R(fa,da.data)}function R(da,fa){const {name:na}=P(da);fa=A(fa);ca(fa);var ra=r.find(v.iterateXML(fa.firstElementChild,{element:ta=>ta}),ta=>ta.getAttribute("name")===na);if(null!=ra){const ta=ra.getAttribute("type");if(ra=ta?r.find(v.iterateXML(fa.firstElementChild,{complexType:za=>za}),za=>za.getAttribute("name")===P(ta).name):r.find(v.iterateXML(ra,{complexType:za=>za}),()=>
!0))return h(ra)}throw new z("wfs-layer:feature-type-not-found",`Type '${da}' not found in document`,{document:(new XMLSerializer).serializeToString(fa)});}function h(da){const fa=[],na=[];let ra=void 0;var ta=v.iterateXML(da,{complexContent:{extension:{sequence:{element:za=>za}}}});for(const za of ta){ta=za.getAttribute("name");if(!ta)continue;let Aa,Ha;za.hasAttribute("type")?Aa=P(za.getAttribute("type")).name:v.visitXML(za,{simpleType:{restriction:l=>{Aa=P(l.getAttribute("base")).name;return{maxLength:H=>
{Ha=+H.getAttribute("value")}}}}});if(!Aa)continue;const Ka="true"===za.getAttribute("nillable");let Ga=!1;switch(Aa.toLowerCase()){case "integer":case "nonpositiveinteger":case "negativeinteger":case "long":case "int":case "short":case "byte":case "nonnegativeinteger":case "unsignedlong":case "unsignedint":case "unsignedshort":case "unsignedbyte":case "positiveinteger":na.push(new F({name:ta,alias:ta,type:"integer",nullable:Ka,length:t.getFieldDefaultLength("integer")}));break;case "float":case "double":case "decimal":na.push(new F({name:ta,
alias:ta,type:"double",nullable:Ka,length:t.getFieldDefaultLength("double")}));break;case "boolean":case "string":case "gyearmonth":case "gyear":case "gmonthday":case "gday":case "gmonth":case "anyuri":case "qname":case "notation":case "normalizedstring":case "token":case "language":case "idrefs":case "entities":case "nmtoken":case "nmtokens":case "name":case "ncname":case "id":case "idref":case "entity":case "duration":case "time":na.push(new F({name:ta,alias:ta,type:"string",nullable:Ka,length:Ha??
t.getFieldDefaultLength("string")}));break;case "datetime":case "date":na.push(new F({name:ta,alias:ta,type:"date",nullable:Ka,length:Ha??t.getFieldDefaultLength("date")}));break;case "pointpropertytype":ra="point";Ga=!0;break;case "multipointpropertytype":ra="multipoint";Ga=!0;break;case "curvepropertytype":case "multicurvepropertytype":case "multilinestringpropertytype":ra="polyline";Ga=!0;break;case "surfacepropertytype":case "multisurfacepropertytype":case "multipolygonpropertytype":ra="polygon";
Ga=!0;break;case "geometrypropertytype":case "multigeometrypropertytype":Ga=!0;fa.push(new z("wfs-layer:unknown-geometry-type",`geometry type '${Aa}' is not supported`,{type:(new XMLSerializer).serializeToString(da)}));break;default:fa.push(new z("wfs-layer:unknown-field-type",`Unknown field type '${Aa}'`,{type:(new XMLSerializer).serializeToString(da)}))}Ga&&na.push(new F({name:ta,alias:ta,type:"geometry",nullable:Ka}))}for(const za of na)if("integer"===za.type&&!za.nullable&&sa.has(za.name.toLowerCase())){za.type=
"oid";break}return{geometryType:ra,fields:na,errors:fa}}async function e(da,fa,na,ra,ta){({data:da}=await u(da,{responseType:"text",query:n(fa,na,ra,ta),signal:ta?.signal}));da=da.replaceAll(/": +(-?\d+),(\d+)(,)?/g,'": $1.$2$3');try{return JSON.parse(da)}catch(za){throw new z("wfs-layer:malformed-json","Error while parsing the\u00a0response",{response:da,error:za});}}function n(da,fa,na,ra){return{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:da,OUTPUTFORMAT:na,SRSNAME:"EPSG:"+("number"===
typeof fa?fa:fa.wkid),STARTINDEX:ra?.startIndex,COUNT:ra?.count,...ra?.customParameters}}function A(da){return(new DOMParser).parseFromString(da.trim(),"text/xml")}function P(da){const [fa,na]=da.split(":");return{prefix:na?fa:"",name:na??fa}}function X(da){if((da=da.firstElementChild?.getAttribute("version"))&&"2.0.0"!==da)throw new z("wfs-layer:unsupported-wfs-version",`Unsupported WFS version ${da}. Supported version: ${"2.0.0"}`);}function ca(da){let fa="",na="";v.visitXML(da.firstElementChild,
{Exception:ra=>{fa=ra.getAttribute("exceptionCode");return{ExceptionText:ta=>{na=ta.textContent}}}});if(fa)throw new z(`wfs-layer:${fa}`,na);}function ja(da,fa,na){const ra={wkid:fa.defaultSpatialReference};na=null!=na?.wkid?{wkid:na.wkid}:ra;da=D.isArcGISUrl(da)||na.wkid&&fa.supportedSpatialReferences.includes(na.wkid)?{wkid:na.wkid}:{wkid:fa.defaultSpatialReference};return{spatialReference:na,getFeatureSpatialReference:da}}const qa=["json","application/json","geojson","application/json; subtype\x3dgeojson",
"application/geo+json"],sa=new Set(["objectid","fid"]);d.describeFeatureType=x;d.findFeatureType=O;d.getCapabilities=async function(da,fa){fa=await u(da,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetCapabilities",VERSION:"2.0.0",...fa?.customParameters},signal:fa?.signal});fa=w(fa.data);M.isHTTPSProtocol(da)&&(M.hasSameOrigin(da,fa.operations.DescribeFeatureType.url,!0)&&(fa.operations.DescribeFeatureType.url=M.toHTTPS(fa.operations.DescribeFeatureType.url)),M.hasSameOrigin(da,fa.operations.GetFeature.url,
!0)&&(fa.operations.GetFeature.url=M.toHTTPS(fa.operations.GetFeature.url)));return fa};d.getFeature=e;d.getFeatureCount=async function(da,fa,na){da=await u(da,{responseType:"text",query:{SERVICE:"WFS",REQUEST:"GetFeature",VERSION:"2.0.0",TYPENAMES:fa,RESULTTYPE:"hits",...na?.customParameters},signal:na?.signal});da=/numberMatched=["'](?<numberMatched>\d+)["']/gi.exec(da.data);if(da?.groups)return+da.groups.numberMatched};d.getFeatureTypeInfo=Q;d.getGetFeatureSpatialReference=ja;d.getWFSLayerInfo=
async function(da,fa,na,ra={}){const {featureType:ta,extent:za}=await Q(da,fa,na,ra);({spatialReference:fa}=ja(da.operations.GetFeature.url,ta,ra.spatialReference));const {fields:Aa,geometryType:Ha,swapXY:Ka,objectIdField:Ga,geometryField:l}=await Z(da,ta,fa,ra);return{url:da.operations.GetCapabilities.url,name:ta.name,namespaceUri:ta.namespaceUri,fields:Aa,geometryField:l,geometryType:Ha,objectIdField:Ga,spatialReference:ra.spatialReference??new L({wkid:ta.defaultSpatialReference}),extent:za,swapXY:Ka,
wfsCapabilities:da,customParameters:ra.customParameters}};d.parseDescribeFeatureTypeResponse=R;d.parseGetCapabilitiesResponse=w;d.prepareWFSLayerFields=U;d.wfsOidFieldName="__esri_wfs_id__";Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/ogc/xmlUtils":function(){define(["exports"],function(d){function g(z,r){if(z&&r)for(const M of z.children)M.localName in r&&(z=r[M.localName],"function"===typeof z?(z=z(M))&&g(M,z):g(M,z))}function*u(z,r){for(const M of z.children)M.localName in
r&&(z=r[M.localName],"function"===typeof z?yield z(M):yield*u(M,z))}d.iterateXML=u;d.visitXML=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(d,g,u){function z(D){if(null==D)return null;D=g.urlToObject(D);D=D?.path.match(k)||D?.path.match(y);if(!D)return null;const [,F,t,J,L]=D;D=t.indexOf("/");return{title:M(-1!==D?t.slice(D+1):t),serverType:a[J.toLowerCase()],
sublayer:null!=L&&""!==L?parseInt(L,10):null,url:{path:F}}}function r(D){return(D=g.urlToObject(D).path.match(v))?{serviceUrl:D[1],sublayerId:Number(D[2])}:null}function M(D){D=D.replaceAll(/\s*[/_]+\s*/g," ");return D[0].toUpperCase()+D.slice(1)}const a={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},
p=Object.values(a),k=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${p.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),y=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${p.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),v=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;d.cleanTitle=M;d.isArcGISUrl=function(D){return k.test(D)};d.isHostedAgolService=function(D){D=g.getOrigin(D,!0);if(!D)return!1;D=D.toLowerCase();return D.endsWith(".arcgis.com")&&(D.startsWith("services")||D.startsWith("tiles")||
D.startsWith("features"))};d.isServerOrServicesAGOLUrl=function(D){if(!D)return!1;D=(new g.Url(g.makeAbsolute(D))).authority?.toLowerCase();return"server.arcgisonline.com"===D||"services.arcgisonline.com"===D};d.isWmsServer=function(D){if(!D)return!1;var F=D.toLowerCase();D=F.includes("/services/");const t=F.includes("/mapserver/wmsserver"),J=F.includes("/imageserver/wmsserver");F=F.includes("/wmsserver");return D&&(t||J||F)};d.parse=z;d.parseNonStandardSublayerUrl=r;d.sanitizeUrl=function(D,F){return D?
g.removeTrailingSlash(g.removeQueryParameters(D,F)):D};d.sanitizeUrlWithLayerId=function(D){let {url:F}=D;if(!F)return{url:F};F=g.removeQueryParameters(F,D.logger);const t=g.urlToObject(F),J=z(t.path);let L=void 0;null!=J?(null!=J.sublayer&&null==D.layer.layerId&&(L=J.sublayer),F=J.url.path):D.nonStandardUrlAllowed&&(D=r(t.path),null!=D&&(F=D.serviceUrl,L=D.sublayerId));return{url:g.removeTrailingSlash(F),layerId:L}};d.serverTypes=p;d.titleFromUrlAndName=function(D,F){const t=[];D&&(D=z(D),null!=
D&&D.title&&t.push(D.title));F&&(F=M(F),t.push(F));if(2===t.length){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")};d.writeUrlWithLayerId=function(D,F,t,J,L){u.write(F,J,"url",L);J.url&&null!=D.layerId&&(J.url=g.join(J.url,t,D.layerId.toString()))};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(d,g,u,z,r,M,a,p,k,y,v,D){var F;const t=new g.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});g=F=class extends u.JSONSupport{constructor(J){super(J);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(J,{description:L}){J=null;try{J=L?JSON.parse(L):null}catch(w){}return J?.value??null}readValueType(J,{description:L}){J=null;try{J=L?JSON.parse(L):null}catch(w){}return J?t.fromJSON(J.fieldValueType):null}clone(){return new F({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};d.__decorate([z.property({type:String,json:{write:!0}})],g.prototype,"alias",void 0);d.__decorate([z.property({type:[String,Number],json:{write:{allowNull:!0}}})],g.prototype,"defaultValue",void 0);d.__decorate([z.property()],g.prototype,"description",void 0);d.__decorate([k.reader("description")],g.prototype,"readDescription",
null);d.__decorate([z.property({types:v.types,json:{read:{reader:v.fromJSON},write:!0}})],g.prototype,"domain",void 0);d.__decorate([z.property({type:Boolean,json:{write:!0}})],g.prototype,"editable",void 0);d.__decorate([z.property({type:r.Integer,json:{write:{overridePolicy(J){return{enabled:Number.isFinite(J)}}}}})],g.prototype,"length",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],g.prototype,"name",void 0);d.__decorate([z.property({type:Boolean,json:{write:!0}})],g.prototype,
"nullable",void 0);d.__decorate([p.enumeration(D.kebabDict)],g.prototype,"type",void 0);d.__decorate([z.property()],g.prototype,"valueType",void 0);d.__decorate([k.reader("valueType",["description"])],g.prototype,"readValueType",null);d.__decorate([z.property({type:Boolean,json:{read:!1}})],g.prototype,"visible",void 0);return g=F=d.__decorate([y.subclass("esri.layers.support.Field")],g)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(d,g,u,z,r,M){g={key:"type",base:z,typeMap:{range:M,"coded-value":u,inherited:r}};d.CodedValueDomain=u;d.DomainBase=z;d.InheritedDomain=r;d.RangeDomain=M;d.fromJSON=function(a){if(!a?.type)return null;switch(a.type){case "range":return M.fromJSON(a);case "codedValue":return u.fromJSON(a);case "inherited":return r.fromJSON(a)}return null};d.types=g;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(d,g,u,z,r,M,a,p,k){var y;z=y=class extends k{constructor(v){super(v);this.codedValues=null;this.type="coded-value"}getName(v){let D=null;if(this.codedValues){const F=String(v);this.codedValues.some(t=>{String(t.code)===F&&(D=t.name);return!!D})}return D}clone(){return new y({codedValues:g.clone(this.codedValues),name:this.name})}};d.__decorate([u.property({type:[p.CodedValue],json:{write:!0}})],z.prototype,"codedValues",void 0);d.__decorate([M.enumeration({codedValue:"coded-value"})],z.prototype,
"type",void 0);return z=y=d.__decorate([a.subclass("esri.layers.support.CodedValueDomain")],z)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(d,g,u,z,r,M,a,p){var k;d.CodedValue=k=class extends u.JSONSupport{constructor(y){super(y);this.code=this.name=null}clone(){return new k({name:this.name,
code:this.code})}};g.__decorate([z.property({type:String,json:{write:!0}})],d.CodedValue.prototype,"name",void 0);g.__decorate([z.property({type:[String,Number],json:{write:!0}})],d.CodedValue.prototype,"code",void 0);d.CodedValue=k=g.__decorate([p.subclass("esri.layers.support.CodedValue")],d.CodedValue);Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(d,g,u,z,r,M,a,p,k){g=new g.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});u=class extends u.JSONSupport{constructor(y){super(y);this.type=this.name=null}};d.__decorate([z.property({type:String,json:{write:!0}})],u.prototype,"name",void 0);d.__decorate([p.enumeration(g)],u.prototype,"type",void 0);return u=d.__decorate([k.subclass("esri.layers.support.Domain")],u)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(d,g,u,z,r,M,a,p){var k;g=k=class extends p{constructor(y){super(y);this.type="inherited"}clone(){return new k}};d.__decorate([M.enumeration({inherited:"inherited"})],g.prototype,"type",void 0);return g=k=d.__decorate([a.subclass("esri.layers.support.InheritedDomain")],g)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(d,g,u,z,r,M,a,p){var k;u=k=class extends p{constructor(y){super(y);this.minValue=this.maxValue=null;this.type="range"}clone(){return new k({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};d.__decorate([g.property({json:{type:[Number],read:{source:"range",reader(y,v){return v.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(y,v,D){v[D]=[this.minValue||0,y]}}}})],u.prototype,"maxValue",void 0);d.__decorate([g.property({json:{type:[Number],
read:{source:"range",reader(y,v){return v.range?.[0]}},write:{target:"range",writer(y,v,D){v[D]=[y,this.maxValue||0]}}}})],u.prototype,"minValue",void 0);d.__decorate([M.enumeration({range:"range"})],u.prototype,"type",void 0);return u=k=d.__decorate([a.subclass("esri.layers.support.RangeDomain")],u)})},"*noref":1}});
define("../../../core/asyncUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../core/Warning ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ../data/FeatureStore ../data/projectionSupport ../data/QueryEngine ./geojson/geojson ./support/sourceUtils ../../ogc/wfsUtils ../../support/FieldsIndex ../../../time/timeZoneUtils".split(" "),function(d,g,u,z,r,M,a,p,k,y,v,D,F,t,J){function*L(I,f,G){for(let O=0;O<f;O++)yield I._pageQuery(O,G)}async function w(I,
f,G){let O=I.next();for(;!O.done;){try{const Q=await O.value;f.push(...Q)}catch(Q){z.isAbortError(Q)||G.push(Q)}O=I.next()}}function b(I){const f=[];null!=I.totalRecordCount&&(I.features.length<I.totalRecordCount&&f.push({name:"wfs-layer:maxRecordCount-too-low",message:`Could only fetch ${I.features.length} of ${I.totalRecordCount} in ${I.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:I.features.length,totalRecordCount:I.totalRecordCount}}),I.totalRecordCount>
I.maxTotalRecordCount&&f.push({name:"wfs-layer:large-dataset",message:`The number of ${I.totalRecordCount} features exceeds the maximum allowed of ${I.maxTotalRecordCount}.`,details:{recordCount:I.features.length,totalRecordCount:I.totalRecordCount,maxTotalRecordCount:I.maxTotalRecordCount}}));return f}class q{constructor(){this._queryEngine=this._customParameters=null;this._supportsPagination=!0}destroy(){this._queryEngine?.destroy();this._queryEngine=null}async load(I,f={}){const {getFeatureUrl:G,
getFeatureOutputFormat:O,fields:Q,geometryType:Z,featureType:U,maxRecordCount:T,maxTotalRecordCount:x,maxPageCount:R,objectIdField:h,customParameters:e}=I,{spatialReference:n,getFeatureSpatialReference:A}=F.getGetFeatureSpatialReference(G,U,I.spatialReference);try{await k.checkProjectionSupport(A,n)}catch{throw new g("unsupported-projection","Projection not supported",{inSpatialReference:A,outSpatialReference:n});}z.throwIfAborted(f);this._customParameters=e;this._featureType=U;this._fieldsIndex=
t.fromLayerJSON({fields:Q,dateFieldsTimeReference:Q.some(P=>"esriFieldTypeDate"===P.type)?{timeZoneIANA:J.utc}:null});this._geometryType=Z;this._getFeatureUrl=G;this._getFeatureOutputFormat=O;this._getFeatureSpatialReference=A;this._maxRecordCount=T;this._maxTotalRecordCount=x;this._maxPageCount=R;this._objectIdField=h;this._spatialReference=n;I=await this._snapshotFeatures(f);if(0<I.errors.length&&(this._supportsPagination=!1,I=await this._snapshotFeatures(f),0<I.errors.length))throw I.errors[0];
this._queryEngine=new y.QueryEngine({fieldsIndex:this._fieldsIndex,geometryType:Z,hasM:!1,hasZ:!1,objectIdField:h,spatialReference:n,timeInfo:null,featureStore:new p({geometryType:Z,hasM:!1,hasZ:!1})});this._queryEngine.featureStore.addMany(I.features);return{warnings:b(I),extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new g("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer");}async queryFeatures(I={},f={}){await this._waitSnapshotComplete();
return this._queryEngine.executeQuery(I,f.signal)}async queryFeatureCount(I={},f={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForCount(I,f.signal)}async queryObjectIds(I={},f={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForIds(I,f.signal)}async queryExtent(I={},f={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForExtent(I,f.signal)}async querySnapping(I,f={}){await this._waitSnapshotComplete();return this._queryEngine.executeQueryForSnapping(I,
f.signal)}async refresh(I){this._customParameters=I.customParameters;this._maxRecordCount=I.maxRecordCount;this._maxTotalRecordCount=I.maxTotalRecordCount;this._maxPageCount=I.maxPageCount;this._snapshotTask?.abort();this._snapshotTask=d.createTask(f=>this._snapshotFeatures({signal:f}));this._snapshotTask.promise.then(f=>{this._queryEngine.featureStore.clear();this._queryEngine.featureStore.addMany(f.features);for(const G of b(f))u.getLogger("esri.layers.WFSLayer").warn(new r("wfs-layer:refresh-warning",
G.message,G.details));f.errors?.length&&u.getLogger("esri.layers.WFSLayer").warn(new r("wfs-layer:refresh-error","Refresh completed with errors",{errors:f.errors}))},()=>{this._queryEngine.featureStore.clear()});await this._waitSnapshotComplete();return{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(I){I=
I?.signal;const f=this._maxTotalRecordCount,G=this._maxPageCount,O=this._supportsPagination?await F.getFeatureCount(this._getFeatureUrl,this._featureType.typeName,{customParameters:this._customParameters,signal:I}):void 0;let Q=[];const Z=[];if(null==O)try{Q=await this._singleQuery(I)}catch(U){z.isAbortError(U)||Z.push(U)}else{const U=L(this,Math.max(1,Math.min(Math.ceil(Math.min(O,f)/this._maxRecordCount),G)),I);await Promise.allSettled(Array.from({length:10}).map(()=>w(U,Q,Z)))}z.throwIfAborted(I);
return{features:Q,totalRecordCount:O,maxTotalRecordCount:f,maxPageCount:G,errors:Z}}async _singleQuery(I){const f=await F.getFeature(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,signal:I});return this._processGeoJSON(f,{signal:I})}async _pageQuery(I,f){I*=this._maxRecordCount;const G=await F.getFeature(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,
{customParameters:this._customParameters,startIndex:I,count:this._maxRecordCount,signal:f});return this._processGeoJSON(G,{startIndex:I,signal:f})}_processGeoJSON(I,f){v.validateGeoJSON(I,this._getFeatureSpatialReference.wkid);const {startIndex:G,signal:O}=f;z.throwIfAborted(O);I=v.createOptimizedFeatures(I,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!M.equals(this._spatialReference,this._getFeatureSpatialReference))for(var Q of I)null!=Q.geometry&&(Q.geometry=
a.convertFromGeometry(k.project(a.convertToGeometry(Q.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));Q=G??1;for(const Z of I)f={},D.mixAttributes(this._fieldsIndex,f,Z.attributes,!0),Z.attributes=f,null==f[this._objectIdField]&&(Z.objectId=f[this._objectIdField]=Q++);return I}}return q});