// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../core/asyncUtils ../../core/events ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/screenUtils ../../views/interactive/sketch/SketchTooltipVisibleElements".split(" "),function(m,q,r,t,c,u,v,w,x){function y(a,{hideOnBlur:e=!0}){const b=c.createResolver();if(!e)return{promise:b.promise,handle:t.makeHandle()};const {outerContainer:g}=a;a=r.on(g,"focusout",({relatedTarget:h})=>{h instanceof HTMLElement&&g.contains(h)||b.resolve()});
return{promise:b.promise,handle:a}}function z(a){({activeComponent:a}=a);return a&&"tooltip"in a&&"activeTooltipInfo"in a&&"destroyed"in a?a:null}const l=new Map,A={area:!1,distance:!1,direction:!1,elevation:!1,orientation:!1,radius:!1,rotation:!1,scale:!1,size:!1,totalLength:!1,coordinates:!1,helpMessage:!1,header:!1};m.hideAllVisibleElements=function(a){a.tooltipOptions.visibleElements=new x(A)};m.showTooltipAndFocusField=async function(a,e,b={}){const g=l.get(a);g&&(g.abort(),await g.promise);
const h=q.createTask(async function(k){const n=z(a),{tooltipOptions:f}=a;if("coordinates"===e)e="x",f.xyMode="coordinates";else if("direction"===e||"distance"===e)f.xyMode="direction-distance";await v.waitAnimationFrame();if(!c.isAborted(b)&&!c.isAborted(k)){var d=n?.tooltip;if(d&&n.activeTooltipInfo?.editableFields?.find(B=>B.name===e)){var {handle:C,promise:D}=y(d,b),p=c.createResolver(),E=c.onAbort(b.signal,p.resolve),F=c.onAbort(k,p.resolve),G=f.offset,H=d.position;try{f.forceEnabled=!0,await c.waitTick(),
b.position&&(f.offset=0,d.position=w.createScreenPoint(b.position[0],b.position[1])),await d.enterInputMode(e),c.isAborted(b)||c.isAborted(k)||(b.onOpen?.(),await Promise.race([u.whenOnce(()=>n.destroyed||"feedback"===d.content?.mode,b),D,p.promise]))}finally{E?.remove(),F?.remove(),C.remove(),k=d.outerContainer.contains(document.activeElement),f.enabled?await d.exitInputMode({focusOnView:k}):k&&a.view?.focus(),b.onClose?.(),d.position=H,f.offset=G,f.forceEnabled=!1}}}});l.set(a,h);return h.promise.catch(c.ignoreAbortErrors).finally(()=>
{l.get(a)===h&&l.delete(a)})};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});