// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../support/popupUtils ../../tables/AttributeTableTemplate ../../tables/elements/AttributeTableAttachmentElement ../../tables/elements/AttributeTableFieldElement ../../tables/elements/AttributeTableRelationshipElement ../../widgets/FeatureTable/support/AttachmentsColumnTemplate ../../widgets/FeatureTable/support/FieldColumnTemplate ../../widgets/FeatureTable/support/RelationshipColumnTemplate ../../widgets/FeatureTable/support/TableTemplate ../../widgets/FeatureTable/support/tableUtils ../../widgets/FeatureTable/support/templateUtils".split(" "),
function(m,p,r,y,z,A,t,u,v,w,l,x){m.createDefaultAttributeTableTemplateFromLayer=async function(g){const {excludeAttachments:f,excludeRelationships:k,layer:d}=g,e=[];d||Promise.resolve(new r);await d.load();g=p.createFieldInfos(d,{sortDisabled:!0});for(const {visible:a,fieldName:c,label:b}of g)a&&e.push(new z({fieldName:c,label:b}));l.isIFeatureTableSupportedLayerWithAttachments(d)&&!0!==f&&e.push(new y);l.isIFeatureTableSupportedLayerWithRelationships(d)&&!0!==k&&d.relationships?.forEach(a=>{e.push(new A({relationshipId:a.id,
label:a.name}))});return new r({elements:e,orderByFields:[]})};m.createDefaultTableTemplateFromLayer=async function(g){const {excludeAttachments:f,excludeRelationships:k,layer:d}=g,e=[];await d.load();p.createFieldInfos(d,{sortDisabled:!0}).forEach(({fieldName:a,format:c,label:b,visible:h})=>{null!=a&&e.push(new u({fieldName:a,format:c,label:b,visible:h}))});l.isIFeatureTableSupportedLayerWithAttachments(d)&&!0!==f&&e.push(new t);l.isIFeatureTableSupportedLayerWithRelationships(d)&&!0!==k&&d.relationships?.forEach(({id:a})=>
{e.push(new v({relationshipId:a}))});return new w({columnTemplates:e})};m.createTableTemplateFromAttributeTableTemplate=async function(g){const {layer:f,template:k,includeHiddenFields:d}=g,e=k.orderByFields??[],a=x.createColumnTemplates(k.elements,e);d&&(await f.load(),p.createFieldInfos(f,{sortDisabled:!0}).forEach(c=>{if(c.fieldName){var {fieldName:b,label:h}=c;if(!l.hasTemplateForField(b,a)){c=e.findIndex(n=>n.field&&n.field===b);const q=-1<c?e.at(c)?.order:void 0;a.push(new u({direction:q,fieldName:b,
initialSortPriority:c,label:h,visible:!1}))}}}),l.isIFeatureTableSupportedLayerWithAttachments(f)&&!a.some(c=>"attachment"===c.type)&&a.push(new t({visible:!1})),l.isIFeatureTableSupportedLayerWithRelationships(f)&&f.relationships?.forEach(({id:c})=>{a.some(b=>"relationship"===b.type&&b.relationshipId===c)||a.push(new v({relationshipId:c,visible:!1}))}));return new w({columnTemplates:a})};m.syncAttributeTableTemplate=function(g,f,k=!0){const {allColumns:d,columns:e}=g,a=[],c=x.createAttributeTableElements(e.toArray());
g.activeSortOrders.forEach(({fieldName:b,direction:h})=>{b&&h&&a.push({field:b,order:h})});d.filter(b=>null!=b.direction&&(!b.hidden||k)).forEach(({fieldName:b,direction:h})=>{const q=a.find(n=>n.field===b);h&&!q&&a.push({field:b,order:h})});f.elements=c;f.orderByFields=a;return f};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});