// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Features":function(){define("require ../chunks/tslib.es6 ../intl ../core/Collection ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/throttle ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/support/geometryUtils ../support/actions/actionUtils ./Feature ./Spinner ./Widget ./Feature/resources ./Feature/support/FeatureContentMixin ./Features/css ./Features/FeaturesDrillIn ./Features/FeaturesViewModel ./Features/FeaturesVisibleElements ./Popup/actions ./Popup/actionUtils ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute ../intl/number".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l,c,a,d,n,D,J,K,N,G,Q,h,C,I){e=class extends y.FeatureContentMixin(z){constructor(g,E){super(g,E);this._featureMenuIntersectionObserverCallback=([P])=>{P?.isIntersecting&&null!=this.viewModel.featurePage&&this.viewModel.featurePage++};this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document});this._focusAbortController=this._feature=this._spinner=this._featureMenuIntersectionObserverNode=
null;this._drillInFlowItems=new B;this._drillInWidget=new l({flowItems:this._drillInFlowItems});this._actionBarMenuNode=this._featureMenuViewportNode=this._rootFlowItemNode=null;this.featureNavigationTop=this.collapsed=!1;this.headerActions=new d.ActionsCollection;this.headingLevel=2;this.messagesCommon=this.messages=null;this.responsiveActionsEnabled=!1;this.viewModel=new c;this.visibleElements=new a;this._renderAction=(P,R)=>{const V=this._getActionTitle(P),{type:T,active:X,uid:Z,disabled:ba,indicator:W}=
P;return P.visible?h.tsx("calcite-action",{active:"toggle"===T?P.value:!1,appearance:"solid",bind:this,"data-action-uid":Z,disabled:ba,icon:this._getActionIcon(P),indicator:W,key:`action-${R}`,loading:X,onclick:this._triggerAction,scale:"s",text:V,title:this._hideActionText?V:void 0},this._getFallbackIcon(P)):null};this._openFeatureMenu=()=>{this.featureMenuOpen=!0;this._focusFlowItemNode("menu-flow-item")};this._previousFeature=()=>{this.viewModel.selectedFeatureIndex--};this._nextFeature=()=>{this.viewModel.selectedFeatureIndex++};
this._handleFeatureMenuBack=()=>{this.featureMenuOpen&&(this._focusFlowItemNode("root-flow-item"),this.featureMenuOpen=!1)};this._displaySpinnerThrottled=O.throttle(()=>this._displaySpinner(),0);this._addSelectedFeatureIndexHandle();this.addHandles([this._displaySpinnerThrottled,m.watch(()=>this.viewModel?.active,()=>this._toggleScreenLocationEnabled()),m.watch(()=>this.viewModel?.active,P=>this._drillInWidget.closed=!P),m.watch(()=>this.visibleElements?.closeButton,P=>this._drillInWidget.closable=
P),m.watch(()=>this.visibleElements?.spinner,P=>this._spinnerEnabledChange(P)),m.watch(()=>this.viewModel?.view,(P,R)=>this._viewChange(P,R)),m.watch(()=>this.viewModel?.view?.ready,(P,R)=>this._viewReadyChange(P??!1,R??!1)),m.watch(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner();this._displaySpinnerThrottled()}),m.watch(()=>this.viewModel?.screenLocation,()=>this._closeOpenActionMenu()),m.watch(()=>this.selectedFeatureWidget,()=>this._destroyDrillInFlowItemWidgets()),
m.watch(()=>{const P=this.selectedFeatureWidget?.viewModel;return[P?.title,P?.state]},()=>this._setTitleFromFeatureWidget()),m.watch(()=>{const P=this.selectedFeatureWidget?.viewModel;return[P?.content,P?.state]},()=>this._setContentFromFeatureWidget()),m.watch(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),this._drillInWidget.on("close",()=>this.close()),this._drillInWidget.on("exit",()=>this._destroyDrillInFlowItemWidgets()),this._drillInWidget.on("open-feature",
({feature:P})=>this._openRelatedFeature(P)),this._drillInWidget.on("zoom-to-feature",({featureWidget:P})=>n.zoomToLocation(this.viewModel,P))])}loadDependencies(){return D.loadCalciteComponents({action:()=>new Promise((g,E)=>b(["../chunks/calcite-action"],g,E)),"action-bar":()=>new Promise((g,E)=>b(["../chunks/calcite-action-bar"],g,E)),"action-group":()=>new Promise((g,E)=>b(["../chunks/calcite-action-group"],g,E)),button:()=>new Promise((g,E)=>b(["../chunks/calcite-button"],g,E)),flow:()=>new Promise((g,
E)=>b(["../chunks/calcite-flow"],g,E)),"flow-item":()=>new Promise((g,E)=>b(["../chunks/calcite-flow-item"],g,E)),list:()=>new Promise((g,E)=>b(["../chunks/calcite-list"],g,E)),"list-item":()=>new Promise((g,E)=>b(["../chunks/calcite-list-item"],g,E)),"list-item-group":()=>new Promise((g,E)=>b(["../chunks/calcite-list-item-group"],g,E)),loader:()=>new Promise((g,E)=>b(["../chunks/calcite-loader"],g,E))})}destroy(){this._destroyDrillInFlowItemWidgets();this._destroySelectedFeatureWidget();this._destroySpinner();
this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver?.disconnect();this._drillInWidget?.destroy();this._focusAbortController?.abort()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;const g=this.view?.widthBreakpoint;return"xsmall"===g||"small"===g||"medium"===g}get _featureNavigationVisible(){return this.viewModel.active&&1<this.viewModel.featureCount&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&
!!this.title&&!!this.content}get active(){return this.viewModel.active}get content(){return this.viewModel.content}set content(g){this.viewModel.content=g}get icon(){return null}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(g){this.viewModel.featureMenuOpen=g}get features(){return this.viewModel.features}set features(g){this.viewModel.features=g}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(g){this.viewModel.goToOverride=g}get location(){return this.viewModel.location}set location(g){this.viewModel.location=
g}get label(){return this.messages?.widgetLabel??""}set label(g){this._overrideIfSome("label",g)}get map(){return this.viewModel.map}set map(g){this.viewModel.map=g}get promises(){return this.viewModel.promises}set promises(g){this.viewModel.promises=g}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){const g=Array.from(this._drillInFlowItems).at(-1);if(!g)return null;const {flowType:E}=g;return"feature-association"===E||"feature-relationship"===E?g.graphic??
null:null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(g){this.viewModel.selectedFeatureIndex=g}get selectedFeatureWidget(){const {_feature:g,headingLevel:E,_drillInFlowItems:P,timeZone:R,spatialReference:V,map:T}=this,{selectedFeatureViewModel:X}=this.viewModel,Z={title:!1};if(!X)return null;g?(g.viewModel=X,g.visibleElements=Z):this._feature=new A({flowItems:P,headingLevel:E+1,timeZone:R,spatialReference:V,map:T,viewModel:X,visibleElements:Z});return this._feature}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(g){this.viewModel.spatialReference=
g}get title(){return this.viewModel.title}set title(g){this.viewModel.title=g}get timeZone(){return this.viewModel.timeZone}set timeZone(g){this.viewModel.timeZone=g}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(g){this.viewModel.updateLocationEnabled=g}get view(){return this.viewModel.view}set view(g){this.viewModel.view=g}get visible(){return this.viewModel.visible}set visible(g){this.viewModel.visible=g}blur(){const {active:g}=this.viewModel;
g?this._rootFlowItemNode?.blur():x.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=!1}fetchFeatures(g,E){return this.viewModel.fetchFeatures(g,E)}focus(){const {active:g}=this.viewModel;g?this._focusFlowItemNode(this.featureMenuOpen?"menu-flow-item":"root-flow-item"):x.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(g){this.removeHandles("selected-index");
this.set({collapsed:g?.collapsed??!1});this.viewModel.open(g);this.addHandles(m.when(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(g){return this.viewModel.triggerAction(g)}render(){return h.tsx("div",{bind:this,class:this.classes(L.css.base,J.globalCss.widget,J.globalCss.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),
this._renderFeatureMenuButton()]}_renderHeader(){return!this.featureMenuOpen&&this.featureNavigationTop&&this._featureNavigationVisible?h.tsx("div",{class:L.css.header,key:"header-actions"},this._renderFeatureNavigation()):null}_renderFooter(){return this.featureMenuOpen||this.featureNavigationTop||!this._featureNavigationVisible?null:h.tsx("div",{class:L.css.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation())}_renderFeatureMenuButton(){const {messages:g,viewModel:E}=this,
{featureCount:P,selectedFeatureIndex:R,pendingPromisesCount:V}=E;return h.tsx("calcite-action",{appearance:"solid",bind:this,icon:"list",key:"feature-menu-button",label:g.selectFeature,loading:0<V,onclick:this._openFeatureMenu,scale:"s",text:C.substitute(g.pageText,{index:I.formatNumber(R+1),total:I.formatNumber(P)}),textEnabled:!0,title:g.selectFeature})}_renderPagination(){const {previous:g,next:E}=this.messagesCommon.pagination;return h.tsx("calcite-action-bar",{class:L.css.paginationActionBar,
expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},h.tsx("calcite-action-group",{scale:"s"},h.tsx("calcite-action",{appearance:"solid",class:L.css.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:g,onclick:this._previousFeature,scale:"s",text:g,title:g}),h.tsx("calcite-action",{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:E,onclick:this._nextFeature,scale:"s",text:E,title:E})))}_renderFeatureMenuItem(g){const {selectedFeatureViewModel:E,
featureViewModels:P}=this.viewModel,R=g===E,V=P.indexOf(g);return h.tsx("calcite-list-item",{bind:this,"data-feature-index":V,key:`feature-menu-item-${g.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:R,onCalciteListItemSelect:this._selectFeature},h.tsx("span",{innerHTML:g.title||this.messagesCommon.untitled,slot:"content"}))}_groupResultsByLayer(){const {featureViewModels:g}=this.viewModel,E=
new Map;g.forEach(P=>{var R=P?.graphic;if(R){var {layer:V,sourceLayer:T}=R;R=(V?.declaredClass.startsWith("esri.layers.")??!1?V:null)||(T?.declaredClass.startsWith("esri.layers.")??!1?T:null);var X=E.get(R)??[];E.set(R,[...X,P])}});return E}_renderFeatureMenu(){const {featureViewModels:g}=this.viewModel,E=this._groupResultsByLayer();return g.length?h.tsx("calcite-list",{selectionAppearance:"icon",selectionMode:"single"},Array.from(E.keys(),P=>{const R=E.get(P)?.map(T=>this._renderFeatureMenuItem(T)),
V=P?P.title??this.messagesCommon.untitled:null;return this.visibleElements.featureListLayerTitle&&null!==V?h.tsx("calcite-list-item-group",{heading:V,key:P?.uid||"map-graphics"},R):R})):null}_renderHeaderAction(g,E){const P=g.title||"";return g.visible?h.tsx("calcite-action",{active:"toggle"===g.type?g.value:!1,appearance:"solid",bind:this,"data-action-uid":g.uid,disabled:g.disabled,icon:g.icon??void 0,indicator:g.indicator,key:`header-action-${E}`,loading:g.active,onclick:this._triggerHeaderAction,
slot:"header-actions-end",text:P,title:P}):null}_renderHeaderActions(){return this.headerActions.map((g,E)=>this._renderHeaderAction(g,E)).toArray()}_renderContentFeature(){const {headingLevel:g,visibleElements:E,_isCollapsed:P,_collapseEnabled:R,featureNavigationTop:V}=this,{title:T,active:X}=this.viewModel,Z=E.heading&&T?T:"";return h.tsx("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,bind:this,class:this.classes({[L.css.contentFeature]:!0,[L.css.flowItemCollapsed]:P}),closable:E.closeButton,
closed:!X,collapsed:P,collapseDirection:V?"down":"up",collapsible:R,headingLevel:g,key:"root-flow-item",onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},Z?h.tsx(K.Heading,{class:this.classes(L.css.featuresHeading,J.globalCss.heading),innerHTML:Z,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),P?null:h.tsx("div",{class:this.classes(L.css.container,L.css.contentContainer)},this._renderContent()),
this._renderFooter())}_renderFeatureMenuContainer(){const {viewModel:g,featureMenuOpen:E,messages:P,messagesCommon:R}=this,{active:V,featureViewModels:T,pendingPromisesCount:X}=g;return E?h.tsx("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,bind:this,closable:!1,closed:!V,description:C.substitute(P.total,{total:T.length}),heading:P.selectFeature,key:"feature-menu",loading:g.waitingForContents,onCalciteFlowItemBack:Z=>{Z.preventDefault();this._handleFeatureMenuBack()}},0<X?h.tsx("calcite-loader",
{class:L.css.loader,inline:!0,key:"feature-menu-loader",label:R.loading,slot:"header-actions-end"}):null,h.tsx("div",{class:L.css.container},this._renderFeatureMenu()),h.tsx("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:L.css.featureMenuObserver}),h.tsx("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},R.back)):null}_renderContentContainer(){const g=[this._renderContentFeature(),this._renderFeatureMenuContainer(),
this._drillInWidget.render()];return this.visibleElements.flow?h.tsx("calcite-flow",{key:"content-container"},g):g}_getFallbackIcon(g){const {className:E,icon:P}=g;if(P)return null;g=p.substituteActionImage({action:g,feature:this.selectedFeature});const R={[L.css.icon]:!!E,[L.css.actionImage]:!!g};E&&(R[E]=!0);return g||E?h.tsx("span",{"aria-hidden":"true",class:this.classes(L.css.icon,R),key:"icon",styles:p.getActionStyles(g)}):null}_renderActionBar(){return!this._isCollapsed&&this.visibleElements.actionBar&&
this.viewModel.allActions?.length?h.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},h.tsx("calcite-action-group",{afterCreate:g=>this._actionBarMenuNode=g,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){const g=this.viewModel?.content;return g?"string"===typeof g?h.tsx("div",{class:u.css.contentNode,
innerHTML:g,key:g}):this.renderNodeContent(g):null}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(g){await g.viewModel.updateGeometry();g=g.graphic;var E=g?.geometry;null!=E&&null!=g&&(this._destroyDrillInFlowItemWidgets(),await this.viewModel.zoomTo({target:E}),E=q.getPointFromGeometry(E),this.open({features:[g],location:null!=E?E:void 0}))}async _focusFlowItemNode(g){this._focusAbortController?.abort();this._focusAbortController=new AbortController;await F.ignoreAbortErrors(H.waitAnimationFrame(this._focusAbortController.signal));
N.setFocus("menu-flow-item"===g?this._featureMenuViewportNode:this._rootFlowItemNode)}_storeRootFlowItemNode(g){this._rootFlowItemNode=g}_storeFeatureMenuFlowItemNode(g){this._featureMenuViewportNode=g}_setActiveFeature(g){const {viewModel:E}=this;g=g.currentTarget["data-feature-index"];E.activeFeature=E.features?.[g]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_selectFeature(g){g=g.currentTarget["data-feature-index"];isNaN(g)||(this.viewModel.selectedFeatureIndex=g);this._handleFeatureMenuBack()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&
this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(g){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(g);this._featureMenuIntersectionObserverNode=g}_getActionIcon(g){if(g.icon)return g.icon;if(!g.image&&!g.className)return"question"}_getActionTitle(g){const {messages:E,selectedFeature:P,messagesCommon:R}=this,{id:V}=g,T=P?.attributes,X=g.title??"";return(g="zoom-to-feature"===V?C.substitute(X,
{messages:E}):"remove-selected-feature"===V?C.substitute(X,{messages:R}):"zoom-to-clustered-features"===V?C.substitute(X,{messages:E}):"browse-clustered-features"===V?C.substitute(X,{messages:E}):g.title)&&T?C.substitute(g,T):g??""}_onMainKeydown(g){const {key:E}=g;"ArrowLeft"===E&&(g.stopPropagation(),this._handleFeatureMenuBack(),this.previous());"ArrowRight"===E&&(g.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const {selectedFeatureWidget:g}=
this;g&&(this.viewModel.content=g)}_setTitleFromFeatureWidget(){const {selectedFeatureWidget:g,messagesCommon:E}=this,P=g?.viewModel;g&&(this.viewModel.title="error"===P?.state?E?.errorMessage:P?.title||"")}_addSelectedFeatureIndexHandle(){const g=m.watch(()=>this.viewModel?.selectedFeatureIndex,(E,P)=>this._selectedFeatureIndexUpdated(E,P));this.addHandles(g,"selected-index")}_selectedFeatureIndexUpdated(g,E){const {featureCount:P}=this.viewModel;P&&g!==E&&-1!==g&&(this._destroyDrillInFlowItemWidgets(),
this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(g){g=g.currentTarget;if(!g.disabled){var E=g.dataset.actionUid;(g=this.headerActions.find(({uid:P})=>P===E))&&!g.disabled&&("toggle"===g?.type&&(g.value=!g.value),this.emit("trigger-header-action",{action:g}))}}_triggerAction(g){g=g.currentTarget;if(!g.disabled){var E=g.dataset.actionUid,{allActions:P}=this.viewModel;g=P.findIndex(R=>R.uid===E);(P=P.at(g))&&"toggle"===P.type&&(P.value=!P.value);this.viewModel.triggerAction(g)}}_createSpinner(g){g&&
(this._spinner=new v({view:g}),g.ui.add(this._spinner,{key:"features-spinner",position:"manual",internal:!0}))}_wireUpView(g){this._destroySpinner();g&&this.visibleElements?.spinner&&this._createSpinner(g)}_hideSpinner(){const {_spinner:g}=this;g&&(g.location=null,g.hide())}_viewReadyChange(g,E){g?this._wireUpView(this.viewModel?.view):E&&this.viewModel.clear()}_viewChange(g,E){g&&E&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const {_feature:g}=this;g&&(g.viewModel=null,!g.destroyed&&
g.destroy());this._feature=null}_closeOpenActionMenu(){const {_actionBarMenuNode:g}=this;g&&(g.menuOpen=!1)}_destroyDrillInFlowItemWidgets(){this._drillInFlowItems.drain(g=>{"showAllEnabled"in g.viewModel&&(g.viewModel.showAllEnabled=!1);g.viewModel=null;g.destroy()})}_toggleScreenLocationEnabled(){const {viewModel:g}=this;g&&(g.screenLocationEnabled=g.active)}_displaySpinner(){const {_spinner:g}=this;if(g){var {location:E,waitingForResult:P}=this.viewModel;P&&E?g.show({location:E}):g.hide()}}_destroySpinner(){const {_spinner:g,
view:E}=this;g&&(E?.ui?.remove(g,"features-spinner"),g.destroy(),this._spinner=null)}_spinnerEnabledChange(g){this._destroySpinner();g&&this._createSpinner(this.viewModel?.view)}};k.__decorate([t.property()],e.prototype,"_drillInFlowItems",void 0);k.__decorate([t.property()],e.prototype,"_hideActionText",null);k.__decorate([t.property()],e.prototype,"_featureNavigationVisible",null);k.__decorate([t.property()],e.prototype,"_isCollapsed",null);k.__decorate([t.property()],e.prototype,"_collapseEnabled",
null);k.__decorate([t.property({readOnly:!0})],e.prototype,"active",null);k.__decorate([t.property()],e.prototype,"collapsed",void 0);k.__decorate([t.property()],e.prototype,"content",null);k.__decorate([t.property()],e.prototype,"icon",null);k.__decorate([t.property()],e.prototype,"featureMenuOpen",null);k.__decorate([t.property()],e.prototype,"featureNavigationTop",void 0);k.__decorate([t.property()],e.prototype,"features",null);k.__decorate([t.property()],e.prototype,"goToOverride",null);k.__decorate([t.property({type:d.ActionsCollection})],
e.prototype,"headerActions",void 0);k.__decorate([t.property()],e.prototype,"headingLevel",void 0);k.__decorate([t.property()],e.prototype,"location",null);k.__decorate([t.property()],e.prototype,"label",null);k.__decorate([t.property()],e.prototype,"map",null);k.__decorate([t.property(),G.messageBundle("esri/widgets/Features/t9n/Features")],e.prototype,"messages",void 0);k.__decorate([t.property(),G.messageBundle("esri/t9n/common")],e.prototype,"messagesCommon",void 0);k.__decorate([t.property()],
e.prototype,"promises",null);k.__decorate([t.property()],e.prototype,"responsiveActionsEnabled",void 0);k.__decorate([t.property({readOnly:!0})],e.prototype,"selectedFeature",null);k.__decorate([t.property({readOnly:!0})],e.prototype,"selectedDrillInFeature",null);k.__decorate([t.property()],e.prototype,"selectedFeatureIndex",null);k.__decorate([t.property({readOnly:!0})],e.prototype,"selectedFeatureWidget",null);k.__decorate([t.property()],e.prototype,"spatialReference",null);k.__decorate([t.property()],
e.prototype,"title",null);k.__decorate([t.property()],e.prototype,"timeZone",null);k.__decorate([t.property()],e.prototype,"updateLocationEnabled",null);k.__decorate([t.property()],e.prototype,"view",null);k.__decorate([t.property({type:c}),Q.vmEvent(["triggerAction","trigger-action"])],e.prototype,"viewModel",void 0);k.__decorate([t.property({type:a,nonNullable:!0})],e.prototype,"visibleElements",void 0);k.__decorate([t.property()],e.prototype,"visible",null);return e=k.__decorate([r.subclass("esri.widgets.Features")],
e)})},"esri/core/throttle":function(){define(["exports"],function(b){b.throttle=function(k,e,B,x){let F=null,m=1E3;"number"===typeof e?(m=e,x=B):(F=e??null,m=B);let H=0,O;const t=()=>{H=0;k.apply(x,O)};e=(...w)=>{F&&F.apply(x,w);O=w;m?H||=setTimeout(t,m):t()};e.remove=()=>{H&&(clearTimeout(H),H=0)};e.forceUpdate=()=>{H&&(clearTimeout(H),t())};e.hasPendingUpdates=()=>!!H;return e};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geometryUtils":function(){define(["exports",
"../../geometry","./scaleUtils","../Extent"],function(b,k,e,B){function x(F,m,H){const O=F.hasZ?F.z:void 0;if(m?.map)return(null!=H?e.getExtentForScale(m,H):m.extent).clone().centerAt(F).set({zmax:O,zmin:O});const {x:t,y:w,spatialReference:f}=F;return new B({xmin:t-.25,ymin:w-.25,xmax:t+.25,ymax:w+.25,spatialReference:f,zmin:O,zmax:O})}b.createExtentFromGeometry=function(F,m,H){switch(F?.type){case "extent":return F;case "multipoint":case "polygon":case "polyline":return F.extent;case "point":return x(F,
m,H);default:return null}};b.createExtentFromPoint=x;b.getPointFromGeometry=function(F){switch(F?.type){case "point":return F;case "extent":return F.center;case "polygon":return F.centroid;case "multipoint":case "polyline":return F.extent?.center;default:return null}};b.getPointWithElevation=async function(F,m){if(F.hasZ||"2d"===m.type)return F;const H=m.map?.ground;if(!H?.layers.length)return F;({geometry:F}=await H.queryElevation(F,{cache:m.basemapTerrain?.elevationQueryCache}));return F};b.scaleExtent=
function(F,m,H){return x(F.center,m,H)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(b,k,e){function B(x,F){F=e.getMetersPerUnitForSR(F);return x/(F*e.inchesPerMeter*96)}b.getExtentForScale=function(x,F){const m=x.extent;x=x.width-(x.padding?x.padding.left+x.padding.right:0);F=B(F,m.spatialReference);return m.clone().expand(F*x/m.width)};b.getResolutionForScale=
B;b.getResolutionInMetersForScale=function(x){return x/(96*e.inchesPerMeter)};b.getScale=function(x,F){F=F||x.extent;x=x.width;const m=e.getMetersPerUnitForSR(F?.spatialReference);return F&&x?F.width/x*m*e.inchesPerMeter*96:0};b.getScaleForResolution=function(x,F){F=e.getMetersPerUnitForSR(F);return x*F*e.inchesPerMeter*96};b.isInScaleRange=function(x,F,m){if(F=0===F||k.floatEqualAbsolute(x,F)||x<F)F=0===m||k.floatEqualAbsolute(x,m)||x>m;return F};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/support/actions/actionUtils":function(){define(["exports","../../intl","../../intl/substitute"],function(b,k,e){b.getActionIcon=function(B){if(B.icon)return B.icon;if(!("image"in B&&B.image||B.className))return"question"};b.getActionStyles=function(B){return B?{backgroundImage:`url(${B})`}:{}};b.substituteActionImage=function({action:B,feature:x}){x=x?.attributes;return(B="image"in B?B.image:void 0)&&x?e.substitute(B,x):B??""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Feature":function(){define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureUtilityNetworkAssociations ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l,c,a,d,n,D){const J={title:!0,content:!0,lastEditedInfo:!0};e=class extends y.FeatureContentMixin(t){constructor(K,N){super(K,N);this._contentWidgets=[];this.flowType="feature";this.flowItems=null;this.headingLevel=2;this.messagesCommon=this.messages=null;this.visibleElements={...J};this.viewModel=new z}initialize(){this.addHandles(B.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),B.initial))}loadDependencies(){return L.loadCalciteComponents({notice:()=>
new Promise((K,N)=>b(["../chunks/calcite-notice"],K,N)),loader:()=>new Promise((K,N)=>b(["../chunks/calcite-loader"],K,N))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(K){this.viewModel.graphic=K}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(K){this.viewModel.defaultPopupTemplateEnabled=K}get isTable(){return this.viewModel.isTable}get icon(){return"polygon"}set icon(K){this._overrideIfSome("icon",
K)}get label(){return this.messages?.widgetLabel??""}set label(K){this._overrideIfSome("label",K)}get location(){return this.viewModel.location}set location(K){this.viewModel.location=K}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(K){this.viewModel.spatialReference=K}get timeZone(){return this.viewModel.timeZone}set timeZone(K){this.viewModel.timeZone=K}get title(){return this.viewModel.title}castVisibleElements(K){return{...J,...K}}get map(){return this.viewModel.map}set map(K){this.viewModel.map=
K}get view(){return this.viewModel.view}set view(K){this.viewModel.view=K}setActiveMedia(K,N){return this.viewModel.setActiveMedia(K,N)}nextMedia(K){return this.viewModel.nextMedia(K)}previousMedia(K){return this.viewModel.previousMedia(K)}render(){var {state:K}=this.viewModel;K=n.tsx("div",{class:u.css.container,key:"container"},this._renderTitle(),"error"===K?this._renderError():"loading"===K?this._renderLoading():this._renderContentContainer());return n.tsx("div",{class:this.classes(u.css.base,
l.globalCss.widget)},K)}_renderError(){const {messagesCommon:K,messages:N,visibleElements:G}=this;return n.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},G.title?n.tsx("div",{key:"error-title",slot:"title"},K.errorMessage):null,n.tsx("div",{key:"error-message",slot:"message"},N.loadingError))}_renderLoading(){return n.tsx("div",{class:u.css.loadingSpinnerContainer,key:"loading-container"},n.tsx("calcite-loader",{inline:!0,label:""}))}_renderContentContainer(){const {visibleElements:K}=
this;return K.content?n.tsx("div",{class:u.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:K,title:N}=this;return K.title?n.tsx(c.Heading,{class:u.css.title,innerHTML:N,level:this.headingLevel}):null}_renderContent(){var K=this.viewModel.content;return K?Array.isArray(K)?K.length?n.tsx("div",{class:u.css.contentNode,key:"content-content-elements"},K.map(this._renderContentElement,this)):null:"string"===typeof K?(K=this._contentWidgets[0],!K||
K.destroyed?null:n.tsx("div",{class:this.classes(u.css.contentNode,u.css.contentNodeText),key:"content-content"},K.render())):this.renderNodeContent(K):null}_renderContentElement(K,N){const {visibleElements:G}=this;if("boolean"!==typeof G.content&&!G.content?.[K.type])return null;switch(K.type){case "attachments":return this._renderAttachments(N);case "custom":return this._renderCustom(K,N);case "fields":return this._renderFields(N);case "media":return this._renderMedia(N);case "text":return this._renderText(K,
N);case "expression":return this._renderExpression(N);case "relationship":return this._renderRelationship(N);case "utility-network-associations":return this._renderAssociation(N);default:return null}}_renderAttachments(K){const N=this._contentWidgets[K];if(!N||N.destroyed)return null;const {state:G,attachmentInfos:Q}=N.viewModel;return"loading"===G||0<Q.length?n.tsx("div",{class:this.classes(u.css.contentElement),key:this._buildKey("attachments-element",K)},N.render()):null}_renderRelationship(K){const N=
this._contentWidgets[K];return N&&!N.destroyed&&this.flowItems?n.tsx("div",{class:u.css.contentElement,key:this._buildKey("relationship-element",K)},N.render()):null}_renderAssociation(K){const N=this._contentWidgets[K];return N&&!N.destroyed&&this.flowItems?n.tsx("div",{class:u.css.contentElement,key:this._buildKey("utility-network-association-element",K)},N.render()):null}_renderExpression(K){const N=this._contentWidgets[K];return N&&!N.destroyed&&N.viewModel.contentElement?n.tsx("div",{class:u.css.contentElement,
key:this._buildKey("expression-element",K)},N.render()):null}_renderCustom(K,N){({creator:K}=K);const G=this._contentWidgets[N];return!G||G.destroyed?null:K?n.tsx("div",{class:u.css.contentElement,key:this._buildKey("custom-element",N)},G.render()):null}_renderFields(K){const N=this._contentWidgets[K];return!N||N.destroyed?null:n.tsx("div",{class:u.css.contentElement,key:this._buildKey("fields-element",K)},N.render())}_renderMedia(K){const N=this._contentWidgets[K];return!N||N.destroyed?null:n.tsx("div",
{class:u.css.contentElement,key:this._buildKey("media-element",K)},N.render())}_renderLastEditInfo(){const {visibleElements:K,messages:N}=this;var {lastEditInfo:G}=this.viewModel;if(!G||!K.lastEditedInfo)return null;const {date:Q,user:h}=G;G=D.substitute("edit"===G.type?h?N.lastEditedByUser:N.lastEdited:h?N.lastCreatedByUser:N.lastCreated,{date:Q,user:h});return n.tsx("div",{class:this.classes(u.css.lastEditedInfo,u.css.contentElement),key:"edit-info-element"},G)}_renderText(K,N){const G=this._contentWidgets[N];
return!G||G.destroyed?null:K.text?n.tsx("div",{class:this.classes(u.css.contentElement,u.css.text),key:this._buildKey("text-element",N)},G.render()):null}_buildKey(K,...N){const G=this.viewModel?.graphic?.uid||"0";N=N.join("-");return`${K}__${G}-${N}`}_destroyContentWidget(K){K&&(K.viewModel=null,!K.destroyed&&K.destroy())}_destroyContentWidgets(){this._contentWidgets.forEach(K=>this._destroyContentWidget(K));this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:K,
visibleElements:N,flowItems:G,viewModel:Q}=this;var h=Q?.content;const {contentViewModels:C}=Q;Array.isArray(h)?h.forEach((I,g)=>{"attachments"===I.type&&(this._contentWidgets[g]=new w({displayType:I.displayType,headingLevel:N.title&&6>K?K+1:K,viewModel:C[g]}));"fields"===I.type&&(this._contentWidgets[g]=new q({viewModel:C[g]}));"media"===I.type&&(this._contentWidgets[g]=new p({viewModel:C[g]}));"text"===I.type&&(this._contentWidgets[g]=new f({viewModel:C[g]}));"custom"===I.type&&(this._contentWidgets[g]=
new f({viewModel:C[g]}));"expression"===I.type&&(this._contentWidgets[g]=new r({viewModel:C[g]}));if("relationship"===I.type){const E=new A({flowItems:G,featureVisibleElements:N,viewModel:C[g]});this._contentWidgets[g]=E}"utility-network-associations"===I.type&&(I=new v({flowItems:G,parentFeatureViewModel:Q,featureVisibleElements:N,viewModel:C[g]}),this._contentWidgets[g]=I)},this):(h=C[0])&&!h.destroyed&&(this._contentWidgets[0]=new f({viewModel:h}));this.scheduleRender()}};k.__decorate([x.property()],
e.prototype,"flowType",void 0);k.__decorate([x.property()],e.prototype,"graphic",null);k.__decorate([x.property()],e.prototype,"defaultPopupTemplateEnabled",null);k.__decorate([x.property()],e.prototype,"flowItems",void 0);k.__decorate([x.property()],e.prototype,"headingLevel",void 0);k.__decorate([x.property({readOnly:!0})],e.prototype,"isTable",null);k.__decorate([x.property()],e.prototype,"icon",null);k.__decorate([x.property()],e.prototype,"label",null);k.__decorate([x.property()],e.prototype,
"location",null);k.__decorate([x.property(),d.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);k.__decorate([x.property(),d.messageBundle("esri/t9n/common")],e.prototype,"messagesCommon",void 0);k.__decorate([x.property()],e.prototype,"spatialReference",null);k.__decorate([x.property()],e.prototype,"timeZone",null);k.__decorate([x.property({readOnly:!0})],e.prototype,"title",null);k.__decorate([x.property()],e.prototype,"visibleElements",void 0);k.__decorate([F.cast("visibleElements")],
e.prototype,"castVisibleElements",null);k.__decorate([x.property()],e.prototype,"map",null);k.__decorate([x.property()],e.prototype,"view",null);k.__decorate([x.property({type:z})],e.prototype,"viewModel",void 0);return e=k.__decorate([O.subclass("esri.widgets.Feature")],e)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r){B=class extends O{constructor(q,p){super(q,p);this._featureElementInfo=null;this.attachmentsWidget=new H;this.headingLevel=2;this.viewModel=new t}initialize(){this._featureElementInfo=new w;this.addHandles([k.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),k.initial),k.watch(()=>this.viewModel,q=>this.attachmentsWidget.viewModel=q,k.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();
this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(q){this.viewModel.description=q}get displayType(){return this.attachmentsWidget.displayType}set displayType(q){this.attachmentsWidget.displayType=q}get graphic(){return this.viewModel.graphic}set graphic(q){this.viewModel.graphic=q}get title(){return this.viewModel.title}set title(q){this.viewModel.title=q}render(){const {attachmentsWidget:q}=this;return r.tsx("div",{class:"esri-feature-attachments"},
this._featureElementInfo?.render(),q?.render())}_setupFeatureElementInfo(){const {description:q,title:p,headingLevel:A}=this;this._featureElementInfo?.set({description:q,title:p,headingLevel:A})}};b.__decorate([e.property({readOnly:!0})],B.prototype,"attachmentsWidget",void 0);b.__decorate([e.property()],B.prototype,"description",null);b.__decorate([e.property()],B.prototype,"displayType",null);b.__decorate([e.property()],B.prototype,"graphic",null);b.__decorate([e.property()],B.prototype,"headingLevel",
void 0);b.__decorate([e.property()],B.prototype,"title",null);b.__decorate([e.property({type:t})],B.prototype,"viewModel",void 0);return B=b.__decorate([m.subclass("esri.widgets.Feature.FeatureAttachments")],B)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u){const y={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},L=window.CSS;H=class extends w{constructor(l,c){super(l,c);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...y};this._supportsImageOrientation=L&&L.supports&&L.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(l){l?.viewModel||(l={viewModel:new f,...l});return l}initialize(){this.addHandles([B.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),B.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),B.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),B.initial)])}loadDependencies(){return q.loadCalciteComponents({icon:()=>new Promise((l,c)=>b(["../chunks/calcite-icon"],l,c))})}get capabilities(){return this.viewModel.capabilities}set capabilities(l){this.viewModel.capabilities=
l}get effectiveDisplayType(){const {displayType:l}=this;return l&&"auto"!==l?l:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(l){this.viewModel.graphic=l}get icon(){return"attachment"}set icon(l){this._overrideIfSome("icon",l)}get label(){return this.messages?.widgetLabel??""}set label(l){this._overrideIfSome("label",l)}castVisibleElements(l){return{...y,...l}}addAttachment(){const {_addAttachmentForm:l,viewModel:c}=this;this._set("submitting",
!0);this._set("error",null);return c.addAttachment(l).then(a=>{this._set("submitting",!1);this._set("error",null);c.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new e("attachments:add-attachment",this.messages.addErrorMessage,a));throw a;})}deleteAttachment(l){const {viewModel:c}=this;this._set("submitting",!0);this._set("error",null);return c.deleteAttachment(l).then(a=>{this._set("submitting",!1);this._set("error",null);c.mode="view";return a}).catch(a=>{this._set("submitting",
!1);this._set("error",new e("attachments:delete-attachment",this.messages.deleteErrorMessage,a));throw a;})}updateAttachment(){const {viewModel:l}=this,{_updateAttachmentForm:c}=this;this._set("submitting",!0);this._set("error",null);return l.updateAttachment(c).then(a=>{this._set("submitting",!1);this._set("error",null);l.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new e("attachments:update-attachment",this.messages.updateErrorMessage,a));throw a;})}addFile(){const l=
this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return l}updateFile(){const {viewModel:l}=this,c=l.updateFile(this.selectedFile,this._updateAttachmentForm,l.activeFileInfo);l.mode="view";return c}deleteFile(l){l=this.viewModel.deleteFile(l||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return l}render(){const {submitting:l,viewModel:c}=this,{state:a}=c;return u.tsx("div",{class:this.classes("esri-attachments",p.globalCss.widget)},l?this._renderProgressBar():
null,"loading"===a?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const {error:l,visibleElements:c}=this;return l&&c.errorMessage?u.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},l.message):null}_renderAttachments(){const {activeFileInfo:l,mode:c,activeAttachmentInfo:a}=this.viewModel;return"add"===c?this._renderAddForm():"edit"===c?this._renderDetailsForm(a||l):this._renderAttachmentContainer()}_renderLoading(){return u.tsx("div",
{class:"esri-attachments__loader-container",key:"loader"},u.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?u.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:l,selectedFile:c}=this;var a=l||!c,d=this.visibleElements.cancelAddButton?u.tsx("button",{bind:this,class:this.classes(p.globalCss.button,p.globalCss.buttonTertiary,p.globalCss.buttonSmall,p.globalCss.buttonHalf,l&&p.globalCss.buttonDisabled),
disabled:l,onclick:this._cancelForm,type:"button"},this.messages.cancel):null;a=this.visibleElements.addSubmitButton?u.tsx("button",{class:this.classes(p.globalCss.button,p.globalCss.buttonSecondary,p.globalCss.buttonSmall,p.globalCss.buttonHalf,{[p.globalCss.buttonDisabled]:a}),disabled:a,type:"submit"},this.messages.add):null;const n=c?u.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},c.name):null;d=u.tsx("form",{afterCreate:v.storeNode,afterRemoved:v.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",
onsubmit:this._submitAddAttachment},u.tsx("fieldset",{class:"esri-attachments__file-fieldset"},n,u.tsx("label",{class:this.classes("esri-attachments__file-label",p.globalCss.button,p.globalCss.buttonSecondary)},c?this.messages.changeFile:this.messages.selectFile,u.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),a,d);return u.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},d)}_renderDetailsForm(l){const {visibleElements:c,
viewModel:a,selectedFile:d,submitting:n}=this;var {capabilities:D}=a,J=n||!d;let K;if(d){var N=d.type;K=d.name;var G=d.size}else if(l&&"file"in l)N=l.file.type,K=l.file.name,G=l.file.size;else if(l&&"contentType"in l){N=l.contentType;K=l.name;G=l.size;var Q=l.url}var h=D.editing&&D.operations?.delete&&c.deleteButton?u.tsx("button",{bind:this,class:this.classes(p.globalCss.button,p.globalCss.buttonSmall,p.globalCss.buttonTertiary,"esri-attachments__delete-button",{[p.globalCss.buttonDisabled]:n}),
disabled:n,key:"delete-button",onclick:I=>this._submitDeleteAttachment(I,l),type:"button"},this.messages.delete):void 0;J=D.editing&&D.operations?.update&&c.updateButton?u.tsx("button",{class:this.classes(p.globalCss.button,p.globalCss.buttonSmall,p.globalCss.buttonThird,{[p.globalCss.buttonDisabled]:J}),disabled:J,key:"update-button",type:"submit"},this.messages.update):void 0;const C=this.visibleElements.cancelUpdateButton?u.tsx("button",{bind:this,class:this.classes(p.globalCss.button,p.globalCss.buttonSmall,
p.globalCss.buttonTertiary,p.globalCss.buttonThird,{[p.globalCss.buttonDisabled]:n}),disabled:n,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;D=D.editing&&D.operations?.update?u.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},u.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},K),u.tsx("label",{class:this.classes("esri-attachments__file-label",p.globalCss.button,p.globalCss.buttonSecondary)},this.messages.changeFile,u.tsx("input",
{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;G=u.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},u.tsx("label",null,x.formatFileSize(this.messagesUnits,G??0)));N=u.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},u.tsx("label",null,N));Q=null!=Q?u.tsx("a",{class:"esri-attachments__item-link",href:Q,rel:"noreferrer",target:"_blank"},this._renderImageMask(l,400),u.tsx("div",
{class:"esri-attachments__item-link-overlay"},u.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},u.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(l,400);h=u.tsx("form",{afterCreate:v.storeNode,afterRemoved:v.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:I=>this._submitUpdateAttachment(I,l)},u.tsx("div",{class:"esri-attachments__metadata"},G,N),D,u.tsx("div",{class:"esri-attachments__actions"},h,C,J));return u.tsx("div",{class:"esri-attachments__form-node",
key:"edit-form-container"},Q,h)}_renderImageMask(l,c){return l?"file"in l?this._renderGenericImageMask(l.file.name,l.file.type):this._renderImageMaskForAttachment(l,c):null}_renderGenericImageMask(l,c){var {supportsResizeAttachments:a}=this.viewModel;c=r.getIconPath(c);a={["esri-attachments__image--resizable"]:a};return u.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:c},u.tsx("img",{alt:l,class:this.classes(a,"esri-attachments__image"),src:c,
title:l}))}_renderImageMaskForAttachment(l,c){var {supportsResizeAttachments:a}=this.viewModel;if(!l)return null;const {contentType:d,name:n,url:D}=l;if(!a||!r.isSupportedImage(d))return this._renderGenericImageMask(n,d);l=(l=this._getCSSTransform(l))?{transform:l,"image-orientation":"none"}:{};c=`${D}${D?.includes("?")?"\x26":"?"}w=${c}`;a={["esri-attachments__image--resizable"]:a};return u.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:c},u.tsx("img",{alt:n,class:this.classes(a,
"esri-attachments__image"),src:c,styles:l,title:n}))}_renderFile(l){const {file:c}=l;return u.tsx("li",{class:"esri-attachments__item",key:c},u.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(l),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(l),u.tsx("label",{class:"esri-attachments__label"},u.tsx("span",{class:"esri-attachments__filename"},c.name||this.messages.noTitle),
u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",v.isRTL(this.container)?A.legacyIcon.left:A.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:l,displayType:c}){const {viewModel:a,effectiveDisplayType:d}=this,{capabilities:n,supportsResizeAttachments:D}=a,{contentType:J,name:K,url:N}=l;c=this._renderImageMask(l,"list"===c?48:400);var G=n.editing?u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",v.isRTL(this.container)?
A.legacyIcon.left:A.legacyIcon.right)}):null;G="preview"===d&&D&&r.isSupportedImage(J)?null:u.tsx("label",{class:"esri-attachments__label"},u.tsx("span",{class:"esri-attachments__filename"},K||this.messages.noTitle),G);c=[c,G];c=n.editing?u.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":l.id,key:"details-button",onclick:()=>this._startEditAttachment(l),title:this.messages.attachmentDetails,type:"button"},c):u.tsx("a",
{class:"esri-attachments__item-button",href:N??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},c);return u.tsx("li",{class:"esri-attachments__item",key:l},c)}_renderAttachmentContainer(){const {effectiveDisplayType:l,viewModel:c,visibleElements:a}=this,{attachmentInfos:d,capabilities:n,fileInfos:D}=c;var J=!!d?.length;const K=!!D?.length,N={["esri-attachments__container--list"]:"preview"!==l,["esri-attachments__container--preview"]:"preview"===l},G=n.editing&&n.operations?.add&&a.addButton?
u.tsx("button",{bind:this,class:this.classes(p.globalCss.button,p.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),onclick:()=>this._startAddAttachment(),type:"button"},u.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",A.legacyIcon.plus)}),this.messages.add):void 0,Q=J?u.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},d.toArray().map(C=>this._renderAttachmentInfo({attachmentInfo:C,displayType:l}))):void 0,h=K?u.tsx("ul",{class:"esri-attachments__items",
key:"file-list"},D.toArray().map(C=>this._renderFile(C))):void 0;J=K||J?void 0:u.tsx("div",{class:p.globalCss.empty},this.messages.noAttachments);return u.tsx("div",{class:this.classes("esri-attachments__container",N),key:"attachments-container"},Q,h,J,G)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(l){l=l.target.files?.item(0);this._set("selectedFile",l)}_submitDeleteAttachment(l,c){l.preventDefault();c&&("file"in c?this.deleteFile(c.file):c&&this.deleteAttachment(c))}_submitAddAttachment(l){l.preventDefault();
this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(l,c){l.preventDefault();c&&"file"in c?this.updateFile():this.updateAttachment()}_startEditAttachment(l){const {viewModel:c}=this;c.activeFileInfo=null;c.activeAttachmentInfo=l;c.mode="edit"}_startEditFile(l){const {viewModel:c}=this;c.activeAttachmentInfo=null;c.activeFileInfo=l;c.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(l){l.preventDefault();this.viewModel.mode="view"}_getCSSTransform(l){({orientationInfo:l}=
l);return!this._supportsImageOrientation&&l?[l.rotation?`rotate(${l.rotation}deg)`:"",l.mirrored?"scaleX(-1)":""].join(" "):""}};k.__decorate([F.property()],H.prototype,"capabilities",null);k.__decorate([F.property()],H.prototype,"displayType",void 0);k.__decorate([F.property({readOnly:!0})],H.prototype,"effectiveDisplayType",null);k.__decorate([F.property()],H.prototype,"graphic",null);k.__decorate([F.property()],H.prototype,"icon",null);k.__decorate([F.property()],H.prototype,"label",null);k.__decorate([F.property(),
z.messageBundle("esri/widgets/Attachments/t9n/Attachments")],H.prototype,"messages",void 0);k.__decorate([F.property(),z.messageBundle("esri/core/t9n/Units")],H.prototype,"messagesUnits",void 0);k.__decorate([F.property({readOnly:!0})],H.prototype,"selectedFile",void 0);k.__decorate([F.property({readOnly:!0})],H.prototype,"submitting",void 0);k.__decorate([F.property({readOnly:!0})],H.prototype,"error",void 0);k.__decorate([F.property({type:f})],H.prototype,"viewModel",void 0);k.__decorate([F.property()],
H.prototype,"visibleElements",void 0);k.__decorate([m.cast("visibleElements")],H.prototype,"castVisibleElements",null);return H=k.__decorate([t.subclass("esri.widgets.Attachments")],H)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(b,k,e,B,x,F,m,H){function O(p,A,v){return p.units[A][v]}function t(p,A,v,z=2,u="abbr"){return`${H.formatNumber(A,{minimumFractionDigits:z,maximumFractionDigits:z,
signDisplay:0<A?"never":"exceptZero"})} ${O(p,v,u)}`}function w(p,A,v,z=2,u="abbr"){return`${H.formatNumber(A,{minimumFractionDigits:z,maximumFractionDigits:z,signDisplay:"exceptZero"})} ${O(p,v,u)}`}function f(p,A){const v=JSON.stringify(A);let z=r.get(v);z||(z=new Intl.NumberFormat("en-US",A),r.set(v,z));return/^[-+]?360\.?0*\u00b0?$/.test(z.format(p))?0:p}const r=new Map,q=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(p,A,v,z,u,y=e.cyclicalDegrees,L=!0){p=y.normalize(x.convertRotationType(m.convertUnit(p,
A,"degrees"),v,z),0,L);u=u??2;u={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:u,minimumFractionDigits:u,signDisplay:0<p?"never":"exceptZero"};p=f(p,u);return H.formatNumber(p,u)};b.formatDMS=function(p,A,v=2){p=m.convertUnit(p,A,"degrees");A=p-Math.floor(p);p-=A;A*=60;let z=A-Math.floor(A);A-=z;z*=60;return`${p.toFixed()}\u00b0 ${A.toFixed()}' ${z.toFixed(v)}"`};b.formatDecimal=t;b.formatFileSize=function(p,A){A=Math.round(A);let v=0===A?0:Math.floor(Math.log(A)/Math.log(k.ByteSizeUnit.KILOBYTES));
v=B.clamp(v,0,q.length-1);A=H.formatNumber(A/k.ByteSizeUnit.KILOBYTES**v,{maximumFractionDigits:2});return F.replace(p.units.bytes[q[v]],{fileSize:A})};b.formatImperialArea=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveImperialAreaUnit(A,v);return t(p,m.convertUnit(A,v,y),y,z,u)};b.formatImperialLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveImperialLengthUnit(A,v);return t(p,m.convertUnit(A,v,y),y,z,u)};b.formatImperialRelativeLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveImperialLengthUnit(A,
v);return w(p,m.convertUnit(A,v,y),y,z,u)};b.formatImperialRelativeVerticalLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveImperialVerticalLengthUnit(A,v);return w(p,m.convertUnit(A,v,y),y,z,u)};b.formatImperialVerticalLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveImperialVerticalLengthUnit(A,v);return t(p,m.convertUnit(A,v,y),y,z,u)};b.formatMetricArea=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveMetricAreaUnit(A,v);return t(p,m.convertUnit(A,v,y),y,z,u)};b.formatMetricLength=function(p,
A,v,z=2,u="abbr"){const y=m.adaptiveMetricLengthUnit(A,v);return t(p,m.convertUnit(A,v,y),y,z,u)};b.formatMetricRelativeLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveMetricLengthUnit(A,v);return w(p,m.convertUnit(A,v,y),y,z,u)};b.formatMetricRelativeVerticalLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveMetricVerticalLengthUnit(A,v);return w(p,m.convertUnit(A,v,y),y,z,u)};b.formatMetricVerticalLength=function(p,A,v,z=2,u="abbr"){const y=m.adaptiveMetricVerticalLengthUnit(A,v);return t(p,
m.convertUnit(A,v,y),y,z,u)};b.formatRelativeAngleDegrees=function(p,A,v,z,u=2){v!==z&&(p=-p);v={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:u,minimumFractionDigits:u,signDisplay:"exceptZero"};p=m.convertUnit(p,A,"degrees")%360;p=f(p,v);return H.formatNumber(p,v)};b.formatRelativeDecimal=w;b.unitName=O;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(b){b.ByteSizeUnit=void 0;var k=b.ByteSizeUnit||
(b.ByteSizeUnit={});k[k.KILOBYTES=1024]="KILOBYTES";k[k.MEGABYTES=1048576]="MEGABYTES";k[k.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(b,k){function e(q,p){return{type:k.unitType(p),value:q,unit:p}}function B(q,p){return{type:k.unitType(p),value:q,unit:p}}function x(q,p){return{type:k.unitType(p),value:q,unit:p}}function F(q,p,A="arithmetic"){return{type:k.unitType(p),
value:q,unit:p,rotationType:A}}function m(q,p){const A=H(q,p);return"angle"===q.type?F(A,p,q.rotationType):e(A,p)}function H(q,p){return k.convertUnit(q.value,q.unit,p)}const O=B(0,"meters"),t=x(0,"square-meters"),w=F(0,"radians"),f=F(0,"degrees"),r=F(0,"degrees","geographic");b.convertRotationType=function(q,p,A){if(p===A)return q;switch(A){case "arithmetic":case "geographic":return-q+90}};b.createAngle=F;b.createArea=x;b.createLength=B;b.createQuantity=e;b.createScalar=function(q){return{value:q}};
b.isBaseUnit=function(q){return k.isBaseUnit(q.unit)};b.max=function(q,p){return null==q?p:null==p?q:q.value>k.convertUnit(p.value,p.unit,q.unit)?q:p};b.min=function(q,p){return null==q?p:null==p?q:q.value<k.convertUnit(p.value,p.unit,q.unit)?q:p};b.scale=function(q,p){return null==q?null:{...q,value:q.value*p}};b.toBaseUnit=function(q){return m(q,k.baseUnitForUnit(q.unit))};b.toUnit=m;b.valueInUnit=H;b.zeroDegrees=f;b.zeroDegreesGeographic=r;b.zeroMeters=O;b.zeroRadians=w;b.zeroSquareMeters=t;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q){const p={editing:!1,operations:{add:!0,update:!0,delete:!0}},A=B.ofType(f);e=class extends e{constructor(v){super(v);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...p};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new A;this.fileInfos=new B;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(F.watch(()=>this.graphic,()=>this._graphicChanged(),F.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(v){return{...p,...v}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:v}=this;if(!v)return!1;v=v.layer||v.sourceLayer;return v?.loaded&&"capabilities"in v&&v.capabilities&&"operations"in v.capabilities&&"supportsResizeAttachments"in v.capabilities.operations&&v.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:v,attachmentInfos:z}=this;if(!v||
"function"!==typeof v.queryAttachments)throw new x("invalid-layer","getAttachments(): A valid layer is required.");const u=this._getObjectId();if("number"!==typeof u)throw new x("invalid-object-id","getAttachments(): Numeric object id is required");var y=new r({objectIds:[u],returnMetadata:!0});const L=[];this._getAttachmentsPromise=y=v.queryAttachments(y).then(l=>l[u]||L).catch(()=>L);this.notifyChange("state");y=await y;z.destroyAll();y.length&&z.addMany(y);this._getAttachmentsPromise=null;this.notifyChange("state");
return y}async addAttachment(v,z=this.graphic){const {_attachmentLayer:u,attachmentInfos:y,capabilities:L}=this;if(!z)throw new x("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:z});if(!v)throw new x("invalid-attachment","addAttachment(): An attachment is required.",{attachment:v});if(!L.operations?.add)throw new x("invalid-capabilities","addAttachment(): add capabilities are required.");if(!u||"function"!==typeof u.addAttachment)throw new x("invalid-layer","addAttachment(): A valid layer is required.");
v=await u.addAttachment(z,v).then(l=>this._queryAttachment(l.objectId,z));y.add(v);return v}async deleteAttachment(v){const {_attachmentLayer:z,attachmentInfos:u,graphic:y,capabilities:L}=this;if(!v)throw new x("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:v});if(!L.operations?.delete)throw new x("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!z||"function"!==typeof z.deleteAttachments)throw new x("invalid-layer",
"deleteAttachment(): A valid layer is required.");if(!y)throw new x("invalid-graphic","deleteAttachment(): A graphic is required.");const l=await z.deleteAttachments(y,[v.id]).then(()=>v);u.remove(l);l.destroy();return l}async updateAttachment(v,z=this.activeAttachmentInfo){const {_attachmentLayer:u,attachmentInfos:y,graphic:L,capabilities:l}=this;if(!v)throw new x("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:v});if(!z)throw new x("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",
{attachmentInfo:z});if(!l.operations?.update)throw new x("invalid-capabilities","updateAttachment(): Update capabilities are required.");const c=y.indexOf(z);if(!u||"function"!==typeof u.updateAttachment)throw new x("invalid-layer","updateAttachment(): A valid layer is required.");if(!L)throw new x("invalid-graphic","updateAttachment(): A graphic is required.");v=await u.updateAttachment(L,z.id,v).then(a=>this._queryAttachment(a.objectId));y.splice(c,1,v);return v}async commitFiles(){await Promise.all(this.fileInfos.items.map(v=>
this.addAttachment(v.form)));this.fileInfos.removeAll();return this.getAttachments()}addFile(v,z){if(!v||!z)return null;v={file:v,form:z};this.fileInfos.add(v);return v}updateFile(v,z,u=this.activeFileInfo){if(!v||!z||!u)return null;u=this.fileInfos.indexOf(u);-1<u&&this.fileInfos.splice(u,1,{file:v,form:z});return this.fileInfos.items[u]}deleteFile(v){const z=this.fileInfos.find(u=>u.file===v);return z?(this.fileInfos.remove(z),z):null}async _queryAttachment(v,z){const {_attachmentLayer:u}=this;
if(!v||!u?.queryAttachments)throw new x("invalid-attachment-id","Could not query attachment.");const y=this._getObjectId(z);if("number"!==typeof y)throw new x("invalid-object-id","getAttachments(): Numeric object id is required");v=new r({objectIds:[y],attachmentsWhere:`AttachmentId=${v}`,returnMetadata:!0});return u.queryAttachments(v).then(L=>L[y][0])}_getObjectId(v=this.graphic){return v?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>
this.attachmentInfos.destroyAll()))}_setAttachmentLayer(){var {graphic:v}=this;this._attachmentLayer=(v=q.getSourceLayer(v))?"scene"===v.type&&null!=v.associatedLayer?v.associatedLayer:v:null}};b.__decorate([m.property()],e.prototype,"capabilities",void 0);b.__decorate([H.cast("capabilities")],e.prototype,"castCapabilities",null);b.__decorate([m.property()],e.prototype,"activeAttachmentInfo",void 0);b.__decorate([m.property()],e.prototype,"activeFileInfo",void 0);b.__decorate([m.property({readOnly:!0,
type:A})],e.prototype,"attachmentInfos",void 0);b.__decorate([m.property()],e.prototype,"fileInfos",void 0);b.__decorate([m.property({type:k})],e.prototype,"graphic",void 0);b.__decorate([m.property()],e.prototype,"mode",void 0);b.__decorate([m.property({readOnly:!0})],e.prototype,"state",null);b.__decorate([m.property()],e.prototype,"filesEnabled",void 0);b.__decorate([m.property({readOnly:!0})],e.prototype,"supportsResizeAttachments",null);return e=b.__decorate([w.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
e)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(b,k,e,B,x,F,m,H){var O;const t={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,
mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};k=O=class extends k.JSONSupport{constructor(w){super(w);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:w}=this;w=H.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:w});return t[w]||null}clone(){return new O({contentType:this.contentType,
exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};b.__decorate([e.property({type:String})],k.prototype,"contentType",void 0);b.__decorate([e.property()],k.prototype,"exifInfo",void 0);b.__decorate([e.property({readOnly:!0})],k.prototype,"orientationInfo",null);b.__decorate([e.property({type:B.Integer})],k.prototype,"id",void 0);b.__decorate([e.property({type:String})],
k.prototype,"globalId",void 0);b.__decorate([e.property({type:String})],k.prototype,"keywords",void 0);b.__decorate([e.property({type:String})],k.prototype,"name",void 0);b.__decorate([e.property({json:{read:!1}})],k.prototype,"parentGlobalId",void 0);b.__decorate([e.property({json:{read:!1}})],k.prototype,"parentObjectId",void 0);b.__decorate([e.property({type:B.Integer})],k.prototype,"size",void 0);b.__decorate([e.property({json:{read:!1}})],k.prototype,"url",void 0);return k=O=b.__decorate([m.subclass("esri.rest.query.support.AttachmentInfo")],
k)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function k(e){const {tagName:B,tags:x}=e;return x&&B?x.find(F=>F.name===B)?.value||null:null}b.getExifValue=function(e){const {exifInfo:B,exifName:x,tagName:F}=e;return B&&x&&F?(e=B.find(m=>m.name===x))?k({tagName:F,tags:e.tags}):null:null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/has ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w){function f(M){return M?X.test(M):!1}function r(M,S){if(S&&f(S)&&M){var U=S.replace(X,"").toLowerCase();return M.find(({name:Y})=>Y.toLowerCase()===U)}}function q(M,S){return(S=p(S,M))?S.name:M}function p(M,S){return M&&"function"===typeof M.getField&&S?M.getField(S)??null:null}function A({formattedAttributes:M,template:S,fieldInfoMap:U}){return`${B.replace(B.replace(S,Y=>`{${U.get(Y.toLowerCase())?.fieldName||Y}}`),M).replaceAll(R,"")}`.trim()}function v(M,S,U=!1){const Y=
S[M];"string"===typeof Y&&(U=(U?encodeURIComponent(Y):Y).replaceAll(T,"%27"),S[M]=U)}function z(M,S=!1){const U={...M};Object.keys(U).forEach(Y=>v(Y,U,S));return U}function u(M,S){return M.replaceAll(V,(U,Y,ca)=>(U=p(S,ca))?`{${U.name}}`:Y)}function y(M,S,U){return(M=u(M,U))?M.replaceAll(W,(Y,ca,aa)=>{ca=`${ca||aa}`.trim();return B.replace(Y,z(S,ca&&"{"!==ca[0]||!1))}):M}function L(M){return null!=M&&"object"===typeof M&&"fieldsIndex"in M&&"geometryType"in M&&"getField"in M&&"load"in M&&"loaded"in
M&&"objectIdField"in M&&"spatialReference"in M&&"type"in M&&("feature"===M.type||"scene"===M.type||"subtype-sublayer"===M.type||"sublayer"===M.type)&&"when"in M}function l(M){return null!=M&&"object"===typeof M&&"createQuery"in M&&"queryFeatureCount"in M&&"queryObjectIds"in M&&"queryRelatedFeatures"in M&&"queryRelatedFeaturesCount"in M&&"relationships"in M}function c(M){return M&&"object"===typeof M&&"createQuery"in M&&"queryFeatureCount"in M&&"type"in M?"subtype-sublayer"===M.type&&"parent"in M&&
M.parent&&"object"===typeof M.parent?"globalIdField"in M.parent:"globalIdField"in M:!1}function a(M){return L(M)&&l(M)}function d(M,S){const {fieldInfos:U,fieldName:Y,preventPlacesFormatting:ca,layer:aa,timeZone:ja}=S;S=D(U,Y);var ia=p(aa,Y);if(S&&!m.isRasterPixelValueField(Y)){ia=ia?.type;const ka=S.format?.dateFormat;if("date"===ia||"date-only"===ia||"time-only"===ia||"timestamp-offset"===ia||ka)return O.formatAnyDate(M,{format:ka,fieldType:ia,timeZoneOptions:{layerTimeZone:aa&&"preferredTimeZone"in
aa?aa.preferredTimeZone:null,viewTimeZone:ja,datesInUnknownTimezone:aa&&"datesInUnknownTimezone"in aa?!!aa.datesInUnknownTimezone:!1}})}S=S?.format;if("string"===typeof M&&m.isRasterPixelValueField(Y)&&S)return M=M.trim(),/\d{2}-\d{2}/.test(M)?M:M.includes(",")?n(M,",",", ",S):M.includes(";")?n(M,";","; ",S):M.includes(" ")?n(M," "," ",S):F.formatNumber(Number(M),F.convertNumberFormatToIntlOptions(S));"string"!==typeof M||!S||null!=S.dateFormat||null==S.places&&null==S.digitSeparator||(ia=Number(M),
isNaN(ia)||(M=ia));return"string"===typeof M||null==M||null==S?N(M):ca?F.formatNumber(M,{...F.convertNumberFormatToIntlOptions(S),minimumFractionDigits:0,maximumFractionDigits:20}):F.formatNumber(M,F.convertNumberFormatToIntlOptions(S))}function n(M,S,U,Y){return M.trim().split(S).map(ca=>F.formatNumber(Number(ca),F.convertNumberFormatToIntlOptions(Y))).join(U)}function D(M,S){if(M?.length&&S)return M.find(U=>U.fieldName?.toLowerCase()===S.toLowerCase())}function J({fieldName:M,graphic:S,layer:U}){if(C(M)||
!U||"function"!==typeof U.getFeatureType)return null;const {typeIdField:Y}=U;return Y&&M===Y?(M=U.getFeatureType(S))?M.name:null:null}function K({fieldName:M,value:S,graphic:U,layer:Y}){return C(M)||!Y||"function"!==typeof Y.getFieldDomain?null:(M=U&&Y.getFieldDomain(M,{feature:U,excludeImpliedDomains:k("esri-widget-legacy-field-domain-calculation")}))&&"coded-value"===M.type?M.getName(S):null}function N(M){return"string"===typeof M?M.replaceAll(Z,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):M}function G(M){const {value:S,
fieldName:U,fieldInfos:Y,fieldInfoMap:ca,layer:aa,graphic:ja,timeZone:ia}=M;return null==S?"":(M=K({fieldName:U,value:S,graphic:ja,layer:aa}))||(M=J({fieldName:U,graphic:ja,layer:aa}))?M:ca.get(U.toLowerCase())?d(S,{fieldInfos:Y||Array.from(ca.values()),fieldName:U,layer:aa,timeZone:ia}):(M=aa?.fieldsIndex?.get(U))&&(O.isAnyDateField(M)||m.isTimeOnlyField(M))?O.formatAnyDate(S,{fieldType:M.type,timeZoneOptions:{layerTimeZone:aa&&"preferredTimeZone"in aa?aa.preferredTimeZone:null,viewTimeZone:ia,datesInUnknownTimezone:aa&&
"datesInUnknownTimezone"in aa?!!aa.datesInUnknownTimezone:!1}}):N(S)}async function Q(M,S){const {layer:U,graphic:Y,outFields:ca,objectIds:aa,returnGeometry:ja,spatialReference:ia}=M;M=aa[0];if("number"!==typeof M&&"string"!==typeof M)return S={layer:U,graphic:Y,objectId:M,requiredFields:ca},e.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",S),null;if(!H.getEffectiveLayerCapabilities(U)?.operations?.supportsQuery)return S=
{layer:U,graphic:Y,requiredFields:ca,returnGeometry:ja},e.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",S),null;M=U.createQuery();M.objectIds=aa;M.outFields=ca?.length?ca:[U.objectIdField];M.returnGeometry=!!ja;M.returnZ=!!ja;M.returnM=!!ja;M.outSpatialReference=ia;return(await U.queryFeatures(M,S)).features[0]}async function h(M){if(!M.expressionInfos?.length)return!1;var S=await t.loadArcade();({arcadeUtils:{hasGeometryFunctions:S}}=
S);return S(M)}function C(M=""){return M?M.includes("relationships/"):!1}function I({attributes:M,graphic:S,relatedInfo:U,fieldInfos:Y,fieldInfoMap:ca,layer:aa,timeZone:ja}){M&&S&&U&&Object.keys(S.attributes).forEach(ia=>{var ka=(ka={layerId:U.relation.id.toString(),fieldName:ia},`${"relationships/"}${ka.layerId}/${ka.fieldName}`);M[ka]=G({fieldName:ka,fieldInfos:Y,fieldInfoMap:ca,layer:aa,value:S.attributes[ia],graphic:S,timeZone:ja})})}function g({attributes:M,relatedInfo:S,fieldInfoMap:U,fieldInfos:Y,
layer:ca,timeZone:aa}){M&&S&&(S.relatedFeatures?.forEach(ja=>I({attributes:M,graphic:ja,relatedInfo:S,fieldInfoMap:U,fieldInfos:Y,layer:ca,timeZone:aa})),S.relatedStatsFeatures?.forEach(ja=>I({attributes:M,graphic:ja,relatedInfo:S,fieldInfoMap:U,fieldInfos:Y,layer:ca,timeZone:aa})))}function E(M,S){return M?.allTables.find(U=>"feature"===U.type&&U.layerId===S.id&&U.url===S.layer?.url)}function P({map:M,relationship:S,relationship:{relatedTableId:U},relatedLayer:Y,layers:ca}){if(!ca)return null;for(const aa of ca)if("map-image"===
aa.type){if(ca=P({layers:aa.sublayers,map:M,relatedLayer:Y,relationship:S})||P({layers:aa.subtables,map:M,relatedLayer:Y,relationship:S}))return ca}else if(a(aa))if("sublayer"===Y.type){if(aa!==Y&&aa.id===U)return aa.isTable?E(M,aa):aa}else{ca="scene"===Y.type&&Y.associatedLayer?Y.associatedLayer.url:Y.url;if(!ca)break;if("sublayer"===aa.type){if(aa!==Y&&aa.layer?.url===ca&&aa.id===U)return aa.isTable?E(M,aa):aa}else if(aa!==Y&&aa.url===ca&&aa.layerId===U)return aa}return null}const R=/href=(""|'')/gi,
V=/(\{([^{\r\n]+)\})/g,T=/'/g,X=/^\s*expression\//i,Z=/(\n)/gi,ba=/[\u00A0-\u9999<>&]/gim,W=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ea=/^(?:mailto:|tel:)/,fa=x.convertDateFormatToIntlOptions("short-date-short-time"),da=M=>{if(!M)return!1;M=M.toUpperCase();return M.includes("CURRENT_TIMESTAMP")||M.includes("CURRENT_DATE")||M.includes("CURRENT_TIME")},ha=({layer:M,method:S,query:U,definitionExpression:Y})=>{M.capabilities?.query?.supportsCacheHint&&"attachments"!==S&&(M=null!=U.where?U.where:null,S=
null!=U.geometry?U.geometry:null,da(Y)||da(M)||"extent"===S?.type||"tile"===U.resultType||(U.cacheHint=!0))};b.applyTextFormattingHTML=N;b.createFieldInfoMap=function(M,S){const U=new Map;if(!M)return U;for(const Y of M)Y.fieldName&&(M=q(Y.fieldName,S),Y.fieldName=M,U.set(M.toLowerCase(),Y));return U};b.findRelatedLayer=function(M,S,U){return M&&S&&U?"sublayer"===S.type?P({layers:S.layer?.sublayers,map:M,relatedLayer:S,relationship:U})||P({layers:S.layer?.subtables,map:M,relatedLayer:S,relationship:U}):
P({layers:M.allLayers,map:M,relatedLayer:S,relationship:U})||P({layers:M.allTables,map:M,relatedLayer:S,relationship:U}):null};b.findUtilityNetwork=function(M,S){return M&&"utilityNetworks"in M&&S?M.utilityNetworks?.find(U=>U.isUtilityLayer(S)):null};b.fixTokens=u;b.formatAttributes=function({fieldInfos:M,attributes:S,layer:U,graphic:Y,fieldInfoMap:ca,relatedInfos:aa,timeZone:ja}){const ia={};aa?.forEach(ka=>g({attributes:ia,relatedInfo:ka,fieldInfoMap:ca,fieldInfos:M,layer:U,timeZone:ja}));S&&Object.keys(S).forEach(ka=>
{ia[ka]=G({fieldName:ka,fieldInfos:M,fieldInfoMap:ca,layer:U,value:S[ka],graphic:Y,timeZone:ja})});return ia};b.formatEditInfo=function(M,S,U,Y){const {creatorField:ca,creationDateField:aa,editorField:ja,editDateField:ia}=M;if(S){M=w.getTimeZoneFormattingOptions(Y&&"preferredTimeZone"in Y?Y.preferredTimeZone:null,Y&&"datesInUnknownTimezone"in Y?!!Y.datesInUnknownTimezone:!1,U,fa,"date");M={...fa,...M};U=S[ia];if("number"===typeof U)return S=S[ja],{type:"edit",date:x.formatDate(U,M),user:S};U=S[aa];
return"number"===typeof U?(S=S[ca],{type:"create",date:x.formatDate(U,M),user:S}):null}};b.formatValueToFieldInfo=d;b.getAllFieldInfos=function(M){const S=[];if(!M)return S;const {fieldInfos:U,content:Y}=M;U&&S.push(...U);if(!Y||!Array.isArray(Y))return S;Y.forEach(ca=>{"fields"===ca.type&&(ca=ca?.fieldInfos)&&S.push(...ca)});return S};b.getFieldInfo=D;b.getFieldInfoLabel=function(M,S){return(S=r(S,M?.fieldName))?S.title||null:M?M.label||M.fieldName:null};b.getFixedFieldName=q;b.getFixedFieldNames=
function(M,S){return M&&M.map(U=>q(U,S))};b.getHighlightKeyForFeature=function(M){const S=M.getObjectId();return null!=S?`oid:${S}`:`uid:${M.uid}`};b.getSourceLayer=function(M){if(null!=M)return(M.sourceLayer||M.layer)??void 0};b.graphicCallback=async function({type:M,value:S,event:U}){try{return"function"===typeof S?S(U):await S}catch(Y){e.getLogger("esri.widgets.Feature.support.featureUtils").error("error",`An error occurred when calling the "${M}" function`,{error:Y,graphic:U.graphic,value:S})}};
b.htmlEntities=function(M){return M.replaceAll(ba,S=>`&#${S.charCodeAt(0)};`)};b.isAssociatedFeatureSupportedLayer=function(M){return L(M)&&c(M)};b.isAssociatedLayer=c;b.isExpressionField=f;b.isFeatureSupportedLayer=L;b.isGraphicForRelatableFeatureSupportedLayer=function(M){return!!M&&"object"===typeof M&&"sourceLayer"in M&&a(M.sourceLayer)};b.isRelatableFeatureSupportedLayer=a;b.isRelatableLayer=l;b.isRelatedField=C;b.preLayerQueryCallback=({query:M,layer:S,method:U})=>{ha({layer:S,method:U,query:M,
definitionExpression:`${S.definitionExpression} ${S.serviceDefinitionExpression??""}`})};b.preRequestCallback=({queryPayload:M,layer:S,method:U})=>{ha({layer:S,method:U,query:M,definitionExpression:`${S.definitionExpression} ${S.serviceDefinitionExpression??""}`})};b.querySourceLayer=Q;b.queryUpdatedFeature=async function({graphic:M,popupTemplate:S,layer:U,spatialReference:Y},ca){if(U&&S&&("function"===typeof U.load&&await U.load(ca),M.attributes)){var aa=U.objectIdField,ja=M.attributes[aa];if(null!=
ja){ja=[ja];var ia=await S.getRequiredFields(U.fieldsIndex),ka=m.featureHasFields(ia,M);aa=ka?[]:ia.includes(aa)?ia:[...ia,aa];S=S.returnGeometry||await h(S);if(!ka||S)if(U=await Q({layer:U,graphic:M,outFields:aa,objectIds:ja,returnGeometry:S,spatialReference:Y},ca))U.geometry&&(M.geometry=U.geometry),U.attributes&&(M.attributes={...M.attributes,...U.attributes})}}};b.shouldOpenInNewTab=function(M=""){if(M)return!ea.test(M.trim().toLowerCase())};b.substituteAttributes=A;b.substituteFieldsInLinksAndAttributes=
function({attributes:M,globalAttributes:S,layer:U,text:Y,expressionAttributes:ca,fieldInfoMap:aa}){return Y?A({formattedAttributes:S,template:y(Y,{...S,...ca,...M},U),fieldInfoMap:aa}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(b,k,e,B,x,F){function m(q){return String(q).padStart(2,
"0")}function H(q,p,A){if("date"===p||"number"===p){"number"===p&&(q=new Date(q));p=A?q.getFullYear():q.getUTCFullYear();const v=m((A?q.getMonth():q.getUTCMonth())+1),z=m(A?q.getDate():q.getUTCDate()),u=m(A?q.getHours():q.getUTCHours()),y=m(A?q.getMinutes():q.getUTCMinutes());q=m(A?q.getSeconds():q.getUTCSeconds());q=`TIMESTAMP'${p}-${v}-${z} ${u}:${y}:${q}'`}return q}function O(q,p){if(p instanceof Date)return"date";if("number"===typeof p)return"number";if("string"===typeof p&&(q=q.getField(p),"\x3cnow\x3e"!==
p.toLowerCase()&&e.isDateField(q)))return"field"}const t={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},f=new Set(["integer","small-integer"]);let r=null;b.castIntegerFieldToFloat=function(q){return`cast(${q} as float)`};b.dateTypes=
["date","date-only","timestamp-offset"];b.defaultBasemapGroups=t;b.defaultStatisticTypes={exclude:["median"]};b.fieldDelimiter=",";b.formatAnyDate=function(q,p){const {format:A,timeZoneOptions:v,fieldType:z}=p??{};let u;v&&({timeZone:y,timeZoneName:u}=F.getTimeZoneFormattingOptions(v.layerTimeZone,v.datesInUnknownTimezone,v.viewTimeZone,k.convertDateFormatToIntlOptions(A||"short-date-short-time"),z));if("string"===typeof q&&isNaN(Date.parse("time-only"===z?`1970-01-01T${q}Z`:q)))return q;switch(z){case "date-only":var y=
k.convertDateFormatToIntlOptions(A||"short-date");return"string"===typeof q?k.formatDateOnly(q,{...y}):k.formatDate(q,{...y,timeZone:F.utc});case "time-only":return y=k.convertDateFormatToIntlOptions(A||"short-time"),"string"===typeof q?k.formatTimeOnly(q,y):k.formatDate(q,{...y,timeZone:F.utc});case "timestamp-offset":if(!y&&"string"===typeof q&&(new Date(q)).toISOString()!==q)return q;y=(p=A||v?k.convertDateFormatToIntlOptions(A||"short-date-short-time"):void 0)?{...p,timeZone:y,timeZoneName:u}:
void 0;return"string"===typeof q?k.formatTimestamp(q,y):k.formatDate(q,y);default:return p=A||v?k.convertDateFormatToIntlOptions(A||"short-date-short-time"):void 0,k.formatDate("string"===typeof q?new Date(q):q,p?{...p,timeZone:y,timeZoneName:u}:void 0)}};b.getBasemapGroup=function(q,p=t){for(const A in p)if(p[A].includes(q))return A};b.getBasemapId=function(q,p,A=!0){let v=null;q&&("string"===typeof q?p.includes(q)&&(v=q):v=x.getWellKnownBasemapId(q));return A?v||"gray":v};b.getDateDiffSQL=function(q,
p,A,v){const {hasQueryEngine:z}=q;A=H(A,O(q,A),z);q=H(p,O(q,p),z);q=`(${A} - ${q})`;v=w[v];p="/";1>v&&(v=1/v,p="*");return{sqlExpression:1===v?q:`(${q} ${p} ${v})`,sqlWhere:null}};b.getDateType=O;b.getFieldsList=async function(q){const {field:p,field2:A,field3:v,normalizationField:z,valueExpression:u}=q;q=[];u&&(r||({arcadeUtils:q}=await B.loadArcade(),r=q),q=r.extractFieldNames(u));p&&q.push(p);A&&q.push(A);v&&q.push(v);z&&q.push(z);return q};b.getNormalizationType=function(q){let p=q.normalizationType;
p||(q.normalizationField?p="field":null!=q.normalizationTotal&&(p="percent-of-total"));return p??void 0};b.isAnyDateField=function(q){return e.isDateField(q)||e.isDateOnlyField(q)||e.isTimestampOffsetField(q)};b.isIntegerField=function(q,p){q=p&&q.getField(p);return!!q&&f.has(q.type)};b.unitValueInDays=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,k){b.getCalciteIconForAttachment=
function(e){return e?"text/plain"===e?"file-text":"application/pdf"===e?"file-pdf":"text/csv"===e?"file-csv":"application/gpx+xml"===e?"file-gpx":"application/x-dwf"===e?"file-cad":"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?"file-code":"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===
e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?"file-zip":e.includes("image/")?"file-image":e.includes("audio/")?"file-sound":e.includes("video/")?"file-video":e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?"file-excel":e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?"file-word":e.includes("powerpoint")||e.includes("presentationml")?"file-ppt":"file":"file"};b.getIconPath=function(e){const B=
k.getAssetUrl("esri/themes/base/images/files/");return e?"text/plain"===e?`${B}text-32.svg`:"application/pdf"===e?`${B}pdf-32.svg`:"text/csv"===e?`${B}csv-32.svg`:"application/gpx+xml"===e?`${B}gpx-32.svg`:"application/x-dwf"===e?`${B}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${B}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===
e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${B}zip-32.svg`:e.includes("image/")?`${B}image-32.svg`:e.includes("audio/")?`${B}sound-32.svg`:e.includes("video/")?`${B}video-32.svg`:e.includes("msexcel")||e.includes("ms-excel")||e.includes("spreadsheetml")?`${B}excel-32.svg`:e.includes("msword")||e.includes("ms-word")||e.includes("wordprocessingml")?`${B}word-32.svg`:e.includes("powerpoint")||
e.includes("presentationml")?`${B}report-32.svg`:`${B}generic-32.svg`:`${B}generic-32.svg`};b.isSupportedImage=function(e){e=e.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(b){b.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",
loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",
widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/legacyIcon":function(){define(["exports"],function(b){b.legacyIcon={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",
expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",
swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(b,k,e,B,x,F,m){e=class extends m{constructor(H){super(H);this.title=this.description=null}};b.__decorate([k.property()],e.prototype,"description",void 0);b.__decorate([k.property()],e.prototype,"title",void 0);return e=b.__decorate([F.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],e)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t){e=class extends m{constructor(w,f){super(w,f);this.description=null;this.headingLevel=2;this.title=null}render(){return t.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:w}=this;return w?t.tsx(H.Heading,{class:"esri-feature-element-info__title",innerHTML:w,level:this.headingLevel}):null}_renderDescription(){const {description:w}=this;return w?t.tsx("div",{class:"esri-feature-element-info__description",
innerHTML:w,key:"description"}):null}};b.__decorate([k.property()],e.prototype,"description",void 0);b.__decorate([k.property()],e.prototype,"headingLevel",void 0);b.__decorate([k.property()],e.prototype,"title",void 0);return e=b.__decorate([F.subclass("esri.widgets.Feature.support.FeatureElementInfo")],e)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(b,k,e,B,x){b.Heading=function({level:F,class:m,...H},
O){F=k.clamp(Math.ceil(F),1,6);return x.tsx(`h${F}`,{...H,"aria-level":String(F),class:B.classes(e.globalCss.heading,m),role:"heading"},O)};b.incrementHeadingLevel=function(F,m=1){return k.clamp(Math.ceil(F+m),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w){e=class extends m{constructor(f,r){super(f,r);this.viewModel=null;this._addTargetToAnchors=q=>{Array.from(q.querySelectorAll("a")).forEach(p=>{O.shouldOpenInNewTab(p.href)&&!p.hasAttribute("target")&&p.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(f){this.viewModel&&(this.viewModel.creator=f)}get graphic(){return this.viewModel?.graphic}set graphic(f){this.viewModel&&(this.viewModel.graphic=f)}render(){return w.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return w.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},w.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const f=this.viewModel?.created;return f?f instanceof HTMLElement?w.tsx("div",{afterCreate:this._attachToNode,bind:f,key:f}):t.isWidget(f)?w.tsx("div",{key:f},!f.destroyed&&f.render()):w.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:f,key:f}):null}_attachToNode(f){f.appendChild(this)}};b.__decorate([k.property()],e.prototype,"creator",null);b.__decorate([k.property()],e.prototype,"graphic",null);b.__decorate([k.property({type:H})],e.prototype,"viewModel",void 0);return e=b.__decorate([F.subclass("esri.widgets.Feature.FeatureContent")],e)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t){e=class extends e{constructor(w){super(w);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(B.watch(()=>this.creator,f=>{this._destroyContent();this._createContent(f)},B.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:w,graphic:f,destroyer:r}=this;w&&f&&(t.graphicCallback({type:"content",value:r,event:{graphic:f}}),this._set("created",null))}async _createContent(w){var f=
this.graphic;f&&w&&(this._loadingPromise=w=t.graphicCallback({type:"content",value:w,event:{graphic:f}}),this.notifyChange("state"),f=await w,w===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",f)))}};b.__decorate([x.property({readOnly:!0})],e.prototype,"created",void 0);b.__decorate([x.property()],e.prototype,"creator",void 0);b.__decorate([x.property()],e.prototype,"destroyer",void 0);b.__decorate([x.property({type:k})],e.prototype,"graphic",void 0);
b.__decorate([x.property({readOnly:!0})],e.prototype,"state",null);return e=b.__decorate([O.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],e)})},"esri/widgets/Feature/FeatureExpression":function(){define("require ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../../chunks/componentsUtils ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A){x=class extends O{constructor(v,z){super(v,z);this._contentWidget=null;this.viewModel=new r}initialize(){this.addHandles(e.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),e.initial))}loadDependencies(){return q.loadCalciteComponents({loader:()=>new Promise((v,z)=>b(["../../chunks/calcite-loader"],v,z))})}destroy(){this._destroyContentWidget()}render(){const {state:v}=this.viewModel;return A.tsx("div",{class:"esri-feature-expression"},
"loading"===v?this._renderLoading():"disabled"===v?null:this._contentWidget?.render())}_renderLoading(){return A.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},A.tsx("calcite-loader",{inline:!0,label:""}))}_destroyContentWidget(){const {_contentWidget:v}=this;v&&(v.viewModel=null,v.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:v,contentElement:z}=this.viewModel,u=z?.type;this._destroyContentWidget();this._contentWidget=v?"fields"===
u?new w({viewModel:v}):"media"===u?new f({viewModel:v}):"text"===u?new t({viewModel:v}):null:null;this.scheduleRender()}};k.__decorate([B.property({type:r})],x.prototype,"viewModel",void 0);return x=k.__decorate([H.subclass("esri.widgets.Feature.FeatureExpression")],x)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p){B=class extends H{constructor(A,v){super(A,v);this._featureElementInfo=null;this.viewModel=new O;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new t;this.addHandles(k.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),k.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(A){this.viewModel.attributes=A}get description(){return this.viewModel.description}set description(A){this.viewModel.description=
A}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(A){this.viewModel.expressionInfos=A}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(A){this.viewModel.fieldInfos=A}get title(){return this.viewModel.title}set title(A){this.viewModel.title=A}render(){return p.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(A,v){var {attributes:z}=this.viewModel;const u=A.fieldName||"",y=A.label||u;z=z?
null==z[u]?"":z[u]:"";A=!!A.format?.dateFormat;z="number"!==typeof z||A?f.autoLink(this.messagesURIUtils,z):this._forceLTR(z);A={["esri-feature-fields__field-data--date"]:A};return p.tsx("tr",{key:`fields-element-info-row-${u}-${v}`},p.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:y,key:`fields-element-info-row-header-${u}-${v}`}),p.tsx("td",{class:this.classes("esri-feature-fields__field-data",A),innerHTML:z,key:`fields-element-info-row-data-${u}-${v}`}))}_renderFields(){const {formattedFieldInfos:A}=
this.viewModel;return A?.length?p.tsx("table",{class:w.globalCss.table,summary:this.messages.fieldsSummary},p.tsx("tbody",null,A.map((v,z)=>this._renderFieldInfo(v,z)))):null}_setupFeatureElementInfo(){const {description:A,title:v}=this;this._featureElementInfo?.set({description:A,title:v})}_forceLTR(A){return`&lrm;${A}`}};b.__decorate([e.property()],B.prototype,"attributes",null);b.__decorate([e.property()],B.prototype,"description",null);b.__decorate([e.property()],B.prototype,"expressionInfos",
null);b.__decorate([e.property()],B.prototype,"fieldInfos",null);b.__decorate([e.property()],B.prototype,"title",null);b.__decorate([e.property({type:O,nonNullable:!0})],B.prototype,"viewModel",void 0);b.__decorate([e.property(),q.messageBundle("esri/widgets/Feature/t9n/Feature")],B.prototype,"messages",void 0);b.__decorate([e.property(),q.messageBundle("esri/widgets/support/t9n/uriUtils")],B.prototype,"messagesURIUtils",void 0);return B=b.__decorate([m.subclass("esri.widgets.Feature.FeatureFields")],
B)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(b,k,e,B,x,F,m,H,O,t){k=class extends k{constructor(w){super(w);this.title=this.fieldInfos=this.description=
this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:w,fieldInfos:f}=this,r=[];f?.forEach(q=>{if(!q.hasOwnProperty("visible")||q.visible)q=q.clone(),q.label=t.getFieldInfoLabel(q,w),r.push(q)});return r}};b.__decorate([e.property()],k.prototype,"attributes",void 0);b.__decorate([e.property({type:[H]})],k.prototype,"expressionInfos",void 0);b.__decorate([e.property()],k.prototype,"description",void 0);b.__decorate([e.property({type:[O]})],k.prototype,"fieldInfos",
void 0);b.__decorate([e.property({readOnly:!0})],k.prototype,"formattedFieldInfos",null);b.__decorate([e.property()],k.prototype,"title",void 0);return k=b.__decorate([m.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],k)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(b,k){const e=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];b.autoLink=function(B,x){if("string"!==typeof x||!x)return x;const F=e.find(H=>H.pattern.test(x));if(!F)return x;const m=x.match(F.pattern);B=k.replace(k.replace(F.label,{messages:B,hierPart:m?.[2]}),{appName:F.appName});return x.replace(F.pattern,`<a${F.target?` target="${F.target}"`:""} href="$1"${"_blank"===F.target?' rel\x3d"noreferrer"':""}>${B}</a>`)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L){e=class extends f{constructor(l,c){super(l,c);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new r;this.messages=null;this._disposeChart=a=>{this._chartRootMap.get(a)?.dispose();this._chartRootMap.delete(a)};this._createChart=async a=>{const {destroyed:d,viewModel:n}=this;if(!d&&n&&a){var {createRoot:D}=await new Promise((J,K)=>b(["../support/chartUtilsAm5"],J,K));D=await D(a);
this._chartRootMap.set(a,D);this._renderChart({mediaInfo:n.activeMediaInfo,root:D})}}}initialize(){this._featureElementInfo=new q;this.addHandles([x.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),x.initial),x.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),x.initial)])}loadDependencies(){return A.loadCalciteComponents({icon:()=>new Promise((l,c)=>b(["../../chunks/calcite-icon"],l,
c))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(l){this.viewModel.attributes=l}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(l){this.viewModel.activeMediaInfoIndex=l}get description(){return this.viewModel.description}set description(l){this.viewModel.description=l}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(l){this.viewModel.fieldInfoMap=
l}get layer(){return this.viewModel.layer}set layer(l){this.viewModel.layer=l}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(l){this.viewModel.mediaInfos=l}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(l){this.viewModel.popupTemplate=l}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(l){this.viewModel.relatedInfos=l}get title(){return this.viewModel.title}set title(l){this.viewModel.title=l}render(){return u.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:l,activeMediaInfoIndex:c}=this.viewModel,a=this._renderMediaText();return l?u.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),u.tsx("div",{class:"esri-feature-media__item-navigation"},a,1<l?u.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),u.tsx("span",
{class:"esri-feature-media__pagination-text"},L.substitute(this.messages.pageText,{index:c+1,total:l})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:l}=this.viewModel;if(!l)return null;const c=l&&l.title?u.tsx("div",{class:"esri-feature-media__item-title",innerHTML:l.title,key:"media-title"}):null;l=l&&l.caption?u.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:l.caption,key:"media-caption"}):null;return c||l?u.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},c,l):null}_renderImageMediaInfo(l){if(!l.value)return null;var {_refreshIntervalInfo:c}=this;const {activeMediaInfoIndex:a,formattedMediaInfoCount:d}=this.viewModel,{value:n,refreshInterval:D,altText:J,title:K,type:N}=l,{sourceURL:G,linkURL:Q}=n;l=p.shouldOpenInNewTab(Q??void 0)?"_blank":"_self";const h="_blank"===l?"noreferrer":"";c=D?c:null;c=u.tsx("img",{alt:J||K,key:`media-${N}-${a}-${d}-${c?c.timestamp:0}`,src:(c?c.sourceURL:G)??void 0});return(Q?u.tsx("a",{href:Q,rel:h,target:l,
title:K},c):null)??c}_renderChartMediaInfo(l){const {activeMediaInfoIndex:c,formattedMediaInfoCount:a}=this.viewModel;return u.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${l.type}-${c}-${a}`})}_renderMediaInfoType(){const {activeMediaInfo:l}=this.viewModel;return l?"image"===l.type?this._renderImageMediaInfo(l):l.type.includes("chart")?this._renderChartMediaInfo(l):null:null}_renderMediaInfo(){const {activeMediaInfo:l}=
this.viewModel;return l?u.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},u.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(l){if(2>this.viewModel.formattedMediaInfoCount)return null;const c=(l="previous"===l)?this.messages.previous:this.messages.next;return u.tsx("button",{"aria-label":c,bind:this,class:"esri-feature-media__pagination-button",key:l?"media-previous":"media-next",onclick:l?
this._previous:this._next,tabIndex:0,title:c,type:"button"},u.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:l?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:l,title:c}=this;this._featureElementInfo?.set({description:l,title:c})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:l,layer:c}=this.viewModel;return l&&c?.featureReduction&&"renderer"in c.featureReduction?
c.featureReduction.renderer:c?.renderer}}async _getSeriesColors(l){const {colorAm5:c}=await new Promise((d,n)=>b(["./FeatureMedia/chartCommon"],d,n)),a=new Map;l.forEach(d=>{d.color&&a.set(d,c(d.color.toCss(!0)))});return a}async _getRendererColors(){const {colorAm5:l}=await new Promise((n,D)=>b(["./FeatureMedia/chartCommon"],n,D)),c=new Map,a=this._getRenderer();if(!a)return c;const d=await w.getColorsFromRenderer(a);d.delete("default");if(!Array.from(d.values()).every(n=>1===n?.length))return c;
Array.from(d.keys()).forEach(n=>{const D=d.get(n)?.[0]?.toCss(!0);D&&c.set(n,l(D))});return c}_handleMediaKeyup(l){const {key:c}=l;"ArrowLeft"===c&&(l.stopPropagation(),this.viewModel.previous());"ArrowRight"===c&&(l.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!B.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(l){const {root:c,
mediaInfo:a}=l,{value:d,type:n}=a,{ResponsiveThemeAm5:D,DarkThemeAm5:J,AnimatedThemeAm5:K,ColorSetAm5:N,ThemeAm5:G,esriChartColorSet:Q}=await new Promise((P,R)=>b(["./FeatureMedia/chartCommon"],P,R));var h=G.new(c);h.rule("ColorSet").set("colors",Q);h.rule("ColorSet").set("reuse",!0);h=[D.new(c),h];y.isDarkTheme()&&h.push(J.new(c));this._canAnimateChart()&&h.push(K.new(c));c.setThemes(h);const C=await this._getRendererColors(),I=await this._getSeriesColors(d.series),g=N.new(c,{}),E=(h=I.get(d.series[0]))?
{lineSettings:{stroke:h}}:void 0;h=d.series.map((P,R)=>{R=I.get(P)||C.get(P.fieldName)||g.getIndex(R);return{category:P.tooltip,value:P.value,columnSettings:{fill:R,stroke:R},...E}}).filter(P=>"pie-chart"===n?null!=P.value&&0<P.value:!0);"pie-chart"===n?this._createPieChart(l,h):this._createXYChart(l,h)}_getDirection(){return v.isRTL(this.container)?"rtl":"ltr"}async _customizeChartTooltip(l,c="horizontal"){const {colorAm5:a}=await new Promise((d,n)=>b(["./FeatureMedia/chartCommon"],d,n));l.setAll({pointerOrientation:c});
l.get("background")?.setAll({stroke:a("rgba(50, 50, 50, 1)")});l.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(l,c){var {TooltipAm5:a}=await new Promise((N,G)=>b(["./FeatureMedia/chartCommon"],N,G));const {PieChartAm5:d,PieSeriesAm5:n}=await new Promise((N,G)=>b(["./FeatureMedia/pieChart"],N,G)),{mediaInfo:D,root:J}=l;var {title:K}=D;l=J.container.children.push(d.new(J,{ariaLabel:D?.altText||D?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,
paddingLeft:5,paddingRight:5}));a=a.new(J,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});K=l.series.push(n.new(J,{name:K,valueField:"value",categoryField:"category",tooltip:a}));K.ticks.template.set("forceHidden",!0);K.labels.template.set("forceHidden",!0);K.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(a);K.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",focusable:!0,templateField:"columnSettings"});
K.data.setAll(c);K.appear(this._getChartSeriesAnimationMS());l.appear(this._getChartAnimationMS());l.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(l){let c=0;l.forEach(a=>c=Math.min(a.value,c));return c}async _createColumnChart(l,c,a){const {TooltipAm5:d,ScrollbarAm5:n}=await new Promise((P,R)=>b(["./FeatureMedia/chartCommon"],P,R)),{CategoryAxisAm5:D,AxisRendererXAm5:J,ValueAxisAm5:K,AxisRendererYAm5:N,ColumnSeriesAm5:G}=await new Promise((P,R)=>b(["./FeatureMedia/xyChart"],
P,R)),{mediaInfo:Q,root:h}=c,{value:C,title:I}=Q;l.setAll({wheelX:"panX",wheelY:"zoomX"});c=l.xAxes.push(D.new(h,{renderer:J.new(h,{inversed:v.isRTL(this.container)}),categoryField:"category"}));c.get("renderer").labels.template.setAll({forceHidden:!0});var g=l.yAxes.push(K.new(h,{renderer:N.new(h,{inside:!1}),min:this._getMinSeriesValue(C.series)}));g.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=d.new(h,{labelText:"{categoryX}"});g=l.series.push(G.new(h,{name:I,
xAxis:c,yAxis:g,valueYField:"value",categoryXField:"category",tooltip:E}));this._customizeChartTooltip(E);g.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<C.series.length&&l.set("scrollbarX",n.new(h,{orientation:"horizontal"}));c.data.setAll(a);g.data.setAll(a);g.appear(this._getChartSeriesAnimationMS());l.appear(this._getChartAnimationMS())}async _createBarChart(l,c,a){const {TooltipAm5:d,ScrollbarAm5:n}=await new Promise((P,R)=>b(["./FeatureMedia/chartCommon"],
P,R)),{CategoryAxisAm5:D,AxisRendererXAm5:J,ValueAxisAm5:K,AxisRendererYAm5:N,ColumnSeriesAm5:G}=await new Promise((P,R)=>b(["./FeatureMedia/xyChart"],P,R)),{mediaInfo:Q,root:h}=c,{value:C,title:I}=Q;l.setAll({wheelX:"panY",wheelY:"zoomY"});c=l.yAxes.push(D.new(h,{renderer:N.new(h,{inversed:!0}),categoryField:"category"}));c.get("renderer").labels.template.setAll({forceHidden:!0});var g=l.xAxes.push(K.new(h,{renderer:J.new(h,{inside:!1,inversed:v.isRTL(this.container)}),min:this._getMinSeriesValue(C.series)}));
g.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=d.new(h,{labelText:"{categoryY}"});g=l.series.push(G.new(h,{name:I,xAxis:g,yAxis:c,valueXField:"value",categoryYField:"category",tooltip:E}));this._customizeChartTooltip(E,"vertical");g.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<C.series.length&&l.set("scrollbarY",n.new(h,{orientation:"vertical"}));c.data.setAll(a);g.data.setAll(a);g.appear(this._getChartSeriesAnimationMS());
l.appear(this._getChartAnimationMS())}async _createLineChart(l,c,a){const {TooltipAm5:d,ScrollbarAm5:n}=await new Promise((R,V)=>b(["./FeatureMedia/chartCommon"],R,V)),{CategoryAxisAm5:D,AxisRendererXAm5:J,ValueAxisAm5:K,AxisRendererYAm5:N,LineSeriesAm5:G}=await new Promise((R,V)=>b(["./FeatureMedia/xyChart"],R,V)),{root:Q,mediaInfo:h}=c,{value:C,title:I}=h;l.setAll({wheelX:"panX",wheelY:"zoomX"});c=l.xAxes.push(D.new(Q,{renderer:J.new(Q,{inversed:v.isRTL(this.container)}),categoryField:"category"}));
c.get("renderer").labels.template.setAll({forceHidden:!0});var g=l.yAxes.push(K.new(Q,{renderer:N.new(Q,{inside:!1}),min:this._getMinSeriesValue(C.series)}));g.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=a[0]?.lineSettings?.stroke,P=d.new(Q,{getFillFromSprite:!E,labelText:"{categoryX}"});E&&P.get("background")?.setAll({fill:E});g=l.series.push(G.new(Q,{name:I,xAxis:c,yAxis:g,valueYField:"value",categoryXField:"category",tooltip:P}));g.strokes.template.setAll({templateField:"lineSettings"});
this._customizeChartTooltip(P,"vertical");15<C.series.length&&l.set("scrollbarX",n.new(Q,{orientation:"horizontal"}));c.data.setAll(a);g.data.setAll(a);g.appear(this._getChartSeriesAnimationMS());l.appear(this._getChartAnimationMS())}async _createXYChart(l,c){const {XYChartAm5:a,XYCursorAm5:d}=await new Promise((N,G)=>b(["./FeatureMedia/xyChart"],N,G)),{root:n,mediaInfo:D}=l,{type:J}=D,K=n.container.children.push(a.new(n,{ariaLabel:D?.altText||D?.title||"",focusable:!0,panX:!0,panY:!0}));K.set("cursor",
d.new(n,{}));"column-chart"===J&&await this._createColumnChart(K,l,c);"bar-chart"===J&&await this._createBarChart(K,l,c);"line-chart"===J&&await this._createLineChart(K,l,c);K.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:l}=this;l&&(clearTimeout(l),this._refreshTimer=null)}_updateMediaInfoTimestamp(l){const c=Date.now();this._refreshIntervalInfo={timestamp:c,sourceURL:l&&this._getImageSource(l,c)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();
const {activeMediaInfo:l}=this.viewModel;"image"===l?.type&&0<l?.refreshInterval&&this._setRefreshTimeout(l)}_setRefreshTimeout(l){const {refreshInterval:c,value:a}=l;l=6E4*c;this._updateMediaInfoTimestamp(a.sourceURL);this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(a.sourceURL)},l)}_getImageSource(l,c){const a=l.includes("?")?"\x26":"?",[d,n=""]=l.split("#");return`${d}${a}timestamp=${c}${n?"#":""}${n}`}};k.__decorate([F.property()],e.prototype,"_refreshIntervalInfo",void 0);k.__decorate([F.property()],
e.prototype,"attributes",null);k.__decorate([F.property()],e.prototype,"activeMediaInfoIndex",null);k.__decorate([F.property()],e.prototype,"description",null);k.__decorate([F.property()],e.prototype,"fieldInfoMap",null);k.__decorate([F.property()],e.prototype,"layer",null);k.__decorate([F.property()],e.prototype,"mediaInfos",null);k.__decorate([F.property()],e.prototype,"popupTemplate",null);k.__decorate([F.property()],e.prototype,"relatedInfos",null);k.__decorate([F.property()],e.prototype,"title",
null);k.__decorate([F.property({type:r})],e.prototype,"viewModel",void 0);k.__decorate([F.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);return e=k.__decorate([t.subclass("esri.widgets.Feature.FeatureMedia")],e)})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f){async function r(y,L,l){B.getOrCreateMapValue(y,L,()=>[]).push(...l)}async function q(y,L,l){y=B.getOrCreateMapValue(y,L,()=>new Map);for(const c of l)y.set(c.value,c.color)}function p(y){let L=y.minValue,l=y.maxValue;const c=y.isFirstBreak?"":v.gt+" ";y="percent-of-total"===y.normalizationType?v.pct:"";L=null==L?"":m.format(L);l=null==l?"":m.format(l);return c+L+y+" "+v.ld+" "+l+y}function A(y,L){return"normalizationField"in y&&y.normalizationField?{type:"normalized-field",
field:y.field,normalizationField:y.normalizationField}:"field"in y&&y.field?{type:"field",field:y.field}:"valueExpression"in y&&y.valueExpression?{type:"expression",expression:y.valueExpression,title:y.valueExpressionTitle,returnType:L}:null}const v={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},z={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},u=x.convertDateFormatToIntlOptions("short-date");b.calculateDateFormatInterval=function(y){y=y.map(d=>new Date(d));
const L=y.length;let l=Infinity,c=null;for(let d=0;d<L-1;d++){const n=y[d];let D=Infinity,J=null;for(let K=d+1;K<L;K++){var a=y[K];a=n.getFullYear()!==a.getFullYear()&&"year"||n.getMonth()!==a.getMonth()&&"month"||n.getDate()!==a.getDate()&&"day"||n.getHours()!==a.getHours()&&"hour"||n.getMinutes()!==a.getMinutes()&&"minute"||n.getSeconds()!==a.getSeconds()&&"second"||"millisecond";const N=z[a];N<D&&(D=N,J=a)}D<l&&(l=D,c=J)}return c};b.createClassBreakLabel=p;b.createColorStops=function(y){const {values:L,
colors:l,labelIndexes:c,isDate:a}=y;return L.map((d,n)=>{var D=null;if(!c||c.includes(n)){const J=a?x.formatDate(d):m.format(d);J&&(D="",0===n?D=v.lt+" ":n===L.length-1&&(D=v.gt+" "),D+=J)}return new H({value:d,color:l[n],label:D})})};b.createUniqueValueLabel=function(y){const {value:L,domain:l,fieldInfo:c,dateFormatOptions:a}=y;y=String(L);const d=l&&"codedValues"in l&&l.codedValues?l.getName(L):null;d?y=d:null!=L&&c&&(O.isAnyDateField(c)||F.isTimeOnlyField(c))?y=O.formatAnyDate(L,a??{fieldType:c.type}):
"number"===typeof L&&(y=m.format(L));return y};b.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};b.getAttribute=A;b.getAttributes=function(y,L){const l=[];if("class-breaks"===y.type||"heatmap"===y.type)l.push(A(y,"number"));else if("unique-value"===y.type){var c=y.authoringInfo;if(c&&"relationship"===
c.type){if(c.field1&&c.field2){var a=c.field2.field;const d=c.field2.normalizationField;l.push(A({field:c.field1.field,normalizationField:c.field1.normalizationField}));l.push(A({field:a,normalizationField:d}))}}else a=y.uniqueValueInfos?.[0],c=null,a?.value&&(a=typeof a.value,"string"===a||"number"===a)&&(c=a),l.push(A(y,c)),[y.field2,y.field3].forEach(d=>d&&l.push({type:"field",field:d}))}else"attributes"in y&&y.attributes?.forEach(d=>l.push(A(d,"number")));(y=L?L(y):"visualVariables"in y?y.visualVariables:
null)&&y.forEach(d=>l.push(A(d,"number")));return k.unique(l.filter(k.isSome),(d,n)=>"field"===d.type&&"field"===n.type?d.field===n.field:"normalized-field"===d.type&&"normalized-field"===n.type?d.field===n.field&&d.normalizationField===n.normalizationField:"expression"===d.type&&"expression"===n.type?d.expression===n.expression:!1)};b.getColorsForRendererValues=async function(y){const L=new Map;if(!y)return L;if("unique-value"!==y.type||y.authoringInfo?.type)if("class-breaks"===y.type){var l=y.classBreakInfos.map(d=>
({value:d.minValue,color:t.getColorFromSymbol(d.symbol,null)})).reverse();const {field:c,valueExpression:a}=y;await q(L,c??a,l)}else"simple"===y.type&&await q(L,"default",[{value:"default",color:t.getColorFromSymbol(y.symbol,null)}]);else{l=(y.uniqueValueInfos??[]).map(K=>({value:K.value,color:t.getColorFromSymbol(K.symbol,null)}));const {field:c,field2:a,field3:d,valueExpression:n,fieldDelimiter:D}=y,J=[c,a,d].filter(Boolean).join(D||"");(J||n)&&await q(L,J||n,l)}"defaultSymbol"in y&&y.defaultSymbol&&
await q(L,"default",[{value:"default",color:t.getColorFromSymbol(y.defaultSymbol,null)}]);if("visualVariables"in y&&y.visualVariables){y=y.visualVariables.filter(c=>"color"===c.type);for(const c of y)y=await w.getRampStops(c)??[],await q(L,c.field||c.valueExpression,y)}return L};b.getColorsFromRenderer=async function(y){const L=new Map;if(!y)return L;if("visualVariables"in y&&y.visualVariables){var l=y.visualVariables.filter(a=>"color"===a.type);for(var c of l)l=(await w.getRampStops(c)??[]).map(a=>
a.color),await r(L,c.field||c.valueExpression,l)}if("heatmap"===y.type)c=f.getHeatmapRampStops(y).map(a=>a.color),await r(L,y.field||y.valueExpression,c);else if("pie-chart"===y.type){for(const a of y.attributes)await r(L,a.field||a.valueExpression,[a.color]);await r(L,"default",[y?.othersCategory?.color,t.getColorFromSymbol(y.backgroundFillSymbol,null)])}else if("dot-density"===y.type){for(const a of y.attributes)await r(L,a.field||a.valueExpression,[a.color]);await r(L,"default",[y.backgroundColor])}else if("unique-value"===
y.type)if("predominance"===y.authoringInfo?.type)for(const a of y.uniqueValueInfos??[])await r(L,a.value.toString(),[t.getColorFromSymbol(a.symbol,null)]);else{c=(y.uniqueValueInfos??[]).map(J=>t.getColorFromSymbol(J.symbol,null));const {field:a,field2:d,field3:n,valueExpression:D}=y;(a||D)&&await r(L,a||D,c);d&&await r(L,d,c);n&&await r(L,n,c)}else if("class-breaks"===y.type){c=y.classBreakInfos.map(n=>t.getColorFromSymbol(n.symbol,null));const {field:a,valueExpression:d}=y;await r(L,a??d,c)}else"simple"===
y.type&&await r(L,"default",[t.getColorFromSymbol(y.symbol,null)]);"defaultSymbol"in y&&y.defaultSymbol&&await r(L,"default",[t.getColorFromSymbol(y.defaultSymbol,null)]);L.forEach((a,d)=>{a=k.unique(a.filter(Boolean),(n,D)=>JSON.stringify(n)===JSON.stringify(D));L.set(d,a)});return L};b.setLabelsForClassBreaks=function(y){const L=y.classBreakInfos,l=y.normalizationType;let c=[];if(L?.length)if("standard-deviation"===y.classificationMethod)e.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks",
"cannot set labels for class breaks generated using 'standard-deviation' method.");else if(y.round){c.push(L[0].minValue);for(const a of L)c.push(a.maxValue);c=m.round(c);L.forEach((a,d)=>{a.label=p({minValue:0===d?c[0]:c[d],maxValue:c[d+1],isFirstBreak:0===d,normalizationType:l})})}else L.forEach((a,d)=>{a.label=p({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===d,normalizationType:l})})};b.timelineDateFormatOptions=u;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports",
"../../intl","../../intl/number"],function(b,k,e){function B(w,f){return w-f}function x(w,f){let r;r=Number(w.toFixed(f));r<w?w=r+1/10**f:(w=r,r-=1/10**f);r=Number(r.toFixed(f));w=Number(w.toFixed(f));return[r,w]}function F(w,f,r,q,p){w=H(w,f,r,q);f=null==w.next||w.next<=p;return(null==w.previous||w.previous<=p)&&f||w.previous+w.next<=2*p}function m(w){w=String(w);var f=w.match(O);if(f?.[1])return{integer:f[1].split("").length,fractional:f[3]?f[3].split("").length:0};if(w.toLowerCase().includes("e")&&
(f=w.split("e"),w=f[0],f=f[1],w&&f)){w=Number(w);f=Number(f);const r=0<f;r||(f=Math.abs(f));w=m(w);r?(w.integer+=f,w.fractional=f>w.fractional?0:w.fractional-f):(w.fractional+=f,w.integer=f>w.integer?1:w.integer-f);return w}return{integer:0,fractional:0}}function H(w,f,r,q){const p={previous:null,next:null};if(null!=r){const A=w-r;p.previous=Math.floor(Math.abs(100*(f-r-A)/A))}null!=q&&(w=q-w,p.next=Math.floor(Math.abs(100*(q-f-w)/w)));return p}const O=/^-?(\d+)(\.(\d+))?$/i,t={maximumFractionDigits:20};
b.format=function(w){return e.formatNumber(w,t)};b.numDigits=m;b.percentChange=H;b.round=function(w,f={}){w=w.slice();const {tolerance:r=2,strictBounds:q=!1,indexes:p=w.map((v,z)=>z)}=f;p.sort(B);for(f=0;f<p.length;f++){const v=p[f],z=w[v],u=0===v?null:w[v-1],y=v===w.length-1?null:w[v+1],L=m(z).fractional;if(L){let l=0,c=!1;for(var A=void 0;l<=L&&!c;)A=x(z,l),A=q&&0===f?A[1]:A[0],c=F(z,A,u,y,r),l++;c&&(w[v]=A)}}return w};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f){function r(a){a=a.symbolLayers;if(!a)return null;let d=null;a.forEach(n=>{"object"===n.type&&n.resource?.href||(d="water"===n.type?n.color:n.material?n.material.color:null)});return d?new e(d):null}function q(a,d){if(null==d||null==a)return a;a=a.toRgba();a[3]*=d;return new e(a)}function p(a,d,n){if(a=a.symbolLayers){var D=J=>{d=d??J??(null!=n?c:null);return q(d,n)};a.forEach(J=>{if("object"!==J.type||!J.resource?.href||d)if("water"===J.type)J.color=D(J.color);else{const K=
D(null!=J.material?J.material.color:null);null==J.material?J.material=new f.Symbol3DMaterial({color:K}):J.material.color=K;null!=n&&"outline"in J&&null!=J.outline?.color&&(J.outline.color=q(J.outline.color,n))}})}}async function A(a,d){(a=a.symbolLayers)&&await x.forEach(a,async n=>v(n,d))}async function v(a,d){switch(a.type){case "extrude":a.size="number"===typeof d[2]?d[2]:0;break;case "icon":case "line":case "text":d=z(d);null!=d&&(a.size=d);break;case "path":const n=y(d,H.ONES,[a.width,void 0,
a.height]);a.width=l(d[0],a.width,1,n);a.height=l(d[2],a.height,1,n);break;case "object":await u(a,d)}}function z(a){for(const d of a)if("number"===typeof d)return d;return null}async function u(a,d){const {resourceSize:n,symbolSize:D}=await L(a),J=y(d,n,D);a.width=l(d[0],D[0],n[0],J);a.depth=l(d[1],D[1],n[1],J);a.height=l(d[2],D[2],n[2],J)}function y(a,d,n){for(let D=0;3>D;D++){const J=a[D];switch(J){case "symbol-value":return a=n[D],null!=a?a/d[D]:1;case "proportional":break;default:if(J&&d[D])return J/
d[D]}}return 1}async function L(a){var {computeObjectLayerResourceSize:d}=await new Promise((G,Q)=>b(["./symbolLayerUtils"],G,Q));d=await d(a,10);const {width:n,height:D,depth:J}=a;a=[n,J,D];let K=1;for(var N=0;3>N;N++){const G=a[N];if(null!=G){K=G/d[N];break}}for(N=0;3>N;N++)null==a[N]&&(a[N]=d[N]*K);return{resourceSize:d,symbolSize:a}}function l(a,d,n,D){switch(a){case "proportional":return n*D;case "symbol-value":return null!=d?d:n;default:return a}}const c=new e("white");k.applyColorToSymbol=
function(a,d,n){if(a&&(d||null!=n))if(d&&=new e(d),B.isSymbol3D(a))p(a,d,n);else if(B.isSymbol2D(a)){if(d=d??a.color)a.color=q(d,n);null!=n&&"outline"in a&&a.outline?.color&&(a.outline.color=q(a.outline.color,n))}};k.applyOpacityToColor=q;k.applyRotationToSymbol=function(a,d,n){a&&null!=d&&(B.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(D=>{if("object"===D.type)switch(n){case "tilt":D.tilt=(D.tilt??0)+d;break;case "roll":D.roll=(D.roll??0)+d;break;default:D.heading=(D.heading??0)+d}"icon"===D.type&&
(D.angle+=d)}):!B.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle+=d))};k.applySizesToSymbol=async function(a,d){if(a&&d){if(B.isSymbol3D(a))return A(a,d);if(B.isSymbol2D(a)&&(d=z(d),null!=d))switch(a.type){case "simple-marker":a.size=d;break;case "picture-marker":const n=a.width/a.height;1<n?(a.width=d,a.height=d*n):(a.width=d*n,a.height=d);break;case "simple-line":a.width=d;break;case "text":a.font.size=d}}};k.fetchWebStyleSymbol=async function(a,d){const n=
await a.fetchSymbol(d);return n?n:a.fetchCIMSymbol(d)};k.getCSSFilterFromEffectList=function(a){if(!a)return null;a=a.effects.filter(d=>"bloom"!==d.type).map(d=>d.toJSON());return O.effectFunctionsFromJSON(a)};k.getColorFromSymbol=function(a,d){if(!a)return null;let n=null;B.isSymbol3D(a)?n=r(a):B.isSymbol2D(a)&&(n="cim"===a.type?t.getCIMSymbolColor(a):a.color?new e(a.color):null);return n?q(n,d):null};k.getIconHref=function(a){return a.resource?.href??""};k.getSymbolOutlineSize=function(a){return a?
B.isSymbol3D(a)?(a=(a=a.symbolLayers?.at(-1))&&"outline"in a?a?.outline?.size:void 0,null!=a?a:0):m.px2pt(w.getStroke(a)?.width):0};k.isVolumetricSymbol=function(a){if(null==a||!("symbolLayers"in a)||null==a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(d=>"object"===d.type);case "line-3d":return a.symbolLayers.some(d=>"path"===d.type);case "polygon-3d":return a.symbolLayers.some(d=>"object"===d.type||"extrude"===d.type);default:return!1}};k.symbolHasExtrudeSymbolLayer=
function(a){return null!=a&&"polygon-3d"===a.type&&a.symbolLayers.some(d=>"extrude"===d.type)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(b,k,e){function B(f){f=e.toCIMSymbolJSON(f);if("CIMTextSymbol"===f?.type)return f.height??0;let r=0;if(f?.symbolLayers)for(const q of f.symbolLayers)e.isCIMMarker(q)&&null!=q.size&&q.size>r?r=q.size:e.isCIMStroke(q)&&null!=q.width&&q.width>
r?r=q.width:e.isCIMFill(q);return r}function x(f,r,q,p){if(f)if("CIMTextSymbol"===f.type)null!=f.height&&(f.height*=r);else{if(q&&f.effects)for(const A of f.effects)H(A,r);if(f.symbolLayers)for(const A of f.symbolLayers)switch(A.type){case "CIMPictureMarker":case "CIMVectorMarker":F(A,r,p);break;case "CIMPictureStroke":case "CIMSolidStroke":!p?.preserveOutlineWidth&&A.width&&(A.width*=r);break;case "CIMPictureFill":A.height&&(A.height*=r);A.offsetX&&(A.offsetX*=r);A.offsetY&&(A.offsetY*=r);break;
case "CIMHatchFill":x(A.lineSymbol,r,!0,{...p,preserveOutlineWidth:!1}),A.offsetX&&(A.offsetX*=r),A.offsetY&&(A.offsetY*=r),A.separation&&(A.separation*=r)}}}function F(f,r,q){if(f&&(f.markerPlacement&&m(f.markerPlacement,r),f.offsetX&&(f.offsetX*=r),f.offsetY&&(f.offsetY*=r),f.anchorPoint&&"Absolute"===f.anchorPointUnits&&(f.anchorPoint={x:f.anchorPoint.x*r,y:f.anchorPoint.y*r}),f.size=null!=f.size?f.size*r:0,"CIMVectorMarker"===f.type&&f.markerGraphics))for(const p of f.markerGraphics)f.scaleSymbolsProportionally||
x(p.symbol,r,!0,q)}function m(f,r){e.isCIMMarkerStrokePlacement(f)&&f.offset&&(f.offset*=r);switch(f.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":f.customEndingOffset&&(f.customEndingOffset*=r);f.offsetAlongLine&&(f.offsetAlongLine*=r);if(f.placementTemplate&&f.placementTemplate.length){var q=f.placementTemplate.map(p=>p*r);f.placementTemplate=q}break;case "CIMMarkerPlacementAlongLineVariableSize":f.maxRandomOffset&&(f.maxRandomOffset*=r);f.placementTemplate&&
f.placementTemplate.length&&(q=f.placementTemplate.map(p=>p*r),f.placementTemplate=q);break;case "CIMMarkerPlacementOnLine":f.startPointOffset&&(f.startPointOffset*=r);break;case "CIMMarkerPlacementAtExtremities":f.offsetAlongLine&&(f.offsetAlongLine*=r);break;case "CIMMarkerPlacementAtRatioPositions":f.beginPosition&&(f.beginPosition*=r);f.endPosition&&(f.endPosition*=r);break;case "CIMMarkerPlacementPolygonCenter":f.offsetX&&(f.offsetX*=r);f.offsetY&&(f.offsetY*=r);break;case "CIMMarkerPlacementInsidePolygon":f.offsetX&&
(f.offsetX*=r),f.offsetY&&(f.offsetY*=r),f.stepX&&(f.stepX*=r),f.stepY&&(f.stepY*=r)}}function H(f,r){switch(f.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":f.width&&(f.width*=r);break;case "CIMGeometricEffectBuffer":f.size&&(f.size*=r);break;case "CIMGeometricEffectCut":f.beginCut&&(f.beginCut*=r);f.endCut&&(f.endCut*=r);f.middleCut&&(f.middleCut*=r);break;case "CIMGeometricEffectDashes":f.customEndingOffset&&(f.customEndingOffset*=r);f.offsetAlongLine&&(f.offsetAlongLine*=
r);if(f.dashTemplate&&f.dashTemplate.length){const q=f.dashTemplate.map(p=>p*r);f.dashTemplate=q}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":f.length&&(f.length*=r);break;case "CIMGeometricEffectMove":f.offsetX&&(f.offsetX*=r);f.offsetY&&(f.offsetY*=r);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":f.offset&&(f.offset*=r);break;case "CIMGeometricEffectRegularPolygon":f.radius&&(f.radius*=r);break;case "CIMGeometricEffectTaperedPolygon":f.fromWidth&&
(f.fromWidth*=r);f.length&&(f.length*=r);f.toWidth&&(f.toWidth*=r);break;case "CIMGeometricEffectWave":f.amplitude&&(f.amplitude*=r),f.period&&(f.period*=r)}}function O(f,r){if(f){var q="CIMTextSymbol"===f.type?f.symbol:f;f="CIMPolygonSymbol"===f.type;if(q?.symbolLayers)for(const p of q.symbolLayers)if(!(p.colorLocked||f&&(e.isCIMStroke(p)||e.isCIMMarker(p)&&p.markerPlacement&&e.isCIMMarkerStrokePlacement(p.markerPlacement))))switch(p.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":p.tintColor&&
t(r,p.tintColor);break;case "CIMVectorMarker":p.markerGraphics?.forEach(A=>{O(A.symbol,r)});break;case "CIMSolidStroke":case "CIMSolidFill":t(r,p.color);break;case "CIMHatchFill":O(p.lineSymbol,r)}}}function t(f,r){for(const q of f)if(q.join(".")===r.join("."))return;f.push(r)}function w(f,r,q){if(f){var p="CIMTextSymbol"===f.type?f.symbol:f;f="CIMPolygonSymbol"===p?.type;if(p?.symbolLayers)for(const A of p.symbolLayers)if(!A.colorLocked){if(f)if(q){if({layersToColor:p}=q,(e.isCIMStroke(A)||e.isCIMMarker(A)&&
A.markerPlacement&&e.isCIMMarkerStrokePlacement(A.markerPlacement))&&"fill"===p||e.isCIMFill(A)&&"outline"===p)continue}else if(e.isCIMStroke(A)||e.isCIMMarker(A)&&A.markerPlacement&&e.isCIMMarkerStrokePlacement(A.markerPlacement))continue;p=r.toArray();switch(A.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":A.tintColor=p;break;case "CIMVectorMarker":A.markerGraphics?.forEach(v=>{w(v.symbol,r,q)});break;case "CIMSolidStroke":case "CIMSolidFill":A.color=p;break;case "CIMHatchFill":w(A.lineSymbol,
r,q)}}}}b.applyCIMSymbolColor=function(f,r,q){r instanceof k||(r=new k(r));(f=e.toCIMSymbolJSON(f))&&w(f,r,q)};b.applyCIMSymbolRotation=function(f,r,q=!1){f=e.toCIMSymbolJSON(f);q&&(r=360-r);if("CIMTextSymbol"===f?.type)f.angle=r;else if("CIMPointSymbol"===f?.type&&f.symbolLayers){q=r-(f.angle||0);for(const p of f.symbolLayers)if(e.isCIMMarker(p)){let A=p.rotation||0;A=p.rotateClockwise?A-q:A+q;p.rotation=A}f.angle=r}};b.getCIMSymbolColor=function(f){f=e.toCIMSymbolJSON(f);const r=[];O(f,r);return r.length?
new k(e.normalizeAlpha(r[0])):null};b.getCIMSymbolRotation=function(f,r=!1){f=e.toCIMSymbolJSON(f);return"CIMTextSymbol"===f?.type||"CIMPointSymbol"===f?.type?(f=f.angle,null!=f&&r?360-f:f??0):0};b.getCIMSymbolSize=B;b.getCIMSymbolType=function(f){f=e.toCIMSymbolJSON(f);if(!f)return null;switch(f.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";
default:return null}};b.scaleCIMMarker=F;b.scaleCIMSymbol=x;b.scaleCIMSymbolTo=function(f,r,q){if(f){var p=e.toCIMSymbolJSON(f);f=B(f);if(0===f){if(p)if("CIMTextSymbol"===p.type)p.height=r;else if(p.symbolLayers)for(const A of p.symbolLayers)switch(A.type){case "CIMPictureMarker":case "CIMVectorMarker":A.size=r;break;case "CIMPictureStroke":case "CIMSolidStroke":A.width=r}}else x(p,r/f,!1,q)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(b,k,e,B,x,F,m){function H(r){if(!r)return null;let q=null;switch(r.type){case "simple-fill":case "picture-fill":case "simple-marker":q=H(r.outline);break;case "simple-line":const p=F.pt2px(r.width);null!=r.style&&"none"!==r.style&&0!==p&&(q={color:r.color,style:f(r.style),width:p,cap:r.cap,join:"miter"===r.join?F.pt2px(r.miterLimit):r.join},q.dashArray=O(q).join(",")||"none");break;default:q=null}return q}function O(r){if(!r?.style)return[];const {dashArray:q,style:p,width:A}=r;if("string"===
typeof q&&"none"!==q)return q.split(",").map(u=>Number(u));const v=A??0,z=t.has(p)?t.get(p).map(u=>u*v):[];if("butt"!==r.cap)for(const [u,y]of z.entries())z[u]=1===u%2?y+v:Math.max(y-v,1);return z}const t=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),w=new x.LRUCache(1E3),f=(()=>{const r={};return q=>
{if(r[q])return r[q];const p=q.replaceAll("-","");return r[q]=p}})();e=new e([128,128,128]);b.defaultThematicColor=e;b.dekebabifyLineStyle=f;b.getDashArray=O;b.getFill=function(r){const q=r.style;let p=null;if(r)switch(r.type){case "simple-marker":"cross"!==q&&"x"!==q&&(p=r.color);break;case "simple-fill":q&&"solid"!==q?"none"!==q&&(p={type:"pattern",x:0,y:0,src:k.getAssetUrl(`esri/symbols/patterns/${q}.png`),width:5,height:5}):p=r.color;break;case "picture-fill":p={type:"pattern",src:r.url,width:F.pt2px(r.width)*
r.xscale,height:F.pt2px(r.height)*r.yscale,x:F.pt2px(r.xoffset),y:F.pt2px(r.yoffset)};break;case "text":p=r.color;break;case "cim":p=m.getCIMSymbolColor(r)}return p};b.getPatternUrlWithColor=function(r,q){const p=r+"-"+q;return void 0!==w.get(p)?Promise.resolve(w.get(p)):B(r,{responseType:"image"}).then(A=>{A=A.data;const v=A.naturalWidth,z=A.naturalHeight,u=document.createElement("canvas");u.width=v;u.height=z;const y=u.getContext("2d");y.fillStyle=q;y.fillRect(0,0,v,z);y.globalCompositeOperation=
"destination-in";y.drawImage(A,0,0);A=u.toDataURL();w.put(p,A);return A})};b.getStroke=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(b,k,e,B){function x(t,w){const f=[],r=t.length-1;5===t.length?f.push(0,2,4):f.push(0,r);return t.map((q,p)=>f.includes(p)?B.createStopLabel(q,p,r,w):null)}async function F(t,w,f){f=new e(f??O);t=(await new Promise((r,q)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],
r,q))).getOpacity(w,t);null!=t&&(f.a=t);return f}function m(t,w){const {startIndex:f,endIndex:r,weight:q}=H(t,w);if(f===r)return w[f].color;t=e.blendColors(w[f].color,w[r].color,q);return new e(t)}function H(t,w){let f=0,r=w.length-1;w.some((q,p)=>{if(t<q.value)return r=p,!0;f=p;return!1});return{startIndex:f,endIndex:r,weight:(t-w[f].value)/(w[r].value-w[f].value)}}const O=new e([64,64,64]);k.getColorFromPointCloudStops=m;k.getRampStops=async function(t,w,f){let r=!1,q=[],p=[];if(t.stops){var A=
t.stops;q=A.map(z=>z.value);(r=A.some(z=>!!z.label))&&(p=A.map(z=>z.label))}A=q[q.length-1];if(null==q[0]&&null==A)return null;const v=r?null:x(q,f);return(await Promise.all(q.map(async(z,u)=>{const y="opacity"===t.type?await F(z,t,w):(await new Promise((L,l)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],L,l))).getColor(t,z);return{value:z,color:y,label:r?p[u]:v?.[u]??""}}))).reverse()};k.getRampStopsForPointCloud=function(t){let w=!1,f=[],r=[];f=t.map(A=>A.value);(w=t.some(A=>
!!A.label))&&(r=t.map(A=>A.label??""));const q=f[f.length-1];if(null==f[0]&&null==q)return null;const p=w?null:x(f);return f.map((A,v)=>{const z=m(A,t);return{value:A,color:z,label:w?r[v]:p?.[v]??""}}).reverse()};k.getStretchRampStops=function(t,w){let f=[];if(t&&"multipart"===t.type)t.colorRamps.reverse().forEach((r,q)=>{0===q?f.push({value:w.max,color:new e(r.toColor),label:"high"}):f.push({value:null,color:new e(r.toColor),label:""});q===t.colorRamps.length-1?f.push({value:w.min,color:new e(r.fromColor),
label:"low"}):f.push({value:null,color:new e(r.fromColor),label:""})});else{let r,q;t&&"algorithmic"===t.type?(r=t.fromColor,q=t.toColor):(r=[0,0,0,1],q=[255,255,255,1]);f=[{value:w.max,color:new e(q),label:"high"},{value:w.min,color:new e(r),label:"low"}]}return f};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(b,k,e,B,x,F,m,H){async function O(f){if(!("visualVariables"in f&&f.visualVariables))return null;f=f.visualVariables.find(p=>"color"===p.type);if(!f)return null;var r=null,q=null;if(f.stops){if(1===f.stops.length)return f.stops[0].color;r=f.stops[0].value;q=f.stops[f.stops.length-1].value}r=null!=r&&null!=q?r+(q-r)/2:0;({getColor:q}=await new Promise((p,A)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],p,A)));return q(f,r)??null}function t(f,r){if(!r.field)return null;
if("featureReduction"in f)switch(f.featureReduction?.type){case "cluster":case "binning":const q=f.featureReduction.fields.find(({name:p})=>p.toLowerCase()===r.field.toLowerCase());return q&&"getField"in f?f.getField(q.onStatisticField):null}return"getField"in f?f.getField?.(r.field):null}function w(f,r){f="popupTemplate"in f?f.popupTemplate?.fieldInfos:null;if(f?.length&&r)return f.find(q=>q.fieldName?.toLowerCase()===r.toLowerCase())?.format?.dateFormat}k.createStopLabel=function(f,r,q,p){let A=
"";0===r?A="\x3c ":r===q&&(A="\x3e ");f=p?m.formatAnyDate(f,p):F.format(f);return A+f};k.getDateFormatOptions=function(f,r,q){const p=t(f,r);if(!p||!m.isAnyDateField(p)&&!x.isTimeOnlyField(p))return null;var A=w(f,p.name);if(!A&&"date"===p.type){let v=A=0;r.stops?(A=r.stops?.at(0)?.value??A,v=r.stops?.at(-1)?.value??v):"minDataValue"in r&&"maxDataValue"in r&&(A=r.minDataValue??A,v=r.maxDataValue??v);A=v-A>2*B.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:p.type,
format:A,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in f?f.preferredTimeZone:null,viewTimeZone:q,datesInUnknownTimezone:"datesInUnknownTimezone"in f&&f.datesInUnknownTimezone}}};k.getMedianColor=O;k.getReferenceSizeAuthoringInfoVisualVariable=function(f){if("authoringInfo"in f)return f.authoringInfo?.visualVariables?.find(({theme:r})=>"reference-size"===r)};k.getSymbolForFlowRenderer=async function(f,r){const q=f.trailCap,p=f.trailWidth||1;f=r||await O(f)||f.color;return new H({cap:q,color:f,
width:p})};k.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
k.specialCharsGreaterThan="\x3e";k.specialCharsLessThan="\x3c";Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(b,k){b.getHeatmapRampStops=function(e){if(!e.colorStops)return[];const B=[...e.colorStops].filter(F=>0<F.color?.a);let x=B.length-1;if(B&&B[0]){const F=B[x];F&&1!==F.ratio&&(B.push(new k({ratio:1,color:F.color})),x++)}return B.map((F,m)=>{let H=
"";0===m?H=e.legendOptions?.minLabel||"low":m===x&&(H=e.legendOptions?.maxLabel||"high");return{color:F.color,label:H,ratio:F.ratio}}).reverse()};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w){const f={chartAnimation:!0};k=class extends k{constructor(r){super(r);this.abilities={...f};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(r){return{...f,...r}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(r){this._setContentElementMedia(r)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(r){const {formattedMediaInfoCount:q}=this;this.activeMediaInfoIndex=(r+q)%q}_pageContentElementMedia(r){const {activeMediaInfoIndex:q}=this;this._setContentElementMedia(q+r)}_formatMediaInfos(){const {mediaInfos:r,layer:q}=this,p=this.attributes??{},A=this.formattedAttributes??
{},v=this.expressionAttributes??{},z=this.fieldInfoMap??new Map;return r?.map(u=>{u=u?.clone();if(!u)return null;u.title=t.substituteFieldsInLinksAndAttributes({attributes:p,fieldInfoMap:z,globalAttributes:A,expressionAttributes:v,layer:q,text:u.title});u.caption=t.substituteFieldsInLinksAndAttributes({attributes:p,fieldInfoMap:z,globalAttributes:A,expressionAttributes:v,layer:q,text:u.caption});u.altText=t.substituteFieldsInLinksAndAttributes({attributes:p,fieldInfoMap:z,globalAttributes:A,expressionAttributes:v,
layer:q,text:u.altText});if("image"===u.type){if(!u.value)return;this._setImageValue({value:u.value,formattedAttributes:A,layer:q});return u.value.sourceURL?u:void 0}if("pie-chart"===u.type||"line-chart"===u.type||"column-chart"===u.type||"bar-chart"===u.type){if(!u.value)return;this._setChartValue({value:u.value,chartType:u.type,attributes:p,formattedAttributes:A,layer:q,expressionAttributes:v});return u}return null}).filter(e.isSome)??[]}_setImageValue(r){const q=this.fieldInfoMap??new Map,{value:p,
formattedAttributes:A,layer:v}=r,{linkURL:z,sourceURL:u}=p;u&&(r=t.fixTokens(u,v),p.sourceURL=t.substituteAttributes({formattedAttributes:A,template:r,fieldInfoMap:q}));z&&(r=t.fixTokens(z,v),p.linkURL=t.substituteAttributes({formattedAttributes:A,template:r,fieldInfoMap:q}))}_setChartValue(r){const {value:q,attributes:p,formattedAttributes:A,chartType:v,layer:z,expressionAttributes:u}=r,{popupTemplate:y,relatedInfos:L}=this,{fields:l,normalizeField:c}=q;q.fields=t.getFixedFieldNames(l,z);c&&(q.normalizeField=
t.getFixedFieldName(c,z));if(l.some(d=>!!(null!=A[d]||t.isRelatedField(d)&&L?.size))){var a=y?.fieldInfos??[];l.forEach((d,n)=>{n=q.colors?.[n];t.isRelatedField(d)?q.series=[...q.series,...this._getRelatedChartInfos({fieldInfos:a,fieldName:d,formattedAttributes:A,chartType:v,value:q,color:n})]:(d=this._getChartOption({value:q,attributes:p,chartType:v,formattedAttributes:A,expressionAttributes:u,fieldName:d,fieldInfos:a,color:n}),q.series.push(d))})}}_getRelatedChartInfos(r){const {fieldInfos:q,fieldName:p,
formattedAttributes:A,chartType:v,value:z,color:u}=r,y=[],L=w.getRelatedFieldInfo(p);r=L&&this.relatedInfos?.get(L.layerId.toString());if(!r)return y;const {relatedFeatures:l,relation:c}=r;if(!c||!l)return y;({cardinality:r}=c);l.forEach(a=>{const {attributes:d}=a;d&&Object.keys(d).forEach(n=>{n===L.fieldName&&y.push(this._getChartOption({value:z,attributes:d,formattedAttributes:A,fieldName:p,chartType:v,relatedFieldName:n,hasMultipleRelatedFeatures:1<l?.length,fieldInfos:q,color:u}))})});return"one-to-many"===
r||"many-to-many"===r?y:[y[0]]}_getTooltip({label:r,value:q,chartType:p}){return"pie-chart"===p?`${r}`:`${r}: ${q}`}_getChartOption(r){const {value:q,attributes:p,formattedAttributes:A,expressionAttributes:v,fieldName:z,relatedFieldName:u,fieldInfos:y,chartType:L,hasMultipleRelatedFeatures:l,color:c}=r;var a=this.layer,d=this.fieldInfoMap??new Map;const {normalizeField:n,tooltipField:D}=q;r=n?t.isRelatedField(n)?p[w.getRelatedFieldInfo(n).fieldName]:p[n]:null;var J=t.isExpressionField(z)&&v&&void 0!==
v[z]?v[z]:u&&void 0!==p[u]?p[u]:void 0!==p[z]?p[z]:A[z];r=new O({fieldName:z,color:c,value:void 0===J?null:J&&r?J/r:J});if(t.isRelatedField(z))return a=d.get(z.toLowerCase()),J=D&&d.get(D.toLowerCase()),d=a?.fieldName??z,J=l&&D?w.getRelatedFieldInfo(D).fieldName:J?.fieldName??D,r.tooltip=this._getTooltip({label:l&&J?p[J]:A[J]??a?.label??a?.fieldName??u,value:l&&u?p[u]:A[d],chartType:L}),r;d=t.getFieldInfo(y,z);a=t.getFixedFieldName(z,a);d=D&&void 0!==A[D]?A[D]:t.getFieldInfoLabel(d||new H({fieldName:a}),
this.popupTemplate?.expressionInfos);r.tooltip=this._getTooltip({label:d,value:A[a],chartType:L});return r}};b.__decorate([B.property()],k.prototype,"abilities",void 0);b.__decorate([x.cast("abilities")],k.prototype,"castAbilities",null);b.__decorate([B.property()],k.prototype,"activeMediaInfoIndex",void 0);b.__decorate([B.property({readOnly:!0})],k.prototype,"activeMediaInfo",null);b.__decorate([B.property()],k.prototype,"attributes",void 0);b.__decorate([B.property()],k.prototype,"description",
void 0);b.__decorate([B.property()],k.prototype,"fieldInfoMap",void 0);b.__decorate([B.property()],k.prototype,"formattedAttributes",void 0);b.__decorate([B.property()],k.prototype,"expressionAttributes",void 0);b.__decorate([B.property({readOnly:!0})],k.prototype,"formattedMediaInfos",null);b.__decorate([B.property()],k.prototype,"isAggregate",void 0);b.__decorate([B.property()],k.prototype,"layer",void 0);b.__decorate([B.property({readOnly:!0})],k.prototype,"formattedMediaInfoCount",null);b.__decorate([B.property()],
k.prototype,"mediaInfos",void 0);b.__decorate([B.property()],k.prototype,"popupTemplate",void 0);b.__decorate([B.property()],k.prototype,"relatedInfos",void 0);b.__decorate([B.property()],k.prototype,"title",void 0);return k=b.__decorate([m.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],k)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../rest/query/executeQueryJSON ../../../rest/support/Query ../../../rest/support/RelationshipQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f){function r(c,a){if(!a.relationships)return null;let d=null;({relationships:a}=a);a.some(n=>n.id===parseInt(c,10)?(d=n,!0):!1);return d}function q({originRelationship:c,relationships:a,layerId:d}){return a.find(({relatedTableId:n,id:D})=>`${n}`===d&&D===c?.id)??null}function p(c,a){a=a.toLowerCase();for(const d in c)if(d.toLowerCase()===a)return c[d];return null}function A(c,a,d,n){const D=new t;D.outFields=["*"];D.relationshipId="number"===typeof a.id?a.id:parseInt(a.id,
10);D.objectIds=[c.attributes[d.objectIdField]];D.gdbVersion=d.gdbVersion??null;D.historicMoment=d.historicMoment??null;return d.queryRelatedFeatures?.(D,n)??Promise.resolve({})}function v(c,a,d){let n=0;const D=[];for(;n<a.length;)D.push(`${c} IN (${a.slice(n,d+n)})`),n+=d;return D.join(" OR ")}function z(c){return c?e.unique(c):void 0}function u(c){return c?e.unique(c,(a,d)=>JSON.stringify(a.toJSON())===JSON.stringify(d.toJSON())):void 0}async function y(c,a,d,n){var D=d.layerId.toString();const {layerInfo:J,
relation:K,relatedFields:N,outStatistics:G,url:Q,sourceSpatialReference:h}=a;a=z(N);const C=u(G);if(!J||!K)return null;const I=q({originRelationship:K,relationships:J.relationships,layerId:D});if(I?.relationshipTableId&&I.keyFieldInRelationshipTable){D=(await A(c,I,d,n))[c.attributes[d.objectIdField]];if(!D)return null;var g=D.features.map(E=>E.attributes[J.objectIdField]);if(C?.length&&J.supportsStatistics)return n=new O,n.where=v(J.objectIdField,g,1E3),n.outFields=a,n.outStatistics=C,n.sourceSpatialReference=
h,n={features:Promise.resolve(D),statsFeatures:H.executeQueryJSON(Q,n)},F.eachAlways(n)}return(D=I?.keyField)?(g=m.isNumericField(L(J.fields,D)),c=p(c.attributes,K.keyField),c=g?`${D}=${c}`:`${D}='${c}'`,d=H.executeQueryJSON(Q,new O({where:c,outFields:a,sourceSpatialReference:h,historicMoment:d.historicMoment,gdbVersion:d.gdbVersion}),n),n=C?.length&&J.supportsStatistics?H.executeQueryJSON(Q,new O({where:c,outFields:a,outStatistics:C,sourceSpatialReference:h}),n):null,a={features:d},n&&(a.statsFeatures=
n),F.eachAlways(a)):null}function L(c,a){if(null!=c){a=a.toLowerCase();for(const d of c)if(d&&d.name.toLowerCase()===a)return d}return null}const l=new Map;b.createRelatedInfo=function(c,a){if(c=r(c,a))return{url:`${a.url}/${c.relatedTableId}`,sourceSpatialReference:a.spatialReference,relation:c,relatedFields:[],outStatistics:[]}};b.getDestinationRelation=q;b.getRelatedFieldInfo=function(c){if(!f.isRelatedField(c))return null;const [a,d]=c.split("/").slice(1);return{layerId:a,fieldName:d}};b.getUniqueOutFields=
z;b.getUniqueOutStatistics=u;b.queryLayerInfos=function({relatedInfos:c,layer:a},d){const n={};c.forEach((D,J)=>{({relation:D}=D);if(!D)throw J=new B("relation-required","A relation is required on a layer to retrieve related records."),x.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(J),J;({relatedTableId:D}=D);if("number"!==typeof D)throw J=new B("A related table ID is required on a layer to retrieve related records."),x.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(J),
J;D=`${a.url}/${D}`;const K=l.get(D),N=K??k(D,{query:{f:"json"},signal:(void 0)?.signal});K||l.set(D,N);n[J]=N});return F.whenOrAbort(F.eachAlways(n),d)};b.queryRelatedFeatures=function({graphic:c,relatedInfos:a,layer:d},n){const D={};a.forEach((J,K)=>{J.layerInfo&&(D[K]=y(c,J,d,n))});return F.eachAlways(D)};b.setRelatedFeatures=function(c,a){if(a&&c){var {features:d,statsFeatures:n}=c;c=d?.value;a.relatedFeatures=c?c.features:[];c=n?.value;a.relatedStatsFeatures=c?c.features:[]}};b.updateRelatedInfo=
function({relatedInfo:c,fieldName:a,fieldInfo:d}){c.relatedFields?.push(a);d.statisticType&&(a=new w({statisticType:d.statisticType,onStatisticField:a,outStatisticFieldName:a}),c.outStatistics?.push(a))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/content/UtilityNetworkAssociationsContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils ../../../geometry/Point".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l,c,a,d,n){k=class extends B{constructor(D){super(D);this.view=this.location=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:J}=this;J&&J.abort();this._abortController=null};this._createVM=()=>{var J=this.contentElement?.type;this.contentElementViewModel?.destroy();J="fields"===J?new c:"media"===J?new a:"text"===J?new l:null;
this._set("contentElementViewModel",J)};this._compile=async()=>{this._cancelQuery();const J=new AbortController;this._abortController=J;await this._compileExpression();this._abortController===J&&(this._abortController=null)};this._compileThrottled=F.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:J,graphic:K,interceptor:N,spatialReference:G,map:Q,location:h,view:C,_abortController:I}=this;if(J&&K){var g=await d.loadArcade();if(I===this._abortController)if((g=
await d.createCompiledExpression({arcade:g,expressionInfo:J,graphic:K,location:h,interceptor:N,map:Q,spatialReference:G,view:C}))&&"esri.arcade.Dictionary"===g.declaredClass){g=await g.castAsJsonAsync(I?.signal);var E=g?.type;g="media"===E?v.fromJSON(g):"text"===E?u.fromJSON(g):"fields"===E?A.fromJSON(g):null;"media"===g.type&&!g.mediaInfos||"fields"===g.type&&!g.fieldInfos||"text"===g.type&&!g.text?this._set("contentElement",null):this._set("contentElement",g)}else this._set("contentElement",null)}else this._set("contentElement",
null)};this.addHandles([x.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),x.initial),x.watch(()=>[this.contentElement],()=>this._createVM(),x.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(D){this._override("spatialReference",
D)}get state(){const {_abortController:D,contentElement:J,contentElementViewModel:K}=this;return D?"loading":J||K?"ready":"disabled"}get map(){return this.view?.map??null}set map(D){this._override("map",D)}};b.__decorate([m.property()],k.prototype,"_abortController",void 0);b.__decorate([m.property({type:L})],k.prototype,"expressionInfo",void 0);b.__decorate([m.property({type:e})],k.prototype,"graphic",void 0);b.__decorate([m.property({readOnly:!0})],k.prototype,"contentElement",void 0);b.__decorate([m.property({readOnly:!0})],
k.prototype,"contentElementViewModel",void 0);b.__decorate([m.property()],k.prototype,"interceptor",void 0);b.__decorate([m.property({type:n})],k.prototype,"location",void 0);b.__decorate([m.property()],k.prototype,"spatialReference",null);b.__decorate([m.property({readOnly:!0})],k.prototype,"state",null);b.__decorate([m.property()],k.prototype,"map",null);b.__decorate([m.property()],k.prototype,"view",void 0);return k=b.__decorate([w.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],
k)})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../arcade/featureset/support/shared ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils ../../support/globalCss".split(" "),function(b,k,e,B,x,F,m,H){function O(p){return`<ul class="esri-widget__list">${p.map(A=>`<li>${"string"===typeof A?m.applyTextFormattingHTML(m.htmlEntities(A)):A}</li>`).join("")}</ul>`}function t(p){const A=p.keys().map(v=>{var z=p.field(v);
z="string"===typeof z?m.applyTextFormattingHTML(m.htmlEntities(z)):z;return`<tr><th>${v}</th><td>${z}</td></tr>`}).join("");return`<table class="${H.globalCss.table}">${A}</table>`}function w(){return new Promise((p,A)=>b(["../../../arcade"],p,A))}async function f({graphic:p,view:A,options:v}){const {isAggregate:z,layer:u}=p;if(!z||!u||"2d"!==A?.type)return[];A=await A.whenLayerView(u);if(!("createQuery"in A&&"queryFeatures"in A))return[];const y=A.createQuery();p=p.getObjectId();y.aggregateIds=null!=
p?[p]:[];({features:v}=await A.queryFeatures(y,v));return v}function r({layer:p,aggregatedFeatures:A,interceptor:v}){const {fields:z,objectIdField:u,geometryType:y,spatialReference:L,displayField:l}=p;return new F({fields:z,objectIdField:u,geometryType:y,spatialReference:L,displayField:l,interceptor:v,...("feature"===p.type?{templates:p.templates,typeIdField:p.typeIdField,types:p.types}:null),source:A})}async function q({expressionInfo:p,arcade:A,interceptor:v,spatialReference:z,map:u,graphic:y,location:L,
view:l,options:c}){if(!p?.expression)return null;var {isAggregate:a}=y;const d=(y.sourceLayer||y.layer)??void 0;a=a?"feature-reduction-popup":"popup";const n=A.createArcadeProfile(a);A=A.createArcadeExecutor(p.expression,n).catch(N=>B.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-executor-error",{error:N,expressionInfo:p}));const [D,J]=await Promise.all([f({graphic:y,view:l,options:c}),A]);if(!J)return null;const K="feature-reduction-popup"===a?r({layer:d,aggregatedFeatures:D,
interceptor:v}):void 0;u={...("feature-reduction-popup"===a?{$aggregatedFeatures:K}:{$datastore:d?.url,$layer:null!=d&&e.isSupportedLayer(d)?d:"scene"===d?.type&&null!=d.associatedLayer?d.associatedLayer:void 0,$map:u,$userInput:L,$graph:"knowledge-graph-sublayer"===d?.type?d?.parentCompositeLayer?.knowledgeGraph:void 0}),$feature:y};return await J.executeAsync(u,{abortSignal:c?.signal??void 0,interceptor:v??void 0,rawOutput:!0,spatialReference:z??void 0,timeZone:l?.timeZone}).catch(N=>B.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-execution-error",
{error:N,graphic:y,expressionInfo:p})).finally(()=>K?.destroy())}k.createCompiledExpression=q;k.createCompiledExpressions=async function({expressionInfos:p,spatialReference:A,graphic:v,interceptor:z,map:u,view:y,location:L,options:l}){if(!p?.length)return{};const c=await w(),a={};for(const d of p)a[`expression/${d.name}`]=q({expressionInfo:d,arcade:c,interceptor:z,spatialReference:A,map:u,graphic:v,location:L,view:y,options:l});p=await x.eachAlways(a);A={};for(const d in p)v=p[d].value,v="string"===
typeof v?m.applyTextFormattingHTML(m.htmlEntities(v)):Array.isArray(v)?O(v):"esri.arcade.Dictionary"===v?.declaredClass?t(v):v,A[d]=v;return A};k.loadArcade=w;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/shared":function(){define("exports ../../ArcadeDate ../../../core/sql/DateOnly ../../../core/sql/TimeOnly ../../../geometry/Extent ../../../layers/support/Field ../../../chunks/datetime".split(" "),function(b,k,e,B,x,F,m){function H(w){return w instanceof
Date}function O(w){return w instanceof k.ArcadeDate}function t(w){switch(w.type){case "catalog":case "csv":case "feature":case "geojson":case "oriented-imagery":case "subtype-group":case "wfs":return!0;default:return!1}}b.FeatureServiceDatabaseType=void 0;(function(w){w[w.Standardised=0]="Standardised";w[w.StandardisedNoInterval=1]="StandardisedNoInterval";w[w.SqlServer=2]="SqlServer";w[w.Oracle=3]="Oracle";w[w.Postgres=4]="Postgres";w[w.PGDB=5]="PGDB";w[w.FILEGDB=6]="FILEGDB";w[w.NotEvaluated=7]=
"NotEvaluated"})(b.FeatureServiceDatabaseType||(b.FeatureServiceDatabaseType={}));b.IdState=void 0;(function(w){w[w.InFeatureSet=0]="InFeatureSet";w[w.NotInFeatureSet=1]="NotInFeatureSet";w[w.Unknown=2]="Unknown"})(b.IdState||(b.IdState={}));b.callback=function(w,f){return function(){try{w.apply(null,arguments)}catch(r){f.reject(r)}}};b.cloneAttributes=function(w){const f={};for(const r in w)f[r]=w[r];return f};b.cloneField=function(w){return F.fromJSON(w.toJSON())};b.convertLinearUnitsToCode=function(w){if(null==
w)return null;if("number"===typeof w||"number"===typeof w)return w;switch(w.toLowerCase()){case "meters":case "meter":return 9001;case "miles":case "mile":return 9093;case "kilometers":case "kilometer":case "km":return 9036}return null};b.convertSquareUnitsToCode=function(w){if(null==w)return null;if("number"===typeof w)return w;switch(w.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109439;case "kilometers":case "kilometer":case "km":return 109414}return null};
b.defaultMaxRecords=1E3;b.equalityTest=function(w,f){return w===f?!0:(H(w)||O(w))&&(H(f)||O(f))?w.getTime()===f.getTime():!1};b.errback=function(w){return function(f){w.reject(f)}};b.esriFieldToJson=function(w){return w.toJSON?w.toJSON():w};b.extractServiceUrl=function(w){if(void 0===w)return"";w=w.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer");w=w.replace(/\/mapserver\/[0-9]*/i,"/MapServer");return w=w.split("?")[0]};b.isArcadeDate=O;b.isArcadeDateOnly=function(w){return w instanceof e.DateOnly};
b.isArcadeTime=function(w){return w instanceof B.TimeOnly};b.isArray=function(w){return Array.isArray(w)};b.isBoolean=function(w){return"boolean"===typeof w};b.isDate=H;b.isLuxonDate=function(w){return w instanceof m.DateTime};b.isNumber=function(w){return"number"===typeof w};b.isString=function(w){return"string"===typeof w||w instanceof String};b.isSupportedLayer=function(w){switch(w.type){case "catalog-footprint":case "subtype-sublayer":return!0;default:return t(w)}};b.isSupportedSourceLayer=t;
b.layerFieldEsriConstants={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger",long:"esriFieldTypeLong",single:"esriFieldTypeSingle",double:"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate","date-only":"esriFieldTypeDateOnly","time-only":"esriFieldTypeTimeOnly","timestamp-offset":"esriFieldTypeTimestampOffset",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",
xml:"esriFieldTypeXML","big-integer":"esriFieldTypeBigInteger",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeDateOnly:"esriFieldTypeDateOnly",esriFieldTypeTimeOnly:"esriFieldTypeTimeOnly",esriFieldTypeTimestampOffset:"esriFieldTypeTimestampOffset",
esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"esriFieldTypeXML",esriFieldTypeBigInteger:"esriFieldTypeBigInteger"};b.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",
esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"};b.layerGeometryEsriRestConstants={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",
envelope:"esriGeometryEnvelope"};b.sameGeomType=function(w,f){return w===f||"point"===w&&"esriGeometryPoint"===f||"polyline"===w&&"esriGeometryPolyline"===f||"polygon"===w&&"esriGeometryPolygon"===f||"extent"===w&&"esriGeometryEnvelope"===f||"multipoint"===w&&"esriGeometryMultipoint"===f||"point"===f&&"esriGeometryPoint"===w||"polyline"===f&&"esriGeometryPolyline"===w||"polygon"===f&&"esriGeometryPolygon"===w||"extent"===f&&"esriGeometryEnvelope"===w||"multipoint"===f&&"esriGeometryMultipoint"===
w?!0:!1};b.shapeExtent=function(w){if(null==w)return null;switch(w.type){case "polygon":case "multipoint":case "polyline":return w.extent;case "point":return new x({xmin:w.x,ymin:w.y,xmax:w.x,ymax:w.y,spatialReference:w.spatialReference});case "extent":return w}return null};b.stableStringify=function(w,f){f||={};"function"===typeof f&&(f={cmp:f});const r="boolean"===typeof f.cycles?f.cycles:!1,q=f.cmp&&function(A){return function(v){return function(z,u){return A({key:z,value:v[z]},{key:u,value:v[u]})}}}(f.cmp),
p=[];return function z(v){v?.toJSON&&"function"===typeof v.toJSON&&(v=v.toJSON());if(void 0!==v){if("number"===typeof v)return isFinite(v)?""+v:"null";if("object"!==typeof v)return JSON.stringify(v);var u;if(Array.isArray(v)){var y="[";for(u=0;u<v.length;u++)u&&(y+=","),y+=z(v[u])||"null";return y+"]"}if(null===v)return"null";if(p.includes(v)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var L=p.push(v)-1,l=Object.keys(v).sort(q?.(v));y="";
for(u=0;u<l.length;u++){const c=l[u],a=z(v[c]);a&&(y&&(y+=","),y+=JSON.stringify(c)+":"+a)}p.splice(L,1);return"{"+y+"}"}}(w)};b.toEsriGeometryType=function(w){switch(w){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string",
"../core/sql/UnknownTimeZone","../chunks/datetime"],function(b,k,e,B){function x(t,w,f){return t<w?t-w:t>f?t-f:0}function F(t,w=!0){if(t instanceof B.Zone)return t;if("system"===t.toLowerCase())return"system";if("utc"===t.toLowerCase())return"UTC";if("unknown"===t.toLowerCase())return e.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const f=B.FixedOffsetZone.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(f)return f}t=B.IANAZone.create(t);if(!t.isValid){if(w)throw new H(b.ArcadeDateErrorCodes.TimeZoneNotRecognized);
return null}return t}b.ArcadeDateErrorCodes=void 0;(b.ArcadeDateErrorCodes||(b.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const m={[b.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class H extends Error{constructor(t,w){super(k.replace(m[t],w));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,H)}}class O{constructor(t){this._date=t;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(t=
0,w=1,f=1,r=0,q=0,p=0,A=0,v){if(isNaN(t)||isNaN(w)||isNaN(f)||isNaN(r)||isNaN(q)||isNaN(p)||isNaN(A))return null;const z=B.DateTime.local(t,w).daysInMonth;t=B.DateTime.fromObject({day:1>f?1:f>z?z:f,year:t,month:1>w?1:12<w?12:w,hour:0>r?0:23<r?23:r,minute:0>q?0:59<q?59:q,second:0>p?0:59<p?59:p,millisecond:0>A?0:999<A?999:A},{zone:F(v)});t=t.plus({months:x(w,1,12),days:x(f,1,z),hours:x(r,0,23),minutes:x(q,0,59),seconds:x(p,0,59),milliseconds:x(A,0,999)});return new O(t)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??
"system"}static arcadeDateAndZoneToArcadeDate(t,w){w=F(w);return t.isUnknownTimeZone||w===e.UnknownTimeZone.instance?O.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,w):new O(t._date.setZone(w))}static dateJSToArcadeDate(t){return new O(B.DateTime.fromJSDate(t,{zone:"system"}))}static dateJSAndZoneToArcadeDate(t,w="system"){w=F(w);return new O(B.DateTime.fromJSDate(t,{zone:w}))}static unknownEpochToArcadeDate(t){return new O(B.DateTime.fromMillis(t,{zone:e.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(t){return new O(B.DateTime.fromMillis(t.getTime(),
{zone:e.UnknownTimeZone.instance}))}static epochToArcadeDate(t,w="system"){w=F(w);return new O(B.DateTime.fromMillis(t,{zone:w}))}static dateTimeToArcadeDate(t){return new O(t)}clone(){return new O(this._date)}changeTimeZone(t){t=F(t);return O.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(t,w){w=F(w);return t.zone===e.UnknownTimeZone.instance||w===e.UnknownTimeZone.instance?O.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,w):new O(t.setZone(w))}static nowToArcadeDate(t){t=
F(t);return new O(B.DateTime.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new O(B.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===O.systemTimeZoneCanonicalName}equals(t){return this.isSystem&&t.isSystem?this.toNumber()===t.toNumber():this.isUnknownTimeZone!==t.isUnknownTimeZone?!1:this._date.equals(t._date)}get isUnknownTimeZone(){return this._date.zone===e.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let t=
this._date.weekday;6<t&&(t=0);return t}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const t=this.zone;return"fixed"===t.type?0===t.fixed?"UTC":t.formatOffset(0,"short"):t.name}stringify(){return JSON.stringify(this.toJSDate())}plus(t){return new O(this._date.plus(t))}diff(t,w="milliseconds"){return this._date.diff(t._date,w)[w]}toISODate(){return this._date.toISODate()}toISOString(t){return t?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(t,w){return this._date.toISOTime({suppressMilliseconds:t,
includeOffset:w&&!this.isUnknownTimeZone})}toFormat(t,w){this.isUnknownTimeZone&&(t=t.replaceAll("Z",""));return this._date.toFormat(t,w)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new O(this._date.toUTC())}toLocal(){return new O(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(t){if(!t)return null;
t=B.DateTime.fromISO(t,{setZone:!0});return new O(t)}}b.ArcadeDate=O;b.ArcadeDateError=H;b.arcadeDateErrorMessages=m;b.createDateTimeZone=F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(b,k,e,B){function x(m){m=m.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let H="";const O=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;
for(const t of m.match(O)||[])switch(t){case "D":H+="d";break;case "DD":H+="dd";break;case "DDD":H+="o";break;case "d":H+="c";break;case "ddd":H+="ccc";break;case "dddd":H+="cccc";break;case "M":H+="L";break;case "MM":H+="LL";break;case "MMM":H+="LLL";break;case "MMMM":H+="LLLL";break;case "YY":H+="yy";break;case "Y":case "YYYY":H+="yyyy";break;case "Q":H+="q";break;case "X":case "x":H+=t;break;default:H=2<=t.length&&"["===t.slice(0,1)&&"]"===t.slice(-1)?H+`'${t.slice(1,-1)}'`:H+`'${t}'`}return H}
class F{constructor(m,H,O){this._year=m;this._month=H;this._day=O;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(m){return m instanceof F&&m.day===this.day&&m.month===this.month&&m.year===this.year}clone(){return new F(this._year,this._month,this._day)}toDateTime(m){return B.DateTime.fromObject({day:this.day,month:this.month,
year:this.year},{zone:k.createDateTimeZone(m)})}toDateTimeLuxon(m){return B.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:k.createDateTimeZone(m)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(m=null,H=!0){if(null===m||""===m)return this.toString();H&&(m=x(m));if(!m)return"";H=this.toDateTime("unknown");return k.ArcadeDate.dateTimeToArcadeDate(H).toFormat(m,{locale:e.getLocale(),
numberingSystem:"latn"})}toArcadeDate(){const m=this.toDateTime("unknown");return k.ArcadeDate.dateTimeToArcadeDate(m)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(m,H){return F.fromDateTime(this.toUTCDateTime().plus({[m]:H}))}toUTCDateTime(){return B.DateTime.utc(this.year,
this.month,this.day,0,0,0,0)}difference(m,H){switch(H.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(m.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(m.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===H?this.toUTCDateTime().diff(m.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(m.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(m.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(m.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(m.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(m.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(m.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(m){m=B.DateTime.fromMillis(m,{zone:B.FixedOffsetZone.utcInstance});
return m.isValid?F.fromParts(m.year,m.month,m.day):null}static fromSeconds(m){m=B.DateTime.fromSeconds(m,{zone:B.FixedOffsetZone.utcInstance});return m.isValid?F.fromParts(m.year,m.month,m.day):null}static fromReader(m){if(!m)return null;m=m.split("-");return 3!==m.length?null:new F(parseInt(m[0],10),parseInt(m[1],10),parseInt(m[2],10))}static fromParts(m,H,O){m=new F(m,H,O);return!1===m.isValid?null:m}static fromDateJS(m){return F.fromParts(m.getFullYear(),m.getMonth()+1,m.getDay())}static fromDateTime(m){return F.fromParts(m.year,
m.month,m.day)}static fromSqlTimeStampOffset(m){return this.fromDateTime(m.toDateTime())}static fromString(m,H=null){if(""===m||null===m)return null;var O=[];if(H)(H=x(H))&&O.push(H);else if(null===H||""===H)return m=B.DateTime.fromISO(m,{setZone:!0}),m.isValid?F.fromParts(m.year,m.month,m.day):null;for(const t of O)if(O=B.DateTime.fromFormat(m,H??t),O.isValid)return new F(O.year,O.month,O.day);return null}static fromNow(m="system"){m=B.DateTime.fromJSDate(new Date).setZone(k.createDateTimeZone(m));
return new F(m.year,m.month,m.day)}}b.DateOnly=F;b.standardizeDateOnlyFormat=x;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(b,k,e,B){function x(m){if(!m)return"";const H=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let O="";for(const t of m.match(H)||[])switch(t){case "SSS":O+=t;break;case "A":case "a":O+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":O+=
t;break;default:O+=`'${t}'`}return O}class F{constructor(m,H,O,t){this._hour=m;this._minute=H;this._second=O;this._millisecond=t;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(m){return m instanceof F&&m.hour===this.hour&&m.minute===this.minute&&m.second===this.second&&m.millisecond===this.millisecond}clone(){return new F(this.hour,this.minute,this.second,
this.millisecond)}isValid(){return k.isInteger(this.hour)&&k.isInteger(this.minute)&&k.isInteger(this.second)&&k.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,
"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(m=null){return null===m||""===m?this.toString():(m=x(m))?B.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(m,{locale:e.getLocale(),numberingSystem:"latn"}):
""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(m,H,O,t){m=new F(m,H,O,t);return m.isValid()?m:null}static fromReader(m){if(!m)return null;m=m.split(":");return 3!==m.length?null:new F(parseInt(m[0],10),parseInt(m[1],10),parseInt(m[2],10),0)}static fromMilliseconds(m){return 864E5<m||0>m?null:new F(Math.floor(m/36E5%24),Math.floor(m/6E4%60),Math.floor(m/1E3%60),Math.floor(m%1E3))}static fromDateJS(m){return new F(m.getHours(),m.getMinutes(),m.getSeconds(),
m.getMilliseconds())}static fromDateTime(m){return new F(m.hour,m.minute,m.second,m.millisecond)}static fromSqlTimeStampOffset(m){return this.fromDateTime(m.toDateTime())}static fromString(m,H=null){if(""===m||null===m)return null;const O=[];if(H)(H=x(H))&&O.push(H);else if(null===H||""===H)O.push("HH:mm:ss"),O.push("HH:mm:ss.SSS"),O.push("hh:mm:ss a"),O.push("hh:mm:ss.SSS a"),O.push("HH:mm"),O.push("hh:mm a"),O.push("H:mm"),O.push("h:mm a"),O.push("H:mm:ss"),O.push("h:mm:ss a"),O.push("H:mm:ss.SSS"),
O.push("h:mm:ss.SSS a");for(const t of O)if(H=B.DateTime.fromFormat(m,t),H.isValid)return new F(H.hour,H.minute,H.second,H.millisecond);return null}plus(m,H){switch(m){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return F.fromDateTime(this.toUTCDateTime().plus({[m]:H}))}return null}toUTCDateTime(){return B.DateTime.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(m,H){switch(H.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(m.toUTCDateTime(),
"days").days;case "months":case "month":return this.toUTCDateTime().diff(m.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===H?this.toUTCDateTime().diff(m.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(m.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(m.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(m.toUTCDateTime(),"milliseconds").milliseconds;
case "hours":case "hour":case "h":return this.toUTCDateTime().diff(m.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(m.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(m.toUTCDateTime(),"milliseconds").milliseconds}}}b.TimeOnly=F;b.standardizeTimeFormat=x;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(b,k){b.cloneGeometry=function(e){if(null==
e)return null;const B=e.clone();void 0!==e.cache._geVersion&&(B.cache._geVersion=e.cache._geVersion);return B};b.convertLinearUnitsToCode=function(e){if(null==e)return null;if("number"===typeof e)return e;e=e.toLowerCase();e=e.replaceAll(/\s/g,"");e=e.replaceAll("-","");switch(e){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};b.convertSquareUnitsToCode=function(e){if(null==e)return null;if("number"===typeof e)return e;e=e.toLowerCase();e=e.replaceAll(/\s/g,"");e=e.replaceAll("-","");switch(e){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;
case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};
b.isInteger=function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e};b.sameGeomType=function(e,B){return e===B||"point"===e&&"esriGeometryPoint"===B||"polyline"===e&&"esriGeometryPolyline"===B||"polygon"===e&&"esriGeometryPolygon"===B||"extent"===e&&"esriGeometryEnvelope"===B||"multipoint"===e&&"esriGeometryMultipoint"===B||"point"===B&&"esriGeometryPoint"===e||"polyline"===B&&"esriGeometryPolyline"===e||"polygon"===B&&"esriGeometryPolygon"===e||"extent"===B&&"esriGeometryEnvelope"===
e||"multipoint"===B&&"esriGeometryMultipoint"===e?!0:!1};b.shapeExtent=function(e){if(null==e)return null;switch(e.type){case "polygon":case "multipoint":case "polyline":return e.extent;case "point":return new k({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case "extent":return e}return null};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y){var L;const l={title:!0,description:!0};e=L=class extends f{constructor(c,a){super(c,a);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([d])=>{d?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.flowItems=null;this.flowType="feature-relationship";this.headingLevel=2;this.viewModel=new r;this.messagesCommon=this.messages=null;this.visibleElements=
{...l};this._increaseFeaturePage=()=>{const {state:d,showAllEnabled:n,relatedFeatures:D,featuresPerPage:J,featurePage:K}=this.viewModel;"ready"===d&&n&&D.length>=J*K&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new q;this.addHandles([F.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),F.initial),F.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),
F.on(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return p.loadCalciteComponents({icon:()=>new Promise((c,a)=>b(["../../chunks/calcite-icon"],c,a)),list:()=>new Promise((c,a)=>b(["../../chunks/calcite-list"],c,a)),"list-item":()=>new Promise((c,a)=>b(["../../chunks/calcite-list-item"],c,a)),loader:()=>new Promise((c,a)=>b(["../../chunks/calcite-loader"],c,a)),notice:()=>new Promise((c,a)=>b(["../../chunks/calcite-notice"],c,a))})}destroy(){this._unobserveRelatedFeatureObserver();
this._featureElementInfo=B.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:c,featureCount:a,displayCount:d,state:n}=this.viewModel;return!c&&!!a&&"ready"===n&&(a>d||0===d)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(c){this.viewModel.description=c}get featureCountDescription(){const {messages:c}=this,{featureCount:a}=this.viewModel;
return y.substitute(c?.numberRecords,{number:a})}get title(){return this.viewModel.title}set title(c){this.viewModel.title=c}castVisibleElements(c){return{...l,...c}}render(){const {state:c}=this.viewModel;return u.tsx("div",{class:this.classes("esri-feature-relationship",A.globalCss.widget)},this._featureElementInfo?.render(),"loading"===c?this._renderLoading():"disabled"===c?this._renderRelationshipNotFound():this._renderRelatedFeatures())}async _selectRecord(c){const {flowItems:a,featureVisibleElements:d}=
this;if(a){c.abilities={relationshipContent:!0};var {default:n}=await new Promise((D,J)=>b(["../Feature"],K=>D(Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}))),J));a.push(new n({flowItems:a,flowType:this.flowType,viewModel:c,visibleElements:d}))}}_showAllRecords(){const {flowItems:c}=this;if(c){var {viewModel:a,featureVisibleElements:d}=this;a.showAllEnabled=!0;var n=new L({flowItems:c,featureVisibleElements:d,visibleElements:{title:!1,description:!1},
viewModel:a});c.push(n)}}_renderStickyLoading(){return"querying"===this.viewModel.state?u.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return u.tsx("calcite-loader",{inline:!0,label:""})}_renderLoading(){return u.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return u.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const c=
v.isRTL(this.container)?"chevron-left":"chevron-right";return u.tsx("calcite-icon",{icon:c,scale:"s",slot:"content-end"})}_renderRelatedFeature(c){const {itemDescriptionFieldName:a}=this.viewModel,d=c.title;c.description=a&&c.formattedAttributes?.global[a];return u.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===c.state}),description:c.description??"",key:c.uid,label:d,onCalciteListItemSelect:()=>this._selectRecord(c)},
this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?u.tsx("calcite-list-item",{description:this.featureCountDescription,key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this._showAllRecords()},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return u.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},u.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return u.tsx("div",
{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:c}=this.viewModel;return u.tsx("calcite-list",null,c.toArray().map(a=>this._renderRelatedFeature(a)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:c}=this,{state:a}=this.viewModel;return u.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===
a}),key:"list-container"},c?this._renderList():"ready"===a?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return u.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},u.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:c}=this.viewModel;this.removeHandles("related-feature-viewmodels");
c?.forEach(a=>{this.addHandles(F.watch(()=>[a.title,a.state],()=>this.scheduleRender(),F.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:c,visibleElements:a}=this,d=a.description&&this.description,n=a.title&&this.title;this._featureElementInfo?.set({description:d,title:n,headingLevel:c})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:c,showAllEnabled:a}=this.viewModel;await x.after(0);this._relatedFeatureIntersectionObserverNode&&
"ready"===c&&a&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(c){this._relatedFeatureIntersectionObserverNode=c}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};k.__decorate([m.property()],e.prototype,"_relatedFeatureIntersectionObserverNode",void 0);k.__decorate([m.property({readOnly:!0})],
e.prototype,"displayShowAllButton",null);k.__decorate([m.property({readOnly:!0})],e.prototype,"displayListItems",null);k.__decorate([m.property()],e.prototype,"description",null);k.__decorate([m.property({readOnly:!0})],e.prototype,"featureCountDescription",null);k.__decorate([m.property()],e.prototype,"featureVisibleElements",void 0);k.__decorate([m.property()],e.prototype,"flowItems",void 0);k.__decorate([m.property()],e.prototype,"flowType",void 0);k.__decorate([m.property()],e.prototype,"headingLevel",
void 0);k.__decorate([m.property()],e.prototype,"title",null);k.__decorate([m.property({type:r})],e.prototype,"viewModel",void 0);k.__decorate([m.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);k.__decorate([m.property(),z.messageBundle("esri/t9n/common")],e.prototype,"messagesCommon",void 0);k.__decorate([m.property()],e.prototype,"visibleElements",void 0);k.__decorate([H.cast("visibleElements")],e.prototype,"castVisibleElements",null);return e=L=k.__decorate([w.subclass("esri.widgets.Feature.FeatureRelationship")],
e)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A){e=class extends x.ClonableMixin(m.IdentifiableMixin(e)){constructor(v){super(v);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:z}=this;z&&z.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:z}=this;z&&z.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:z}=this;z&&z.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const z=new AbortController;this._queryAbortController=z;await H.ignoreAbortErrors(this._query());this._queryAbortController===z&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const z=new AbortController;this._queryFeatureCountAbortController=z;await H.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===z&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const z=new AbortController;this._queryPageAbortController=z;await H.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===z&&(this._queryPageAbortController=null)};
this._queryDebounced=H.debounce(this._queryController,100);this._queryFeatureCountDebounced=H.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=H.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:z,relatedFeatures:u}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,u.destroyAll(),this.destroyed||u.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:z?.signal}))))};this.addHandles([O.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),O.initial),O.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),O.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.destroyAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(v){const {featuresPerPage:z,featureCount:u}=this;this._set("featurePage",Math.min(Math.max(v,1),Math.ceil(u/z)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:v,relatedLayer:z}=this;return v&&z?.loaded?v.map(u=>{const y=u.clone();y.field=p.getFixedFieldName(u.field,z);return y}):v??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
null!=this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const v=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&null!=this.relationshipId&&null!=this.objectId&&!!v?.supportsCount&&!!v?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(v){this._set("displayCount",Math.min(Math.max(v,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new F}get relatedLayer(){const {layer:v,map:z,relationship:u}=this;return v?.loaded&&z&&u?p.findRelatedLayer(z,v,u)??null:null}get relationship(){const {relationshipId:v,layer:z}=this;return null!=v?z?.relationships?.find(({id:u})=>u===v)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new F}get state(){const {_queryAbortController:v,
_queryFeatureCountAbortController:z,_queryPageAbortController:u,canQuery:y,_loaded:L,canLoad:l}=this;return z||l&&!L?"loading":v||u?"querying":y?"ready":"disabled"}getRelatedFeatureByObjectId(v){return this.relatedFeatures.find(z=>z.getObjectId()===v)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.destroyAll()}async _queryFeatureCount(){const {layer:v,relatedLayer:z,relationshipId:u,objectId:y,_queryFeatureCountAbortController:L,canQuery:l,
supportsCacheHint:c}=this;await v?.load();await z?.load();if(l&&v&&z&&null!=y){var a=z.createQuery(),{historicMoment:d,gdbVersion:n}=v;a=new q({cacheHint:c,gdbVersion:n,historicMoment:d,relationshipId:u,returnGeometry:!1,objectIds:[y],where:a.where??void 0});a=await v.queryRelatedFeaturesCount(a,{signal:L?.signal});this._set("featureCount",a[y]||0)}else this._set("featureCount",0)}_sliceFeatures(v){const {showAllEnabled:z,displayCount:u}=this;return z?v:u?v.slice(0,u):[]}async _queryPage(){const {relatedFeatures:v,
featurePage:z,showAllEnabled:u,_queryPageAbortController:y,featureCount:L}=this;!u||2>z||!L||v.addMany(await this._queryRelatedFeatures({signal:y?.signal}))}async _queryRelatedFeatures(v){const {orderByFieldsFixedCasing:z,showAllEnabled:u,featuresPerPage:y,displayCount:L,layer:l,relationshipId:c,featurePage:a,featureCount:d,relatedLayer:n,supportsCacheHint:D}=this,{canQuery:J,objectId:K}=this;if(!J||!l||!n||null==K)return[];var N=u?((a-1)*y+d)%d:0;const G=u?y:L;var Q=n.objectIdField;Q=[...z.map(E=>
E.field),...A.getFieldsInTitleAndDesc(n),Q].filter(B.isSome);const h=z.map(E=>`${E.field} ${E.order}`),C=n.createQuery(),{historicMoment:I,gdbVersion:g}=l;N=new q({orderByFields:h,start:N,num:G,outFields:Q,cacheHint:D,historicMoment:I,gdbVersion:g,relationshipId:c,returnGeometry:!1,objectIds:[K],where:C.where??void 0});v=(await l.queryRelatedFeatures(N,{signal:v?.signal}))[K]?.features||[];v.forEach(E=>{E.sourceLayer=n;E.layer=n});return v}};b.__decorate([t.property()],e.prototype,"_loaded",void 0);
b.__decorate([t.property()],e.prototype,"_queryAbortController",void 0);b.__decorate([t.property()],e.prototype,"_queryPageAbortController",void 0);b.__decorate([t.property()],e.prototype,"_queryFeatureCountAbortController",void 0);b.__decorate([t.property({value:1})],e.prototype,"featurePage",null);b.__decorate([t.property()],e.prototype,"featuresPerPage",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"orderByFieldsFixedCasing",null);b.__decorate([t.property({readOnly:!0})],e.prototype,
"supportsCacheHint",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"canLoad",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"canQuery",null);b.__decorate([t.property()],e.prototype,"description",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"itemDescriptionFieldName",null);b.__decorate([t.property({value:3})],e.prototype,"displayCount",null);b.__decorate([t.property({type:k})],e.prototype,"graphic",void 0);b.__decorate([t.property()],e.prototype,"layer",void 0);
b.__decorate([t.property()],e.prototype,"map",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"objectId",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"objectIdField",null);b.__decorate([t.property()],e.prototype,"orderByFields",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"relatedFeatures",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"relatedLayer",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"relationship",null);b.__decorate([t.property()],
e.prototype,"featureCount",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"relatedFeatureViewModels",null);b.__decorate([t.property()],e.prototype,"relationshipId",void 0);b.__decorate([t.property()],e.prototype,"showAllEnabled",void 0);b.__decorate([t.property()],e.prototype,"state",null);b.__decorate([t.property()],e.prototype,"title",void 0);return e=b.__decorate([r.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],e)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/lang ../../core/Logger ../../core/string ../../form/support/formUtils ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../layers/support/layerUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q){function p(d){const {fields:n,values:D}=d,J=d.timeZone??void 0;d=n.map((K,N)=>{let G=D[N];K.domain&&"coded-value"===K.domain.type&&(N=K.domain.codedValues.find(Q=>Q.code===G),N?.name&&(G=N.name));if(f.isAnyDateField(K)||t.isTimeOnlyField(K))G=r.getLabelForDateFieldValue(K,G,{timeZone:J,...r.getIntlOptionsForField(K)});return[K.name,G]});return Object.fromEntries(d)}function A(d,n){return m.replace(m.replace(d,D=>`{${D.toLowerCase()}}`),Object.fromEntries(Object.entries(n).map(([D,
J])=>[D.toLowerCase(),J])))}function v(d){return 1E7<=d||-1E7>=d}function z(d,{validationErrors:n}){return null!=d.max&&null!=d.min?n.outsideRange:null!=d.max?n.outsideRangeMax:n.outsideRangeMin}const u=d=>"field"===d?.type,y=d=>"relationship"===d?.type,L=d=>d.reduce((n,D)=>"group"===D?.type?[...n,...D.inputs]:[...n,D],[]),l=(d,n)=>null!=d&&d.input?.type===n;b.LengthValidationError=void 0;(function(d){d.TOO_SHORT="length-validation-error::too-short";d.TOO_LONG="length-validation-error::too-long"})(b.LengthValidationError||
(b.LengthValidationError={}));const c={type:"number"},a={type:"number",intlOptions:{notation:"scientific"}};b.extractExpressionNameFromString=function(d){const [n,D]=d.split("expression/");return""===n&&D?D:(F.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${d} is not a valid expression reference of the form '${"expression/"}/expressionName'`),"")};b.flattenFieldInputs=d=>L(d).filter(u);b.flattenInputs=L;b.flattenRelationshipInputs=
d=>L(d).filter(y);b.formTemplateHasInvalidFields=function(d,n){return(n=n??("formTemplate"in d&&d.formTemplate))?(n.elements?.filter(H.isFieldElement)??[]).some(({fieldName:D})=>!d.fieldsIndex.get(D)):!1};b.getComputedAttributes=p;b.getErrorMessageForFieldInput=(d,n,D)=>{const {dataType:J,error:K,minLength:N,value:G,required:Q}=d,h=n?.validationErrors;if(!h||!K)return null;if(Q&&null===G)return h.cannotBeNull;if(K===O.DomainValidationError.VALUE_OUT_OF_RANGE||K===t.NumericRangeValidationError.OUT_OF_RANGE){const {field:C,
range:I}=d;d={type:"date",intlOptions:{timeZone:"date"===C.type&&D?D:void 0,...r.getIntlOptionsForField(C)}};n=z(I,n);return q.substitute(n,I,{format:{max:"date"===J?d:null!=I.max&&v(I.max)?a:c,min:"date"===J?d:null!=I.min&&v(I.min)?a:c}})}return K===O.DomainValidationError.INVALID_CODED_VALUE?h.invalidCodedValue:K===t.TypeValidationError.INVALID_TYPE?h.invalidType:K===b.LengthValidationError.TOO_SHORT?q.substitute(h.tooShort,{min:N}):null};b.getFieldsInTitleAndDesc=d=>{const n=[];if(d.formTemplate){const {description:D,
title:J}=d.formTemplate;d.fields?.forEach(K=>{const N=J&&m.templateHasKey(J,K.name),G=D&&m.templateHasKey(D,K.name);(N||G)&&n.push(K.name)})}return n};b.getIconForFeature=d=>{if(d){var n=d.layer;n=n&&"geometryType"in n?n.geometryType:void 0;d=d.geometry?.type;return"polyline"===d||"polyline"===n?"line":"mesh"===d||"mesh"===n||"multipatch"===n?"cube":"multipoint"===d||"multipoint"===n?"point":d||n||"table"}};b.getNormalizedFeatureTypeInfo=d=>{const n={typeFieldName:null,types:[]};if(!d)return n;"subtype-sublayer"===
d.type?(n.typeFieldName=d.parent?.subtypeField,n.types=d.parent?.subtypes??[]):"subtype-group"===d.type||"feature"===d.type&&d.subtypes?.length?(n.typeFieldName=d.subtypeField,n.types=d.subtypes??[]):"types"in d&&d.types&&(n.typeFieldName=d.typeIdField,n.types=d.types.map(({id:D,name:J,domains:K})=>({code:D,name:J,domains:K})));null!=n.typeFieldName&&(n.typeFieldName=d.getField(n.typeFieldName)?.name??n.typeFieldName);return n};b.isExpressionReference=function(d){return d.startsWith("expression/")};
b.isFieldElementWithInputType=l;b.isFieldElementWithShowNoValueOptionInput=d=>null!=d&&(l(d,"combo-box")||l(d,"radio-buttons"));b.isFieldElementWithTextInput=d=>null!=d&&(l(d,"text-box")||l(d,"text-area"));b.isFieldInput=u;b.isGroupInput=d=>"group"===d?.type;b.isInputInGroupInput=d=>"group"!==d?.type&&null!=d.group;b.isLegacyFieldMapsExpressionReference=function(d){return d.startsWith("expr/")};b.isNumberFieldInput=({domain:d,inputType:n="text-box",dataType:D})=>"number"===D&&"text-box"===n&&(!d||
"coded-value"!==d.type);b.isRelationshipInput=y;b.isTextElementInput=d=>"text"===d.type;b.parseFormTemplateString=function(d){const {attributes:n,fieldsIndex:D,label:J,timeZone:K}=d;if(!n||"object"!==typeof n)return J;var N=Object.keys(n).filter(G=>m.templateHasKey(J,G));d=N.map(G=>n[G]);N=N.map(G=>D.get(G)).filter(e.isSome);return A(J,p({values:d,fields:N,timeZone:K}))};b.prependExpressionPrefix=function(d){return`${"expression/"}${d}`};b.prependFieldPrefix=function(d){return`${"field/"}${d}`};b.substituteFieldTemplatesInString=
A;b.subtypeChangeShouldPrompt=function(d,n,D){var J=w.getSubtypesFromLayer(d);d=J?.find(K=>K.code===D);if(!d)return!1;J=J?.find(K=>K.code===n);return x.equalsShallow(d.defaultValues,J?.defaultValues)?!1:Object.values(d.defaultValues).some(K=>null!=K)};b.valueIsInvalidSwitchValue=function(d,n){return null==d||n.onValue!==d&&n.offValue!==d};b.valueIsValidContingentValue=function(d,n){switch(n.objectType){case "any":return!0;case "null":return null==d;case "code":return d===n.codedValue?.code;case "range":return null!=
d&&null!=n.minValue&&null!=n.maxValue&&+d>=n.minValue&&+d<=n.maxValue;default:return B.neverReached(n.objectType),!1}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations":function(){define("require ../../chunks/tslib.es6 ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureUtilityNetworkAssociationType ./FeatureUtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel ./FeatureUtilityNetworkAssociations/VisibleElements ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u){F=class extends t{constructor(y,L){super(y,L);this._featureElementInfo=null;this.flowType="feature-utility-network-associations";this.parentFeatureViewModel=this.flowItems=null;this.headingLevel=2;this.viewModel=new f;this.messagesCommon=this.messages=null;this.visibleElements=new r}initialize(){this._featureElementInfo=new q;this.addHandles([B.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),
B.initial)])}loadDependencies(){return p.loadCalciteComponents({chip:()=>new Promise((y,L)=>b(["../../chunks/calcite-chip"],y,L)),icon:()=>new Promise((y,L)=>b(["../../chunks/calcite-icon"],y,L)),loader:()=>new Promise((y,L)=>b(["../../chunks/calcite-loader"],y,L)),notice:()=>new Promise((y,L)=>b(["../../chunks/calcite-notice"],y,L)),list:()=>new Promise((y,L)=>b(["../../chunks/calcite-list"],y,L)),"list-item":()=>new Promise((y,L)=>b(["../../chunks/calcite-list-item"],y,L))})}destroy(){this._featureElementInfo=
e.destroyMaybe(this._featureElementInfo)}get description(){return this.viewModel.description}set description(y){this.viewModel.description=y}get title(){return this.viewModel.title}set title(y){this.viewModel.title=y}render(){const {state:y}=this.viewModel;return u.tsx("div",{class:this.classes("esri-feature-relationship",A.globalCss.widget)},this._featureElementInfo?.render(),"loading"===y?this._renderLoading():"disabled"===y?this._renderAssociationNotFound():this._renderContent())}_renderStickyLoading(){return"querying"===
this.viewModel.state?u.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return u.tsx("calcite-loader",{inline:!0,label:""})}_renderLoading(){return u.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderAssociationNotFound(){return u.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"association-not-found",kind:"danger",open:!0,scale:"s",width:"full"},
u.tsx("div",{slot:"message"},this.messages?.noAssociations))}_setupFeatureElementInfo(){const {headingLevel:y,visibleElements:L}=this,l=L.description&&this.description,c=L.title&&this.title;this._featureElementInfo?.set({description:l,title:c,headingLevel:y})}_getAssociationTypeTitle(y){const {messages:L}=this;if(y.title)return y.title;switch(y.type){case "attachment":return L.associationsAttachments;case "connectivity":return L.associationsConnectivity;case "structure":return L.associationsStructure;
case "content":return L.associationsContents;case "container":return L.associationsContainer}}_selectAssociationType(y){const {viewModel:L,flowItems:l,parentFeatureViewModel:c}=this;if(l){var {associationTypes:a}=L;a.forEach(d=>{d.open=d.type===y.type?!0:!1});a=new w({viewModel:L,parentFeatureViewModel:c,listType:y,title:this._getAssociationTypeTitle(y),featureVisibleElements:this.featureVisibleElements,description:this.parentFeatureViewModel?.title,flowItems:l});l.push(a)}}_renderAssociationType(y){const L=
this._getAssociationTypeTitle(y);return u.tsx("calcite-list-item",{description:y.description,key:`association-type-${y.type}`,label:L,value:y.type,onCalciteListItemSelect:()=>this._selectAssociationType(y)},u.tsx("calcite-chip",{scale:"s",slot:"content-end",value:y.type},this._getFeatureCount(y.type)),u.tsx("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_getFeatureCount(y){switch(y){case "attachment":return this.viewModel.attachmentsFeatureCount;case "structure":return this.viewModel.structureFeatureCount;
case "content":return this.viewModel.contentFeatureCount;case "container":return this.viewModel.containerFeatureCount;case "connectivity":return this.viewModel.connectivityFeatureCount}}_renderAssociations(y){return u.tsx("div",null,0<this._getFeatureCount(y.type)?this._renderAssociationType(y):null)}_renderContent(){const {state:y,associationTypes:L}=this.viewModel;return u.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===
y}),key:"list-container"},"ready"===y?u.tsx("calcite-list",null,L.map(l=>this._renderAssociations(l))):null,this._renderStickyLoading())}};k.__decorate([x.property()],F.prototype,"flowType",void 0);k.__decorate([x.property()],F.prototype,"flowItems",void 0);k.__decorate([x.property()],F.prototype,"parentFeatureViewModel",void 0);k.__decorate([x.property()],F.prototype,"featureVisibleElements",void 0);k.__decorate([x.property()],F.prototype,"description",null);k.__decorate([x.property()],F.prototype,
"headingLevel",void 0);k.__decorate([x.property()],F.prototype,"title",null);k.__decorate([x.property({type:f})],F.prototype,"viewModel",void 0);k.__decorate([x.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],F.prototype,"messages",void 0);k.__decorate([x.property(),z.messageBundle("esri/t9n/common")],F.prototype,"messagesCommon",void 0);k.__decorate([x.property({type:r,nonNullable:!0})],F.prototype,"visibleElements",void 0);return F=k.__decorate([O.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations")],
F)})},"esri/widgets/Feature/FeatureUtilityNetworkAssociationType":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/promiseUtils ../../core/ReactiveMap ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../intl/number ../../support/popupUtils ../Widget ./FeatureUtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel ./FeatureUtilityNetworkAssociations/VisibleElements ../../chunks/componentsUtils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l){var c;e=c=class extends q{constructor(a,d){super(a,d);this.flowType="feature-utility-network-association-type";this.description=null;this.headingLevel=2;this.title=null;this.viewModel=new p;this.messagesCommon=this.messages=this.flowItems=this.selectedLayer=this.listType=this.parentFeatureViewModel=null;this.visibleElements=new A;this._featuresPerPage=50;this._maxNumFeatures=1E3;this._currentFeaturePage=1;this._previewDisplayCount=3;this._associatedFeatureIntersectionObserverNode=
null;this._associatedFeatureIntersectionObserver=new IntersectionObserver(([n])=>{n?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this._tooltipReferenceMap=new x;this._filterText=""}initialize(){this.addHandles([F.watch(()=>[this._associatedFeatureIntersectionObserverNode],()=>this._handleAssociatedFeatureObserverChange())])}loadDependencies(){return v.loadCalciteComponents({chip:()=>new Promise((a,d)=>b(["../../chunks/calcite-chip"],a,d)),icon:()=>new Promise((a,d)=>b(["../../chunks/calcite-icon"],
a,d)),input:()=>new Promise((a,d)=>b(["../../chunks/calcite-input"],a,d)),loader:()=>new Promise((a,d)=>b(["../../chunks/calcite-loader"],a,d)),list:()=>new Promise((a,d)=>b(["../../chunks/calcite-list"],a,d)),"list-item":()=>new Promise((a,d)=>b(["../../chunks/calcite-list-item"],a,d)),tooltip:()=>new Promise((a,d)=>b(["../../chunks/calcite-tooltip"],a,d))})}destroy(){this._tooltipReferenceMap.clear()}get _numAssociatedFeatures(){const a=this.viewModel.associationViewModels;return this.selectedLayer?
a.get(this.selectedLayer).length:0}set currentFeaturePage(a){const {_featuresPerPage:d,_numAssociatedFeatures:n}=this;this._currentFeaturePage=Math.max(Math.min(a,Math.ceil(n/d)||1),1)}get currentFeaturePage(){return this._currentFeaturePage}render(){const a=this.viewModel.associationViewModels,{state:d,showAllEnabled:n}=this.viewModel,{state:D}=this.parentFeatureViewModel??{};return L.tsx("div",{class:this.classes("esri-feature-relationship",z.globalCss.widget)},"loading"===d||"querying"===d||"loading"===
D?this._renderLoading():L.tsx("calcite-list",null,n&&this.selectedLayer?L.tsx(L.tsxFragment,null,this._renderFilter(),this._renderAssociatedFeatureListPage(),this._renderFeatureObserver()):Array.from(a.keys(),J=>this._renderTypeList(J,a.get(J)))))}_renderFilter(){return L.tsx("div",{class:"esri-feature__filter-container",key:"filter"},L.tsx("calcite-input",{icon:"search",placeholder:this.messages.associationFilterPlaceholder,type:"search",onCalciteInputInput:a=>{this._filterText=a.target.value.trim().toLowerCase();
this._currentFeaturePage=1}}))}_showAllAssociations(a){const {flowItems:d,viewModel:n,description:D}=this;d&&a&&(n.showAllEnabled=!0,a=new c({selectedLayer:a,title:a?.title,flowItems:d,parentFeatureViewModel:this.parentFeatureViewModel,featureVisibleElements:this.featureVisibleElements,description:D,visibleElements:{title:!1,description:!1},viewModel:n}),d.push(a))}_renderAssociatedFeatureListPage(){const {currentFeaturePage:a,_featuresPerPage:d,_maxNumFeatures:n,_filterText:D}=this;var J=Math.min(a*
d,n);J=this.viewModel.associationViewModels.get(this.selectedLayer).filter(K=>r.getFeaturePopupTitle(K.featureViewModel).toLowerCase().includes(D)).slice(0,J);return[...this._renderTooltips(J),...this._renderAssociatedFeatureList(J)]}async _handleAssociatedFeatureObserverChange(){this._associatedFeatureIntersectionObserverNode&&this._associatedFeatureIntersectionObserver.unobserve(this._associatedFeatureIntersectionObserverNode);const {state:a,showAllEnabled:d}=this.viewModel;await B.after(0);this._associatedFeatureIntersectionObserverNode&&
"ready"===a&&d&&this._associatedFeatureIntersectionObserver.observe(this._associatedFeatureIntersectionObserverNode)}_associatedFeatureIntersectionObserverCreated(a){this._associatedFeatureIntersectionObserverNode=a}_renderFeatureObserver(){return L.tsx("div",{afterCreate:this._associatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",key:"feature-observer"})}_increaseFeaturePage(){this.currentFeaturePage++}_renderLoading(){return L.tsx("div",{class:"esri-feature__loading-container",
key:"loading-container"},this._renderLoadingIcon())}_renderLoadingIcon(){return L.tsx("calcite-loader",{inline:!0,label:""})}isConnectivity(a){return["connectivity","junction-junction-connectivity","junction-edge-from-connectivity","junction-midspan-connectivity","junction-edge-to-connectivity"].includes(a.association.associationType)}_getConnectivityTooltip(a){switch(a){case "connectivity":case "junction-junction-connectivity":return this.messages.associationsJunctionJunction;case "junction-edge-from-connectivity":return this.messages.associationsJunctionEdgeFrom;
case "junction-midspan-connectivity":return this.messages.associationsJunctionEdgeMidspan;case "junction-edge-to-connectivity":return this.messages.associationsJunctionEdgeTo;default:return""}}_renderItemTooltip(a){const {_tooltipReferenceMap:d}=this;return this.isConnectivity(a)?L.tsx("calcite-tooltip",{key:`tooltip-${a.featureViewModel.uid}`,referenceElement:d.get(a.featureViewModel.uid)},this._getConnectivityTooltip(a.association.associationType)):null}_renderConnectivityIcon(a,d){switch(a){case "junction-edge-from-connectivity":a=
"connection-end-left";break;case "junction-edge-to-connectivity":a="connection-end-right";break;case "junction-midspan-connectivity":a="connection-middle";break;default:a="connection-to-connection"}return L.tsx("calcite-icon",{afterCreate:n=>this._tooltipReferenceMap.set(d,n),afterRemoved:()=>this._tooltipReferenceMap.delete(d),icon:a,scale:"s",slot:"content-start"})}_formatPercentAlong(a){return`${f.formatNumber(a.association.percentAlong,{style:"percent",maximumFractionDigits:2})}`}_renderAssociatedFeature(a){const {featureViewModel:d}=
a,n=r.getFeaturePopupTitle(d),D="loading"===d.state,J=this._findFlowItem(d),K=0>J&&this._isParentFeature(d),N=K||0<=J,G=this.isConnectivity(a),Q=G&&"junction-midspan-connectivity"===a.association.associationType;return L.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:D}),description:a.terminalName??"",key:`associated-feature-type-${d.uid}`,label:n,onCalciteListItemSelect:()=>this._handleFeatureClick(K,J,d)},G?this._renderConnectivityIcon(a.association.associationType,
a.featureViewModel.uid):null,Q?L.tsx("calcite-chip",{scale:"s",slot:"content-end",value:a.association.percentAlong},this._formatPercentAlong(a)):null,this._renderChevronIconNode(N))}async _selectAssociation(a){const {flowItems:d,featureVisibleElements:n}=this;if(d){a.abilities={utilityNetworkAssociationsContent:!0};var {default:D}=await new Promise((J,K)=>b(["../Feature"],N=>J(Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}))),K));d.push(new D({flowItems:d,
flowType:"feature-association",viewModel:a,visibleElements:n}))}}_handleFeatureClick(a,d,n){if(a)this.flowItems.drain(D=>{"showAllEnabled"in D.viewModel&&(D.viewModel.showAllEnabled=!1);D.viewModel=null;D.destroy()});else if(0>d||!this.flowItems)this._selectAssociation(n);else for(;this.flowItems.length>d+1;)if(a=this.flowItems.pop())"showAllEnabled"in a.viewModel&&(a.viewModel.showAllEnabled=!1),a.viewModel=null,a.destroy()}_featureViewModelMatch(a,d){a=a.graphic;var n=a?.layer,D=null;"subtype-sublayer"===
n?.type&&n.parent?D=n.parent.globalIdField??null:n&&"globalIdField"in n&&(D=n.globalIdField);a=D?a?.attributes[D]:null;d=d.graphic;n=d?.layer;D=null;"subtype-sublayer"===n?.type&&n.parent?D=n.parent.globalIdField??null:n&&"globalIdField"in n&&(D=n.globalIdField);d=D?d?.attributes[D]:null;return a&&d&&a===d}_isParentFeature(a){const d=this.flowItems?.getItemAt(0);return d?this._featureViewModelMatch(d.parentFeatureViewModel,a):!1}_findFlowItem(a){return this.flowItems?.findIndex(d=>"feature"!==d.flowType?
!1:this._featureViewModelMatch(d.viewModel,a))??-1}_renderTooltips(a){return a.toArray().map(d=>this._renderItemTooltip(d))}_renderAssociatedFeatureList(a){return a.toArray().map(d=>this._renderAssociatedFeature(d))}_renderChevronIconNode(a){return L.tsx("calcite-icon",{flipRtl:!0,icon:a?"move-up":"chevron-right",scale:"s",slot:"content-end"})}_renderTypeList(a,d){const {messages:n}=this,D=d.slice(0,this._previewDisplayCount),J=D.length<d.length;return L.tsx("calcite-list-item",{key:"show-all",label:a.title,
open:!0,value:a.id},L.tsx("calcite-chip",{scale:"s",slot:"actions-end",value:a.id},d.length),L.tsx("calcite-list",{group:a.id},[this._renderTooltips(D),this._renderAssociatedFeatureList(D)],J?L.tsx("calcite-list-item",{description:l.substitute(n?.numberRecords,{number:d.length.toString()}),key:"show-all-item",label:n.showAll,onCalciteListItemSelect:()=>this._showAllAssociations(a)},L.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})):null))}};k.__decorate([m.property()],e.prototype,"flowType",
void 0);k.__decorate([m.property()],e.prototype,"description",void 0);k.__decorate([m.property()],e.prototype,"headingLevel",void 0);k.__decorate([m.property()],e.prototype,"title",void 0);k.__decorate([m.property({type:p})],e.prototype,"viewModel",void 0);k.__decorate([m.property()],e.prototype,"parentFeatureViewModel",void 0);k.__decorate([m.property()],e.prototype,"listType",void 0);k.__decorate([m.property()],e.prototype,"selectedLayer",void 0);k.__decorate([m.property()],e.prototype,"featureVisibleElements",
void 0);k.__decorate([m.property()],e.prototype,"flowItems",void 0);k.__decorate([m.property(),y.messageBundle("esri/widgets/Feature/t9n/Feature")],e.prototype,"messages",void 0);k.__decorate([m.property(),y.messageBundle("esri/t9n/common")],e.prototype,"messagesCommon",void 0);k.__decorate([m.property({type:A,nonNullable:!0})],e.prototype,"visibleElements",void 0);k.__decorate([m.property()],e.prototype,"_featuresPerPage",void 0);k.__decorate([m.property()],e.prototype,"_maxNumFeatures",void 0);
k.__decorate([m.property()],e.prototype,"_numAssociatedFeatures",null);k.__decorate([m.property()],e.prototype,"_currentFeaturePage",void 0);k.__decorate([m.property()],e.prototype,"currentFeaturePage",null);k.__decorate([m.property()],e.prototype,"_previewDisplayCount",void 0);k.__decorate([m.property()],e.prototype,"_associatedFeatureIntersectionObserverNode",void 0);k.__decorate([m.property()],e.prototype,"_tooltipReferenceMap",void 0);k.__decorate([m.property()],e.prototype,"_filterText",void 0);
return e=c=k.__decorate([w.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociationType")],e)})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/ReactiveMap ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/FeatureLayer ../../../networks/support/typeUtils ../../../rest/networks/support/Association ../../../rest/networks/support/NetworkElement ../../../rest/support/Query ./resources ../support/featureUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L){e=class extends B.ClonableMixin(F.IdentifiableMixin(e)){constructor(l){super(l);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.networkSourceIdsInUse=new Set;this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.associationTypes=null;this.showAllEnabled=!1;this.title=null;this.connectivityFeatureCount=this.containerFeatureCount=this.contentFeatureCount=
this.structureFeatureCount=this.attachmentsFeatureCount=0;this._cancelQuery=()=>{const {_queryAbortController:c}=this;c&&c.abort();this._queryAbortController=null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:c}=this;c&&c.abort();this._queryFeatureCountAbortController=null};this._queryController=async c=>{this._cancelQuery();const a=new AbortController;this._queryAbortController=a;await m.ignoreAbortErrors(this._query(c));this._queryAbortController===a&&(this._queryAbortController=
null)};this._queryFeatureCountController=async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const c=new AbortController;this._queryFeatureCountAbortController=c;await m.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===c&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryDebounced=m.debounce(this._queryController,100);this._queryFeatureCountDebounced=m.debounce(this._queryFeatureCountController,100)}initialize(){this.associationTypes?.forEach(l=>
{l.open=!1});this.addHandles([...(this.associationTypes?.map(l=>O.watch(()=>l.open,()=>{l.open&&this._queryDebounced(l)}))??[]),O.watch(()=>[this.graphic,this.layer,this.map,this.associationTypes,this.objectId,this.globalId,this.canQuery],()=>this._queryFeatureCountDebounced(),O.initial)])}destroy(){this._cancelQuery();this._cancelQueryFeatureCount();this._destroyAssociatedFeatureViewModels()}get supportsCacheHint(){return!!this.layer?.capabilities?.query?.supportsCacheHint}get canLoad(){return!!this.map&&
!!this.associationTypes&&"string"===typeof this.globalId}get canQuery(){const l=this.layer?.capabilities?.query;return!!this.associationTypes&&"string"===typeof this.globalId&&!!l?.supportsPagination}get objectId(){return(this.objectIdField&&this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get globalId(){return(this.globalIdField&&this.graphic?.attributes?.[this.globalIdField])??null}get globalIdField(){const {layer:l}=this;return"subtype-sublayer"===
l?.type&&l?.parent?l.parent.globalIdField??null:l?.globalIdField??null}get state(){const {_queryAbortController:l,_queryFeatureCountAbortController:c,_queryPageAbortController:a,canQuery:d,_loaded:n,canLoad:D}=this;return c||D&&!n?"loading":l||a?"querying":d&&0!==this.featureCount?"ready":"disabled"}get utilityNetwork(){const {layer:l,map:c}=this;return l?.loaded&&c?"subtype-sublayer"===l?.type&&l?.parent?L.findUtilityNetwork(c,l.parent)??null:L.findUtilityNetwork(c,l)??null:null}get associationsLayer(){const {utilityNetwork:l}=
this;return l?.loaded?new p({url:l.networkSystemLayers.associationsTableUrl,gdbVersion:l.gdbVersion}):null}get attachmentsAssociations(){return this._get("attachmentsAssociations")||new x}get structureAssociations(){return this._get("structureAssociations")||new x}get contentAssociations(){return this._get("contentAssociations")||new x}get containerAssociations(){return this._get("containerAssociations")||new x}get connectivityAssociations(){return this._get("connectivityAssociations")||new x}get associationFeatures(){return this._get("associationFeatures")||
new H}get associationViewModels(){return this._get("associationViewModels")||new Map}refresh(){this._queryFeatureCountDebounced()}_destroyAssociatedFeatureViewModels(){this.associationViewModels.forEach(l=>l.destroyAll())}_generateGlobalIdWhereClause(l,c){const {globalId:a,networkSourceIdsInUse:d}=this;var {associatedNetworkSourceId:n}=l;const D=c.fieldsIndex.get(y.featureUtilityNetworkFields.fromGlobalId),J=c.fieldsIndex.get(y.featureUtilityNetworkFields.toGlobalId),K=c.fieldsIndex.get(y.featureUtilityNetworkFields.fromNetworkSourceId);
var N=c.fieldsIndex.get(y.featureUtilityNetworkFields.toNetworkSourceId);c=null!=n;const G=`(${Array.from(d.values())})`;N=c?` AND ${N.name} = ${n} AND ${N.name} IN ${G}`:"";n=c?` AND ${K.name} = ${n} AND ${K.name} IN ${G}`:"";switch(l.type){case "connectivity":return`((${D.name} = '${a}'${N}) OR (${J.name} = '${a}'${n}))`;case "attachment":case "content":return`${D.name} = '${a}'${N}`;case "container":case "structure":return`${J.name} = '${a}'${n}`;default:return""}}_generateNetworkSourceIdWhereClause(l){var {networkSourceIdsInUse:c}=
this;c=`(${Array.from(c.values())})`;const a=l.fieldsIndex.get(y.featureUtilityNetworkFields.fromNetworkSourceId);l=l.fieldsIndex.get(y.featureUtilityNetworkFields.toNetworkSourceId);return`(${a.name} IN ${c} AND ${l.name} IN ${c})`}_generateAssociationTypeWhereClause(l,c){c=c.fieldsIndex.get(y.featureUtilityNetworkFields.associationType);switch(l.type){case "attachment":case "structure":return`${c.name} = 3`;case "connectivity":return`${c.name} IN  (1, 4, 5, 6)`;case "container":case "content":return`${c.name} = 2`;
default:return""}}_generateWhereClause(l,c){var a=c.fieldsIndex.get(y.featureUtilityNetworkFields.status),d=`(${A.AssociationOpenStatus.join(",")})`;a=`${a.name} IN ${d}`;d=this._generateGlobalIdWhereClause(l,c);l=this._generateAssociationTypeWhereClause(l,c);return`(${d} AND ${a} AND ${l})`}async _loadUtiltyNetworks(){const l=this.map;if(l){await Promise.allSettled(l.utilityNetworks?.map(async d=>{await d.load()})??[]);var c=d=>{"layerId"in d&&a.isUtilityLayer(d)&&(d=a.getSourceIdByLayerId(d.layerId),
null!==d&&this.networkSourceIdsInUse.add(d))},a=this.utilityNetwork;this._set("networkSourceIdsInUse",new Set);l.allLayers.forEach(c);l.allTables.forEach(c)}}async _findLayersBySourceId(l){const {utilityNetwork:c,map:a}=this;var d=D=>D.url&&D.layerId===n?D.url.replace(/\/\d+$/,"")===c?.featureServiceUrl:!1;await c?.load();const n=c.getLayerIdBySourceId(l);l=a.allLayers.filter(d);d=a.allTables.filter(d);d=l.concat(d).toArray();await Promise.allSettled(d.map(D=>D.load()));return d}_clearAssociations(){this.attachmentsAssociations.removeAll();
this.structureAssociations.removeAll();this.contentAssociations.removeAll();this.containerAssociations.removeAll();this.connectivityAssociations.removeAll()}_clearFeatures(){this.associationFeatures.forEach(l=>l.removeAll());this.associationFeatures.clear()}_getAssociationsByType(l){switch(l){case "attachment":return this.attachmentsAssociations;case "structure":return this.structureAssociations;case "connectivity":return this.connectivityAssociations;case "container":return this.containerAssociations;
case "content":return this.contentAssociations}}_createAssociationFromFeature(l,c){if(!l)return null;const a=A.AssociationTypeDict.get(c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.associationType).name]);return new v({globalId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.globalId).name],fromNetworkElement:new z({globalId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.fromGlobalId).name],networkSourceId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.fromNetworkSourceId).name],
terminalId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.fromTerminalId).name]}),toNetworkElement:new z({globalId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.toGlobalId).name],networkSourceId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.toNetworkSourceId).name],terminalId:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.toTerminalId).name]}),associationType:a,status:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.status).name],
isContentVisible:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.isContentVisible).name],percentAlong:c.attributes[l.fieldsIndex.get(y.featureUtilityNetworkFields.percentAlong).name]})}async _queryLayer(l,c,a,d,n){const D=l.fieldsIndex.get(y.featureUtilityNetworkFields.assetGroup),J=l.fieldsIndex.get(y.featureUtilityNetworkFields.assetType),K=null!=a,N=null!=d;c="("+c.map(G=>`'${G}'`).join(", ")+")";a=new u({outFields:["*"],cacheHint:this.supportsCacheHint,where:`${l.globalIdField} IN ${c}`+
(K?` AND ${D?.name} = ${a}`:"")+(K&&N?` AND ${J?.name} = ${d}`:"")});return await this._queryAll(a,l,{signal:n?.signal})}async _createAssociationFeatureObjects(l,c,a,d,n,D){if(0===l.length)return[];const J=new Map;for(const [N,G]of c){c=await this._findLayersBySourceId(N);for(const Q of c)(await this._queryLayer(Q,G,d,n,D)).forEach(h=>{if(h.getEffectivePopupTemplate()&&h.layer){const C=J.get(h.attributes[Q.globalIdField])??[];C.push(h);J.set(h.attributes[Q.globalIdField],C)}})}const K=[];l.toArray().forEach(N=>
{const G=N.fromNetworkElement.globalId===a?N.toNetworkElement:N.fromNetworkElement;(J.get(G.globalId)??[]).forEach(Q=>{const h=this.utilityNetwork?.getTerminalById(G?.terminalId)?.name;K.push({association:N,feature:Q,terminalName:h})})});return K}_parseFeatureObjects(l,c){l.forEach(a=>{const d=(a?.feature).layer,n=c.get(d)??new x;n.add(a);c.set(d,n)})}async _queryAll(l,c,a){const d=[];let n=0,D=!1;l.num=c.sourceJSON?.maxRecordCount??2E3;do{l.start=n;const J=await c.queryFeatures(l,a);d.push(...J.features);
(D=J.exceededTransferLimit)&&(n+=J.features.length)}while(D);return d}async _queryAssociatedFeatureCount(l){const {layer:c,globalId:a,supportsCacheHint:d,associationTypes:n,associationsLayer:D,utilityNetwork:J,canQuery:K}=this;await Promise.allSettled([c?.load(),J?.load(),D?.load()]);this._clearAssociations();if(K&&c&&n&&D){var N=D.fieldsIndex.get(y.featureUtilityNetworkFields.toGlobalId).name,G=D.fieldsIndex.get(y.featureUtilityNetworkFields.fromGlobalId).name,Q=n.map(I=>this._generateWhereClause(I,
D)),h=this._generateNetworkSourceIdWhereClause(D);Q=Q.join(" OR ");h=new u({outFields:["*"],cacheHint:d,returnGeometry:!1,where:`(${Q}) AND (${h})`});h=await this._queryAll(h,D,{signal:l?.signal});var C=new Map;n.forEach(I=>{C.set(I.type,[])});h.forEach(I=>{const g=D.fieldsIndex.get(y.featureUtilityNetworkFields.associationType);switch(I.attributes[g.name]){case 1:case 4:case 5:case 6:I.attributes[G]===a?C.get("connectivity").push(I.attributes[N]):C.get("connectivity").push(I.attributes[G]);this.connectivityAssociations.add(this._createAssociationFromFeature(D,
I));break;case 2:I.attributes[G]===a?(C.get("content").push(I.attributes[N]),this.contentAssociations.add(this._createAssociationFromFeature(D,I))):(C.get("container").push(I.attributes[G]),this.containerAssociations.add(this._createAssociationFromFeature(D,I)));break;case 3:I.attributes[G]===a?(C.get("attachment").push(I.attributes[N]),this.attachmentsAssociations.add(this._createAssociationFromFeature(D,I))):(C.get("structure").push(I.attributes[G]),this.structureAssociations.add(this._createAssociationFromFeature(D,
I)))}});h=n.map(async I=>{const {associatedNetworkSourceId:g,associatedAssetGroup:E,associatedAssetType:P}=I;var R=C.get(I.type);R=null!=E?await this._countAssociatedFeatures(g,R,E,P,l):R.length;switch(I.type){case "attachment":this._set("attachmentsFeatureCount",R);break;case "structure":this._set("structureFeatureCount",R);break;case "content":this._set("contentFeatureCount",R);break;case "container":this._set("containerFeatureCount",R);break;case "connectivity":this._set("connectivityFeatureCount",
R)}});await Promise.allSettled(h)}}async _countAssociatedFeatureCount(l,c,a,d,n){const D=l.fieldsIndex.get(y.featureUtilityNetworkFields.assetGroup),J=l.fieldsIndex.get(y.featureUtilityNetworkFields.assetType),K=null!=d;c="("+c.map(N=>`'${N}'`).join(", ")+")";return l.queryFeatureCount({where:`${l.globalIdField} IN ${c}`+` AND ${D?.name} = ${a}`+(K?` AND ${J?.name} = ${d}`:""),outFields:["*"],returnGeometry:!1},{signal:n?.signal})}async _countAssociatedFeatures(l,c,a,d,n){if(0===c.length)return 0;
l=(await this._findLayersBySourceId(l)).map(async D=>this._countAssociatedFeatureCount(D,c,a,d,n));return(await Promise.all(l)).reduce((D,J)=>D+J,0)}async _queryAssociatedFeatures(l,c){const {layer:a,globalId:d,associationTypes:n,associationsLayer:D,utilityNetwork:J,canQuery:K,associationFeatures:N}=this;await Promise.allSettled([a?.load(),J?.load(),D?.load()]);if(K&&a&&n&&D){var G=this._getAssociationsByType(l.type),{associatedAssetGroup:Q,associatedAssetType:h}=l,C=new Map;G.forEach(I=>{const {networkSourceId:g,
elementGlobalId:E}=I.fromNetworkElement.globalId===d?{networkSourceId:I.toNetworkElement.networkSourceId,elementGlobalId:I.toNetworkElement.globalId}:{networkSourceId:I.fromNetworkElement.networkSourceId,elementGlobalId:I.fromNetworkElement.globalId};I=C.get(g)||[];I.push(E);C.set(g,I)});l=await this._createAssociationFeatureObjects(G,C,d,Q,h,c);this._parseFeatureObjects(l,N)}}async _queryFeatureCount(){await this._loadUtiltyNetworks();const {_queryFeatureCountAbortController:l,canQuery:c}=this;c?
(await this._queryAssociatedFeatureCount(l),this._set("featureCount",this.attachmentsFeatureCount+this.structureFeatureCount+this.contentFeatureCount+this.containerFeatureCount+this.connectivityFeatureCount)):this._set("featureCount",0)}async _query(l){await this._loadUtiltyNetworks();const {_queryAbortController:c}=this;this.featureCount&&(this._destroyAssociatedFeatureViewModels(),this._clearFeatures(),this.destroyed||await this._queryAssociatedFeatures(l,{signal:c?.signal}))}};b.__decorate([t.property()],
e.prototype,"_loaded",void 0);b.__decorate([t.property()],e.prototype,"_queryAbortController",void 0);b.__decorate([t.property()],e.prototype,"_queryPageAbortController",void 0);b.__decorate([t.property()],e.prototype,"_queryFeatureCountAbortController",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"supportsCacheHint",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"canLoad",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"canQuery",null);b.__decorate([t.property()],
e.prototype,"networkSourceIdsInUse",void 0);b.__decorate([t.property()],e.prototype,"description",void 0);b.__decorate([t.property({type:k})],e.prototype,"graphic",void 0);b.__decorate([t.property()],e.prototype,"layer",void 0);b.__decorate([t.property()],e.prototype,"map",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"objectId",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"objectIdField",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"globalId",null);b.__decorate([t.property({readOnly:!0})],
e.prototype,"globalIdField",null);b.__decorate([t.property()],e.prototype,"featureCount",void 0);b.__decorate([t.property()],e.prototype,"associationTypes",void 0);b.__decorate([t.property()],e.prototype,"showAllEnabled",void 0);b.__decorate([t.property()],e.prototype,"state",null);b.__decorate([t.property()],e.prototype,"title",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"utilityNetwork",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"associationsLayer",null);b.__decorate([t.property({readOnly:!0})],
e.prototype,"attachmentsFeatureCount",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"structureFeatureCount",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"attachmentsAssociations",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"structureAssociations",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"contentFeatureCount",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"containerFeatureCount",void 0);b.__decorate([t.property({readOnly:!0})],
e.prototype,"contentAssociations",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"containerAssociations",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"connectivityFeatureCount",void 0);b.__decorate([t.property({readOnly:!0})],e.prototype,"connectivityAssociations",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"associationFeatures",null);b.__decorate([t.property({readOnly:!0})],e.prototype,"associationViewModels",null);return e=b.__decorate([q.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations.FeatureUtilityNetworkAssociationsViewModel")],
e)})},"esri/networks/support/typeUtils":function(){define(["exports","../../core/jsonMap"],function(b,k){b.RuleType=void 0;(function(m){m[m.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity";m[m.RTAttachment=2]="RTAttachment";m[m.RTContainment=3]="RTContainment";m[m.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity";m[m.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(b.RuleType||(b.RuleType={}));const e=new k.JSONMap({connected:"connected",upstream:"upstream",
downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),B=new k.JSONMap({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),
x=Array.from({length:33},(m,H)=>2*H),F=new Map([[1,"connectivity"],[2,"containment"],[3,"attachment"],[4,"junction-edge-from-connectivity"],[5,"junction-midspan-connectivity"],[6,"junction-edge-to-connectivity"]]);k=new k.JSONMap({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});b.AssociationOpenStatus=x;b.AssociationTypeDict=F;b.AssociationTypeEnum={connectivity:1,"junction-junction-connectivity":1,attachment:2,containment:3,"junction-edge-from-connectivity":4,"junction-midspan-connectivity":5,
"junction-edge-to-connectivity":6};b.associationTypeKebabDict=B;b.traceTypeKebabDict=e;b.validationTypeKebabDict=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/networks/support/Association":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ../../../networks/support/typeUtils ./NetworkElement ../../../geometry/Polyline".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r){k=class extends e.JSONSupport{constructor(q){super(q);this.status=this.isContentVisible=this.errorCode=this.percentAlong=this.errorMessage=this.geometry=this.toNetworkElement=this.fromNetworkElement=this.associationType=this.globalId=null}readFromNetworkElement(q,p){return new f({globalId:p.fromGlobalId,networkSourceId:p.fromNetworkSourceId,terminalId:p.fromTerminalId})}writeFromNetworkElement(q,p){q&&(p.fromGlobalId=q.globalId,p.fromNetworkSourceId=q.networkSourceId,
p.fromTerminalId=q.terminalId)}readToNetworkElement(q,p){return new f({globalId:p.toGlobalId,networkSourceId:p.toNetworkSourceId,terminalId:p.toTerminalId})}writeToNetworkElement(q,p){q&&(p.toGlobalId=q.globalId,p.toNetworkSourceId=q.networkSourceId,p.toTerminalId=q.terminalId)}};b.__decorate([B.property({type:String,json:{write:!0}})],k.prototype,"globalId",void 0);b.__decorate([B.property({type:w.associationTypeKebabDict.apiValues,json:{type:w.associationTypeKebabDict.jsonValues,read:w.associationTypeKebabDict.read,
write:w.associationTypeKebabDict.write}})],k.prototype,"associationType",void 0);b.__decorate([B.property({type:f,json:{write:{target:{fromGlobalId:{type:String},fromNetworkSourceId:{type:Number},fromTerminalId:{type:Number}}},read:{source:["fromGlobalId","fromNetworkSourceId","fromTerminalId"]}}})],k.prototype,"fromNetworkElement",void 0);b.__decorate([H.reader("fromNetworkElement")],k.prototype,"readFromNetworkElement",null);b.__decorate([t.writer("fromNetworkElement")],k.prototype,"writeFromNetworkElement",
null);b.__decorate([B.property({type:f,json:{write:{target:{toGlobalId:{type:String},toNetworkSourceId:{type:Number},toTerminalId:{type:Number}}},read:{source:["toGlobalId","toNetworkSourceId","toTerminalId"]}}})],k.prototype,"toNetworkElement",void 0);b.__decorate([H.reader("toNetworkElement")],k.prototype,"readToNetworkElement",null);b.__decorate([t.writer("toNetworkElement")],k.prototype,"writeToNetworkElement",null);b.__decorate([B.property({type:r,json:{write:!0}})],k.prototype,"geometry",void 0);
b.__decorate([B.property({type:String,json:{write:!0}})],k.prototype,"errorMessage",void 0);b.__decorate([B.property({type:Number,json:{write:!0}})],k.prototype,"percentAlong",void 0);b.__decorate([B.property({type:Number,json:{write:!0}})],k.prototype,"errorCode",void 0);b.__decorate([B.property({type:Boolean,json:{write:!0}})],k.prototype,"isContentVisible",void 0);b.__decorate([B.property({type:Number,json:{write:!0}})],k.prototype,"status",void 0);return k=b.__decorate([O.subclass("esri.rest.networks.support.Association")],
k)})},"esri/rest/networks/support/NetworkElement":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,k,e,B,x,F,m){k=class extends k.JSONSupport{constructor(H){super(H);this.terminalId=this.positionTo=this.positionFrom=this.objectId=this.networkSourceId=this.globalId=this.assetTypeCode=this.assetGroupCode=
null}};b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"assetGroupCode",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"assetTypeCode",void 0);b.__decorate([e.property({type:String,json:{write:!0}})],k.prototype,"globalId",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"networkSourceId",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"objectId",void 0);b.__decorate([e.property({type:Number,
json:{write:!0}})],k.prototype,"positionFrom",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"positionTo",void 0);b.__decorate([e.property({type:Number,json:{write:!0}})],k.prototype,"terminalId",void 0);return k=b.__decorate([m.subclass("esri.rest.networks.support.NetworkElement")],k)})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations/resources":function(){define(["exports"],function(b){b.featureUtilityNetworkFields={fromGlobalId:"fromglobalid",fromNetworkSourceId:"fromnetworksourceid",
fromTerminalId:"fromterminalid",toGlobalId:"toglobalid",toNetworkSourceId:"tonetworksourceid",toTerminalId:"toterminalid",associationType:"associationtype",globalId:"globalid",status:"status",isContentVisible:"iscontentvisible",percentAlong:"percentalong",assetGroup:"assetgroup",assetType:"assettype"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,k,e,B,x,F,m){k=class extends k{constructor(H){super(H);this.description=this.title=!0}};b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"title",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"description",void 0);return k=b.__decorate([m.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations.VisibleElements")],k)})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../support/popupUtils ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./FeatureUtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils ../../geometry/Point".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l,c,a,d,n,D,J,K,N){var G;const Q={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0,utilityNetworkAssociationsContent:!0};k=G=class extends H.IdentifiableMixin(x){constructor(h){super(h);this._associationVMAbortController=this._featureAbortController=this._error=null;this._graphicChangedThrottled=f.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=
this._expressionAttributes=null;this.abilities={...Q};this.content=null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.location=this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=C=>{const {abilities:I}=this;return"attachments"===C.type&&!!I.attachmentsContent||"custom"===C.type&&!!I.customContent||"fields"===C.type&&!!I.fieldsContent||"media"===C.type&&!!I.mediaContent||"text"===
C.type&&!!I.textContent||"expression"===C.type&&!!I.expressionContent||"relationship"===C.type&&!!I.relationshipContent||"utility-network-associations"===C.type&&!!I.utilityNetworkAssociationsContent};this.addHandles(w.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone],()=>this._graphicChangedThrottled(),w.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();
this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return J.createFieldInfoMap(J.getAllFieldInfos(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return J.getSourceLayer(this.graphic)}castAbilities(h){return{...Q,...h}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":
"ready":"disabled"}set graphic(h){this._featureAbortController=new AbortController;this._set("graphic",h?.clone()??null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(h){this._override("spatialReference",h)}get timeZone(){return this.view?.timeZone??u.system}set timeZone(h){this._overrideIfSome("timeZone",h)}get map(){return this.view?.map||null}set map(h){this._override("map",h)}get waitingForContent(){return!(!this._featureAbortController&&!this._associationVMAbortController)}setActiveMedia(h,
C){h=this.contentViewModels[h];h instanceof a&&h.setActiveMedia(C)}nextMedia(h){h=this.contentViewModels[h];h instanceof a&&h.next()}previousMedia(h){h=this.contentViewModels[h];h instanceof a&&h.previous()}async updateGeometry(){const {graphic:h,spatialReference:C,_sourceLayer:I}=this;await I?.load();var g=I?.objectIdField;g&&h&&I&&(g=h?.attributes?.[g],null!=g&&(g=[g],!h.geometry&&(g=(await J.querySourceLayer({layer:I,graphic:h,outFields:[],objectIds:g,returnGeometry:!0,spatialReference:C}))?.geometry)))&&
(h.geometry=g)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:h}=this;if(h){var C=new AbortController;this._featureAbortController=C;try{await this._queryFeature({signal:C.signal})}catch(I){t.isAbortError(I)||(this._error=I,O.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:I,graphic:h,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===
C&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:h}=this;h&&h.abort();this._featureAbortController=null}_compileContentElement(h,C){if("attachments"===h.type)return this._compileAttachments(h,C);if("custom"===h.type)return this._compileCustom(h,C);if("fields"===h.type)return this._compileFields(h,C);if("media"===h.type)return this._compileMedia(h,C);if("text"===h.type)return this._compileText(h,C);if("expression"===h.type)return this._compileExpression(h,
C);if("relationship"===h.type)return this._compileRelationship(h,C);if("utility-network-associations"===h.type)return this._compileUtilityNetworkAssociation(h,C)}_compileContent(h){this._destroyContentViewModels();if(this.graphic)return Array.isArray(h)?h.filter(this._isAllowedContentType).map((C,I)=>this._compileContentElement(C,I)).filter(F.isSome):"string"===typeof h?this._compileText(new v({text:h}),0).text:h}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");
this.contentViewModels.forEach(h=>h&&!h.destroyed&&h.destroy());this._set("contentViewModels",[])}_matchesFeature(h,C){h=h?.graphic?.getObjectId();C=C?.getObjectId();return null!=h&&null!=C&&h===C}_setRelatedFeaturesViewModels({relatedFeatureViewModels:h,relatedFeatures:C,map:I}){const {view:g,spatialReference:E,timeZone:P}=this;C?.filter(Boolean).forEach(R=>{h.some(V=>this._matchesFeature(V,R))||h.add(new G({abilities:{relationshipContent:!1},map:I,view:g,spatialReference:E,timeZone:P,graphic:R}))});
h.forEach(R=>{C?.find(V=>this._matchesFeature(R,V))||h.remove(R)})}_setExpressionContentVM(h,C){const I=this.formattedAttributes,{contentElement:g,contentElementViewModel:E}=h;h=g?.type;E&&h&&("fields"===h&&(this._createFieldsFormattedAttributes({contentElement:g,contentElementIndex:C,formattedAttributes:I}),E.set(this._createFieldsVMParams(g,C))),"media"===h&&(this._createMediaFormattedAttributes({contentElement:g,contentElementIndex:C,formattedAttributes:I}),E.set(this._createMediaVMParams(g,C))),
"text"===h&&E.set(this._createTextVMParams(g)))}_compileRelationship(h,C){const {displayCount:I,orderByFields:g,relationshipId:E,title:P,description:R}=h,{_sourceLayer:V,graphic:T,map:X}=this;if(J.isRelatableFeatureSupportedLayer(V)){var Z=new d({displayCount:I,graphic:T,orderByFields:g,relationshipId:E,layer:V,map:X,...this._compileTitleAndDesc({title:P,description:R})});this.contentViewModels[C]=Z;this.addHandles(w.on(()=>Z.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(Z)),"relationship-view-models");
return h}}_matchesGlobalFeature(h,C){h=h?.association.globalId;C=C?.association.globalId;return null!=h&&null!=C&&h===C}async _setUpUtilityNetworkAssociationsViewModels(h,C,I){const {view:g,spatialReference:E,timeZone:P}=this;h.forEach((V,T)=>{const X=C.get(T);X?V.forEach(Z=>{X.find(ba=>this._matchesGlobalFeature(Z,ba))||(V.remove(Z),0===V.length&&h.delete(T))}):(V.removeAll(),h.delete(T))});C.forEach((V,T)=>{const X=h.get(T)||new m;V?.filter(Boolean).forEach(Z=>{X.some(ba=>this._matchesGlobalFeature(ba,
Z))||X.add({association:Z.association,featureViewModel:new G({abilities:{utilityNetworkAssociationsContent:!1},map:I,view:g,spatialReference:E,timeZone:P,graphic:Z.feature}),terminalName:Z.terminalName})});h.set(T,X)});const R=new AbortController;this._associationVMAbortController=R;await this._sortListObjectsByTitle(h,{signal:R.signal});this._associationVMAbortController===R&&(this._associationVMAbortController=null)}async _sortListObjectsByTitle(h,C){for(const I of h.values())h=I.map(g=>w.whenOnce(()=>
"ready"===g.featureViewModel.state,C?.signal)),await Promise.all(h),I.sort(this._compareByFeatureTitle)}_compareByFeatureTitle(h,C){h=z.getFeaturePopupTitle(h.featureViewModel);C=z.getFeaturePopupTitle(C.featureViewModel);return h.localeCompare(C,void 0,{numeric:!0})}_compileUtilityNetworkAssociation(h,C){const {title:I,description:g,associationTypes:E}=h,{_sourceLayer:P,graphic:R,map:V}=this;if(J.isAssociatedFeatureSupportedLayer(P)){var T=new n({graphic:R,associationTypes:E,layer:P,map:V,...this._compileTitleAndDesc({title:I,
description:g})});this.contentViewModels[C]=T;this.addHandles([w.watch(()=>T.associationFeatures.values(),()=>this._setUpUtilityNetworkAssociationsViewModels(T.associationViewModels,T.associationFeatures,T.map))],"association-view-models");return h}}_compileExpression(h,C){const {expressionInfo:I}=h,{graphic:g,map:E,spatialReference:P,view:R,location:V}=this,T=new l({expressionInfo:I,graphic:g,interceptor:G.interceptor,map:E,spatialReference:P,view:R,location:V});this.contentViewModels[C]=T;this.addHandles(w.watch(()=>
T.contentElementViewModel,()=>this._setExpressionContentVM(T,C),w.initial),"content-view-models");return h}_compileAttachments(h,C){const {graphic:I}=this,{description:g,title:E}=h;this.contentViewModels[C]=new y({graphic:I,...this._compileTitleAndDesc({title:E,description:g})});return h}_compileCustom(h,C){const {graphic:I}=this,{creator:g,destroyer:E}=h;this.contentViewModels[C]=new L({graphic:I,creator:g,destroyer:E});return h}_compileTitleAndDesc({title:h,description:C}){const {_fieldInfoMap:I,
_sourceLayer:g,graphic:E,formattedAttributes:P}=this,R=E?.attributes,V=this._expressionAttributes,T=P.global;return{title:J.substituteFieldsInLinksAndAttributes({attributes:R,fieldInfoMap:I,globalAttributes:T,expressionAttributes:V,layer:g,text:h}),description:J.substituteFieldsInLinksAndAttributes({attributes:R,fieldInfoMap:I,globalAttributes:T,expressionAttributes:V,layer:g,text:C})}}_createFieldsVMParams(h,C){const I=this._effectivePopupTemplate,g=this.formattedAttributes,E={...g?.global,...g?.content[C]};
C=(h?.fieldInfos||I?.fieldInfos)?.filter(({fieldName:V})=>!!V&&(J.isExpressionField(V)||J.isRelatedField(V)||E.hasOwnProperty(V)));const {description:P,title:R}=h;return{attributes:E,expressionInfos:I?.expressionInfos,fieldInfos:C,...this._compileTitleAndDesc({title:R,description:P})}}_compileFields(h,C){const I=h.clone();h=new c(this._createFieldsVMParams(h,C));this.contentViewModels[C]=h;I.fieldInfos=h.formattedFieldInfos.slice();return I}_createMediaVMParams(h,C){const {abilities:I,graphic:g,_fieldInfoMap:E,
_effectivePopupTemplate:P,relatedInfos:R,_sourceLayer:V,_expressionAttributes:T}=this,X=this.formattedAttributes,Z=g?.attributes??{},{description:ba,mediaInfos:W,title:ea}=h;return{abilities:{chartAnimation:I.chartAnimation},activeMediaInfoIndex:h.activeMediaInfoIndex||0,attributes:Z,isAggregate:g?.isAggregate,layer:V,fieldInfoMap:E,formattedAttributes:{...X?.global,...X?.content[C]},expressionAttributes:T,mediaInfos:W,popupTemplate:P,relatedInfos:R,...this._compileTitleAndDesc({title:ea,description:ba})}}_compileMedia(h,
C){const I=h.clone();h=new a(this._createMediaVMParams(h,C));I.mediaInfos=h.formattedMediaInfos.slice();this.contentViewModels[C]=h;return I}_createTextVMParams(h){const {graphic:C,_fieldInfoMap:I,_sourceLayer:g,_expressionAttributes:E}=this;h&&h.text&&(h.text=J.substituteFieldsInLinksAndAttributes({attributes:C?.attributes??{},fieldInfoMap:I,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:E,layer:g,text:h.text}));return{graphic:C,creator:h.text}}_compileText(h,C){h=h.clone();
this.contentViewModels[C]=new L(this._createTextVMParams(h));return h}_compileLastEditInfo(){const {_effectivePopupTemplate:h,_sourceLayer:C,graphic:I,timeZone:g}=this;if(h){var {lastEditInfoEnabled:E}=h,P=C?.editFieldsInfo;if(E&&P)return J.formatEditInfo(P,I?.attributes,g,C)}}_compileTitle(h){const {_fieldInfoMap:C,_sourceLayer:I,graphic:g,_expressionAttributes:E}=this;return J.substituteFieldsInLinksAndAttributes({attributes:g?.attributes??{},fieldInfoMap:C,globalAttributes:this.formattedAttributes?.global??
{},expressionAttributes:E,layer:I,text:h})}async _getTitle(){const {_effectivePopupTemplate:h,graphic:C}=this;return C?J.graphicCallback({type:"title",value:h?.title,event:{graphic:C}}):null}async _getContent(){const {_effectivePopupTemplate:h,graphic:C}=this;return C?J.graphicCallback({type:"content",value:h?.content,event:{graphic:C}}):null}async _queryFeature(h){const {_featureAbortController:C,_sourceLayer:I,graphic:g,_effectivePopupTemplate:E}=this,P=this.map,R=this.view,V=this.spatialReference,
T=this.location;if(C===this._featureAbortController&&g){await J.queryUpdatedFeature({graphic:g,popupTemplate:E,layer:I,spatialReference:V},h);var {content:{value:X},title:{value:Z}}=await t.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:h}}=await t.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(h),expressionAttributes:D.createCompiledExpressions({expressionInfos:E?.expressionInfos,spatialReference:V,graphic:g,map:P,interceptor:G.interceptor,
view:R,options:h,location:T})}));C===this._featureAbortController&&g&&(this._expressionAttributes=h,this._graphicExpressionAttributes={...g.attributes,...h},this._set("formattedAttributes",this._createFormattedAttributes(X)),this._set("title",this._compileTitle(Z)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(X)||null))}}_createMediaFormattedAttributes({contentElement:h,contentElementIndex:C,formattedAttributes:I}){const {_effectivePopupTemplate:g,
graphic:E,relatedInfos:P,_sourceLayer:R,_fieldInfoMap:V,_graphicExpressionAttributes:T,timeZone:X}=this;I.content[C]=J.formatAttributes({fieldInfos:g?.fieldInfos,graphic:E,attributes:{...T,...h.attributes},layer:R,fieldInfoMap:V,relatedInfos:P,timeZone:X})}_createFieldsFormattedAttributes({contentElement:h,contentElementIndex:C,formattedAttributes:I}){if(h.fieldInfos){const {graphic:g,relatedInfos:E,_sourceLayer:P,_fieldInfoMap:R,_graphicExpressionAttributes:V,timeZone:T}=this;I.content[C]=J.formatAttributes({fieldInfos:h.fieldInfos,
graphic:g,attributes:{...V,...h.attributes},layer:P,fieldInfoMap:R,relatedInfos:E,timeZone:T})}}_createFormattedAttributes(h){const {_effectivePopupTemplate:C,graphic:I,relatedInfos:g,_sourceLayer:E,_fieldInfoMap:P,_graphicExpressionAttributes:R,timeZone:V}=this,T={global:J.formatAttributes({fieldInfos:C?.fieldInfos,graphic:I,attributes:R,layer:E,fieldInfoMap:P,relatedInfos:g,timeZone:V}),content:[]};Array.isArray(h)&&h.forEach((X,Z)=>{"fields"===X.type&&this._createFieldsFormattedAttributes({contentElement:X,
contentElementIndex:Z,formattedAttributes:T});"media"===X.type&&this._createMediaFormattedAttributes({contentElement:X,contentElementIndex:Z,formattedAttributes:T})});return T}_checkForRelatedFeatures(h){const {graphic:C,_effectivePopupTemplate:I}=this;return this._queryRelatedInfos(C,J.getAllFieldInfos(I),h)}async _queryRelatedInfos(h,C,I){const {relatedInfos:g,_sourceLayer:E}=this;g.clear();const P=null!=E?.associatedLayer?await E?.associatedLayer.load(I):E;if(P&&h&&C.filter(T=>!!T.fieldName&&J.isRelatedField(T.fieldName))?.length){C.forEach(T=>
this._configureRelatedInfo(T,P));var R=await K.queryLayerInfos({relatedInfos:g,layer:P},I);Object.keys(R).forEach(T=>{const X=g.get(T.toString());T=R[T]?.value;X&&T&&(X.layerInfo=T.data)});var V=await K.queryRelatedFeatures({graphic:h,relatedInfos:g,layer:P},I);Object.keys(V).forEach(T=>{K.setRelatedFeatures(V[T]?.value,g.get(T.toString()))})}}_configureRelatedInfo(h,C){const {relatedInfos:I}=this,g=K.getRelatedFieldInfo(h.fieldName||"");if(g){var {layerId:E,fieldName:P}=g;E&&(C=I.get(E.toString())||
K.createRelatedInfo(E,C))&&(K.updateRelatedInfo({relatedInfo:C,fieldName:P,fieldInfo:h}),this.relatedInfos.set(E,C))}}};k.interceptor=new B.FeatureSetQueryInterceptor(J.preLayerQueryCallback,J.preRequestCallback);b.__decorate([r.property()],k.prototype,"_error",void 0);b.__decorate([r.property()],k.prototype,"_featureAbortController",void 0);b.__decorate([r.property()],k.prototype,"_associationVMAbortController",void 0);b.__decorate([r.property({readOnly:!0})],k.prototype,"_effectivePopupTemplate",
null);b.__decorate([r.property({readOnly:!0})],k.prototype,"_fieldInfoMap",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"_sourceLayer",null);b.__decorate([r.property()],k.prototype,"abilities",void 0);b.__decorate([q.cast("abilities")],k.prototype,"castAbilities",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"content",void 0);b.__decorate([r.property({readOnly:!0})],k.prototype,"contentViewModels",void 0);b.__decorate([r.property()],k.prototype,"description",void 0);b.__decorate([r.property({type:Boolean})],
k.prototype,"defaultPopupTemplateEnabled",void 0);b.__decorate([r.property({readOnly:!0})],k.prototype,"isTable",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"state",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"formattedAttributes",void 0);b.__decorate([r.property({type:e,value:null})],k.prototype,"graphic",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"lastEditInfo",void 0);b.__decorate([r.property({type:N})],k.prototype,"location",void 0);b.__decorate([r.property({readOnly:!0})],
k.prototype,"relatedInfos",void 0);b.__decorate([r.property()],k.prototype,"spatialReference",null);b.__decorate([r.property()],k.prototype,"timeZone",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"title",void 0);b.__decorate([r.property()],k.prototype,"map",null);b.__decorate([r.property({readOnly:!0})],k.prototype,"waitingForContent",null);b.__decorate([r.property()],k.prototype,"view",void 0);return k=G=b.__decorate([A.subclass("esri.widgets.Feature.FeatureViewModel")],k)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],
function(b){class k{constructor(e,B){this.preLayerQueryCallback=e;this.preRequestCallback=B;this.preLayerQueryCallback||(this.preLayerQueryCallback=x=>{});this.preRequestCallback||(this.preLayerQueryCallback=x=>{})}}b.FeatureSetQueryInterceptor=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(b){b.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",
btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container"};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(b,k,e,B,x,F,m,H,O,t){b.FeatureContentMixin=w=>{w=class extends w{constructor(){super(...arguments);this.renderNodeContent=
f=>O.isWidget(f)&&!f.destroyed?t.tsx("div",{class:H.css.contentNode,key:f},f.render()):f instanceof HTMLElement?t.tsx("div",{afterCreate:this._attachToNode,bind:f,class:H.css.contentNode,key:f}):O.hasDomNode(f)?t.tsx("div",{afterCreate:this._attachToNode,bind:f.domNode,class:H.css.contentNode,key:f}):null}_attachToNode(f){f.appendChild(this)}};return w=k.__decorate([m.subclass("esri.widgets.Feature.support.FeatureContentMixin")],w)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),function(b,k,e,B,x,F,m,H,O,t,w,f){x=class extends O{constructor(r,q){super(r,q);this._animationDelay=500;this._animationPromise=null;this.viewModel=new t}initialize(){this.addHandles(e.watch(()=>
this.visible,r=>this._visibleChange(r)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(r){this.viewModel.location=r}get view(){return this.viewModel.view}set view(r){this.viewModel.view=r}get visible(){return this.viewModel.visible}set visible(r){this.viewModel.visible=r}show(r){const {location:q,promise:p}=r??{};q&&(this.viewModel.location=q);this.visible=!0;r=()=>this.hide();p&&p.catch(()=>{}).then(r)}hide(){this.visible=!1}render(){var {visible:r}=
this,{screenLocation:q}=this.viewModel;q=!!q;r={["esri-spinner--start"]:r&&q,["esri-spinner--finish"]:!r&&q};q=this._getPositionStyles();return f.tsx("div",{class:this.classes("esri-spinner",r),styles:q})}_visibleChange(r){if(r)this.viewModel.screenLocationEnabled=!0;else{var q=k.after(this._animationDelay);this._animationPromise=q;q.catch(()=>{}).then(()=>{this._animationPromise===q&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:r,
view:q}=this.viewModel;if(null==q||null==r)return{};const {padding:p}=q;return{left:`${r.x-p.left}px`,top:`${r.y-p.top}px`}}};b.__decorate([B.property()],x.prototype,"location",null);b.__decorate([B.property()],x.prototype,"view",null);b.__decorate([B.property({type:t})],x.prototype,"viewModel",void 0);b.__decorate([B.property()],x.prototype,"visible",null);return x=b.__decorate([H.subclass("esri.widgets.Spinner")],x)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),
function(b,k,e,B,x,F,m){e=class extends m{constructor(H){super(H);this.visible=!1}};b.__decorate([k.property()],e.prototype,"visible",void 0);return e=b.__decorate([F.subclass("esri.widgets.Spinner.SpinnerViewModel")],e)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),
function(b,k,e,B,x,F,m,H,O){k=class extends k.EventedAccessor{constructor(t){super(t);this.location=null;this.screenLocationEnabled=!1;this.view=null;this.addHandles([e.when(()=>{const w=this.screenLocationEnabled?this.view:null;return w?[w.size,"3d"===w.type?w.camera:w.viewpoint]:null},()=>this.notifyChange("screenLocation")),e.watch(()=>this.screenLocation,(w,f)=>{null!=w&&null!=f&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:t,view:w,screenLocationEnabled:f}=
this;var r=w?.spatialReference;r=r?O.projectOrLoad(t,r).geometry:null;return f&&r&&w?.ready?w.toScreen(r):null}};b.__decorate([B.property()],k.prototype,"location",void 0);b.__decorate([B.property()],k.prototype,"screenLocation",null);b.__decorate([B.property()],k.prototype,"screenLocationEnabled",void 0);b.__decorate([B.property()],k.prototype,"view",void 0);return k=b.__decorate([H.subclass("esri.widgets.support.AnchorElementViewModel")],k)})},"esri/widgets/Features/css":function(){define(["exports"],
function(b){b.css={icon:"esri-features__icon",actionImage:"esri-features__action-image",base:"esri-features",container:"esri-features__container",contentContainer:"esri-features__content-container",contentFeature:"esri-features__content-feature",flowItemCollapsed:"esri-features__flow-item--collapsed",header:"esri-features__header",footer:"esri-features__footer",featureMenuObserver:"esri-features__feature-menu-observer",actionExit:"esri-features__action--exit",loader:"esri-features__loader",featuresHeading:"esri-features__heading",
paginationActionBar:"esri-features__pagination-action-bar",paginationPrevious:"esri-features__pagination-previous",paginationNext:"esri-features__pagination-next"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesDrillIn":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./css ../Popup/actions ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A){const v=w.zoomToFeature.clone();e=class extends O{constructor(z,u){super(z,u);this.messages=null;this.closed=!1;this.closable=!0;this._handleOpenFeature=y=>{this.emit("open-feature",{feature:y})};this._handleZoomToFeature=y=>{this.emit("zoom-to-feature",{featureWidget:y})}}loadDependencies(){return f.loadCalciteComponents({action:()=>new Promise((z,u)=>b(["../../chunks/calcite-action"],z,u)),"action-bar":()=>new Promise((z,u)=>b(["../../chunks/calcite-action-bar"],
z,u)),"action-group":()=>new Promise((z,u)=>b(["../../chunks/calcite-action-group"],z,u)),"flow-item":()=>new Promise((z,u)=>b(["../../chunks/calcite-flow-item"],z,u))})}render(){var {flowItems:z}=this;z=z?.toArray();return p.tsx(p.tsxFragment,null,z?.map(u=>this._renderFlowItem(u)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleDrillInBackClick(){const z=this.flowItems?.pop();z&&("showAllEnabled"in z.viewModel&&(z.viewModel.showAllEnabled=!1),z&&(z.viewModel=
null,z.destroy()))}_getExitMessage(z){switch(z.flowType){case "feature":case "feature-association":return"";case "feature-relationship":return this.messages.exitRelatedRecords;case "feature-utility-network-associations":case "feature-utility-network-association-type":return this.messages.exitAssociations}}_renderFlowItem(z){const {messages:u,closable:y,closed:L}=this,l="graphic"in z&&!z.isTable,c="feature-association"===z.flowType,a=this._getExitMessage(z),d=u.selectFeature;return p.tsx("calcite-flow-item",
{bind:this,closable:y,closed:L,description:this._getDrillInFlowItemDescription(z),heading:z.title??"",key:`flow-item-${z.viewModel.uid}`,onCalciteFlowItemBack:n=>{n.preventDefault();this._handleDrillInBackClick()},onCalciteFlowItemClose:this._handleCloseClick},p.tsx("calcite-action",{appearance:"transparent",bind:this,class:t.css.actionExit,icon:"move-up",key:"exit-action",onclick:this._handleExitClick,slot:"header-actions-start",text:a,title:a}),l?p.tsx("calcite-action",{appearance:"transparent",
bind:this,icon:"zoom-to-object",key:"open-feature-action",onclick:()=>this._handleOpenFeature(z),slot:"header-actions-end",text:d,title:d}):null,c?p.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!0,key:"header-action-bar",scale:"s",slot:"action-bar"},p.tsx("calcite-action-group",{overlayPositioning:"fixed",scale:"s"},this._renderDefaultActions(z))):null,p.tsx("div",{class:t.css.container},z.render()))}_renderDefaultActions(z){const u=this._getActionTitle(v);return p.tsx("calcite-action",{active:v.active,
appearance:"solid",bind:this,"data-action-uid":v.uid,disabled:v.disabled,icon:v.icon??"question",indicator:v.indicator,key:`action-${v.uid}`,loading:v.active,onclick:()=>this._handleZoomToFeature(z),scale:"s",text:u,textEnabled:!0,title:u})}_getActionTitle(z){const {messages:u}=this,{id:y}=z;z=z.title??"";return"zoom-to-feature"===y?A.substitute(z,{messages:u}):z}_getDrillInFlowItemDescription(z){switch(z.flowType){case "feature":case "feature-association":case "feature-utility-network-associations":return z.viewModel.description??
"";case "feature-relationship":return z.featureCountDescription;case "feature-utility-network-association-type":return z.description??""}}};k.__decorate([B.property()],e.prototype,"flowItems",void 0);k.__decorate([B.property(),q.messageBundle("esri/widgets/Features/t9n/Features")],e.prototype,"messages",void 0);k.__decorate([B.property()],e.prototype,"closed",void 0);k.__decorate([B.property()],e.prototype,"closable",void 0);return e=k.__decorate([H.subclass("esri.widgets.Features.FeaturesDrillIn")],
e)})},"esri/widgets/Popup/actions":function(){define("exports ../../core/Collection ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../support/legacyIcon".split(" "),function(b,k,e,B,x,F){k=k.ofType({key:"type",defaultKeyValue:"button",base:e,typeMap:{button:B,toggle:x}});e=new B({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:F.legacyIcon.zoomInMagnifyingGlass});const m=new B({icon:"trash",id:"remove-selected-feature",
title:"{messages.remove}",className:F.legacyIcon.trash});B=new B({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:F.legacyIcon.zoomInMagnifyingGlass});x=new x({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:F.legacyIcon.table,value:!1});F=[e,m,x,B];b.ActionsCollection=k;b.all=F;b.browseClusteredFeatures=x;b.removeSelectedFeature=m;b.zoomToClusteredFeatures=B;b.zoomToFeature=e;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Features/FeaturesViewModel":function(){define("require ../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/ReactiveSet ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/projection ../../geometry/support/geometryUtils ../../geometry/support/webMercatorUtils ../../layers/Layer ../../layers/LayerConstants ../../symbols/support/symbolUtils ../../time/timeZoneUtils ../../views/support/layerViewUtils ../Feature/FeatureViewModel ../Popup/actions ../Popup/actionUtils ../support/AnchorElementViewModel ../support/GoTo ../../symbols/SimpleFillSymbol ../../geometry/Point".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L,l,c,a,d,n,D,J,K){let N=null;e=class extends D.GoToMixin(n){constructor(G){super(G);this._pendingPromises=new t;this._selectedClusterFeature=this._highlightActiveFeaturePromise=this._highlightSelectedFeaturePromise=this._fetchFeaturesController=null;this.actions=new a.ActionsCollection;this.activeFeature=null;this.browseClusterEnabled=this.autoCloseEnabled=!1;this.content=null;this.defaultPopupTemplateEnabled=!1;this.featurePage=null;this.featuresPerPage=
20;this.featureMenuOpen=!1;this.featureViewModelAbilities=null;this.featureViewModels=[];this.includeDefaultActions=this.highlightEnabled=!0;this.selectedClusterBoundaryFeature=new B({symbol:new J({outline:{width:1.5,color:"cyan"},style:"none"})});this.title=null;this.updateLocationEnabled=!1;this.view=null;this.visible=!1;this.zoomFactor=4;this.zoomToLocation=null;this._debouncedLocationUpdate=O.debounce(async Q=>{const {spatialReference:h}=this,C=this.selectedFeature?.geometry?.type;Q=this.location??
Q;if(C&&"mesh"!==C&&h&&Q&&this.selectedFeature)if("point"===C)this.location=A.getPointFromGeometry(this.selectedFeature.geometry)??Q;else try{const I=this.selectedFeature;let g=I.geometry;const E=this._getHighlightLayer(I),P=I.getObjectId();if(E&&this.view){if(P){const R=this.view?.allLayerViews.find(X=>X.layer.uid===E.uid);if(!(R&&"queryFeatures"in R))return;const V=R.createQuery();V.outSpatialReference=h;V.objectIds=[P];V.returnGeometry=!0;const {features:T}=await R.queryFeatures(V);g=T[0]?.geometry}if(g&&
"mesh"!==g.type&&(g=p.project(g,h),N||=await new Promise((R,V)=>b(["../../geometry/geometryEngineAsync"],R,V)),!await N.intersects(g,Q))){const R=(await N.nearestCoordinate(g,Q)).coordinate??Q;this.selectedFeature===I&&(this.location=R)}}}catch(I){O.isAbortError(I)||H.getLogger(this).error(I)}})}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),w.watch(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),w.watch(()=>
[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),w.watch(()=>this.view?.animation?.state,G=>this._animationStateChange(G)),w.watch(()=>this.location,G=>this._locationChange(G)),w.watch(()=>this.selectedFeature,G=>this._selectedFeatureChange(G)),w.watch(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),w.watch(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,
this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),w.watch(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",G=>d.triggerAction({event:G,viewModel:this,view:this.view})),w.when(()=>!this.waitingForResult,()=>this._waitingForResultChange(),w.sync),w.watch(()=>[this.features,this.map,this.spatialReference,this.timeZone],()=>this._updateFeatureVMs()),w.watch(()=>this.view?.scale,()=>this._viewScaleChange()),w.when(()=>!this.visible,()=>this.browseClusterEnabled=
!1),w.watch(()=>this.browseClusterEnabled,G=>G?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures();this._pendingPromises.clear();this.browseClusterEnabled=!1;this.timeZone=this.spatialReference=this.map=this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const G=this._get("allActions")||new a.ActionsCollection;G.removeAll();const {actions:Q,defaultActions:h,defaultPopupTemplateEnabled:C,includeDefaultActions:I,
selectedFeature:g}=this,E=I?h.concat(Q):Q,P=g&&("function"===typeof g.getEffectivePopupTemplate&&g.getEffectivePopupTemplate(C)||g.popupTemplate),R=P?.actions;(P?.overwriteActions?R:R?.concat(E)??E)?.filter(Boolean).forEach(V=>G.add(V));return G}get defaultActions(){const G=this._get("defaultActions")||new a.ActionsCollection;G.removeAll();G.addMany(d.isClusterFeature(this.selectedFeature)?[a.zoomToClusteredFeatures.clone(),a.browseClusteredFeatures.clone()]:[a.zoomToFeature.clone()]);return G}get featureCount(){return this.features.length}set features(G){G=
G||[];this._set("features",G);const {pendingPromisesCount:Q,promiseCount:h,selectedFeatureIndex:C}=this,I=h&&G.length;I&&Q&&-1===C?this.selectedFeatureIndex=0:I&&-1!==C||(this.selectedFeatureIndex=G.length?0:-1)}set location(G){let Q=G;const h=this.spatialReference?.isWebMercator;G?.spatialReference?.isWGS84&&h&&(Q=v.geographicToWebMercator(G));this._set("location",Q)}get map(){return this.view?.map??null}set map(G){this._override("map",G)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||
[]}set promises(G){this._pendingPromises.clear();this.features=[];Array.isArray(G)&&G.length?(this._set("promises",G),G=G.slice(),G.forEach(Q=>this._pendingPromises.add(Q)),G.reduce((Q,h)=>Q.finally(()=>h.then(C=>{this._pendingPromises.has(h)&&this._updateFeatures(C)}).finally(()=>this._pendingPromises.delete(h)).catch(()=>{})),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const {features:G,selectedFeatureIndex:Q}=this;return-1===Q?null:G[Q]||null}get selectedFeatureIndex(){const G=
this._get("selectedFeatureIndex");return"number"===typeof G?G:-1}set selectedFeatureIndex(G){const {featureCount:Q}=this;G=isNaN(G)||-1>G||!Q?-1:(G+Q)%Q;this.activeFeature=null;this._set("selectedFeatureIndex",G)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(G){this._override("spatialReference",G)}get state(){const {view:G,map:Q}=this;return G?G.ready?"ready":"disabled":
Q?"ready":"disabled"}get timeZone(){return this.view?.timeZone??L.system}set timeZone(G){this._overrideIfSome("timeZone",G)}get waitingForContents(){return this.featureViewModels.some(G=>G.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||0<this.pendingPromisesCount)||0!==this.featureCount)}centerAtLocation(){const {view:G}=this,Q=d.getSelectedTarget(this);return Q&&G?this.callGoTo({target:{target:Q,scale:G.scale}}):Promise.reject(new m("center-at-location:invalid-target-or-view",
"Cannot center at a location without a target and view.",{target:Q,view:G}))}zoomTo(G){return this.callGoTo(G)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(G,Q){const {view:h}=this;if(!h||!G)throw new m("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:G,view:h});return h.fetchPopupFeatures(G,{pointerType:Q?.event?.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,
signal:Q?.signal})}open(G){G={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...G,visible:!0};var {fetchFeatures:Q}=G;delete G.fetchFeatures;Q&&this._setFetchFeaturesPromises(G.location);Q=["actionsMenuOpen","collapsed"];for(const h of Q)delete G[h];this.set(G)}triggerAction(G){(G=this.allActions.at(G))&&!G.disabled&&this.emit("trigger-action",{action:G})}next(){this.selectedFeatureIndex++;return this}previous(){this.selectedFeatureIndex--;return this}disableClusterBrowsing(){d.removeClusteredFeaturesForBrowsing(this);
this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const {view:G,selectedFeature:Q}=this;"2d"!==G?.type?H.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",Q):d.isClusterFeature(Q)?(await d.displayClusterExtent(this),await d.browseAggregateFeatures(this)):H.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",Q)}handleViewClick(G){this._fetchFeaturesAndOpen(G)}_animationStateChange(G){this.zoomToLocation||
(a.zoomToFeature.disabled="waiting-for-target"===G)}_clearBrowsedClusterGraphics(){const G=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(F.isSome);this.view?.graphics?.removeMany(G);this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){d.isClusterFeature(this.selectedFeature)?(this.visible=this.browseClusterEnabled=!1,this.clear()):this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(G){const {selectedFeature:Q,
updateLocationEnabled:h,view:C}=this;C&&h&&G&&(!Q||Q.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=1<this.featureCount?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=1<this.featureCount?1:null}_setGraphicOnFeatureViewModels(){const {features:G,featureCount:Q,featurePage:h,featuresPerPage:C,featureViewModels:I}=this;if(null!==h){var g=((h-1)*C+Q)%Q;I.slice(g,g+C).forEach((E,P)=>{E&&(E.graphic??(E.graphic=
G[g+P]))})}}async _selectedFeatureChange(G){const {location:Q,updateLocationEnabled:h,view:C}=this;if(G&&C)if(this.browseClusterEnabled)this._selectedClusterFeature&&(C.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),d.isClusterFeature(G)||(G.symbol=await y.getDisplayedSymbol(G),this._selectedClusterFeature=G,C.graphics.add(this._selectedClusterFeature));else{var I=G.sourceLayer?.type;if("map-image"===I||"imagery"===I||"imagery-tile"===I)G.symbol=await y.getDisplayedSymbol(G);
!h&&Q||!G.geometry?h&&!G.geometry&&(await this.centerAtLocation(),G=C.center?.clone())&&(this.location=G):this.location=A.getPointFromGeometry(G.geometry)}}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(G){({pendingFeatures:G}=await this._fetchFeaturesWithController({mapPoint:G}));this.promises=G}_destroyFeatureVMs(){this.featureViewModels.forEach(G=>G&&!G.destroyed&&G.destroy());this._set("featureViewModels",[])}_updateFeatureVMs(){const {selectedFeature:G,
features:Q,featureViewModels:h,view:C,spatialReference:I,map:g,timeZone:E,location:P}=this;d.isClusterFeature(G)||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(Q?.length){var R=h.slice(),V=[];Q.forEach((T,X)=>{if(T){var Z=null;R.some((ba,W)=>{ba&&ba.graphic===T&&(Z=ba,R.splice(W,1));return!!Z});if(Z)V[X]=Z;else{const ba=new c({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:I,graphic:T===G?T:null,location:P,map:g,
view:C,timeZone:E});V[X]=ba}}});R.forEach(T=>T&&!T.destroyed&&T.destroy());this._set("featureViewModels",V)}}async _getScreenPoint(G,Q){const {spatialReference:h,view:C}=this;if(!C)return null;await C?.when();const I=G?.spatialReference;if(!I||!h)return null;await p.initializeProjection(I,h,null,Q);return C.toScreen(G)}_cancelFetchingFeatures(){const G=this._fetchFeaturesController;G&&G.abort();this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures({mapPoint:G,screenPoint:Q,
event:h,signal:C}){return this.fetchFeatures(Q??await this._getScreenPoint(G??this.location,{signal:C}),{signal:C,event:h})}_fetchFeaturesWithController({mapPoint:G,screenPoint:Q,event:h}){this._cancelFetchingFeatures();const C=new AbortController,{signal:I}=C;this._fetchFeaturesController=C;G=this._projectScreenPointAndFetchFeatures({mapPoint:G,screenPoint:Q,signal:I,event:h});G.catch(()=>{}).then(()=>{this._fetchFeaturesController=null});return G}async _fetchFeaturesAndOpen(G){const {mapPoint:Q,
screenPoint:h}=G,{view:C}=this;this.removeHandles("location-scale-handle");this.addHandles([w.watch(()=>this.view?.scale,()=>this._debouncedLocationUpdate(Q).catch(I=>{O.isAbortError(I)||H.getLogger(this).error(I)})),w.when(()=>!this.visible,()=>{this.removeHandles("location-scale-handle")},{once:!0})],"location-scale-handle");({pendingFeatures:G}=await this._fetchFeaturesWithController({mapPoint:Q,screenPoint:h,event:G}));C?.popup&&"open"in C.popup&&C.popup.open({location:Q??void 0,promises:G})}_autoClose(){this.autoCloseEnabled&&
(this.visible=!1)}async _getLayerView(G,Q){await G.when();return G.whenLayerView(Q)}_getHighlightLayer(G){const {layer:Q,sourceLayer:h}=G;return h&&"layer"in h&&h.layer?h.layer:"map-notes"===h?.type||"subtype-group"===h?.type?h:Q}_getHighlightTarget(G,Q,h){var C=Q.type;if("building-scene"===C||"2d"===h&&("map-image"===C||"tile"===C||"imagery"===C||"imagery-tile"===C))return G;h=G.getObjectId();if(null!=h)return h;Q="imagery"===Q.type?void 0:"objectIdField"in Q?Q.objectIdField||u.fallbackObjectIDAttribute:
null;return(h=G.attributes)&&Q&&h[Q]||G}_mapIncludesLayer(G){return!!this.map?.allLayers?.includes(G)}async _highlightActiveFeature(){this.removeHandles("highlight-active-feature");const {highlightEnabled:G,view:Q,activeFeature:h,visible:C}=this;if(h&&Q&&G&&C){var I=this._getHighlightLayer(h);if(I&&I instanceof z&&this._mapIncludesLayer(I)){var g=this._getLayerView(Q,I);this._highlightActiveFeaturePromise=g;var E=await g;E&&l.highlightsSupported(E)&&this._highlightActiveFeaturePromise===g&&this.activeFeature&&
this.highlightEnabled&&(I=E.highlight(this._getHighlightTarget(h,I,Q.type)),this.addHandles(I,"highlight-active-feature"))}}}async _highlightSelectedFeature(){this.removeHandles("highlight-selected-feature");const {selectedFeature:G,highlightEnabled:Q,view:h,visible:C}=this;if(G&&h&&Q&&C){var I=this._getHighlightLayer(G);if(I&&I instanceof z&&this._mapIncludesLayer(I)){var g=this._getLayerView(h,I);this._highlightSelectedFeaturePromise=g;var E=await g;E&&l.highlightsSupported(E)&&this._highlightSelectedFeaturePromise===
g&&this.selectedFeature&&this.highlightEnabled&&this.visible&&(I=E.highlight(this._getHighlightTarget(G,I,h.type)),this.addHandles(I,"highlight-selected-feature"))}}}_updateFeatures(G){const {features:Q}=this;G=G.filter(h=>!Q.includes(h));G?.length&&(this.features=Q.concat(G))}};k.__decorate([f.property()],e.prototype,"_fetchFeaturesController",void 0);k.__decorate([f.property({type:a.ActionsCollection})],e.prototype,"actions",void 0);k.__decorate([f.property({readOnly:!0})],e.prototype,"active",
null);k.__decorate([f.property()],e.prototype,"activeFeature",void 0);k.__decorate([f.property({readOnly:!0})],e.prototype,"allActions",null);k.__decorate([f.property()],e.prototype,"autoCloseEnabled",void 0);k.__decorate([f.property()],e.prototype,"browseClusterEnabled",void 0);k.__decorate([f.property()],e.prototype,"content",void 0);k.__decorate([f.property({type:a.ActionsCollection,readOnly:!0})],e.prototype,"defaultActions",null);k.__decorate([f.property({type:Boolean})],e.prototype,"defaultPopupTemplateEnabled",
void 0);k.__decorate([f.property({readOnly:!0})],e.prototype,"featureCount",null);k.__decorate([f.property()],e.prototype,"featurePage",void 0);k.__decorate([f.property({value:[]})],e.prototype,"features",null);k.__decorate([f.property()],e.prototype,"featuresPerPage",void 0);k.__decorate([f.property()],e.prototype,"featureMenuOpen",void 0);k.__decorate([f.property()],e.prototype,"featureViewModelAbilities",void 0);k.__decorate([f.property({readOnly:!0})],e.prototype,"featureViewModels",void 0);k.__decorate([f.property()],
e.prototype,"highlightEnabled",void 0);k.__decorate([f.property()],e.prototype,"includeDefaultActions",void 0);k.__decorate([f.property({type:K})],e.prototype,"location",null);k.__decorate([f.property()],e.prototype,"map",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"pendingPromisesCount",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"promiseCount",null);k.__decorate([f.property()],e.prototype,"promises",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"selectedClusterBoundaryFeature",
void 0);k.__decorate([f.property({value:null,readOnly:!0})],e.prototype,"selectedFeature",null);k.__decorate([f.property({value:-1})],e.prototype,"selectedFeatureIndex",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"selectedFeatureViewModel",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"state",null);k.__decorate([f.property()],e.prototype,"timeZone",null);k.__decorate([f.property()],e.prototype,"title",void 0);k.__decorate([f.property()],e.prototype,"updateLocationEnabled",
void 0);k.__decorate([f.property()],e.prototype,"view",void 0);k.__decorate([f.property()],e.prototype,"visible",void 0);k.__decorate([f.property({readOnly:!0})],e.prototype,"waitingForContents",null);k.__decorate([f.property({readOnly:!0})],e.prototype,"waitingForResult",null);k.__decorate([f.property()],e.prototype,"zoomFactor",void 0);k.__decorate([f.property()],e.prototype,"zoomToLocation",void 0);k.__decorate([f.property()],e.prototype,"centerAtLocation",null);return e=k.__decorate([q.subclass("esri.widgets.Features.FeaturesViewModel")],
e)})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(b,k){class e{constructor(B){this._observable=new k.SimpleObservable;this._set=new Set(B)}get size(){b.trackAccess(this._observable);return this._set.size}add(B){const x=this._set.size;this._set.add(B);this._set.size!==x&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(B){(B=this._set.delete(B))&&this._observable.notify();
return B}entries(){b.trackAccess(this._observable);return this._set.entries()}forEach(B,x){b.trackAccess(this._observable);this._set.forEach((F,m)=>B.call(x,F,m,this),x)}has(B){b.trackAccess(this._observable);return this._set.has(B)}keys(){b.trackAccess(this._observable);return this._set.keys()}values(){b.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){b.trackAccess(this._observable);return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}
return e})},"esri/layers/LayerConstants":function(){define(["exports"],function(b){b.fallbackObjectIDAttribute="OBJECTID";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(b,k,e,B,x,F,m,H,O,t){function w(v,
z){if(z&&(v.style.filter=H.getCSSFilterFromEffectList(z),z=z.effects))for(const u of z)if("drop-shadow"===u?.type){0>u.offsetX?v.style.marginLeft=`${Math.abs(u.offsetX)}px`:v.style.marginRight=`${u.offsetX}px`;break}}async function f(v,z){switch(v.type){case "web-style":var {previewWebStyleSymbol:u}=await new Promise((y,L)=>b(["./previewWebStyleSymbol"],y,L));return u(v,f,z);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:u}=await new Promise((y,
L)=>b(["./previewSymbol3D"],y,L)),u(v,z);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:u}=await new Promise((y,L)=>b(["./previewSymbol2D"],y,L)),u(v,z);case "cim":return{previewCIMSymbol:u}=await new Promise((y,L)=>b(["./previewCIMSymbol"],y,L)),u(v,z)}}function r(v){return v&&"opacity"in v?v.opacity*r(v.parent):1}function q(v){if(v)return"renderer"in v?v.renderer:void 0}let p=null;const A=[255,255,255];k.getDisplayedColor=
async function(v,z){if(v){var {layer:u,sourceLayer:y}=v,L=r(u??y);if(null!=v.symbol&&(null==z||!0!==z.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await H.fetchWebStyleSymbol(v.symbol,z):v.symbol.clone(),H.getColorFromSymbol(v,L);var l=z?.renderer??q(u)??q(y),c=l&&"getSymbolAsync"in l?await l.getSymbolAsync(v,z):void 0;if(c){c="web-style"===c.type?await H.fetchWebStyleSymbol(c,z):c.clone();c=H.getColorFromSymbol(c,L);if(!(l&&"visualVariables"in l)||"visualVariables"in l&&!l.visualVariables||
"visualVariables"in l&&!l.visualVariables?.length)return c;"arcadeRequiredForVisualVariables"in l&&l.arcadeRequiredForVisualVariables&&null==z?.arcade&&(z={...z},z.arcade=await B.loadArcade());var {getColor:a,getOpacity:d}=await new Promise((J,K)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],J,K)),n=[],D=[];if(l.visualVariables)for(const J of l.visualVariables)switch(J.type){case "color":n.push(J);break;case "opacity":D.push(J)}l=(l=0<n.length?n[n.length-1]:null)?a(l,v,z):c;v=
(c=0<D.length?D[D.length-1]:null)?d(c,v,z):null;null!=L&&(v=null!=v?v*L:L);return l?H.applyOpacityToColor(l,v):null}}};k.getDisplayedSymbol=async function(v,z){if(v){var u=v.sourceLayer,y=(null!=z&&(z.useSourceLayer??!1)?u:v.layer)??u;u=r(y);if(null!=v.symbol&&(null==z||!0!==z.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await H.fetchWebStyleSymbol(v.symbol,{...z,cache:null!=z?z.webStyleCache:null}):v.symbol.clone(),H.applyColorToSymbol(v,null,u),v;var L=z?.renderer??q(y);if(y=L&&"getSymbolAsync"in
L?await L.getSymbolAsync(v,z):null){y="web-style"===y.type?await y.fetchSymbol({...z,cache:null!=z?z.webStyleCache:null}):y.clone();if(!(L&&"visualVariables"in L&&L.visualVariables?.length))return H.applyColorToSymbol(y,null,u),y;"arcadeRequiredForVisualVariables"in L&&L.arcadeRequiredForVisualVariables&&null==z?.arcade&&(z={...z},z.arcade=await B.loadArcade());var {getColor:l,getOpacity:c,getAllSizes:a,getRotationAngle:d}=await new Promise((G,Q)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],
G,Q)),n=[],D=[],J=[],K=[];for(var N of L.visualVariables)switch(N.type){case "color":n.push(N);break;case "opacity":D.push(N);break;case "rotation":K.push(N);break;case "size":N.target||J.push(N)}N=(N=!!n.length&&n[n.length-1])?l(N,v,z):null;D=(D=!!D.length&&D[D.length-1])?c(D,v,z):null;null!=u&&(D=null!=D?D*u:u);H.applyColorToSymbol(y,N,D);J.length&&(u=a(J,v,z),await H.applySizesToSymbol(y,u));for(const G of K)H.applyRotationToSymbol(y,d(G,v,z),G.axis);return y}}};k.getLegendLabel=async function(v,
z,u){if(v){var {layer:y,sourceLayer:L}=v,l=u?.renderer??q(y)??q(L);if(!l)return null;if("visualVariables"in l&&l.visualVariables?.length){const {getRampStops:a}=await new Promise((J,K)=>b(["../../widgets/Legend/support/colorRampUtils"],J,K)),{getRampStops:d}=await new Promise((J,K)=>b(["../../widgets/Legend/support/sizeRampUtils"],J,K)),{getDateFormatOptions:n}=await new Promise((J,K)=>b(["../../widgets/Legend/support/utils"],J,K));let D=null;for(const J of l.visualVariables){var c=z?n(y,J,z.timeZone):
null;let K=null;switch(J.type){case "color":K=await a(J,null,c);break;case "opacity":K=await a(J);break;case "size":J.target||(K=await d(l,J,null,u?.scale||z?.scale,z,c))}if(K?.length&&(c=K.find((N,G)=>{const Q=v.attributes[J.field];return 0===G?Q>=N.value:G===K?.length-1?Q<=N.value:N.value===Q}))){D=c.label;break}}if(D)return D}switch(l.type){case "class-breaks":return z="getClassBreakInfo"in l?await l.getClassBreakInfo(v,u):null,z?.label??(z&&1<l.classBreakInfos?.length)?`${z.minValue} - ${z.maxValue}`:
null;case "unique-value":return("getUniqueValueInfo"in l?await l.getUniqueValueInfo(v,u):null)?.label}return null}};k.renderColorRampPreviewHTML=function(v,z={}){var u="horizontal"===z.align;const y=z.width??(u?75:24),L=z.height??(u?24:75);var l=z.gradient??!0,c=window.devicePixelRatio,a=y*c,d=L*c;c=document.createElement("canvas");c.width=a;c.height=d;c.ariaLabel=z.ariaLabel??null;c.style.width=`${y}px`;c.style.height=`${L}px`;const n=c.getContext("2d");var D=u?a:0;const J=u?0:d;if(l){const K=n.createLinearGradient(0,
0,D,J);u=v.length;const N=1===u?0:1/(u-1);v.forEach((G,Q)=>K.addColorStop(Q*N,G.toString()));n.fillStyle=K;n.fillRect(0,0,a,d)}else{a=u?a/v.length:a;d=u?d:d/v.length;D=l=0;for(const K of v)n.fillStyle=K.toString(),n.fillRect(l,D,a,d),l=u?l+a:0,D=u?0:D+d}v=document.createElement("div");v.style.width=`${y}px`;v.style.height=`${L}px`;w(v,z?.effectList);v.appendChild(c);return v};k.renderDotDensityPreviewHTML=function(v,z,u){const {backgroundColor:y,outline:L,dotSize:l}=v;var c=u?.swatchSize||F.SymbolSizeDefaults.size;
const a=Math.round(c*c/Math.max(l,.5)**2*.8),d=window.devicePixelRatio;v=document.createElement("canvas");const n=c*d;v.width=n;v.height=n;v.style.width=`${v.width/d}px`;v.style.height=`${v.height/d}px`;const D=v.getContext("2d");y&&(D.fillStyle=y.toCss(!0),D.fillRect(0,0,n,n),D.fill());D.fillStyle=z?.toCss(!0)??"";if(p&&p.length/2===a)for(z=0;z<2*a;z+=2)D.fillRect(p[z],p[z+1],l*d,l*d),D.fill();else for(p=[],z=0;z<2*a;z+=2){const J=Math.floor(Math.random()*(n-0+1)),K=Math.floor(Math.random()*(n-0+
1));p.push(J,K);D.fillRect(J,K,l*d,l*d);D.fill()}L&&(L.color&&(D.strokeStyle=L.color.toCss(!0)),D.lineWidth=L.width,D.strokeRect(0,0,n,n));c=new Image(c,c);c.src=v.toDataURL();c.ariaLabel=u?.ariaLabel??null;c.alt=u?.ariaLabel??"";return c};k.renderPieChartPreviewHTML=function(v,z={}){const u=z.radius||40;var y=2*Math.PI*u,L=v.length;const l=y/L,c=[],a=x.getStroke(z.outline);null!=a?.width&&(a.width*=2);(a||z.backgroundColor)&&c.push({shape:{type:"circle",cx:u,cy:u,r:u},fill:z.backgroundColor,stroke:a,
offset:[0,0]});const d=z.values,n=d&&d.length===L&&100===d.reduce((J,K)=>J+K,0),D=[0];for(let J=0;J<L;J++){let K=null;n&&(K=d[J]*y/100,D.push(K+D[J]));c.push({shape:{type:"circle",cx:u,cy:u,r:u/2},fill:[0,0,0,0],stroke:{width:u,dashArray:`${(K??l)/2} ${y}`,dashoffset:`-${n?D[J]/2:l/2*J}`,color:v[J]},offset:[0,0]})}L=null;v=2*u+(a?.width||0);if(y=z.holePercentage)a&&c.push({shape:{type:"circle",cx:u,cy:u,r:u*y},fill:null,stroke:a,offset:[0,0]}),L=v/2,L=[[{shape:{type:"circle",cx:L,cy:L,r:L},fill:A,
stroke:a?{...a,color:A}:null,offset:[0,0]},{shape:{type:"circle",cx:L,cy:L,r:u*y},fill:[0,0,0],stroke:null,offset:[0,0]}]];return m.renderSymbol([c],[v,v],{effectView:z.effectList,ignoreStrokeWidth:!0,masking:L,rotations:[-90],ariaLabel:z.ariaLabel})};k.renderPreviewHTML=f;k.renderRelationshipRampPreviewHTML=function(v,z={}){const u=v?.authoringInfo;if("relationship"!==u?.type||!u?.numClasses||!v.uniqueValueInfos)return null;const {focus:y,numClasses:L}=u,l=t.getRelationshipRampElement({focus:y,numClasses:L,
infos:v.uniqueValueInfos});v=z?.node||document.createElement("div");m.renderOnce(v,()=>O.renderRelationshipRamp(l,z.id||"relationship",{opacity:z.opacity||1,effectList:z.effectList,ariaLabel:z.ariaLabel}));return v};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(b,k){function e(B,x){return Math.round(Math.min(Math.max(B+191.25*x,0),255))}b.SymbolSizeDefaults=void 0;(function(B){B[B.size=22]="size";
B[B.lineWidth=50]="lineWidth";B[B.maxSize=120]="maxSize";B[B.maxOutlineSize=80]="maxOutlineSize";B[B.tallSymbolWidth=20]="tallSymbolWidth"})(b.SymbolSizeDefaults||(b.SymbolSizeDefaults={}));b.adjustColorBrightness=function(B,x){if(null==B)return new k;if("type"in B&&("linear"===B.type||"pattern"===B.type))return B;B=new k(B);return new k([e(B.r,x),e(B.g,x),e(B.b,x),B.a])};b.adjustColorComponentBrightness=e;b.getConeShapes=function(B,x){let F=x?b.SymbolSizeDefaults.tallSymbolWidth:B;x=x?4:6;F=F<=b.SymbolSizeDefaults.size?
F-.5*x:F-x;x=.15*F;const m=F;B-=x;return[{type:"ellipse",cx:.5*F,cy:B,rx:.5*F,ry:x},{type:"path",path:[{command:"M",values:[.5*m,0]},{command:"L",values:[m,B]},{command:"L",values:[0,B]},{command:"Z",values:[]}]}]};b.getCubeShapes=function(B,x){let F=x?b.SymbolSizeDefaults.tallSymbolWidth:B;var m=x?4:6;m=F=F<=b.SymbolSizeDefaults.size?F-.5*m:F-m;x=x?.35*F:.5*F;return[{type:"path",path:[{command:"M",values:[.5*m,0]},{command:"L",values:[m,.5*x]},{command:"L",values:[.5*m,x]},{command:"L",values:[0,
.5*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*m,x]},{command:"L",values:[.5*m,B]},{command:"L",values:[0,B-.5*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*m,x]},{command:"L",values:[.5*m,B]},{command:"L",values:[m,B-.5*x]},{command:"L",values:[m,.5*x]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(B,x){var F=x?b.SymbolSizeDefaults.tallSymbolWidth:B;x=x?4:6;F=F<=b.SymbolSizeDefaults.size?F-.5*x:F-x;x=
.5*F;const m=.15*F;B-=m;return[{type:"ellipse",cx:.5*F,cy:B,rx:x,ry:m},{type:"path",path:[{command:"M",values:[0,m]},{command:"L",values:[0,B]},{command:"L",values:[F,B]},{command:"L",values:[F,m]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*F,cy:m,rx:x,ry:m}]};b.getDiamondShapes=function(B){var x=B;x=x<b.SymbolSizeDefaults.size?x-2:x-4;const F=Math.floor(B/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[x,.5*B-F]},{command:"L",values:[.45*x-F,.5*B+F]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*x,0]},{command:"L",values:[.45*x-F,.5*B+F]},{command:"L",values:[0,.5*B-F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*B-F]},{command:"L",values:[.45*x-F,.5*B+F]},{command:"L",values:[.45*x,B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*x,B]},{command:"L",values:[x,.5*B-F]},{command:"L",values:[.45*x-F,.5*B+F]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(B){const x=b.SymbolSizeDefaults.size;
B*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*x]},{command:"L",values:[.3*x,.7*x]},{command:"L",values:[.3*x,.7*x+B]},{command:"L",values:[0,.7*x+B-.35*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*x,.7*x]},{command:"L",values:[.3*x,.7*x+B]},{command:"L",values:[x,B]},{command:"L",values:[x,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*x,0]},{command:"L",values:[x,0]},{command:"L",values:[.3*x,.7*x]},{command:"L",values:[0,.35*x]},
{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(B){let x=B;x=x<b.SymbolSizeDefaults.size?x-3:x-6;const F=.15*x,m=x;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[m,0]},{command:"L",values:[.5*m,B-F]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*x,cy:0,rx:.5*x,ry:F}]};b.getPathSymbolShapes=function(B,x,F){var m=b.SymbolSizeDefaults.size;let H=m,O=m;1>B?H*=.75:1<B&&(O*=1.25);B=m;x&&F&&(H=O=B=m=0);return[{type:"path",path:[{command:"M",values:[B,0]},{command:"L",
values:[F?B:.875*B,0]},{command:"L",values:[F?H-.5*B:0,O-.5*m]},{command:"L",values:[H-.5*B,O-.5*m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[B,0]},{command:"L",values:[B,x?0:.125*m]},{command:"L",values:[H-.5*B,x?O-.5*m:m]},{command:"L",values:[H-.5*B,O-.5*m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[H-.5*B,O-.5*m]},{command:"L",values:[F?H-.5*B:0,O-.5*m]},{command:"L",values:[F?H-.5*B:0,x?O-.5*m:m]},{command:"L",values:[H-.5*B,x?O-.5*m:m]},{command:"Z",
values:[]}]}]};b.getTetrahedronShapes=function(B){var x=B;x=x<b.SymbolSizeDefaults.size?x-1:x-2;return[{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",values:[B,x]},{command:"L",values:[.45*B,.6*x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",values:[.45*B,.6*x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[.45*B,.6*x]},{command:"L",values:[B,x]},{command:"Z",values:[]}]}]};
b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(b,k,e,B,x,F,m,H,O,t){function w(q,p){r.append(q,p);r.detach(p)}function f(q,p,A){return q?e(q,{responseType:"image"}).then(v=>{v=v.data;const z=v.width,u=
v.height,y=z/u;let L=p;A&&(L=Math.min(L,Math.max(z,u)));return{image:v,width:1>=y?Math.ceil(L*y):L,height:1>=y?L:Math.ceil(L/y)}}):Promise.reject(new x("renderUtils: imageDataSize","href not provided."))}const r=H.createProjector();b.renderOnce=w;b.renderSymbol=function(q,p,A){const v=Math.ceil(p[0]),z=Math.ceil(p[1]);if(!q.some(u=>!!u.length))return null;p=A?.node||document.createElement("div");null!=A.opacity&&(p.style.opacity=A.opacity.toString());null!=A.effectView&&(p.style.filter=t.getCSSFilterFromEffectList(A.effectView));
w(p,()=>O.renderSVG(q,v,z,A));return p};b.tintImageWithColor=function(q,p,A,v,z){return f(q,p,z).then(u=>{const y=u.width??p,L=u.height??p;var l;if(l=u.image)l=A&&"ignore"!==v?"multiply"===v&&255===A.r&&255===A.g&&255===A.b&&1===A.a?!1:!0:!1;if(l){var c=u.image.width,a=u.image.height;F("edge")&&/\.svg$/i.test(q)&&(--c,--a);l=Math.ceil(y);var d=Math.ceil(L);var n=document.createElement("canvas");n.width=l;n.height=d;n.style.width=l+"px";n.style.height=d+"px";n=n.getContext("2d");n.clearRect(0,0,l,
d);l=n;l.drawImage(u.image,0,0,c,a,0,0,y,L);d=l.getImageData(0,0,y,L);n=[A.r/255,A.g/255,A.b/255,A.a];const J=B.toHSV(A);for(let K=0;K<d.data.length;K+=4){u=d.data;c=K;a=n;var D=J;switch(v){case "multiply":u[c]*=a[0];u[c+1]*=a[1];u[c+2]*=a[2];u[c+3]*=a[3];break;default:const N=B.toHSV({r:u[c],g:u[c+1],b:u[c+2]});N.h=D.h;N.s=D.s;N.v=N.v/100*D.v;D=B.toRGB(N);u[c]=D.r;u[c+1]=D.g;u[c+2]=D.b;u[c+3]*=a[3]}}l.putImageData(d,0,0);q=l.canvas.toDataURL("image/png")}else l=k.id?.findCredential(q),l?.token&&
(u=q.includes("?")?"\x26":"?",q=`${q}${u}token=${l.token}`);return{url:q,width:y,height:L}}).catch(()=>({url:q,width:p,height:p}))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ./svgGlobalState ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(b,
k,e,B,x,F,m,H,O,t){function w(h,C){h*=Q/180;return Math.abs(C*Math.sin(h))+Math.abs(C*Math.cos(h))}function f(h){return h.map(C=>`${C.command} ${C.values.join(" ")}`).join(" ").trim()}function r(h,C,I,g,E){if(h){if("circle"===h.type)return t.tsx("circle",{cx:h.cx,cy:h.cy,fill:C,"fill-rule":"evenodd",r:h.r,stroke:I.color,"stroke-dasharray":I.dashArray,"stroke-dashoffset":I.dashOffset,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-miterlimit":"4","stroke-width":I.width});if("ellipse"===h.type)return t.tsx("ellipse",
{cx:h.cx,cy:h.cy,fill:C,"fill-rule":"evenodd",rx:h.rx,ry:h.ry,stroke:I.color,"stroke-dasharray":I.dashArray,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-miterlimit":"4","stroke-width":I.width});if("rect"===h.type)return t.tsx("rect",{fill:C,"fill-rule":"evenodd",height:h.height,stroke:I.color,"stroke-dasharray":I.dashArray,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-miterlimit":"4","stroke-width":I.width,width:h.width,x:h.x,y:h.y});if("image"===h.type)return t.tsx("image",{alt:E||
"image",height:h.height,href:h.src,preserveAspectRatio:"none",width:h.width,x:h.x,y:h.y});if("path"===h.type)return h="string"!==typeof h.path?f(h.path):h.path,t.tsx("path",{d:h,fill:C,"fill-rule":"evenodd",stroke:I.color,"stroke-dasharray":I.dashArray,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-miterlimit":"4","stroke-width":I.width});if("text"===h.type)return B.assertIsSome(g),t.tsx("text",{"dominant-baseline":g.dominantBaseline,fill:C,"fill-rule":"evenodd","font-family":g.font.family,
"font-size":g.font.size,"font-style":g.font.style,"font-variant":g.font.variant,"font-weight":g.font.weight,kerning:g.kerning,rotate:g.rotate,stroke:I.color,"stroke-dasharray":I.dashArray,"stroke-linecap":I.cap,"stroke-linejoin":I.join,"stroke-miterlimit":"4","stroke-width":I.width,"text-anchor":g.align,"text-decoration":g.decoration,"text-rendering":D,x:h.x,y:h.y},h.text)}return null}function q(h){if(!h)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in h))return{fill:(new k(h)).toString(),
pattern:null,linearGradient:null};if("pattern"===h.type){var C=`patternId-${H.nextPatternId()}`;return{fill:`url(#${C})`,pattern:{id:C,x:h.x,y:h.y,width:h.width,height:h.height,image:{x:0,y:0,width:h.width,height:h.height,href:h.src}},linearGradient:null}}C=`linearGradientId-${H.nextLinearGradientId()}`;return{fill:`url(#${C})`,pattern:null,linearGradient:{id:C,x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,stops:h.colors.map(I=>({offset:I.offset,color:I.color&&(new k(I.color)).toString()}))}}}function p(h){const C=
{color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};h&&(null!=h.width&&(C.width=h.width),h.cap&&(C.cap=h.cap),h.join&&(C.join=h.join.toString()),h.color&&(C.color=(new k(h.color)).toString()),h.dashArray&&(C.dashArray=h.dashArray),h.dashoffset&&(C.dashOffset=h.dashoffset),h.style&&!h.dashArray&&(C.dashArray=m.getDashArray(h).join(",")||"none"));return C}function A(h,C){const I={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,
family:null}};if(h){const g=h.alignBaseline;I.align=h.align;I.dominantBaseline="baseline"===g?"auto":"top"===g?"text-top":"bottom"===g?"hanging":g;I.decoration=h.decoration;I.kerning=h.kerning?"auto":"0";I.rotate=h.rotated?"90":"0";B.assertIsSome(C);I.font.style=C.style||"normal";I.font.variant=C.variant||"normal";I.font.weight=C.weight||"normal";I.font.size=C.size&&C.size.toString()||"10pt";I.font.family=C.family||"serif"}return I}function v(h){const {pattern:C,linearGradient:I}=h;return C?t.tsx("pattern",
{height:C.height,id:C.id,patternUnits:"userSpaceOnUse",width:C.width,x:C.x,y:C.y},t.tsx("image",{height:C.image.height,href:C.image.href,width:C.image.width,x:C.image.x,y:C.image.y})):I?(h=I.stops.map((g,E)=>t.tsx("stop",{key:`${E}-stop`,offset:g.offset,"stop-color":g.color})),t.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:I.id,x1:I.x1,x2:I.x2,y1:I.y1,y2:I.y2},h)):null}function z(h,C){if(!h||0===h.length)return null;const I=[];for(const g of h){const {shape:E,fill:P,stroke:R,font:V}=g;
h=q(P);const T=p(R),X="text"===E.type?A(E,V):null;(h=r(E,h.fill,T,X))&&I.push(h)}return t.tsx("mask",{id:C,maskUnits:"userSpaceOnUse"},t.tsx("g",null,I))}function u(h,C,I,g,E){F.scale(h,F.identity(h),[C,I]);h[4]=h[4]*C-g*C+g;h[5]=h[5]*I-E*I+E;return h}function y(h,C){if(N&&"left"in N){null!=N.left&&N.left>h&&(N.left=h);if(null==N.right||N.right<h)N.right=h;if(null==N.top||N.top>C)N.top=C;if(null==N.bottom||N.bottom<C)N.bottom=C}else N={left:h,bottom:C,right:h,top:C}}function L(h){const C=h.args,I=
C.length;switch(h.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(h=0;h<I;h+=2)y(C[h],C[h+1]);G.x=C[I-2];G.y=C[I-1];break;case "H":for(h=0;h<I;++h)y(C[h],G.y);G.x=C[I-1];break;case "V":for(h=0;h<I;++h)y(G.x,C[h]);G.y=C[I-1];break;case "m":h=0;"x"in G||(y(G.x=C[0],G.y=C[1]),h=2);for(;h<I;h+=2)y(G.x+=C[h],G.y+=C[h+1]);break;case "l":case "t":for(h=0;h<I;h+=2)y(G.x+=C[h],G.y+=C[h+1]);break;case "h":for(h=0;h<I;++h)y(G.x+=C[h],G.y);break;case "v":for(h=0;h<I;++h)y(G.x,G.y+=C[h]);break;
case "c":for(h=0;h<I;h+=6)y(G.x+C[h],G.y+C[h+1]),y(G.x+C[h+2],G.y+C[h+3]),y(G.x+=C[h+4],G.y+=C[h+5]);break;case "s":case "q":for(h=0;h<I;h+=4)y(G.x+C[h],G.y+C[h+1]),y(G.x+=C[h+2],G.y+=C[h+3]);break;case "A":for(h=0;h<I;h+=7)y(C[h+5],C[h+6]);G.x=C[I-2];G.y=C[I-1];break;case "a":for(h=0;h<I;h+=7)y(G.x+=C[h+5],G.y+=C[h+6])}}function l(h,C,I){const g=J[h.toLowerCase()];"number"===typeof g&&(g?C.length>=g&&(h={action:h,args:C.slice(0,C.length-C.length%g)},I.push(h),L(h)):(h={action:h,args:[]},I.push(h),
L(h)))}function c(h){const C={x:0,y:0,width:0,height:0};if("circle"===h.type)C.x=h.cx-h.r,C.y=h.cy-h.r,C.width=2*h.r,C.height=2*h.r;else if("ellipse"===h.type)C.x=h.cx-h.rx,C.y=h.cy-h.ry,C.width=2*h.rx,C.height=2*h.ry;else if("image"===h.type||"rect"===h.type)C.x=h.x,C.y=h.y,C.width=h.width,C.height=h.height;else if("path"===h.type){{const E=("string"!==typeof h.path?f(h.path):h.path).match(K),P=[];N={};G={};if(E){h="";var I=[],g=E.length;for(let R=0;R<g;++R){const V=E[R],T=parseFloat(V);isNaN(T)?
(h&&l(h,I,P),I=[],h=V):I.push(T)}l(h,I,P);h={x:0,y:0,width:0,height:0};N&&"left"in N&&(h.x=N.left,h.y=N.top,h.width=N.right-N.left,h.height=N.bottom-N.top)}else h=null}C.x=h.x;C.y=h.y;C.width=h.width;C.height=h.height}return C}function a(h){const C={x:0,y:0,width:0,height:0};let I=null,g=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(const P of h)I?(I.x=Math.min(I.x,P.x),I.y=Math.min(I.y,P.y),g=Math.max(g,P.x+P.width),E=Math.max(E,P.y+P.height)):(I=C,I.x=P.x,I.y=P.y,g=P.x+P.width,E=P.y+P.height);
I&&(I.width=g-I.x,I.height=E-I.y);return I}function d(h,C,I,g,E,P,R,V,T){var X=(R&&P?w(P,C):C)/2,Z=(R&&P?w(P,I):I)/2;if(T){var ba=T[0];T=T[1];X=(R&&P?w(P,ba):ba)/2;Z=(R&&P?w(P,T):T)/2}ba=h.width+g;const W=h.height+g;R=x.create();T=x.create();var ea=!1;if(E&&0!==ba&&0!==W){E=C!==I?C/I:ba/W;ea=C>I?C:I;let fa=1,da=1;isNaN(ea)||(1<E?(fa=ea/ba,da=ea/E/W):(da=ea/W,fa=ea*E/ba));F.multiply(T,T,u(R,fa,da,X,Z));ea=!0}E=h.x+(ba-g)/2;h=h.y+(W-g)/2;g=F.multiply;X-=E;Z-=h;X=F.translate(R,F.identity(R),[X,Z]);g.call(F,
T,T,X);!ea&&(ba>C||W>I)&&(X=ba/C>W/I,C=(X?C:I)/(X?ba:W),F.multiply(T,T,u(R,C,C,E,h)));V&&(C=F.multiply,I=V[0],V=V[1],V=F.translate(R,F.identity(R),[I,V]),C.call(F,T,T,V));P&&(V=F.multiply,C=P%360*Math.PI/180,F.rotate(R,F.identity(R),C),P=Math.cos(C),C=Math.sin(C),I=R[4],ba=R[5],R[4]=I*P-ba*C+h*C-E*P+E,R[5]=ba*P+I*C-E*C-h*P+h,V.call(F,T,T,R));return`matrix(${T[0]},${T[1]},${T[2]},${T[3]},${T[4]},${T[5]})`}function n(h,C,I){h=h?.effects.find(V=>"bloom"===V.type);if(!h)return null;const {strength:g,
radius:E}=h;h=0<g?E:0;const P=(g+h)*C,R=4*g+1;return t.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${I}`,width:"300%",x:"-100%",y:"-100%"},t.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(g+.5*h)*5**(C/100)*(.4+C/100),result:"dilate"}),t.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:P/25}),t.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:P/50}),t.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
t.tsx("feFuncR",{slope:R,type:"linear"}),t.tsx("feFuncG",{slope:R,type:"linear"}),t.tsx("feFuncB",{slope:R,type:"linear"})),t.tsx("feMerge",null,t.tsx("feMergeNode",{in:"intensityBlur"}),t.tsx("feMergeNode",{in:"intensityBrightness"}),t.tsx("feGaussianBlur",{stdDeviation:g/10})))}O=e("android");const D=e("chrome")||O&&4<=O?"auto":"optimizeLegibility",J={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},K=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let N={},G={};const Q=Math.PI;b.computeBBox=a;b.generateFillAttributes=
q;b.generateStrokeAttributes=p;b.generateTextAttributes=A;b.getBoundingBox=c;b.getTransformMatrix=d;b.renderDef=v;b.renderSVG=function(h,C,I,g={}){const E=[],P=[],R=H.nextBloomId(),V=n(g.effectView,C,R);var T=null;V&&(T=g.effectView?.effects.find(M=>"bloom"===M.type),T=(T.strength?T.strength+T.radius/2:0)/3,T=[Math.max(C+C*T,10),Math.max(I+I*T,10)]);let X=C,Z=I;if(g.useRotationSize)for(var ba=0;ba<h.length;ba++){var W=g.rotations?.[ba]??0;X=Math.max(w(W,C),X);Z=Math.max(w(W,I),Z)}for(ba=0;ba<h.length;ba++){var ea=
h[ba];W=[];var fa=[],da=0,ha=0;let M=0;for(const S of ea){const {shape:U,fill:Y,stroke:ca,font:aa,offset:ja}=S;g.ignoreStrokeWidth||"text"===U.type||(da+=ca?.width||0);ea=q(Y);const ia=p(ca),ka="text"===U.type?A(U,aa):null;E.push(v(ea));W.push(r(U,ea.fill,ia,ka,g.ariaLabel));fa.push(c(U));ja&&(ha+=ja[0],M+=ja[1])}ea=g.rotations?.[ba]??0;g.useRotationSize&&(ha+=(X-w(ea,C))/2,M+=(Z-w(ea,I))/2);fa=a(fa);da=d(fa,C,I,da,g.scale??!1,ea,g.useRotationSize??!1,[ha,M],T);ha=null;g.masking&&(ha=`mask-${ba}`,
E.push(z(g.masking[ba],ha)),ha=`url(#${ha})`);P.push(ha?t.tsx("g",{mask:ha},t.tsx("g",{transform:da},W)):t.tsx("g",{transform:da},W))}V&&(B.assertIsSome(T),X=T[0],Z=T[1]);return t.tsx("svg",{"aria-label":g.ariaLabel,focusable:!1,height:Z,role:"img",style:"display: block;",width:X,xmlns:"http://www.w3.org/2000/svg"},V,t.tsx("defs",null,E),V?t.tsx("g",{filter:`url(#bloom${R})`},P):P)};b.renderShape=r;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],
function(b){function k(){const O=new Float32Array(6);O[0]=1;O[3]=1;return O}function e(O){const t=new Float32Array(6);t[0]=O[0];t[1]=O[1];t[2]=O[2];t[3]=O[3];t[4]=O[4];t[5]=O[5];return t}function B(O,t,w,f,r,q){const p=new Float32Array(6);p[0]=O;p[1]=t;p[2]=w;p[3]=f;p[4]=r;p[5]=q;return p}function x(O,t){return new Float32Array(O,t,6)}function F(O,t,w,f){const r=t[f];t=t[f+1];O[f]=w[0]*r+w[2]*t+w[4];O[f+1]=w[1]*r+w[3]*t+w[5]}function m(O,t,w,f=0,r=0,q=2){for(r=r||t.length/q;f<r;f++)F(O,t,w,f*q)}const H=
Object.freeze(Object.defineProperty({__proto__:null,clone:e,create:k,createView:x,fromValues:B,transform:F,transformMany:m},Symbol.toStringTag,{value:"Module"}));b.clone=e;b.create=k;b.createView=x;b.fromValues=B;b.mat2df32=H;b.transform=F;b.transformMany=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(b,k){function e(a,d){a[0]=d[0];a[1]=d[1];a[2]=d[2];a[3]=d[3];a[4]=d[4];a[5]=d[5];return a}
function B(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function x(a,d,n,D,J,K,N){a[0]=d;a[1]=n;a[2]=D;a[3]=J;a[4]=K;a[5]=N;return a}function F(a,d){const n=d[0],D=d[1],J=d[2],K=d[3],N=d[4];d=d[5];let G=n*K-D*J;if(!G)return null;G=1/G;a[0]=K*G;a[1]=-D*G;a[2]=-J*G;a[3]=n*G;a[4]=(J*d-K*N)*G;a[5]=(D*N-n*d)*G;return a}function m(a){return a[0]*a[3]-a[1]*a[2]}function H(a,d,n){const D=d[0],J=d[1],K=d[2],N=d[3],G=d[4];d=d[5];const Q=n[0],h=n[1],C=n[2],I=n[3],g=n[4];n=n[5];a[0]=D*Q+K*h;a[1]=J*Q+
N*h;a[2]=D*C+K*I;a[3]=J*C+N*I;a[4]=D*g+K*n+G;a[5]=J*g+N*n+d;return a}function O(a,d,n){const D=d[0],J=d[1],K=d[2],N=d[3],G=d[4];d=d[5];const Q=Math.sin(n);n=Math.cos(n);a[0]=D*n+K*Q;a[1]=J*n+N*Q;a[2]=D*-Q+K*n;a[3]=J*-Q+N*n;a[4]=G;a[5]=d;return a}function t(a,d,n){const D=d[1],J=d[2],K=d[3],N=d[4],G=d[5],Q=n[0];n=n[1];a[0]=d[0]*Q;a[1]=D*Q;a[2]=J*n;a[3]=K*n;a[4]=N;a[5]=G;return a}function w(a,d,n){const D=d[0],J=d[1],K=d[2],N=d[3],G=d[4];d=d[5];const Q=n[0];n=n[1];a[0]=D;a[1]=J;a[2]=K;a[3]=N;a[4]=D*
Q+K*n+G;a[5]=J*Q+N*n+d;return a}function f(a,d){const n=Math.sin(d);d=Math.cos(d);a[0]=d;a[1]=n;a[2]=-n;a[3]=d;a[4]=0;a[5]=0;return a}function r(a,d){a[0]=d[0];a[1]=0;a[2]=0;a[3]=d[1];a[4]=0;a[5]=0;return a}function q(a,d){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=d[0];a[5]=d[1];return a}function p(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function A(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+1)}function v(a,d,n){a[0]=d[0]+n[0];a[1]=d[1]+n[1];a[2]=
d[2]+n[2];a[3]=d[3]+n[3];a[4]=d[4]+n[4];a[5]=d[5]+n[5];return a}function z(a,d,n){a[0]=d[0]-n[0];a[1]=d[1]-n[1];a[2]=d[2]-n[2];a[3]=d[3]-n[3];a[4]=d[4]-n[4];a[5]=d[5]-n[5];return a}function u(a,d,n){a[0]=d[0]*n;a[1]=d[1]*n;a[2]=d[2]*n;a[3]=d[3]*n;a[4]=d[4]*n;a[5]=d[5]*n;return a}function y(a,d,n,D){a[0]=d[0]+n[0]*D;a[1]=d[1]+n[1]*D;a[2]=d[2]+n[2]*D;a[3]=d[3]+n[3]*D;a[4]=d[4]+n[4]*D;a[5]=d[5]+n[5]*D;return a}function L(a,d){return a[0]===d[0]&&a[1]===d[1]&&a[2]===d[2]&&a[3]===d[3]&&a[4]===d[4]&&a[5]===
d[5]}function l(a,d){const n=a[0],D=a[1],J=a[2],K=a[3],N=a[4];a=a[5];const G=d[0],Q=d[1],h=d[2],C=d[3],I=d[4];d=d[5];const g=k.getEpsilon();return Math.abs(n-G)<=g*Math.max(1,Math.abs(n),Math.abs(G))&&Math.abs(D-Q)<=g*Math.max(1,Math.abs(D),Math.abs(Q))&&Math.abs(J-h)<=g*Math.max(1,Math.abs(J),Math.abs(h))&&Math.abs(K-C)<=g*Math.max(1,Math.abs(K),Math.abs(C))&&Math.abs(N-I)<=g*Math.max(1,Math.abs(N),Math.abs(I))&&Math.abs(a-d)<=g*Math.max(1,Math.abs(a),Math.abs(d))}const c=Object.freeze(Object.defineProperty({__proto__:null,
add:v,copy:e,determinant:m,equals:l,exactEquals:L,frob:A,fromRotation:f,fromScaling:r,fromTranslation:q,identity:B,invert:F,mul:H,multiply:H,multiplyScalar:u,multiplyScalarAndAdd:y,rotate:O,scale:t,set:x,str:p,sub:z,subtract:z,translate:w},Symbol.toStringTag,{value:"Module"}));b.add=v;b.copy=e;b.determinant=m;b.equals=l;b.exactEquals=L;b.frob=A;b.fromRotation=f;b.fromScaling=r;b.fromTranslation=q;b.identity=B;b.invert=F;b.mat2d=c;b.mul=H;b.multiply=H;b.multiplyScalar=u;b.multiplyScalarAndAdd=y;b.rotate=
O;b.scale=t;b.set=x;b.str=p;b.sub=z;b.subtract=z;b.translate=w;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgGlobalState":function(){define(["exports"],function(b){function k(H=0){x=H}function e(H=0){F=H}function B(H=0){m=H}let x=0,F=0,m=0;b.nextBloomId=function(){return m++};b.nextLinearGradientId=function(){return F++};b.nextPatternId=function(){return x++};b.resetBloomId=B;b.resetLinearGradientId=e;b.resetPatternId=k;b.resetSVGGlobalState=function(){k();
e();B()};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(b,k,e,B,x){function F(O,t,w){const f=`${w}_arrowStart`;w=`${w}_arrowEnd`;O="left"===O;const r={markerStart:null,markerEnd:null};switch(t){case "HL":O?r.markerStart=`url(#${w})`:r.markerEnd=`url(#${f})`;
break;case "LL":r.markerStart=`url(#${w})`;break;case "LH":O?r.markerEnd=`url(#${f})`:r.markerStart=`url(#${w})`;break;default:r.markerEnd=`url(#${f})`}return r}function m(O,t,w={}){const {focus:f,numClasses:r,colors:q,rotation:p}=O,{opacity:A,effectList:v,ariaLabel:z}=w;O=w.size??60;w=!!f;const u=Math.sqrt(O**2+O**2)+(w?0:5),y=[],L=[];var l=[],c=(O||75)/r;for(var a=0;a<r;a++){var d=a*c;for(var n=0;n<r;n++){var D=n*c,J=k.generateFillAttributes(q[a][n]);const K=k.generateStrokeAttributes(null);D={type:"rect",
x:D,y:d,width:c,height:c};const N=k.renderDef(J);N&&y.push(N);(J=k.renderShape(D,J.fill,K,null))&&L.push(J);l.push(k.getBoundingBox(D))}}c=null;w||(c="margin: -15px -15px -18px -15px");a=F("left",f,t);d=F("right",f,t);n=k.computeBBox(l);l=k.getTransformMatrix(n,u,u,0,!1,p,!1);n=k.getTransformMatrix(n,u,u,0,!1,w?-45:null,!1);J={filter:e.getCSSFilterFromEffectList(v)??void 0,opacity:null==A?"":`${A}`};return x.tsx("div",{class:w?H.diamondMidColRamp:H.squareTableCell,styles:J},x.tsx("svg",{"aria-label":z,
focusable:!1,height:u,role:"image",style:c,width:u,xmlns:"http://www.w3.org/2000/svg"},x.tsx("defs",null,x.tsx("marker",{id:`${t}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},x.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),x.tsx("marker",{id:`${t}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},x.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",
stroke:"#555555","stroke-width":"1"})),y),x.tsx("g",{transform:l},L),x.tsx("g",{transform:n},x.tsx("line",{fill:"none","marker-end":a.markerEnd,"marker-start":a.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:O-15,y2:15}),x.tsx("line",{fill:"none","marker-end":d.markerEnd,"marker-start":d.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:O-15,y1:O+10,y2:O+10}))))}const H={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",
diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",
squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};b.renderRelationshipRamp=function(O,t,w={}){const {focus:f,labels:r}=O,q=!!f;O=m(O,t,w);const p={justifyContent:"center"},A=B.isRTL();t=w.key??t;return q?x.tsx("div",
{class:H.diamondContainer,key:`${t}-container`,styles:p},x.tsx("div",{class:H.diamondLeftCol},A?r.right:r.left),x.tsx("div",{class:H.diamondMidCol},x.tsx("div",{class:H.diamondMidColLabel},r.top),O,x.tsx("div",{class:H.diamondMidColLabel},r.bottom)),x.tsx("div",{class:H.diamondRightCol},A?r.left:r.right)):x.tsx("div",{class:H.squareTable,key:`${t}-container`},x.tsx("div",{class:H.squareTableRow},x.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelRightBottom)},A?r.top:
r.left),x.tsx("div",{class:H.squareTableCell}),x.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelLeftBottom)},A?r.left:r.top)),x.tsx("div",{class:H.squareTableRow},x.tsx("div",{class:H.squareTableCell}),O,x.tsx("div",{class:H.squareTableCell})),x.tsx("div",{class:H.squareTableRow},x.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelRightTop)},A?r.right:r.bottom),x.tsx("div",{class:H.squareTableCell}),x.tsx("div",{class:B.classes(H.squareTableCell,
H.squareTableLabel,H.squareTableLabelLeftTop)},A?r.bottom:r.right)))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(b,k,e,B){function x(t){if(t){var {type:w}=t;return w.includes("3d")?B.getSymbolLayerFill(t.symbolLayers.at(0)):"simple-line"===w||"simple-marker"===t.type&&("x"===t.style||"cross"===
t.style)?(t=e.getStroke(t))&&t.color:e.getFill(t)}}function F(t,w){const f=w.HH.label,r=w.LL.label,q=w.HL.label;w=w.LH.label;switch(t){case "HH":return{top:f,bottom:r,left:q,right:w};case "HL":return{top:q,bottom:w,left:r,right:f};case "LL":return{top:r,bottom:f,left:w,right:q};case "LH":return{top:w,bottom:q,left:f,right:r};default:return{top:f,bottom:r,left:q,right:w}}}function m(t){let w=H[t];t&&null==w&&(w=H.HH);return w||0}const H={HH:315,HL:45,LL:135,LH:225},O={2:[["HL","HH"],["LL","LH"]],3:[["HL",
"HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};b.getRelationshipRampColors2D=function(t,w){const f=[],r=t.length**.5;t=k.clone(t);var q=(w||"HH").split("");w=q[0];for(q="H"===q[1];t.length;){const p=[];for(;p.length<r;)p.push(t.shift());q&&p.reverse();f.push(p)}"L"===w&&f.reverse();return f};b.getRelationshipRampElement=function(t){const {focus:w,infos:f,numClasses:r}=t;var q=O[r];const p={};
f.forEach(A=>{p[A.value]={label:A.label,fill:x(A.symbol)}});t=[];for(let A=0;A<r;A++){const v=[];for(let z=0;z<r;z++)v.push(p[q[A][z]].fill);t.push(v)}q=F(w,p);return{type:"relationship-ramp",numClasses:r,focus:w,colors:t,labels:q,rotation:m(w)}};b.getRotationAngleForFocus=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w,f,r,q){function p(g){const E=g.outline;var P=null!=g.material?g.material.color:null;P=null!=P?P.toHex():null;if(null==E||"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type&&"none"===E.pattern.style)return"fill"===g.type&&"#ffffff"===P?{color:"#bdc3c7",width:.75}:null;g=m.pt2px(E.size)||0;return{color:"rgba("+(null!=E.color?E.color.toRgba():"255,255,255,1")+")",width:Math.min(g,h),style:"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type?H.dekebabifyLineStyle(E.pattern.style):
null,join:"butt",cap:"patternCap"in E?E.patternCap:"butt"}}async function A(g,E){if(g.thumbnail?.url)return g.thumbnail.url;if("icon"===E.type&&E?.resource?.href)return r.getIconHref(E);E=k.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return g.styleOrigin&&(g.styleOrigin.styleName||g.styleOrigin.styleUrl)&&(g=await q.resolveWebStyleSymbol(g.styleOrigin,{portal:g.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in g&&g.thumbnail?.url?g.thumbnail.url:E}function v(g,E=1){const P=
g.a;g=e.toHSV(g);const {r:R,g:V,b:T}=e.toRGB({h:g.h,s:g.s/E,v:100-(100-g.v)/E});return[R,V,T,P]}function z(g){return"water"===g.type?null==g.color?null:g.color:null==g.material?.color?null:g.material.color}function u(g,E=0){var P=z(g);if(!P){if("fill"===g.type)return null;E=w.adjustColorComponentBrightness(H.defaultThematicColor.r,E);return[E,E,E,100]}g=P.toRgba();for(P=0;3>P;P++)g[P]=w.adjustColorComponentBrightness(g[P],E);return g}async function y(g,E){g=g.style;return"none"===g?null:{type:"pattern",
x:0,y:0,src:await H.getPatternUrlWithColor(k.getAssetUrl(`esri/symbols/patterns/${g}.png`),E.toCss(!0)),width:5,height:5}}function L(g){return g.outline?p(g):{color:"rgba(0, 0, 0, 1)",width:1.5}}function l(g,E){g=z(g);if(!g)return null;let P;P="rgba("+(w.adjustColorComponentBrightness(g.r,E)+",");P+=w.adjustColorComponentBrightness(g.g,E)+",";P+=w.adjustColorComponentBrightness(g.b,E)+",";return P+g.a+");"}function c(g,E){E=l(g,E);if(!E)return{};if("pattern"in g&&null!=g.pattern&&"style"===g.pattern.type&&
"none"===g.pattern.style)return null;const P=Math.min(g.size?m.pt2px(g.size):.75,h);return{color:E,width:P,style:"pattern"in g&&null!=g.pattern&&"style"===g.pattern.type?H.dekebabifyLineStyle(g.pattern.style):null,cap:"cap"in g?g.cap:null,join:"join"in g?"miter"===g.join?m.pt2px(2):g.join:null}}function a(g,E,P){P=null!=P?.75*P:0;return{type:"linear",x1:P?.25*P:0,y1:P?.5*P:0,x2:P||4,y2:P?.5*P:4,colors:[{color:g,offset:0},{color:E,offset:1}]}}function d(g){const E=g.depth,P=g.height;g=g.width;return 0!==
g&&0!==E&&0!==P&&g===E&&null!=g&&null!=P&&g<P}function n(g,E,P){const R=[];if(!g)return R;switch(g.type){case "icon":switch(g.resource?.primitive??O.defaultPrimitive){case "circle":R.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:u(g,0),stroke:p(g)});break;case "square":R.push({shape:{type:"path",path:[{command:"M",values:[0,E]},{command:"L",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:u(g,0),stroke:p(g)});break;case "triangle":R.push({shape:{type:"path",
path:[{command:"M",values:[0,E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:u(g,0),stroke:p(g)});break;case "cross":R.push({shape:{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[.5*E,E]},{command:"M",values:[0,.5*E]},{command:"L",values:[E,.5*E]}]},stroke:L(g)});break;case "x":R.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,E]},{command:"M",values:[E,0]},{command:"L",values:[0,E]}]},stroke:L(g)});
break;case "kite":R.push({shape:{type:"path",path:[{command:"M",values:[0,.5*E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,.5*E]},{command:"L",values:[.5*E,E]},{command:"Z",values:[]}]},fill:u(g,0),stroke:p(g)})}break;case "object":switch(g.resource?.primitive??t.defaultPrimitive){case "cone":var V=u(g,0);g=u(g,-.6);g=a(V,g,P?I:E);E=w.getConeShapes(E,P);R.push({shape:E[0],fill:g},{shape:E[1],fill:g});break;case "inverted-cone":P=u(g,0);g=u(g,-.6);g=a(P,g,E);E=w.getInvertedConeShapes(E);
R.push({shape:E[0],fill:g},{shape:E[1],fill:P});break;case "cube":E=w.getCubeShapes(E,P);R.push({shape:E[0],fill:u(g,0)},{shape:E[1],fill:u(g,-.3)},{shape:E[2],fill:u(g,-.5)});break;case "cylinder":V=u(g,0);const T=u(g,-.6);V=a(V,T,P?I:E);E=w.getCylinderShapes(E,P);R.push({shape:E[0],fill:V},{shape:E[1],fill:V},{shape:E[2],fill:u(g,0)});break;case "diamond":E=w.getDiamondShapes(E);R.push({shape:E[0],fill:u(g,-.3)},{shape:E[1],fill:u(g,0)},{shape:E[2],fill:u(g,-.3)},{shape:E[3],fill:u(g,-.7)});break;
case "sphere":P=u(g,0);g=u(g,-.6);g=a(P,g);g.x1=0;g.y1=0;g.x2=.25*E;g.y2=.25*E;R.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:g});break;case "tetrahedron":E=w.getTetrahedronShapes(E),R.push({shape:E[0],fill:u(g,-.3)},{shape:E[1],fill:u(g,0)},{shape:E[2],fill:u(g,-.6)})}}return R}function D(g){return(g="number"===typeof g?.size?g?.size:null)?m.pt2px(g):null}async function J(g,E){const P=D(E),R=E?.maxSize?m.pt2px(E.maxSize):null,V=E?.disableUpsampling??!1,T=[],X=[];let Z=!1,ba=0,W=0,ea=0;g.symbolLayers.forEach(da=>
{if("icon"===da.type||"object"===da.type){da&&"icon"===da.type&&(ea=Math.max(da.size&&m.pt2px(da.size),ea));var ha="icon"===da.type?da.size&&m.pt2px(da.size):0,M=P||ha?Math.ceil(Math.min(P||ha,R||Q)):G,S="icon"===da.type?da.angle:null;null!=E?.rotation&&(S=(S??0)+E.rotation);X.push(S);if(da?.resource?.href){var U=A(g,da).then(Y=>{const ca=da?.material?.color;var aa="icon"===da.type?"multiply":"tint";return f.tintImageWithColor(Y,M,ca,aa,V)}).then(Y=>{const ca=Y.width,aa=Y.height;ba=Math.max(ba,ca);
W=Math.max(W,aa);S&&(Z=!0);return[{shape:{type:"image",x:0,y:0,width:ca,height:aa,src:Y.url},fill:null,stroke:null}]});T.push(U)}else U=M,"icon"===da.type&&P&&(U=ha/ea*M),ha="tall"===E?.symbolConfig||E?.symbolConfig?.isTall||("object"===da.type?d(da):!1),ba=Math.max(ba,ha?I:U),W=Math.max(W,U),S&&da.resource?.primitive&&["square","triangle","x"].includes(da.resource?.primitive)&&(Z=!0),T.push(Promise.resolve(n(da,U,ha)))}});const fa=[];(await Promise.allSettled(T)).forEach(da=>{"fulfilled"===da.status?
fa.push(da.value):da.reason&&F.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",da.reason)});return f.renderSymbol(fa,[ba,W],{node:E?.node,scale:!1,opacity:E?.opacity,ariaLabel:E?.ariaLabel,rotations:X,useRotationSize:Z})}function K(g,E){const P=g.symbolLayers,R=[];g=r.isVolumetricSymbol(g);const V=D(E),T=(E?.maxSize?m.pt2px(E.maxSize):null)||h;let X=0,Z=0,ba;P.forEach((W,ea)=>{if(W&&("line"===W.type||"path"===W.type)){var fa=[];switch(W.type){case "line":var da=
c(W,0);if(null==da)break;var ha=da?.width||0;0===ea&&(ba=ha);W=Math.min(V||ha,T);ea=0===ea?W:V?ha/ba*W:W;ha=ea>C/2?2*ea:C;Z=Math.max(Z,ea);X=Math.max(X,ha);da.width=ea;fa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Z]},{command:"L",values:[X,.5*Z]}]},stroke:da});break;case "path":da=Math.min(V||G,T);ea=u(W,0);ha=u(W,-.2);var M=l(W,-.4);M=M?{color:M,width:1}:{};if("quad"===W.profile){const S=W.width;W=W.height;W=w.getPathSymbolShapes(S&&W?S/W:1,0===W,0===S);M={...M,join:"bevel"};fa.push({shape:W[0],
fill:ha,stroke:M},{shape:W[1],fill:ha,stroke:M},{shape:W[2],fill:ea,stroke:M})}else fa.push({shape:w.shapes.pathSymbol3DLayer[0],fill:ha,stroke:M},{shape:w.shapes.pathSymbol3DLayer[1],fill:ea,stroke:M});X=Z=Math.max(Z,da)}R.push(fa)}});return Promise.resolve(f.renderSymbol(R,[X,Z],{node:E?.node,scale:g,opacity:E?.opacity,ariaLabel:E?.ariaLabel}))}async function N(g,E){const P="mesh-3d"===g.type;g=g.symbolLayers;var R=D(E);const V=E?.maxSize?m.pt2px(E.maxSize):null;R=R||G;const T=[];let X=0,Z=0;var ba=
!1;for(let ha=0;ha<g.length;ha++){var W=g.at(ha);const M=[];if(!P||"fill"===W.type){switch(W.type){case "fill":ba=Math.min(R,V||Q);X=Math.max(X,ba);Z=Math.max(Z,ba);ba=!0;if(P){var ea=w.shapes.meshSymbol3DFill,fa=l(W,-.4);fa=fa?{color:fa,width:1,join:"round"}:{};M.push({shape:ea[0],fill:u(W,0),stroke:fa},{shape:ea[1],fill:u(W,-.2),stroke:fa},{shape:ea[2],fill:u(W,-.6),stroke:fa})}else{ea=u(W,0);fa="pattern"in W?W.pattern:null;var da=p(W);W=z(W);null!=fa&&"style"===fa.type&&"solid"!==fa.style&&W&&
(ea=await y(fa,W));M.push({shape:w.shapes.fill[0],fill:ea,stroke:da})}break;case "line":W=c(W,0);if(null==W)break;W={stroke:W,shape:w.shapes.fill[0]};X=Math.max(X,G);Z=Math.max(Z,G);M.push(W);break;case "extrude":ea={join:"round",width:1,...c(W,-.4)};fa=u(W,0);W=u(W,-.2);da=Math.min(R,V||Q);const S=w.getExtrudeSymbolShapes(da);ea.width=1;M.push({shape:S[0],fill:W,stroke:ea},{shape:S[1],fill:W,stroke:ea},{shape:S[2],fill:fa,stroke:ea});W=.7*G+.5*da;X=Math.max(X,G);Z=Math.max(Z,W);break;case "water":ba=
z(W),W=v(ba),ea=v(ba,2),fa=v(ba,3),da=w.getWaterSymbolShapes(),ba=!0,M.push({shape:da[0],fill:W},{shape:da[1],fill:ea},{shape:da[2],fill:fa}),W=Math.min(R,V||Q),X=Math.max(X,W),Z=Math.max(Z,W)}T.push(M)}}return f.renderSymbol(T,[X,Z],{node:E?.node,scale:ba,opacity:E?.opacity,ariaLabel:E?.ariaLabel})}const G=w.SymbolSizeDefaults.size,Q=w.SymbolSizeDefaults.maxSize,h=w.SymbolSizeDefaults.maxOutlineSize,C=w.SymbolSizeDefaults.lineWidth,I=w.SymbolSizeDefaults.tallSymbolWidth;b.getPatternDescriptor=y;
b.getSizeFromOptions=D;b.getSymbolLayerFill=u;b.previewSymbol3D=function(g,E){if(0===g.symbolLayers.length)return Promise.reject(new x("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(g.type){case "point-3d":return J(g,E);case "line-3d":return K(g,E);case "polygon-3d":case "mesh-3d":return N(g,E)}return Promise.reject(new x("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(b,k,e,B,x,F,m,H,O,t,w){function f(p,A){return A.items.find(v=>v.name===p)}function r(p,A,v,z,u,y){const L=null!=v?.portal?v.portal:F.getDefault(),l={portal:L,url:x.urlToObject(p.baseUrl),origin:"portal-item"},c=f(A,p.data);if(!c)return Promise.reject(new B("symbolstyleutils:symbol-name-not-found",`The symbol name '${A}' could not be found`,{symbolName:A}));u=m.fromJSON(u(c,z),l);let a=c.thumbnail?.href??null;const d=c.thumbnail?.imageData;e.isDevEnvironment()&&(u=e.adjustStaticAGOUrl(u)??
"",a=e.adjustStaticAGOUrl(a));const n={portal:L,url:x.urlToObject(x.removeFile(u)),origin:"portal-item"};return t.requestJSON(u,y).then(D=>{D="cimRef"===z?t.makeCIMSymbolRef(D.data):D.data;if((D=H.fromJSON(D,n))&&k.isSymbol3D(D)){if(a){const J=m.fromJSON(a,l);D.thumbnail=new w.Thumbnail({url:J})}else d&&(D.thumbnail=new w.Thumbnail({url:`data:image/png;base64,${d}`}));p.styleUrl?D.styleOrigin=new O({portal:v.portal,styleUrl:p.styleUrl,name:A}):p.styleName&&(D.styleOrigin=new O({portal:v.portal,styleName:p.styleName,
name:A}))}return D})}function q(p,A,v){const z=t.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,p),u=null!=A.portal?A.portal:F.getDefault();return t.requestJSON(z,v).then(y=>{y=t.makeCIMSymbolRef(y.data);return H.fromJSON(y,{portal:u,url:x.urlToObject(x.removeFile(z)),origin:"portal-item"})})}b.fetchSymbolFromStyle=r;b.getStyleItemFromStyle=f;b.resolveWebStyleSymbol=function(p,A,v,z){const u=p.name;return null==u?Promise.reject(new B("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
"Esri2DPointSymbolsStyle"===p.styleName?q(u,A,z):t.fetchStyle(p,A,z).then(y=>r(y,u,A,v,t.symbolUrlFromStyleItem,z))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(b){const k=/^devext\.arcgis\.com$/,e=/^qaext\.arcgis\.com$/,B=/^[\w-]*\.mapsdevext\.arcgis\.com$/,x=/^[\w-]*\.mapsqa\.arcgis\.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,k,e,/^jsapps\.esri\.com$/,B,x];b.adjustStaticAGOUrl=function(m,H){return m?
(H=H||globalThis.location.hostname)?null!=H.match(k)||null!=H.match(B)?m.replace("static.arcgis.com","staticdev.arcgis.com"):null!=H.match(e)||null!=H.match(x)?m.replace("static.arcgis.com","staticqa.arcgis.com"):m:m:null};b.devHostnames=F;b.isDevEnvironment=function(m){m=m||globalThis.location.hostname;return F.some(H=>null!=m?.match(H))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../core/Error","../../core/Logger",
"../../core/promiseUtils","./actions"],function(b,k,e,B,x){function F(f){const {selectedFeature:r,location:q,view:p}=f;return p?r??q??null:null}function m(f){return!!f&&f.isAggregate&&"cluster"===f.sourceLayer?.featureReduction?.type}async function H(f,r){if("3d"!==r?.type||!f||"esri.Graphic"!==f.declaredClass)return!0;if((r=r.getViewForGraphic(f))&&"whenGraphicBounds"in r){let q=null;try{q=await r.whenGraphicBounds(f,{useViewElevation:!0})}catch(p){}return!q||!q.boundingBox||q.boundingBox[0]===q.boundingBox[3]&&
q.boundingBox[1]===q.boundingBox[4]&&q.boundingBox[2]===q.boundingBox[5]}return!0}async function O(f,r){const {location:q,selectedFeature:p,view:A,zoomFactor:v}=f;await r?.viewModel?.updateGeometry();r=r?.graphic;const z=r?.geometry?r:F(f);if(!A||!z)throw f=new k("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:z,view:A}),e.getLogger("esri.widgets.Popup.PopupViewModel").error(f),f;const u=A.scale/v,y=r?.geometry??f.selectedFeature?.geometry??q,L=null!=
y&&"point"===y.type&&await H(r??p,A);x.zoomToFeature.active=!0;x.zoomToFeature.disabled=!0;try{await f.zoomTo({target:{target:z,scale:L?u:void 0}})}catch(c){if(!B.isAbortError(c)){var l=new k("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:r??p});e.getLogger("esri.widgets.Popup.PopupViewModel").error(l)}}finally{x.zoomToFeature.active=!1,x.zoomToFeature.disabled=!1,f.zoomToLocation=null,L&&(f.location=y)}}async function t(f){const {selectedFeature:r,view:q}=f;if("2d"!==
q?.type)throw f=new k("zoomToCluster:invalid-view","View must be 2d MapView.",{view:q}),e.getLogger("esri.widgets.Popup.PopupViewModel").error(f),f;if(!r||!m(r))throw f=new k("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r}),e.getLogger("esri.widgets.Popup.PopupViewModel").error(f),f;const [p,A]=await w(q,r);x.zoomToClusteredFeatures.active=!0;x.zoomToClusteredFeatures.disabled=!0;const {extent:v}=await p.queryExtent(A);v&&
await f.zoomTo({target:v});x.zoomToClusteredFeatures.active=!1;x.zoomToClusteredFeatures.disabled=!1}async function w(f,r){f=await f.whenLayerView(r.sourceLayer);const q=f.createQuery();r=r.getObjectId();q.aggregateIds=null!=r?[r]:[];return[f,q]}b.browseAggregateFeatures=async function(f){const {selectedFeature:r,view:q}=f;if(q&&r){var [p,A]=await w(q,r);x.browseClusteredFeatures.active=!0;x.browseClusteredFeatures.disabled=!0;var {features:v}=await p.queryFeatures(A);x.browseClusteredFeatures.active=
!1;x.browseClusteredFeatures.disabled=!1;x.browseClusteredFeatures.value=!0;f?.open({features:[r].concat(v),featureMenuOpen:!0})}};b.displayClusterExtent=async function(f){const {view:r,selectedFeature:q}=f;if(r&&q){var [p,A]=await w(r,q),{extent:v}=await p.queryExtent(A);f.selectedClusterBoundaryFeature.geometry=v;r.graphics.add(f.selectedClusterBoundaryFeature)}};b.getSelectedTarget=F;b.isClusterFeature=m;b.removeClusteredFeaturesForBrowsing=function(f){x.browseClusteredFeatures.value=!1;const r=
f.features.filter(q=>m(q));r.length&&(f.features=r)};b.triggerAction=f=>{const {event:r,view:q,viewModel:p}=f;({action:f}=r);if(!f)return Promise.reject(new k("trigger-action:missing-arguments","Event has no action"));const {disabled:A,id:v}=f;if(!v)return Promise.reject(new k("trigger-action:invalid-action","action.id is missing"));if(A)return Promise.reject(new k("trigger-action:invalid-action","Action is disabled"));if(v===x.zoomToFeature.id)return O(p).catch(B.throwIfNotAbortError);if(v===x.zoomToClusteredFeatures.id)return t(p);
if(v===x.browseClusteredFeatures.id)return p.browseClusterEnabled=!p.browseClusterEnabled,p.featureMenuOpen=p.browseClusterEnabled,Promise.resolve();if(v===x.removeSelectedFeature.id){p.visible=!1;({selectedFeature:f}=p);if(!f)return Promise.reject(new k(`trigger-action:${x.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:f}));const {sourceLayer:z}=f;z?z.remove(f):q?.graphics.remove(f)}return Promise.resolve()};b.zoomToClusterExtent=t;b.zoomToLocation=O;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,k,e,B,x,F,m,H){b.GoToMixin=O=>{O=class extends O{constructor(...t){super(...t);this.view=this.goToOverride=null}callGoTo(t){const {view:w}=this;e.assertIsSome(w);return this.goToOverride?this.goToOverride(w,
t):w.goTo(t.target,t.options)}};k.__decorate([B.property()],O.prototype,"goToOverride",void 0);k.__decorate([B.property()],O.prototype,"view",void 0);return O=k.__decorate([H.subclass("esri.widgets.support.GoTo")],O)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,k,e,B,x,F,m){k=class extends k{constructor(){super(...arguments);this.closeButton=this.actionBar=!0;this.collapseButton=!1;this.spinner=this.heading=this.flow=this.featureListLayerTitle=this.featureNavigation=!0}};b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"actionBar",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"closeButton",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"collapseButton",void 0);b.__decorate([e.property({type:Boolean,
nonNullable:!0})],k.prototype,"featureNavigation",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"featureListLayerTitle",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"flow",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"heading",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"spinner",void 0);return k=b.__decorate([m.subclass("esri.widgets.Features.FeaturesVisibleElements")],
k)})},"esri/widgets/Popup/css":function(){define(["exports"],function(b){b.css={base:"esri-popup",baseHidden:"esri-popup--hidden",main:"esri-popup__main-container",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",
alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass ../Features/FeaturesViewModel".split(" "),
function(b,k,e,B,x,F,m){k=class extends m{constructor(H){super(H)}};return k=b.__decorate([F.subclass("esri.widgets.Popup.PopupViewModel")],k)})},"esri/widgets/Popup/PopupVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,k,e,B,x,F,m){k=class extends k{constructor(){super(...arguments);this.spinner=this.heading=
this.featureListLayerTitle=this.featureNavigation=this.collapseButton=this.closeButton=this.actionBar=!0}};b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"actionBar",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"closeButton",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"collapseButton",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"featureNavigation",void 0);b.__decorate([e.property({type:Boolean,
nonNullable:!0})],k.prototype,"featureListLayerTitle",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"heading",void 0);b.__decorate([e.property({type:Boolean,nonNullable:!0})],k.prototype,"spinner",void 0);return k=b.__decorate([m.subclass("esri.widgets.Popup.PopupVisibleElements")],k)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/deprecate ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../support/actions/ActionButton ./Features ./Widget ./Popup/css ./Popup/PopupViewModel ./Popup/PopupVisibleElements ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(b,
k,e,B,x,F,m,H,O,t,w,f,r,q,p,A,v,z,u,y,L){const l={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};H=class extends r{constructor(c,a){super(c,a);this._dockAction=new w({id:"popup-dock-action"});this._featuresWidget=new f({responsiveActionsEnabled:!0});this._mainContainerNode=this._containerNode=null;this._pointerOffsetInPx=16;this._focusAbortController=null;this.alignment="auto";this.dockEnabled=!1;this.headingLevel=2;this.messages=null;this.viewModel=new p;this.visibleElements=new A}initialize(){this.addHandles([x.watch(()=>
[this.viewModel?.view?.widthBreakpoint,this.dockEnabled],()=>this._handleDockIcon(),x.initial),x.watch(()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock],()=>this._handleDockEnabled(),x.initial),x.watch(()=>this.dockOptions,c=>{const {_dockAction:a}=this,d=this._featuresWidget.headerActions;d.remove(a);c.buttonEnabled&&d.add(a)},x.initial),x.watch(()=>this.viewModel?.screenLocation,()=>this._positionContainer()),x.watch(()=>[this.viewModel?.active,this.dockEnabled],()=>this._toggleScreenLocationEnabled()),
x.watch(()=>[this.viewModel?.screenLocation,this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment],()=>this.reposition()),x.watch(()=>this.viewModel?.view?.size,(c,a)=>this._updateDockEnabledForViewSize(c,a)),x.watch(()=>this.viewModel?.view,(c,a)=>this._viewChange(c,a)),x.watch(()=>this.viewModel?.view?.ready,(c,a)=>this._viewReadyChange(c??!1,a??!1)),x.watch(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,x.initial),
x.watch(()=>this._featureNavigationTop,c=>this._featuresWidget.featureNavigationTop=c,x.initial),x.watch(()=>this.headingLevel,c=>this._featuresWidget.headingLevel=c,x.initial),x.watch(()=>this.visibleElements.actionBar,c=>this._featuresWidget.visibleElements.actionBar=!!c,x.initial),x.watch(()=>this.visibleElements.closeButton,c=>this._featuresWidget.visibleElements.closeButton=!!c,x.initial),x.watch(()=>this.visibleElements.collapseButton,c=>this._featuresWidget.visibleElements.collapseButton=!!c,
x.initial),x.watch(()=>this.visibleElements.heading,c=>this._featuresWidget.visibleElements.heading=!!c,x.initial),x.watch(()=>this.visibleElements.spinner,c=>this._featuresWidget.visibleElements.spinner=!!c,x.initial),x.watch(()=>this.visibleElements.featureNavigation,c=>this._featuresWidget.visibleElements.featureNavigation=!!c,x.initial),x.watch(()=>this.visibleElements.featureListLayerTitle,c=>this._featuresWidget.visibleElements.featureListLayerTitle=!!c,x.initial),x.on(()=>this._featuresWidget,
"trigger-header-action",c=>{c.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}normalizeCtorArgs(c){const a={...c};null!=c?.visibleElements&&(a.visibleElements=new A(c.visibleElements),null!=c.collapseEnabled&&(a.visibleElements.collapseButton=c.collapseEnabled),null!=c.spinnerEnabled&&(a.visibleElements.spinner=c.spinnerEnabled));return a}destroy(){this._dockAction.destroy();this._featuresWidget?.destroy();this._focusAbortController?.abort()}get _featureNavigationTop(){const {currentAlignment:c,
currentDockPosition:a}=this;return"bottom-left"===c||"bottom-center"===c||"bottom-right"===c||"top-left"===a||"top-center"===a||"top-right"===a}get actions(){return this.viewModel.actions}set actions(c){this.viewModel.actions=c}get active(){return this.viewModel.active}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(c){this.viewModel.autoCloseEnabled=c}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(c){this.viewModel.defaultPopupTemplateEnabled=
c}get content(){return this.viewModel.content}set content(c){this.viewModel.content=c}get collapsed(){return this._featuresWidget.collapsed}set collapsed(c){this._featuresWidget.collapsed=c}get collapseEnabled(){k.deprecatedProperty(e.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",version:"4.29"});return this.visibleElements.collapseButton}set collapseEnabled(c){k.deprecatedProperty(e.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",
version:"4.29"});this.visibleElements.collapseButton=c}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||l}set dockOptions(c){var a={...l};const d=this.viewModel?.view?.breakpoints;var n={};d&&(n.width=d.xsmall,n.height=d.xsmall);c={...a,...c};a={...a.breakpoint,...n};({breakpoint:n}=c);"object"===typeof n?c.breakpoint={...a,...n}:n&&(c.breakpoint=a);this._set("dockOptions",c);
this._setCurrentDockPosition();this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(c){this.viewModel.featureMenuOpen=c}get features(){return this.viewModel.features}set features(c){this.viewModel.features=c}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(c){this.viewModel.goToOverride=c}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(c){this.viewModel.highlightEnabled=
c}get icon(){return"popup"}set icon(c){this._overrideIfSome("icon",c)}get location(){return this.viewModel.location}set location(c){this.viewModel.location=c}get label(){return this.messages?.widgetLabel??""}set label(c){this._overrideIfSome("label",c)}get promises(){return this.viewModel.promises}set promises(c){this.viewModel.promises=c}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(c){this.viewModel.selectedFeatureIndex=
c}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get spinnerEnabled(){k.deprecatedProperty(e.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});return this.visibleElements.spinner}set spinnerEnabled(c){k.deprecatedProperty(e.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});this.visibleElements.spinner=c}get title(){return this.viewModel.title}set title(c){this.viewModel.title=c}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(c){this.viewModel.updateLocationEnabled=
c}get view(){return this.viewModel.view}set view(c){this.viewModel.view=c}get visible(){return this.viewModel.visible}set visible(c){this.viewModel.visible=c}blur(){const {active:c}=this.viewModel;c||e.getLogger(this).warn("Popup can only be blurred when currently active.");this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(c,a){return this.viewModel.fetchFeatures(c,a)}focus(){const {active:c}=this.viewModel;c||e.getLogger(this).warn("Popup can only be focused when currently active.");
this._handleFocus()}next(){return this.viewModel.next()}open(c){this.set({collapsed:c?!!c.collapsed:!1,featureMenuOpen:c?!!c.featureMenuOpen:!1});this.viewModel.open(c);c?.shouldFocus&&this._handleFocus(!0)}previous(){return this.viewModel.previous()}reposition(){this.renderNow();this._positionContainer();this._setCurrentAlignment()}triggerAction(c){return this.viewModel.triggerAction(c)}render(){const {dockEnabled:c,currentAlignment:a,currentDockPosition:d}=this,{active:n,screenLocation:D}=this.viewModel,
J=this.selectedFeature?.layer?.title,K=this.selectedFeature?.layer?.id;return L.tsx("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,bind:this,class:this.classes(q.css.base,{[q.css.alignTopCenter]:"top-center"===a,[q.css.alignBottomCenter]:"bottom-center"===a,[q.css.alignTopLeft]:"top-left"===a,[q.css.alignBottomLeft]:"bottom-left"===a,[q.css.alignTopRight]:"top-right"===a,[q.css.alignBottomRight]:"bottom-right"===a,[q.css.isDocked]:n&&c,[q.css.shadow]:n&&!c,[q.css.isDockedTopLeft]:"top-left"===
d,[q.css.isDockedTopCenter]:"top-center"===d,[q.css.isDockedTopRight]:"top-right"===d,[q.css.isDockedBottomLeft]:"bottom-left"===d,[q.css.isDockedBottomCenter]:"bottom-center"===d,[q.css.isDockedBottomRight]:"bottom-right"===d},{[q.css.baseHidden]:!D&&!c}),"data-layer-id":K,"data-layer-title":J,role:"presentation"},n?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:L.tsx("div",{class:q.css.pointer,key:"popup-pointer",role:"presentation"},L.tsx("div",
{class:this.classes(q.css.pointerDirection,q.css.shadow)}))}_renderMainContainer(){const {dockEnabled:c}=this;return L.tsx("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(q.css.main,v.globalCss.widget,{[q.css.shadow]:c})},this._featuresWidget.render())}_getAnimationDurationMS(){const {_containerNode:c}=this;return c?1E3*parseFloat(window.getComputedStyle(c).animationDuration):200}async _handleFocus(c=!1){this._focusAbortController?.abort();
this._focusAbortController=new AbortController;const a=this._focusAbortController.signal;c&&await x.whenOnce(()=>!0===this.viewModel?.active,{signal:a});await B.ignoreAbortErrors(F.waitAnimationFrame(a));await B.ignoreAbortErrors(B.after(this._getAnimationDurationMS(),a));this._featuresWidget.focus()}_isOutsideView(c){const {popupHeight:a,popupWidth:d,screenLocation:n,side:D,view:J}=c;if(isNaN(d)||isNaN(a)||!J||!n)return!1;c=J.padding;return"right"===D&&n.x+d/2>J.width-c.right||"left"===D&&n.x-d/
2<c.left||"top"===D&&n.y-a<c.top||"bottom"===D&&n.y+a>J.height-c.bottom?!0:!1}_calculateAutoAlignment(c){if("auto"!==c)return c;const {_pointerOffsetInPx:a,_containerNode:d,_mainContainerNode:n,viewModel:D}=this,{screenLocation:J,view:K}=D;if(null==J||!K||!d)return"top-center";var N=(c=n?window.getComputedStyle(n,null):null)?parseInt(c.getPropertyValue("max-height").replaceAll(/[^-\d.]/g,""),10):0,G=c?parseInt(c.getPropertyValue("height").replaceAll(/[^-\d.]/g,""),10):0;const {height:Q,width:h}=d.getBoundingClientRect();
c=h+a;const C=Math.max(Q,N,G)+a;N=this._isOutsideView({popupHeight:C,popupWidth:c,screenLocation:J,side:"right",view:K});G=this._isOutsideView({popupHeight:C,popupWidth:c,screenLocation:J,side:"left",view:K});const I=this._isOutsideView({popupHeight:C,popupWidth:c,screenLocation:J,side:"top",view:K});c=this._isOutsideView({popupHeight:C,popupWidth:c,screenLocation:J,side:"bottom",view:K});return G?I?"bottom-right":"top-right":N?I?"bottom-left":"top-left":I?c?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(c){return"function"===
typeof c?c.call(this):c}_getCurrentAlignment(){const {alignment:c,dockEnabled:a}=this;return a||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(c)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(c){const a=["left","right"];z.isRTL(this.container)&&a.reverse();return c?.replace(/leading/gi,
a[0]).replaceAll(/trailing/gi,a[1])}_callDockPosition(c){return"function"===typeof c?c.call(this):c}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(c){if("auto"!==c)return c;var a=this.viewModel?.view;c=z.isRTL(this.container)?"top-left":"top-right";if(!a)return c;var d=a.padding||
{left:0,right:0,top:0,bottom:0};d=a.width-d.left-d.right;({breakpoints:a}=a);return a&&d<=a.xsmall?"bottom-center":c}_getDockIcon(){const c=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(c){case "top-left":case "bottom-left":return"dock-left";case "top-center":return"maximize";case "bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:
this.messages?.dock}_setMainContainerNode(c){this._mainContainerNode=c}_positionContainer(c=this._containerNode){c&&(this._containerNode=c);if(this._containerNode){({screenLocation:c}=this.viewModel);var {width:a}=this._containerNode.getBoundingClientRect();(c=this._calculatePositionStyle(c,a))&&Object.assign(this._containerNode.style,c)}}_calculateFullWidth(c){const {currentAlignment:a,_pointerOffsetInPx:d}=this;return"top-left"===a||"bottom-left"===a||"top-right"===a||"bottom-right"===a?c+d:c}_calculateAlignmentPosition(c,
a,d,n){const {currentAlignment:D,_pointerOffsetInPx:J}=this;if(d){var {padding:K}=d;n/=2;var N=d.height-a;d=d.width-c;if("bottom-center"===D)return{top:a+J-K.top,left:c-n-K.left};if("top-left"===D)return{bottom:N+J-K.bottom,right:d+J-K.right};if("bottom-left"===D)return{top:a+J-K.top,right:d+J-K.right};if("top-right"===D)return{bottom:N+J-K.bottom,left:c+J-K.left};if("bottom-right"===D)return{top:a+J-K.top,left:c+J-K.left};if("top-center"===D)return{bottom:N+J-K.bottom,left:c-n-K.left}}}_calculatePositionStyle(c,
a){const {dockEnabled:d,view:n}=this;if(n){if(d)return{left:"",top:"",right:"",bottom:""};if(null!=c&&a&&(a=this._calculateFullWidth(a),c=this._calculateAlignmentPosition(c.x,c.y,n,a)))return{top:void 0!==c.top?`${c.top}px`:"auto",left:void 0!==c.left?`${c.left}px`:"auto",bottom:void 0!==c.bottom?`${c.bottom}px`:"auto",right:void 0!==c.right?`${c.right}px`:"auto"}}}_viewChange(c,a){c&&a&&(this.close(),this.clear())}_viewReadyChange(c,a){c?this._wireUpView():a&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(c,
a,d){const [n,D]=c,[J,K]=a,{width:N=0,height:G=0}=d??{};return n<=N&&J>N||n>N&&J<=N||D<=G&&K>G||D>G&&K<=G}_updateDockEnabledForViewSize(c,a){if(c&&a){var d=this.viewModel?.view?.padding||{left:0,right:0,top:0,bottom:0},n=d.left+d.right,D=d.top+d.bottom;d=[];var J=[];d[0]=c[0]-n;d[1]=c[1]-D;J[0]=a[0]-n;J[1]=a[1]-D;({dockOptions:c}=this);this._dockingThresholdCrossed(d,J,c.breakpoint)&&this._setDockEnabledForViewSize(c);this._setCurrentDockPosition()}}_toggleScreenLocationEnabled(){const {dockEnabled:c,
viewModel:a}=this;a&&(a.screenLocationEnabled=a.active&&!c)}_shouldDockAtCurrentViewSize(c){c=c.breakpoint;var a=this.viewModel?.view?.ui;if(!a)return!1;const {width:d,height:n}=a;if(isNaN(d)||isNaN(n)||!c)return!1;a=c.hasOwnProperty("width")&&d<=(c.width??0);c=c.hasOwnProperty("height")&&n<=(c.height??0);return a||c}_setDockEnabledForViewSize(c){c.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(c))}};b.__decorate([m.property({readOnly:!0})],H.prototype,"_featureNavigationTop",null);
b.__decorate([m.property()],H.prototype,"actions",null);b.__decorate([m.property({readOnly:!0})],H.prototype,"active",null);b.__decorate([m.property()],H.prototype,"alignment",void 0);b.__decorate([m.property()],H.prototype,"autoCloseEnabled",null);b.__decorate([m.property()],H.prototype,"defaultPopupTemplateEnabled",null);b.__decorate([m.property()],H.prototype,"content",null);b.__decorate([m.property()],H.prototype,"collapsed",null);b.__decorate([m.property()],H.prototype,"collapseEnabled",null);
b.__decorate([m.property({readOnly:!0})],H.prototype,"currentAlignment",null);b.__decorate([m.property({readOnly:!0})],H.prototype,"currentDockPosition",null);b.__decorate([m.property()],H.prototype,"dockOptions",null);b.__decorate([m.property()],H.prototype,"dockEnabled",void 0);b.__decorate([m.property({readOnly:!0})],H.prototype,"featureCount",null);b.__decorate([m.property()],H.prototype,"featureMenuOpen",null);b.__decorate([m.property()],H.prototype,"features",null);b.__decorate([m.property()],
H.prototype,"goToOverride",null);b.__decorate([m.property()],H.prototype,"headingLevel",void 0);b.__decorate([m.property()],H.prototype,"highlightEnabled",null);b.__decorate([m.property()],H.prototype,"icon",null);b.__decorate([m.property()],H.prototype,"location",null);b.__decorate([m.property()],H.prototype,"label",null);b.__decorate([m.property(),u.messageBundle("esri/widgets/Popup/t9n/Popup")],H.prototype,"messages",void 0);b.__decorate([m.property()],H.prototype,"promises",null);b.__decorate([m.property({readOnly:!0})],
H.prototype,"selectedFeature",null);b.__decorate([m.property()],H.prototype,"selectedFeatureIndex",null);b.__decorate([m.property({readOnly:!0})],H.prototype,"selectedFeatureWidget",null);b.__decorate([m.property()],H.prototype,"spinnerEnabled",null);b.__decorate([m.property()],H.prototype,"title",null);b.__decorate([m.property()],H.prototype,"updateLocationEnabled",null);b.__decorate([m.property()],H.prototype,"view",null);b.__decorate([m.property({type:p}),y.vmEvent(["triggerAction","trigger-action"])],
H.prototype,"viewModel",void 0);b.__decorate([m.property()],H.prototype,"visible",null);b.__decorate([m.property({type:A,nonNullable:!0})],H.prototype,"visibleElements",void 0);return H=b.__decorate([t.subclass("esri.widgets.Popup")],H)});