// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/interactive/sketch/SketchValueOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./Units ../../support/angularMeasurementUtils".split(" "),function(a,b,c,l,h,g,m,y,q){b=class extends b{constructor(n){super(n);this.directionMode="relative";this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case "relative":return this.relativeDirectionIsBilateral?
q.DirectionMode.RelativeBilateral:q.DirectionMode.Relative;case "absolute":return q.DirectionMode.Absolute}}get displayUnits(){return this._get("displayUnits")??new y}set displayUnits(n){this._set("displayUnits",n)}get inputUnits(){return this._get("inputUnits")??new y}set inputUnits(n){this._set("inputUnits",n)}};a.__decorate([c.property({type:String,nonNullable:!0})],b.prototype,"directionMode",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"relativeDirectionIsBilateral",
void 0);a.__decorate([c.property()],b.prototype,"effectiveDirectionMode",null);a.__decorate([c.property({type:y,nonNullable:!0})],b.prototype,"displayUnits",null);a.__decorate([c.property({type:y,nonNullable:!0})],b.prototype,"inputUnits",null);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.SketchValueOptions")],b)})},"esri/views/interactive/sketch/Units":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m){b=class extends b{constructor(y){super(y);this.area=this.verticalLength=this.length=null}};a.__decorate([c.property()],b.prototype,"length",void 0);a.__decorate([c.property()],b.prototype,"verticalLength",void 0);a.__decorate([c.property()],b.prototype,"area",void 0);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.Units")],b)})},"esri/views/support/angularMeasurementUtils":function(){define("exports ../../core/Cyclical ../../core/quantityUtils ../../core/unitUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){function B(e,r){if(null!=e&&null!=r)return e=z(e,r),null!=e?c.createAngle(e,"radians","geographic"):void 0}function d(e,r,G){if(e&&r&&G&&(e=z(e,r),r=z(r,G),null!=e&&null!=r))return c.createAngle(r-e,"radians","geographic")}function f(e,r){if(null!=e)switch(r){case a.DirectionMode.Absolute:return v(e);case a.DirectionMode.Relative:return e=t(e),e=D.normalize(e,0,!0),-180===e&&(e=180),c.createAngle(e,"degrees","geographic");case a.DirectionMode.RelativeBilateral:return e=
t(e),e=Math.abs(D.normalize(e,0,!0)),c.createAngle(e,"degrees","geographic")}}function v(e){e=t(e);e=p.normalize(e,0,!0);return c.createAngle(e,"degrees","geographic")}function t(e){if(null!=e)return c.convertRotationType(l.convertUnit(e.value,e.unit,"degrees"),e.rotationType,"geographic")}a.DirectionMode=void 0;(function(e){e.Absolute="absolute";e.Relative="relative";e.RelativeBilateral="relative-bilateral"})(a.DirectionMode||(a.DirectionMode={}));const z=(()=>{const e=y.create(),r=y.create();return(G,
A)=>{m.set(e,G.x,G.y,G.z??0);m.set(r,A.x,A.y,A.z??0);return F(e,r,G.spatialReference,A.spatialReference)}})(),F=(()=>{const e=g.create(),r=y.create(),G=y.create();return(A,x,L,S)=>{if(!m.exactEquals(A,x)){var Q=n.geodesicCompatibleSpatialReference(L),R=n.geodesicCompatibleSpatialReference(S);if(Q&&R&&w.equals(Q,R)&&q.projectVectorToVector(A,L,r,Q)&&q.projectVectorToVector(x,S,G,R))return{azimuth:A}=n.inverseGeodeticSolver(J,r,G,Q),null!=A?l.convertUnit(A,"degrees","radians"):void 0;e[0]=x[0]-A[0];
e[1]=x[1]-A[1];A=h.angle(g.UNIT_Y,e);0>e[0]&&(A=E-A);return A}}})(),H=(()=>{const e=y.create();return(r,G,A,x,L,S="geodesic")=>{m.copy(e,G);L=t(L);if("geodesic"===S&&(S=n.geodesicCompatibleSpatialReference(A))&&q.projectVectorToVector(e,A,e,S))return n.directGeodeticSolver(r,e,L,x,S),r[2]=G[2],q.projectVectorToVector(r,S,r,A)?!0:!1;A=c.convertRotationType(L,"geographic","arithmetic");A=l.convertUnit(A,"degrees","radians");m.set(r,G[0]+x*Math.cos(A),G[1]+x*Math.sin(A),G[2]);return!0}})(),J=new n.InverseGeodeticSolverResult,
E=2*Math.PI,p=b.cyclicalDegrees,D=new b.Cyclical(-180,180);a.convertAngle=function(e,r,G){let A=l.convertUnit(e.value,e.unit,"degrees");A=c.convertRotationType(A,e.rotationType,G);A=l.convertUnit(A,"degrees",r);return c.createAngle(A,r,G)};a.directionBetweenPoints=B;a.directionForVertices=function(e,r,G,A=a.DirectionMode.Absolute){if(r&&G)switch(A){case a.DirectionMode.Absolute:return B(r,G);case a.DirectionMode.Relative:return f(d(e,r,G),a.DirectionMode.Relative);case a.DirectionMode.RelativeBilateral:return f(d(e,
r,G),a.DirectionMode.RelativeBilateral)}};a.getDegreesArithmetic=function(e){if(null!=e)return c.convertRotationType(l.convertUnit(e.value,e.unit,"degrees"),e.rotationType,"arithmetic")};a.getDegreesGeographic=t;a.getNormalizedDirection=f;a.getNormalizedGeographicOrientation=v;a.pointFromDistanceAlongAzimuth=H;a.radiansGeographicBetweenVec=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,b){function c(f,
v){return{type:b.unitType(v),value:f,unit:v}}function l(f,v){return{type:b.unitType(v),value:f,unit:v}}function h(f,v){return{type:b.unitType(v),value:f,unit:v}}function g(f,v,t="arithmetic"){return{type:b.unitType(v),value:f,unit:v,rotationType:t}}function m(f,v){const t=y(f,v);return"angle"===f.type?g(t,v,f.rotationType):c(t,v)}function y(f,v){return b.convertUnit(f.value,f.unit,v)}const q=l(0,"meters"),n=h(0,"square-meters"),w=g(0,"radians"),B=g(0,"degrees"),d=g(0,"degrees","geographic");a.convertRotationType=
function(f,v,t){if(v===t)return f;switch(t){case "arithmetic":case "geographic":return-f+90}};a.createAngle=g;a.createArea=h;a.createLength=l;a.createQuantity=c;a.createScalar=function(f){return{value:f}};a.isBaseUnit=function(f){return b.isBaseUnit(f.unit)};a.max=function(f,v){return null==f?v:null==v?f:f.value>b.convertUnit(v.value,v.unit,f.unit)?f:v};a.min=function(f,v){return null==f?v:null==v?f:f.value<b.convertUnit(v.value,v.unit,f.unit)?f:v};a.scale=function(f,v){return null==f?null:{...f,
value:f.value*v}};a.toBaseUnit=function(f){return m(f,b.baseUnitForUnit(f.unit))};a.toUnit=m;a.valueInUnit=y;a.zeroDegrees=B;a.zeroDegreesGeographic=d;a.zeroMeters=q;a.zeroRadians=w;a.zeroSquareMeters=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["exports","./common"],function(a,b){function c(M,N){M[0]=N[0];M[1]=N[1];return M}function l(M,N,V){M[0]=N;M[1]=V;return M}function h(M,N,V){M[0]=N[0]+V[0];M[1]=N[1]+V[1];return M}
function g(M,N,V){M[0]=N[0]-V[0];M[1]=N[1]-V[1];return M}function m(M,N,V){M[0]=N[0]*V[0];M[1]=N[1]*V[1];return M}function y(M,N,V){M[0]=N[0]/V[0];M[1]=N[1]/V[1];return M}function q(M,N){M[0]=Math.ceil(N[0]);M[1]=Math.ceil(N[1]);return M}function n(M,N){M[0]=Math.floor(N[0]);M[1]=Math.floor(N[1]);return M}function w(M,N,V){M[0]=Math.min(N[0],V[0]);M[1]=Math.min(N[1],V[1]);return M}function B(M,N,V){M[0]=Math.max(N[0],V[0]);M[1]=Math.max(N[1],V[1]);return M}function d(M,N){M[0]=Math.round(N[0]);M[1]=
Math.round(N[1]);return M}function f(M,N,V){M[0]=N[0]*V;M[1]=N[1]*V;return M}function v(M,N,V,Y){M[0]=N[0]+V[0]*Y;M[1]=N[1]+V[1]*Y;return M}function t(M,N){const V=N[0]-M[0];M=N[1]-M[1];return Math.sqrt(V*V+M*M)}function z(M,N){const V=N[0]-M[0];M=N[1]-M[1];return V*V+M*M}function F(M){const N=M[0];M=M[1];return Math.sqrt(N*N+M*M)}function H(M){const N=M[0];M=M[1];return N*N+M*M}function J(M,N){M[0]=-N[0];M[1]=-N[1];return M}function E(M,N){M[0]=1/N[0];M[1]=1/N[1];return M}function p(M,N){var V=N[0];
const Y=N[1];V=V*V+Y*Y;0<V&&(V=1/Math.sqrt(V),M[0]=N[0]*V,M[1]=N[1]*V);return M}function D(M,N){return M[0]*N[0]+M[1]*N[1]}function e(M,N,V){N=N[0]*V[1]-N[1]*V[0];M[0]=M[1]=0;M[2]=N;return M}function r(M,N,V,Y){const ea=N[0];N=N[1];M[0]=ea+Y*(V[0]-ea);M[1]=N+Y*(V[1]-N);return M}function G(M,N=1){const V=2*b.RANDOM()*Math.PI;M[0]=Math.cos(V)*N;M[1]=Math.sin(V)*N;return M}function A(M,N,V){const Y=N[0];N=N[1];M[0]=V[0]*Y+V[2]*N;M[1]=V[1]*Y+V[3]*N;return M}function x(M,N,V){const Y=N[0];N=N[1];M[0]=
V[0]*Y+V[2]*N+V[4];M[1]=V[1]*Y+V[3]*N+V[5];return M}function L(M,N,V){const Y=N[0];N=N[1];M[0]=V[0]*Y+V[3]*N+V[6];M[1]=V[1]*Y+V[4]*N+V[7];return M}function S(M,N,V){const Y=N[0];N=N[1];M[0]=V[0]*Y+V[4]*N+V[12];M[1]=V[1]*Y+V[5]*N+V[13];return M}function Q(M,N,V,Y){const ea=N[0]-V[0];N=N[1]-V[1];const Z=Math.sin(Y);Y=Math.cos(Y);M[0]=ea*Y-N*Z+V[0];M[1]=ea*Z+N*Y+V[1];return M}function R(M,N){var V=M[0];M=M[1];const Y=N[0];N=N[1];let ea=V*V+M*M;0<ea&&(ea=1/Math.sqrt(ea));let Z=Y*Y+N*N;0<Z&&(Z=1/Math.sqrt(Z));
V=(V*Y+M*N)*ea*Z;return 1<V?0:-1>V?Math.PI:Math.acos(V)}function I(M){return"vec2("+M[0]+", "+M[1]+")"}function k(M,N){return M[0]===N[0]&&M[1]===N[1]}function u(M,N){const V=M[0];M=M[1];const Y=N[0];N=N[1];const ea=b.getEpsilon();return Math.abs(V-Y)<=ea*Math.max(1,Math.abs(V),Math.abs(Y))&&Math.abs(M-N)<=ea*Math.max(1,Math.abs(M),Math.abs(N))}function C(M,N,V,Y,ea){let Z=N[0]-V[0];V=N[1]-V[1];ea=(Y[0]*Z+Y[1]*V)*(ea-1);Z=Y[0]*ea;V=Y[1]*ea;M[0]=N[0]+Z;M[1]=N[1]+V;return M}const T=Object.freeze(Object.defineProperty({__proto__:null,
add:h,angle:R,ceil:q,copy:c,cross:e,dist:t,distance:t,div:y,divide:y,dot:D,equals:u,exactEquals:k,floor:n,inverse:E,len:F,length:F,lerp:r,max:B,min:w,mul:m,multiply:m,negate:J,normalize:p,projectAndScale:C,random:G,rotate:Q,round:d,scale:f,scaleAndAdd:v,set:l,sqrDist:z,sqrLen:H,squaredDistance:z,squaredLength:H,str:I,sub:g,subtract:g,transformMat2:A,transformMat2d:x,transformMat3:L,transformMat4:S},Symbol.toStringTag,{value:"Module"}));a.add=h;a.angle=R;a.ceil=q;a.copy=c;a.cross=e;a.dist=t;a.distance=
t;a.div=y;a.divide=y;a.dot=D;a.equals=u;a.exactEquals=k;a.floor=n;a.inverse=E;a.len=F;a.length=F;a.lerp=r;a.max=B;a.min=w;a.mul=m;a.multiply=m;a.negate=J;a.normalize=p;a.projectAndScale=C;a.random=G;a.rotate=Q;a.round=d;a.scale=f;a.scaleAndAdd=v;a.set=l;a.sqrDist=z;a.sqrLen=H;a.squaredDistance=z;a.squaredLength=H;a.str=I;a.sub=g;a.subtract=g;a.transformMat2=A;a.transformMat2d=x;a.transformMat3=L;a.transformMat4=S;a.vec2=T;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["exports"],
function(a){function b(){return[0,0]}function c(t){return[t[0],t[1]]}function l(t,z){return[t,z]}function h(t,z=[0,0]){const F=Math.min(2,t.length);for(let H=0;H<F;++H)z[H]=t[H];return z}function g(t,z){return new Float64Array(t,z,2)}function m(){return[0,0]}function y(){return[1,1]}function q(){return[1,0]}function n(){return[0,1]}const w=[0,0],B=[1,1],d=[1,0],f=[0,1],v=Object.freeze(Object.defineProperty({__proto__:null,ONES:B,UNIT_X:d,UNIT_Y:f,ZEROS:w,clone:c,create:b,createView:g,fromArray:h,
fromValues:l,ones:y,unitX:q,unitY:n,zeros:m},Symbol.toStringTag,{value:"Module"}));a.ONES=B;a.UNIT_X=d;a.UNIT_Y=f;a.ZEROS=w;a.clone=c;a.create=b;a.createView=g;a.fromArray=h;a.fromValues=l;a.ones=y;a.unitX=q;a.unitY=n;a.vec2f64=v;a.zeros=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectVectorToVector":function(){define(["exports","../projection","../SpatialReference","./projectPointToVector","../../layers/graphics/dehydratedPoint"],function(a,b,c,
l,h){function g(y,q,n,w,B){if(null==q||null==w||2>y.length)return!1;m.x=y[0];m.y=y[1];m.z=y[2];m.spatialReference=q;return l.projectPointToVector(m,n,w,B)}const m=h.makeDehydratedPoint(0,0,0,c.WGS84);a.projectVectorToVector=g;a.projectVectorToVectorAsync=async function(y,q,n,w,B,d){await b.initializeProjection(q,w,null,d);return g(y,q,n,w,B)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPointToVector":function(){define(["exports","../../core/libs/gl-matrix-2/factories/vec3f64",
"../projection","./projectBuffer"],function(a,b,c,l){function h(m,y,q,n){if(c.canProjectWithoutEngine(m.spatialReference,q))return g[0]=m.x,g[1]=m.y,g[2]=m.z??n??0,l.projectBuffer(g,m.spatialReference,0,y,q,0);m=c.tryProjectWithZConversion(m,q);if(!m)return!1;y[0]=m?.x;y[1]=m?.y;y[2]=m?.z??n??0;return!0}const g=b.create();a.projectPointToVector=h;a.projectPointToVectorAsync=async function(m,y,q,n,w){await c.initializeProjection(m.spatialReference,q,null,w);return h(m,y,q,n)};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedPoint":function(){define(["exports"],function(a){a.makeDehydratedPoint=function(b,c,l,h){return{x:b,y:c,z:l,hasZ:null!=l,hasM:!1,spatialReference:h,type:"point"}};a.setDehydratedPoint=function(b,c,l,h,g){b.x=c;b.y=l;b.z=h;b.hasZ=null!=h;b.spatialReference=g};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ../../core/accessorSupport/ensureType ./geodesicConstants ./spatialReferenceUtils ../SpatialReference ../Polyline ../Polygon ../Point".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){function B(E){if(!E)return null;var p=E.wkid;if(p)return g.spheroids[p];(E=E.wkt2??E.wkt)?(E=g.wktSpheroidRegex.exec(E))&&2===E.length?(p=E[1].split(","),!p||3>p.length?E=null:(E=parseFloat(p[1]),p=parseFloat(p[2]),E=isNaN(E)||isNaN(p)?null:{a:E,f:0===p?0:1/p})):E=null:E=null;return E}function d(E){E=B(E);if(null!=E&&"b"in E&&"eSq"in E&&"radius"in E)return E;const p=E.a*(1-E.f);return Object.assign(E,{b:p,eSq:1-(p/E.a)**2,radius:(2*E.a+p)/3,densificationRatio:1E4/((2*
E.a+p)/3)})}function f(E){return null!=E&&0>E?E+360:E}function v(E,p,D){const {a:e,eSq:r}=d(D);D=Math.sqrt(r);const G=Math.sin(p[1]*g.toRadians);p=e*p[0]*g.toRadians;D=0<r?e*(1-r)*(G/(1-r*G*G)-1/(2*D)*Math.log((1-D*G)/(1+D*G)))*.5:e*G;E[0]=p;E[1]=D;return E}function t(E){return m.isGeographic(E)&&!!B(E)}function z(E,p){if("polyline"!==E.type&&"polygon"!==E.type)throw new c("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:D}=E;if(!t(D))throw new c("geodesic-densify:invalid-spatial-reference",
"the input geometry spatial reference is not supported");var e="polyline"===E.type?E.paths:E.rings;const r=[],G=[0,0],A=new J;for(const S of e){e=[];r.push(e);e.push([S[0][0],S[0][1]]);var x=S[0][0],L=S[0][1];let Q,R;for(let I=0;I<S.length-1;I++){Q=S[I+1][0];R=S[I+1][1];if(x===Q&&L===R)continue;const k=[x,L];H(A,[x,L],[Q,R],D);const {azimuth:u,distance:C}=A;x=C/p;if(1<x){for(L=1;L<=x-1;L++)F(G,k,u,L*p,D),e.push(G.slice());F(G,k,u,(C+Math.floor(x-1)*p)/2,D);e.push(G.slice())}F(G,k,u,C,D);e.push(G.slice());
x=G[0];L=G[1]}}p=h.ensureClass(y,D);return"polyline"===E.type?new q({paths:r,spatialReference:p}):new n({rings:r,spatialReference:p})}function F(E,p,D,e,r){const G=p[0]*g.toRadians;p=p[1]*g.toRadians;D=(D??0)*g.toRadians;const {a:A,b:x,f:L}=d(r);r=Math.sin(D);D=Math.cos(D);var S=(1-L)*Math.tan(p);p=1/Math.sqrt(1+S*S);const Q=S*p,R=Math.atan2(S,D);S=p*r;const I=S*S;var k=1-I,u=k*(A*A-x*x)/(x*x);const C=1+u/16384*(4096+u*(-768+u*(320-175*u))),T=u/1024*(256+u*(-128+u*(74-47*u)));u=e/(x*C);let M=2*Math.PI,
N,V,Y,ea;for(;1E-12<Math.abs(u-M);)Y=Math.cos(2*R+u),N=Math.sin(u),V=Math.cos(u),ea=T*N*(Y+T/4*(V*(-1+2*Y*Y)-T/6*Y*(-3+4*N*N)*(-3+4*Y*Y))),M=u,u=e/(x*C)+ea;e=Q*N-p*V*D;k=L/16*k*(4+L*(4-3*k));e=Math.atan2(Q*V+p*N*D,(1-L)*Math.sqrt(I+e*e))/g.toRadians;E[0]=(G+(Math.atan2(N*r,p*V-Q*N*D)-(1-k)*L*S*(u+k*N*(Y+k*V*(-1+2*Y*Y)))))/g.toRadians;E[1]=e;return E}function H(E,p,D,e){var r=p[0]*g.toRadians;p=p[1]*g.toRadians;var G=D[0]*g.toRadians;D=D[1]*g.toRadians;const {a:A,b:x,f:L,radius:S}=d(e),Q=G-r;var R=
Math.atan((1-L)*Math.tan(p)),I=Math.atan((1-L)*Math.tan(D));e=Math.sin(R);R=Math.cos(R);const k=Math.sin(I);I=Math.cos(I);let u=1E3,C=Q,T,M,N;let V,Y,ea;do{var Z=Math.sin(C);var ia=Math.cos(C);N=Math.sqrt(I*Z*I*Z+(R*k-e*I*ia)*(R*k-e*I*ia));if(0===N)return E.distance=0,E.azimuth=void 0,E.reverseAzimuth=void 0,E;ia=e*k+R*I*ia;V=Math.atan2(N,ia);Y=R*I*Z/N;M=1-Y*Y;Z=ia-2*e*k/M;isNaN(Z)&&(Z=0);ea=L/16*M*(4+L*(4-3*M));T=C;C=Q+(1-ea)*L*Y*(V+ea*N*(Z+ea*ia*(-1+2*Z*Z)))}while(1E-12<Math.abs(C-T)&&0<--u);if(0===
u)return e=Math.acos(Math.sin(p)*Math.sin(D)+Math.cos(p)*Math.cos(D)*Math.cos(G-r))*S,r=G-r,E.azimuth=Math.atan2(Math.sin(r)*Math.cos(D),Math.cos(p)*Math.sin(D)-Math.sin(p)*Math.cos(D)*Math.cos(r))/g.toRadians,E.distance=e,E.reverseAzimuth=void 0,E;r=M*(A*A-x*x)/(x*x);p=r/1024*(256+r*(-128+r*(74-47*r)));G=Math.atan2(R*Math.sin(C),R*k*Math.cos(C)-e*I);E.azimuth=Math.atan2(I*Math.sin(C),R*k-e*I*Math.cos(C))/g.toRadians;E.distance=x*(1+r/16384*(4096+r*(-768+r*(320-175*r))))*(V-p*N*(Z+p/4*(ia*(-1+2*Z*
Z)-p/6*Z*(-3+4*N*N)*(-3+4*Z*Z))));E.reverseAzimuth=G/g.toRadians;return E}class J{constructor(E=0,p,D){this.distance=E;this.azimuth=p;this.reverseAzimuth=D}}a.InverseGeodeticSolverResult=J;a.directGeodeticSolver=F;a.geodesicAreas=function(E,p="square-meters"){if(E.some(G=>!t(G.spatialReference)))throw new c("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const D=[];for(var e=0;e<E.length;e++){var r=E[e];const {radius:G,densificationRatio:A}=d(r.spatialReference);
D.push(z(r,G*A))}E=[];e=[0,0];r=[0,0];for(let G=0;G<D.length;G++){const {rings:A,spatialReference:x}=D[G];let L=0;for(let S=0;S<A.length;S++){const Q=A[S];v(e,Q[0],x);v(r,Q[Q.length-1],x);let R=r[0]*e[1]-e[0]*r[1];for(let I=0;I<Q.length-1;I++)v(e,Q[I+1],x),v(r,Q[I],x),R+=r[0]*e[1]-e[0]*r[1];L+=R}L=l.convertUnit(L,"square-meters",p);E.push(L/-2)}return E};a.geodesicCompatibleSpatialReference=function(E){return t(E)?E:m.isWebMercator(E)?y.WGS84:null};a.geodesicDensify=z;a.geodesicDistance=function(E,
p,D="meters"){if(!E||!p)throw new c("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!E.spatialReference||!p.spatialReference)throw new c("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!m.equals(E.spatialReference,p.spatialReference))throw new c("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:e}=E;if(!t(e))throw new c("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(E.x===p.x&&E.y===p.y)return new J(0,0,0);const r=new J;H(r,[E.x,E.y],[p.x,p.y],e);r.distance=l.convertUnit(r.distance,"meters",D);r.azimuth=f(r.azimuth);r.reverseAzimuth=f(r.reverseAzimuth);return r};a.geodesicLengths=function(E,p="meters"){if(!E)throw new c("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(E.some(r=>!t(r.spatialReference)))throw new c("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const D=[];for(let r=0;r<E.length;r++){var e=E[r];const {spatialReference:G}=e;e="polyline"===e.type?e.paths:e.rings;let A=0;for(let x=0;x<e.length;x++){const L=e[x];let S=0;for(let Q=1;Q<L.length;Q++){const R=L[Q-1][0],I=L[Q][0],k=L[Q-1][1],u=L[Q][1];if(k!==u||R!==I){const C=new J;H(C,[R,k],[I,u],G);S+=C.distance}}A+=S}A=l.convertUnit(A,"meters",p);D.push(A)}return D};a.inverseGeodeticSolver=H;a.isSupported=t;a.pointFromDistance=function(E,p,D){if(!E||null==p||null==D)throw new c("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>D||360<D)throw new c("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!E.spatialReference)throw new c("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:e}=E;if(!t(e))throw new c("geodesic-distance:not-supported","input geometry spatial reference is not supported");const r=[0,0];F(r,[E.x,E.y],
D,p,e);return new w({x:r[0],y:r[1],spatialReference:e})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/handleUtils ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../layers/support/layerUtils ../../views/3d/interactive/editingTools/isSupportedObjectUtils ../../views/3d/interactive/editingTools/move/isSupportedObject ../../views/3d/interactive/editingTools/reshape/isSupportedObject ../../views/3d/interactive/editingTools/transform/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/sketch/SketchValueOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J,E,p,D,e,r,G,A,x,L,S,Q,R,I,k,u,C,T,M,N,V,Y,ea,Z){function ia(K){return"polygon"===K||"rectangle"===K||"circle"===K}function oa(K,U){na("undo",K.history.undo,K.history.redo,U)}function ra(K,U){na("redo",K.history.redo,K.history.undo,U)}function na(K,U,W,X){if(U=U.pop()){var ba=U.updates,ma=[];X.forEach((la,ca)=>{ca=ba[ca];null!=ca&&("geometry"in ca&&null!=ca.geometry&&(ma.push({geometry:la.geometry}),la.geometry=ca.geometry),"symbol"in ca&&null!=ca.symbol&&
(ma.push({symbol:la.symbol}),la.symbol=ca.symbol),"undo"in ca&&(ma.push(ca),ca[K](la)))});W.push({updates:ma})}}function za(K){return{updates:K.map(({geometry:U})=>"mesh"===U?.type?{geometry:U.cloneShallow()}:{geometry:U})}}function Aa(K,U){K.tools?.remove(U);U.destroyed||U.destroy()}function va(K){return"requireError"in K&&"aborted"===K.requireError}const aa=K=>Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"})),da={defaultZ:0},ja={reshapeOptions:{edgeOperation:"split",
shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};g=class extends g.EventedAccessor{constructor(K){super(K);this._numUpdating=0;this._defaultSnappingManager=null;this._internalGraphicsLayer=new J({listMode:"hide",internal:!0,title:"SVM Internal"});this._operationHandle=null;this._viewHandlesKey="viewHandles";this.activeVertexSymbol=
this.activeLineSymbol=this.activeFillSymbol=null;this.allowDeleteKey=!0;this.layer=null;this.pointSymbol=new N({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});this.polygonSymbol=new V({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});this.polylineSymbol=new Y({color:[130,130,130,1],width:2});this.meshSymbol=new ea({symbolLayers:new l([new Z])});this.updateGraphics=new l;this.updateOnGraphicClick=!0;this.vertexSymbol=new N({style:"circle",size:6,color:[255,
255,255],outline:{color:[50,50,50],width:1}});this.sketchOptions=new S;this._originalPopupEnabled=this._viewReadyAbortController=this._moduleLoaderAbortController=null;this.defaultCreateOptions=da;this.defaultUpdateOptions=ja;this.snappingOptions=K?.snappingManager?.options??K?.snappingOptions??new k}initialize(){this.addHandles([B.on(()=>this.view?.map?.layers,"change",K=>{K.removed.includes(this.layer)&&this.cancel()}),B.on(()=>this.layer?.graphics,"change",K=>{if(null!=this._operationHandle)for(const U of K.removed)this.updateGraphics.includes(U)&&
(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(U):this._operationHandle.cancel())}),B.watch(()=>this.layer?.elevationInfo??null,K=>{K!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=K)},B.syncAndInitial),B.watch(()=>this.view,K=>{this._defaultSnappingManager=n.destroyMaybe(this._defaultSnappingManager);K&&(this.snappingManager||(this._defaultSnappingManager=new I.SnappingManager({view:K,options:this.snappingOptions})),
"2d"===K.type?new Promise((U,W)=>a(["../../views/2d/interactive/editingTools"],U,W)):"3d"===K.type&&(new Promise((U,W)=>a(["../../views/3d/interactive/editingTools"],U,W)),new Promise((U,W)=>a(["../../views/3d/layers/GraphicsLayerView3D"],X=>U(aa(X)),W))))},B.syncAndInitial),B.watch(()=>this.view?.spatialReference,(K,U)=>{K&&U&&!K.equals(U)&&this.cancel()})]);u.setupSnappingToggleHandles(this)}destroy(){this.cancel();this._removeDefaultLayer();this._defaultSnappingManager=n.destroyMaybe(this._defaultSnappingManager);
this._set("snappingManager",null);this._set("view",null);this.emit("destroy")}get updating(){return 0<this._numUpdating||null!=this.snappingManager&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeTooltip(){const {activeComponent:K,destroyed:U}=this,W=!U&&K&&"tooltip"in K?K.tooltip:null;return W?.visible?W:null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==
this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(K){this._set("defaultCreateOptions",{...da,...K})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(K){this._set("defaultUpdateOptions",{...ja,...K,reshapeOptions:{...ja.reshapeOptions,...K?.reshapeOptions},highlightOptions:{...ja.highlightOptions,
...K?.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(K){this.sketchOptions.labels=K}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(K){null!=this._defaultSnappingManager&&(this._defaultSnappingManager.options=K);this._set("snappingOptions",K)}get snappingManager(){this._isOverridden("snappingManager")&&this._get("snappingManager");return this._defaultSnappingManager}set snappingManager(K){K?(this._isOverridden("snappingManager")||
(this._defaultSnappingManager=n.destroyMaybe(this._defaultSnappingManager)),this._override("snappingManager",K)):({view:K}=this,!this._defaultSnappingManager&&K&&(this._defaultSnappingManager=new I.SnappingManager({options:this.snappingOptions,view:K})),this._clearOverride("snappingManager"))}get state(){const K=!(!this.view?.ready||!this.layer),U=this._operationHandle;return K&&U?"active":K?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(K){this.sketchOptions.tooltips=
K}get valueOptions(){return this.sketchOptions.values}set valueOptions(K){this.sketchOptions.values=K}get view(){return this._get("view")}set view(K){const U=this._get("view");if(U){const {container:W,map:X}=U;W&&(U.cursor=null);X?.remove(this._internalGraphicsLayer);this.removeHandles(this._viewHandlesKey);this.cancel()}this.removeHandles("view-ready");K&&this.addHandles(B.when(()=>K.ready,W=>{this.removeHandles(this._viewHandlesKey);W&&this.addHandles(this._generateViewHandles(K),this._viewHandlesKey)},
B.syncAndInitial),"view-ready");this._set("view",K)}cancel(){this._moduleLoaderAbortController=n.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=n.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const {state:K,updateGraphics:U}=this;if("active"===K&&U.length){const {activeTool:W,layer:X}=this,ba=U.toArray();X.removeMany(ba);this.cancel();this._emitDeleteEvent({graphics:ba,
tool:W})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const K=this.updateGraphics.map(U=>U.clone()).toArray();this.layer.addMany(K);this.emit("duplicate",{graphics:K,type:"duplicate"});return K}return[]}async create(K,U){this.cancel();await this._waitViewReady();const {view:W,layer:X}=this;if(!W||"disabled"===this.state)throw X||this._logMissingLayer(),w.createAbortError();null!=W.activeTool&&(W.activeTool=null);if(K){G.addUniqueLayer(W,this._internalGraphicsLayer);var ba=await this._setupCreateOperation(K,
U);null==ba||this.destroyed?W.map.remove(this._internalGraphicsLayer):(ba.on("complete",()=>{if(ba===this._operationHandle){const ma=this.createGraphic,la=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view?.map&&this.view.map.remove(this._internalGraphicsLayer);ba.cancelled||null==ma||X.add(ma);this.emit("create",{graphic:ma,state:la?"cancel":"complete",tool:K,toolEventInfo:null,type:"create"})}}),this._operationHandle=
ba,W.ready&&W.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")}async place(K,U){return this.create("mesh",{mode:"click",hasZ:K.hasZ,geometryToPlace:K,...U})}async update(K,U){this.cancel();await this._waitViewReady();const {layer:W,view:X,state:ba}=this;if(!X||"disabled"===ba)throw W||this._logMissingLayer(),w.createAbortError();null!=X.activeTool&&(X.activeTool=null);const ma=Array.isArray(K)?K:[K];null!=K&&ma?.length?ma.some(la=>la.layer!==W?(this._logError("sketch:invalid-parameter",
"Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==la.geometry?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(K=await this._setupUpdateOperation(ma,U),this.destroyed||null==K||va(K)||(G.addUniqueLayer(X,this._internalGraphicsLayer),this._setUpdateOperationHandle(K,U),this.emit("update",{graphics:ma,state:"start",aborted:!1,tool:K.tool,toolEventInfo:null,type:"update"}))):
this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")}async _updateSpatialReference(K){const U=this.view;if(U){this._beginAsyncOperation();K=Array.isArray(K)?K:[K];for(const W of K)null==W.geometry||"mesh"===W.geometry.type||H.equals(W.geometry.spatialReference,U.spatialReference)||(z.canProjectWithoutEngine(W.geometry.spatialReference,U.spatialReference)||z.isLoaded()||await z.load(),W.geometry=z.project(W.geometry,U.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){this.canUndo()&&
this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}async _getFirstHit(K){var U=this.view;if(!U)return this._logMissingView(),null;if("2d"===U.type){const X=[];U.map.allLayers.forEach(ba=>{"vector-tile"!==ba.type&&"imagery"!==ba.type||X.push(ba)});U=await U.hitTest(K,{exclude:X});return C.findFirstGraphicHit(U.results)}const W=
[U.map.ground];U.map.allLayers.forEach(X=>{E.isIntegratedMeshLayer(X.type)&&W.push(X)});K=await U.hitTest(K,{exclude:W});if(0<K.results.length){const X=K.results[0];if(null!=X&&"graphic"===X.type&&X.graphic&&(!K.ground.mapPoint||1>U.map.ground.opacity||K.ground.distance-(X.distance??0)>-Math.min(3*K.ground.distance,"global"===U.viewingMode?t.getReferenceEllipsoid(U.renderCoordsHelper.spatialReference).radius/U.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return X}return null}_generateViewHandles(K){return[K.on("immediate-click",
async U=>{var W="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!W&&this.updateOnGraphicClick){this._beginAsyncOperation();var X=await U.async(()=>this._getFirstHit(T.createScreenPointFromEvent(U)));W=null;null!=X?(X=X.graphic,this.updateGraphics.includes(X)||X.layer===this.layer?(U.stopPropagation(),W=X):"2d"!==K.type||this._isComponentGraphic(X)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==W||this.updateGraphics.includes(W)||
await this.update([W],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},A.ViewEventPriorities.WIDGET)]}async _setupCreateOperation(K,U){const W=this.view;if(!W)return this._logMissingView(),null;K=await this._setupDrawGraphicTool(K,W,{hasZ:"3d"===W.type,...this.defaultCreateOptions,...U});if(null==K)return null;W.tools.add(K);W.activeTool=K;return this._setupCreateOperationHandle(K)}async _setupDrawGraphicTool(K,U,W){if("multipoint"===
K&&"3d"===U.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!U)return this._logMissingView(),null;const {cursor:X,defaultZ:ba,hasZ:ma,geometryToPlace:la,graphicProperties:ca,mode:fa,preserveAspectRatio:wa}=W;W="rectangle"===K||"circle"===K?"hybrid":"click";const sa=wa??"rectangle"!==K;K={centered:"rectangle"!==K&&!("circle"===K&&!sa),cursor:X,defaultZ:ba,forceUniformSize:sa,graphicProperties:ca,geometryToPlace:la,geometryType:K,graphicSymbol:this._getGraphicSymbolFromTool(K),
hasZ:ma,mode:fa??W,snappingManager:this.snappingManager,snapToScene:!1,view:U};return"2d"===U.type?this._makeDrawGraphicTool2D(K):this._makeDrawGraphicTool3D(K)}async _makeDrawGraphicTool2D(K){const U=await this._requireModule(new Promise((W,X)=>a(["../../views/2d/interactive/editingTools"],W,X)));return va(U)||this.destroyed?null:new U.module.DrawGraphicTool2D({...K,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:ia(K.geometryType)?
this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(K){const U=await this._requireModule(new Promise((X,ba)=>a(["../../views/3d/interactive/editingTools"],X,ba)));if(va(U)||this.destroyed)return null;const {elevationInfo:W}=this.layer;return new U.module.DrawGraphicTool3D({...K,elevationInfo:W,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(K){const U=this.view;if(!U)return this._logMissingView(),null;let W=null;const X=K.forceUniformSize,
ba=K.centered,ma=[U.on("key-down",ca=>{if(ca.key===x.sketchKeys.pan)ca.stopPropagation(),ca.repeat||(K.enabled=!1);else if(ca.key===x.sketchKeys.complete)ca.stopPropagation(),K.completeCreateOperation();else if(ca.key!==x.sketchKeys.vertexAdd||ca.repeat)ca.key===x.sketchKeys.undo?(ca.stopPropagation(),la.undo()):ca.key===x.sketchKeys.redo?(ca.stopPropagation(),la.redo()):ca.key!==x.sketchKeys.constraint||"rectangle"!==K.geometryType&&"circle"!==K.geometryType||ca.repeat?ca.key!==x.sketchKeys.center||
ca.repeat||(K.centered=!ba,ca.stopPropagation()):(K.forceUniformSize=!X,ca.stopPropagation());else{const fa=K.drawOperation.geometryType;if("polyline"===fa||"polygon"===fa||"multipoint"===fa)ca.stopPropagation(),K.drawOperation.commitStagedVertex()}},A.ViewEventPriorities.WIDGET),U.on("key-up",ca=>{ca.key===x.sketchKeys.pan?K.enabled=!0:ca.key!==x.sketchKeys.constraint||"rectangle"!==K.geometryType&&"circle"!==K.geometryType?ca.key===x.sketchKeys.center&&(K.centered=ba,ca.stopPropagation()):(K.forceUniformSize=
X,ca.stopPropagation())},A.ViewEventPriorities.WIDGET),K.on("vertex-add",ca=>{W=null==W?"start":"active";switch(ca.operation){case "apply":this.emit("create",{graphic:K.graphic,state:W,tool:this.activeTool,toolEventInfo:ca,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[K.graphic],tool:K.geometryType});break;case "redo":this._emitRedoEvent({graphics:[K.graphic],tool:K.geometryType})}}),K.on("cursor-update",ca=>{0<K.drawOperation.numCommittedVertices&&this.emit("create",{graphic:K.graphic,
state:"active",tool:this.activeTool,toolEventInfo:{coordinates:ca.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),K.on("vertex-remove",ca=>{switch(ca.operation){case "apply":this.emit("create",{graphic:K.graphic,state:"active",tool:this.activeTool,toolEventInfo:ca,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[K.graphic],tool:K.geometryType});break;case "redo":this._emitRedoEvent({graphics:[K.graphic],tool:K.geometryType})}}),K.on("complete",ca=>{this._set("createGraphic",
ca.graphic);W="complete";ca.aborted?la&&la.cancel():la&&la.complete()}),B.watch(()=>this._getGraphicSymbolFromTool(K.geometryType),ca=>{K.graphicSymbol=ca})],la=new M.CreateOperationHandle({activeComponent:K,tool:K.geometryType,type:"create",onEnd:()=>{m.drainHandles(ma);U.tools?.remove(K)},undo:()=>{K.canUndo&&K.undo()},redo:()=>{K.canRedo&&K.redo()},canUndo:()=>K.canUndo,canRedo:()=>K.canRedo});return la}_getGraphicSymbolFromTool(K){switch(K){case "point":case "multipoint":return this.pointSymbol;
case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}}async _setupUpdateOperation(K,U){const {layer:W,view:X}=this;if(!X)return this._logMissingView(),null;U={...this.defaultUpdateOptions,...U,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...U?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...U?.highlightOptions}};let ba=U.tool??ja.tool;for(var ma of K)W.remove(ma),
W.add(ma);if("3d"===X.type){if(0===K.length)return null;switch(ba){case "move":return this._setupMove3DOperation(K,U,X,ba);case "reshape":return 1<K.length?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(K[0],U,X);case "transform":return this._setupGraphicTransform3DOperation(K,U,X)}}switch(ba){case "move":return this._setupMove2DOperation(K,U,X);case "reshape":return 1<K.length?(this._logError("sketch:reshape-multiple",
"Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(K,ba,U,X);case "transform":return 1===K.length&&(ma=K[0].geometry?.type,"point"===ma||"multipoint"===ma)&&(ba="reshape"),this._setupTransformOrReshape2DOperation(K,ba,U,X)}}async _setupMove3DOperation(K,U,W,X,ba=!1){var ma=await this._requireModule(new Promise((pa,O)=>a(["../../views/3d/interactive/editingTools"],pa,O)));if(va(ma))return ma;const {ManipulatedObject3DGraphic:la,MoveTool3D:ca}=ma.module,
fa=new Map,wa=()=>{fa.forEach(pa=>pa.destroy());fa.clear()};for(const pa of K){ma=new la({view:W,graphic:pa});const O=D.isSupportedObject(ma);if(O!==p.SupportedObjectResult.SUPPORTED)return wa(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${p.isSupportedObjectResultMessage(O)}).`),null;fa.set(pa,ma)}const sa=new ca({view:W,enableZ:U.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});W.tools.add(sa);sa.objects.addMany(Array.from(fa.values()));
ba||this.updateGraphics.addMany(K);const ya=[],ua=new M.UpdateOperationHandle({activeComponent:sa,tool:X,type:"update",onEnd:()=>{m.drainHandles(ya);Aa(W,sa);wa()},undo:()=>{var pa=this.view;null!=pa&&sa.hasGrabbedManipulators&&(pa.activeTool=null);oa(ua,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:X})},redo:()=>{ra(ua,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:X})},addToSelection:pa=>{this.updateGraphics.push(pa);
const O=new la({view:W,graphic:pa});fa.set(pa,O);sa.objects.push(O);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:pa=>{const O=this.updateGraphics.indexOf(pa);ua.history.undo.forEach(ha=>ha.updates.splice(O,1));ua.history.redo.forEach(ha=>ha.updates.splice(O,1));this.updateGraphics.remove(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"});if(0===this.updateGraphics.length)ua.complete();else{var P=fa.get(pa);P&&(sa.objects.remove(P),P.destroy(),fa.delete(pa))}},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==U.toggleToolOnClick&&"transform"===X){var pa=this.updateGraphics.at(0);(pa=await this._setupReshape3DOperation(pa,U,W,!0))&&!va(pa)&&(ua.onEnd(),ua.destroy(),this._setUpdateOperationHandle(pa,
U))}}});ya.push(...this._getHandlesForComponent(ua,U),W.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(ua,pa,U),A.ViewEventPriorities.WIDGET),W.on("key-down",pa=>{this._getCommonUpdateOperationKeyDownHandlers(ua,pa)},A.ViewEventPriorities.WIDGET));return ua}_setupGraphicTransform3DOperation(K,U,W,X=!1){if(1===K.length&&r.isSupportedGraphic(K[0])===p.SupportedObjectResult.SUPPORTED){const ba=K[0],ma=ba.geometry;if(null!=ma&&("point"===ma.type||"mesh"===ma.type))return this._setupPointTransform3DOperation(ba,
U,W);if(null!=ma&&("polygon"===ma.type||"polyline"===ma.type))return this._setupPolyTransform3DOperation(ba,U,W,X)}return this._setupMove3DOperation(K,U,W,"transform",X)}async _setupPointTransform3DOperation(K,U,W){const {enableRotation:X,enableScaling:ba,enableZ:ma}=U,la=await this._requireModule(new Promise((pa,O)=>a(["../../views/3d/interactive/editingTools"],pa,O)));if(va(la))return la;const {TransformTool3D:ca,ManipulatedObject3DGraphic:fa}=la.module,wa=new fa({graphic:K,view:W}),sa=new ca({object:wa,
view:W,enableRotation:X,enableScaling:ba,enableZ:ma,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});W.tools.add(sa);this.updateGraphics.add(K);const ya=[],ua=new M.UpdateOperationHandle({activeComponent:sa,tool:"transform",type:"update",onEnd:()=>{m.drainHandles(ya);Aa(W,sa);wa.destroy()},undo:()=>{var pa=this.view;null!=pa&&sa.hasGrabbedManipulators&&(pa.activeTool=null);oa(ua,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},
redo:()=>{ra(ua,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async pa=>{this.updateGraphics.add(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],type:"selection-change"},type:"update"});ua.onEnd();ua.destroy();pa=await this._setupMove3DOperation(this.updateGraphics.toArray(),U,W,"transform",!0);va(pa)||this._setUpdateOperationHandle(pa,
U)},removeFromSelection:pa=>{this.updateGraphics.remove(pa);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"});ua.complete()},toggleTool:()=>{}});ya.push(...this._getHandlesForComponent(ua,U),W.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(ua,pa,U),A.ViewEventPriorities.WIDGET),W.on("key-down",pa=>{this._getCommonUpdateOperationKeyDownHandlers(ua,
pa)},A.ViewEventPriorities.WIDGET));return ua}async _setupPolyTransform3DOperation(K,U,W,X=!1){const {enableRotation:ba,enableScaling:ma,enableZ:la,preserveAspectRatio:ca}=U;var fa=await this._requireModule(new Promise((P,ha)=>a(["../../views/3d/interactive/editingTools"],P,ha)));if(va(fa))return fa;const {ManipulatedObject3DGraphic:wa,ExtentTransformTool:sa}=fa.module;fa=this.view?.inputManager?.isModifierKeyDown(x.sketchKeys.constraint);const ya=new wa({view:W,graphic:K}),ua=new sa({object:ya,view:W,
enableRotation:ba,enableScaling:ma,enableZ:la,preserveAspectRatio:!!ca!==!!fa,sketchOptions:this.sketchOptions});W.tools.add(ua);X||this.updateGraphics.add(K);const pa=[],O=new M.UpdateOperationHandle({activeComponent:ua,tool:"transform",type:"update",onEnd:()=>{m.drainHandles(pa);Aa(W,ua);ya.destroy()},canUndo:()=>!ua.destroyed&&ua.canUndo,undo:()=>{ua.destroyed||(ua.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"}))},canRedo:()=>!ua.destroyed&&ua.canRedo,redo:()=>
{ua.destroyed||(ua.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"}))},addToSelection:async P=>{this.updateGraphics.add(P);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[P],removed:[],type:"selection-change"},type:"update"});O.onEnd();O.destroy();P=await this._setupMove3DOperation(this.updateGraphics.toArray(),U,W,"transform",!0);va(P)||this._setUpdateOperationHandle(P,U)},removeFromSelection:P=>
{this.updateGraphics.remove(P);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[P],type:"selection-change"},type:"update"});O.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==U.toggleToolOnClick){var P=await this._setupReshape3DOperation(K,U,W,!0);P&&!va(P)&&(O.onEnd(),O.destroy(),this._setUpdateOperationHandle(P,U))}}});pa.push(...this._getHandlesForComponent(O,U),W.on("immediate-click",
P=>this._getCommonUpdateOperationClickHandlers(O,P,U),A.ViewEventPriorities.WIDGET),W.on("key-down",P=>this._getCommonUpdateOperationKeyDownHandlers(O,P),A.ViewEventPriorities.WIDGET),W.on("key-down",P=>{P.key!==x.sketchKeys.constraint||P.repeat||(ua.preserveAspectRatio=!ua.preserveAspectRatio,P.stopPropagation())},A.ViewEventPriorities.WIDGET),W.on("key-up",P=>{P.key===x.sketchKeys.constraint&&(ua.preserveAspectRatio=!ua.preserveAspectRatio,P.stopPropagation())},A.ViewEventPriorities.WIDGET));return O}async _setupMove2DOperation(K,
U,W){this.updateGraphics.addMany(K);await this._updateSpatialReference(K);const X=await this._getGraphicMover(K,U,W);if(va(X))return X;const ba=new M.UpdateOperationHandle({activeComponent:X,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();m.drainHandles(ca);m.drainHandles(la);X.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const fa=this.updateGraphics.toArray();oa(ba,fa);ba.refreshComponent();this._emitUndoEvent({graphics:fa,tool:"move"})},
redo:()=>{const fa=this.updateGraphics.toArray();ra(ba,fa);ba.refreshComponent();this._emitRedoEvent({graphics:fa,tool:"move"})},addToSelection:async fa=>{await this._updateSpatialReference(fa);this.updateGraphics.push(fa);X.graphics=this.updateGraphics.toArray();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[fa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:fa=>{const wa=this.updateGraphics.indexOf(fa);
ba.history.undo.forEach(ya=>ya.updates.splice(wa,1));ba.history.redo.forEach(ya=>ya.updates.splice(wa,1));this.updateGraphics.remove(fa);const sa=this.updateGraphics.toArray();this.emit("update",{graphics:sa,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[fa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?ba.complete():X.graphics=sa}});let ma=!1;const la=[W.on("immediate-click",fa=>this._getCommonUpdateOperationClickHandlers(ba,fa,U),A.ViewEventPriorities.WIDGET),
W.on("key-down",fa=>{this._getCommonUpdateOperationKeyDownHandlers(ba,fa);fa.key!==x.sketchKeys.constraint||fa.repeat||(ma=!0,X.enableMoveAllGraphics=!X.enableMoveAllGraphics)},A.ViewEventPriorities.WIDGET),W.on("key-up",fa=>{fa.key===x.sketchKeys.constraint&&ma&&(ma=!1,X.enableMoveAllGraphics=!X.enableMoveAllGraphics)},A.ViewEventPriorities.WIDGET)],ca=this._getHandlesForComponent(ba,U);return ba}async _setupReshape3DOperation(K,U,W,X=!1){const ba=await this._requireModule(new Promise((ya,ua)=>a(["../../views/3d/interactive/editingTools"],
ya,ua)));if(va(ba))return ba;const {ManipulatedObject3DGraphic:ma,ReshapeTool3D:la}=ba.module,ca=new ma({view:W,graphic:K});K=e.isSupportedObject(ca);if(K!==p.SupportedObjectResult.SUPPORTED)return ca.destroy(),this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${p.isSupportedObjectResultMessage(K)}).`),null;K=U.reshapeOptions;const fa=new la({view:W,object:ca,enableZVertex:U.enableZ&&"move"===K?.vertexOperation,enableZShape:U.enableZ&&"move"===K?.shapeOperation,
enableMoveObject:"move"===K?.shapeOperation||"move-xy"===K?.shapeOperation,enableMidpoints:"split"===K?.edgeOperation,enableEdgeOffset:"offset"===K?.edgeOperation,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});W.tools.add(fa);X||this.updateGraphics.add(ca.graphic);const wa=[],sa=new M.UpdateOperationHandle({activeComponent:fa,tool:"reshape",type:"update",onEnd:()=>{m.drainHandles(wa);Aa(W,fa);ca.destroy()},canUndo:()=>!fa.destroyed&&fa.canUndo,undo:()=>{fa.destroyed||(fa.undo(),
this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"}))},canRedo:()=>!fa.destroyed&&fa.canRedo,redo:()=>{fa.destroyed||(fa.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"}))},addToSelection:async ya=>{this.updateGraphics.add(ya);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ya],removed:[],type:"selection-change"},type:"update"});sa.onEnd();sa.destroy();ya=await this._setupMove3DOperation(this.updateGraphics.toArray(),
U,W,"transform",!0);va(ya)||this._setUpdateOperationHandle(ya,U)},removeFromSelection:ya=>{this.updateGraphics.remove(ya);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ya],type:"selection-change"},type:"update"});sa.complete()},toggleTool:async()=>{if(!1!==U.toggleToolOnClick){sa.onEnd();sa.destroy();var ya=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),U,W,!0);va(ya)||this._setUpdateOperationHandle(ya,
U)}}});wa.push(...this._getHandlesForComponent(sa,U),W.on("immediate-click",ya=>this._getCommonUpdateOperationClickHandlers(sa,ya,U),A.ViewEventPriorities.WIDGET),W.on("key-down",ya=>{this._getCommonUpdateOperationKeyDownHandlers(sa,ya)},A.ViewEventPriorities.WIDGET));return sa}async _setupTransformOrReshape2DOperation(K,U,W,X){this.updateGraphics.addMany(K);await this._updateSpatialReference(K);K="transform"===U?await this._getBox(K,W,X):await this._getReshape(K,W,X);if(va(K))return K;const ba=new M.UpdateOperationHandle({activeComponent:K,
type:"update",onEnd:()=>{m.drainHandles(la);m.drainHandles(ma);ba.activeComponent&&!ba.activeComponent.destroyed&&ba.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{oa(ba,this.updateGraphics.toArray());ba.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:ba.tool})},redo:()=>{ra(ba,this.updateGraphics.toArray());ba.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ba.tool})},
addToSelection:async ca=>{var fa=ba.activeComponent;if("reshape"===fa?.type){fa=[...this.updateGraphics,ca];this.updateGraphics.removeAll();ba.onEnd();ba.destroy();fa=await this._setupTransformOrReshape2DOperation(fa,"transform",W,X);if(va(fa))return;this._setUpdateOperationHandle(fa,W)}else this.updateGraphics.add(ca),fa.graphics=this.updateGraphics.toArray(),fa.refresh(),ba.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ca],
removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async ca=>{const fa=this.updateGraphics.indexOf(ca);ba.history.undo.forEach(sa=>sa.updates.splice(fa,1));ba.history.redo.forEach(sa=>sa.updates.splice(fa,1));this.updateGraphics.remove(ca);const wa=this.updateGraphics.toArray();if(0===wa.length)ba.complete();else{const sa=wa[0].geometry;1!==wa.length||null==sa||"point"!==sa.type&&"multipoint"!==sa.type?ba.activeComponent.graphics=wa:ba.toggleTool()}this.emit("update",{graphics:wa,
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ca],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var ca=this.updateGraphics.at(0),fa=ca.geometry;if(null==fa||("reshape"!==ba.tool||"point"!==fa.type&&"multipoint"!==fa.type)&&("transform"!==ba.tool||"extent"!==fa.type))fa=null,"transform"===ba.tool?fa=await this._getReshape([ca],W,X):"reshape"===ba.tool&&(fa=await this._getBox([ca],W,X)),va(fa)||(ba.activeComponent?.destroy(),
ba.activeComponent=fa,ba.activeComponent&&(m.drainHandles(la),la=this._getHandlesForComponent(ba,W)))}}}),ma=[X.on("immediate-click",ca=>this._getCommonUpdateOperationClickHandlers(ba,ca,W),A.ViewEventPriorities.WIDGET),X.on("key-down",ca=>{this._getCommonUpdateOperationKeyDownHandlers(ba,ca);ca.key===x.sketchKeys.constraint&&!ca.repeat&&ba&&(ca=ba.activeComponent)&&"box"===ca.type&&(ca.preserveAspectRatio=!ca.preserveAspectRatio)},A.ViewEventPriorities.WIDGET),X.on("key-up",ca=>{ca.key===x.sketchKeys.constraint&&
ba&&(ca=ba.activeComponent)&&"box"===ca.type&&(ca.preserveAspectRatio=!ca.preserveAspectRatio)},A.ViewEventPriorities.WIDGET)];let la=this._getHandlesForComponent(ba,W);return ba}async _getGraphicMover(K,U,W){const {enableMoveAllGraphics:X,highlightOptions:ba}=U;U=await this._requireModule(new Promise((ma,la)=>a(["../../views/draw/support/GraphicMover"],ca=>ma(aa(ca)),la)));return va(U)?U:new U.module.default({enableMoveAllGraphics:X,highlightsEnabled:!!ba?.enabled,indicatorsEnabled:!1,graphics:K,
view:W,callbacks:{onGraphicMoveStart:({dx:ma,dy:la,graphic:ca})=>{this._displayGrabbingCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:la,mover:ca,type:"move-start"},type:"update"})},onGraphicMove:({dx:ma,dy:la,graphic:ca})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:la,mover:ca,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ma,
dy:la,graphic:ca})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ma,dy:la,mover:ca,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(K,U,W){const {enableRotation:X,enableScaling:ba,highlightOptions:ma,preserveAspectRatio:la}=U;U=await this._requireModule(new Promise((fa,wa)=>a(["../../views/draw/support/Box"],
sa=>fa(aa(sa)),wa)));if(va(U))return U;const ca=this.view?.inputManager?.isModifierKeyDown(x.sketchKeys.constraint);return new U.module.default({graphics:K,enableRotation:X,enableScaling:ba,highlightsEnabled:!!ma?.enabled,preserveAspectRatio:!!la!==!!ca,layer:this._internalGraphicsLayer,view:W,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onMove:fa=>
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onMoveStop:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onScaleStart:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onScale:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onScaleStop:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onRotateStart:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onRotate:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...fa},type:"update"}),onRotateStop:fa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...fa},type:"update"})}})}async _getReshape(K,U,W){const X="split"===U.reshapeOptions?.edgeOperation,ba="move"===U.reshapeOptions?.shapeOperation;U=!!U.highlightOptions?.enabled;const ma=await this._requireModule(new Promise((la,ca)=>a(["../../views/draw/support/Reshape"],fa=>la(aa(fa)),ca)));return va(ma)?
ma:new ma.module.default({enableMidpoints:X,enableMovement:ba,graphic:K[0],highlightsEnabled:U,layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:W,callbacks:{onReshapeStart:la=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...la},type:"update"}),onReshape:la=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...la},
type:"update"}),onReshapeStop:({mover:la,type:ca})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:la,type:ca},type:"update"}),onMoveStart:({dx:la,dy:ca,mover:fa,type:wa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ca,mover:fa,type:wa},type:"update"}),onMove:({dx:la,dy:ca,mover:fa,type:wa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ca,mover:fa,type:wa},type:"update"}),onMoveStop:({dx:la,dy:ca,mover:fa,type:wa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:la,dy:ca,mover:fa,type:wa},type:"update"}),onVertexAdd:({added:la,type:ca,vertices:fa})=>{la=la.map(wa=>F.geometryToCoordinates(wa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{added:la,vertices:fa,type:ca},type:"update"})},onVertexRemove:({removed:la,type:ca,vertices:fa})=>{la=la.map(wa=>F.geometryToCoordinates(wa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:la,vertices:fa,type:ca},type:"update"})}}})}_getHandlesForComponent(K,U){const W=K.activeComponent;if(!W)return[];switch(W.type){case "graphic-mover":return[W.on("graphic-click",({graphic:X,
viewEvent:ba})=>{ba.native?.shiftKey&&(ba.stopPropagation(),K.removeFromSelection(X))}),W.on("graphic-move-start",X=>K.addToHistory(za(X.allGraphics)))];case "box":return[W.on("graphic-click",X=>this._onTransformOrReshape2DGraphicClick(K,U,X)),W.on("move-start",X=>K.addToHistory(za(X.graphics))),W.on("rotate-start",X=>K.addToHistory(za(X.graphics))),W.on("scale-start",X=>K.addToHistory(za(X.graphics)))];case "reshape":return[W.on("graphic-click",X=>this._onTransformOrReshape2DGraphicClick(K,U,X)),
W.on("move-start",X=>K.addToHistory(za([X.mover]))),W.on("reshape-start",X=>K.addToHistory(za([X.graphic]))),W.on("vertex-add",X=>K.addToHistory(za([X.oldGraphic]))),W.on("vertex-remove",X=>K.addToHistory(za([X.oldGraphic])))];case "move-3d":return[W.events.on("record-undo",({updates:X})=>{K.addToHistory({updates:X})}),W.events.on("move-start",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<X.objects.length?
X.objects[0].graphic:null,type:"move-start"},type:"update"})}),W.events.on("move",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:X.dx,dy:X.dy,mover:0<X.objects.length?X.objects[0].graphic:null,type:"move"},type:"update"})}),W.events.on("move-stop",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<X.objects.length?X.objects[0].graphic:
null,type:"move-stop"},type:"update"})}),W.events.on("immediate-click",X=>{X.shiftKey?this._toggleSelection([X.object.graphic],K,U):K.toggleTool()})];case "transform-3d":return[W.events.on("record-undo",({updates:X})=>{K.addToHistory({updates:X})}),W.events.on("translate-start",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,dx:X.dxScreen,dy:X.dyScreen,type:"move-start"},type:"update"})}),W.events.on("translate-stop",
X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,dx:X.dxScreen,dy:X.dyScreen,type:"move-stop"},type:"update"})}),W.events.on("rotate-start",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,angle:X.angle,type:"rotate-start"},type:"update"})}),W.events.on("rotate-stop",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,angle:X.angle,type:"rotate-stop"},type:"update"})}),W.events.on("scale-start",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,xScale:X.xScale,yScale:X.yScale,type:"scale-start"},type:"update"})}),W.events.on("scale-stop",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{mover:X.object.graphic,xScale:X.xScale,yScale:X.yScale,type:"scale-stop"},type:"update"})}),W.events.on("translate",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,dx:X.dxScreen,dy:X.dyScreen,type:"move"},type:"update"})}),W.events.on("rotate",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,
angle:X.angle,type:"rotate"},type:"update"})}),W.events.on("scale",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:X.object.graphic,xScale:X.xScale,yScale:X.yScale,type:"scale"},type:"update"})}),W.events.on("immediate-click",X=>{X.shiftKey?this._toggleSelection([X.object.graphic],K,U):K.toggleTool()})];case "reshape-3d":return[W.events.on("reshape",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",
aborted:!1,tool:this.activeTool,toolEventInfo:{...X,mover:X.object.graphic},type:"update"})}),W.events.on("move",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...X,mover:X.object.graphic},type:"update"})}),W.events.on("vertex-add",X=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:X,type:"update"})}),W.events.on("vertex-remove",X=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:X,type:"update"})}),W.events.on("immediate-click",X=>{X.shiftKey?this._toggleSelection([X.object.graphic],K,U):K.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(K,U,W){const {graphic:X,viewEvent:ba}=W;if(ba.native?.shiftKey&&X.layer===this.layer)return ba.stopPropagation(),K.removeFromSelection(X);if(U.toggleToolOnClick)return ba.stopPropagation(),K.toggleTool()}_setUpdateOperationHandle(K,U){this._operationHandle=
K;const W=this.view?.map;this._disablePopup(U);K.on("complete",()=>{if(K===this._operationHandle){const X=this.updateGraphics.toArray(),ba=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();W&&W.remove(this._internalGraphicsLayer);this._restorePopup(U);this.emit("update",{graphics:X,state:"complete",aborted:K.cancelled,tool:ba,toolEventInfo:null,type:"update"})}})}async _getCommonUpdateOperationClickHandlers(K,
U,W){const X=T.createScreenPointFromEvent(U),ba=await U.async(()=>this._getFirstHit(X));null==ba?K.complete():U.native.shiftKey&&this._toggleSelection([ba.graphic],K,W)?U.stopPropagation():this.updateGraphics.includes(ba.graphic)?U.stopPropagation():K.complete()}_toggleSelection(K,U,W){const X=!!W.multipleSelectionEnabled;return K.some(ba=>null==ba?!1:X&&ba.layer===this.layer?(this.updateGraphics.includes(ba)?U.removeFromSelection(ba):U.addToSelection(ba),!0):!1)}_getCommonUpdateOperationKeyDownHandlers(K,
U){if(K){var W=U.key;W===x.sketchKeys.undo&&K.canUndo()?(U.stopPropagation(),K.undo()):W===x.sketchKeys.redo&&K.canRedo()?(U.stopPropagation(),K.redo()):W===x.sketchKeys.cancel?(U.stopPropagation(),K.cancel()):this.allowDeleteKey&&x.sketchKeys.delete.includes(W)&&this._onDeleteKey(U)}}_onDeleteKey(K){if(this._operationHandle&&"update"===this._operationHandle.type){var U=this.activeComponent,W=this.updateGraphics.toArray();null!=U&&("reshape"!==U.type||1===W.length&&"point"===W[0].geometry?.type)&&
(K.stopPropagation(),this.delete())}}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=n.destroyMaybe(this._internalGraphicsLayer))}_isComponentGraphic(K){const {activeComponent:U}=this;return K&&null!=U?K.attributes?.esriSketchTool||"draw-2d"===U.type&&U.graphic===K||("box"===U.type||"reshape"===U.type)&&U.isUIGraphic(K):!1}_displayPointerCursor(){this.view?.container&&"pointer"!==this.view.cursor&&(this.view.cursor=
"pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(K,U,W){q.getLogger(this).error(new h(K,U,W))}async _requireModule(K){const U=new AbortController;this._moduleLoaderAbortController=U;K=await K;return this._moduleLoaderAbortController!==U||U.signal.aborted?{requireError:"aborted"}:{module:K}}_emitUndoEvent(K){this.emit("undo",
{...K,type:"undo"})}_emitRedoEvent(K){this.emit("redo",{...K,type:"redo"})}_emitDeleteEvent(K){this.emit("delete",{...K,type:"delete"})}get test(){}wait(){return B.whenOnce(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1;this.notifyChange("updating")}_endAsyncOperation(){--this._numUpdating;this.notifyChange("updating")}_disablePopupEnabled(K){return"3d"!==this.view?.type||this.updateOnGraphicClick||(K?.toggleToolOnClick??!1)}_disablePopup(K){this._disablePopupEnabled(K)&&this.view&&
null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(K){this._disablePopupEnabled(K)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const K=this.view;K?(n.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await w.whenOrAbort(B.whenOnce(()=>K?.ready),this._viewReadyAbortController.signal)):
this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",ta("view"))}_logMissingLayer(){this._logError("sketch:missing-property",ta("layer"))}};b.__decorate([d.property()],g.prototype,"_defaultSnappingManager",void 0);b.__decorate([d.property()],g.prototype,"updating",null);b.__decorate([d.property()],g.prototype,"_operationHandle",void 0);b.__decorate([d.property({readOnly:!0})],g.prototype,"activeTool",null);b.__decorate([d.property()],g.prototype,"activeTooltip",null);
b.__decorate([d.property()],g.prototype,"activeFillSymbol",void 0);b.__decorate([d.property()],g.prototype,"activeLineSymbol",void 0);b.__decorate([d.property()],g.prototype,"activeVertexSymbol",void 0);b.__decorate([d.property()],g.prototype,"allowDeleteKey",void 0);b.__decorate([d.property({readOnly:!0})],g.prototype,"createGraphic",null);b.__decorate([d.property()],g.prototype,"defaultCreateOptions",null);b.__decorate([d.property()],g.prototype,"defaultUpdateOptions",null);b.__decorate([d.property({type:L,
nonNullable:!0})],g.prototype,"labelOptions",null);b.__decorate([d.property()],g.prototype,"layer",void 0);b.__decorate([d.property({types:c.symbolTypes})],g.prototype,"pointSymbol",void 0);b.__decorate([d.property({types:c.symbolTypes})],g.prototype,"polygonSymbol",void 0);b.__decorate([d.property({types:c.symbolTypes})],g.prototype,"polylineSymbol",void 0);b.__decorate([d.property()],g.prototype,"meshSymbol",void 0);b.__decorate([d.property({type:k,nonNullable:!0})],g.prototype,"snappingOptions",
null);b.__decorate([d.property()],g.prototype,"snappingManager",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"state",null);b.__decorate([d.property({type:Q,nonNullable:!0})],g.prototype,"tooltipOptions",null);b.__decorate([d.property({readOnly:!0})],g.prototype,"updateGraphics",void 0);b.__decorate([d.property()],g.prototype,"updateOnGraphicClick",void 0);b.__decorate([d.property({type:R,nonNullable:!0})],g.prototype,"valueOptions",null);b.__decorate([d.property({types:c.symbolTypes})],
g.prototype,"vertexSymbol",void 0);b.__decorate([d.property({value:null})],g.prototype,"view",null);b.__decorate([d.property({constructOnly:!0,type:S})],g.prototype,"sketchOptions",void 0);g=b.__decorate([v.subclass("esri.widgets.Sketch.SketchViewModel")],g);const ta=K=>`Property '${K}' is missing on SketchViewModel.`;return g})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B){c=class extends q.BlendLayer(n.ScaleRangeLayer(y)){constructor(d){super(d);this.elevationInfo=null;this.graphics=new w.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(d){this.graphics.add(d);return this}addMany(d){this.graphics.addMany(d);return this}removeAll(){this.graphics.removeAll();return this}remove(d){this.graphics.remove(d)}removeMany(d){this.graphics.removeMany(d)}on(d,
f){return super.on(d,f)}graphicChanged(d){this.emit("graphic-update",d)}};a.__decorate([b.property({type:B})],c.prototype,"elevationInfo",void 0);a.__decorate([b.property(m.owningCollectionProperty(w.GraphicsCollection,"graphics"))],c.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],c.prototype,"listMode",void 0);a.__decorate([b.property()],c.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],c.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
c.prototype,"internal",void 0);return c=a.__decorate([g.subclass("esri.layers.GraphicsLayer")],c)})},"esri/views/3d/interactive/editingTools/isSupportedObjectUtils":function(){define(["exports","../../../../core/has"],function(a,b){a.SupportedObjectResult=void 0;(function(c){c[c.SUPPORTED=0]="SUPPORTED";c[c.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";c[c.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";c[c.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";c[c.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";
c[c.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedObjectResult||(a.SupportedObjectResult={}));a.isSupportedObjectResultMessage=function(c){switch(c){case a.SupportedObjectResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case a.SupportedObjectResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";
case a.SupportedObjectResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/move/isSupportedObject":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,c,l){a.isSupportedObject=function(h){if(h.graphic&&"graphics"!==h.graphic.layer?.type)return l.SupportedObjectResult.GRAPHICS_LAYER_MISSING;
const g=h.operations?.data.type;if(!g)return l.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED;switch(g){case "polygon":case "point":case "polyline":case "mesh":break;default:return l.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}return c.hasEffectiveFeatureExpressionInfo(h.elevationInfo)?l.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:l.SupportedObjectResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports",
"../core/unitUtils","../symbols/support/unitConversionUtils"],function(a,b,c){function l(z,F){return F?.mode?F.mode:(z?v:t).mode}function h(z,F){return null!=F?F:z?v:t}function g(z,F){return l(null==z?!0:z.hasZ??!1,F)}function m(z){const F=n(z);z=g(z.geometry,F);const H=null!=F&&"on-the-ground"!==z?f(F):0;return{mode:z,offset:H,featureExpressionInfo:F?.featureExpressionInfo}}function y(z){return"0"===z?.featureExpressionInfo?.expression}function q(z){if(!z||"on-the-ground"===z.mode)return!1;z=z?.featureExpressionInfo?
z.featureExpressionInfo.expression:null;return!(!z||"0"===z)}function n(z){return z.layer&&"elevationInfo"in z.layer?z.layer.elevationInfo:null}function w(z,F){if(!z?.offset)return 0;const {offset:H,unit:J}=z;if("decimal-degrees"===J)return 0;z="unknown"!==J&&J?J:"meters";return(F=b.verticalLengthUnitFromSpatialReference(F))?b.convertUnit(H,z,F):0}function B(z,F,H,J,E,p,D=null){if(null!=p){var e=null!=D?D.mode:"absolute-height";if("on-the-ground"===e)return 0;({absoluteZ:p}=d(F,H,J,E,z,p));a:{D=w(D,
E);switch(e){case "absolute-height":z=p-D;break a;case "relative-to-ground":z=p-((z.elevationProvider.getElevation(F,H,J,E,"ground")??0)+D);break a;case "relative-to-scene":z=p-((z.elevationProvider.getElevation(F,H,J,E,"scene")??0)+D);break a}z=void 0}return z}}function d(z,F,H,J,E,p){const D=w(p,J);switch(p.mode){case "absolute-height":return{absoluteZ:H+D,elevation:0};case "on-the-ground":return H=E.elevationProvider.getElevation(z,F,0,J,"ground")??0,{absoluteZ:H,elevation:H};case "relative-to-ground":return z=
E.elevationProvider.getElevation(z,F,H,J,"ground")??0,{absoluteZ:H+z+D,elevation:z};case "relative-to-scene":return z=E.elevationProvider.getElevation(z,F,H,J,"scene")??0,{absoluteZ:H+z+D,elevation:z}}}function f(z){return(z?.offset??0)*c.getMetersPerUnit(z?.unit)}const v={mode:"absolute-height",offset:0},t={mode:"on-the-ground",offset:null};a.absoluteHeightElevationInfo=v;a.elevationContextAffectsAlignment=function(z,F){if(null==F)return!1;({mode:F}=F);return null!=F&&("scene"===z&&"relative-to-scene"===
F||"ground"===z&&"absolute-height"!==F)};a.elevationModeRequiredMessage=function(z,F,H){return H&&H.mode!==F?`${z} only support ${F} elevation mode`:null};a.elevationModeUnsupportedMessage=function(z,F,H){return H?.mode===F?`${z} do not support ${F} elevation mode`:null};a.featureExpressionInfoIsZero=y;a.featureExpressionUnsupportedMessage=function(z,F){return null!=F?.featureExpressionInfo&&"0"!==F.featureExpressionInfo.expression?`${z} do not support featureExpressionInfo`:null};a.getConvertedElevation=
function(z,F,H,J=null){return B(z,F.x,F.y,F.hasZ?F.z:0,F.spatialReference,H,J)};a.getConvertedElevationFromVector=function(z,F,H,J,E=null){return B(z,F[0],F[1],2<F.length?F[2]:0,H,J,E)};a.getConvertedElevationFromXYZ=B;a.getEffectiveElevationInfo=h;a.getEffectiveElevationMode=l;a.getElevationOffset=w;a.getElevationOffsetInMeters=f;a.getGeometryEffectiveElevationInfo=function(z,F){return h(null==z?!0:z.hasZ??!1,F)};a.getGeometryEffectiveElevationMode=g;a.getGraphicEffectiveElevationInfo=m;a.getGraphicEffectiveElevationMode=
function(z){const F=n(z);return g(z.geometry,F)};a.getZForElevationMode=function(z,F,H){if(H?.mode){var J=z.hasZ?z.z:0,E=w(H,z.spatialReference);switch(H.mode){case "absolute-height":return J-E;case "on-the-ground":return 0;case "relative-to-ground":return z=(F.elevationProvider.getElevation(z.x,z.y,J,z.spatialReference,"ground")??0)+E,J-z;case "relative-to-scene":return z=(F.elevationProvider.getElevation(z.x,z.y,J,z.spatialReference,"scene")??0)+E,J-z}}};a.hasEffectiveFeatureExpressionInfo=q;a.hasFeatureExpressionInfo=
function(z){return q(z)||y(z)};a.hasGraphicFeatureExpressionInfo=function(z){return q(m(z))};a.logInvalidElevationInfoWarning=function(z,F){F&&z.warn(".elevationInfo\x3d",F)};a.onTheGroundElevationInfo=t;a.zValueInAbsoluteHeightMode=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/isSupportedObject":function(){define(["exports","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,c){function l(h){if(h.graphic&&
"graphics"!==h.graphic.layer?.type)return{result:c.SupportedObjectResult.GRAPHICS_LAYER_MISSING};if(!h.operations)return{result:c.SupportedObjectResult.GEOMETRY_MISSING};if(b.hasEffectiveFeatureExpressionInfo(h.elevationInfo))return{result:c.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED};const g=h.operations.data.type;h=h.operations.data.geometry;return"point"===g||"mesh"===g||"polyline"===g||"polygon"===g?{result:c.SupportedObjectResult.SUPPORTED,geometry:h}:{result:c.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}}
a.geometryOfSupportedObject=function(h){return l(h).geometry};a.isSupportedObject=function(h){return l(h).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,c,l){a.isSupportedGraphic=function(h){if("graphics"!==h.layer?.type)return l.SupportedObjectResult.GRAPHICS_LAYER_MISSING;
if(null==h.geometry)return l.SupportedObjectResult.GEOMETRY_MISSING;switch(h.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return l.SupportedObjectResult.SUPPORTED;default:return l.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}const g=null!=h.symbol&&"point-3d"===h.symbol.type&&h.symbol.symbolLayers;return g&&g.some(m=>"object"===m.type)?"on-the-ground"!==c.getGraphicEffectiveElevationMode(h)&&c.hasGraphicFeatureExpressionInfo(h)?l.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:
l.SupportedObjectResult.SUPPORTED:l.SupportedObjectResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(b,c,l){if(c&&b?.map){({map:b}=b);var h=b.layers.find(g=>g===c);h||b.add(c,l);h&&null!=l&&b.layers.reorder(h,l)}};a.findLayerView=function(b,c){const l="subtype-sublayer"===c?.type?c.parent:c;return b.allLayerViews.find(h=>{h=h.layer;return h===l||"sublayers"in
h&&null!=h.sublayers&&h.sublayers.includes(l)})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define("exports ../../core/arrayUtils ../../core/handleUtils ../../core/MapUtils ../input/InputManager ../input/keys".split(" "),function(a,b,c,l,h,g){g={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",
modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:g.primaryKey,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"};class m{constructor(){this._bindings=new Map}add(q,n){return this.addToggle(q,w=>{"key-down"===w.type&&n(w)})}addToggle(q,n){const w=y.fromDefinition(q,n),B=l.getOrCreateMapValue(this._bindings,w.key,
()=>[]);B.push(w);return c.makeHandle(()=>b.remove(B,w))}register(q,n=h.ViewEventPriorities.WIDGET){return c.handlesGroup([q.on("key-down",w=>this.dispatch(q.inputManager,w),n),q.on("key-up",w=>this.dispatch(q.inputManager,w),n)])}dispatch(q,n){const w=this._bindings.get(n.key);if(w)for(const B of w)B.process(q,n)}}class y{constructor(q,n,w,B,d){this.key=q;this.modifiers=n;this.repeats=w;this.continuePropagation=B;this.callback=d}process(q,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const w of this.modifiers)if(!q.isModifierKeyDown(w))return;
this.continuePropagation||n.stopPropagation();this.callback(n)}}static fromDefinition(q,n){if("string"===typeof q)return new y(q,[],!1,!1,n);const {key:w,modifier:B,repeats:d,continuePropagation:f}=q;return new y(w,B?Array.isArray(B)?B:[B]:[],!!d,!!f,n)}}a.KeyBindings=m;a.mediaKeys=g;a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",
commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,c,l,h,g,m){b=class extends b{constructor(y){super(y);this.enabled=!1}};a.__decorate([c.property({type:Boolean,
nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchLabelOptions ./SketchTooltipOptions ./SketchValueOptions".split(" "),function(a,
b,c,l,h,g,m,y,q,n){b=class extends b{constructor(w){super(w);this.labels=new y;this.tooltips=new q;this.values=new n}};a.__decorate([c.property({nonNullable:!0,type:y})],b.prototype,"labels",void 0);a.__decorate([c.property({nonNullable:!0,type:q})],b.prototype,"tooltips",void 0);a.__decorate([c.property({nonNullable:!0,type:n})],b.prototype,"values",void 0);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.SketchOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,c,l,h,g,m,y,q){b=class extends b{constructor(n){super(n);this.forceEnabled=this.enabled=!1;this.helpMessageIcon=this.helpMessage=null;this.inputEnabled=!0;this.elevation=new y.SketchTooltipElevationOptions;this.placement="auto";this.offset=null;this.visibleElements=new q;this.visualVariables=null;this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([c.property()],
b.prototype,"forceEnabled",void 0);a.__decorate([c.property()],b.prototype,"effectiveEnabled",null);a.__decorate([c.property()],b.prototype,"helpMessage",void 0);a.__decorate([c.property()],b.prototype,"helpMessageIcon",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",void 0);a.__decorate([c.property({type:y.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([c.property()],b.prototype,"placement",void 0);a.__decorate([c.property()],
b.prototype,"offset",void 0);a.__decorate([c.property({type:q,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([c.property()],b.prototype,"visualVariables",void 0);a.__decorate([c.property()],b.prototype,"xyMode",void 0);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m,y){a.SketchTooltipElevationOptions=class extends c{constructor(q){super(q);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([l.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([y.subclass("esri.views.interactive.sketch.SketchTooltipElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m){b=class extends b{constructor(y){super(y);this.header=this.elevation=this.distance=this.direction=this.coordinates=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"area",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"coordinates",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,
"direction",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"distance",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"helpMessage",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"orientation",void 0);a.__decorate([c.property({type:Boolean,
nonNullable:!0})],b.prototype,"radius",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"rotation",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"scale",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"size",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"totalLength",void 0);return b=a.__decorate([m.subclass("esri.views.interactive.sketch.SketchTooltipVisibleElements")],b)})},"esri/views/interactive/snapping/SnappingManager":function(){define("require exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/asyncUtils ../../../core/Evented ../../../core/has ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingDomain ./SnappingOptions ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/IntersectionSnappingCandidate ./candidates/LineSnappingCandidate ./candidates/ParallelLineSnappingCandidate ./candidates/RightAngleSnappingCandidate ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J,E,p,D,e,r,G,A,x){function L(I,k){return!k||null==k.direction&&null==k.distance?!0:I instanceof E.DrapedEdgeSnappingCandidate||I instanceof p.EdgeSnappingCandidate||I instanceof e.LineSnappingCandidate||I instanceof r.ParallelLineSnappingCandidate||I instanceof A.RightAngleTriangleSnappingCandidate||I instanceof G.RightAngleSnappingCandidate&&(null!=k.direction||I.selfSnappingType!==G.SelfSnappingRightAngleType.LastVertex)?!1:!0}function S(I,k){let u=
-1;for(let C=0;C<I.length;++C)if(k.constraint.equals(I[C].constraint)){u=C;break}return u}function Q({coordinateHelper:I,elevationInfo:k}){return I.hasZ()?v.absoluteHeightElevationInfo:k}b.SnappingManager=class extends g.EventedMixin(l){constructor(I){super(I);this.options=new H;this._engineCache=new Map;this._loadTask=null;this._engines=[];this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=R.MAIN}initialize(){this.addHandles([q.watch(()=>{const {distance:I,
touchSensitivityMultiplier:k,effectiveSelfEnabled:u,effectiveFeatureEnabled:C,effectiveGridEnabled:T}=this.options;return{selfEnabled:u,featureEnabled:C,gridEnabled:"2d"===this.view.type&&T,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:I,touchSensitivityMultiplier:k}},(I,k)=>{k&&(this.doneSnapping(),this.emit("changed"));this._loadTask?.abort();this._loadTask=h.createTask(u=>this._updateEngines(I,k,u))},q.syncAndInitial),q.watch(()=>this.options,I=>{for(const k of this._engines)k.options=
I},q.sync)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(I=>I.updating)||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach(I=>I.destroy());this._engineCache.clear();this._engines=[]}async _updateEngines(I,k,u){if(I.viewReady){k?.viewSpatialReference!==I.viewSpatialReference&&this._destroyEngines();({_engineCache:k}=this);var C=[];I.featureEnabled&&!k.has("feature")&&C.push(this._setupFeatureSnappingEngine(u));I.selfEnabled&&!k.has("self")&&C.push(this._setupSelfSnappingEngine(u));
I.gridEnabled&&!k.has("grid")&&"2d"===this.view.type&&C.push(this._setupGridSnappingEngine(u));await Promise.allSettled(C);u.aborted||(this._engines=Array.from(k.values()))}else this._destroyEngines()}async _setupSelfSnappingEngine(I){const {SelfSnappingEngine:k}=await new Promise((u,C)=>a(["./SelfSnappingEngine"],u,C));y.throwIfAborted(I);I=new k({view:this.view,options:this.options});this._engineCache.set("self",I)}async _setupGridSnappingEngine(I){const {view:k}=this,{GridSnappingEngine:u}=await new Promise((C,
T)=>a(["./GridSnappingEngine"],C,T));y.throwIfAborted(I);"2d"===k.type&&(I=new u({view:k,options:this.options}),this._engineCache.set("grid",I))}async _setupFeatureSnappingEngine(I){const {FeatureSnappingEngine:k}=await new Promise((M,N)=>a(["./FeatureSnappingEngine"],M,N));y.throwIfAborted(I);const {view:u,options:C,_engineCache:T}=this;I=new k({view:u,options:C,spatialReference:u.spatialReference});T.set("feature",I)}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:I,
touchSensitivityMultiplier:k}=this.options,u=I*k;return u*u}snap(I){return null!=I.scenePoint?this._snapMultiPoint(I):this._snapSinglePoint(I)}update(I){const {point:k,context:u}=I;this._removeVisualization();const C=this._currentMainCandidate;if(null==C)return k;var T=this._selectUpdateInput(I);if(null==T)return k;({spatialReference:I}=u);var M=f.project(T,I);if(null==M)return k;({view:T}=this);const {elevationInfo:N,visualizer:V}=u,Y=[];M=t.fromPoint(M,T,N);const ea=C.constraint.closestTo(M);if(!this._arePointsWithinScreenThreshold(M,
ea,u)||!L(C,u.drawConstraints))return this._resetSnappingState(),k;C.targetPoint=t.markAsTarget(ea);Y.push(...C.hints);for(const Z of this._currentOtherActiveCandidates)L(Z,u.drawConstraints)&&(Z.targetPoint=t.markAsTarget(ea),Y.push(...Z.hints));null!=V&&this.addHandles(V.draw(Y,{spatialReference:I,elevationInfo:Q(u),view:T,selfSnappingZ:u.selfSnappingZ}),"visualization-handle");return t.toElevationAlignedDehydratedPoint(ea,T,k,u)}doneSnapping(){this._removeVisualization();this._resetSnappingState()}_selectUpdateInput({point:I,
scenePoint:k}){switch(this._currentSnappedType){case R.MAIN:return I;case R.SCENE:return k}}_resetSnappingState(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=R.MAIN}_removeVisualization(){this.removeHandles("visualization-handle")}async _snapSinglePoint({point:I,context:k,signal:u}){const {view:C}=this;var {elevationInfo:T}=k;T=t.fromPoint(I,C,T);const M=await this._fetchCandidates(T,F.SnappingDomain.ALL,k,u);return this._createSnapResult(T,R.MAIN,
M,C,I,k,u)}async _snapMultiPoint({point:I,scenePoint:k,context:u,signal:C}){const {view:T}=this,{coordinateHelper:M,elevationInfo:N,spatialReference:V}=u;await f.initializeProjection(k.spatialReference,V);k=f.project(k,V);var Y=t.fromPoint(k,T,N);const ea=await this._fetchCandidates(Y,F.SnappingDomain.FEATURE,u,C);if(0<ea.length)return I=await this._fetchCandidates(Y,F.SnappingDomain.SELF,u,C),this._createSnapResult(Y,R.SCENE,[...ea,...I],T,k,u,C);k=t.fromPoint(I,T,N);Y=await this._fetchCandidates(k,
F.SnappingDomain.SELF,u,C);return this._createSnapResult(k,R.MAIN,Y,T,{z:M.hasZ()&&I.hasZ?I.z??0:void 0,m:M.hasM()&&I.hasM?I.m??0:void 0},u,C)}async _fetchCandidates(I,k,u,C){return(await Promise.all(this._engines.map(T=>T.fetchCandidates(I,k,u,C)))).flat()}_createSnapResult(I,k,u,C,T,M,N){return{get valid(){return!y.isAborted(N)},apply:()=>{const {spatialReference:V}=M,{snappedPoint:Y,hints:ea}=this._processCandidates(I,k,u,M);this._removeVisualization();null!=M.visualizer&&this.addHandles(M.visualizer.draw(ea,
{spatialReference:V,elevationInfo:v.absoluteHeightElevationInfo,view:C,selfSnappingZ:M.selfSnappingZ}),"visualization-handle");return t.toElevationAlignedDehydratedPoint(Y,C,T,M)}}}_processCandidates(I,k,u,C){if(1>u.length)return this.doneSnapping(),{snappedPoint:I,hints:[]};this._currentSnappedType!==k&&this._resetSnappingState();J.sortCandidatesInPlace(I,u);const T=this._currentMainCandidate;if(null!=T){var M=T instanceof D.IntersectionSnappingCandidate?0<=S(u,T.first)&&0<=S(u,T.second)?0:-1:S(u,
T);if(0<=M)if(u[M]instanceof D.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(I,T.targetPoint,C))return this._updateSnappingCandidate(T,k,u,C)}else return this._intersectWithOtherCandidates(M,u,I,k,C)}return this._intersectWithOtherCandidates(0,u,I,k,C)}_intersectWithOtherCandidates(I,k,u,C,T){const {coordinateHelper:M}=T,N=k[I],V=[];for(let Y=0;Y<k.length;++Y){if(Y===I)continue;const ea=k[Y],Z=N.constraint.intersect(ea.constraint);if(Z)for(const ia of Z.closestPoints(N.targetPoint))V.push([new D.IntersectionSnappingCandidate(t.markAsTarget(ia),
N,ea,ea.isDraped),this._squaredScreenDistance(u,ia,M)])}return 0<V.length&&(V.sort((Y,ea)=>Y[1]-ea[1]),V[0][1]<this._squaredPointProximityThreshold(T.pointer))?this._updateSnappingCandidate(V[0][0],C,k,T):L(N,T.drawConstraints)?this._updateSnappingCandidate(N,C,k,T):{snappedPoint:u,hints:[]}}_updateSnappingCandidate(I,k,u,C){this.doneSnapping();this._currentMainCandidate=I;this._currentSnappedType=k;k=this._currentMainCandidate.targetPoint;const T=[];T.push(...I.hints);for(const M of u){if(I instanceof
D.IntersectionSnappingCandidate){if(M.constraint.equals(I.first.constraint)||M.constraint.equals(I.second.constraint))continue}else if(M.constraint.equals(I.constraint))continue;u=M.constraint.closestTo(k);this._squaredScreenDistance(u,k,C.coordinateHelper)<z.defaults.satisfiesConstraintScreenThreshold*z.defaults.satisfiesConstraintScreenThreshold&&(M.targetPoint=k,this._currentOtherActiveCandidates.push(M),T.push(...M.hints))}return{snappedPoint:k,hints:T}}_squaredPointProximityThreshold(I){return"touch"===
I?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(I,k,u){return this._squaredScreenDistance(I,k,u.coordinateHelper)<this._squaredPointProximityThreshold(u.pointer)}_squaredScreenDistance(I,k,u){return J.squaredScreenDistance(this._toScreen(I,u),this._toScreen(k,u))}_toScreen(I,k){return x.vectorToScreenPoint(I,k.spatialReference,v.absoluteHeightElevationInfo,this.view)}get test(){}};c.__decorate([n.property({constructOnly:!0})],b.SnappingManager.prototype,
"view",void 0);c.__decorate([n.property()],b.SnappingManager.prototype,"options",void 0);c.__decorate([n.property({readOnly:!0})],b.SnappingManager.prototype,"updating",null);c.__decorate([n.property()],b.SnappingManager.prototype,"_loadTask",void 0);c.__decorate([n.property()],b.SnappingManager.prototype,"_engines",void 0);c.__decorate([n.property()],b.SnappingManager.prototype,"_squaredMouseProximityThreshold",null);c.__decorate([n.property()],b.SnappingManager.prototype,"_squaredTouchProximityThreshold",
null);b.SnappingManager=c.__decorate([d.subclass("esri.views.interactive.snapping.SnappingManager")],b.SnappingManager);var R;(function(I){I[I.MAIN=0]="MAIN";I[I.SCENE=1]="SCENE"})(R||={});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,c,l){function h(q=0,n=0,w=
0){return b.fromValues(q,n,w)}function g(q,n,w,B=h()){B[0]=q.x;B[1]=q.y;B[2]=q.z??0;if(null==n)return B;B[2]="2d"===n.type?0:l.getConvertedElevation(n,q,w,l.absoluteHeightElevationInfo)??0;return B}var m;(function(q){q[q.NONE=0]="NONE";q[q.TARGET=1]="TARGET"})(m||={});const y=c.makeDehydratedPoint(0,0,0,null);a.asVec2=function(q){return q};a.clone=function(q){const [n,w,B]=q;return 3<q.length?[n,w,B,q[3]]:[n,w,B]};a.create=function(q,n,w){return h(q,n,w)};a.createWritable=h;a.fromAnyMapPoint=function(q,
n,{coordinateHelper:w,elevationInfo:B},d){return q?g(w.vectorToDehydratedPoint(q,y),n,B,d):null};a.fromPoint=g;a.fromValues=function(q,n,w){return b.fromValues(q,n,w)};a.fromVec3=function(q){return q};a.isTarget=function(q){return!!(((3<q.length?q[3]:void 0)??m.NONE)&m.TARGET)};a.markAsTarget=function(q){q[3]=((3<q.length?q[3]:void 0)??m.NONE)|m.TARGET;return q};a.toDehydratedPoint=function(q,n,w){return w?(c.setDehydratedPoint(w,q[0],q[1],q[2],n),w):c.makeDehydratedPoint(q[0],q[1],q[2],n)};a.toElevationAlignedDehydratedPoint=
function(q,n,{z:w,m:B},d,f){const {spatialReference:v,elevationInfo:t}=d;n=null==w&&null==B?void 0:null==n||"2d"===n.type?w??void 0:l.getConvertedElevationFromVector(n,q,v,l.absoluteHeightElevationInfo,t)??0;const [z,F]=q;f?c.setDehydratedPoint(f,z,F,n,v):f=c.makeDehydratedPoint(z,F,n,v);null!=B&&(f.m=B,f.hasM=!0);return f};a.withSelfSnappingZ=function(q,n,w,B,d=h()){const [f,v]=q;d[0]=f;d[1]=v;3<q.length&&(d[3]=q[3]??m.NONE);if("3d"!==w?.type)return d[2]=n.value,d;d[2]=l.getConvertedElevationFromXYZ(w,
f,v,n.value,B,n.elevationInfo,l.absoluteHeightElevationInfo)??0;return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,c,l,h,g){let m=class extends l.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([h.property({type:Boolean})],
m.prototype,"enabled",void 0);m=b.__decorate([g.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],m);l=class extends l.JSONSupport{constructor(y){super(y);this.lineSnapper=new m;this.parallelLineSnapper=new m;this.rightAngleSnapper=new m;this.rightAngleTriangleSnapper=new m;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThresholdMeters=.3;this.touchSensitivityMultiplier=
1.5;this.pointOnLineThreshold=1E-6;this.orange=new c([255,127,0]);this.orangeTransparent=new c([255,127,0,.5]);this.lineHintWidthTarget=this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=1}};b.__decorate([h.property({type:m,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"lineSnapper",
void 0);b.__decorate([h.property({type:m,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"parallelLineSnapper",void 0);b.__decorate([h.property({type:m,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"rightAngleSnapper",void 0);b.__decorate([h.property({type:m,constructOnly:!0,nonNullable:!0,json:{write:!0}})],l.prototype,"rightAngleTriangleSnapper",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l.prototype,
"shortLineThreshold",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],l.prototype,"distance",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"pointThreshold",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,
max:1E-5},json:{write:!0}})],l.prototype,"parallelLineThreshold",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],l.prototype,"verticalLineThresholdMeters",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],l.prototype,"pointOnLineThreshold",void 0);b.__decorate([h.property({type:c,
nonNullable:!0})],l.prototype,"orange",void 0);b.__decorate([h.property({type:c,nonNullable:!0})],l.prototype,"orangeTransparent",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"lineHintWidthReference",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"lineHintWidthTarget",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],
l.prototype,"lineHintFadedExtensions",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],l.prototype,"parallelLineHintWidth",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],l.prototype,"parallelLineHintLength",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],l.prototype,"parallelLineHintOffset",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,
range:{min:0,max:46},json:{write:!0}})],l.prototype,"rightAngleHintSize",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],l.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([h.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],l.prototype,"satisfiesConstraintScreenThreshold",void 0);l=b.__decorate([g.subclass("esri.views.interactive.snapping.Settings.Defaults")],l);b=new l;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Logger ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(a,b,c,l,h,g,m,y,q,n){function w(f){return"subtype-group"===f.layer.type}function B(f){return"subtype-group"!==f.layer.type}function d(f){return"subtype-sublayer"===f.layer.type}b=class extends b{constructor(f){super(f);this.forceDisabled=this.enabledToggled=this.enabled=!1;this.featureEnabled=this.selfEnabled=!0;this.attributeRulesEnabled=this.gridEnabled=!1;this.featureSources=new l;this.distance=n.defaults.distance;this.touchSensitivityMultiplier=n.defaults.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&
(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var f=this.featureSources;f.some(w)&&h.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");
const v=f.filter(d),t=this._get("_effectiveFeatureSources")?.filter(w)??new l;for(const E of v){var z=t.find(p=>p.layer===E.layer.parent);z?z.sublayerSources.includes(E)||z.sublayerSources.add(E):E.layer.parent&&(z=new q({layer:E.layer.parent}),z.sublayerSources.add(E),t.add(z))}for(var F of t)z=F.sublayerSources.filter(E=>!v.includes(E)),F.sublayerSources.removeMany(z);t.removeMany(t.filter(E=>0===E.sublayerSources.length));f=f.filter(B);F=this._get("_effectiveFeatureSources")??new l;const {added:H,
removed:J}=c.difference(F.toArray(),[...f,...t]);F.removeMany(J);F.addMany(H);return F}};a.__decorate([g.property()],b.prototype,"enabled",void 0);a.__decorate([g.property()],b.prototype,"enabledToggled",void 0);a.__decorate([g.property()],b.prototype,"forceDisabled",void 0);a.__decorate([g.property()],b.prototype,"selfEnabled",void 0);a.__decorate([g.property()],b.prototype,"featureEnabled",void 0);a.__decorate([g.property()],b.prototype,"gridEnabled",void 0);a.__decorate([g.property()],b.prototype,
"attributeRulesEnabled",void 0);a.__decorate([g.property({type:l.ofType(q)})],b.prototype,"featureSources",void 0);a.__decorate([g.property()],b.prototype,"distance",void 0);a.__decorate([g.property()],b.prototype,"touchSensitivityMultiplier",void 0);a.__decorate([g.property({readOnly:!0})],b.prototype,"effectiveEnabled",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"effectiveGridEnabled",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null);a.__decorate([g.property({readOnly:!0})],
b.prototype,"effectiveFeatureEnabled",null);a.__decorate([g.property({readOnly:!0})],b.prototype,"_effectiveFeatureSources",null);return b=a.__decorate([y.subclass("esri.views.interactive.snapping.SnappingOptions")],b)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m,y){b=class extends b{constructor(q){super(q);this.layer=null;this.enabled=!0;this.updating=!1;this.availability=1;this.sublayerSources=new c}};a.__decorate([l.property({constructOnly:!0})],b.prototype,"layer",void 0);a.__decorate([l.property()],b.prototype,"enabled",void 0);a.__decorate([l.property()],b.prototype,"updating",void 0);a.__decorate([l.property()],b.prototype,"availability",void 0);a.__decorate([l.property()],b.prototype,"sublayerSources",void 0);return b=a.__decorate([y.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
b)})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec32 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint ../../../webmap/utils".split(" "),function(a,b,c,l,h,g,m,y,q,n,w,B){function d(t,z){const F=t.x-z.x;t=t.y-z.y;return F*F+t*t}const f=Symbol("grid-placement-graphic");a.LineSegmentHintType=
void 0;(function(t){t[t.TARGET=0]="TARGET";t[t.REFERENCE=1]="REFERENCE";t[t.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));const v=Symbol("snapping-toggle");a.editEdgeToSnappingEdge=function(t,z,F){return{left:w.fromAnyMapPoint(t.leftVertex.pos,z,F),right:w.fromAnyMapPoint(t.rightVertex.pos,z,F)}};a.gridPlacementGraphicSymbol=f;a.isUtilityNetworkWebMap=function(t){return B.isWebMap(t)&&"utilityNetworks"in t&&!!t.utilityNetworks?.length};a.makeFilter=
function(t){return t.createQuery()};a.makeSnappingQuery=function({point:t,distance:z,returnEdge:F,vertexMode:H,coordinateHelper:{spatialReference:J},filter:E},p,D){D=null!=D?D.clone():new y({where:"1\x3d1"});if(E){D.geometry=E.geometry;D.distance=E.distance;D.spatialRelationship=E.spatialRelationship;D.where=l.sqlAnd(D.where,E.where);D.timeExtent=h.mergeTimeExtents(D.timeExtent,E.timeExtent);var e=D;var r=D.objectIds;E=E.objectIds;r=r||E?E?r?Array.from(c.intersection(new Set(r),new Set(E))):E:r:null;
e.objectIds=r}return{point:m.makeDehydratedPoint(t[0],t[1],t[2],J.toJSON()),mode:p,distance:z,returnEdge:F,vertexMode:H,query:D.toJSON()}};a.objectEqual=function(t,z){const F=t.length===z.length&&t[0]===z[0]&&t[1]===z[1];switch(t.length){case 2:return F;case 3:return F&&t[2]===z[2];case 4:return F&&t[2]===z[2]&&t[3]===z[3]}return!1};a.screenDistance=function(t,z){return Math.sqrt(d(t,z))};a.setupSnappingToggleHandles=function(t,z=()=>{}){const F=b.watch(()=>({view:t.view,snappingOptions:t.snappingOptions}),
({view:H,snappingOptions:J})=>{t.removeHandles(v);if(H&&J){var E=q.ViewEventPriorities.TOOL;H=[H.on("key-down",p=>{p.key!==n.snappingKeys.toggle||p.repeat||(J.enabledToggled=!0,z())},E),H.on("key-up",p=>{p.key===n.snappingKeys.toggle&&(J.enabledToggled=!1,z())},E),H.on("pointer-move",p=>{p=p.native.ctrlKey;J.enabledToggled!==p&&(J.enabledToggled=p,z())},E)];t.addHandles(H,v)}},b.syncAndInitial);t.addHandles(F)};a.sortCandidatesInPlace=function(t,z){z.sort((F,H)=>{F=g.squaredDistance(F.targetPoint,
t);H=g.squaredDistance(H.targetPoint,t);return F-H})};a.squaredScreenDistance=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/utils":function(){define(["exports","./Version"],function(a,b){b=new b.Version(2,32);a.currentVersion=b;a.isWebMap=function(c){return null!=c&&"object"===typeof c&&"declaredClass"in c&&"esri.WebMap"===c.declaredClass};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/Version":function(){define(["exports","../core/Version"],
function(a,b){class c extends b.Version{constructor(l,h){super(l,h,"webmap")}}a.Version=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,c,l,h){class g extends l.FeatureSnappingCandidate{constructor(m){super({...m,isDraped:!0,constraint:new b.DrapedLineConstraint(m.edgeStart,
m.edgeEnd,m.getGroundElevation)})}get hints(){return[new h.LineSnappingHint(c.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.DrapedEdgeSnappingCandidate=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../core/mathUtils ../../../core/libs/gl-matrix-2/math/vec2 ../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../chunks/vec42 ../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../geometry/support/geodesicConstants ../../../geometry/support/geodesicUtils ../../../geometry/support/plane ../../../chunks/sphere ../../3d/support/mathUtils ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z){function F(O,P){if(O instanceof Y){var ha=[];for(const ka of O.constraints)(O=ka.intersect(P))&&ha.push(O);return A(ha)}if(P instanceof Y)return F(P,O);if(O instanceof W)return D(O,P);if(P instanceof W)return D(P,O);if(x(O)){({point:ha}=O);if(x(P))return g.exactEquals(ha,P.point)?O:void 0;P=P.closestTo(ha);return g.equals(P,ha)?O:void 0}if(L(O)){if(x(P))return F(P,O);if(L(P))return r(t.intersectLineLikes(O.lineLike,P.lineLike));if(S(P))return fa(O,P);if(Q(P))return r(t.intersectVerticalPlaneAndLineLike(P.planeLike,
O.lineLike));if(R(P))return r(t.intersectLineLikeAndVerticalCylinder(O.lineLike,P.center,P.radius));if(k(P))return r(t.intersectLineLikeAndCircle(O.lineLike,P));if(I(P))return H(O,P);if(u(P))return J(O,P)}else if(S(O)){if(x(P)||L(P))return F(P,O);if(S(P))return t.isClose(O.z,P.z)?O:void 0;if(Q(P))return E(O,P);if(R(P)){const [ka,qa]=P.center;return new Z(v.fromValues(ka,qa,O.z),P.radius)}if(k(P))return sa(O,P);if(I(P))return t.isClose(P.center[2],O.z)?P:void 0;if(u(P))return p(O,P)}else if(Q(O)){if(x(P)||
L(P)||S(P))return F(P,O);if(Q(P))return e(t.intersectVerticalPlanes(O.planeLike,P.planeLike));if(R(P))return e(t.intersectVerticalPlaneAndVerticalCylinder(O.planeLike,P.center,P.radius));if(k(P))return ua(O,P);if(I(P))return ya(O,P);if(u(P))return pa(O,P)}else if(R(O)){if(x(P)||L(P)||S(P)||Q(P))return F(P,O);if(R(P))return e(t.intersectVerticalCylinders(v.asVec2(O.center),O.radius,v.asVec2(P.center),P.radius));if(!k(P)){if(I(P))return ha=l.squaredDistance(v.asVec2(O.center),v.asVec2(P.center)),t.isClose(ha,
0)&&t.isClose(O.radius,P.radius)||(O=t.intersectVerticalCylinders(v.asVec2(O.center),O.radius,v.asVec2(P.center),P.radius),P=G(O,P.center[2])),P;u(P)}}else if(k(O)){if(x(P)||L(P)||S(P)||Q(P)||R(P))return F(P,O);k(P)||(I(P)?P.asCircle():u(P))}else if(I(O)){if(x(P)||L(P)||S(P)||Q(P)||R(P)||k(P))return F(P,O);if(I(P))return t.vectorsHaveCloseZ(P.center,O.center)?(ha=l.squaredDistance(v.asVec2(P.center),v.asVec2(O.center)),t.isClose(ha,0)&&t.isClose(P.radius,O.radius)||(O=t.intersectVerticalCylinders(v.asVec2(P.center),
P.radius,v.asVec2(O.center),O.radius),P=G(O,P.center[2]))):P=void 0,P;u(P)}else if(u(O)){if(x(P)||L(P)||S(P)||Q(P)||R(P)||I(P))return F(P,O);u(P)}}function H({lineLike:O},{center:P,radius:ha}){const ka=P[2];O=t.intersectLineLikeAndVerticalCylinder(O,P,ha).filter(qa=>t.isClose(qa[2],ka));return r(O)}function J({lineLike:O},{sphere:P}){return r(d.intersectLine(P,O.start,O.end))}function E({z:O},{planeLike:P}){const [ha,ka]=P.start,[qa,xa]=P.end,Ba=v.fromValues(ha,ka,O);O=v.fromValues(qa,xa,O);return P.type===
t.VerticalPlaneType.PLANE?new N(Ba,O):new V(Ba,O)}function p(O,{center:P,radius:ha}){const ka=Math.abs(P[2]-O.z);if(!(ka>ha)||t.isClose(ka,ha))if(O=v.fromValues(P[0],P[1],O.z),ha=Math.sqrt(ha**2-ka**2),!t.isClose(ha,0))return new Z(O,ha)}function D(O,P){const {planeLike:ha,getZ:ka}=O,qa=[];if(x(P))O.addIfOnTheGround(qa,t.intersectVerticalPlaneAndPoint(ha,P.point));else if(L(P))O.addIfOnTheGround(qa,t.intersectVerticalPlaneAndLineLike(ha,P.lineLike));else if(R(P))for(const [xa,Ba]of t.intersectVerticalPlaneAndVerticalCylinder(ha,
P.center,P.radius))O=ka(xa,Ba),null!=O&&qa.push(m.fromValues(xa,Ba,O));else if(Q(P)||P instanceof W)for(const [xa,Ba]of t.intersectVerticalPlanes(ha,P.planeLike))O=ka(xa,Ba)??0,qa.push(m.fromValues(xa,Ba,O));return r(qa)}function e(O){return A(O.map(([P,ha])=>{const ka=v.fromValues(P,ha,0);P=v.fromValues(P,ha,1);return new N(ka,P)}))}function r(O){return A(O.map(P=>P?new T(v.fromVec3(P)):void 0))}function G(O,P){return r(O.map(([ha,ka])=>[ha,ka,P]))}function A(O){if(0!==O.length)return 1===O.length?
O[0]??void 0:new Y(O.filter(b.isSome))}function x(O){return O instanceof T}function L(O){return O instanceof M}function S(O){return O instanceof na}function Q(O){return O instanceof Aa}function R(O){return O instanceof ea}function I(O){return O instanceof Z}function k(O){return O instanceof ia}function u(O){return O instanceof U}class C{intersect(O){return F(this,O)}closestPoints(O){return[this.closestTo(O)]}}class T extends C{constructor(O){super();this.point=O}equals(O){return this===O||x(O)&&g.exactEquals(this.point,
O.point)}closestTo(){return v.clone(this.point)}}class M extends C{constructor(O,P,ha){super();this.start=O;this.end=P;this.lineLike={start:O,end:P,type:ha}}equals(O){return this===O||L(O)&&this.lineLike.type===O.lineLike.type&&g.exactEquals(this.start,O.start)&&g.exactEquals(this.end,O.end)}closestTo(O){const P=v.createWritable();t.projectPointToLineLike(O,this.lineLike,P);return P}}class N extends M{constructor(O,P){super(O,P,z.LineType.LINE)}}class V extends M{constructor(O,P){super(O,P,z.LineType.RAY)}}
class Y extends C{constructor(O){super();this.constraints=O}equals(O){return this===O||O instanceof Y&&b.equals(this.constraints,O.constraints,(P,ha)=>P.equals(ha))}closestTo(O){let P=Infinity,ha;for(const ka of this.constraints){const qa=ka.closestTo(O),xa=g.squaredDistance(O,qa);xa<P&&(P=xa,ha=qa)}return v.clone(ha??O)}closestPoints(O){return this.constraints.flatMap(P=>P===this?[]:P.closestPoints(O))}}class ea extends C{constructor(O,P){super();this.center=O;this.radius=P}equals(O){return this===
O||R(O)&&this.center[0]===O.center[0]&&this.center[1]===O.center[1]&&this.radius===O.radius}closestTo(O){const P=v.createWritable();t.projectPointToVerticalCylinder(O,this.center,this.radius,P);return P}}class Z extends C{constructor(O,P){super();this.center=O;this.radius=P}equals(O){return this===O||I(O)&&g.exactEquals(this.center,O.center)&&this.radius===O.radius}closestTo(O){const P=v.createWritable();t.projectPointToVerticalCylinder(O,this.center,this.radius,P);P[2]=this.center[2];return P}asCircle(){return new ia(v.clone(this.center),
this.radius,v.fromValues(0,0,1))}}class ia extends C{constructor(O,P,ha,ka){super();this.center=O;this.radius=P;this.normal=ha;this.slicePlane=ka}equals(O){return this===O||k(O)&&g.exactEquals(this.center,O.center)&&g.exactEquals(this.normal,O.normal)&&this.radius===O.radius}closestTo(O){const {center:P,radius:ha}=this;B.projectPoint(this.getPlane(ra),O,oa);var ka=g.sub(oa,oa,P),qa=g.squaredLength(ka);if(t.isClose(qa,0))return v.clone(O);const xa=ha/Math.sqrt(qa);qa=v.createWritable();g.scaleAndAdd(qa,
P,ka,xa);({slicePlane:ka}=this);return ka&&!t.isPointInsidePlane(ka,qa)?wa(ka,this)?.closestTo(O)??v.clone(O):qa}getPlane(O=B.create()){return B.fromPositionAndNormal(this.center,this.normal,O)}}const oa=m.create(),ra=B.create();class na extends C{constructor(O){super();this.z=O}equals(O){return this===O||S(O)&&this.z===O.z}closestTo(O){return v.fromValues(O[0],O[1],this.z)}getPlane(O=B.create()){g.set(za,0,0,this.z);return B.fromPositionAndNormal(za,m.UNIT_Z,O)}}const za=m.create();class Aa extends C{constructor(O,
P,ha){super();this.start=O;this.end=P;this.planeLike={start:v.asVec2(O),end:v.asVec2(P),type:ha}}equals(O){return this===O||Q(O)&&this.planeLike.type===O.planeLike.type&&g.exactEquals(this.start,O.start)&&g.exactEquals(this.end,O.end)}closestTo(O){const P=v.createWritable();t.projectPointToVerticalPlane(O,this.planeLike,P);return P}closestEndTo(O){const {start:P,end:ha}=this.planeLike;return 0<Math.sign(l.dot(l.subtract(va,ha,P),l.subtract(aa,v.asVec2(O),P)))?this.end:this.start}getPlane(O=B.create()){const P=
g.copy(da,this.end);P[2]+=1;return B.fromPoints(this.start,this.end,P,O)}getSlicePlane(O=B.create()){const {start:P,end:ha,type:ka}=this.planeLike;if(ka!==t.VerticalPlaneType.PLANE){var qa=g.set(da,P[0],P[1],0),xa=g.set(ja,ha[0],ha[1],0);xa=g.subtract(ja,xa,qa);B.fromPositionAndNormal(qa,xa,O);return O}}}const va=h.create(),aa=h.create(),da=m.create(),ja=m.create();class ta extends Aa{constructor(O,P){super(O,P,t.VerticalPlaneType.HALF_PLANE)}}class K extends Aa{constructor(O,P){super(O,P,t.VerticalPlaneType.PLANE)}}
class U extends C{constructor(O,P){super();this.sphere=d.fromCenterAndRadius(O,P)}equals(O){return this===O||u(O)&&d.exactEquals(this.sphere,O.sphere)}closestTo(O){const P=v.createWritable();d.projectPoint(this.sphere,O,P);return P}get center(){return d.getCenter(this.sphere)}get radius(){return this.sphere[3]}}class W extends C{constructor(O,P,ha){super();this.start=O;this.end=P;this.getZ=ha;this.planeLike={start:v.asVec2(O),end:v.asVec2(P),type:t.VerticalPlaneType.PLANE}}equals(O){return this===
O||O instanceof W&&g.exactEquals(this.start,O.start)&&g.exactEquals(this.end,O.end)&&this.getZ===O.getZ}closestTo(O){const P=v.createWritable();t.projectPointToVerticalPlane(O,this.planeLike,P);P[2]=this.getZ(P[0],P[1])??0;return P}addIfOnTheGround(O,P){for(const ha of P)P=this.getZ(ha[0],ha[1])??0,t.isClose(ha[2],P)&&(ha[2]=P,O.push(ha))}}class X extends C{constructor(O,P,ha){super();this._x=O;this._y=P;this._z=ha}equals(O){return this===O||O instanceof X&&this._x===O._x&&this._y===O._y&&this._z===
O._z}closestTo([O,P,ha]){return v.create(this._x??O,this._y??P,this._z??ha)}}class ba extends C{constructor(O,P,ha,ka,qa){super();this._origin=O;this._spatialReference=P;this._distanceMeters=ha;this._z=ka;this._directionDegrees=qa}equals(O){return this===O||O instanceof ba&&l.exactEquals(this._origin,O._origin)&&this._spatialReference===O._spatialReference&&this._distanceMeters===O._distanceMeters&&this._z===O._z&&this._directionDegrees===O._directionDegrees}closestTo([O,P,ha]){l.set(ma,O,P);l.exactEquals(ma,
this._origin)||this._applyDirectionAndDistance(ma);return v.create(ma[0],ma[1],this._z??ha)}_applyDirectionAndDistance(O){if(null!=this._directionDegrees&&null!=this._distanceMeters)w.directGeodeticSolver(O,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees){var P=this._origin,ha=this._directionDegrees,ka=this._spatialReference;let {azimuth:qa,distance:xa}=w.inverseGeodeticSolver(ca,P,O,ka);qa??=0;let Ba=xa*Math.cos((qa-ha)*n.toRadians);
Ba=Math.max(0,Ba);w.directGeodeticSolver(O,P,ha,Ba,ka)}else null!=this._distanceMeters&&({azimuth:P}=w.inverseGeodeticSolver(la,this._origin,O,this._spatialReference),w.directGeodeticSolver(O,this._origin,P??0,this._distanceMeters,this._spatialReference))}}const ma=[0,0],la=new w.InverseGeodeticSolverResult,ca=new w.InverseGeodeticSolverResult,fa=(()=>{const O=B.create();return(P,ha)=>{const {start:ka,end:qa}=P;if(t.vectorsHaveCloseZ(ka,qa)&&t.isClose(ka[2],ha.z))return P;P=v.createWritable();if(B.intersectLine(ha.getPlane(O),
ka,qa,P))return new T(P)}})(),wa=(()=>{const O=q.create(),P=m.create(),ha=m.create();return(ka,qa,xa)=>{const {normal:Ba,center:Ea,radius:Fa}=qa;f.tangentFrame(Ba,P,ha);const Ga=B.getNormal(ka);var Da=Fa*g.dot(Ga,P),Ca=Fa*g.dot(Ga,ha);y.set(O,Ea[0],Ea[1],Ea[2],1);const Ja=y.dot(ka,O),Ha=Math.hypot(Da,Ca),Ia=t.isClose(Ha,0);if(t.isClose(B.distance(ka,Ea),0)){if(Ia)return qa;if(t.isClose(Fa,0))return!xa||t.isPointInsidePlane(xa,Ea)?new T(v.clone(Ea)):void 0;g.cross(P,Ga,Ba);g.normalize(P,P);Da=[];Ca=
m.clone(Ea);g.scaleAndAdd(Ca,Ca,P,Fa);xa&&!t.isPointInsidePlane(xa,Ca)||Da.push(Ca);Ca=m.clone(Ea);g.scaleAndAdd(Ca,Ca,P,-Fa);xa&&!t.isPointInsidePlane(xa,Ca)||Da.push(Ca);return r(Da)}if(!(Ia||(ka=-Ja/Ha,1<Math.abs(ka)||t.isClose(ka,1))))return Da=Math.atan(Da/Ca),ka=c.asinClamped(ka)-Da,Da=Math.PI-ka,Ca=[],qa=m.create(),g.scaleAndAdd(qa,Ea,P,Fa*Math.cos(ka)),g.scaleAndAdd(qa,qa,ha,Fa*Math.sin(ka)),Ca.push(qa),ka=m.create(),g.scaleAndAdd(ka,Ea,P,Fa*Math.cos(Da)),g.scaleAndAdd(ka,ka,ha,Fa*Math.sin(Da)),
Ca.push(ka),r(xa?t.pointsInsidePlane(xa,Ca):Ca)}})(),sa=(()=>{const O=B.create();return(P,ha)=>wa(P.getPlane(O),ha,ha.slicePlane)})(),ya=(()=>{const O=B.create();return(P,{center:ha,radius:ka})=>{ka=t.intersectVerticalPlaneAndVerticalCylinder(P.planeLike,ha,ka);ha=ha[2];P.getSlicePlane(O);P=[];for(const [qa,xa]of ka)ka=[qa,xa,ha],t.isPointInsidePlane(O,ka)&&P.push(ka);return r(P)}})(),ua=(()=>{const O=B.create(),P=B.create();return(ha,ka)=>wa(ha.getPlane(O),ka,ha.getSlicePlane(P))})(),pa=(()=>{const O=
B.create();return(P,{center:ha,radius:ka})=>{var qa=P.getPlane(O);const xa=B.signedDistance(qa,ha);var Ba=Math.abs(xa);if(!(Ba>ka)||t.isClose(Ba,ka)){ka=Math.sqrt(ka**2-xa**2);if(t.isClose(ka,0))return P=v.createWritable(),B.projectPoint(qa,ha,P),new T(P);Ba=v.createWritable();qa=m.clone(B.getNormal(qa));g.scaleAndAdd(Ba,ha,qa,xa);return new ia(Ba,ka,qa,P.getSlicePlane())}}})();a.CircleConstraint=ia;a.Constraint=C;a.CoordinateConstraint=X;a.DrapedLineConstraint=W;a.GeodesicConstraint=ba;a.HorizontalCircleConstraint=
Z;a.HorizontalPlaneConstraint=na;a.LineConstraint=N;a.LineLikeConstraint=M;a.PointConstraint=T;a.RayConstraint=V;a.SetConstraint=Y;a.SphereConstraint=U;a.VerticalCylinderConstraint=ea;a.VerticalHalfPlaneConstraint=ta;a.VerticalPlaneConstraint=K;a.VerticalPlaneLikeConstraint=Aa;a.constraintOrSet=A;a.isPoint=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),
function(a,b,c,l,h,g,m,y){function q(x=r){return[x[0],x[1],x[2],x[3]]}function n(x,L){return w(L[0],L[1],L[2],L[3],x)}function w(x,L,S,Q,R=q()){R[0]=x;R[1]=L;R[2]=S;R[3]=Q;return R}function B(x,L,S){var Q=L[0]*L[0]+L[1]*L[1]+L[2]*L[2];Q=1E-5<Math.abs(Q-1)&&1E-12<Q?1/Math.sqrt(Q):1;S[0]=L[0]*Q;S[1]=L[1]*Q;S[2]=L[2]*Q;S[3]=-(S[0]*x[0]+S[1]*x[1]+S[2]*x[2]);return S}function d(x,L,S,Q=q()){var R=S[0]-L[0],I=S[1]-L[1],k=S[2]-L[2];S=x[0]-L[0];const u=x[1]-L[1],C=x[2]-L[2];L=I*C-k*u;k=k*S-R*C;R=R*u-I*S;
I=L*L+k*k+R*R;I=1E-5<Math.abs(I-1)&&1E-12<I?1/Math.sqrt(I):1;Q[0]=L*I;Q[1]=k*I;Q[2]=R*I;Q[3]=-(Q[0]*x[0]+Q[1]*x[1]+Q[2]*x[2]);return Q}function f(x,L,S,Q=0,R=Math.floor(1/3*S),I=Math.floor(2/3*S)){if(3>S)return!1;L(J,Q);let k=R,u=!1;for(;k<S-1&&!u;)L(E,k),k++,u=!c.exactEquals(J,E);if(!u)return!1;k=Math.max(k,I);for(u=!1;k<S&&!u;)L(p,k),k++,c.subtract(D,J,E),c.normalize(D,D),c.subtract(e,E,p),c.normalize(e,e),u=!c.exactEquals(J,p)&&!c.exactEquals(E,p)&&.99619469809>Math.abs(c.dot(D,e));if(!u)return 0===
Q&&1===R&&2===I?!1:f(x,L,S,0,1,2);d(J,E,p,x);return!0}function v(x,L,S){x=c.scale(m.sv3d.get(),x,c.dot(x,L));c.subtract(S,L,x);return S}function t(x,L){return c.dot(x,L)+x[3]}function z(x){return x===a.IntersectResult.INTERSECTS_INSIDE_OUT||x===a.IntersectResult.INTERSECTS_OUTSIDE_IN}function F(x,L,S,Q,R){var I=c.dot(x,S);x=t(x,L);if(0===I)return 0<=x?a.IntersectResult.INSIDE:a.IntersectResult.OUTSIDE;I=-x/I;Q&a.IntersectFlags.CLAMP&&(I=b.clamp(I,0,1));if(!(Q&a.IntersectFlags.INFINITE_MIN)&&0>I||
!(Q&a.IntersectFlags.INFINITE_MAX)&&1<I)return 0<=x?a.IntersectResult.INSIDE:a.IntersectResult.OUTSIDE;c.add(R,L,c.scale(R,S,I));return 0<=x?a.IntersectResult.INTERSECTS_INSIDE_OUT:a.IntersectResult.INTERSECTS_OUTSIDE_IN}const H=h.exactEquals;h=h.equals;const J=l.create(),E=l.create(),p=l.create(),D=l.create(),e=l.create();a.IntersectResult=void 0;(function(x){x[x.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT";x[x.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN";x[x.INSIDE=2]="INSIDE";x[x.OUTSIDE=
3]="OUTSIDE"})(a.IntersectResult||(a.IntersectResult={}));const r=[0,0,1,0];a.IntersectFlags=void 0;(function(x){x[x.NONE=0]="NONE";x[x.CLAMP=1]="CLAMP";x[x.INFINITE_MIN=4]="INFINITE_MIN";x[x.INFINITE_MAX=8]="INFINITE_MAX"})(a.IntersectFlags||(a.IntersectFlags={}));const G=a.IntersectFlags.INFINITE_MIN|a.IntersectFlags.INFINITE_MAX,A=a.IntersectFlags.INFINITE_MAX;a.clip=function(x,L){const S=c.dot(x,L.ray.direction);x=-t(x,L.ray.origin);if(0>x&&0<=S)return!1;if(-1E-6<S&&1E-6>S)return 0<x;if((0>x||
0>S)&&!(0>x&&0>S))return!0;x/=S;0<S?x<L.c1&&(L.c1=x):x>L.c0&&(L.c0=x);return L.c0<=L.c1};a.clipInfinite=function(x,L){const S=c.dot(x,L.ray.direction);x=-t(x,L.ray.origin);if(-1E-6<S&&1E-6>S)return 0<x;x/=S;0<S?x<L.c1&&(L.c1=x):x>L.c0&&(L.c0=x);return L.c0<=L.c1};a.copy=n;a.create=q;a.distance=function(x,L){return Math.abs(t(x,L))};a.equals=h;a.exactEquals=H;a.fromArray=function(x,L,S=!0){const Q=L.length/3;return f(x,(R,I)=>c.set(R,L[3*I],L[3*I+1],L[3*I+2]),S?Q-1:Q)};a.fromManyPoints=f;a.fromNormalAndOffset=
function(x,L,S){c.copy(S,x);S[3]=L;return S};a.fromPoints=d;a.fromPositionAndNormal=B;a.fromValues=w;a.fromVectorsAndPoint=function(x,L,S,Q){c.cross(p,L,x);return B(S,p,Q)};a.getNormal=function(x){return x};a.intersectLine=function(x,L,S,Q){S=c.subtract(m.sv3d.get(),S,L);return z(F(x,L,S,G,Q))};a.intersectLineOrRay=F;a.intersectLineSegment=function(x,L,S){return z(F(x,L.origin,L.vector,a.IntersectFlags.NONE,S))};a.intersectLineSegmentClamp=function(x,L,S){return z(F(x,L.origin,L.vector,a.IntersectFlags.CLAMP,
S))};a.intersectRay=function(x,L,S){return null!=L?z(F(x,L.origin,L.direction,A,S)):!1};a.isPointInside=function(x,L){return 0<=t(x,L)};a.negate=function(x,L){L[0]=-x[0];L[1]=-x[1];L[2]=-x[2];L[3]=-x[3];return L};a.projectPoint=function(x,L,S){const Q=c.scale(m.sv3d.get(),x,-x[3]);L=c.subtract(m.sv3d.get(),L,Q);x=v(x,L,m.sv3d.get());c.add(S,x,Q);return S};a.projectPointLocal=function(x,L,S,Q){var R=m.sv3d.get(),I=m.sv3d.get();y.tangentFrame(x,R,I);L=c.subtract(m.sv3d.get(),S,L);R=g.projectPointSignedLength(R,
L);I=g.projectPointSignedLength(I,L);x=g.projectPointSignedLength(x,L);return c.set(Q,R,I,x)};a.projectVector=v;a.setOffsetFromPoint=function(x,L,S){L!==x&&n(x,L);x[3]=-c.dot(x,S);return x};a.signedDistance=t;a.up=r;a.wrap=function(x=r[0],L=r[1],S=r[2],Q=r[3]){return w(x,L,S,Q,m.sv4d.get())};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64"],
function(a,b,c,l){const h=l.create(),g=l.create();a.angle=function(m,y){m=c.dot(m,y)/(c.length(m)*c.length(y));return-b.acosClamped(m)};a.angleAroundAxis=function(m,y,q){c.normalize(h,m);c.normalize(g,y);m=c.dot(h,g);m=b.acosClamped(m);y=c.cross(h,h,g);return 0>c.dot(y,q)?2*Math.PI-m:m};a.projectPoint=function(m,y,q){y=c.dot(m,y)/c.dot(m,m);return c.scale(q,m,y)};a.projectPointSignedLength=function(m,y){return c.dot(m,y)/c.length(m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/geometry/support/vectorStacks":function(){define(["exports","../../core/VectorStack"],function(a,b){const c=b.VectorStack.createVec2f64(),l=b.VectorStack.createVec3f64(),h=b.VectorStack.createVec4f64(),g=b.VectorStack.createMat3f64(),m=b.VectorStack.createMat4f64();b=b.VectorStack.createQuatf64();a.sm3d=g;a.sm4d=m;a.sq4d=b;a.sv2d=c;a.sv3d=l;a.sv4d=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/VectorStack":function(){define("exports ./has ./nextTick ./libs/gl-matrix-2/factories/mat3f64 ./libs/gl-matrix-2/factories/mat4f64 ./libs/gl-matrix-2/factories/quatf64 ./libs/gl-matrix-2/factories/vec2f64 ./libs/gl-matrix-2/factories/vec3f64 ./libs/gl-matrix-2/factories/vec4f64".split(" "),
function(a,b,c,l,h,g,m,y,q){class n{constructor(w){this._create=w;this._items=[];this._itemsPtr=0}get(){0===this._itemsPtr&&c.nextTick(()=>this._reset());this._itemsPtr>=this._items.length&&this._items.push(this._create());return this._items[this._itemsPtr++]}_reset(){const w=2*this._itemsPtr;this._items.length>w&&(this._items.length=w);this._itemsPtr=0}static createVec2f64(){return new n(m.create)}static createVec3f64(){return new n(y.create)}static createVec4f64(){return new n(q.create)}static createMat3f64(){return new n(l.create)}static createMat4f64(){return new n(h.create)}static createQuatf64(){return new n(g.create)}get test(){}}
a.VectorStack=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64"],function(a,b,c,l){const h=l.create(),g=l.create(),m=l.create(),y=l.create(),q=l.create();a.angle=function(n,w,B){n=c.normalize(y,n);w=c.normalize(q,w);const d=b.acosClamped(c.dot(n,w));return B&&(n=c.cross(m,n,w),0>c.dot(n,B))?-d:d};a.bilerp=function(n,w,B,
d,f,v){n+=(w-n)*f;return n+(B+(d-B)*f-n)*v};a.cosCapped=function(n,w){return n>w?Math.cos(w):Math.cos(n)};a.fovx2fovy=function(n,w,B){return 2*Math.atan(B*Math.tan(.5*n)/w)};a.fovy2fovx=function(n,w,B){return 2*Math.atan(w*Math.tan(.5*n)/B)};a.makeOrthonormal=function(n,w,B){B=B||n;const d=c.dot(n,w);c.set(B,n[0]-d*w[0],n[1]-d*w[1],n[2]-d*w[2]);c.normalize(B,B)};a.makePiecewiseLinearFunction=function(n){const w=n.length;return B=>{if(B<=n[0][0])return n[0][1];if(B>=n[w-1][0])return n[w-1][1];let d=
1;for(;B>n[d][0];)d++;const f=n[d][0];B=(f-B)/(f-n[d-1][0]);return B*n[d-1][1]+(1-B)*n[d][1]}};a.maxScale=function(n){return Math.sqrt(Math.max(n[0]*n[0]+n[4]*n[4]+n[8]*n[8],n[1]*n[1]+n[5]*n[5]+n[9]*n[9],n[2]*n[2]+n[6]*n[6]+n[10]*n[10]))};a.midpoint3d=function(n,w){c.set(w,0,0,0);if(0<n.length){for(let B=0;B<n.length;++B)c.add(w,w,n[B]);c.scale(w,w,1/n.length)}};a.planeFromPoints=function(n,w,B,d){c.subtract(h,w,n);c.subtract(g,B,n);c.cross(d,h,g);c.normalize(d,d);d[3]=-c.dot(n,d)};a.scaleFromMatrix=
function(n,w){c.set(n,Math.sqrt(w[0]*w[0]+w[4]*w[4]+w[8]*w[8]),Math.sqrt(w[1]*w[1]+w[5]*w[5]+w[9]*w[9]),Math.sqrt(w[2]*w[2]+w[6]*w[6]+w[10]*w[10]));return n};a.slerp=function(n,w,B,d=l.create()){const f=c.length(n);var v=c.length(w),t=c.dot(n,w)/(f*v);if(.9999999999999999>t){t=Math.acos(t);const z=((1-B)*f+B*v)/Math.sin(t);v=z/v*Math.sin(B*t);c.scale(y,n,z/f*Math.sin((1-B)*t));c.scale(q,w,v);return c.add(d,y,q)}return c.lerp(d,n,w,B)};a.slerpTangent=function(n,w,B,d=l.create(),f=l.create()){const v=
c.length(n),t=c.length(w);var z=c.dot(n,w)/(v*t);if(.9999999999999999>z){z=Math.acos(z);const F=Math.sin(z),H=Math.sin(B*z),J=Math.sin((1-B)*z),E=(1-B)*v+B*t,p=E/F,D=p/t*H;c.scale(y,n,p/v*J);c.scale(q,w,D);c.add(d,y,q);c.scale(y,n,1/v*(-Math.cos((1-B)*z)*z*E+J*(-v+t)));c.scale(q,w,1/t*(Math.cos(B*z)*z*E+H*(-v+t)));c.add(f,y,q);c.scale(f,f,1/F);return f}c.lerp(d,n,w,B);c.subtract(f,w,n);c.normalize(f,f);return f};a.tangentFrame=function(n,w,B){Math.abs(n[0])>Math.abs(n[1])?c.set(w,0,1,0):c.set(w,1,
0,0);c.cross(B,n,w);c.cross(w,B,n);c.normalize(B,B);c.normalize(w,w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ../core/libs/gl-matrix-2/math/mat4 ./vec32 ../core/libs/gl-matrix-2/factories/vec3f64 ./vec42 ../core/libs/gl-matrix-2/factories/vec4f64 ../core/libs/gl-matrix-2/math/common ../geometry/support/Axis ../geometry/support/ray ../geometry/support/sphereUtils ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v){function t(){return q.create()}function z(aa,da){return y.copy(da,aa)}function F(aa,da){return q.fromValues(aa[0],aa[1],aa[2],da)}function H(aa){return aa}function J(aa){aa[0]=aa[1]=aa[2]=aa[3]=0}function E(aa,da){aa[0]=aa[1]=aa[2]=0;aa[3]=da;return aa}function p(aa){return aa[3]}function D(aa){return aa}function e(aa,da,ja,ta){return q.fromValues(aa,da,ja,ta)}function r(aa,da,ja){aa!==ja&&(ja[0]=aa[0],ja[1]=aa[1],ja[2]=aa[2]);ja[3]=aa[3]+da;return ja}function G(aa,
da,ja){aa!==ja&&z(aa,ja);return ja}function A(aa,da){return da}function x(aa,da,ja){if(null==da||!S(aa,da,oa))return!1;let {t0:ta,t1:K}=oa;if(0>ta||K<ta&&0<K)ta=K;if(0>ta)return!1;if(ja){const {origin:U,direction:W}=da;ja[0]=U[0]+W[0]*ta;ja[1]=U[1]+W[1]*ta;ja[2]=U[2]+W[2]*ta}return!0}function L(aa,da,ja){da=B.fromPoints(da,ja);if(!S(aa,da,oa))return[];const {origin:ta,direction:K}=da,{t0:U,t1:W}=oa;da=X=>{const ba=m.create();g.scaleAndAdd(ba,ta,K,X);return C(aa,ba,ba)};return Math.abs(U-W)<n.getEpsilon()?
[da(U)]:[da(U),da(W)]}function S(aa,da,ja){const {origin:ta,direction:K}=da,U=ra;U[0]=ta[0]-aa[0];U[1]=ta[1]-aa[1];U[2]=ta[2]-aa[2];da=K[0]*K[0]+K[1]*K[1]+K[2]*K[2];if(0===da)return!1;const W=2*(K[0]*U[0]+K[1]*U[1]+K[2]*U[2]);aa=W*W-4*da*(U[0]*U[0]+U[1]*U[1]+U[2]*U[2]-aa[3]*aa[3]);if(0>aa)return!1;aa=Math.sqrt(aa);ja.t0=(-W-aa)/(2*da);ja.t1=(-W+aa)/(2*da);return!0}function Q(aa,da){return x(aa,da,null)}function R(aa,da,ja){if(x(aa,da,ja))return ja;aa=I(aa,da,v.sv3d.get());g.add(ja,da.origin,g.scale(v.sv3d.get(),
da.direction,g.distance(da.origin,aa)/g.length(da.direction)));return ja}function I(aa,da,ja){const ta=v.sv3d.get(),K=v.sm4d.get();g.cross(ta,da.origin,da.direction);const U=aa[3];g.cross(ja,ta,da.origin);g.scale(ja,ja,1/g.length(ja)*U);aa=M(aa,da.origin);da=f.angle(da.origin,ja);h.fromRotation(K,da+aa,ta);g.transformMat4(ja,ja,K);return ja}function k(aa,da,ja,ta){aa=aa[3];var K=aa*aa;da+=.5*Math.PI;const U=ja*ja+K-2*Math.cos(da)*ja*aa;ja=Math.sqrt(U);K=U-K;return 0>=K?.5:Math.min(1,(Math.acos(Math.sqrt(K)/
ja)-Math.asin(aa/(ja/Math.sin(da)))+.5*ta)/ta)}function u(aa,da,ja){if(x(aa,da,ja))return ja;B.closestPoint(da,aa,ja);return C(aa,ja,ja)}function C(aa,da,ja){da=g.subtract(v.sv3d.get(),da,aa);da=g.scale(v.sv3d.get(),da,aa[3]/g.length(da));return g.add(ja,da,aa)}function T(aa,da){da=g.subtract(v.sv3d.get(),da,aa);da=g.squaredLength(da);return Math.sqrt(Math.abs(da-aa[3]*aa[3]))}function M(aa,da){da=g.subtract(v.sv3d.get(),da,aa);da=g.length(da);aa=aa[3];return l.acosClamped(aa/(aa+Math.abs(aa-da)))}
function N(aa,da,ja,ta){aa=g.subtract(na,da,aa);switch(ja){case w.Axis.X:return ja=d.cartesianToSpherical(aa,na)[2],g.set(ta,-Math.sin(ja),Math.cos(ja),0);case w.Axis.Y:return aa=d.cartesianToSpherical(aa,na),ja=aa[1],aa=aa[2],da=Math.sin(ja),g.set(ta,-da*Math.cos(aa),-da*Math.sin(aa),Math.cos(ja));case w.Axis.Z:return g.normalize(ta,aa)}}function V(aa,da){da=g.subtract(za,da,aa);return g.length(da)-aa[3]}function Y(aa,da,ja,ta){const K=V(aa,da);aa=N(aa,da,w.Axis.Z,za);ja=g.scale(za,aa,ja-K);return g.add(ta,
da,ja)}function ea(aa,da){da=g.squaredDistance(aa,da);aa=aa[3];return da<=aa*aa}function Z(aa,da,ja=q.create()){const ta=g.distance(aa,da),K=aa[3],U=da[3];if(ta+U<K)return y.copy(ja,aa),ja;if(ta+K<U)return y.copy(ja,da),ja;g.lerp(ja,aa,da,(ta+U-K)/(2*ta));ja[3]=(ta+K+U)/2;return ja}b=t();const ia=c=y.equals,oa={t0:0,t1:0},ra=m.create(),na=m.create(),za=m.create(),Aa=t(),va=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:b,altitudeAt:V,angleToSilhouette:M,axisAt:N,cameraFrustumCoverage:k,
clear:J,closestPoint:u,closestPointOnSilhouette:I,containsPoint:ea,copy:z,create:t,distanceToSilhouette:T,elevate:r,equals:ia,exactEquals:c,fromCenterAndRadius:F,fromRadius:E,fromValues:e,getCenter:D,getExtent:A,getRadius:p,intersectLine:L,intersectRay:x,intersectRayClosestSilhouette:R,intersectsRay:Q,projectPoint:C,setAltitudeAt:Y,setExtent:G,tmpSphere:Aa,union:Z,wrap:H},Symbol.toStringTag,{value:"Module"}));a.NullSphere=b;a.altitudeAt=V;a.angleToSilhouette=M;a.axisAt=N;a.cameraFrustumCoverage=k;
a.clear=J;a.closestPoint=u;a.closestPointOnSilhouette=I;a.containsPoint=ea;a.copy=z;a.create=t;a.distanceToSilhouette=T;a.elevate=r;a.equals=ia;a.exactEquals=c;a.fromCenterAndRadius=F;a.fromRadius=E;a.fromValues=e;a.getCenter=D;a.getExtent=A;a.getRadius=p;a.intersectLine=L;a.intersectRay=x;a.intersectRayClosestSilhouette=R;a.intersectsRay=Q;a.projectPoint=C;a.setAltitudeAt=Y;a.setExtent=G;a.sphere=va;a.tmpSphere=Aa;a.union=Z;a.wrap=H})},"esri/geometry/support/ray":function(){define("exports ../../core/arrayUtils ../../core/ObjectStack ../../core/libs/gl-matrix-2/math/mat3 ../../core/libs/gl-matrix-2/factories/mat3f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ./vectorStacks".split(" "),
function(a,b,c,l,h,g,m,y){function q(z){return z?n(m.clone(z.origin),m.clone(z.direction)):n(m.create(),m.create())}function n(z,F){return{origin:z,direction:F}}function w(z,F,H=q()){g.copy(H.origin,z);g.copy(H.direction,F);return H}const B=new c.ObjectStack(()=>q()),d=m.create(),f=m.create(),v=m.create(),t=h.create();a.closestPoint=function(z,F,H){F=g.dot(z.direction,g.subtract(H,F,z.origin));g.add(H,z.origin,g.scale(H,z.direction,F));return H};a.closestPoints=function(z,F,H,J){const E=z.origin,
p=F.origin;z=z.direction;F=F.direction;var D=g.dot(g.normalize(f,z),g.normalize(v,F));if(1<=Math.abs(D))return null;var e=g.cross(f,z,F);D=g.sub(d,p,E);e=l.set(t,z[0],z[1],z[2],-F[0],-F[1],-F[2],e[0],e[1],e[2]);const r=l.invert(t,e);if(null==r)return[H,J];e=g.dot(g.set(f,r[0],r[3],r[6]),D);D=g.dot(g.set(v,r[1],r[4],r[7]),D);g.add(H,E,g.scale(d,z,e));g.add(J,p,g.scale(d,F,D));return[H,J]};a.copy=function(z,F=q()){return w(z.origin,z.direction,F)};a.create=q;a.distance2=function(z,F){z=g.cross(y.sv3d.get(),
g.normalize(y.sv3d.get(),z.direction),g.subtract(y.sv3d.get(),F,z.origin));return g.dot(z,z)};a.equals=function(z,F){return b.equals(z.origin,F.origin)&&b.equals(z.direction,F.direction)};a.fromPoints=function(z,F,H=q()){g.copy(H.origin,z);g.subtract(H.direction,F,z);return H};a.fromValues=w;a.wrap=function(z,F){const H=B.get();H.origin=z;H.direction=F;return H};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ObjectStack":function(){define(["exports","./nextTick"],function(a,
b){class c{constructor(l){this._allocator=l;this._items=[];this._itemsPtr=0;this._grow()}get(){0===this._itemsPtr&&b.nextTick(()=>this._reset());this._itemsPtr===this._items.length&&this._grow();return this._items[this._itemsPtr++]}_reset(){this._items.length=Math.min(Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3072),this._items.length);this._itemsPtr=0}_grow(){for(let l=0;l<Math.max(8,Math.min(this._items.length,1024));l++)this._items.push(this._allocator())}}a.ObjectStack=c;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["exports","./common"],function(a,b){function c(k,u){k[0]=u[0];k[1]=u[1];k[2]=u[2];k[3]=u[4];k[4]=u[5];k[5]=u[6];k[6]=u[8];k[7]=u[9];k[8]=u[10];return k}function l(k,u){k[0]=u[0];k[1]=u[1];k[2]=u[2];k[3]=u[3];k[4]=u[4];k[5]=u[5];k[6]=u[6];k[7]=u[7];k[8]=u[8];return k}function h(k,u,C,T,M,N,V,Y,ea,Z){k[0]=u;k[1]=C;k[2]=T;k[3]=M;k[4]=N;k[5]=V;k[6]=Y;k[7]=ea;k[8]=Z;return k}function g(k){k[0]=1;k[1]=0;k[2]=
0;k[3]=0;k[4]=1;k[5]=0;k[6]=0;k[7]=0;k[8]=1;return k}function m(k,u){if(k===u){const C=u[1],T=u[2],M=u[5];k[1]=u[3];k[2]=u[6];k[3]=C;k[5]=u[7];k[6]=T;k[7]=M}else k[0]=u[0],k[1]=u[3],k[2]=u[6],k[3]=u[1],k[4]=u[4],k[5]=u[7],k[6]=u[2],k[7]=u[5],k[8]=u[8];return k}function y(k,u){const C=u[0],T=u[1],M=u[2],N=u[3],V=u[4],Y=u[5],ea=u[6],Z=u[7];u=u[8];const ia=u*V-Y*Z,oa=-u*N+Y*ea,ra=Z*N-V*ea;let na=C*ia+T*oa+M*ra;if(!na)return null;na=1/na;k[0]=ia*na;k[1]=(-u*T+M*Z)*na;k[2]=(Y*T-M*V)*na;k[3]=oa*na;k[4]=
(u*C-M*ea)*na;k[5]=(-Y*C+M*N)*na;k[6]=ra*na;k[7]=(-Z*C+T*ea)*na;k[8]=(V*C-T*N)*na;return k}function q(k,u){const C=u[0],T=u[1],M=u[2],N=u[3],V=u[4],Y=u[5],ea=u[6],Z=u[7];u=u[8];k[0]=V*u-Y*Z;k[1]=M*Z-T*u;k[2]=T*Y-M*V;k[3]=Y*ea-N*u;k[4]=C*u-M*ea;k[5]=M*N-C*Y;k[6]=N*Z-V*ea;k[7]=T*ea-C*Z;k[8]=C*V-T*N;return k}function n(k){const u=k[3],C=k[4],T=k[5],M=k[6],N=k[7],V=k[8];return k[0]*(V*C-T*N)+k[1]*(-V*u+T*M)+k[2]*(N*u-C*M)}function w(k,u,C){const T=u[0],M=u[1],N=u[2],V=u[3],Y=u[4],ea=u[5],Z=u[6],ia=u[7];
u=u[8];const oa=C[0],ra=C[1],na=C[2],za=C[3],Aa=C[4],va=C[5],aa=C[6],da=C[7];C=C[8];k[0]=oa*T+ra*V+na*Z;k[1]=oa*M+ra*Y+na*ia;k[2]=oa*N+ra*ea+na*u;k[3]=za*T+Aa*V+va*Z;k[4]=za*M+Aa*Y+va*ia;k[5]=za*N+Aa*ea+va*u;k[6]=aa*T+da*V+C*Z;k[7]=aa*M+da*Y+C*ia;k[8]=aa*N+da*ea+C*u;return k}function B(k,u,C){const T=u[0],M=u[1],N=u[2],V=u[3],Y=u[4],ea=u[5],Z=u[6],ia=u[7];u=u[8];const oa=C[0];C=C[1];k[0]=T;k[1]=M;k[2]=N;k[3]=V;k[4]=Y;k[5]=ea;k[6]=oa*T+C*V+Z;k[7]=oa*M+C*Y+ia;k[8]=oa*N+C*ea+u;return k}function d(k,
u,C){const T=u[0],M=u[1],N=u[2],V=u[3],Y=u[4],ea=u[5],Z=u[6],ia=u[7];u=u[8];const oa=Math.sin(C);C=Math.cos(C);k[0]=C*T+oa*V;k[1]=C*M+oa*Y;k[2]=C*N+oa*ea;k[3]=C*V-oa*T;k[4]=C*Y-oa*M;k[5]=C*ea-oa*N;k[6]=Z;k[7]=ia;k[8]=u;return k}function f(k,u,C){const T=C[0],M=C[1];C=C[2];k[0]=T*u[0];k[1]=T*u[1];k[2]=T*u[2];k[3]=M*u[3];k[4]=M*u[4];k[5]=M*u[5];k[6]=C*u[6];k[7]=C*u[7];k[8]=C*u[8];return k}function v(k,u,C){const T=C[0];C=C[1];k[0]=T*u[0];k[1]=T*u[1];k[2]=T*u[2];k[3]=C*u[3];k[4]=C*u[4];k[5]=C*u[5];return k}
function t(k,u){k[0]=1;k[1]=0;k[2]=0;k[3]=0;k[4]=1;k[5]=0;k[6]=u[0];k[7]=u[1];k[8]=1;return k}function z(k,u){const C=Math.sin(u);u=Math.cos(u);k[0]=u;k[1]=C;k[2]=0;k[3]=-C;k[4]=u;k[5]=0;k[6]=0;k[7]=0;k[8]=1;return k}function F(k,u){k[0]=u[0];k[1]=0;k[2]=0;k[3]=0;k[4]=u[1];k[5]=0;k[6]=0;k[7]=0;k[8]=1;return k}function H(k,u){k[0]=u[0];k[1]=u[1];k[2]=0;k[3]=u[2];k[4]=u[3];k[5]=0;k[6]=u[4];k[7]=u[5];k[8]=1;return k}function J(k,u){var C=u[0],T=u[1],M=u[2];u=u[3];var N=C+C,V=T+T;const Y=M+M;C*=N;const ea=
T*N;T*=V;const Z=M*N,ia=M*V;M*=Y;N*=u;V*=u;u*=Y;k[0]=1-T-M;k[3]=ea-u;k[6]=Z+V;k[1]=ea+u;k[4]=1-C-M;k[7]=ia-N;k[2]=Z-V;k[5]=ia+N;k[8]=1-C-T;return k}function E(k,u){const C=u[0],T=u[1],M=u[2],N=u[4],V=u[5],Y=u[6],ea=u[8],Z=u[9];u=u[10];const ia=u*V-Y*Z,oa=-u*N+Y*ea,ra=Z*N-V*ea;var na=C*ia+T*oa+M*ra;if(!na)return null;na=1/na;k[0]=ia*na;k[1]=(-u*T+M*Z)*na;k[2]=(Y*T-M*V)*na;k[3]=oa*na;k[4]=(u*C-M*ea)*na;k[5]=(-Y*C+M*N)*na;k[6]=ra*na;k[7]=(-Z*C+T*ea)*na;k[8]=(V*C-T*N)*na;return k}function p(k,u){const C=
u[0],T=u[1],M=u[2],N=u[3],V=u[4],Y=u[5],ea=u[6],Z=u[7];var ia=u[8],oa=u[9],ra=u[10],na=u[11];const za=u[12],Aa=u[13],va=u[14];u=u[15];const aa=C*Y-T*V,da=C*ea-M*V,ja=C*Z-N*V,ta=T*ea-M*Y,K=T*Z-N*Y,U=M*Z-N*ea,W=ia*Aa-oa*za,X=ia*va-ra*za;ia=ia*u-na*za;const ba=oa*va-ra*Aa;oa=oa*u-na*Aa;ra=ra*u-na*va;na=aa*ra-da*oa+ja*ba+ta*ia-K*X+U*W;if(!na)return null;na=1/na;k[0]=(Y*ra-ea*oa+Z*ba)*na;k[1]=(ea*ia-V*ra-Z*X)*na;k[2]=(V*oa-Y*ia+Z*W)*na;k[3]=(M*oa-T*ra-N*ba)*na;k[4]=(C*ra-M*ia+N*X)*na;k[5]=(T*ia-C*oa-N*
W)*na;k[6]=(Aa*U-va*K+u*ta)*na;k[7]=(va*ja-za*U-u*da)*na;k[8]=(za*K-Aa*ja+u*aa)*na;return k}function D(k,u,C){k[0]=2/u;k[1]=0;k[2]=0;k[3]=0;k[4]=-2/C;k[5]=0;k[6]=-1;k[7]=1;k[8]=1;return k}function e(k){return"mat3("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+", "+k[4]+", "+k[5]+", "+k[6]+", "+k[7]+", "+k[8]+")"}function r(k){return Math.sqrt(k[0]**2+k[1]**2+k[2]**2+k[3]**2+k[4]**2+k[5]**2+k[6]**2+k[7]**2+k[8]**2)}function G(k,u,C){k[0]=u[0]+C[0];k[1]=u[1]+C[1];k[2]=u[2]+C[2];k[3]=u[3]+C[3];k[4]=u[4]+C[4];
k[5]=u[5]+C[5];k[6]=u[6]+C[6];k[7]=u[7]+C[7];k[8]=u[8]+C[8];return k}function A(k,u,C){k[0]=u[0]-C[0];k[1]=u[1]-C[1];k[2]=u[2]-C[2];k[3]=u[3]-C[3];k[4]=u[4]-C[4];k[5]=u[5]-C[5];k[6]=u[6]-C[6];k[7]=u[7]-C[7];k[8]=u[8]-C[8];return k}function x(k,u,C){k[0]=u[0]*C;k[1]=u[1]*C;k[2]=u[2]*C;k[3]=u[3]*C;k[4]=u[4]*C;k[5]=u[5]*C;k[6]=u[6]*C;k[7]=u[7]*C;k[8]=u[8]*C;return k}function L(k,u,C,T){k[0]=u[0]+C[0]*T;k[1]=u[1]+C[1]*T;k[2]=u[2]+C[2]*T;k[3]=u[3]+C[3]*T;k[4]=u[4]+C[4]*T;k[5]=u[5]+C[5]*T;k[6]=u[6]+C[6]*
T;k[7]=u[7]+C[7]*T;k[8]=u[8]+C[8]*T;return k}function S(k,u){return k[0]===u[0]&&k[1]===u[1]&&k[2]===u[2]&&k[3]===u[3]&&k[4]===u[4]&&k[5]===u[5]&&k[6]===u[6]&&k[7]===u[7]&&k[8]===u[8]}function Q(k,u){const C=k[0],T=k[1],M=k[2],N=k[3],V=k[4],Y=k[5],ea=k[6],Z=k[7];k=k[8];const ia=u[0],oa=u[1],ra=u[2],na=u[3],za=u[4],Aa=u[5],va=u[6],aa=u[7];u=u[8];const da=b.getEpsilon();return Math.abs(C-ia)<=da*Math.max(1,Math.abs(C),Math.abs(ia))&&Math.abs(T-oa)<=da*Math.max(1,Math.abs(T),Math.abs(oa))&&Math.abs(M-
ra)<=da*Math.max(1,Math.abs(M),Math.abs(ra))&&Math.abs(N-na)<=da*Math.max(1,Math.abs(N),Math.abs(na))&&Math.abs(V-za)<=da*Math.max(1,Math.abs(V),Math.abs(za))&&Math.abs(Y-Aa)<=da*Math.max(1,Math.abs(Y),Math.abs(Aa))&&Math.abs(ea-va)<=da*Math.max(1,Math.abs(ea),Math.abs(va))&&Math.abs(Z-aa)<=da*Math.max(1,Math.abs(Z),Math.abs(aa))&&Math.abs(k-u)<=da*Math.max(1,Math.abs(k),Math.abs(u))}function R(k){const u=b.getEpsilon(),C=k[0],T=k[1],M=k[2],N=k[3],V=k[4],Y=k[5],ea=k[6],Z=k[7];k=k[8];return Math.abs(1-
(C*C+N*N+ea*ea))<=u&&Math.abs(1-(T*T+V*V+Z*Z))<=u&&Math.abs(1-(M*M+Y*Y+k*k))<=u}const I=Object.freeze(Object.defineProperty({__proto__:null,add:G,adjoint:q,copy:l,determinant:n,equals:Q,exactEquals:S,frob:r,fromMat2d:H,fromMat4:c,fromQuat:J,fromRotation:z,fromScaling:F,fromTranslation:t,identity:g,invert:y,isOrthoNormal:R,mul:w,multiply:w,multiplyScalar:x,multiplyScalarAndAdd:L,normalFromMat4:p,normalFromMat4Legacy:E,projection:D,rotate:d,scale:f,scaleByVec2:v,set:h,str:e,sub:A,subtract:A,translate:B,
transpose:m},Symbol.toStringTag,{value:"Module"}));a.add=G;a.adjoint=q;a.copy=l;a.determinant=n;a.equals=Q;a.exactEquals=S;a.frob=r;a.fromMat2d=H;a.fromMat4=c;a.fromQuat=J;a.fromRotation=z;a.fromScaling=F;a.fromTranslation=t;a.identity=g;a.invert=y;a.isOrthoNormal=R;a.mat3=I;a.mul=w;a.multiply=w;a.multiplyScalar=x;a.multiplyScalarAndAdd=L;a.normalFromMat4=p;a.normalFromMat4Legacy=E;a.projection=D;a.rotate=d;a.scale=f;a.scaleByVec2=v;a.set=h;a.str=e;a.sub=A;a.subtract=A;a.translate=B;a.transpose=m;
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/sphereUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec32"],function(a,b,c){a.cartesianToSpherical=function(l,h){const g=c.length(l),m=b.asinClamped(l[2]/g);c.set(h,g,m,Math.atan2(l[1]/g,l[0]/g));return h};a.sphericalToCartesian=function(l,h){const g=l[0],m=l[1];l=l[2];const y=Math.cos(m);c.set(h,g*y*Math.cos(l),g*y*Math.sin(l),g*Math.sin(m))};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../core/libs/gl-matrix-2/math/common ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),function(a,b,c,l,h,g,m,y,q,n){function w(R,{start:I,end:k,type:u},C=g.create()){R=h.sub(p,R,I);k=h.sub(D,k,I);R=h.dot(R,k)/
h.dot(k,k);return h.scaleAndAdd(C,I,k,u===n.LineType.RAY?Math.max(R,0):R)}function B({start:R,end:I,type:k},u){const C=h.sub(p,u,R);I=h.sub(D,I,R);if(k===n.LineType.RAY&&h.dot(I,C)<-m.getEpsilon())return h.distance(R,u);R=h.cross(e,I,C);return h.len(R)/h.len(I)}function d(R,I){const k=R.start,u=I.start;var C=I.end;const T=h.sub(p,R.end,k);C=h.sub(D,C,u);var M=h.sub(e,u,k),N=h.cross(r,T,C),V=h.dot(M,N);if(!t(V,0))return[];V=h.sqrLen(N);if(t(V,0))return[];M=h.cross(G,M,C);N=h.dot(M,N)/V;N=h.scaleAndAdd(A,
k,T,N);return R.type===n.LineType.RAY&&(R=h.sub(x,N,k),h.dot(T,R)<-m.getEpsilon())||I.type===n.LineType.RAY&&(I=h.sub(x,N,u),h.dot(C,I)<-m.getEpsilon())?[]:[g.clone(N)]}function f({start:R,end:I,type:k},u){const C=h.sub(p,u,R);R=h.sub(D,I,R);I=h.cross(e,R,C);I=h.sqrLen(I)/h.sqrLen(R);const T=m.getEpsilon();if(I<T)switch(k){case n.LineType.LINE:return[g.clone(u)];case n.LineType.RAY:return h.dot(R,C)<-T?[]:[g.clone(u)]}return[]}function v(R,I,{start:k,end:u,type:C}){h.set(R.start,k[0],k[1],I);h.set(R.end,
u[0],u[1],I);R.type=H[C];return R}function t(R,I){return b.floatEqualAbsolute(Math.abs(R-I),0,m.getEpsilon())}function z(R,I){return y.isPointInside(R,I)}const F=(()=>{const R=g.create(),I=g.create(),k=g.create();return({start:u,end:C},{center:T,radius:M,normal:N,slicePlane:V})=>{var Y=y.fromPositionAndNormal(T,N,L);if(t(y.distance(Y,u),0)&&t(y.distance(Y,C),0)){q.tangentFrame(N,R,I);Y=(ea,Z)=>{h.subtract(k,Z,T);c.set(ea,h.dot(k,R),h.dot(k,I));return ea};C=n.intersectLineLikeAndCircle({start:Y(J,
u),end:Y(E,C),type:n.LineType.LINE},l.ZEROS,M);u=[];for(const [ea,Z]of C)C=h.copy(g.create(),T),h.scaleAndAdd(C,C,R,ea),h.scaleAndAdd(C,C,I,Z),V&&!z(V,C)||u.push(C);return u}N=g.create();return y.intersectLine(Y,u,C,N)?!t(h.distance(N,T),M)||V&&!z(V,N)?[]:[N]:[]}})();a.VerticalPlaneType=void 0;(function(R){R[R.PLANE=0]="PLANE";R[R.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const H={[a.VerticalPlaneType.PLANE]:n.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:n.LineType.RAY},
J=l.create(),E=l.create(),p=g.create(),D=g.create(),e=g.create(),r=g.create(),G=g.create(),A=g.create(),x=g.create(),L=y.create(),S={start:g.create(),end:g.create(),type:n.LineType.LINE},Q={start:g.create(),end:g.create(),type:n.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>n.LineType});a.intersectLineAndPoint=f;a.intersectLineLikeAndCircle=F;a.intersectLineLikeAndVerticalCylinder=function({start:R,end:I,type:k},u,C){const T=[];I=h.subtract(p,I,R);var M=c.subtract(E,R,u);
u=c.squaredLength(I);const N=2*c.dot(I,M);C=c.squaredLength(M)-C*C;C=N*N-4*u*C;0===C?(u=-N/(2*u),(k===n.LineType.LINE||0<=u)&&T.push(h.scaleAndAdd(g.create(),R,I,u))):0<C&&(C=Math.sqrt(C),M=(-N+C)/(2*u),(k===n.LineType.LINE||0<=M)&&T.push(h.scaleAndAdd(g.create(),R,I,M)),u=(-N-C)/(2*u),(k===n.LineType.LINE||0<=u)&&T.push(h.scaleAndAdd(g.create(),R,I,u)));return T};a.intersectLineLikes=d;a.intersectVerticalCylinderAndPoint=function(R,I,k){return t(c.squaredDistance(k,R),I*I)?[g.clone(k)]:[]};a.intersectVerticalCylinders=
function(R,I,k,u){const [C,T]=R,[M,N]=k;var V=M-C,Y=N-T;const ea=V*V+Y*Y,Z=Math.sqrt(ea);if(Z>I+u||Z<Math.abs(I-u)||t(Z,0)&&t(I,u))return[];u=(I*I-u*u+ea)/(2*Z);I=Math.sqrt(I*I-u*u);Y=I*Y/Z;V=I*V/Z;const [ia,oa]=c.lerp(J,R,k,u/Z);return t(Y,V)?[l.fromValues(ia,oa)]:[l.fromValues(ia+Y,oa-V),l.fromValues(ia-Y,oa+V)]};a.intersectVerticalPlaneAndLineLike=function(R,I){const k=R.start,u=c.subtract(J,R.end,k);var C=h.set(D,-u[1],u[0],0);const T=I.start,M=h.sub(e,I.end,T);var N=h.dot(M,C),V=h.set(r,k[0],
k[1],0);V=h.sub(G,V,T);V=h.dot(V,C);C=m.getEpsilon();if(Math.abs(N)<C)return[];N=h.scaleAndAdd(A,T,M,V/N);return I.type===n.LineType.RAY&&(I=h.sub(x,N,T),h.dot(I,M)<-C)||R.type===a.VerticalPlaneType.HALF_PLANE&&(R=c.sub(E,N,k),c.dot(R,u)<-C)?[]:[g.clone(N)]};a.intersectVerticalPlaneAndPoint=function(R,I){return f(v(S,I[2],R),I)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:R,end:I,type:k},u,C){const T=[];I=c.subtract(J,I,R);var M=c.subtract(E,R,u);u=c.squaredLength(I);const N=2*c.dot(I,
M);C=c.squaredLength(M)-C*C;C=N*N-4*u*C;0===C?(u=-N/(2*u),(k===a.VerticalPlaneType.PLANE||0<=u)&&T.push(c.scaleAndAdd(l.create(),R,I,u))):0<C&&(C=Math.sqrt(C),M=(-N+C)/(2*u),(k===a.VerticalPlaneType.PLANE||0<=M)&&T.push(c.scaleAndAdd(l.create(),R,I,M)),u=(-N-C)/(2*u),(k===a.VerticalPlaneType.PLANE||0<=u)&&T.push(c.scaleAndAdd(l.create(),R,I,u)));return T};a.intersectVerticalPlanes=function(R,I){R=v(S,0,R);I=v(Q,0,I);return d(R,I).map(([k,u])=>l.fromValues(k,u))};a.isClose=t;a.isPointInsidePlane=z;
a.pointToLineLikeDistance=B;a.pointToVerticalCylinderDistance=function(R,I,k){return c.distance(R,I)-k};a.pointToVerticalPlaneDistance=function(R,I){return B(v(S,R[2],I),R)};a.pointsInsidePlane=function(R,I){return I.filter(k=>z(R,k))};a.projectPointToLineLike=w;a.projectPointToVerticalCylinder=function(R,I,k,u=g.create()){const C=c.subtract(J,R,I),T=c.length(C);c.scaleAndAdd(u,I,C,0===T?1:k/T);u[2]=R[2];return u};a.projectPointToVerticalPlane=function(R,I,k){return w(R,v(S,R[2],I),k)};a.vectorsHaveCloseZ=
function(R,I){return t(R[2],I[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64"],function(a,b,c,l){function h(d,f){return d[0]*f[1]-d[1]*f[0]}function g(d,f,v){f=c.dot(v,f)/c.squaredLength(v);return c.scale(d,v,f)}function m(d,f,v,t,z=v){c.subtract(q,t,v);c.subtract(w,f,z);g(B,w,q);return c.add(d,z,B)}function y(d,
f,v,t){c.subtract(q,f,v);f=t/c.length(q);return c.scaleAndAdd(d,v,q,f)}a.LineType=void 0;(function(d){d[d.RAY=0]="RAY";d[d.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const q=l.create(),n=l.create(),w=l.create(),B=l.create();a.cross=h;a.intersectCircleAndPoint=function(d,f,v){y(w,v,d,f);return b.floatEqualAbsolute(w[0],v[0])&&b.floatEqualAbsolute(w[1],v[1])?[l.clone(v)]:[]};a.intersectLineAndPoint=function(d,f){m(w,f,d.start,d.end);return b.floatEqualAbsolute(w[0],f[0])&&b.floatEqualAbsolute(w[1],
f[1])?[l.clone(f)]:[]};a.intersectLineAndRay=function(d,f){const v=d.start;var t=f.start,z=f.end;const F=c.subtract(q,d.end,v);var H=c.subtract(n,z,t);z=h(F,H);if(1E-6>=Math.abs(z))return[];t=c.subtract(w,v,t);H=h(H,t)/z;z=h(F,t)/z;if(0<=H){if(0<=z||f.type===a.LineType.LINE)return[c.scaleAndAdd(B,v,F,H)]}else if(d.type===a.LineType.LINE&&(0<=z||f.type===a.LineType.LINE))return[c.scaleAndAdd(B,v,F,H)];return[]};a.intersectLineLikeAndCircle=function(d,f,v){const t=[],z=c.subtract(q,d.end,d.start);var F=
c.subtract(n,d.start,f);f=c.squaredLength(z);const H=2*c.dot(z,F);v=c.squaredLength(F)-v*v;v=H*H-4*f*v;0===v?(f=-H/(2*f),(d.type===a.LineType.LINE||0<=f)&&t.push(c.scaleAndAdd(B,d.start,z,f))):0<v&&(v=Math.sqrt(v),F=(-H+v)/(2*f),(d.type===a.LineType.LINE||0<=F)&&t.push(c.scaleAndAdd(B,d.start,z,F)),f=(-H-v)/(2*f),(d.type===a.LineType.LINE||0<=f)&&t.push(c.scaleAndAdd(w,d.start,z,f)));return t};a.pointToLineDistance=function(d,f,v){return Math.abs((f[0]-d[0])*(v[1]-d[1])-(f[1]-d[1])*(v[0]-d[0]))/c.distance(f,
v)};a.projectPoint=g;a.projectPointToCircle=y;a.projectPointToLine=m;a.projectPointToRay=function(d,f,v,t){c.subtract(q,t,v);c.subtract(w,f,v);f=c.dot(q,w)/c.squaredLength(q);return 0<f?c.scaleAndAdd(d,v,q,f):c.copy(d,v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports","../SnappingDomain","./SnappingCandidate"],function(a,b,c){class l extends c.SnappingCandidate{constructor({targetPoint:h,
objectId:g,constraint:m,isDraped:y}){super(h,m,y,b.SnappingDomain.FEATURE);this.objectId=g}}a.FeatureSnappingCandidate=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(a){class b{constructor(c,l,h,g){this.targetPoint=c;this.constraint=l;this.isDraped=h;this.domain=g}}a.SnappingCandidate=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,c,l,h,g){class m extends g.SnappingHint{constructor(y,q,n,w,B=h.SnappingDomain.ALL,d=!0,f=!0){super(w,B);this.type=y;this.lineStart=q;this.lineEnd=n;this.fadeLeft=d;this.fadeRight=f}equals(y){return y instanceof m?this.type===y.type&&l.exactEquals(this.lineStart,y.lineStart)&&l.exactEquals(this.lineEnd,y.lineEnd)&&this.fadeLeft===y.fadeLeft&&this.fadeRight===y.fadeRight:!1}get length(){return l.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=m;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(c,l){this.isDraped=c;this.domain=l}}a.SnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,c,l,h){class g extends l.FeatureSnappingCandidate{constructor(m){super({...m,
constraint:new b.LineConstraint(m.edgeStart,m.edgeEnd)})}get hints(){return[new h.LineSnappingHint(c.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.EdgeSnappingCandidate=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../sketch/constraints","../SnappingDomain","./SnappingCandidate","../hints/IntersectionSnappingHint"],
function(a,b,c,l,h){class g extends l.SnappingCandidate{constructor(m,y,q,n){super(m,new b.PointConstraint(m),n,c.SnappingDomain.ALL);this.first=y;this.second=q}get hints(){this.first.targetPoint=this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new h.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}a.IntersectionSnappingCandidate=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports",
"../../../../chunks/vec32","../SnappingDomain","./SnappingHint"],function(a,b,c,l){class h extends l.SnappingHint{constructor(g,m,y=c.SnappingDomain.ALL){super(m,y);this.intersectionPoint=g}equals(g){return g instanceof h?b.exactEquals(this.intersectionPoint,g.intersectionPoint):!1}}a.IntersectionSnappingHint=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../sketch/constraints ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),
function(a,b,c,l,h,g){class m extends h.SnappingCandidate{constructor({lineStart:y,lineEnd:q,targetPoint:n,isDraped:w}){super(n,new b.VerticalPlaneConstraint(y,q),w,c.SnappingDomain.SELF);this._referenceLineHint=new g.LineSnappingHint(l.LineSegmentHintType.REFERENCE_EXTENSION,y,q,w,this.domain)}get hints(){return[this._referenceLineHint,new g.LineSnappingHint(l.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}
a.LineSnappingCandidate=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(a,b,c,l,h,g,m,y,q,n){class w extends y.SnappingCandidate{constructor({referenceLine:B,
lineStart:d,targetPoint:f,isDraped:v}){const t=c.clone(d),{left:z,right:F}=B;b.subtract(t,b.add(t,t,F),z);super(f,new l.VerticalPlaneConstraint(d,h.fromVec3(t)),v,g.SnappingDomain.SELF);this._referenceLines=[{edge:B,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new q.LineSnappingHint(m.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new n.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(B=>
new q.LineSnappingHint(m.LineSegmentHintType.REFERENCE,B.edge.left,B.edge.right,this.isDraped,this.domain,B.fadeLeft,B.fadeRight))]}addReferenceLine(B){const d={edge:B,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(f=>{b.exactEquals(B.right,f.edge.left)&&(f.fadeLeft=!1,d.fadeRight=!1);b.exactEquals(B.right,f.edge.right)&&(f.fadeRight=!1,d.fadeRight=!1);b.exactEquals(B.left,f.edge.right)&&(f.fadeRight=!1,d.fadeLeft=!1);b.exactEquals(B.left,f.edge.left)&&(f.fadeLeft=!1,d.fadeLeft=!1)});this._referenceLines.push(d)}}
a.ParallelLineSnappingCandidate=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,c,l,h,g){class m extends g.SnappingHint{constructor(y,q,n,w=h.SnappingDomain.ALL){super(n,w);this.lineStart=y;this.lineEnd=q}equals(y){return y instanceof m?l.exactEquals(this.lineStart,y.lineStart)&&
l.exactEquals(this.lineEnd,y.lineEnd):!1}}a.ParallelSnappingHint=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),function(a,b,c,l,h,g){class m extends l.SnappingCandidate{constructor({targetPoint:y,constraint:q,previousVertex:n,otherVertex:w,otherVertexType:B,
isDraped:d,selfSnappingType:f,objectId:v,domain:t}){super(y,q,d,t??b.SnappingDomain.SELF);this.previousVertex=n;this.otherVertex=w;this.otherVertexType=B;this.selfSnappingType=f??a.SelfSnappingRightAngleType.None;this.objectId=v??null}get hints(){const y=this.previousVertex,q=this.otherVertexType===a.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===a.OtherVertexType.CENTER?this.targetPoint:this.otherVertex;return[new h.LineSnappingHint(c.LineSegmentHintType.TARGET,
q,n,this.isDraped,this.domain),new h.LineSnappingHint(c.LineSegmentHintType.REFERENCE,y,q,this.isDraped,this.domain),new g.RightAngleSnappingHint(this.previousVertex,q,n,this.isDraped,this.domain)]}}a.OtherVertexType=void 0;(function(y){y[y.NEXT=0]="NEXT";y[y.CENTER=1]="CENTER"})(a.OtherVertexType||(a.OtherVertexType={}));a.SelfSnappingRightAngleType=void 0;(function(y){y[y.None=0]="None";y[y.LastVertex=1]="LastVertex";y[y.FirstVertex=2]="FirstVertex";y[y.ExistingEdge=3]="ExistingEdge"})(a.SelfSnappingRightAngleType||
(a.SelfSnappingRightAngleType={}));a.RightAngleSnappingCandidate=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,c,l,h,g){class m extends g.SnappingHint{constructor(y,q,n,w,B=h.SnappingDomain.ALL){super(w,B);this.previousVertex=y;this.centerVertex=q;this.nextVertex=
n}equals(y){return y instanceof m?l.exactEquals(this.previousVertex,y.previousVertex)&&l.exactEquals(this.centerVertex,y.centerVertex)&&l.exactEquals(this.nextVertex,y.nextVertex):!1}}a.RightAngleSnappingHint=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){class B extends q.SnappingCandidate{constructor({targetPoint:d,point1:f,point2:v,isDraped:t}){super(d,new h.VerticalCylinderConstraint(g.fromVec3(c.lerp(l.create(),f,v,.5)),.5*b.distance(g.asVec2(f),g.asVec2(v))),t,m.SnappingDomain.SELF);this._p1=f;this._p2=v}get hints(){return[new n.LineSnappingHint(y.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new n.LineSnappingHint(y.LineSegmentHintType.REFERENCE,this.targetPoint,this._p2,this.isDraped,
this.domain),new w.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}a.RightAngleTriangleSnappingCandidate=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define(["exports","../../../core/screenUtils","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../3d/interactive/support/viewUtils"],function(a,b,c,l,h){const g=l.makeDehydratedPoint(0,0,0,
null),m=c.create(),y=b.createScreenPointArray();a.vectorToScreenPoint=function(q,n,w,B){if("2d"===B.type)return g.x=q[0],g.y=q[1],g.spatialReference=n,B.toScreen(g);h.vectorToRender(q,n,w,B,m);B.state.camera.projectToScreen(m,y);return b.createScreenPoint(y[0],y[1])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/support/viewUtils":function(){define("exports ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../support/elevationInfoUtils".split(" "),
function(a,b,c,l,h,g){const m=h.create(),y=b.createRenderScreenPointArray(),q=b.createRenderScreenPointArray();a.renderScreenSpaceTangent=function(n,w,B,d){B.projectToRenderScreen(n,y);B.projectToRenderScreen(w,q);c.subtract(d,q,y);c.normalize(d,d)};a.vectorToRender=function(n,w,B,d,f=h.create()){n=l.copy(m,n);n[2]=g.getConvertedElevationFromVector(d,n,w,B)||0;d.renderCoordsHelper.toRenderCoords(n,w,f);return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],
function(a){function b(c){return"graphic"===c?.type}a.filterGraphicHits=function(c){return c.filter(b)};a.findFirstGraphicHit=function(c){return c.find(b)??null};a.hitTestSelectSimilarDistance=async function(c,l){if("2d"===c.type)return c.hitTest(l);c=await c.hitTest(l);if(0===c.results.length)return c;l=c.results[0];const h=1.05*(l.distance??0),g=c.results.findIndex(m=>(m.distance??0)>h);-1!==g&&(c.results=c.results.slice(0,g));l&&c.ground.distance>h&&(c.ground.mapPoint=null);return c};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,c,l,h,g,m,y){a.OperationHandle=class extends l.EventedAccessor{constructor(q){super(q);this.cancelled=!1;this.history={undo:[],redo:[]};this.type=
null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:c.neverReached(this.activeComponent)}return null}addToHistory(q){this.history.redo=[];this.history.undo.push(q)}resetHistory(){this.history.redo=[];this.history.undo=[]}canUndo(){return 0<
this.history.undo.length}canRedo(){return 0<this.history.redo.length}complete(){this._reset();this.onEnd();this.emit("complete")}cancel(){this.cancelled=!0;this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const q=this.activeComponent;q&&("box"!==q.type&&"reshape"!==q.type&&"graphic-mover"!==q.type||q.refresh())}set undo(q){this._set("undo",()=>{this.canUndo()&&q()})}set redo(q){this._set("redo",()=>{this.canRedo()&&q()})}};b.__decorate([h.property()],a.OperationHandle.prototype,
"activeComponent",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"cancelled",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"history",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"tool",null);b.__decorate([h.property()],a.OperationHandle.prototype,"type",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"canUndo",null);b.__decorate([h.property()],a.OperationHandle.prototype,"canRedo",null);b.__decorate([h.property()],a.OperationHandle.prototype,
"onEnd",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"undo",null);b.__decorate([h.property()],a.OperationHandle.prototype,"redo",null);b.__decorate([h.property()],a.OperationHandle.prototype,"toggleTool",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"addToSelection",void 0);b.__decorate([h.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=b.__decorate([y.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);
a.CreateOperationHandle=class extends a.OperationHandle{};b.__decorate([h.property()],a.CreateOperationHandle.prototype,"activeComponent",void 0);a.CreateOperationHandle=b.__decorate([y.subclass("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],a.CreateOperationHandle);a.UpdateOperationHandle=class extends a.OperationHandle{};b.__decorate([h.property()],a.UpdateOperationHandle.prototype,"activeComponent",void 0);a.UpdateOperationHandle=b.__decorate([y.subclass("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],
a.UpdateOperationHandle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/SnappingControls/VisibleElements".split(" "),function(a,b,c,l,h,g,m,y){let q=class extends b{constructor(w){super(w);this.mesh=this.multipoint=this.circle=
this.rectangle=this.polygon=this.polyline=this.point=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"point",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"polyline",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"polygon",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"rectangle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"circle",void 0);a.__decorate([c.property({type:Boolean,
nonNullable:!0})],q.prototype,"multipoint",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],q.prototype,"mesh",void 0);q=a.__decorate([m.subclass("esri.widgets.Sketch.VisibleElements.CreateToolVisibilityMap")],q);let n=class extends b{constructor(w){super(w);this["rectangle-selection"]=!0;this["lasso-selection"]=!0;this["custom-selection"]=!0}};a.__decorate([c.property({nonNullable:!0})],n.prototype,"rectangle-selection",void 0);a.__decorate([c.property({nonNullable:!0})],n.prototype,
"lasso-selection",void 0);a.__decorate([c.property({nonNullable:!0})],n.prototype,"custom-selection",void 0);n=a.__decorate([m.subclass("esri.widgets.Sketch.VisibleElements.SelectionToolVisibilityMap")],n);b=class extends b{constructor(w){super(w);this.createTools=new q;this.directionModePicker=!1;this.labelsToggle=this.duplicateButton=!0;this.selectionTools=new n;this.snappingControls=this.settingsMenu=!0;this.snappingControlsElements=new y;this.undoRedoMenu=this.tooltipsToggle=!0}};a.__decorate([c.property({type:q,
nonNullable:!0})],b.prototype,"createTools",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"directionModePicker",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"duplicateButton",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"labelsToggle",void 0);a.__decorate([c.property({type:n,nonNullable:!0})],b.prototype,"selectionTools",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"settingsMenu",
void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"snappingControls",void 0);a.__decorate([c.property({type:y,nonNullable:!0})],b.prototype,"snappingControlsElements",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"undoRedoMenu",void 0);return b=a.__decorate([m.subclass("esri.widgets.Sketch.VisibleElements")],b)})},"esri/widgets/support/SnappingControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../GridControls/VisibleElements".split(" "),
function(a,b,c,l,h,g,m,y){b=class extends b{constructor(q){super(q);this.gridEnabledToggle=this.featureEnabledToggle=this.enabledToggle=!0;this.header=!1;this.gridControls=this.layerList=!0;this.gridControlsElements=new y({gridSnapEnabledToggle:!1,gridEnabledToggle:!1});this.selfEnabledToggle=this.layerListToggleLayersButton=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"enabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"featureEnabledToggle",
void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"gridEnabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"layerList",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"gridControls",void 0);a.__decorate([c.property({type:y,nonNullable:!0})],b.prototype,"gridControlsElements",void 0);a.__decorate([c.property({type:Boolean,
nonNullable:!0})],b.prototype,"layerListToggleLayersButton",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"selfEnabledToggle",void 0);return b=a.__decorate([m.subclass("esri.widgets.support.SnappingControls.VisibleElements")],b)})},"esri/widgets/support/GridControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m){b=class extends b{constructor(y){super(y);this.rotateWithMapToggle=this.placementButtons=this.outOfScaleWarning=this.lineIntervalInput=this.gridSnapEnabledToggle=this.numericInputs=this.gridEnabledToggle=this.dynamicScaleToggle=this.colorSelection=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"colorSelection",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"dynamicScaleToggle",void 0);a.__decorate([c.property({type:Boolean,
nonNullable:!0})],b.prototype,"gridEnabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"numericInputs",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"gridSnapEnabledToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"lineIntervalInput",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"outOfScaleWarning",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],
b.prototype,"placementButtons",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"rotateWithMapToggle",void 0);return b=a.__decorate([m.subclass("esri.widgets.support.GridControls.VisibleElements")],b)})},"esri/widgets/support/globalCss":function(){define(["exports"],function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",
buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",
menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",
widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SelectionToolbar":function(){define("require ../../chunks/tslib.es6 ../../core/deprecate ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ../../chunks/componentsUtils ./globalCss ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SelectionToolbar/SelectionToolbarViewModel".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F){const H={lassoTool:!0,rectangleTool:!0},J={createTool:"polygon",mode:"freehand"},E={createTool:"rectangle"};q=class extends B{constructor(p,D){super(p,D);this.messages=this.activeToolInfo=this._viewModelHandlesGroup=null;this.toolConfigs=[];this.viewModel=new F;this.visibleElements={...H};this._viewModelHandlesGroup=l.handlesGroup([this.viewModel.on("complete",e=>{this._set("activeToolInfo",null);this.emit("complete",e)})])}destroy(){this._viewModelHandlesGroup=
g.removeMaybe(this._viewModelHandlesGroup)}loadDependencies(){return d.loadCalciteComponents({action:()=>new Promise((p,D)=>a(["../../chunks/calcite-action"],p,D)),icon:()=>new Promise((p,D)=>a(["../../chunks/calcite-icon"],p,D))})}get label(){return this.messages?.widgetLabel??""}set label(p){this._overrideIfSome("label",p)}get layers(){c.deprecatedProperty(h.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});return this.viewModel.sources}set layers(p){c.deprecatedProperty(h.getLogger(this),
"layers",{replacement:"Use SelectionToolbar.sources instead."});this.viewModel.sources=p}get sources(){return this.viewModel.sources}set sources(p){this.viewModel.sources=p}get view(){return this.viewModel.view}set view(p){this.viewModel.view=p}castVisibleElements(p){return{...H,...p}}get visibleToolCount(){const {view:p,toolConfigs:D,visibleElements:e}=this;return(D?.length??0)+("2d"===p?.type?(e.lassoTool?1:0)+(e.rectangleTool?1:0):0)}activate(p){this.cancel();if("disabled"!==this.viewModel.state)switch(p){case "lasso":this._activateTool("lasso");
break;case "rectangle":this._activateTool("rectangle");break;default:this._activateTool(p)}}cancel(){this.viewModel.cancel();this._set("activeToolInfo",null)}render(){return z.tsx("div",{"aria-label":this.label,class:this.classes("esri-selection-toolbar",f.globalCss.widget)},z.tsx("div",{class:"esri-selection-toolbar__container"},this._renderDefaultTools(),this._renderCustomTools()))}_renderDefaultTools(){if("2d"===this.view?.type)return[this._renderRectangleTool(),this._renderLassoTool()]}_renderCustomTools(){if(this.toolConfigs?.length)return this.toolConfigs.map(({toolName:p,
icon:D})=>z.tsx("calcite-action",{active:this.activeToolInfo?.toolName===p,bind:this,class:"esri-selection-toolbar__tool-button",disabled:"disabled"===this.viewModel.state,onclick:()=>this._onCustomToolClick(p),scale:"s",text:p,title:p},z.tsx("calcite-icon",{icon:D||"selection",scale:"s"})))}_renderLassoTool(){const {activeToolInfo:p,messages:D,visibleElements:e}=this;if(e.lassoTool){var r=D.selectByLasso;return z.tsx("calcite-action",{active:"lasso"===p?.toolName,bind:this,disabled:"disabled"===
this.viewModel.state,onclick:this._onLassoToolClick,scale:"s",text:r,title:r},z.tsx("calcite-icon",{icon:"lasso-select",scale:"s"}))}}_renderRectangleTool(){const {activeToolInfo:p,messages:D,visibleElements:e}=this;if(e.rectangleTool){var r=D.selectByRectangle;return z.tsx("calcite-action",{active:"rectangle"===p?.toolName,bind:this,disabled:"disabled"===this.viewModel.state,onclick:this._onRectangleToolClick,scale:"s",text:r,title:r},z.tsx("calcite-icon",{icon:"cursor-marquee",scale:"s"}))}}_onCustomToolClick(p){this._toggleTool(p)}_onLassoToolClick(){this._toggleTool("lasso")}_onRectangleToolClick(){this._toggleTool("rectangle")}_activateTool(p){var D=
this._getToolOptions(p);D&&(D=this.viewModel.activate(D))&&this._set("activeToolInfo",{toolName:p,operation:D})}_toggleTool(p){if(this.activeToolInfo){const D=this.activeToolInfo.toolName;this.cancel();if(D===p)return}this._activateTool(p)}_getToolOptions(p){return"lasso"===p?J:"rectangle"===p?E:this.toolConfigs.find(D=>D.toolName===p)}};b.__decorate([m.property({readOnly:!0})],q.prototype,"activeToolInfo",void 0);b.__decorate([m.property()],q.prototype,"label",null);b.__decorate([m.property()],q.prototype,
"layers",null);b.__decorate([m.property(),t.messageBundle("esri/widgets/support/SelectionToolbar/t9n/SelectionToolbar")],q.prototype,"messages",void 0);b.__decorate([m.property()],q.prototype,"sources",null);b.__decorate([m.property()],q.prototype,"toolConfigs",void 0);b.__decorate([m.property()],q.prototype,"view",null);b.__decorate([m.property()],q.prototype,"viewModel",void 0);b.__decorate([m.property()],q.prototype,"visibleElements",void 0);b.__decorate([y.cast("visibleElements")],q.prototype,
"castVisibleElements",null);b.__decorate([m.property()],q.prototype,"visibleToolCount",null);return q=b.__decorate([w.subclass("esri.widgets.support.SelectionToolbar")],q)})},"esri/widgets/support/SelectionToolbar/SelectionToolbarViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/deprecate ../../../core/Evented ../../../core/handleUtils ../../../core/Logger ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/support/layerUtils ../../../views/draw/support/layerUtils ../../../views/support/layerViewUtils ../Selector2D/SelectionOperation".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v){c=class extends c.EventedAccessor{constructor(t){super(t);this.sources=this.activeOperation=this._operationHandlesGroup=null}initialize(){this.addHandles([m.watch(()=>this._sources,t=>{this.activeOperation&&(this.activeOperation.sources=t)})])}destroy(){this._operationHandlesGroup=g.removeMaybe(this._operationHandlesGroup)}get _sources(){const {sources:t,view:z}=this;return z&&t?.length?t.flatMap(F=>{if(f.isSelectableLayerView2D(F))return F;if(B.isKnowledgeGraphLayer(F)||
B.isLinkChartLayer(F)){var H=F.layers||[];const J=H.map(E=>{const p=d.findLayerView(z,E)||void 0;return f.isSelectableLayerView2D(p)?p:E});return J.length?J.toArray():H.length?H.toArray():F}H=d.findLayerView(z,F)||void 0;return f.isSelectableLayerView2D(H)?H:F}):[]}get layers(){b.deprecatedProperty(h.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});return this.sources}set layers(t){b.deprecatedProperty(h.getLogger(this),"layers",{replacement:"Use SelectionToolbar.sources instead."});
this.sources=t}get state(){const {_sources:t,view:z}=this;return this.activeOperation?"active":z?.ready&&(t?.length||z?.selectionManager.sources.length)?"ready":"disabled"}cancel(){"active"===this.state&&(this.activeOperation?.cancel(),this._set("activeOperation",null))}activate(t){const {_sources:z,state:F,view:H}=this;if("disabled"!==F&&(z?.length||H?.selectionManager.sources.length)&&this.view)return"active"===F&&this.cancel(),t=new v({view:this.view,sources:z,options:t}),this._operationHandlesGroup=
l.handlesGroup([t.selection.on("change",J=>this.emit("selection-change",J)),t.once("complete",J=>this._onOperationComplete(J))]),this._set("activeOperation",t),t}_onOperationComplete(t){this._operationHandlesGroup=g.removeMaybe(this._operationHandlesGroup);this._set("activeOperation",null);this.emit("complete",t)}};a.__decorate([y.property()],c.prototype,"_sources",null);a.__decorate([y.property({readOnly:!0})],c.prototype,"activeOperation",void 0);a.__decorate([y.property()],c.prototype,"layers",
null);a.__decorate([y.property()],c.prototype,"sources",void 0);a.__decorate([y.property({readOnly:!0})],c.prototype,"state",null);a.__decorate([y.property()],c.prototype,"view",void 0);return c=a.__decorate([w.subclass("esri.widgets.support.SelectionToolbar.SelectionToolbarViewModel")],c)})},"esri/widgets/support/Selector2D/SelectionOperation":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/asyncUtils ../../../core/Collection ../../../core/Evented ../../../core/handleUtils ../../../core/promiseUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/coordsUtils ../../../views/draw/DrawScreenTool ../../../views/interactive/keybindings ./selectorUtils ../../../geometry/Point ../../../geometry/Polygon".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H){b=class extends h.EventedAccessor{constructor(J){super(J);this.options=this._processTask=null;this.selection=new l;this.sources=null;this._process=m.debounce(async(E,p)=>{const {callback:D,selector:e,completed:r}=E,G=c.createTask(async A=>{const {sources:x,selection:L,view:S}=this;(x?.length||S?.selectionManager.sources.length)&&S?(e&&null!=x&&(A=await z.getSelectionFromGeometry({currentSelection:L,selector:e,signal:A,sources:x,view:S}),r&&S.selectionManager?.updateSelection({current:L.toArray(),
...A})),D&&D()):L.removeAll()});m.onAbort(p,()=>G.abort());this._processTask=G;return G.promise},100)}initialize(){this._setup()}cancel(){this.removeAllHandles();this._processTask?.abort()}async _setup(){const {view:J}=this;await J.whenReady();if(!this.destroyed){var E=this.options,p=E?.createTool??"rectangle",D=E?.mode??("polygon"===p?"click":"hybrid"),e=Symbol();this._tool=new v.DrawScreenTool({view:J,mode:D,geometryType:p});E?.selectOnComplete||this.addHandles(this._tool.on(["cursor-update","vertex-add",
"vertex-remove"],()=>m.ignoreAbortErrors(this._process({selector:this._selectionArea}))),e);this.addHandles([J.on("key-down",r=>{if(!r.repeat)switch(r.key){case t.sketchKeys.constraint:this._tool.uniformSizeToggled=!0;r.stopPropagation();break;case t.sketchKeys.center:this._tool.centeredToggled=!0,r.stopPropagation()}}),J.on("key-up",r=>{switch(r.key){case t.sketchKeys.constraint:this._tool.uniformSizeToggled=!1;r.stopPropagation();break;case t.sketchKeys.center:this._tool.centeredToggled=!1,r.stopPropagation()}}),
this._tool.on("complete",async r=>{this.removeHandles(e);const G=()=>{this.removeAllHandles();this.emit("complete",{aborted:r.aborted,selection:this.selection.toArray()})};r.aborted?(this.cancel(),this.selection.removeAll(),G()):await this._process({selector:this._selectionArea,callback:G,completed:!0})})],e);this.addHandles(g.makeHandle(()=>J.tools.remove(this._tool)));J.addAndActivateTool(this._tool)}}get _selectionArea(){const J=y.createScreenPoint();var E=this._tool.coordinates;const p=this.view.spatialReference,
D=e=>{J.x=e[0];J.y=e[1];const {x:r,y:G}=this.view.toMap(J);return[r,G]};if(1===E.length){const [e,r]=D(E[0]);return new F({x:e,y:r,spatialReference:p})}E=this._tool.coordinates.map(D);if(0!==E.length)return f.isClockwise(E)||E.reverse(),new H({spatialReference:p,rings:[E]})}};a.__decorate([q.property()],b.prototype,"options",void 0);a.__decorate([q.property({readOnly:!0})],b.prototype,"selection",void 0);a.__decorate([q.property()],b.prototype,"sources",void 0);a.__decorate([q.property({constructOnly:!0})],
b.prototype,"view",void 0);return b=a.__decorate([d.subclass("esri.widgets.support.Selector2D.SelectionOperation")],b)})},"esri/views/draw/DrawScreenTool":function(){define("exports ../../chunks/tslib.es6 ../../core/Evented ../../core/handleUtils ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/factories/mat2df64 ./DrawOperation ./drawSurfaces ./support/createUtils ./support/surfaceCoordinateSystems ../interactive/InteractiveToolBase ../overlay/OutlineOverlayItem".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z){function F(H){switch(H){case "polygon":case "point":return H;case "circle":case "rectangle":return"segment"}}a.DrawScreenTool=class extends c.EventedMixin(t.InteractiveToolBase){constructor(H){super(H);this._overlayItem=void 0;this.mode=this.geometryType=null;this.type="draw-screen"}initialize(){this.drawOperation=this._makeDrawOperation();const H=J=>this.drawOperation.on(J,E=>{this._updateVisuals();this.emit(J,E)});this.addHandles([H("vertex-add"),H("vertex-remove"),
H("vertex-update"),H("cursor-update"),H("complete")]);this.finishToolCreation()}destroy(){this.drawOperation=h.destroyMaybe(this.drawOperation);this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centeredToggled(H){this._set("centeredToggled",H);this._updateVisuals()}set enabled(H){this.drawOperation.interactive=H;this._set("enabled",H)}set uniformSizeToggled(H){this._set("uniformSizeToggled",H);this._updateVisuals()}get updating(){return this.drawOperation?.updating??
!1}get cursor(){return"point"===this.geometryType?"default":"crosshair"}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(H){if(!this.destroyed)this.drawOperation.onInputEvent(H)}redo(){this.drawOperation.redo()}undo(){this.drawOperation.undo()}reset(){}_makeDrawOperation(){const {view:H}=this;return new B.DrawOperation({view:H,manipulators:this.manipulators,geometryType:F(this.geometryType),drawingMode:this.mode,hasZ:!1,defaultZ:0,snapToSceneEnabled:!1,drawSurface:new d.ScreenDrawSurface,
hasM:!1,snappingManager:null,snappingVisualizer:null,graphic:null,cursor:this.cursor})}get coordinates(){var {drawOperation:H}=this;if(!H?.geometryIncludingUncommittedVertices.length)return[];var {coordinateHelper:J}=H,E=H.committableVertex,p=H.committedVertices.slice();null!=E&&p.push(J.pointToArray(E));const D=p.length;switch(this.geometryType){case "circle":case "rectangle":J=new v.AffineCoordinateSystem(w.IDENTITY,d.ScreenDrawSurface.spatialReference);E="circle"===this.geometryType?f.createCircle:
f.createSquare;const e="circle"===this.geometryType?f.createEllipse:f.createRectangle;return 1===D&&H.isCompleted?(p=p[0],H=J.makeMapPoint(p[0]+48,p[1]),E([p,H],J,!0)?.geometry.rings[0]??[]):2===D?(H=this.centeredToggled!==("rectangle"!==this.geometryType),(this.uniformSizeToggled!==("rectangle"!==this.geometryType)?E(p,J,H)?.geometry.rings[0]:e(p,J,H)?.geometry.rings[0])??[]):[]}return p}_updateVisuals(){if(!this._overlayItem){const H=new z({strokeDash:[5],strokeDashColor:[255,255,255,255]});this.view.overlay?.addItem(H);
this.addHandles(l.makeHandle(()=>{this.view.overlay?.removeItem(H);H?.destroy();this._overlayItem=void 0}));this._overlayItem=H}this._overlayItem.coordinates=this.coordinates}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}};b.__decorate([g.property({value:!1})],a.DrawScreenTool.prototype,"centeredToggled",null);b.__decorate([g.property()],a.DrawScreenTool.prototype,"drawOperation",void 0);b.__decorate([g.property({value:!0})],a.DrawScreenTool.prototype,"enabled",null);
b.__decorate([g.property({value:!1})],a.DrawScreenTool.prototype,"uniformSizeToggled",null);b.__decorate([g.property({constructOnly:!0})],a.DrawScreenTool.prototype,"geometryType",void 0);b.__decorate([g.property({constructOnly:!0})],a.DrawScreenTool.prototype,"mode",void 0);b.__decorate([g.property({readOnly:!0})],a.DrawScreenTool.prototype,"type",void 0);b.__decorate([g.property({readOnly:!0})],a.DrawScreenTool.prototype,"updating",null);b.__decorate([g.property({constructOnly:!0,nonNullable:!0})],
a.DrawScreenTool.prototype,"view",void 0);b.__decorate([g.property()],a.DrawScreenTool.prototype,"cursor",null);a.DrawScreenTool=b.__decorate([n.subclass("esri.views.draw.DrawScreenTool")],a.DrawScreenTool);a.geometryTypeToDrawOperationGeometryType=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["exports"],function(a){function b(){return[1,0,0,1,0,0]}function c(y){return[y[0],y[1],y[2],y[3],y[4],y[5]]}function l(y,
q,n,w,B,d){return[y,q,n,w,B,d]}function h(y,q){return new Float64Array(y,q,6)}const g=b(),m=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:g,clone:c,create:b,createView:h,fromValues:l},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=g;a.clone=c;a.create=b;a.createView=h;a.fromValues=l;a.mat2df64=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawOperation":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/lang ../../core/maybe ../../core/memoize ../../core/promiseUtils ../../core/ReactiveSet ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/diffUtils ../../core/support/UpdatingHandles ../../layers/graphics/dehydratedFeatureComparison ../../support/elevationInfoUtils ../ViewingMode ./DrawingMode ./DrawManipulator ../interactive/coordinateHelper ../interactive/dragEventPipeline ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryOperations ../interactive/sketch/constraints ../interactive/sketch/constraintUtils ../interactive/sketch/SketchLabelOptions ../interactive/snapping/SnappingContext ../interactive/snapping/SnappingDragPipelineStep ../interactive/snapping/SnappingOperation ../interactive/snapping/snappingUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J,E,p,D,e,r,G,A,x,L,S,Q,R,I){const k=Symbol(),u=Symbol();a.DrawOperation=class extends l.EventedMixin(c){constructor(C){super(C);this._hideDefaultCursor=this._createOperationCompleted=!1;this._pointerDownStates=new q;this._stagedPointerType=this._stagedScreenPoint=null;this._updatingHandles=new z.UpdatingHandles;this._stagedPointerId=null;this.constraintsEnabled=!1;this.constraints=void 0;this._getPointConstraint=m.memoize(x.getPointConstraint);this._getPolylineOrPolygonConstraint=
m.memoize(x.getPolylineOrPolygonConstraint);this.defaultZ=this.constraintZ=null;this.isDraped=!0;this.labelOptions=new L;this.cursor=null;this.loading=!1;this.secondToLastVertex=this.lastVertex=this.firstVertex=this.snapToSceneEnabled=null;null==C.elevationInfo&&(this.elevationInfo=H.getEffectiveElevationInfo(!!C.hasZ))}initialize(){const {geometryType:C,view:T}=this,M=T.spatialReference,N="viewingMode"in T.state?T.state.viewingMode:J.ViewingMode.Local,V="segment"===C||"multipoint"===C?"polyline":
C;this.coordinateHelper=D.createCoordinateHelper(this.hasZ,this.hasM,M);this._editGeometryOperations=new G.EditGeometryOperations(new r.EditGeometry(V,this.coordinateHelper),N);this._snappingOperation=new R.SnappingOperation({view:T});this.addHandles([n.watch(()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint}),({stagedPoint:Z,constraint:ia},oa)=>{const {snappingOptions:ra}=this;ra&&(ra.forceDisabled=null!=ia&&A.isPoint(ia));if(null!=oa&&Z===oa.stagedPoint&&ia!==oa.constraint)return this._onKeyboardBasedChange();
this._processCursor(Z??this._screenToMap(this._stagedScreenPoint))},{equals:(Z,ia)=>Z.stagedPoint===ia.stagedPoint&&g.equalsMaybe(Z.constraint,ia.constraint)}),n.watch(()=>this.view.viewpoint,(Z,ia)=>{Z&&ia&&t.diff(Z,ia)&&this._onKeyboardBasedChange()})]);this._activeComponent=new r.Component(M,N);this._editGeometryOperations.data.components.push(this._activeComponent);const Y=this.segmentLabels;null!=Y&&(Y.context={view:T,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,
labelOptions:this.labelOptions},this.addHandles(n.watch(()=>this.labelOptions.enabled,Z=>{Y.visible=Z},n.syncAndInitial)));this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],Z=>{const ia=Z.vertices.map(na=>({componentIndex:0,vertexIndex:na.index,coordinates:this.coordinateHelper.vectorToArray(na.pos)})),oa=ia.map(na=>na.coordinates);var ra=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;F.pointEquals(ra,this.firstVertex)||
(this.firstVertex=ra);ra=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;F.pointEquals(ra,this.lastVertex)||(this.lastVertex=ra);ra=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;F.pointEquals(ra,this.secondToLastVertex)||(this.secondToLastVertex=ra);this._processCursor(this.cursorVertex);switch(Z.type){case "vertex-add":this.emit(Z.type,{...Z,added:oa,vertices:ia});break;case "vertex-update":this.emit(Z.type,
{...Z,updated:oa,vertices:ia});break;case "vertex-remove":this.emit(Z.type,{...Z,removed:oa,vertices:ia})}}));const ea=this._manipulator=new p.DrawManipulator({consumesClicks:!1,grabbableForEvent:Z=>"click"!==this.drawingMode?!0:"touch"===Z.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(ea);ea.grabbable="point"!==C;this.addHandles([ea.events.on("immediate-click",Z=>this._onImmediateClick(Z)),ea.events.on("immediate-double-click",Z=>this._onImmediateDoubleClick(Z)),
n.watch(()=>this.drawingMode,()=>{this.removeHandles(k);this.addHandles(this._createManipulatorDragPipeline(ea),k)},n.syncAndInitial),n.watch(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:Z})=>{ea.cursor=Z},n.syncAndInitial)]);I.setupSnappingToggleHandles(this,()=>{var Z=this._getSnappingContext(this.view.inputManager.latestPointerType??"mouse");null!=this.snappingManager&&(Z=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,Z),this._updatingHandles.addPromise(y.ignoreAbortErrors(Z)))})}destroy(){g.destroyMaybe(this.segmentLabels);
g.destroyMaybe(this._snappingOperation);this._editGeometryOperations=g.destroyMaybe(this._editGeometryOperations);this._updatingHandles.destroy()}get _isDragging(){const {_stagedPointerId:C,_manipulator:T}=this;return null!=C&&this._pointerDownStates.has(C)||T.grabbing||!T.interactive}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const C=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==
C}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(C=>this.coordinateHelper.vectorToArray(C.pos))}get _constraint(){const {constraints:C,constraintsEnabled:T}=this;if(C&&T)switch(this.geometryType){case "point":return this._getPointConstraint(C);case "polygon":case "polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,C)}}set drawingMode(C){this._set("drawingMode",
C??E.defaultDrawingMode)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(C){this._manipulator.interactive=C}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===
this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const {cursorVertex:C,lastVertex:T,firstVertex:M,geometryType:N}=this;return"polygon"===N&&F.pointNear(C,M)||F.pointNear(C,T)?null:C}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const {committedVertices:C,committableVertex:T,coordinateHelper:M}=this,N=C.slice();null!=T&&N.push(M.pointToArray(T));return N}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();
const {committableVertex:C}=this;null!=C&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(C))}complete(C){C=C?.aborted||!1;this._snappingOperation.abort();this.snappingManager?.doneSnapping();const {geometryType:T,numCommittedVertices:M}=this,N="multipoint"===T&&0===M||"polyline"===T&&2>M||"polygon"===T&&3>M;"segment"!==T&&"point"!==T||this.commitStagedVertex();this._createOperationCompleted=!N;if(this.isCompleted||C)this._stagedPointerType=this._stagedPointerId=this._stagedScreenPoint=
null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((V,Y)=>({componentIndex:0,vertexIndex:Y,coordinates:V})),aborted:C,type:"complete"})}onInputEvent(C){switch(C.type){case "pointer-down":this._pointerDownStates.add(C.pointerId);break;case "pointer-up":this._pointerDownStates.delete(C.pointerId)}switch(C.type){case "pointer-move":return this._onPointerMove(C);case "hold":return this._onHold(C)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&
this.snappingManager.doneSnapping();this._editGeometryOperations.undo()}_processCursor(C){const T=h.clone(this.cursorVertex);C=(C=h.clone(C))&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(C)??C);C=this._snapToClosingVertex(C);C=this._applyConstraints(C);F.pointNear(T,C)||(this._set("cursorVertex",C),this.segmentLabels?.set("stagedVertex",null!=C?this.coordinateHelper.pointToVector(C):null),null==C||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,
vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(C)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(C){if(null==C||this._isDragging||"polygon"!==this.geometryType||2>=this.numCommittedVertices)return C;const T=this._mapToScreen(C);if(!T)return C;const M=this._activeComponent;return this._vertexWithinPointerDistance(M.vertices[0].pos,T)?this.firstVertex:this._vertexWithinPointerDistance(M.vertices.at(-1).pos,
T)?this.lastVertex:C}_createManipulatorDragPipeline(C){switch(this.drawingMode){case "click":return this._createManipulatorDragPipelineClick(C);case "freehand":return this._createManipulatorDragPipelineFreehand(C);case "hybrid":return this._createManipulatorDragPipelineHybrid(C)}}_createManipulatorDragPipelineClick(C){return e.createManipulatorDragEventPipeline(C,(T,M,N,V)=>{const Y="touch"===V&&this._snappingEnabled;if(!this.isCompleted&&Y){var {snappingStep:ea,cancelSnapping:Z}=Q.createSnapDragEventPipelineStep({predicate:()=>
Y,snappingManager:this.snappingManager,snappingContext:new S.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:V,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});N=N.next(ia=>{Y&&null!=this.snappingManager&&this.snappingManager.doneSnapping();return ia}).next(Z);M.next(this._screenToMapDragEventStep()).next(ia=>{"start"===ia.action&&
(this._processCursor(ia.mapStart),("segment"===this.geometryType||Y&&!this.numCommittedVertices)&&this.commitStagedVertex());return ia}).next(e.sceneSnappingAtLocation(this.view,this.elevationInfo)).next(...ea).next(ia=>{Y&&(this._processCursor(ia.mapEnd),"end"===ia.action&&this.commitStagedVertex());return ia}).next(ia=>{"end"===ia.action&&("mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete());return ia})}})}_createManipulatorDragPipelineFreehand(C){return e.createManipulatorDragEventPipeline(C,
(T,M)=>{this.isCompleted||M.next(this._screenToMapDragEventStep()).next(N=>{"start"===N.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(N.mapStart),"segment"===this.geometryType&&this.commitStagedVertex());return N}).next(N=>{switch(N.action){case "start":case "update":this._processCursor(N.mapEnd);"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return N})})}_createManipulatorDragPipelineHybrid(C){return e.createManipulatorDragEventPipeline(C,
(T,M)=>{this.isCompleted||M.next(this._screenToMapDragEventStep()).next(N=>{"start"===N.action&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),u),this._processCursor(N.mapStart),this.commitStagedVertex());return N}).next(N=>{switch(N.action){case "start":case "update":this._processCursor(N.mapEnd);"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),
this.removeHandles(u),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return N})})}get _drawAtFixedElevation(){const {constraintsEnabled:C,constraintZ:T,geometryType:M,numCommittedVertices:N}=this;return C?null!=T||"segment"===M&&0<N:("segment"===M||"polygon"===M)&&0<N}_updateAndGetEffectiveDrawSurface(){const {constraintsEnabled:C,coordinateHelper:T,drawSurface:M,elevationDrawSurface:N,snapToSceneEnabled:V}=this;if(null==N)return M;if(!this.hasZ)return N.defaultZ=null,
N;const Y=this.elevationInfo?.mode;let ea=this.defaultZ,Z=C||"absolute-height"===Y;null!=V&&(Z=V);"on-the-ground"===Y&&(Z=!1);this._drawAtFixedElevation&&(ea=(C?this.constraintZ:null)??T.getZ(this._activeComponent.vertices[0].pos),Z=!1);if(Z)return M;N.defaultZ=ea;return N}_mapToScreen(C){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(C)}_onHold(C){this._snappingOperation.abort();"click"===this.drawingMode&&"touch"===C.pointerType&&this._snappingEnabled&&this._processCursor(C.mapPoint);
C.stopPropagation()}_onImmediateClick(C){if(!("mouse"===C.pointerType&&2===C.button||this._manipulator.dragging))try{const {drawingMode:T,geometryType:M}=this;this._stagedPointerType=C.pointerType;this._stagedScreenPoint=C.screenPoint;const N=this._screenToMap(C.screenPoint);null==N||null==N||"freehand"===T&&"point"!==M||(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(N),null==this.committableVertex?this.complete():(this.commitStagedVertex(),"mouse"!==C.pointerType&&this._processCursor(null),
("freehand"===T||"point"===M||"segment"===M&&2===this.numCommittedVertices||"segment"===M&&"hybrid"===T&&1===this.numCommittedVertices)&&this.complete()))}finally{C.stopPropagation()}}_onImmediateDoubleClick(C){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),C.stopPropagation())}_onPointerMove(C){const T=w.createScreenPoint(C.x,C.y);this._stagedScreenPoint=T;this._stagedPointerType=C.pointerType;this._stagedPointerId=C.pointerId;this._isDragging?this._snappingOperation.abort():
(C.stopPropagation(),this._processCursorMovementRelativeToSurface(T,C.pointerType))}_onKeyboardBasedChange(){"mouse"!==this._stagedPointerType||!this._stagedScreenPoint||null==this._stagedPointerId||this._isDragging?this._snappingOperation.abort():this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType)}_processCursorMovementRelativeToSurface(C,T){const M=this._snappingOperation,N=this._screenToMap(C);C=this._requiresScenePoint?this.drawSurface?.screenToMap(C):
null;if(null==N)this._hideDefaultCursor=!0,this._processCursor(null),M.abort();else{this._hideDefaultCursor=!1;var V=this.snappingManager;null==V?(this._processCursor(N),M.abort()):(T=this._getSnappingContext(T),this._updatingHandles.addPromise(y.ignoreAbortErrors(M.snap({point:N,scenePoint:C},V,T))))}}_applyConstraints(C){const {_constraint:T,constraints:M}=this;if(!C||!M||!T)return C;var {context:N}=M,V=x.pointToConstraintSpace(C,N);V=V?T.closestTo(V):void 0;if(!V)return C;C=x.constraintSpaceToPoint(V,
C,N);N="2d"===this.view.type||"absolute-height"!==N.elevationInfo.mode;null!=C&&N&&null!=this.constraintZ&&this.hasZ&&(C.z=this.constraintZ);return C}_screenToMap(C){return C?this._updateAndGetEffectiveDrawSurface()?.screenToMap(C):null}_screenToMapDragEventStep(){let C=null;return T=>{"start"===T.action&&(C=this._screenToMap(T.screenStart));if(null==C)return null;const M=this._screenToMap(T.screenEnd);return null!=M?{...T,mapStart:C,mapEnd:M}:null}}_vertexWithinPointerDistance(C,T){const M=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(C));
null!=M?(C=M.x-T.x,T=M.y-T.y,T=25>=C*C+T*T):T=!1;return T}_getSnappingContext(C){const T=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new S.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:C,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=T?{value:T,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};b.__decorate([B.property()],a.DrawOperation.prototype,"_hideDefaultCursor",
void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"_stagedPointerId",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"_isDragging",null);b.__decorate([B.property()],a.DrawOperation.prototype,"_snappingOperation",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"_snappingEnabled",null);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"graphic",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"constraintsEnabled",void 0);b.__decorate([B.property()],
a.DrawOperation.prototype,"constraints",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"_constraint",null);b.__decorate([B.property()],a.DrawOperation.prototype,"constraintZ",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"defaultZ",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"isDraped",void 0);b.__decorate([B.property({value:E.defaultDrawingMode})],a.DrawOperation.prototype,"drawingMode",null);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,
"elevationDrawSurface",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"elevationInfo",void 0);b.__decorate([B.property({constructOnly:!0,type:L})],a.DrawOperation.prototype,"labelOptions",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"geometryType",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"hasM",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"hasZ",void 0);b.__decorate([B.property()],
a.DrawOperation.prototype,"cursor",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"effectiveCursor",null);b.__decorate([B.property()],a.DrawOperation.prototype,"loading",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"manipulators",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"drawSurface",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"segmentLabels",void 0);b.__decorate([B.property({constructOnly:!0})],
a.DrawOperation.prototype,"snappingManager",void 0);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"snappingVisualizer",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"snapToSceneEnabled",void 0);b.__decorate([B.property({readOnly:!0})],a.DrawOperation.prototype,"cursorVertex",null);b.__decorate([B.property({readOnly:!0})],a.DrawOperation.prototype,"visualizationCursorVertex",null);b.__decorate([B.property()],a.DrawOperation.prototype,"committableVertex",null);
b.__decorate([B.property()],a.DrawOperation.prototype,"firstVertex",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"lastVertex",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"secondToLastVertex",void 0);b.__decorate([B.property()],a.DrawOperation.prototype,"updating",null);b.__decorate([B.property({constructOnly:!0})],a.DrawOperation.prototype,"view",void 0);a.DrawOperation=b.__decorate([v.subclass("esri.views.draw.DrawOperation")],a.DrawOperation);a.defaultCursor="crosshair";
a.defaultLoadingCursor="progress";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/memoize":function(){define(["exports"],function(a){a.memoize=function(b){let c,l=[],h,g=!1;return function(...m){var y;if(y=g&&c===this)a:if(m.length!==l.length)y=!1;else{for(y=0;y<m.length;++y)if(m[y]!==l[y]){y=!1;break a}y=!0}if(y)return h;h=b.apply(this,m);c=this;l=m;g=!0;return h}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking",
"./accessorSupport/tracking/SimpleObservable"],function(a,b){class c{constructor(l){this._observable=new b.SimpleObservable;this._set=new Set(l)}get size(){a.trackAccess(this._observable);return this._set.size}add(l){const h=this._set.size;this._set.add(l);this._set.size!==h&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(l){(l=this._set.delete(l))&&this._observable.notify();return l}entries(){a.trackAccess(this._observable);return this._set.entries()}forEach(l,
h){a.trackAccess(this._observable);this._set.forEach((g,m)=>l.call(h,g,m,this),h)}has(l){a.trackAccess(this._observable);return this._set.has(l)}keys(){a.trackAccess(this._observable);return this._set.keys()}values(){a.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){a.trackAccess(this._observable);return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return c})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["exports",
"../../core/has","../../core/mathUtils","../../geometry/support/spatialReferenceUtils"],function(a,b,c,l){function h(n,w){if(n===w)return!0;if(null==n||null==w||n.length!==w.length)return!1;for(let B=0;B<n.length;B++){const d=n[B],f=w[B];if(d.length!==f.length)return!1;for(let v=0;v<d.length;v++)if(d[v]!==f[v])return!1}return!0}function g(n,w){if(n===w)return!0;if(null==n||null==w||n.length!==w.length)return!1;for(let B=0;B<n.length;B++)if(!h(n[B],w[B]))return!1;return!0}function m(n,w){return n===
w||null!=n&&null!=w&&l.equals(n.spatialReference,w.spatialReference)&&n.x===w.x&&n.y===w.y&&n.z===w.z&&n.m===w.m}function y(n,w){if(n===w)return!0;if(null==n||null==w||n.type!==w.type)return!1;switch(n.type){case "point":return m(n,w);case "extent":return n=n.hasZ!==w.hasZ||n.hasM!==w.hasM?!1:l.equals(n.spatialReference,w.spatialReference)?n.xmin===w.xmin&&n.ymin===w.ymin&&n.zmin===w.zmin&&n.xmax===w.xmax&&n.ymax===w.ymax&&n.zmax===w.zmax:!1,n;case "polyline":return n=n.hasZ!==w.hasZ||n.hasM!==w.hasM?
!1:l.equals(n.spatialReference,w.spatialReference)?g(n.paths,w.paths):!1,n;case "polygon":return n=n.hasZ!==w.hasZ||n.hasM!==w.hasM?!1:l.equals(n.spatialReference,w.spatialReference)?g(n.rings,w.rings):!1,n;case "multipoint":return n=n.hasZ!==w.hasZ||n.hasM!==w.hasM?!1:l.equals(n.spatialReference,w.spatialReference)?h(n.points,w.points):!1,n;case "mesh":return!1}}function q(n,w){if(n===w)return!0;if(!n||!w)return!1;const B=Object.keys(n),d=Object.keys(w);if(B.length!==d.length)return!1;for(const f of B)if(n[f]!==
w[f])return!1;return!0}a.equals=function(n,w){return n===w?!0:null!=n&&null!=w&&n.objectId===w.objectId&&y(n.geometry,w.geometry)&&q(n.attributes,w.attributes)?!0:!1};a.pointEquals=m;a.pointNear=function(n,w,B){return n===w||null!=n&&null!=w&&l.equals(n.spatialReference,w.spatialReference)&&c.floatEqualAbsolute(n.x,w.x,B)&&c.floatEqualAbsolute(n.y,w.y,B)&&c.floatEqualAbsolute(n.z??0,w.z??0,B)&&c.floatEqualAbsolute(n.m??0,w.m??0,B)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawingMode":function(){define(["exports"],
function(a){a.defaultDrawingMode="click";a.drawingModes=["freehand","hybrid","click"];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawManipulator":function(){define(["exports","../../core/Evented"],function(a,b){class c{constructor({consumesClicks:l,grabbableForEvent:h}){this.events=new b;this.interactive=!0;this.selectable=!1;this.cursor=null;this.grabbable=!0;this.consumesClicks=l;this.grabbableForEvent=h}destroy(){}intersectionDistance(l,h){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}
a.DrawManipulator=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ../../core/libs/gl-matrix-2/factories/vec4f64 ../../geometry/Point".split(" "),function(a,b,c,l,h,g,m,y){var q;(function(d){d[d.Z=0]="Z";d[d.M=1]="M"})(q||={});class n{constructor(d){this.spatialReference=
d}createVector(){return this._tag(c.create())}pointToVector(d){return this._tag(c.fromValues(d.x,d.y))}arrayToVector(d){return this._tag(c.fromValues(d[0],d[1]))}vectorToArray(d){return[d[0],d[1]]}pointToArray(d){return[d.x,d.y]}vectorToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=void 0;f.m=void 0;f.spatialReference=this.spatialReference;return f}arrayToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=void 0;f.m=void 0;f.spatialReference=this.spatialReference;return f}vectorToDehydratedPoint(d,f){if(d)return f??=
{x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},f.x=d[0],f.y=d[1],f.z=void 0,f.m=void 0,f.hasZ=!1,f.hasM=!1,f.spatialReference=this.spatialReference,f}lerp(d,f,v,t){return b.lerp(t,d,f,v)}addDelta(d,f,v){d[0]+=f;d[1]+=v}distance(d,f){return b.distance(d,f)}getZ(d,f){return f}hasZ(){return!1}getM(d,f){return f}hasM(){return!1}clone(d){return this._tag(c.fromArray(d))}copy(d,f){return b.copy(f,d)}fromXYZ(d){return this._tag(c.fromValues(d[0],d[1]))}toXYZ(d,
f=h.create()){return l.set(f,d[0],d[1],0)}pointToXYZ(d,f=h.create()){return l.set(f,d.x,d.y,0)}equals(d,f){return b.equals(d,f)}_tag(d){return d}}class w{constructor(d,f){this._valueType=d;this.spatialReference=f}createVector(){return this._tag(h.create())}pointToVector(d){return this._tag(h.fromValues(d.x,d.y,this._valueType===q.Z?d.z:d.m))}arrayToVector(d){return this._tag(h.fromValues(d[0],d[1],d[2]||0))}vectorToArray(d){return[d[0],d[1],d[2]]}pointToArray(d){return this._valueType===q.Z?[d.x,
d.y,d.z]:[d.x,d.y,d.m]}vectorToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=this._valueType===q.Z?d[2]:void 0;f.m=this._valueType===q.M?d[2]:void 0;f.spatialReference=this.spatialReference;return f}arrayToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=this._valueType===q.Z?d[2]:void 0;f.m=this._valueType===q.M?d[2]:void 0;f.spatialReference=this.spatialReference;return f}vectorToDehydratedPoint(d,f){if(d){f??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"};var v=
this._valueType===q.Z,t=this._valueType===q.M;f.x=d[0];f.y=d[1];f.z=v?d[2]:void 0;f.m=t?d[2]:void 0;f.hasZ=v;f.hasM=t;f.spatialReference=this.spatialReference;return f}}lerp(d,f,v,t){return l.lerp(t,d,f,v)}addDelta(d,f,v,t){d[0]+=f;d[1]+=v;this._valueType===q.Z&&(d[2]+=t)}distance(d,f){return this._valueType===q.Z?l.distance(d,f):b.distance(d,f)}getZ(d,f){return this._valueType===q.Z?d[2]:f}hasZ(){return this._valueType===q.Z}getM(d,f){return this._valueType===q.M?d[2]:f}hasM(){return this._valueType===
q.M}clone(d){return this._tag(h.fromArray(d))}copy(d,f){return l.copy(f,d)}fromXYZ(d,f=0,v=0){return this._tag(h.fromValues(d[0],d[1],this._valueType===q.Z?2<d.length?d[2]:f:v))}toXYZ(d,f=h.create()){return l.set(f,d[0],d[1],this._valueType===q.Z?d[2]:0)}pointToXYZ(d,f=h.create()){return l.set(f,d.x,d.y,this._valueType===q.Z?d.z??0:0)}equals(d,f){return l.equals(d,f)}_tag(d){return d}}class B{constructor(d){this.spatialReference=d}createVector(){return this._tag(m.create())}pointToVector(d){return this._tag(m.fromValues(d.x,
d.y,d.z,d.m))}arrayToVector(d){return this._tag(m.fromValues(d[0],d[1],d[2]||0,d[3]||0))}vectorToArray(d){return[d[0],d[1],d[2],d[3]]}pointToArray(d){return[d.x,d.y,d.z,d.m]}vectorToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=d[2];f.m=d[3];f.spatialReference=this.spatialReference;return f}arrayToPoint(d,f=new y){f.x=d[0];f.y=d[1];f.z=d[2];f.m=d[3];f.spatialReference=this.spatialReference;return f}vectorToDehydratedPoint(d,f){if(d)return f??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,
spatialReference:void 0,type:"point"},f.x=d[0],f.y=d[1],f.z=d[2],f.m=d[3],f.hasZ=!0,f.hasM=!0,f.spatialReference=this.spatialReference,f}lerp(d,f,v,t){return g.lerp(t,d,f,v)}addDelta(d,f,v,t){d[0]+=f;d[1]+=v;d[2]+=t}distance(d,f){return l.distance(d,f)}getZ(d){return d[2]}hasZ(){return!0}getM(d){return d[3]}hasM(){return!0}clone(d){return this._tag(m.fromArray(d))}copy(d,f){return g.copy(f,d)}fromXYZ(d,f=0,v=0){return this._tag(m.fromValues(d[0],d[1],2<d.length?d[2]:f,v))}toXYZ(d,f=h.create()){return l.set(f,
d[0],d[1],d[2])}pointToXYZ(d,f=h.create()){return l.set(f,d.x,d.y,d.z??0)}equals(d,f){return g.equals(d,f)}_tag(d){return d}}a.CoordinateHelper2D=n;a.CoordinateHelper3D=w;a.CoordinateHelper4D=B;a.createCoordinateHelper=function(d,f,v){return d&&f?new B(v):f?new w(q.M,v):d?new w(q.Z,v):new n(v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../core/arrayUtils ../../core/has ../../core/lang ../../core/mathUtils ../../core/screenUtils ../../geometry/projection ../../geometry/support/meshVertexSpaceUtils ../../layers/graphics/hydratedFeatures ../../support/elevationInfoUtils ./editGeometry/EditGeometryOperations".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){function B(E,p){let D=null,e=null;return r=>{if("cancel"===r.action)null!=e&&(e.execute({action:"cancel"}),e=D=null);else{var G={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};"start"===r.action&&null==D&&(D=new J,e=new J,p(E,D,e,r.pointerType,G));null!=D&&D.execute(G);"end"===r.action&&null!=D&&(e=D=null)}}}function d(E){let p=null;return D=>{"start"===D.action&&(p=v(E,D.mapStart.spatialReference));if(null==p)return null;const e=D.mapEnd.x-D.mapStart.x,
r=D.mapEnd.y-D.mapStart.y,G=(D.mapEnd.z??0)-(D.mapStart.z??0);p.move(e,r,G,D.action);return{...D,translationX:e,translationY:r,translationZ:G}}}function f(E,p){return null==E?null:E.spatialReference.equals(p)?E.clone():m.project(E,p)}function v(E,p){const D=E.operations;if(!D)return null;const e=D.data.geometry;p=q.hydratedSpatialReference(p);if(e.spatialReference.equals(p))return t(E,D,()=>{});if("mesh"!==e.type){p=f(e,p);if(null==p)return null;const r=e.spatialReference;p=w.EditGeometryOperations.fromGeometry(p,
D.viewingMode);return t(E,p,()=>{const G=m.project(e,r);D.trySetGeometry(G)})}if(y.isMeshWithRelativeVertexSpace(e)){p=f(e.origin,p);if(!p)return null;const r=e.spatialReference,G=w.EditGeometryOperations.fromGeometry(p,D.viewingMode);return t(E,D,()=>{const A=m.project(G.data.geometry,r);D.move(A.x-e.origin.x,A.y-e.origin.y,(A.z??0)-(e.origin.z??0))})}return null}function t(E,p,D){let e=0,r=0,G=0;return{move:(A,x,L,S)=>{"start"===S&&(G=r=e=0);A-=e;x-=r;L-=G;p.move(A,x,L);e+=A;r+=x;G+=L;D();"end"===
S&&E.endInteraction?.()}}}function z(E){const p=E.operations?.createResetState();return D=>{p?.remove();return D}}function F(E,p,D){const e=p.elevationProvider.getElevation(E.x,E.y,E.z??0,E.spatialReference,"scene")??0;E=q.clonePoint(E);E.z=e;E.hasZ=!0;E.z=n.getZForElevationMode(E,p,D);return E}const H=()=>{};class J{constructor(){this.execute=H}next(E,p=new J){null!=E&&(this.execute=D=>{D=E(D);null!=D&&p.execute(D)});return p}}a.EventPipeline=J;a.addMapDelta=function(){let E=0,p=0,D=0;return e=>
{"start"===e.action&&(E=e.mapStart.x,p=e.mapStart.y,D=e.mapStart.z);const r=e.mapEnd.x-E,G=e.mapEnd.y-p,A=e.mapEnd.z-D;E=e.mapEnd.x;p=e.mapEnd.y;D=e.mapEnd.z;return{...e,mapDeltaX:r,mapDeltaY:G,mapDeltaZ:A,mapDeltaSpatialReference:e.mapStart.spatialReference}}};a.addScreenDelta=function(){let E=0,p=0;return D=>{"start"===D.action&&(E=D.screenStart.x,p=D.screenStart.y);const e=D.screenEnd.x-E,r=D.screenEnd.y-p;E=D.screenEnd.x;p=D.screenEnd.y;return{...D,screenDeltaX:e,screenDeltaY:r}}};a.constrainToMapAxis=
function(E,p){const D=[E.x,E.y,E.z??0],e=[Math.cos(p),Math.sin(p)];E=Math.sqrt(e[0]*e[0]+e[1]*e[1]);if(0===E)return null;e[0]/=E;e[1]/=E;const r=G=>{const A=(G.x-D[0])*e[0]+(G.y-D[1])*e[1];G.x=D[0]+A*e[0];G.y=D[1]+A*e[1]};return G=>{r(G.mapStart);r(G.mapEnd);return{...G,axis:e}}};a.createDragEventPipelineCallback=B;a.createManipulatorDragEventPipeline=function(E,p){return E.events.on("drag",B(E,p))};a.dragAtLocation=function(E,p){let D=null,e=0,r=0;return G=>{"start"===G.action&&(D=E.toScreen?.(p),
null!=D&&(0>D.x||D.x>E.width||0>D.y||D.y>E.height?D=null:(e=G.screenStart.x-D.x,r=G.screenStart.y-D.y)));if(null==D)return null;var A=h.clamp(G.screenEnd.x-e,0,E.width);const x=h.clamp(G.screenEnd.y-r,0,E.height);A=g.createScreenPoint(A,x);G.screenStart=D;G.screenEnd=A;return G}};a.dragManipulatedObject=d;a.dragManipulatedObjectMany=function(E){const p=E.map(D=>d(D)).filter(b.isSome);return D=>{const e=D.mapEnd.x-D.mapStart.x,r=D.mapEnd.y-D.mapStart.y,G=D.mapEnd.z-D.mapStart.z;p.forEach(A=>A(D));
return{...D,translationX:e,translationY:r,translationZ:G}}};a.resetManipulatedObject=z;a.resetManipulatedObjectMany=function(E){const p=E.map(D=>z(D)).filter(D=>null!=D);return D=>{p.forEach(e=>e(D));return D}};a.resetProperties=function(E,p){const D=new Map;for(const e of p)D.set(e,l.clone(E[e]));return e=>{D.forEach((r,G)=>{E[G]=r});return e}};a.sceneSnappingAtLocation=function(E,p,D=[]){if("2d"===E.type)return r=>r;let e=null;return r=>{"start"===r.action&&(e=E.toMap(r.screenStart,{exclude:D}),
null!=e&&(e.z=n.getZForElevationMode(e,E,p)));const G=E.toMap(r.screenEnd,{exclude:D});null!=G&&(G.z=n.getZForElevationMode(G,E,p));return{...r,scenePoints:null!=e&&null!=G?{sceneStart:e,sceneEnd:G}:null}}};a.sceneSnappingAtProjectedLocation=function(E,p){if("2d"===E.type)return e=>e;let D=null;return e=>{"start"===e.action&&(D=F(e.mapStart,E,p));const r=F(e.mapEnd,E,p);return{...e,scenePoints:null!=D&&null!=r?{sceneStart:D,sceneEnd:r}:null}}};a.screenToMap=function(E,p=null,D){let e=null;const r=
null==p||E.spatialReference?.equals(p)?A=>A:A=>null!=A?m.project(A,p):A,G={exclude:[],...D};return A=>{"start"===A.action&&(e=r(E.toMap(A.screenStart,G)));if(null==e)return null;const x=r(E.toMap(A.screenEnd,G));return null!=x?{...A,mapStart:e,mapEnd:x}:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/hydratedFeatures":function(){define("exports ../../geometry ../../Graphic ../../core/has ../../core/lang ../../core/typedArrayUtil ../../geometry/support/jsonUtils ./dehydratedPoint ../../geometry/SpatialReference".split(" "),
function(a,b,c,l,h,g,m,y,q){function n(H){return"declaredClass"in H}function w(H){return"declaredClass"in H}function B(H){return"declaredClass"in H}function d(H){return null==H?null:n(H)?H:m.fromJSON(f(H))}function f(H){const {wkid:J,wkt:E,wkt2:p,latestWkid:D}=H.spatialReference,e={wkid:J,wkt:E,wkt2:p,latestWkid:D};switch(H.type){case "point":const {x:r,y:G,z:A,m:x}=H;return{x:r,y:G,z:A,m:x,spatialReference:e};case "polygon":const {rings:L,hasZ:S,hasM:Q}=H;return{rings:v(L),hasZ:S,hasM:Q,spatialReference:e};
case "polyline":const {paths:R,hasZ:I,hasM:k}=H;return{paths:v(R),hasZ:I,hasM:k,spatialReference:e};case "extent":const {xmin:u,xmax:C,ymin:T,ymax:M,zmin:N,zmax:V,mmin:Y,mmax:ea,hasZ:Z,hasM:ia}=H;return{xmin:u,xmax:C,ymin:T,ymax:M,zmin:N,zmax:V,mmin:Y,mmax:ea,hasZ:Z,hasM:ia,spatialReference:e};case "multipoint":const {points:oa,hasZ:ra,hasM:na}=H;return{points:F(oa)?t(oa):oa,hasZ:ra,hasM:na,spatialReference:e}}}function v(H){return z(H)?H.map(J=>t(J)):H}function t(H){return H.map(J=>Array.from(J))}
function z(H){for(const J of H)if(0!==J.length)return F(J);return!1}function F(H){return 0<H.length&&(g.isFloat32Array(H[0])||g.isFloat64Array(H[0]))}a.clonePoint=function(H,J){if(!H)return null;if(w(H)){if(null==J)return H.clone();if(w(J))return J.copy(H)}null!=J?(J.x=H.x,J.y=H.y,J.spatialReference=H.spatialReference,H.hasZ?(J.z=H.z,J.hasZ=H.hasZ):(J.z=void 0,J.hasZ=!1),H.hasM?(J.m=H.m,J.hasM=!0):(J.m=void 0,J.hasM=!1)):(J=y.makeDehydratedPoint(H.x,H.y,H.z,H.spatialReference),H.hasM&&(J.m=H.m,J.hasM=
!0));return J};a.hydrateGeometry=d;a.hydrateGraphic=function(H,J){return H?B(H)?H:new c({layer:J,sourceLayer:J,visible:H.visible,symbol:h.clone(H.symbol),attributes:h.clone(H.attributes),geometry:d(H.geometry)}):null};a.hydratedSpatialReference=function(H){const {wkid:J,wkt:E,wkt2:p,latestWkid:D}=H;return q.fromJSON({wkid:J,wkt:E,wkt2:p,latestWkid:D})};a.isHydratedGeometry=n;a.isHydratedGraphic=B;a.isHydratedPoint=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometryOperations":function(){define("exports ../../../core/Evented ../../../core/handleUtils ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/coordsUtils ./EditGeometry ./interfaces ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/CloseComponent ./operations/MoveMesh ./operations/MoveVertex ./operations/OffsetEdgeVertex ./operations/RotateVertex ./operations/ScaleVertex ./operations/SetAllVertexPositions ./operations/UndoGroup".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J){class E extends b{constructor(p,D){super();this.data=p;this.viewingMode=D;this._undoStack=[];this._redoStack=[];this._listener=this.data.on("change",e=>{e.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:e.addedVertices,operation:e.operation});e.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:e.removedVertices,operation:e.operation});e.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:e.updatedVertices,
operation:e.operation})})}destroy(){this._listener.remove()}splitEdge(p,D){return this._apply(new w.SplitEdge(this.data,p,D))}updateVertices(p,D,e=m.AccumulationBehavior.ACCUMULATE_STEPS){return this._apply(new q.UpdateVertices(this.data,p,D),e)}move(p,D,e,r=m.AccumulationBehavior.ACCUMULATE_STEPS){return g.isMeshEditGeometry(this.data)?this._apply(new f.MoveMesh(this.data,p,D,e),r):this.moveVertices(this.data.allVertices,p,D,e,r)}moveVertices(p,D,e,r,G=m.AccumulationBehavior.ACCUMULATE_STEPS){return g.isMeshEditGeometry(this.data)?
this._apply(new f.MoveMesh(this.data,D,e,r),G):this.updateVertices(p,new v.MoveVertex(this.data.coordinateHelper,D,e,r),G)}scale(p,D,e,r,G=m.AccumulationBehavior.ACCUMULATE_STEPS,A=q.AccumulationType.CUMULATIVE){return this.scaleVertices(this.data.allVertices,p,D,e,r,G,A)}scaleVertices(p,D,e,r,G,A=m.AccumulationBehavior.ACCUMULATE_STEPS,x=q.AccumulationType.CUMULATIVE){return this.updateVertices(p,new F.ScaleVertex(D,e,r,G,x),A)}rotate(p,D,e=m.AccumulationBehavior.ACCUMULATE_STEPS,r=q.AccumulationType.CUMULATIVE){return this.rotateVertices(this.data.allVertices,
p,D,e,r)}rotateVertices(p,D,e,r=m.AccumulationBehavior.ACCUMULATE_STEPS,G=q.AccumulationType.CUMULATIVE){return this.updateVertices(p,new z.RotateVertex(D,e,G),r)}removeVertices(p){return this._apply(new n.RemoveVertices(this.data,p,this._minNumVerticesPerType))}appendVertex(p){return 0===this.data.components.length?null:this._apply(new y.AppendVertex(this.data,this.data.components[0],p))}setVertexPosition(p,D){return this._apply(new B.SetVertexPosition(this.data,p,D))}offsetEdge(p,D,e,r=m.AccumulationBehavior.ACCUMULATE_STEPS){return this.updateVertices([D.leftVertex,
D.rightVertex],new t.OffsetEdgeVertex(this.data.coordinateHelper,p,D,e),r)}trySetGeometry(p,D=m.AccumulationBehavior.ACCUMULATE_STEPS){const {data:e}=this,{coordinateHelper:r}=e;if(e.type===p.type&&e.spatialReference.equals(p.spatialReference)&&r.hasZ()===p.hasZ&&r.hasM()===p.hasM&&h.hasCompatibleTopology(e.geometry,p)&&!g.isMeshEditGeometry(e))return p=Array.from(g.EditGeometry.fromGeometry(p,this.viewingMode).iterateVertices(),G=>G.pos),this.setVertexPositions(p,D)}setVertexPositions(p,D=m.AccumulationBehavior.ACCUMULATE_STEPS){return this._apply(new H.SetAllVertexPositions(this.data,
p),D)}createResetState(){if(g.isMeshEditGeometry(this.data))return this._createResetStateMesh();const p=this.data.geometry.clone();return c.makeHandle(()=>this.trySetGeometry(p))}closeComponent(p){return this.data.components.includes(p)?this._apply(new d.CloseComponent(this.data,p)):null}canRemoveVertex(p){return p.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const p=new J.UndoGroup;this._apply(p);return c.makeHandle(()=>p.close())}undo(){if(0<this._undoStack.length){const p=this._undoStack.pop();
p.undo();this._redoStack.push(p);return p}return null}redo(){if(0<this._redoStack.length){const p=this._redoStack.pop();p.apply();this._undoStack.push(p);return p}return null}get canUndo(){return 0<this._undoStack.length}get canRedo(){return 0<this._redoStack.length}get lastOperation(){return 0<this._undoStack.length?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case "point":return 1;case "polyline":return 2;case "polygon":return 3;default:return 0}}_apply(p,
D=m.AccumulationBehavior.ACCUMULATE_STEPS){D!==m.AccumulationBehavior.NEW_STEP&&null!=this.lastOperation&&this.lastOperation.accumulate(p)||(p.apply(),this._undoStack.push(p),this._redoStack=[]);return p}_createResetStateMesh(){if(!g.isMeshEditGeometry(this.data))return c.makeHandle();const p=this.data.geometry,{vertexSpace:D}=p;if(D.origin){const r=l.clone(D.origin);return c.makeHandle(()=>{p.vertexSpace.origin=r})}const e=p.vertexAttributes.clonePositional();return c.makeHandle(()=>{p.vertexAttributes=
e;p.vertexAttributesChanged()})}static fromGeometry(p,D){return new E(g.EditGeometry.fromGeometry(p,D),D)}}a.EditGeometryOperations=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../core/arrayUtils ../../../core/compilerUtils ../../../core/Evented ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper ./unnormalizationHelper".split(" "),function(a,b,c,l,h,g,m,y){function q(f,v,
t){const z=f.coordinateHelper;t=new B(v.spatialReference,t);t.index=0;const F=new n(t);F.index=0;F.pos=z.pointToVector(v);t.vertices.push(F);f.components.push(t)}class n{constructor(f){this.component=f;this.rightEdge=this.leftEdge=null;this.type="vertex";this.index=null}get pos(){return this._pos}set pos(f){this._pos=f;this.component.unnormalizeVertexPositions()}}class w{constructor(f,v,t){this.component=f;this.leftVertex=v;this.rightVertex=t;this.type="edge";v.rightEdge=this;t.leftEdge=this}}class B{constructor(f,
v){this._spatialReference=f;this._viewingMode=v;this.vertices=[];this.edges=[];this.index=null}unnormalizeVertexPositions(){1>=this.vertices.length||y.unnormalize(this.vertices,y.getUnnormalizationInfo(this._spatialReference,this._viewingMode))}updateVertexIndex(f,v){if(0!==this.vertices.length){var t=this.vertices[0],z=null;do z=f,z.index=v++,f=z.rightEdge?z.rightEdge.rightVertex:null;while(null!=f&&f!==t);z.leftEdge&&z!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(z),
this.vertices.length-1)}}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return 2<this.vertices.length&&null!==this.vertices[0].leftEdge}swapVertices(f,v){const t=this.vertices[f];this.vertices[f]=this.vertices[v];this.vertices[v]=t}iterateVertices(f){if(0!==this.vertices.length){var v=this.vertices[0],t=v;do f(t,t.index),t=null!=t.rightEdge?t.rightEdge.rightVertex:null;while(t!==v&&null!=t)}}}class d extends l{constructor(f,v){super();this.type=
f;this.coordinateHelper=v;this._geometry=null;this._dirty=!0;this.components=[]}get geometry(){if(this._dirty){switch(this.type){case "point":this._geometry=this._toPoint();break;case "polyline":this._geometry=this._toPolyline();break;case "polygon":this._geometry=this._toPolygon();break;case "mesh":break;default:c.neverReached(this.type)}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}get allVertices(){return Array.from(this.iterateVertices())}*iterateVertices(){for(const f of this.components)for(const v of f.vertices)yield v}notifyChanges(f){this._dirty=
!0;this.emit("change",f)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const f=[],v=this.coordinateHelper.vectorToArray;for(const t of this.components){if(1>t.vertices.length)continue;const z=[];let F=t.vertices.find(J=>null==J.leftEdge);const H=F;do z.push(v(F.pos)),F=F.rightEdge?F.rightEdge.rightVertex:null;while(F&&F!==H);f.push(z)}return new g({paths:f,spatialReference:this.spatialReference,
hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const f=[],v=this.coordinateHelper.vectorToArray;for(const t of this.components){if(1>t.vertices.length)continue;const z=[],F=t.vertices[0];let H=F;const J=H;do z.push(v(H.pos)),H=null!=H.rightEdge?H.rightEdge.rightVertex:null;while(H&&H!==J);t.isClosed()&&z.push(v(F.pos));f.push(z)}return new h({rings:f,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(f,
v){var t=m.createCoordinateHelper(f.hasZ,f.hasM,f.spatialReference);t=new d(f.type,t);switch(f.type){case "polygon":var z=f.spatialReference,F=t.coordinateHelper;f=f.rings;for(var H=0;H<f.length;++H){var J=f[H],E=new B(z,v);E.index=H;var p=2<J.length&&b.equals(J[0],J[J.length-1]),D=p?J.length-1:J.length;for(var e=0;e<D;++e){var r=F.arrayToVector(J[e]);const G=new n(E);E.vertices.push(G);G.pos=r;G.index=e}J=E.vertices.length-1;for(D=0;D<J;++D)e=new w(E,E.vertices[D],E.vertices[D+1]),E.edges.push(e);
p&&(p=new w(E,E.vertices[E.vertices.length-1],E.vertices[0]),E.edges.push(p));t.components.push(E)}break;case "polyline":z=f.spatialReference;F=t.coordinateHelper;f=f.paths;for(H=0;H<f.length;++H){p=f[H];E=new B(z,v);E.index=H;J=p.length;for(D=0;D<J;++D)e=F.arrayToVector(p[D]),r=new n(E),E.vertices.push(r),r.pos=e,r.index=D;p=E.vertices.length-1;for(J=0;J<p;++J)D=new w(E,E.vertices[J],E.vertices[J+1]),E.edges.push(D);t.components.push(E)}break;case "point":q(t,f,v);break;case "mesh":q(t,f.origin,
v),t._geometry=f,t._dirty=!1}return t}}a.Component=B;a.Edge=w;a.EditGeometry=d;a.Vertex=n;a.isMeshEditGeometry=function(f){return"mesh"===f.type};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/unnormalizationHelper":function(){define(["exports","../../../geometry/support/spatialReferenceUtils","../../ViewingMode"],function(a,b,c){a.getUnnormalizationInfo=function(l,h){l=b.getInfo(l);return h===c.ViewingMode.Global&&l?{supported:!0,lowerBoundX:l.valid[0],
upperBoundX:l.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}};a.unnormalize=function(l,h){if(h.supported){var g=Infinity,m=-Infinity,y=h.upperBoundX-h.lowerBoundX;l.forEach(n=>{let w=n.pos[0];for(;w<h.lowerBoundX;)w+=y;for(;w>h.upperBoundX;)w-=y;g=Math.min(g,w);m=Math.max(m,w);n.pos[0]=w});var q=m-g;y-q<q&&l.forEach(n=>{0>n.pos[0]&&(n.pos[0]+=y)})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/interfaces":function(){define(["exports"],
function(a){a.AccumulationBehavior=void 0;var b=a.AccumulationBehavior||(a.AccumulationBehavior={});b[b.NEW_STEP=0]="NEW_STEP";b[b.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports","../EditGeometry"],function(a,b){class c{constructor(l,h,g){this._editGeometry=l;this._component=h;this._pos=g;this._right=this._left=this._originalEdge=this._addedVertex=null}apply(){let l=
"redo";null==this._addedVertex&&(l="apply",this._addedVertex=new b.Vertex(this._component));const h=this._component.getLastVertex();if(null==h)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let g=null;h.rightEdge&&(this._originalEdge=h.rightEdge,g=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1));this._component.vertices.push(this._addedVertex);this._addedVertex.pos=this._pos;
null==this._left&&(this._left=new b.Edge(this._component,h,this._addedVertex));this._component.edges.push(this._left);h.rightEdge=this._left;null!=this._originalEdge&&null!=g&&(null==this._right&&(this._right=new b.Edge(this._component,this._addedVertex,g)),this._component.edges.push(this._right),g.leftEdge=this._right);this._component.updateVertexIndex(this._addedVertex,h.index+1)}this._editGeometry.notifyChanges({operation:l,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),
1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,
this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}a.AppendVertex=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],function(a){class b{constructor(c,l,h){this._editGeometry=c;this._vertices=l;this.operation=h;this._undone=!1}apply(){this._vertices.forEach(c=>
this.operation.apply(c));this._editGeometry.components.forEach(c=>c.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(c=>this.operation.undo(c));this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices});this._undone=!0}canAccumulate(c){if(this._undone||c._vertices.length!==this._vertices.length)return!1;for(let l=0;l<c._vertices.length;++l)if(c._vertices[l]!==
this._vertices[l])return!1;return this.operation.canAccumulate(c.operation)}accumulate(c){return c instanceof b&&this.canAccumulate(c)?(this._vertices.forEach(l=>this.operation.accumulate(l,c.operation)),this.operation.accumulateParams(c.operation),this._editGeometry.components.forEach(l=>l.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0):!1}}a.AccumulationType=void 0;(function(c){c[c.CUMULATIVE=0]="CUMULATIVE";c[c.REPLACE=1]="REPLACE"})(a.AccumulationType||
(a.AccumulationType={}));a.UpdateVertices=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../EditGeometry"],function(a,b){class c{constructor(l,h,g=0){this._editGeometry=l;this._vertices=h;this._minNumberOfVertices=g;this.removedVertices=null}apply(){let l="redo";if(null==this.removedVertices){const h=this.removedVertices=[];this._vertices.forEach(g=>{g=this._removeVertex(g);null!=g&&h.push(g)});
l="apply"}else this.removedVertices.forEach(h=>{this._removeVertex(h.removedVertex)});this._editGeometry.notifyChanges({operation:l,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(l=>{this._undoRemoveVertex(l)});this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(l){const h=l.component;if(h.vertices.length<=this._minNumberOfVertices)return null;const g={removedVertex:l,createdEdge:null},m=l.leftEdge,y=l.rightEdge;
h.vertices.splice(h.vertices.indexOf(l),1);m&&(h.edges.splice(h.edges.indexOf(m),1),m.leftVertex.rightEdge=null);y&&(h.edges.splice(h.edges.indexOf(y),1),y.rightVertex.leftEdge=null);0===l.index&&y&&0<this._vertices.length&&h.swapVertices(h.vertices.indexOf(y.rightVertex),0);m&&y&&(g.createdEdge=new b.Edge(h,m.leftVertex,y.rightVertex),h.edges.push(g.createdEdge));y&&h.updateVertexIndex(y.rightVertex,y.rightVertex.index-1);return g}_undoRemoveVertex(l){const h=l.removedVertex,g=l.removedVertex.component,
m=h.leftEdge,y=h.rightEdge;l.createdEdge&&g.edges.splice(g.edges.indexOf(l.createdEdge),1);g.vertices.push(h);m&&(g.edges.push(m),m.leftVertex.rightEdge=m);y&&(g.edges.push(y),y.rightVertex.leftEdge=y);g.updateVertexIndex(h,h.index)}}a.RemoveVertices=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports","../EditGeometry"],function(a,b){class c{constructor(l,h,g){this._editGeometry=l;this._edge=h;this._t=
g;this._right=this._left=this.createdVertex=null}apply(){let l="redo";const h=this._edge,g=h.component,m=h.leftVertex,y=h.rightVertex;g.edges.splice(g.edges.indexOf(h),1);null==this.createdVertex&&(l="apply",this.createdVertex=new b.Vertex(h.component));g.vertices.push(this.createdVertex);this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(h.leftVertex.pos,h.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector());null==this._left&&(this._left=new b.Edge(g,m,this.createdVertex));
this._left.leftVertex.leftEdge?g.edges.push(this._left):g.edges.unshift(this._left);m.rightEdge=this._left;null==this._right&&(this._right=new b.Edge(g,this.createdVertex,y));g.edges.push(this._right);y.leftEdge=this._right;g.updateVertexIndex(this.createdVertex,m.index+1);this._editGeometry.notifyChanges({operation:l,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const l=this._edge,h=l.component,g=this.createdVertex.leftEdge?.leftVertex,
m=this.createdVertex.rightEdge?.rightVertex;h.vertices.splice(h.vertices.indexOf(this.createdVertex),1);h.edges.splice(h.edges.indexOf(this._left),1);h.edges.splice(h.edges.indexOf(this._right),1);this._edge.leftVertex.leftEdge?h.edges.push(this._edge):h.edges.unshift(this._edge);g&&(g.rightEdge=l);m&&(m.leftEdge=l);g&&h.updateVertexIndex(g,g.index);this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}a.SplitEdge=c;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports"],function(a){class b{constructor(c,l,h){this._editGeometry=c;this._vertex=l;this._pos=h}apply(){const c=null==this._originalPosition;c&&(this._originalPosition=this._vertex.pos);this._apply(c?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition;this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(c){return c instanceof
b&&c._vertex===this._vertex?(this._pos=c._pos,this._apply("apply"),!0):!1}_apply(c){this._vertex.pos=this._pos;this._editGeometry.components.forEach(l=>l.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:c,updatedVertices:[this._vertex]})}}a.SetVertexPosition=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/CloseComponent":function(){define(["exports","../../../../core/arrayUtils","../EditGeometry"],function(a,
b,c){class l{constructor(h,g){this._editGeometry=h;this._component=g;this._createdEdge=null}apply(){let h="redo";if(null==this._createdEdge){h="apply";const g=this._component.getFirstVertex(),m=this._component.getLastVertex();if(this._component.isClosed()||3>this._component.vertices.length||null==g||null==m)return;this._createdEdge=new c.Edge(this._component,m,g)}this._createdEdge.leftVertex.rightEdge=this._createdEdge;this._createdEdge.rightVertex.leftEdge=this._createdEdge;this._component.edges.push(this._createdEdge);
this._editGeometry.notifyChanges({operation:h})}undo(){null!=this._createdEdge&&(b.remove(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}a.CloseComponent=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveMesh":function(){define(["exports"],function(a){class b{constructor(c,
l,h,g){this._editGeometry=c;this.dx=l;this.dy=h;this.dz=g;this._firstTime=!0}apply(){const c=this._firstTime?"apply":"redo";this._firstTime=!1;this._apply(c,this.dx,this.dy,this.dz)}undo(){this._apply("undo",-this.dx,-this.dy,-this.dz)}accumulate(c){const l=this._editGeometry.geometry;return c instanceof b&&c._editGeometry.geometry===l?(this._apply("apply",c.dx,c.dy,c.dz),this.dx+=c.dx,this.dy+=c.dy,this.dz+=c.dz,!0):!1}_apply(c,l,h,g){const m=this._editGeometry.geometry;m.offset(l,h,g);if(l=this._editGeometry.components[0].getFirstVertex())l.pos=
this._editGeometry.coordinateHelper.pointToVector(m.origin),this._editGeometry.notifyChanges({operation:c,updatedVertices:[l]})}}a.MoveMesh=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports"],function(a){class b{constructor(c,l,h,g){this._helper=c;this.dx=l;this.dy=h;this.dz=g}_move(c,l,h,g){this._helper.addDelta(c.pos,l,h,g)}apply(c){this._move(c,this.dx,this.dy,this.dz)}undo(c){this._move(c,-this.dx,
-this.dy,-this.dz)}canAccumulate(c){return c instanceof b}accumulate(c,l){this._move(c,l.dx,l.dy,l.dz)}accumulateParams(c){this.dx+=c.dx;this.dy+=c.dy;this.dz+=c.dz}}a.MoveVertex=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/OffsetEdgeVertex":function(){define("exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/vector ../../../support/geometry2dUtils".split(" "),
function(a,b,c,l,h,g,m,y,q){class n{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(d,f,v,t=0,z=B.IMMEDIATE){this._helper=d;this._planeType=f;this._edge=v;this.distance=t;this._plane=m.create();this._offsetPlane=m.create();this._minDistance=-Infinity;this._maxDistance=Infinity;this._selectedArrow=1;z===B.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors();
this._initializePlane();this._initializeDistanceConstraints()}_initializeNeighbors(){const d=this._toXYZ(this._edge.leftVertex.pos),f=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),v=this._toXYZ(this._edge.rightVertex.pos),t=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=h.direction(g.create(),d,v);f?(this._left=this._computeNeighbor(d,f,this._edgeDirection),this._right=this._computeNeighbor(v,t,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(v,
t,this._edgeDirection),this._left=this._computeNeighbor(d,f,this._edgeDirection,this._right))}_toXYZ(d){return null!=d?this._helper.toXYZ(d):null}_pointToXYZ(d){return this._toXYZ(this._helper.pointToVector(d))}_computeNeighbor(d,f,v,t){const z=g.create();if(f)return h.direction(z,d,f),t=!this._passesBisectingAngleThreshold(z,v),{start:d,end:f,direction:t?this._bisectVectorsPerpendicular(v,z):z,isOriginalDirection:!t};this._helper.hasZ()?t&&(h.cross(z,v,t.direction),h.cross(z,z,v),h.normalize(z,z),
Math.sign(z[1])!==Math.sign(v[0])&&h.scale(z,z,-1)):h.set(z,-v[1],v[0],0);return{start:d,end:f,direction:z,isOriginalDirection:!0}}_passesBisectingAngleThreshold(d,f){d=Math.abs(y.angle(f,d));return d>=w&&d<=Math.PI-w}_bisectVectorsPerpendicular(d,f){d=0>h.dot(d,f)?d:h.negate(g.create(),d);const v=Math.abs(h.dot(d,f));if(!(.001>v||.999<v))return this._bisectDirection(d,f);f=h.cross(g.create(),d,[0,0,1]);return h.normalize(f,f)}_bisectDirection(d,f){d=h.add(g.create(),d,f);return h.normalize(d,d)}_initializePlane(){const d=
this._computeNormalDirection(this._left),f=this._computeNormalDirection(this._right);0>h.dot(d,f)&&h.negate(f,f);m.fromPositionAndNormal(this._left.start,this._bisectDirection(d,f),this._plane)}_computeNormalDirection(d){d=h.cross(g.create(),d.direction,this._edgeDirection);h.normalize(d,d);d=h.cross(g.create(),this._edgeDirection,d);this._planeType===a.PlaneType.XY&&(d[2]=0);return h.normalize(d,d)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint(m.signedDistance(this._plane,
this._left.end));null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint(m.signedDistance(this._plane,this._right.end));this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(d){0>=d&&(this._minDistance=Math.max(this._minDistance,d));0<=d&&(this._maxDistance=Math.min(this._maxDistance,d))}_updateIntersectDistanceConstraint(d){var f=m.getNormal(d);const v=this._edgeDirection;var t=h.add(g.create(),this._left.start,this._left.direction);const z=h.add(g.create(),
this._right.start,this._right.direction);var F=this._pointInBasis2D(l.create(),f,v,this._left.start),H=this._pointInBasis2D(l.create(),f,v,t),J=this._pointInBasis2D(l.create(),f,v,this._right.start);f=this._pointInBasis2D(l.create(),f,v,z);[J]=q.intersectLineAndRay({start:H,end:F,type:q.LineType.LINE},{start:f,end:J,type:q.LineType.LINE});J&&(F=c.subtract(l.create(),F,H),c.normalize(F,F),H=c.subtract(l.create(),J,H),H=c.dot(F,H),t=h.add(g.create(),t,h.scale(g.create(),this._left.direction,-H)),d=
m.signedDistance(d,t),this._updateDistanceConstraint(d))}_pointInBasis2D(d,f,v,t){d[0]=y.projectPointSignedLength(f,t);d[1]=y.projectPointSignedLength(v,t);return d}_offset(d,f){Number.isFinite(this._minDistance)&&(f=Math.max(this._minDistance,f));Number.isFinite(this._maxDistance)&&(f=Math.min(this._maxDistance,f));m.copy(this._offsetPlane,this._plane);this._offsetPlane[3]-=f;f=(t,z,F)=>null!=z&&m.intersectLine(this._offsetPlane,t,h.add(g.create(),t,z),F);const v=g.create();(d===this._edge.leftVertex?
f(this._left.start,this._left.direction,v):f(this._right.start,this._right.direction,v))&&this._helper.copy(this._helper.fromXYZ(v,void 0,this._helper.getM(d.pos)),d.pos)}selectArrowFromStartPoint(d){this._selectedArrow=m.isPointInside(this.plane,this._pointToXYZ(d))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(d){return m.signedDistance(this.plane,this._pointToXYZ(d))}clampedStartAndEnd(d){d=this._helper.toXYZ(this._helper.pointToVector(d));const f=m.projectPoint(this._plane,
d,g.create()),v=m.signedDistance(this._plane,d),t=b.clamp(v,this._minDistance,this._maxDistance);h.lerp(d,f,d,t/v);return{start:f,end:d}}apply(d){this._offset(d,this.distance)}undo(d){this._offset(d,0)}canAccumulate(d){return d instanceof n&&this._edge.leftVertex.index===d._edge.leftVertex.index&&this._edge.rightVertex.index===d._edge.rightVertex.index&&this._edge.component===d._edge.component&&this._maybeEqualsVec3(this._left.direction,d._left.direction)&&this._maybeEqualsVec3(this._right.direction,
d._right.direction)&&h.equals(m.getNormal(this._plane),m.getNormal(d._plane))}accumulate(d,f){this._offset(d,this._plane[3]-f._plane[3]+f.distance)}accumulateParams(d){this.distance=d.distance-d._plane[3]+this._plane[3]}clone(){const d=new n(this._helper,this._planeType,this._edge,this.distance,B.DEFERRED);m.copy(d._plane,this._plane);m.copy(d._offsetPlane,this._offsetPlane);d._maxDistance=this._maxDistance;d._minDistance=this._minDistance;d._left=this._cloneNeighbor(this._left);d._right=this._cloneNeighbor(this._right);
d._edgeDirection=h.copy(g.create(),this._edgeDirection);return d}_maybeEqualsVec3(d,f){return null==d&&null==f||null!=d&&null!=f&&h.equals(d,f)}_cloneNeighbor({start:d,end:f,direction:v,isOriginalDirection:t}){return{start:h.copy(g.create(),d),end:null!=f?h.copy(g.create(),f):null,direction:h.copy(g.create(),v),isOriginalDirection:t}}}const w=b.deg2rad(15);a.PlaneType=void 0;(function(d){d[d.XYZ=0]="XYZ";d[d.XY=1]="XY"})(a.PlaneType||(a.PlaneType={}));var B;(function(d){d[d.IMMEDIATE=0]="IMMEDIATE";
d[d.DEFERRED=1]="DEFERRED"})(B||={});a.OffsetEdgeVertex=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../core/arrayUtils","../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,c,l){class h{constructor(g,m,y=l.AccumulationType.CUMULATIVE){this.origin=g;this.angle=m;this._accumulationType=y}_rotate(g,m){c.rotate(g.pos,g.pos,this.origin,m)}apply(g){this._rotate(g,
this.angle)}undo(g){this._rotate(g,-this.angle)}canAccumulate(g){return g instanceof h&&b.equals(this.origin,g.origin)}accumulate(g,m){this._rotate(g,m._accumulationType===l.AccumulationType.REPLACE?m.angle-this.angle:m.angle)}accumulateParams(g){this.angle=g._accumulationType===l.AccumulationType.REPLACE?g.angle:this.angle+g.angle}}a.RotateVertex=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define(["exports",
"../../../../core/arrayUtils","../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,c,l,h){class g{constructor(m,y,q,n,w=h.AccumulationType.CUMULATIVE){this.origin=m;this.axis1=y;this.factor1=q;this.factor2=n;this._accumulationType=w;this.axis2=c.fromValues(y[1],-y[0])}_scale(m,y,q){l.projectAndScale(m.pos,m.pos,this.origin,this.axis1,y);l.projectAndScale(m.pos,m.pos,this.origin,this.axis2,q)}apply(m){this._scale(m,this.factor1,
this.factor2)}undo(m){this._scale(m,1/this.factor1,1/this.factor2)}canAccumulate(m){return m instanceof g&&b.equals(this.origin,m.origin)&&b.equals(this.axis1,m.axis1)}accumulate(m,y){y._accumulationType===h.AccumulationType.REPLACE?this._scale(m,y.factor1/this.factor1,y.factor2/this.factor2):this._scale(m,y.factor1,y.factor2)}accumulateParams(m){const y=m._accumulationType===h.AccumulationType.REPLACE;this.factor1=y?m.factor1:this.factor1*m.factor1;this.factor2=y?m.factor2:this.factor2*m.factor2}}
a.ScaleVertex=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetAllVertexPositions":function(){define(["exports"],function(a){class b{constructor(c,l){this._editGeometry=c;this._newPositions=l}apply(){const c=null==this._originalPositions?"apply":"redo";if(!this._originalPositions){const l=this._editGeometry.coordinateHelper;this._originalPositions=this._editGeometry.allVertices.map(h=>l.clone(h.pos))}this._apply(c,this._newPositions)}undo(){this._originalPositions&&
this._apply("undo",this._originalPositions)}accumulate(c){return c instanceof b?(this._newPositions=c._newPositions,this._apply("apply",this._newPositions),!0):!1}_apply(c,l){const h=this._editGeometry.coordinateHelper,g=this._editGeometry.allVertices;for(let m=0;m<g.length;m++)h.copy(l[m],g[m].pos);this._editGeometry.components.forEach(m=>m.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:c,updatedVertices:g})}}a.SetAllVertexPositions=b;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UndoGroup":function(){define(["exports"],function(a){const b=Symbol();class c{constructor(h){this._operations=[];this._closed=!1;this[l]=!0;h&&(this._operations=h,this._closed=!0)}close(){this._closed=!0}apply(){for(const h of this._operations)h.apply()}undo(){for(let h=this._operations.length-1;0<=h;h--)this._operations[h].undo()}accumulate(h){if(this._closed)return!1;const g=this._operations.length?this._operations[this._operations.length-
1]:null;g&&g.accumulate(h)||(this._operations.push(h),h.apply());return!0}}var l=b;a.UndoGroup=c;a.isUndoGroup=function(h){return b in h};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraintUtils":function(){define("exports ../../../geometry ../../../core/quantityUtils ../../../core/unitUtils ../../../chunks/vec32 ../../../geometry/projection/projectVectorToVector ../../../geometry/support/geodesicUtils ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils ./constraints ./normalizedPoint ../../support/angularMeasurementUtils ../../../geometry/SpatialReference".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d){function f(G,A,x,L){if(null!=x&&null!=G){var S=J(G,L);if(null!=S){x=B.getDegreesGeographic(x);var Q=I=>{if(null!=I){var k=w.createWritable();I=c.createAngle(I,"degrees","geographic");if(B.pointFromDistanceAlongAzimuth(k,S,L.measurementSR,10,I,L.mode))return new n.VerticalHalfPlaneConstraint(S,k)}},R=()=>{if(null!=A&&null!=G)return B.getDegreesGeographic(B.directionBetweenPoints(A,G))};switch(L.directionMode){case B.DirectionMode.Absolute:return Q(x);case B.DirectionMode.Relative:return R=
R(),null==R?void 0:Q(R+x);case B.DirectionMode.RelativeBilateral:return R=R(),null==R?void 0:n.constraintOrSet([Q(R+x),Q(R-x)])}}}}function v(G,A){G=E(G,A)?.value??void 0;return null!=G?new n.HorizontalPlaneConstraint(G):void 0}function t(G,A,x){const {context:L,longitude:S,latitude:Q,direction:R,distance:I,elevation:k}=x;if(null!=S||null!=Q||null!=I||null!=k||null!=R)return null!=S||null!=Q?(G=B.getDegreesGeographic(S),A=B.getDegreesGeographic(Q),x=E(k,L)?.value??void 0,new n.CoordinateConstraint(G,
A,x)):z(G,A,x)}function z(G,A,{context:x,direction:L,distance:S,elevation:Q}){if(null==A)return v(Q,x);const {view:R,elevationInfo:I,measurementSR:k}=x,u=w.fromPoint(A,R,I);if(k&&g.projectVectorToVector(u,A.spatialReference,p,k)){var [C,T]=p,M=null!=S?c.valueInUnit(S,"meters"):void 0;L=B.getDegreesGeographic(L);var N=E(Q,x)?.value??void 0;Q=V=>{const Y=new n.GeodesicConstraint([C,T],k,M,N,V);return null==M||null==V||null==N&&x.hasZ?Y:new n.PointConstraint(Y.closestTo(u))};if(null==L)return Q(void 0);
S=()=>{if(null!=G&&null!=A)return B.getDegreesGeographic(B.directionBetweenPoints(G,A))};switch(x.directionMode){case B.DirectionMode.Absolute:return Q(L);case B.DirectionMode.Relative:return S=S(),null==S?void 0:Q(S+L);case B.DirectionMode.RelativeBilateral:return S=S(),null==S?void 0:n.constraintOrSet([Q(S+L),Q(S-L)])}}}function F({x:G,y:A,elevation:x,context:L}){r.x=G?.value??0;r.y=A?.value??0;r.spatialReference=L.spatialReference;const S=J(r,L,D);return new n.CoordinateConstraint(null!=G&&null!=
S?S[0]:void 0,null!=A&&null!=S?S[1]:void 0,E(x,L)?.value??void 0)}function H(G){let A;for(const x of G)x&&(A=A?.intersect(x)??x);return A}function J(G,A,x=w.createWritable()){const {view:L,elevationInfo:S,measurementSR:Q,origin:R,mode:I}=A;w.fromPoint(G,L,S,x);if(g.projectVectorToVector(x,G.spatialReference,x,Q))return"geodesic"!==I&&h.subtract(x,x,R),x}function E(G,{view:A,origin:x,elevationInfo:L,hasZ:S,measurementSR:Q}){if(null!=G&&S&&(S=l.verticalLengthUnitFromSpatialReference(Q),null!=S)){var [R,
I]=x;G=c.valueInUnit(G,S);A="3d"===A?.type?q.getConvertedElevationFromXYZ(A,R,I,G,Q,L):G;if(null!=A)return c.createLength(A,S)}}const p=w.createWritable(),D=w.createWritable(),e=w.createWritable(),r=y.makeDehydratedPoint(0,0,0,d.WGS84);a.constraintSpaceToPoint=function(G,A,x,L){const {view:S,measurementSR:Q,spatialReference:R,origin:I,mode:k}=x;"geodesic"===k?h.copy(e,G):h.add(e,G,I);if(g.projectVectorToVector(e,Q,e,R))return w.toElevationAlignedDehydratedPoint(e,S,A,x,L)};a.getConstraintContext=
function(G,A,x,L,S,Q){let R="geodesic",I=m.geodesicCompatibleSpatialReference(x);const k=w.createWritable();w.fromPoint(G,A,L,k);k[2]=0;I&&g.projectVectorToVector(k,x,k,I)||(R="euclidean",I=x);return{mode:R,view:A,elevationInfo:L,hasZ:S,directionMode:Q,spatialReference:G.spatialReference,measurementSR:I,origin:k}};a.getGeodesicConstraint=t;a.getPointConstraint=function(G){return"geodesic"===G.context.mode?t(null,null,G):F(G)};a.getPolylineOrPolygonConstraint=function(G,A,x){const {context:L,x:S,y:Q,
distance:R,direction:I,elevation:k}=x;if("geodesic"===L.mode)return t(A,G,x);if(null!=S||null!=Q)return F(x);if(null==R||null==G)x=void 0;else{var u=l.lengthUnitFromSpatialReference(L.measurementSR);null==u?x=void 0:(x=J(G,L),null==x?x=void 0:(u=c.valueInUnit(R,u),x=new n.VerticalCylinderConstraint(x,u)))}return H([x,f(G,A,I,L),v(k,L)])};a.intersectAll=H;a.pointToConstraintSpace=J;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingContext":function(){define(["exports"],
function(a){class b{constructor(c){this.drawConstraints=this.selfSnappingZ=this.visualizer=this.excludeFeature=this.vertexHandle=null;this.editGeometryOperations=c.editGeometryOperations;this.elevationInfo=c.elevationInfo;this.pointer=c.pointer;this.vertexHandle=c.vertexHandle;this.excludeFeature=c.excludeFeature;this.feature=c.feature;this.visualizer=c.visualizer;this.selfSnappingZ=c.selfSnappingZ;this.drawConstraints=c.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}
a.SnappingContext=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDragPipelineStep":function(){define("exports ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../layers/graphics/dehydratedFeatureComparison ../../../layers/graphics/hydratedFeatures ../../../support/elevationInfoUtils ../dragEventPipeline ./SnappingContext ../../support/Scheduler".split(" "),function(a,b,c,l,h,g,m,y,q,n){function w(H,J,E){return c.debounce(async({frameTask:p,
point:D,scenePoint:e,context:r,event:G,delta:A,getLastState:x},L)=>{const S=await p.schedule(()=>H.snap({point:D,scenePoint:e,context:r,signal:L}),L);S.valid&&(p=await p.schedule(()=>S.apply(),L),x=x(),null!=x.point&&D!==x.point&&(p=H.update({point:x.point,scenePoint:x.scenePoint,context:r})),null!=x.updatePoint&&h.pointEquals(p,x.updatePoint)||(t(G.mapEnd,p,A,J),E.execute(G)))})}function B(H){return"3d"===H.type?H.resourceController.scheduler.registerTask(n.TaskPriority.SNAPPING):n.ImmediateTask}
function d(H,J,E){return{context:new q.SnappingContext({editGeometryOperations:H.editGeometryOperations,elevationInfo:H.elevationInfo,pointer:H.pointer,vertexHandle:null!=J.info?J.info.handle:null,excludeFeature:H.excludeFeature,feature:H.feature,visualizer:H.visualizer}),originalPos:null!=J.snapOrigin?H.coordinateHelper.vectorToDehydratedPoint(J.snapOrigin):J.mapStart,originalScenePos:null!=J.scenePoints?J.scenePoints.sceneStart:null,frameTask:E}}function f(H,[J,E,p]){H=g.clonePoint(H);H.x+=J;H.y+=
E;H.hasZ&&(H.z+=p);return H}function v(H,J){return[H.x-J.x,H.y-J.y,H.hasZ&&J.hasZ?H.z-J.z:0]}function t(H,J,[E,p,D],e){H.x=J.x+E;H.y=J.y+p;e&&H.hasZ&&J.hasZ&&(H.z=J.z+D)}function z(H,J){if(!H.hasZ())return null;var E=J.vertices;J=null;for(const p of E){E=H.getZ(p.pos);if(null!=J&&null!=E&&1E-6<Math.abs(E-J))return null;null==J&&(J=E)}return J}function F(H){return H}a.createSnapDragEventPipelineStep=function({predicate:H=()=>!0,snappingManager:J,snappingContext:E,updatingHandles:p,useZ:D=!0}){const e=
new y.EventPipeline;if(null==J)return{snappingStep:[F,e],cancelSnapping:F};let r=null,G=null,A,x=null;const L=()=>{r=b.abortMaybe(r);J.doneSnapping();G?.frameTask.remove();G=null;A=b.removeMaybe(A);x=null},S=w(J,D,e);let Q=null,R=null,I=null;return{snappingStep:[k=>{if(!H(k))return k;const {action:u}=k;if("start"===u){var {info:C}=k;const M=B(J.view);G=d(E,k,M);G.context.selfSnappingZ=null;D||null==C||(C=z(E.coordinateHelper,C.handle.component),null!=C&&(G.context.selfSnappingZ={value:C,elevationInfo:E.elevationInfo??
m.absoluteHeightElevationInfo}))}if(null!=G){const {context:M,originalScenePos:N,originalPos:V}=G,{mapEnd:Y,mapStart:ea,scenePoints:Z}=k,ia=f(V,v(Y,ea)),oa=v(ea,V),ra={...k,action:"update"},na=G.context;var T=null==N||null==Z?null:f(N,v(Z.sceneEnd,Z.sceneStart));I=C=J.update({point:ia,scenePoint:T,context:M});t(Y,C,oa,D);Q=ia;R=T;if("end"!==u){const {frameTask:za}=G;null==r&&(r=new AbortController);x=Aa=>{p.addPromise(c.ignoreAbortErrors(S({frameTask:za,event:ra,context:na,point:ia,scenePoint:T,delta:oa,
getLastState:()=>({point:Q,scenePoint:R,updatePoint:Aa.forceUpdate?null:I})},r.signal)))};x({forceUpdate:!1});null==A&&(A=l.watch(()=>J.options.effectiveEnabled,()=>x?.({forceUpdate:!0})))}}"end"===u&&L();return k},e],cancelSnapping:k=>{L();return k}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v){function t(A){return z.has(A)?z.get(A):"number"===typeof A?A:1}a.TaskPriority=void 0;(function(A){A.RESOURCE_CONTROLLER_IMMEDIATE="immediate";A.RESOURCE_CONTROLLER="schedule";A.SLIDE="slide";A.STREAM_DATA_LOADER="stream loader";A.ELEVATION_QUERY="elevation query";A.TERRAIN_SURFACE="terrain";A.SURFACE_GEOMETRY_UPDATES="surface geometry updates";A.LOD_RENDERER="LoD renderer";A.GRAPHICS_CORE="Graphics3D";A.I3S_CONTROLLER="I3S";A.POINT_CLOUD_LAYER="point cloud";
A.FEATURE_TILE_FETCHER="feature fetcher";A.OVERLAY="overlay";A.STAGE="stage";A.GRAPHICS_DECONFLICTOR="graphics deconflictor";A.FILTER_VISIBILITY="Graphics3D filter visibility";A.SCALE_VISIBILITY="Graphics3D scale visibility";A.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";A.POINT_OF_INTEREST_FREQUENT="POI frequent";A.POINT_OF_INTEREST_INFREQUENT="POI infrequent";A.LABELER="labeler";A.FEATURE_QUERY_ENGINE="feature query";A.FEATURE_TILE_TREE="feature tile tree";A.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
A.ELEVATION_ALIGNMENT="elevation alignment";A.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";A.TEXT_TEXTURE_ATLAS="text texture atlas";A.TEXTURE_UNLOAD="texture unload";A.LINE_OF_SIGHT_TOOL="line of sight tool";A.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";A.ELEVATION_PROFILE="elevation profile";A.SNAPPING="snapping";A.SHADOW_ACCUMULATOR="shadow accumulator";A.CLOUDS_GENERATOR="clouds generator";A.MAPVIEW_FETCH_QUEUE="mapview fetch queue";A.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update";
A.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue";A[A.NONE=0]="NONE";A[A.TEST_PRIO=1]="TEST_PRIO"})(a.TaskPriority||(a.TaskPriority={}));const z=new Map([[a.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[a.TaskPriority.RESOURCE_CONTROLLER,4],[a.TaskPriority.SLIDE,0],[a.TaskPriority.STREAM_DATA_LOADER,0],[a.TaskPriority.ELEVATION_QUERY,0],[a.TaskPriority.TERRAIN_SURFACE,1],[a.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[a.TaskPriority.LOD_RENDERER,2],[a.TaskPriority.GRAPHICS_CORE,
2],[a.TaskPriority.I3S_CONTROLLER,2],[a.TaskPriority.POINT_CLOUD_LAYER,2],[a.TaskPriority.FEATURE_TILE_FETCHER,2],[a.TaskPriority.CLOUDS_GENERATOR,2],[a.TaskPriority.OVERLAY,4],[a.TaskPriority.STAGE,4],[a.TaskPriority.GRAPHICS_DECONFLICTOR,4],[a.TaskPriority.FILTER_VISIBILITY,4],[a.TaskPriority.SCALE_VISIBILITY,4],[a.TaskPriority.FRUSTUM_VISIBILITY,4],[a.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[a.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[a.TaskPriority.LABELER,8],[a.TaskPriority.FEATURE_QUERY_ENGINE,
8],[a.TaskPriority.FEATURE_TILE_TREE,16],[a.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[a.TaskPriority.ELEVATION_ALIGNMENT,12],[a.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[a.TaskPriority.TEXT_TEXTURE_ATLAS,12],[a.TaskPriority.TEXTURE_UNLOAD,12],[a.TaskPriority.LINE_OF_SIGHT_TOOL,16],[a.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[a.TaskPriority.SNAPPING,0],[a.TaskPriority.SHADOW_ACCUMULATOR,30],[a.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[a.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[a.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,
0]]),F=w.Milliseconds(6.5),H=w.Milliseconds(1),J=w.Milliseconds(30),E=w.Milliseconds(1E3/30),p=w.Milliseconds(100);var D;(function(A){class x{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(Q=>Q.needsUpdate)}constructor(){this._updating=n.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new g("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new S;this._state=f.RenderState.INTERACTING;this._tasks=
new m;this._runQueue=new m;this._load=0;this._idleStateCallbacks=new m;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=q.watch(()=>d.SCHEDULER_LOG_SLOW_TASKS,Q=>this._debug=Q,q.initial);for(const Q of Object.keys(a.TaskPriority))this.performanceInfo.tasks.set(a.TaskPriority[Q],new g(a.TaskPriority[Q]))}destroy(){this._tasks.toArray().forEach(Q=>Q.remove());this._tasks.clear();h.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(Q){this._updatingChanged();
Q&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(Q,R){R=new L(this,Q,R);this._tasks.push(R);this._updatingChanged();this.performanceInfo.tasks.has(Q)||this.performanceInfo.tasks.set(Q,new g(Q));return R}registerIdleStateCallbacks(Q,R){const I={idleBegin:Q,idleEnd:R};this._idleStateCallbacks.push(I);this.state===f.RenderState.IDLE&&
this._idleUpdatesStartFired&&I.idleBegin();const k=this;return{remove:()=>this._removeIdleStateCallbacks(I),set idleBegin(u){k._idleUpdatesStartFired&&(I.idleEnd(),k._state===f.RenderState.IDLE&&u());I.idleBegin=u},set idleEnd(u){I.idleEnd=u}}}get load(){return this._load}set state(Q){this._state!==Q&&(this._state=Q,this.state!==f.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(R=>R.idleEnd())))}get state(){return this._state}updateBudget(Q){this._test&&
(this._test.usedBudget=0);++this._frameNumber;let R=F,I=Q.frameDuration,k=H;switch(this.state){case f.RenderState.IDLE:R=w.Milliseconds(0);I=w.Milliseconds(Math.max(p,Q.frameDuration));k=J;break;case f.RenderState.INTERACTING:I=w.Milliseconds(Math.max(E,Q.frameDuration))}I=w.Milliseconds(I-Q.elapsedFrameTime-R);if(this.state!==f.RenderState.IDLE&&I<H&&!this._forceTask)return this._forceTask=!0,!1;I=w.Milliseconds(Math.max(I,k));this._budget.reset(I,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=
this._forceTask=!1;switch(this.state){case f.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(Q=>Q.idleBegin()));this._runIdle();break;case f.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(w.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(Q){this._idleUpdatesStartFired&&Q.idleEnd();
this._idleStateCallbacks.removeUnordered(Q)}removeTask(Q){this._tasks.removeUnordered(Q);this._runQueue.removeUnordered(Q);this._updatingChanged()}_updateTask(Q){this._tasks.forAll(R=>{R.name===Q&&R.setPriority(Q)})}_getState(Q){if(this._runQueue.some(I=>I.name===Q))return a.TaskState.SCHEDULED;let R=a.TaskState.IDLE;this._tasks.forAll(I=>{I.name===Q&&I.needsUpdate&&(1>=I.schedulePriority?R=a.TaskState.READY:R!==a.TaskState.READY&&(R=a.TaskState.WAITING))});return R}_getRuntime(Q){let R=0;this._tasks.forAll(I=>
{I.name===Q&&(R+=I.runtime)});return R}_resetRuntimes(){this._tasks.forAll(Q=>Q.runtime=0)}_getRunning(){const Q=new Map;this._tasks.forAll(I=>{I.needsUpdate&&Q.set(I.name,(Q.get(I.name)||0)+1)});if(0===Q.size)return null;let R="";Q.forEach((I,k)=>{R=1<I?R+` ${I}x ${k}`:R+` ${k}`});return R}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const Q=this._tasks.reduce((R,I)=>I.needsUpdate?++R:R,0);this._load=.9*this._load+Q*(1-.9)}_schedule(){this._runQueue.filterInPlace(Q=>
{if(Q.needsUpdate)return!0;Q.schedulePriority=Q.basePriority;return!1});for(this._tasks.forAll(Q=>{0===Q.basePriority&&Q.needsUpdate&&!this._runQueue.includes(Q)&&Q.blockFrame!==this._frameNumber&&this._runQueue.unshift(Q)});0===this._runQueue.length;){let Q=!1;this._tasks.forAll(R=>{if(R.needsUpdate&&0!==R.schedulePriority&&0!==R.basePriority&&R.blockFrame!==this._frameNumber)switch(Q=!0,R.schedulePriority){case 1:R.schedulePriority=0;this._runQueue.push(R);break;default:--R.schedulePriority}});
if(!Q)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const Q=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var R=this._budget.now();const I=this._runQueue.pop();this._budget.resetProgress();try{I.task.runTask(this._budget)===v.Yield&&(I.blockFrame=this._frameNumber)}catch(k){l.getLogger("esri.views.support.Scheduler").error(`Exception in task "${I.name}"`,k),I.blockFrame=this._frameNumber}!this._budget.hasProgressed&&I.blockFrame!==this._frameNumber&&
I.needsUpdate&&(I.blockFrame=this._frameNumber);I.schedulePriority=I.basePriority;R=this._budget.now()-R;I.runtime+=R;this._frameTaskTimes.set(I.priority,this._frameTaskTimes.get(I.priority)+R);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-Q);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-Q)}_startFrameTaskTimes(){for(const Q of Object.keys(a.TaskPriority))this._frameTaskTimes.set(a.TaskPriority[Q],
0)}_recordFrameTaskTimes(Q){this._frameTaskTimes.forEach((R,I)=>this.performanceInfo.tasks.get(I).push(R));this.performanceInfo.total.push(Q)}get test(){return this._test}}A.Scheduler=x;class L{get task(){return this._task.value}get updating(){return this._queue.running}constructor(Q,R,I){this._scheduler=Q;this.name=R;this.runtime=this.blockFrame=0;this._queue=new B.PromiseQueue;this._handles=new b;this.schedulePriority=this._basePriority=t(R);this._task=n.signal(null!=I?I:this._queue);this._handles.add(q.when(()=>
this.task.running,k=>Q.taskRunningChanged(k)))}remove(){this.processQueue(e);this._scheduler.removeTask(this);this.schedule=G.schedule;this.reschedule=G.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(Q){if(this.name!==Q){this.name=Q;Q=t(Q);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=Q;this._basePriority=Q}}get priority(){return this.name}set priority(Q){this.setPriority(Q)}get needsUpdate(){return this.updating||this.task.running}schedule(Q,
R,I){return this._queue.push(Q,R,I)}reschedule(Q,R,I){return this._queue.unshift(Q,R,I)}processQueue(Q){return this._queue.runTask(Q)}}class S{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=f.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(Q){if(this.done)return!1;!0===Q()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(Q){this._enabled=Q}reset(Q,R){this._begin=this.now();this._budget=Q;this._state=R;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}A.Budget=S})(D||={});a.TaskState=void 0;(function(A){A.SCHEDULED=
"s";A.READY="r";A.WAITING="w";A.IDLE="i"})(a.TaskState||(a.TaskState={}));const e=(()=>{const A=new D.Budget;A.enabled=!1;return A})();class r{remove(){}processQueue(){}schedule(A,x,L){try{if(y.isAborted(x)){const S=y.createAbortError();return L?Promise.resolve(L(S)):Promise.reject(S)}return y.when(A(e))}catch(S){return Promise.reject(S)}}reschedule(A,x,L){return this.schedule(A,x,L)}}const G=new r;a.ImmediateTask=G;a.getTaskPriority=t;a.newScheduler=function(){return new D.Scheduler};a.noBudget=
e;a.taskPriorities=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(a,b,c,l){class h{constructor(){this._tasks=[];this._runningTasks=c.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(m){if(0===this.length)return l.Yield;for(;!m.done&&this._process(m);)m.madeProgress()}push(m,
y,q){++this._runningTasks.value;return(new Promise((n,w)=>this._tasks.push(new g(n,w,m,y,q)))).finally(()=>--this._runningTasks.value)}unshift(m,y,q){++this._runningTasks.value;return(new Promise((n,w)=>this._tasks.unshift(new g(n,w,m,y,q)))).finally(()=>--this._runningTasks.value)}_process(m){if(0===this._tasks.length)return!1;const y=this._tasks.shift();try{const q=b.isAborted(y.signal);if(q&&!y.abortCallback)y.reject(b.createAbortError());else{const n=q?y.abortCallback?.(b.createAbortError()):
y.callback(m);b.isPromiseLike(n)?n.then(y.resolve,y.reject):y.resolve(n)}}catch(q){y.reject(q)}return!0}cancelAll(){const m=b.createAbortError();for(const y of this._tasks)if(y.abortCallback){const q=y.abortCallback(m);y.resolve(q)}else y.reject(m);this._tasks.length=0}}class g{constructor(m,y,q,n,w){this.resolve=m;this.reject=y;this.callback=q;this.signal=n;this.abortCallback=w}}a.PromiseQueue=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/Yield":function(){define(["exports"],
function(a){const b=Symbol("Yield");a.Yield=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,c,l,h,g,m){b=class extends b{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=this.SCHEDULER_LOG_SLOW_TASKS=
!1}};a.__decorate([c.property()],b.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);a.__decorate([c.property()],b.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);b=a.__decorate([m.subclass("esri.views.support.debugFlags")],b);return new b})},"esri/views/support/RenderState":function(){define(["exports"],function(a){a.RenderState=void 0;var b=a.RenderState||(a.RenderState={});b[b.ANIMATING=0]="ANIMATING";b[b.INTERACTING=1]="INTERACTING";b[b.IDLE=2]="IDLE";Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOperation":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),function(a,b,c,l,h,g,m,y,q,n,w){a.SnappingOperation=class extends c{constructor(B){super(B);
this.constrainResult=d=>d;this._stagedPoint=this._abortController=this._frameTask=this._snapPoints=null;this._snap=h.debounce(async(d,f,v,t)=>{const z=this._frameTask;if(null!=z){var F=await z.schedule(()=>f.snap({...d,context:v,signal:t}),t);F.valid&&await z.schedule(()=>{this.stagedPoint=F.apply();d!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=f.update({...this._snapPoints,context:v}))},t)}})}get stagedPoint(){return this._stagedPoint}set stagedPoint(B){this._stagedPoint=this.constrainResult(B)}initialize(){const B=
"3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=B?B.registerTask(w.TaskPriority.SNAPPING):w.ImmediateTask}destroy(){this._abortController=l.abortMaybe(this._abortController);this._frameTask=l.removeMaybe(this._frameTask)}update(B,d,f){this._snapPoints=B;const {point:v,scenePoint:t}=B;return this.stagedPoint=B=d.update({point:v,scenePoint:t,context:f})}async snap(B,d,f){const {point:v,scenePoint:t}=B;this.stagedPoint=d.update({point:v,scenePoint:t,context:f});
this._snapPoints=B;null==this._abortController&&(this._abortController=new AbortController);return this._snap(B,d,f,this._abortController.signal)}async snapAgainNearPreviousMapPoint(B,d){null!=this._snapPoints&&await this.snap(this._snapPoints,B,d)}abort(){this._abortController=l.abortMaybe(this._abortController);this._snapPoints=null}};b.__decorate([g.property({constructOnly:!0})],a.SnappingOperation.prototype,"view",void 0);b.__decorate([g.property()],a.SnappingOperation.prototype,"stagedPoint",
null);b.__decorate([g.property()],a.SnappingOperation.prototype,"constrainResult",void 0);b.__decorate([g.property()],a.SnappingOperation.prototype,"_stagedPoint",void 0);a.SnappingOperation=b.__decorate([n.subclass("esri.views.interactive.snapping.SnappingOperation")],a.SnappingOperation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/drawSurfaces":function(){define("exports ../../geometry ../../core/screenUtils ../../layers/graphics/dehydratedPoint ../../layers/graphics/hydratedFeatures ../../support/elevationInfoUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,b,c,l,h,g,m,y){class q{constructor(d,f,v,t=null){this._elevationInfo=d;this.defaultZ=f;this._view=v;this._excludeGraphics=t}screenToMap(d){const {defaultZ:f,_view:v}=this;d=v.sceneIntersectionHelper.intersectElevationFromScreen(c.createScreenPointArray(d.x,d.y),this._elevationInfo,f??0,this._excludeGraphics);null==f&&null!=d&&(d.z=void 0);return d}mapToScreen(d){d=l.makeDehydratedPoint(d.x,d.y,g.getConvertedElevation(this._view,d,this._elevationInfo),d.spatialReference);return this._view.toScreen(d)}constrainZ(d){const {defaultZ:f}=
this;null!=f&&d.z!==f&&(d=h.clonePoint(d),d.z=f);return d}}class n{constructor(d,f,v=[]){this.view=d;this.elevationInfo=f;this.exclude=v}screenToMap(d){d=this.view.toMap(d,{exclude:this.exclude,excludeLabels:!0});null!=d&&(d.z=g.getZForElevationMode(d,this.view,this.elevationInfo));return d}mapToScreen(d){let f=d;null!=this.elevationInfo&&(f=l.makeDehydratedPoint(d.x,d.y,g.getConvertedElevation(this.view,d,this.elevationInfo),d.spatialReference));return this.view.toScreen(f)}constrainZ(d){return d}}
class w{constructor(d,f=!1,v=0){this.view=d;this.hasZ=f;this.defaultZ=v;this.mapToScreen=t=>d.toScreen(t);this.screenToMap=f?t=>{t=d.toMap(t);t.z=v;return t}:t=>d.toMap(t)}constrainZ(d){const {defaultZ:f}=this;this.hasZ&&d.z!==f&&(d=h.clonePoint(d),d.z=f);return d}}class B{screenToMap(d){const {x:f,y:v}=d;return new y({x:f,y:v,spatialReference:B.spatialReference})}mapToScreen(d){return c.createScreenPoint(d.x,d.y)}constrainZ(d){return d}}B.spatialReference=new m;a.ElevationDrawSurface=q;a.MapDrawSurface=
w;a.SceneDrawSurface=n;a.ScreenDrawSurface=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/createUtils":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils ./surfaceCoordinateSystems ../../../geometry/Point ../../../geometry/Multipoint ../../../geometry/Polyline ../../../geometry/Polygon".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t){function z(e,r){r=new d({x:e[0],y:e[1],spatialReference:r});2<e.length&&(r.z=e[2]);return r}function F(e,r,G,A=!0){e=l.clone(e);e.forEach(x=>{c.equals(x[0],x[x.length-1])&&1!==x.length||x.push(x[0])});e=new t({rings:e,spatialReference:r});e.rings.forEach(x=>{n.isClockwise(x)||x.reverse()});G&&n.unnormalizeGeometryOnDatelineCrossing(e);A&&e.isSelfIntersecting&&w.isValid(r)&&(e=q.simplify(e));return e}function H(e,r,G){const A=J(r[3],r[2],G),x=J(r[1],r[2],G),
L=J(r[0],r[1],G);r=J(r[0],r[3],G);return{geometry:e,midpoints:null!=A&&null!=x&&null!=L&&null!=r?{top:A,right:x,bottom:L,left:r}:null}}function J(e,r,G){p[0]=e.x;p[1]=e.y;p[2]=0;D[0]=r.x;D[1]=r.y;D[2]=0;g.lerp(p,p,D,.5);E.x=p[0];E.y=D[1];E.z=D[2];e=G.localToMap(E);return null!=e?z(e,G.spatialReference):null}const E=B.makeSurfacePoint(0,0,0),p=m.create(),D=m.create();a.createCircle=function(e,r,G,A){var x=r.mapToLocalMultiple(e),L=e=null;G?(e=x[0],L=x[1]):(e=x[0],G=x[1],L=Math.round(G.x-e.x),G=Math.round(G.y-
e.y),x=Math.max(Math.abs(L),Math.abs(G)),e=B.makeSurfacePoint(0<L?e.x+x/2:e.x-x/2,0<G?e.y+x/2:e.y-x/2),L=B.makeSurfacePoint(Math.abs(L)>Math.abs(G)?e.x-x/2:e.x,Math.abs(L)>Math.abs(G)?e.y:e.y-x/2));G=r.localToMap(e);x=r.localToMap(L);if(null==G||null==x)return null;r.doUnnormalization&&n.unnormalizeVerticesOnDatelineCrossing([[G,x]],r.spatialReference);G=z(G,r.spatialReference);x=z(x,r.spatialReference);const S=h.getMetersPerUnitForSR(r.spatialReference);var Q=0;w.isValid(r.spatialReference)?Q=S*
q.distance(G,x,null):(Q=e.x-L.x,e=e.y-L.y,Q=S*Math.sqrt(Q*Q+e*e)*(A||1));r=new y({center:G,radius:Q,radiusUnit:"meters",spatialReference:r.spatialReference});return{geometry:F(r.rings,r.spatialReference,!1),center:G,edge:x}};a.createEllipse=function(e,r,G){function A(C){return B.makeSurfacePoint(Q*Math.cos(C)+S.x,R*Math.sin(C)+S.y)}var x=r.mapToLocalMultiple(e);e=x[0];var L=x[1];x=Math.round(L.x-e.x);L=Math.round(L.y-e.y);const S=B.makeSurfacePoint(G?e.x:e.x+x/2,G?e.y:e.y+L/2),Q=G?x:x/2,R=G?L:L/2;
G=[];e=2*Math.PI/60;for(x=0;60>x;x++)G.push(A(x*e));G.push(G[0]);const {spatialReference:I,doUnnormalization:k}=r;G=F([G.map(C=>r.localToMap(C)).filter(c.isSome)],I,k,!1);e=r.localToMap(A(Math.PI/2));x=r.localToMap(A(0));L=r.localToMap(A(-Math.PI/2));const u=r.localToMap(A(Math.PI));return{geometry:G,midpoints:null!=e&&null!=x&&null!=L&&null!=u?{top:z(e,I),right:z(x,I),bottom:z(L,I),left:z(u,I)}:null}};a.createMultipoint=function(e,r){return new f({points:e,spatialReference:r})};a.createPoint=z;a.createPolygon=
F;a.createPolyline=function(e,r,G){e=new v({paths:e,spatialReference:r});G&&n.unnormalizeGeometryOnDatelineCrossing(e);return e};a.createRectangle=function(e,r,G){var A=r.mapToLocalMultiple(e);1===A.length&&(e=A[0],A=[B.makeSurfacePoint(e.x-48,e.y+48),B.makeSurfacePoint(e.x+48,e.y-48),B.makeSurfacePoint(e.x+48,e.y-48),B.makeSurfacePoint(e.x-48,e.y+48)]);e=[];var x=A[0].x,L=A[0].y,S=A[1].x;A=A[1].y;if(G){G=Math.round(S-x);const Q=Math.round(A-L);e.push(B.makeSurfacePoint(x-G,L-Q),B.makeSurfacePoint(S,
L-Q),B.makeSurfacePoint(S,A),B.makeSurfacePoint(x-G,A))}else e.push(B.makeSurfacePoint(x,L),B.makeSurfacePoint(S,L),B.makeSurfacePoint(S,A),B.makeSurfacePoint(x,A));G=F([e.map(Q=>r.localToMap(Q)).filter(c.isSome)],r.spatialReference,r.doUnnormalization,!0);return H(G,e,r)};a.createSquare=function(e,r,G){var A=r.mapToLocalMultiple(e);e=[];var x=A[0].x,L=A[0].y,S=Math.round(A[1].x-x);const Q=Math.round(A[1].y-L);A=Math.max(Math.abs(S),Math.abs(Q));G?(G=x+A,S=L+A,x-=A,L-=A,e.push(B.makeSurfacePoint(G,
L),B.makeSurfacePoint(x,L),B.makeSurfacePoint(x,S),B.makeSurfacePoint(G,S))):(G=0<S?x+A:x-A,A=0<Q?L+A:L-A,e.push(B.makeSurfacePoint(x,L),B.makeSurfacePoint(G,L),B.makeSurfacePoint(G,A),B.makeSurfacePoint(x,A)));L=F([e.map(R=>r.localToMap(R)).filter(c.isSome)],r.spatialReference,r.doUnnormalization,!0);return H(L,e,r)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./SpatialReference ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f){var v;l=v=class extends n{constructor(t){super(t);this.center=null;this.geodesic=!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}initialize(){var t=this.center;const z=this.numberOfPoints;this.hasZ=t?.hasZ??!1;if(0===this.rings.length&&t){var F=b.convertUnit(this.radius,this.radiusUnit,"meters"),H=t.spatialReference,J="geographic";if(H.isWebMercator)J="webMercator";else if(null!=(H.wkid&&f[H.wkid])||(H.wkt2||H.wkt)&&b.isProjectedWKT(H.wkt2||
H.wkt))J="projected";if(this.geodesic){let E;switch(J){case "webMercator":E=d.webMercatorToGeographic(t);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":E=t}t=this._createGeodesicCircle(E,F,z);"webMercator"===J&&(t=d.geographicToWebMercator(t))}else{let E;"webMercator"===J||"projected"===J?E=F/b.getMetersPerUnit(t.spatialReference):"geographic"===J&&(E=b.lengthToDegrees(F,
"meters",y.getReferenceEllipsoid(t.spatialReference).radius));t=this._createPlanarCircle(t,E,z)}this.spatialReference=t.spatialReference;this.addRing(t.rings[0])}}clone(){const {center:t,numberOfPoints:z,radius:F,radiusUnit:H,geodesic:J}=this;return new v({center:t?.clone(),numberOfPoints:z,radius:F,radiusUnit:H,geodesic:J})}_createGeodesicCircle(t,z,F){let H=0;const J=[];for(;360>H;){const E=[0,0];B.directGeodeticSolver(E,[t.x,t.y],H,z,w.WGS84);this.hasZ&&E.push(t.z);J.push(E);H+=360/F}J.push(J[0]);
return new n({rings:[J]})}_createPlanarCircle(t,z,F){const H=[],J=2*Math.PI/F;for(let p=0;p<F;++p){var E=J*p;E=[t.x+Math.cos(-E)*z,t.y+Math.sin(-E)*z];this.hasZ&&E.push(t.z);H.push(E)}H.push(H[0]);return new n({spatialReference:t.spatialReference,rings:[H]})}};a.__decorate([c.property({type:q})],l.prototype,"center",void 0);a.__decorate([c.property()],l.prototype,"geodesic",void 0);a.__decorate([c.property()],l.prototype,"numberOfPoints",void 0);a.__decorate([c.property()],l.prototype,"radius",void 0);
a.__decorate([c.property()],l.prototype,"radiusUnit",void 0);return l=v=a.__decorate([m.subclass("esri.geometry.Circle")],l)})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/libs/gl-matrix-2/math/mat2d ../../../core/libs/gl-matrix-2/factories/mat2df64 ../../../core/libs/gl-matrix-2/math/quat ../../../core/libs/gl-matrix-2/factories/quatf64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/Axis ../../../geometry/Point".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){function B(z,F,H=null){return null!=H?[z,F,H]:[z,F]}function d(z,F,H=null){return null!=H?{x:z,y:F,z:H}:{x:z,y:F}}class f{constructor(z){this.spatialReference=z}mapToLocalMultiple(z){return z.map(F=>this.mapToLocal(F)).filter(c.isSome)}get doUnnormalization(){return!1}}class v extends f{constructor(z,F,H=null){super(F);this._defaultZ=H;this.transform=h.create();this.transformInv=h.create();this.transform=h.clone(z);l.invert(this.transformInv,this.transform)}makeMapPoint(z,
F){return B(z,F,this._defaultZ)}mapToLocal(z){return d(this.transform[0]*z[0]+this.transform[2]*z[1]+this.transform[4],this.transform[1]*z[0]+this.transform[3]*z[1]+this.transform[5])}localToMap(z){return B(this.transformInv[0]*z.x+this.transformInv[2]*z.y+this.transformInv[4],this.transformInv[1]*z.x+this.transformInv[3]*z.y+this.transformInv[5],this._defaultZ)}}class t extends f{constructor(z,F){super(z.spatialReference);this.view=z;this.defaultZ=null;this.pWS=q.create();this.tangentFrameUpWS=q.create();
this.tangentFrameRightWS=q.create();this.tangentFrameForwardWS=q.create();this.localFrameRightWS=q.create();this.localFrameUpWS=q.create();this.worldToLocalTransform=m.create();this.localToWorldTransform=m.create();this.scale=1;this.scale=z.resolution;this.referenceMapPoint=F;this.defaultZ=F.hasZ?F.z:null;z=z.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n.Axis.X,this.tangentFrameRightWS);
this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n.Axis.Y,this.tangentFrameUpWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n.Axis.Z,this.tangentFrameForwardWS);F=q.create();y.scale(F,this.tangentFrameForwardWS,y.dot(z,this.tangentFrameForwardWS));y.subtract(this.localFrameRightWS,z,F);y.normalize(this.localFrameRightWS,this.localFrameRightWS);y.cross(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS);g.rotationTo(this.worldToLocalTransform,this.localFrameRightWS,
this.tangentFrameRightWS);g.invert(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(z,F){return B(z,F,this.defaultZ)}mapToLocal(z){const F=q.create();this.view.renderCoordsHelper.toRenderCoords(new w({x:z[0],y:z[1],spatialReference:this.spatialReference}),F);y.transformQuat(F,F,this.worldToLocalTransform);z=this.view.renderCoordsHelper.fromRenderCoords(F,new w({spatialReference:this.view.spatialReference}));return null!=
z?d(z.x/this.scale,z.y/this.scale):null}localToMap(z){const F=q.create();this.view.renderCoordsHelper.toRenderCoords(new w({x:z.x*this.scale,y:z.y*this.scale,spatialReference:this.spatialReference}),F);y.transformQuat(F,F,this.localToWorldTransform);z=this.view.renderCoordsHelper.fromRenderCoords(F,new w({spatialReference:this.view.spatialReference}));return null!=z?B(z.x,z.y,this.defaultZ):null}}a.AffineCoordinateSystem=v;a.SceneViewCoordinateSystem=t;a.SurfaceCoordinateSystem=f;a.createViewAlignedCoordinateSystem=
function(z,F){return"2d"===z.type?new v(z.state.transform,z.spatialReference,2<F.length?F[2]:null):"3d"===z.type?(F=2<F.length?new w({x:F[0],y:F[1],z:F[2],spatialReference:z.spatialReference}):new w({x:F[0],y:F[1],spatialReference:z.spatialReference}),new t(z,F)):null};a.makeMapPoint=B;a.makeSurfacePoint=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(a,b){function c(e,r){e[0]=r[0];e[1]=r[1];
e[2]=r[2];e[3]=r[3];e[4]=r[4];e[5]=r[5];return e}function l(e){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=0;e[5]=0;return e}function h(e,r,G,A,x,L,S){e[0]=r;e[1]=G;e[2]=A;e[3]=x;e[4]=L;e[5]=S;return e}function g(e,r){const G=r[0],A=r[1],x=r[2],L=r[3],S=r[4];r=r[5];let Q=G*L-A*x;if(!Q)return null;Q=1/Q;e[0]=L*Q;e[1]=-A*Q;e[2]=-x*Q;e[3]=G*Q;e[4]=(x*r-L*S)*Q;e[5]=(A*S-G*r)*Q;return e}function m(e){return e[0]*e[3]-e[1]*e[2]}function y(e,r,G){const A=r[0],x=r[1],L=r[2],S=r[3],Q=r[4];r=r[5];const R=G[0],I=G[1],
k=G[2],u=G[3],C=G[4];G=G[5];e[0]=A*R+L*I;e[1]=x*R+S*I;e[2]=A*k+L*u;e[3]=x*k+S*u;e[4]=A*C+L*G+Q;e[5]=x*C+S*G+r;return e}function q(e,r,G){const A=r[0],x=r[1],L=r[2],S=r[3],Q=r[4];r=r[5];const R=Math.sin(G);G=Math.cos(G);e[0]=A*G+L*R;e[1]=x*G+S*R;e[2]=A*-R+L*G;e[3]=x*-R+S*G;e[4]=Q;e[5]=r;return e}function n(e,r,G){const A=r[1],x=r[2],L=r[3],S=r[4],Q=r[5],R=G[0];G=G[1];e[0]=r[0]*R;e[1]=A*R;e[2]=x*G;e[3]=L*G;e[4]=S;e[5]=Q;return e}function w(e,r,G){const A=r[0],x=r[1],L=r[2],S=r[3],Q=r[4];r=r[5];const R=
G[0];G=G[1];e[0]=A;e[1]=x;e[2]=L;e[3]=S;e[4]=A*R+L*G+Q;e[5]=x*R+S*G+r;return e}function B(e,r){const G=Math.sin(r);r=Math.cos(r);e[0]=r;e[1]=G;e[2]=-G;e[3]=r;e[4]=0;e[5]=0;return e}function d(e,r){e[0]=r[0];e[1]=0;e[2]=0;e[3]=r[1];e[4]=0;e[5]=0;return e}function f(e,r){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=r[0];e[5]=r[1];return e}function v(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function t(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function z(e,
r,G){e[0]=r[0]+G[0];e[1]=r[1]+G[1];e[2]=r[2]+G[2];e[3]=r[3]+G[3];e[4]=r[4]+G[4];e[5]=r[5]+G[5];return e}function F(e,r,G){e[0]=r[0]-G[0];e[1]=r[1]-G[1];e[2]=r[2]-G[2];e[3]=r[3]-G[3];e[4]=r[4]-G[4];e[5]=r[5]-G[5];return e}function H(e,r,G){e[0]=r[0]*G;e[1]=r[1]*G;e[2]=r[2]*G;e[3]=r[3]*G;e[4]=r[4]*G;e[5]=r[5]*G;return e}function J(e,r,G,A){e[0]=r[0]+G[0]*A;e[1]=r[1]+G[1]*A;e[2]=r[2]+G[2]*A;e[3]=r[3]+G[3]*A;e[4]=r[4]+G[4]*A;e[5]=r[5]+G[5]*A;return e}function E(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===
r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]}function p(e,r){const G=e[0],A=e[1],x=e[2],L=e[3],S=e[4];e=e[5];const Q=r[0],R=r[1],I=r[2],k=r[3],u=r[4];r=r[5];const C=b.getEpsilon();return Math.abs(G-Q)<=C*Math.max(1,Math.abs(G),Math.abs(Q))&&Math.abs(A-R)<=C*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(x-I)<=C*Math.max(1,Math.abs(x),Math.abs(I))&&Math.abs(L-k)<=C*Math.max(1,Math.abs(L),Math.abs(k))&&Math.abs(S-u)<=C*Math.max(1,Math.abs(S),Math.abs(u))&&Math.abs(e-r)<=C*Math.max(1,Math.abs(e),Math.abs(r))}
const D=Object.freeze(Object.defineProperty({__proto__:null,add:z,copy:c,determinant:m,equals:p,exactEquals:E,frob:t,fromRotation:B,fromScaling:d,fromTranslation:f,identity:l,invert:g,mul:y,multiply:y,multiplyScalar:H,multiplyScalarAndAdd:J,rotate:q,scale:n,set:h,str:v,sub:F,subtract:F,translate:w},Symbol.toStringTag,{value:"Module"}));a.add=z;a.copy=c;a.determinant=m;a.equals=p;a.exactEquals=E;a.frob=t;a.fromRotation=B;a.fromScaling=d;a.fromTranslation=f;a.identity=l;a.invert=g;a.mat2d=D;a.mul=y;
a.multiply=y;a.multiplyScalar=H;a.multiplyScalarAndAdd=J;a.rotate=q;a.scale=n;a.set=h;a.str=v;a.sub=F;a.subtract=F;a.translate=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/Logger ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./interfaces ./ManipulatorCollection".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){a.InteractiveToolBase=class extends c{constructor(B){super(B);this.manipulators=new w.ManipulatorCollection;this.automaticManipulatorSelection=!0;this.hasHoveredManipulators=this.hasGrabbedManipulators=!1;this.firstGrabbedManipulator=null;this.created=!1;this.removeIncompleteOnCancel=!0;this._editableFlags=new Map([[n.EditableFlag.MANAGER,!0],[n.EditableFlag.USER,!0]]);this._creationFinishedResolver=g.createResolver()}get active(){return null!=this.view&&this.view.activeTool===
this}set visible(B){this._get("visible")!==B&&(this._set("visible",B),this._syncVisible())}get editable(){return this.getEditableFlag(n.EditableFlag.USER)}set editable(B){this.setEditableFlag(n.EditableFlag.USER,B)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy();this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(B){this.onInputEvent(B)}handleInputEventAfter(B){this.onInputEventAfter(B)}setEditableFlag(B,
d){this._editableFlags.set(B,d);this.manipulators.isToolEditable=this.internallyEditable;this._updateManipulatorAttachment();B===n.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange();this.onManipulatorSelectionChanged()}getEditableFlag(B){return this._editableFlags.get(B)??!1}endDrag(){const B=this.view.inputManager.latestPointerLocation;if(B){var d=!1;this.manipulators.forEach(({manipulator:f})=>{f.dragging&&(d=!0,f.events.emit("drag",{action:"end",start:B,screenPoint:B}))});
d&&(this.view.toolViewManager.activeTool=null)}}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(B){}onInputEventAfter(B){}get internallyEditable(){return this.getEditableFlag(n.EditableFlag.USER)&&this.getEditableFlag(n.EditableFlag.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this);this._set("created",!0)}_syncVisible(){this.initialized&&
(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))}_show(){this._updateManipulatorAttachment();this.onShow()}_hide(){this._updateManipulatorAttachment();this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};b.__decorate([m.property({constructOnly:!0})],a.InteractiveToolBase.prototype,"view",void 0);b.__decorate([m.property({readOnly:!0})],a.InteractiveToolBase.prototype,"active",null);b.__decorate([m.property({value:!0})],
a.InteractiveToolBase.prototype,"visible",null);b.__decorate([m.property({value:!0})],a.InteractiveToolBase.prototype,"editable",null);b.__decorate([m.property({readOnly:!0})],a.InteractiveToolBase.prototype,"manipulators",void 0);b.__decorate([m.property({readOnly:!0})],a.InteractiveToolBase.prototype,"updating",null);b.__decorate([m.property()],a.InteractiveToolBase.prototype,"cursor",null);b.__decorate([m.property({readOnly:!0})],a.InteractiveToolBase.prototype,"automaticManipulatorSelection",
void 0);b.__decorate([m.property()],a.InteractiveToolBase.prototype,"hasFocusedManipulators",null);b.__decorate([m.property()],a.InteractiveToolBase.prototype,"hasGrabbedManipulators",void 0);b.__decorate([m.property()],a.InteractiveToolBase.prototype,"hasHoveredManipulators",void 0);b.__decorate([m.property()],a.InteractiveToolBase.prototype,"firstGrabbedManipulator",void 0);b.__decorate([m.property({readOnly:!0})],a.InteractiveToolBase.prototype,"created",void 0);b.__decorate([m.property({readOnly:!0})],
a.InteractiveToolBase.prototype,"removeIncompleteOnCancel",void 0);a.InteractiveToolBase=b.__decorate([q.subclass("esri.views.interactive.InteractiveToolBase")],a.InteractiveToolBase);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../core/Collection"],function(a,b){a.ManipulatorVisibilityPredicate=void 0;(function(l){l[l.WhenToolEditable=0]="WhenToolEditable";l[l.WhenToolNotEditable=1]="WhenToolNotEditable";
l[l.Always=2]="Always"})(a.ManipulatorVisibilityPredicate||(a.ManipulatorVisibilityPredicate={}));class c{constructor(){this._isToolEditable=!0;this._manipulators=new b;this._resourceContexts={manipulator3D:{}};this._attached=!1}set isToolEditable(l){this._isToolEditable=l}get length(){return this._manipulators.length}add(l,h=a.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([l],h)}addMany(l,h=a.ManipulatorVisibilityPredicate.WhenToolEditable){for(const g of l)l={manipulator:g,visibilityPredicate:h,
attached:!1},this._manipulators.add(l),this._attached&&this._updateManipulatorAttachment(l)}remove(l){for(let h=0;h<this._manipulators.length;h++)if(this._manipulators.at(h).manipulator===l){l=this._manipulators.splice(h,1)[0];this._detachManipulator(l);break}}removeAll(){this._manipulators.forEach(l=>{this._detachManipulator(l)});this._manipulators.removeAll()}attach(){this._manipulators.forEach(l=>{this._updateManipulatorAttachment(l)});this._attached=!0}detach(){this._manipulators.forEach(l=>{this._detachManipulator(l)});
this._attached=!1}destroy(){this.detach();this._manipulators.forEach(({manipulator:l})=>l.destroy());this._manipulators.destroy();this._resourceContexts=null}on(l,h){return this._manipulators.on(l,g=>{h(g)})}forEach(l){for(const h of this._manipulators.items)l(h)}some(l){return this._manipulators.items.some(l)}toArray(){const l=[];this.forEach(h=>l.push(h.manipulator));return l}intersect(l,h){let g=null,m=Number.MAX_VALUE;this._manipulators.forEach(({manipulator:y,attached:q})=>{q&&y.interactive&&
(q=y.intersectionDistance(l,h),null!=q&&q<m&&(m=q,g=y))});return g}_updateManipulatorAttachment(l){this._isManipulatorItemVisible(l)?this._attachManipulator(l):this._detachManipulator(l)}_attachManipulator(l){l.attached||(l.manipulator.attach&&l.manipulator.attach(this._resourceContexts),l.attached=!0)}_detachManipulator(l){if(l.attached){var h=l.manipulator;h.grabbing=!1;h.dragging=!1;h.hovering=!1;h.selected=!1;h.detach&&h.detach(this._resourceContexts);l.attached=!1}}_isManipulatorItemVisible(l){return l.visibilityPredicate===
a.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?l.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolEditable:l.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolNotEditable}}a.ManipulatorCollection=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/overlay/OutlineOverlayItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/aaBoundingRect ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(a,b,c,l,h,g,m,y,q,n){b=class extends b{constructor(w){super(w);this.coordinates=void 0;this.strokeDash=[];this.strokeWidth=1;this.strokeColor=[0,0,0,1];this.strokeDashColor=[255,255,255,1];this.fillColor=[0,0,0,0];this.isDecoration=this.visible=!0}get _strokeStyle(){const w=this.strokeColor;return`rgba(${w[0]}, ${w[1]}, ${w[2]}, ${w[3]})`}get _strokeBackgroundStyle(){const w=this.strokeDashColor;return`rgba(${w[0]}, ${w[1]}, ${w[2]}, ${w[3]})`}get _fillStyle(){const w=this.fillColor;return`rgba(${w[0]}, ${w[1]}, ${w[2]}, ${w[3]})`}get _renderCoordinates(){const w=
[];if(!this.coordinates)return{coordinates:w,rect:y.negativeInfinity};const B=y.pad(y.expandWithNestedArray(y.create(y.negativeInfinity),this.coordinates),2*this.strokeWidth);B[0]=Math.floor(B[0]);B[1]=Math.floor(B[1]);B[2]=Math.ceil(B[2]+.5);B[3]=Math.ceil(B[3]+.5);for(const d of this.coordinates)w.push([Math.floor(d[0]-B[0])+.5,Math.floor(d[1]-B[1])+.5]);w.reverse();return{coordinates:w,rect:B}}render(){const {coordinates:w,rect:B}=this._renderCoordinates,d=y.width(B),f=y.height(B);return n.tsx("div",
{classes:{"esri-outline-overlay-item":!0},styles:{left:B[0]+"px",top:B[1]+"px",width:d+"px",height:f+"px",visibility:this.visible?"visible":"hidden"}},n.tsx("svg",{height:f,styles:{display:"block"},width:d},n.tsx("polygon",{fill:this._fillStyle,points:w.map(([v,t])=>`${v},${t}`).join(" "),stroke:this._strokeBackgroundStyle,"stroke-width":this.strokeWidth}),n.tsx("polygon",{fill:"transparent",points:w.map(([v,t])=>`${v},${t}`).join(" "),stroke:this._strokeStyle,"stroke-dasharray":this.strokeDash.length?
this.strokeDash.join(" "):void 0,"stroke-width":this.strokeWidth})))}renderCanvas(){}};a.__decorate([c.property()],b.prototype,"coordinates",void 0);a.__decorate([c.property()],b.prototype,"strokeDash",void 0);a.__decorate([c.property()],b.prototype,"strokeWidth",void 0);a.__decorate([c.property()],b.prototype,"strokeColor",void 0);a.__decorate([c.property()],b.prototype,"strokeDashColor",void 0);a.__decorate([c.property()],b.prototype,"fillColor",void 0);a.__decorate([c.property()],b.prototype,"visible",
void 0);a.__decorate([c.property()],b.prototype,"isDecoration",void 0);a.__decorate([c.property({readOnly:!0})],b.prototype,"_strokeStyle",null);a.__decorate([c.property({readOnly:!0})],b.prototype,"_strokeBackgroundStyle",null);a.__decorate([c.property({readOnly:!0})],b.prototype,"_fillStyle",null);a.__decorate([c.property({readOnly:!0})],b.prototype,"_renderCoordinates",null);return b=a.__decorate([m.subclass("esri.views.overlay.OutlineOverlayItem")],b)})},"esri/widgets/support/Selector2D/selectorUtils":function(){define("require exports ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../renderers/support/clickToleranceUtils ../../../views/support/drapedUtils ../../../views/support/layerViewUtils".split(" "),
function(a,b,c,l,h,g,m,y){async function q(){return new Promise((p,D)=>a(["../../../geometry/geometryEngineJSON"],p,D))}async function n(){return q().then(({contains:p,intersects:D,overlaps:e,simplify:r})=>({contains:p,intersects:D,overlaps:e,simplify:r}))}function w(p){const D=[];for(let e=0;e<p.length;e++){const r=p[e];"fulfilled"===r.status&&D.push(...r.value)}return D}function B(p){const D=[],e=[],r=[];p.forEach(G=>{h.isFeatureLayer(G)?D.push(G):(h.isKnowledgeGraphLayer(G)||h.isLinkChartLayer(G))&&
G.layers?.length?D.push(...G.layers.toArray()):h.isMapNotesLayer(G)&&G.sublayers?.length?r.push(...G.sublayers.toArray()):h.isGraphicsLayer(G)?r.push(G):y.isSelectableLayerView2D(G)&&e.push(G)});return{layers:D,layerViews:e,graphicsLayers:r}}function d(p,D){if(p.includes(D))return!0;const e=D.getObjectId(),{layer:r,uid:G}=D;return null!=e?p.some(A=>{if(r===A.layer)return e===A.getObjectId()}):p.some(A=>{if(r===A.layer)return G===A.uid})}async function f(p){const {layerViews:D,selector:e,signal:r,
view:G}=p;return c.whenOrAbort(Promise.allSettled(D.map(async A=>{const x=A.createQuery(),{geometry:L}=t(e,A.layer,G);x.outFields=["*"];x.geometry=L;x.returnGeometry=!0;x.outSpatialReference=G.spatialReference;return A.queryFeatures(x,{signal:r}).then(({features:S})=>S)})),r)}async function v(p){const {layers:D,selector:e,signal:r,view:G}=p;return c.whenOrAbort(Promise.allSettled(D.map(async A=>A.queryFeatures(z(A.createQuery(),e,A,G),{signal:r}).then(({features:x})=>x))),r)}function t(p,D,e){const r=
l.getDisplayFieldName({displayField:"displayField"in D?D.displayField:null,fields:D.fields}),G=[D.objectIdField];null!=r&&D.fieldsIndex.has(r)&&G.push(r);D="renderer"in D?g.calculateTolerance({renderer:D.renderer}):0;return{geometry:"point"===p.type?m.createQueryGeometry(p,D,e):p,outFields:G}}function z(p,D,e,r){const {outFields:G,geometry:A}=t(D,e,r);p.outFields=G;p.geometry=A;p.returnGeometry=!0;p.outSpatialReference=r.spatialReference;return p}async function F(p){const {selector:D,candidates:e,
view:r}=p;if(!e?.length||!D)return[];const {spatialReference:G}=r,A=await n();return e.filter(x=>A.intersects(G,D,x.geometry))}const H=async(p,D,e)=>{D=D.flatMap(r=>r.graphics.toArray())??[];return F({candidates:D,selector:p,view:e})},J=async(p,D,e,r)=>(p=await c.ignoreAbortErrors(v({selector:p,signal:r,layers:D,view:e})))?w(p):[],E=async(p,D,e,r)=>(p=await c.ignoreAbortErrors(f({selector:p,signal:r,layerViews:D,view:e})))?w(p):[];b.getGeometryEngineOperations=n;b.getQueryOptionsFromLayer=t;b.getSelectionFromFeatureLayerViews=
f;b.getSelectionFromFeatureLayers=v;b.getSelectionFromGeometry=async function(p){const {currentSelection:D,selector:e,signal:r,sources:G,view:A}=p;if(!G?.length)return{added:[],removed:[]};const {layers:x,layerViews:L,graphicsLayers:S}=B(G),Q=(await c.whenOrAbort(Promise.all([J(e,x,A,r),E(e,L,A,r),H(e,S,A)]),r)).flat();if(!D)return{added:Q,removed:[]};const R=D.toArray();p=Q.filter(k=>!d(R,k));const I=R.filter(k=>!d(Q,k));D.removeMany(I);D.addMany(p);return{added:p,removed:I}};b.getSelectionFromGeometryEngine=
F;b.importGeometryEngine=q;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(h,g){return g?"xoffset"in g&&g.xoffset?Math.max(h,Math.abs(g.xoffset)):"yoffset"in g&&g.yoffset?Math.max(h,Math.abs(g.yoffset||0)):h:h}function c(h,g){if("number"===typeof h)return h;if(h?.stops?.length){h=h.stops;let m=g=0;for(let y=0;y<h.length;y++){const q=h[y].size;"number"===typeof q&&(g+=q,m++)}return g/m}return g}
function l(h,g){if(!g)return h;g=g.filter(q=>"size"===q.type).map(q=>{const {maxSize:n,minSize:w}=q;return(c(n,h)+c(w,h))/2});let m=0;const y=g.length;if(0===y)return h;for(let q=0;q<y;q++)m+=g[q];return Math.max(Math.floor(m/y),h)}a.calculateTolerance=function(h){const g=h?.renderer;h="touch"===h?.pointerType?9:6;if(!g)return h;h="visualVariables"in g?l(h,g.visualVariables):h;if("simple"===g.type)return b(h,g.symbol);if("unique-value"===g.type){let m=h;g.uniqueValueInfos?.forEach(y=>{m=b(m,y.symbol)});
return m}if("class-breaks"===g.type){let m=h;g.classBreakInfos.forEach(y=>{m=b(m,y.symbol)});return m}return h};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils","../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,b,c,l,h){function g(y,q,n,w=new h){let B=0;if("2d"===n.type)B=q*(n.resolution??0);else if("3d"===n.type){var d=n.overlayPixelSizeInMapUnits(y),
f=n.basemapSpatialReference;B=null==f||f.equals(n.spatialReference)?q*d:c.getMetersPerUnitForSR(f)/c.getMetersPerUnitForSR(n.spatialReference)}q=y.x-B;d=y.y-B;f=y.x+B;y=y.y+B;({spatialReference:n}=n);w.xmin=Math.min(q,f);w.ymin=Math.min(d,y);w.xmax=Math.max(q,f);w.ymax=Math.max(d,y);w.spatialReference=n;return w}const m=new h;a.createQueryGeometry=g;a.intersectsDrapedGeometry=function(y,q,n){y=n.toMap(y);if(null==y)return!1;const w=l.calculateTolerance();return g(y,w,n,m).intersects(q)};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../views/interactive/sketch/SketchOptions ../../views/interactive/tooltip/components/directionModeIcons ../Widget ../../chunks/componentsUtils ./globalCss ./LabeledSwitch ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SketchTooltipControls/VisibleElements".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z){h=class extends n{constructor(F,H){super(F,H);this.viewModel=null;this.visibleElements=new z;this.sketchOptions=new y;this.viewType=void 0;this._onTooltipsEnabledChange=J=>{this.sketchOptions.tooltips.enabled=J};this._onLabelsEnabledChange=J=>{this.sketchOptions.labels.enabled=J};this._onDirectionModeChange=J=>{this.sketchOptions.values.directionMode=J.target.selectedItem.value}}loadDependencies(){return Promise.all([w.loadCalciteComponents({block:()=>new Promise((F,
H)=>a(["../../chunks/calcite-block"],F,H)),label:()=>new Promise((F,H)=>a(["../../chunks/calcite-label"],F,H)),icon:()=>new Promise((F,H)=>a(["../../chunks/calcite-icon"],F,H)),"radio-button":()=>new Promise((F,H)=>a(["../../chunks/calcite-radio-button"],F,H)),"radio-button-group":()=>new Promise((F,H)=>a(["../../chunks/calcite-radio-button-group"],F,H))}),d.loadLabeledSwitchComponents()])}render(){const {label:F,visibleElements:H}=this,J=this._renderContent();return t.tsx("div",{"aria-label":F,class:this.classes("esri-sketch-tooltip-controls",
B.globalCss.widget)},J?t.tsx("calcite-block",{class:"esri-sketch-tooltip-controls__block",heading:H.header?this.label:"",key:"content-block",open:!0},t.tsx("div",{class:"esri-sketch-tooltip-controls__block-content",key:"content"},J)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(F){this._overrideIfSome("label",F)}_renderContent(){const {visibleElements:F,viewType:H}=this,J=[F.tooltipsToggle?this._renderTooltipsToggle():null,F.labelsToggle&&"2d"!==H?this._renderLabelsToggle():
null,F.directionModePicker?this._renderDirectionModePicker():null].filter(c.isSome);return 0===J.length?null:J}_renderTooltipsToggle(){const {messages:F,sketchOptions:H}=this;return t.tsx(d.LabeledSwitch,{checked:H.tooltips.effectiveEnabled,hint:F.tooltipsToggleHint,key:`${this.id}__tooltips`,label:F.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const {messages:F,sketchOptions:H}=this;return t.tsx(d.LabeledSwitch,{checked:H.labels.enabled,hint:F.labelsToggleHint,key:`${this.id}__labels`,
label:F.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const {messages:F,sketchOptions:H}=this,{directionMode:J}=H.values;return t.tsx("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},F.directionModePicker,t.tsx("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:J,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",J,F.directionModeRelative),this._renderDirectionModeOption("absolute",
J,F.directionModeAbsolute)))}_renderDirectionModeOption(F,H,J){return t.tsx("calcite-label",{key:F,layout:"inline",scale:"s"},t.tsx("calcite-radio-button",{checked:F===H,scale:"s",value:F}),t.tsx("div",{class:"esri-sketch-tooltip-controls__radio-button-label-wrapper",key:"label-wrapper"},t.tsx("calcite-icon",{icon:q.directionModeIcons[F],scale:"s"}),J))}};b.__decorate([l.property()],h.prototype,"label",null);b.__decorate([l.property({type:z,nonNullable:!0})],h.prototype,"visibleElements",void 0);
b.__decorate([l.property(),v.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],h.prototype,"messages",void 0);b.__decorate([l.property({nonNullable:!0,type:y})],h.prototype,"sketchOptions",void 0);b.__decorate([l.property({type:String})],h.prototype,"viewType",void 0);return h=b.__decorate([m.subclass("esri.widgets.support.SketchTooltipControls")],h)})},"esri/views/interactive/tooltip/components/directionModeIcons":function(){define(["exports"],function(a){a.directionModeIcons=
{absolute:"absolute-direction",relative:"relative-direction"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/LabeledSwitch":function(){define(["require","exports","../../chunks/componentsUtils","./widgetUtils","./jsxFactory"],function(a,b,c,l,h){b.LabeledSwitch=function({checked:g,disabled:m,hint:y,key:q,label:n,onChange:w,hintIcon:B,hintKind:d}){return h.tsx("calcite-label",{class:"esri-labeled-switch__label",disabled:m,key:q,layout:"inline-space-between",scale:"s"},
h.tsx("div",{class:"esri-labeled-switch__label-content",key:"label-content"},y?h.tsx(h.tsxFragment,null,h.tsx("div",null,n),h.tsx("calcite-icon",{class:"warning"!==d?"esri-labeled-switch__icon_info":"esri-labeled-switch__icon_warning",icon:B??"information",id:q,scale:"s",tabIndex:0}),h.tsx("calcite-tooltip",{class:"esri-labeled-switch__tooltip",referenceElement:q},y)):n),h.tsx("calcite-switch",{checked:g,disabled:m,scale:"s",onCalciteSwitchChange:f=>w(f.target.checked)}))};b.loadLabeledSwitchComponents=
()=>c.loadCalciteComponents({icon:()=>new Promise((g,m)=>a(["../../chunks/calcite-icon"],g,m)),label:()=>new Promise((g,m)=>a(["../../chunks/calcite-label"],g,m)),switch:()=>new Promise((g,m)=>a(["../../chunks/calcite-switch"],g,m)),tooltip:()=>new Promise((g,m)=>a(["../../chunks/calcite-tooltip"],g,m))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,c,l,h,g,m){b=class extends b{constructor(y){super(y);this.header=this.directionModePicker=!1;this.tooltipsToggle=this.labelsToggle=!0}};a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"directionModePicker",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"labelsToggle",void 0);a.__decorate([c.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",
void 0);return b=a.__decorate([m.subclass("esri.widgets.support.SketchTooltipControls.VisibleElements")],b)})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/asyncUtils ../../core/maybe ../../core/reactiveUtils ../../core/uid ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../Widget ../../chunks/componentsUtils ./globalCss ./LabeledSwitch ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel ./SnappingControls/snappingLayerListUtils ./SnappingControls/VisibleElements".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J,E){q=class extends B{constructor(p,D){super(p,D);this._gridLoadTask=this._layerListFilter=this._defaultViewModel=null;this.layerListOpen=!0;this.gridOptionsOpen=!1;this.snappingManager=this.messagesCommon=this.messages=null;this.visibleElements=new E;this._enableSnappingSwitchChange=A=>{this.snappingOptions.enabled=A};this._featureEnabledSwitchChange=A=>{this.snappingOptions.featureEnabled=A};this._gridEnabledSwitchChange=A=>{(this.snappingOptions.gridEnabled=
A)&&this._startLoadGrid()};this._selfEnabledSwitchChange=A=>{this.snappingOptions.selfEnabled=A};this._onToggleLayersButtonClick=A=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled);t.setFocus(A.target)};const {snappingOptions:e,view:r,viewModel:G}=p;this.viewModel=G??(this._defaultViewModel=new H({snappingOptions:e,view:r}))}normalizeCtorArgs(p){const {snappingOptions:D,view:e,viewModel:r,...G}=p;return G}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=
h.destroyMaybe(this._defaultViewModel))}loadDependencies(){return Promise.all([d.loadCalciteComponents({block:()=>new Promise((p,D)=>a(["../../chunks/calcite-block"],p,D)),button:()=>new Promise((p,D)=>a(["../../chunks/calcite-button"],p,D)),input:()=>new Promise((p,D)=>a(["../../chunks/calcite-input"],p,D)),list:()=>new Promise((p,D)=>a(["../../chunks/calcite-list"],p,D)),"list-item":()=>new Promise((p,D)=>a(["../../chunks/calcite-list-item"],p,D)),checkbox:()=>new Promise((p,D)=>a(["../../chunks/calcite-checkbox"],
p,D)),loader:()=>new Promise((p,D)=>a(["../../chunks/calcite-loader"],p,D))}),v.loadLabeledSwitchComponents()])}initialize(){this.addHandles(g.watch(()=>"2d"===this.view?.type&&!!this.view.grid,p=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=p)}))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(p){this._overrideIfSome("icon",p)}get label(){return this.messages?.widgetLabel??
""}set label(p){this._overrideIfSome("label",p)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(p){this.viewModel.snappingOptions=p}get view(){return this.viewModel.view}set view(p){this.viewModel.view=p}set viewModel(p){if(p!==this._get("viewModel")){if(null==this._defaultViewModel||this._defaultViewModel!==p)this._defaultViewModel=h.destroyMaybe(this._defaultViewModel);this._set("viewModel",p)}}render(){const {label:p}=this;return F.tsx("div",{"aria-label":p,class:this.classes("esri-snapping-controls",
f.globalCss.widget)},F.tsx("div",{class:"esri-snapping-controls__container"},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),"2d"===this.view?.type&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const {visibleElements:p,view:D}=this;var e=[p.selfEnabledToggle?this._renderSelfEnabledToggle():null,p.featureEnabledToggle?this._renderFeatureEnabledToggle():null,p.gridEnabledToggle&&"2d"===D?.type?this._renderGridEnabledToggle():
null].filter(c.isSome);e=[p.enabledToggle?this._renderEnabledToggle():null,0<e.length?F.tsx("div",{class:"esri-snapping-controls__nested-container"},e):null].filter(c.isSome);return 0===e.length?null:F.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",heading:p.header?this.label:"",key:"toggle-block",open:!0},e)}_renderEnabledToggle(){return F.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,
onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return F.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return F.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,
label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return F.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const {messages:p,viewModel:D}=this;var e=({target:{value:G}})=>{this._layerListFilter=""===G?null:new RegExp(G,
"i")};e=9<D.layerListViewModel.operationalItems.length?F.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:p?.searchLayers,onCalciteInputInput:e}):null;const r=this._secondaryElementsDisabled;return F.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:this._secondaryElementsDisabled,heading:p.snappingLayers,key:"list-block",open:this.layerListOpen&&!r,onCalciteBlockToggle:G=>this.layerListOpen=G.target.open},
e,this._renderToggleLayersButton(),F.tsx("calcite-list",{class:"esri-snapping-controls__layer-list",selectionMode:"none"},this._renderLayerListItemCollection(D.layerListViewModel.operationalItems)))}_renderGridOptions(){const {view:p,visibleElements:D,snappingManager:e,snappingOptions:r,_openAndReady:G}=this,{gridEnabled:A,enabled:x}=r;(G||"2d"===p?.type&&p.grid)&&this._startLoadGrid();var L=this._gridLoadTask?.value;L=L&&"2d"===p?.type&&F.tsx(L,{snappingManager:e,snappingOptions:r,view:p,visibleElements:D.gridControlsElements});
return F.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:!A||!x,heading:this.messages.gridOptionsHeading,key:"grid-block",open:G,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},L??F.tsx("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&"2d"===this.view?.type&&(this._gridLoadTask=
l.createTask(async()=>(await new Promise((p,D)=>a(["./GridControls"],e=>p(Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}))),D))).default))}_renderLayerListItemCollection(p){const D=this._layerListFilter;return p.map(e=>{switch(D?J.itemTitleMatchesFilter(e,D):null){case "children":const r=e.children.filter(G=>!1!==J.itemTitleMatchesFilter(G,D));return this._renderLayerListItemGroup(e,r);case "self":case null:return this._renderLayerListItemOrGroup(e);
case !1:return"self"===J.itemTitleMatchesFilter(e.parent,D)?this._renderLayerListItemOrGroup(e):null}}).toArray().filter(c.isSome)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:p},messages:D}=this,e=p?D.disableAllLayers:D.enableAllLayers;return F.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:e,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},e)}_renderLayerListItemOrGroup(p){if(p.children.length)return this._renderLayerListItemGroup(p);
const {messages:{untitledLayer:D}}=this,e=()=>{this.viewModel.toggleSnappingForLayers([p.layer.id],"enabled"!==p.enabled)};return F.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:`${this.id}-list-item-${p.uid}`,label:p.title||D,onCalciteListItemSelect:r=>{r.stopPropagation();e()}},F.tsx("calcite-checkbox",{checked:"enabled"===p.enabled,slot:"actions-start",onCalciteCheckboxChange:e}))}_renderLayerListItemGroup(p,D){const {children:e,title:r}=p,G=r||this.messages.untitledLayer,
A=r&&""!==r?r:m.generateUID(),x=D??e,L=()=>{this.viewModel.toggleSnappingForLayers(p.childLayerIds,"enabled"!==p.enabled)};return F.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__group",key:A,label:G,open:!!D?.length,onCalciteListItemSelect:S=>{S.stopPropagation();L()}},F.tsx("calcite-checkbox",{checked:"enabled"===p.enabled,indeterminate:"indeterminate"===p.enabled,slot:"actions-start",onCalciteCheckboxChange:L}),F.tsx("calcite-list",null,this._renderLayerListItemCollection(x)))}get _enabledToggleDisabled(){const p=
this.snappingOptions;return p.enabledToggled||p.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};b.__decorate([y.property()],q.prototype,"_defaultViewModel",void 0);b.__decorate([y.property()],q.prototype,"_layerListFilter",void 0);b.__decorate([y.property()],q.prototype,"_gridLoadTask",void 0);b.__decorate([y.property()],q.prototype,"_openAndReady",null);b.__decorate([y.property()],q.prototype,"label",null);b.__decorate([y.property({type:Boolean,
nonNullable:!0})],q.prototype,"layerListOpen",void 0);b.__decorate([y.property({type:Boolean,nonNullable:!0})],q.prototype,"gridOptionsOpen",void 0);b.__decorate([y.property(),z.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],q.prototype,"messages",void 0);b.__decorate([y.property(),z.messageBundle("esri/t9n/common")],q.prototype,"messagesCommon",void 0);b.__decorate([y.property()],q.prototype,"snappingOptions",null);b.__decorate([y.property()],q.prototype,"snappingManager",
void 0);b.__decorate([y.property()],q.prototype,"view",null);b.__decorate([y.property()],q.prototype,"viewModel",null);b.__decorate([y.property({type:E,nonNullable:!0})],q.prototype,"visibleElements",void 0);b.__decorate([y.property()],q.prototype,"_enabledToggleDisabled",null);b.__decorate([y.property()],q.prototype,"_secondaryElementsDisabled",null);return q=b.__decorate([w.subclass("esri.widgets.support.SnappingControls")],q)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../../views/interactive/snapping/SnappingOptions ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d){b=class extends b{constructor(f){super(f);this.layerListViewModel=new d.SnappingLayerListViewModel;this.snappingOptions=new w;this.view=null}initialize(){this.addHandles([l.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:f,view:v})=>{f.view=v},l.initial),l.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:f,sources:v})=>{f.featureSnappingSources=v},l.initial)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??
[]).every(f=>"enabled"===f.enabled)}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(f=>!f.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(f=>"enabled"===f.enabled).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(f,v){f?.forEach(t=>v?this.enableSnappingForLayer(t):this.disableSnappingForLayer(t))}toggleSnappingForAllLayers(f){this.layerListViewModel.selectableItems.forEach(({layer:{id:v}})=>
{f?this.enableSnappingForLayer(v):this.disableSnappingForLayer(v)})}enableSnappingForLayer(f){if(f=this._findSnappingSourceForLayer(f)??this._makeSnappingSourceForLayer(f))f.enabled=!0}disableSnappingForLayer(f){if(f=this._findSnappingSourceForLayer(f))f.enabled=!1}updateEnabledFeatureSources(f){for(const v of this.snappingOptions.featureSources)B.canDisplayLayer(v.layer)&&(v.enabled=f.includes(v.layer.id))}_findSnappingSourceForLayer(f){return this.snappingOptions.featureSources.find(v=>v.layer.id===
f)}_makeSnappingSourceForLayer(f){var v=this.layerListViewModel.operationalItemsFlat.find(t=>t.layer.id===f)?.layer;if(!v)throw new c("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${f} because no such layer was found in the view`);if("group"!==v.type)return v=new n({layer:v}),this.snappingOptions.featureSources.add(v),v}};a.__decorate([h.property()],b.prototype,"allLayersEnabled",null);a.__decorate([h.property()],b.prototype,"allLayersDisabled",null);a.__decorate([h.property({constructOnly:!0})],
b.prototype,"layerListViewModel",void 0);a.__decorate([h.property()],b.prototype,"layersEnabledCount",null);a.__decorate([h.property({type:w,nonNullable:!0})],b.prototype,"snappingOptions",void 0);a.__decorate([h.property()],b.prototype,"state",null);a.__decorate([h.property()],b.prototype,"view",void 0);return b=a.__decorate([q.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],b)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(a){function b(q){return q?.listMode??
void 0}function c(q){return null!=q&&"minScale"in q&&null!=q.minScale?q.minScale:void 0}function l(q){return null!=q&&"maxScale"in q&&null!=q.maxScale?q.maxScale:void 0}function h(q){if(q&&!("type"in q&&"wmts"===q.type))return"sublayers"in q?"sublayers":"layers"in q?"layers":void 0}function g(q,n){q?.sort((w,B)=>{w="uid"in w?n.indexOf(w.uid):-1;B="uid"in B?n.indexOf(B.uid):-1;return w>B?-1:w<B?1:0})}function m(q){return null!=q&&"layer"in q&&null!=q.layer}function y(q){return q&&"capabilities"in q&&
null!=q.capabilities&&"exportMap"in q.capabilities?q.capabilities.exportMap:void 0}a.areChildrenHidden=function(q){return"hide-children"===q?.listMode};a.canDisplayLayer=function(q){return"hide"!==b(q)};a.canSortSublayers=function(q){q=(q?.layer&&m(q.layer)?q.layer.layer:void 0)??q?.layer;if(!q)return!1;"catalog"===q.type?q=!1:(q=y(q),q=(null!=q&&"supportsDynamicLayers"in q?q.supportsDynamicLayers:void 0)??!0);return q};a.findLayerListMode=b;a.findLayerMaxScale=l;a.findLayerMinScale=c;a.findLayerVisibilityMode=
function(q){if(!q)return"inherited";var n=m(q)?q.layer:q;n=y(n);n=null!=n&&"supportsSublayerVisibility"in n?n.supportsSublayerVisibility:void 0;return null!=n?n?"independent":"inherited":"visibilityMode"in q&&null!=q.visibilityMode?q.visibilityMode:"independent"};a.getItem=function(q){return q?.["data-item"]};a.getItemLayers=function(q){return(q=q?.layer)&&"layers"in q?q.layers:null};a.getLayerType=function(q){return q?.getAttribute("data-layer-type")};a.getNormalizedChildLayerProperty=h;a.getSingleAction=
function(q){for(const n of q)for(const w of n)if("button"===w.type||"toggle"===w.type)return w};a.getStatusIcon=function({connectionStatus:q,publishing:n}){return q?"connected"===q?"beacon":"offline":n?"square":"bullet-point"};a.getVisibilityIcon=function({exclusive:q,visible:n,visibilityAppearance:w}){w="checkbox"===w;return n?q?"circle-f":w?"check-square-f":"view-visible":q?"circle":w?"square":"view-hide"};a.isLayerOutsideScaleRange=function(q,n){if(!q||null==n||isNaN(n))return!1;var w=c(q);q=l(q);
w=null!=w&&!isNaN(w)&&0<w&&n>w;n=null!=q&&!isNaN(q)&&0<q&&n<q;return w||n};a.isSublayer=m;a.listItemHasChildren=function({children:q,error:n,incompatible:w}){return!!q?.filter(B=>!B.hidden).length&&!n&&!w};a.minDragEnabledItems=2;a.minFilterItems=10;a.sortChildLayersToIds=function(q,n){if(q=q?.layer){var w=h(q);if(w){if("layers"===w&&"layers"in q)var B=q.layers;else"sublayers"===w&&"sublayers"in q&&(B=q.sublayers);g(B,n)}}};a.sortLayersToIds=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),function(a,b,c,l,h,g,m,y,q,n,w){a.SnappingLayerListViewModel=class extends q{constructor(){super(...arguments);
this.featureSnappingSources=new c}get operationalItemsFlat(){return this.operationalItems.flatten(B=>B.children)}get selectableItems(){return this.operationalItemsFlat.filter(B=>!B.children?.length)}_compileList(){var B=this.view?.map?.layers;B&&(B=B.filter(n.isValidSnappingLayer),this._watchLayersListMode(B),B=this._getViewableLayers(B),B?.length?(this._createNewItems(B),this._removeItems(B),this._sortItems(B)):this._removeAllItems())}_createListItem(B){return new w.SnappingListItem({layer:B,view:this.view,
getFeatureSnappingSources:()=>this.featureSnappingSources})}};b.__decorate([l.property()],a.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);b.__decorate([l.property()],a.SnappingLayerListViewModel.prototype,"operationalItems",void 0);b.__decorate([l.property()],a.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);b.__decorate([l.property()],a.SnappingLayerListViewModel.prototype,"selectableItems",null);a.SnappingLayerListViewModel=b.__decorate([y.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
a.SnappingLayerListViewModel);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../linkChart/utils ./ListItem ./support/layerListUtils".split(" "),function(a,b,c,l,h,g,m,y,q,n,w,B){const d=
b.ofType(w);b=class extends c.EventedAccessor{constructor(f){super(f);this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=null;this.listModeDisabled=!1;this.operationalItems=new d;this.view=null}initialize(){this.addHandles([l.watch(()=>!0===this.view?.ready,()=>this._viewHandles(),l.initial),l.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),l.watch(()=>n.isLinkChartView(this.view)?this.view.inGeographicLayout:null,
()=>this._compileList())],"view")}destroy(){this._removeAllItems();this.view=null}get state(){const {view:f}=this;return f?.ready?"ready":f?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(f=>f.children).length}triggerAction(f,v){f&&!f.disabled&&this.emit("trigger-action",{action:f,item:v})}moveListItem(f,v,t,z){const F=f?.layer;if(F&&"subtype-sublayer"!==F.type&&"sublayer"!==F.type){var H=this.view?.map?.layers,J=v?B.getItemLayers(v):H;H=t?B.getItemLayers(t):H;if(J&&H){var {operationalItems:E}=
this,p=t?.children||E;z=H.length-z;f.parent=t||null;(v?.children||E).remove(f);J.remove(F);p.includes(f)||p.add(f,z);H.includes(F)||H.add(F,z);this._compileList()}}}_createLayerViewHandles(f){this.removeHandles("layer-views");this._compileList();f&&this.addHandles(f.on("change",()=>this._compileList()),"layer-views")}_createMapLayerHandles(f){this.removeHandles("map-layers");this._compileList();f&&this.addHandles(f.on("change",()=>this._compileList()),"map-layers")}_createListItem(f){const {view:v,
listItemCreatedFunction:t,checkPublishStatusEnabled:z,listModeDisabled:F}=this;return new w({checkPublishStatusEnabled:z,listModeDisabled:F,layer:f,listItemCreatedFunction:t,view:v})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(f){return f?this.listModeDisabled?f:f.filter(v=>"hide"!==B.findLayerListMode(v)):void 0}_watchLayersListMode(f){this.removeHandles("layer-list-mode");f&&!this.listModeDisabled&&this.addHandles(l.watch(()=>f.filter(v=>"listMode"in v).map(v=>v.listMode).toArray(),
()=>this._compileList()),"layer-list-mode")}_compileList(){var f=this.view?.map?.layers;f=n.isLinkChartView(this.view)&&!this.view.inGeographicLayout?f?.filter(({type:v})=>"link-chart"===v):f;this._watchLayersListMode(f);f=this._getViewableLayers(f);f?.length?(this._createNewItems(f),this._removeItems(f),this._sortItems(f)):this._removeAllItems()}_createNewItems(f){const {operationalItems:v}=this;f.forEach(t=>{v.some(z=>z.layer===t)||v.add(this._createListItem(t))})}_removeItems(f){const {operationalItems:v}=
this,t=[];v.forEach(z=>{z&&f&&f.includes(z.layer)||t.push(z)});v.destroyMany(t)}_sortItems(f){const {operationalItems:v}=this;v.sort((t,z)=>{t=f.indexOf(t.layer);z=f.indexOf(z.layer);return t>z?-1:t<z?1:0})}_recompileList(){this._removeAllItems();this._compileList()}_viewHandles(){const {view:f}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);f?.ready?this.addHandles([l.watch(()=>this.view?.map?.allLayers,v=>this._createMapLayerHandles(v),l.initial),l.watch(()=>this.view?.allLayerViews,
v=>this._createLayerViewHandles(v),l.initial)],"view-layers"):this._removeAllItems()}};a.__decorate([h.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([h.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([h.property({nonNullable:!0})],b.prototype,"listModeDisabled",void 0);a.__decorate([h.property({type:d})],b.prototype,"operationalItems",void 0);a.__decorate([h.property({readOnly:!0})],b.prototype,"state",null);a.__decorate([h.property()],b.prototype,
"totalItems",null);a.__decorate([h.property()],b.prototype,"view",void 0);return b=a.__decorate([q.subclass("esri.widgets.LayerList.LayerListViewModel")],b)})},"esri/linkChart/utils":function(){define(["exports"],function(a){a.isLinkChartView=function(b){return null!=b&&"object"===typeof b&&"2d"===b.type&&"linkchart"===b.view2dType};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z){var F;q=l.ofType({key:"type",defaultKeyValue:"button",base:B,typeMap:{button:d,toggle:v,slider:f}});const H=l.ofType(q);b=F=class extends h.IdentifiableMixin(b){constructor(J){super(J);this.actionsSections=new H;this.checkPublishStatusEnabled=this.actionsOpen=!1;this.children=new (l.ofType(F));this.childrenSortable=!0;this.hidden=!1;this.listItemCreatedFunction=this.layer=null;this.open=this.listModeDisabled=!1;this.view=this.parent=this.panel=null}initialize(){this.addHandles([g.watch(()=>
[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),g.initial),g.watch(()=>this.checkPublishStatusEnabled,J=>this._updateChildrenPublishing(J),g.initial),g.watch(()=>this.view,J=>this._updateChildrenView(J),g.initial),g.watch(()=>this.panel,J=>this._setListItemOnPanel(J),g.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})}destroy(){this.panel?.destroy();this.children.destroyAll();this.view=
null}get connectionStatus(){const {layerView:J,publishing:E}=this;if(!E&&J&&"connectionStatus"in J)return J.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const {layerView:J}=this;return J&&"spatialReferenceSupported"in J?!J.spatialReferenceSupported:!1}get layerView(){const {layer:J,view:E}=this;if(!J||!E||"sublayer"===J.type)return null;const p="subtype-sublayer"===J.type?J.parent:J;return E.allLayerViews.find(D=>D.layer===p)??null}castPanel(J){this.panel?.open&&!J.hasOwnProperty("open")&&
(J.open=!0);return J?new t(J):null}get sortable(){return"knowledge-graph-sublayer"===this.layer?.type?!1:this._get("sortable")}set sortable(J){this._set("sortable",J)}get title(){const J=w.get(this,"layer.layer");return(!J||J&&w.get(this,"layer.layer.loaded"))&&w.get(this,"layer.title")||w.get(this,"layer.attributes.title")||""}set title(J){this._override("title",J)}get publishing(){const {layer:J,checkPublishStatusEnabled:E}=this;return E&&J&&"publishingInfo"in J&&"publishing"===J.publishingInfo?.status}get updating(){const {layerView:J,
connectionStatus:E,layer:p,publishing:D}=this;return D||E?!1:J?J.updating:"loading"===p?.loadStatus||!1}get visible(){return this.layer?.visible}set visible(J){const E=this.layer;E&&(E.visible=J)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!z.isLayerOutsideScaleRange(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return z.findLayerVisibilityMode(this.layer)}clone(){return new F({actionsSections:this.actionsSections.clone(),
actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(J){J&&(J.listItem=this)}_updateChildrenPublishing(J){const E=this.children;
E&&E.forEach(p=>p.checkPublishStatusEnabled=J)}_updateChildrenView(J){const E=this.children;E&&E.forEach(p=>p.view=J)}_createChildren(J){const {listModeDisabled:E,children:p}=this;J=J.filter(D=>!p.some(e=>e.layer===D));p.addMany(this._createChildItems(J,E))}_destroyChildren(J){const {children:E}=this,p=E.filter(D=>!J.includes(D.layer));E.destroyMany(p)}_sortChildren(J){this.children.sort((E,p)=>J.indexOf(p.layer)-J.indexOf(E.layer))}_destroyAllChildren(){this.removeHandles("child-list-mode");this.children.destroyAll()}_watchChildLayerListMode(J){this.removeHandles("child-list-mode");
this.listModeDisabled||this.addHandles(J.toArray().map(E=>g.watch(()=>E.listMode,()=>this._compileChildren(J))),"child-list-mode")}_compileChildren(J){const E=this.listModeDisabled?J:J?.filter(p=>"hide"!==z.findLayerListMode(p));E?.length?(this._createChildren(E),this._destroyChildren(E),this._sortChildren(E),this._watchChildLayerListMode(J)):this._destroyAllChildren()}_watchSublayerChanges(J){J&&this.addHandles(J.on("change",()=>this._compileChildren(J)),"layer")}_initializeChildLayers(J){this._compileChildren(J);
this._watchSublayerChanges(J)}_createChildItems(J,E){return J.map(p=>E||z.canDisplayLayer(p)?new F({layer:p,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(c.isSome).reverse()}_watchLayerProperties(J){this.removeHandles("layer");this.removeHandles("child-list-mode");if(J)if("hide-children"===(!this.listModeDisabled&&z.findLayerListMode(J)))this.children.destroyAll();
else{var E=z.getNormalizedChildLayerProperty(J);E&&this.addHandles(g.watch(()=>J[E],p=>{J.hasOwnProperty(E)&&this._initializeChildLayers(p)},g.initial),"layer")}}};a.__decorate([m.property({type:H})],b.prototype,"actionsSections",void 0);a.__decorate([m.property()],b.prototype,"actionsOpen",void 0);a.__decorate([m.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([m.property({type:l})],b.prototype,"children",void 0);a.__decorate([m.property()],b.prototype,"childrenSortable",
void 0);a.__decorate([m.property({readOnly:!0})],b.prototype,"connectionStatus",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"error",null);a.__decorate([m.property()],b.prototype,"hidden",void 0);a.__decorate([m.property({readOnly:!0})],b.prototype,"incompatible",null);a.__decorate([m.property()],b.prototype,"layer",void 0);a.__decorate([m.property({readOnly:!0})],b.prototype,"layerView",null);a.__decorate([m.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([m.property({nonNullable:!0})],
b.prototype,"listModeDisabled",void 0);a.__decorate([m.property()],b.prototype,"open",void 0);a.__decorate([m.property({type:t})],b.prototype,"panel",void 0);a.__decorate([y.cast("panel")],b.prototype,"castPanel",null);a.__decorate([m.property()],b.prototype,"parent",void 0);a.__decorate([m.property({value:!0})],b.prototype,"sortable",null);a.__decorate([m.property()],b.prototype,"title",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"publishing",null);a.__decorate([m.property({readOnly:!0})],
b.prototype,"updating",null);a.__decorate([m.property()],b.prototype,"view",void 0);a.__decorate([m.property()],b.prototype,"visible",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"visibleAtCurrentScale",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"visibleAtCurrentTimeExtent",null);a.__decorate([m.property({readOnly:!0})],b.prototype,"visibilityMode",null);return b=F=a.__decorate([n.subclass("esri.widgets.LayerList.ListItem")],b)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(a,b,c,l,h,g,m){var y;c=y=class extends m{constructor(q){super(q);this.displayValueEnabled=!1;this.max=1;this.min=0;this.step=.1;this.type="slider";this.value=null}clone(){return new y({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};a.__decorate([b.property()],c.prototype,"displayValueEnabled",
void 0);a.__decorate([b.property()],c.prototype,"max",void 0);a.__decorate([b.property()],c.prototype,"min",void 0);a.__decorate([b.property()],c.prototype,"step",void 0);a.__decorate([b.property()],c.prototype,"value",void 0);return c=y=a.__decorate([g.subclass("esri.support.actions.ActionSlider")],c)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w,B,d,f){c=class extends c.IdentifiableMixin(w){constructor(v,t){super(v,t);this.content=this.className=this._legend=null;this.flowEnabled=!1;this.listItem=this.image=null;this.open=!1;this.visible=!0}initialize(){this.addHandles([h.watch(()=>this._canCreateLegend,()=>this._createLegend(),h.initial),h.watch(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),h.initial)])}destroy(){this._legend=l.destroyMaybe(this._legend)}get _canCreateLegend(){const {content:v,
listItem:t}=this;return t?"legend"===v?!0:null!=v&&(Array.isArray(v)?v.includes("legend"):!1):!1}get _legendOptions(){const {listItem:v,_legendLayerInfo:t}=this,z=v?.view;return t&&z?{view:z,layerInfos:[t]}:{}}get _legendLayerInfo(){const v=this.listItem?.layer;if(!v||"subtype-sublayer"===v.type)return null;var t=B.isSublayer(v)?v:null;const z=v?.parent;return(t=null!=z&&"type"in z&&"map-image"===z.type?t?.source:null)&&z?{layer:z,title:"",sublayerIds:[t.mapLayerId]}:{layer:v,title:""}}get disabled(){const {listItem:v,
_legend:t,content:z}=this;return v?Array.isArray(z)&&1<z.length?!1:t?!t.activeLayerInfos?.length||!v.visibleAtCurrentScale||!v.visible:!1:!0}set disabled(v){this._overrideIfSome("disabled",v)}get icon(){const {image:v}=this,t=this._getFirstWidget();return this._get("icon")??(!v&&t?t.icon:null)}set icon(v){this._overrideIfSome("icon",v)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(v){this._override("title",v)}render(){return f.tsx("div",{class:"esri-list-item-panel"},
this._renderContents())}_renderContent(v){const {_legend:t,disabled:z,open:F}=this;return v&&!z&&F?"legend"===v&&t?f.tsx("div",{key:"legend-widget"},t.render()):"string"===typeof v?f.tsx("div",{innerHTML:v,key:v}):d.isWidget(v)?f.tsx("div",{key:"content-widget"},v.render()):v instanceof HTMLElement?f.tsx("div",{afterCreate:this._attachToNode,bind:v,key:"content-element"}):null:null}_renderContents(){const {content:v,open:t}=this;return t?Array.isArray(v)?v.map(z=>this._renderContent(z)):this._renderContent(v):
null}async _createLegend(){l.destroyMaybe(this._legend);this._legend=null;if(this._canCreateLegend){var {default:v}=await new Promise((t,z)=>a(["../Legend"],F=>t(Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}))),z));this._legend=new v(this._legendOptions)}}_attachToNode(v){v.appendChild(this)}_updateLegend(){const v=this._legend;v&&v.set(this._legendOptions)}_getWidget(v){return"legend"===v?this._legend:d.isWidget(v)?v:null}_getFirstWidget(){const {content:v}=
this;return Array.isArray(v)?v.map(t=>this._getWidget(t)).find(t=>t):this._getWidget(v)}};b.__decorate([g.property()],c.prototype,"_legend",void 0);b.__decorate([g.property()],c.prototype,"_canCreateLegend",null);b.__decorate([g.property()],c.prototype,"_legendOptions",null);b.__decorate([g.property()],c.prototype,"_legendLayerInfo",null);b.__decorate([g.property()],c.prototype,"className",void 0);b.__decorate([g.property()],c.prototype,"content",void 0);b.__decorate([g.property()],c.prototype,"disabled",
null);b.__decorate([g.property()],c.prototype,"flowEnabled",void 0);b.__decorate([g.property()],c.prototype,"icon",null);b.__decorate([g.property()],c.prototype,"image",void 0);b.__decorate([g.property()],c.prototype,"listItem",void 0);b.__decorate([g.property()],c.prototype,"open",void 0);b.__decorate([g.property()],c.prototype,"title",null);b.__decorate([g.property()],c.prototype,"visible",void 0);return c=b.__decorate([n.subclass("esri.widgets.LayerList.ListItemPanel")],c)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports",
"../../LayerList/support/layerListUtils"],function(a,b){const c=m=>l(m)||h(m),l=m=>{if(!("type"in m))return!1;switch(m.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":case "subtype-sublayer":return!0;default:return!1}},h=m=>{const y=b.getNormalizedChildLayerProperty(m);if(null!=y&&m.hasOwnProperty(y)&&null!=m[y])for(const q of m[y])if(c(q))return!0;return!1},g=(m,y)=>{if(null!=y&&null!=m){if(y.test(m.title))return"self";
if(m.children.some(q=>!1!==g(q,y)))return"children"}return!1};a.isValidSnappingLayer=c;a.isValidSnappingLayerGroup=h;a.isValidSnappingLayerSource=l;a.itemTitleMatchesFilter=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(a,b,c,l,h,g,m,y,q,n,w){var B;a.SnappingListItem=B=class extends q{constructor(d){super(d);this.children=new l;this.parent=null}get enabled(){const {children:d}=this;if(0===d.length)return null!=this.featureSource?this.featureSource.enabled?"enabled":"disabled":"disabled";let f=!1,v=!1;for(const t of d){if("indeterminate"===t.enabled)return t.enabled;"enabled"===t.enabled?f=!0:"disabled"===t.enabled&&(v=!0);if(v&&f)return"indeterminate"}return v?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(d=>
[d.layer.id,...d.childLayerIds])}get featureSource(){const {layer:d,getFeatureSnappingSources:f}=this;return f().find(v=>v.layer===d)}_initializeChildLayers(d){d&&(d=d.filter(w.isValidSnappingLayer),super._initializeChildLayers(d))}_createChildItems(d){return d.map(f=>n.canDisplayLayer(f)?new B({layer:f,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(c.isSome).reverse()}};b.__decorate([h.property()],a.SnappingListItem.prototype,"enabled",null);b.__decorate([h.property()],
a.SnappingListItem.prototype,"children",void 0);b.__decorate([h.property()],a.SnappingListItem.prototype,"childLayerIds",null);b.__decorate([h.property()],a.SnappingListItem.prototype,"featureSource",null);b.__decorate([h.property({constructOnly:!0})],a.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);b.__decorate([h.property()],a.SnappingListItem.prototype,"parent",void 0);a.SnappingListItem=B=b.__decorate([y.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],a.SnappingListItem);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/handleUtils ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../views/interactive/sketch/SketchValueOptions ./Widget ./Sketch/SketchViewModel ./Sketch/VisibleElements ../chunks/componentsUtils ./support/globalCss ./support/SelectionToolbar ./support/SketchTooltipControls ./support/SnappingControls ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
b,c,l,h,g,m,y,q,n,w,B,d,f,v,t,z,F,H,J,E,p,D,e,r,G){c=class extends f{constructor(A,x){super(A,x);this._activeCreateOptions=this._activeCustomToolOptions=null;this._menuOpen=!1;this._viewModelHandlesGroup=this._selectionToolbar=null;this.availableCreateTools=["point","polyline","polygon","rectangle","circle"];this.creationMode="continuous";this.customToolOptions=null;this.layout="horizontal";this.messagesCommon=this.messages=null;this.visibleElements=new t;this._activateCreateTool=this._activateCreateTool.bind(this);
this.viewModel=A?.viewModel||new v}initialize(){const {layer:A,view:x}=this,L=new H({view:"2d"===x?.type?x:null,sources:A?[A]:null});this.addHandles([m.watch(()=>this.viewModel,S=>{this._viewModelHandlesGroup=h.removeMaybe(this._viewModelHandlesGroup);S&&(this._viewModelHandlesGroup=l.handlesGroup([S.on("create",Q=>{this.scheduleRender();this._onCreateOperation(Q)}),S.on("update",()=>this.scheduleRender()),S.on("delete",Q=>this.emit("delete",Q)),S.on("undo",()=>this.scheduleRender()),S.on("redo",
()=>this.scheduleRender()),m.watch(()=>S.layer,Q=>{this._selectionToolbar&&(this._selectionToolbar.sources=Q?[Q]:null)}),m.watch(()=>S.view,Q=>{this._selectionToolbar&&(this._selectionToolbar.view="2d"===Q?.type?Q:null)}),m.watch(()=>S.state,()=>this.notifyChange("state"))]))},m.syncAndInitial),m.when(()=>L.activeToolInfo,()=>this.viewModel.cancel()),L.on("complete",S=>this._onSelectionOperationComplete(S)),m.watch(()=>{const {selectionTools:S}=this.visibleElements;return{lassoTool:!!S?.["lasso-selection"],
rectangleTool:!!S?.["rectangle-selection"]}},S=>{Object.assign(L.visibleElements,S)},m.syncAndInitial)]);this._selectionToolbar=L}loadDependencies(){return z.loadCalciteComponents({action:()=>new Promise((A,x)=>a(["../chunks/calcite-action"],A,x)),icon:()=>new Promise((A,x)=>a(["../chunks/calcite-icon"],A,x))})}destroy(){this._selectionToolbar?.destroy();this._viewModelHandlesGroup=h.removeMaybe(this._viewModelHandlesGroup)}get activeTool(){const A=this._selectionToolbar?.activeToolInfo;if(A)switch(A.toolName){case "lasso":return"lasso-selection";
case "rectangle":return"rectangle-selection";case "default":return"custom-selection"}return this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(A){this.viewModel.defaultCreateOptions=A}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(A){this.viewModel.defaultUpdateOptions=A}get icon(){return"pencil"}set icon(A){this._overrideIfSome("icon",
A)}get label(){return this.messages?.widgetLabel??""}set label(A){this._overrideIfSome("label",A)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(A){this.viewModel.labelOptions=A}get layer(){return this.viewModel.layer}set layer(A){this.viewModel.layer=A}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(A){this.viewModel.snappingOptions=A}get state(){return this._selectionToolbar?.activeToolInfo?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(A){this.viewModel.tooltipOptions=
A}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(A){this.viewModel.valueOptions=A}get view(){return this.viewModel.view}set view(A){this.viewModel.view=A}set viewModel(A){const x=this._get("viewModel");A!==x&&(x&&h.destroyMaybe(x),this._set("viewModel",A))}get _effectiveAvailableCreateTools(){const {availableCreateTools:A,visibleElements:x}=this;return A?.filter(L=>!!x.createTools?.[L])}create(A,x,L){this._activeCreateOptions=
(x=L?.createOptions??x)||null;this._activeCustomToolOptions=L;return g.ignoreAbortErrors(this.viewModel.create(A,x))}update(A,x){return g.ignoreAbortErrors(this.viewModel.update(A,x))}complete(){this.viewModel.complete()}cancel(){this._selectionToolbar?.cancel();this.viewModel.cancel();this._activeCustomToolOptions=null}undo(){this.viewModel.undo();this.view?.focus()}redo(){this.viewModel.redo();this.view?.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}render(){const {label:A,
layout:x,viewModel:{state:L}}=this;return r.tsx("div",{"aria-label":A,class:this.classes("esri-sketch",F.globalCss.widget,{[F.globalCss.disabled]:"disabled"===L,["esri-sketch--vertical"]:"vertical"===x,["esri-sketch--horizontal"]:"horizontal"===x})},r.tsx("div",{class:"esri-sketch__panel",role:"toolbar"},this._renderTopPanelContents()),r.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this._renderInfoPanelContents()))}_renderTopPanelContents(){const A=this.classes("esri-sketch__section",
"esri-sketch__tool-section"),{_effectiveAvailableCreateTools:x,customToolOptions:L,visibleElements:S,viewModel:Q}=this,R=!(!x?.length&&!L?.length);return[Q.updateOnGraphicClick||this._selectionToolbar?.visibleToolCount?r.tsx("div",{class:A,key:"selection-button-container",role:"menu"},this._renderDefaultSelectionButton(),this._renderSelectionToolbar()):null,R?r.tsx("div",{class:A,role:"menu"},this._renderDrawActions(),this._renderCustomToolActions()):null,S.undoRedoMenu?r.tsx("div",{class:A,key:"undo-redo-menu-button-container",
role:"menu"},this._renderUndoRedoMenuButtons()):null,S.settingsMenu?r.tsx("div",{class:"esri-sketch__section",key:"settings-menu-button-container"},this._renderSettingsMenuButton()):null]}_renderInfoPanelContents(){if(this._menuOpen)return this._renderSettingsMenu();if(this.updateGraphics.length)return[r.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},this._renderFeatureCount()),r.tsx("div",{class:this.classes("esri-sketch__section",
"esri-sketch__info-section"),key:"delete-button-container"},this._renderDuplicateButton(),this._renderDeleteButton())]}_renderSettingsMenu(){const {messagesCommon:A,snappingOptions:x,view:L,viewModel:S,visibleElements:Q}=this,R={directionModePicker:Q.directionModePicker,labelsToggle:Q.labelsToggle,tooltipsToggle:Q.tooltipsToggle};return r.tsx("div",{class:"esri-sketch__menu-container","data-testid":"menu",key:"settings-menu-container",role:"menu"},r.tsx("header",{class:"esri-sketch__menu-header",
key:"settings-menu-header"},r.tsx("span",{class:"esri-sketch__menu-title"},A.settings)),Object.values(R).includes(!0)?r.tsx(J,{sketchOptions:S.sketchOptions,viewType:L?.type,visibleElements:R}):void 0,Q.snappingControls&&L&&x?r.tsx(E,{snappingManager:this.viewModel.snappingManager,snappingOptions:x,view:L,visibleElements:Q.snappingControlsElements}):void 0)}_renderFeatureCount(){const {layout:A,messages:x,updateGraphics:{length:L}}=this,S=G.substitute(x.selectedCount,{count:L});return r.tsx("div",
{"aria-label":S,class:"esri-sketch__feature-count-badge"},r.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===A?L:S))}_renderDuplicateButton(){if(this.visibleElements.duplicateButton){var A=this.messages;A=1<this.updateGraphics.length?A.duplicateFeatures:A.duplicateFeature;return r.tsx("calcite-action",{bind:this,onclick:this._onDuplicateSelect,scale:"s",text:A,title:A},r.tsx("calcite-icon",{icon:"copy",scale:"s"}))}}_renderDeleteButton(){var A=this.messages;A=1<this.updateGraphics.length?
A.deleteFeatures:A.deleteFeature;return r.tsx("calcite-action",{bind:this,onclick:this.delete,scale:"s",text:A,title:A},r.tsx("calcite-icon",{icon:"trash",scale:"s"}))}_renderDefaultSelectionButton(){if(this.viewModel.updateOnGraphicClick){var {messages:A,state:x}=this,L=A.selectFeature;return r.tsx("calcite-action",{active:"ready"===x,bind:this,disabled:"disabled"===x,onclick:this._activateDefaultSelectTool,scale:"s",text:L,title:L},r.tsx("calcite-icon",{icon:"cursor",scale:"s"}))}}_renderSelectionToolbar(){if("2d"===
this.view?.type&&this._selectionToolbar)return this._selectionToolbar.render()}_renderDrawActions(){const {messages:A}=this;return this._effectiveAvailableCreateTools?.map(x=>{switch(x){case "point":return this._renderAction(x,A.drawPoint,"pin");case "polyline":return this._renderAction(x,A.drawPolyline,"line");case "polygon":return this._renderAction(x,A.drawPolygon,"polygon");case "rectangle":return this._renderAction(x,A.drawRectangle,"rectangle");case "circle":return this._renderAction(x,A.drawCircle,
"circle")}})}_renderCustomToolActions(){return this.customToolOptions?.map(A=>this._renderCustomToolAction(A))}_renderCustomToolAction(A){const {icon:x,label:L,toolKey:S,toolName:Q}=A;return r.tsx("calcite-action",{active:this._activeCustomToolOptions?.toolKey===S,bind:this,disabled:"disabled"===this.state,onclick:()=>this._activateCreateTool(Q,null,A),scale:"s",text:L,title:L},r.tsx("calcite-icon",{icon:x,scale:"s"}))}_renderAction(A,x,L){return r.tsx("calcite-action",{active:this.activeTool===A&&
!this._activeCustomToolOptions,bind:this,disabled:"disabled"===this.state,onclick:()=>this._activateCreateTool(A),scale:"s",text:x,title:x},r.tsx("calcite-icon",{icon:L,scale:"s"}))}_renderUndoRedoMenuButtons(){return[this._renderUndoButton(),this._renderRedoButton()]}_renderUndoButton(){const A=this.messages.undo;return r.tsx("calcite-action",{bind:this,disabled:!this.viewModel.canUndo()||"disabled"===this.state,onclick:this.undo,scale:"s",text:A,title:A},r.tsx("calcite-icon",{icon:p.isRTL(this.container)?
"redo":"undo",scale:"s"}))}_renderRedoButton(){const A=this.messages.redo;return r.tsx("calcite-action",{bind:this,disabled:!this.viewModel.canRedo()||"disabled"===this.state,onclick:this.redo,scale:"s",text:A,title:A},r.tsx("calcite-icon",{icon:p.isRTL(this.container)?"undo":"redo",scale:"s"}))}_renderSettingsMenuButton(){const A=this.messagesCommon.settings;return r.tsx("calcite-action",{active:this._menuOpen,bind:this,"data-testid":"settings-menu-action",disabled:"disabled"===this.state,onclick:this._toggleMenu,
scale:"s",text:A,title:A},r.tsx("calcite-icon",{icon:"gear",scale:"s"}))}_activateCreateTool(A,x,L){const S=this._activeCustomToolOptions;if(L||S){if(L?.toolKey===S?.toolKey){this.cancel();return}}else if(this.activeTool===A){this.cancel();return}this._selectionToolbar?.cancel();this.create(A,x,L)}_onCreateOperation(A){if("complete"===A.state){var {creationMode:x}=this,{type:L}=A;if("create"===L){const {tool:S,graphic:Q}=A;A=this._activeCreateOptions;this._activeCreateOptions=null;"continuous"===
x?this.create(S,A,this._activeCustomToolOptions):(this._activeCustomToolOptions=null,"update"===x&&this.update([Q]))}}}_toggleMenu(){this._menuOpen=!this._menuOpen;this.scheduleRender()}_onDuplicateSelect(){const A=this.duplicate(),x=this.viewModel.activeTool;"transform"!==x&&"reshape"!==x||this.update(A,{tool:x})}_onSelectionOperationComplete(A){const {viewModel:{defaultUpdateOptions:x}}=this,{selection:L}=A;!A.aborted&&L.length&&(A=x.tool,this.update(L,{...x,tool:1<L.length&&"reshape"===A?"transform":
A}));this.notifyChange("state")}_activateDefaultSelectTool(){this.cancel();this.view?.focus()}};b.__decorate([y.property()],c.prototype,"_activeCustomToolOptions",void 0);b.__decorate([y.property()],c.prototype,"_activeCreateOptions",void 0);b.__decorate([y.property()],c.prototype,"activeTool",null);b.__decorate([y.property({readOnly:!0})],c.prototype,"activeTooltip",null);b.__decorate([y.property({cast:A=>{if(!A?.length)return null;const x=new Set(["point","polyline","polygon","rectangle","circle"]);
return A.filter(L=>x.has(L))}})],c.prototype,"availableCreateTools",void 0);b.__decorate([y.property({readOnly:!0})],c.prototype,"createGraphic",null);b.__decorate([y.property()],c.prototype,"creationMode",void 0);b.__decorate([y.property()],c.prototype,"customToolOptions",void 0);b.__decorate([y.property()],c.prototype,"defaultCreateOptions",null);b.__decorate([y.property()],c.prototype,"defaultUpdateOptions",null);b.__decorate([y.property()],c.prototype,"icon",null);b.__decorate([y.property()],
c.prototype,"label",null);b.__decorate([y.property()],c.prototype,"labelOptions",null);b.__decorate([y.property()],c.prototype,"layer",null);b.__decorate([y.property({type:["horizontal","vertical"]})],c.prototype,"layout",void 0);b.__decorate([y.property(),D.messageBundle("esri/widgets/Sketch/t9n/Sketch")],c.prototype,"messages",void 0);b.__decorate([y.property(),D.messageBundle("esri/t9n/common")],c.prototype,"messagesCommon",void 0);b.__decorate([y.property()],c.prototype,"snappingOptions",null);
b.__decorate([y.property()],c.prototype,"state",null);b.__decorate([y.property()],c.prototype,"tooltipOptions",null);b.__decorate([y.property({readOnly:!0})],c.prototype,"updateGraphics",null);b.__decorate([y.property({type:d,nonNullable:!0})],c.prototype,"valueOptions",null);b.__decorate([y.property()],c.prototype,"view",null);b.__decorate([y.property(),e.vmEvent(["create","update","undo","redo"])],c.prototype,"viewModel",null);b.__decorate([y.property({type:t,nonNullable:!0})],c.prototype,"visibleElements",
void 0);b.__decorate([y.property()],c.prototype,"_effectiveAvailableCreateTools",null);return c=b.__decorate([B.subclass("esri.widgets.Sketch")],c)});