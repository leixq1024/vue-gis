// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./Column ../../support/uriUtils".split(" "),function(f,h,e,u,v,q,r,t){e=class extends r{constructor(b){super(b);this.editInfo=null;this.cellValueValidatorFunction=({oldValue:a,value:c})=>a!==c;this.editable=!0;this.headerRenderFunction=a=>{({root:a}=a);const c=this.createHeaderContent();this.tableEditingEnabled&&
!this.effectiveEditable&&c.prepend(this._lockIconNode);this.removeCellContent(a);a.appendChild(c)};this.inputRenderFunction=({root:a,column:c,rowData:d})=>{if(!this.editInfo&&this.effectiveEditable&&d){var k=this.getCellValue(d),g=this.createInputElement({value:k});this._set("editInfo",{column:c,inputs:[g],root:a,rowData:d,oldValue:k});c=document.createElement("div");c.appendChild(g);this.removeCellContent(a);a.appendChild(c);g.focus();g instanceof HTMLInputElement&&g.select()}};this.loadingMessage=
"";this.inputType="text";this.maxLength=null;this.onShowPromptCallback=()=>{};this.parseInputValueFunction=({inputs:a})=>a?.length?null:1!==a.length||Array.isArray(a[0].value)?null:a[0].value;this.renderFunction=a=>{const {root:c,rowData:d}=a;var {editInfo:k}=this;if(!k){k=this.getCellValue(d);var g=this.cellValueFormatFunction({root:c,rowData:d,value:k}),l=null;c.onclick=()=>c.focus();c.ondblclick=()=>this.inputRenderFunction(a);c.ontouchend=()=>this.inputRenderFunction(a);(l=this.grid?.getSlotElementByName(c.slot)?.parentElement)&&
!l.onkeydown&&(l.onkeydown=m=>{"Enter"!==m.key||this.editInfo||this.inputRenderFunction(a);"Escape"===m.key&&this.editInfo&&this.cancel()});null!=k&&null!=g?c.title=g.toString():c.title&&c.removeAttribute("title");l=g instanceof HTMLElement?g:t.autoLink(this.messagesURIUtils,g);this.removeCellContent(c);l instanceof HTMLElement?c.appendChild(l):null!=l&&(c.innerHTML=l.toString())}};this.tableEditingEnabled=this.required=!1}get _lockIconNode(){return this.createCalciteIcon({icon:"lock",textLabel:this.messages?.editingPreventedColumn})}get effectiveEditable(){return this.tableEditingEnabled&&
this.editable}get effectiveRequired(){return this.required}get editing(){return!!this.editInfo}get shouldShowPrompt(){return!1}cancel(){const {editInfo:b}=this;if(b){var {column:a,root:c,rowData:d}=b;this.onEditComplete();this.renderFunction({column:a,root:c,rowData:d})}}createCalciteOption(b,a,c=!1){const d=document.createElement("calcite-option");d.label=b;d.value=`${a}`;d.selected=c;return d}createCalciteSelect(b,a){const {effectiveRequired:c,messages:d}=this;let k=!1;a=a.map(({name:m,value:n})=>
{const p=n===b;p&&(k=!0);return this.createCalciteOption(m,n,p)});if(null!=b&&""!==b&&!k){var g=b.toString();g=this.createCalciteOption(g,g);a.unshift(g)}c||a.unshift(this.createCalciteOption(`<${d?.noValue}>`,""));const l=document.createElement("calcite-select");a.forEach(m=>l.appendChild(m));return l}createInputElement({value:b}){const {effectiveRequired:a,maxLength:c}=this,d=document.createElement("calcite-input");null!=c&&(d.maxLength=c);d.required=a;d.value=b;d.addEventListener("calciteInputChange",
()=>this.onInputBlur(d));d.onkeydown=k=>{if("Escape"===k.key)this.onInputBlur(d,!0)};d.onblur=()=>this.onInputBlur(d);return d}createDateComponent(){const b=document.createElement("calcite-input-date-picker");b.focusTrapDisabled=!0;b.overlayPositioning="fixed";return b}createTimeComponent(){const b=document.createElement("calcite-input-time-picker");b.overlayPositioning="fixed";b.placement="auto-start";b.step=1;return b}createTimeZoneComponent(){const b=document.createElement("calcite-input-time-zone");
b.maxItems=4;b.overlayPositioning="fixed";return b}onEditComplete(){this._set("editInfo",null);this.grid?.generateCellPartNames()}onInputBlur(b,a=!1){b.onblur=null;a?this.cancel():this.submit()}async submit(){var {editInfo:b}=this;if(b){var {inputs:a,rowData:c,oldValue:d}=b,k=this.parseInputValueFunction({inputs:a});if(this.cellValueValidatorFunction({value:k,oldValue:d})){({root:b}=b);var g=c.item.objectId,{fieldName:l}=this;b.textContent=this.loadingMessage;if(this.shouldShowPrompt)this.onShowPromptCallback({column:this,
objectId:g,oldValue:d,value:k});else await this.updateItems({objectId:g,updates:[{fieldName:l,value:k}]})}else this.cancel()}else this.cancel()}async updateItems(b){const {store:a}=this;if(a)try{await a.updateItem(b),this.onEditComplete()}catch{this.cancel()}else this.cancel()}};f.__decorate([h.property()],e.prototype,"_lockIconNode",null);f.__decorate([h.property({readOnly:!0})],e.prototype,"editInfo",void 0);f.__decorate([h.property()],e.prototype,"cellValueValidatorFunction",void 0);f.__decorate([h.property()],
e.prototype,"editable",void 0);f.__decorate([h.property()],e.prototype,"effectiveEditable",null);f.__decorate([h.property()],e.prototype,"effectiveRequired",null);f.__decorate([h.property()],e.prototype,"editing",null);f.__decorate([h.property()],e.prototype,"headerRenderFunction",void 0);f.__decorate([h.property()],e.prototype,"inputRenderFunction",void 0);f.__decorate([h.property({constructOnly:!0})],e.prototype,"loadingMessage",void 0);f.__decorate([h.property()],e.prototype,"inputType",void 0);
f.__decorate([h.property()],e.prototype,"maxLength",void 0);f.__decorate([h.property()],e.prototype,"onShowPromptCallback",void 0);f.__decorate([h.property()],e.prototype,"parseInputValueFunction",void 0);f.__decorate([h.property()],e.prototype,"renderFunction",void 0);f.__decorate([h.property()],e.prototype,"required",void 0);f.__decorate([h.property()],e.prototype,"shouldShowPrompt",null);f.__decorate([h.property()],e.prototype,"tableEditingEnabled",void 0);return e=f.__decorate([q.subclass("esri.widgets.FeatureTable.Grid.EditorColumn")],
e)});