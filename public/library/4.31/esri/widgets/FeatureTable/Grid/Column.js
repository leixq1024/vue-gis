// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../../chunks/tslib.es6 ../../../core/Evented ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./ColumnCSS ../support/tableUtils ../../support/uriUtils ../../support/widgetUtils".split(" "),function(f,d,p,g,C,D,E,y,t,z,A,u){d=class extends d.EventedAccessor{constructor(b){super(b);this.autoWidth=this._menuIsOpen=!1;this.cellValueFormatFunction=({root:a,
rowData:c,value:e})=>{const {formatFunction:h}=this;e=u.renderingSanitizer.sanitize(e);if(h&&c){const {index:k,item:{attachments:l,feature:m,relatedRecords:q}}=c;return h({attachments:l,column:this,feature:m,index:k,relatedRecords:q,value:e,virtualIndex:this.getVirtualRowIndex(a)})}return e};this.fieldName=this.direction=this.description=null;this.flexGrow=1;this.formatFunction=this.footerRenderFunction=null;this.frozenToEnd=this.frozen=!1;this.grid=null;this.headerRenderFunction=a=>{({root:a}=a);
const c=this.createHeaderContent();this.removeCellContent(a);a.appendChild(c)};this.hidden=!1;this.messagesURIUtils=this.messagesCommon=this.messages=this.menuConfig=this.label=this.initialSortPriority=this.icon=null;this.renderFunction=({root:a,rowData:c})=>{var e=this.getCellValue(c);c=this.cellValueFormatFunction({root:a,rowData:c,value:e});e=null;e=c instanceof HTMLElement?c:A.autoLink(this.messagesURIUtils,c);this.removeCellContent(a);e instanceof HTMLElement?(a.removeAttribute("title"),a.appendChild(e)):
null!=e&&(c=e.toString(),a.innerHTML=c,a.title=c)};this.resizable=!0;this.sortable=!1;this.tableTimeZone=this.store=null;this.textAlign="start";this.textWrap=!1;this.visibleElements=this.timeZone=null;this.width=200}initialize(){const {fieldName:b}=this;this._set("sortElement",this.createSortElement());this.sortElement.setAttribute("path",b);this.addHandles([p.watch(()=>this.direction,a=>{const {sortElement:c}=this;this.sortable&&c&&(a?this.sortElement.direction!==a&&c.setAttribute("direction",a):
c.removeAttribute("direction"))}),p.when(()=>this.grid?.isReady&&this.sortElement,()=>{const {direction:a,grid:c,hidden:e,sortElement:h}=this;e&&a&&h&&c&&!c.hasSorter(h)&&c.addSorter(h)},p.initial),p.watch(()=>this.timeZone,()=>this.grid?.requestContentUpdate()),p.watch(()=>this.hidden,()=>this.closeMenu()),p.watch(()=>this.fieldName,a=>{const {sortElement:c}=this;c&&c.path!==a&&c.setAttribute("path",a)}),p.watch(()=>this.effectiveLabel,a=>{const {sortElement:c}=this;c&&c.textContent!==a&&(c.setAttribute("title",
a),c.textContent=a)})])}get _headerRequiresTextContainer(){return!(!this.sortable&&""===this.effectiveLabel&&null==this.effectiveDescription)}get customMenuItems(){return this.menuConfig?.items?.map(({disabled:b,hidden:a,icon:c,iconClass:e,label:h,selected:k,clickFunction:l})=>this.createCalciteDropdownItem({disabled:b,hidden:a,iconClass:e,iconStart:c,selected:k,textContent:h,onclick:m=>l(m)}))??[]}get defaultMenuItems(){if(!this.sortable)return[];var b=this.messages;const a=[],c=this.visibleElements?.columnMenuItems;
if(!1!==c?.sortAscending){const e=this.createCalciteDropdownItem({iconStart:"sort-ascending-arrow",textContent:b?.sortAsc,onclick:()=>this.direction="asc"});a.push(e)}!1!==c?.sortDescending&&(b=this.createCalciteDropdownItem({iconStart:"sort-descending-arrow",textContent:b?.sortDesc,onclick:()=>this.direction="desc"}),a.push(b));return a}get effectiveDescription(){const {description:b}=this;return z.isEmptyStringOrWhitespace(b)?null:u.renderingSanitizer.sanitize(b)}get effectiveLabel(){return u.renderingSanitizer.sanitize(this.label||
this.fieldName)}get iconNode(){const {icon:b}=this;return b?this.createCalciteIcon({icon:b}):null}set invalid(b){this._set("invalid",b);this.grid?.generateCellPartNames()}get invalid(){return this._get("invalid")??!1}get menu(){const {customMenuItems:b,defaultMenuItems:a,menuConfig:c}=this;var e=!!c?.open;const h=this.createCalciteAction({icon:c?.icon??"ellipsis",text:this.messages?.menu??"",slot:"trigger"}),k=document.createElement("calcite-dropdown");k.maxItems=c?.maxItems??4;k.placement="top-end";
k.overlayPositioning="fixed";k.scale=c?.scale??"m";e&&(k.open=e,this._menuIsOpen=!0);k.appendChild(h);k.addEventListener("calciteDropdownOpen",()=>this._menuIsOpen=!0);k.addEventListener("calciteDropdownClose",()=>this._menuIsOpen=!1);k.onkeydown=this._stopPropagationOnSelect;k.addEventListener("mousewheel",l=>{l.stopPropagation()});a.length&&(e=k.appendChild(document.createElement("calcite-dropdown-group")),e.selectionMode="none",e.append(...a));b.length&&(e=k.appendChild(document.createElement("calcite-dropdown-group")),
e.selectionMode=c?.selectionMode??"none",e.append(...b));return k}get menuItems(){return[...this.defaultMenuItems,...this.customMenuItems]}get menuIsOpen(){return this._menuIsOpen}get menuIsVisible(){return!(!1===this.visibleElements?.columnMenus||!this.menuItems.length)}closeMenu(){this.menu.open=!1}createSortElement(){const {effectiveLabel:b,direction:a,fieldName:c,initialSortPriority:e}=this,h=document.createElement("vaadin-grid-sorter");h.classList.add(t.css.sorter);h.setAttribute("path",c);h.setAttribute("title",
b);h.textContent=b;a&&h.setAttribute("direction",a);null!=e&&(h._initialOrder=e);h.addEventListener("direction-changed",()=>{this.direction!==h.direction&&this._set("direction",h.direction)});return h}createCalciteAction(b){const a=document.createElement("calcite-action"),{alignment:c,appearance:e,className:h,disabled:k,icon:l,label:m,scale:q,slot:n,text:r,textEnabled:v,onclick:w}=b;a.alignment=c??"center";a.appearance=e??"transparent";a.className=h??"";a.disabled=!!k;a.icon=l??"";a.label=m??"";a.scale=
q??"s";a.slot=n??"";a.text=a.title=r??"";a.textEnabled=!!v;a.onclick=w??null;return a}createCalciteButton(b){const a=document.createElement("calcite-button"),{alignment:c,appearance:e,className:h,disabled:k,iconEnd:l,iconFlipRtl:m,kind:q,loading:n,onclick:r,scale:v,textContent:w,title:x,width:B}=b;a.alignment=c??"center";a.className=h??"";a.scale=v??"s";a.appearance=e??"transparent";a.disabled=!!k;a.iconEnd=l??"";m&&(a.iconFlipRtl=m);a.kind=q??"brand";a.loading=!!n;a.textContent=w??"";x&&(a.title=
x);a.width=B??"auto";a.onclick=r??null;return a}createCalciteDropdownItem(b){const a=document.createElement("calcite-dropdown-item"),{disabled:c,hidden:e,iconClass:h,iconStart:k,textContent:l,onclick:m,selected:q}=b;b=l??"";if(h&&!k){const n=document.createElement("span"),r=document.createElement("span");r.classList.add(t.css.headerMenuIcon,h);n.textContent=n.title=b;n.insertBefore(r,n.firstChild);a.appendChild(n)}else a.iconStart=k??"",a.textContent=a.title=b;a.disabled=!!c;a.hidden="function"===
typeof e?e():!!e;a.selected=!!q;m&&(a.addEventListener("calciteDropdownItemSelect",m),a.onkeydown=this._stopPropagationOnSelect);return a}createCalciteIcon(b){var {effectiveLabel:a}=this;const {icon:c,scale:e,textLabel:h}=b;b=document.createElement("calcite-icon");a=h??a;b.icon=c;b.scale=e??"s";b.textLabel=a;b.title=a;return b}createHeaderContent(){const {effectiveDescription:b,effectiveLabel:a,iconNode:c}=this,e=document.createElement("div");e.classList.add(t.css.headerContent);c&&e.appendChild(c);
if(!this._headerRequiresTextContainer)return e;const h=e.appendChild(document.createElement("div"));this.sortable?h.appendChild(this.sortElement):""!==a&&h.appendChild(this._createHeaderTextElement(a,t.css.headerLabel));null!=b&&!1!==this.visibleElements?.columnDescriptions&&h.appendChild(this._createHeaderTextElement(b,t.css.headerDescription));this.menuIsVisible&&e.appendChild(this.menu);return e}getCellValue(b){return b?.item.feature.attributes?.[this.fieldName]}getVirtualRowIndex(b){b=this.grid?.getRowContainingNode(b);
return b?.parentElement?[...b.parentElement.children].indexOf(b):-1}removeCellContent(b){if(b&&b.firstChild)try{for(;b?.firstChild;)b?.removeChild(b.firstChild)}catch(a){}}openMenu(){this.menuIsVisible&&(this.menu.open=!0,u.setFocus(this.menuItems[0]))}sort(){this.sortable&&this.sortElement?.click()}_stopPropagationOnSelect(b){"Enter"!==b.key&&" "!==b.key||b.stopPropagation()}_createHeaderTextElement(b,a){const c=document.createElement("span");b=b??"";c.classList.add(a);a=c.appendChild(document.createElement("span"));
a.textContent=b;a.setAttribute("title",b);return c}};f.__decorate([g.property()],d.prototype,"_headerRequiresTextContainer",null);f.__decorate([g.property()],d.prototype,"_menuIsOpen",void 0);f.__decorate([g.property()],d.prototype,"autoWidth",void 0);f.__decorate([g.property()],d.prototype,"cellValueFormatFunction",void 0);f.__decorate([g.property()],d.prototype,"customMenuItems",null);f.__decorate([g.property()],d.prototype,"defaultMenuItems",null);f.__decorate([g.property()],d.prototype,"description",
void 0);f.__decorate([g.property()],d.prototype,"direction",void 0);f.__decorate([g.property()],d.prototype,"effectiveDescription",null);f.__decorate([g.property()],d.prototype,"effectiveLabel",null);f.__decorate([g.property({constructOnly:!0})],d.prototype,"fieldName",void 0);f.__decorate([g.property()],d.prototype,"flexGrow",void 0);f.__decorate([g.property()],d.prototype,"footerRenderFunction",void 0);f.__decorate([g.property()],d.prototype,"formatFunction",void 0);f.__decorate([g.property()],
d.prototype,"frozen",void 0);f.__decorate([g.property()],d.prototype,"frozenToEnd",void 0);f.__decorate([g.property()],d.prototype,"grid",void 0);f.__decorate([g.property()],d.prototype,"iconNode",null);f.__decorate([g.property()],d.prototype,"invalid",null);f.__decorate([g.property()],d.prototype,"headerRenderFunction",void 0);f.__decorate([g.property()],d.prototype,"hidden",void 0);f.__decorate([g.property()],d.prototype,"icon",void 0);f.__decorate([g.property({constructOnly:!0})],d.prototype,"initialSortPriority",
void 0);f.__decorate([g.property()],d.prototype,"label",void 0);f.__decorate([g.property()],d.prototype,"menu",null);f.__decorate([g.property()],d.prototype,"menuItems",null);f.__decorate([g.property()],d.prototype,"menuConfig",void 0);f.__decorate([g.property()],d.prototype,"menuIsOpen",null);f.__decorate([g.property()],d.prototype,"menuIsVisible",null);f.__decorate([g.property()],d.prototype,"messages",void 0);f.__decorate([g.property()],d.prototype,"messagesCommon",void 0);f.__decorate([g.property()],
d.prototype,"messagesURIUtils",void 0);f.__decorate([g.property()],d.prototype,"renderFunction",void 0);f.__decorate([g.property()],d.prototype,"resizable",void 0);f.__decorate([g.property()],d.prototype,"sortable",void 0);f.__decorate([g.property({readOnly:!0})],d.prototype,"sortElement",void 0);f.__decorate([g.property()],d.prototype,"store",void 0);f.__decorate([g.property()],d.prototype,"tableTimeZone",void 0);f.__decorate([g.property()],d.prototype,"textAlign",void 0);f.__decorate([g.property()],
d.prototype,"textWrap",void 0);f.__decorate([g.property()],d.prototype,"timeZone",void 0);f.__decorate([g.property()],d.prototype,"visibleElements",void 0);f.__decorate([g.property()],d.prototype,"width",void 0);return d=f.__decorate([y.subclass("esri.widgets.FeatureTable.Grid.Column")],d)});