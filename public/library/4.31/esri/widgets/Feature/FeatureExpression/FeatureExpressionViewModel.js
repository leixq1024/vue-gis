// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../../chunks/tslib.es6 ../../../geometry ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/content/UtilityNetworkAssociationsContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils ../../../geometry/Point".split(" "),
function(d,c,n,p,g,q,e,G,H,I,r,J,K,L,M,t,u,N,v,O,w,x,y,z,l,A){c=class extends p{constructor(f){super(f);this.view=this.location=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:b}=this;b&&b.abort();this._abortController=null};this._createVM=()=>{var b=this.contentElement?.type;this.contentElementViewModel?.destroy();b="fields"===b?new y:"media"===b?new z:"text"===b?new x:null;
this._set("contentElementViewModel",b)};this._compile=async()=>{this._cancelQuery();const b=new AbortController;this._abortController=b;await this._compileExpression();this._abortController===b&&(this._abortController=null)};this._compileThrottled=q.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:b,graphic:h,interceptor:B,spatialReference:C,map:D,location:E,view:F,_abortController:m}=this;if(b&&h){var a=await l.loadArcade();if(m===this._abortController)if((a=
await l.createCompiledExpression({arcade:a,expressionInfo:b,graphic:h,location:E,interceptor:B,map:D,spatialReference:C,view:F}))&&"esri.arcade.Dictionary"===a.declaredClass){a=await a.castAsJsonAsync(m?.signal);var k=a?.type;a="media"===k?u.fromJSON(a):"text"===k?v.fromJSON(a):"fields"===k?t.fromJSON(a):null;"media"===a.type&&!a.mediaInfos||"fields"===a.type&&!a.fieldInfos||"text"===a.type&&!a.text?this._set("contentElement",null):this._set("contentElement",a)}else this._set("contentElement",null)}else this._set("contentElement",
null)};this.addHandles([g.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),g.initial),g.watch(()=>[this.contentElement],()=>this._createVM(),g.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(f){this._override("spatialReference",
f)}get state(){const {_abortController:f,contentElement:b,contentElementViewModel:h}=this;return f?"loading":b||h?"ready":"disabled"}get map(){return this.view?.map??null}set map(f){this._override("map",f)}};d.__decorate([e.property()],c.prototype,"_abortController",void 0);d.__decorate([e.property({type:w})],c.prototype,"expressionInfo",void 0);d.__decorate([e.property({type:n})],c.prototype,"graphic",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"contentElement",void 0);d.__decorate([e.property({readOnly:!0})],
c.prototype,"contentElementViewModel",void 0);d.__decorate([e.property()],c.prototype,"interceptor",void 0);d.__decorate([e.property({type:A})],c.prototype,"location",void 0);d.__decorate([e.property()],c.prototype,"spatialReference",null);d.__decorate([e.property({readOnly:!0})],c.prototype,"state",null);d.__decorate([e.property()],c.prototype,"map",null);d.__decorate([e.property()],c.prototype,"view",void 0);return c=d.__decorate([r.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],
c)});