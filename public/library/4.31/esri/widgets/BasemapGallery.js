// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("require ../chunks/tslib.es6 ../assets ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../support/basemapUtils ./Widget ./BasemapGallery/BasemapGalleryViewModel ./BasemapGallery/css ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/decorators/accessibleHandler ./support/decorators/messageBundle ./support/jsxFactory ./support/widgetUtils".split(" "),function(q,e,
w,x,g,d,G,H,y,n,z,A,f,B,k,r,C,D,c,E){d=class extends z{constructor(a,b){super(a,b);this.disabled=!1;this.headingLevel=2;this.messages=null;this.viewModel=new A;this._focusBasemapItemEnabled=!1;this._container=null;this._width=0;this._onContainerCreated=h=>{this._container=h}}initialize(){this.addHandles([E.onResize(()=>this._container,({contentRect:a})=>{this._width=a.width}),x.when(()=>this.source,()=>this.viewModel.loadSource(),{sync:!0,initial:!0})])}loadDependencies(){return B.loadCalciteComponents({scrim:()=>
new Promise((a,b)=>q(["../chunks/calcite-scrim"],a,b)),chip:()=>new Promise((a,b)=>q(["../chunks/calcite-chip"],a,b))})}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(a){this.viewModel.activeBasemap=a}get icon(){return"basemap"}set icon(a){this._overrideIfSome("icon",a)}get label(){return this.messages?.widgetLabel??""}set label(a){this._overrideIfSome("label",a)}get source(){return this.viewModel.source}set source(a){this.viewModel.source=a}get view(){return this.viewModel.view}set view(a){this.viewModel.view=
a}render(){const a={[f.css.sourceLoading]:"loading"===this.source.state,[k.globalCss.disabled]:this.disabled||"disabled"===this.viewModel.state};var b=this._width;200>=b||420<=b?a[f.css.layoutGrid]=!0:280>b&&(a[f.css.narrowItems]=!0);b=this._getContext();return c.tsx("div",{afterCreate:this._onContainerCreated,class:this.classes(f.css.base,k.globalCss.widget,k.globalCss.panel,a),key:"container",styles:{"--esri-basemap-gallery-small":"200px"}},0===this._width?null:b)}_getContext(){if("unsupported"===
this.viewModel.state)return c.tsx("div",{class:k.globalCss.empty,key:"empty-message"},c.tsx(r.Heading,{level:this.headingLevel},this.messages.unsupported));if("loading"===this.source.state)return c.tsx("div",{class:f.css.loader,key:"loader"});const a=this.viewModel.items;return 0<a.length?c.tsx("ul",{"aria-disabled":this.disabled,"aria-label":this.label,bind:this,class:f.css.itemContainer,key:"item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},a.map((b,h)=>this._renderBasemapGalleryItem(b,
h)).toArray()):c.tsx("div",{class:k.globalCss.empty,key:"empty-message"},c.tsx(r.Heading,{level:this.headingLevel},this.messages.noBasemaps))}_getRoundRobinIndex(a,b){return(a+b)%b}_handleKeyDown(a){const {key:b}=a;if(["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(b)){a.preventDefault();var {items:h,activeBasemapIndex:l}=this.viewModel;a="ArrowUp"===b||"ArrowLeft"===b?this._getRoundRobinIndex(Math.max(l-1,-1),h.length):this._getRoundRobinIndex(l+1,h.length);a=h.at(a);"ready"===a?.state&&
(this.viewModel.activeBasemap=a.basemap);this._focusBasemapItemEnabled=!0}}_focusBasemapItem(a){this._focusBasemapItemEnabled&&0===a.tabIndex&&(a.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(a){a=a.currentTarget["data-item"];"ready"===a.state&&(this.viewModel.activeBasemap=a.basemap)}_renderBasemapGalleryItem(a,b){const h=n.getBasemapThumbnailUrl(a.basemap)||w.getAssetUrl("esri/themes/base/images/basemap-toggle-64.svg"),l=a.basemap.title;var p=a.basemap.portalItem?.snippet;p=a.error?.message||
p||l;const {viewModel:{state:t,activeBasemapIndex:u}}=this,m=u===b;b=m||-1===u&&0===b?0:-1;const F="loading"===t,v=`basemapgallery-item-${a.uid}`;return c.tsx("li",{afterUpdate:this._focusBasemapItem,"aria-checked":m.toString(),"aria-disabled":(this.disabled||"disabled"===t).toString(),"aria-labelledby":v,bind:this,class:this.classes(f.css.item,{[f.css.selectedItem]:m,[f.css.itemError]:"error"===a.state}),"data-item":a,key:a.uid,onclick:this._handleClick,onkeydown:this._handleClick,role:"radio",tabIndex:b,
title:p},c.tsx("img",{alt:"",class:f.css.itemThumbnail,src:h}),c.tsx("div",{class:f.css.itemContent,key:"content"},c.tsx("div",{class:f.css.itemTitle,key:"title"},c.tsx("span",{id:v},l)),n.isBasemap3D(a.basemap)?this._renderTags(a.basemap):null),"loading"===a.state||m&&F?c.tsx("calcite-scrim",null,c.tsx("span",{"aria-hidden":"true",class:k.globalCss.loaderAnimation,key:"loader",role:"presentation"})):null)}_renderTags(a){return c.tsx("div",{class:f.css.itemTagsContainer,key:"tag"},this._render3DTag(),
n.isBasemapInBeta(a)?this._renderBetaTag():null)}_render3DTag(){const {messages:a}=this;return c.tsx("calcite-chip",{key:"tag-3d",scale:"s",value:a.tag3D},this.messages.tag3D)}_renderBetaTag(){const {messages:a}=this;return c.tsx("calcite-chip",{appearance:"outline-fill",key:"tag-beta",scale:"s",value:a.tagBeta},this.messages.tagBeta)}};e.__decorate([g.property()],d.prototype,"activeBasemap",null);e.__decorate([g.property()],d.prototype,"disabled",void 0);e.__decorate([g.property()],d.prototype,"headingLevel",
void 0);e.__decorate([g.property()],d.prototype,"icon",null);e.__decorate([g.property()],d.prototype,"label",null);e.__decorate([g.property(),D.messageBundle("esri/widgets/BasemapGallery/t9n/BasemapGallery")],d.prototype,"messages",void 0);e.__decorate([g.property()],d.prototype,"source",null);e.__decorate([g.property()],d.prototype,"view",null);e.__decorate([g.property()],d.prototype,"viewModel",void 0);e.__decorate([g.property()],d.prototype,"_focusBasemapItemEnabled",void 0);e.__decorate([g.property()],
d.prototype,"_container",void 0);e.__decorate([g.property()],d.prototype,"_width",void 0);e.__decorate([C.accessibleHandler()],d.prototype,"_handleClick",null);return d=e.__decorate([y.subclass("esri.widgets.BasemapGallery")],d)});