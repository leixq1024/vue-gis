// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("require ../chunks/tslib.es6 ../core/Collection ../core/deprecate ../core/Identifiable ../core/Logger ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./LayerList/LayerListItem ./LayerList/support/layerListUtils ../chunks/componentsUtils ./support/globalCss ./support/listUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ./TableList/css ./TableList/ListItem ./TableList/TableListViewModel ./TableList/TableListVisibleElements ./TableList/support/tableListUtils".split(" "),
function(q,e,b,v,F,w,f,R,S,G,H,I,x,J,y,K,A,B,L,k,z,M,C,D,r){const N=b.ofType(M);b=class extends F.IdentifiableMixin(H){constructor(a,c){super(a,c);this._focusPanelFlowItem=this._focusRootFlowItem=!1;this._selectedDragItemLayerUid=this._lastDragDetail=null;this._rootGroupUid=`table-${this.uid}`;this.dragEnabled=this.collapsed=!1;this.filterText=this.filterPlaceholder="";this.headingLevel=2;this.messagesCommon=this.messages=this.listItemCanReceiveFunction=this.listItemCanGiveFunction=null;this.minDragEnabledItems=
x.minDragEnabledItems;this.minFilterItems=x.minFilterItems;this.selectedItems=new N;this.selectionMode="none";this.viewModel=new C;this.visibleElements=new D;this._canMove=({dragEl:d,fromEl:g,toEl:l},m)=>{m="pull"===m?this.listItemCanGiveFunction:this.listItemCanReceiveFunction;d=r.getItem(d);if(!d?.sortable)return!1;const t=r.getItem(g);var p=x.getLayerType(g);const n=r.getItem(l),u=x.getLayerType(l);p=!!p&&!!u&&p===u;d={selected:d,from:t,to:n};l=l.group;return g.group&&l&&"function"===typeof m?
m.call(null,d):p};this._onCalciteListOrderChange=d=>{const {_lastDragDetail:g}=this,{toEl:l,fromEl:m,dragEl:t,newIndex:p}=d;m&&l&&(g?.newIndex!==p||g?.dragEl!==t||g?.toEl!==l||g?.fromEl!==m)&&(this._lastDragDetail=d,d=Array.from(m.children).filter(n=>n?.matches("calcite-list-item")).map(n=>n.value),r.sortTablesToIds(this.map?.tables,d))};this._onTriggerAction=(d,g)=>{this.triggerAction(d,g)};this._onPanelOpen=()=>{this._focusPanelFlowItem=!0};this._onSelectedDragItemLayerUidChange=d=>{this._selectedDragItemLayerUid=
d}}loadDependencies(){return J.loadCalciteComponents({button:()=>new Promise((a,c)=>q(["../chunks/calcite-button"],a,c)),flow:()=>new Promise((a,c)=>q(["../chunks/calcite-flow"],a,c)),"flow-item":()=>new Promise((a,c)=>q(["../chunks/calcite-flow-item"],a,c)),list:()=>new Promise((a,c)=>q(["../chunks/calcite-list"],a,c)),notice:()=>new Promise((a,c)=>q(["../chunks/calcite-notice"],a,c))})}get _dragEnabled(){return this.viewModel.totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this.viewModel.totalItems>=
this.minFilterItems&&this.visibleElements.filter}get icon(){return"table"}set icon(a){this._overrideIfSome("icon",a)}get label(){return this.messages?.widgetLabel??""}set label(a){this._overrideIfSome("label",a)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(a){this.viewModel.listItemCreatedFunction=a}get map(){return this.viewModel.map}set map(a){this.viewModel.map=a}get multipleSelectionEnabled(){v.deprecatedProperty(w.getLogger(this),"multipleSelectionEnabled",
{replacement:"selectionMode",version:"4.29",warnOnce:!0});return"multiple"===this.selectionMode}set multipleSelectionEnabled(a){v.deprecatedProperty(w.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0});this.selectionMode=a?"multiple":this.selectionEnabled?"single":"none"}get selectionEnabled(){v.deprecatedProperty(w.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0});return"none"!==this.selectionMode&&
this.dragEnabled}set selectionEnabled(a){v.deprecatedProperty(w.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0});this.selectionMode=(this.dragEnabled=a)?this.multipleSelectionEnabled?"multiple":"single":"none"}get tableItems(){return this.viewModel.tableItems}get tables(){return this.viewModel.tables}set tables(a){this.viewModel.tables=a}triggerAction(a,c){return this.viewModel.triggerAction(a,c)}render(){var a=this.viewModel?.state;a={[y.globalCss.hidden]:"loading"===
a,[y.globalCss.disabled]:"disabled"===a};const c=this.tableItems?.filter(d=>!d.hidden&&(this.visibleElements.errors||!d.error));return k.tsx("div",{class:this.classes(z.css.base,y.globalCss.widget,y.globalCss.panel,a)},c?.length?this._renderItems(c):this._renderNoItems())}_renderNoItemsMessage(){return k.tsx("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return k.tsx("div",{class:z.css.itemMessage,key:"esri-layer-list__no-items"},k.tsx("calcite-notice",{icon:"information",
kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}_renderPanelFlowItems(a){return a?.toArray().filter(({panel:c})=>c?.open&&!c.disabled&&c.flowEnabled).map(({title:c,panel:d})=>{const g=()=>this._handlePanelFlowItemBack(d);return k.tsx("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:c,heading:d.title,headingLevel:this.headingLevel,key:`flow-panel-${d.uid}`,onCalciteFlowItemBack:l=>{l.preventDefault();g()}},
d.render(),k.tsx("calcite-button",{appearance:"transparent",onclick:g,slot:"footer-actions",width:"full"},this.messagesCommon.back))})}_handlePanelFlowItemBack(a){a.open=!1;this._focusRootFlowItem=!0}_focusRootFlowItemNode(a){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,A.setFocus(a))}_focusPanelFlowItemNode(a){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,A.setFocus(a))}_renderItems(a){const {visible:c,collapsed:d,visibleElements:{closeButton:g,collapseButton:l,heading:m,flow:t},
_dragEnabled:p,_filterEnabled:n,_rootGroupUid:u,selectionMode:O,messages:E,filterPlaceholder:P,filterText:Q}=this;a=[k.tsx("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:g,closed:!c,collapsed:d,collapsible:l,heading:m?E.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",onCalciteFlowItemClose:()=>this.visible=!1},k.tsx("calcite-list",{canPull:h=>this._canMove(h,"pull"),canPut:h=>this._canMove(h,"put"),"data-layer-type":u,
dragEnabled:p,filterEnabled:n,filterPlaceholder:P,filterProps:K.calciteListFilterProps,filterText:n?Q:"",group:u,key:"root-list",label:E.widgetLabel,selectionAppearance:"border",selectionMode:O,onCalciteListChange:h=>this._handleCalciteListChange(h),onCalciteListDragEnd:h=>this._handleCalciteListDragEnd(h.detail),onCalciteListFilter:h=>this.filterText=h.target?.filterText??"",onCalciteListOrderChange:h=>this._onCalciteListOrderChange(h.detail)},a?.toArray().map(h=>this._renderItem(h)),a?.length&&
n?k.tsx("div",{class:z.css.filterNoResults,slot:"filter-no-results"},k.tsx("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(a)];return c?t?k.tsx("calcite-flow",{key:"root-flow"},a):a:null}_handleCalciteListDragEnd(a){const {fromEl:c,dragEl:d,oldIndex:g}=a;c.insertBefore(d,c.children[g])}_renderItem(a){return k.tsx(I,{canMove:this._canMove,css:z.css,dragEnabled:this.dragEnabled,item:a,key:`layerListItem-${a.layer.uid}`,listModeDisabled:this.viewModel.listModeDisabled,
messages:this.messages,messagesCommon:this.messagesCommon,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange})}_handleCalciteListChange(a){const {selectionMode:c,selectedItems:d}=this;"none"!==c&&(a=a.target.selectedItems.map(g=>
r.getItem(g)).filter(Boolean),d.removeAll(),d.addMany(a))}};e.__decorate([f.property()],b.prototype,"_focusRootFlowItem",void 0);e.__decorate([f.property()],b.prototype,"_focusPanelFlowItem",void 0);e.__decorate([f.property()],b.prototype,"_dragEnabled",null);e.__decorate([f.property()],b.prototype,"_filterEnabled",null);e.__decorate([f.property()],b.prototype,"collapsed",void 0);e.__decorate([f.property()],b.prototype,"dragEnabled",void 0);e.__decorate([f.property()],b.prototype,"filterPlaceholder",
void 0);e.__decorate([f.property()],b.prototype,"filterText",void 0);e.__decorate([f.property()],b.prototype,"headingLevel",void 0);e.__decorate([f.property()],b.prototype,"icon",null);e.__decorate([f.property()],b.prototype,"label",null);e.__decorate([f.property()],b.prototype,"listItemCanGiveFunction",void 0);e.__decorate([f.property()],b.prototype,"listItemCanReceiveFunction",void 0);e.__decorate([f.property()],b.prototype,"listItemCreatedFunction",null);e.__decorate([f.property()],b.prototype,
"map",null);e.__decorate([f.property(),B.messageBundle("esri/widgets/TableList/t9n/TableList")],b.prototype,"messages",void 0);e.__decorate([f.property(),B.messageBundle("esri/t9n/common")],b.prototype,"messagesCommon",void 0);e.__decorate([f.property()],b.prototype,"minDragEnabledItems",void 0);e.__decorate([f.property()],b.prototype,"minFilterItems",void 0);e.__decorate([f.property()],b.prototype,"multipleSelectionEnabled",null);e.__decorate([f.property()],b.prototype,"selectionEnabled",null);e.__decorate([f.property()],
b.prototype,"selectedItems",void 0);e.__decorate([f.property()],b.prototype,"selectionMode",void 0);e.__decorate([f.property({readOnly:!0})],b.prototype,"tableItems",null);e.__decorate([f.property()],b.prototype,"tables",null);e.__decorate([L.vmEvent("trigger-action"),f.property({type:C})],b.prototype,"viewModel",void 0);e.__decorate([f.property({type:D,nonNullable:!0})],b.prototype,"visibleElements",void 0);return b=e.__decorate([G.subclass("esri.widgets.TableList")],b)});