// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search/css":function(){define(["exports"],function(b){b.css={base:"esri-search",hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",form:"esri-search__form",submitButton:"esri-search__submit-button",
sourcesButton:"esri-search__sources-button",sourcesButtonDown:"esri-search__sources-button--down",sourcesButtonUp:"esri-search__sources-button--up",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",source:"esri-search__source",warningMenu:"esri-search__warning-menu",
warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./searchResultRendererCSS ./SearchViewModel ../support/globalCss ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../support/jsxFactory ../support/widgetUtils".split(" "),
function(b,d,n,m,x,h,v,k,B,t,L,D,y,C){n=class extends v{constructor(I,u){super(I,u);this.messages=null;this.showMoreResultsOpen=!1;this.viewModel=null}destroy(){this.viewModel=null}render(){const I={[k.css.showMoreResults]:this.showMoreResultsOpen};return y.tsx("div",{class:this.classes(k.css.base,t.globalCss.widget)},y.tsx("div",{class:this.classes(k.css.moreResults,I),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return y.tsx("div",
{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){return y.tsx("div",{class:k.css.moreResultsItem,key:"esri-search-renderer__result-name"},this.viewModel?.selectedResult?.name||"")}_renderMoreResultsLists(){var {viewModel:I}=this;if(!I)return[];if(2>(I.resultCount??0))return null;I=I.results?.map(u=>this._renderMoreResultsList(u));return y.tsx("div",{class:k.css.moreResultsList,key:"esri-search-renderer__more-results-container"},
I)}_renderMoreResultsButton(){const {messages:I,viewModel:u}=this;return!u||2>(u.resultCount??0)?null:y.tsx("div",{class:k.css.moreResultsItem,key:"esri-search-renderer__more-results-button"},y.tsx("a",{bind:this,class:t.globalCss.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?I.hideMoreResults:I.showMoreResults))}_renderMoreResultsHeader(I,u){return y.tsx("div",{class:k.css.moreResultsListHeader,key:`esri-search-result-renderer__header-${u}`},
I)}_renderMoreResultsList(I){var {results:u}=I,l=u?.length??0;const E=0<l;var w=this.viewModel?.selectedResult;l=1===l&&u[0]===w;w=this._getSourceName(I.source,I.sourceIndex);w=1<(this.viewModel?.results?.length??0)&&!l?this._renderMoreResultsHeader(w,I.sourceIndex):null;u=E&&u.map((Q,S)=>this._renderMoreResultsListItem(Q,S));u=E&&!l?y.tsx("ul",{key:`esri-search-result-renderer__list-${I.sourceIndex}`},u):null;return E?y.tsx("div",{key:`esri-search-result-renderer__results-${I.sourceIndex}`},w,u):
null}_renderMoreResultsListItem(I,u){return I!==this.viewModel?.selectedResult?y.tsx("li",{key:`esri-search-result-renderer__list-item-${u}`},y.tsx("a",{bind:this,class:t.globalCss.anchor,"data-result":I,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},I.name)):null}_showMoreResultsClick(I){I.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(I=this.viewModel?.view?.popup)&&"reposition"in I&&I.reposition()}_selectResultClick(I){I.preventDefault();
I=I.currentTarget["data-result"];this.viewModel?.select(I)}_getSourceName(I,u){return u===B.ALL_INDEX?this.messages.all:I.name}};b.__decorate([d.property(),D.messageBundle("esri/widgets/Search/t9n/Search")],n.prototype,"messages",void 0);b.__decorate([d.property()],n.prototype,"showMoreResultsOpen",void 0);b.__decorate([d.property()],n.prototype,"viewModel",void 0);b.__decorate([L.accessibleHandler()],n.prototype,"_showMoreResultsClick",null);b.__decorate([L.accessibleHandler()],n.prototype,"_selectResultClick",
null);return n=b.__decorate([h.subclass("esri.widgets.Search.SearchResultRenderer")],n)})},"esri/widgets/Search/searchResultRendererCSS":function(){define(["exports"],function(b){b.css={base:"esri-search-result-renderer",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",
moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../symbols ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/geometryUtils ../../intl/locale ../../intl/messages ../../portal/Portal ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/locatorUtils ../support/geolocationUtils ../support/GoTo ../../symbols/PictureMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol ../../symbols/TextSymbol".split(" "),
function(b,d,n,m,x,h,v,k,B,t,L,D,y,C,I,u,l,E,w,Q,S,G,Y,ba,ca,c,f,q,H,R,P,r,F,z,O){function J(a,e){return a.hasOwnProperty(e)&&null!=a[e]&&""!==a[e]}const U=B.ofType({key:a=>a.layer?"layer":"locator",base:q,typeMap:{layer:c,locator:f}}),K=Q.WGS84,X=/<[\s\S]*?>/g;h=class extends P.GoToMixin(L.EventedMixin(v)){constructor(a){super(a);this._updatingPromise=this._searching=this._gotoController=null;this._createdFeatureLayers=[];this.autoSelect=this.autoNavigate=!0;this.defaultPopupTemplate=null;this.defaultSources=
new U;this.defaultSymbols={point:new r({url:d.getAssetUrl("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new F({color:[130,130,130,1],width:2}),polygon:new z({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};this.includeDefaultSources=!0;this.maxInputLength=128;this.maxSuggestions=this.maxResults=6;this.messages=null;this.minSuggestCharacters=3;this.popupEnabled=!0;this.popupTemplate=null;this.portal=ba.getDefault();this.resultCount=null;this.resultGraphicEnabled=
!0;this.selectedSuggestion=this.results=this.resultGraphic=null;this.searchAllEnabled=!0;this.selectedResult=null;this.sources=new U;this.suggestionDelay=350;this.suggestions=this.suggestionCount=null;this.suggestionsEnabled=!0;this.view=null}initialize(){const a=async()=>{const e=await Y.fetchMessageBundle("esri/widgets/Search/t9n/Search");this.messages=e;this.defaultPopupTemplate=new x({title:e.searchResult,content:"{Match_addr}"})};a();this.addHandles([I.watch(()=>[this.includeDefaultSources,this.view,
this.portal],()=>this._update(),I.initial),G.onLocaleChange(a)])}destroy(){this._destroyFeatureLayers();this._abortGoTo();this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0}set activeSourceIndex(a){this._overrideIfSome("activeSourceIndex",a)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(a){this._overrideIfSome("allPlaceholder",a)}get allSources(){const {sources:a,
defaultSources:e,includeDefaultSources:g}=this,p="function"===typeof g?g.call(null,{sources:a,defaultSources:e}):g?e.concat(a):a,A=this._get("allSources")||new U;A.removeAll();A.addMany(p.filter(Boolean));return A}get locationEnabled(){return this._get("locationEnabled")||R.supported()}set locationEnabled(a){if(void 0===a)this._clearOverride("locationEnabled");else{var e=R.supported();if(a&&!e){const g=new t("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});
D.getLogger(this).error(g)}this._override("locationEnabled",!!a&&e)}}get placeholder(){const {allSources:a,activeSourceIndex:e,allPlaceholder:g}=this;return-1===e?g??"":a.at(e)?.placeholder??""}set searchTerm(a){this._set("searchTerm",a||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==a&&this._set("selectedSuggestion",null);""===a&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":
0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight();this._closePopup();const {view:a,resultGraphic:e}=this;a&&e&&a.graphics.remove(e);this._set("resultGraphic",null)}search(a,e){this.emit("search-start");this.clearGraphics();const g=this._createSuggestionForSearch(a);return this._searching=a=(async()=>{try{await this.when();const p=await this._getResultsFromSources(g,e);if(e?.signal?.aborted)return null;
const A={activeSourceIndex:this.activeSourceIndex,searchTerm:g.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(A,p,g);const N=this._getFirstResult(A.results),T=(g.location&&N?N.name:g.text)?.replace(X,"");this._set("searchTerm",T);(g.key&&"number"===typeof g.sourceIndex||g.location)&&this._set("selectedSuggestion",g);this._set("results",A.results);this._set("resultCount",A.results.reduce((V,M)=>V+(M.results?.length??0),0));this.emit("search-complete",A);await this._selectFirstResult(N);
return A}finally{this._clearSearching()}})()}async searchNearby(a){if(!this.locationEnabled){var e=new t("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});D.getLogger(this).error(e);throw e;}return this._searching=e=(async()=>{try{const g=await R.getCurrentPosition(),p=await R.positionToPoint({position:g,view:this.view},a);return await this.search(p,a)}finally{this._clearSearching()}})()}async select(a){this.clearGraphics();if(!a)throw a=
new t("select:missing-parameter","Cannot select without a searchResult.",{searchResult:a}),D.getLogger(this).error(a),a;const {view:e}=this,g=J(a,"sourceIndex")?a.sourceIndex:this._getSourceIndexOfResult(a),p=null!=g?this.allSources.at(g):null;if(!p)throw a=new t("select:missing-source","Cannot select without a source.",{source:p}),D.getLogger(this).error(a),a;var A=p instanceof c?this._getLayerSourcePopupTemplate(p):p.popupTemplate,N=p.resultSymbol||this._getDefaultSymbol(a);const T=J(p,"resultGraphicEnabled")?
p.resultGraphicEnabled:this.resultGraphicEnabled;var V=J(p,"autoNavigate")?p.autoNavigate:this.autoNavigate,M=J(p,"popupEnabled")?p.popupEnabled:this.popupEnabled;const Z=M?A||this.popupTemplate||this.defaultPopupTemplate:null,{feature:da}=a;if(!da)throw a=new t("select:missing-feature","Cannot select without a feature.",{feature:da}),D.getLogger(this).error(a),a;const {attributes:ea,geometry:W,layer:aa,sourceLayer:fa}=da;A=W?S.getPointFromGeometry(W):null;A={layerViewQuery:this._getLayerView(da),
elevationQuery:e&&null!=A?S.getPointWithElevation(A,e):Promise.resolve(A)};var ha=await C.eachAlways(A);A=ha.layerViewQuery.value;ha=ha.elevationQuery.value;N instanceof O&&(N.text=a.name);V=e&&V?a.target||a.extent:null;await (null!=V?this._goToSearchResult(V):Promise.resolve());N=A?da:new m({geometry:W,symbol:N,attributes:ea,layer:aa,sourceLayer:fa,popupTemplate:Z});(M=(V=e?.popup)&&M&&N.getEffectivePopupTemplate(V.defaultPopupTemplateEnabled))&&await e.openPopup({features:[N],location:ha});A&&ca.highlightsSupported(A)&&
!M&&this._highlightFeature({graphic:N,layerView:A});!A&&T&&e&&e.graphics.push(N);this._setResultFloor(a);this._set("selectedResult",a);this._set("resultGraphic",N);this.emit("select-result",{result:a,source:p,sourceIndex:g});return a}async suggest(a,e,g){a=a||this.searchTerm;this.emit("suggest-start",{searchTerm:a});await this._suggestTimer(e,g);e=await this._suggestImmediate(a,g);this._set("suggestions",e?.results);this._set("suggestionCount",e?.results.reduce((p,A)=>p+(A.results?.length??0),0)??
null);this.emit("suggest-complete",e);return e}async when(){await I.whenOnce(()=>!this.updating)}async _update(){const {portal:a,view:e}=this;if(this.includeDefaultSources){const g=this._updatingPromise=C.eachAlways([a?.load(),e?.when()]);if(this.destroyed)return;await g;if(g!==this._updatingPromise)return}await I.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const a=this.portal?.helperServices?.geocode;
return a?a.map(e=>{if(!1!==e.placefinding){var g=n.apiKey&&H.isArcGISWorldGeocoder(e.url)?{url:H.meteredArcGISLocatorUrl}:null;e=f.fromJSON({...e,...g});g=e.url;if(H.isArcGISWorldGeocoder(g)||H.isProxiedArcGISWorldGeocoder(g)||H.isMeteredArcGISWorldGeocoder(g)){g=e.outFields??["Addr_type","Match_addr","StAddr","City"];const p=(e.placeholder||this.messages?.placeholder)??"",A="number"===typeof e.defaultZoomScale?e.defaultZoomScale:2500;e.singleLineFieldName="SingleLine";e.outFields=g;e.placeholder=
p;e.defaultZoomScale=A}if(e.singleLineFieldName)return e}}).filter(k.isSome):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(a=>a?.destroy());this._createdFeatureLayers=[]}_getLayerSources(a,e){const g=this.view?.map;return a.map(p=>{const A=g.findLayerById(p.id);if(A){p=this._getLayerJSON(p);var N=c.fromJSON(p);N.placeholder=e;this._getLayer(A,p).then(T=>{N.layer=T});return N}}).filter(k.isSome).toArray()}_getTableSources(a,e){const g=this.view?.map;return a.map(p=>{if(p.id){var A=
g.findTableById(p.id);if(A){p=this._getLayerJSON(p);var N=c.fromJSON(p);N.placeholder=e;this._getLayer(A,p).then(T=>{N.layer=T});return N}}}).filter(k.isSome).toArray()}_convertApplicationProperties(){var a=this.view?.map?.applicationProperties?.viewing?.search;if(!a)return[];const {enabled:e,hintText:g,layers:p,tables:A}=a;if(!e)return[];a=this._getLayerSources(p,g);const N=this._getTableSources(A,g);return[...a,...N]}async _getSubLayer(a,e){await a.load();if(!a.allSublayers)throw Error();a=a.allSublayers.find(g=>
g.id===e.subLayer);if(!a)throw Error();a=await a.createFeatureLayer?.();if(!a)throw Error();this._createdFeatureLayers.push(a);return a}async _getBuildingSubLayer(a,e){await a.load();a=a.allSublayers.find(g=>g.id===e.subLayer);if("building-component"!==a?.type)throw Error();await a.load();if(null==a.associatedLayer)throw Error();await a.associatedLayer.load();return a}async _getLayer(a,e){if("feature"===a.type||"scene"===a.type||"csv"===a.type||"geojson"===a.type||"ogc-feature"===a.type)return a;
if("map-image"===a.type)try{return await this._getSubLayer(a,e)}catch(g){return a=new t("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:a}),D.getLogger(this).error(a),null}return"building-scene"===a.type?this._getBuildingSubLayer(a,e):null}_getLayerJSON(a){return"function"===typeof a.toJSON?a.toJSON():a}_updateDefaultSources(){const {defaultSources:a,includeDefaultSources:e}=this;this._destroyFeatureLayers();a.removeAll();e&&a.addMany([...this._convertApplicationProperties(),
...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort();this._gotoController=null}_clear(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")}_closePopup(){const a=this.view?.popup,{resultGraphic:e}=this;if(a&&e){var g="selectedFeature"in a,p=g?a.selectedFeature:null;g&&p&&p===
e&&a.close()}}_suggestTimer(a,e){return C.after(null!=a?a:this.suggestionDelay,null,e?.signal)}_createLocationForSearch(a){return a instanceof m&&a.geometry?S.getPointFromGeometry(a.geometry):a instanceof w?a:Array.isArray(a)&&2===a.length?new w({longitude:a[0],latitude:a[1]}):null}_createSuggestionForSearch(a){if(a&&J(a,"key")&&J(a,"text")&&J(a,"sourceIndex"))return a;const e=this._createLocationForSearch(a),g="string"===typeof a?a:this.searchTerm,{selectedSuggestion:p,selectedResult:A}=this,N=(a=
!a&&p&&A)&&p.location;return a&&p.key===A.key&&p.sourceIndex===A.sourceIndex||N?p:{location:e,text:e?"":g,sourceIndex:null,key:null}}_getFirstResult(a){return y.mappedFind(a,({results:e})=>e?.[0])??null}async _selectFirstResult(a){return this.autoSelect&&a?this.select(a):null}async _suggestImmediate(a,e){await this.when();const g=await this._getSuggestionsFromSources(a,e);if(e?.signal?.aborted)return null;a={activeSourceIndex:this.activeSourceIndex,searchTerm:a??"",numResults:0,numErrors:0,errors:[],
results:[]};this._formatResponse(a,g);return a}_formatSourceResponse(a,e,g){const p=e?.value||[];e=e?.error;const A=this.allSources.at(g);e?(a.errors.push({sourceIndex:g,source:A,error:e}),D.getLogger(this).error(e),a.numErrors++):(a.results.push({sourceIndex:g,source:A,results:p}),a.numResults+=p.length)}_formatResponse(a,e,g){if(e)if(-1===a.activeSourceIndex){const p=g&&J(g,"sourceIndex")&&-1!==g.sourceIndex?g.sourceIndex:void 0;e.forEach((A,N)=>{this._formatSourceResponse(a,A,void 0!==p?p:N)})}else this._formatSourceResponse(a,
e[0],a.activeSourceIndex)}async _getResultsFromSources(a,e){var {allSources:g}=this;const p=!a.location&&J(a,"sourceIndex")?a.sourceIndex:this.activeSourceIndex,A=[];if(!g.length)throw g=new t("search:no-sources-defined","At least one source is required.",{allSources:g}),D.getLogger(this).error(g),g;-1===p?g.forEach((N,T)=>{A.push(this._getResultsFromSource(a,T,e))}):A.push(this._getResultsFromSource(a,p,e));return C.eachAlways(A)}async _getSuggestionsFromSources(a,e){const {allSources:g,activeSourceIndex:p}=
this,A=[];if(!g.length){const N=new t("suggest:no-sources-defined","At least one source is required.",{allSources:g});D.getLogger(this).error(N);throw N;}-1===p?g.forEach((N,T)=>{A.push(this._getSuggestionsFromSource(a,T,e))}):A.push(this._getSuggestionsFromSource(a,p,e));return C.eachAlways(A)}async _getResultsFromSource(a,e,g){const p=null!=e?this.allSources.at(e):null;if(!p)return null;const {location:A=null}=a,N=this.view?.spatialReference||K,T=J(p,"maxResults")?p.maxResults:this.maxResults,V=
p instanceof c&&J(p,"exactMatch")?p.exactMatch:!1,{view:M}=this;return p.getResults?.({view:M,sourceIndex:e,location:A,suggestResult:a,spatialReference:N,exactMatch:V,maxResults:T},g)}async _getSuggestionsFromSource(a,e,g){const p=this.allSources.at(e);if(!p)return null;a??="";var A=J(p,"suggestionsEnabled")?p.suggestionsEnabled:this.suggestionsEnabled,N=a?.length,T=J(p,"minSuggestCharacters")?p.minSuggestCharacters:this.minSuggestCharacters;if(A&&a.trim()&&N>=T){A=this.view?.spatialReference||K;
N=J(p,"maxSuggestions")?p.maxSuggestions:this.maxSuggestions;({view:T}=this);const V=p instanceof c&&J(p,"exactMatch")?p.exactMatch:!1;return p.getSuggestions?.({view:T,sourceIndex:e,suggestTerm:a,spatialReference:A,maxSuggestions:N,exactMatch:V},g)}return null}_getLayerSourcePopupTemplate(a){const {layer:e}=a;if(e)return J(a,"popupTemplate")?a.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(a){return y.mappedFind(this.results??[],({results:e,sourceIndex:g})=>e?.includes(a)?g:null)??null}async _goToSearchResult(a){this._abortGoTo();
var e=new AbortController;this._gotoController=e;e={target:{target:a},options:{signal:e.signal}};a||(e.options.animate=!1);await this.callGoTo(e);this._gotoController=null}_getDefaultSymbol(a){const {defaultSymbols:e}=this;a=a.feature?.geometry;if(null==a)return null;switch(a.type){case "point":case "multipoint":return e.point;case "polyline":return e.polyline;case "extent":case "polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles("highlight")}async _getLayerView(a){const {view:e}=
this;if(!a||!e||"building-component"===a.layer?.type||"subtype-sublayer"===a.layer?.type)return null;({layer:a}=a);if(!a)return null;await e.when();return e.whenLayerView(a)}_highlightFeature(a){const {graphic:e,layerView:g}=a,{attributes:p,layer:A}=e;({objectIdField:a}=A);a=g.highlight((a&&p?.[a])??null??e);this.addHandles(a,"highlight")}_setResultFloor(a){const {view:e}=this;var g=a.feature?.attributes;(a=a.feature?.sourceLayer)&&"floorInfo"in a&&a?.floorInfo?.floorField&&g&&(g=g[a.floorInfo.floorField],
e?.emit("select-result-floor",g))}};h.ALL_INDEX=-1;b.__decorate([u.property()],h.prototype,"_searching",void 0);b.__decorate([u.property()],h.prototype,"_updatingPromise",void 0);b.__decorate([u.property({readOnly:!0,value:null})],h.prototype,"activeSource",null);b.__decorate([u.property()],h.prototype,"activeSourceIndex",null);b.__decorate([u.property()],h.prototype,"allPlaceholder",null);b.__decorate([u.property({readOnly:!0})],h.prototype,"allSources",null);b.__decorate([u.property()],h.prototype,
"autoNavigate",void 0);b.__decorate([u.property()],h.prototype,"autoSelect",void 0);b.__decorate([u.property()],h.prototype,"defaultPopupTemplate",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"defaultSources",void 0);b.__decorate([u.property()],h.prototype,"defaultSymbols",void 0);b.__decorate([u.property()],h.prototype,"includeDefaultSources",void 0);b.__decorate([u.property()],h.prototype,"locationEnabled",null);b.__decorate([u.property()],h.prototype,"maxInputLength",void 0);b.__decorate([u.property()],
h.prototype,"maxResults",void 0);b.__decorate([u.property()],h.prototype,"maxSuggestions",void 0);b.__decorate([u.property()],h.prototype,"messages",void 0);b.__decorate([u.property()],h.prototype,"minSuggestCharacters",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"placeholder",null);b.__decorate([u.property()],h.prototype,"popupEnabled",void 0);b.__decorate([u.property({type:x})],h.prototype,"popupTemplate",void 0);b.__decorate([u.property({type:ba})],h.prototype,"portal",void 0);
b.__decorate([u.property()],h.prototype,"resultCount",void 0);b.__decorate([u.property()],h.prototype,"resultGraphicEnabled",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"resultGraphic",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"results",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"selectedSuggestion",void 0);b.__decorate([u.property()],h.prototype,"searchAllEnabled",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"selectedResult",void 0);
b.__decorate([u.property()],h.prototype,"searchTerm",null);b.__decorate([u.property({type:U})],h.prototype,"sources",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"state",null);b.__decorate([u.property()],h.prototype,"suggestionDelay",void 0);b.__decorate([u.property()],h.prototype,"suggestionCount",void 0);b.__decorate([u.property({readOnly:!0})],h.prototype,"suggestions",void 0);b.__decorate([u.property()],h.prototype,"suggestionsEnabled",void 0);b.__decorate([u.property({readOnly:!0})],
h.prototype,"updating",null);b.__decorate([u.property()],h.prototype,"view",void 0);b.__decorate([u.property()],h.prototype,"clear",null);return h=b.__decorate([E.subclass("esri.widgets.Search.SearchViewModel")],h)})},"esri/geometry/support/geometryUtils":function(){define(["exports","../../geometry","./scaleUtils","../Extent"],function(b,d,n,m){function x(h,v,k){const B=h.hasZ?h.z:void 0;if(v?.map)return(null!=k?n.getExtentForScale(v,k):v.extent).clone().centerAt(h).set({zmax:B,zmin:B});const {x:t,
y:L,spatialReference:D}=h;return new m({xmin:t-.25,ymin:L-.25,xmax:t+.25,ymax:L+.25,spatialReference:D,zmin:B,zmax:B})}b.createExtentFromGeometry=function(h,v,k){switch(h?.type){case "extent":return h;case "multipoint":case "polygon":case "polyline":return h.extent;case "point":return x(h,v,k);default:return null}};b.createExtentFromPoint=x;b.getPointFromGeometry=function(h){switch(h?.type){case "point":return h;case "extent":return h.center;case "polygon":return h.centroid;case "multipoint":case "polyline":return h.extent?.center;
default:return null}};b.getPointWithElevation=async function(h,v){if(h.hasZ||"2d"===v.type)return h;const k=v.map?.ground;if(!k?.layers.length)return h;({geometry:h}=await k.queryElevation(h,{cache:v.basemapTerrain?.elevationQueryCache}));return h};b.scaleExtent=function(h,v,k){return x(h.center,v,k)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(b,d,n){function m(x,
h){h=n.getMetersPerUnitForSR(h);return x/(h*n.inchesPerMeter*96)}b.getExtentForScale=function(x,h){const v=x.extent;x=x.width-(x.padding?x.padding.left+x.padding.right:0);h=m(h,v.spatialReference);return v.clone().expand(h*x/v.width)};b.getResolutionForScale=m;b.getResolutionInMetersForScale=function(x){return x/(96*n.inchesPerMeter)};b.getScale=function(x,h){h=h||x.extent;x=x.width;const v=n.getMetersPerUnitForSR(h?.spatialReference);return h&&x?h.width/x*v*n.inchesPerMeter*96:0};b.getScaleForResolution=
function(x,h){h=n.getMetersPerUnitForSR(h);return x*h*n.inchesPerMeter*96};b.isInScaleRange=function(x,h,v){if(h=0===h||d.floatEqualAbsolute(x,h)||x<h)h=0===v||d.floatEqualAbsolute(x,v)||x>v;return h};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(b,d,n,m,x,h,v,k){var B;m=B=class extends v{constructor(t){super(t);this.suggestionTemplate=this.searchTemplate=this.searchFields=this.orderByFields=this.exactMatch=this.displayField=null;this.getResults=(L,D)=>k.getResults({source:this,...L},D);this.getSuggestions=(L,D)=>k.getSuggestions({source:this,...L},D)}set layer(t){this._set("layer",t);t&&t.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(t){this._overrideIfSome("name",t)}clone(){return new B({autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?d.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,
exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?d.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(t=>"string"===t.type)?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const {layer:t,searchFields:L}=this;return t.loaded?`: ${(L||[this._getDisplayField()]).map(D=>t.getField(D)?.alias||
D).join(", ")}`:""}_getLayerTitle(){var {layer:t}=this;if(t&&({title:t}=t,t))return`${t}${this._getSearchFieldsString()}`}};b.__decorate([n.property({json:{read:{source:"field.name"},write:{target:"field.name"}}})],m.prototype,"displayField",void 0);b.__decorate([n.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],m.prototype,"exactMatch",void 0);b.__decorate([n.property({value:null})],m.prototype,"layer",null);b.__decorate([n.property()],m.prototype,"name",null);
b.__decorate([n.property({type:[String],json:{write:!0}})],m.prototype,"orderByFields",void 0);b.__decorate([n.property()],m.prototype,"searchFields",void 0);b.__decorate([n.property()],m.prototype,"searchTemplate",void 0);b.__decorate([n.property()],m.prototype,"suggestionTemplate",void 0);return m=B=b.__decorate([h.subclass("esri.widgets.Search.LayerSearchSource")],m)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,n,m,x,h,v,k){d=class extends d.IdentifiableMixin(n.JSONSupport){constructor(B){super(B);this.outFields=this.minSuggestCharacters=this.maxSuggestions=this.maxResults=this.getSuggestions=this.getResults=this.filter=this.autoNavigate=null;this.placeholder="";this.popupTemplate=this.popupEnabled=null;this.prefix="";this.suggestionsEnabled=this.resultSymbol=this.resultGraphicEnabled=null;this.suffix="";this.withinViewEnabled=!1;this.zoomScale=null}};b.__decorate([m.property()],d.prototype,
"autoNavigate",void 0);b.__decorate([m.property()],d.prototype,"filter",void 0);b.__decorate([m.property()],d.prototype,"getResults",void 0);b.__decorate([m.property()],d.prototype,"getSuggestions",void 0);b.__decorate([m.property()],d.prototype,"maxResults",void 0);b.__decorate([m.property()],d.prototype,"maxSuggestions",void 0);b.__decorate([m.property()],d.prototype,"minSuggestCharacters",void 0);b.__decorate([m.property()],d.prototype,"outFields",void 0);b.__decorate([m.property()],d.prototype,
"placeholder",void 0);b.__decorate([m.property()],d.prototype,"popupEnabled",void 0);b.__decorate([m.property()],d.prototype,"popupTemplate",void 0);b.__decorate([m.property()],d.prototype,"prefix",void 0);b.__decorate([m.property()],d.prototype,"resultGraphicEnabled",void 0);b.__decorate([m.property()],d.prototype,"resultSymbol",void 0);b.__decorate([m.property()],d.prototype,"suggestionsEnabled",void 0);b.__decorate([m.property()],d.prototype,"suffix",void 0);b.__decorate([m.property()],d.prototype,
"withinViewEnabled",void 0);b.__decorate([m.property()],d.prototype,"zoomScale",void 0);return d=b.__decorate([k.subclass("esri.widgets.Search.SearchSource")],d)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../intl ../../../core/Error ../../../core/has ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/unitUtils ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/support/FullTextSearch ../../../intl/substitute ../../../intl/date".split(" "),
function(b,d,n,m,x,h,v,k,B,t,L,D,y){function C(r,F){const {filter:z,withinViewEnabled:O}=r;r=F?.extent;return z?.geometry??(O&&r?r:void 0)}async function I(r){r&&await r.load()}function u(r,F){return(r=r?.indexes)&&F?.length?r.filter(z=>"FullText"===z.indexType).some(z=>{const O=z.fields?.split(",").map(J=>J.trim().toLowerCase())||[];return F.every(J=>O.includes(J.toLowerCase()))}):!1}function l({text:r,searchFields:F}){return r.trim().split(" ").filter(z=>!!z.trim()).map(z=>new L({onFields:F,searchTerm:z,
searchType:"prefix"}))}function E(r){return r?.fieldsIndex?.fields?.find(F=>"string"===F.type)?.name??""}function w(r,F){return r&&F?.length?F.every(z=>!!r.getField(z)):!1}function Q({codedValues:r},F,z){return v.mappedFind(r??[],O=>{var J=O.name;J=z?J:J.toLowerCase();return(z?F:F.toLowerCase())===J?O.code.toString():null})??null}function S(r,F){return(F=F?.where)?`(${r}) AND (${F})`:r}function G({currentTerm:r,field:F,filter:z,exactMatch:O,url:J,type:U}){var K=F?.type;F=F?.name;if("string"===K||
"date"===K||"global-id"===K){if(K=J=H.test(J??""))a:{for(K=0;K<r.length;K++)if(255<r.charCodeAt(K)){K=!0;break a}K=!1}K=K?"N":"";if(O&&"search"===U)return S(`${F} = ${K}'${r}'`,z);if(J)return S(`${F} LIKE ${K}${`'${r}%'`}`,z);O=`LOWER(${F})`;r=r.toLowerCase();return S(`${O} LIKE ${K}${`'${r}%'`}`,z)}return"oid"===K||"small-integer"===K||"integer"===K||"single"===K||"double"===K?(r=Number(r),isNaN(r)?null:S(`${F} = ${r}`,z)):S(`${F} = ${r}`,z)}function Y({searchTerm:r,layer:F,searchFields:z,filter:O,
exactMatch:J,query:U,type:K}){const {definitionExpression:X,url:a}=F;let e="";!U.fullText&&r&&z&&z.forEach(g=>{var p=F.getField(g);g=((g=F.getFieldDomain?.(g,{excludeImpliedDomains:m("esri-widget-legacy-field-domain-calculation")}))&&"coded-value"===g.type?Q(g,r,J):null)||r||null;null!==g&&(p=G({currentTerm:g,field:p,filter:O,exactMatch:J,url:a,type:K}))&&(e+=e?` OR (${p})`:`(${p})`)});return X&&e?`(${X}) AND (${e})`:X||e}function ba(r,F){let z=null;({codedValues:r}=r);r&&r.length&&r.some(O=>O.code===
F?(z=O.name,!0):!1);return z}function ca(r,F){return r[F]??r[Object.keys(r).find(z=>z.toLowerCase()===F.toLowerCase())]}function c(r,F,z){const O=r.sourceLayer,{attributes:J}=r;r=O.getFieldDomain?.(z,{feature:r,excludeImpliedDomains:m("esri-widget-legacy-field-domain-calculation")});return F?D.substitute(F,J):z&&J?(F=O.getField(z),z=ca(J,z),null==z?"":r&&"coded-value"===r.type?ba(r,z)??"":"date"===F?.type?y.formatDate(new Date(z)):"number"===typeof z?z.toString():"string"!==typeof z?"":z.trim()):
""}function f(r,F,z,O){return r.features.map(J=>{var U=J.sourceLayer,{attributes:K}=J;({objectIdField:U}=U);K=U?K[U]:null;return{text:c(J,F.suggestionTemplate,O),key:K,sourceIndex:z}})}function q(r,F,z,O,J,U,K){return r.features.map(X=>{var a=U;const e=X.clone(),g=X.sourceLayer;var p=g?.objectIdField;p=p?X.attributes[p]:null;const A=c(X,z.searchTemplate,J);null!=a&&null!=g&&null!=g.minScale&&null!=g.maxScale&&(g.minScale&&g.minScale<a?a=g.minScale:g.maxScale&&g.maxScale>a&&(a=g.maxScale));a=e.geometry?
t.createExtentFromGeometry(e.geometry,F??void 0,a??void 0):void 0;a="number"===typeof K&&a?t.scaleExtent(x.clone(a),F??void 0,K):a;X=X.clone();null!=a&&(X.geometry=B.fromExtent(a));return{extent:a,target:X,feature:e,key:p,name:A,sourceIndex:O}})}const H=/https?:\/\/services.*\.arcgis\.com/i,R=/(?:\{([^}]+)\})/g,P=()=>h.getLogger("esri.widgets.Search.support.layerSearchUtils");b.createFullTextSearchInfos=l;b.getResults=function(r,F){const {exactMatch:z=!1,location:O,maxResults:J,spatialReference:U,
source:K,sourceIndex:X,suggestResult:a,view:e}=r,{layer:g,filter:p,zoomScale:A}=K,N=e?.scale,T=C(K,e),V=F?.signal;return I(g).then(()=>{const M=g.popupTemplate;return M?M.getRequiredFields(g.fieldsIndex):null}).then(M=>{const {objectIdField:Z,returnZ:da}=g,ea=K.displayField||K.layer.displayField||E(K.layer);if(!g.getField(ea))throw P().error("invalid-field: displayField is invalid."),new n("getResults():invalid-field","displayField is invalid.");M=M?.length?M:[ea];var W=K.outFields||M;M=W&&W.includes("*");
W.includes(Z)||M||W.push(Z);g.floorInfo?.floorField&&W.push(g.floorInfo.floorField);if(!M&&!w(g,W))throw P().error("invalid-field: outField is invalid."),new n("getResults():invalid-field","outField is invalid.");M=g.createQuery();var {orderByFields:aa}=K;aa&&(M.orderByFields=aa);U&&(M.outSpatialReference=U,aa=1/k.getMetersPerUnitForSR(U))&&(M.maxAllowableOffset=aa);aa="mesh"===g.geometryType||"multipatch"===g.geometryType;M.returnZ=g.capabilities?.data?.supportsZ&&!aa&&!1!==da;M.returnGeometry=!0;
M.multipatchOption=aa?"xyFootprint":null;W&&(M.outFields=W);if(O)M.geometry=O;else if(a.key)M.objectIds=[a.key];else{W=K.searchFields||[ea];if(!w(g,W))throw P().error("invalid-field: search field is invalid."),new n("getResults():invalid-field","search field is invalid.");(g?.capabilities?.query?.supportsPagination??!1)&&(M.num=J);T&&(M.geometry=T);if(!a.text?.trim())return[];aa=a.text;const {prefix:fa="",suffix:ha=""}=K,ia=`${fa}${aa}${ha}`.replaceAll("'","''");(g?.capabilities?.query?.supportsFullTextSearch??
!1)&&u(g,W)&&!z&&aa&&(M.fullText=l({text:aa,searchFields:W}));W=Y({searchTerm:ia,layer:g,searchFields:W,filter:p,exactMatch:z,query:M,type:"search"});M.where=W;if(!M.fullText&&!M.where)return[]}return g.queryFeatures(M,{signal:V}).then(fa=>q(fa,e,K,X,ea,N,A))})};b.getSuggestions=function(r,F){const {source:z,spatialReference:O,view:J,suggestTerm:U,maxSuggestions:K,sourceIndex:X,exactMatch:a}=r,{layer:e,filter:g}=z,p=F?.signal,A=C(z,J);return I(e).then(()=>{if(!(e?.capabilities?.query?.supportsPagination??
!1))return[];const N=z.displayField||z.layer.displayField||E(z.layer);var T=z.searchFields||[N];const V=[];z.suggestionTemplate?z.suggestionTemplate.replaceAll(R,(aa,fa)=>{V.push(fa);return aa}):V.push(N);var M=V&&V.includes("*");V.includes(e.objectIdField)||M||V.push(e.objectIdField);var Z=!!e.getField(N);M=M||w(e,V);const da=w(e,T);if(!Z)throw P().error("invalid-field: displayField is invalid."),new n("getSuggestions():invalid-field","displayField is invalid.");if(!M)throw P().error("invalid-field: outField is invalid."),
new n("getSuggestions():invalid-field","outField is invalid.");if(!da)throw P().error("invalid-field: search field is invalid."),new n("getSuggestions():invalid-field","search field is invalid.");Z=e.createQuery();({orderByFields:M}=z);M&&(Z.orderByFields=M);Z.outSpatialReference=O;Z.returnGeometry=!1;Z.num=K;Z.outFields=V;A&&(Z.geometry=A);if(!U.trim())return[];const {prefix:ea="",suffix:W=""}=z;M=`${ea}${U}${W}`.replaceAll("'","''");(e?.capabilities?.query?.supportsFullTextSearch??!1)&&u(e,T)&&
!a&&U&&(Z.fullText=l({text:U,searchFields:T}));T=Y({searchTerm:M,layer:e,searchFields:T,filter:g,exactMatch:a,query:Z,type:"suggest"});Z.where=T;return Z.fullText||Z.where?e.queryFeatures(Z,{signal:p}).then(aa=>f(aa,z,X,N)):[]})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/locatorUtils".split(" "),
function(b,d,n,m,x,h,v,k){var B;m=B=class extends v{constructor(t){super(t);this.defaultZoomScale=this.countryCode=this.categories=this.apiKey=null;this.localSearchDisabled=!1;this.locationType=null;this.searchTemplate=this.placeholder=this.name="";this.zoomScale=this.url=this.suggestionsEnabled=this.singleLineFieldName=null;this.getResults=(L,D)=>k.getResults({source:this,...L},D);this.getSuggestions=(L,D)=>k.getSuggestions({source:this,...L},D)}clone(){return new B({apiKey:this.apiKey,autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?d.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?d.clone(this.categories):
null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};b.__decorate([n.property()],m.prototype,"apiKey",void 0);b.__decorate([n.property()],m.prototype,"categories",void 0);b.__decorate([n.property()],m.prototype,"countryCode",void 0);b.__decorate([n.property({json:{write:!0}})],m.prototype,"defaultZoomScale",void 0);b.__decorate([n.property()],m.prototype,"localSearchDisabled",void 0);
b.__decorate([n.property()],m.prototype,"locationType",void 0);b.__decorate([n.property({json:{write:!0}})],m.prototype,"name",void 0);b.__decorate([n.property({json:{write:!0}})],m.prototype,"placeholder",void 0);b.__decorate([n.property()],m.prototype,"searchTemplate",void 0);b.__decorate([n.property({json:{write:!0}})],m.prototype,"singleLineFieldName",void 0);b.__decorate([n.property({json:{read:{source:"suggest"},write:{target:"suggest"}}})],m.prototype,"suggestionsEnabled",void 0);b.__decorate([n.property({json:{write:!0}})],
m.prototype,"url",void 0);b.__decorate([n.property({json:{write:!0}})],m.prototype,"zoomScale",void 0);return m=B=b.__decorate([h.subclass("esri.widgets.Search.LocatorSearchSource")],m)})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters".split(" "),
function(b,d,n,m,x,h,v,k,B,t){function L(l,E){if(E.localSearchDisabled)return null;E=l?.scale;return"number"===typeof E&&3E5>=E?l?.extent?.center:null}async function D(l,E){const {source:w,spatialReference:Q,location:S,sourceIndex:G,view:Y}=l,{apiKey:ba,url:ca,zoomScale:c,defaultZoomScale:f}=w;if(null==ca)return[];l=Y?.scale;E=E?.signal;const q=new B({location:S});ba&&(q.apiKey=ba);Q&&(q.outSpatialReference=Q);try{const H=await h.locationToAddress(ca,q,{signal:E});return u([H],{sourceIndex:G,scale:l,
view:Y,zoomScale:c,defaultZoomScale:f})}catch(H){return[]}}function y(l,E){const {filter:w,withinViewEnabled:Q}=l;l=E?.extent;const S=w?.geometry;return(E=S?m.createExtentFromGeometry(S,E??void 0,E?.scale):void 0)||(Q&&l?l:void 0)}async function C(l,E){const {source:w,suggestResult:Q,spatialReference:S,view:G,maxResults:Y,sourceIndex:ba}=l,ca=w?.zoomScale,c=w?.defaultZoomScale;if(!Q.text?.trim())return null;l=`${!Q.key&&w.prefix?w.prefix:""}${Q.text}${!Q.key&&w.suffix?w.suffix:""}`;const f=new k,
{apiKey:q,url:H}=w,R=G?.scale;var P=y(w,G);E=E?.signal;q&&(f.apiKey=q);if(!H)return null;w.categories&&(f.categories=w.categories);w.locationType&&(f.locationType=w.locationType);S&&(f.outSpatialReference=S);const r=L(G,w);r&&(f.location=r);f.maxLocations=Y;P&&(f.searchExtent=P);w.countryCode&&(f.countryCode=w.countryCode);({key:P}=Q);const F=`${P}`;P&&(f.magicKey=F);f.address={};f.address[w.singleLineFieldName||"Single Line Input"]=l;w.outFields&&(f.outFields=w.outFields);return x.addressToLocations(H,
f,{signal:E}).then(z=>u(z,{key:F,scale:R,sourceIndex:ba,view:G,zoomScale:ca,defaultZoomScale:c}))}function I(l,E){return l.map(w=>({text:w.text,key:w.magicKey,sourceIndex:E}))}function u(l,E){return l.filter(Boolean).map(w=>{const {key:Q,scale:S,sourceIndex:G,view:Y,zoomScale:ba,defaultZoomScale:ca}=E,{attributes:c,extent:f,location:q,address:H}=w;w=new d({geometry:q,attributes:c});var R=f||q,P=R?m.createExtentFromGeometry(R,Y??void 0,S??void 0):void 0;R=P?"number"===typeof ba?m.scaleExtent(P,Y??
void 0,ba):"number"===typeof ca&&"point"===R?.type?m.scaleExtent(P,Y??void 0,ca):P:null;P=q?`${q.x},${q.y}`:"";P=H||P;const r=w.clone();null!=R&&(r.geometry=n.fromExtent(R));return{extent:R,feature:w,target:r,key:Q,name:P,sourceIndex:G}})}b.getLocation=L;b.getResults=function(l,E){return l.location?D(l,E):C(l,E)};b.getSuggestions=async function(l,E){const {source:w,spatialReference:Q,view:S,suggestTerm:G,maxSuggestions:Y,sourceIndex:ba}=l;l=new t;const {apiKey:ca,url:c}=w,f=y(w,S);E=E?.signal;if(!c)return null;
ca&&(l.apiKey=ca);w.categories&&(l.categories=w.categories);Q&&(l.outSpatialReference=Q);const q=L(S,w);q&&(l.location=q);if(!G.trim())return null;const {prefix:H="",suffix:R=""}=w;l.text=`${H}${G}${R}`;f&&(l.searchExtent=f);l.maxSuggestions=Y;w.countryCode&&(l.countryCode=w.countryCode);return v.suggestLocations(c,l,{signal:E}).then(P=>I(P,ba))};b.isArcGISWorldGeocoder=function(l){return l?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(l):!1};b.isMeteredArcGISWorldGeocoder=
function(l){return l?/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(l):!1};b.isProxiedArcGISWorldGeocoder=function(l){return l?/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(l):!1};b.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/addressToLocations":function(){define("exports ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),
function(b,d,n,m,x,h){function v({data:k}){if(!k)return[];const {candidates:B,spatialReference:t}=k;return B?B.map(L=>{if(L){var {extent:D,location:y}=L,C=D?m.isValidExtent(D):!0;if(m.isValidLocation(y)&&C)return D&&(D.spatialReference=t),y&&(y.spatialReference=t),x.fromJSON(L)}}):[]}b.addressToLocations=async function(k,B,t){B=h.from(B);k=n.parseUrl(k);const {address:L,...D}=B.toJSON();B=n.encode({...k.query,...L,...D,f:"json"});t=n.asValidOptions(B,t);return d(`${k.path}/findAddressCandidates`,
t).then(v)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/utils":function(){define(["exports"],function(b){b.isValidExtent=function(d){return d&&"number"===typeof d.xmin&&"number"===typeof d.ymin&&"number"===typeof d.xmax&&"number"===typeof d.ymax};b.isValidLocation=function(d){return!!d&&"number"===typeof d.x&&"number"===typeof d.y};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(b,d,n,m,x,h,v,k,B){d=class extends d.JSONSupport{constructor(t){super(t);this.score=this.location=this.extent=this.attributes=this.address=null}};b.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"address",void 0);b.__decorate([n.property({type:Object,json:{write:!0}})],d.prototype,"attributes",void 0);b.__decorate([n.property({type:k,json:{write:!0}})],d.prototype,"extent",void 0);b.__decorate([n.property({type:B,json:{write:!0}})],d.prototype,"location",void 0);b.__decorate([n.property({type:Number,
json:{write:!0}})],d.prototype,"score",void 0);return d=b.__decorate([v.subclass("esri.rest.support.AddressCandidate")],d)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(b,d,n,m,x,h,v,k,B,t,L,D){d=class extends n.JSONSupport{constructor(y){super(y);this.searchExtent=this.outSpatialReference=this.outFields=this.maxLocations=this.magicKey=this.locationType=this.location=this.forStorage=this.countryCode=this.categories=this.apiKey=this.address=null}};b.__decorate([m.property({type:Object,json:{write:!0}})],d.prototype,"address",void 0);b.__decorate([m.property(B.apiKey)],d.prototype,"apiKey",void 0);b.__decorate([m.property({type:[String],json:{read:{source:"category",
reader:y=>y?y.split(","):null},write:{target:"category",writer:(y,C)=>{C.category=y?y.join(","):null}}}})],d.prototype,"categories",void 0);b.__decorate([m.property({type:String,json:{write:!0}})],d.prototype,"countryCode",void 0);b.__decorate([m.property({type:Boolean,json:{write:!0}})],d.prototype,"forStorage",void 0);b.__decorate([m.property({type:t,json:{write:{writer:(y,C)=>{C.location=y?y.clone().normalize():null}}}})],d.prototype,"location",void 0);b.__decorate([m.property({type:String,json:{write:!0}})],
d.prototype,"locationType",void 0);b.__decorate([m.property({type:String,json:{write:!0}})],d.prototype,"magicKey",void 0);b.__decorate([m.property({type:Number,json:{write:!0}})],d.prototype,"maxLocations",void 0);b.__decorate([m.property({type:[String],json:{write:{writer:(y,C)=>{C.outFields=y?y.join(","):null}}}})],d.prototype,"outFields",void 0);b.__decorate([m.property({type:L,json:{read:{source:"outSR"},write:{target:"outSR"}}})],d.prototype,"outSpatialReference",void 0);b.__decorate([m.property({type:D,
json:{write:{writer:(y,C)=>{y=y?y.shiftCentralMeridian():null;C.searchExtent=y}}}})],d.prototype,"searchExtent",void 0);d=b.__decorate([k.subclass("esri.rest.support.AddressToLocationsParameters")],d);d.from=x.ensureType(d);return d})},"esri/rest/support/commonProperties":function(){define(["exports"],function(b){b.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/locationToAddress":function(){define(["exports",
"../../request","../utils","../support/AddressCandidate","../support/LocationToAddressParameters"],function(b,d,n,m,x){function h({data:v}){if(v){var {address:k,location:B}=v;return m.fromJSON({address:k?.Match_addr||"",attributes:k||{},location:B,score:100})}}b.locationToAddress=async function(v,k,B){k=x.from(k);v=n.parseUrl(v);k={...k.toJSON(),f:"json"};k=n.encode({...v.query,...k});B=n.asValidOptions(k,B);return d(`${v.path}/reverseGeocode`,B).then(h)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference".split(" "),function(b,d,n,m,x,h,v,k,B,t,L){d=class extends n.JSONSupport{constructor(D){super(D);this.outSpatialReference=
this.locationType=this.location=this.apiKey=null}};b.__decorate([m.property(B.apiKey)],d.prototype,"apiKey",void 0);b.__decorate([m.property({type:t,json:{write:{writer:(D,y)=>{D=D?D.clone().normalize():null;y.location=void 0!==D?D:null}}}})],d.prototype,"location",void 0);b.__decorate([m.property({type:String,json:{write:!0}})],d.prototype,"locationType",void 0);b.__decorate([m.property({type:L,json:{read:{source:"outSR"},write:{target:"outSR"}}})],d.prototype,"outSpatialReference",void 0);d=b.__decorate([k.subclass("esri.rest.support.LocationToAddressParameters")],
d);d.from=x.ensureType(d);return d})},"esri/rest/locator/suggestLocations":function(){define(["exports","../../request","../utils","../support/SuggestionCandidate","../support/SuggestLocationsParameters"],function(b,d,n,m,x){function h(v){({data:v}=v);if(!v)return[];({suggestions:v}=v);return v?v.map(k=>new m(k)):[]}b.suggestLocations=async function(v,k,B){v=n.parseUrl(v);k=x.from(k);k={...k.toJSON(),f:"json"};k=n.encode({...v.query,...k});B=n.asValidOptions(k,B);return d(`${v.path}/suggest`,B).then(h)};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,d,n,m,x,h,v){d=class extends d.JSONSupport{constructor(k){super(k);this.text=this.magicKey=this.isCollection=null}};b.__decorate([n.property({type:Boolean,json:{write:!0}})],
d.prototype,"isCollection",void 0);b.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"magicKey",void 0);b.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"text",void 0);return d=b.__decorate([v.subclass("esri.rest.support.SuggestionCandidate")],d)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(b,d,n,m,x,h,v,k,B,t,L,D){d=class extends n.JSONSupport{constructor(y){super(y);this.text=this.searchExtent=this.outSpatialReference=this.maxSuggestions=this.location=this.countryCode=this.categories=this.apiKey=null}};b.__decorate([m.property(B.apiKey)],d.prototype,"apiKey",void 0);b.__decorate([m.property({type:[String],json:{read:{source:"category",reader:y=>y?y.split(","):null},write:{target:"category",writer:(y,C)=>{C.category=y?y.join(","):null}}}})],d.prototype,"categories",void 0);
b.__decorate([m.property({type:String,json:{write:!0}})],d.prototype,"countryCode",void 0);b.__decorate([m.property({type:t,json:{write:{writer:(y,C)=>{C.location=y?y.clone().normalize():null}}}})],d.prototype,"location",void 0);b.__decorate([m.property({type:Number,json:{write:!0}})],d.prototype,"maxSuggestions",void 0);b.__decorate([m.property({type:L,json:{read:{source:"outSR"},write:{target:"outSR"}}})],d.prototype,"outSpatialReference",void 0);b.__decorate([m.property({type:D,json:{write:{writer:(y,
C)=>{y=y?y.shiftCentralMeridian():null;C.searchExtent=JSON.stringify(y)}}}})],d.prototype,"searchExtent",void 0);b.__decorate([m.property({type:String,json:{write:!0}})],d.prototype,"text",void 0);d=b.__decorate([k.subclass("esri.rest.support.SuggestLocationsParameters")],d);d.from=x.ensureType(d);return d})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../rest/geometryService/project ../../rest/support/ProjectParameters".split(" "),
function(b,d,n,m,x,h,v,k,B,t){function L({longitude:l,latitude:E,altitude:w}){return new h({longitude:l,latitude:E,z:w||void 0,spatialReference:{wkid:4326}})}function D(l,E,w){if(!E)return Promise.resolve(l);const Q=E.spatialReference;return Q.isWGS84?Promise.resolve(l):Q.isWebMercator?Promise.resolve(v.geographicToWebMercator(l)):y(w).then(S=>{if(!S)throw new n("geometry-service:missing-url","Geometry service URL is missing");const G=new t({geometries:[l],outSpatialReference:Q});return B.project(S,
G,w).then(Y=>Y[0])})}function y(l){if(d.geometryServiceUrl)return Promise.resolve(d.geometryServiceUrl);const E=k.getDefault();return E.load(l).catch(()=>{}).then(()=>E.helperServices?.geometry?.url)}const C=()=>x.getLogger("esri.widgets.support.geolocationUtils"),I={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};let u;b.getCurrentPosition=function(l){l??=I;return new Promise((E,w)=>{setTimeout(()=>w(new n("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(E,
w,l??void 0)})};b.overridePositionToPoint=function(l){u=l};b.positionToPoint=function(l,E){if(u)return u(l,E);const {position:w,view:Q}=l;l=w&&w.coords||{};l={accuracy:l.accuracy,altitude:l.altitude,altitudeAccuracy:l.altitudeAccuracy,heading:l.heading,latitude:l.latitude,longitude:l.longitude,speed:l.speed};l=(w?{coords:l,timestamp:w.timestamp}:w)?.coords;if(!l)throw new n("geometry-service:no-coords","Geolocation has no coordinates");l=L(l);return D(l,Q,E)};b.supported=function(){var l=!!m("esri-geolocation");
l||C().warn("geolocation-unsupported","Geolocation unsupported.");l&&((l=window.isSecureContext)||C().warn("insecure-context","Geolocation requires a secure origin."));return l};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define("exports ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),function(b,d,n,m,x,h,v){const k=n.ensureType(v);b.project=
async function(B,t,L){t=k(t);B=x.parseUrl(B);const D={...B.query,f:"json",...t.toJSON()},y=t.outSpatialReference,C=m.getJsonType(t.geometries[0]);t=x.asValidOptions(D,L);return d(B.path+"/project",t).then(({data:{geometries:I}})=>h.decodeGeometries(I,C,y))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(b,d,n,m,x,h,v,k,B){d=class extends d.JSONSupport{constructor(t){super(t);this.geometries=[];this.transformForward=this.transformation=this.outSpatialReference=null}toJSON(){const t=this.geometries.map(y=>y.toJSON()),L=this.geometries[0],D={};D.outSR=B.srToRESTValue(this.outSpatialReference);D.inSR=B.srToRESTValue(L.spatialReference);D.geometries=JSON.stringify({geometryType:k.getJsonType(L),geometries:t});this.transformation&&(D.transformation=this.transformation.wkid||JSON.stringify(this.transformation));
null!=this.transformForward&&(D.transformForward=this.transformForward);return D}};b.__decorate([n.property()],d.prototype,"geometries",void 0);b.__decorate([n.property({json:{read:{source:"outSR"}}})],d.prototype,"outSpatialReference",void 0);b.__decorate([n.property()],d.prototype,"transformation",void 0);b.__decorate([n.property()],d.prototype,"transformForward",void 0);return d=b.__decorate([v.subclass("esri.rest.support.ProjectParameters")],d)})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,d,n,m,x,h,v,k){b.GoToMixin=B=>{B=class extends B{constructor(...t){super(...t);this.view=this.goToOverride=null}callGoTo(t){const {view:L}=this;n.assertIsSome(L);return this.goToOverride?this.goToOverride(L,t):L.goTo(t.target,t.options)}};d.__decorate([m.property()],B.prototype,"goToOverride",void 0);d.__decorate([m.property()],B.prototype,"view",void 0);return B=d.__decorate([k.subclass("esri.widgets.support.GoTo")],B)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],
function(b){b.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",
input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",
primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/legacyIcon":function(){define(["exports"],function(b){b.legacyIcon={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",
downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",
radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"*noref":1}});
define("../chunks/tslib.es6 ../intl ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/string ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Search/css ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(b,
d,n,m,x,h,v,k,B,t,L,D,y,C,I,u,l,E,w,Q,S,G,Y){const ba=/<[a-z/][\s\S]*>/i,ca=(c,f)=>{f=v.escapeRegExpString(f).split(/\s/);f=new RegExp(`(${f.join("|")})`,"gi");return c.replace(f,q=>`<strong>${q}</strong>`)};d=class extends y{constructor(c,f){super(c,f);this._activeMenuItemIndex=-1;this._focusAbortController=this._inputNode=null;this._menuItemCount=0;this._suggestionListNode=this._sourceListNode=this._sourceMenuButtonNode=null;this._searchResultRenderer=new I;this._searchController=this._suggestController=
null;this._locateFailed=!1;this._container=null;this.activeMenu="none";this.disabled=!1;this.messagesCommon=this.messages=null;this.viewModel=new u;this._clearActiveMenu=()=>{this.activeMenu="none"};this._removeActiveMenu=q=>{(q=q.relatedTarget)&&this._container?.contains(q)||this._clearActiveMenu()};this._renderSearchResultsContent=()=>this._searchResultRenderer;this.addHandles([x.watch(()=>this.searchTerm,q=>{(q&&"warning"===this.activeMenu||!q&&!this.viewModel?.selectedSuggestion?.location)&&this._clearActiveMenu()}),
x.on(()=>this.viewModel?.allSources,"change",()=>this._watchSourceChanges()),x.watch(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),x.initial),x.watch(()=>this.viewModel,q=>this._searchResultRenderer.viewModel=q,x.initial),x.watch(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),x.watch(()=>this.viewModel?.defaultPopupTemplate,q=>{q&&(q.content=this._renderSearchResultsContent)},x.initial)])}destroy(){this._cancelSuggest();this._cancelSearch();this._searchResultRenderer=
n.destroyMaybe(this._searchResultRenderer);this._focusAbortController?.abort()}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(c){this.viewModel.activeSourceIndex=
c}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(c){this.viewModel.allPlaceholder=c}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(c){this.viewModel.autoNavigate=c}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(c){this.viewModel.autoSelect=c}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(c){this.viewModel.goToOverride=
c}get icon(){return"search"}set icon(c){this._overrideIfSome("icon",c)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(c){this.viewModel.includeDefaultSources=c}get label(){return this.messages?.widgetLabel??""}set label(c){this._overrideIfSome("label",c)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(c){this.viewModel.locationEnabled=c}get maxResults(){return this.viewModel.maxResults}set maxResults(c){this.viewModel.maxResults=
c}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(c){this.viewModel.maxSuggestions=c}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(c){this.viewModel.minSuggestCharacters=c}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(c){this.viewModel.popupEnabled=c}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(c){this.viewModel.popupTemplate=c}get portal(){return this.viewModel?.portal}set portal(c){this.viewModel&&
(this.viewModel.portal=c)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(c){this.viewModel.resultGraphic=c}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(c){this.viewModel.resultGraphicEnabled=c}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(c){this.viewModel.searchAllEnabled=c}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(c){this.viewModel.searchTerm=
c}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(c){this.viewModel.sources=c}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(c){this.viewModel.suggestionsEnabled=c}get view(){return this.viewModel.view}set view(c){this.viewModel.view=c}clear(){this.viewModel.clear()}focus(){this._handleFocus();this.emit("search-focus")}async _handleFocus(){this._focusAbortController?.abort();
this._focusAbortController=new AbortController;await m.ignoreAbortErrors(h.waitAnimationFrame(this._focusAbortController.signal));this._inputNode?.focus()}blur(){this._inputNode?.blur();this.emit("search-blur")}async search(c){this._clearActiveMenu();this._cancelSuggest();this._cancelSearch();const f=new AbortController,{signal:q}=f;this._searchController=f;try{const H=await this.viewModel.search(c,{signal:q});if(this._searchController===f)return this.activeMenu=H?.numResults?"none":"warning",this._searchController=
null,H}catch(H){this._searchController===f&&(this._clearActiveMenu(),this._searchController=null)}}async suggest(c){this._cancelSuggest();const f=new AbortController,{signal:q}=f;this._suggestController=f;try{const H=await this.viewModel.suggest(c,null,{signal:q});if(this._suggestController===f)return this._suggestController=null,H?.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),H}catch(H){return this._suggestController!==f?null:this._suggestController=null}}render(){const {state:c}=
this.viewModel;return G.tsx("div",{class:this.classes(C.css.base,l.globalCss.widget,{[l.globalCss.disabled]:"disabled"===c,[l.globalCss.widgetDisabled]:this.disabled})},"loading"===c?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const {messages:c,disabled:f}=this;return G.tsx("button",{"aria-label":c.searchButtonTitle,bind:this,class:this.classes(C.css.submitButton,l.globalCss.widgetButton),disabled:f,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:c.searchButtonTitle,
type:"button"},G.tsx("span",{"aria-hidden":"true",class:E.legacyIcon.search}))}_renderWarningMenu(){return G.tsx("div",{class:this.classes(l.globalCss.menu,C.css.warningMenu),key:"esri-search__error-menu"},G.tsx("div",{class:C.css.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const {messages:c,activeMenu:f,sourceMenuId:q,sourceMenuButtonId:H,disabled:R}=this,{activeSourceIndex:P,allSources:r}=this.viewModel;return 1<r.length?G.tsx("button",{afterCreate:w.storeNode,"aria-controls":q,
"aria-expanded":("source"===f).toString(),"aria-haspopup":"true","aria-label":c.searchIn,bind:this,class:this.classes(C.css.sourcesButton,l.globalCss.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:R,id:H,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,title:c.searchIn,type:"button"},G.tsx("span",{"aria-hidden":"true",class:this.classes(E.legacyIcon.downArrow,C.css.sourcesButtonDown)}),G.tsx("span",{"aria-hidden":"true",
class:this.classes(E.legacyIcon.upArrow,C.css.sourcesButtonUp)}),G.tsx("span",{class:C.css.sourceName},this._getSourceName(P))):null}_renderSourcesList(){const {allSources:c,searchAllEnabled:f}=this.viewModel,{_activeMenuItemIndex:q,activeMenu:H,sourceMenuId:R,sourceMenuButtonId:P}=this,r="source"===H&&-1<q?this._buildId("source-item",q):null;return 1<c.length?G.tsx("ul",{afterCreate:w.storeNode,"aria-activedescendant":r,"aria-labelledby":P,bind:this,class:l.globalCss.menuList,"data-node-ref":"_sourceListNode",
id:R,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},f?this._renderSource(u.ALL_INDEX):null,c.map((F,z)=>this._renderSource(z)).toArray()):null}_renderSourcesMenu(){const {allSources:c}=this.viewModel;return 1<c.length?G.tsx("div",{class:this.classes(l.globalCss.menu,C.css.sourcesMenu),key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const {messages:c,messagesCommon:f,disabled:q}=this;return G.tsx("div",{class:l.globalCss.loader,
key:"base-loader",tabIndex:q?-1:void 0},G.tsx("span",{"aria-hidden":"true",class:l.globalCss.loaderAnimation}),G.tsx("span",{class:E.legacyIcon.fontFallbackText},c.searchButtonTitle),G.tsx("span",{class:l.globalCss.loaderText},f.loading))}_renderContainer(){const {allSources:c,state:f}=this.viewModel,{activeMenu:q}=this;return G.tsx("div",{afterCreate:H=>{this._container=H;H.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:H=>{H.removeEventListener("focusout",this._removeActiveMenu)},
class:this.classes({[C.css.hasMultipleSources]:1<c.length,[C.css.isLoading]:"loading"===f,[C.css.isSearching]:"searching"===f,[C.css.showWarning]:"warning"===q,[C.css.showSources]:"source"===q,[C.css.showSuggestions]:"suggestion"===q},C.css.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?G.tsx("button",{bind:this,class:this.classes(C.css.clearButton,
l.globalCss.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},G.tsx("span",{"aria-hidden":"true",class:E.legacyIcon.close})):null}_renderLocationGroup(){const {messages:c,locationEnabled:f,displayedSearchTerm:q}=this,H="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return f&&!q?G.tsx("ul",{class:this.classes(l.globalCss.menuList,C.css.suggestionList,
C.css.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},G.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),bind:this,class:this.classes(l.globalCss.menuItem,H?l.globalCss.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",0),onclick:this._handleUseCurrentLocationClick,role:"option"},G.tsx("span",{"aria-hidden":"true",class:E.legacyIcon.locateCircled})," ",c.useCurrentLocation)):
null}_renderInput(){const {activeMenu:c,locationEnabled:f,displayedSearchTerm:q,messages:H,suggestionsMenuId:R,inputId:P,_activeMenuItemIndex:r,disabled:F}=this,{maxInputLength:z,placeholder:O,searchTerm:J,suggestionCount:U}=this.viewModel,K=!!(f&&!q||U),X="suggestion"===c&&-1<r?this._buildId("suggestion-item",r):null;return G.tsx("input",{afterCreate:w.storeNode,"aria-activedescendant":X,"aria-autocomplete":"list","aria-controls":K?R:null,"aria-expanded":(K&&"suggestion"===c).toString(),"aria-haspopup":"listbox",
"aria-label":H.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(l.globalCss.input,C.css.input),"data-node-ref":"_inputNode",disabled:F,id:P,maxlength:z,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:O,role:"combobox",title:J?"":O,type:"text",value:J})}_renderForm(){return G.tsx("form",{bind:this,class:C.css.form,disabled:this.disabled,key:"esri-search__form",
onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(c){const {sourceIndex:f}=c;({results:c}=c);return c?.length?G.tsx("ul",{class:this.classes(l.globalCss.menuList,C.css.suggestionList),key:`esri-search__suggestion-list-${f}`,role:"group"},c?.map(q=>this._renderSuggestion(q,this._menuItemCount++))):null}_renderSuggestionsGroup(){const {suggestions:c}=this.viewModel;return c?c.map(f=>[this._renderSuggestionHeader(f),this._renderSuggestList(f)]):[]}_renderSuggestionsMenu(){const {displayedSearchTerm:c,
locationEnabled:f,suggestionsMenuId:q,inputId:H}=this,{suggestionCount:R}=this.viewModel;this._menuItemCount=0;return f&&!c||R?G.tsx("div",{afterCreate:w.storeNode,"aria-labelledby":H,bind:this,class:this.classes(l.globalCss.menu,C.css.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:q,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),this._renderSuggestionsGroup()):null}_renderInputContainer(){return G.tsx("div",{class:C.css.inputContainer,key:"esri-search__input-container"},
this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(c){const {allSources:f,activeSourceIndex:q}=this.viewModel,{sourceIndex:H}=c,R=1<f.length&&q===u.ALL_INDEX;return c.results?.length&&R?G.tsx("div",{class:l.globalCss.menuHeader,key:`esri-search__suggestion-header-${H}`},this._getSourceName(H)):null}_renderSuggestion(c,f){const {_activeMenuItemIndex:q,viewModel:{searchTerm:H}}=this;if(H)return G.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&
this._activeMenuItemIndex===f).toString(),bind:this,class:this.classes(l.globalCss.menuItem,"suggestion"===this.activeMenu&&q===f?l.globalCss.menuItemFocus:null),"data-suggestion":c,id:this._buildId("suggestion-item",f),innerHTML:this._getSuggestResultHTML(c.text,H),key:`esri-search__suggestion_${f}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(c){const {activeSourceIndex:f,searchAllEnabled:q}=this.viewModel,H=q?c+1:c;return G.tsx("li",{"aria-checked":(c===f).toString(),bind:this,
class:this.classes(C.css.source,l.globalCss.menuItem,{[l.globalCss.menuItemActive]:c===f,[l.globalCss.menuItemFocus]:"source"===this.activeMenu&&c===(q?this._activeMenuItemIndex-1:this._activeMenuItemIndex)}),"data-source-index":c,id:this._buildId("source-item",H),key:`esri-search__source-${c}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(c))}_renderNoResultsWarning(c){const {messages:f}=this;c=c?Y.substitute(f.noResultsFoundForValue,{value:`"${c}"`}):f.noResultsFound;
return G.tsx("div",{key:"esri-search__no_results"},G.tsx("div",{class:C.css.warningMenuHeader},f.noResults),G.tsx("div",{class:C.css.warningMenuText},c))}_renderEmptySearchWarning(){const {messages:c}=this;return G.tsx("div",{key:"esri-search__empty-search"},G.tsx("span",{"aria-hidden":"true",class:E.legacyIcon.noticeTriangle}),G.tsx("span",{class:C.css.noValueText},c.emptyValue))}_renderLocateWarning(){const {messages:c}=this;return G.tsx("div",{key:"esri-search__locate-error"},G.tsx("span",{"aria-hidden":"true",
class:E.legacyIcon.noticeTriangle}),G.tsx("span",{class:C.css.noValueText},c.locateError))}_renderWarning(){const {displayedSearchTerm:c,_locateFailed:f}=this,{viewModel:q}=this;return f?this._renderLocateWarning():q.selectedSuggestion?.location||c?this._renderNoResultsWarning(c):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(c,f){return`${this.id}-${c}${void 0===f?"":`-${f}`}`}_watchSourceChanges(){const {viewModel:{allSources:c}}=this;this.removeHandles("sources");
c.forEach(f=>this.addHandles(x.watch(()=>f.name,()=>this.scheduleRender()),"sources"))}_handleSourcesMenuToggleFocus(){"source"!==this.activeMenu&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){this.activeMenu="source"===this.activeMenu?"none":"source";this.renderNow();"source"===this.activeMenu&&this._sourceListNode?.focus()}_handleClearButtonClick(){this.viewModel.clear();this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(c){if(c=c.currentTarget?.["data-suggestion"])this._focus(),
this.search(c)}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none");this._cancelSuggest();this._cancelSearch();const c=new AbortController,{signal:f}=c;this._searchController=c;(async()=>{try{this.activeMenu=(await this.viewModel.searchNearby({signal:f}))?.numResults?"none":"warning"}catch(q){this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(c){this._setSourceFromMenuItem(c.currentTarget)}_setSourceFromMenuItem(c){c&&
(c=c?.["data-source-index"],null!=c&&(this.viewModel.activeSourceIndex=c,this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()))}_cancelSuggest(){this._suggestController=n.abortMaybe(this._suggestController)}_cancelSearch(){this._searchController=n.abortMaybe(this._searchController);this._locateFailed=!1}_handleInputKeyup(c){var {key:f}=c;if(!c.ctrlKey&&!c.metaKey&&"Copy"!==f&&"ArrowLeft"!==f&&"ArrowRight"!==f&&"Shift"!==f)if("Tab"===f||"Escape"===f||c.shiftKey&&"Tab"===f)this._cancelSuggest(),
"Escape"===f&&this._clearActiveMenu();else{var q="Home"===f||"End"===f||"ArrowUp"===f||"ArrowDown"===f;if("Enter"===f&&0>this._activeMenuItemIndex)this._cancelSuggest();else{var H=this._suggestionListNode?.getElementsByTagName("li");if(H?.length){"suggestion"!==this.activeMenu&&this._openSuggestionMenu();if(q){c.preventDefault();this._cancelSuggest();this._handleItemNavigation(f,H,this._suggestionListNode);return}c=H[this._activeMenuItemIndex];if("Enter"===f&&c){(f=c?.["data-suggestion"])?(this._focus(),
this.search(f)):c?.["data-current-location-item"]&&this._useCurrentLocation();return}}this.viewModel.searchTerm&&this.suggest()}}}_handleItemNavigation(c,f,q){var H=this._activeMenuItemIndex;"Home"===c&&(this._activeMenuItemIndex=0);"End"===c&&(this._activeMenuItemIndex=f.length-1);"ArrowUp"===c&&(this._activeMenuItemIndex=0>=this._activeMenuItemIndex?f.length-1:this._activeMenuItemIndex-1);"ArrowDown"===c&&(this._activeMenuItemIndex=this._activeMenuItemIndex===f.length-1?0:this._activeMenuItemIndex+
1);if(H!==this._activeMenuItemIndex&&q){c=f[this._activeMenuItemIndex];f=c.getBoundingClientRect();q=q.getBoundingClientRect();H=f.top;const R=q.top;(f.top+f.height>q.top+q.height||H<R)&&c.scrollIntoView({block:"end"})}}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(c){c=c.target;this.viewModel.searchTerm!==c.value&&(this.viewModel.searchTerm=c.value);this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(c){const {key:f}=
c;w.isActivationKey(f)?(c.preventDefault(),c=this._sourceListNode?.getElementsByTagName("li")?.[this._activeMenuItemIndex],this._setSourceFromMenuItem(c)):"ArrowUp"!==f&&"ArrowDown"!==f&&"End"!==f&&"Home"!==f||c.preventDefault()}_handleSourceMenuKeyup(c){const {key:f}=c,q="ArrowUp"===f||"ArrowDown"===f||"End"===f||"Home"===f;q&&c.preventDefault();"Escape"===f?(this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()):(c=this._sourceListNode?.getElementsByTagName("li"))&&0!==c.length&&q&&("source"!==
this.activeMenu&&(this.activeMenu="source"),this._handleItemNavigation(f,c,this._sourceListNode?.parentElement))}_focus(c){this.focus();c&&(this.activeMenu=c)}_formSubmit(c){c.preventDefault();-1===this._activeMenuItemIndex&&this.search()}_getSourceName(c){const {messages:f}=this;var {allSources:q}=this.viewModel;q=q.at(c);return c===u.ALL_INDEX?f.all:q?q.name||f.untitledSource:f.untitledSource}_getSuggestResultHTML(c,f){return c?ba.test(c)?c:ca(c,f):this.messages.untitledResult}};b.__decorate([k.property()],
d.prototype,"_activeMenuItemIndex",void 0);b.__decorate([k.property()],d.prototype,"displayedSearchTerm",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"inputId",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"suggestionsMenuId",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"sourceMenuId",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"sourceMenuButtonId",null);b.__decorate([k.property()],d.prototype,"activeMenu",void 0);b.__decorate([k.property({readOnly:!0})],
d.prototype,"activeSource",null);b.__decorate([k.property()],d.prototype,"activeSourceIndex",null);b.__decorate([k.property()],d.prototype,"allPlaceholder",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"allSources",null);b.__decorate([k.property()],d.prototype,"autoNavigate",null);b.__decorate([k.property()],d.prototype,"autoSelect",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"defaultSources",null);b.__decorate([k.property()],d.prototype,"disabled",void 0);b.__decorate([k.property()],
d.prototype,"goToOverride",null);b.__decorate([k.property()],d.prototype,"icon",null);b.__decorate([k.property()],d.prototype,"includeDefaultSources",null);b.__decorate([k.property()],d.prototype,"label",null);b.__decorate([k.property()],d.prototype,"locationEnabled",null);b.__decorate([k.property()],d.prototype,"maxResults",null);b.__decorate([k.property()],d.prototype,"maxSuggestions",null);b.__decorate([k.property(),Q.messageBundle("esri/widgets/Search/t9n/Search")],d.prototype,"messages",void 0);
b.__decorate([k.property(),Q.messageBundle("esri/t9n/common")],d.prototype,"messagesCommon",void 0);b.__decorate([k.property()],d.prototype,"minSuggestCharacters",null);b.__decorate([k.property()],d.prototype,"popupEnabled",null);b.__decorate([k.property()],d.prototype,"popupTemplate",null);b.__decorate([k.property()],d.prototype,"portal",null);b.__decorate([k.property()],d.prototype,"resultGraphic",null);b.__decorate([k.property()],d.prototype,"resultGraphicEnabled",null);b.__decorate([k.property({readOnly:!0})],
d.prototype,"results",null);b.__decorate([k.property()],d.prototype,"searchAllEnabled",null);b.__decorate([k.property()],d.prototype,"searchTerm",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"selectedResult",null);b.__decorate([k.property()],d.prototype,"sources",null);b.__decorate([k.property({readOnly:!0})],d.prototype,"suggestions",null);b.__decorate([k.property()],d.prototype,"suggestionsEnabled",null);b.__decorate([k.property()],d.prototype,"view",null);b.__decorate([S.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),
k.property({type:u})],d.prototype,"viewModel",void 0);return d=b.__decorate([D.subclass("esri.widgets.Search")],d)});