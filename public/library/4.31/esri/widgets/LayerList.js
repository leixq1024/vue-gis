// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/LayerList/css":function(){define(["exports"],function(f){f.css={base:"esri-layer-list",actionMenu:"esri-layer-list__action-menu",actionGroup:"esri-layer-list__action-group",filterNoResults:"esri-layer-list__filter-no-results",item:"esri-layer-list__item",itemActive:"esri-layer-list__item--active",itemContent:"esri-layer-list__item-content",itemContentBottom:"esri-layer-list__item-content-bottom",itemMessage:"esri-layer-list__item-message",itemInvisible:"esri-layer-list__item--invisible",
itemActionIcon:"esri-layer-list__item-action-icon",itemActionImage:"esri-layer-list__item-action-image",itemTemporaryIcon:"esri-layer-list__item-temporary-icon",itemTableIcon:"esri-layer-list__item-table-icon",itemCatalogIcon:"esri-layer-list__item-catalog-icon",statusIndicator:"esri-layer-list__status-indicator",publishing:"esri-layer-list__publishing",updating:"esri-layer-list__updating",connectionStatus:"esri-layer-list__connection-status",connectionStatusConnected:"esri-layer-list__connection-status--connected",
visibleToggle:"esri-layer-list__visible-toggle",visibleIcon:"esri-layer-list__visible-icon"};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListItem":function(){define("require ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/catalog/catalogUtils ../../support/actions/actionUtils ../Widget ./support/layerListUtils ../../chunks/componentsUtils ../support/jsxFactory ../support/widgetUtils".split(" "),
function(f,a,h,m,p,z,y,J,d,A,w,E,B,q){var k;m=k=class extends A{constructor(b){super(b);this.listModeDisabled=this.dragEnabled=!1;this.viewModel=this.parentTitles=this.parent=null;this._onActionMenuOpen=c=>{this.item.actionsOpen=c.target.open};this._setTooltipReference=c=>{this.onTooltipReferenceChange?.(this.item.layer.uid,c)};this._removeTooltipReference=()=>{this.onTooltipReferenceChange?.(this.item.layer.uid,null)}}loadDependencies(){return E.loadCalciteComponents({"action-group":()=>new Promise((b,
c)=>f(["../../chunks/calcite-action-group"],b,c)),"action-menu":()=>new Promise((b,c)=>f(["../../chunks/calcite-action-menu"],b,c)),action:()=>new Promise((b,c)=>f(["../../chunks/calcite-action"],b,c)),icon:()=>new Promise((b,c)=>f(["../../chunks/calcite-icon"],b,c)),"list-item":()=>new Promise((b,c)=>f(["../../chunks/calcite-list-item"],b,c)),list:()=>new Promise((b,c)=>f(["../../chunks/calcite-list"],b,c)),notice:()=>new Promise((b,c)=>f(["../../chunks/calcite-notice"],b,c))})}render(){const b=
this.parentTitles??[],{_title:c,item:l,activeItem:t,selectedDragItemLayerUid:g,selectionMode:u,selectedItems:x,messages:C,parent:K,css:L}=this,D="visibleAtCurrentTimeExtent"in l&&"layerInvisibleAtTime"in C&&!l.visibleAtCurrentTimeExtent?`${c} (${C.layerInvisibleAtTime})`:"visibleAtCurrentScale"in l&&"layerInvisibleAtScale"in C&&!l.visibleAtCurrentScale?`${c} (${C.layerInvisibleAtScale})`:c,R="parent"in l&&"catalog"===l.parent?.layer?.type,{layer:P}=l,e="visibleAtCurrentScale"in l&&!l.visibleAtCurrentScale||
"visibleAtCurrentTimeExtent"in l&&!l.visibleAtCurrentTimeExtent;return B.tsx("calcite-list-item",{afterCreate:n=>this._focusSelectedDragEl(n,l),afterUpdate:n=>this._focusSelectedDragEl(n,l),class:this.classes(L.item,"itemActive"in L&&{[L.itemActive]:t===l}),"data-item":l,"data-layer-id":P.id,dragDisabled:!l.sortable||R,dragSelected:P.uid===g,id:P.uid,key:`list-item-${P.uid}`,label:c,metadata:{parentTitles:b,_title:c},open:"open"in l&&l.open,selected:"none"!==u?x.includes(l):!1,title:D,unavailable:e,
value:P.uid,onCalciteListItemDragHandleChange:n=>this._handleCalciteListItemDragHandleChange(n,l),onCalciteListItemSelect:n=>"visible"in l&&this._handleCalciteListItemSelect(n,l,K),onCalciteListItemToggle:n=>"open"in l&&this._handleCalciteListItemToggle(n,l)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,B.tsx("div",{class:this.classes(L.itemContent,"itemInvisible"in L&&{[L.itemInvisible]:e}),slot:"content"},c),this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,
this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const {messages:b}=this;return this.item.title||("untitledTable"in b?b.untitledTable:b.untitledLayer)}get _renderedItemStatus(){const {item:b,parent:c,visibleElements:l,css:t}=this;if(!l.statusIndicators)return null;const {publishing:g}=b,u="updating"in b&&b.updating&&!c,x="connectionStatus"in b?b.connectionStatus:void 0,C=!!x;return B.tsx("calcite-icon",
{class:this.classes(t.statusIndicator,{[t.publishing]:g},"updating"in t&&{[t.updating]:u},"connectionStatus"in t&&{[t.connectionStatus]:C},"connectionStatusConnected"in t&&{[t.connectionStatusConnected]:C&&"connected"===x}),icon:w.getStatusIcon({connectionStatus:x,publishing:g}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const {item:b,visibleElements:c,css:l}=this;var {layer:t}=b;const g="temporaryLayerIndicators"in c&&c.temporaryLayerIndicators,u="temporaryTableIndicators"in
c&&c.temporaryTableIndicators;t="persistenceEnabled"in t&&(J.isLayerFromCatalog(t)||!t.persistenceEnabled);return(g||u)&&t?B.tsx("calcite-icon",{class:l.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"actions-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const {item:b,parent:c,messages:l,visibilityAppearance:t,css:g}=this;if(!("visible"in b&&"layerVisibility"in l&&"visibleToggle"in g&&t))return null;const {visible:u}=b,x=c?.visibilityMode;if("inherited"===
x)return null;const C=w.getVisibilityIcon({visible:u,exclusive:"exclusive"===x,visibilityAppearance:t}),K="checkbox"===t,L=l.layerVisibility;return B.tsx("calcite-action",{appearance:"transparent",class:g.visibleToggle,icon:K?C:void 0,key:"visibility-toggle",onclick:()=>this._toggleVisibility(b,c),scale:"s",slot:K?"actions-start":"actions-end",text:L,title:L},K?null:B.tsx("calcite-icon",{class:this.classes({[g.visibleIcon]:"exclusive"!==x&&u}),icon:C,scale:"s"}))}get _renderedPanel(){const {panel:b}=
this.item;return!b?.open||b.disabled||b.flowEnabled?null:B.tsx("div",{class:this.css.itemContentBottom,key:`content-panel-${b.uid}`,slot:"content-bottom"},b.render())}get _renderedPanelAction(){const {panel:b}=this.item;if(!b?.visible)return null;const {open:c,title:l,disabled:t}=b;return B.tsx("calcite-action",{active:c,appearance:"transparent",disabled:t,icon:d.getActionIcon(b),key:`action-${b.uid}`,onclick:()=>this._togglePanel(b),scale:"s",slot:"actions-end",text:l??"",title:l??void 0},this._renderFallbackIcon(b))}get _renderedActions(){switch(this._actionsCount){case 0:return null;
case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const {item:b,messagesCommon:c}=this,l=c.options;return B.tsx("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:c.menu,open:b.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},B.tsx("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:l,title:l}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map(b=>
B.tsx("calcite-action-group",{key:`action-section-${b.uid}`},b.toArray().map(c=>this._renderAction({action:c,textEnabled:!0}))))}get _renderedCatalogFootprintIcon(){const {css:b}=this,c="catalog-footprint"===this.item.layer?.type;return"itemCatalogIcon"in b&&c?B.tsx("calcite-icon",{class:b.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){const {css:b}=this,c="catalog-dynamic-group"===this.item.layer?.type;return"itemCatalogIcon"in
b&&c?B.tsx("calcite-icon",{class:b.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const {_title:b,item:c,visibleElements:l}=this;if("visible"in c){var {layer:t}=c;return"catalogLayerList"in l&&l.catalogLayerList&&"catalog-dynamic-group"===t?.type?B.tsx("calcite-action",{appearance:"transparent",disabled:!t.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(c),scale:"s",slot:"actions-end",
text:b}):null}}get _renderedChildList(){const {dragEnabled:b,item:c,rootGroupUid:l,listModeDisabled:t,selectionMode:g}=this;if("visible"in c){var u=[...(this.parentTitles??[]),c.title],{children:x,layer:C}=c,K="catalog-dynamic-group"!==C?.type&&w.listItemHasChildren(c),L=t?!1:w.areChildrenHidden(C);return K||!L&&!K&&b&&"group"===C?.type?B.tsx("calcite-list",{canPull:D=>this.canMove?this.canMove(D,"pull"):!1,canPut:D=>this.canMove?this.canMove(D,"put"):!1,"data-item":c,"data-layer-type":l,dragEnabled:b?
c.childrenSortable&&w.canSortSublayers(c):!1,group:`${l}-${C.uid}`,key:`child-list-${C.uid}`,selectionAppearance:"border",selectionMode:g},x?.filter(D=>!D.hidden).toArray().map(D=>this._renderItem(D,c,u)),this._renderedTablesItem):null}}get _hasTables(){const {layerTablesEnabled:b}=this,c=this.item.layer;if(!b||!c)return!1;switch(c.type){case "knowledge-graph":return b.includes(c.type)&&!!c.tables?.length;case "map-image":case "tile":return b.includes(c.type)&&!!c.subtables?.length;default:return!1}}get _renderedTablesItem(){const {item:b,
messages:c,css:l}=this,{layer:t}=b;return"itemTableIcon"in l&&"visible"in b&&"tables"in c&&this._hasTables?B.tsx("calcite-list-item",{class:l.item,"data-layer-id":t.id,dragDisabled:!0,key:`list-item-table-list-tables-${t.uid}`,title:c.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(b)},B.tsx("div",{class:l.itemContent,slot:"content"},c.tables),B.tsx("calcite-icon",{class:l.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),B.tsx("calcite-icon",{flipRtl:!0,icon:"chevron-right",
scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const {item:b,messages:c,css:l}=this;return b.error?B.tsx("div",{class:l.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},B.tsx("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},B.tsx("div",{slot:"message"},"tableError"in c?c.tableError:c.layerError))):"incompatible"in b&&b.incompatible&&"layerIncompatible"in c?B.tsx("div",{class:l.itemMessage,key:"esri-layer-list__incompatible",
slot:"content-bottom"},B.tsx("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},B.tsx("div",{slot:"message"},c.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:w.getSingleAction(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map(b=>b.filter(c=>c.visible))}get _actionsCount(){return this.item.actionsSections.reduce((b,
c)=>b+c.length,0)}_renderAction(b){const {item:c}=this,{action:l,textEnabled:t}=b;if(!l)return null;const {active:g,disabled:u,title:x,type:C,indicator:K}=l;return B.tsx("calcite-action",{active:"toggle"===C?l.value:!1,appearance:"transparent",disabled:u,icon:d.getActionIcon(l),indicator:K,key:`action-${l.uid}`,loading:g,onclick:()=>this._triggerAction(c,l),scale:"s",slot:t?void 0:"actions-end",text:x??"",textEnabled:t,title:x??void 0},this._renderFallbackIcon(l))}_renderFallbackIcon(b){const {css:c}=
this,{className:l,icon:t}=b;if(t)return null;b="image"in b?b.image:void 0;const g={[c.itemActionIcon]:!!l,[c.itemActionImage]:!!b};l&&(g[l]=!0);return b||l?B.tsx("span",{"aria-hidden":"true",class:this.classes(c.itemActionIcon,g),key:"icon",styles:d.getActionStyles(b)}):null}_renderItem(b,c,l=[]){return B.tsx(k,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,dragEnabled:this.dragEnabled,item:b,key:`layerListItem-${b.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,
messages:this.messages,messagesCommon:this.messagesCommon,parent:c,parentTitles:l,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,
onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(b,c){c&&b&&("toggle"===c.type&&(c.value=!c.value),this.onAction(c,b))}_triggerOnTablesOpen(b){if(b&&this.onTablesOpen)this.onTablesOpen(b)}_triggerOnCatalogOpen(b){if(b)this.onCatalogOpen?.(b)}_focusSelectedDragEl(b,c){this.selectedDragItemLayerUid===c.layer.uid&&q.setFocus(b)}_handleCalciteListItemToggle(b,c){b.stopPropagation();c.open=b.target.open}_handleCalciteListItemDragHandleChange(b,c){b.stopPropagation();b=b.target.dragSelected;
this.onSelectedDragItemLayerUidChange?.(b?c.layer.uid:null)}_handleCalciteListItemSelect(b,c,l){w.getItem(b.target)===c&&"none"===this.selectionMode&&"inherited"!==l?.visibilityMode&&this._toggleVisibility(c,l)}_togglePanel(b){b.open=!b.open;if(b.open)this.onPanelOpen()}_toggleVisibility(b,c){!b||"exclusive"===c?.visibilityMode&&b.visible||(b.visible=!b.visible)}};m.vnodeSelector="calcite-list-item";a.__decorate([h.property()],m.prototype,"activeItem",void 0);a.__decorate([h.property()],m.prototype,
"canMove",void 0);a.__decorate([h.property()],m.prototype,"css",void 0);a.__decorate([h.property()],m.prototype,"dragEnabled",void 0);a.__decorate([h.property()],m.prototype,"item",void 0);a.__decorate([h.property()],m.prototype,"layerTablesEnabled",void 0);a.__decorate([h.property()],m.prototype,"listModeDisabled",void 0);a.__decorate([h.property()],m.prototype,"messages",void 0);a.__decorate([h.property()],m.prototype,"messagesCommon",void 0);a.__decorate([h.property()],m.prototype,"onAction",void 0);
a.__decorate([h.property()],m.prototype,"onPanelOpen",void 0);a.__decorate([h.property()],m.prototype,"onCatalogOpen",void 0);a.__decorate([h.property()],m.prototype,"onTablesOpen",void 0);a.__decorate([h.property()],m.prototype,"onSelectedDragItemLayerUidChange",void 0);a.__decorate([h.property()],m.prototype,"onTooltipReferenceChange",void 0);a.__decorate([h.property()],m.prototype,"parent",void 0);a.__decorate([h.property()],m.prototype,"parentTitles",void 0);a.__decorate([h.property()],m.prototype,
"rootGroupUid",void 0);a.__decorate([h.property()],m.prototype,"selectionMode",void 0);a.__decorate([h.property()],m.prototype,"selectedItems",void 0);a.__decorate([h.property()],m.prototype,"selectedDragItemLayerUid",void 0);a.__decorate([h.property()],m.prototype,"visibleElements",void 0);a.__decorate([h.property()],m.prototype,"visibilityAppearance",void 0);a.__decorate([h.property()],m.prototype,"_title",null);a.__decorate([h.property()],m.prototype,"_renderedItemStatus",null);a.__decorate([h.property()],
m.prototype,"_renderedItemTemporaryIcon",null);a.__decorate([h.property()],m.prototype,"_renderedItemToggle",null);a.__decorate([h.property()],m.prototype,"_renderedPanel",null);a.__decorate([h.property()],m.prototype,"_renderedPanelAction",null);a.__decorate([h.property()],m.prototype,"_renderedActions",null);a.__decorate([h.property()],m.prototype,"_renderedActionMenu",null);a.__decorate([h.property()],m.prototype,"_renderedActionMenuContent",null);a.__decorate([h.property()],m.prototype,"_renderedCatalogFootprintIcon",
null);a.__decorate([h.property()],m.prototype,"_renderedCatalogDynamicIcon",null);a.__decorate([h.property()],m.prototype,"_renderedCatalogSelectNode",null);a.__decorate([h.property()],m.prototype,"_renderedChildList",null);a.__decorate([h.property()],m.prototype,"_hasTables",null);a.__decorate([h.property()],m.prototype,"_renderedTablesItem",null);a.__decorate([h.property()],m.prototype,"_renderedItemMessage",null);a.__decorate([h.property()],m.prototype,"_singleAction",null);a.__decorate([h.property()],
m.prototype,"_filteredSections",null);a.__decorate([h.property()],m.prototype,"_actionsCount",null);return m=k=a.__decorate([y.subclass("esri.widgets.LayerList.LayerListItem")],m)})},"esri/support/actions/actionUtils":function(){define(["exports","../../intl","../../intl/substitute"],function(f,a,h){f.getActionIcon=function(m){if(m.icon)return m.icon;if(!("image"in m&&m.image||m.className))return"question"};f.getActionStyles=function(m){return m?{backgroundImage:`url(${m})`}:{}};f.substituteActionImage=
function({action:m,feature:p}){p=p?.attributes;return(m="image"in m?m.image:void 0)&&p?h.substitute(m,p):m??""};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(f){function a(d){return d?.listMode??void 0}function h(d){return null!=d&&"minScale"in d&&null!=d.minScale?d.minScale:void 0}function m(d){return null!=d&&"maxScale"in d&&null!=d.maxScale?d.maxScale:void 0}function p(d){if(d&&!("type"in d&&
"wmts"===d.type))return"sublayers"in d?"sublayers":"layers"in d?"layers":void 0}function z(d,A){d?.sort((w,E)=>{w="uid"in w?A.indexOf(w.uid):-1;E="uid"in E?A.indexOf(E.uid):-1;return w>E?-1:w<E?1:0})}function y(d){return null!=d&&"layer"in d&&null!=d.layer}function J(d){return d&&"capabilities"in d&&null!=d.capabilities&&"exportMap"in d.capabilities?d.capabilities.exportMap:void 0}f.areChildrenHidden=function(d){return"hide-children"===d?.listMode};f.canDisplayLayer=function(d){return"hide"!==a(d)};
f.canSortSublayers=function(d){d=(d?.layer&&y(d.layer)?d.layer.layer:void 0)??d?.layer;if(!d)return!1;"catalog"===d.type?d=!1:(d=J(d),d=(null!=d&&"supportsDynamicLayers"in d?d.supportsDynamicLayers:void 0)??!0);return d};f.findLayerListMode=a;f.findLayerMaxScale=m;f.findLayerMinScale=h;f.findLayerVisibilityMode=function(d){if(!d)return"inherited";var A=y(d)?d.layer:d;A=J(A);A=null!=A&&"supportsSublayerVisibility"in A?A.supportsSublayerVisibility:void 0;return null!=A?A?"independent":"inherited":"visibilityMode"in
d&&null!=d.visibilityMode?d.visibilityMode:"independent"};f.getItem=function(d){return d?.["data-item"]};f.getItemLayers=function(d){return(d=d?.layer)&&"layers"in d?d.layers:null};f.getLayerType=function(d){return d?.getAttribute("data-layer-type")};f.getNormalizedChildLayerProperty=p;f.getSingleAction=function(d){for(const A of d)for(const w of A)if("button"===w.type||"toggle"===w.type)return w};f.getStatusIcon=function({connectionStatus:d,publishing:A}){return d?"connected"===d?"beacon":"offline":
A?"square":"bullet-point"};f.getVisibilityIcon=function({exclusive:d,visible:A,visibilityAppearance:w}){w="checkbox"===w;return A?d?"circle-f":w?"check-square-f":"view-visible":d?"circle":w?"square":"view-hide"};f.isLayerOutsideScaleRange=function(d,A){if(!d||null==A||isNaN(A))return!1;var w=h(d);d=m(d);w=null!=w&&!isNaN(w)&&0<w&&A>w;A=null!=d&&!isNaN(d)&&0<d&&A<d;return w||A};f.isSublayer=y;f.listItemHasChildren=function({children:d,error:A,incompatible:w}){return!!d?.filter(E=>!E.hidden).length&&
!A&&!w};f.minDragEnabledItems=2;f.minFilterItems=10;f.sortChildLayersToIds=function(d,A){if(d=d?.layer){var w=p(d);if(w){if("layers"===w&&"layers"in d)var E=d.layers;else"sublayers"===w&&"sublayers"in d&&(E=d.sublayers);z(E,A)}}};f.sortLayersToIds=z;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../linkChart/utils ./ListItem ./support/layerListUtils".split(" "),
function(f,a,h,m,p,z,y,J,d,A,w,E){const B=a.ofType(w);a=class extends h.EventedAccessor{constructor(q){super(q);this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=null;this.listModeDisabled=!1;this.operationalItems=new B;this.view=null}initialize(){this.addHandles([m.watch(()=>!0===this.view?.ready,()=>this._viewHandles(),m.initial),m.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),m.watch(()=>A.isLinkChartView(this.view)?
this.view.inGeographicLayout:null,()=>this._compileList())],"view")}destroy(){this._removeAllItems();this.view=null}get state(){const {view:q}=this;return q?.ready?"ready":q?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(q=>q.children).length}triggerAction(q,k){q&&!q.disabled&&this.emit("trigger-action",{action:q,item:k})}moveListItem(q,k,b,c){const l=q?.layer;if(l&&"subtype-sublayer"!==l.type&&"sublayer"!==l.type){var t=this.view?.map?.layers,g=k?E.getItemLayers(k):t;
t=b?E.getItemLayers(b):t;if(g&&t){var {operationalItems:u}=this,x=b?.children||u;c=t.length-c;q.parent=b||null;(k?.children||u).remove(q);g.remove(l);x.includes(q)||x.add(q,c);t.includes(l)||t.add(l,c);this._compileList()}}}_createLayerViewHandles(q){this.removeHandles("layer-views");this._compileList();q&&this.addHandles(q.on("change",()=>this._compileList()),"layer-views")}_createMapLayerHandles(q){this.removeHandles("map-layers");this._compileList();q&&this.addHandles(q.on("change",()=>this._compileList()),
"map-layers")}_createListItem(q){const {view:k,listItemCreatedFunction:b,checkPublishStatusEnabled:c,listModeDisabled:l}=this;return new w({checkPublishStatusEnabled:c,listModeDisabled:l,layer:q,listItemCreatedFunction:b,view:k})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(q){return q?this.listModeDisabled?q:q.filter(k=>"hide"!==E.findLayerListMode(k)):void 0}_watchLayersListMode(q){this.removeHandles("layer-list-mode");q&&!this.listModeDisabled&&this.addHandles(m.watch(()=>
q.filter(k=>"listMode"in k).map(k=>k.listMode).toArray(),()=>this._compileList()),"layer-list-mode")}_compileList(){var q=this.view?.map?.layers;q=A.isLinkChartView(this.view)&&!this.view.inGeographicLayout?q?.filter(({type:k})=>"link-chart"===k):q;this._watchLayersListMode(q);q=this._getViewableLayers(q);q?.length?(this._createNewItems(q),this._removeItems(q),this._sortItems(q)):this._removeAllItems()}_createNewItems(q){const {operationalItems:k}=this;q.forEach(b=>{k.some(c=>c.layer===b)||k.add(this._createListItem(b))})}_removeItems(q){const {operationalItems:k}=
this,b=[];k.forEach(c=>{c&&q&&q.includes(c.layer)||b.push(c)});k.destroyMany(b)}_sortItems(q){const {operationalItems:k}=this;k.sort((b,c)=>{b=q.indexOf(b.layer);c=q.indexOf(c.layer);return b>c?-1:b<c?1:0})}_recompileList(){this._removeAllItems();this._compileList()}_viewHandles(){const {view:q}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);q?.ready?this.addHandles([m.watch(()=>this.view?.map?.allLayers,k=>this._createMapLayerHandles(k),m.initial),m.watch(()=>this.view?.allLayerViews,
k=>this._createLayerViewHandles(k),m.initial)],"view-layers"):this._removeAllItems()}};f.__decorate([p.property()],a.prototype,"checkPublishStatusEnabled",void 0);f.__decorate([p.property()],a.prototype,"listItemCreatedFunction",void 0);f.__decorate([p.property({nonNullable:!0})],a.prototype,"listModeDisabled",void 0);f.__decorate([p.property({type:B})],a.prototype,"operationalItems",void 0);f.__decorate([p.property({readOnly:!0})],a.prototype,"state",null);f.__decorate([p.property()],a.prototype,
"totalItems",null);f.__decorate([p.property()],a.prototype,"view",void 0);return a=f.__decorate([d.subclass("esri.widgets.LayerList.LayerListViewModel")],a)})},"esri/linkChart/utils":function(){define(["exports"],function(f){f.isLinkChartView=function(a){return null!=a&&"object"===typeof a&&"2d"===a.type&&"linkchart"===a.view2dType};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(f,a,h,m,p,z,y,J,d,A,w,E,B,q,k,b,c){var l;d=m.ofType({key:"type",defaultKeyValue:"button",base:E,typeMap:{button:B,toggle:k,slider:q}});const t=m.ofType(d);a=l=class extends p.IdentifiableMixin(a){constructor(g){super(g);this.actionsSections=new t;this.checkPublishStatusEnabled=this.actionsOpen=!1;this.children=new (m.ofType(l));this.childrenSortable=!0;this.hidden=!1;this.listItemCreatedFunction=this.layer=null;this.open=this.listModeDisabled=!1;this.view=this.parent=this.panel=null}initialize(){this.addHandles([z.watch(()=>
[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),z.initial),z.watch(()=>this.checkPublishStatusEnabled,g=>this._updateChildrenPublishing(g),z.initial),z.watch(()=>this.view,g=>this._updateChildrenView(g),z.initial),z.watch(()=>this.panel,g=>this._setListItemOnPanel(g),z.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})}destroy(){this.panel?.destroy();this.children.destroyAll();this.view=
null}get connectionStatus(){const {layerView:g,publishing:u}=this;if(!u&&g&&"connectionStatus"in g)return g.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const {layerView:g}=this;return g&&"spatialReferenceSupported"in g?!g.spatialReferenceSupported:!1}get layerView(){const {layer:g,view:u}=this;if(!g||!u||"sublayer"===g.type)return null;const x="subtype-sublayer"===g.type?g.parent:g;return u.allLayerViews.find(C=>C.layer===x)??null}castPanel(g){this.panel?.open&&!g.hasOwnProperty("open")&&
(g.open=!0);return g?new b(g):null}get sortable(){return"knowledge-graph-sublayer"===this.layer?.type?!1:this._get("sortable")}set sortable(g){this._set("sortable",g)}get title(){const g=w.get(this,"layer.layer");return(!g||g&&w.get(this,"layer.layer.loaded"))&&w.get(this,"layer.title")||w.get(this,"layer.attributes.title")||""}set title(g){this._override("title",g)}get publishing(){const {layer:g,checkPublishStatusEnabled:u}=this;return u&&g&&"publishingInfo"in g&&"publishing"===g.publishingInfo?.status}get updating(){const {layerView:g,
connectionStatus:u,layer:x,publishing:C}=this;return C||u?!1:g?g.updating:"loading"===x?.loadStatus||!1}get visible(){return this.layer?.visible}set visible(g){const u=this.layer;u&&(u.visible=g)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!c.isLayerOutsideScaleRange(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return c.findLayerVisibilityMode(this.layer)}clone(){return new l({actionsSections:this.actionsSections.clone(),
actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(g){g&&(g.listItem=this)}_updateChildrenPublishing(g){const u=this.children;
u&&u.forEach(x=>x.checkPublishStatusEnabled=g)}_updateChildrenView(g){const u=this.children;u&&u.forEach(x=>x.view=g)}_createChildren(g){const {listModeDisabled:u,children:x}=this;g=g.filter(C=>!x.some(K=>K.layer===C));x.addMany(this._createChildItems(g,u))}_destroyChildren(g){const {children:u}=this,x=u.filter(C=>!g.includes(C.layer));u.destroyMany(x)}_sortChildren(g){this.children.sort((u,x)=>g.indexOf(x.layer)-g.indexOf(u.layer))}_destroyAllChildren(){this.removeHandles("child-list-mode");this.children.destroyAll()}_watchChildLayerListMode(g){this.removeHandles("child-list-mode");
this.listModeDisabled||this.addHandles(g.toArray().map(u=>z.watch(()=>u.listMode,()=>this._compileChildren(g))),"child-list-mode")}_compileChildren(g){const u=this.listModeDisabled?g:g?.filter(x=>"hide"!==c.findLayerListMode(x));u?.length?(this._createChildren(u),this._destroyChildren(u),this._sortChildren(u),this._watchChildLayerListMode(g)):this._destroyAllChildren()}_watchSublayerChanges(g){g&&this.addHandles(g.on("change",()=>this._compileChildren(g)),"layer")}_initializeChildLayers(g){this._compileChildren(g);
this._watchSublayerChanges(g)}_createChildItems(g,u){return g.map(x=>u||c.canDisplayLayer(x)?new l({layer:x,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(h.isSome).reverse()}_watchLayerProperties(g){this.removeHandles("layer");this.removeHandles("child-list-mode");if(g)if("hide-children"===(!this.listModeDisabled&&c.findLayerListMode(g)))this.children.destroyAll();
else{var u=c.getNormalizedChildLayerProperty(g);u&&this.addHandles(z.watch(()=>g[u],x=>{g.hasOwnProperty(u)&&this._initializeChildLayers(x)},z.initial),"layer")}}};f.__decorate([y.property({type:t})],a.prototype,"actionsSections",void 0);f.__decorate([y.property()],a.prototype,"actionsOpen",void 0);f.__decorate([y.property()],a.prototype,"checkPublishStatusEnabled",void 0);f.__decorate([y.property({type:m})],a.prototype,"children",void 0);f.__decorate([y.property()],a.prototype,"childrenSortable",
void 0);f.__decorate([y.property({readOnly:!0})],a.prototype,"connectionStatus",null);f.__decorate([y.property({readOnly:!0})],a.prototype,"error",null);f.__decorate([y.property()],a.prototype,"hidden",void 0);f.__decorate([y.property({readOnly:!0})],a.prototype,"incompatible",null);f.__decorate([y.property()],a.prototype,"layer",void 0);f.__decorate([y.property({readOnly:!0})],a.prototype,"layerView",null);f.__decorate([y.property()],a.prototype,"listItemCreatedFunction",void 0);f.__decorate([y.property({nonNullable:!0})],
a.prototype,"listModeDisabled",void 0);f.__decorate([y.property()],a.prototype,"open",void 0);f.__decorate([y.property({type:b})],a.prototype,"panel",void 0);f.__decorate([J.cast("panel")],a.prototype,"castPanel",null);f.__decorate([y.property()],a.prototype,"parent",void 0);f.__decorate([y.property({value:!0})],a.prototype,"sortable",null);f.__decorate([y.property()],a.prototype,"title",null);f.__decorate([y.property({readOnly:!0})],a.prototype,"publishing",null);f.__decorate([y.property({readOnly:!0})],
a.prototype,"updating",null);f.__decorate([y.property()],a.prototype,"view",void 0);f.__decorate([y.property()],a.prototype,"visible",null);f.__decorate([y.property({readOnly:!0})],a.prototype,"visibleAtCurrentScale",null);f.__decorate([y.property({readOnly:!0})],a.prototype,"visibleAtCurrentTimeExtent",null);f.__decorate([y.property({readOnly:!0})],a.prototype,"visibilityMode",null);return a=l=f.__decorate([A.subclass("esri.widgets.LayerList.ListItem")],a)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(f,a,h,m,p,z,y){var J;h=J=class extends y{constructor(d){super(d);this.displayValueEnabled=!1;this.max=1;this.min=0;this.step=.1;this.type="slider";this.value=null}clone(){return new J({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};f.__decorate([a.property()],h.prototype,"displayValueEnabled",
void 0);f.__decorate([a.property()],h.prototype,"max",void 0);f.__decorate([a.property()],h.prototype,"min",void 0);f.__decorate([a.property()],h.prototype,"step",void 0);f.__decorate([a.property()],h.prototype,"value",void 0);return h=J=f.__decorate([z.subclass("esri.support.actions.ActionSlider")],h)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(f,a,h,m,p,z,y,J,d,A,w,E,B,q){h=class extends h.IdentifiableMixin(w){constructor(k,b){super(k,b);this.content=this.className=this._legend=null;this.flowEnabled=!1;this.listItem=this.image=null;this.open=!1;this.visible=!0}initialize(){this.addHandles([p.watch(()=>this._canCreateLegend,()=>this._createLegend(),p.initial),p.watch(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),p.initial)])}destroy(){this._legend=m.destroyMaybe(this._legend)}get _canCreateLegend(){const {content:k,
listItem:b}=this;return b?"legend"===k?!0:null!=k&&(Array.isArray(k)?k.includes("legend"):!1):!1}get _legendOptions(){const {listItem:k,_legendLayerInfo:b}=this,c=k?.view;return b&&c?{view:c,layerInfos:[b]}:{}}get _legendLayerInfo(){const k=this.listItem?.layer;if(!k||"subtype-sublayer"===k.type)return null;var b=E.isSublayer(k)?k:null;const c=k?.parent;return(b=null!=c&&"type"in c&&"map-image"===c.type?b?.source:null)&&c?{layer:c,title:"",sublayerIds:[b.mapLayerId]}:{layer:k,title:""}}get disabled(){const {listItem:k,
_legend:b,content:c}=this;return k?Array.isArray(c)&&1<c.length?!1:b?!b.activeLayerInfos?.length||!k.visibleAtCurrentScale||!k.visible:!1:!0}set disabled(k){this._overrideIfSome("disabled",k)}get icon(){const {image:k}=this,b=this._getFirstWidget();return this._get("icon")??(!k&&b?b.icon:null)}set icon(k){this._overrideIfSome("icon",k)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(k){this._override("title",k)}render(){return q.tsx("div",{class:"esri-list-item-panel"},
this._renderContents())}_renderContent(k){const {_legend:b,disabled:c,open:l}=this;return k&&!c&&l?"legend"===k&&b?q.tsx("div",{key:"legend-widget"},b.render()):"string"===typeof k?q.tsx("div",{innerHTML:k,key:k}):B.isWidget(k)?q.tsx("div",{key:"content-widget"},k.render()):k instanceof HTMLElement?q.tsx("div",{afterCreate:this._attachToNode,bind:k,key:"content-element"}):null:null}_renderContents(){const {content:k,open:b}=this;return b?Array.isArray(k)?k.map(c=>this._renderContent(c)):this._renderContent(k):
null}async _createLegend(){m.destroyMaybe(this._legend);this._legend=null;if(this._canCreateLegend){var {default:k}=await new Promise((b,c)=>f(["../Legend"],l=>b(Object.freeze(Object.defineProperty({__proto__:null,default:l},Symbol.toStringTag,{value:"Module"}))),c));this._legend=new k(this._legendOptions)}}_attachToNode(k){k.appendChild(this)}_updateLegend(){const k=this._legend;k&&k.set(this._legendOptions)}_getWidget(k){return"legend"===k?this._legend:B.isWidget(k)?k:null}_getFirstWidget(){const {content:k}=
this;return Array.isArray(k)?k.map(b=>this._getWidget(b)).find(b=>b):this._getWidget(k)}};a.__decorate([z.property()],h.prototype,"_legend",void 0);a.__decorate([z.property()],h.prototype,"_canCreateLegend",null);a.__decorate([z.property()],h.prototype,"_legendOptions",null);a.__decorate([z.property()],h.prototype,"_legendLayerInfo",null);a.__decorate([z.property()],h.prototype,"className",void 0);a.__decorate([z.property()],h.prototype,"content",void 0);a.__decorate([z.property()],h.prototype,"disabled",
null);a.__decorate([z.property()],h.prototype,"flowEnabled",void 0);a.__decorate([z.property()],h.prototype,"icon",null);a.__decorate([z.property()],h.prototype,"image",void 0);a.__decorate([z.property()],h.prototype,"listItem",void 0);a.__decorate([z.property()],h.prototype,"open",void 0);a.__decorate([z.property()],h.prototype,"title",null);a.__decorate([z.property()],h.prototype,"visible",void 0);return h=a.__decorate([A.subclass("esri.widgets.LayerList.ListItemPanel")],h)})},"esri/widgets/LayerList/LayerListVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(f,a,h,m,p,z,y){a=class extends a{constructor(){super(...arguments);this.catalogLayerList=!0;this.filter=this.errors=this.collapseButton=this.closeButton=!1;this.flow=!0;this.heading=!1;this.statusIndicators=!0;this.temporaryLayerIndicators=!1}};f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"catalogLayerList",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"closeButton",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,
"collapseButton",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"errors",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"filter",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"flow",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"heading",void 0);f.__decorate([h.property({type:Boolean,nonNullable:!0})],a.prototype,"statusIndicators",void 0);f.__decorate([h.property({type:Boolean,
nonNullable:!0})],a.prototype,"temporaryLayerIndicators",void 0);return a=f.__decorate([y.subclass("esri.widgets.LayerList.LayerListVisibleElements")],a)})},"esri/widgets/support/globalCss":function(){define(["exports"],function(f){f.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",
buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",
menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/support/listUtils":function(){define(["exports"],function(f){f.calciteListFilterProps=["label","description","metadata"];Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../core/Collection ../core/deprecate ../core/Identifiable ../core/Logger ../core/ReactiveMap ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./LayerList/css ./LayerList/LayerListItem ./LayerList/LayerListViewModel ./LayerList/LayerListVisibleElements ./LayerList/ListItem ./LayerList/support/layerListUtils ../chunks/componentsUtils ./support/globalCss ./support/listUtils ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(f,
a,h,m,p,z,y,J,d,A,w,E,B,q,k,b,c,l,t,g,u,x,C,K,L,D){const R=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"})),P=h.ofType(l);p=class extends p.IdentifiableMixin(B){constructor(e,n){super(e,n);this._activeItem=null;this._tooltipReferenceMap=new y;this._focusPanelFlowItem=this._focusRootFlowItem=!1;this._focusLayerFlowItem=null;this._layerListMap=new y;this._selectedDragItemLayerUid=this._lastDragDetail=null;this._rootGroupUid=`operational-${this.uid}`;
this.catalogOptions=this.catalogLayerList=this._openedLayersController=null;this.dragEnabled=this.collapsed=!1;this.filterText=this.filterPlaceholder="";this.headingLevel=2;this.knowledgeGraphOptions=null;this.layerTablesEnabled=new h(["knowledge-graph"]);this.messagesCommon=this.messages=this.mapImageOptions=this.listItemCanReceiveFunction=this.listItemCanGiveFunction=null;this.minDragEnabledItems=t.minDragEnabledItems;this.minFilterItems=t.minFilterItems;this.openedLayers=new h;this.openedLayerLists=
new h;this.selectedItems=new P;this.selectionMode="none";this.tileOptions=this.tableList=null;this.viewModel=new b;this.visibilityAppearance="default";this.visibleElements=new c;this._canMove=({dragEl:r,fromEl:v,toEl:F},G)=>{G="pull"===G?this.listItemCanGiveFunction:this.listItemCanReceiveFunction;r=t.getItem(r);if(!r?.sortable)return!1;var I=t.getItem(v),M=t.getLayerType(v),N=t.getItem(F),O=t.getLayerType(F);M=!!M&&!!O&&M===O;O={selected:r,from:I,to:N};v=v.group;F=F.group;I=I?.layer?.type??"";N=
N?.layer?.type??"";const Q=new Set(["map-image","catalog","knowledge-graph"]);return v&&F&&"function"===typeof G?G.call(null,O):M&&!Q.has(I)&&!Q.has(N)&&"sublayer"!==r?.layer?.type};this._onCatalogOpen=r=>{this.openedLayers.push(r.layer.parent);this._focusLayerFlowItem=r.layer.uid};this._onTablesOpen=r=>{this.openedLayers.push(r.layer);this._focusLayerFlowItem=r.layer.uid};this._onPanelOpen=()=>{this._focusPanelFlowItem=!0};this._onSelectedDragItemLayerUidChange=r=>{this._selectedDragItemLayerUid=
r};this._onTooltipReferenceChange=(r,v)=>{v?this._tooltipReferenceMap.set(r,v):this._tooltipReferenceMap.delete(r)};this._onTriggerAction=(r,v)=>{this.triggerAction(r,v)};this._clearActiveItem=()=>{this._activeItem=null};this._setActiveItem=r=>{"default"===this.visibilityAppearance&&(r=Array.from(r.composedPath()).find(v=>v.classList?.contains(q.css.item)),this._activeItem=t.getItem(r))};this._onCalciteListOrderChange=r=>{const {_lastDragDetail:v}=this,{toEl:F,fromEl:G,dragEl:I,newIndex:M}=r;G&&F&&
(v?.newIndex!==M||v?.dragEl!==I||v?.toEl!==F||v?.fromEl!==G)&&(this._lastDragDetail=r,G===F?(r=Array.from(G.children).filter(N=>N?.matches("calcite-list-item")).map(N=>N.value),this._sortLayers(G,r)):this._moveLayerFromChildList({toEl:F,fromEl:G,dragEl:I,newIndex:M}))}}initialize(){this.addHandles(J.on(()=>this.openedLayers,"change",()=>this._handleOpenedLayersChange(),J.initial))}loadDependencies(){return g.loadCalciteComponents({button:()=>new Promise((e,n)=>f(["../chunks/calcite-button"],e,n)),
flow:()=>new Promise((e,n)=>f(["../chunks/calcite-flow"],e,n)),"flow-item":()=>new Promise((e,n)=>f(["../chunks/calcite-flow-item"],e,n)),list:()=>new Promise((e,n)=>f(["../chunks/calcite-list"],e,n)),notice:()=>new Promise((e,n)=>f(["../chunks/calcite-notice"],e,n)),tooltip:()=>new Promise((e,n)=>f(["../chunks/calcite-tooltip"],e,n))})}destroy(){this._destroyOpenedLayerLists();this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(n=>
"catalog-dynamic-group"!==n.layer.type)).length}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){return this.openedLayers.toArray().map(e=>this._renderLayerFlowItem(e))}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=
e}get multipleSelectionEnabled(){m.deprecatedProperty(z.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0});return"multiple"===this.selectionMode}set multipleSelectionEnabled(e){m.deprecatedProperty(z.getLogger(this),"multipleSelectionEnabled",{replacement:"selectionMode",version:"4.29",warnOnce:!0});this.selectionMode=e?"multiple":this.selectionEnabled?"single":"none"}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=
e}get selectionEnabled(){m.deprecatedProperty(z.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0});return"none"!==this.selectionMode&&this.dragEnabled}set selectionEnabled(e){m.deprecatedProperty(z.getLogger(this),"selectionEnabled",{replacement:"selectionMode, dragEnabled",version:"4.29",warnOnce:!0});this.selectionMode=(this.dragEnabled=e)?this.multipleSelectionEnabled?"multiple":"single":"none"}get view(){return this.viewModel.view}set view(e){this.viewModel.view=
e}triggerAction(e,n){return this.viewModel.triggerAction(e,n)}render(){var e=this.viewModel?.state;e={[u.globalCss.hidden]:"loading"===e,[u.globalCss.disabled]:"disabled"===e};const n=this.operationalItems?.filter(r=>!r.hidden&&(this.visibleElements.errors||!r.error));return D.tsx("div",{class:this.classes(q.css.base,u.globalCss.widget,u.globalCss.panel,e)},n?.length?[this._renderItemTooltips(n),this._renderItems(n)]:this._renderNoItems())}async _createFlowList(e,n){const {_layerListMap:r}=this;var v=
r.get(e);if(v)return v;v="catalog"===e.type?await this._createCatalogLayerList(e):await this._createTableList(e);n.aborted||r.set(e,v);return v}async _handleOpenedLayersChange(){const {_layerListMap:e,openedLayers:n,openedLayerLists:r}=this;this._openedLayersController?.abort();var v=new AbortController;const {signal:F}=v;this._openedLayersController=v;e.forEach((G,I)=>{n.includes(I)||(G.destroy(),e.delete(I))});v=await Promise.all(n.map(G=>this._createFlowList(G,F)));F.aborted||(r.removeAll(),r.addMany(v),
(v=r.at(-1))?"catalogLayer"in v?(this._set("catalogLayerList",v),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",v)):(this._set("catalogLayerList",null),this._set("tableList",null)))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll();this.openedLayers.removeAll();this._layerListMap.clear()}_renderItemTooltip(e){const {_tooltipReferenceMap:n,messages:r}=this;return e?D.tsx("calcite-tooltip",{key:`tooltip-${e.layer.uid}`,referenceElement:n.get(e.layer.uid)},
r.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){return e.incompatible?this._renderItemTooltip(e):e.children?.filter(n=>!n.hidden).toArray().map(n=>this._renderItemTooltipNodes(n))}_renderItemTooltips(e){return e?.toArray().map(n=>this._renderItemTooltipNodes(n))}_renderNoItemsMessage(){return D.tsx("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return D.tsx("div",{class:q.css.itemMessage,key:"esri-layer-list__no-items"},D.tsx("calcite-notice",{icon:"information",
kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(e){const {default:n}=await new Promise((S,H)=>f(["./CatalogLayerList"],V=>S(R(V)),H)),{headingLevel:r,catalogOptions:v,view:F,filterPlaceholder:G,listItemCreatedFunction:I,minFilterItems:M,selectionMode:N,visibilityAppearance:O,_onCatalogOpen:Q,_onTablesOpen:T,layerTablesEnabled:U}=this;return new n({headingLevel:r,view:F,filterPlaceholder:G,listItemCreatedFunction:I,minFilterItems:M,selectionMode:N,visibilityAppearance:O,
...v,catalogLayer:e,layerTablesEnabled:U,onCatalogOpen:Q,onTablesOpen:T})}_getTableListParams(e){switch(e.type){case "knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case "map-image":return{...this.mapImageOptions,tables:e.subtables};case "tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(e){const {default:n}=await new Promise((G,I)=>f(["./TableList"],M=>G(R(M)),I)),{headingLevel:r,selectionMode:v,dragEnabled:F}=this;return new n({headingLevel:r,
selectionMode:v,dragEnabled:F,...this._getTableListParams(e)})}_renderLayerFlowItem(e){const {messages:n,openedLayers:r}=this;return D.tsx("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:e.title||this.messages.untitledLayer,heading:n["catalog"===e.type?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,onCalciteFlowItemBack:v=>{v.preventDefault();r.pop();(v=r.at(-1))?
this._focusLayerFlowItem=v.uid:this._focusRootFlowItem=!0}},this._layerListMap.get(e)?.render())}_renderPanelFlowItems(e){return e?e.flatten(n=>n.children).filter(({hidden:n,panel:r})=>!n&&r?.open&&!r.disabled&&r.flowEnabled).toArray().map(({title:n,panel:r})=>{const v=()=>this._handlePanelFlowItemBack(r);return D.tsx("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:n,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,
onCalciteFlowItemBack:F=>{F.preventDefault();v()}},r.render(),D.tsx("calcite-button",{appearance:"transparent",onclick:v,slot:"footer-actions",width:"full"},this.messagesCommon.back))}):[]}_handlePanelFlowItemBack(e){e.open=!1;this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,C.setFocus(e))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,C.setFocus(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&
(this._focusPanelFlowItem=!1,C.setFocus(e))}_renderItems(e){const {visible:n,collapsed:r,_filterEnabled:v,_rootGroupUid:F,visibleElements:{closeButton:G,collapseButton:I,heading:M,flow:N},_dragEnabled:O,selectionMode:Q,filterText:T,filterPlaceholder:U,messages:S}=this;e=[D.tsx("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:G,closed:!n,collapsed:r,collapsible:I,heading:M?S.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",
onCalciteFlowItemClose:()=>this.visible=!1},D.tsx("calcite-list",{afterCreate:H=>{H.addEventListener("focusin",this._setActiveItem);H.addEventListener("focusout",this._clearActiveItem)},afterRemoved:H=>{H.removeEventListener("focusin",this._setActiveItem);H.removeEventListener("focusout",this._clearActiveItem)},canPull:H=>this._canMove(H,"pull"),canPut:H=>this._canMove(H,"put"),"data-layer-type":F,dragEnabled:O,filterEnabled:v,filterPlaceholder:U,filterProps:x.calciteListFilterProps,filterText:v?
T:"",group:F,key:"root-list",label:S.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:Q,onCalciteListChange:H=>this._handleCalciteListChange(H),onCalciteListDragEnd:H=>this._handleCalciteListDragEnd(H.detail),onCalciteListFilter:H=>this.filterText=H.target?.filterText??"",onCalciteListOrderChange:H=>this._onCalciteListOrderChange(H.detail)},e?.toArray().map(H=>this._renderItem(H)),e?.length&&v?D.tsx("div",{class:q.css.filterNoResults,
slot:"filter-no-results"},D.tsx("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(e),this._renderedOpenLayerFlowItems];return n?N?D.tsx("calcite-flow",{key:"root-flow"},e):e:null}_renderItem(e,n,r){return D.tsx(k,{activeItem:this._activeItem,canMove:this._canMove,css:q.css,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,
messages:this.messages,messagesCommon:this.messagesCommon,parent:n,parentTitles:r,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,
onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:n,dragEl:r,newIndex:v}){r=t.getItem(r);e=t.getItem(e);n=t.getItem(n);this.viewModel.moveListItem(r,n,e,v)}_handleCalciteListDragEnd(e){const {fromEl:n,dragEl:r,oldIndex:v}=e;n.insertBefore(r,n.children[v])}_sortLayers(e,n){e&&(e.group===this._rootGroupUid?t.sortLayersToIds(this.view?.map?.layers,n):(e=t.getItem(e))&&t.sortChildLayersToIds(e,n))}_handleCalciteListChange(e){const {selectionMode:n,selectedItems:r}=
this;"none"!==n&&(e=e.target.selectedItems.map(v=>t.getItem(v)).filter(Boolean),r.removeAll(),r.addMany(e))}};a.__decorate([d.property()],p.prototype,"_activeItem",void 0);a.__decorate([d.property()],p.prototype,"_tooltipReferenceMap",void 0);a.__decorate([d.property()],p.prototype,"_focusRootFlowItem",void 0);a.__decorate([d.property()],p.prototype,"_focusPanelFlowItem",void 0);a.__decorate([d.property()],p.prototype,"_focusLayerFlowItem",void 0);a.__decorate([d.property()],p.prototype,"_layerListMap",
void 0);a.__decorate([d.property()],p.prototype,"_totalItems",null);a.__decorate([d.property()],p.prototype,"_dragEnabled",null);a.__decorate([d.property()],p.prototype,"_filterEnabled",null);a.__decorate([d.property()],p.prototype,"_renderedOpenLayerFlowItems",null);a.__decorate([d.property({readOnly:!0})],p.prototype,"catalogLayerList",void 0);a.__decorate([d.property()],p.prototype,"catalogOptions",void 0);a.__decorate([d.property()],p.prototype,"collapsed",void 0);a.__decorate([d.property()],
p.prototype,"dragEnabled",void 0);a.__decorate([d.property()],p.prototype,"filterPlaceholder",void 0);a.__decorate([d.property()],p.prototype,"filterText",void 0);a.__decorate([d.property()],p.prototype,"headingLevel",void 0);a.__decorate([d.property()],p.prototype,"icon",null);a.__decorate([d.property()],p.prototype,"knowledgeGraphOptions",void 0);a.__decorate([d.property()],p.prototype,"label",null);a.__decorate([d.property()],p.prototype,"layerTablesEnabled",void 0);a.__decorate([d.property()],
p.prototype,"listItemCanGiveFunction",void 0);a.__decorate([d.property()],p.prototype,"listItemCanReceiveFunction",void 0);a.__decorate([d.property()],p.prototype,"listItemCreatedFunction",null);a.__decorate([d.property()],p.prototype,"mapImageOptions",void 0);a.__decorate([d.property(),K.messageBundle("esri/widgets/LayerList/t9n/LayerList")],p.prototype,"messages",void 0);a.__decorate([d.property(),K.messageBundle("esri/t9n/common")],p.prototype,"messagesCommon",void 0);a.__decorate([d.property()],
p.prototype,"minDragEnabledItems",void 0);a.__decorate([d.property()],p.prototype,"minFilterItems",void 0);a.__decorate([d.property()],p.prototype,"multipleSelectionEnabled",null);a.__decorate([d.property({readOnly:!0})],p.prototype,"openedLayers",void 0);a.__decorate([d.property({readOnly:!0})],p.prototype,"openedLayerLists",void 0);a.__decorate([d.property()],p.prototype,"operationalItems",null);a.__decorate([d.property()],p.prototype,"selectionEnabled",null);a.__decorate([d.property()],p.prototype,
"selectedItems",void 0);a.__decorate([d.property()],p.prototype,"selectionMode",void 0);a.__decorate([d.property({readOnly:!0})],p.prototype,"tableList",void 0);a.__decorate([d.property()],p.prototype,"tileOptions",void 0);a.__decorate([d.property()],p.prototype,"view",null);a.__decorate([L.vmEvent("trigger-action"),d.property({type:b})],p.prototype,"viewModel",void 0);a.__decorate([d.property()],p.prototype,"visibilityAppearance",void 0);a.__decorate([d.property({type:c,nonNullable:!0})],p.prototype,
"visibleElements",void 0);return p=a.__decorate([E.subclass("esri.widgets.LayerList")],p)});