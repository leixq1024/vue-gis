// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/interactive/sketch/SketchValueOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./Units ../../support/angularMeasurementUtils".split(" "),function(a,b,d,m,p,l,k,E,q){b=class extends b{constructor(f){super(f);this.directionMode="relative";this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case "relative":return this.relativeDirectionIsBilateral?
q.DirectionMode.RelativeBilateral:q.DirectionMode.Relative;case "absolute":return q.DirectionMode.Absolute}}get displayUnits(){return this._get("displayUnits")??new E}set displayUnits(f){this._set("displayUnits",f)}get inputUnits(){return this._get("inputUnits")??new E}set inputUnits(f){this._set("inputUnits",f)}};a.__decorate([d.property({type:String,nonNullable:!0})],b.prototype,"directionMode",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"relativeDirectionIsBilateral",
void 0);a.__decorate([d.property()],b.prototype,"effectiveDirectionMode",null);a.__decorate([d.property({type:E,nonNullable:!0})],b.prototype,"displayUnits",null);a.__decorate([d.property({type:E,nonNullable:!0})],b.prototype,"inputUnits",null);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.SketchValueOptions")],b)})},"esri/views/interactive/sketch/Units":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.area=this.verticalLength=this.length=null}};a.__decorate([d.property()],b.prototype,"length",void 0);a.__decorate([d.property()],b.prototype,"verticalLength",void 0);a.__decorate([d.property()],b.prototype,"area",void 0);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.Units")],b)})},"esri/views/support/angularMeasurementUtils":function(){define("exports ../../core/Cyclical ../../core/quantityUtils ../../core/unitUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){function t(z,C){if(null!=z&&null!=C)return z=n(z,C),null!=z?d.createAngle(z,"radians","geographic"):void 0}function A(z,C,L){if(z&&C&&L&&(z=n(z,C),C=n(C,L),null!=z&&null!=C))return d.createAngle(C-z,"radians","geographic")}function x(z,C){if(null!=z)switch(C){case a.DirectionMode.Absolute:return v(z);case a.DirectionMode.Relative:return z=B(z),z=P.normalize(z,0,!0),-180===z&&(z=180),d.createAngle(z,"degrees","geographic");case a.DirectionMode.RelativeBilateral:return z=
B(z),z=Math.abs(P.normalize(z,0,!0)),d.createAngle(z,"degrees","geographic")}}function v(z){z=B(z);z=G.normalize(z,0,!0);return d.createAngle(z,"degrees","geographic")}function B(z){if(null!=z)return d.convertRotationType(m.convertUnit(z.value,z.unit,"degrees"),z.rotationType,"geographic")}a.DirectionMode=void 0;(function(z){z.Absolute="absolute";z.Relative="relative";z.RelativeBilateral="relative-bilateral"})(a.DirectionMode||(a.DirectionMode={}));const n=(()=>{const z=E.create(),C=E.create();return(L,
S)=>{k.set(z,L.x,L.y,L.z??0);k.set(C,S.x,S.y,S.z??0);return w(z,C,L.spatialReference,S.spatialReference)}})(),w=(()=>{const z=l.create(),C=E.create(),L=E.create();return(S,r,J,M)=>{if(!k.exactEquals(S,r)){var y=f.geodesicCompatibleSpatialReference(J),H=f.geodesicCompatibleSpatialReference(M);if(y&&H&&u.equals(y,H)&&q.projectVectorToVector(S,J,C,y)&&q.projectVectorToVector(r,M,L,H))return{azimuth:S}=f.inverseGeodeticSolver(K,C,L,y),null!=S?m.convertUnit(S,"degrees","radians"):void 0;z[0]=r[0]-S[0];
z[1]=r[1]-S[1];S=p.angle(l.UNIT_Y,z);0>z[0]&&(S=N-S);return S}}})(),D=(()=>{const z=E.create();return(C,L,S,r,J,M="geodesic")=>{k.copy(z,L);J=B(J);if("geodesic"===M&&(M=f.geodesicCompatibleSpatialReference(S))&&q.projectVectorToVector(z,S,z,M))return f.directGeodeticSolver(C,z,J,r,M),C[2]=L[2],q.projectVectorToVector(C,M,C,S)?!0:!1;S=d.convertRotationType(J,"geographic","arithmetic");S=m.convertUnit(S,"degrees","radians");k.set(C,L[0]+r*Math.cos(S),L[1]+r*Math.sin(S),L[2]);return!0}})(),K=new f.InverseGeodeticSolverResult,
N=2*Math.PI,G=b.cyclicalDegrees,P=new b.Cyclical(-180,180);a.convertAngle=function(z,C,L){let S=m.convertUnit(z.value,z.unit,"degrees");S=d.convertRotationType(S,z.rotationType,L);S=m.convertUnit(S,"degrees",C);return d.createAngle(S,C,L)};a.directionBetweenPoints=t;a.directionForVertices=function(z,C,L,S=a.DirectionMode.Absolute){if(C&&L)switch(S){case a.DirectionMode.Absolute:return t(C,L);case a.DirectionMode.Relative:return x(A(z,C,L),a.DirectionMode.Relative);case a.DirectionMode.RelativeBilateral:return x(A(z,
C,L),a.DirectionMode.RelativeBilateral)}};a.getDegreesArithmetic=function(z){if(null!=z)return d.convertRotationType(m.convertUnit(z.value,z.unit,"degrees"),z.rotationType,"arithmetic")};a.getDegreesGeographic=B;a.getNormalizedDirection=x;a.getNormalizedGeographicOrientation=v;a.pointFromDistanceAlongAzimuth=D;a.radiansGeographicBetweenVec=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,b){function d(x,
v){return{type:b.unitType(v),value:x,unit:v}}function m(x,v){return{type:b.unitType(v),value:x,unit:v}}function p(x,v){return{type:b.unitType(v),value:x,unit:v}}function l(x,v,B="arithmetic"){return{type:b.unitType(v),value:x,unit:v,rotationType:B}}function k(x,v){const B=E(x,v);return"angle"===x.type?l(B,v,x.rotationType):d(B,v)}function E(x,v){return b.convertUnit(x.value,x.unit,v)}const q=m(0,"meters"),f=p(0,"square-meters"),u=l(0,"radians"),t=l(0,"degrees"),A=l(0,"degrees","geographic");a.convertRotationType=
function(x,v,B){if(v===B)return x;switch(B){case "arithmetic":case "geographic":return-x+90}};a.createAngle=l;a.createArea=p;a.createLength=m;a.createQuantity=d;a.createScalar=function(x){return{value:x}};a.isBaseUnit=function(x){return b.isBaseUnit(x.unit)};a.max=function(x,v){return null==x?v:null==v?x:x.value>b.convertUnit(v.value,v.unit,x.unit)?x:v};a.min=function(x,v){return null==x?v:null==v?x:x.value<b.convertUnit(v.value,v.unit,x.unit)?x:v};a.scale=function(x,v){return null==x?null:{...x,
value:x.value*v}};a.toBaseUnit=function(x){return k(x,b.baseUnitForUnit(x.unit))};a.toUnit=k;a.valueInUnit=E;a.zeroDegrees=t;a.zeroDegreesGeographic=A;a.zeroMeters=q;a.zeroRadians=u;a.zeroSquareMeters=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["exports","./common"],function(a,b){function d(I,O){I[0]=O[0];I[1]=O[1];return I}function m(I,O,R){I[0]=O;I[1]=R;return I}function p(I,O,R){I[0]=O[0]+R[0];I[1]=O[1]+R[1];return I}
function l(I,O,R){I[0]=O[0]-R[0];I[1]=O[1]-R[1];return I}function k(I,O,R){I[0]=O[0]*R[0];I[1]=O[1]*R[1];return I}function E(I,O,R){I[0]=O[0]/R[0];I[1]=O[1]/R[1];return I}function q(I,O){I[0]=Math.ceil(O[0]);I[1]=Math.ceil(O[1]);return I}function f(I,O){I[0]=Math.floor(O[0]);I[1]=Math.floor(O[1]);return I}function u(I,O,R){I[0]=Math.min(O[0],R[0]);I[1]=Math.min(O[1],R[1]);return I}function t(I,O,R){I[0]=Math.max(O[0],R[0]);I[1]=Math.max(O[1],R[1]);return I}function A(I,O){I[0]=Math.round(O[0]);I[1]=
Math.round(O[1]);return I}function x(I,O,R){I[0]=O[0]*R;I[1]=O[1]*R;return I}function v(I,O,R,W){I[0]=O[0]+R[0]*W;I[1]=O[1]+R[1]*W;return I}function B(I,O){const R=O[0]-I[0];I=O[1]-I[1];return Math.sqrt(R*R+I*I)}function n(I,O){const R=O[0]-I[0];I=O[1]-I[1];return R*R+I*I}function w(I){const O=I[0];I=I[1];return Math.sqrt(O*O+I*I)}function D(I){const O=I[0];I=I[1];return O*O+I*I}function K(I,O){I[0]=-O[0];I[1]=-O[1];return I}function N(I,O){I[0]=1/O[0];I[1]=1/O[1];return I}function G(I,O){var R=O[0];
const W=O[1];R=R*R+W*W;0<R&&(R=1/Math.sqrt(R),I[0]=O[0]*R,I[1]=O[1]*R);return I}function P(I,O){return I[0]*O[0]+I[1]*O[1]}function z(I,O,R){O=O[0]*R[1]-O[1]*R[0];I[0]=I[1]=0;I[2]=O;return I}function C(I,O,R,W){const V=O[0];O=O[1];I[0]=V+W*(R[0]-V);I[1]=O+W*(R[1]-O);return I}function L(I,O=1){const R=2*b.RANDOM()*Math.PI;I[0]=Math.cos(R)*O;I[1]=Math.sin(R)*O;return I}function S(I,O,R){const W=O[0];O=O[1];I[0]=R[0]*W+R[2]*O;I[1]=R[1]*W+R[3]*O;return I}function r(I,O,R){const W=O[0];O=O[1];I[0]=R[0]*
W+R[2]*O+R[4];I[1]=R[1]*W+R[3]*O+R[5];return I}function J(I,O,R){const W=O[0];O=O[1];I[0]=R[0]*W+R[3]*O+R[6];I[1]=R[1]*W+R[4]*O+R[7];return I}function M(I,O,R){const W=O[0];O=O[1];I[0]=R[0]*W+R[4]*O+R[12];I[1]=R[1]*W+R[5]*O+R[13];return I}function y(I,O,R,W){const V=O[0]-R[0];O=O[1]-R[1];const aa=Math.sin(W);W=Math.cos(W);I[0]=V*W-O*aa+R[0];I[1]=V*aa+O*W+R[1];return I}function H(I,O){var R=I[0];I=I[1];const W=O[0];O=O[1];let V=R*R+I*I;0<V&&(V=1/Math.sqrt(V));let aa=W*W+O*O;0<aa&&(aa=1/Math.sqrt(aa));
R=(R*W+I*O)*V*aa;return 1<R?0:-1>R?Math.PI:Math.acos(R)}function h(I){return"vec2("+I[0]+", "+I[1]+")"}function e(I,O){return I[0]===O[0]&&I[1]===O[1]}function c(I,O){const R=I[0];I=I[1];const W=O[0];O=O[1];const V=b.getEpsilon();return Math.abs(R-W)<=V*Math.max(1,Math.abs(R),Math.abs(W))&&Math.abs(I-O)<=V*Math.max(1,Math.abs(I),Math.abs(O))}function g(I,O,R,W,V){let aa=O[0]-R[0];R=O[1]-R[1];V=(W[0]*aa+W[1]*R)*(V-1);aa=W[0]*V;R=W[1]*V;I[0]=O[0]+aa;I[1]=O[1]+R;return I}const F=Object.freeze(Object.defineProperty({__proto__:null,
add:p,angle:H,ceil:q,copy:d,cross:z,dist:B,distance:B,div:E,divide:E,dot:P,equals:c,exactEquals:e,floor:f,inverse:N,len:w,length:w,lerp:C,max:t,min:u,mul:k,multiply:k,negate:K,normalize:G,projectAndScale:g,random:L,rotate:y,round:A,scale:x,scaleAndAdd:v,set:m,sqrDist:n,sqrLen:D,squaredDistance:n,squaredLength:D,str:h,sub:l,subtract:l,transformMat2:S,transformMat2d:r,transformMat3:J,transformMat4:M},Symbol.toStringTag,{value:"Module"}));a.add=p;a.angle=H;a.ceil=q;a.copy=d;a.cross=z;a.dist=B;a.distance=
B;a.div=E;a.divide=E;a.dot=P;a.equals=c;a.exactEquals=e;a.floor=f;a.inverse=N;a.len=w;a.length=w;a.lerp=C;a.max=t;a.min=u;a.mul=k;a.multiply=k;a.negate=K;a.normalize=G;a.projectAndScale=g;a.random=L;a.rotate=y;a.round=A;a.scale=x;a.scaleAndAdd=v;a.set=m;a.sqrDist=n;a.sqrLen=D;a.squaredDistance=n;a.squaredLength=D;a.str=h;a.sub=l;a.subtract=l;a.transformMat2=S;a.transformMat2d=r;a.transformMat3=J;a.transformMat4=M;a.vec2=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["exports"],
function(a){function b(){return[0,0]}function d(B){return[B[0],B[1]]}function m(B,n){return[B,n]}function p(B,n=[0,0]){const w=Math.min(2,B.length);for(let D=0;D<w;++D)n[D]=B[D];return n}function l(B,n){return new Float64Array(B,n,2)}function k(){return[0,0]}function E(){return[1,1]}function q(){return[1,0]}function f(){return[0,1]}const u=[0,0],t=[1,1],A=[1,0],x=[0,1],v=Object.freeze(Object.defineProperty({__proto__:null,ONES:t,UNIT_X:A,UNIT_Y:x,ZEROS:u,clone:d,create:b,createView:l,fromArray:p,
fromValues:m,ones:E,unitX:q,unitY:f,zeros:k},Symbol.toStringTag,{value:"Module"}));a.ONES=t;a.UNIT_X=A;a.UNIT_Y=x;a.ZEROS=u;a.clone=d;a.create=b;a.createView=l;a.fromArray=p;a.fromValues=m;a.ones=E;a.unitX=q;a.unitY=f;a.vec2f64=v;a.zeros=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectVectorToVector":function(){define(["exports","../projection","../SpatialReference","./projectPointToVector","../../layers/graphics/dehydratedPoint"],function(a,b,d,
m,p){function l(E,q,f,u,t){if(null==q||null==u||2>E.length)return!1;k.x=E[0];k.y=E[1];k.z=E[2];k.spatialReference=q;return m.projectPointToVector(k,f,u,t)}const k=p.makeDehydratedPoint(0,0,0,d.WGS84);a.projectVectorToVector=l;a.projectVectorToVectorAsync=async function(E,q,f,u,t,A){await b.initializeProjection(q,u,null,A);return l(E,q,f,u,t)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPointToVector":function(){define(["exports","../../core/libs/gl-matrix-2/factories/vec3f64",
"../projection","./projectBuffer"],function(a,b,d,m){function p(k,E,q,f){if(d.canProjectWithoutEngine(k.spatialReference,q))return l[0]=k.x,l[1]=k.y,l[2]=k.z??f??0,m.projectBuffer(l,k.spatialReference,0,E,q,0);k=d.tryProjectWithZConversion(k,q);if(!k)return!1;E[0]=k?.x;E[1]=k?.y;E[2]=k?.z??f??0;return!0}const l=b.create();a.projectPointToVector=p;a.projectPointToVectorAsync=async function(k,E,q,f,u){await d.initializeProjection(k.spatialReference,q,null,u);return p(k,E,q,f)};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/dehydratedPoint":function(){define(["exports"],function(a){a.makeDehydratedPoint=function(b,d,m,p){return{x:b,y:d,z:m,hasZ:null!=m,hasM:!1,spatialReference:p,type:"point"}};a.setDehydratedPoint=function(b,d,m,p,l){b.x=d;b.y=m;b.z=p;b.hasZ=null!=p;b.spatialReference=l};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ../../core/accessorSupport/ensureType ./geodesicConstants ./spatialReferenceUtils ../SpatialReference ../Polyline ../Polygon ../Point".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){function t(N){if(!N)return null;var G=N.wkid;if(G)return l.spheroids[G];(N=N.wkt2??N.wkt)?(N=l.wktSpheroidRegex.exec(N))&&2===N.length?(G=N[1].split(","),!G||3>G.length?N=null:(N=parseFloat(G[1]),G=parseFloat(G[2]),N=isNaN(N)||isNaN(G)?null:{a:N,f:0===G?0:1/G})):N=null:N=null;return N}function A(N){N=t(N);if(null!=N&&"b"in N&&"eSq"in N&&"radius"in N)return N;const G=N.a*(1-N.f);return Object.assign(N,{b:G,eSq:1-(G/N.a)**2,radius:(2*N.a+G)/3,densificationRatio:1E4/((2*
N.a+G)/3)})}function x(N){return null!=N&&0>N?N+360:N}function v(N,G,P){const {a:z,eSq:C}=A(P);P=Math.sqrt(C);const L=Math.sin(G[1]*l.toRadians);G=z*G[0]*l.toRadians;P=0<C?z*(1-C)*(L/(1-C*L*L)-1/(2*P)*Math.log((1-P*L)/(1+P*L)))*.5:z*L;N[0]=G;N[1]=P;return N}function B(N){return k.isGeographic(N)&&!!t(N)}function n(N,G){if("polyline"!==N.type&&"polygon"!==N.type)throw new d("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:P}=N;if(!B(P))throw new d("geodesic-densify:invalid-spatial-reference",
"the input geometry spatial reference is not supported");var z="polyline"===N.type?N.paths:N.rings;const C=[],L=[0,0],S=new K;for(const M of z){z=[];C.push(z);z.push([M[0][0],M[0][1]]);var r=M[0][0],J=M[0][1];let y,H;for(let h=0;h<M.length-1;h++){y=M[h+1][0];H=M[h+1][1];if(r===y&&J===H)continue;const e=[r,J];D(S,[r,J],[y,H],P);const {azimuth:c,distance:g}=S;r=g/G;if(1<r){for(J=1;J<=r-1;J++)w(L,e,c,J*G,P),z.push(L.slice());w(L,e,c,(g+Math.floor(r-1)*G)/2,P);z.push(L.slice())}w(L,e,c,g,P);z.push(L.slice());
r=L[0];J=L[1]}}G=p.ensureClass(E,P);return"polyline"===N.type?new q({paths:C,spatialReference:G}):new f({rings:C,spatialReference:G})}function w(N,G,P,z,C){const L=G[0]*l.toRadians;G=G[1]*l.toRadians;P=(P??0)*l.toRadians;const {a:S,b:r,f:J}=A(C);C=Math.sin(P);P=Math.cos(P);var M=(1-J)*Math.tan(G);G=1/Math.sqrt(1+M*M);const y=M*G,H=Math.atan2(M,P);M=G*C;const h=M*M;var e=1-h,c=e*(S*S-r*r)/(r*r);const g=1+c/16384*(4096+c*(-768+c*(320-175*c))),F=c/1024*(256+c*(-128+c*(74-47*c)));c=z/(r*g);let I=2*Math.PI,
O,R,W,V;for(;1E-12<Math.abs(c-I);)W=Math.cos(2*H+c),O=Math.sin(c),R=Math.cos(c),V=F*O*(W+F/4*(R*(-1+2*W*W)-F/6*W*(-3+4*O*O)*(-3+4*W*W))),I=c,c=z/(r*g)+V;z=y*O-G*R*P;e=J/16*e*(4+J*(4-3*e));z=Math.atan2(y*R+G*O*P,(1-J)*Math.sqrt(h+z*z))/l.toRadians;N[0]=(L+(Math.atan2(O*C,G*R-y*O*P)-(1-e)*J*M*(c+e*O*(W+e*R*(-1+2*W*W)))))/l.toRadians;N[1]=z;return N}function D(N,G,P,z){var C=G[0]*l.toRadians;G=G[1]*l.toRadians;var L=P[0]*l.toRadians;P=P[1]*l.toRadians;const {a:S,b:r,f:J,radius:M}=A(z),y=L-C;var H=Math.atan((1-
J)*Math.tan(G)),h=Math.atan((1-J)*Math.tan(P));z=Math.sin(H);H=Math.cos(H);const e=Math.sin(h);h=Math.cos(h);let c=1E3,g=y,F,I,O;let R,W,V;do{var aa=Math.sin(g);var fa=Math.cos(g);O=Math.sqrt(h*aa*h*aa+(H*e-z*h*fa)*(H*e-z*h*fa));if(0===O)return N.distance=0,N.azimuth=void 0,N.reverseAzimuth=void 0,N;fa=z*e+H*h*fa;R=Math.atan2(O,fa);W=H*h*aa/O;I=1-W*W;aa=fa-2*z*e/I;isNaN(aa)&&(aa=0);V=J/16*I*(4+J*(4-3*I));F=g;g=y+(1-V)*J*W*(R+V*O*(aa+V*fa*(-1+2*aa*aa)))}while(1E-12<Math.abs(g-F)&&0<--c);if(0===c)return z=
Math.acos(Math.sin(G)*Math.sin(P)+Math.cos(G)*Math.cos(P)*Math.cos(L-C))*M,C=L-C,N.azimuth=Math.atan2(Math.sin(C)*Math.cos(P),Math.cos(G)*Math.sin(P)-Math.sin(G)*Math.cos(P)*Math.cos(C))/l.toRadians,N.distance=z,N.reverseAzimuth=void 0,N;C=I*(S*S-r*r)/(r*r);G=C/1024*(256+C*(-128+C*(74-47*C)));L=Math.atan2(H*Math.sin(g),H*e*Math.cos(g)-z*h);N.azimuth=Math.atan2(h*Math.sin(g),H*e-z*h*Math.cos(g))/l.toRadians;N.distance=r*(1+C/16384*(4096+C*(-768+C*(320-175*C))))*(R-G*O*(aa+G/4*(fa*(-1+2*aa*aa)-G/6*
aa*(-3+4*O*O)*(-3+4*aa*aa))));N.reverseAzimuth=L/l.toRadians;return N}class K{constructor(N=0,G,P){this.distance=N;this.azimuth=G;this.reverseAzimuth=P}}a.InverseGeodeticSolverResult=K;a.directGeodeticSolver=w;a.geodesicAreas=function(N,G="square-meters"){if(N.some(L=>!B(L.spatialReference)))throw new d("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const P=[];for(var z=0;z<N.length;z++){var C=N[z];const {radius:L,densificationRatio:S}=A(C.spatialReference);
P.push(n(C,L*S))}N=[];z=[0,0];C=[0,0];for(let L=0;L<P.length;L++){const {rings:S,spatialReference:r}=P[L];let J=0;for(let M=0;M<S.length;M++){const y=S[M];v(z,y[0],r);v(C,y[y.length-1],r);let H=C[0]*z[1]-z[0]*C[1];for(let h=0;h<y.length-1;h++)v(z,y[h+1],r),v(C,y[h],r),H+=C[0]*z[1]-z[0]*C[1];J+=H}J=m.convertUnit(J,"square-meters",G);N.push(J/-2)}return N};a.geodesicCompatibleSpatialReference=function(N){return B(N)?N:k.isWebMercator(N)?E.WGS84:null};a.geodesicDensify=n;a.geodesicDistance=function(N,
G,P="meters"){if(!N||!G)throw new d("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!N.spatialReference||!G.spatialReference)throw new d("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!k.equals(N.spatialReference,G.spatialReference))throw new d("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:z}=N;if(!B(z))throw new d("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(N.x===G.x&&N.y===G.y)return new K(0,0,0);const C=new K;D(C,[N.x,N.y],[G.x,G.y],z);C.distance=m.convertUnit(C.distance,"meters",P);C.azimuth=x(C.azimuth);C.reverseAzimuth=x(C.reverseAzimuth);return C};a.geodesicLengths=function(N,G="meters"){if(!N)throw new d("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(N.some(C=>!B(C.spatialReference)))throw new d("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const P=[];for(let C=0;C<N.length;C++){var z=N[C];const {spatialReference:L}=z;z="polyline"===z.type?z.paths:z.rings;let S=0;for(let r=0;r<z.length;r++){const J=z[r];let M=0;for(let y=1;y<J.length;y++){const H=J[y-1][0],h=J[y][0],e=J[y-1][1],c=J[y][1];if(e!==c||H!==h){const g=new K;D(g,[H,e],[h,c],L);M+=g.distance}}S+=M}S=m.convertUnit(S,"meters",G);P.push(S)}return P};a.inverseGeodeticSolver=D;a.isSupported=B;a.pointFromDistance=function(N,G,P){if(!N||null==G||null==P)throw new d("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>P||360<P)throw new d("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!N.spatialReference)throw new d("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:z}=N;if(!B(z))throw new d("geodesic-distance:not-supported","input geometry spatial reference is not supported");const C=[0,0];w(C,[N.x,N.y],
P,G,z);return new u({x:C[0],y:C[1],spatialReference:z})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D){const K={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},N=window.CSS;E=class extends u{constructor(G,P){super(G,P);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...K};this._supportsImageOrientation=N&&N.supports&&N.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(G){G?.viewModel||(G={viewModel:new t,...G});return G}initialize(){this.addHandles([m.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),m.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),m.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),m.initial)])}loadDependencies(){return x.loadCalciteComponents({icon:()=>new Promise((G,P)=>a(["../chunks/calcite-icon"],G,P))})}get capabilities(){return this.viewModel.capabilities}set capabilities(G){this.viewModel.capabilities=
G}get effectiveDisplayType(){const {displayType:G}=this;return G&&"auto"!==G?G:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(G){this.viewModel.graphic=G}get icon(){return"attachment"}set icon(G){this._overrideIfSome("icon",G)}get label(){return this.messages?.widgetLabel??""}set label(G){this._overrideIfSome("label",G)}castVisibleElements(G){return{...K,...G}}addAttachment(){const {_addAttachmentForm:G,viewModel:P}=this;this._set("submitting",
!0);this._set("error",null);return P.addAttachment(G).then(z=>{this._set("submitting",!1);this._set("error",null);P.mode="view";return z}).catch(z=>{this._set("submitting",!1);this._set("error",new d("attachments:add-attachment",this.messages.addErrorMessage,z));throw z;})}deleteAttachment(G){const {viewModel:P}=this;this._set("submitting",!0);this._set("error",null);return P.deleteAttachment(G).then(z=>{this._set("submitting",!1);this._set("error",null);P.mode="view";return z}).catch(z=>{this._set("submitting",
!1);this._set("error",new d("attachments:delete-attachment",this.messages.deleteErrorMessage,z));throw z;})}updateAttachment(){const {viewModel:G}=this,{_updateAttachmentForm:P}=this;this._set("submitting",!0);this._set("error",null);return G.updateAttachment(P).then(z=>{this._set("submitting",!1);this._set("error",null);G.mode="view";return z}).catch(z=>{this._set("submitting",!1);this._set("error",new d("attachments:update-attachment",this.messages.updateErrorMessage,z));throw z;})}addFile(){const G=
this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return G}updateFile(){const {viewModel:G}=this,P=G.updateFile(this.selectedFile,this._updateAttachmentForm,G.activeFileInfo);G.mode="view";return P}deleteFile(G){G=this.viewModel.deleteFile(G||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return G}render(){const {submitting:G,viewModel:P}=this,{state:z}=P;return D.tsx("div",{class:this.classes("esri-attachments",v.globalCss.widget)},G?this._renderProgressBar():
null,"loading"===z?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const {error:G,visibleElements:P}=this;return G&&P.errorMessage?D.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},G.message):null}_renderAttachments(){const {activeFileInfo:G,mode:P,activeAttachmentInfo:z}=this.viewModel;return"add"===P?this._renderAddForm():"edit"===P?this._renderDetailsForm(z||G):this._renderAttachmentContainer()}_renderLoading(){return D.tsx("div",
{class:"esri-attachments__loader-container",key:"loader"},D.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?D.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:G,selectedFile:P}=this;var z=G||!P,C=this.visibleElements.cancelAddButton?D.tsx("button",{bind:this,class:this.classes(v.globalCss.button,v.globalCss.buttonTertiary,v.globalCss.buttonSmall,v.globalCss.buttonHalf,G&&v.globalCss.buttonDisabled),
disabled:G,onclick:this._cancelForm,type:"button"},this.messages.cancel):null;z=this.visibleElements.addSubmitButton?D.tsx("button",{class:this.classes(v.globalCss.button,v.globalCss.buttonSecondary,v.globalCss.buttonSmall,v.globalCss.buttonHalf,{[v.globalCss.buttonDisabled]:z}),disabled:z,type:"submit"},this.messages.add):null;const L=P?D.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},P.name):null;C=D.tsx("form",{afterCreate:n.storeNode,afterRemoved:n.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",
onsubmit:this._submitAddAttachment},D.tsx("fieldset",{class:"esri-attachments__file-fieldset"},L,D.tsx("label",{class:this.classes("esri-attachments__file-label",v.globalCss.button,v.globalCss.buttonSecondary)},P?this.messages.changeFile:this.messages.selectFile,D.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),z,C);return D.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},C)}_renderDetailsForm(G){const {visibleElements:P,
viewModel:z,selectedFile:C,submitting:L}=this;var {capabilities:S}=z,r=L||!C;let J;if(C){var M=C.type;J=C.name;var y=C.size}else if(G&&"file"in G)M=G.file.type,J=G.file.name,y=G.file.size;else if(G&&"contentType"in G){M=G.contentType;J=G.name;y=G.size;var H=G.url}var h=S.editing&&S.operations?.delete&&P.deleteButton?D.tsx("button",{bind:this,class:this.classes(v.globalCss.button,v.globalCss.buttonSmall,v.globalCss.buttonTertiary,"esri-attachments__delete-button",{[v.globalCss.buttonDisabled]:L}),
disabled:L,key:"delete-button",onclick:c=>this._submitDeleteAttachment(c,G),type:"button"},this.messages.delete):void 0;r=S.editing&&S.operations?.update&&P.updateButton?D.tsx("button",{class:this.classes(v.globalCss.button,v.globalCss.buttonSmall,v.globalCss.buttonThird,{[v.globalCss.buttonDisabled]:r}),disabled:r,key:"update-button",type:"submit"},this.messages.update):void 0;const e=this.visibleElements.cancelUpdateButton?D.tsx("button",{bind:this,class:this.classes(v.globalCss.button,v.globalCss.buttonSmall,
v.globalCss.buttonTertiary,v.globalCss.buttonThird,{[v.globalCss.buttonDisabled]:L}),disabled:L,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;S=S.editing&&S.operations?.update?D.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},D.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},J),D.tsx("label",{class:this.classes("esri-attachments__file-label",v.globalCss.button,v.globalCss.buttonSecondary)},this.messages.changeFile,D.tsx("input",
{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;y=D.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},D.tsx("label",null,p.formatFileSize(this.messagesUnits,y??0)));M=D.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},D.tsx("label",null,M));H=null!=H?D.tsx("a",{class:"esri-attachments__item-link",href:H,rel:"noreferrer",target:"_blank"},this._renderImageMask(G,400),D.tsx("div",
{class:"esri-attachments__item-link-overlay"},D.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},D.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(G,400);h=D.tsx("form",{afterCreate:n.storeNode,afterRemoved:n.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:c=>this._submitUpdateAttachment(c,G)},D.tsx("div",{class:"esri-attachments__metadata"},y,M),S,D.tsx("div",{class:"esri-attachments__actions"},h,e,r));return D.tsx("div",{class:"esri-attachments__form-node",
key:"edit-form-container"},H,h)}_renderImageMask(G,P){return G?"file"in G?this._renderGenericImageMask(G.file.name,G.file.type):this._renderImageMaskForAttachment(G,P):null}_renderGenericImageMask(G,P){var {supportsResizeAttachments:z}=this.viewModel;P=A.getIconPath(P);z={["esri-attachments__image--resizable"]:z};return D.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:P},D.tsx("img",{alt:G,class:this.classes(z,"esri-attachments__image"),src:P,
title:G}))}_renderImageMaskForAttachment(G,P){var {supportsResizeAttachments:z}=this.viewModel;if(!G)return null;const {contentType:C,name:L,url:S}=G;if(!z||!A.isSupportedImage(C))return this._renderGenericImageMask(L,C);G=(G=this._getCSSTransform(G))?{transform:G,"image-orientation":"none"}:{};P=`${S}${S?.includes("?")?"\x26":"?"}w=${P}`;z={["esri-attachments__image--resizable"]:z};return D.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:P},D.tsx("img",{alt:L,class:this.classes(z,
"esri-attachments__image"),src:P,styles:G,title:L}))}_renderFile(G){const {file:P}=G;return D.tsx("li",{class:"esri-attachments__item",key:P},D.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(G),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(G),D.tsx("label",{class:"esri-attachments__label"},D.tsx("span",{class:"esri-attachments__filename"},P.name||this.messages.noTitle),
D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",n.isRTL(this.container)?B.legacyIcon.left:B.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:G,displayType:P}){const {viewModel:z,effectiveDisplayType:C}=this,{capabilities:L,supportsResizeAttachments:S}=z,{contentType:r,name:J,url:M}=G;P=this._renderImageMask(G,"list"===P?48:400);var y=L.editing?D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",n.isRTL(this.container)?
B.legacyIcon.left:B.legacyIcon.right)}):null;y="preview"===C&&S&&A.isSupportedImage(r)?null:D.tsx("label",{class:"esri-attachments__label"},D.tsx("span",{class:"esri-attachments__filename"},J||this.messages.noTitle),y);P=[P,y];P=L.editing?D.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":G.id,key:"details-button",onclick:()=>this._startEditAttachment(G),title:this.messages.attachmentDetails,type:"button"},P):D.tsx("a",
{class:"esri-attachments__item-button",href:M??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},P);return D.tsx("li",{class:"esri-attachments__item",key:G},P)}_renderAttachmentContainer(){const {effectiveDisplayType:G,viewModel:P,visibleElements:z}=this,{attachmentInfos:C,capabilities:L,fileInfos:S}=P;var r=!!C?.length;const J=!!S?.length,M={["esri-attachments__container--list"]:"preview"!==G,["esri-attachments__container--preview"]:"preview"===G},y=L.editing&&L.operations?.add&&z.addButton?
D.tsx("button",{bind:this,class:this.classes(v.globalCss.button,v.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),onclick:()=>this._startAddAttachment(),type:"button"},D.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",B.legacyIcon.plus)}),this.messages.add):void 0,H=r?D.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},C.toArray().map(e=>this._renderAttachmentInfo({attachmentInfo:e,displayType:G}))):void 0,h=J?D.tsx("ul",{class:"esri-attachments__items",
key:"file-list"},S.toArray().map(e=>this._renderFile(e))):void 0;r=J||r?void 0:D.tsx("div",{class:v.globalCss.empty},this.messages.noAttachments);return D.tsx("div",{class:this.classes("esri-attachments__container",M),key:"attachments-container"},H,h,r,y)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(G){G=G.target.files?.item(0);this._set("selectedFile",G)}_submitDeleteAttachment(G,P){G.preventDefault();P&&("file"in P?this.deleteFile(P.file):P&&this.deleteAttachment(P))}_submitAddAttachment(G){G.preventDefault();
this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(G,P){G.preventDefault();P&&"file"in P?this.updateFile():this.updateAttachment()}_startEditAttachment(G){const {viewModel:P}=this;P.activeFileInfo=null;P.activeAttachmentInfo=G;P.mode="edit"}_startEditFile(G){const {viewModel:P}=this;P.activeAttachmentInfo=null;P.activeFileInfo=G;P.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(G){G.preventDefault();this.viewModel.mode="view"}_getCSSTransform(G){({orientationInfo:G}=
G);return!this._supportsImageOrientation&&G?[G.rotation?`rotate(${G.rotation}deg)`:"",G.mirrored?"scaleX(-1)":""].join(" "):""}};b.__decorate([l.property()],E.prototype,"capabilities",null);b.__decorate([l.property()],E.prototype,"displayType",void 0);b.__decorate([l.property({readOnly:!0})],E.prototype,"effectiveDisplayType",null);b.__decorate([l.property()],E.prototype,"graphic",null);b.__decorate([l.property()],E.prototype,"icon",null);b.__decorate([l.property()],E.prototype,"label",null);b.__decorate([l.property(),
w.messageBundle("esri/widgets/Attachments/t9n/Attachments")],E.prototype,"messages",void 0);b.__decorate([l.property(),w.messageBundle("esri/core/t9n/Units")],E.prototype,"messagesUnits",void 0);b.__decorate([l.property({readOnly:!0})],E.prototype,"selectedFile",void 0);b.__decorate([l.property({readOnly:!0})],E.prototype,"submitting",void 0);b.__decorate([l.property({readOnly:!0})],E.prototype,"error",void 0);b.__decorate([l.property({type:t})],E.prototype,"viewModel",void 0);b.__decorate([l.property()],
E.prototype,"visibleElements",void 0);b.__decorate([k.cast("visibleElements")],E.prototype,"castVisibleElements",null);return E=b.__decorate([f.subclass("esri.widgets.Attachments")],E)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(a,b,d,m,p,l,k,E){function q(v,B,n){return v.units[B][n]}function f(v,B,n,w=2,D="abbr"){return`${E.formatNumber(B,{minimumFractionDigits:w,maximumFractionDigits:w,
signDisplay:0<B?"never":"exceptZero"})} ${q(v,n,D)}`}function u(v,B,n,w=2,D="abbr"){return`${E.formatNumber(B,{minimumFractionDigits:w,maximumFractionDigits:w,signDisplay:"exceptZero"})} ${q(v,n,D)}`}function t(v,B){const n=JSON.stringify(B);let w=A.get(n);w||(w=new Intl.NumberFormat("en-US",B),A.set(n,w));return/^[-+]?360\.?0*\u00b0?$/.test(w.format(v))?0:v}const A=new Map,x=["B","kB","MB","GB","TB"];a.formatAngleDegrees=function(v,B,n,w,D,K=d.cyclicalDegrees,N=!0){v=K.normalize(p.convertRotationType(k.convertUnit(v,
B,"degrees"),n,w),0,N);D=D??2;D={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:D,minimumFractionDigits:D,signDisplay:0<v?"never":"exceptZero"};v=t(v,D);return E.formatNumber(v,D)};a.formatDMS=function(v,B,n=2){v=k.convertUnit(v,B,"degrees");B=v-Math.floor(v);v-=B;B*=60;let w=B-Math.floor(B);B-=w;w*=60;return`${v.toFixed()}\u00b0 ${B.toFixed()}' ${w.toFixed(n)}"`};a.formatDecimal=f;a.formatFileSize=function(v,B){B=Math.round(B);let n=0===B?0:Math.floor(Math.log(B)/Math.log(b.ByteSizeUnit.KILOBYTES));
n=m.clamp(n,0,x.length-1);B=E.formatNumber(B/b.ByteSizeUnit.KILOBYTES**n,{maximumFractionDigits:2});return l.replace(v.units.bytes[x[n]],{fileSize:B})};a.formatImperialArea=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveImperialAreaUnit(B,n);return f(v,k.convertUnit(B,n,K),K,w,D)};a.formatImperialLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveImperialLengthUnit(B,n);return f(v,k.convertUnit(B,n,K),K,w,D)};a.formatImperialRelativeLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveImperialLengthUnit(B,
n);return u(v,k.convertUnit(B,n,K),K,w,D)};a.formatImperialRelativeVerticalLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveImperialVerticalLengthUnit(B,n);return u(v,k.convertUnit(B,n,K),K,w,D)};a.formatImperialVerticalLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveImperialVerticalLengthUnit(B,n);return f(v,k.convertUnit(B,n,K),K,w,D)};a.formatMetricArea=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveMetricAreaUnit(B,n);return f(v,k.convertUnit(B,n,K),K,w,D)};a.formatMetricLength=function(v,
B,n,w=2,D="abbr"){const K=k.adaptiveMetricLengthUnit(B,n);return f(v,k.convertUnit(B,n,K),K,w,D)};a.formatMetricRelativeLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveMetricLengthUnit(B,n);return u(v,k.convertUnit(B,n,K),K,w,D)};a.formatMetricRelativeVerticalLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveMetricVerticalLengthUnit(B,n);return u(v,k.convertUnit(B,n,K),K,w,D)};a.formatMetricVerticalLength=function(v,B,n,w=2,D="abbr"){const K=k.adaptiveMetricVerticalLengthUnit(B,n);return f(v,
k.convertUnit(B,n,K),K,w,D)};a.formatRelativeAngleDegrees=function(v,B,n,w,D=2){n!==w&&(v=-v);n={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:D,minimumFractionDigits:D,signDisplay:"exceptZero"};v=k.convertUnit(v,B,"degrees")%360;v=t(v,n);return E.formatNumber(v,n)};a.formatRelativeDecimal=u;a.unitName=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var b=a.ByteSizeUnit||
(a.ByteSizeUnit={});b[b.KILOBYTES=1024]="KILOBYTES";b[b.MEGABYTES=1048576]="MEGABYTES";b[b.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x){const v={editing:!1,operations:{add:!0,update:!0,delete:!0}},B=m.ofType(t);d=class extends d{constructor(n){super(n);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...v};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new B;this.fileInfos=new m;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(l.watch(()=>this.graphic,()=>this._graphicChanged(),l.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(n){return{...v,...n}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:n}=this;if(!n)return!1;n=n.layer||n.sourceLayer;return n?.loaded&&"capabilities"in n&&n.capabilities&&"operations"in n.capabilities&&"supportsResizeAttachments"in n.capabilities.operations&&n.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:n,attachmentInfos:w}=this;if(!n||
"function"!==typeof n.queryAttachments)throw new p("invalid-layer","getAttachments(): A valid layer is required.");const D=this._getObjectId();if("number"!==typeof D)throw new p("invalid-object-id","getAttachments(): Numeric object id is required");var K=new A({objectIds:[D],returnMetadata:!0});const N=[];this._getAttachmentsPromise=K=n.queryAttachments(K).then(G=>G[D]||N).catch(()=>N);this.notifyChange("state");K=await K;w.destroyAll();K.length&&w.addMany(K);this._getAttachmentsPromise=null;this.notifyChange("state");
return K}async addAttachment(n,w=this.graphic){const {_attachmentLayer:D,attachmentInfos:K,capabilities:N}=this;if(!w)throw new p("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:w});if(!n)throw new p("invalid-attachment","addAttachment(): An attachment is required.",{attachment:n});if(!N.operations?.add)throw new p("invalid-capabilities","addAttachment(): add capabilities are required.");if(!D||"function"!==typeof D.addAttachment)throw new p("invalid-layer","addAttachment(): A valid layer is required.");
n=await D.addAttachment(w,n).then(G=>this._queryAttachment(G.objectId,w));K.add(n);return n}async deleteAttachment(n){const {_attachmentLayer:w,attachmentInfos:D,graphic:K,capabilities:N}=this;if(!n)throw new p("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:n});if(!N.operations?.delete)throw new p("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!w||"function"!==typeof w.deleteAttachments)throw new p("invalid-layer",
"deleteAttachment(): A valid layer is required.");if(!K)throw new p("invalid-graphic","deleteAttachment(): A graphic is required.");const G=await w.deleteAttachments(K,[n.id]).then(()=>n);D.remove(G);G.destroy();return G}async updateAttachment(n,w=this.activeAttachmentInfo){const {_attachmentLayer:D,attachmentInfos:K,graphic:N,capabilities:G}=this;if(!n)throw new p("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:n});if(!w)throw new p("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",
{attachmentInfo:w});if(!G.operations?.update)throw new p("invalid-capabilities","updateAttachment(): Update capabilities are required.");const P=K.indexOf(w);if(!D||"function"!==typeof D.updateAttachment)throw new p("invalid-layer","updateAttachment(): A valid layer is required.");if(!N)throw new p("invalid-graphic","updateAttachment(): A graphic is required.");n=await D.updateAttachment(N,w.id,n).then(z=>this._queryAttachment(z.objectId));K.splice(P,1,n);return n}async commitFiles(){await Promise.all(this.fileInfos.items.map(n=>
this.addAttachment(n.form)));this.fileInfos.removeAll();return this.getAttachments()}addFile(n,w){if(!n||!w)return null;n={file:n,form:w};this.fileInfos.add(n);return n}updateFile(n,w,D=this.activeFileInfo){if(!n||!w||!D)return null;D=this.fileInfos.indexOf(D);-1<D&&this.fileInfos.splice(D,1,{file:n,form:w});return this.fileInfos.items[D]}deleteFile(n){const w=this.fileInfos.find(D=>D.file===n);return w?(this.fileInfos.remove(w),w):null}async _queryAttachment(n,w){const {_attachmentLayer:D}=this;
if(!n||!D?.queryAttachments)throw new p("invalid-attachment-id","Could not query attachment.");const K=this._getObjectId(w);if("number"!==typeof K)throw new p("invalid-object-id","getAttachments(): Numeric object id is required");n=new A({objectIds:[K],attachmentsWhere:`AttachmentId=${n}`,returnMetadata:!0});return D.queryAttachments(n).then(N=>N[K][0])}_getObjectId(n=this.graphic){return n?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>
this.attachmentInfos.destroyAll()))}_setAttachmentLayer(){var {graphic:n}=this;this._attachmentLayer=(n=x.getSourceLayer(n))?"scene"===n.type&&null!=n.associatedLayer?n.associatedLayer:n:null}};a.__decorate([k.property()],d.prototype,"capabilities",void 0);a.__decorate([E.cast("capabilities")],d.prototype,"castCapabilities",null);a.__decorate([k.property()],d.prototype,"activeAttachmentInfo",void 0);a.__decorate([k.property()],d.prototype,"activeFileInfo",void 0);a.__decorate([k.property({readOnly:!0,
type:B})],d.prototype,"attachmentInfos",void 0);a.__decorate([k.property()],d.prototype,"fileInfos",void 0);a.__decorate([k.property({type:b})],d.prototype,"graphic",void 0);a.__decorate([k.property()],d.prototype,"mode",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,"state",null);a.__decorate([k.property()],d.prototype,"filesEnabled",void 0);a.__decorate([k.property({readOnly:!0})],d.prototype,"supportsResizeAttachments",null);return d=a.__decorate([u.subclass("esri.widgets.Attachments.AttachmentsViewModel")],
d)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),function(a,b,d,m,p,l,k,E){var q;const f={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,
mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};b=q=class extends b.JSONSupport{constructor(u){super(u);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:u}=this;u=E.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:u});return f[u]||null}clone(){return new q({contentType:this.contentType,
exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};a.__decorate([d.property({type:String})],b.prototype,"contentType",void 0);a.__decorate([d.property()],b.prototype,"exifInfo",void 0);a.__decorate([d.property({readOnly:!0})],b.prototype,"orientationInfo",null);a.__decorate([d.property({type:m.Integer})],b.prototype,"id",void 0);a.__decorate([d.property({type:String})],
b.prototype,"globalId",void 0);a.__decorate([d.property({type:String})],b.prototype,"keywords",void 0);a.__decorate([d.property({type:String})],b.prototype,"name",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"parentGlobalId",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"parentObjectId",void 0);a.__decorate([d.property({type:m.Integer})],b.prototype,"size",void 0);a.__decorate([d.property({json:{read:!1}})],b.prototype,"url",void 0);return b=q=a.__decorate([k.subclass("esri.rest.query.support.AttachmentInfo")],
b)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(a){function b(d){const {tagName:m,tags:p}=d;return p&&m?p.find(l=>l.name===m)?.value||null:null}a.getExifValue=function(d){const {exifInfo:m,exifName:p,tagName:l}=d;return m&&p&&l?(d=m.find(k=>k.name===p))?b({tagName:l,tags:d.tags}):null:null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/has ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){function t(T){return T?V.test(T):!1}function A(T,U){if(U&&t(U)&&T){var ba=U.replace(V,"").toLowerCase();return T.find(({name:ha})=>ha.toLowerCase()===ba)}}function x(T,U){return(U=v(U,T))?U.name:T}function v(T,U){return T&&"function"===typeof T.getField&&U?T.getField(U)??null:null}function B({formattedAttributes:T,template:U,fieldInfoMap:ba}){return`${m.replace(m.replace(U,ha=>`{${ba.get(ha.toLowerCase())?.fieldName||ha}}`),T).replaceAll(O,"")}`.trim()}function n(T,
U,ba=!1){const ha=U[T];"string"===typeof ha&&(ba=(ba?encodeURIComponent(ha):ha).replaceAll(W,"%27"),U[T]=ba)}function w(T,U=!1){const ba={...T};Object.keys(ba).forEach(ha=>n(ha,ba,U));return ba}function D(T,U){return T.replaceAll(R,(ba,ha,ma)=>(ba=v(U,ma))?`{${ba.name}}`:ha)}function K(T,U,ba){return(T=D(T,ba))?T.replaceAll(ja,(ha,ma,Q)=>{ma=`${ma||Q}`.trim();return m.replace(ha,w(U,ma&&"{"!==ma[0]||!1))}):T}function N(T){return null!=T&&"object"===typeof T&&"fieldsIndex"in T&&"geometryType"in T&&
"getField"in T&&"load"in T&&"loaded"in T&&"objectIdField"in T&&"spatialReference"in T&&"type"in T&&("feature"===T.type||"scene"===T.type||"subtype-sublayer"===T.type||"sublayer"===T.type)&&"when"in T}function G(T){return null!=T&&"object"===typeof T&&"createQuery"in T&&"queryFeatureCount"in T&&"queryObjectIds"in T&&"queryRelatedFeatures"in T&&"queryRelatedFeaturesCount"in T&&"relationships"in T}function P(T){return T&&"object"===typeof T&&"createQuery"in T&&"queryFeatureCount"in T&&"type"in T?"subtype-sublayer"===
T.type&&"parent"in T&&T.parent&&"object"===typeof T.parent?"globalIdField"in T.parent:"globalIdField"in T:!1}function z(T){return N(T)&&G(T)}function C(T,U){const {fieldInfos:ba,fieldName:ha,preventPlacesFormatting:ma,layer:Q,timeZone:X}=U;U=S(ba,ha);var ea=v(Q,ha);if(U&&!k.isRasterPixelValueField(ha)){ea=ea?.type;const ia=U.format?.dateFormat;if("date"===ea||"date-only"===ea||"time-only"===ea||"timestamp-offset"===ea||ia)return q.formatAnyDate(T,{format:ia,fieldType:ea,timeZoneOptions:{layerTimeZone:Q&&
"preferredTimeZone"in Q?Q.preferredTimeZone:null,viewTimeZone:X,datesInUnknownTimezone:Q&&"datesInUnknownTimezone"in Q?!!Q.datesInUnknownTimezone:!1}})}U=U?.format;if("string"===typeof T&&k.isRasterPixelValueField(ha)&&U)return T=T.trim(),/\d{2}-\d{2}/.test(T)?T:T.includes(",")?L(T,",",", ",U):T.includes(";")?L(T,";","; ",U):T.includes(" ")?L(T," "," ",U):l.formatNumber(Number(T),l.convertNumberFormatToIntlOptions(U));"string"!==typeof T||!U||null!=U.dateFormat||null==U.places&&null==U.digitSeparator||
(ea=Number(T),isNaN(ea)||(T=ea));return"string"===typeof T||null==T||null==U?M(T):ma?l.formatNumber(T,{...l.convertNumberFormatToIntlOptions(U),minimumFractionDigits:0,maximumFractionDigits:20}):l.formatNumber(T,l.convertNumberFormatToIntlOptions(U))}function L(T,U,ba,ha){return T.trim().split(U).map(ma=>l.formatNumber(Number(ma),l.convertNumberFormatToIntlOptions(ha))).join(ba)}function S(T,U){if(T?.length&&U)return T.find(ba=>ba.fieldName?.toLowerCase()===U.toLowerCase())}function r({fieldName:T,
graphic:U,layer:ba}){if(e(T)||!ba||"function"!==typeof ba.getFeatureType)return null;const {typeIdField:ha}=ba;return ha&&T===ha?(T=ba.getFeatureType(U))?T.name:null:null}function J({fieldName:T,value:U,graphic:ba,layer:ha}){return e(T)||!ha||"function"!==typeof ha.getFieldDomain?null:(T=ba&&ha.getFieldDomain(T,{feature:ba,excludeImpliedDomains:b("esri-widget-legacy-field-domain-calculation")}))&&"coded-value"===T.type?T.getName(U):null}function M(T){return"string"===typeof T?T.replaceAll(aa,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):
T}function y(T){const {value:U,fieldName:ba,fieldInfos:ha,fieldInfoMap:ma,layer:Q,graphic:X,timeZone:ea}=T;return null==U?"":(T=J({fieldName:ba,value:U,graphic:X,layer:Q}))||(T=r({fieldName:ba,graphic:X,layer:Q}))?T:ma.get(ba.toLowerCase())?C(U,{fieldInfos:ha||Array.from(ma.values()),fieldName:ba,layer:Q,timeZone:ea}):(T=Q?.fieldsIndex?.get(ba))&&(q.isAnyDateField(T)||k.isTimeOnlyField(T))?q.formatAnyDate(U,{fieldType:T.type,timeZoneOptions:{layerTimeZone:Q&&"preferredTimeZone"in Q?Q.preferredTimeZone:
null,viewTimeZone:ea,datesInUnknownTimezone:Q&&"datesInUnknownTimezone"in Q?!!Q.datesInUnknownTimezone:!1}}):M(U)}async function H(T,U){const {layer:ba,graphic:ha,outFields:ma,objectIds:Q,returnGeometry:X,spatialReference:ea}=T;T=Q[0];if("number"!==typeof T&&"string"!==typeof T)return U={layer:ba,graphic:ha,objectId:T,requiredFields:ma},d.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",U),null;if(!E.getEffectiveLayerCapabilities(ba)?.operations?.supportsQuery)return U=
{layer:ba,graphic:ha,requiredFields:ma,returnGeometry:X},d.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",U),null;T=ba.createQuery();T.objectIds=Q;T.outFields=ma?.length?ma:[ba.objectIdField];T.returnGeometry=!!X;T.returnZ=!!X;T.returnM=!!X;T.outSpatialReference=ea;return(await ba.queryFeatures(T,U)).features[0]}async function h(T){if(!T.expressionInfos?.length)return!1;var U=await f.loadArcade();({arcadeUtils:{hasGeometryFunctions:U}}=
U);return U(T)}function e(T=""){return T?T.includes("relationships/"):!1}function c({attributes:T,graphic:U,relatedInfo:ba,fieldInfos:ha,fieldInfoMap:ma,layer:Q,timeZone:X}){T&&U&&ba&&Object.keys(U.attributes).forEach(ea=>{var ia=(ia={layerId:ba.relation.id.toString(),fieldName:ea},`${"relationships/"}${ia.layerId}/${ia.fieldName}`);T[ia]=y({fieldName:ia,fieldInfos:ha,fieldInfoMap:ma,layer:Q,value:U.attributes[ea],graphic:U,timeZone:X})})}function g({attributes:T,relatedInfo:U,fieldInfoMap:ba,fieldInfos:ha,
layer:ma,timeZone:Q}){T&&U&&(U.relatedFeatures?.forEach(X=>c({attributes:T,graphic:X,relatedInfo:U,fieldInfoMap:ba,fieldInfos:ha,layer:ma,timeZone:Q})),U.relatedStatsFeatures?.forEach(X=>c({attributes:T,graphic:X,relatedInfo:U,fieldInfoMap:ba,fieldInfos:ha,layer:ma,timeZone:Q})))}function F(T,U){return T?.allTables.find(ba=>"feature"===ba.type&&ba.layerId===U.id&&ba.url===U.layer?.url)}function I({map:T,relationship:U,relationship:{relatedTableId:ba},relatedLayer:ha,layers:ma}){if(!ma)return null;
for(const Q of ma)if("map-image"===Q.type){if(ma=I({layers:Q.sublayers,map:T,relatedLayer:ha,relationship:U})||I({layers:Q.subtables,map:T,relatedLayer:ha,relationship:U}))return ma}else if(z(Q))if("sublayer"===ha.type){if(Q!==ha&&Q.id===ba)return Q.isTable?F(T,Q):Q}else{ma="scene"===ha.type&&ha.associatedLayer?ha.associatedLayer.url:ha.url;if(!ma)break;if("sublayer"===Q.type){if(Q!==ha&&Q.layer?.url===ma&&Q.id===ba)return Q.isTable?F(T,Q):Q}else if(Q!==ha&&Q.url===ma&&Q.layerId===ba)return Q}return null}
const O=/href=(""|'')/gi,R=/(\{([^{\r\n]+)\})/g,W=/'/g,V=/^\s*expression\//i,aa=/(\n)/gi,fa=/[\u00A0-\u9999<>&]/gim,ja=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,da=/^(?:mailto:|tel:)/,Z=p.convertDateFormatToIntlOptions("short-date-short-time"),ka=T=>{if(!T)return!1;T=T.toUpperCase();return T.includes("CURRENT_TIMESTAMP")||T.includes("CURRENT_DATE")||T.includes("CURRENT_TIME")},la=({layer:T,method:U,query:ba,definitionExpression:ha})=>{T.capabilities?.query?.supportsCacheHint&&"attachments"!==U&&(T=null!=
ba.where?ba.where:null,U=null!=ba.geometry?ba.geometry:null,ka(ha)||ka(T)||"extent"===U?.type||"tile"===ba.resultType||(ba.cacheHint=!0))};a.applyTextFormattingHTML=M;a.createFieldInfoMap=function(T,U){const ba=new Map;if(!T)return ba;for(const ha of T)ha.fieldName&&(T=x(ha.fieldName,U),ha.fieldName=T,ba.set(T.toLowerCase(),ha));return ba};a.findRelatedLayer=function(T,U,ba){return T&&U&&ba?"sublayer"===U.type?I({layers:U.layer?.sublayers,map:T,relatedLayer:U,relationship:ba})||I({layers:U.layer?.subtables,
map:T,relatedLayer:U,relationship:ba}):I({layers:T.allLayers,map:T,relatedLayer:U,relationship:ba})||I({layers:T.allTables,map:T,relatedLayer:U,relationship:ba}):null};a.findUtilityNetwork=function(T,U){return T&&"utilityNetworks"in T&&U?T.utilityNetworks?.find(ba=>ba.isUtilityLayer(U)):null};a.fixTokens=D;a.formatAttributes=function({fieldInfos:T,attributes:U,layer:ba,graphic:ha,fieldInfoMap:ma,relatedInfos:Q,timeZone:X}){const ea={};Q?.forEach(ia=>g({attributes:ea,relatedInfo:ia,fieldInfoMap:ma,
fieldInfos:T,layer:ba,timeZone:X}));U&&Object.keys(U).forEach(ia=>{ea[ia]=y({fieldName:ia,fieldInfos:T,fieldInfoMap:ma,layer:ba,value:U[ia],graphic:ha,timeZone:X})});return ea};a.formatEditInfo=function(T,U,ba,ha){const {creatorField:ma,creationDateField:Q,editorField:X,editDateField:ea}=T;if(U){T=u.getTimeZoneFormattingOptions(ha&&"preferredTimeZone"in ha?ha.preferredTimeZone:null,ha&&"datesInUnknownTimezone"in ha?!!ha.datesInUnknownTimezone:!1,ba,Z,"date");T={...Z,...T};ba=U[ea];if("number"===typeof ba)return U=
U[X],{type:"edit",date:p.formatDate(ba,T),user:U};ba=U[Q];return"number"===typeof ba?(U=U[ma],{type:"create",date:p.formatDate(ba,T),user:U}):null}};a.formatValueToFieldInfo=C;a.getAllFieldInfos=function(T){const U=[];if(!T)return U;const {fieldInfos:ba,content:ha}=T;ba&&U.push(...ba);if(!ha||!Array.isArray(ha))return U;ha.forEach(ma=>{"fields"===ma.type&&(ma=ma?.fieldInfos)&&U.push(...ma)});return U};a.getFieldInfo=S;a.getFieldInfoLabel=function(T,U){return(U=A(U,T?.fieldName))?U.title||null:T?T.label||
T.fieldName:null};a.getFixedFieldName=x;a.getFixedFieldNames=function(T,U){return T&&T.map(ba=>x(ba,U))};a.getHighlightKeyForFeature=function(T){const U=T.getObjectId();return null!=U?`oid:${U}`:`uid:${T.uid}`};a.getSourceLayer=function(T){if(null!=T)return(T.sourceLayer||T.layer)??void 0};a.graphicCallback=async function({type:T,value:U,event:ba}){try{return"function"===typeof U?U(ba):await U}catch(ha){d.getLogger("esri.widgets.Feature.support.featureUtils").error("error",`An error occurred when calling the "${T}" function`,
{error:ha,graphic:ba.graphic,value:U})}};a.htmlEntities=function(T){return T.replaceAll(fa,U=>`&#${U.charCodeAt(0)};`)};a.isAssociatedFeatureSupportedLayer=function(T){return N(T)&&P(T)};a.isAssociatedLayer=P;a.isExpressionField=t;a.isFeatureSupportedLayer=N;a.isGraphicForRelatableFeatureSupportedLayer=function(T){return!!T&&"object"===typeof T&&"sourceLayer"in T&&z(T.sourceLayer)};a.isRelatableFeatureSupportedLayer=z;a.isRelatableLayer=G;a.isRelatedField=e;a.preLayerQueryCallback=({query:T,layer:U,
method:ba})=>{la({layer:U,method:ba,query:T,definitionExpression:`${U.definitionExpression} ${U.serviceDefinitionExpression??""}`})};a.preRequestCallback=({queryPayload:T,layer:U,method:ba})=>{la({layer:U,method:ba,query:T,definitionExpression:`${U.definitionExpression} ${U.serviceDefinitionExpression??""}`})};a.querySourceLayer=H;a.queryUpdatedFeature=async function({graphic:T,popupTemplate:U,layer:ba,spatialReference:ha},ma){if(ba&&U&&("function"===typeof ba.load&&await ba.load(ma),T.attributes)){var Q=
ba.objectIdField,X=T.attributes[Q];if(null!=X){X=[X];var ea=await U.getRequiredFields(ba.fieldsIndex),ia=k.featureHasFields(ea,T);Q=ia?[]:ea.includes(Q)?ea:[...ea,Q];U=U.returnGeometry||await h(U);if(!ia||U)if(ba=await H({layer:ba,graphic:T,outFields:Q,objectIds:X,returnGeometry:U,spatialReference:ha},ma))ba.geometry&&(T.geometry=ba.geometry),ba.attributes&&(T.attributes={...T.attributes,...ba.attributes})}}};a.shouldOpenInNewTab=function(T=""){if(T)return!da.test(T.trim().toLowerCase())};a.substituteAttributes=
B;a.substituteFieldsInLinksAndAttributes=function({attributes:T,globalAttributes:U,layer:ba,text:ha,expressionAttributes:ma,fieldInfoMap:Q}){return ha?B({formattedAttributes:U,template:K(ha,{...U,...ma,...T},ba),fieldInfoMap:Q}):""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(a,
b,d,m,p,l){function k(x){return String(x).padStart(2,"0")}function E(x,v,B){if("date"===v||"number"===v){"number"===v&&(x=new Date(x));v=B?x.getFullYear():x.getUTCFullYear();const n=k((B?x.getMonth():x.getUTCMonth())+1),w=k(B?x.getDate():x.getUTCDate()),D=k(B?x.getHours():x.getUTCHours()),K=k(B?x.getMinutes():x.getUTCMinutes());x=k(B?x.getSeconds():x.getUTCSeconds());x=`TIMESTAMP'${v}-${n}-${w} ${D}:${K}:${x}'`}return x}function q(x,v){if(v instanceof Date)return"date";if("number"===typeof v)return"number";
if("string"===typeof v&&(x=x.getField(v),"\x3cnow\x3e"!==v.toLowerCase()&&d.isDateField(x)))return"field"}const f={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},u={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},t=new Set(["integer","small-integer"]);let A=null;a.castIntegerFieldToFloat=function(x){return`cast(${x} as float)`};a.dateTypes=
["date","date-only","timestamp-offset"];a.defaultBasemapGroups=f;a.defaultStatisticTypes={exclude:["median"]};a.fieldDelimiter=",";a.formatAnyDate=function(x,v){const {format:B,timeZoneOptions:n,fieldType:w}=v??{};let D;n&&({timeZone:K,timeZoneName:D}=l.getTimeZoneFormattingOptions(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,b.convertDateFormatToIntlOptions(B||"short-date-short-time"),w));if("string"===typeof x&&isNaN(Date.parse("time-only"===w?`1970-01-01T${x}Z`:x)))return x;switch(w){case "date-only":var K=
b.convertDateFormatToIntlOptions(B||"short-date");return"string"===typeof x?b.formatDateOnly(x,{...K}):b.formatDate(x,{...K,timeZone:l.utc});case "time-only":return K=b.convertDateFormatToIntlOptions(B||"short-time"),"string"===typeof x?b.formatTimeOnly(x,K):b.formatDate(x,{...K,timeZone:l.utc});case "timestamp-offset":if(!K&&"string"===typeof x&&(new Date(x)).toISOString()!==x)return x;K=(v=B||n?b.convertDateFormatToIntlOptions(B||"short-date-short-time"):void 0)?{...v,timeZone:K,timeZoneName:D}:
void 0;return"string"===typeof x?b.formatTimestamp(x,K):b.formatDate(x,K);default:return v=B||n?b.convertDateFormatToIntlOptions(B||"short-date-short-time"):void 0,b.formatDate("string"===typeof x?new Date(x):x,v?{...v,timeZone:K,timeZoneName:D}:void 0)}};a.getBasemapGroup=function(x,v=f){for(const B in v)if(v[B].includes(x))return B};a.getBasemapId=function(x,v,B=!0){let n=null;x&&("string"===typeof x?v.includes(x)&&(n=x):n=p.getWellKnownBasemapId(x));return B?n||"gray":n};a.getDateDiffSQL=function(x,
v,B,n){const {hasQueryEngine:w}=x;B=E(B,q(x,B),w);x=E(v,q(x,v),w);x=`(${B} - ${x})`;n=u[n];v="/";1>n&&(n=1/n,v="*");return{sqlExpression:1===n?x:`(${x} ${v} ${n})`,sqlWhere:null}};a.getDateType=q;a.getFieldsList=async function(x){const {field:v,field2:B,field3:n,normalizationField:w,valueExpression:D}=x;x=[];D&&(A||({arcadeUtils:x}=await m.loadArcade(),A=x),x=A.extractFieldNames(D));v&&x.push(v);B&&x.push(B);n&&x.push(n);w&&x.push(w);return x};a.getNormalizationType=function(x){let v=x.normalizationType;
v||(x.normalizationField?v="field":null!=x.normalizationTotal&&(v="percent-of-total"));return v??void 0};a.isAnyDateField=function(x){return d.isDateField(x)||d.isDateOnlyField(x)||d.isTimestampOffsetField(x)};a.isIntegerField=function(x,v){x=v&&x.getField(v);return!!x&&t.has(x.type)};a.unitValueInDays=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(a,b){a.getCalciteIconForAttachment=
function(d){return d?"text/plain"===d?"file-text":"application/pdf"===d?"file-pdf":"text/csv"===d?"file-csv":"application/gpx+xml"===d?"file-gpx":"application/x-dwf"===d?"file-cad":"application/postscript"===d||"application/json"===d||"text/xml"===d||"model/vrml"===d?"file-code":"application/x-zip-compressed"===d||"application/x-7z-compressed"===d||"application/x-gzip"===d||"application/x-tar"===d||"application/x-gtar"===d||"application/x-bzip2"===d||"application/gzip"===d||"application/x-compress"===
d||"application/x-apple-diskimage"===d||"application/x-rar-compressed"===d||"application/zip"===d?"file-zip":d.includes("image/")?"file-image":d.includes("audio/")?"file-sound":d.includes("video/")?"file-video":d.includes("msexcel")||d.includes("ms-excel")||d.includes("spreadsheetml")?"file-excel":d.includes("msword")||d.includes("ms-word")||d.includes("wordprocessingml")?"file-word":d.includes("powerpoint")||d.includes("presentationml")?"file-ppt":"file":"file"};a.getIconPath=function(d){const m=
b.getAssetUrl("esri/themes/base/images/files/");return d?"text/plain"===d?`${m}text-32.svg`:"application/pdf"===d?`${m}pdf-32.svg`:"text/csv"===d?`${m}csv-32.svg`:"application/gpx+xml"===d?`${m}gpx-32.svg`:"application/x-dwf"===d?`${m}cad-32.svg`:"application/postscript"===d||"application/json"===d||"text/xml"===d||"model/vrml"===d?`${m}code-32.svg`:"application/x-zip-compressed"===d||"application/x-7z-compressed"===d||"application/x-gzip"===d||"application/x-tar"===d||"application/x-gtar"===d||"application/x-bzip2"===
d||"application/gzip"===d||"application/x-compress"===d||"application/x-apple-diskimage"===d||"application/x-rar-compressed"===d||"application/zip"===d?`${m}zip-32.svg`:d.includes("image/")?`${m}image-32.svg`:d.includes("audio/")?`${m}sound-32.svg`:d.includes("video/")?`${m}video-32.svg`:d.includes("msexcel")||d.includes("ms-excel")||d.includes("spreadsheetml")?`${m}excel-32.svg`:d.includes("msword")||d.includes("ms-word")||d.includes("wordprocessingml")?`${m}word-32.svg`:d.includes("powerpoint")||
d.includes("presentationml")?`${m}report-32.svg`:`${m}generic-32.svg`:`${m}generic-32.svg`};a.isSupportedImage=function(d){d=d.toLowerCase();return"image/bmp"===d||"image/emf"===d||"image/exif"===d||"image/gif"===d||"image/x-icon"===d||"image/jpeg"===d||"image/png"===d||"image/tiff"===d||"image/x-wmf"===d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",
loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",
widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/legacyIcon":function(){define(["exports"],function(a){a.legacyIcon={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",
expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",
swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm":function(){define("require ../chunks/tslib.es6 ../intl ../core/arrayUtils ../core/has ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/subclass ../layers/support/fieldUtils ../layers/support/layerUtils ./Widget ./Editor/components/Prompt ./FeatureForm/css ./FeatureForm/featureFormUtils ./FeatureForm/FeatureFormViewModel ../chunks/componentsUtils ./support/dataUtils ./support/dateUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S){d=class extends A{constructor(r,J){super(r,J);this._attemptFocusOnNextRender=!1;this._dateComponentMap=new Map;this._inputsWithChanges=new Set;this._listObserverNode=this._pendingSubtypeChoice=this._focusedFieldName=null;this._listObserver=new IntersectionObserver(M=>{M.length&&M[0].isIntersecting&&this._incrementRelatedRecordPage()},{root:window.document});this._prompt=null;this.groupDisplay="all";this.headingLevel=2;this.messagesTemplates=
this.messagesFeature=this.messagesCommon=this.messages=null;this.viewModel=new n;this._onShowAllRelatedRecordsClick=M=>{const {feature:y,relatedRecordCallbacks:H}=this;y&&H?.showAllRelatedRecords&&H.showAllRelatedRecords({parentFeature:y,relationshipId:M})};this._onAddRelatedRecordsClick=(M,y)=>{const {feature:H,relatedRecordCallbacks:h}=this;H&&h?.addRelatedRecord&&h.addRelatedRecord({parentFeature:H,relatedLayer:y,relationshipId:M})};this._onFormKeyDown=this._onFormKeyDown.bind(this);this._onFormSubmit=
this._onFormSubmit.bind(this);this._onGroupToggle=this._onGroupToggle.bind(this);this._onComponentBlur=this._onComponentBlur.bind(this);this._onComponentFocus=this._onComponentFocus.bind(this);this._onComponentKeyDown=this._onComponentKeyDown.bind(this);this._afterComponentCreate=this._afterComponentCreate.bind(this);this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this);this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this);this._afterDateComponentCreateOrUpdate=
this._afterDateComponentCreateOrUpdate.bind(this);this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([E.watch(()=>this.feature,()=>{this._inputsWithChanges.clear();this._dateComponentMap.clear();E.whenOnce(()=>!this.viewModel.updating).then(()=>{const r=this._getFocusableInput("forward");this._syncGroupInputStates();this._focusedFieldName=r?.name||null;this._attemptFocusOnNextRender=!0})}),E.watch(()=>this.groupDisplay,()=>this._syncGroupInputStates()),
this.on("submit",r=>{if(0<r.invalid.length){const [J]=r.invalid;r.invalid.forEach(M=>this._inputsWithChanges.add(M));this._focusedFieldName=J;this._attemptFocusOnNextRender=!0;this.scheduleRender()}}),E.watch(()=>[this.viewModel.activeRelationshipInput,this._listObserverNode],()=>this._onObserverChange())])}loadDependencies(){return w.loadCalciteComponents({block:()=>new Promise((r,J)=>a(["../chunks/calcite-block"],r,J)),button:()=>new Promise((r,J)=>a(["../chunks/calcite-button"],r,J)),combobox:()=>
new Promise((r,J)=>a(["../chunks/calcite-combobox"],r,J)),"combobox-item":()=>new Promise((r,J)=>a(["../chunks/calcite-combobox-item"],r,J)),"combobox-item-group":()=>new Promise((r,J)=>a(["../chunks/calcite-combobox-item-group"],r,J)),icon:()=>new Promise((r,J)=>a(["../chunks/calcite-icon"],r,J)),input:()=>new Promise((r,J)=>a(["../chunks/calcite-input"],r,J)),"input-date-picker":()=>new Promise((r,J)=>a(["../chunks/calcite-input-date-picker"],r,J)),"input-message":()=>new Promise((r,J)=>a(["../chunks/calcite-input-message"],
r,J)),"input-number":()=>new Promise((r,J)=>a(["../chunks/calcite-input-number"],r,J)),"input-time-picker":()=>new Promise((r,J)=>a(["../chunks/calcite-input-time-picker"],r,J)),"input-time-zone":()=>new Promise((r,J)=>a(["../chunks/calcite-input-time-zone"],r,J)),label:()=>new Promise((r,J)=>a(["../chunks/calcite-label"],r,J)),list:()=>new Promise((r,J)=>a(["../chunks/calcite-list"],r,J)),"list-item":()=>new Promise((r,J)=>a(["../chunks/calcite-list-item"],r,J)),loader:()=>new Promise((r,J)=>a(["../chunks/calcite-loader"],
r,J)),notice:()=>new Promise((r,J)=>a(["../chunks/calcite-notice"],r,J)),"radio-button":()=>new Promise((r,J)=>a(["../chunks/calcite-radio-button"],r,J)),"radio-button-group":()=>new Promise((r,J)=>a(["../chunks/calcite-radio-button-group"],r,J)),switch:()=>new Promise((r,J)=>a(["../chunks/calcite-switch"],r,J)),"text-area":()=>new Promise((r,J)=>a(["../chunks/calcite-text-area"],r,J))})}destroy(){this._listObserverNode&&this._listObserver.unobserve(this._listObserverNode)}get _relatedRecordsEnabled(){const r=
this.relatedRecordCallbacks;return!(!r||!(r.addRelatedRecord||r.editRelatedRecord||r.showAllRelatedRecords))}get _subtypes(){return t.getSubtypesFromLayer(this.layer)}get disabled(){return this.viewModel.disabled}set disabled(r){this.viewModel.disabled=r}get feature(){return this.viewModel.feature}set feature(r){this.viewModel.feature=r}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(r){this.viewModel.formTemplate=r}get icon(){return"form-field"}set icon(r){this._overrideIfSome("icon",
r)}get label(){return this.messages?.widgetLabel??""}set label(r){this._overrideIfSome("label",r)}get layer(){return this.viewModel.layer}set layer(r){this.viewModel.layer=r}get map(){return this.viewModel.map}set map(r){this.viewModel.map=r}get relatedRecordCallbacks(){return this.viewModel.relatedRecordCallbacks}set relatedRecordCallbacks(r){this.viewModel.relatedRecordCallbacks=r}get relationshipId(){return this.viewModel.relationshipId}set relationshipId(r){this.viewModel.relationshipId=r}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(r){this.viewModel.spatialReference=
r}get strict(){return this.viewModel.strict}set strict(r){this.viewModel.strict=r}get timeZone(){return this.viewModel.timeZone}set timeZone(r){this.viewModel.timeZone=r}get showPrompt(){return r=>{this._prompt?.cancel?.();this._prompt=r}}set showPrompt(r){this._overrideIfSome("showPrompt",r)}get clearPrompt(){return()=>this._prompt=null}set clearPrompt(r){this._overrideIfSome("clearPrompt",r)}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const {state:r}=
this.viewModel;return L.tsx("div",{class:this.classes(v.css.base,N.globalCss.widget,N.globalCss.panel)},"ready"===r?this._renderForm():null)}_renderForm(){return L.tsx("div",null,L.tsx("form",{class:v.css.form,novalidate:!0,onkeydown:this._onFormKeyDown,onsubmit:this._onFormSubmit},this._renderHeader(),this._renderContent()),this._prompt?L.tsx(x.Prompt,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderHeader(){var r=this.viewModel;if(r.formHeaderVisible){var J=null!=r.formTitle&&L.tsx(G.Heading,
{key:"title",level:this.headingLevel},r.formTitle);r=null!=r.formDescription&&L.tsx("p",{class:v.css.description,key:"description"},r.formDescription);return L.tsx("div",{class:v.css.formHeader},J,r)}}_renderContent(){const {viewModel:r}=this;return r.activeRelationshipInput?this._renderRelationshipInput(r.activeRelationshipInput):r.inputs.filter(m.isSome).filter(J=>J.visible).map(J=>this._renderInput(J))}_renderInput(r){if(B.isGroupInput(r))return this._renderGroup(r);if(B.isFieldInput(r))return this._renderLabeledField(r);
if(B.isRelationshipInput(r))return this._renderRelationshipInput(r);if(B.isTextElementInput(r))return this._renderTextElementInput(r)}_renderDescriptionOrEmpty(r,J){return null==r?null:L.tsx("div",{class:this.classes(v.css.description),id:J},r)}_renderGroup(r){const {disabled:J,formTemplate:M,headingLevel:y}=this,{description:H,id:h,inputs:e,label:c,open:g}=r,F=e.filter(O=>O.visible),I=this.viewModel.findField(this._focusedFieldName);return L.tsx("calcite-block",{class:this.classes(v.css.group,"sequential"===
this.groupDisplay?v.css.groupSequential:null,I?.group===r?v.css.groupActive:null,J?v.css.inputDisabled:null),collapsible:!0,"data-group":r,description:H||void 0,disabled:J,heading:`${c}`,headingLevel:M?.title?G.incrementHeadingLevel(y):y,id:h,key:h,open:g,onCalciteBlockToggle:({target:O})=>this._onGroupToggle(O,r)},F.map(O=>this._renderInput(O)))}_getFocusableInput(r,J){const M=B.flattenInputs(this.viewModel.inputs);"backward"===r&&M.reverse();J?B.isGroupInput(J)?r=(r=J.inputs.find(y=>y.visible))?
M.indexOf(r):0:(B.isInputInGroupInput(J)&&!J.group.open?(J=J.group.inputs.filter(B.isFieldInput),r="forward"===r?J[J.length-1]:J[0]):r=J,r=M.indexOf(r)+1):r=0;for(;r<M.length;r++)if(J=M[r],J.visible&&B.isFieldInput(J))return J;return null}_renderLabeledField(r){const {dataType:J,feature:M,label:y,layer:H,required:h}=r,e={"aria-label":h?S.substitute(this.messages.requiredFieldLabel,{name:y}):y,class:v.css.label,key:`${H.id}-${M.uid}-${r.name}`},c=[L.tsx("div",{class:v.css.labelTextContent,key:"labelTextContainer"},
y,h?L.tsx("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),"unsupported"!==J?this._renderFieldInput(r):this._renderReadOnlyComponent(r),this._renderAuxiliaryText(r)];return"date"===J&&"coded-value"!==r.domain?.type?L.tsx("label",{...e},c):L.tsx("calcite-label",{...e},c)}_renderFieldInput(r){const {dataType:J,domain:M,inputType:y,name:H}=r,h=this.getCommonInputProps(r);if("coded-value"===M?.type){const e=this.viewModel.getFieldValueOptionsForField(H,this.messages.empty);
return"switch"!==y||r.hasInvalidSwitchValue?"radio-buttons"===y?this._renderRadioButtonComponents(r,e.flat(),h):this._renderComboBoxComponent(r,e,h):this._renderSwitchComponent(r,h)}return"datetime-picker"===y||"date"===J?this._renderDateComponents(r,h):"number"===J?this._renderNumberComponent(r,h):this._renderStringComponent(r,h)}_renderStringComponent(r,J){return"text-area"===r.inputType?J.readOnly?L.tsx("calcite-input",{...J,loading:r.updating,type:"textarea",onCalciteInputInput:M=>this._saveValueFromComponent(M.target)}):
L.tsx("calcite-text-area",{...J,resize:"vertical",onCalciteTextAreaInput:M=>this._saveValueFromComponent(M.target)}):L.tsx("calcite-input",{...J,loading:r.updating,type:"text",onCalciteInputInput:M=>this._saveValueFromComponent(M.target)})}_renderNumberComponent(r,J){return L.tsx("calcite-input-number",{...J,integer:u.isIntegerField(r.field),loading:r.updating,type:"number",onCalciteInputNumberInput:M=>this._saveValueFromComponent(M.target)})}_renderDateComponents(r,J){const {field:M}=r;switch(M.type){case "date":return this._renderDateFieldComponents(r,
J);case "date-only":return this._renderDateOnlyFieldComponent(r,J);case "time-only":return this._renderTimeOnlyFieldComponent(r,J);case "timestamp-offset":return this._renderTimestampOffsetFieldComponents(r,J);default:return this._renderReadOnlyComponent(r,K.getLabelForDateFieldValue(M,J.value,{timeZone:this.timeZone,...K.getIntlOptionsForField(M)}))}}_renderDateOnlyFieldComponent(r,J){const {range:M,valid:y,value:H}=r,{class:h,key:e,readOnly:c}=J,{rawMax:g,rawMin:F}=M;return L.tsx("calcite-input-date-picker",
{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!y,class:h,"data-date-part":"date","data-field-name":J["data-field-name"],key:`${e}-date-input`,max:D.isString(g)?g:void 0,min:D.isString(F)?F:void 0,numberingSystem:K.numberingSystem,onblur:I=>{this._focusedFieldName=null;this._saveValueFromDateComponent(I.target)},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:c,value:null!=H?`${H}`:void 0,onCalciteInputDatePickerChange:I=>
this._saveValueFromDateComponent(I.target)})}_renderTimeOnlyFieldComponent(r,J){const {valid:M,value:y}=r,{class:H,key:h,readOnly:e}=J;return L.tsx("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!M,class:H,"data-date-part":"time","data-field-name":J["data-field-name"],key:`${h}-time-input`,numberingSystem:K.numberingSystem,onblur:c=>{this._focusedFieldName=null;this._saveValueFromDateComponent(c.target)},onfocus:this._onComponentFocus,
overlayPositioning:"fixed",readOnly:e,step:r.timeStep,value:null!=y?`${y}`:void 0,onCalciteInputTimePickerChange:c=>this._saveValueFromDateComponent(c.target)})}_renderTimestampOffsetFieldComponents(r,J){const {name:M,range:y,timeZone:H,valid:h,value:e}=r,{class:c,key:g,readOnly:F}=J,{rawMax:I,rawMin:O}=y;J={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!h,numberingSystem:K.numberingSystem,overlayPositioning:"fixed",readOnly:F,["data-field-name"]:M,
onfocus:this._onComponentFocus};const R=K.prepareISOFieldValueForDateComponents(I,H),W=K.prepareISOFieldValueForDateComponents(O,H),V=K.prepareISOFieldValueForDateComponents(e,H);return L.tsx("div",{class:v.css.dateInputContainer,key:`${g}-date-time-container`},L.tsx("calcite-input-date-picker",{...J,class:c,"data-date-part":"date",key:`${g}-date-input`,max:R?.date??void 0,min:W?.date??void 0,onblur:aa=>{this._focusedFieldName=null;this._saveValueFromDateComponent(aa.target)},value:V.date??void 0,
onCalciteInputDatePickerChange:aa=>this._saveValueFromDateComponent(aa.target)}),L.tsx("calcite-input-time-picker",{...J,class:c,"data-date-part":"time",key:`${g}-time-input`,onblur:aa=>{this._focusedFieldName=null;this._saveValueFromDateComponent(aa.target)},step:r.timeStep,value:V.time??void 0,onCalciteInputTimePickerChange:aa=>this._saveValueFromDateComponent(aa.target)}),r.includeTimeOffset?L.tsx("calcite-input-time-zone",{...J,class:c,"data-date-part":"timeZone",disabled:F,key:`${g}-timezone-input`,
onblur:aa=>{this._focusedFieldName=null;this._saveValueFromDateComponent(aa.target)},value:V.timeZoneOffset??"0",onCalciteInputTimeZoneChange:aa=>this._saveValueFromDateComponent(aa.target)}):null)}_renderDateFieldComponents(r,J){const {includeTime:M,name:y,valid:H,value:h}=r,{class:e,key:c,max:g,min:F,readOnly:I}=J;var {timeZone:O}=this;r={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentCreateOrUpdate,"aria-invalid":!H,numberingSystem:K.numberingSystem,overlayPositioning:"fixed",
readOnly:I,["data-field-name"]:y,onfocus:this._onComponentFocus};J=K.prepareUnixFieldValueForDateComponents(h,O);const R=K.prepareUnixFieldValueForDateComponents(g,O);O=K.prepareUnixFieldValueForDateComponents(F,O);return L.tsx("div",{class:v.css.dateInputContainer,key:`${c}-date-time-container`},L.tsx("calcite-input-date-picker",{...r,class:e,"data-date-part":"date",key:`${c}-date-input`,max:R?.date??void 0,min:O?.date??void 0,onblur:W=>{this._focusedFieldName=null;this._saveValueFromDateComponent(W.target)},
value:J.date??void 0,onCalciteInputDatePickerChange:W=>this._saveValueFromDateComponent(W.target)}),M?L.tsx("calcite-input-time-picker",{...r,class:e,"data-date-part":"time",key:`${c}-time-input`,onblur:W=>{this._focusedFieldName=null;this._saveValueFromDateComponent(W.target)},step:1,value:J.time??void 0,onCalciteInputTimePickerChange:W=>this._saveValueFromDateComponent(W.target)}):null)}_renderReadOnlyComponent(r,J){r=this.getCommonInputProps(r);return L.tsx("calcite-input",{...r,class:this.classes(v.css.fieldInput,
v.css.inputDisabled),readOnly:!0,type:"text",value:null!=J?`${J}`:r.value})}_renderComboBoxComponent(r,J,M){const {value:y,name:H}=r,{viewModel:h,_inputsWithChanges:e}=this,c="INSERT"===h.arcadeEditType,g=e.has(H),F=null==y&&(!c||g);return L.tsx("calcite-combobox",{...M,allowCustomValues:!1,clearDisabled:!0,disabled:M.readOnly,onblur:c&&r.showNoValueOptionEnabled&&!g?()=>{}:M.onblur,overlayPositioning:"fixed",selectionMode:"single",onCalciteComboboxChange:({target:I})=>{F&&0===I.selectedItems.length?
this._ignoreDeselectionOfNoValueOption(I):r.isSubtypeField&&0===I.selectedItems.length?I.value=`${r.value}`:this._saveValueFromComponent(I)}},this.renderComboboxOptionsList(r,J))}renderComboboxOptionsList(r,J){const {value:M,name:y}=r,{messages:H,messagesTemplates:h,viewModel:e,_inputsWithChanges:c}=this,[g,F,I]=J.map(W=>W.map(({name:V,value:aa})=>L.tsx("calcite-combobox-item",{key:`#${aa}`,selected:M===aa,textLabel:V,value:`${aa}`})));J=[];0<F.length&&J.push(L.tsx("calcite-combobox-item-group",{key:"other",
label:h.other},F));0<I.length&&J.push(L.tsx("calcite-combobox-item-group",{key:"unsupported",label:H.subtypes.unsupportedDomainGroupTitle},I));0<J.length?J.unshift(L.tsx("calcite-combobox-item-group",{key:"recommended",label:H.recommended},g)):J.push(...g);const O="INSERT"===e.arcadeEditType,R=c.has(y);r.showNoValueOptionEnabled&&J.unshift(L.tsx("calcite-combobox-item",{key:"empty-option",selected:null==M&&(!O||R),textLabel:r.showNoValueLabel||H.empty,value:""}));return J}_renderRadioButtonComponents(r,
J,M){const {name:y,value:H}=r;J=J.map(({name:h,value:e})=>this._renderRadioButtonComponent({key:h,label:h,name:y,value:e,selected:e===H,props:M}));r.showNoValueOptionEnabled&&J.unshift(this._renderRadioButtonComponent({key:"empty-option",label:r.showNoValueLabel||this.messages.empty,name:y,value:"",selected:""===H||null===H,props:M}));return L.tsx("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:v.css.inputRadioGroup,
"data-field-name":M["data-field-name"],key:`${M.key}-radio-group`,layout:"vertical",name:M.key,required:M.required},J)}_renderSwitchComponent(r,J){const {value:M}=r;r=B.isFieldElementWithInputType(r.element,"switch")?M===r.element.input.onValue:!1;return L.tsx("calcite-switch",{...J,checked:r,class:v.css.inputSwitch,disabled:J.readOnly,onblur:()=>{this._focusedFieldName=null},onCalciteSwitchChange:y=>this._saveValueFromComponent(y.target)})}_renderRadioButtonComponent({key:r,name:J,value:M,selected:y,
label:H,props:h}){return L.tsx("calcite-label",{class:v.css.inputRadioLabel,key:r,layout:"inline"},L.tsx("calcite-radio-button",{...h,afterCreate:void 0,afterUpdate:void 0,checked:y,class:v.css.inputRadio,disabled:h.readOnly,name:J,onblur:()=>{this._focusedFieldName=null},value:M,onCalciteRadioButtonChange:({target:e})=>{e.checked&&this._saveValueFromComponent(e)}}),H)}_renderAuxiliaryText(r){const J=r.name,M=this._inputsWithChanges.has(J)&&!r.valid?B.getErrorMessageForFieldInput(r,this.messages,
this.timeZone):null!=this.viewModel.contingencyConstraintViolations.get(J)?this.messages.validationErrors.valuesIncompatible:null!=r.valueExpressionExecutor&&r.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return null!=M?L.tsx("calcite-input-message",{icon:!0,status:"invalid"},M):this._inputsWithChanges.has(J)&&r.valueIsOutOfDomain?L.tsx("calcite-input-message",{icon:!0,status:"idle"},this.messages.subtypes.fieldOutOfSubtypeDomainWarning):this._renderDescriptionOrEmpty(r.description)}_renderShowAllRelatedRecordsListItem(r){const {featureCount:J,
relationshipId:M,showAllActionVisible:y}=r;({relatedRecordCallbacks:r}=this);if(y&&r?.showAllRelatedRecords)return r=this.messages,L.tsx("calcite-list-item",{description:S.substitute(r.totalCount,{count:J}),label:r.showAll,value:!0,onCalciteListItemSelect:()=>this._onShowAllRelatedRecordsClick(M)},L.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"}))}_renderAddRelatedRecordButton(r){const {canAddRelatedFeature:J,relationshipId:M,relatedLayer:y}=r,{messages:H,relatedRecordCallbacks:h}=
this;if(J&&h?.addRelatedRecord&&y)return L.tsx("calcite-button",{alignment:"center",appearance:"outline-fill",class:v.css.centeredButton,disabled:r.updating||!r.originHasValidKey,iconStart:"plus",key:`${M}-add-button`,onclick:()=>{!r.updating&&r.originHasValidKey&&this._onAddRelatedRecordsClick(M,y)},round:!0,scale:"s",width:"half"},r.relatedLayerIsTable?H.addRecord:H.addFeature)}_renderRelatedRecordListItem(r,J){const {feature:M,description:y,title:H}=r,{feature:h,relatedRecordCallbacks:e}=this,
{highlightHelper:c}=this.viewModel;return L.tsx("calcite-list-item",{bind:this,description:y,key:`${J}-${M.uid}`,label:H,onclick:()=>{c?.removeAll();e?.editRelatedRecord&&h&&e.editRelatedRecord({parentFeature:h,relationshipId:J,relatedFeature:M})},onmouseenter:c?()=>c.add(M):void 0,onmouseleave:c?()=>c.remove(M):void 0,value:H},L.tsx("calcite-icon",{icon:B.getIconForFeature(M),slot:"content-start"}),L.tsx("calcite-icon",{icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderRelationshipInput(r){if(this._relatedRecordsEnabled&&
r.editable){var {featureCount:J,relationshipId:M,showAllEnabled:y}=r,H=y?null:this._renderDescriptionOrEmpty(r.description),h=0<J?this._renderRelatedRecordsList(r):r.loaded?r.originHasValidKey?this._renderNoRelatedRecordsNotice():this._renderNoValidOriginKeyNotice(r):void 0;return L.tsx("calcite-label",{class:this.classes(v.css.label,v.css.relatedRecordsLabel),key:`relationship-${M}-container`},L.tsx("div",null,this._renderRelatedRecordsHeaderContainer(r),H,h),this._renderAddRelatedRecordButton(r))}}_renderRelatedRecordsHeaderContainer(r){const J=
r.updating||!r.loaded;return L.tsx("div",{class:v.css.relatedRecordsHeader,key:`relationship-${r.relationshipId}-header`},L.tsx("span",null,r.label),J?L.tsx("calcite-loader",{inline:!0,key:"loader",label:this.messagesCommon?.loading,scale:"s",type:"indeterminate"}):void 0)}_renderRelatedRecordsList(r){const {relationshipId:J}=r;return L.tsx("calcite-list",{class:v.css.relatedRecordsList},r.relatedFeatureInfos.map(M=>this._renderRelatedRecordListItem(M,J)),this._renderShowAllRelatedRecordsListItem(r),
this._renderObserverNode())}_renderNoValidOriginKeyNotice(r){var {messages:J}=this;J=r.relatedLayerIsTable?J.noOriginKeyRecord:J.noOriginKeyFeature;const M=r.relationship?.keyField,y=this.viewModel.findField(M),H=r.layer?.fieldsIndex.get(M);r=S.substitute(J,{relatedLayerName:r.relatedLayer?.title,originKeyField:y?.label||H?.alias||M});return L.tsx("calcite-notice",{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},L.tsx("div",{slot:"message"},r))}_renderNoRelatedRecordsNotice(){return L.tsx("calcite-notice",
{icon:"information",kind:"brand",open:!0,scale:"s",width:"full"},L.tsx("div",{slot:"message"},this.messagesFeature.noRelatedFeatures))}_renderObserverNode(){if(this.viewModel.activeRelationshipInput?.showAllEnabled)return L.tsx("div",{afterCreate:this._afterListObserverCreated,afterRemoved:this._afterListObserverRemoved,bind:this,class:v.css.listObserver,key:"feature-observer"})}_renderTextElementInput(r){return L.tsx("div",{class:v.css.textElement,innerHTML:r.text,key:r.id})}getCommonInputProps(r){var {disabled:J}=
this;const {editable:M,hint:y,label:H,maxLength:h,minLength:e,name:c,range:{max:g,min:F},required:I,valid:O,value:R}=r;r=this._inputsWithChanges.has(c);J=!M||J;return{afterCreate:this._afterComponentCreate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":O?"false":"true",class:this.classes(v.css.fieldInput,J?v.css.inputDisabled:null),status:r&&!O?"invalid":"idle",key:c,label:H,max:null!=g?g:void 0,min:null!=F?F:void 0,maxLength:-1<h?h:void 0,minLength:-1<e?e:void 0,placeholder:y??void 0,
readOnly:J,required:I,value:null==R?"":`${R}`,onblur:this._onComponentBlur,onfocus:this._onComponentFocus,onkeydown:this._onComponentKeyDown,["data-field-name"]:c}}_getFieldInputFromHTMLElement(r){return this.viewModel.findField(r.getAttribute("data-field-name"))}_afterDateComponentCreate(r){const J=this._getFieldInputFromHTMLElement(r),M=r.dataset.datePart,y=this._dateComponentMap.get(J.name);if("valueAsDate"in r&&null!=r.value&&null!=J.value){const H=new ResizeObserver(()=>{r.value=void 0;switch(J.field.type){case "date":r.value=
K.prepareUnixFieldValueForDateComponents(J.value,this.timeZone).date??"";break;case "timestamp-offset":r.value=K.prepareISOFieldValueForDateComponents(J.value,this.timeZone).date??"";break;default:r.value=`${J.value}`}H.unobserve(r)});H.observe(r)}if(null!=y)switch(M){case "date":y.date=r;break;case "time":y.time=r;break;case "timeZone":y.timeZone=r}else this._dateComponentMap.set(J.name,{[M]:r});this._afterDateComponentCreateOrUpdate(r)}_afterDateComponentCreateOrUpdate(r){this._afterComponentCreateOrUpdate(r)}_afterComponentCreate(r){const J=
this._getFieldInputFromHTMLElement(r);B.isNumberFieldInput(J)&&null!=r.value&&"setNumberValue"in r&&r.setNumberValue({committing:!1,value:r.value,origin:"direct"});this._afterComponentCreateOrUpdate(r)}_afterRadioGroupCreateOrUpdate(r){var J=r.selectedItem;r=r.querySelector("calcite-radio-button");(J=J||r)&&this._afterComponentCreateOrUpdate(J)}_afterComponentCreateOrUpdate(r){var {viewModel:J}=this;const M=this._getFieldInputFromHTMLElement(r);J=J.findField(this._focusedFieldName);this._attemptFocusOnNextRender&&
J===M&&(this._attemptFocusOnNextRender=!1,B.isInputInGroupInput(M)&&(M.group.open=!0),P.setFocus(r))}_onComponentFocus(r){this._focusedFieldName=this._getFieldInputFromHTMLElement(r.target).name}_onComponentBlur(r){r=r.target;this._focusedFieldName=null;this._saveValueFromComponent(r)}_saveValueFromDateComponent(r){const {timeZone:J}=this;var M=this._getFieldInputFromHTMLElement(r);const y=M.field.type,{name:H,range:h}=M;if(M=this._dateComponentMap.get(H)){var e=this.viewModel.getValue(H),c=null;
"date-only"===y?c=Array.isArray(r.value)?r.value[0]:r.value:"time-only"===y?(e=K.normalizeTimeOnlyString(e),c=K.normalizeTimeOnlyString(r.value)):c="timestamp-offset"===y?null!=r.value?K.getISOFieldValueFromDateComponents({dateComponent:M.date,timeComponent:M.time,timeZoneComponent:M.timeZone,oldValue:e,defaultTimeZone:J}):null:null!=r.value?K.getUnixFieldValueFromDateComponents({oldValue:e,dateComponent:M.date,timeComponent:M.time,timeZone:J,max:h.max,min:h.min}):null;null!==c&&r.value?e!==c&&this._updateFieldValue(H,
c):this._updateFieldValue(H,null)}}_saveValueFromComponent(r){const J=this._getFieldInputFromHTMLElement(r);r=this._parseValue(r);const M=J.value;J.isSubtypeField&&B.subtypeChangeShouldPrompt(this.layer,M,r)?this._pendingSubtypeChoice||r===M||(this._pendingSubtypeChoice=this._handleSubtypeChoice(J,r)):this._updateFieldValue(J.name,r)}async _handleSubtypeChoice(r,J){const {value:M,name:y}=r,{messages:H,viewModel:h,messagesCommon:e,_subtypes:c}=this;this._updateFieldValue(y,J);if(c?.length){var g=c.find(W=>
W.code===J),F=c.find(W=>W.code===M)?.name??`${M}`;if(g){h.hasPendingSubtypeChoice=!0;var I=k.createResolver(),O="update-fields",R=[{label:H.subtypes.useDefaultValuesOption,value:"update-fields"},{label:H.subtypes.keepCurrentValuesOption,value:"keep-existing"}];F={context:"info",title:H.subtypes.changeWarningTitle,message:S.substitute(H.subtypes.changeWarning,{originalType:F,newType:g.name}),radios:R,defaultRadioSelection:"update-fields",onRadioSelection:W=>O=W,actions:{primary:{label:e.apply,action:()=>
I.resolve(O),type:"positive"},secondary:{label:e.cancel,type:"neutral",action:()=>I.resolve("undo")}},cancel:()=>I.reject()};try{switch(this.showPrompt(F),await I.promise){case "update-fields":h.applySubtypeDefaults(g);this._validateContingenciesForNonNullFields();break;case "keep-existing":this._validateContingenciesForNonNullFields();break;case "undo":this._updateFieldValue(r.name,M)}}finally{h.hasPendingSubtypeChoice=!1,this.clearPrompt(),this._pendingSubtypeChoice=null}}}}_onComponentKeyDown({key:r,
target:J}){J=this._getFieldInputFromHTMLElement(J);"Enter"===r&&B.isInputInGroupInput(J)&&!J.group.open&&(J.group.open=!0)}_updateFieldValue(r,J){const M=this.viewModel.getValue(r);this.viewModel.setValue(r,J);this._inputsWithChanges.add(r);M!==J&&this.viewModel.fieldsWithContingentValues.has(r)&&this._validateContingenciesForNonNullFields()}_validateContingenciesForNonNullFields(){const r=Object.fromEntries(Object.entries(this.getValues()).filter(([,J])=>null!=J));this.viewModel.validateContingencyConstraints(r)}_parseValue(r){const J=
this._getFieldInputFromHTMLElement(r),M=r.value;return B.isFieldElementWithInputType(J.element,"switch")?r.checked?J.element.input.onValue:J.element.input.offValue:null==M||""===M?null:"number"===J.dataType?"-0"===M||"-0."===M||"-0,"===M?M:parseFloat(M):"date"===J.field.type?parseFloat(M):M}_ignoreDeselectionOfNoValueOption(r){const {firstChild:J,selectedItems:M}=r;0===M.length&&J&&"selected"in J?J.selected=!0:l.getLogger(this).warnOnce("Failed to override user attempt to deselect 'No value' option.")}_onGroupToggle(r,
J){r.open?(J.open=!0,this._focusedFieldName=this._getFocusableInput("forward",J)?.name||null,this._attemptFocusOnNextRender=!0,"sequential"===this.groupDisplay&&this.viewModel.allGroupInputs.forEach(M=>{M!==J&&(M.open=!1)})):J.open=!1;this.scheduleRender()}_onFormSubmit(r){r.preventDefault()}_onFormKeyDown(r){"Enter"===r.key&&this.viewModel.submit()}_afterListObserverCreated(r){this.viewModel.activeRelationshipInput&&(this._listObserverNode=r)}_afterListObserverRemoved(){this._listObserverNode=null}_onObserverChange(){this._listObserverNode&&
this._listObserver.unobserve(this._listObserverNode);const r=this.viewModel.activeRelationshipInput;r&&this._listObserverNode&&r.showAllEnabled&&this._listObserver.observe(this._listObserverNode)}_incrementRelatedRecordPage(){this.viewModel.activeRelationshipInput?.incrementPage()}_syncGroupInputStates(){if("sequential"===this.groupDisplay){var r=this.viewModel.allGroupInputs;if(r.length){var J=r.filter(M=>M.open);0===J.length?r[0].open=!0:1<J.length&&J.slice(1).forEach(M=>M.open=!1)}}}get test(){return{inputsWithChanges:this._inputsWithChanges,
updateValue:this._saveValueFromComponent.bind(this)}}};b.__decorate([q.property()],d.prototype,"_listObserverNode",void 0);b.__decorate([q.property()],d.prototype,"_relatedRecordsEnabled",null);b.__decorate([q.property()],d.prototype,"_prompt",void 0);b.__decorate([q.property()],d.prototype,"_subtypes",null);b.__decorate([q.property()],d.prototype,"disabled",null);b.__decorate([q.property()],d.prototype,"feature",null);b.__decorate([q.property()],d.prototype,"formTemplate",null);b.__decorate([q.property()],
d.prototype,"groupDisplay",void 0);b.__decorate([q.property()],d.prototype,"headingLevel",void 0);b.__decorate([q.property()],d.prototype,"icon",null);b.__decorate([q.property()],d.prototype,"label",null);b.__decorate([q.property()],d.prototype,"layer",null);b.__decorate([q.property()],d.prototype,"map",null);b.__decorate([q.property(),z.messageBundle("esri/widgets/FeatureForm/t9n/FeatureForm")],d.prototype,"messages",void 0);b.__decorate([q.property(),z.messageBundle("esri/t9n/common")],d.prototype,
"messagesCommon",void 0);b.__decorate([q.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],d.prototype,"messagesFeature",void 0);b.__decorate([q.property(),z.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],d.prototype,"messagesTemplates",void 0);b.__decorate([q.property()],d.prototype,"relatedRecordCallbacks",null);b.__decorate([q.property()],d.prototype,"relationshipId",null);b.__decorate([q.property()],d.prototype,"spatialReference",null);b.__decorate([q.property()],
d.prototype,"strict",null);b.__decorate([q.property()],d.prototype,"timeZone",null);b.__decorate([q.property()],d.prototype,"showPrompt",null);b.__decorate([q.property()],d.prototype,"clearPrompt",null);b.__decorate([q.property(),C.vmEvent(["value-change","submit"])],d.prototype,"viewModel",void 0);b.__decorate([q.property()],d.prototype,"test",null);return d=b.__decorate([f.subclass("esri.widgets.FeatureForm")],d)})},"esri/widgets/Editor/components/Prompt":function(){define("require exports ../../../chunks/componentsUtils ../../support/Heading ../../support/iconUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k){function E({radios:f,onRadioSelection:u,defaultRadioSelection:t}){return f?.length?k.tsx("calcite-radio-button-group",{name:"PromptChoiceList"},f.map(A=>k.tsx("calcite-label",{layout:"inline"},k.tsx("calcite-radio-button",{checked:A.value===t,value:A.value,onCalciteRadioButtonChange:()=>u?.(A.value)}),A.label))):void 0}const q={base:"esri-editor__prompt",header:"esri-editor__prompt__header",heading:"esri-editor__prompt__header__heading",message:"esri-editor__prompt__message",
divider:"esri-editor__prompt__divider",actions:"esri-editor__prompt__actions"};b.Prompt=function({actions:f,context:u,headingLevel:t,message:A,title:x,...v}){const {primary:B,secondary:n}=f;switch(u){case "danger":var w="danger";break;case "info":w="brand";break;default:w="neutral"}f=k.tsx("calcite-button",{afterCreate:D=>l.setFocus(D),appearance:"solid","data-testid":"primary-prompt-button",key:"prompt-primary-button",kind:w,onclick:B.action,width:n?"half":"full"},B.label);w=n&&k.tsx("calcite-button",
{appearance:"outline","data-testid":"secondary-prompt-button",key:"prompt-secondary-button",kind:w,onclick:n.action,width:"half"},n.label);return k.tsx("calcite-scrim",{"data-testid":"prompt",key:"prompt"},k.tsx("div",{class:`${q.base}--${u}`},k.tsx("div",{class:q.header},k.tsx("calcite-icon",{icon:p.iconByKind.warning}),k.tsx(m.Heading,{class:q.heading,level:t},x)),k.tsx("div",{class:q.message},A),E(v)??k.tsx("div",{class:q.divider}),k.tsx("div",{class:q.actions},w,f)))};b.css=q;b.loadPromptComponents=
()=>d.loadCalciteComponents({button:()=>new Promise((f,u)=>a(["../../../chunks/calcite-button"],f,u)),icon:()=>new Promise((f,u)=>a(["../../../chunks/calcite-icon"],f,u)),scrim:()=>new Promise((f,u)=>a(["../../../chunks/calcite-scrim"],f,u)),label:()=>new Promise((f,u)=>a(["../../../chunks/calcite-label"],f,u)),"radio-button":()=>new Promise((f,u)=>a(["../../../chunks/calcite-radio-button"],f,u)),"radio-button-group":()=>new Promise((f,u)=>a(["../../../chunks/calcite-radio-button-group"],f,u))});
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(a,b,d,m,p){a.Heading=function({level:l,class:k,...E},q){l=b.clamp(Math.ceil(l),1,6);return p.tsx(`h${l}`,{...E,"aria-level":String(l),class:m.classes(d.globalCss.heading,k),role:"heading"},q)};a.incrementHeadingLevel=function(l,k=1){return b.clamp(Math.ceil(l+k),1,6)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/support/iconUtils":function(){define(["exports"],function(a){a.iconByKind={danger:"exclamation-mark-circle",info:"information",success:"check",warning:"exclamation-mark-triangle",brand:void 0,neutral:void 0,inverse:void 0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/css":function(){define(["exports"],function(a){a.css={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",
label:"esri-feature-form__label",labelTextContent:"esri-feature-form__label-text-content",fieldInput:"esri-feature-form__input",inputRadio:"esri-feature-form__input--radio",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadioLabel:"esri-feature-form__input--radio-label",inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",centeredButton:"esri-feature-form__centered-button",description:"esri-feature-form__description-text",listObserver:"esri-feature-form__list-observer",
relatedRecordsHeader:"esri-feature-form__related-records_header",relatedRecordsLabel:"esri-feature-form__related-records_label",relatedRecordsList:"esri-feature-form__related-records_list",dateInputContainer:"esri-feature-form__date-input-container",textElement:"esri-feature-form__text-element",group:"esri-feature-form__group",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/lang ../../core/Logger ../../core/string ../../form/support/formUtils ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../layers/support/layerUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x){function v(C){const {fields:L,values:S}=C,r=C.timeZone??void 0;C=L.map((J,M)=>{let y=S[M];J.domain&&"coded-value"===J.domain.type&&(M=J.domain.codedValues.find(H=>H.code===y),M?.name&&(y=M.name));if(t.isAnyDateField(J)||f.isTimeOnlyField(J))y=A.getLabelForDateFieldValue(J,y,{timeZone:r,...A.getIntlOptionsForField(J)});return[J.name,y]});return Object.fromEntries(C)}function B(C,L){return k.replace(k.replace(C,S=>`{${S.toLowerCase()}}`),Object.fromEntries(Object.entries(L).map(([S,
r])=>[S.toLowerCase(),r])))}function n(C){return 1E7<=C||-1E7>=C}function w(C,{validationErrors:L}){return null!=C.max&&null!=C.min?L.outsideRange:null!=C.max?L.outsideRangeMax:L.outsideRangeMin}const D=C=>"field"===C?.type,K=C=>"relationship"===C?.type,N=C=>C.reduce((L,S)=>"group"===S?.type?[...L,...S.inputs]:[...L,S],[]),G=(C,L)=>null!=C&&C.input?.type===L;a.LengthValidationError=void 0;(function(C){C.TOO_SHORT="length-validation-error::too-short";C.TOO_LONG="length-validation-error::too-long"})(a.LengthValidationError||
(a.LengthValidationError={}));const P={type:"number"},z={type:"number",intlOptions:{notation:"scientific"}};a.extractExpressionNameFromString=function(C){const [L,S]=C.split("expression/");return""===L&&S?S:(l.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${C} is not a valid expression reference of the form '${"expression/"}/expressionName'`),"")};a.flattenFieldInputs=C=>N(C).filter(D);a.flattenInputs=N;a.flattenRelationshipInputs=
C=>N(C).filter(K);a.formTemplateHasInvalidFields=function(C,L){return(L=L??("formTemplate"in C&&C.formTemplate))?(L.elements?.filter(E.isFieldElement)??[]).some(({fieldName:S})=>!C.fieldsIndex.get(S)):!1};a.getComputedAttributes=v;a.getErrorMessageForFieldInput=(C,L,S)=>{const {dataType:r,error:J,minLength:M,value:y,required:H}=C,h=L?.validationErrors;if(!h||!J)return null;if(H&&null===y)return h.cannotBeNull;if(J===q.DomainValidationError.VALUE_OUT_OF_RANGE||J===f.NumericRangeValidationError.OUT_OF_RANGE){const {field:e,
range:c}=C;C={type:"date",intlOptions:{timeZone:"date"===e.type&&S?S:void 0,...A.getIntlOptionsForField(e)}};L=w(c,L);return x.substitute(L,c,{format:{max:"date"===r?C:null!=c.max&&n(c.max)?z:P,min:"date"===r?C:null!=c.min&&n(c.min)?z:P}})}return J===q.DomainValidationError.INVALID_CODED_VALUE?h.invalidCodedValue:J===f.TypeValidationError.INVALID_TYPE?h.invalidType:J===a.LengthValidationError.TOO_SHORT?x.substitute(h.tooShort,{min:M}):null};a.getFieldsInTitleAndDesc=C=>{const L=[];if(C.formTemplate){const {description:S,
title:r}=C.formTemplate;C.fields?.forEach(J=>{const M=r&&k.templateHasKey(r,J.name),y=S&&k.templateHasKey(S,J.name);(M||y)&&L.push(J.name)})}return L};a.getIconForFeature=C=>{if(C){var L=C.layer;L=L&&"geometryType"in L?L.geometryType:void 0;C=C.geometry?.type;return"polyline"===C||"polyline"===L?"line":"mesh"===C||"mesh"===L||"multipatch"===L?"cube":"multipoint"===C||"multipoint"===L?"point":C||L||"table"}};a.getNormalizedFeatureTypeInfo=C=>{const L={typeFieldName:null,types:[]};if(!C)return L;"subtype-sublayer"===
C.type?(L.typeFieldName=C.parent?.subtypeField,L.types=C.parent?.subtypes??[]):"subtype-group"===C.type||"feature"===C.type&&C.subtypes?.length?(L.typeFieldName=C.subtypeField,L.types=C.subtypes??[]):"types"in C&&C.types&&(L.typeFieldName=C.typeIdField,L.types=C.types.map(({id:S,name:r,domains:J})=>({code:S,name:r,domains:J})));null!=L.typeFieldName&&(L.typeFieldName=C.getField(L.typeFieldName)?.name??L.typeFieldName);return L};a.isExpressionReference=function(C){return C.startsWith("expression/")};
a.isFieldElementWithInputType=G;a.isFieldElementWithShowNoValueOptionInput=C=>null!=C&&(G(C,"combo-box")||G(C,"radio-buttons"));a.isFieldElementWithTextInput=C=>null!=C&&(G(C,"text-box")||G(C,"text-area"));a.isFieldInput=D;a.isGroupInput=C=>"group"===C?.type;a.isInputInGroupInput=C=>"group"!==C?.type&&null!=C.group;a.isLegacyFieldMapsExpressionReference=function(C){return C.startsWith("expr/")};a.isNumberFieldInput=({domain:C,inputType:L="text-box",dataType:S})=>"number"===S&&"text-box"===L&&(!C||
"coded-value"!==C.type);a.isRelationshipInput=K;a.isTextElementInput=C=>"text"===C.type;a.parseFormTemplateString=function(C){const {attributes:L,fieldsIndex:S,label:r,timeZone:J}=C;if(!L||"object"!==typeof L)return r;var M=Object.keys(L).filter(y=>k.templateHasKey(r,y));C=M.map(y=>L[y]);M=M.map(y=>S.get(y)).filter(d.isSome);return B(r,v({values:C,fields:M,timeZone:J}))};a.prependExpressionPrefix=function(C){return`${"expression/"}${C}`};a.prependFieldPrefix=function(C){return`${"field/"}${C}`};a.substituteFieldTemplatesInString=
B;a.subtypeChangeShouldPrompt=function(C,L,S){var r=u.getSubtypesFromLayer(C);C=r?.find(J=>J.code===S);if(!C)return!1;r=r?.find(J=>J.code===L);return p.equalsShallow(C.defaultValues,r?.defaultValues)?!1:Object.values(C.defaultValues).some(J=>null!=J)};a.valueIsInvalidSwitchValue=function(C,L){return null==C||L.onValue!==C&&L.offValue!==C};a.valueIsValidContingentValue=function(C,L){switch(L.objectType){case "any":return!0;case "null":return null==C;case "code":return C===L.codedValue?.code;case "range":return null!=
C&&null!=L.minValue&&null!=L.maxValue&&+C>=L.minValue&&+C<=L.maxValue;default:return m.neverReached(L.objectType),!1}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FeatureFormViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/compilerUtils ../../core/Evented ../../core/Logger ../../core/maybe ../../core/Promise ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../form/FormTemplate ../../form/support/formUtils ../../layers/support/ContingentValue ../../layers/support/editableLayers ../../layers/support/LayerContingentValuesCache ../../time/timeZoneUtils ./featureFormUtils ./FieldInput ./FormExpressionArcadeExecutor ./FormExpressionsManager ./GroupInput ./RelationshipInput ./TextElementInput".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L){function S(y){if("field"===y.type||"group"===y.type||"relationship"===y.type||"text"===y.type)return!0;p.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel").warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${y.label} has unsupported type '${y.type}'`);return!1}function r(y,H,h=null){const {feature:e,layer:c,timeZone:g}=H;return new L.TextElementInput({element:y,
feature:e,group:h,layer:c,timeZone:g})}const J=new b({attributes:{}}),M={field:["editableExpression","requiredExpression","valueExpression","visibilityExpression"],group:["visibilityExpression"],relationship:["editableExpression","visibilityExpression"],text:["visibilityExpression"]};b=class extends k.EsriPromiseMixin(m.EventedAccessor){constructor(y){super(y);this._expressionExecutorsInUse=new Set;this._expressionExecutorLookup=new Map;this._contingentValuesCache=this._expressionsManager=null;this._featureClone=
J.clone();this._initialFeature=J.clone();this._timeZone=null;this._updatingHandles=new A.UpdatingHandles;this.arcadeEditType="NA";this.contingencyConstraintViolations=new Map;this.disabled=!1;this.highlightHelper=null;this.inputs=[];this.relatedRecordCallbacks=this.map=null;this.hasPendingSubtypeChoice=this.strict=!1}initialize(){const y=E.watch(()=>[this.layer,!!this.layer?.loaded,this.formTemplate,this.feature,this.timeZone,this.arcadeEditType],async([e,c])=>{null!=e&&(c?this._updatingHandles.addPromise(this._updateInputs()):
e.load().catch(()=>{}))},{equals:([e,c,g,F,I,O],[R,W,V,aa,fa,ja])=>e===R&&c===W&&g===V&&F===aa&&I===fa&&O===ja,initial:!0}),H=E.watch(()=>this._arcadeContextInfo,e=>{null!=this._expressionsManager&&(this._expressionsManager.arcadeContextInfo=e,this._updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())))}),h=E.watch(()=>this.layer,e=>{(e="subtype-sublayer"===e?.type?e.parent:"feature"===e?.type?e:null)&&this.addResolvingPromise(w.createLoadedLayerContingentValuesCache(e).then(c=>
{this._contingentValuesCache=c;this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.addHandles([y,H,h])}destroy(){this.layer=this.feature=null;this._contingentValuesCache=l.destroyMaybe(this._contingentValuesCache);this.highlightHelper?.removeAll();this._updatingHandles.destroy()}get _expressionInfosLookup(){return new Map(this.formTemplate?.expressionInfos?.map(y=>[y.name,y]))}get activeRelationshipInput(){return this.allRelationshipInputs.find(y=>y.relationshipId===this.relationshipId)}get _arcadeContextInfo(){const {_initialFeature:y,
arcadeEditType:H,layer:h,map:e,spatialReference:c,timeZone:g}=this;return{layer:n.isEditableLayer(h)?h:null,originalFeature:y,editType:H,map:e,spatialReference:c,timeZone:g}}get allFieldInputs(){return K.flattenFieldInputs(this.inputs)}get allGroupInputs(){return this.inputs.filter(K.isGroupInput)}get allRelationshipInputs(){return K.flattenRelationshipInputs(this.inputs)}get _layerFieldsByName(){return new Map(this.layer?.fields.map(y=>[y.name,y]))}get feature(){return this._get("feature")}set feature(y){const H=
this._get("feature");this._featureClone=y?y.clone():J.clone();this._initialFeature=this._featureClone.clone();this._expressionsManager&&(this._expressionsManager.feature=this._featureClone);y?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(h=>h.feature=y)):(this.inputs.forEach(h=>h.destroy()),this.inputs.length=0);H!==y&&(this.hasPendingSubtypeChoice=!1);this.contingencyConstraintViolations.clear();this._set("feature",y)}get fieldsWithContingentValues(){if(null==
this._contingentValuesCache)return new Set;const y=this._contingentValuesCache.fieldGroups.flatMap(H=>H.fields);return new Set(y)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(y){void 0===y?this._clearOverride("formTemplate"):this._override("formTemplate",y)}get formDescription(){const {formTemplate:y,layer:H}=this;return y?.description&&H?K.parseFormTemplateString({label:y.description,attributes:this.getValues(),fieldsIndex:H.fieldsIndex,
timeZone:this.timeZone}):null}get formTitle(){const {formTemplate:y,layer:H}=this;return y?.title&&H?K.parseFormTemplateString({label:y.title,attributes:this.getValues(),fieldsIndex:H.fieldsIndex,timeZone:this.timeZone}):null}get formHeaderVisible(){const {activeRelationshipInput:y,formDescription:H,formTitle:h}=this;return!(y||!H&&!h)}get joinedContingentValues(){return this._joinContingentValues()}get layer(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:
null}set layer(y){this._override("layer",y)}get relationshipId(){return this._get("relationshipId")}set relationshipId(y){var H=this.allRelationshipInputs;null!=y&&y===this.relationshipId||H.forEach(h=>h.showAllEnabled=!1);null!=y&&(H=H.find(h=>h.relationshipId===y))&&(H.showAllEnabled=!0);this._set("relationshipId",y)}get spatialReference(){return this.layer?.spatialReference??null}set spatialReference(y){this._override("spatialReference",y)}get state(){return this.layer?.loaded?"ready":"disabled"}get submittable(){return this.valid?
!0:this.allFieldInputs.filter(y=>!y.valid).every(({submittable:y})=>y)}get timeZone(){var {layer:y}=this;if(y&&"datesInUnknownTimezone"in y&&y.datesInUnknownTimezone)return D.utc;y=y&&"preferredTimeZone"in y&&y.preferredTimeZone;return this._timeZone===D.unknown?y||D.utc:this._timeZone||D.system}set timeZone(y){this._timeZone=y}get updating(){return this._updatingHandles.updating}get valid(){const y=this.allFieldInputs;return 0<y.length&&y.every(({valid:H})=>H)}findField(y){return this.allFieldInputs.find(H=>
H.name===y)}getFieldValueOptionsForField(y,H){const h=this.findField(y);if(!h)return[[],[],[]];var e="coded-value"===h.domain?.type?h.domain.codedValues.map(({name:g,code:F})=>({name:g,value:F})):[];const c=null==h.value||e.some(g=>g.value===h.value)?[]:[{name:`${h.value}`,value:h.value}];y=this.fieldsWithContingentValues.has(y)?this._getContingentValueOptionsForField(y,H):[];if(0<y.length){const g=new Set(y.map(F=>F.value));e=e.filter(F=>!g.has(F.value));return[y,e,c]}return[e,[],c]}getValue(y){y=
this.layer?.getField(y);if(null!=y)return this._featureClone.getAttribute(y.name)??null}setValue(y,H){const {_featureClone:h,strict:e}=this,c=this.findField(y);H=""===H?null:H;c&&h.getAttribute(y)!==H&&(c.value=H,!e||c.valid)&&(this._afterValueChange(c),null!=this._expressionsManager&&this._updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([c.name]).finally(()=>this._afterExpressionsEvaluated())))}getValues(){return{...this._featureClone.attributes}}overrideInitialFeature(y){this._initialFeature=
y}submit(){var y=this.allFieldInputs;const H=new Set(y.filter(e=>e.valid).map(({name:e})=>e));y=y.filter(e=>!e.valid).map(({name:e})=>e);const h=this.getValues();if(0<this.validateContingencyConstraints(h,{includeIncompleteViolations:!0}).length)for(const [e,c]of this.contingencyConstraintViolations.entries())"error"===c.type&&(H.delete(e),y.push(e));this.emit("submit",{valid:[...H],invalid:y,values:h})}validateContingencyConstraints(y,H){const {_contingentValuesCache:h}=this,e=new Map;this.contingencyConstraintViolations=
e;if(null==h)return[];const {invalid:c,incomplete:g}=h.validateContingencyConstraints(y);y=[...c,...(H?.includeIncompleteViolations?g:[])];for(const F of y)for(const I of F.fieldGroup.fields)e.set(I,F);return y}notifyFeatureGeometryChanged(){const {_expressionsManager:y,feature:H,_featureClone:h}=this;H&&(h.geometry=H.geometry,null!=y&&this._updatingHandles.addPromise(y.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated())))}applySubtypeDefaults(y){({defaultValues:y}=y);var {allFieldInputs:H}=
this;for(const {name:h}of H)H=y[h],null!=H&&this.setValue(h,H)}_emitChangeEvent({name:y,valid:H,value:h}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:y,value:h,valid:H})}async _updateInputs(){this._stopExpressions();const {_featureClone:y,_initialFeature:H,arcadeEditType:h,formTemplate:e,inputs:c,layer:g,timeZone:F}=this;if(g){var I={arcadeEditType:h,feature:y,initialFeature:H,layer:g,timeZone:F},O=c.slice();this.inputs=e?.elements&&0<e.elements.length?await this._updateInputsUsingFormElements(O,
e.elements,I):this._updateInputsUsingLayerFields(O,g?.fields,I);await this._startExpressions()}}async _updateInputsUsingFormElements(y,H,h){const e=new Map;for(const c of y)if(K.isGroupInput(c)){e.set(c.element,c);for(const g of c.inputs)g.element&&e.set(g.element,g)}else c.element&&e.set(c.element,c);y=new Map;H=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:e,updatedElements:H.filter(S),sharedInitializationProperties:h,group:null,newExpressionExecutorPromises:y});for(const [c,
g]of e.entries())e.delete(c),g.destroy();await Promise.all(Array.from(y.values()));return H}async _updateInputsUsingFormElementsRecursive(y){const {existingInputsByElement:H,updatedElements:h,sharedInitializationProperties:e,group:c,newExpressionExecutorPromises:g}=y;y=[];for(const I of h){var F=H.has(I);const O=F?H.get(I):this._makeInputFromElement(I,e,c);if(O){y.push(O);await E.whenOnce(()=>!O.updating);this._assignExpressionExecutors(O,I,g);if(F)if(H.delete(I),K.isGroupInput(O)){const {feature:R,
timeZone:W}=e;O.set({feature:R,timeZone:W})}else K.isRelationshipInput(O)?(F=this.relationshipId===I.relationshipId,O.set(e),O.set({map:this.map,showAllEnabled:F})):O.set(e);v.isGroupElement(I)&&(F=I.elements.filter(R=>S(R)),O.inputs=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:H,updatedElements:F,sharedInitializationProperties:e,group:O,newExpressionExecutorPromises:g}))}}return y}_updateInputsUsingLayerFields(y,H,h){if(!Array.isArray(H))return p.getLogger("esri.widgets.FeatureForm.FeatureFormViewModel").warn(this.declaredClass,
"No attribute fields found."),[];const e=new Map;for(var c of y)if(K.isGroupInput(c)){for(const g of c.inputs)g.destroy();c.inputs.length=0;c.destroy()}else K.isRelationshipInput(c)?c.destroy():K.isFieldInput(c)&&(null!==c.element?c.destroy():e.set(c.field,c));y=[];for(const g of H)H=h.feature?.getAttribute(g.name)??null,c=e.get(g)??new N({field:g,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden}),y.push(c.set({...h,value:H})),e.delete(g);for(const [g,F]of e.entries())e.delete(g),
F.destroy();return y}_resetFieldInputValues(y){for(const H of this.allFieldInputs)H.value=y.getAttribute(H.name)}_makeInputFromElement(y,H,h){if(v.isGroupElement(y)){const {feature:e,layer:c}=H;return new z({element:y,inputs:[],feature:e,layer:c})}return v.isFieldElement(y)?this._makeFieldInputFromElement(y,H,h):v.isRelationshipElement(y)?this._makeRelationshipInputFromElement(y,H,h):v.isTextElement(y)?r(y,H):d.neverReached()}_makeFieldInputFromElement(y,H,h){const {arcadeEditType:e,feature:c,initialFeature:g,
layer:F,timeZone:I}=H;({fieldName:H}=y);return(H=H&&this._layerFieldsByName.get(H))?new N({arcadeEditType:e,element:y,field:H,value:c?.getAttribute(y.fieldName)??null,feature:c,initialFeature:g,layer:F,group:h,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden,timeZone:I}):null}_makeRelationshipInputFromElement(y,H,h=null){const {map:e}=this,{feature:c,layer:g,timeZone:F}=H,I=new C({element:y,feature:c,group:h,layer:g,map:e,timeZone:F});I.addHandles(E.on(()=>I.relatedLayer,
"edits",()=>this._expressionsManager?.evaluateAsyncExpressions()));return I}_assignExpressionExecutors(y,H,h){var e=M[H.type];const c=[];for(const g of e){const F=`${g}Executor`;y[F]?this._useExecutor(y[F]):(e=H[g],null!=e&&""!==e&&(e=this._expressionInfosLookup.get(e)?.expression??e,c.push(this._getOrCreateExecutorForExpression(e,h).then(I=>{y[F]=this._useExecutor(I)}))))}K.isTextElementInput(y)&&c.push(...this._assignTextElementExpressionExecutors(y,h));return c}_assignTextElementExpressionExecutors(y,
H){const {_expressionInfosLookup:h}=this,e=[];for(const c of y.expressionsUsed){const g=h.get(c);null==g?p.getLogger(this).error("feature-form:expression-not-found",`Could not find expressionInfo object with name '${c}'`):e.push(this._getOrCreateExecutorForExpression(g.expression,H).then(F=>y.setExpressionExecutor(c,this._useExecutor(F))))}for(const c of y.fieldsUsed)e.push(this._getOrCreateExecutorForExpression(`return $feature['${c}'];`,H).then(g=>y.setFieldExecutor(c,this._useExecutor(g))));return e}async _getOrCreateExecutorForExpression(y,
H){const {_expressionExecutorLookup:h}=this;if(h.has(y))return h.get(y);if(H.has(y))return H.get(y);const e=G.createFormExpressionArcadeExecutor(y,this.layer);H.set(y,e);H=await e;h.set(y,H);return H}_createExpressionsManager(y){const {_arcadeContextInfo:H,_featureClone:h,allFieldInputs:e,formTemplate:c}=this;this._expressionsManager=new P.FormExpressionsManager({executors:y,feature:h,arcadeContextInfo:H,fieldInputs:e,preserveFieldValuesWhenHidden:!0===c?.preserveFieldValuesWhenHidden})}async _startExpressions(){if(0!==
this._expressionExecutorsInUse.size){var y=Array.from(this._expressionExecutorsInUse);this._createExpressionsManager(y);await this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated())}}_stopExpressions(){this._expressionsManager=l.destroyMaybe(this._expressionsManager);this._expressionExecutorsInUse.clear()}_useExecutor(y){this._expressionExecutorsInUse.add(y);return y}_afterValueChange(y){const {name:H,value:h}=y,{_featureClone:e,formTemplate:c,layer:g}=this;if(g){var F=
e.getAttribute(H);e.setAttribute(H,h);var {typeFieldName:I,types:O}=K.getNormalizedFeatureTypeInfo(g);if((y.isSubtypeField||H===I)&&h!==F){"subtype-sublayer"===g.type&&(F=g.parent?.findSublayerForFeature(e),this.feature&&(this.feature.sourceLayer=F),e.sourceLayer=F);F=new Set;for(var R of O)if(R.domains&&"object"===typeof R.domains)for(const W of Object.keys(R.domains))F.add(W);for(const W of F)(R=this.findField(W))&&R.notifyChange("domain");this.notifyChange("joinedContingentValues")}if(null!=c){const {description:W,
title:V}=c;V&&q.templateHasKey(V,H)&&this.notifyChange("formTitle");W&&q.templateHasKey(W,H)&&this.notifyChange("formDescription")}this._emitChangeEvent(y)}}_afterExpressionsEvaluated(){const {_featureClone:y}=this;for(const H of this.allFieldInputs)H.value!==y.getAttribute(H.name)&&this._afterValueChange(H)}_joinContingentValues(){var y=this._contingentValuesCache;if(null==y)return[];var {typeFieldName:H}=K.getNormalizedFeatureTypeInfo(this.layer);H=H?this.getValue(H):null;const h=[];for(var e of y.fieldGroups){const {contingencies:I,
fields:O,name:R}=e;y=[];for(var c of I)c.isRetired||(null==c.subtype||c.subtype.code===H)&&y.push({values:c.values});0<y.length&&h.push({name:R,fields:O,contingencies:y})}const [g,F]=this._generateJoinPlan(h);e=g.flatMap(I=>this._joinFieldGroupContingencies(I));c=F.flatMap(I=>I.contingencies);return[...e,...c]}_generateJoinPlan(y){var H=new Map,h=[],e=new Set;for(var c of y)for(const O of c.fields)if(H.has(O)){const R=H.get(O),W=c,V=[R.name,W.name].sort().join("|");e.has(V)||(h.push([R,W]),e.add(V),
H.set(O,W))}else H.set(O,c);H=new Set(h.flat());y=new Set(y);for(var g of H)y.delete(g);g=new Map;H=new Map;for(var F of new Set(h.flat()))e=Symbol(F.name),g.set(e,new Set([F])),H.set(F,e);for(const [O,R]of h)if(h=H.get(O),F=H.get(R),h!==F){e=g.get(h);c=g.get(F);for(var I of c)e.add(I),H.set(I,h);g.delete(F)}I=[...g.values()].map(O=>[...O]);h=[...y];return[I,h]}_joinFieldGroupContingencies(y){const H=y.slice();var h=H.shift(),e=H.shift();y=this._generateJoinKey(h.fields,e.fields);let c=new Set([...h.fields,
...e.fields]),g=new Map;for(var F of h.contingencies)[h]=this._hashContingency(F,y.codedValueFields,!0),g.has(h)?g.get(h)?.push(F):g.set(h,[F]);for(;0<H.length;){F=new Map;h=H.shift();const R=this._generateJoinKey(c,h.fields);for(var I of e.contingencies){const [W,V]=this._hashContingency(I,y.codedValueFields);e=V?this._findMatchingContingenciesWithAnyHashMask(g,W):g.get(W);g.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&e?.push(...this._findMatchingContingenciesContainingAny(I,g.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),
y.codedValueFields));if(null!=e)for(var O of e){e=0<y.rangeFields.length?this._joinContingenciesWithRangeDomains(O,I,y.rangeFields):this._joinContingencies(O,I);if(null==e)break;const [aa]=this._hashContingency(e,R.codedValueFields,!0);F.has(aa)?F.get(aa)?.push(e):F.set(aa,[e])}}g=F;e=h;y=R;c=new Set([...c,...e.fields])}I=[];for(const R of e.contingencies){const [W,V]=this._hashContingency(R,y.codedValueFields);O=V?this._findMatchingContingenciesWithAnyHashMask(g,W):g.get(W);g.has("#JSAPI_CONTINGENT_VALUE_ANY_HASH")&&
O.push(...this._findMatchingContingenciesContainingAny(R,g.get("#JSAPI_CONTINGENT_VALUE_ANY_HASH"),y.codedValueFields));if(null!=O)for(const aa of O)O=0<y.rangeFields.length?this._joinContingenciesWithRangeDomains(aa,R,y.rangeFields):this._joinContingencies(aa,R),null!=O&&I.push(O)}return I}_joinContingencies(y,H){H={values:{...y.values,...H.values}};for(const [h,e]of Object.entries(H.values))"any"===e.objectType&&null!=y.values[h]&&(H.values[h]=y.values[h]);return H}_joinContingenciesWithRangeDomains(y,
H,h){const e=this._joinContingencies(y,H);for(const g of h){var c=y.values[g];const F=H.values[g],{leftIsNull:I,rightIsNull:O,bothAreNull:R,leftIsAny:W,rightIsAny:V,bothAreAny:aa,leftIsRange:fa,rightIsRange:ja}=this._compareObjectTypes(c.objectType,F.objectType);if(!R&&!aa)if(I&&V||O&&W)e.values[g]=new B({objectType:"null"});else{if(I&&ja||O&&fa)return null;W?(c.minValue=-Infinity,c.maxValue=Infinity):V&&(F.minValue=-Infinity,F.maxValue=Infinity);h=Math.max(c.minValue,F.minValue);c=Math.min(c.maxValue,
F.maxValue);if(h>c)return null;e.values[g]=new B({objectType:"range",minValue:h,maxValue:c})}}return e}_findMatchingContingenciesContainingAny(y,H,h){return H.filter(e=>h.every(c=>{const g=e.values[c];c=y.values[c];return"any"===g.objectType||"any"===c.objectType||g.codedValue?.code===c.codedValue?.code}))}_findMatchingContingenciesWithAnyHashMask(y,H){H=RegExp(`${H}$`);const h=[];for(const [e,c]of y){if("#JSAPI_CONTINGENT_VALUE_ANY_HASH"===e)break;H.test(e)&&h.push(...c)}return h}_generateJoinKey(y,
H){y=Array.isArray(y)?new Set(y):y;var h=Array.isArray(H)?new Set(H):H;H=y.size<h.size?y:h;y=H===y?h:y;({feature:h}=this);const e=new Set,c=new Set;for(const g of H)if(y.has(g)&&(H=this.layer?.getFieldDomain(g,{feature:h??void 0,excludeImpliedDomains:!0}),null!=H))switch(H.type){case "coded-value":e.add(g);break;case "range":c.add(g)}return{codedValueFields:[...e],rangeFields:[...c]}}_contingencyIsValid(y,H){const h={};for(const {name:e,value:c}of this.allFieldInputs)this.fieldsWithContingentValues.has(e)&&
null!=c&&e!==y&&(h[e]=c);return Object.entries(h).every(([e,c])=>!H.values.hasOwnProperty(e)||K.valueIsValidContingentValue(c,H.values[e]))}_getContingentValueOptionsForField(y,H){var h=this.joinedContingentValues.slice();const e=new Map;H={code:"",name:H??"No value"};for(const c of h)if(h=c.values[y],"code"===h?.objectType||"null"===h?.objectType){const {code:g,name:F}=h.codedValue&&"null"!==h.objectType?h.codedValue:H;!e.has(g)&&this._contingencyIsValid(y,c)&&e.set(g,{name:F,value:g})}return[...e.values()]}_hashContingency(y,
H,h=!1){if(1>H.length)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const e=[];let c=!1;for(const g of H)if(H=y.values[g],"any"===H.objectType){if(h)return["#JSAPI_CONTINGENT_VALUE_ANY_HASH",!0];c=!0;e.push(`${g}:.*`)}else"null"===H.objectType?e.push(`${g}:${"#JSAPI_CONTINGENT_VALUE_NULL_HASH"}`):e.push(`${g}:${H.codedValue?.code}`);return[e.sort().join("\x26"),c]}_compareObjectTypes(y,H){return{leftIsNull:"null"===y,rightIsNull:"null"===H,bothAreNull:"null"===y&&"null"===H,leftIsAny:"any"===y,
rightIsAny:"any"===H,bothAreAny:"any"===y&&"any"===H,leftIsRange:"range"===y,rightIsRange:"range"===H}}get test(){return{featureClone:this._featureClone}}};a.__decorate([f.property()],b.prototype,"_expressionInfosLookup",null);a.__decorate([f.property()],b.prototype,"_featureClone",void 0);a.__decorate([f.property()],b.prototype,"_timeZone",void 0);a.__decorate([f.property()],b.prototype,"activeRelationshipInput",null);a.__decorate([f.property()],b.prototype,"_arcadeContextInfo",null);a.__decorate([f.property()],
b.prototype,"allFieldInputs",null);a.__decorate([f.property()],b.prototype,"allGroupInputs",null);a.__decorate([f.property()],b.prototype,"allRelationshipInputs",null);a.__decorate([f.property()],b.prototype,"_layerFieldsByName",null);a.__decorate([f.property()],b.prototype,"arcadeEditType",void 0);a.__decorate([f.property()],b.prototype,"contingencyConstraintViolations",void 0);a.__decorate([f.property()],b.prototype,"disabled",void 0);a.__decorate([f.property()],b.prototype,"feature",null);a.__decorate([f.property()],
b.prototype,"fieldsWithContingentValues",null);a.__decorate([f.property({type:x})],b.prototype,"formTemplate",null);a.__decorate([f.property()],b.prototype,"formDescription",null);a.__decorate([f.property()],b.prototype,"formTitle",null);a.__decorate([f.property()],b.prototype,"formHeaderVisible",null);a.__decorate([f.property()],b.prototype,"highlightHelper",void 0);a.__decorate([f.property()],b.prototype,"inputs",void 0);a.__decorate([f.property()],b.prototype,"joinedContingentValues",null);a.__decorate([f.property()],
b.prototype,"layer",null);a.__decorate([f.property()],b.prototype,"map",void 0);a.__decorate([f.property()],b.prototype,"relatedRecordCallbacks",void 0);a.__decorate([f.property()],b.prototype,"relationshipId",null);a.__decorate([f.property()],b.prototype,"spatialReference",null);a.__decorate([f.property()],b.prototype,"state",null);a.__decorate([f.property()],b.prototype,"strict",void 0);a.__decorate([f.property()],b.prototype,"submittable",null);a.__decorate([f.property()],b.prototype,"timeZone",
null);a.__decorate([f.property()],b.prototype,"updating",null);a.__decorate([f.property()],b.prototype,"valid",null);a.__decorate([f.property()],b.prototype,"hasPendingSubtypeChoice",void 0);a.__decorate([f.property()],b.prototype,"getValues",null);a.__decorate([f.property()],b.prototype,"submit",null);a.__decorate([f.property()],b.prototype,"test",null);return b=a.__decorate([t.subclass("esri.widgets.FeatureForm.FeatureFormViewModel")],b)})},"esri/layers/support/ContingentValue":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.codedValue=this.minValue=this.maxValue=null}};a.__decorate([d.property()],b.prototype,"objectType",void 0);a.__decorate([d.property()],b.prototype,"maxValue",void 0);a.__decorate([d.property()],b.prototype,"minValue",void 0);a.__decorate([d.property()],b.prototype,"codedValue",void 0);return b=a.__decorate([k.subclass("esri.layers.support.ContingentValue")],b)})},"esri/layers/support/LayerContingentValuesCache":function(){define("../../chunks/tslib.es6 ../../request ../../core/arrayUtils ../../core/JSONSupport ../../core/Loadable ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./arcgisLayerUrl ./Contingency ./ContingencyConstraintViolation ./ContingentValue ./ContingentValuesResult ./FieldGroup ./fieldUtils ./Subtype ../../widgets/FeatureForm/featureFormUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w){function D(M){switch(M.objectType){case "any":return"@any@";case "null":return"@null@";case "code":return M.codedValue.name+M.codedValue.code.toString();case "range":return M.minValue.toString()+"-"+M.maxValue.toString()}}function K(M){M.sort((e,c)=>"null"===e.objectType?-1:"null"===c.objectType?1:e.minValue-c.minValue);let y,H;const h=[];for(const e of M)"null"===e.objectType?h.push(e):null==y||null==H?(y=e.minValue,H=e.maxValue):H<e.minValue?(h.push(new A({objectType:"range",
minValue:y,maxValue:H})),y=e.minValue,H=e.maxValue):H<e.maxValue&&(H=e.maxValue);h.push(new A({objectType:"range",minValue:y,maxValue:H}));return h}function N(M,y){const H=[];for(const h of M)y.some(e=>{if(h.objectType===e.objectType)switch(h.objectType){case "any":case "null":return!0;case "code":return h.codedValue.code===e.codedValue.code&&h.codedValue.name===e.codedValue.name}return!1})&&H.push(h);return H}function G(M,y){if(0===M.length||0===y.length)return[];if("any"===M[0].objectType)return y;
if("any"===y[0].objectType)return M;var H="range"===y[0].objectType||"range"===y[1]?.objectType;if("range"===M[0].objectType||"range"===M[1]?.objectType||H){H=[];let h=0;for(const e of M)for(;h<y.length;h++){const c=y[h];if("null"===e.objectType&&"null"===c.objectType)H.push(new A({objectType:"null"}));else if("null"===e.objectType)break;else if("null"===c.objectType)continue;if(e.maxValue<c.minValue)break;if(e.maxValue===c.minValue){H.push(new A({objectType:"range",minValue:e.maxValue,maxValue:c.minValue}));
break}if(!(e.minValue>c.maxValue))if(e.minValue===c.maxValue)H.push(new A({objectType:"range",minValue:e.minValue,maxValue:c.maxValue}));else{M=e.minValue>c.minValue?e.minValue:c.minValue;if(e.maxValue<c.maxValue){H.push(new A({objectType:"range",minValue:M,maxValue:e.maxValue}));break}H.push(new A({objectType:"range",minValue:M,maxValue:c.maxValue}))}}y=H}else y=N(M,y);return y}async function P(M,y,H){return b(`${M}/${y}/fieldgroups`,{responseType:"json",query:{f:"json"},...H}).then(h=>h.data.fieldGroups??
[])}async function z(M,y,H){return b(`${M}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([y]),f:"json"},...H}).then(h=>h.data.layerDataElements?.[0].dataElement.fieldGroups??[])}async function C(M,y){return b(M,{responseType:"json",query:{f:"json"},...y}).then(H=>H.data)}async function L(M,y,H){return b(`${M}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([y]),f:"json"},...H}).then(h=>h.data.contingentValueSets?.[0])}async function S(M,y,H){return b(`${M}/${y}/contingentValues`,
{responseType:"json",query:{f:"json"},...H}).then(h=>h.data)}function r(M,y){return(M=M.domains)?([,M]=Object.entries(M).find(([H])=>H.trim().toLowerCase()===y.trim().toLowerCase())||[],M||null):null}var J;m=J=class extends m.JSONSupportMixin(p){constructor(M){super(M);this.request=b;this.fieldGroupDefinitions=this.fieldGroups=null}initialize(){}get subtypeFieldName(){return w.getNormalizedFeatureTypeInfo(this.layer).typeFieldName}static async createLoadedLayerContingentValuesCache(M){await M.load();
if(void 0===M.layerId)return null;var y=M.sourceJSON.hasContingentValuesDefinition;if(y)return(new J({layer:M})).load();if(void 0===y){y=f.parse(M.url);if(null==y)return null;y=y.url.path;if((await C(y)).supportsQueryDataElements&&(y=await z(y,M.layerId.toString())))return y=y.map(H=>({name:H.name,isEditingRestrictive:H.isEditingRestrictive,fields:H.fieldNames.names.map(h=>M.fieldsIndex.normalizeFieldName(h))})),(new J({layer:M,fieldGroupDefinitions:y})).load()}return null}async load(M){const y=this.layer.load(M).then(()=>
this._initializeContingentValues(this.fieldGroupDefinitions,M));this.addResolvingPromise(y);return this}validateContingencyConstraints(M,y){const H=Object.keys(M),h=[],e=[];for(const g of this.fieldGroups){const F=g.isEditingRestrictive?"error":"warning";if(y&&!g.fields.some(R=>y.includes(R)))continue;if(!g.fields.every(R=>H.includes(R))){e.push(new t({fieldGroup:g,type:F}));continue}let I=!1;const O=M[this.subtypeFieldName];var c=g.contingencies.filter(R=>!R.isRetired&&R.subtype?R.subtype.code===
O:!0);if(0!==c.length){for(const R of c){c=!0;for(const W in R.values){const V=R.values[W];if("any"!==V.objectType)if("null"===V.objectType){if(null!=M[W]){c=!1;break}}else if("code"===V.objectType){if(M[W]!==V.codedValue.code){c=!1;break}}else if("range"===V.objectType){const aa=M[W];if(aa<V.minValue||aa>V.maxValue){c=!1;break}}}if(c){I=!0;break}}I||h.push(new t({fieldGroup:g,type:F}))}}return{invalid:h,incomplete:e}}getContingentValues(M,y,H=!1){const h=M[this.subtypeFieldName],e=void 0!==h&&null!==
h,c={};let g=[];const F=this.fieldGroups.filter(O=>O.fields.includes(y));g.push(new A({objectType:"any"}));for(const O of F){let R=[];var I=O.contingencies.filter(aa=>!aa.isRetired&&(aa.subtype&&e?aa.subtype.code===h:!0));let W=!1;const V={};for(const aa of I){let fa;I=!0;for(const ja in aa.values){const da=aa.values[ja];if(y===ja)fa=da,W=W||"range"===da.objectType;else if(void 0!==M[ja]&&"any"!==da.objectType)if("null"===da.objectType)null!==M[ja]&&(I=!1);else if("code"===da.objectType)M[ja]!==da.codedValue.code&&
(I=!1);else if("range"===da.objectType){const Z=M[ja];if(Z<da.minValue||Z>da.maxValue)I=!1}}if(fa&&I){if("any"===fa.objectType){R.length=0;R.push(fa);break}I=D(fa);V[I]||R.push(fa);V[I]=!0}}W&&(R=K(R));c[O.name]=R;g=H?G(g,R):[]}1===F.length&&H&&(g=[]);return new x({contingentValuesAllGroups:g,contingentValuesByFieldGroup:c})}async _initializeContingentValues(M,y){M=M??await this._fetchFieldGroupDefs(y);this.fieldGroups=0===M.length?[]:await this._fetchContingentValues(M,y)}async _fetchFieldGroupDefs(M){if(void 0===
this.layer.layerId)return[];const y=this.layer.sourceJSON,H=this.layer.layerId.toString(),h=f.parse(this.layer.url).url.path;return y.hasContingentValuesDefinition?(await P(h,H,M)).map(e=>({name:e.name,isEditingRestrictive:e.restrictive,fields:e.fields.map(c=>this.layer.fieldsIndex.normalizeFieldName(c))})):void 0!==y.hasContingentValuesDefinition?[]:C(h,M).then(async e=>e.supportsQueryDataElements?(await z(h,H,M)).map(c=>({name:c.name,isEditingRestrictive:c.isEditingRestrictive,fields:c.fieldNames.names.map(g=>
this.layer.fieldsIndex.normalizeFieldName(g))})):[])}async _fetchContingentValues(M,y){if(void 0===this.layer.layerId)return[];const H=this.layer.sourceJSON,h=this.layer.layerId.toString(),e=f.parse(this.layer.url).url.path;if(H.hasContingentValuesDefinition)return y=await S(e,h,y),this._constructFieldGroupsAGOL(M,y);y=await L(e,h,y);return this._constructFieldGroupsEnterprise(M,y)}_constructFieldGroupsAGOL(M,y){return M.map(H=>{const h=y.contingentValuesDefinition.fieldGroups.find(e=>e.name===H.name);
if(h){let e=[];e=y.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(H,y,h.subTypes):this._parseAGOLFieldGroup(H,y,h.contingentValues);return new v({name:H.name,isEditingRestrictive:H.isEditingRestrictive,fields:H.fields,contingencies:e})}return null}).filter(d.isSome)}_parseAGOLFieldGroupSubtype(M,y,H){let h=[];H?.forEach(e=>{const c=this._getSubtypeAGOL(e.name);h=h.concat(this._parseAGOLFieldGroup(M,y,e.contingentValues,c))});return h}_parseAGOLFieldGroup(M,y,H,h=null){const e=
[];for(const c of H??[])H=this._parseAGOLContingency(c,M,y,h),e.push(H);return e}_parseAGOLContingency(M,y,H,h){const e=M.id,c=M.retired?1===M.retired:!1,g={};for(let I=0,O=0;I<y.fields.length;I++){const R=y.fields[I];var F=H.typeCodes[M.types[I]];if("Code"===F){let W=M.values[O];O++;const V=this._getDomain(h,R);"string"===this.layer.getField(R)?.type&&(F=H.stringDicts.find(aa=>aa.domain===V?.name))&&(W=F.entries[W]);F=V?.codedValues.find(aa=>aa.code===W);F=new A({codedValue:F,objectType:"code"});
g[R]=F}else"Range"===F?(F=M.values[O],O++,F=new A({minValue:F.range[0],maxValue:F.range[1],objectType:"range"}),g[R]=F):"Any"===F?(F=new A({objectType:"any"}),g[R]=F):(F=new A({objectType:"null"}),g[R]=F)}return new u({id:e,isRetired:c,subtype:h,values:g})}_constructFieldGroupsEnterprise(M,y){const H=y.fieldGroups;return M.map(h=>{var e=H.find(c=>c.name===h.name);return e?(e=e.contingencies.map(c=>{const g=c.id,F=c.isRetired||!1,I=this._getSubtypeEnterprise(c.subtypeCode),O={};for(let W=0;W<h.fields.length;W++){const V=
h.fields[W];let aa=c.values[W];if("number"===typeof aa||"string"===typeof aa){var R=this._getDomain(I,V);const fa=this.layer.getField(V);B.isStringField(fa)?aa=y.stringDictionary[aa]:B.isDateField(fa)&&(aa=(new Date(`${aa}+00:00`)).getTime());R=R?.codedValues.find(ja=>ja.code===aa);R=new A({codedValue:R,objectType:"code"});O[V]=R}else"object"===typeof aa?(R=new A({minValue:aa.minValue,maxValue:aa.maxValue,objectType:"range"}),O[V]=R):aa?(R=new A({objectType:"any"}),O[V]=R):(R=new A({objectType:"null"}),
O[V]=R)}return new u({id:g,isRetired:F,subtype:I,values:O})}),new v({name:h.name,isEditingRestrictive:h.isEditingRestrictive,fields:h.fields,contingencies:e})):null}).filter(d.isSome)}_getSubtypeEnterprise(M){var y=this.layer.sourceJSON;let H;y.subtypes&&(y=y.subtypes.find(h=>h.code===M),H=n.fromJSON(y));return H||null}_getSubtypeAGOL(M){var y=this.layer.sourceJSON;let H;y.subtypes&&(y=y.subtypes.find(h=>h.name===M),H=n.fromJSON(y));return H||null}_getDomain(M,y){M=M?r(M,y):this.layer.getFieldDomain(y);
return"inherited"===M?.type?this.layer.getFieldDomain(y):M}};a.__decorate([l.property({constructOnly:!0})],m.prototype,"layer",void 0);a.__decorate([l.property({constructOnly:!0})],m.prototype,"request",void 0);a.__decorate([l.property({type:[v]})],m.prototype,"fieldGroups",void 0);a.__decorate([l.property({constructOnly:!0})],m.prototype,"fieldGroupDefinitions",void 0);a.__decorate([l.property()],m.prototype,"subtypeFieldName",null);return m=J=a.__decorate([q.subclass("esri.layers.support.LayerContingentValuesCache")],
m)})},"esri/layers/support/Contingency":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.isRetired=!1}};a.__decorate([d.property()],b.prototype,"id",void 0);a.__decorate([d.property()],b.prototype,"isRetired",void 0);a.__decorate([d.property()],b.prototype,
"subtype",void 0);a.__decorate([d.property()],b.prototype,"values",void 0);return b=a.__decorate([k.subclass("esri.layers.support.Contingency")],b)})},"esri/layers/support/ContingencyConstraintViolation":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E)}};a.__decorate([d.property()],
b.prototype,"fieldGroup",void 0);a.__decorate([d.property()],b.prototype,"type",void 0);return b=a.__decorate([k.subclass("esri.layers.support.ContingencyConstraintViolation")],b)})},"esri/layers/support/ContingentValuesResult":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E)}};
a.__decorate([d.property()],b.prototype,"contingentValuesAllGroups",void 0);a.__decorate([d.property()],b.prototype,"contingentValuesByFieldGroup",void 0);return b=a.__decorate([k.subclass("esri.layers.support.ContingentValuesResult")],b)})},"esri/layers/support/FieldGroup":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,
b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.fields=null;this.isEditingRestrictive=!1}};a.__decorate([d.property()],b.prototype,"name",void 0);a.__decorate([d.property()],b.prototype,"fields",void 0);a.__decorate([d.property()],b.prototype,"isEditingRestrictive",void 0);a.__decorate([d.property()],b.prototype,"contingencies",void 0);return b=a.__decorate([k.subclass("esri.layers.support.FieldGroup")],b)})},"esri/widgets/FeatureForm/FieldInput":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../Feature/support/featureUtils ./EditableInput ./featureFormUtils ../support/dataUtils ../support/dateUtils ../support/forms/formUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){p=class extends A{constructor(w){super(w);this.error=this._storedValue=null;this.preservesValueWhenHidden=!0;this.requiredExpressionExecutor=this.group=this.field=null;this.type="field";this._fieldInputWasVisibleDuringLifetime=!1;this.valueExpressionExecutor=null}initialize(){this.addHandles(d.watch(()=>this.feature,()=>this._fieldInputWasVisibleDuringLifetime=!1,d.sync))}get _dateFormRange(){const {element:w,field:D}=this;if("date"!==this.dataType)return{};
const K=w?.domain?q.getDomainRange(D,w.domain):null;if(!w?.input)return K??{};var N=w.input,{type:G}=N;let P={};if("date-picker"===G||"time-picker"===G||"datetimeoffset-picker"===G)P=q.dateTimeFieldValuesToNumericRange(D,N.max,N.min);if("datetime-picker"===G){const {max:L,min:S}=N;P={max:null!=L&&L&&!Number.isNaN(L.valueOf())?L.getTime():null,min:null!=S&&S&&!Number.isNaN(S.valueOf())?S.getTime():null}}const {max:z,min:C}=P;if(K){const {max:L,min:S}=K;N=v.isNumber(L)&&(null==z||null!=z&&L<z);G=v.isNumber(S)&&
(null==C||null!=C&&S>C);return{max:N?L:z??null,min:G?S:C??null,rawMax:N?K.rawMax:P?.rawMax??null,rawMin:G?K.rawMin:P?.rawMin??null}}return{min:C,max:z,rawMax:P?.rawMax??null,rawMin:P?.rawMin??null}}get _dateRange(){const {_dateFormRange:w,field:D}=this;if("date"!==this.dataType)return{};var K=q.getDomainRange(D);if(!K)return w;const {max:N,min:G,rawMax:P,rawMin:z}=w;if("date"===D.type){const {max:C,min:L}=K;return{max:v.isNumber(N)&&(null===C||null!=C&&N<C)?N:C??null,min:v.isNumber(G)&&(null===L||
null!=L&&G>L)?G:L??null}}if("date-only"===D.type||"time-only"===D.type||"timestamp-offset"===D.type){const {max:C,min:L,rawMax:S,rawMin:r}=K;K=v.isNumber(N)&&P&&(null==C||N<C);const J=v.isNumber(G)&&z&&(null==L||G>L);return{max:K?N:C,min:J?G:L,rawMax:K?P:S,rawMin:K?z:r}}return{max:null,min:null}}get _configAllowsEdits(){const {element:w,layer:D,name:K}=this;return null!=w?w.editableExpression?!!this.evaluatedEditableExpression:!1!==w.editable:D?.userHasUpdateItemPrivileges?!0:(D&&"popupTemplate"in
D?D?.popupTemplate?.fieldInfos?.find(({fieldName:N})=>N===K):null)?.isEditable??!0}get _layerAndFieldAllowEdits(){return this.layerAllowsEdits&&this.field?.editable}get _isVisibleByDefault(){const {field:w,layer:D}=this;return!!w?.visible&&f.isFieldVisibleByDefault(w,D)}get _isEditTrackingField(){return f.getLowerCaseEditTrackingFields(this.layer).includes(this.name?.toLowerCase())}get _shouldUseValueExpression(){return this._layerAndFieldAllowEdits&&!this._configAllowsEdits&&null!=this.valueExpressionExecutor}get isSubtypeField(){const {layer:w}=
this;if(w&&"subtypeField"in w){const {subtypeField:D,fieldsIndex:K}=w;return(K.get(D)?.name??D)===this.name}return!1}get valueIsOutOfDomain(){const {domain:w,value:D,field:K}=this;return w&&null!=D?null!==q.validateDomainValue(K,D,w):!1}get dataType(){const {field:w}=this;return f.isNumericField(w)?n.FieldInputDataTypes.Number:f.isStringField(w)?n.FieldInputDataTypes.Text:u.isAnyDateField(w)||f.isTimeOnlyField(w)?n.FieldInputDataTypes.Date:n.FieldInputDataTypes.Unsupported}get dateDataType(){if(this.dataType===
n.FieldInputDataTypes.Date)return"date"!==this.field.type?"string":"number"}get domain(){const {layer:w,feature:D,name:K,element:N}=this,G=N?.domain;return null!=G&&this._isDomainCompatible(G)?G:w.getFieldDomain(K,{feature:D})}get editable(){return this._layerAndFieldAllowEdits?this.evaluatedEditableExpression??this._configAllowsEdits:!1}get evaluatedRequiredExpression(){const {requiredExpressionExecutor:w}=this;return null!=w?!!w.lastEvaluatedValue:null}get evaluatedValueExpression(){const {valueExpressionExecutor:w}=
this;return null!=w?w.lastEvaluatedValue:null}get hint(){return this.element?.hint}get includeDate(){return!(this.dataType!==n.FieldInputDataTypes.Date||"time-only"===this.field.type)}get includeTime(){const {element:w,field:D}=this;if(this.dataType!==n.FieldInputDataTypes.Date)return!1;if("time-only"===D.type)return!0;if("date-only"===D.type)return!1;const K="datetime-picker"===w?.input?.type?w.input.includeTime:void 0;return void 0===K||K}get includeTimeOffset(){if("timestamp-offset"!==this.field.type)return!1;
const w=this.element?.input;return w?"datetimeoffset-picker"===w.type&&w.includeTimeOffset:!0}set initialFeature(w){this._set("initialFeature",w);this.notifyChange("valid")}get inputType(){return this.element?.input?.type}get hasInvalidSwitchValue(){var {element:w}=this;w=x.isFieldElementWithInputType(w,"switch")?w.input:null;return!w||x.valueIsInvalidSwitchValue(this.value,w)}get isRelationshipKeyField(){const {field:w,layer:D}=this;return t.isRelatableFeatureSupportedLayer(D)&&!!D.relationships?.some(K=>
K.keyField===w.name)}get label(){const {field:w}=this;return this.getFormattedLabel(this.element?.label)??w.alias??w.name}get maxLength(){if(this.dataType===n.FieldInputDataTypes.Date)return-1;const {field:w,element:D}=this,K=w?.length??-1,N=x.isFieldElementWithTextInput(D)?D.input.maxLength:NaN;return null!=N&&!isNaN(N)&&-1<=N&&(-1===K||N<=K)?N:K}get minLength(){if(this.dataType===n.FieldInputDataTypes.Date)return-1;const {field:w,element:D}=this,K=w?.length??-1,N=x.isFieldElementWithTextInput(D)?
D.input.minLength:NaN;return null!=N&&!isNaN(N)&&-1<=N&&(-1===K||N<=K)?N:-1}get name(){return this.field?.name}get range(){const {domain:w,element:D,field:K}=this;if("date"===this.dataType)return this._dateRange;var N=q.getDomainRange(K,w)||f.getFieldRange(K,w);const G=N?.max===Number.MAX_VALUE?null:N?.max??null;N=N?.min===-Number.MAX_VALUE?null:N?.min??null;if(!D?.domain||"range"!==D.domain.type)return{max:G,min:N};const {max:P,min:z}=q.getDomainRange(K)||{};return{max:null!=P&&(null===G||null!=
G&&P<G)?P:G,min:null!=z&&(null===N||null!=N&&z>N)?z:N}}get required(){const {editable:w,evaluatedRequiredExpression:D,field:K,visible:N,isSubtypeField:G}=this;return w?!1===K?.nullable||G?!0:N&&!1!==this.group?.visible&&null!=D?D:!1:!1}set required(w){this._overrideIfSome("required",w)}get showNoValueOptionEnabled(){const {element:w}=this;return this.required?!1:x.isFieldElementWithShowNoValueOptionInput(w)?w.input.showNoValueOption:!0}get showNoValueLabel(){const {element:w}=this;return x.isFieldElementWithShowNoValueOptionInput(w)?
w.input.noValueOptionLabel:null}get submittable(){const {field:w,required:D,valid:K,value:N}=this;return D&&null==N?!1:K?!0:this.initialFeature.getAttribute(w.name)===N}get timeResolution(){const w=this.element?.input;if(w&&("datetimeoffset-picker"===w.type||"time-picker"===w.type))return w.timeResolution??"minutes"}get timeStep(){return null!=this.timeResolution?B.timeResolutionToStepMap.get(this.timeResolution):void 0}get updating(){const {editableExpressionExecutor:w,valueExpressionExecutor:D,
visibilityExpressionExecutor:K,preservesValueWhenHidden:N}=this;return null!=D&&D.updating||null!=w&&w.updating||!1===N&&null!=K&&K.updating}get valid(){const w=this.editable?this._validate():null;this._set("error",w);return null===w}get value(){this._fieldInputWasVisibleDuringLifetime=this._fieldInputWasVisibleDuringLifetime||this.visible&&!1!==this.group?.visible;if(!1===this.preservesValueWhenHidden&&this._fieldInputWasVisibleDuringLifetime&&(!1===this.visibilityExpressionExecutor?.lastEvaluatedValue||
!1===this.group?.visibilityExpressionExecutor?.lastEvaluatedValue))return null!==this._storedValue&&this.set("_storedValue",null),null;if(this._shouldUseValueExpression){const w=this.evaluatedValueExpression;return this.dataType===n.FieldInputDataTypes.Date?this._arcadeOutputToDateFieldValue(w):null!=w&&"object"===typeof w?w.toString():w}return this._storedValue}set value(w){this.notifyChange("evaluatedVisibilityExpression");this.set("_storedValue",w)}get visible(){return this._isEditTrackingField?
!1:null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element&&!1!==this.field?.visible?!0:this._isVisibleByDefault}_arcadeOutputToDateFieldValue(w){const D=this.field.type;try{if("object"===typeof w){if(null!==w){if(B.isArcadeDate(w))return B.arcadeDateToFieldValue(w,D);if("getTime"in w&&"function"===typeof w.getTime&&"date"===D)return parseInt(w.getTime(),10);if("date-only"===D||"time-only"===D||"timestamp-offset"===D)return w.toString()}}else{if("string"===typeof w)return"date"===
D?parseInt(w,10):w;if("number"===typeof w&&"date"===D)return w}throw new b("feature-form:invalid-date-value");}catch{return"date"===D?NaN:""}}_isDomainCompatible(w){const {field:D}=this;if("coded-value"===w?.type){const K=typeof w.codedValues[0].code;if("string"===K&&f.isStringField(D)||"number"===K&&f.isNumericField(D))return!0}return"range"===w?.type&&f.isNumericField(D)||u.isAnyDateField(D)||f.isTimeOnlyField(D)?!0:!1}_validate(){const {dataType:w,domain:D,field:K,initialFeature:N,minLength:G,
range:P,required:z,valid:C,value:L,maxLength:S}=this,r=z&&null==L,J=void 0!==C;if(!r&&N.getAttribute(K.name)===L&&J)return null;if(r)return f.TypeValidationError.INVALID_TYPE;if("text"===w&&"string"===typeof L){if(-1<G&&L.length<G)return x.LengthValidationError.TOO_SHORT;if(-1<S&&L.length>S)return x.LengthValidationError.TOO_LONG}return"date"!==w||null==L||B.dateTimeIsInRange({type:K.type,range:P,value:L})?D?null!==L||z?q.validateDomainValue(K,L,D):null:f.validateFieldValue(K,L):f.NumericRangeValidationError.OUT_OF_RANGE}};
a.__decorate([m.property()],p.prototype,"_dateFormRange",null);a.__decorate([m.property()],p.prototype,"_dateRange",null);a.__decorate([m.property()],p.prototype,"_storedValue",void 0);a.__decorate([m.property()],p.prototype,"_configAllowsEdits",null);a.__decorate([m.property()],p.prototype,"_layerAndFieldAllowEdits",null);a.__decorate([m.property()],p.prototype,"_isVisibleByDefault",null);a.__decorate([m.property()],p.prototype,"_isEditTrackingField",null);a.__decorate([m.property()],p.prototype,
"_shouldUseValueExpression",null);a.__decorate([m.property()],p.prototype,"isSubtypeField",null);a.__decorate([m.property()],p.prototype,"valueIsOutOfDomain",null);a.__decorate([m.property()],p.prototype,"dataType",null);a.__decorate([m.property()],p.prototype,"dateDataType",null);a.__decorate([m.property()],p.prototype,"domain",null);a.__decorate([m.property()],p.prototype,"editable",null);a.__decorate([m.property({readOnly:!0})],p.prototype,"error",void 0);a.__decorate([m.property({constructOnly:!0})],
p.prototype,"preservesValueWhenHidden",void 0);a.__decorate([m.property()],p.prototype,"evaluatedRequiredExpression",null);a.__decorate([m.property()],p.prototype,"evaluatedValueExpression",null);a.__decorate([m.property()],p.prototype,"field",void 0);a.__decorate([m.property()],p.prototype,"group",void 0);a.__decorate([m.property({readOnly:!0})],p.prototype,"hint",null);a.__decorate([m.property()],p.prototype,"includeDate",null);a.__decorate([m.property()],p.prototype,"includeTime",null);a.__decorate([m.property()],
p.prototype,"includeTimeOffset",null);a.__decorate([m.property()],p.prototype,"initialFeature",null);a.__decorate([m.property({readOnly:!0})],p.prototype,"inputType",null);a.__decorate([m.property()],p.prototype,"hasInvalidSwitchValue",null);a.__decorate([m.property()],p.prototype,"isRelationshipKeyField",null);a.__decorate([m.property()],p.prototype,"label",null);a.__decorate([m.property()],p.prototype,"maxLength",null);a.__decorate([m.property()],p.prototype,"minLength",null);a.__decorate([m.property({readOnly:!0})],
p.prototype,"name",null);a.__decorate([m.property()],p.prototype,"range",null);a.__decorate([m.property()],p.prototype,"required",null);a.__decorate([m.property()],p.prototype,"requiredExpressionExecutor",void 0);a.__decorate([m.property()],p.prototype,"showNoValueOptionEnabled",null);a.__decorate([m.property()],p.prototype,"submittable",null);a.__decorate([m.property()],p.prototype,"timeResolution",null);a.__decorate([m.property()],p.prototype,"timeStep",null);a.__decorate([m.property({readOnly:!0})],
p.prototype,"type",void 0);a.__decorate([m.property()],p.prototype,"updating",null);a.__decorate([m.property()],p.prototype,"valid",null);a.__decorate([m.property({value:null})],p.prototype,"value",null);a.__decorate([m.property()],p.prototype,"valueExpressionExecutor",void 0);a.__decorate([m.property()],p.prototype,"visible",null);return p=a.__decorate([E.subclass("esri.widgets.FeatureForm.FieldInput")],p)})},"esri/widgets/FeatureForm/EditableInput":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ./InputBase ../support/forms/formUtils".split(" "),
function(a,b,d,m,p,l,k,E,q){d=class extends E{constructor(f){super(f);this.arcadeEditType="NA";this.editableExpressionExecutor=null}get editable(){return this.layerAllowsEdits?this.evaluatedEditableExpression??!0:!1}get evaluatedEditableExpression(){const {editableExpressionExecutor:f}=this;return null!=f?!!f.lastEvaluatedValue:null}get layerAllowsEdits(){var {layer:f}=this;if(!f)return!1;var u=k.getEffectiveLayerCapabilities(f);f=u?.operations.supportsEditing;u=q.capabilitiesAllowEditType(u,this.arcadeEditType);
return!(!f||!u)}};a.__decorate([b.property()],d.prototype,"arcadeEditType",void 0);a.__decorate([b.property()],d.prototype,"editable",null);a.__decorate([b.property()],d.prototype,"editableExpressionExecutor",void 0);a.__decorate([b.property()],d.prototype,"evaluatedEditableExpression",null);a.__decorate([b.property()],d.prototype,"layerAllowsEdits",null);return d=a.__decorate([l.subclass("esri.widgets.FeatureForm.EditableInput")],d)})},"esri/widgets/FeatureForm/InputBase":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./featureFormUtils".split(" "),
function(a,b,d,m,p,l,k,E){b=class extends b{constructor(q){super(q);this.visibilityExpressionExecutor=this.type=this.timeZone=this.layer=this.feature=this.element=null}get description(){return this.getFormattedLabel(this.element?.description)}get evaluatedVisibilityExpression(){const {visibilityExpressionExecutor:q}=this;return null!=q?!!q.lastEvaluatedValue:null}get label(){return this.getFormattedLabel(this.element?.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?
this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(q){const {feature:f,layer:u,timeZone:t}=this;return null==u||null==q?q:E.parseFormTemplateString({label:q,attributes:f.attributes,fieldsIndex:u.fieldsIndex,timeZone:t})}};a.__decorate([d.property({readOnly:!0})],b.prototype,"description",null);a.__decorate([d.property({constructOnly:!0})],b.prototype,"element",void 0);a.__decorate([d.property()],b.prototype,"evaluatedVisibilityExpression",null);a.__decorate([d.property()],b.prototype,
"feature",void 0);a.__decorate([d.property()],b.prototype,"label",null);a.__decorate([d.property()],b.prototype,"layer",void 0);a.__decorate([d.property()],b.prototype,"timeZone",void 0);a.__decorate([d.property()],b.prototype,"type",void 0);a.__decorate([d.property()],b.prototype,"updating",null);a.__decorate([d.property()],b.prototype,"visible",null);a.__decorate([d.property()],b.prototype,"visibilityExpressionExecutor",void 0);return b=a.__decorate([k.subclass("esri.widgets.FeatureForm.InputBase")],
b)})},"esri/widgets/support/forms/formUtils":function(){define(["exports"],function(a){a.FieldInputDataTypes=void 0;(function(b){b.Text="text";b.Number="number";b.Date="date";b.Unsupported="unsupported"})(a.FieldInputDataTypes||(a.FieldInputDataTypes={}));a.capabilitiesAllowEditType=(b,d)=>{if(!b)return!0;({operations:b}=b);switch(d){case "INSERT":return b.supportsAdd;case "UPDATE":case "DELETE":return b.supportsUpdate;default:return!0}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/FeatureForm/FormExpressionArcadeExecutor":function(){define("exports ../../chunks/tslib.es6 ../../arcade ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/support/fieldUtils".split(" "),function(a,b,d,m,p,l,k,E,q,f,u,t){k=Symbol("FormExpressionArcadeExecutor");a.FormExpressionArcadeExecutor=class extends m{constructor(x){super(x);
this[A]=!0;this._lastEvaluatedValue=null;this._abortController=new AbortController;this._stale=!1;this._updatingTracking=new u.UpdatingHandles;this._executeAsyncDebounced=p.debounce(async(v,B,n)=>{v=await this.executor.executeAsync(v,{...B,abortSignal:n});if(n.aborted)return this._lastEvaluatedValue;this._lastEvaluatedValue=v;this._stale=!1;return v})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(x,
v){this._abortController=new AbortController;return this._lastEvaluatedValue=x=this.executor.execute(x,{...v,abortSignal:this._abortController.signal})}async executeAsync(x,v){this._abortController=new AbortController;return this._updatingTracking.addPromise(this._executeAsyncDebounced(x,v??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort();this._lastEvaluatedValue=null;this._stale=!1}};var A=k;b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"_lastEvaluatedValue",
void 0);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"_stale",void 0);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"_updatingTracking",void 0);b.__decorate([l.property({constructOnly:!0})],a.FormExpressionArcadeExecutor.prototype,"executor",void 0);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"isAsync",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"fieldsUsed",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,
"syntaxTree",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"updating",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"stale",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"geometryUsed",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"variablesUsed",null);b.__decorate([l.property()],a.FormExpressionArcadeExecutor.prototype,"lastEvaluatedValue",null);a.FormExpressionArcadeExecutor=b.__decorate([f.subclass("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],
a.FormExpressionArcadeExecutor);a.createFormExpressionArcadeExecutor=async(x,v)=>{const B=d.createArcadeProfile("form-calculation");x=await d.createArcadeExecutor(x,B,{});v?.fieldsIndex&&(x.fieldsUsed=t.fixFields(v.fieldsIndex,x.fieldsUsed));return new a.FormExpressionArcadeExecutor({executor:x})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade":function(){define("exports ./Graphic ./arcade/ArcadeDate ./arcade/ImmutableArray ./core/Error ./core/lang ./core/sql/DateOnly ./core/sql/TimeOnly ./layers/FeatureLayer ./portal/Portal ./rest/support/FeatureSet ./support/arcadeOnDemand".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t){function A(C,L,S,r={}){L=L.elementType;const J="array"===L.type?[{name:"value",type:L.type,elementType:L.elementType}]:"dictionary"===L.type?[{name:"value",type:L.type,properties:L.properties}]:[{name:"value",type:L.type}];return new m(C.map(M=>{const y={};n(y,J,{value:M},S,r);return y.value}))}function x(C,L,S={}){C=C instanceof u?new q({source:C.features,geometryType:C.geometryType,fields:C.fields,spatialReference:C.spatialReference}):C;return L.constructFeatureSet(C,
S.spatialReference,null,!0,S.lruCache,S.interceptor)}function v(C,L,S={}){const {spatialReference:r,interceptor:J,lruCache:M}=S;return"string"===typeof C?L.createFeatureSetCollectionFromService(C,r,M,J):L.createFeatureSetCollectionFromMap(C,r,M,J)}function B(C,L,S,r={}){const J={};n(J,L.properties,C,S,r);return new N.Dictionary(J)}function n(C,L,S,r,J={}){const M={};for(const y of Object.keys(S))M[y.toLowerCase()]=S[y];for(const y of L)if(L=y.name.toLowerCase(),J.variablesPreProcessed)C[L]=M[L];else switch(y.type){case "array":S=
M[L];C[L]=null==S?null:A(S,y,r,J);break;case "feature":S=M[L];C[L]=null==S?null:N.Feature.createFromGraphic(S,J?.timeZone);break;case "featureSet":S=M[L];C[L]=null==S?null:r?x(S,r,J):null;break;case "featureSetCollection":S=M[L];C[L]=null==S?null:r?v(S,r,J):null;break;case "dictionary":S=M[L];C[L]=null==S?null:B(S,y,r,J);break;case "date":S=M[L];C[L]=S?S instanceof d.ArcadeDate?S:J?.timeZone?d.ArcadeDate.dateJSAndZoneToArcadeDate(S,J?.timeZone):d.ArcadeDate.dateJSToArcadeDate(S):null;break;case "dateOnly":S=
M[L];C[L]=S?S instanceof k.DateOnly?S:k.DateOnly.fromReader(S):null;break;case "time":S=M[L];C[L]=S?S instanceof E.TimeOnly?S:E.TimeOnly.fromReader(S):null;break;case "knowledgeGraph":case "geometry":case "boolean":case "text":case "number":C[L]=M[L]}}function w(C,L){for(const S of C)L.push(S),"dictionary"===S.type&&w(S.properties,L);return L}function D(C,L,S,r,J){const {spatialReference:M,interceptor:y,lruCache:H,console:h,abortSignal:e,timeZone:c,services:g={portal:f.getDefault()}}=S;J={vars:{},
spatialReference:M,interceptor:y,timeZone:c,lrucache:H,useAsync:J,services:g,console:h,abortSignal:e};if(!L)return J;n(J.vars,C.variables,L,r,S);return J}function K(C,L){switch(L.getArcadeType(C)){case "date":return C.toJSDate();case "time":return C.toString();case "dateOnly":return C.toString();case "feature":var S="geometry"in C?C.geometry():null;C="readAttributes"in C?C.readAttributes():C.attributes;return new b({geometry:S,attributes:C});case "dictionary":S=C.attributes;const r={};for(const J of Object.keys(S))r[J]=
K(C.field(J),L);return r;case "array":return("toArray"in C?C.toArray():C).map(J=>K(J,L))}return C}let N=null;const G={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$userInput",type:"geometry"},{name:"$graph",type:"knowledgeGraph"}]},P={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},z=new Map([["aggregate-field",{variables:[{name:"$feature",
type:"feature"}]}],["form-constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",
type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",G],["popup-element",G],["feature-reduction-popup",P],["feature-reduction-popup-element",P],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);a.createArcadeExecutor=async function(C,L,S={}){N||=await t.loadArcade();const {arcade:r,
arcadeUtils:J}=N,{loadScriptDependencies:M,referencesMember:y,scriptIsAsync:H}=r;var h=w(L.variables,[]),e=h.filter(V=>"featureSet"===V.type||"featureSetCollection"===V.type).map(V=>V.name.toLowerCase());const c=r.parseScript(C,e);if(!c)throw new p("arcade:invalid-script","Unable to create SyntaxTree");C=J.extractFieldNames(c);const g=r.scriptTouchesGeometry(c);h=h.map(V=>V.name.toLowerCase()).filter(V=>y(c,V));const F=H(c,e);await M(c,F,e);e={vars:{},spatialReference:null,useAsync:F};for(const V of h)e.vars[V]=
"any";const {lruCache:I}=S,O=r.compileScript(c,e),R=r.featureSetUtils(),{services:W}=S;return{execute:(V,aa={})=>{if(F)throw new p("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");V=O(D(L,V,{lruCache:I,...aa},R,F));return aa.rawOutput?V:K(V,J)},executeAsync:async(V,aa={})=>{V=await O(D(L,V,{lruCache:I,services:W,...aa},R,F));return aa.rawOutput?V:K(V,J)},isAsync:F,variablesUsed:h,fieldsUsed:C,geometryUsed:g,syntaxTree:c}};a.createArcadeProfile=function(C){var L=z.get(C);
if(!L)throw L=Array.from(z.keys()).map(S=>`'${S}'`).join(", "),new p("createArcadeProfile:invalid-profile-name",`Invalid profile name '${C}'. You must specify one of the following values: ${L}`);return l.clone(L)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(a,b,d,m){function p(f,u,t){return f<u?f-u:f>t?f-t:0}function l(f,u=!0){if(f instanceof m.Zone)return f;
if("system"===f.toLowerCase())return"system";if("utc"===f.toLowerCase())return"UTC";if("unknown"===f.toLowerCase())return d.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(f)){const t=m.FixedOffsetZone.parseSpecifier("UTC"+(f.startsWith("+")||f.startsWith("-")?"":"+")+f);if(t)return t}f=m.IANAZone.create(f);if(!f.isValid){if(u)throw new E(a.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return f}a.ArcadeDateErrorCodes=void 0;(a.ArcadeDateErrorCodes||(a.ArcadeDateErrorCodes=
{})).TimeZoneNotRecognized="TimeZoneNotRecognized";const k={[a.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class E extends Error{constructor(f,u){super(b.replace(k[f],u));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,E)}}class q{constructor(f){this._date=f;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(f=0,u=1,t=1,A=0,x=0,v=0,B=0,n){if(isNaN(f)||isNaN(u)||isNaN(t)||isNaN(A)||
isNaN(x)||isNaN(v)||isNaN(B))return null;const w=m.DateTime.local(f,u).daysInMonth;f=m.DateTime.fromObject({day:1>t?1:t>w?w:t,year:f,month:1>u?1:12<u?12:u,hour:0>A?0:23<A?23:A,minute:0>x?0:59<x?59:x,second:0>v?0:59<v?59:v,millisecond:0>B?0:999<B?999:B},{zone:l(n)});f=f.plus({months:p(u,1,12),days:p(t,1,w),hours:p(A,0,23),minutes:p(x,0,59),seconds:p(v,0,59),milliseconds:p(B,0,999)});return new q(f)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(f,
u){u=l(u);return f.isUnknownTimeZone||u===d.UnknownTimeZone.instance?q.fromParts(f.year,f.monthJS+1,f.day,f.hour,f.minute,f.second,f.millisecond,u):new q(f._date.setZone(u))}static dateJSToArcadeDate(f){return new q(m.DateTime.fromJSDate(f,{zone:"system"}))}static dateJSAndZoneToArcadeDate(f,u="system"){u=l(u);return new q(m.DateTime.fromJSDate(f,{zone:u}))}static unknownEpochToArcadeDate(f){return new q(m.DateTime.fromMillis(f,{zone:d.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(f){return new q(m.DateTime.fromMillis(f.getTime(),
{zone:d.UnknownTimeZone.instance}))}static epochToArcadeDate(f,u="system"){u=l(u);return new q(m.DateTime.fromMillis(f,{zone:u}))}static dateTimeToArcadeDate(f){return new q(f)}clone(){return new q(this._date)}changeTimeZone(f){f=l(f);return q.dateTimeToArcadeDate(this._date.setZone(f))}static dateTimeAndZoneToArcadeDate(f,u){u=l(u);return f.zone===d.UnknownTimeZone.instance||u===d.UnknownTimeZone.instance?q.fromParts(f.year,f.month,f.day,f.hour,f.minute,f.second,f.millisecond,u):new q(f.setZone(u))}static nowToArcadeDate(f){f=
l(f);return new q(m.DateTime.fromJSDate(new Date,{zone:f}))}static nowUTCToArcadeDate(){return new q(m.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===q.systemTimeZoneCanonicalName}equals(f){return this.isSystem&&f.isSystem?this.toNumber()===f.toNumber():this.isUnknownTimeZone!==f.isUnknownTimeZone?!1:this._date.equals(f._date)}get isUnknownTimeZone(){return this._date.zone===d.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let f=
this._date.weekday;6<f&&(f=0);return f}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";
const f=this.zone;return"fixed"===f.type?0===f.fixed?"UTC":f.formatOffset(0,"short"):f.name}stringify(){return JSON.stringify(this.toJSDate())}plus(f){return new q(this._date.plus(f))}diff(f,u="milliseconds"){return this._date.diff(f._date,u)[u]}toISODate(){return this._date.toISODate()}toISOString(f){return f?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(f,u){return this._date.toISOTime({suppressMilliseconds:f,
includeOffset:u&&!this.isUnknownTimeZone})}toFormat(f,u){this.isUnknownTimeZone&&(f=f.replaceAll("Z",""));return this._date.toFormat(f,u)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new q(this._date.toUTC())}toLocal(){return new q(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(f){if(!f)return null;
f=m.DateTime.fromISO(f,{setZone:!0});return new q(f)}}a.ArcadeDate=q;a.ArcadeDateError=E;a.arcadeDateErrorMessages=k;a.createDateTimeZone=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ImmutableArray":function(){define(function(){class a{constructor(b=[]){this._elements=b}length(){return this._elements.length}get(b){return this._elements[b]}toArray(){return this.slice()}slice(b=0,d=this.length()){const m=[];for(;b<d;b++)m.push(this.get(b));return m}}return a})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(a,b,d,m){function p(k){k=k.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let E="";const q=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const f of k.match(q)||[])switch(f){case "D":E+="d";break;case "DD":E+="dd";break;case "DDD":E+="o";break;case "d":E+="c";break;case "ddd":E+=
"ccc";break;case "dddd":E+="cccc";break;case "M":E+="L";break;case "MM":E+="LL";break;case "MMM":E+="LLL";break;case "MMMM":E+="LLLL";break;case "YY":E+="yy";break;case "Y":case "YYYY":E+="yyyy";break;case "Q":E+="q";break;case "X":case "x":E+=f;break;default:E=2<=f.length&&"["===f.slice(0,1)&&"]"===f.slice(-1)?E+`'${f.slice(1,-1)}'`:E+`'${f}'`}return E}class l{constructor(k,E,q){this._year=k;this._month=E;this._day=q;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(k){return k instanceof l&&k.day===this.day&&k.month===this.month&&k.year===this.year}clone(){return new l(this._year,this._month,this._day)}toDateTime(k){return m.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:b.createDateTimeZone(k)})}toDateTimeLuxon(k){return m.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:b.createDateTimeZone(k)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(k=null,E=!0){if(null===k||""===k)return this.toString();E&&(k=p(k));if(!k)return"";E=this.toDateTime("unknown");return b.ArcadeDate.dateTimeToArcadeDate(E).toFormat(k,{locale:d.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const k=this.toDateTime("unknown");return b.ArcadeDate.dateTimeToArcadeDate(k)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(k,E){return l.fromDateTime(this.toUTCDateTime().plus({[k]:E}))}toUTCDateTime(){return m.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(k,E){switch(E.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(k.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(k.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
E?this.toUTCDateTime().diff(k.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(k.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(k.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(k.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(k.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(k.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(k.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(k){k=m.DateTime.fromMillis(k,{zone:m.FixedOffsetZone.utcInstance});return k.isValid?l.fromParts(k.year,k.month,k.day):null}static fromSeconds(k){k=m.DateTime.fromSeconds(k,{zone:m.FixedOffsetZone.utcInstance});return k.isValid?l.fromParts(k.year,k.month,k.day):null}static fromReader(k){if(!k)return null;k=k.split("-");return 3!==k.length?null:new l(parseInt(k[0],10),parseInt(k[1],
10),parseInt(k[2],10))}static fromParts(k,E,q){k=new l(k,E,q);return!1===k.isValid?null:k}static fromDateJS(k){return l.fromParts(k.getFullYear(),k.getMonth()+1,k.getDay())}static fromDateTime(k){return l.fromParts(k.year,k.month,k.day)}static fromSqlTimeStampOffset(k){return this.fromDateTime(k.toDateTime())}static fromString(k,E=null){if(""===k||null===k)return null;var q=[];if(E)(E=p(E))&&q.push(E);else if(null===E||""===E)return k=m.DateTime.fromISO(k,{setZone:!0}),k.isValid?l.fromParts(k.year,
k.month,k.day):null;for(const f of q)if(q=m.DateTime.fromFormat(k,E??f),q.isValid)return new l(q.year,q.month,q.day);return null}static fromNow(k="system"){k=m.DateTime.fromJSDate(new Date).setZone(b.createDateTimeZone(k));return new l(k.year,k.month,k.day)}}a.DateOnly=l;a.standardizeDateOnlyFormat=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(a,b,d,
m){function p(k){if(!k)return"";const E=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let q="";for(const f of k.match(E)||[])switch(f){case "SSS":q+=f;break;case "A":case "a":q+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":q+=f;break;default:q+=`'${f}'`}return q}class l{constructor(k,E,q,f){this._hour=k;this._minute=E;this._second=q;this._millisecond=f;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(k){return k instanceof
l&&k.hour===this.hour&&k.minute===this.minute&&k.second===this.second&&k.millisecond===this.millisecond}clone(){return new l(this.hour,this.minute,this.second,this.millisecond)}isValid(){return b.isInteger(this.hour)&&b.isInteger(this.minute)&&b.isInteger(this.second)&&b.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(k=null){return null===k||""===k?this.toString():(k=p(k))?m.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(k,{locale:d.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(k,E,q,f){k=new l(k,E,q,f);return k.isValid()?k:null}static fromReader(k){if(!k)return null;k=k.split(":");return 3!==k.length?null:new l(parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],
10),0)}static fromMilliseconds(k){return 864E5<k||0>k?null:new l(Math.floor(k/36E5%24),Math.floor(k/6E4%60),Math.floor(k/1E3%60),Math.floor(k%1E3))}static fromDateJS(k){return new l(k.getHours(),k.getMinutes(),k.getSeconds(),k.getMilliseconds())}static fromDateTime(k){return new l(k.hour,k.minute,k.second,k.millisecond)}static fromSqlTimeStampOffset(k){return this.fromDateTime(k.toDateTime())}static fromString(k,E=null){if(""===k||null===k)return null;const q=[];if(E)(E=p(E))&&q.push(E);else if(null===
E||""===E)q.push("HH:mm:ss"),q.push("HH:mm:ss.SSS"),q.push("hh:mm:ss a"),q.push("hh:mm:ss.SSS a"),q.push("HH:mm"),q.push("hh:mm a"),q.push("H:mm"),q.push("h:mm a"),q.push("H:mm:ss"),q.push("h:mm:ss a"),q.push("H:mm:ss.SSS"),q.push("h:mm:ss.SSS a");for(const f of q)if(E=m.DateTime.fromFormat(k,f),E.isValid)return new l(E.hour,E.minute,E.second,E.millisecond);return null}plus(k,E){switch(k){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return l.fromDateTime(this.toUTCDateTime().plus({[k]:E}))}return null}toUTCDateTime(){return m.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(k,E){switch(E.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(k.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(k.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===E?this.toUTCDateTime().diff(k.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(k.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(k.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(k.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(k.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(k.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(k.toUTCDateTime(),"milliseconds").milliseconds}}}a.TimeOnly=l;a.standardizeTimeFormat=p;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(a,b){a.cloneGeometry=function(d){if(null==d)return null;const m=d.clone();void 0!==d.cache._geVersion&&(m.cache._geVersion=d.cache._geVersion);return m};a.convertLinearUnitsToCode=function(d){if(null==d)return null;if("number"===typeof d)return d;d=d.toLowerCase();d=d.replaceAll(/\s/g,"");d=d.replaceAll("-","");switch(d){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};a.convertSquareUnitsToCode=
function(d){if(null==d)return null;if("number"===typeof d)return d;d=d.toLowerCase();d=d.replaceAll(/\s/g,"");d=d.replaceAll("-","");switch(d){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};a.isInteger=function(d){return"number"===typeof d&&isFinite(d)&&Math.floor(d)===d};a.sameGeomType=function(d,m){return d===m||"point"===d&&"esriGeometryPoint"===m||"polyline"===d&&"esriGeometryPolyline"===
m||"polygon"===d&&"esriGeometryPolygon"===m||"extent"===d&&"esriGeometryEnvelope"===m||"multipoint"===d&&"esriGeometryMultipoint"===m||"point"===m&&"esriGeometryPoint"===d||"polyline"===m&&"esriGeometryPolyline"===d||"polygon"===m&&"esriGeometryPolygon"===d||"extent"===m&&"esriGeometryEnvelope"===d||"multipoint"===m&&"esriGeometryMultipoint"===d?!0:!1};a.shapeExtent=function(d){if(null==d)return null;switch(d.type){case "polygon":case "multipoint":case "polyline":return d.extent;case "point":return new b({xmin:d.x,
ymin:d.y,xmax:d.x,ymax:d.y,spatialReference:d.spatialReference});case "extent":return d}return null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureForm/FormExpressionsManager":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/Logger ../../core/MapUtils ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,
d,m,p,l,k,E,q,f){a.FormExpressionsManager=class extends d{constructor(A){super(A);this._fieldReferencesLookup=new Map;this._fieldsAffectedLookup=new Map;this.preserveFieldValuesWhenHidden=!0;this._latestFieldValues={...A.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}destroy(){this.resetExecutors()}get _asyncExecutors(){return this.executors.filter(A=>A.isAsync)}get _baseContext(){const {editType:A,layer:x,map:v,originalFeature:B,spatialReference:n,timeZone:w}=
this.arcadeContextInfo,D="scene"===x?.type&&null!=x.associatedLayer?x.associatedLayer:x;return[{$originalfeature:B,$editcontext:{editType:A},$layer:D,$featureset:D,$datastore:x?.url,$map:v},{rawOutput:!0,spatialReference:n??void 0,timeZone:w}]}set feature(A){this._latestFieldValues={...A?.attributes};this._set("feature",A)}evaluateAll(){return this._evaluate(this.executors)}evaluateAsyncExpressions(){return this._evaluate(this._asyncExecutors)}evaluateExpressions(A){return this._evaluate(A)}evaluateInvalidated(A){const {_fieldReferencesLookup:x,
_latestFieldValues:v,feature:B}=this,n=new Set;for(const w of A)if(v[w]=B.getAttribute(w),x.has(w))for(const D of x.get(w))n.add(D);return this._evaluate([...n])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY"))return this._evaluate([...this._fieldReferencesLookup.get("#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY")])}resetExecutors(){for(const A of this.executors)A.reset()}_buildDependencyGraph(){const {_fieldReferencesLookup:A,_fieldsAffectedLookup:x,
executors:v,preserveFieldValuesWhenHidden:B}=this,n=new Map(this.fieldInputs.map(K=>[K.name,K])),w=!1===B,D=new Map(v.map(K=>[K,[]]));for(const K of v){for(const N of K.fieldsUsed){l.getOrCreateMapValue(A,N,()=>new Set).add(K);const G=n.get(N);[G?.valueExpressionExecutor,G?.editableExpressionExecutor,w?G?.group?.visibilityExpressionExecutor:null,w?G?.visibilityExpressionExecutor:null].filter(P=>null!=P&&P!==K).forEach(P=>{D.get(P).push(K);l.getOrCreateMapValue(x,P,()=>new Set).add(G)})}K.geometryUsed&&
l.getOrCreateMapValue(A,"#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",()=>new Set).add(K)}return D}async _evaluate(A){const x=new Map,{_dependencyGraph:v,_fieldsAffectedLookup:B,_latestFieldValues:n}=this;for(const w of A)u(w,x,v);for(const [w,{resolver:D,dependencyPromises:K}]of x)Promise.all(K).then(async()=>{const [N,G]=this._makeContext(n);return w.executeAsync(N,G)}).then(()=>{if(B.has(w))for(const N of B.get(w))this._latestFieldValues[N.name]=N.value;D.resolve()},N=>{!N||k.isAbortError(N)||t(N)||
w.markStale();D.reject(N)});A=(await Promise.allSettled(Array.from(x.values(),({resolver:w})=>w.promise))).filter(w=>"rejected"===w.status&&!(k.isAbortError(w.reason)||t(w.reason)));if(0<A.length)throw A=new AggregateError(A,`One or more expression executions failed. First error message: ${A[0].reason}`),p.getLogger(this).error(A),A;}_makeContext(A){const [x,v]=this._baseContext,B=this.feature.clone();B.attributes=A;return[{...x,$feature:B},v]}get test(){}};b.__decorate([E.property()],a.FormExpressionsManager.prototype,
"_asyncExecutors",null);b.__decorate([E.property()],a.FormExpressionsManager.prototype,"_baseContext",null);b.__decorate([E.property()],a.FormExpressionsManager.prototype,"feature",null);b.__decorate([E.property({constructOnly:!0})],a.FormExpressionsManager.prototype,"preserveFieldValuesWhenHidden",void 0);b.__decorate([E.property()],a.FormExpressionsManager.prototype,"executors",void 0);b.__decorate([E.property()],a.FormExpressionsManager.prototype,"fieldInputs",void 0);b.__decorate([E.property()],
a.FormExpressionsManager.prototype,"arcadeContextInfo",void 0);a.FormExpressionsManager=b.__decorate([f.subclass("esri.widgets.FeatureForm.FormExpressionsManager")],a.FormExpressionsManager);const u=(A,x,v)=>{if(!x.has(A)){var B=k.createResolver();x.set(A,{resolver:B,dependencyPromises:[]});A.abort();A=v.get(A);for(const n of A)u(n,x,v),x.get(n).dependencyPromises.push(B.promise)}},t=A=>A&&"object"===typeof A&&"message"in A&&"Cancelled"===A.message;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/FeatureForm/GroupInput":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/uid ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./featureFormUtils ./InputBase".split(" "),function(a,b,d,m,p,l,k,E,q,f){p=class extends f{constructor(u){super(u);this._expressionTrackingHandles=new Map;this.id=d.generateUID().toString();this.type="group"}initialize(){this.addHandles([b.watch(()=>
[this.visible,this.inputs],([u])=>{const {inputs:t}=this;u=u?void 0:!1;for(const A of t)q.isFieldInput(A)&&(A.required=u)},{initial:!0,equals:(u,t)=>t[0]===u[0]&&t[1]===u[1]})])}destroy(){for(const u of this._expressionTrackingHandles.values())u.remove()}get initialState(){return this.element.initialState||"expanded"}get inputs(){return this._get("inputs")}set inputs(u){this.removeAllHandles();u&&this.addHandles(u.map(t=>b.watch(()=>t.visible,()=>this._dirtyEvaluatedVisibilityExpression())));this._set("inputs",
u)}get open(){return"expanded"===this.initialState}set open(u){this._override("open",u)}get visible(){return!1!==this.evaluatedVisibilityExpression&&this.inputs&&this.inputs.some(u=>u.visible)}_dirtyEvaluatedVisibilityExpression(){const {element:u}=this;u.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};a.__decorate([m.property()],p.prototype,"id",void 0);a.__decorate([m.property()],p.prototype,"initialState",null);a.__decorate([m.property()],p.prototype,"inputs",null);a.__decorate([m.property()],
p.prototype,"open",null);a.__decorate([m.property()],p.prototype,"type",void 0);a.__decorate([m.property()],p.prototype,"visible",null);return p=a.__decorate([E.subclass("esri.widgets.FeatureForm.GroupInput")],p)})},"esri/widgets/FeatureForm/RelationshipInput":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/layerUtils ../Feature/FeatureRelationship/FeatureRelationshipViewModel ../Feature/support/featureUtils ./EditableInput ./featureFormUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t){m=class extends u{constructor(A){super(A);this.group=this._relationshipVM=null;this.type="relationship";this.addHandles([b.watch(()=>({feature:this.feature,element:this.element,layer:this.layer}),x=>this._createRelationshipVM(x),b.initial),b.on(()=>this.relatedLayer,"edits",()=>this._relationshipVM?.refresh())])}destroy(){this._relationshipVM?.destroy()}get canAddRelatedFeature(){const {editable:A,featureCount:x,relationship:v}=this;if(!v||!this.loaded||!this.relatedLayerAllowsAdds)return!1;
const {cardinality:B,role:n}=v;return"one-to-one"===B&&0<x||"many-to-many"===B||"one-to-many"===B&&"destination"===n&&0<x?!1:A}get displayCount(){return this.element.displayCount??3}get displayType(){return this.element.displayType}get editable(){return this.relatedLayerAllowsEdits?this.evaluatedEditableExpression??!0:!1}get featureCount(){return this._relationshipVM?.featureCount??0}get loaded(){return"loading"!==this._relationshipVM?.state}get map(){return this._get("map")}set map(A){A&&this._relationshipVM?.set("map",
A);this._set("map",A)}get orderByFields(){return this.element.orderByFields}get originHasValidKey(){return!(!this.relationship||!this.feature.getAttribute(this.relationship.keyField))}get relationship(){return this._relationshipVM?.relationship}get relationshipId(){return this.element.relationshipId}get relatedFeatureInfos(){const {_relationshipVM:A,timeZone:x}=this;if(!A?.relatedFeatures?.length||!A?.relatedLayer)return[];const {itemDescriptionFieldName:v,relatedFeatures:B,relatedLayer:n}=A,w=n&&
"formTemplate"in n&&n.formTemplate?n.formTemplate.title:void 0;return B.map(D=>{let K=void 0;if(v){var N=D.getAttribute(v);const G=n.fieldsIndex.get(v);G&&(N=t.getComputedAttributes({values:[N],fields:[G],timeZone:x??void 0})[v],null!=N&&(K=N.toString()))}N=w?t.parseFormTemplateString({label:w,attributes:D.attributes,fieldsIndex:n.fieldsIndex,timeZone:x}):void 0;return{feature:D,description:K,title:N}}).toArray()}get relatedLayer(){return this._relationshipVM?.relatedLayer}get relatedLayerIsTable(){return!!this.relatedLayer?.isTable}get relatedLayerAllowsAdds(){const {relatedLayer:A}=
this;return A&&this.relatedLayerAllowsEdits?!!E.getEffectiveLayerCapabilities(A)?.operations?.supportsAdd:!1}get relatedLayerAllowsEdits(){const {relatedLayer:A}=this;return A?!!E.getEffectiveLayerCapabilities(A)?.operations?.supportsEditing:!1}get showAllEnabled(){return this._get("showAllEnabled")}set showAllEnabled(A){this._relationshipVM?.set("showAllEnabled",A);this._set("showAllEnabled",A)}get showAllActionVisible(){return!this.showAllEnabled&&0<this.featureCount&&this.featureCount>this.displayCount}get visible(){var {relationship:A}=
this;if(!A)return!1;({cardinality:A}=A);return"many-to-many"===A?!1:null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}get updating(){return"loading"===this._relationshipVM?.state||"querying"===this._relationshipVM?.state}incrementPage(){this._relationshipVM&&this._relationshipVM.featurePage++}getRelatedFeatureByObjectId(A){return this._relationshipVM?.getRelatedFeatureByObjectId(A)}_createRelationshipVM(A){const {feature:x,element:v,layer:B}=A;this._relationshipVM?.destroy();
if(x&&v&&B){var {displayCount:n,map:w,orderByFields:D,relationshipId:K,showAllEnabled:N}=this;f.isRelatableFeatureSupportedLayer(B)&&(this._relationshipVM=new q({graphic:x,displayCount:n,layer:B,map:w,orderByFields:D,relationshipId:K,showAllEnabled:N}))}}};a.__decorate([d.property()],m.prototype,"_relationshipVM",void 0);a.__decorate([d.property()],m.prototype,"canAddRelatedFeature",null);a.__decorate([d.property()],m.prototype,"displayCount",null);a.__decorate([d.property()],m.prototype,"displayType",
null);a.__decorate([d.property()],m.prototype,"editable",null);a.__decorate([d.property()],m.prototype,"featureCount",null);a.__decorate([d.property()],m.prototype,"group",void 0);a.__decorate([d.property()],m.prototype,"loaded",null);a.__decorate([d.property()],m.prototype,"map",null);a.__decorate([d.property()],m.prototype,"orderByFields",null);a.__decorate([d.property()],m.prototype,"originHasValidKey",null);a.__decorate([d.property()],m.prototype,"relationship",null);a.__decorate([d.property()],
m.prototype,"relationshipId",null);a.__decorate([d.property()],m.prototype,"relatedFeatureInfos",null);a.__decorate([d.property()],m.prototype,"relatedLayer",null);a.__decorate([d.property()],m.prototype,"relatedLayerIsTable",null);a.__decorate([d.property()],m.prototype,"relatedLayerAllowsAdds",null);a.__decorate([d.property()],m.prototype,"relatedLayerAllowsEdits",null);a.__decorate([d.property()],m.prototype,"showAllEnabled",null);a.__decorate([d.property()],m.prototype,"showAllActionVisible",
null);a.__decorate([d.property({readOnly:!0})],m.prototype,"type",void 0);a.__decorate([d.property()],m.prototype,"visible",null);a.__decorate([d.property()],m.prototype,"updating",null);return m=a.__decorate([k.subclass("esri.widgets.FeatureForm.RelationshipInput")],m)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B){d=class extends p.ClonableMixin(k.IdentifiableMixin(d)){constructor(n){super(n);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:w}=this;w&&w.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:w}=this;w&&w.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:w}=this;w&&w.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const w=new AbortController;this._queryAbortController=w;await E.ignoreAbortErrors(this._query());this._queryAbortController===w&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const w=new AbortController;this._queryFeatureCountAbortController=w;await E.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===w&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const w=new AbortController;this._queryPageAbortController=w;await E.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===w&&(this._queryPageAbortController=null)};
this._queryDebounced=E.debounce(this._queryController,100);this._queryFeatureCountDebounced=E.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=E.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:w,relatedFeatures:D}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,D.destroyAll(),this.destroyed||D.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:w?.signal}))))};this.addHandles([q.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),q.initial),q.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),q.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.destroyAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(n){const {featuresPerPage:w,featureCount:D}=this;this._set("featurePage",Math.min(Math.max(n,1),Math.ceil(D/w)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:n,relatedLayer:w}=this;return n&&w?.loaded?n.map(D=>{const K=D.clone();K.field=v.getFixedFieldName(D.field,w);return K}):n??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
null!=this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const n=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&null!=this.relationshipId&&null!=this.objectId&&!!n?.supportsCount&&!!n?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(n){this._set("displayCount",Math.min(Math.max(n,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new l}get relatedLayer(){const {layer:n,map:w,relationship:D}=this;return n?.loaded&&w&&D?v.findRelatedLayer(w,n,D)??null:null}get relationship(){const {relationshipId:n,layer:w}=this;return null!=n?w?.relationships?.find(({id:D})=>D===n)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new l}get state(){const {_queryAbortController:n,
_queryFeatureCountAbortController:w,_queryPageAbortController:D,canQuery:K,_loaded:N,canLoad:G}=this;return w||G&&!N?"loading":n||D?"querying":K?"ready":"disabled"}getRelatedFeatureByObjectId(n){return this.relatedFeatures.find(w=>w.getObjectId()===n)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.destroyAll()}async _queryFeatureCount(){const {layer:n,relatedLayer:w,relationshipId:D,objectId:K,_queryFeatureCountAbortController:N,canQuery:G,
supportsCacheHint:P}=this;await n?.load();await w?.load();if(G&&n&&w&&null!=K){var z=w.createQuery(),{historicMoment:C,gdbVersion:L}=n;z=new x({cacheHint:P,gdbVersion:L,historicMoment:C,relationshipId:D,returnGeometry:!1,objectIds:[K],where:z.where??void 0});z=await n.queryRelatedFeaturesCount(z,{signal:N?.signal});this._set("featureCount",z[K]||0)}else this._set("featureCount",0)}_sliceFeatures(n){const {showAllEnabled:w,displayCount:D}=this;return w?n:D?n.slice(0,D):[]}async _queryPage(){const {relatedFeatures:n,
featurePage:w,showAllEnabled:D,_queryPageAbortController:K,featureCount:N}=this;!D||2>w||!N||n.addMany(await this._queryRelatedFeatures({signal:K?.signal}))}async _queryRelatedFeatures(n){const {orderByFieldsFixedCasing:w,showAllEnabled:D,featuresPerPage:K,displayCount:N,layer:G,relationshipId:P,featurePage:z,featureCount:C,relatedLayer:L,supportsCacheHint:S}=this,{canQuery:r,objectId:J}=this;if(!r||!G||!L||null==J)return[];var M=D?((z-1)*K+C)%C:0;const y=D?K:N;var H=L.objectIdField;H=[...w.map(F=>
F.field),...B.getFieldsInTitleAndDesc(L),H].filter(m.isSome);const h=w.map(F=>`${F.field} ${F.order}`),e=L.createQuery(),{historicMoment:c,gdbVersion:g}=G;M=new x({orderByFields:h,start:M,num:y,outFields:H,cacheHint:S,historicMoment:c,gdbVersion:g,relationshipId:P,returnGeometry:!1,objectIds:[J],where:e.where??void 0});n=(await G.queryRelatedFeatures(M,{signal:n?.signal}))[J]?.features||[];n.forEach(F=>{F.sourceLayer=L;F.layer=L});return n}};a.__decorate([f.property()],d.prototype,"_loaded",void 0);
a.__decorate([f.property()],d.prototype,"_queryAbortController",void 0);a.__decorate([f.property()],d.prototype,"_queryPageAbortController",void 0);a.__decorate([f.property()],d.prototype,"_queryFeatureCountAbortController",void 0);a.__decorate([f.property({value:1})],d.prototype,"featurePage",null);a.__decorate([f.property()],d.prototype,"featuresPerPage",void 0);a.__decorate([f.property({readOnly:!0})],d.prototype,"orderByFieldsFixedCasing",null);a.__decorate([f.property({readOnly:!0})],d.prototype,
"supportsCacheHint",null);a.__decorate([f.property({readOnly:!0})],d.prototype,"canLoad",null);a.__decorate([f.property({readOnly:!0})],d.prototype,"canQuery",null);a.__decorate([f.property()],d.prototype,"description",void 0);a.__decorate([f.property({readOnly:!0})],d.prototype,"itemDescriptionFieldName",null);a.__decorate([f.property({value:3})],d.prototype,"displayCount",null);a.__decorate([f.property({type:b})],d.prototype,"graphic",void 0);a.__decorate([f.property()],d.prototype,"layer",void 0);
a.__decorate([f.property()],d.prototype,"map",void 0);a.__decorate([f.property({readOnly:!0})],d.prototype,"objectId",null);a.__decorate([f.property({readOnly:!0})],d.prototype,"objectIdField",null);a.__decorate([f.property()],d.prototype,"orderByFields",void 0);a.__decorate([f.property({readOnly:!0})],d.prototype,"relatedFeatures",null);a.__decorate([f.property({readOnly:!0})],d.prototype,"relatedLayer",null);a.__decorate([f.property({readOnly:!0})],d.prototype,"relationship",null);a.__decorate([f.property()],
d.prototype,"featureCount",void 0);a.__decorate([f.property({readOnly:!0})],d.prototype,"relatedFeatureViewModels",null);a.__decorate([f.property()],d.prototype,"relationshipId",void 0);a.__decorate([f.property()],d.prototype,"showAllEnabled",void 0);a.__decorate([f.property()],d.prototype,"state",null);a.__decorate([f.property()],d.prototype,"title",void 0);return d=a.__decorate([A.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],d)})},"esri/widgets/FeatureForm/TextElementInput":function(){define("exports ../../chunks/tslib.es6 ../../core/Collection ../../core/ReactiveMap ../../core/ReactiveSet ../../core/uid ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/support/fieldUtils ./featureFormUtils ./InputBase ./support/textManipulationUtils ../support/widgetUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){function w(K){var N=[...K.matchAll(/{[^{]+?}/g)];let G=0;const P=[],z=[];for(const C of N)N=C[0],P.push(K.slice(G,C.index)),z.push(N),G=C.index+N.length;P.push(K.slice(G));return{literals:P,templates:z}}function D(K,N){return N.reduce((G,P,z)=>G.concat(K.at(z),P),"").concat(K.at(-1))}a.TextElementInput=class extends v{constructor(K){super(K);this.group=null;this.id=`TextElementInput-${l.generateUID()}`;this.type="text";this._expressionReferences=new m;this._expressionsUsed=
new p;this._fieldsUsed=new p;this._literalParts=new d;this._templateParts=new d;this._updatingHandles=new t.UpdatingHandles}initialize(){const {rawText:K}=this;K?"markdown"===this.textFormat?this._updatingHandles.addPromise(B.compileTextElementMarkdownToHTML(K).then(N=>this._initializeTextParts(N))):this._initializeTextParts(K):this._literalParts.push("")}get expressionsUsed(){return Array.from(this._expressionsUsed)}get fieldsIndex(){return this.layer.fieldsIndex}set fieldsIndex(K){this._overrideIfSome("fieldsIndex",
K)}get fieldsUsed(){return Array.from(this._fieldsUsed)}get rawText(){return this.element.text}get text(){const K=this._templateParts.map(N=>`${this._expressionReferences.get(N)?.lastEvaluatedValue??""}`);return n.renderingSanitizer.sanitize(D(this._literalParts,K))}get textFormat(){return this.element.textFormat}get updating(){return this._updatingHandles.updating||Array.from(this._expressionReferences.values()).some(K=>K?.updating)}setExpressionExecutor(K,N){this._expressionReferences.set(x.prependExpressionPrefix(K),
N)}setFieldExecutor(K,N){this._expressionReferences.set(x.prependFieldPrefix(K),N)}_initializeTextParts(K){const {fieldsIndex:N}=this,{literals:G,templates:P}=w(K);K=[];const z=[];for(let L=0;L<P.length;L++){const S=G[L];var C=A.extractSubstitutionTemplatesFromString(P[L])[0];x.isExpressionReference(C)?(this._expressionsUsed.add(x.extractExpressionNameFromString(C)),this._expressionReferences.set(C,null),K.push(S),z.push(C)):x.isLegacyFieldMapsExpressionReference(C)?(this._expressionsUsed.add(C),
C=x.prependExpressionPrefix(C),this._expressionReferences.set(C,null),K.push(S),z.push(C)):N?.has(C)?(C=N.normalizeFieldName(C),this._fieldsUsed.add(C),C=x.prependFieldPrefix(C),this._expressionReferences.set(C,null),K.push(S),z.push(C)):G[L+1]=S.concat(C,G[L+1])}K.push(G.at(-1));this._literalParts.addMany(K);this._templateParts.addMany(z)}};b.__decorate([k.property()],a.TextElementInput.prototype,"expressionsUsed",null);b.__decorate([k.property()],a.TextElementInput.prototype,"fieldsIndex",null);
b.__decorate([k.property()],a.TextElementInput.prototype,"fieldsUsed",null);b.__decorate([k.property()],a.TextElementInput.prototype,"group",void 0);b.__decorate([k.property()],a.TextElementInput.prototype,"id",void 0);b.__decorate([k.property()],a.TextElementInput.prototype,"rawText",null);b.__decorate([k.property()],a.TextElementInput.prototype,"text",null);b.__decorate([k.property()],a.TextElementInput.prototype,"textFormat",null);b.__decorate([k.property()],a.TextElementInput.prototype,"type",
void 0);b.__decorate([k.property()],a.TextElementInput.prototype,"updating",null);a.TextElementInput=b.__decorate([u.subclass("esri.widgets.FeatureForm.TextElementInput")],a.TextElementInput);a.assembleStringFromParts=D;a.splitStringIntoParts=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(a,b){class d{constructor(m){this._observable=new b.SimpleObservable;
this._set=new Set(m)}get size(){a.trackAccess(this._observable);return this._set.size}add(m){const p=this._set.size;this._set.add(m);this._set.size!==p&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(m){(m=this._set.delete(m))&&this._observable.notify();return m}entries(){a.trackAccess(this._observable);return this._set.entries()}forEach(m,p){a.trackAccess(this._observable);this._set.forEach((l,k)=>m.call(p,l,k,this),p)}has(m){a.trackAccess(this._observable);
return this._set.has(m)}keys(){a.trackAccess(this._observable);return this._set.keys()}values(){a.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){a.trackAccess(this._observable);return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return d})},"esri/widgets/FeatureForm/support/textManipulationUtils":function(){define(["require","exports"],function(a,b){async function d(){const {Marked:l}=await new Promise((q,f)=>a(["../../../chunks/marked.esm"],
q,f)),k=()=>"",E={};for(const q of p)E[q]=k;m=new l({renderer:{del:function({text:q}){return`<span style="text-decoration:line-through;">${q}</span>`},link:function({href:q,text:f,title:u}){return`<a${null!=q?` href="${q}"`:""}${null!=u?` title="${u}"`:""} target="_blank">${f??""}</a>`},...E}})}let m;const p="blockquote html hr checkbox table tablerow tablecell image".split(" ");b.compileTextElementMarkdownToHTML=async function(l){m||await d();return m.parse(l)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/FeatureTemplates":function(){define("require ../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../layers/support/layerUtils ./Widget ./FeatureTemplates/featureTemplatesUtils ./FeatureTemplates/FeatureTemplatesViewModel ./FeatureTemplates/ItemList ./FeatureTemplates/TemplateItem ./FeatureTemplates/VisibleElements ../chunks/componentsUtils ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N){function G(P){return P.id}p=class extends f{constructor(P,z){super(P,z);this.enableListScroll=!0;this.filterText="";this.headingLevel=4;this.messagesCommon=this.messages=null;this.selectionMode="none";this.viewModel=new t;this.visibleElements=new v;this.renderCustomItem=C=>null;this.renderCustomGroupContent=C=>null;this.renderItemLabel=()=>null;this.renderItemDescription=()=>null;this.renderItemContent=C=>null;this.renderItemContentEnd=C=>null;this._iconIntersectionObserver=
new IntersectionObserver((C,L)=>{C.forEach(async S=>{if(S.isIntersecting){const M=S.target;if(M?.["data-has-icon"])L.unobserve(M);else{var {layer:r,template:J}=M?.["data-item"];M&&(M["data-has-icon"]=!0);S=await x.fetchThumbnail(r,J).catch(()=>{M&&(M["data-has-icon"]=!1);return null});null!=S&&M.appendChild(S)}}})});this._renderItemIcon=C=>q.isTable(C.layer)?N.tsx("span",{"data-has-icon":!0,"data-item":C,key:"icon"},N.tsx("calcite-icon",{icon:"table"})):N.tsx("span",{afterCreate:this._afterItemCreateOrUpdate,
afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":C,key:"icon"});this._afterItemCreateOrUpdate=C=>{this._iconIntersectionObserver?.observe(C)};this._afterItemRemoved=C=>{this._iconIntersectionObserver?.unobserve(C)}}initialize(){const P=({label:z})=>!this.filterText||!!z?.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(d.watch(()=>this.viewModel,(z,C)=>{z&&!z.filterFunction&&(this.filterFunction=P);C&&C!==z&&C.filterFunction===
P&&(C.filterFunction=null)},d.initial))}destroy(){this._iconIntersectionObserver?.disconnect();this._iconIntersectionObserver=null}loadDependencies(){return B.loadCalciteComponents({icon:()=>new Promise((P,z)=>a(["../chunks/calcite-icon"],P,z)),loader:()=>new Promise((P,z)=>a(["../chunks/calcite-loader"],P,z)),input:()=>new Promise((P,z)=>a(["../chunks/calcite-input"],P,z)),list:()=>new Promise((P,z)=>a(["../chunks/calcite-list"],P,z)),"list-item":()=>new Promise((P,z)=>a(["../chunks/calcite-list-item"],
P,z)),notice:()=>new Promise((P,z)=>a(["../chunks/calcite-notice"],P,z))})}get disabled(){return this.viewModel.disabled}set disabled(P){this.viewModel.disabled=P}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(P){this.viewModel.filterFunction=P}get groupBy(){return this.viewModel.groupBy}set groupBy(P){this.viewModel.groupBy=P}get icon(){return"list-rectangle"}set icon(P){this._overrideIfSome("icon",P)}get label(){return this.messages?.widgetLabel??""}set label(P){this._overrideIfSome("label",
P)}get layers(){return this.viewModel.layers}set layers(P){this.viewModel.layers=P}get selectedItem(){return this.viewModel.selectedItem}select(P,z){return this.viewModel.select(P,z)}render(){const {disabled:P,enableListScroll:z,filterText:C,headingLevel:L,messages:S,viewModel:{items:r,numberOfFeatureTemplates:J,selectedItem:M,state:y}}=this,H=this.visibleElements.filter&&1<J;if(0<r.length&&u.isTemplateItemGroup(r[0])){const h=r.find(e=>e.label===t.nullGroupBy.label);h&&(h.label=S.other)}return N.tsx("div",
{"aria-label":S.widgetLabel,class:this.classes("esri-feature-templates",n.globalCss.widget)},"loading"===y?N.tsx("calcite-loader",{key:"loader",label:this.messagesCommon.loading,type:"indeterminate"}):"ready"===y?N.tsx(A.ItemList,{disabled:P,enableListScroll:z,filterEnabled:H,filterText:C,headingLevel:L,id:this.id,identify:G,items:r,messages:{filterPlaceholder:S.filterPlaceholder,noItems:S.noItems,noMatches:S.noMatches},renderCustomGroupContent:this.renderCustomGroupContent,renderCustomItem:this.renderCustomItem,
renderIcon:this._renderItemIcon,renderItemContent:this.renderItemContent,renderItemContentEnd:this.renderItemContentEnd,renderItemDescription:this.renderItemDescription,renderItemLabel:this.renderItemLabel,selectedItem:M??void 0,selectionMode:this.selectionMode??void 0,onFilterChange:h=>{this.filterText=h},onItemSelect:h=>!u.isTemplateItemGroup(h)&&this.viewModel.select(h)}):null)}};b.__decorate([m.property()],p.prototype,"disabled",null);b.__decorate([m.property()],p.prototype,"enableListScroll",
void 0);b.__decorate([m.property()],p.prototype,"filterFunction",null);b.__decorate([m.property()],p.prototype,"filterText",void 0);b.__decorate([m.property()],p.prototype,"groupBy",null);b.__decorate([m.property()],p.prototype,"headingLevel",void 0);b.__decorate([m.property()],p.prototype,"icon",null);b.__decorate([m.property()],p.prototype,"label",null);b.__decorate([m.property()],p.prototype,"layers",null);b.__decorate([m.property(),D.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],
p.prototype,"messages",void 0);b.__decorate([m.property(),D.messageBundle("esri/t9n/common")],p.prototype,"messagesCommon",void 0);b.__decorate([m.property({readOnly:!0})],p.prototype,"selectedItem",null);b.__decorate([m.property()],p.prototype,"selectionMode",void 0);b.__decorate([m.property(),K.vmEvent("select")],p.prototype,"viewModel",void 0);b.__decorate([m.property({type:v,nonNullable:!0})],p.prototype,"visibleElements",void 0);b.__decorate([m.property()],p.prototype,"renderCustomItem",void 0);
b.__decorate([m.property()],p.prototype,"renderCustomGroupContent",void 0);b.__decorate([m.property()],p.prototype,"renderItemLabel",void 0);b.__decorate([m.property()],p.prototype,"renderItemDescription",void 0);b.__decorate([m.property()],p.prototype,"renderItemContent",void 0);b.__decorate([m.property()],p.prototype,"renderItemContentEnd",void 0);return p=b.__decorate([E.subclass("esri.widgets.FeatureTemplates")],p)})},"esri/widgets/FeatureTemplates/featureTemplatesUtils":function(){define(["exports"],
function(a){a.isTemplateItemGroup=b=>"items"in b;a.loadLayerWithTemplates=async function(b,d){"subtype-sublayer"===b.type?await b.parent?.load(d):await b.load(d);return b};a.mapItemsByTemplate=function(b){const d=new Map,m=[];for(const p of b)if("items"in p){m.push(p);for(const l of p.items)d.set(l.template,l)}else d.set(p.template,p);return[d,m]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/FeatureTemplatesViewModel":function(){define("../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Evented ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/support/layerUtils ./featureTemplatesUtils ./TemplateItem ./TemplateItemGroup ../support/templateUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){function w(G){for(const P of G){if(x.isTemplateItemGroup(P))for(const z of P.items)z.destroy();P.destroy()}}var D;const K=({layer:G})=>({key:G,label:G.title??""}),N=({layer:G})=>({key:G.geometryType,label:G.geometryType??""});d=D=class extends d.EventedAccessor{constructor(G){super(G);this._allItems=[];this._updatingHandles=new t.UpdatingHandles;this._updateAllItemsTask=null;this.disabled=!1;this.selectedItem=this.filterFunction=this.disabledItemFunction=
null}initialize(){this._get("groupBy")||(this.groupBy="layer");this.addHandles([l.watch(()=>[this._featureTemplatesByLayer,this._groupByFunction],()=>{this._updateAllItemsTask=m.abortMaybe(this._updateAllItemsTask);const G=b.createTask(P=>this._updateAllItems(P));this._updateAllItemsTask=G;this._updatingHandles.addPromise(G.promise)},l.syncAndInitial),l.watch(()=>this.filterFunction,G=>{for(const P of this._allItems)x.isTemplateItemGroup(P)&&(P.filterFunction=G)},l.sync)])}get _featureTemplatesByLayer(){const G=
new Map;if(!this.layers)return G;for(const P of this.layers)if("subtype-group"===P.type)for(const z of P.sublayers)G.set(z,n.getAllTemplatesForLayer(z));else G.set(P,n.getAllTemplatesForLayer(P));return G}set groupBy(G){this._set("groupBy",G);if("function"===typeof G)this._groupByFunction=P=>this._ensureGroupByObject(G(P));else switch(G){case "layer":this._groupByFunction=K;break;case "geometry":this._groupByFunction=N;break;default:this._groupByFunction=null}}get layers(){return this._get("layers")}set layers(G){this.removeHandles("layers");
if(G){const P=()=>this.notifyChange("state");this.addHandles(G.map(z=>l.when(()=>z.loadStatus,P)),"layers")}this._set("layers",G)}get state(){return this.updating?"loading":0===this.layers.length?"disabled":"ready"}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((G,P)=>G+P.length,0)}get items(){const {filterFunction:G}=this;return null==G?this._allItems:this._allItems.filter(P=>x.isTemplateItemGroup(P)?0<P.items.length:G(P))}get updating(){return this._updatingHandles.updating}refresh(){this.notifyChange("filterFunction");
for(const G of this._allItems)x.isTemplateItemGroup(G)&&G.reapplyFilter()}select(G,{emit:P=!0}={}){const z=this.selectedItem;G=G?.clone()||null;this._set("selectedItem",G);P&&this.emit("select",{item:G,oldItem:z,template:G?.template??null})}_createItem(G,P){return new v({disabledFunction:this.disabledItemFunction,layer:P,template:G})}_ensureGroupByObject(G){return"string"===typeof G?{key:G,label:G}:G}async _updateAllItems(G){var P=this._allItems;if(0===this.numberOfFeatureTemplates)w(P),this._allItems=
[];else{var [z,C]=x.mapItemsByTemplate(P),L={signal:G},S=this._featureTemplatesByLayer;P=[];for(const [y,H]of S)if(await x.loadLayerWithTemplates(y,L),p.throwIfAborted(G),S=A.getEffectiveLayerCapabilities(y)?.operations,S?.supportsEditing&&S?.supportsAdd)for(var r of H)z.has(r)?(P.push(z.get(r)),z.delete(r)):P.push(this._createItem(r,y));for(const y of[...z.values(),...C])y.destroy();if(null==this._groupByFunction)p.throwIfAborted(G),this._allItems=P;else{r=new Map;for(var J of P){P=this._groupByFunction(J);
const {key:y,label:H}=null!=P.key?P:D.nullGroupBy;r.has(y)||r.set(y,{label:H,items:[]});r.get(y)?.items.push(J)}var {filterFunction:M}=this;J=Array.from(r.values()).map(({label:y,items:H})=>new B({allItems:H,filterFunction:M,label:y}));p.throwIfAborted(G);this._allItems=1===J.length&&J[0].label===D.nullGroupBy.label?J[0].allItems:J}}}};d.nullGroupBy={key:Symbol(),label:"Other\u200b"};a.__decorate([k.property()],d.prototype,"_allItems",void 0);a.__decorate([k.property()],d.prototype,"_featureTemplatesByLayer",
null);a.__decorate([k.property()],d.prototype,"_groupByFunction",void 0);a.__decorate([k.property()],d.prototype,"_updatingHandles",void 0);a.__decorate([k.property()],d.prototype,"disabled",void 0);a.__decorate([k.property()],d.prototype,"disabledItemFunction",void 0);a.__decorate([k.property({value:null})],d.prototype,"filterFunction",void 0);a.__decorate([k.property()],d.prototype,"groupBy",null);a.__decorate([k.property({value:[]})],d.prototype,"layers",null);a.__decorate([k.property()],d.prototype,
"state",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"numberOfFeatureTemplates",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"items",null);a.__decorate([k.property({readOnly:!0})],d.prototype,"selectedItem",void 0);a.__decorate([k.property()],d.prototype,"updating",null);return d=D=a.__decorate([u.subclass("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],d)})},"esri/widgets/FeatureTemplates/TemplateItem":function(){define("require ../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../symbols/support/symbolUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){async function t(B,n){var {renderer:w}=B;return w&&(n=new d({attributes:n.prototype.attributes}),w=await w.getSymbolAsync(n))?w:A(B)}async function A(B){({geometryType:B}=B);return(B="point"===B||"multipoint"===B?await new Promise((n,w)=>a(["../../symbols/SimpleMarkerSymbol"],D=>n(x(D)),w)):"polyline"===B?await new Promise((n,w)=>a(["../../symbols/SimpleLineSymbol"],D=>n(x(D)),w)):"polygon"===B||"mesh"===B||"multipatch"===B?await new Promise((n,w)=>a(["../../symbols/SimpleFillSymbol"],
D=>n(x(D)),w)):null)?new B.default:null}const x=B=>Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));var v;m=v=class extends m{constructor(B){super(B);this._activeFetchInfo={id:null,request:null};this.thumbnail=this.template=this.layer=this.disabledFunction=null}initialize(){this.addHandles(p.watch(()=>{const {layer:B}=this;return[B&&"renderer"in B?B.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null;this._activeFetchInfo.request=null;
this._set("thumbnail",null)},p.initial))}get description(){return this.template?.description}set description(B){this.template&&(this.template.description=B)}get disabled(){return this.disabledFunction?.(this)??!1}get label(){return this.template?.name}set label(B){this.template&&(this.template.name=B)}get id(){return`${this.label??""}\u2013${this.layer?.id}`}get supportsUpload(){return"scene"===this.layer?.type}clone(){const B=null!=this.thumbnail?this.thumbnail.cloneNode(!0):null,n=new v({layer:this.layer,
template:this.template});n._set("thumbnail",B);return n}static async fetchThumbnail(B,n){const w=await t(B,n);if(null==w)return null;const D={maxSize:36};"dictionary"===B.renderer?.type&&(D.fieldMap=B.renderer.fieldMap??void 0,D.feature={attributes:n.prototype.attributes??{}});return await u.renderPreviewHTML(w,D)}};b.__decorate([l.property()],m.prototype,"description",null);b.__decorate([l.property()],m.prototype,"disabled",null);b.__decorate([l.property()],m.prototype,"disabledFunction",void 0);
b.__decorate([l.property()],m.prototype,"label",null);b.__decorate([l.property()],m.prototype,"layer",void 0);b.__decorate([l.property()],m.prototype,"template",void 0);b.__decorate([l.property()],m.prototype,"thumbnail",void 0);b.__decorate([l.property()],m.prototype,"id",null);b.__decorate([l.property()],m.prototype,"supportsUpload",null);return m=v=b.__decorate([f.subclass("esri.widgets.FeatureTemplates.TemplateItem")],m)})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f){function u(n,w){if(w&&(n.style.filter=E.getCSSFilterFromEffectList(w),w=w.effects))for(const D of w)if("drop-shadow"===D?.type){0>D.offsetX?n.style.marginLeft=`${Math.abs(D.offsetX)}px`:n.style.marginRight=`${D.offsetX}px`;break}}async function t(n,w){switch(n.type){case "web-style":var {previewWebStyleSymbol:D}=await new Promise((K,N)=>a(["./previewWebStyleSymbol"],K,N));return D(n,t,w);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:D}=
await new Promise((K,N)=>a(["./previewSymbol3D"],K,N)),D(n,w);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:D}=await new Promise((K,N)=>a(["./previewSymbol2D"],K,N)),D(n,w);case "cim":return{previewCIMSymbol:D}=await new Promise((K,N)=>a(["./previewCIMSymbol"],K,N)),D(n,w)}}function A(n){return n&&"opacity"in n?n.opacity*A(n.parent):1}function x(n){if(n)return"renderer"in n?n.renderer:void 0}let v=null;const B=
[255,255,255];b.getDisplayedColor=async function(n,w){if(n){var {layer:D,sourceLayer:K}=n,N=A(D??K);if(null!=n.symbol&&(null==w||!0!==w.ignoreGraphicSymbol))return n="web-style"===n.symbol.type?await E.fetchWebStyleSymbol(n.symbol,w):n.symbol.clone(),E.getColorFromSymbol(n,N);var G=w?.renderer??x(D)??x(K),P=G&&"getSymbolAsync"in G?await G.getSymbolAsync(n,w):void 0;if(P){P="web-style"===P.type?await E.fetchWebStyleSymbol(P,w):P.clone();P=E.getColorFromSymbol(P,N);if(!(G&&"visualVariables"in G)||"visualVariables"in
G&&!G.visualVariables||"visualVariables"in G&&!G.visualVariables?.length)return P;"arcadeRequiredForVisualVariables"in G&&G.arcadeRequiredForVisualVariables&&null==w?.arcade&&(w={...w},w.arcade=await m.loadArcade());var {getColor:z,getOpacity:C}=await new Promise((r,J)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],r,J)),L=[],S=[];if(G.visualVariables)for(const r of G.visualVariables)switch(r.type){case "color":L.push(r);break;case "opacity":S.push(r)}G=(G=0<L.length?L[L.length-
1]:null)?z(G,n,w):P;n=(P=0<S.length?S[S.length-1]:null)?C(P,n,w):null;null!=N&&(n=null!=n?n*N:N);return G?E.applyOpacityToColor(G,n):null}}};b.getDisplayedSymbol=async function(n,w){if(n){var D=n.sourceLayer,K=(null!=w&&(w.useSourceLayer??!1)?D:n.layer)??D;D=A(K);if(null!=n.symbol&&(null==w||!0!==w.ignoreGraphicSymbol))return n="web-style"===n.symbol.type?await E.fetchWebStyleSymbol(n.symbol,{...w,cache:null!=w?w.webStyleCache:null}):n.symbol.clone(),E.applyColorToSymbol(n,null,D),n;var N=w?.renderer??
x(K);if(K=N&&"getSymbolAsync"in N?await N.getSymbolAsync(n,w):null){K="web-style"===K.type?await K.fetchSymbol({...w,cache:null!=w?w.webStyleCache:null}):K.clone();if(!(N&&"visualVariables"in N&&N.visualVariables?.length))return E.applyColorToSymbol(K,null,D),K;"arcadeRequiredForVisualVariables"in N&&N.arcadeRequiredForVisualVariables&&null==w?.arcade&&(w={...w},w.arcade=await m.loadArcade());var {getColor:G,getOpacity:P,getAllSizes:z,getRotationAngle:C}=await new Promise((y,H)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],
y,H)),L=[],S=[],r=[],J=[];for(var M of N.visualVariables)switch(M.type){case "color":L.push(M);break;case "opacity":S.push(M);break;case "rotation":J.push(M);break;case "size":M.target||r.push(M)}M=(M=!!L.length&&L[L.length-1])?G(M,n,w):null;S=(S=!!S.length&&S[S.length-1])?P(S,n,w):null;null!=D&&(S=null!=S?S*D:D);E.applyColorToSymbol(K,M,S);r.length&&(D=z(r,n,w),await E.applySizesToSymbol(K,D));for(const y of J)E.applyRotationToSymbol(K,C(y,n,w),y.axis);return K}}};b.getLegendLabel=async function(n,
w,D){if(n){var {layer:K,sourceLayer:N}=n,G=D?.renderer??x(K)??x(N);if(!G)return null;if("visualVariables"in G&&G.visualVariables?.length){const {getRampStops:z}=await new Promise((r,J)=>a(["../../widgets/Legend/support/colorRampUtils"],r,J)),{getRampStops:C}=await new Promise((r,J)=>a(["../../widgets/Legend/support/sizeRampUtils"],r,J)),{getDateFormatOptions:L}=await new Promise((r,J)=>a(["../../widgets/Legend/support/utils"],r,J));let S=null;for(const r of G.visualVariables){var P=w?L(K,r,w.timeZone):
null;let J=null;switch(r.type){case "color":J=await z(r,null,P);break;case "opacity":J=await z(r);break;case "size":r.target||(J=await C(G,r,null,D?.scale||w?.scale,w,P))}if(J?.length&&(P=J.find((M,y)=>{const H=n.attributes[r.field];return 0===y?H>=M.value:y===J?.length-1?H<=M.value:M.value===H}))){S=P.label;break}}if(S)return S}switch(G.type){case "class-breaks":return w="getClassBreakInfo"in G?await G.getClassBreakInfo(n,D):null,w?.label??(w&&1<G.classBreakInfos?.length)?`${w.minValue} - ${w.maxValue}`:
null;case "unique-value":return("getUniqueValueInfo"in G?await G.getUniqueValueInfo(n,D):null)?.label}return null}};b.renderColorRampPreviewHTML=function(n,w={}){var D="horizontal"===w.align;const K=w.width??(D?75:24),N=w.height??(D?24:75);var G=w.gradient??!0,P=window.devicePixelRatio,z=K*P,C=N*P;P=document.createElement("canvas");P.width=z;P.height=C;P.ariaLabel=w.ariaLabel??null;P.style.width=`${K}px`;P.style.height=`${N}px`;const L=P.getContext("2d");var S=D?z:0;const r=D?0:C;if(G){const J=L.createLinearGradient(0,
0,S,r);D=n.length;const M=1===D?0:1/(D-1);n.forEach((y,H)=>J.addColorStop(H*M,y.toString()));L.fillStyle=J;L.fillRect(0,0,z,C)}else{z=D?z/n.length:z;C=D?C:C/n.length;S=G=0;for(const J of n)L.fillStyle=J.toString(),L.fillRect(G,S,z,C),G=D?G+z:0,S=D?0:S+C}n=document.createElement("div");n.style.width=`${K}px`;n.style.height=`${N}px`;u(n,w?.effectList);n.appendChild(P);return n};b.renderDotDensityPreviewHTML=function(n,w,D){const {backgroundColor:K,outline:N,dotSize:G}=n;var P=D?.swatchSize||l.SymbolSizeDefaults.size;
const z=Math.round(P*P/Math.max(G,.5)**2*.8),C=window.devicePixelRatio;n=document.createElement("canvas");const L=P*C;n.width=L;n.height=L;n.style.width=`${n.width/C}px`;n.style.height=`${n.height/C}px`;const S=n.getContext("2d");K&&(S.fillStyle=K.toCss(!0),S.fillRect(0,0,L,L),S.fill());S.fillStyle=w?.toCss(!0)??"";if(v&&v.length/2===z)for(w=0;w<2*z;w+=2)S.fillRect(v[w],v[w+1],G*C,G*C),S.fill();else for(v=[],w=0;w<2*z;w+=2){const r=Math.floor(Math.random()*(L-0+1)),J=Math.floor(Math.random()*(L-0+
1));v.push(r,J);S.fillRect(r,J,G*C,G*C);S.fill()}N&&(N.color&&(S.strokeStyle=N.color.toCss(!0)),S.lineWidth=N.width,S.strokeRect(0,0,L,L));P=new Image(P,P);P.src=n.toDataURL();P.ariaLabel=D?.ariaLabel??null;P.alt=D?.ariaLabel??"";return P};b.renderPieChartPreviewHTML=function(n,w={}){const D=w.radius||40;var K=2*Math.PI*D,N=n.length;const G=K/N,P=[],z=p.getStroke(w.outline);null!=z?.width&&(z.width*=2);(z||w.backgroundColor)&&P.push({shape:{type:"circle",cx:D,cy:D,r:D},fill:w.backgroundColor,stroke:z,
offset:[0,0]});const C=w.values,L=C&&C.length===N&&100===C.reduce((r,J)=>r+J,0),S=[0];for(let r=0;r<N;r++){let J=null;L&&(J=C[r]*K/100,S.push(J+S[r]));P.push({shape:{type:"circle",cx:D,cy:D,r:D/2},fill:[0,0,0,0],stroke:{width:D,dashArray:`${(J??G)/2} ${K}`,dashoffset:`-${L?S[r]/2:G/2*r}`,color:n[r]},offset:[0,0]})}N=null;n=2*D+(z?.width||0);if(K=w.holePercentage)z&&P.push({shape:{type:"circle",cx:D,cy:D,r:D*K},fill:null,stroke:z,offset:[0,0]}),N=n/2,N=[[{shape:{type:"circle",cx:N,cy:N,r:N},fill:B,
stroke:z?{...z,color:B}:null,offset:[0,0]},{shape:{type:"circle",cx:N,cy:N,r:D*K},fill:[0,0,0],stroke:null,offset:[0,0]}]];return k.renderSymbol([P],[n,n],{effectView:w.effectList,ignoreStrokeWidth:!0,masking:N,rotations:[-90],ariaLabel:w.ariaLabel})};b.renderPreviewHTML=t;b.renderRelationshipRampPreviewHTML=function(n,w={}){const D=n?.authoringInfo;if("relationship"!==D?.type||!D?.numClasses||!n.uniqueValueInfos)return null;const {focus:K,numClasses:N}=D,G=f.getRelationshipRampElement({focus:K,numClasses:N,
infos:n.uniqueValueInfos});n=w?.node||document.createElement("div");k.renderOnce(n,()=>q.renderRelationshipRamp(G,w.id||"relationship",{opacity:w.opacity||1,effectList:w.effectList,ariaLabel:w.ariaLabel}));return n};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(a,b,d,m,p,l,k){function E(A){if(!A)return null;
let x=null;switch(A.type){case "simple-fill":case "picture-fill":case "simple-marker":x=E(A.outline);break;case "simple-line":const v=l.pt2px(A.width);null!=A.style&&"none"!==A.style&&0!==v&&(x={color:A.color,style:t(A.style),width:v,cap:A.cap,join:"miter"===A.join?l.pt2px(A.miterLimit):A.join},x.dashArray=q(x).join(",")||"none");break;default:x=null}return x}function q(A){if(!A?.style)return[];const {dashArray:x,style:v,width:B}=A;if("string"===typeof x&&"none"!==x)return x.split(",").map(D=>Number(D));
const n=B??0,w=f.has(v)?f.get(v).map(D=>D*n):[];if("butt"!==A.cap)for(const [D,K]of w.entries())w[D]=1===D%2?K+n:Math.max(K-n,1);return w}const f=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),u=new p.LRUCache(1E3),t=(()=>{const A={};return x=>{if(A[x])return A[x];const v=x.replaceAll("-","");return A[x]=
v}})();d=new d([128,128,128]);a.defaultThematicColor=d;a.dekebabifyLineStyle=t;a.getDashArray=q;a.getFill=function(A){const x=A.style;let v=null;if(A)switch(A.type){case "simple-marker":"cross"!==x&&"x"!==x&&(v=A.color);break;case "simple-fill":x&&"solid"!==x?"none"!==x&&(v={type:"pattern",x:0,y:0,src:b.getAssetUrl(`esri/symbols/patterns/${x}.png`),width:5,height:5}):v=A.color;break;case "picture-fill":v={type:"pattern",src:A.url,width:l.pt2px(A.width)*A.xscale,height:l.pt2px(A.height)*A.yscale,x:l.pt2px(A.xoffset),
y:l.pt2px(A.yoffset)};break;case "text":v=A.color;break;case "cim":v=k.getCIMSymbolColor(A)}return v};a.getPatternUrlWithColor=function(A,x){const v=A+"-"+x;return void 0!==u.get(v)?Promise.resolve(u.get(v)):m(A,{responseType:"image"}).then(B=>{B=B.data;const n=B.naturalWidth,w=B.naturalHeight,D=document.createElement("canvas");D.width=n;D.height=w;const K=D.getContext("2d");K.fillStyle=x;K.fillRect(0,0,n,w);K.globalCompositeOperation="destination-in";K.drawImage(B,0,0);B=D.toDataURL();u.put(v,B);
return B})};a.getStroke=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(a,b,d){function m(t){t=d.toCIMSymbolJSON(t);if("CIMTextSymbol"===t?.type)return t.height??0;let A=0;if(t?.symbolLayers)for(const x of t.symbolLayers)d.isCIMMarker(x)&&null!=x.size&&x.size>A?A=x.size:d.isCIMStroke(x)&&null!=x.width&&x.width>A?A=x.width:d.isCIMFill(x);return A}function p(t,A,x,v){if(t)if("CIMTextSymbol"===
t.type)null!=t.height&&(t.height*=A);else{if(x&&t.effects)for(const B of t.effects)E(B,A);if(t.symbolLayers)for(const B of t.symbolLayers)switch(B.type){case "CIMPictureMarker":case "CIMVectorMarker":l(B,A,v);break;case "CIMPictureStroke":case "CIMSolidStroke":!v?.preserveOutlineWidth&&B.width&&(B.width*=A);break;case "CIMPictureFill":B.height&&(B.height*=A);B.offsetX&&(B.offsetX*=A);B.offsetY&&(B.offsetY*=A);break;case "CIMHatchFill":p(B.lineSymbol,A,!0,{...v,preserveOutlineWidth:!1}),B.offsetX&&
(B.offsetX*=A),B.offsetY&&(B.offsetY*=A),B.separation&&(B.separation*=A)}}}function l(t,A,x){if(t&&(t.markerPlacement&&k(t.markerPlacement,A),t.offsetX&&(t.offsetX*=A),t.offsetY&&(t.offsetY*=A),t.anchorPoint&&"Absolute"===t.anchorPointUnits&&(t.anchorPoint={x:t.anchorPoint.x*A,y:t.anchorPoint.y*A}),t.size=null!=t.size?t.size*A:0,"CIMVectorMarker"===t.type&&t.markerGraphics))for(const v of t.markerGraphics)t.scaleSymbolsProportionally||p(v.symbol,A,!0,x)}function k(t,A){d.isCIMMarkerStrokePlacement(t)&&
t.offset&&(t.offset*=A);switch(t.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":t.customEndingOffset&&(t.customEndingOffset*=A);t.offsetAlongLine&&(t.offsetAlongLine*=A);if(t.placementTemplate&&t.placementTemplate.length){var x=t.placementTemplate.map(v=>v*A);t.placementTemplate=x}break;case "CIMMarkerPlacementAlongLineVariableSize":t.maxRandomOffset&&(t.maxRandomOffset*=A);t.placementTemplate&&t.placementTemplate.length&&(x=t.placementTemplate.map(v=>
v*A),t.placementTemplate=x);break;case "CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=A);break;case "CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=A);break;case "CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=A);t.endPosition&&(t.endPosition*=A);break;case "CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=A);t.offsetY&&(t.offsetY*=A);break;case "CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=A),t.offsetY&&(t.offsetY*=
A),t.stepX&&(t.stepX*=A),t.stepY&&(t.stepY*=A)}}function E(t,A){switch(t.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":t.width&&(t.width*=A);break;case "CIMGeometricEffectBuffer":t.size&&(t.size*=A);break;case "CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=A);t.endCut&&(t.endCut*=A);t.middleCut&&(t.middleCut*=A);break;case "CIMGeometricEffectDashes":t.customEndingOffset&&(t.customEndingOffset*=A);t.offsetAlongLine&&(t.offsetAlongLine*=A);if(t.dashTemplate&&t.dashTemplate.length){const x=
t.dashTemplate.map(v=>v*A);t.dashTemplate=x}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":t.length&&(t.length*=A);break;case "CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=A);t.offsetY&&(t.offsetY*=A);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=A);break;case "CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=A);break;case "CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=
A);t.length&&(t.length*=A);t.toWidth&&(t.toWidth*=A);break;case "CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=A),t.period&&(t.period*=A)}}function q(t,A){if(t){var x="CIMTextSymbol"===t.type?t.symbol:t;t="CIMPolygonSymbol"===t.type;if(x?.symbolLayers)for(const v of x.symbolLayers)if(!(v.colorLocked||t&&(d.isCIMStroke(v)||d.isCIMMarker(v)&&v.markerPlacement&&d.isCIMMarkerStrokePlacement(v.markerPlacement))))switch(v.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":v.tintColor&&
f(A,v.tintColor);break;case "CIMVectorMarker":v.markerGraphics?.forEach(B=>{q(B.symbol,A)});break;case "CIMSolidStroke":case "CIMSolidFill":f(A,v.color);break;case "CIMHatchFill":q(v.lineSymbol,A)}}}function f(t,A){for(const x of t)if(x.join(".")===A.join("."))return;t.push(A)}function u(t,A,x){if(t){var v="CIMTextSymbol"===t.type?t.symbol:t;t="CIMPolygonSymbol"===v?.type;if(v?.symbolLayers)for(const B of v.symbolLayers)if(!B.colorLocked){if(t)if(x){if({layersToColor:v}=x,(d.isCIMStroke(B)||d.isCIMMarker(B)&&
B.markerPlacement&&d.isCIMMarkerStrokePlacement(B.markerPlacement))&&"fill"===v||d.isCIMFill(B)&&"outline"===v)continue}else if(d.isCIMStroke(B)||d.isCIMMarker(B)&&B.markerPlacement&&d.isCIMMarkerStrokePlacement(B.markerPlacement))continue;v=A.toArray();switch(B.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":B.tintColor=v;break;case "CIMVectorMarker":B.markerGraphics?.forEach(n=>{u(n.symbol,A,x)});break;case "CIMSolidStroke":case "CIMSolidFill":B.color=v;break;case "CIMHatchFill":u(B.lineSymbol,
A,x)}}}}a.applyCIMSymbolColor=function(t,A,x){A instanceof b||(A=new b(A));(t=d.toCIMSymbolJSON(t))&&u(t,A,x)};a.applyCIMSymbolRotation=function(t,A,x=!1){t=d.toCIMSymbolJSON(t);x&&(A=360-A);if("CIMTextSymbol"===t?.type)t.angle=A;else if("CIMPointSymbol"===t?.type&&t.symbolLayers){x=A-(t.angle||0);for(const v of t.symbolLayers)if(d.isCIMMarker(v)){let B=v.rotation||0;B=v.rotateClockwise?B-x:B+x;v.rotation=B}t.angle=A}};a.getCIMSymbolColor=function(t){t=d.toCIMSymbolJSON(t);const A=[];q(t,A);return A.length?
new b(d.normalizeAlpha(A[0])):null};a.getCIMSymbolRotation=function(t,A=!1){t=d.toCIMSymbolJSON(t);return"CIMTextSymbol"===t?.type||"CIMPointSymbol"===t?.type?(t=t.angle,null!=t&&A?360-t:t??0):0};a.getCIMSymbolSize=m;a.getCIMSymbolType=function(t){t=d.toCIMSymbolJSON(t);if(!t)return null;switch(t.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";
default:return null}};a.scaleCIMMarker=l;a.scaleCIMSymbol=p;a.scaleCIMSymbolTo=function(t,A,x){if(t){var v=d.toCIMSymbolJSON(t);t=m(t);if(0===t){if(v)if("CIMTextSymbol"===v.type)v.height=A;else if(v.symbolLayers)for(const B of v.symbolLayers)switch(B.type){case "CIMPictureMarker":case "CIMVectorMarker":B.size=A;break;case "CIMPictureStroke":case "CIMSolidStroke":B.width=A}}else p(v,A/t,!1,x)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports",
"../../Color"],function(a,b){function d(m,p){return Math.round(Math.min(Math.max(m+191.25*p,0),255))}a.SymbolSizeDefaults=void 0;(function(m){m[m.size=22]="size";m[m.lineWidth=50]="lineWidth";m[m.maxSize=120]="maxSize";m[m.maxOutlineSize=80]="maxOutlineSize";m[m.tallSymbolWidth=20]="tallSymbolWidth"})(a.SymbolSizeDefaults||(a.SymbolSizeDefaults={}));a.adjustColorBrightness=function(m,p){if(null==m)return new b;if("type"in m&&("linear"===m.type||"pattern"===m.type))return m;m=new b(m);return new b([d(m.r,
p),d(m.g,p),d(m.b,p),m.a])};a.adjustColorComponentBrightness=d;a.getConeShapes=function(m,p){let l=p?a.SymbolSizeDefaults.tallSymbolWidth:m;p=p?4:6;l=l<=a.SymbolSizeDefaults.size?l-.5*p:l-p;p=.15*l;const k=l;m-=p;return[{type:"ellipse",cx:.5*l,cy:m,rx:.5*l,ry:p},{type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,m]},{command:"L",values:[0,m]},{command:"Z",values:[]}]}]};a.getCubeShapes=function(m,p){let l=p?a.SymbolSizeDefaults.tallSymbolWidth:m;var k=p?4:6;k=l=l<=a.SymbolSizeDefaults.size?
l-.5*k:l-k;p=p?.35*l:.5*l;return[{type:"path",path:[{command:"M",values:[.5*k,0]},{command:"L",values:[k,.5*p]},{command:"L",values:[.5*k,p]},{command:"L",values:[0,.5*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*p]},{command:"L",values:[.5*k,p]},{command:"L",values:[.5*k,m]},{command:"L",values:[0,m-.5*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*k,p]},{command:"L",values:[.5*k,m]},{command:"L",values:[k,m-.5*p]},{command:"L",values:[k,.5*
p]},{command:"Z",values:[]}]}]};a.getCylinderShapes=function(m,p){var l=p?a.SymbolSizeDefaults.tallSymbolWidth:m;p=p?4:6;l=l<=a.SymbolSizeDefaults.size?l-.5*p:l-p;p=.5*l;const k=.15*l;m-=k;return[{type:"ellipse",cx:.5*l,cy:m,rx:p,ry:k},{type:"path",path:[{command:"M",values:[0,k]},{command:"L",values:[0,m]},{command:"L",values:[l,m]},{command:"L",values:[l,k]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*l,cy:k,rx:p,ry:k}]};a.getDiamondShapes=function(m){var p=m;p=p<a.SymbolSizeDefaults.size?p-
2:p-4;const l=Math.floor(m/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*p,0]},{command:"L",values:[p,.5*m-l]},{command:"L",values:[.45*p-l,.5*m+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*p,0]},{command:"L",values:[.45*p-l,.5*m+l]},{command:"L",values:[0,.5*m-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*m-l]},{command:"L",values:[.45*p-l,.5*m+l]},{command:"L",values:[.45*p,m]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*p,m]},{command:"L",values:[p,.5*m-l]},{command:"L",values:[.45*p-l,.5*m+l]},{command:"Z",values:[]}]}]};a.getExtrudeSymbolShapes=function(m){const p=a.SymbolSizeDefaults.size;m*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*p]},{command:"L",values:[.3*p,.7*p]},{command:"L",values:[.3*p,.7*p+m]},{command:"L",values:[0,.7*p+m-.35*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*p,.7*p]},{command:"L",values:[.3*p,.7*p+m]},{command:"L",values:[p,m]},{command:"L",
values:[p,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*p,0]},{command:"L",values:[p,0]},{command:"L",values:[.3*p,.7*p]},{command:"L",values:[0,.35*p]},{command:"Z",values:[]}]}]};a.getInvertedConeShapes=function(m){let p=m;p=p<a.SymbolSizeDefaults.size?p-3:p-6;const l=.15*p,k=p;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[k,0]},{command:"L",values:[.5*k,m-l]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*p,cy:0,rx:.5*p,ry:l}]};a.getPathSymbolShapes=
function(m,p,l){var k=a.SymbolSizeDefaults.size;let E=k,q=k;1>m?E*=.75:1<m&&(q*=1.25);m=k;p&&l&&(E=q=m=k=0);return[{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[l?m:.875*m,0]},{command:"L",values:[l?E-.5*m:0,q-.5*k]},{command:"L",values:[E-.5*m,q-.5*k]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[m,0]},{command:"L",values:[m,p?0:.125*k]},{command:"L",values:[E-.5*m,p?q-.5*k:k]},{command:"L",values:[E-.5*m,q-.5*k]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[E-.5*m,q-.5*k]},{command:"L",values:[l?E-.5*m:0,q-.5*k]},{command:"L",values:[l?E-.5*m:0,p?q-.5*k:k]},{command:"L",values:[E-.5*m,p?q-.5*k:k]},{command:"Z",values:[]}]}]};a.getTetrahedronShapes=function(m){var p=m;p=p<a.SymbolSizeDefaults.size?p-1:p-2;return[{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[m,p]},{command:"L",values:[.45*m,.6*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[.45*m,.6*p]},{command:"L",
values:[0,p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,p]},{command:"L",values:[.45*m,.6*p]},{command:"L",values:[m,p]},{command:"Z",values:[]}]}]};a.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
a.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(a,b,d,m,p,l,k,E,q,f){function u(x,v){A.append(x,v);A.detach(v)}function t(x,v,B){return x?d(x,{responseType:"image"}).then(n=>{n=n.data;const w=n.width,D=
n.height,K=w/D;let N=v;B&&(N=Math.min(N,Math.max(w,D)));return{image:n,width:1>=K?Math.ceil(N*K):N,height:1>=K?N:Math.ceil(N/K)}}):Promise.reject(new p("renderUtils: imageDataSize","href not provided."))}const A=E.createProjector();a.renderOnce=u;a.renderSymbol=function(x,v,B){const n=Math.ceil(v[0]),w=Math.ceil(v[1]);if(!x.some(D=>!!D.length))return null;v=B?.node||document.createElement("div");null!=B.opacity&&(v.style.opacity=B.opacity.toString());null!=B.effectView&&(v.style.filter=f.getCSSFilterFromEffectList(B.effectView));
u(v,()=>q.renderSVG(x,n,w,B));return v};a.tintImageWithColor=function(x,v,B,n,w){return t(x,v,w).then(D=>{const K=D.width??v,N=D.height??v;var G;if(G=D.image)G=B&&"ignore"!==n?"multiply"===n&&255===B.r&&255===B.g&&255===B.b&&1===B.a?!1:!0:!1;if(G){var P=D.image.width,z=D.image.height;l("edge")&&/\.svg$/i.test(x)&&(--P,--z);G=Math.ceil(K);var C=Math.ceil(N);var L=document.createElement("canvas");L.width=G;L.height=C;L.style.width=G+"px";L.style.height=C+"px";L=L.getContext("2d");L.clearRect(0,0,G,
C);G=L;G.drawImage(D.image,0,0,P,z,0,0,K,N);C=G.getImageData(0,0,K,N);L=[B.r/255,B.g/255,B.b/255,B.a];const r=m.toHSV(B);for(let J=0;J<C.data.length;J+=4){D=C.data;P=J;z=L;var S=r;switch(n){case "multiply":D[P]*=z[0];D[P+1]*=z[1];D[P+2]*=z[2];D[P+3]*=z[3];break;default:const M=m.toHSV({r:D[P],g:D[P+1],b:D[P+2]});M.h=S.h;M.s=S.s;M.v=M.v/100*S.v;S=m.toRGB(M);D[P]=S.r;D[P+1]=S.g;D[P+2]=S.b;D[P+3]*=z[3]}}G.putImageData(C,0,0);x=G.canvas.toDataURL("image/png")}else G=b.id?.findCredential(x),G?.token&&
(D=x.includes("?")?"\x26":"?",x=`${x}${D}token=${G.token}`);return{url:x,width:K,height:N}}).catch(()=>({url:x,width:v,height:v}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ./svgGlobalState ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(a,
b,d,m,p,l,k,E,q,f){function u(h,e){h*=H/180;return Math.abs(e*Math.sin(h))+Math.abs(e*Math.cos(h))}function t(h){return h.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function A(h,e,c,g,F){if(h){if("circle"===h.type)return f.tsx("circle",{cx:h.cx,cy:h.cy,fill:e,"fill-rule":"evenodd",r:h.r,stroke:c.color,"stroke-dasharray":c.dashArray,"stroke-dashoffset":c.dashOffset,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-miterlimit":"4","stroke-width":c.width});if("ellipse"===h.type)return f.tsx("ellipse",
{cx:h.cx,cy:h.cy,fill:e,"fill-rule":"evenodd",rx:h.rx,ry:h.ry,stroke:c.color,"stroke-dasharray":c.dashArray,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-miterlimit":"4","stroke-width":c.width});if("rect"===h.type)return f.tsx("rect",{fill:e,"fill-rule":"evenodd",height:h.height,stroke:c.color,"stroke-dasharray":c.dashArray,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-miterlimit":"4","stroke-width":c.width,width:h.width,x:h.x,y:h.y});if("image"===h.type)return f.tsx("image",{alt:F||
"image",height:h.height,href:h.src,preserveAspectRatio:"none",width:h.width,x:h.x,y:h.y});if("path"===h.type)return h="string"!==typeof h.path?t(h.path):h.path,f.tsx("path",{d:h,fill:e,"fill-rule":"evenodd",stroke:c.color,"stroke-dasharray":c.dashArray,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-miterlimit":"4","stroke-width":c.width});if("text"===h.type)return m.assertIsSome(g),f.tsx("text",{"dominant-baseline":g.dominantBaseline,fill:e,"fill-rule":"evenodd","font-family":g.font.family,
"font-size":g.font.size,"font-style":g.font.style,"font-variant":g.font.variant,"font-weight":g.font.weight,kerning:g.kerning,rotate:g.rotate,stroke:c.color,"stroke-dasharray":c.dashArray,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-miterlimit":"4","stroke-width":c.width,"text-anchor":g.align,"text-decoration":g.decoration,"text-rendering":S,x:h.x,y:h.y},h.text)}return null}function x(h){if(!h)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in h))return{fill:(new b(h)).toString(),
pattern:null,linearGradient:null};if("pattern"===h.type){var e=`patternId-${E.nextPatternId()}`;return{fill:`url(#${e})`,pattern:{id:e,x:h.x,y:h.y,width:h.width,height:h.height,image:{x:0,y:0,width:h.width,height:h.height,href:h.src}},linearGradient:null}}e=`linearGradientId-${E.nextLinearGradientId()}`;return{fill:`url(#${e})`,pattern:null,linearGradient:{id:e,x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,stops:h.colors.map(c=>({offset:c.offset,color:c.color&&(new b(c.color)).toString()}))}}}function v(h){const e=
{color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};h&&(null!=h.width&&(e.width=h.width),h.cap&&(e.cap=h.cap),h.join&&(e.join=h.join.toString()),h.color&&(e.color=(new b(h.color)).toString()),h.dashArray&&(e.dashArray=h.dashArray),h.dashoffset&&(e.dashOffset=h.dashoffset),h.style&&!h.dashArray&&(e.dashArray=k.getDashArray(h).join(",")||"none"));return e}function B(h,e){const c={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,
family:null}};if(h){const g=h.alignBaseline;c.align=h.align;c.dominantBaseline="baseline"===g?"auto":"top"===g?"text-top":"bottom"===g?"hanging":g;c.decoration=h.decoration;c.kerning=h.kerning?"auto":"0";c.rotate=h.rotated?"90":"0";m.assertIsSome(e);c.font.style=e.style||"normal";c.font.variant=e.variant||"normal";c.font.weight=e.weight||"normal";c.font.size=e.size&&e.size.toString()||"10pt";c.font.family=e.family||"serif"}return c}function n(h){const {pattern:e,linearGradient:c}=h;return e?f.tsx("pattern",
{height:e.height,id:e.id,patternUnits:"userSpaceOnUse",width:e.width,x:e.x,y:e.y},f.tsx("image",{height:e.image.height,href:e.image.href,width:e.image.width,x:e.image.x,y:e.image.y})):c?(h=c.stops.map((g,F)=>f.tsx("stop",{key:`${F}-stop`,offset:g.offset,"stop-color":g.color})),f.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:c.id,x1:c.x1,x2:c.x2,y1:c.y1,y2:c.y2},h)):null}function w(h,e){if(!h||0===h.length)return null;const c=[];for(const g of h){const {shape:F,fill:I,stroke:O,font:R}=g;
h=x(I);const W=v(O),V="text"===F.type?B(F,R):null;(h=A(F,h.fill,W,V))&&c.push(h)}return f.tsx("mask",{id:e,maskUnits:"userSpaceOnUse"},f.tsx("g",null,c))}function D(h,e,c,g,F){l.scale(h,l.identity(h),[e,c]);h[4]=h[4]*e-g*e+g;h[5]=h[5]*c-F*c+F;return h}function K(h,e){if(M&&"left"in M){null!=M.left&&M.left>h&&(M.left=h);if(null==M.right||M.right<h)M.right=h;if(null==M.top||M.top>e)M.top=e;if(null==M.bottom||M.bottom<e)M.bottom=e}else M={left:h,bottom:e,right:h,top:e}}function N(h){const e=h.args,c=
e.length;switch(h.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(h=0;h<c;h+=2)K(e[h],e[h+1]);y.x=e[c-2];y.y=e[c-1];break;case "H":for(h=0;h<c;++h)K(e[h],y.y);y.x=e[c-1];break;case "V":for(h=0;h<c;++h)K(y.x,e[h]);y.y=e[c-1];break;case "m":h=0;"x"in y||(K(y.x=e[0],y.y=e[1]),h=2);for(;h<c;h+=2)K(y.x+=e[h],y.y+=e[h+1]);break;case "l":case "t":for(h=0;h<c;h+=2)K(y.x+=e[h],y.y+=e[h+1]);break;case "h":for(h=0;h<c;++h)K(y.x+=e[h],y.y);break;case "v":for(h=0;h<c;++h)K(y.x,y.y+=e[h]);break;
case "c":for(h=0;h<c;h+=6)K(y.x+e[h],y.y+e[h+1]),K(y.x+e[h+2],y.y+e[h+3]),K(y.x+=e[h+4],y.y+=e[h+5]);break;case "s":case "q":for(h=0;h<c;h+=4)K(y.x+e[h],y.y+e[h+1]),K(y.x+=e[h+2],y.y+=e[h+3]);break;case "A":for(h=0;h<c;h+=7)K(e[h+5],e[h+6]);y.x=e[c-2];y.y=e[c-1];break;case "a":for(h=0;h<c;h+=7)K(y.x+=e[h+5],y.y+=e[h+6])}}function G(h,e,c){const g=r[h.toLowerCase()];"number"===typeof g&&(g?e.length>=g&&(h={action:h,args:e.slice(0,e.length-e.length%g)},c.push(h),N(h)):(h={action:h,args:[]},c.push(h),
N(h)))}function P(h){const e={x:0,y:0,width:0,height:0};if("circle"===h.type)e.x=h.cx-h.r,e.y=h.cy-h.r,e.width=2*h.r,e.height=2*h.r;else if("ellipse"===h.type)e.x=h.cx-h.rx,e.y=h.cy-h.ry,e.width=2*h.rx,e.height=2*h.ry;else if("image"===h.type||"rect"===h.type)e.x=h.x,e.y=h.y,e.width=h.width,e.height=h.height;else if("path"===h.type){{const F=("string"!==typeof h.path?t(h.path):h.path).match(J),I=[];M={};y={};if(F){h="";var c=[],g=F.length;for(let O=0;O<g;++O){const R=F[O],W=parseFloat(R);isNaN(W)?
(h&&G(h,c,I),c=[],h=R):c.push(W)}G(h,c,I);h={x:0,y:0,width:0,height:0};M&&"left"in M&&(h.x=M.left,h.y=M.top,h.width=M.right-M.left,h.height=M.bottom-M.top)}else h=null}e.x=h.x;e.y=h.y;e.width=h.width;e.height=h.height}return e}function z(h){const e={x:0,y:0,width:0,height:0};let c=null,g=Number.NEGATIVE_INFINITY,F=Number.NEGATIVE_INFINITY;for(const I of h)c?(c.x=Math.min(c.x,I.x),c.y=Math.min(c.y,I.y),g=Math.max(g,I.x+I.width),F=Math.max(F,I.y+I.height)):(c=e,c.x=I.x,c.y=I.y,g=I.x+I.width,F=I.y+I.height);
c&&(c.width=g-c.x,c.height=F-c.y);return c}function C(h,e,c,g,F,I,O,R,W){var V=(O&&I?u(I,e):e)/2,aa=(O&&I?u(I,c):c)/2;if(W){var fa=W[0];W=W[1];V=(O&&I?u(I,fa):fa)/2;aa=(O&&I?u(I,W):W)/2}fa=h.width+g;const ja=h.height+g;O=p.create();W=p.create();var da=!1;if(F&&0!==fa&&0!==ja){F=e!==c?e/c:fa/ja;da=e>c?e:c;let Z=1,ka=1;isNaN(da)||(1<F?(Z=da/fa,ka=da/F/ja):(ka=da/ja,Z=da*F/fa));l.multiply(W,W,D(O,Z,ka,V,aa));da=!0}F=h.x+(fa-g)/2;h=h.y+(ja-g)/2;g=l.multiply;V-=F;aa-=h;V=l.translate(O,l.identity(O),[V,
aa]);g.call(l,W,W,V);!da&&(fa>e||ja>c)&&(V=fa/e>ja/c,e=(V?e:c)/(V?fa:ja),l.multiply(W,W,D(O,e,e,F,h)));R&&(e=l.multiply,c=R[0],R=R[1],R=l.translate(O,l.identity(O),[c,R]),e.call(l,W,W,R));I&&(R=l.multiply,e=I%360*Math.PI/180,l.rotate(O,l.identity(O),e),I=Math.cos(e),e=Math.sin(e),c=O[4],fa=O[5],O[4]=c*I-fa*e+h*e-F*I+F,O[5]=fa*I+c*e-F*e-h*I+h,R.call(l,W,W,O));return`matrix(${W[0]},${W[1]},${W[2]},${W[3]},${W[4]},${W[5]})`}function L(h,e,c){h=h?.effects.find(R=>"bloom"===R.type);if(!h)return null;const {strength:g,
radius:F}=h;h=0<g?F:0;const I=(g+h)*e,O=4*g+1;return f.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${c}`,width:"300%",x:"-100%",y:"-100%"},f.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(g+.5*h)*5**(e/100)*(.4+e/100),result:"dilate"}),f.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:I/25}),f.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:I/50}),f.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
f.tsx("feFuncR",{slope:O,type:"linear"}),f.tsx("feFuncG",{slope:O,type:"linear"}),f.tsx("feFuncB",{slope:O,type:"linear"})),f.tsx("feMerge",null,f.tsx("feMergeNode",{in:"intensityBlur"}),f.tsx("feMergeNode",{in:"intensityBrightness"}),f.tsx("feGaussianBlur",{stdDeviation:g/10})))}q=d("android");const S=d("chrome")||q&&4<=q?"auto":"optimizeLegibility",r={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},J=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let M={},y={};const H=Math.PI;a.computeBBox=z;a.generateFillAttributes=
x;a.generateStrokeAttributes=v;a.generateTextAttributes=B;a.getBoundingBox=P;a.getTransformMatrix=C;a.renderDef=n;a.renderSVG=function(h,e,c,g={}){const F=[],I=[],O=E.nextBloomId(),R=L(g.effectView,e,O);var W=null;R&&(W=g.effectView?.effects.find(T=>"bloom"===T.type),W=(W.strength?W.strength+W.radius/2:0)/3,W=[Math.max(e+e*W,10),Math.max(c+c*W,10)]);let V=e,aa=c;if(g.useRotationSize)for(var fa=0;fa<h.length;fa++){var ja=g.rotations?.[fa]??0;V=Math.max(u(ja,e),V);aa=Math.max(u(ja,c),aa)}for(fa=0;fa<
h.length;fa++){var da=h[fa];ja=[];var Z=[],ka=0,la=0;let T=0;for(const U of da){const {shape:ba,fill:ha,stroke:ma,font:Q,offset:X}=U;g.ignoreStrokeWidth||"text"===ba.type||(ka+=ma?.width||0);da=x(ha);const ea=v(ma),ia="text"===ba.type?B(ba,Q):null;F.push(n(da));ja.push(A(ba,da.fill,ea,ia,g.ariaLabel));Z.push(P(ba));X&&(la+=X[0],T+=X[1])}da=g.rotations?.[fa]??0;g.useRotationSize&&(la+=(V-u(da,e))/2,T+=(aa-u(da,c))/2);Z=z(Z);ka=C(Z,e,c,ka,g.scale??!1,da,g.useRotationSize??!1,[la,T],W);la=null;g.masking&&
(la=`mask-${fa}`,F.push(w(g.masking[fa],la)),la=`url(#${la})`);I.push(la?f.tsx("g",{mask:la},f.tsx("g",{transform:ka},ja)):f.tsx("g",{transform:ka},ja))}R&&(m.assertIsSome(W),V=W[0],aa=W[1]);return f.tsx("svg",{"aria-label":g.ariaLabel,focusable:!1,height:aa,role:"img",style:"display: block;",width:V,xmlns:"http://www.w3.org/2000/svg"},R,f.tsx("defs",null,F),R?f.tsx("g",{filter:`url(#bloom${O})`},I):I)};a.renderShape=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],
function(a){function b(){const q=new Float32Array(6);q[0]=1;q[3]=1;return q}function d(q){const f=new Float32Array(6);f[0]=q[0];f[1]=q[1];f[2]=q[2];f[3]=q[3];f[4]=q[4];f[5]=q[5];return f}function m(q,f,u,t,A,x){const v=new Float32Array(6);v[0]=q;v[1]=f;v[2]=u;v[3]=t;v[4]=A;v[5]=x;return v}function p(q,f){return new Float32Array(q,f,6)}function l(q,f,u,t){const A=f[t];f=f[t+1];q[t]=u[0]*A+u[2]*f+u[4];q[t+1]=u[1]*A+u[3]*f+u[5]}function k(q,f,u,t=0,A=0,x=2){for(A=A||f.length/x;t<A;t++)l(q,f,u,t*x)}const E=
Object.freeze(Object.defineProperty({__proto__:null,clone:d,create:b,createView:p,fromValues:m,transform:l,transformMany:k},Symbol.toStringTag,{value:"Module"}));a.clone=d;a.create=b;a.createView=p;a.fromValues=m;a.mat2df32=E;a.transform=l;a.transformMany=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(a,b){function d(z,C){z[0]=C[0];z[1]=C[1];z[2]=C[2];z[3]=C[3];z[4]=C[4];z[5]=C[5];return z}
function m(z){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=0;z[5]=0;return z}function p(z,C,L,S,r,J,M){z[0]=C;z[1]=L;z[2]=S;z[3]=r;z[4]=J;z[5]=M;return z}function l(z,C){const L=C[0],S=C[1],r=C[2],J=C[3],M=C[4];C=C[5];let y=L*J-S*r;if(!y)return null;y=1/y;z[0]=J*y;z[1]=-S*y;z[2]=-r*y;z[3]=L*y;z[4]=(r*C-J*M)*y;z[5]=(S*M-L*C)*y;return z}function k(z){return z[0]*z[3]-z[1]*z[2]}function E(z,C,L){const S=C[0],r=C[1],J=C[2],M=C[3],y=C[4];C=C[5];const H=L[0],h=L[1],e=L[2],c=L[3],g=L[4];L=L[5];z[0]=S*H+J*h;z[1]=r*H+
M*h;z[2]=S*e+J*c;z[3]=r*e+M*c;z[4]=S*g+J*L+y;z[5]=r*g+M*L+C;return z}function q(z,C,L){const S=C[0],r=C[1],J=C[2],M=C[3],y=C[4];C=C[5];const H=Math.sin(L);L=Math.cos(L);z[0]=S*L+J*H;z[1]=r*L+M*H;z[2]=S*-H+J*L;z[3]=r*-H+M*L;z[4]=y;z[5]=C;return z}function f(z,C,L){const S=C[1],r=C[2],J=C[3],M=C[4],y=C[5],H=L[0];L=L[1];z[0]=C[0]*H;z[1]=S*H;z[2]=r*L;z[3]=J*L;z[4]=M;z[5]=y;return z}function u(z,C,L){const S=C[0],r=C[1],J=C[2],M=C[3],y=C[4];C=C[5];const H=L[0];L=L[1];z[0]=S;z[1]=r;z[2]=J;z[3]=M;z[4]=S*
H+J*L+y;z[5]=r*H+M*L+C;return z}function t(z,C){const L=Math.sin(C);C=Math.cos(C);z[0]=C;z[1]=L;z[2]=-L;z[3]=C;z[4]=0;z[5]=0;return z}function A(z,C){z[0]=C[0];z[1]=0;z[2]=0;z[3]=C[1];z[4]=0;z[5]=0;return z}function x(z,C){z[0]=1;z[1]=0;z[2]=0;z[3]=1;z[4]=C[0];z[5]=C[1];return z}function v(z){return"mat2d("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+", "+z[4]+", "+z[5]+")"}function B(z){return Math.sqrt(z[0]**2+z[1]**2+z[2]**2+z[3]**2+z[4]**2+z[5]**2+1)}function n(z,C,L){z[0]=C[0]+L[0];z[1]=C[1]+L[1];z[2]=
C[2]+L[2];z[3]=C[3]+L[3];z[4]=C[4]+L[4];z[5]=C[5]+L[5];return z}function w(z,C,L){z[0]=C[0]-L[0];z[1]=C[1]-L[1];z[2]=C[2]-L[2];z[3]=C[3]-L[3];z[4]=C[4]-L[4];z[5]=C[5]-L[5];return z}function D(z,C,L){z[0]=C[0]*L;z[1]=C[1]*L;z[2]=C[2]*L;z[3]=C[3]*L;z[4]=C[4]*L;z[5]=C[5]*L;return z}function K(z,C,L,S){z[0]=C[0]+L[0]*S;z[1]=C[1]+L[1]*S;z[2]=C[2]+L[2]*S;z[3]=C[3]+L[3]*S;z[4]=C[4]+L[4]*S;z[5]=C[5]+L[5]*S;return z}function N(z,C){return z[0]===C[0]&&z[1]===C[1]&&z[2]===C[2]&&z[3]===C[3]&&z[4]===C[4]&&z[5]===
C[5]}function G(z,C){const L=z[0],S=z[1],r=z[2],J=z[3],M=z[4];z=z[5];const y=C[0],H=C[1],h=C[2],e=C[3],c=C[4];C=C[5];const g=b.getEpsilon();return Math.abs(L-y)<=g*Math.max(1,Math.abs(L),Math.abs(y))&&Math.abs(S-H)<=g*Math.max(1,Math.abs(S),Math.abs(H))&&Math.abs(r-h)<=g*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(J-e)<=g*Math.max(1,Math.abs(J),Math.abs(e))&&Math.abs(M-c)<=g*Math.max(1,Math.abs(M),Math.abs(c))&&Math.abs(z-C)<=g*Math.max(1,Math.abs(z),Math.abs(C))}const P=Object.freeze(Object.defineProperty({__proto__:null,
add:n,copy:d,determinant:k,equals:G,exactEquals:N,frob:B,fromRotation:t,fromScaling:A,fromTranslation:x,identity:m,invert:l,mul:E,multiply:E,multiplyScalar:D,multiplyScalarAndAdd:K,rotate:q,scale:f,set:p,str:v,sub:w,subtract:w,translate:u},Symbol.toStringTag,{value:"Module"}));a.add=n;a.copy=d;a.determinant=k;a.equals=G;a.exactEquals=N;a.frob=B;a.fromRotation=t;a.fromScaling=A;a.fromTranslation=x;a.identity=m;a.invert=l;a.mat2d=P;a.mul=E;a.multiply=E;a.multiplyScalar=D;a.multiplyScalarAndAdd=K;a.rotate=
q;a.scale=f;a.set=p;a.str=v;a.sub=w;a.subtract=w;a.translate=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgGlobalState":function(){define(["exports"],function(a){function b(E=0){p=E}function d(E=0){l=E}function m(E=0){k=E}let p=0,l=0,k=0;a.nextBloomId=function(){return k++};a.nextLinearGradientId=function(){return l++};a.nextPatternId=function(){return p++};a.resetBloomId=m;a.resetLinearGradientId=d;a.resetPatternId=b;a.resetSVGGlobalState=function(){b();
d();m()};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(a,b,d,m,p,l,k,E,q,f,u,t){function A(z){z=z.symbolLayers;if(!z)return null;let C=null;z.forEach(L=>{"object"===L.type&&L.resource?.href||
(C="water"===L.type?L.color:L.material?L.material.color:null)});return C?new d(C):null}function x(z,C){if(null==C||null==z)return z;z=z.toRgba();z[3]*=C;return new d(z)}function v(z,C,L){if(z=z.symbolLayers){var S=r=>{C=C??r??(null!=L?P:null);return x(C,L)};z.forEach(r=>{if("object"!==r.type||!r.resource?.href||C)if("water"===r.type)r.color=S(r.color);else{const J=S(null!=r.material?r.material.color:null);null==r.material?r.material=new t.Symbol3DMaterial({color:J}):r.material.color=J;null!=L&&"outline"in
r&&null!=r.outline?.color&&(r.outline.color=x(r.outline.color,L))}})}}async function B(z,C){(z=z.symbolLayers)&&await p.forEach(z,async L=>n(L,C))}async function n(z,C){switch(z.type){case "extrude":z.size="number"===typeof C[2]?C[2]:0;break;case "icon":case "line":case "text":C=w(C);null!=C&&(z.size=C);break;case "path":const L=K(C,E.ONES,[z.width,void 0,z.height]);z.width=G(C[0],z.width,1,L);z.height=G(C[2],z.height,1,L);break;case "object":await D(z,C)}}function w(z){for(const C of z)if("number"===
typeof C)return C;return null}async function D(z,C){const {resourceSize:L,symbolSize:S}=await N(z),r=K(C,L,S);z.width=G(C[0],S[0],L[0],r);z.depth=G(C[1],S[1],L[1],r);z.height=G(C[2],S[2],L[2],r)}function K(z,C,L){for(let S=0;3>S;S++){const r=z[S];switch(r){case "symbol-value":return z=L[S],null!=z?z/C[S]:1;case "proportional":break;default:if(r&&C[S])return r/C[S]}}return 1}async function N(z){var {computeObjectLayerResourceSize:C}=await new Promise((y,H)=>a(["./symbolLayerUtils"],y,H));C=await C(z,
10);const {width:L,height:S,depth:r}=z;z=[L,r,S];let J=1;for(var M=0;3>M;M++){const y=z[M];if(null!=y){J=y/C[M];break}}for(M=0;3>M;M++)null==z[M]&&(z[M]=C[M]*J);return{resourceSize:C,symbolSize:z}}function G(z,C,L,S){switch(z){case "proportional":return L*S;case "symbol-value":return null!=C?C:L;default:return z}}const P=new d("white");b.applyColorToSymbol=function(z,C,L){if(z&&(C||null!=L))if(C&&=new d(C),m.isSymbol3D(z))v(z,C,L);else if(m.isSymbol2D(z)){if(C=C??z.color)z.color=x(C,L);null!=L&&"outline"in
z&&z.outline?.color&&(z.outline.color=x(z.outline.color,L))}};b.applyOpacityToColor=x;b.applyRotationToSymbol=function(z,C,L){z&&null!=C&&(m.isSymbol3D(z)?(z=z.symbolLayers)&&z.forEach(S=>{if("object"===S.type)switch(L){case "tilt":S.tilt=(S.tilt??0)+C;break;case "roll":S.roll=(S.roll??0)+C;break;default:S.heading=(S.heading??0)+C}"icon"===S.type&&(S.angle+=C)}):!m.isSymbol2D(z)||"simple-marker"!==z.type&&"picture-marker"!==z.type&&"text"!==z.type||(z.angle+=C))};b.applySizesToSymbol=async function(z,
C){if(z&&C){if(m.isSymbol3D(z))return B(z,C);if(m.isSymbol2D(z)&&(C=w(C),null!=C))switch(z.type){case "simple-marker":z.size=C;break;case "picture-marker":const L=z.width/z.height;1<L?(z.width=C,z.height=C*L):(z.width=C*L,z.height=C);break;case "simple-line":z.width=C;break;case "text":z.font.size=C}}};b.fetchWebStyleSymbol=async function(z,C){const L=await z.fetchSymbol(C);return L?L:z.fetchCIMSymbol(C)};b.getCSSFilterFromEffectList=function(z){if(!z)return null;z=z.effects.filter(C=>"bloom"!==C.type).map(C=>
C.toJSON());return q.effectFunctionsFromJSON(z)};b.getColorFromSymbol=function(z,C){if(!z)return null;let L=null;m.isSymbol3D(z)?L=A(z):m.isSymbol2D(z)&&(L="cim"===z.type?f.getCIMSymbolColor(z):z.color?new d(z.color):null);return L?x(L,C):null};b.getIconHref=function(z){return z.resource?.href??""};b.getSymbolOutlineSize=function(z){return z?m.isSymbol3D(z)?(z=(z=z.symbolLayers?.at(-1))&&"outline"in z?z?.outline?.size:void 0,null!=z?z:0):k.px2pt(u.getStroke(z)?.width):0};b.isVolumetricSymbol=function(z){if(null==
z||!("symbolLayers"in z)||null==z.symbolLayers)return!1;switch(z.type){case "point-3d":return z.symbolLayers.some(C=>"object"===C.type);case "line-3d":return z.symbolLayers.some(C=>"path"===C.type);case "polygon-3d":return z.symbolLayers.some(C=>"object"===C.type||"extrude"===C.type);default:return!1}};b.symbolHasExtrudeSymbolLayer=function(z){return null!=z&&"polygon-3d"===z.type&&z.symbolLayers.some(C=>"extrude"===C.type)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports",
"../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(a,b,d,m,p){function l(q,f,u){const t=`${u}_arrowStart`;u=`${u}_arrowEnd`;q="left"===q;const A={markerStart:null,markerEnd:null};switch(f){case "HL":q?A.markerStart=`url(#${u})`:A.markerEnd=`url(#${t})`;break;case "LL":A.markerStart=`url(#${u})`;break;case "LH":q?A.markerEnd=`url(#${t})`:A.markerStart=`url(#${u})`;break;default:A.markerEnd=`url(#${t})`}return A}
function k(q,f,u={}){const {focus:t,numClasses:A,colors:x,rotation:v}=q,{opacity:B,effectList:n,ariaLabel:w}=u;q=u.size??60;u=!!t;const D=Math.sqrt(q**2+q**2)+(u?0:5),K=[],N=[];var G=[],P=(q||75)/A;for(var z=0;z<A;z++){var C=z*P;for(var L=0;L<A;L++){var S=L*P,r=b.generateFillAttributes(x[z][L]);const J=b.generateStrokeAttributes(null);S={type:"rect",x:S,y:C,width:P,height:P};const M=b.renderDef(r);M&&K.push(M);(r=b.renderShape(S,r.fill,J,null))&&N.push(r);G.push(b.getBoundingBox(S))}}P=null;u||(P=
"margin: -15px -15px -18px -15px");z=l("left",t,f);C=l("right",t,f);L=b.computeBBox(G);G=b.getTransformMatrix(L,D,D,0,!1,v,!1);L=b.getTransformMatrix(L,D,D,0,!1,u?-45:null,!1);r={filter:d.getCSSFilterFromEffectList(n)??void 0,opacity:null==B?"":`${B}`};return p.tsx("div",{class:u?E.diamondMidColRamp:E.squareTableCell,styles:r},p.tsx("svg",{"aria-label":w,focusable:!1,height:D,role:"image",style:P,width:D,xmlns:"http://www.w3.org/2000/svg"},p.tsx("defs",null,p.tsx("marker",{id:`${f}_arrowStart`,markerHeight:"10",
markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},p.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),p.tsx("marker",{id:`${f}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},p.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),K),p.tsx("g",{transform:G},N),p.tsx("g",{transform:L},p.tsx("line",{fill:"none","marker-end":z.markerEnd,"marker-start":z.markerStart,
stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:q-15,y2:15}),p.tsx("line",{fill:"none","marker-end":C.markerEnd,"marker-start":C.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:q-15,y1:q+10,y2:q+10}))))}const E={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",
diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",
squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};a.renderRelationshipRamp=function(q,f,u={}){const {focus:t,labels:A}=q,x=!!t;q=k(q,f,u);const v={justifyContent:"center"},B=m.isRTL();f=u.key??f;return x?p.tsx("div",{class:E.diamondContainer,key:`${f}-container`,styles:v},p.tsx("div",{class:E.diamondLeftCol},B?A.right:A.left),p.tsx("div",{class:E.diamondMidCol},p.tsx("div",{class:E.diamondMidColLabel},A.top),q,p.tsx("div",{class:E.diamondMidColLabel},A.bottom)),p.tsx("div",
{class:E.diamondRightCol},B?A.left:A.right)):p.tsx("div",{class:E.squareTable,key:`${f}-container`},p.tsx("div",{class:E.squareTableRow},p.tsx("div",{class:m.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelRightBottom)},B?A.top:A.left),p.tsx("div",{class:E.squareTableCell}),p.tsx("div",{class:m.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelLeftBottom)},B?A.left:A.top)),p.tsx("div",{class:E.squareTableRow},p.tsx("div",{class:E.squareTableCell}),q,p.tsx("div",{class:E.squareTableCell})),
p.tsx("div",{class:E.squareTableRow},p.tsx("div",{class:m.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelRightTop)},B?A.right:A.bottom),p.tsx("div",{class:E.squareTableCell}),p.tsx("div",{class:m.classes(E.squareTableCell,E.squareTableLabel,E.squareTableLabelLeftTop)},B?A.bottom:A.right)))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils",
"../../../symbols/support/previewSymbol3D"],function(a,b,d,m){function p(f){if(f){var {type:u}=f;return u.includes("3d")?m.getSymbolLayerFill(f.symbolLayers.at(0)):"simple-line"===u||"simple-marker"===f.type&&("x"===f.style||"cross"===f.style)?(f=d.getStroke(f))&&f.color:d.getFill(f)}}function l(f,u){const t=u.HH.label,A=u.LL.label,x=u.HL.label;u=u.LH.label;switch(f){case "HH":return{top:t,bottom:A,left:x,right:u};case "HL":return{top:x,bottom:u,left:A,right:t};case "LL":return{top:A,bottom:t,left:u,
right:x};case "LH":return{top:u,bottom:x,left:t,right:A};default:return{top:t,bottom:A,left:x,right:u}}}function k(f){let u=E[f];f&&null==u&&(u=E.HH);return u||0}const E={HH:315,HL:45,LL:135,LH:225},q={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};a.getRelationshipRampColors2D=function(f,u){const t=[],A=f.length**.5;f=b.clone(f);var x=(u||"HH").split("");
u=x[0];for(x="H"===x[1];f.length;){const v=[];for(;v.length<A;)v.push(f.shift());x&&v.reverse();t.push(v)}"L"===u&&t.reverse();return t};a.getRelationshipRampElement=function(f){const {focus:u,infos:t,numClasses:A}=f;var x=q[A];const v={};t.forEach(B=>{v[B.value]={label:B.label,fill:p(B.symbol)}});f=[];for(let B=0;B<A;B++){const n=[];for(let w=0;w<A;w++)n.push(v[x[B][w]].fill);f.push(n)}x=l(u,v);return{type:"relationship-ramp",numClasses:A,focus:u,colors:f,labels:x,rotation:k(u)}};a.getRotationAngleForFocus=
k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),function(a,b,d,m,p,l,k,E,q,f,u,t,A,x){function v(g){const F=g.outline;var I=null!=g.material?g.material.color:null;I=null!=
I?I.toHex():null;if(null==F||"pattern"in F&&null!=F.pattern&&"style"===F.pattern.type&&"none"===F.pattern.style)return"fill"===g.type&&"#ffffff"===I?{color:"#bdc3c7",width:.75}:null;g=k.pt2px(F.size)||0;return{color:"rgba("+(null!=F.color?F.color.toRgba():"255,255,255,1")+")",width:Math.min(g,h),style:"pattern"in F&&null!=F.pattern&&"style"===F.pattern.type?E.dekebabifyLineStyle(F.pattern.style):null,join:"butt",cap:"patternCap"in F?F.patternCap:"butt"}}async function B(g,F){if(g.thumbnail?.url)return g.thumbnail.url;
if("icon"===F.type&&F?.resource?.href)return A.getIconHref(F);F=b.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return g.styleOrigin&&(g.styleOrigin.styleName||g.styleOrigin.styleUrl)&&(g=await x.resolveWebStyleSymbol(g.styleOrigin,{portal:g.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in g&&g.thumbnail?.url?g.thumbnail.url:F}function n(g,F=1){const I=g.a;g=d.toHSV(g);const {r:O,g:R,b:W}=d.toRGB({h:g.h,s:g.s/F,v:100-(100-g.v)/F});return[O,R,W,I]}function w(g){return"water"===
g.type?null==g.color?null:g.color:null==g.material?.color?null:g.material.color}function D(g,F=0){var I=w(g);if(!I){if("fill"===g.type)return null;F=u.adjustColorComponentBrightness(E.defaultThematicColor.r,F);return[F,F,F,100]}g=I.toRgba();for(I=0;3>I;I++)g[I]=u.adjustColorComponentBrightness(g[I],F);return g}async function K(g,F){g=g.style;return"none"===g?null:{type:"pattern",x:0,y:0,src:await E.getPatternUrlWithColor(b.getAssetUrl(`esri/symbols/patterns/${g}.png`),F.toCss(!0)),width:5,height:5}}
function N(g){return g.outline?v(g):{color:"rgba(0, 0, 0, 1)",width:1.5}}function G(g,F){g=w(g);if(!g)return null;let I;I="rgba("+(u.adjustColorComponentBrightness(g.r,F)+",");I+=u.adjustColorComponentBrightness(g.g,F)+",";I+=u.adjustColorComponentBrightness(g.b,F)+",";return I+g.a+");"}function P(g,F){F=G(g,F);if(!F)return{};if("pattern"in g&&null!=g.pattern&&"style"===g.pattern.type&&"none"===g.pattern.style)return null;const I=Math.min(g.size?k.pt2px(g.size):.75,h);return{color:F,width:I,style:"pattern"in
g&&null!=g.pattern&&"style"===g.pattern.type?E.dekebabifyLineStyle(g.pattern.style):null,cap:"cap"in g?g.cap:null,join:"join"in g?"miter"===g.join?k.pt2px(2):g.join:null}}function z(g,F,I){I=null!=I?.75*I:0;return{type:"linear",x1:I?.25*I:0,y1:I?.5*I:0,x2:I||4,y2:I?.5*I:4,colors:[{color:g,offset:0},{color:F,offset:1}]}}function C(g){const F=g.depth,I=g.height;g=g.width;return 0!==g&&0!==F&&0!==I&&g===F&&null!=g&&null!=I&&g<I}function L(g,F,I){const O=[];if(!g)return O;switch(g.type){case "icon":switch(g.resource?.primitive??
q.defaultPrimitive){case "circle":O.push({shape:{type:"circle",cx:0,cy:0,r:.5*F},fill:D(g,0),stroke:v(g)});break;case "square":O.push({shape:{type:"path",path:[{command:"M",values:[0,F]},{command:"L",values:[0,0]},{command:"L",values:[F,0]},{command:"L",values:[F,F]},{command:"Z",values:[]}]},fill:D(g,0),stroke:v(g)});break;case "triangle":O.push({shape:{type:"path",path:[{command:"M",values:[0,F]},{command:"L",values:[.5*F,0]},{command:"L",values:[F,F]},{command:"Z",values:[]}]},fill:D(g,0),stroke:v(g)});
break;case "cross":O.push({shape:{type:"path",path:[{command:"M",values:[.5*F,0]},{command:"L",values:[.5*F,F]},{command:"M",values:[0,.5*F]},{command:"L",values:[F,.5*F]}]},stroke:N(g)});break;case "x":O.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[F,F]},{command:"M",values:[F,0]},{command:"L",values:[0,F]}]},stroke:N(g)});break;case "kite":O.push({shape:{type:"path",path:[{command:"M",values:[0,.5*F]},{command:"L",values:[.5*F,0]},{command:"L",values:[F,.5*F]},
{command:"L",values:[.5*F,F]},{command:"Z",values:[]}]},fill:D(g,0),stroke:v(g)})}break;case "object":switch(g.resource?.primitive??f.defaultPrimitive){case "cone":var R=D(g,0);g=D(g,-.6);g=z(R,g,I?c:F);F=u.getConeShapes(F,I);O.push({shape:F[0],fill:g},{shape:F[1],fill:g});break;case "inverted-cone":I=D(g,0);g=D(g,-.6);g=z(I,g,F);F=u.getInvertedConeShapes(F);O.push({shape:F[0],fill:g},{shape:F[1],fill:I});break;case "cube":F=u.getCubeShapes(F,I);O.push({shape:F[0],fill:D(g,0)},{shape:F[1],fill:D(g,
-.3)},{shape:F[2],fill:D(g,-.5)});break;case "cylinder":R=D(g,0);const W=D(g,-.6);R=z(R,W,I?c:F);F=u.getCylinderShapes(F,I);O.push({shape:F[0],fill:R},{shape:F[1],fill:R},{shape:F[2],fill:D(g,0)});break;case "diamond":F=u.getDiamondShapes(F);O.push({shape:F[0],fill:D(g,-.3)},{shape:F[1],fill:D(g,0)},{shape:F[2],fill:D(g,-.3)},{shape:F[3],fill:D(g,-.7)});break;case "sphere":I=D(g,0);g=D(g,-.6);g=z(I,g);g.x1=0;g.y1=0;g.x2=.25*F;g.y2=.25*F;O.push({shape:{type:"circle",cx:0,cy:0,r:.5*F},fill:g});break;
case "tetrahedron":F=u.getTetrahedronShapes(F),O.push({shape:F[0],fill:D(g,-.3)},{shape:F[1],fill:D(g,0)},{shape:F[2],fill:D(g,-.6)})}}return O}function S(g){return(g="number"===typeof g?.size?g?.size:null)?k.pt2px(g):null}async function r(g,F){const I=S(F),O=F?.maxSize?k.pt2px(F.maxSize):null,R=F?.disableUpsampling??!1,W=[],V=[];let aa=!1,fa=0,ja=0,da=0;g.symbolLayers.forEach(ka=>{if("icon"===ka.type||"object"===ka.type){ka&&"icon"===ka.type&&(da=Math.max(ka.size&&k.pt2px(ka.size),da));var la="icon"===
ka.type?ka.size&&k.pt2px(ka.size):0,T=I||la?Math.ceil(Math.min(I||la,O||H)):y,U="icon"===ka.type?ka.angle:null;null!=F?.rotation&&(U=(U??0)+F.rotation);V.push(U);if(ka?.resource?.href){var ba=B(g,ka).then(ha=>{const ma=ka?.material?.color;var Q="icon"===ka.type?"multiply":"tint";return t.tintImageWithColor(ha,T,ma,Q,R)}).then(ha=>{const ma=ha.width,Q=ha.height;fa=Math.max(fa,ma);ja=Math.max(ja,Q);U&&(aa=!0);return[{shape:{type:"image",x:0,y:0,width:ma,height:Q,src:ha.url},fill:null,stroke:null}]});
W.push(ba)}else ba=T,"icon"===ka.type&&I&&(ba=la/da*T),la="tall"===F?.symbolConfig||F?.symbolConfig?.isTall||("object"===ka.type?C(ka):!1),fa=Math.max(fa,la?c:ba),ja=Math.max(ja,ba),U&&ka.resource?.primitive&&["square","triangle","x"].includes(ka.resource?.primitive)&&(aa=!0),W.push(Promise.resolve(L(ka,ba,la)))}});const Z=[];(await Promise.allSettled(W)).forEach(ka=>{"fulfilled"===ka.status?Z.push(ka.value):ka.reason&&l.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",
ka.reason)});return t.renderSymbol(Z,[fa,ja],{node:F?.node,scale:!1,opacity:F?.opacity,ariaLabel:F?.ariaLabel,rotations:V,useRotationSize:aa})}function J(g,F){const I=g.symbolLayers,O=[];g=A.isVolumetricSymbol(g);const R=S(F),W=(F?.maxSize?k.pt2px(F.maxSize):null)||h;let V=0,aa=0,fa;I.forEach((ja,da)=>{if(ja&&("line"===ja.type||"path"===ja.type)){var Z=[];switch(ja.type){case "line":var ka=P(ja,0);if(null==ka)break;var la=ka?.width||0;0===da&&(fa=la);ja=Math.min(R||la,W);da=0===da?ja:R?la/fa*ja:ja;
la=da>e/2?2*da:e;aa=Math.max(aa,da);V=Math.max(V,la);ka.width=da;Z.push({shape:{type:"path",path:[{command:"M",values:[0,.5*aa]},{command:"L",values:[V,.5*aa]}]},stroke:ka});break;case "path":ka=Math.min(R||y,W);da=D(ja,0);la=D(ja,-.2);var T=G(ja,-.4);T=T?{color:T,width:1}:{};if("quad"===ja.profile){const U=ja.width;ja=ja.height;ja=u.getPathSymbolShapes(U&&ja?U/ja:1,0===ja,0===U);T={...T,join:"bevel"};Z.push({shape:ja[0],fill:la,stroke:T},{shape:ja[1],fill:la,stroke:T},{shape:ja[2],fill:da,stroke:T})}else Z.push({shape:u.shapes.pathSymbol3DLayer[0],
fill:la,stroke:T},{shape:u.shapes.pathSymbol3DLayer[1],fill:da,stroke:T});V=aa=Math.max(aa,ka)}O.push(Z)}});return Promise.resolve(t.renderSymbol(O,[V,aa],{node:F?.node,scale:g,opacity:F?.opacity,ariaLabel:F?.ariaLabel}))}async function M(g,F){const I="mesh-3d"===g.type;g=g.symbolLayers;var O=S(F);const R=F?.maxSize?k.pt2px(F.maxSize):null;O=O||y;const W=[];let V=0,aa=0;var fa=!1;for(let la=0;la<g.length;la++){var ja=g.at(la);const T=[];if(!I||"fill"===ja.type){switch(ja.type){case "fill":fa=Math.min(O,
R||H);V=Math.max(V,fa);aa=Math.max(aa,fa);fa=!0;if(I){var da=u.shapes.meshSymbol3DFill,Z=G(ja,-.4);Z=Z?{color:Z,width:1,join:"round"}:{};T.push({shape:da[0],fill:D(ja,0),stroke:Z},{shape:da[1],fill:D(ja,-.2),stroke:Z},{shape:da[2],fill:D(ja,-.6),stroke:Z})}else{da=D(ja,0);Z="pattern"in ja?ja.pattern:null;var ka=v(ja);ja=w(ja);null!=Z&&"style"===Z.type&&"solid"!==Z.style&&ja&&(da=await K(Z,ja));T.push({shape:u.shapes.fill[0],fill:da,stroke:ka})}break;case "line":ja=P(ja,0);if(null==ja)break;ja={stroke:ja,
shape:u.shapes.fill[0]};V=Math.max(V,y);aa=Math.max(aa,y);T.push(ja);break;case "extrude":da={join:"round",width:1,...P(ja,-.4)};Z=D(ja,0);ja=D(ja,-.2);ka=Math.min(O,R||H);const U=u.getExtrudeSymbolShapes(ka);da.width=1;T.push({shape:U[0],fill:ja,stroke:da},{shape:U[1],fill:ja,stroke:da},{shape:U[2],fill:Z,stroke:da});ja=.7*y+.5*ka;V=Math.max(V,y);aa=Math.max(aa,ja);break;case "water":fa=w(ja),ja=n(fa),da=n(fa,2),Z=n(fa,3),ka=u.getWaterSymbolShapes(),fa=!0,T.push({shape:ka[0],fill:ja},{shape:ka[1],
fill:da},{shape:ka[2],fill:Z}),ja=Math.min(O,R||H),V=Math.max(V,ja),aa=Math.max(aa,ja)}W.push(T)}}return t.renderSymbol(W,[V,aa],{node:F?.node,scale:fa,opacity:F?.opacity,ariaLabel:F?.ariaLabel})}const y=u.SymbolSizeDefaults.size,H=u.SymbolSizeDefaults.maxSize,h=u.SymbolSizeDefaults.maxOutlineSize,e=u.SymbolSizeDefaults.lineWidth,c=u.SymbolSizeDefaults.tallSymbolWidth;a.getPatternDescriptor=K;a.getSizeFromOptions=S;a.getSymbolLayerFill=D;a.previewSymbol3D=function(g,F){if(0===g.symbolLayers.length)return Promise.reject(new p("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(g.type){case "point-3d":return r(g,F);case "line-3d":return J(g,F);case "polygon-3d":case "mesh-3d":return M(g,F)}return Promise.reject(new p("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){function t(v,B){return B.items.find(n=>n.name===v)}function A(v,B,n,w,D,K){const N=null!=n?.portal?n.portal:l.getDefault(),G={portal:N,url:p.urlToObject(v.baseUrl),origin:"portal-item"},P=t(B,v.data);if(!P)return Promise.reject(new m("symbolstyleutils:symbol-name-not-found",`The symbol name '${B}' could not be found`,{symbolName:B}));D=k.fromJSON(D(P,w),G);let z=P.thumbnail?.href??null;const C=P.thumbnail?.imageData;d.isDevEnvironment()&&(D=d.adjustStaticAGOUrl(D)??
"",z=d.adjustStaticAGOUrl(z));const L={portal:N,url:p.urlToObject(p.removeFile(D)),origin:"portal-item"};return f.requestJSON(D,K).then(S=>{S="cimRef"===w?f.makeCIMSymbolRef(S.data):S.data;if((S=E.fromJSON(S,L))&&b.isSymbol3D(S)){if(z){const r=k.fromJSON(z,G);S.thumbnail=new u.Thumbnail({url:r})}else C&&(S.thumbnail=new u.Thumbnail({url:`data:image/png;base64,${C}`}));v.styleUrl?S.styleOrigin=new q({portal:n.portal,styleUrl:v.styleUrl,name:B}):v.styleName&&(S.styleOrigin=new q({portal:n.portal,styleName:v.styleName,
name:B}))}return S})}function x(v,B,n){const w=f.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,v),D=null!=B.portal?B.portal:l.getDefault();return f.requestJSON(w,n).then(K=>{K=f.makeCIMSymbolRef(K.data);return E.fromJSON(K,{portal:D,url:p.urlToObject(p.removeFile(w)),origin:"portal-item"})})}a.fetchSymbolFromStyle=A;a.getStyleItemFromStyle=t;a.resolveWebStyleSymbol=function(v,B,n,w){const D=v.name;return null==D?Promise.reject(new m("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
"Esri2DPointSymbolsStyle"===v.styleName?x(D,B,w):f.fetchStyle(v,B,w).then(K=>A(K,D,B,n,f.symbolUrlFromStyleItem,w))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(a){const b=/^devext\.arcgis\.com$/,d=/^qaext\.arcgis\.com$/,m=/^[\w-]*\.mapsdevext\.arcgis\.com$/,p=/^[\w-]*\.mapsqa\.arcgis\.com$/,l=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,b,d,/^jsapps\.esri\.com$/,m,p];a.adjustStaticAGOUrl=function(k,E){return k?
(E=E||globalThis.location.hostname)?null!=E.match(b)||null!=E.match(m)?k.replace("static.arcgis.com","staticdev.arcgis.com"):null!=E.match(d)||null!=E.match(p)?k.replace("static.arcgis.com","staticqa.arcgis.com"):k:k:null};a.devHostnames=l;a.isDevEnvironment=function(k){k=k||globalThis.location.hostname;return l.some(E=>null!=k?.match(E))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/TemplateItemGroup":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k,E){b=class extends d.IdentifiableMixin(b){constructor(q){super(q);this.allItems=[];this.label=this.filterFunction=null}get items(){const {filterFunction:q}=this;return null==q||q(this)?this.allItems:this.allItems.filter(q)}get id(){return this.label}reapplyFilter(){this.notifyChange("filterFunction")}findByTemplate(q){return this.items.find(f=>f.template===q)}};a.__decorate([m.property()],b.prototype,"allItems",void 0);a.__decorate([m.property()],b.prototype,"filterFunction",
void 0);a.__decorate([m.property()],b.prototype,"items",null);a.__decorate([m.property()],b.prototype,"label",void 0);a.__decorate([m.property()],b.prototype,"id",null);return b=a.__decorate([E.subclass("esri.widgets.FeatureTemplates.TemplateItemGroup")],b)})},"esri/widgets/support/templateUtils":function(){define(["exports"],function(a){a.getAllTemplatesForLayer=b=>{if(null==b||"object"!==typeof b)return[];const d="templates"in b&&Array.isArray(b.templates)?b.templates:[];b="types"in b&&Array.isArray(b.types)?
b.types.flatMap(m=>m.templates):[];return[...d,...b]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/ItemList":function(){define(["exports","../support/Heading","../support/widgetUtils","../support/jsxFactory"],function(a,b,d,m){function p(f){const {headingLevel:u,items:t,...A}=f;return 0===t.length?m.tsx("div",{class:q.noMatchesMessage,key:"no-matches"},f.messages.noMatches):m.tsx("div",{class:d.classes({[q.scroller]:!0,[q.scrollerEnabled]:!!f.enableListScroll}),
key:"item-container"},t.map(x=>x.items?E({...A,group:x,headingLevel:u}):k({...A,grouped:!0,item:x})))}function l(f){const {disabled:u,messages:t,filterText:A,enableListScroll:x}=f;return m.tsx("div",{class:x?void 0:q.filterContainerSticky,key:"filter"},m.tsx("calcite-input",{disabled:u,placeholder:t.filterPlaceholder,type:"search",value:A,onCalciteInputInput:v=>{v=v.currentTarget;f.onFilterChange&&f.onFilterChange(v.value)}}))}function k(f){const {disabled:u,grouped:t,identify:A,item:x,onItemMouseEnter:v,
onItemMouseLeave:B,onItemSelect:n,renderIcon:w,renderCustomItem:D,renderItemContent:K,renderItemContentEnd:N,renderItemLabel:G,renderItemDescription:P,selectedItem:z}=f,C=x?`${A?.(x)||x.id}__${x.label}`:"";var L=z?`${A?.(z)||z.id}__${z.label}`:"";const S=C===L;if(f=D?.(f))return f;f=K?.(x);L=N?.(x);const r=!(!x.disabled&&!u);return m.tsx("calcite-list-item",{afterUpdate:J=>{J.selected=S},"aria-level":t?"2":"",class:d.classes({[q.item]:!0,[q.itemDisabled]:r}),"data-item":x,description:f?void 0:P?.(x)??
void 0,disabled:r,key:C,label:f?void 0:G?.(x)??x.label??void 0,onmouseenter:J=>v?.(J.currentTarget["data-item"]),onmouseleave:J=>B?.(J.currentTarget["data-item"]),selected:S,tabIndex:r?-1:0,onCalciteListItemSelect:J=>{J.preventDefault();n?.(J.currentTarget["data-item"])}},m.tsx("div",{class:q.itemIcon,key:"content-start",slot:"content-start"},w?.(x)),f?m.tsx("div",{key:"content",slot:"content"},f):null,L?m.tsx("div",{class:q.itemContentEnd,key:"content-end",slot:"content-end"},L):null)}function E(f){const {disabled:u,
group:t,headingLevel:A=4,selectionMode:x="none",renderCustomGroupContent:v,...B}=f;f=v?.(f);return m.tsx("div",{class:q.group,key:t.label??void 0},m.tsx(b.Heading,{class:q.groupHeader,level:A},t.label),f||m.tsx("calcite-list",{disabled:u,selectionAppearance:"border",selectionMode:x},t.items.map(n=>k({...B,disabled:u,item:n,grouped:!0}))))}const q={base:"esri-item-list",filterContainerSticky:"esri-item-list__filter-container--sticky",group:"esri-item-list__group",groupHeader:"esri-item-list__group__header",
item:"esri-item-list__list-item",itemDisabled:"esri-item-list__list-item--disabled",itemIcon:"esri-item-list__list-item-icon",itemContentEnd:"esri-item-list__list-item-content-end",noMatchesMessage:"esri-item-list__no-matches-message",scroller:"esri-item-list__scroller",scrollerEnabled:"esri-item-list__scroller--enabled"};a.ItemList=function(f){const {disabled:u,filterText:t="",id:A,messages:x,onFilterChange:v,...B}=f;return m.tsx("div",{key:A},f.filterEnabled??!0?l({disabled:u,filterText:t,id:A,
messages:x,onFilterChange:v}):null,p({...B,disabled:u,enableListScroll:f.enableListScroll??!0,filterText:t,messages:x}))};a.renderGroup=E;a.renderItem=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/FeatureTemplates/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,
m,p,l,k){b=class extends b{constructor(E){super(E);this.filter=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"filter",void 0);return b=a.__decorate([k.subclass("esri.widgets.FeatureTemplates.VisibleElements")],b)})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t){p=class extends q{constructor(A,x){super(A,x);this._animationDelay=500;this._animationPromise=null;this.viewModel=new f}initialize(){this.addHandles(d.watch(()=>this.visible,A=>this._visibleChange(A)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(A){this.viewModel.location=A}get view(){return this.viewModel.view}set view(A){this.viewModel.view=A}get visible(){return this.viewModel.visible}set visible(A){this.viewModel.visible=
A}show(A){const {location:x,promise:v}=A??{};x&&(this.viewModel.location=x);this.visible=!0;A=()=>this.hide();v&&v.catch(()=>{}).then(A)}hide(){this.visible=!1}render(){var {visible:A}=this,{screenLocation:x}=this.viewModel;x=!!x;A={["esri-spinner--start"]:A&&x,["esri-spinner--finish"]:!A&&x};x=this._getPositionStyles();return t.tsx("div",{class:this.classes("esri-spinner",A),styles:x})}_visibleChange(A){if(A)this.viewModel.screenLocationEnabled=!0;else{var x=b.after(this._animationDelay);this._animationPromise=
x;x.catch(()=>{}).then(()=>{this._animationPromise===x&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:A,view:x}=this.viewModel;if(null==x||null==A)return{};const {padding:v}=x;return{left:`${A.x-v.left}px`,top:`${A.y-v.top}px`}}};a.__decorate([m.property()],p.prototype,"location",null);a.__decorate([m.property()],p.prototype,"view",null);a.__decorate([m.property({type:f})],p.prototype,"viewModel",void 0);a.__decorate([m.property()],
p.prototype,"visible",null);return p=a.__decorate([E.subclass("esri.widgets.Spinner")],p)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(a,b,d,m,p,l,k){d=class extends k{constructor(E){super(E);this.visible=!1}};a.__decorate([b.property()],d.prototype,"visible",
void 0);return d=a.__decorate([l.subclass("esri.widgets.Spinner.SpinnerViewModel")],d)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),function(a,b,d,m,p,l,k,E,q){b=class extends b.EventedAccessor{constructor(f){super(f);this.location=
null;this.screenLocationEnabled=!1;this.view=null;this.addHandles([d.when(()=>{const u=this.screenLocationEnabled?this.view:null;return u?[u.size,"3d"===u.type?u.camera:u.viewpoint]:null},()=>this.notifyChange("screenLocation")),d.watch(()=>this.screenLocation,(u,t)=>{null!=u&&null!=t&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:f,view:u,screenLocationEnabled:t}=this;var A=u?.spatialReference;A=A?q.projectOrLoad(f,A).geometry:null;return t&&A&&u?.ready?
u.toScreen(A):null}};a.__decorate([m.property()],b.prototype,"location",void 0);a.__decorate([m.property()],b.prototype,"screenLocation",null);a.__decorate([m.property()],b.prototype,"screenLocationEnabled",void 0);a.__decorate([m.property()],b.prototype,"view",void 0);return b=a.__decorate([E.subclass("esri.widgets.support.AnchorElementViewModel")],b)})},"esri/widgets/Editor/css":function(){define(["exports"],function(a){a.css={base:"esri-editor",helpMessage:"esri-editor__help-message",updateActions:"esri-editor__update-actions",
updateActionsList:"esri-editor__update-actions-list",featureTemplatesContainer:"esri-editor__feature-templates-container",templateItemContentEnd:"esri-editor__template-item-content-end"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/EditorViewModel":function(){define("../../chunks/tslib.es6 ../../core/asyncUtils ../../core/Collection ../../core/deprecate ../../core/Error ../../core/Evented ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles ../../layers/GraphicsLayer ../../layers/support/editableLayers ../../layers/support/layerUtils ../../portal/support/urlUtils ../../views/interactive/sketch/SketchOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../Attachments/AttachmentsViewModel ./CreateFeaturesWorkflow ./UpdateWorkflow ./workflowUtils ./support/EditorItem ../FeatureTemplates/FeatureTemplatesViewModel ../Sketch/SketchViewModel ../Spinner/SpinnerViewModel".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S,r,J,M,y){function H(c,g,F){E.getLogger("esri.widgets.Editor.EditorViewModel").error(new p(c,g,F))}function h(c,g){return c?.find(F=>F.layer===g)}const e=["create-features","update"];l=class extends l.EventedAccessor{constructor(c){super(c);this._sketchEventListenerHandle=null;this._sketchGraphicsLayer=new n({listMode:"hide",internal:!0});this._updateItemsTask=this._snappingManager=null;this._updatingHandles=new B.UpdatingHandles;this._featureTemplatesViewModelLocked=
!1;this.activeWorkflow=null;this._activityQueue=new d;this.editorItems=new d;this.failures=[];this.hideTemplatesForInactiveLayers=!1;this.attachmentsViewModel=new z({capabilities:{editing:!0}});this.featureTemplatesViewModel=new J({disabledItemFunction:({layer:g})=>this._itemIsSuspended(g)});this.layerInfos=null;this.ownSketchViewModel=new M({layer:this._sketchGraphicsLayer});this.sketchOptions=new N;this.snappingOptions=new P({attributeRulesEnabled:!0});this.spinnerViewModel=new y;this.pageStack=
[];this.showDiscardEditsPrompt=()=>Promise.resolve(!0);this._candidateCommitted=!1;this.back=async()=>{this.canGoBack&&(this.activeWorkflow?.hasPreviousStep?await this.activeWorkflow.back(this.showDiscardEditsPrompt):await this._cancelWorkflow({force:!this.hasPendingEdits}))};this.saveWorkflow=async()=>{const {featureFormViewModel:g}=this;if(g){g.submit();if(!g.submittable||g.hasPendingSubtypeChoice)return;const F=g.getValues();if(0<g.validateContingencyConstraints(F,{includeIncompleteViolations:!0}).length)return}await this.activeWorkflow?.save()};
this.selectFeature=(g,F=!1)=>{const I=this.activeWorkflow;this._candidateCommitted||"update"!==I?.type||(I.data.rootFeature=g,F&&(I.next(),this._candidateCommitted=!0))}}initialize(){this.addHandles([u.watch(()=>{var c=this.view;const g=c?.map?.editableLayers;c=c?.allLayerViews?.filter(F=>!!g?.includes(F.layer));return[g,c,this.layerInfos,this.allowedWorkflows]},()=>this._updateEditorItems(),u.syncAndInitial),u.watch(()=>this.hideTemplatesForInactiveLayers,()=>this.syncFeatureTemplates()),u.on(()=>
this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),u.on(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),u.on(()=>this.activeWorkflow,"complete",()=>{this.emit("workflow-commit");this._set("activeWorkflow",null)}),u.when(()=>this.view?.map,c=>c.add(this._sketchGraphicsLayer),u.initial),u.on(()=>this.editorItems,"change",()=>this._afterEditorItemsChange()),u.watch(()=>[this.canCreate,this.canUpdateVisible],()=>this._afterEditorItemsChange()),u.watch(()=>this.page,(c,g)=>
{g=[...this.pageStack];if(-1===g.indexOf(c))g.push(c);else for(;g.length&&g.at(-1)!==c;)g.pop();this.pageStack=g},u.syncAndInitial),u.when(()=>"awaiting-update-feature-candidate"===this.state,()=>this._candidateCommitted=!1),u.on(()=>this.featureTemplatesViewModel,"select",async({item:c,oldItem:g})=>{var {activeWorkflow:F}=this;if(F){if("update"===F.type&&"awaiting-feature-creation-info"===F.activeWorkflow?.stepId)return;try{await this.cancelWorkflow({force:!this.hasPendingEdits})}catch{this.featureTemplatesViewModel.select(g,
{emit:!1});return}}if(c){F={layer:c.layer,template:c.template};if(c.supportsUpload)return this.featureTemplatesViewModel.select(g,{emit:!1}),this.startCreateFeaturesWorkflow(F);this.startCreateFeaturesWorkflowAtFeatureCreation(F)}}),u.on(()=>this.view,"key-down",c=>{"Escape"===c.key&&this.activeWorkflow?.keyboardCancellationEnabled&&(c.stopPropagation(),this.back())}),u.on(()=>this.sketchViewModel,["create","delete","update"],c=>{const {activeWorkflow:g}=this,F="update"===g?.type,I=`sketch-${c.type}`;
this.emit(I,{type:I,detail:c,layer:F?g.activeWorkflow?.layer:g?.layer,parentLayer:F?g?.activeWorkflow?.parentLayer:void 0})},u.sync),u.watch(()=>this.view,c=>{this._snappingManager=q.destroyMaybe(this._snappingManager);c&&(this._snappingManager=new G.SnappingManager({view:c,options:this.snappingOptions}),this.ownSketchViewModel.snappingManager=this._snappingManager)},u.syncAndInitial),u.watch(()=>this.snappingOptions,c=>{this._snappingManager&&(this._snappingManager.options=c)},u.syncAndInitial)])}destroy(){this._cancelWorkflow({warnIfNoWorkflow:!1}).then(()=>
{this.view?.map?.remove(this._sketchGraphicsLayer);this.view=null});this._updateItemsTask=q.abortMaybe(this._updateItemsTask);this._updatingHandles.destroy();this._sketchEventListenerHandle=q.removeMaybe(this._sketchEventListenerHandle)}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(c){m.deprecatedProperty(E.getLogger(this),"allowedWorkflows",{replacement:"Editor.visibleElements",version:"4.29",warnOnce:!0});c&&0!==c.length||(c=[...e]);this._set("allowedWorkflows",
c)}get canCreate(){return this.editorItems.some(c=>c.supportsCreateFeaturesWorkflow)}get canCreateVisible(){return!!this.featureTemplatesLayers.length}get canUpdate(){return this.editorItems.some(c=>c.supportsUpdateWorkflow)}get canUpdateVisible(){return this.editorItems.some(c=>c.supportsUpdateWorkflow&&c.visible)}get featureTemplatesLayers(){const c=new d;for(const g of this.editorItems){const F=this.hideTemplatesForInactiveLayers&&!g.visible;!g.supportsCreateFeaturesWorkflow||g.isTable||F||c.push(g.layer)}return c}get editableItems(){m.deprecatedProperty(E.getLogger(this),
"editableItems",{replacement:"editorItems",version:"4.29",warnOnce:!0});return this.editorItems.map(c=>{const {capabilities:g,disabled:F,hasInvalidFormTemplate:I,layer:O}=c;c=[];const R=g.create,W=g.update,V=g.delete;R.enabled&&c.push("create");W.enabled&&c.push("update");V.enabled&&c.push("delete");return{layer:O,supports:c,suspended:F,attributeUpdatesEnabled:W.attributes,geometryUpdatesEnabled:W.geometry,attachmentsOnCreateEnabled:R.attachments.enabled,attachmentsOnUpdateEnabled:W.attachments.enabled,
hasInvalidFormTemplate:I,hasAttachments:g.attachments.enabled}})}get featureFormViewModel(){const {activeWorkflow:c}=this;return"update"===c?.type?c.activeFeatureFormViewModel:"create-features"===c?.type?c.featureFormViewModel:null}get labelOptions(){return this.sketchOptions.labels}set labelOptions(c){this.sketchOptions.labels=c}get sketchViewModel(){const {activeWorkflow:c}=this;return"update"===c?.type?c.activeSketchViewModel:"create-features"===c?.type?c.sketchViewModel:this.ownSketchViewModel}get state(){if(!this.view?.ready)return"disabled";
var c=this.attachmentsViewModel.mode;if("add"===c)return"adding-attachment";if("edit"===c)return"editing-attachment";({activeWorkflow:c}=this);return c?.stepId?"update"===c.type&&c.activeWorkflow?.stepId?c.activeWorkflow.stepId:c.stepId:"ready"}get syncing(){return 0<this._activityQueue.length}get updating(){return this._updatingHandles.updating||!0===this.activeWorkflow?.updating}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(c){this.sketchOptions.tooltips=c}get valueOptions(){return this.sketchOptions.values}set valueOptions(c){this.sketchOptions.values=
c}set view(c){this.ownSketchViewModel.view=c;this.spinnerViewModel.view=c;this._set("view",c)}get page(){const {activeWorkflow:c,state:g}=this;if("update"===c?.type&&"awaiting-feature-to-update"===c.stepId)return"ready";if("create-features"===c?.type&&0===c.numPendingFeatures){const F=c.data.upload;if(F)return"default"===F.state?"ready":"creating-features-upload-details"}return g??"disabled"}get featureFormDisabled(){const {activeWorkflow:c}=this;return"update"===c?.type&&!1===c.activeEditorItem?.capabilities.update.attributes}get canGoBack(){return null!=
this.activeWorkflow&&!this.syncing}get shouldShowDeleteButton(){const {activeWorkflow:c}=this;return!!c&&"update"===c.type&&!!c.activeEditorItem?.capabilities.delete.enabled}get hasPendingEdits(){return this.activeWorkflow?.hasPendingEdits??!1}get snappingManager(){return this._snappingManager}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateFeaturesWorkflowAtFeatureCreation(c){return this.startCreateFeaturesWorkflow(c,"creating-features")}async startCreateFeaturesWorkflow(c,
g="awaiting-feature-creation-info"){await u.whenOnce(()=>!this.updating);if(!this.canCreate)throw new p("editing:unsupported-workflow","Creating features is unsupported or disabled.");const F=this._createUpdatingResolver();try{await this._cancelWorkflow();const I=this._createCreateFeaturesWorkflow(c,g);this._set("activeWorkflow",I);await I.start()}catch(I){this._logErrorAndCancelWorkflow(I)}finally{F.resolve()}}async startCreateFeaturesWorkflowAtFeatureEdit(c){await u.whenOnce(()=>!this.updating);
const g=this._createUpdatingResolver();try{({initialFeature:c}=c);const F=c.sourceLayer=c.layer,I=F?this.findEditorItemForLayer(F):void 0;if(!I?.supportsCreateFeaturesWorkflow)throw new p("editing:unsupported-workflow","Creating features is unsupported or disabled for this layer.");await this._cancelWorkflow();const O=this._createCreateFeaturesWorkflow({initialFeature:c,layer:I.layer,maxFeatures:1},"creating-features");this._set("activeWorkflow",O);await O.start()}catch(F){this._logErrorAndCancelWorkflow(F)}finally{g.resolve()}}async startUpdateWorkflowAtFeatureSelection(){await u.whenOnce(()=>
!this.updating);if(this.canUpdate){var c=this._createUpdatingResolver();try{await this._cancelWorkflow();const g=this._createUpdateWorkflow();this._set("activeWorkflow",g);await g.start()}catch(g){this._logErrorAndCancelWorkflow(g)}finally{c.resolve()}}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async startUpdateWorkflowAtMultipleFeatureSelection(c){await u.whenOnce(()=>!this.updating);if(this.canUpdate){var g=this._createUpdatingResolver();try{await this._cancelWorkflow();
const F=this._createUpdateWorkflow("awaiting-update-feature-candidate");F.data.candidates=c;this._set("activeWorkflow",F);await F.start()}catch(F){this._logErrorAndCancelWorkflow(F)}finally{g.resolve()}}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async startUpdateWorkflowAtFeatureEdit(c){await u.whenOnce(()=>!this.updating);if(this.canUpdate){var g=this._createUpdatingResolver();try{await this._cancelWorkflow();const F=this._createUpdateWorkflow("editing-existing-feature");
F.data.rootFeature=c;this._set("activeWorkflow",F);await F.start()}catch(F){this._logErrorAndCancelWorkflow(F)}finally{g.resolve()}}else H("editing:unsupported-workflow","Update workflow is unsupported or disabled.")}async deleteFeatureFromWorkflow(){const {activeWorkflow:c}=this;c&&"update"===c.type?await c.deleteActiveFeature():H("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(c){return this._cancelWorkflow({warnIfNoWorkflow:!0,...c})}findEditorItemForLayer(c){return this.editorItems.find(g=>
g.layer===c)}itemHasInvalidFormTemplate(c){return null!=c&&!0===this.findEditorItemForLayer(c.layer)?.hasInvalidFormTemplate}syncFeatureTemplates(){this._featureTemplatesViewModelLocked||(this.featureTemplatesViewModel.layers=this.featureTemplatesLayers.toArray())}async toggleUpdateWorkflow(){!this.canUpdate||this.hasPendingEdits&&!await this.showDiscardEditsPrompt()||(this.activeWorkflow&&"awaiting-feature-to-update"===this.state?await this.cancelWorkflow({force:!0}):await this.startUpdateWorkflowAtFeatureSelection())}lockFeatureTemplatesViewModel(){this._featureTemplatesViewModelLocked=
!0;return k.makeHandle(()=>{this._featureTemplatesViewModelLocked=!1;this.syncFeatureTemplates()})}async _getEditorItemCandidates(c){const {view:g}=this;if(!g?.map)return[];var {map:F}=g;const I=F.editableLayers.toArray()??[];F=F.allTables.toArray().filter(D.isFeatureLayer)??[];await Promise.allSettled([...I.map(O=>"subtype-group"===O.type?O.loadAll():Promise.resolve()),...F.map(O=>O.load())]);f.throwIfAborted(c);return[...I.reverse(),...F.reverse()].filter(O=>w.isEditableLayer(O)&&("mesh"!==O.geometryType||
"3d"===g.type)).flatMap(O=>"subtype-group"===O.type?O.sublayers.toArray():O)}_drainEditorItems(){this.editorItems.drain(c=>c.destroy())}async _updateEditorItems(){q.abortMaybe(this._updateItemsTask);const {view:c}=this,g=b.createTask(async F=>{if(c?.map&&c?.allLayerViews){var I=await this._getEditorItemCandidates(F);if(I.length){var O=[],R=[],W=[],{layerInfos:V}=this;for(const aa of I){I=h(V,aa);const fa=await S.whenEditorLayerView(c,aa).catch(()=>null);(I?O:fa?R:W).push(new r({layer:aa,layerInfo:I,
layerView:fa}))}V?.length&&O.sort((aa,fa)=>{const ja=V.findIndex(({layer:Z})=>Z===aa.layer),da=V.findIndex(({layer:Z})=>Z===fa.layer);return ja-da});O=[...O,...R,...W];F.aborted||(this._drainEditorItems(),this.editorItems.addMany(O))}else this._drainEditorItems()}});this._updatingHandles.addPromise(g.promise);this._updateItemsTask=g}_afterEditorItemsChange(){const {activeWorkflow:c}=this;this.syncFeatureTemplates();if(c){var {stepId:g}=c;"create-features"===c.type?"awaiting-feature-creation-info"!==
g||this.canCreate||this._cancelWorkflow():"update"===c.type&&("awaiting-feature-to-update"===g&&!this.canUpdateVisible||"awaiting-update-feature-candidate"===g&&!c.hasUpdatableCandidates)&&this._cancelWorkflow()}}async _cancelWorkflow(c){const g=this.activeWorkflow;g?c&&!1===c.force?(await g.cancel(c),this._set("activeWorkflow",null)):(this.emit("workflow-cancel"),this._set("activeWorkflow",null),await g.cancel(c)):c?.warnIfNoWorkflow&&H("editing:no-active-workflow","There is no active workflow to cancel.")}_createCreateFeaturesWorkflow(c,
g){return C.create({viewModel:this,creationInfo:c,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:g,applyEditsCallback:(F,I,O)=>this._applyEdits(F,I,O),addAttachmentsCallback:(F,I)=>this._addAttachments(F,I)})}_createUpdateWorkflow(c){return L.create({viewModel:this,sketchOptions:this.sketchOptions,snappingManager:this._snappingManager,startAt:c,applyEditsCallback:(g,F,I)=>this._applyEdits(g,F,I),addAttachmentsCallback:(g,F)=>this._addAttachments(g,F)})}_addAttachments(c,
g){g=g.map(F=>this._addAttachment(c,F.feature,F.attachment))??[];return Promise.all(g)}async _addAttachment(c,g,F){let I=null;if(!("addAttachment"in c)||null==c.capabilities?.attachment)throw new p("editor:attachments-not-supported","Adding attachments is not supported for this layer type");await this._queueOperation(async()=>I=await c.addAttachment?.(g,F).catch(O=>{throw O?.error||O;})??null);return I}async _applyEdits(c,g,F){let I=null;const O=c.url?await D.getOwningPortalUrl(c.url):null,R={returnServiceEditsOption:O&&
K.parseKnownArcGISOnlineDomain(O)||RegExp("/hosted/","i").test(c.url)?void 0:"original-and-current-features",...F};await this._queueOperation(async()=>{const {view:W}=this;if(!W)return null;const V=await S.whenEditorLayerView(W,c).catch(()=>null);I=await c.applyEdits(g,R);V&&await u.whenOnce(()=>!V.updating);return I});return I}_queueOperation(c){this._activityQueue.push(c);const g=(F,I)=>{F=I.indexOf(F);-1<F&&I.splice(F,1)};return c().then(F=>{if(null!=F&&"error"in F&&null!=F.error)throw F.error;
if(null!=F&&"addFeatureResults"in F){const {addFeatureResults:I,deleteFeatureResults:O,updateFeatureResults:R}=F,W=I.find(V=>!!V.error)||R.find(V=>!!V.error)||O.find(V=>!!V.error);if(W)throw W.error;}return F}).catch(F=>{H("editing:operation-error","An error occurred.",{error:F});const I={error:F,retry:()=>{g(I,this.failures);return this._queueOperation(c)},cancel:()=>{g(I,this.failures)}};this._set("failures",[...this.failures,I])}).then(()=>{g(c,this._activityQueue)})}_createUpdatingResolver(){const c=
f.createResolver();this._updatingHandles.addPromise(c.promise);return c}_logErrorAndCancelWorkflow(c){const {name:g,message:F,details:I}=c;H(g??"editing:workflow-start-failed",F??void 0,I??c);this._cancelWorkflow({force:!0})}_itemIsSuspended(c){c=this.findEditorItemForLayer(c);return null!=c&&(!c.visible||c.disabled)}};a.__decorate([t.property()],l.prototype,"_snappingManager",void 0);a.__decorate([t.property({readOnly:!0})],l.prototype,"activeWorkflow",void 0);a.__decorate([t.property({readOnly:!0})],
l.prototype,"_activityQueue",void 0);a.__decorate([t.property({value:[...e]})],l.prototype,"allowedWorkflows",null);a.__decorate([t.property({readOnly:!0})],l.prototype,"canCreate",null);a.__decorate([t.property()],l.prototype,"canCreateVisible",null);a.__decorate([t.property({readOnly:!0})],l.prototype,"canUpdate",null);a.__decorate([t.property()],l.prototype,"canUpdateVisible",null);a.__decorate([t.property()],l.prototype,"featureTemplatesLayers",null);a.__decorate([t.property()],l.prototype,"editableItems",
null);a.__decorate([t.property()],l.prototype,"editorItems",void 0);a.__decorate([t.property({readOnly:!0})],l.prototype,"failures",void 0);a.__decorate([t.property()],l.prototype,"hideTemplatesForInactiveLayers",void 0);a.__decorate([t.property()],l.prototype,"attachmentsViewModel",void 0);a.__decorate([t.property()],l.prototype,"featureFormViewModel",null);a.__decorate([t.property()],l.prototype,"featureTemplatesViewModel",void 0);a.__decorate([t.property()],l.prototype,"labelOptions",null);a.__decorate([t.property()],
l.prototype,"layerInfos",void 0);a.__decorate([t.property()],l.prototype,"ownSketchViewModel",void 0);a.__decorate([t.property()],l.prototype,"sketchOptions",void 0);a.__decorate([t.property()],l.prototype,"sketchViewModel",null);a.__decorate([t.property({type:P,nonNullable:!0})],l.prototype,"snappingOptions",void 0);a.__decorate([t.property()],l.prototype,"spinnerViewModel",void 0);a.__decorate([t.property()],l.prototype,"state",null);a.__decorate([t.property({readOnly:!0})],l.prototype,"syncing",
null);a.__decorate([t.property()],l.prototype,"updating",null);a.__decorate([t.property()],l.prototype,"tooltipOptions",null);a.__decorate([t.property()],l.prototype,"valueOptions",null);a.__decorate([t.property()],l.prototype,"view",null);a.__decorate([t.property()],l.prototype,"pageStack",void 0);a.__decorate([t.property()],l.prototype,"showDiscardEditsPrompt",void 0);a.__decorate([t.property()],l.prototype,"_candidateCommitted",void 0);a.__decorate([t.property()],l.prototype,"page",null);a.__decorate([t.property()],
l.prototype,"featureFormDisabled",null);a.__decorate([t.property()],l.prototype,"canGoBack",null);a.__decorate([t.property()],l.prototype,"shouldShowDeleteButton",null);a.__decorate([t.property()],l.prototype,"hasPendingEdits",null);a.__decorate([t.property()],l.prototype,"snappingManager",null);return l=a.__decorate([v.subclass("esri.widgets.Editor.EditorViewModel")],l)})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t){d=class extends q.BlendLayer(f.ScaleRangeLayer(E)){constructor(A){super(A);this.elevationInfo=null;this.graphics=new u.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(A){this.graphics.add(A);return this}addMany(A){this.graphics.addMany(A);return this}removeAll(){this.graphics.removeAll();return this}remove(A){this.graphics.remove(A)}removeMany(A){this.graphics.removeMany(A)}on(A,
x){return super.on(A,x)}graphicChanged(A){this.emit("graphic-update",A)}};a.__decorate([b.property({type:t})],d.prototype,"elevationInfo",void 0);a.__decorate([b.property(k.owningCollectionProperty(u.GraphicsCollection,"graphics"))],d.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],d.prototype,"listMode",void 0);a.__decorate([b.property()],d.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],d.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
d.prototype,"internal",void 0);return d=a.__decorate([l.subclass("esri.layers.GraphicsLayer")],d)})},"esri/views/interactive/sketch/SketchOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchLabelOptions ./SketchTooltipOptions ./SketchValueOptions".split(" "),function(a,b,d,m,p,l,k,E,q,f){b=class extends b{constructor(u){super(u);
this.labels=new E;this.tooltips=new q;this.values=new f}};a.__decorate([d.property({nonNullable:!0,type:E})],b.prototype,"labels",void 0);a.__decorate([d.property({nonNullable:!0,type:q})],b.prototype,"tooltips",void 0);a.__decorate([d.property({nonNullable:!0,type:f})],b.prototype,"values",void 0);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.SketchOptions")],b)})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.enabled=!1}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,d,m,p,l,k,E,q){b=class extends b{constructor(f){super(f);this.forceEnabled=this.enabled=!1;this.helpMessageIcon=this.helpMessage=null;this.inputEnabled=!0;this.elevation=new E.SketchTooltipElevationOptions;this.placement="auto";this.offset=null;this.visibleElements=new q;this.visualVariables=null;this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([d.property()],
b.prototype,"forceEnabled",void 0);a.__decorate([d.property()],b.prototype,"effectiveEnabled",null);a.__decorate([d.property()],b.prototype,"helpMessage",void 0);a.__decorate([d.property()],b.prototype,"helpMessageIcon",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",void 0);a.__decorate([d.property({type:E.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([d.property()],b.prototype,"placement",void 0);a.__decorate([d.property()],
b.prototype,"offset",void 0);a.__decorate([d.property({type:q,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([d.property()],b.prototype,"visualVariables",void 0);a.__decorate([d.property()],b.prototype,"xyMode",void 0);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k,E){a.SketchTooltipElevationOptions=class extends d{constructor(q){super(q);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([m.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([E.subclass("esri.views.interactive.sketch.SketchTooltipElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.header=this.elevation=this.distance=this.direction=this.coordinates=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"area",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"coordinates",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,
"direction",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"distance",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"helpMessage",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"orientation",void 0);a.__decorate([d.property({type:Boolean,
nonNullable:!0})],b.prototype,"radius",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"rotation",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"scale",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"size",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"totalLength",void 0);return b=a.__decorate([k.subclass("esri.views.interactive.sketch.SketchTooltipVisibleElements")],b)})},"esri/views/interactive/snapping/SnappingManager":function(){define("require exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/asyncUtils ../../../core/Evented ../../../core/has ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/projection ../../../support/elevationInfoUtils ../sketch/normalizedPoint ./Settings ./SnappingDomain ./SnappingOptions ./snappingUtils ./candidates/DrapedEdgeSnappingCandidate ./candidates/EdgeSnappingCandidate ./candidates/IntersectionSnappingCandidate ./candidates/LineSnappingCandidate ./candidates/ParallelLineSnappingCandidate ./candidates/RightAngleSnappingCandidate ./candidates/RightAngleTriangleSnappingCandidate ../support/viewUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S,r){function J(h,e){return!e||null==e.direction&&null==e.distance?!0:h instanceof N.DrapedEdgeSnappingCandidate||h instanceof G.EdgeSnappingCandidate||h instanceof z.LineSnappingCandidate||h instanceof C.ParallelLineSnappingCandidate||h instanceof S.RightAngleTriangleSnappingCandidate||h instanceof L.RightAngleSnappingCandidate&&(null!=e.direction||h.selfSnappingType!==L.SelfSnappingRightAngleType.LastVertex)?!1:!0}function M(h,e){let c=
-1;for(let g=0;g<h.length;++g)if(e.constraint.equals(h[g].constraint)){c=g;break}return c}function y({coordinateHelper:h,elevationInfo:e}){return h.hasZ()?v.absoluteHeightElevationInfo:e}b.SnappingManager=class extends l.EventedMixin(m){constructor(h){super(h);this.options=new D;this._engineCache=new Map;this._loadTask=null;this._engines=[];this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=H.MAIN}initialize(){this.addHandles([q.watch(()=>{const {distance:h,
touchSensitivityMultiplier:e,effectiveSelfEnabled:c,effectiveFeatureEnabled:g,effectiveGridEnabled:F}=this.options;return{selfEnabled:c,featureEnabled:g,gridEnabled:"2d"===this.view.type&&F,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:h,touchSensitivityMultiplier:e}},(h,e)=>{e&&(this.doneSnapping(),this.emit("changed"));this._loadTask?.abort();this._loadTask=p.createTask(c=>this._updateEngines(h,e,c))},q.syncAndInitial),q.watch(()=>this.options,h=>{for(const e of this._engines)e.options=
h},q.sync)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(h=>h.updating)||!this._loadTask?.finished}_destroyEngines(){this._engineCache.forEach(h=>h.destroy());this._engineCache.clear();this._engines=[]}async _updateEngines(h,e,c){if(h.viewReady){e?.viewSpatialReference!==h.viewSpatialReference&&this._destroyEngines();({_engineCache:e}=this);var g=[];h.featureEnabled&&!e.has("feature")&&g.push(this._setupFeatureSnappingEngine(c));h.selfEnabled&&!e.has("self")&&g.push(this._setupSelfSnappingEngine(c));
h.gridEnabled&&!e.has("grid")&&"2d"===this.view.type&&g.push(this._setupGridSnappingEngine(c));await Promise.allSettled(g);c.aborted||(this._engines=Array.from(e.values()))}else this._destroyEngines()}async _setupSelfSnappingEngine(h){const {SelfSnappingEngine:e}=await new Promise((c,g)=>a(["./SelfSnappingEngine"],c,g));E.throwIfAborted(h);h=new e({view:this.view,options:this.options});this._engineCache.set("self",h)}async _setupGridSnappingEngine(h){const {view:e}=this,{GridSnappingEngine:c}=await new Promise((g,
F)=>a(["./GridSnappingEngine"],g,F));E.throwIfAborted(h);"2d"===e.type&&(h=new c({view:e,options:this.options}),this._engineCache.set("grid",h))}async _setupFeatureSnappingEngine(h){const {FeatureSnappingEngine:e}=await new Promise((I,O)=>a(["./FeatureSnappingEngine"],I,O));E.throwIfAborted(h);const {view:c,options:g,_engineCache:F}=this;h=new e({view:c,options:g,spatialReference:c.spatialReference});F.set("feature",h)}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const {distance:h,
touchSensitivityMultiplier:e}=this.options,c=h*e;return c*c}snap(h){return null!=h.scenePoint?this._snapMultiPoint(h):this._snapSinglePoint(h)}update(h){const {point:e,context:c}=h;this._removeVisualization();const g=this._currentMainCandidate;if(null==g)return e;var F=this._selectUpdateInput(h);if(null==F)return e;({spatialReference:h}=c);var I=x.project(F,h);if(null==I)return e;({view:F}=this);const {elevationInfo:O,visualizer:R}=c,W=[];I=B.fromPoint(I,F,O);const V=g.constraint.closestTo(I);if(!this._arePointsWithinScreenThreshold(I,
V,c)||!J(g,c.drawConstraints))return this._resetSnappingState(),e;g.targetPoint=B.markAsTarget(V);W.push(...g.hints);for(const aa of this._currentOtherActiveCandidates)J(aa,c.drawConstraints)&&(aa.targetPoint=B.markAsTarget(V),W.push(...aa.hints));null!=R&&this.addHandles(R.draw(W,{spatialReference:h,elevationInfo:y(c),view:F,selfSnappingZ:c.selfSnappingZ}),"visualization-handle");return B.toElevationAlignedDehydratedPoint(V,F,e,c)}doneSnapping(){this._removeVisualization();this._resetSnappingState()}_selectUpdateInput({point:h,
scenePoint:e}){switch(this._currentSnappedType){case H.MAIN:return h;case H.SCENE:return e}}_resetSnappingState(){this._currentMainCandidate=null;this._currentOtherActiveCandidates=[];this._currentSnappedType=H.MAIN}_removeVisualization(){this.removeHandles("visualization-handle")}async _snapSinglePoint({point:h,context:e,signal:c}){const {view:g}=this;var {elevationInfo:F}=e;F=B.fromPoint(h,g,F);const I=await this._fetchCandidates(F,w.SnappingDomain.ALL,e,c);return this._createSnapResult(F,H.MAIN,
I,g,h,e,c)}async _snapMultiPoint({point:h,scenePoint:e,context:c,signal:g}){const {view:F}=this,{coordinateHelper:I,elevationInfo:O,spatialReference:R}=c;await x.initializeProjection(e.spatialReference,R);e=x.project(e,R);var W=B.fromPoint(e,F,O);const V=await this._fetchCandidates(W,w.SnappingDomain.FEATURE,c,g);if(0<V.length)return h=await this._fetchCandidates(W,w.SnappingDomain.SELF,c,g),this._createSnapResult(W,H.SCENE,[...V,...h],F,e,c,g);e=B.fromPoint(h,F,O);W=await this._fetchCandidates(e,
w.SnappingDomain.SELF,c,g);return this._createSnapResult(e,H.MAIN,W,F,{z:I.hasZ()&&h.hasZ?h.z??0:void 0,m:I.hasM()&&h.hasM?h.m??0:void 0},c,g)}async _fetchCandidates(h,e,c,g){return(await Promise.all(this._engines.map(F=>F.fetchCandidates(h,e,c,g)))).flat()}_createSnapResult(h,e,c,g,F,I,O){return{get valid(){return!E.isAborted(O)},apply:()=>{const {spatialReference:R}=I,{snappedPoint:W,hints:V}=this._processCandidates(h,e,c,I);this._removeVisualization();null!=I.visualizer&&this.addHandles(I.visualizer.draw(V,
{spatialReference:R,elevationInfo:v.absoluteHeightElevationInfo,view:g,selfSnappingZ:I.selfSnappingZ}),"visualization-handle");return B.toElevationAlignedDehydratedPoint(W,g,F,I)}}}_processCandidates(h,e,c,g){if(1>c.length)return this.doneSnapping(),{snappedPoint:h,hints:[]};this._currentSnappedType!==e&&this._resetSnappingState();K.sortCandidatesInPlace(h,c);const F=this._currentMainCandidate;if(null!=F){var I=F instanceof P.IntersectionSnappingCandidate?0<=M(c,F.first)&&0<=M(c,F.second)?0:-1:M(c,
F);if(0<=I)if(c[I]instanceof P.IntersectionSnappingCandidate){if(this._arePointsWithinScreenThreshold(h,F.targetPoint,g))return this._updateSnappingCandidate(F,e,c,g)}else return this._intersectWithOtherCandidates(I,c,h,e,g)}return this._intersectWithOtherCandidates(0,c,h,e,g)}_intersectWithOtherCandidates(h,e,c,g,F){const {coordinateHelper:I}=F,O=e[h],R=[];for(let W=0;W<e.length;++W){if(W===h)continue;const V=e[W],aa=O.constraint.intersect(V.constraint);if(aa)for(const fa of aa.closestPoints(O.targetPoint))R.push([new P.IntersectionSnappingCandidate(B.markAsTarget(fa),
O,V,V.isDraped),this._squaredScreenDistance(c,fa,I)])}return 0<R.length&&(R.sort((W,V)=>W[1]-V[1]),R[0][1]<this._squaredPointProximityThreshold(F.pointer))?this._updateSnappingCandidate(R[0][0],g,e,F):J(O,F.drawConstraints)?this._updateSnappingCandidate(O,g,e,F):{snappedPoint:c,hints:[]}}_updateSnappingCandidate(h,e,c,g){this.doneSnapping();this._currentMainCandidate=h;this._currentSnappedType=e;e=this._currentMainCandidate.targetPoint;const F=[];F.push(...h.hints);for(const I of c){if(h instanceof
P.IntersectionSnappingCandidate){if(I.constraint.equals(h.first.constraint)||I.constraint.equals(h.second.constraint))continue}else if(I.constraint.equals(h.constraint))continue;c=I.constraint.closestTo(e);this._squaredScreenDistance(c,e,g.coordinateHelper)<n.defaults.satisfiesConstraintScreenThreshold*n.defaults.satisfiesConstraintScreenThreshold&&(I.targetPoint=e,this._currentOtherActiveCandidates.push(I),F.push(...I.hints))}return{snappedPoint:e,hints:F}}_squaredPointProximityThreshold(h){return"touch"===
h?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(h,e,c){return this._squaredScreenDistance(h,e,c.coordinateHelper)<this._squaredPointProximityThreshold(c.pointer)}_squaredScreenDistance(h,e,c){return K.squaredScreenDistance(this._toScreen(h,c),this._toScreen(e,c))}_toScreen(h,e){return r.vectorToScreenPoint(h,e.spatialReference,v.absoluteHeightElevationInfo,this.view)}get test(){}};d.__decorate([f.property({constructOnly:!0})],b.SnappingManager.prototype,
"view",void 0);d.__decorate([f.property()],b.SnappingManager.prototype,"options",void 0);d.__decorate([f.property({readOnly:!0})],b.SnappingManager.prototype,"updating",null);d.__decorate([f.property()],b.SnappingManager.prototype,"_loadTask",void 0);d.__decorate([f.property()],b.SnappingManager.prototype,"_engines",void 0);d.__decorate([f.property()],b.SnappingManager.prototype,"_squaredMouseProximityThreshold",null);d.__decorate([f.property()],b.SnappingManager.prototype,"_squaredTouchProximityThreshold",
null);b.SnappingManager=d.__decorate([A.subclass("esri.views.interactive.snapping.SnappingManager")],b.SnappingManager);var H;(function(h){h[h.MAIN=0]="MAIN";h[h.SCENE=1]="SCENE"})(H||={});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/elevationInfoUtils":function(){define(["exports","../core/unitUtils","../symbols/support/unitConversionUtils"],function(a,b,d){function m(n,w){return w?.mode?w.mode:(n?v:B).mode}function p(n,w){return null!=w?w:n?v:B}function l(n,w){return m(null==
n?!0:n.hasZ??!1,w)}function k(n){const w=f(n);n=l(n.geometry,w);const D=null!=w&&"on-the-ground"!==n?x(w):0;return{mode:n,offset:D,featureExpressionInfo:w?.featureExpressionInfo}}function E(n){return"0"===n?.featureExpressionInfo?.expression}function q(n){if(!n||"on-the-ground"===n.mode)return!1;n=n?.featureExpressionInfo?n.featureExpressionInfo.expression:null;return!(!n||"0"===n)}function f(n){return n.layer&&"elevationInfo"in n.layer?n.layer.elevationInfo:null}function u(n,w){if(!n?.offset)return 0;
const {offset:D,unit:K}=n;if("decimal-degrees"===K)return 0;n="unknown"!==K&&K?K:"meters";return(w=b.verticalLengthUnitFromSpatialReference(w))?b.convertUnit(D,n,w):0}function t(n,w,D,K,N,G,P=null){if(null!=G){var z=null!=P?P.mode:"absolute-height";if("on-the-ground"===z)return 0;({absoluteZ:G}=A(w,D,K,N,n,G));a:{P=u(P,N);switch(z){case "absolute-height":n=G-P;break a;case "relative-to-ground":n=G-((n.elevationProvider.getElevation(w,D,K,N,"ground")??0)+P);break a;case "relative-to-scene":n=G-((n.elevationProvider.getElevation(w,
D,K,N,"scene")??0)+P);break a}n=void 0}return n}}function A(n,w,D,K,N,G){const P=u(G,K);switch(G.mode){case "absolute-height":return{absoluteZ:D+P,elevation:0};case "on-the-ground":return D=N.elevationProvider.getElevation(n,w,0,K,"ground")??0,{absoluteZ:D,elevation:D};case "relative-to-ground":return n=N.elevationProvider.getElevation(n,w,D,K,"ground")??0,{absoluteZ:D+n+P,elevation:n};case "relative-to-scene":return n=N.elevationProvider.getElevation(n,w,D,K,"scene")??0,{absoluteZ:D+n+P,elevation:n}}}
function x(n){return(n?.offset??0)*d.getMetersPerUnit(n?.unit)}const v={mode:"absolute-height",offset:0},B={mode:"on-the-ground",offset:null};a.absoluteHeightElevationInfo=v;a.elevationContextAffectsAlignment=function(n,w){if(null==w)return!1;({mode:w}=w);return null!=w&&("scene"===n&&"relative-to-scene"===w||"ground"===n&&"absolute-height"!==w)};a.elevationModeRequiredMessage=function(n,w,D){return D&&D.mode!==w?`${n} only support ${w} elevation mode`:null};a.elevationModeUnsupportedMessage=function(n,
w,D){return D?.mode===w?`${n} do not support ${w} elevation mode`:null};a.featureExpressionInfoIsZero=E;a.featureExpressionUnsupportedMessage=function(n,w){return null!=w?.featureExpressionInfo&&"0"!==w.featureExpressionInfo.expression?`${n} do not support featureExpressionInfo`:null};a.getConvertedElevation=function(n,w,D,K=null){return t(n,w.x,w.y,w.hasZ?w.z:0,w.spatialReference,D,K)};a.getConvertedElevationFromVector=function(n,w,D,K,N=null){return t(n,w[0],w[1],2<w.length?w[2]:0,D,K,N)};a.getConvertedElevationFromXYZ=
t;a.getEffectiveElevationInfo=p;a.getEffectiveElevationMode=m;a.getElevationOffset=u;a.getElevationOffsetInMeters=x;a.getGeometryEffectiveElevationInfo=function(n,w){return p(null==n?!0:n.hasZ??!1,w)};a.getGeometryEffectiveElevationMode=l;a.getGraphicEffectiveElevationInfo=k;a.getGraphicEffectiveElevationMode=function(n){const w=f(n);return l(n.geometry,w)};a.getZForElevationMode=function(n,w,D){if(D?.mode){var K=n.hasZ?n.z:0,N=u(D,n.spatialReference);switch(D.mode){case "absolute-height":return K-
N;case "on-the-ground":return 0;case "relative-to-ground":return n=(w.elevationProvider.getElevation(n.x,n.y,K,n.spatialReference,"ground")??0)+N,K-n;case "relative-to-scene":return n=(w.elevationProvider.getElevation(n.x,n.y,K,n.spatialReference,"scene")??0)+N,K-n}}};a.hasEffectiveFeatureExpressionInfo=q;a.hasFeatureExpressionInfo=function(n){return q(n)||E(n)};a.hasGraphicFeatureExpressionInfo=function(n){return q(k(n))};a.logInvalidElevationInfoWarning=function(n,w){w&&n.warn(".elevationInfo\x3d",
w)};a.onTheGroundElevationInfo=B;a.zValueInAbsoluteHeightMode=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,d,m){function p(q=0,f=0,u=0){return b.fromValues(q,f,u)}function l(q,f,u,t=p()){t[0]=q.x;t[1]=q.y;t[2]=q.z??0;if(null==f)return t;t[2]="2d"===f.type?0:
m.getConvertedElevation(f,q,u,m.absoluteHeightElevationInfo)??0;return t}var k;(function(q){q[q.NONE=0]="NONE";q[q.TARGET=1]="TARGET"})(k||={});const E=d.makeDehydratedPoint(0,0,0,null);a.asVec2=function(q){return q};a.clone=function(q){const [f,u,t]=q;return 3<q.length?[f,u,t,q[3]]:[f,u,t]};a.create=function(q,f,u){return p(q,f,u)};a.createWritable=p;a.fromAnyMapPoint=function(q,f,{coordinateHelper:u,elevationInfo:t},A){return q?l(u.vectorToDehydratedPoint(q,E),f,t,A):null};a.fromPoint=l;a.fromValues=
function(q,f,u){return b.fromValues(q,f,u)};a.fromVec3=function(q){return q};a.isTarget=function(q){return!!(((3<q.length?q[3]:void 0)??k.NONE)&k.TARGET)};a.markAsTarget=function(q){q[3]=((3<q.length?q[3]:void 0)??k.NONE)|k.TARGET;return q};a.toDehydratedPoint=function(q,f,u){return u?(d.setDehydratedPoint(u,q[0],q[1],q[2],f),u):d.makeDehydratedPoint(q[0],q[1],q[2],f)};a.toElevationAlignedDehydratedPoint=function(q,f,{z:u,m:t},A,x){const {spatialReference:v,elevationInfo:B}=A;f=null==u&&null==t?void 0:
null==f||"2d"===f.type?u??void 0:m.getConvertedElevationFromVector(f,q,v,m.absoluteHeightElevationInfo,B)??0;const [n,w]=q;x?d.setDehydratedPoint(x,n,w,f,v):x=d.makeDehydratedPoint(n,w,f,v);null!=t&&(x.m=t,x.hasM=!0);return x};a.withSelfSnappingZ=function(q,f,u,t,A=p()){const [x,v]=q;A[0]=x;A[1]=v;3<q.length&&(A[3]=q[3]??k.NONE);if("3d"!==u?.type)return A[2]=f.value,A;A[2]=m.getConvertedElevationFromXYZ(u,x,v,f.value,t,f.elevationInfo,m.absoluteHeightElevationInfo)??0;return A};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l){let k=class extends m.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([p.property({type:Boolean})],k.prototype,"enabled",void 0);k=b.__decorate([l.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],
k);m=class extends m.JSONSupport{constructor(E){super(E);this.lineSnapper=new k;this.parallelLineSnapper=new k;this.rightAngleSnapper=new k;this.rightAngleTriangleSnapper=new k;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThresholdMeters=.3;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=1E-6;this.orange=new d([255,127,0]);this.orangeTransparent=new d([255,127,0,.5]);this.lineHintWidthTarget=
this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=1}};b.__decorate([p.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"lineSnapper",void 0);b.__decorate([p.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"parallelLineSnapper",void 0);
b.__decorate([p.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"rightAngleSnapper",void 0);b.__decorate([p.property({type:k,constructOnly:!0,nonNullable:!0,json:{write:!0}})],m.prototype,"rightAngleTriangleSnapper",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],m.prototype,"shortLineThreshold",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],m.prototype,
"distance",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"pointThreshold",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"parallelLineThreshold",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,
max:1},json:{write:!0}})],m.prototype,"verticalLineThresholdMeters",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],m.prototype,"pointOnLineThreshold",void 0);b.__decorate([p.property({type:d,nonNullable:!0})],m.prototype,"orange",void 0);b.__decorate([p.property({type:d,nonNullable:!0})],m.prototype,"orangeTransparent",
void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"lineHintWidthReference",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],m.prototype,"lineHintWidthTarget",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],m.prototype,"lineHintFadedExtensions",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
m.prototype,"parallelLineHintWidth",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],m.prototype,"parallelLineHintLength",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],m.prototype,"parallelLineHintOffset",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],m.prototype,"rightAngleHintSize",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,
range:{min:0,max:6},json:{write:!0}})],m.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([p.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],m.prototype,"satisfiesConstraintScreenThreshold",void 0);m=b.__decorate([l.subclass("esri.views.interactive.snapping.Settings.Defaults")],m);b=new m;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=
void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Logger ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/decorators/subclass ./FeatureSnappingLayerSource ./Settings".split(" "),
function(a,b,d,m,p,l,k,E,q,f){function u(x){return"subtype-group"===x.layer.type}function t(x){return"subtype-group"!==x.layer.type}function A(x){return"subtype-sublayer"===x.layer.type}b=class extends b{constructor(x){super(x);this.forceDisabled=this.enabledToggled=this.enabled=!1;this.featureEnabled=this.selfEnabled=!0;this.attributeRulesEnabled=this.gridEnabled=!1;this.featureSources=new m;this.distance=f.defaults.distance;this.touchSensitivityMultiplier=f.defaults.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&
(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var x=this.featureSources;x.some(u)&&p.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");
const v=x.filter(A),B=this._get("_effectiveFeatureSources")?.filter(u)??new m;for(const N of v){var n=B.find(G=>G.layer===N.layer.parent);n?n.sublayerSources.includes(N)||n.sublayerSources.add(N):N.layer.parent&&(n=new q({layer:N.layer.parent}),n.sublayerSources.add(N),B.add(n))}for(var w of B)n=w.sublayerSources.filter(N=>!v.includes(N)),w.sublayerSources.removeMany(n);B.removeMany(B.filter(N=>0===N.sublayerSources.length));x=x.filter(t);w=this._get("_effectiveFeatureSources")??new m;const {added:D,
removed:K}=d.difference(w.toArray(),[...x,...B]);w.removeMany(K);w.addMany(D);return w}};a.__decorate([l.property()],b.prototype,"enabled",void 0);a.__decorate([l.property()],b.prototype,"enabledToggled",void 0);a.__decorate([l.property()],b.prototype,"forceDisabled",void 0);a.__decorate([l.property()],b.prototype,"selfEnabled",void 0);a.__decorate([l.property()],b.prototype,"featureEnabled",void 0);a.__decorate([l.property()],b.prototype,"gridEnabled",void 0);a.__decorate([l.property()],b.prototype,
"attributeRulesEnabled",void 0);a.__decorate([l.property({type:m.ofType(q)})],b.prototype,"featureSources",void 0);a.__decorate([l.property()],b.prototype,"distance",void 0);a.__decorate([l.property()],b.prototype,"touchSensitivityMultiplier",void 0);a.__decorate([l.property({readOnly:!0})],b.prototype,"effectiveEnabled",null);a.__decorate([l.property({readOnly:!0})],b.prototype,"effectiveGridEnabled",null);a.__decorate([l.property({readOnly:!0})],b.prototype,"effectiveSelfEnabled",null);a.__decorate([l.property({readOnly:!0})],
b.prototype,"effectiveFeatureEnabled",null);a.__decorate([l.property({readOnly:!0})],b.prototype,"_effectiveFeatureSources",null);return b=a.__decorate([E.subclass("esri.views.interactive.snapping.SnappingOptions")],b)})},"esri/views/interactive/snapping/FeatureSnappingLayerSource":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k,E){b=class extends b{constructor(q){super(q);this.layer=null;this.enabled=!0;this.updating=!1;this.availability=1;this.sublayerSources=new d}};a.__decorate([m.property({constructOnly:!0})],b.prototype,"layer",void 0);a.__decorate([m.property()],b.prototype,"enabled",void 0);a.__decorate([m.property()],b.prototype,"updating",void 0);a.__decorate([m.property()],b.prototype,"availability",void 0);a.__decorate([m.property()],b.prototype,"sublayerSources",void 0);return b=a.__decorate([E.subclass("esri.views.interactive.snapping.FeatureSnappingLayerSource")],
b)})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec32 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint ../../../webmap/utils".split(" "),function(a,b,d,m,p,l,k,E,q,f,u,t){function A(B,n){const w=B.x-n.x;B=B.y-n.y;return w*w+B*B}const x=Symbol("grid-placement-graphic");a.LineSegmentHintType=
void 0;(function(B){B[B.TARGET=0]="TARGET";B[B.REFERENCE=1]="REFERENCE";B[B.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));const v=Symbol("snapping-toggle");a.editEdgeToSnappingEdge=function(B,n,w){return{left:u.fromAnyMapPoint(B.leftVertex.pos,n,w),right:u.fromAnyMapPoint(B.rightVertex.pos,n,w)}};a.gridPlacementGraphicSymbol=x;a.isUtilityNetworkWebMap=function(B){return t.isWebMap(B)&&"utilityNetworks"in B&&!!B.utilityNetworks?.length};a.makeFilter=
function(B){return B.createQuery()};a.makeSnappingQuery=function({point:B,distance:n,returnEdge:w,vertexMode:D,coordinateHelper:{spatialReference:K},filter:N},G,P){P=null!=P?P.clone():new E({where:"1\x3d1"});if(N){P.geometry=N.geometry;P.distance=N.distance;P.spatialRelationship=N.spatialRelationship;P.where=m.sqlAnd(P.where,N.where);P.timeExtent=p.mergeTimeExtents(P.timeExtent,N.timeExtent);var z=P;var C=P.objectIds;N=N.objectIds;C=C||N?N?C?Array.from(d.intersection(new Set(C),new Set(N))):N:C:null;
z.objectIds=C}return{point:k.makeDehydratedPoint(B[0],B[1],B[2],K.toJSON()),mode:G,distance:n,returnEdge:w,vertexMode:D,query:P.toJSON()}};a.objectEqual=function(B,n){const w=B.length===n.length&&B[0]===n[0]&&B[1]===n[1];switch(B.length){case 2:return w;case 3:return w&&B[2]===n[2];case 4:return w&&B[2]===n[2]&&B[3]===n[3]}return!1};a.screenDistance=function(B,n){return Math.sqrt(A(B,n))};a.setupSnappingToggleHandles=function(B,n=()=>{}){const w=b.watch(()=>({view:B.view,snappingOptions:B.snappingOptions}),
({view:D,snappingOptions:K})=>{B.removeHandles(v);if(D&&K){var N=q.ViewEventPriorities.TOOL;D=[D.on("key-down",G=>{G.key!==f.snappingKeys.toggle||G.repeat||(K.enabledToggled=!0,n())},N),D.on("key-up",G=>{G.key===f.snappingKeys.toggle&&(K.enabledToggled=!1,n())},N),D.on("pointer-move",G=>{G=G.native.ctrlKey;K.enabledToggled!==G&&(K.enabledToggled=G,n())},N)];B.addHandles(D,v)}},b.syncAndInitial);B.addHandles(w)};a.sortCandidatesInPlace=function(B,n){n.sort((w,D)=>{w=l.squaredDistance(w.targetPoint,
B);D=l.squaredDistance(D.targetPoint,B);return w-D})};a.squaredScreenDistance=A;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define("exports ../../core/arrayUtils ../../core/handleUtils ../../core/MapUtils ../input/InputManager ../input/keys".split(" "),function(a,b,d,m,p,l){l={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},
moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:l.primaryKey,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"};class k{constructor(){this._bindings=new Map}add(q,f){return this.addToggle(q,u=>{"key-down"===u.type&&f(u)})}addToggle(q,f){const u=E.fromDefinition(q,f),t=m.getOrCreateMapValue(this._bindings,
u.key,()=>[]);t.push(u);return d.makeHandle(()=>b.remove(t,u))}register(q,f=p.ViewEventPriorities.WIDGET){return d.handlesGroup([q.on("key-down",u=>this.dispatch(q.inputManager,u),f),q.on("key-up",u=>this.dispatch(q.inputManager,u),f)])}dispatch(q,f){const u=this._bindings.get(f.key);if(u)for(const t of u)t.process(q,f)}}class E{constructor(q,f,u,t,A){this.key=q;this.modifiers=f;this.repeats=u;this.continuePropagation=t;this.callback=A}process(q,f){if(!(f.key!==this.key||"repeat"in f&&f.repeat&&!this.repeats)){for(const u of this.modifiers)if(!q.isModifierKeyDown(u))return;
this.continuePropagation||f.stopPropagation();this.callback(f)}}static fromDefinition(q,f){if("string"===typeof q)return new E(q,[],!1,!1,f);const {key:u,modifier:t,repeats:A,continuePropagation:x}=q;return new E(u,t?Array.isArray(t)?t:[t]:[],!!A,!!x,f)}}a.KeyBindings=k;a.mediaKeys=l;a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",
commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/utils":function(){define(["exports","./Version"],function(a,b){b=new b.Version(2,32);a.currentVersion=b;a.isWebMap=function(d){return null!=d&&"object"===typeof d&&"declaredClass"in d&&"esri.WebMap"===d.declaredClass};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/Version":function(){define(["exports","../core/Version"],function(a,b){class d extends b.Version{constructor(m,
p){super(m,p,"webmap")}}a.Version=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,d,m,p){class l extends m.FeatureSnappingCandidate{constructor(k){super({...k,isDraped:!0,constraint:new b.DrapedLineConstraint(k.edgeStart,k.edgeEnd,k.getGroundElevation)})}get hints(){return[new p.LineSnappingHint(d.LineSegmentHintType.REFERENCE,
this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}a.DrapedEdgeSnappingCandidate=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../core/mathUtils ../../../core/libs/gl-matrix-2/math/vec2 ../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../chunks/vec42 ../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../geometry/support/geodesicConstants ../../../geometry/support/geodesicUtils ../../../geometry/support/plane ../../../chunks/sphere ../../3d/support/mathUtils ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){function w(Y,ca){if(Y instanceof W){var qa=[];for(const sa of Y.constraints)(Y=sa.intersect(ca))&&qa.push(Y);return S(qa)}if(ca instanceof W)return w(ca,Y);if(Y instanceof ea)return P(Y,ca);if(ca instanceof ea)return P(ca,Y);if(r(Y)){({point:qa}=Y);if(r(ca))return l.exactEquals(qa,ca.point)?Y:void 0;ca=ca.closestTo(qa);return l.equals(ca,qa)?Y:void 0}if(J(Y)){if(r(ca))return w(ca,Y);if(J(ca))return C(B.intersectLineLikes(Y.lineLike,ca.lineLike));if(M(ca))return oa(Y,
ca);if(y(ca))return C(B.intersectVerticalPlaneAndLineLike(ca.planeLike,Y.lineLike));if(H(ca))return C(B.intersectLineLikeAndVerticalCylinder(Y.lineLike,ca.center,ca.radius));if(e(ca))return C(B.intersectLineLikeAndCircle(Y.lineLike,ca));if(h(ca))return D(Y,ca);if(c(ca))return K(Y,ca)}else if(M(Y)){if(r(ca)||J(ca))return w(ca,Y);if(M(ca))return B.isClose(Y.z,ca.z)?Y:void 0;if(y(ca))return N(Y,ca);if(H(ca)){const [sa,wa]=ca.center;return new aa(v.fromValues(sa,wa,Y.z),ca.radius)}if(e(ca))return ua(Y,
ca);if(h(ca))return B.isClose(ca.center[2],Y.z)?ca:void 0;if(c(ca))return G(Y,ca)}else if(y(Y)){if(r(ca)||J(ca)||M(ca))return w(ca,Y);if(y(ca))return z(B.intersectVerticalPlanes(Y.planeLike,ca.planeLike));if(H(ca))return z(B.intersectVerticalPlaneAndVerticalCylinder(Y.planeLike,ca.center,ca.radius));if(e(ca))return ya(Y,ca);if(h(ca))return za(Y,ca);if(c(ca))return va(Y,ca)}else if(H(Y)){if(r(ca)||J(ca)||M(ca)||y(ca))return w(ca,Y);if(H(ca))return z(B.intersectVerticalCylinders(v.asVec2(Y.center),
Y.radius,v.asVec2(ca.center),ca.radius));if(!e(ca)){if(h(ca))return qa=m.squaredDistance(v.asVec2(Y.center),v.asVec2(ca.center)),B.isClose(qa,0)&&B.isClose(Y.radius,ca.radius)||(Y=B.intersectVerticalCylinders(v.asVec2(Y.center),Y.radius,v.asVec2(ca.center),ca.radius),ca=L(Y,ca.center[2])),ca;c(ca)}}else if(e(Y)){if(r(ca)||J(ca)||M(ca)||y(ca)||H(ca))return w(ca,Y);e(ca)||(h(ca)?ca.asCircle():c(ca))}else if(h(Y)){if(r(ca)||J(ca)||M(ca)||y(ca)||H(ca)||e(ca))return w(ca,Y);if(h(ca))return B.vectorsHaveCloseZ(ca.center,
Y.center)?(qa=m.squaredDistance(v.asVec2(ca.center),v.asVec2(Y.center)),B.isClose(qa,0)&&B.isClose(ca.radius,Y.radius)||(Y=B.intersectVerticalCylinders(v.asVec2(ca.center),ca.radius,v.asVec2(Y.center),Y.radius),ca=L(Y,ca.center[2]))):ca=void 0,ca;c(ca)}else if(c(Y)){if(r(ca)||J(ca)||M(ca)||y(ca)||H(ca)||h(ca))return w(ca,Y);c(ca)}}function D({lineLike:Y},{center:ca,radius:qa}){const sa=ca[2];Y=B.intersectLineLikeAndVerticalCylinder(Y,ca,qa).filter(wa=>B.isClose(wa[2],sa));return C(Y)}function K({lineLike:Y},
{sphere:ca}){return C(A.intersectLine(ca,Y.start,Y.end))}function N({z:Y},{planeLike:ca}){const [qa,sa]=ca.start,[wa,Aa]=ca.end,Ba=v.fromValues(qa,sa,Y);Y=v.fromValues(wa,Aa,Y);return ca.type===B.VerticalPlaneType.PLANE?new O(Ba,Y):new R(Ba,Y)}function G(Y,{center:ca,radius:qa}){const sa=Math.abs(ca[2]-Y.z);if(!(sa>qa)||B.isClose(sa,qa))if(Y=v.fromValues(ca[0],ca[1],Y.z),qa=Math.sqrt(qa**2-sa**2),!B.isClose(qa,0))return new aa(Y,qa)}function P(Y,ca){const {planeLike:qa,getZ:sa}=Y,wa=[];if(r(ca))Y.addIfOnTheGround(wa,
B.intersectVerticalPlaneAndPoint(qa,ca.point));else if(J(ca))Y.addIfOnTheGround(wa,B.intersectVerticalPlaneAndLineLike(qa,ca.lineLike));else if(H(ca))for(const [Aa,Ba]of B.intersectVerticalPlaneAndVerticalCylinder(qa,ca.center,ca.radius))Y=sa(Aa,Ba),null!=Y&&wa.push(k.fromValues(Aa,Ba,Y));else if(y(ca)||ca instanceof ea)for(const [Aa,Ba]of B.intersectVerticalPlanes(qa,ca.planeLike))Y=sa(Aa,Ba)??0,wa.push(k.fromValues(Aa,Ba,Y));return C(wa)}function z(Y){return S(Y.map(([ca,qa])=>{const sa=v.fromValues(ca,
qa,0);ca=v.fromValues(ca,qa,1);return new O(sa,ca)}))}function C(Y){return S(Y.map(ca=>ca?new F(v.fromVec3(ca)):void 0))}function L(Y,ca){return C(Y.map(([qa,sa])=>[qa,sa,ca]))}function S(Y){if(0!==Y.length)return 1===Y.length?Y[0]??void 0:new W(Y.filter(b.isSome))}function r(Y){return Y instanceof F}function J(Y){return Y instanceof I}function M(Y){return Y instanceof Z}function y(Y){return Y instanceof la}function H(Y){return Y instanceof V}function h(Y){return Y instanceof aa}function e(Y){return Y instanceof
fa}function c(Y){return Y instanceof X}class g{intersect(Y){return w(this,Y)}closestPoints(Y){return[this.closestTo(Y)]}}class F extends g{constructor(Y){super();this.point=Y}equals(Y){return this===Y||r(Y)&&l.exactEquals(this.point,Y.point)}closestTo(){return v.clone(this.point)}}class I extends g{constructor(Y,ca,qa){super();this.start=Y;this.end=ca;this.lineLike={start:Y,end:ca,type:qa}}equals(Y){return this===Y||J(Y)&&this.lineLike.type===Y.lineLike.type&&l.exactEquals(this.start,Y.start)&&l.exactEquals(this.end,
Y.end)}closestTo(Y){const ca=v.createWritable();B.projectPointToLineLike(Y,this.lineLike,ca);return ca}}class O extends I{constructor(Y,ca){super(Y,ca,n.LineType.LINE)}}class R extends I{constructor(Y,ca){super(Y,ca,n.LineType.RAY)}}class W extends g{constructor(Y){super();this.constraints=Y}equals(Y){return this===Y||Y instanceof W&&b.equals(this.constraints,Y.constraints,(ca,qa)=>ca.equals(qa))}closestTo(Y){let ca=Infinity,qa;for(const sa of this.constraints){const wa=sa.closestTo(Y),Aa=l.squaredDistance(Y,
wa);Aa<ca&&(ca=Aa,qa=wa)}return v.clone(qa??Y)}closestPoints(Y){return this.constraints.flatMap(ca=>ca===this?[]:ca.closestPoints(Y))}}class V extends g{constructor(Y,ca){super();this.center=Y;this.radius=ca}equals(Y){return this===Y||H(Y)&&this.center[0]===Y.center[0]&&this.center[1]===Y.center[1]&&this.radius===Y.radius}closestTo(Y){const ca=v.createWritable();B.projectPointToVerticalCylinder(Y,this.center,this.radius,ca);return ca}}class aa extends g{constructor(Y,ca){super();this.center=Y;this.radius=
ca}equals(Y){return this===Y||h(Y)&&l.exactEquals(this.center,Y.center)&&this.radius===Y.radius}closestTo(Y){const ca=v.createWritable();B.projectPointToVerticalCylinder(Y,this.center,this.radius,ca);ca[2]=this.center[2];return ca}asCircle(){return new fa(v.clone(this.center),this.radius,v.fromValues(0,0,1))}}class fa extends g{constructor(Y,ca,qa,sa){super();this.center=Y;this.radius=ca;this.normal=qa;this.slicePlane=sa}equals(Y){return this===Y||e(Y)&&l.exactEquals(this.center,Y.center)&&l.exactEquals(this.normal,
Y.normal)&&this.radius===Y.radius}closestTo(Y){const {center:ca,radius:qa}=this;t.projectPoint(this.getPlane(da),Y,ja);var sa=l.sub(ja,ja,ca),wa=l.squaredLength(sa);if(B.isClose(wa,0))return v.clone(Y);const Aa=qa/Math.sqrt(wa);wa=v.createWritable();l.scaleAndAdd(wa,ca,sa,Aa);({slicePlane:sa}=this);return sa&&!B.isPointInsidePlane(sa,wa)?xa(sa,this)?.closestTo(Y)??v.clone(Y):wa}getPlane(Y=t.create()){return t.fromPositionAndNormal(this.center,this.normal,Y)}}const ja=k.create(),da=t.create();class Z extends g{constructor(Y){super();
this.z=Y}equals(Y){return this===Y||M(Y)&&this.z===Y.z}closestTo(Y){return v.fromValues(Y[0],Y[1],this.z)}getPlane(Y=t.create()){l.set(ka,0,0,this.z);return t.fromPositionAndNormal(ka,k.UNIT_Z,Y)}}const ka=k.create();class la extends g{constructor(Y,ca,qa){super();this.start=Y;this.end=ca;this.planeLike={start:v.asVec2(Y),end:v.asVec2(ca),type:qa}}equals(Y){return this===Y||y(Y)&&this.planeLike.type===Y.planeLike.type&&l.exactEquals(this.start,Y.start)&&l.exactEquals(this.end,Y.end)}closestTo(Y){const ca=
v.createWritable();B.projectPointToVerticalPlane(Y,this.planeLike,ca);return ca}closestEndTo(Y){const {start:ca,end:qa}=this.planeLike;return 0<Math.sign(m.dot(m.subtract(T,qa,ca),m.subtract(U,v.asVec2(Y),ca)))?this.end:this.start}getPlane(Y=t.create()){const ca=l.copy(ba,this.end);ca[2]+=1;return t.fromPoints(this.start,this.end,ca,Y)}getSlicePlane(Y=t.create()){const {start:ca,end:qa,type:sa}=this.planeLike;if(sa!==B.VerticalPlaneType.PLANE){var wa=l.set(ba,ca[0],ca[1],0),Aa=l.set(ha,qa[0],qa[1],
0);Aa=l.subtract(ha,Aa,wa);t.fromPositionAndNormal(wa,Aa,Y);return Y}}}const T=p.create(),U=p.create(),ba=k.create(),ha=k.create();class ma extends la{constructor(Y,ca){super(Y,ca,B.VerticalPlaneType.HALF_PLANE)}}class Q extends la{constructor(Y,ca){super(Y,ca,B.VerticalPlaneType.PLANE)}}class X extends g{constructor(Y,ca){super();this.sphere=A.fromCenterAndRadius(Y,ca)}equals(Y){return this===Y||c(Y)&&A.exactEquals(this.sphere,Y.sphere)}closestTo(Y){const ca=v.createWritable();A.projectPoint(this.sphere,
Y,ca);return ca}get center(){return A.getCenter(this.sphere)}get radius(){return this.sphere[3]}}class ea extends g{constructor(Y,ca,qa){super();this.start=Y;this.end=ca;this.getZ=qa;this.planeLike={start:v.asVec2(Y),end:v.asVec2(ca),type:B.VerticalPlaneType.PLANE}}equals(Y){return this===Y||Y instanceof ea&&l.exactEquals(this.start,Y.start)&&l.exactEquals(this.end,Y.end)&&this.getZ===Y.getZ}closestTo(Y){const ca=v.createWritable();B.projectPointToVerticalPlane(Y,this.planeLike,ca);ca[2]=this.getZ(ca[0],
ca[1])??0;return ca}addIfOnTheGround(Y,ca){for(const qa of ca)ca=this.getZ(qa[0],qa[1])??0,B.isClose(qa[2],ca)&&(qa[2]=ca,Y.push(qa))}}class ia extends g{constructor(Y,ca,qa){super();this._x=Y;this._y=ca;this._z=qa}equals(Y){return this===Y||Y instanceof ia&&this._x===Y._x&&this._y===Y._y&&this._z===Y._z}closestTo([Y,ca,qa]){return v.create(this._x??Y,this._y??ca,this._z??qa)}}class na extends g{constructor(Y,ca,qa,sa,wa){super();this._origin=Y;this._spatialReference=ca;this._distanceMeters=qa;this._z=
sa;this._directionDegrees=wa}equals(Y){return this===Y||Y instanceof na&&m.exactEquals(this._origin,Y._origin)&&this._spatialReference===Y._spatialReference&&this._distanceMeters===Y._distanceMeters&&this._z===Y._z&&this._directionDegrees===Y._directionDegrees}closestTo([Y,ca,qa]){m.set(ra,Y,ca);m.exactEquals(ra,this._origin)||this._applyDirectionAndDistance(ra);return v.create(ra[0],ra[1],this._z??qa)}_applyDirectionAndDistance(Y){if(null!=this._directionDegrees&&null!=this._distanceMeters)u.directGeodeticSolver(Y,
this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees){var ca=this._origin,qa=this._directionDegrees,sa=this._spatialReference;let {azimuth:wa,distance:Aa}=u.inverseGeodeticSolver(pa,ca,Y,sa);wa??=0;let Ba=Aa*Math.cos((wa-qa)*f.toRadians);Ba=Math.max(0,Ba);u.directGeodeticSolver(Y,ca,qa,Ba,sa)}else null!=this._distanceMeters&&({azimuth:ca}=u.inverseGeodeticSolver(ta,this._origin,Y,this._spatialReference),u.directGeodeticSolver(Y,this._origin,
ca??0,this._distanceMeters,this._spatialReference))}}const ra=[0,0],ta=new u.InverseGeodeticSolverResult,pa=new u.InverseGeodeticSolverResult,oa=(()=>{const Y=t.create();return(ca,qa)=>{const {start:sa,end:wa}=ca;if(B.vectorsHaveCloseZ(sa,wa)&&B.isClose(sa[2],qa.z))return ca;ca=v.createWritable();if(t.intersectLine(qa.getPlane(Y),sa,wa,ca))return new F(ca)}})(),xa=(()=>{const Y=q.create(),ca=k.create(),qa=k.create();return(sa,wa,Aa)=>{const {normal:Ba,center:Ea,radius:Fa}=wa;x.tangentFrame(Ba,ca,
qa);const Ga=t.getNormal(sa);var Da=Fa*l.dot(Ga,ca),Ca=Fa*l.dot(Ga,qa);E.set(Y,Ea[0],Ea[1],Ea[2],1);const Ja=E.dot(sa,Y),Ha=Math.hypot(Da,Ca),Ia=B.isClose(Ha,0);if(B.isClose(t.distance(sa,Ea),0)){if(Ia)return wa;if(B.isClose(Fa,0))return!Aa||B.isPointInsidePlane(Aa,Ea)?new F(v.clone(Ea)):void 0;l.cross(ca,Ga,Ba);l.normalize(ca,ca);Da=[];Ca=k.clone(Ea);l.scaleAndAdd(Ca,Ca,ca,Fa);Aa&&!B.isPointInsidePlane(Aa,Ca)||Da.push(Ca);Ca=k.clone(Ea);l.scaleAndAdd(Ca,Ca,ca,-Fa);Aa&&!B.isPointInsidePlane(Aa,Ca)||
Da.push(Ca);return C(Da)}if(!(Ia||(sa=-Ja/Ha,1<Math.abs(sa)||B.isClose(sa,1))))return Da=Math.atan(Da/Ca),sa=d.asinClamped(sa)-Da,Da=Math.PI-sa,Ca=[],wa=k.create(),l.scaleAndAdd(wa,Ea,ca,Fa*Math.cos(sa)),l.scaleAndAdd(wa,wa,qa,Fa*Math.sin(sa)),Ca.push(wa),sa=k.create(),l.scaleAndAdd(sa,Ea,ca,Fa*Math.cos(Da)),l.scaleAndAdd(sa,sa,qa,Fa*Math.sin(Da)),Ca.push(sa),C(Aa?B.pointsInsidePlane(Aa,Ca):Ca)}})(),ua=(()=>{const Y=t.create();return(ca,qa)=>xa(ca.getPlane(Y),qa,qa.slicePlane)})(),za=(()=>{const Y=
t.create();return(ca,{center:qa,radius:sa})=>{sa=B.intersectVerticalPlaneAndVerticalCylinder(ca.planeLike,qa,sa);qa=qa[2];ca.getSlicePlane(Y);ca=[];for(const [wa,Aa]of sa)sa=[wa,Aa,qa],B.isPointInsidePlane(Y,sa)&&ca.push(sa);return C(ca)}})(),ya=(()=>{const Y=t.create(),ca=t.create();return(qa,sa)=>xa(qa.getPlane(Y),sa,qa.getSlicePlane(ca))})(),va=(()=>{const Y=t.create();return(ca,{center:qa,radius:sa})=>{var wa=ca.getPlane(Y);const Aa=t.signedDistance(wa,qa);var Ba=Math.abs(Aa);if(!(Ba>sa)||B.isClose(Ba,
sa)){sa=Math.sqrt(sa**2-Aa**2);if(B.isClose(sa,0))return ca=v.createWritable(),t.projectPoint(wa,qa,ca),new F(ca);Ba=v.createWritable();wa=k.clone(t.getNormal(wa));l.scaleAndAdd(Ba,qa,wa,Aa);return new fa(Ba,sa,wa,ca.getSlicePlane())}}})();a.CircleConstraint=fa;a.Constraint=g;a.CoordinateConstraint=ia;a.DrapedLineConstraint=ea;a.GeodesicConstraint=na;a.HorizontalCircleConstraint=aa;a.HorizontalPlaneConstraint=Z;a.LineConstraint=O;a.LineLikeConstraint=I;a.PointConstraint=F;a.RayConstraint=R;a.SetConstraint=
W;a.SphereConstraint=X;a.VerticalCylinderConstraint=V;a.VerticalHalfPlaneConstraint=ma;a.VerticalPlaneConstraint=Q;a.VerticalPlaneLikeConstraint=la;a.constraintOrSet=S;a.isPoint=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/plane":function(){define("exports ../../core/mathUtils ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),function(a,b,d,m,p,l,k,E){function q(r=
C){return[r[0],r[1],r[2],r[3]]}function f(r,J){return u(J[0],J[1],J[2],J[3],r)}function u(r,J,M,y,H=q()){H[0]=r;H[1]=J;H[2]=M;H[3]=y;return H}function t(r,J,M){var y=J[0]*J[0]+J[1]*J[1]+J[2]*J[2];y=1E-5<Math.abs(y-1)&&1E-12<y?1/Math.sqrt(y):1;M[0]=J[0]*y;M[1]=J[1]*y;M[2]=J[2]*y;M[3]=-(M[0]*r[0]+M[1]*r[1]+M[2]*r[2]);return M}function A(r,J,M,y=q()){var H=M[0]-J[0],h=M[1]-J[1],e=M[2]-J[2];M=r[0]-J[0];const c=r[1]-J[1],g=r[2]-J[2];J=h*g-e*c;e=e*M-H*g;H=H*c-h*M;h=J*J+e*e+H*H;h=1E-5<Math.abs(h-1)&&1E-12<
h?1/Math.sqrt(h):1;y[0]=J*h;y[1]=e*h;y[2]=H*h;y[3]=-(y[0]*r[0]+y[1]*r[1]+y[2]*r[2]);return y}function x(r,J,M,y=0,H=Math.floor(1/3*M),h=Math.floor(2/3*M)){if(3>M)return!1;J(K,y);let e=H,c=!1;for(;e<M-1&&!c;)J(N,e),e++,c=!d.exactEquals(K,N);if(!c)return!1;e=Math.max(e,h);for(c=!1;e<M&&!c;)J(G,e),e++,d.subtract(P,K,N),d.normalize(P,P),d.subtract(z,N,G),d.normalize(z,z),c=!d.exactEquals(K,G)&&!d.exactEquals(N,G)&&.99619469809>Math.abs(d.dot(P,z));if(!c)return 0===y&&1===H&&2===h?!1:x(r,J,M,0,1,2);A(K,
N,G,r);return!0}function v(r,J,M){r=d.scale(k.sv3d.get(),r,d.dot(r,J));d.subtract(M,J,r);return M}function B(r,J){return d.dot(r,J)+r[3]}function n(r){return r===a.IntersectResult.INTERSECTS_INSIDE_OUT||r===a.IntersectResult.INTERSECTS_OUTSIDE_IN}function w(r,J,M,y,H){var h=d.dot(r,M);r=B(r,J);if(0===h)return 0<=r?a.IntersectResult.INSIDE:a.IntersectResult.OUTSIDE;h=-r/h;y&a.IntersectFlags.CLAMP&&(h=b.clamp(h,0,1));if(!(y&a.IntersectFlags.INFINITE_MIN)&&0>h||!(y&a.IntersectFlags.INFINITE_MAX)&&1<
h)return 0<=r?a.IntersectResult.INSIDE:a.IntersectResult.OUTSIDE;d.add(H,J,d.scale(H,M,h));return 0<=r?a.IntersectResult.INTERSECTS_INSIDE_OUT:a.IntersectResult.INTERSECTS_OUTSIDE_IN}const D=p.exactEquals;p=p.equals;const K=m.create(),N=m.create(),G=m.create(),P=m.create(),z=m.create();a.IntersectResult=void 0;(function(r){r[r.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT";r[r.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN";r[r.INSIDE=2]="INSIDE";r[r.OUTSIDE=3]="OUTSIDE"})(a.IntersectResult||(a.IntersectResult=
{}));const C=[0,0,1,0];a.IntersectFlags=void 0;(function(r){r[r.NONE=0]="NONE";r[r.CLAMP=1]="CLAMP";r[r.INFINITE_MIN=4]="INFINITE_MIN";r[r.INFINITE_MAX=8]="INFINITE_MAX"})(a.IntersectFlags||(a.IntersectFlags={}));const L=a.IntersectFlags.INFINITE_MIN|a.IntersectFlags.INFINITE_MAX,S=a.IntersectFlags.INFINITE_MAX;a.clip=function(r,J){const M=d.dot(r,J.ray.direction);r=-B(r,J.ray.origin);if(0>r&&0<=M)return!1;if(-1E-6<M&&1E-6>M)return 0<r;if((0>r||0>M)&&!(0>r&&0>M))return!0;r/=M;0<M?r<J.c1&&(J.c1=r):
r>J.c0&&(J.c0=r);return J.c0<=J.c1};a.clipInfinite=function(r,J){const M=d.dot(r,J.ray.direction);r=-B(r,J.ray.origin);if(-1E-6<M&&1E-6>M)return 0<r;r/=M;0<M?r<J.c1&&(J.c1=r):r>J.c0&&(J.c0=r);return J.c0<=J.c1};a.copy=f;a.create=q;a.distance=function(r,J){return Math.abs(B(r,J))};a.equals=p;a.exactEquals=D;a.fromArray=function(r,J,M=!0){const y=J.length/3;return x(r,(H,h)=>d.set(H,J[3*h],J[3*h+1],J[3*h+2]),M?y-1:y)};a.fromManyPoints=x;a.fromNormalAndOffset=function(r,J,M){d.copy(M,r);M[3]=J;return M};
a.fromPoints=A;a.fromPositionAndNormal=t;a.fromValues=u;a.fromVectorsAndPoint=function(r,J,M,y){d.cross(G,J,r);return t(M,G,y)};a.getNormal=function(r){return r};a.intersectLine=function(r,J,M,y){M=d.subtract(k.sv3d.get(),M,J);return n(w(r,J,M,L,y))};a.intersectLineOrRay=w;a.intersectLineSegment=function(r,J,M){return n(w(r,J.origin,J.vector,a.IntersectFlags.NONE,M))};a.intersectLineSegmentClamp=function(r,J,M){return n(w(r,J.origin,J.vector,a.IntersectFlags.CLAMP,M))};a.intersectRay=function(r,J,
M){return null!=J?n(w(r,J.origin,J.direction,S,M)):!1};a.isPointInside=function(r,J){return 0<=B(r,J)};a.negate=function(r,J){J[0]=-r[0];J[1]=-r[1];J[2]=-r[2];J[3]=-r[3];return J};a.projectPoint=function(r,J,M){const y=d.scale(k.sv3d.get(),r,-r[3]);J=d.subtract(k.sv3d.get(),J,y);r=v(r,J,k.sv3d.get());d.add(M,r,y);return M};a.projectPointLocal=function(r,J,M,y){var H=k.sv3d.get(),h=k.sv3d.get();E.tangentFrame(r,H,h);J=d.subtract(k.sv3d.get(),M,J);H=l.projectPointSignedLength(H,J);h=l.projectPointSignedLength(h,
J);r=l.projectPointSignedLength(r,J);return d.set(y,H,h,r)};a.projectVector=v;a.setOffsetFromPoint=function(r,J,M){J!==r&&f(r,J);r[3]=-d.dot(r,M);return r};a.signedDistance=B;a.up=C;a.wrap=function(r=C[0],J=C[1],M=C[2],y=C[3]){return u(r,J,M,y,k.sv4d.get())};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/vector":function(){define(["exports","../../core/mathUtils","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64"],function(a,b,d,m){const p=
m.create(),l=m.create();a.angle=function(k,E){k=d.dot(k,E)/(d.length(k)*d.length(E));return-b.acosClamped(k)};a.angleAroundAxis=function(k,E,q){d.normalize(p,k);d.normalize(l,E);k=d.dot(p,l);k=b.acosClamped(k);E=d.cross(p,p,l);return 0>d.dot(E,q)?2*Math.PI-k:k};a.projectPoint=function(k,E,q){E=d.dot(k,E)/d.dot(k,k);return d.scale(q,k,E)};a.projectPointSignedLength=function(k,E){return d.dot(k,E)/d.length(k)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/vectorStacks":function(){define(["exports",
"../../core/VectorStack"],function(a,b){const d=b.VectorStack.createVec2f64(),m=b.VectorStack.createVec3f64(),p=b.VectorStack.createVec4f64(),l=b.VectorStack.createMat3f64(),k=b.VectorStack.createMat4f64();b=b.VectorStack.createQuatf64();a.sm3d=l;a.sm4d=k;a.sq4d=b;a.sv2d=d;a.sv3d=m;a.sv4d=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/VectorStack":function(){define("exports ./has ./nextTick ./libs/gl-matrix-2/factories/mat3f64 ./libs/gl-matrix-2/factories/mat4f64 ./libs/gl-matrix-2/factories/quatf64 ./libs/gl-matrix-2/factories/vec2f64 ./libs/gl-matrix-2/factories/vec3f64 ./libs/gl-matrix-2/factories/vec4f64".split(" "),
function(a,b,d,m,p,l,k,E,q){class f{constructor(u){this._create=u;this._items=[];this._itemsPtr=0}get(){0===this._itemsPtr&&d.nextTick(()=>this._reset());this._itemsPtr>=this._items.length&&this._items.push(this._create());return this._items[this._itemsPtr++]}_reset(){const u=2*this._itemsPtr;this._items.length>u&&(this._items.length=u);this._itemsPtr=0}static createVec2f64(){return new f(k.create)}static createVec3f64(){return new f(E.create)}static createVec4f64(){return new f(q.create)}static createMat3f64(){return new f(m.create)}static createMat4f64(){return new f(p.create)}static createQuatf64(){return new f(l.create)}get test(){}}
a.VectorStack=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/mathUtils":function(){define(["exports","../../../core/mathUtils","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64"],function(a,b,d,m){const p=m.create(),l=m.create(),k=m.create(),E=m.create(),q=m.create();a.angle=function(f,u,t){f=d.normalize(E,f);u=d.normalize(q,u);const A=b.acosClamped(d.dot(f,u));return t&&(f=d.cross(k,f,u),0>d.dot(f,t))?-A:A};a.bilerp=function(f,u,t,
A,x,v){f+=(u-f)*x;return f+(t+(A-t)*x-f)*v};a.cosCapped=function(f,u){return f>u?Math.cos(u):Math.cos(f)};a.fovx2fovy=function(f,u,t){return 2*Math.atan(t*Math.tan(.5*f)/u)};a.fovy2fovx=function(f,u,t){return 2*Math.atan(u*Math.tan(.5*f)/t)};a.makeOrthonormal=function(f,u,t){t=t||f;const A=d.dot(f,u);d.set(t,f[0]-A*u[0],f[1]-A*u[1],f[2]-A*u[2]);d.normalize(t,t)};a.makePiecewiseLinearFunction=function(f){const u=f.length;return t=>{if(t<=f[0][0])return f[0][1];if(t>=f[u-1][0])return f[u-1][1];let A=
1;for(;t>f[A][0];)A++;const x=f[A][0];t=(x-t)/(x-f[A-1][0]);return t*f[A-1][1]+(1-t)*f[A][1]}};a.maxScale=function(f){return Math.sqrt(Math.max(f[0]*f[0]+f[4]*f[4]+f[8]*f[8],f[1]*f[1]+f[5]*f[5]+f[9]*f[9],f[2]*f[2]+f[6]*f[6]+f[10]*f[10]))};a.midpoint3d=function(f,u){d.set(u,0,0,0);if(0<f.length){for(let t=0;t<f.length;++t)d.add(u,u,f[t]);d.scale(u,u,1/f.length)}};a.planeFromPoints=function(f,u,t,A){d.subtract(p,u,f);d.subtract(l,t,f);d.cross(A,p,l);d.normalize(A,A);A[3]=-d.dot(f,A)};a.scaleFromMatrix=
function(f,u){d.set(f,Math.sqrt(u[0]*u[0]+u[4]*u[4]+u[8]*u[8]),Math.sqrt(u[1]*u[1]+u[5]*u[5]+u[9]*u[9]),Math.sqrt(u[2]*u[2]+u[6]*u[6]+u[10]*u[10]));return f};a.slerp=function(f,u,t,A=m.create()){const x=d.length(f);var v=d.length(u),B=d.dot(f,u)/(x*v);if(.9999999999999999>B){B=Math.acos(B);const n=((1-t)*x+t*v)/Math.sin(B);v=n/v*Math.sin(t*B);d.scale(E,f,n/x*Math.sin((1-t)*B));d.scale(q,u,v);return d.add(A,E,q)}return d.lerp(A,f,u,t)};a.slerpTangent=function(f,u,t,A=m.create(),x=m.create()){const v=
d.length(f),B=d.length(u);var n=d.dot(f,u)/(v*B);if(.9999999999999999>n){n=Math.acos(n);const w=Math.sin(n),D=Math.sin(t*n),K=Math.sin((1-t)*n),N=(1-t)*v+t*B,G=N/w,P=G/B*D;d.scale(E,f,G/v*K);d.scale(q,u,P);d.add(A,E,q);d.scale(E,f,1/v*(-Math.cos((1-t)*n)*n*N+K*(-v+B)));d.scale(q,u,1/B*(Math.cos(t*n)*n*N+D*(-v+B)));d.add(x,E,q);d.scale(x,x,1/w);return x}d.lerp(A,f,u,t);d.subtract(x,u,f);d.normalize(x,x);return x};a.tangentFrame=function(f,u,t){Math.abs(f[0])>Math.abs(f[1])?d.set(u,0,1,0):d.set(u,1,
0,0);d.cross(t,f,u);d.cross(u,t,f);d.normalize(t,t);d.normalize(u,u)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/sphere":function(){define("exports ../core/has ../core/Logger ../core/mathUtils ../core/libs/gl-matrix-2/math/mat4 ./vec32 ../core/libs/gl-matrix-2/factories/vec3f64 ./vec42 ../core/libs/gl-matrix-2/factories/vec4f64 ../core/libs/gl-matrix-2/math/common ../geometry/support/Axis ../geometry/support/ray ../geometry/support/sphereUtils ../geometry/support/vector ../geometry/support/vectorStacks".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v){function B(){return q.create()}function n(U,ba){return E.copy(ba,U)}function w(U,ba){return q.fromValues(U[0],U[1],U[2],ba)}function D(U){return U}function K(U){U[0]=U[1]=U[2]=U[3]=0}function N(U,ba){U[0]=U[1]=U[2]=0;U[3]=ba;return U}function G(U){return U[3]}function P(U){return U}function z(U,ba,ha,ma){return q.fromValues(U,ba,ha,ma)}function C(U,ba,ha){U!==ha&&(ha[0]=U[0],ha[1]=U[1],ha[2]=U[2]);ha[3]=U[3]+ba;return ha}function L(U,ba,ha){U!==ha&&n(U,ha);
return ha}function S(U,ba){return ba}function r(U,ba,ha){if(null==ba||!M(U,ba,ja))return!1;let {t0:ma,t1:Q}=ja;if(0>ma||Q<ma&&0<Q)ma=Q;if(0>ma)return!1;if(ha){const {origin:X,direction:ea}=ba;ha[0]=X[0]+ea[0]*ma;ha[1]=X[1]+ea[1]*ma;ha[2]=X[2]+ea[2]*ma}return!0}function J(U,ba,ha){ba=t.fromPoints(ba,ha);if(!M(U,ba,ja))return[];const {origin:ma,direction:Q}=ba,{t0:X,t1:ea}=ja;ba=ia=>{const na=k.create();l.scaleAndAdd(na,ma,Q,ia);return g(U,na,na)};return Math.abs(X-ea)<f.getEpsilon()?[ba(X)]:[ba(X),
ba(ea)]}function M(U,ba,ha){const {origin:ma,direction:Q}=ba,X=da;X[0]=ma[0]-U[0];X[1]=ma[1]-U[1];X[2]=ma[2]-U[2];ba=Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2];if(0===ba)return!1;const ea=2*(Q[0]*X[0]+Q[1]*X[1]+Q[2]*X[2]);U=ea*ea-4*ba*(X[0]*X[0]+X[1]*X[1]+X[2]*X[2]-U[3]*U[3]);if(0>U)return!1;U=Math.sqrt(U);ha.t0=(-ea-U)/(2*ba);ha.t1=(-ea+U)/(2*ba);return!0}function y(U,ba){return r(U,ba,null)}function H(U,ba,ha){if(r(U,ba,ha))return ha;U=h(U,ba,v.sv3d.get());l.add(ha,ba.origin,l.scale(v.sv3d.get(),ba.direction,
l.distance(ba.origin,U)/l.length(ba.direction)));return ha}function h(U,ba,ha){const ma=v.sv3d.get(),Q=v.sm4d.get();l.cross(ma,ba.origin,ba.direction);const X=U[3];l.cross(ha,ma,ba.origin);l.scale(ha,ha,1/l.length(ha)*X);U=I(U,ba.origin);ba=x.angle(ba.origin,ha);p.fromRotation(Q,ba+U,ma);l.transformMat4(ha,ha,Q);return ha}function e(U,ba,ha,ma){U=U[3];var Q=U*U;ba+=.5*Math.PI;const X=ha*ha+Q-2*Math.cos(ba)*ha*U;ha=Math.sqrt(X);Q=X-Q;return 0>=Q?.5:Math.min(1,(Math.acos(Math.sqrt(Q)/ha)-Math.asin(U/
(ha/Math.sin(ba)))+.5*ma)/ma)}function c(U,ba,ha){if(r(U,ba,ha))return ha;t.closestPoint(ba,U,ha);return g(U,ha,ha)}function g(U,ba,ha){ba=l.subtract(v.sv3d.get(),ba,U);ba=l.scale(v.sv3d.get(),ba,U[3]/l.length(ba));return l.add(ha,ba,U)}function F(U,ba){ba=l.subtract(v.sv3d.get(),ba,U);ba=l.squaredLength(ba);return Math.sqrt(Math.abs(ba-U[3]*U[3]))}function I(U,ba){ba=l.subtract(v.sv3d.get(),ba,U);ba=l.length(ba);U=U[3];return m.acosClamped(U/(U+Math.abs(U-ba)))}function O(U,ba,ha,ma){U=l.subtract(Z,
ba,U);switch(ha){case u.Axis.X:return ha=A.cartesianToSpherical(U,Z)[2],l.set(ma,-Math.sin(ha),Math.cos(ha),0);case u.Axis.Y:return U=A.cartesianToSpherical(U,Z),ha=U[1],U=U[2],ba=Math.sin(ha),l.set(ma,-ba*Math.cos(U),-ba*Math.sin(U),Math.cos(ha));case u.Axis.Z:return l.normalize(ma,U)}}function R(U,ba){ba=l.subtract(ka,ba,U);return l.length(ba)-U[3]}function W(U,ba,ha,ma){const Q=R(U,ba);U=O(U,ba,u.Axis.Z,ka);ha=l.scale(ka,U,ha-Q);return l.add(ma,ba,ha)}function V(U,ba){ba=l.squaredDistance(U,ba);
U=U[3];return ba<=U*U}function aa(U,ba,ha=q.create()){const ma=l.distance(U,ba),Q=U[3],X=ba[3];if(ma+X<Q)return E.copy(ha,U),ha;if(ma+Q<X)return E.copy(ha,ba),ha;l.lerp(ha,U,ba,(ma+X-Q)/(2*ma));ha[3]=(ma+Q+X)/2;return ha}b=B();const fa=d=E.equals,ja={t0:0,t1:0},da=k.create(),Z=k.create(),ka=k.create(),la=B(),T=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:b,altitudeAt:R,angleToSilhouette:I,axisAt:O,cameraFrustumCoverage:e,clear:K,closestPoint:c,closestPointOnSilhouette:h,containsPoint:V,
copy:n,create:B,distanceToSilhouette:F,elevate:C,equals:fa,exactEquals:d,fromCenterAndRadius:w,fromRadius:N,fromValues:z,getCenter:P,getExtent:S,getRadius:G,intersectLine:J,intersectRay:r,intersectRayClosestSilhouette:H,intersectsRay:y,projectPoint:g,setAltitudeAt:W,setExtent:L,tmpSphere:la,union:aa,wrap:D},Symbol.toStringTag,{value:"Module"}));a.NullSphere=b;a.altitudeAt=R;a.angleToSilhouette=I;a.axisAt=O;a.cameraFrustumCoverage=e;a.clear=K;a.closestPoint=c;a.closestPointOnSilhouette=h;a.containsPoint=
V;a.copy=n;a.create=B;a.distanceToSilhouette=F;a.elevate=C;a.equals=fa;a.exactEquals=d;a.fromCenterAndRadius=w;a.fromRadius=N;a.fromValues=z;a.getCenter=P;a.getExtent=S;a.getRadius=G;a.intersectLine=J;a.intersectRay=r;a.intersectRayClosestSilhouette=H;a.intersectsRay=y;a.projectPoint=g;a.setAltitudeAt=W;a.setExtent=L;a.sphere=T;a.tmpSphere=la;a.union=aa;a.wrap=D})},"esri/geometry/support/ray":function(){define("exports ../../core/arrayUtils ../../core/ObjectStack ../../core/libs/gl-matrix-2/math/mat3 ../../core/libs/gl-matrix-2/factories/mat3f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ./vectorStacks".split(" "),
function(a,b,d,m,p,l,k,E){function q(n){return n?f(k.clone(n.origin),k.clone(n.direction)):f(k.create(),k.create())}function f(n,w){return{origin:n,direction:w}}function u(n,w,D=q()){l.copy(D.origin,n);l.copy(D.direction,w);return D}const t=new d.ObjectStack(()=>q()),A=k.create(),x=k.create(),v=k.create(),B=p.create();a.closestPoint=function(n,w,D){w=l.dot(n.direction,l.subtract(D,w,n.origin));l.add(D,n.origin,l.scale(D,n.direction,w));return D};a.closestPoints=function(n,w,D,K){const N=n.origin,
G=w.origin;n=n.direction;w=w.direction;var P=l.dot(l.normalize(x,n),l.normalize(v,w));if(1<=Math.abs(P))return null;var z=l.cross(x,n,w);P=l.sub(A,G,N);z=m.set(B,n[0],n[1],n[2],-w[0],-w[1],-w[2],z[0],z[1],z[2]);const C=m.invert(B,z);if(null==C)return[D,K];z=l.dot(l.set(x,C[0],C[3],C[6]),P);P=l.dot(l.set(v,C[1],C[4],C[7]),P);l.add(D,N,l.scale(A,n,z));l.add(K,G,l.scale(A,w,P));return[D,K]};a.copy=function(n,w=q()){return u(n.origin,n.direction,w)};a.create=q;a.distance2=function(n,w){n=l.cross(E.sv3d.get(),
l.normalize(E.sv3d.get(),n.direction),l.subtract(E.sv3d.get(),w,n.origin));return l.dot(n,n)};a.equals=function(n,w){return b.equals(n.origin,w.origin)&&b.equals(n.direction,w.direction)};a.fromPoints=function(n,w,D=q()){l.copy(D.origin,n);l.subtract(D.direction,w,n);return D};a.fromValues=u;a.wrap=function(n,w){const D=t.get();D.origin=n;D.direction=w;return D};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ObjectStack":function(){define(["exports","./nextTick"],function(a,
b){class d{constructor(m){this._allocator=m;this._items=[];this._itemsPtr=0;this._grow()}get(){0===this._itemsPtr&&b.nextTick(()=>this._reset());this._itemsPtr===this._items.length&&this._grow();return this._items[this._itemsPtr++]}_reset(){this._items.length=Math.min(Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3072),this._items.length);this._itemsPtr=0}_grow(){for(let m=0;m<Math.max(8,Math.min(this._items.length,1024));m++)this._items.push(this._allocator())}}a.ObjectStack=d;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["exports","./common"],function(a,b){function d(e,c){e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=c[4];e[4]=c[5];e[5]=c[6];e[6]=c[8];e[7]=c[9];e[8]=c[10];return e}function m(e,c){e[0]=c[0];e[1]=c[1];e[2]=c[2];e[3]=c[3];e[4]=c[4];e[5]=c[5];e[6]=c[6];e[7]=c[7];e[8]=c[8];return e}function p(e,c,g,F,I,O,R,W,V,aa){e[0]=c;e[1]=g;e[2]=F;e[3]=I;e[4]=O;e[5]=R;e[6]=W;e[7]=V;e[8]=aa;return e}function l(e){e[0]=1;e[1]=0;e[2]=
0;e[3]=0;e[4]=1;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function k(e,c){if(e===c){const g=c[1],F=c[2],I=c[5];e[1]=c[3];e[2]=c[6];e[3]=g;e[5]=c[7];e[6]=F;e[7]=I}else e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8];return e}function E(e,c){const g=c[0],F=c[1],I=c[2],O=c[3],R=c[4],W=c[5],V=c[6],aa=c[7];c=c[8];const fa=c*R-W*aa,ja=-c*O+W*V,da=aa*O-R*V;let Z=g*fa+F*ja+I*da;if(!Z)return null;Z=1/Z;e[0]=fa*Z;e[1]=(-c*F+I*aa)*Z;e[2]=(W*F-I*R)*Z;e[3]=ja*Z;e[4]=(c*g-I*
V)*Z;e[5]=(-W*g+I*O)*Z;e[6]=da*Z;e[7]=(-aa*g+F*V)*Z;e[8]=(R*g-F*O)*Z;return e}function q(e,c){const g=c[0],F=c[1],I=c[2],O=c[3],R=c[4],W=c[5],V=c[6],aa=c[7];c=c[8];e[0]=R*c-W*aa;e[1]=I*aa-F*c;e[2]=F*W-I*R;e[3]=W*V-O*c;e[4]=g*c-I*V;e[5]=I*O-g*W;e[6]=O*aa-R*V;e[7]=F*V-g*aa;e[8]=g*R-F*O;return e}function f(e){const c=e[3],g=e[4],F=e[5],I=e[6],O=e[7],R=e[8];return e[0]*(R*g-F*O)+e[1]*(-R*c+F*I)+e[2]*(O*c-g*I)}function u(e,c,g){const F=c[0],I=c[1],O=c[2],R=c[3],W=c[4],V=c[5],aa=c[6],fa=c[7];c=c[8];const ja=
g[0],da=g[1],Z=g[2],ka=g[3],la=g[4],T=g[5],U=g[6],ba=g[7];g=g[8];e[0]=ja*F+da*R+Z*aa;e[1]=ja*I+da*W+Z*fa;e[2]=ja*O+da*V+Z*c;e[3]=ka*F+la*R+T*aa;e[4]=ka*I+la*W+T*fa;e[5]=ka*O+la*V+T*c;e[6]=U*F+ba*R+g*aa;e[7]=U*I+ba*W+g*fa;e[8]=U*O+ba*V+g*c;return e}function t(e,c,g){const F=c[0],I=c[1],O=c[2],R=c[3],W=c[4],V=c[5],aa=c[6],fa=c[7];c=c[8];const ja=g[0];g=g[1];e[0]=F;e[1]=I;e[2]=O;e[3]=R;e[4]=W;e[5]=V;e[6]=ja*F+g*R+aa;e[7]=ja*I+g*W+fa;e[8]=ja*O+g*V+c;return e}function A(e,c,g){const F=c[0],I=c[1],O=c[2],
R=c[3],W=c[4],V=c[5],aa=c[6],fa=c[7];c=c[8];const ja=Math.sin(g);g=Math.cos(g);e[0]=g*F+ja*R;e[1]=g*I+ja*W;e[2]=g*O+ja*V;e[3]=g*R-ja*F;e[4]=g*W-ja*I;e[5]=g*V-ja*O;e[6]=aa;e[7]=fa;e[8]=c;return e}function x(e,c,g){const F=g[0],I=g[1];g=g[2];e[0]=F*c[0];e[1]=F*c[1];e[2]=F*c[2];e[3]=I*c[3];e[4]=I*c[4];e[5]=I*c[5];e[6]=g*c[6];e[7]=g*c[7];e[8]=g*c[8];return e}function v(e,c,g){const F=g[0];g=g[1];e[0]=F*c[0];e[1]=F*c[1];e[2]=F*c[2];e[3]=g*c[3];e[4]=g*c[4];e[5]=g*c[5];return e}function B(e,c){e[0]=1;e[1]=
0;e[2]=0;e[3]=0;e[4]=1;e[5]=0;e[6]=c[0];e[7]=c[1];e[8]=1;return e}function n(e,c){const g=Math.sin(c);c=Math.cos(c);e[0]=c;e[1]=g;e[2]=0;e[3]=-g;e[4]=c;e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function w(e,c){e[0]=c[0];e[1]=0;e[2]=0;e[3]=0;e[4]=c[1];e[5]=0;e[6]=0;e[7]=0;e[8]=1;return e}function D(e,c){e[0]=c[0];e[1]=c[1];e[2]=0;e[3]=c[2];e[4]=c[3];e[5]=0;e[6]=c[4];e[7]=c[5];e[8]=1;return e}function K(e,c){var g=c[0],F=c[1],I=c[2];c=c[3];var O=g+g,R=F+F;const W=I+I;g*=O;const V=F*O;F*=R;const aa=I*O,fa=
I*R;I*=W;O*=c;R*=c;c*=W;e[0]=1-F-I;e[3]=V-c;e[6]=aa+R;e[1]=V+c;e[4]=1-g-I;e[7]=fa-O;e[2]=aa-R;e[5]=fa+O;e[8]=1-g-F;return e}function N(e,c){const g=c[0],F=c[1],I=c[2],O=c[4],R=c[5],W=c[6],V=c[8],aa=c[9];c=c[10];const fa=c*R-W*aa,ja=-c*O+W*V,da=aa*O-R*V;var Z=g*fa+F*ja+I*da;if(!Z)return null;Z=1/Z;e[0]=fa*Z;e[1]=(-c*F+I*aa)*Z;e[2]=(W*F-I*R)*Z;e[3]=ja*Z;e[4]=(c*g-I*V)*Z;e[5]=(-W*g+I*O)*Z;e[6]=da*Z;e[7]=(-aa*g+F*V)*Z;e[8]=(R*g-F*O)*Z;return e}function G(e,c){const g=c[0],F=c[1],I=c[2],O=c[3],R=c[4],
W=c[5],V=c[6],aa=c[7];var fa=c[8],ja=c[9],da=c[10],Z=c[11];const ka=c[12],la=c[13],T=c[14];c=c[15];const U=g*W-F*R,ba=g*V-I*R,ha=g*aa-O*R,ma=F*V-I*W,Q=F*aa-O*W,X=I*aa-O*V,ea=fa*la-ja*ka,ia=fa*T-da*ka;fa=fa*c-Z*ka;const na=ja*T-da*la;ja=ja*c-Z*la;da=da*c-Z*T;Z=U*da-ba*ja+ha*na+ma*fa-Q*ia+X*ea;if(!Z)return null;Z=1/Z;e[0]=(W*da-V*ja+aa*na)*Z;e[1]=(V*fa-R*da-aa*ia)*Z;e[2]=(R*ja-W*fa+aa*ea)*Z;e[3]=(I*ja-F*da-O*na)*Z;e[4]=(g*da-I*fa+O*ia)*Z;e[5]=(F*fa-g*ja-O*ea)*Z;e[6]=(la*X-T*Q+c*ma)*Z;e[7]=(T*ha-ka*
X-c*ba)*Z;e[8]=(ka*Q-la*ha+c*U)*Z;return e}function P(e,c,g){e[0]=2/c;e[1]=0;e[2]=0;e[3]=0;e[4]=-2/g;e[5]=0;e[6]=-1;e[7]=1;e[8]=1;return e}function z(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function C(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function L(e,c,g){e[0]=c[0]+g[0];e[1]=c[1]+g[1];e[2]=c[2]+g[2];e[3]=c[3]+g[3];e[4]=c[4]+g[4];e[5]=c[5]+g[5];e[6]=c[6]+g[6];e[7]=c[7]+g[7];e[8]=
c[8]+g[8];return e}function S(e,c,g){e[0]=c[0]-g[0];e[1]=c[1]-g[1];e[2]=c[2]-g[2];e[3]=c[3]-g[3];e[4]=c[4]-g[4];e[5]=c[5]-g[5];e[6]=c[6]-g[6];e[7]=c[7]-g[7];e[8]=c[8]-g[8];return e}function r(e,c,g){e[0]=c[0]*g;e[1]=c[1]*g;e[2]=c[2]*g;e[3]=c[3]*g;e[4]=c[4]*g;e[5]=c[5]*g;e[6]=c[6]*g;e[7]=c[7]*g;e[8]=c[8]*g;return e}function J(e,c,g,F){e[0]=c[0]+g[0]*F;e[1]=c[1]+g[1]*F;e[2]=c[2]+g[2]*F;e[3]=c[3]+g[3]*F;e[4]=c[4]+g[4]*F;e[5]=c[5]+g[5]*F;e[6]=c[6]+g[6]*F;e[7]=c[7]+g[7]*F;e[8]=c[8]+g[8]*F;return e}function M(e,
c){return e[0]===c[0]&&e[1]===c[1]&&e[2]===c[2]&&e[3]===c[3]&&e[4]===c[4]&&e[5]===c[5]&&e[6]===c[6]&&e[7]===c[7]&&e[8]===c[8]}function y(e,c){const g=e[0],F=e[1],I=e[2],O=e[3],R=e[4],W=e[5],V=e[6],aa=e[7];e=e[8];const fa=c[0],ja=c[1],da=c[2],Z=c[3],ka=c[4],la=c[5],T=c[6],U=c[7];c=c[8];const ba=b.getEpsilon();return Math.abs(g-fa)<=ba*Math.max(1,Math.abs(g),Math.abs(fa))&&Math.abs(F-ja)<=ba*Math.max(1,Math.abs(F),Math.abs(ja))&&Math.abs(I-da)<=ba*Math.max(1,Math.abs(I),Math.abs(da))&&Math.abs(O-Z)<=
ba*Math.max(1,Math.abs(O),Math.abs(Z))&&Math.abs(R-ka)<=ba*Math.max(1,Math.abs(R),Math.abs(ka))&&Math.abs(W-la)<=ba*Math.max(1,Math.abs(W),Math.abs(la))&&Math.abs(V-T)<=ba*Math.max(1,Math.abs(V),Math.abs(T))&&Math.abs(aa-U)<=ba*Math.max(1,Math.abs(aa),Math.abs(U))&&Math.abs(e-c)<=ba*Math.max(1,Math.abs(e),Math.abs(c))}function H(e){const c=b.getEpsilon(),g=e[0],F=e[1],I=e[2],O=e[3],R=e[4],W=e[5],V=e[6],aa=e[7];e=e[8];return Math.abs(1-(g*g+O*O+V*V))<=c&&Math.abs(1-(F*F+R*R+aa*aa))<=c&&Math.abs(1-
(I*I+W*W+e*e))<=c}const h=Object.freeze(Object.defineProperty({__proto__:null,add:L,adjoint:q,copy:m,determinant:f,equals:y,exactEquals:M,frob:C,fromMat2d:D,fromMat4:d,fromQuat:K,fromRotation:n,fromScaling:w,fromTranslation:B,identity:l,invert:E,isOrthoNormal:H,mul:u,multiply:u,multiplyScalar:r,multiplyScalarAndAdd:J,normalFromMat4:G,normalFromMat4Legacy:N,projection:P,rotate:A,scale:x,scaleByVec2:v,set:p,str:z,sub:S,subtract:S,translate:t,transpose:k},Symbol.toStringTag,{value:"Module"}));a.add=
L;a.adjoint=q;a.copy=m;a.determinant=f;a.equals=y;a.exactEquals=M;a.frob=C;a.fromMat2d=D;a.fromMat4=d;a.fromQuat=K;a.fromRotation=n;a.fromScaling=w;a.fromTranslation=B;a.identity=l;a.invert=E;a.isOrthoNormal=H;a.mat3=h;a.mul=u;a.multiply=u;a.multiplyScalar=r;a.multiplyScalarAndAdd=J;a.normalFromMat4=G;a.normalFromMat4Legacy=N;a.projection=P;a.rotate=A;a.scale=x;a.scaleByVec2=v;a.set=p;a.str=z;a.sub=S;a.subtract=S;a.translate=t;a.transpose=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/geometry/support/sphereUtils":function(){define(["exports","../../core/mathUtils","../../chunks/vec32"],function(a,b,d){a.cartesianToSpherical=function(m,p){const l=d.length(m),k=b.asinClamped(m[2]/l);d.set(p,l,k,Math.atan2(m[1]/l,m[0]/l));return p};a.sphericalToCartesian=function(m,p){const l=m[0],k=m[1];m=m[2];const E=Math.cos(k);d.set(p,l*E*Math.cos(m),l*E*Math.sin(m),l*Math.sin(k))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../core/libs/gl-matrix-2/math/common ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f){function u(H,{start:h,end:e,type:c},g=l.create()){H=p.sub(G,H,h);e=p.sub(P,e,h);H=p.dot(H,e)/p.dot(e,e);return p.scaleAndAdd(g,h,e,c===f.LineType.RAY?Math.max(H,0):H)}function t({start:H,end:h,type:e},c){const g=p.sub(G,c,H);h=p.sub(P,h,H);if(e===f.LineType.RAY&&p.dot(h,g)<-k.getEpsilon())return p.distance(H,c);H=p.cross(z,h,g);return p.len(H)/p.len(h)}function A(H,h){const e=H.start,c=h.start;var g=h.end;const F=p.sub(G,H.end,e);g=p.sub(P,g,c);var I=p.sub(z,c,e),O=p.cross(C,
F,g),R=p.dot(I,O);if(!B(R,0))return[];R=p.sqrLen(O);if(B(R,0))return[];I=p.cross(L,I,g);O=p.dot(I,O)/R;O=p.scaleAndAdd(S,e,F,O);return H.type===f.LineType.RAY&&(H=p.sub(r,O,e),p.dot(F,H)<-k.getEpsilon())||h.type===f.LineType.RAY&&(h=p.sub(r,O,c),p.dot(g,h)<-k.getEpsilon())?[]:[l.clone(O)]}function x({start:H,end:h,type:e},c){const g=p.sub(G,c,H);H=p.sub(P,h,H);h=p.cross(z,H,g);h=p.sqrLen(h)/p.sqrLen(H);const F=k.getEpsilon();if(h<F)switch(e){case f.LineType.LINE:return[l.clone(c)];case f.LineType.RAY:return p.dot(H,
g)<-F?[]:[l.clone(c)]}return[]}function v(H,h,{start:e,end:c,type:g}){p.set(H.start,e[0],e[1],h);p.set(H.end,c[0],c[1],h);H.type=D[g];return H}function B(H,h){return b.floatEqualAbsolute(Math.abs(H-h),0,k.getEpsilon())}function n(H,h){return E.isPointInside(H,h)}const w=(()=>{const H=l.create(),h=l.create(),e=l.create();return({start:c,end:g},{center:F,radius:I,normal:O,slicePlane:R})=>{var W=E.fromPositionAndNormal(F,O,J);if(B(E.distance(W,c),0)&&B(E.distance(W,g),0)){q.tangentFrame(O,H,h);W=(V,
aa)=>{p.subtract(e,aa,F);d.set(V,p.dot(e,H),p.dot(e,h));return V};g=f.intersectLineLikeAndCircle({start:W(K,c),end:W(N,g),type:f.LineType.LINE},m.ZEROS,I);c=[];for(const [V,aa]of g)g=p.copy(l.create(),F),p.scaleAndAdd(g,g,H,V),p.scaleAndAdd(g,g,h,aa),R&&!n(R,g)||c.push(g);return c}O=l.create();return E.intersectLine(W,c,g,O)?!B(p.distance(O,F),I)||R&&!n(R,O)?[]:[O]:[]}})();a.VerticalPlaneType=void 0;(function(H){H[H.PLANE=0]="PLANE";H[H.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType=
{}));const D={[a.VerticalPlaneType.PLANE]:f.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:f.LineType.RAY},K=m.create(),N=m.create(),G=l.create(),P=l.create(),z=l.create(),C=l.create(),L=l.create(),S=l.create(),r=l.create(),J=E.create(),M={start:l.create(),end:l.create(),type:f.LineType.LINE},y={start:l.create(),end:l.create(),type:f.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>f.LineType});a.intersectLineAndPoint=x;a.intersectLineLikeAndCircle=w;a.intersectLineLikeAndVerticalCylinder=
function({start:H,end:h,type:e},c,g){const F=[];h=p.subtract(G,h,H);var I=d.subtract(N,H,c);c=d.squaredLength(h);const O=2*d.dot(h,I);g=d.squaredLength(I)-g*g;g=O*O-4*c*g;0===g?(c=-O/(2*c),(e===f.LineType.LINE||0<=c)&&F.push(p.scaleAndAdd(l.create(),H,h,c))):0<g&&(g=Math.sqrt(g),I=(-O+g)/(2*c),(e===f.LineType.LINE||0<=I)&&F.push(p.scaleAndAdd(l.create(),H,h,I)),c=(-O-g)/(2*c),(e===f.LineType.LINE||0<=c)&&F.push(p.scaleAndAdd(l.create(),H,h,c)));return F};a.intersectLineLikes=A;a.intersectVerticalCylinderAndPoint=
function(H,h,e){return B(d.squaredDistance(e,H),h*h)?[l.clone(e)]:[]};a.intersectVerticalCylinders=function(H,h,e,c){const [g,F]=H,[I,O]=e;var R=I-g,W=O-F;const V=R*R+W*W,aa=Math.sqrt(V);if(aa>h+c||aa<Math.abs(h-c)||B(aa,0)&&B(h,c))return[];c=(h*h-c*c+V)/(2*aa);h=Math.sqrt(h*h-c*c);W=h*W/aa;R=h*R/aa;const [fa,ja]=d.lerp(K,H,e,c/aa);return B(W,R)?[m.fromValues(fa,ja)]:[m.fromValues(fa+W,ja-R),m.fromValues(fa-W,ja+R)]};a.intersectVerticalPlaneAndLineLike=function(H,h){const e=H.start,c=d.subtract(K,
H.end,e);var g=p.set(P,-c[1],c[0],0);const F=h.start,I=p.sub(z,h.end,F);var O=p.dot(I,g),R=p.set(C,e[0],e[1],0);R=p.sub(L,R,F);R=p.dot(R,g);g=k.getEpsilon();if(Math.abs(O)<g)return[];O=p.scaleAndAdd(S,F,I,R/O);return h.type===f.LineType.RAY&&(h=p.sub(r,O,F),p.dot(h,I)<-g)||H.type===a.VerticalPlaneType.HALF_PLANE&&(H=d.sub(N,O,e),d.dot(H,c)<-g)?[]:[l.clone(O)]};a.intersectVerticalPlaneAndPoint=function(H,h){return x(v(M,h[2],H),h)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:H,end:h,
type:e},c,g){const F=[];h=d.subtract(K,h,H);var I=d.subtract(N,H,c);c=d.squaredLength(h);const O=2*d.dot(h,I);g=d.squaredLength(I)-g*g;g=O*O-4*c*g;0===g?(c=-O/(2*c),(e===a.VerticalPlaneType.PLANE||0<=c)&&F.push(d.scaleAndAdd(m.create(),H,h,c))):0<g&&(g=Math.sqrt(g),I=(-O+g)/(2*c),(e===a.VerticalPlaneType.PLANE||0<=I)&&F.push(d.scaleAndAdd(m.create(),H,h,I)),c=(-O-g)/(2*c),(e===a.VerticalPlaneType.PLANE||0<=c)&&F.push(d.scaleAndAdd(m.create(),H,h,c)));return F};a.intersectVerticalPlanes=function(H,
h){H=v(M,0,H);h=v(y,0,h);return A(H,h).map(([e,c])=>m.fromValues(e,c))};a.isClose=B;a.isPointInsidePlane=n;a.pointToLineLikeDistance=t;a.pointToVerticalCylinderDistance=function(H,h,e){return d.distance(H,h)-e};a.pointToVerticalPlaneDistance=function(H,h){return t(v(M,H[2],h),H)};a.pointsInsidePlane=function(H,h){return h.filter(e=>n(H,e))};a.projectPointToLineLike=u;a.projectPointToVerticalCylinder=function(H,h,e,c=l.create()){const g=d.subtract(K,H,h),F=d.length(g);d.scaleAndAdd(c,h,g,0===F?1:e/
F);c[2]=H[2];return c};a.projectPointToVerticalPlane=function(H,h,e){return u(H,v(M,H[2],h),e)};a.vectorsHaveCloseZ=function(H,h){return B(H[2],h[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64"],function(a,b,d,m){function p(A,x){return A[0]*x[1]-A[1]*x[0]}function l(A,x,v){x=d.dot(v,x)/d.squaredLength(v);
return d.scale(A,v,x)}function k(A,x,v,B,n=v){d.subtract(q,B,v);d.subtract(u,x,n);l(t,u,q);return d.add(A,n,t)}function E(A,x,v,B){d.subtract(q,x,v);x=B/d.length(q);return d.scaleAndAdd(A,v,q,x)}a.LineType=void 0;(function(A){A[A.RAY=0]="RAY";A[A.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const q=m.create(),f=m.create(),u=m.create(),t=m.create();a.cross=p;a.intersectCircleAndPoint=function(A,x,v){E(u,v,A,x);return b.floatEqualAbsolute(u[0],v[0])&&b.floatEqualAbsolute(u[1],v[1])?[m.clone(v)]:[]};
a.intersectLineAndPoint=function(A,x){k(u,x,A.start,A.end);return b.floatEqualAbsolute(u[0],x[0])&&b.floatEqualAbsolute(u[1],x[1])?[m.clone(x)]:[]};a.intersectLineAndRay=function(A,x){const v=A.start;var B=x.start,n=x.end;const w=d.subtract(q,A.end,v);var D=d.subtract(f,n,B);n=p(w,D);if(1E-6>=Math.abs(n))return[];B=d.subtract(u,v,B);D=p(D,B)/n;n=p(w,B)/n;if(0<=D){if(0<=n||x.type===a.LineType.LINE)return[d.scaleAndAdd(t,v,w,D)]}else if(A.type===a.LineType.LINE&&(0<=n||x.type===a.LineType.LINE))return[d.scaleAndAdd(t,
v,w,D)];return[]};a.intersectLineLikeAndCircle=function(A,x,v){const B=[],n=d.subtract(q,A.end,A.start);var w=d.subtract(f,A.start,x);x=d.squaredLength(n);const D=2*d.dot(n,w);v=d.squaredLength(w)-v*v;v=D*D-4*x*v;0===v?(x=-D/(2*x),(A.type===a.LineType.LINE||0<=x)&&B.push(d.scaleAndAdd(t,A.start,n,x))):0<v&&(v=Math.sqrt(v),w=(-D+v)/(2*x),(A.type===a.LineType.LINE||0<=w)&&B.push(d.scaleAndAdd(t,A.start,n,w)),x=(-D-v)/(2*x),(A.type===a.LineType.LINE||0<=x)&&B.push(d.scaleAndAdd(u,A.start,n,x)));return B};
a.pointToLineDistance=function(A,x,v){return Math.abs((x[0]-A[0])*(v[1]-A[1])-(x[1]-A[1])*(v[0]-A[0]))/d.distance(x,v)};a.projectPoint=l;a.projectPointToCircle=E;a.projectPointToLine=k;a.projectPointToRay=function(A,x,v,B){d.subtract(q,B,v);d.subtract(u,x,v);x=d.dot(q,u)/d.squaredLength(q);return 0<x?d.scaleAndAdd(A,v,q,x):d.copy(A,v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/FeatureSnappingCandidate":function(){define(["exports",
"../SnappingDomain","./SnappingCandidate"],function(a,b,d){class m extends d.SnappingCandidate{constructor({targetPoint:p,objectId:l,constraint:k,isDraped:E}){super(p,k,E,b.SnappingDomain.FEATURE);this.objectId=l}}a.FeatureSnappingCandidate=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/SnappingCandidate":function(){define(["exports"],function(a){class b{constructor(d,m,p,l){this.targetPoint=d;this.constraint=m;this.isDraped=p;this.domain=
l}}a.SnappingCandidate=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,d,m,p,l){class k extends l.SnappingHint{constructor(E,q,f,u,t=p.SnappingDomain.ALL,A=!0,x=!0){super(u,t);this.type=E;this.lineStart=q;this.lineEnd=f;this.fadeLeft=A;this.fadeRight=x}equals(E){return E instanceof
k?this.type===E.type&&m.exactEquals(this.lineStart,E.lineStart)&&m.exactEquals(this.lineEnd,E.lineEnd)&&this.fadeLeft===E.fadeLeft&&this.fadeRight===E.fadeRight:!1}get length(){return m.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(d,m){this.isDraped=d;this.domain=m}}a.SnappingHint=b;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/EdgeSnappingCandidate":function(){define(["exports","../../sketch/constraints","../snappingUtils","./FeatureSnappingCandidate","../hints/LineSnappingHint"],function(a,b,d,m,p){class l extends m.FeatureSnappingCandidate{constructor(k){super({...k,constraint:new b.LineConstraint(k.edgeStart,k.edgeEnd)})}get hints(){return[new p.LineSnappingHint(d.LineSegmentHintType.REFERENCE,this.constraint.start,this.constraint.end,
this.isDraped,this.domain)]}}a.EdgeSnappingCandidate=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/IntersectionSnappingCandidate":function(){define(["exports","../../sketch/constraints","../SnappingDomain","./SnappingCandidate","../hints/IntersectionSnappingHint"],function(a,b,d,m,p){class l extends m.SnappingCandidate{constructor(k,E,q,f){super(k,new b.PointConstraint(k),f,d.SnappingDomain.ALL);this.first=E;this.second=q}get hints(){this.first.targetPoint=
this.targetPoint;this.second.targetPoint=this.targetPoint;return[...this.first.hints,...this.second.hints,new p.IntersectionSnappingHint(this.targetPoint,this.isDraped,this.domain)]}}a.IntersectionSnappingCandidate=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec32","../SnappingDomain","./SnappingHint"],function(a,b,d,m){class p extends m.SnappingHint{constructor(l,
k,E=d.SnappingDomain.ALL){super(k,E);this.intersectionPoint=l}equals(l){return l instanceof p?b.exactEquals(this.intersectionPoint,l.intersectionPoint):!1}}a.IntersectionSnappingHint=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/LineSnappingCandidate":function(){define("exports ../../sketch/constraints ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint".split(" "),function(a,b,d,m,p,l){class k extends p.SnappingCandidate{constructor({lineStart:E,
lineEnd:q,targetPoint:f,isDraped:u}){super(f,new b.VerticalPlaneConstraint(E,q),u,d.SnappingDomain.SELF);this._referenceLineHint=new l.LineSnappingHint(m.LineSegmentHintType.REFERENCE_EXTENSION,E,q,u,this.domain)}get hints(){return[this._referenceLineHint,new l.LineSnappingHint(m.LineSegmentHintType.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}}a.LineSnappingCandidate=k;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/ParallelLineSnappingCandidate":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/ParallelSnappingHint".split(" "),function(a,b,d,m,p,l,k,E,q,f){class u extends E.SnappingCandidate{constructor({referenceLine:t,lineStart:A,
targetPoint:x,isDraped:v}){const B=d.clone(A),{left:n,right:w}=t;b.subtract(B,b.add(B,B,w),n);super(x,new m.VerticalPlaneConstraint(A,p.fromVec3(B)),v,l.SnappingDomain.SELF);this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new q.LineSnappingHint(k.LineSegmentHintType.TARGET,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new f.ParallelSnappingHint(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(t=>new q.LineSnappingHint(k.LineSegmentHintType.REFERENCE,
t.edge.left,t.edge.right,this.isDraped,this.domain,t.fadeLeft,t.fadeRight))]}addReferenceLine(t){const A={edge:t,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(x=>{b.exactEquals(t.right,x.edge.left)&&(x.fadeLeft=!1,A.fadeRight=!1);b.exactEquals(t.right,x.edge.right)&&(x.fadeRight=!1,A.fadeRight=!1);b.exactEquals(t.left,x.edge.right)&&(x.fadeRight=!1,A.fadeLeft=!1);b.exactEquals(t.left,x.edge.left)&&(x.fadeLeft=!1,A.fadeLeft=!1)});this._referenceLines.push(A)}}a.ParallelLineSnappingCandidate=
u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,d,m,p,l){class k extends l.SnappingHint{constructor(E,q,f,u=p.SnappingDomain.ALL){super(f,u);this.lineStart=E;this.lineEnd=q}equals(E){return E instanceof k?m.exactEquals(this.lineStart,E.lineStart)&&m.exactEquals(this.lineEnd,
E.lineEnd):!1}}a.ParallelSnappingHint=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleSnappingCandidate":function(){define("exports ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),function(a,b,d,m,p,l){class k extends m.SnappingCandidate{constructor({targetPoint:E,constraint:q,previousVertex:f,otherVertex:u,otherVertexType:t,isDraped:A,selfSnappingType:x,
objectId:v,domain:B}){super(E,q,A,B??b.SnappingDomain.SELF);this.previousVertex=f;this.otherVertex=u;this.otherVertexType=t;this.selfSnappingType=x??a.SelfSnappingRightAngleType.None;this.objectId=v??null}get hints(){const E=this.previousVertex,q=this.otherVertexType===a.OtherVertexType.CENTER?this.otherVertex:this.targetPoint,f=this.otherVertexType===a.OtherVertexType.CENTER?this.targetPoint:this.otherVertex;return[new p.LineSnappingHint(d.LineSegmentHintType.TARGET,q,f,this.isDraped,this.domain),
new p.LineSnappingHint(d.LineSegmentHintType.REFERENCE,E,q,this.isDraped,this.domain),new l.RightAngleSnappingHint(this.previousVertex,q,f,this.isDraped,this.domain)]}}a.OtherVertexType=void 0;(function(E){E[E.NEXT=0]="NEXT";E[E.CENTER=1]="CENTER"})(a.OtherVertexType||(a.OtherVertexType={}));a.SelfSnappingRightAngleType=void 0;(function(E){E[E.None=0]="None";E[E.LastVertex=1]="LastVertex";E[E.FirstVertex=2]="FirstVertex";E[E.ExistingEdge=3]="ExistingEdge"})(a.SelfSnappingRightAngleType||(a.SelfSnappingRightAngleType=
{}));a.RightAngleSnappingCandidate=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,d,m,p,l){class k extends l.SnappingHint{constructor(E,q,f,u,t=p.SnappingDomain.ALL){super(u,t);this.previousVertex=E;this.centerVertex=q;this.nextVertex=f}equals(E){return E instanceof
k?m.exactEquals(this.previousVertex,E.previousVertex)&&m.exactEquals(this.centerVertex,E.centerVertex)&&m.exactEquals(this.nextVertex,E.nextVertex):!1}}a.RightAngleSnappingHint=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/candidates/RightAngleTriangleSnappingCandidate":function(){define("exports ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../sketch/constraints ../../sketch/normalizedPoint ../SnappingDomain ../snappingUtils ./SnappingCandidate ../hints/LineSnappingHint ../hints/RightAngleSnappingHint".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){class t extends q.SnappingCandidate{constructor({targetPoint:A,point1:x,point2:v,isDraped:B}){super(A,new p.VerticalCylinderConstraint(l.fromVec3(d.lerp(m.create(),x,v,.5)),.5*b.distance(l.asVec2(x),l.asVec2(v))),B,k.SnappingDomain.SELF);this._p1=x;this._p2=v}get hints(){return[new f.LineSnappingHint(E.LineSegmentHintType.REFERENCE,this.targetPoint,this._p1,this.isDraped,this.domain),new f.LineSnappingHint(E.LineSegmentHintType.REFERENCE,this.targetPoint,this._p2,this.isDraped,
this.domain),new u.RightAngleSnappingHint(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}}a.RightAngleTriangleSnappingCandidate=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define(["exports","../../../core/screenUtils","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../3d/interactive/support/viewUtils"],function(a,b,d,m,p){const l=m.makeDehydratedPoint(0,0,0,
null),k=d.create(),E=b.createScreenPointArray();a.vectorToScreenPoint=function(q,f,u,t){if("2d"===t.type)return l.x=q[0],l.y=q[1],l.spatialReference=f,t.toScreen(l);p.vectorToRender(q,f,u,t,k);t.state.camera.projectToScreen(k,E);return b.createScreenPoint(E[0],E[1])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/support/viewUtils":function(){define("exports ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../support/elevationInfoUtils".split(" "),
function(a,b,d,m,p,l){const k=p.create(),E=b.createRenderScreenPointArray(),q=b.createRenderScreenPointArray();a.renderScreenSpaceTangent=function(f,u,t,A){t.projectToRenderScreen(f,E);t.projectToRenderScreen(u,q);d.subtract(A,q,E);d.normalize(A,A)};a.vectorToRender=function(f,u,t,A,x=p.create()){f=m.copy(k,f);f[2]=l.getConvertedElevationFromVector(A,f,u,t)||0;A.renderCoordsHelper.toRenderCoords(f,u,x);return x};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/CreateFeaturesWorkflow":function(){define("require ../../chunks/tslib.es6 ../../Graphic ../../core/arrayUtils ../../core/Error ../../core/handleUtils ../../core/has ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/support/layerUtils ../../views/draw/support/helpMessageUtils ../../views/input/InputManager ../../views/interactive/sketch/SketchOptions ../../views/interactive/snapping/FeatureSnappingLayerSource ./CreateFeaturesWorkflowData ./modelUploadUtils ./Workflow ./workflowUtils ../FeatureForm/FeatureFormViewModel ../Sketch/SketchViewModel".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L){function S(c,g){let F=null;const I=()=>{null!=F&&(c.snappingOptions.featureSources.remove(F),F=E.destroyMaybe(F))};return l.handlesGroup([f.watch(()=>{const O=g.creationInfo?.layer,R=c.snappingOptions.featureSources.find(W=>W.layer===O);return{hasFeatureLayerSource:!!R,enabled:R?.enabled??!1}},({hasFeatureLayerSource:O,enabled:R})=>{if(O)null==F&&(F=new K({layer:c.layer}),c.snappingOptions.featureSources.add(F)),F.enabled=R;else return I()},
f.syncAndInitial),l.makeHandle(I)])}function r(c,g,F,I){const O=[];g.forEach((R,W)=>{if(!R.error){const V=c[W];W=I.get(V)||[];V.attributes[F.objectIdField]=R.objectId;W.forEach(({form:aa})=>O.push({feature:V,attachment:aa}))}});return O}function J(c,g,F){const I=[],O=g.globalIdField;c.forEach((R,W)=>{let V;(V=c[W].attributes)[O]??(V[O]=u.generateBracedUUID());(F?.get(R)||[]).forEach(({file:aa})=>I.push({feature:R,attachment:{globalId:u.generateBracedUUID(),data:aa}}))});return I.length?{addFeatures:c,
addAttachments:I}:{addFeatures:c}}var M;const y=Symbol(),H=Symbol(),h=Symbol(),e=Symbol();k=M=class extends P{constructor(c){super(c);this.type="create-features";this.createFeatureState="create-new";this.data=void 0;this.isNested=!1;this._getDrawMeshHelpMessage=void 0;this._featureFormHandle=null;this._visualVariableAttributes={rotation:null,size:null};this._featureFormViewModel=new C;this._sketchViewModel=null;this._attachmentFileInfos=new Map;this._highlightHandles=new Map;this._preventDefaultActionOnCancel=
!1;this._lastActiveGraphics=[];this._isActive=!0;this._updateGraphicDebounced=q.debounce((g,F,I)=>z.updateGraphicSymbolWhenRequired(g,F,I))}initialize(){this.isNested&&(this._isActive=!1);this._initializeSketchViewModel()}destroy(){this._sketchViewModel.destroy()}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){if(this.pendingFeatures.some(O=>!!this.data.getEditsForPendingFeature(O)?.modified))return!0;const {creationInfo:c,upload:g}=this.data;var F=this._sketchViewModel;
const {activeComponent:I}=F;F=F.createGraphic?.geometry?.type;return!("polyline"!==F&&"polygon"!==F&&"multipoint"!==F||"draw-2d"!==I?.type&&"draw-3d"!==I?.type)&&0<I.drawOperation.committedVertices.length||g&&("pending"===g.state||"success"===g.state)||c?.geometryToPlace?!0:!1}get helpMessage(){const {creationInfo:c,viewModel:g}=this.data;if("creating-features"===this.stepId&&c){var F=c.layer.geometryType,I=this._sketchViewModel.createGraphic;return"mesh"===F?(this._getDrawMeshHelpMessage||(new Promise((O,
R)=>a(["../../views/draw/support/helpMessageUtils3d"],O,R))).then(O=>{this._getDrawMeshHelpMessage=O.getDrawMeshHelpMessage}),{view:F}=g,"3d"===F?.type?this._getDrawMeshHelpMessage?.(I,F):void 0):n.getDrawHelpMessage(F,I?.geometry)}}get layer(){return this.data.creationInfo?.layer}get numPendingFeatures(){return this.pendingFeatures.length}get parent(){return this.data.parent}get parentLayer(){return this.parent?.data.editorItem.layer}get pendingFeatures(){return this.data.pendingFeatures}get keyboardCancellationEnabled(){return 0===
this.numPendingFeatures}get reliesOnOwnerAdminPrivileges(){return this.data.editorItem?.capabilities.create.reliesOnOwnerAdminPrivileges??!1}get shouldShowAttachments(){return this.data.editorItem?.capabilities.create.attachments.enabled??!1}get shouldAllowAttachmentEditing(){return this.shouldShowAttachments}get sketchViewModel(){return this._sketchViewModel}get test(){}async enter(){this._isActive=!0;"awaiting-feature-creation-info"!==this.stepId&&this._setUpCreatingFeaturesStep()}exit(){this._isActive=
!1;this.removeHandles([h])}async updatePendingFeature(c,g){this._preventDefaultActionOnCancel=!0;this._sketchViewModel.cancel();m.remove(this._lastActiveGraphics,c);return this._startUpdating({feature:c,webStyleCache:g})}async start(){await super.start();return B.isTable(this.data.creationInfo?.layer)?null:{enter:async()=>{},exit:async()=>{},viewModel:this._sketchViewModel}}static create(c){const {addAttachmentsCallback:g,applyEditsCallback:F,isNested:I,creationInfo:O,parent:R,snappingManager:W,startAt:V,
viewModel:aa}=c;c=c.sketchOptions??new D;var fa=O?.layer;fa=fa?aa.findEditorItemForLayer(fa):void 0;const ja=new M({data:new N.CreateFeaturesWorkflowData({creationInfo:O,editorItem:fa,parent:R,sketchOptions:c,snappingManager:W,viewModel:aa}),isNested:I,onCommit:async da=>{var {creationInfo:Z}=da;if(Z){da=da.pendingFeatures.toArray();({layer:Z}=Z);var ka=ja._attachmentFileInfos;if(Z.capabilities?.editing.supportsGlobalId&&"globalIdField"in Z)da=J(da,Z,ka),await F(Z,da,{globalIdUsed:!0});else{var la=
await F(Z,{addFeatures:da});0<ka.size&&await g(Z,r(da,la?.addFeatureResults??[],Z,ka))}}}});ja._set("steps",this._createWorkflowSteps(ja,V));return ja}_fadeExistingFeatures(c){if("effect"in c){const F=c.effect;c.effect="saturate(0.6) opacity(0.8)";return l.makeHandle(()=>c.effect=F)}const g=c.opacity;c.opacity=.7;return l.makeHandle(()=>c.opacity=g)}_highlight(c){const g=this.data.viewModel.view;"3d"===g?.type&&this._highlightHandles.set(c,g.highlight(c))}_removeHighlight(c){E.removeMaybe(this._highlightHandles.get(c));
this._highlightHandles.delete(c)}async _startCreating(c){this.removeHandles(H);const {creationInfo:g}=this.data;g&&(this.createFeatureState="create-new",c=await z.startCreatingNewFeature(this._sketchViewModel,g,c),this.addHandles(c,H))}async _startUpdating({feature:c,webStyleCache:g,initialFeature:F=c}){const {data:I,pendingFeatures:O}=this;O.includes(c)||I.addPendingFeature(c,F);const {_featureFormViewModel:R,_sketchViewModel:W}=this,{creationInfo:V,viewModel:aa}=I,{attachmentsViewModel:fa,layerInfos:ja,
view:da}=aa;if(da&&V){F=V.layer;var Z=z.findLayerInfo(ja,F);R.set({arcadeEditType:"INSERT",feature:c,formTemplate:Z?.formTemplate,spatialReference:da.spatialReference,map:da.map});"add"!==fa.mode&&"edit"!==fa.mode||aa.activeWorkflow?.previous();fa.graphic=c;fa.fileInfos.removeAll();fa.mode="view";(this._attachmentFileInfos.get(c)||[]).forEach(({file:la,form:T})=>fa.addFile(la,T));this._removeHighlight(c);await z.updateGraphicSymbolWhenRequired(c,g,"2d"===da.type?da.scale:null);this.removeHandles(H);
E.removeMaybe(this._featureFormHandle);"2d"===da.type&&(Z=f.watch(()=>da.scale,la=>this._updateGraphicDebounced(c,g,la)),this.addHandles(Z,H));var ka=I.getEditsForPendingFeature(c);this._featureFormHandle=l.handlesGroup([R.on("value-change",async()=>{ka?.updateAttributes(R.getValues());await z.updateGraphicSymbolWhenRequired(c,g,"2d"===da.type?da.scale:null)}),W.on(["update","undo","redo"],la=>{("undo"===la.type||"redo"===la.type||"update"===la.type&&null!=la.toolEventInfo&&z.isTerminalUpdateEventType(la.toolEventInfo.type))&&
R.notifyFeatureGeometryChanged()}),f.watch(()=>R.feature?.sourceLayer,la=>c.sourceLayer=la)]);this.createFeatureState="update-pending";this._visualVariableAttributes=z.getVisualVariableAttributes(c);if(!B.isTable(F))return z.startUpdatingFeature({graphic:c,sketchViewModel:W,sourceLayer:F,visualVariables:this._visualVariableAttributes,webStyleCache:g})}}static _createWorkflowSteps(c,g="awaiting-feature-creation-info"){const {data:F}=c;g=z.createWorkflowSteps(["awaiting-feature-creation-info","creating-features",
"adding-attachment","editing-attachment"],g,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){const {creationInfo:I,viewModel:O}=F,{view:R}=O;R&&(G.isModelUpload(I)?c.addHandles(await G.handleModelUpload({view:R,data:F,next:()=>c.next(),cancel:()=>O.cancelWorkflow({warnIfNoWorkflow:!1})}),this.id):(F.parent&&I&&(c.addHandles(O.lockFeatureTemplatesViewModel(),this.id),O.featureTemplatesViewModel.layers=[I.layer]),c.addHandles(O.featureTemplatesViewModel.on("select",
({item:W})=>{W&&(F.creationInfo={...F.creationInfo,layer:W.layer,template:W.template},c.next())}),this.id)))},async tearDown(){c.removeHandles([this.id,H])}}),"creating-features":()=>({id:"creating-features",async setUp(){c._isActive&&await c._setUpCreatingFeaturesStep()},async tearDown(I){const {viewModel:O}=F;I.canceled&&(c.removeHandles([h,y,H,e]),O.attachmentsViewModel.fileInfos.removeAll(),c._attachmentFileInfos.clear())}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",
async setUp(){},async tearDown(){const {attachmentsViewModel:I}=F.viewModel,{graphic:O,fileInfos:R}=I;c._attachmentFileInfos.set(O,R.toArray());I.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const {attachmentsViewModel:I}=F.viewModel,{graphic:O,fileInfos:R}=I;c._attachmentFileInfos.set(O,R.toArray());I.mode="view"}})});return z.avoidFeatureTemplateSelectionWithOnlyOneItem(F,g)}static _configureSketchViewModel(c,g){const {data:F}=
c,{creationInfo:I,viewModel:O}=F,{view:R}=O,W=c._sketchViewModel;let V=null;var aa=[];if(!R)return l.makeHandle();"2d"===R.type&&I&&aa.push(c._fadeExistingFeatures(I.layer));const fa=async Z=>{if("cancel"===Z.state){if(c._preventDefaultActionOnCancel){c._preventDefaultActionOnCancel=!1;return}if(null==R.activeTool){if(1>c._lastActiveGraphics.length)return c._startCreating(g);Z=c._lastActiveGraphics.pop();return c._startUpdating({feature:Z,webStyleCache:g})}return c._waitForActiveToolCleared().then(()=>
c._startCreating(g))}if("complete"===Z.state&&Z.graphic){const ka=Z.graphic.clone();ka.geometry=null;return c._startUpdating({feature:Z.graphic,webStyleCache:g,initialFeature:ka})}},ja=async Z=>{var {attachmentsViewModel:ka}=O;const {_featureFormViewModel:la}=c;var T=Z.graphics[0];if("complete"===Z.state){T!==V&&(c._lastActiveGraphics.push(T),c._highlight(T));V=null;const {hasPendingSubtypeChoice:ha,submittable:ma}=la;if(c.numPendingFeatures===I?.maxFeatures||ha||!ma){!ma&&la.submit();const Q=c._lastActiveGraphics.pop();
return null===O.view?.activeTool?c._startUpdating({feature:Q,webStyleCache:g}):c._waitForActiveToolCleared().then(()=>c._startUpdating({feature:Q,webStyleCache:g}))}"add"!==ka.mode&&"edit"!==ka.mode||O.activeWorkflow?.previous();if(Z.aborted&&c._preventDefaultActionOnCancel){c._preventDefaultActionOnCancel=!1;return}c.addHandles([z.showProgressCursor(R),R.on("click",Q=>Q.preventDefault())],y);await f.whenOnce(()=>!la.updating);c.removeHandles(y);if(null==O.view?.activeTool)c._startCreating(g);else return c._waitForActiveToolCleared().then(()=>
{const Q=c._lastActiveGraphics.pop();if(Q)return c._startUpdating({feature:Q,webStyleCache:g})})}"start"===Z.state&&c._removeHighlight(T);ka=c._visualVariableAttributes;await z.visualVariableInteractiveUpdate(R,T,Z,ka,g);Z=T.attributes;const {rotation:U,size:ba}=ka;null!=U&&({field:T}=U,la.setValue(T,Z[T]));null!=ba&&({field:T}=ba,la.setValue(T,Z[T]))},da=async Z=>{if(!G.isModelUpload(I)&&({results:Z}=await R.hitTest(Z,{include:W.layer}),Z=Z.find(T=>"graphic"===T.type&&T.graphic.sourceLayer===I?.layer))&&
(Z=Z.graphic,("transform"===W.activeTool||"reshape"===W.activeTool)&&W.updateGraphics.at(0)!==Z)){var {submittable:ka,hasPendingSubtypeChoice:la}=c._featureFormViewModel;ka&&!la&&await c.updatePendingFeature(Z,g)}};aa.push(W.on("create",Z=>c._updatingHandles.addPromise(fa(Z))),W.on("update",Z=>c._updatingHandles.addPromise(ja(Z))),W.on("delete",Z=>{Z=Z.graphics[0];F.removePendingFeature(Z);m.remove(c._lastActiveGraphics,Z);V=Z}),R.on("immediate-click",Z=>c._updatingHandles.addPromise(da(Z)),w.ViewEventPriorities.TOOL),
l.makeHandle(()=>{c._preventDefaultActionOnCancel=!0;W.cancel()}),S(W,F));aa=l.handlesGroup(aa);W.addHandles(aa);return aa}_initializeSketchViewModel(){const {data:c}=this,{view:g}=c.viewModel,F=new v({elevationInfo:c.creationInfo?.layer.elevationInfo,internal:!0,listMode:"hide"});this._sketchViewModel=new L({layer:F,sketchOptions:c.sketchOptions,snappingManager:c.snappingManager,updateOnGraphicClick:!1,view:g});g?.map.add(F);this.addHandles(l.makeHandle(()=>{g?.destroyed||g?.map.remove(F);F.destroy()}))}async _setUpCreatingFeaturesStep(){if(!this.hasHandles(h)){var {data:c}=
this,{creationInfo:g,viewModel:F}=c,{attachmentsViewModel:I,view:O}=F;if(!O||!g?.layer)throw new p("missing-parameters","CreateFeaturesWorkflow requires a view and creationInfo.");this._preventDefaultActionOnCancel=!1;var {initialFeature:R,layer:W}=g,V=this._sketchViewModel,aa=new Map,fa=[];this._lastActiveGraphics=[];this._featureFormHandle=E.removeMaybe(this._featureFormHandle);this._visualVariableAttributes={rotation:null,size:null};this.data.editorItem=F.findEditorItemForLayer(g.layer);z.prepareAttachmentsForCreateFeaturesWorkflow(I);
fa.push(f.watch(()=>I.mode,Z=>{switch(Z){case "add":this.go("adding-attachment");break;case "edit":this.go("editing-attachment")}}));var ja=z.showProgressCursor(O);fa.push(ja);var da=B.isTable(g.layer);try{if(da){const Z=R??new d({attributes:{...g.template?.prototype.attributes,...g.attributeOverrides},sourceLayer:W});await this._startUpdating({feature:Z,webStyleCache:aa})}else fa.push(M._configureSketchViewModel(this,aa)),R?(V.layer.add(R),await this._startUpdating({feature:R,webStyleCache:aa})):
await this._startCreating(aa)}finally{ja.remove()}aa=l.makeHandle(()=>{for(const Z of c.pendingFeatures)V.layer.remove(Z),c.removePendingFeature(Z)});ja=f.watch(()=>O?.timeZone,Z=>this._featureFormViewModel.timeZone=Z,f.initial);da=l.makeHandle(()=>{G.isModelUpload(g)&&F.cancelWorkflow({warnIfNoWorkflow:!1})});this._featureFormHandle&&fa.push(this._featureFormHandle);this.addHandles(fa,this._handleKeys.beforeCommit);this.addHandles([l.makeHandle(()=>I.fileInfos.removeAll()),l.handlesGroup(fa),da,
aa,ja],h)}}async _waitForActiveToolCleared(){const c=this.data.viewModel.view;if(null!=c?.activeTool){var g=new AbortController;this.addHandles(l.abortHandle(g),e);await f.whenOnce(()=>null==c?.activeTool,g.signal);g.abort()}}};b.__decorate([t.property()],k.prototype,"createFeatureState",void 0);b.__decorate([t.property()],k.prototype,"data",void 0);b.__decorate([t.property({constructOnly:!0})],k.prototype,"isNested",void 0);b.__decorate([t.property()],k.prototype,"featureFormViewModel",null);b.__decorate([t.property()],
k.prototype,"hasPendingEdits",null);b.__decorate([t.property()],k.prototype,"_getDrawMeshHelpMessage",void 0);b.__decorate([t.property()],k.prototype,"helpMessage",null);b.__decorate([t.property()],k.prototype,"layer",null);b.__decorate([t.property()],k.prototype,"parent",null);b.__decorate([t.property()],k.prototype,"parentLayer",null);b.__decorate([t.property()],k.prototype,"keyboardCancellationEnabled",null);b.__decorate([t.property()],k.prototype,"reliesOnOwnerAdminPrivileges",null);b.__decorate([t.property()],
k.prototype,"shouldShowAttachments",null);b.__decorate([t.property()],k.prototype,"shouldAllowAttachmentEditing",null);b.__decorate([t.property()],k.prototype,"sketchViewModel",null);return k=M=b.__decorate([x.subclass("esri.widgets.Editor.CreateFeaturesWorkflow")],k)})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports"],function(a){a.getDrawHelpMessage=function(b,d){switch(b){case "point":case "multipoint":return"point";case "polyline":return 2>(null!=d&&"polyline"===d.type&&
d.paths.length?d.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return b=null!=d&&"polygon"===d.type&&d.rings.length?d.rings[0].length:0,b=3>b?"polylineZeroVertices":4>b?"polygonOneVertex":"polygonTwoVertices",b}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/CreateFeaturesWorkflowData":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Collection ../../core/ReactiveMap ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./Edits".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){a.CreateFeaturesWorkflowData=class extends d{constructor(t){super(t);this.upload=this.viewModel=this.snappingManager=this.sketchOptions=this.parent=this.editorItem=this.creationInfo=null;this._pendingEdits=new p}get pendingFeatures(){return new m([...this._pendingEdits.keys()])}addPendingFeature(t,A=t){const {_pendingEdits:x}=this;if(x.has(t))return x.get(t);const v=new u.Edits({feature:t});v.trackChanges(A);x.set(t,v);return v}getEditsForPendingFeature(t){return this._pendingEdits.get(t)}removePendingFeature(t){const {_pendingEdits:A}=
this,x=A.get(t);x&&(x.destroy(),A.delete(t))}};b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"creationInfo",void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"editorItem",void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"parent",void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"pendingFeatures",null);b.__decorate([l.property({constructOnly:!0})],a.CreateFeaturesWorkflowData.prototype,"sketchOptions",
void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"snappingManager",void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"viewModel",void 0);b.__decorate([l.property()],a.CreateFeaturesWorkflowData.prototype,"upload",void 0);a.CreateFeaturesWorkflowData=b.__decorate([f.subclass("esri.widgets.Editor.CreateFeaturesWorkflowData")],a.CreateFeaturesWorkflowData);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/Edits":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/SetUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k,E,q){function f(u,t){u=null==u?{}:u;t=null==t?{}:t;var A=new Set(Object.keys(u));m.addMany(A,Object.keys(t));for(const v of A){A=u[v];var x=t[v];A=null!==A&&void 0!==A&&""!==A||null!==x&&void 0!==x&&""!==x?A===x?!0:!1:!0;if(!A)return!1}return!0}a.Edits=class extends d{constructor(u){super(u);this._stagedForDelete=!1;this.initialFeature=this.feature=null}get attributesModified(){return!f(this.initialFeature?.attributes,this.feature?.attributes)}get geometryModified(){return this._stringifyGeometry(this.feature)!==
this._stringifyGeometry(this.initialFeature)}get stagedForDelete(){return this._stagedForDelete}get modified(){return this.attributesModified||this.geometryModified||this._stagedForDelete}stageDelete(){this._stagedForDelete=!0}unstageDelete(){this._stagedForDelete=!1}trackChanges(u=this.feature){this.initialFeature=u?.clone()}updateAttributes(u){const {feature:t}=this;t&&(t.attributes=u,this.notifyChange("attributesModified"))}updateGeometry(u){const {feature:t}=this;t&&(t.geometry=u,this.notifyChange("geometryModified"))}_stringifyGeometry(u){u=
u?.geometry;return"mesh"===u?.type?(u={transform:u.transform,vertexSpace:u.vertexSpace},null==u?null:JSON.stringify(u)):null==u?null:JSON.stringify(u)}};b.__decorate([p.property()],a.Edits.prototype,"_stagedForDelete",void 0);b.__decorate([p.property()],a.Edits.prototype,"attributesModified",null);b.__decorate([p.property()],a.Edits.prototype,"feature",void 0);b.__decorate([p.property()],a.Edits.prototype,"geometryModified",null);b.__decorate([p.property()],a.Edits.prototype,"initialFeature",void 0);
b.__decorate([p.property()],a.Edits.prototype,"modified",null);a.Edits=b.__decorate([q.subclass("esri.widgets.Editor.Edits")],a.Edits);a.attributesAreEquivalent=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/modelUploadUtils":function(){define("require exports ../../Graphic ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ./workflowUtils".split(" "),function(a,b,d,m,p,l,k){function E(q){return"scene"===q?.layer?.type}b.handleModelUpload=
async function({view:q,data:f,signal:u,next:t,cancel:A}){const {creationInfo:x}=f;if(!x||!E(x))return m.makeHandle();const {layer:v}=x,B=null!=x.geometryToPlace;x.geometryToPlace=null;if(B)return A(),m.makeHandle();({Upload:A}=await new Promise((D,K)=>a(["./Upload"],D,K)));p.throwIfAborted(u);const n=new A;f.upload=n;let w=null;f=m.handlesGroup([l.watch(()=>n.state,D=>{switch(D){case "default":w?.remove();break;case "pending":w?.remove();w=k.showProgressCursor(q);break;case "success":x.maxFeatures=
1;({result:D}=n);"georeferenced"===D?.type||"georeferenced-reprojected"===D?.type?(x.geometryToPlace=D.mesh,x.initialFeature=new d({attributes:k.getCreationAttributes(x),geometry:D.mesh,sourceLayer:v}),q.goTo(x.initialFeature,{animate:!1}).catch(p.ignoreAbortErrors)):x.geometryToPlace=D?.mesh;w?.remove();t();break;case "error":w?.remove()}}),m.makeHandle(()=>{n.cancel();w?.remove()})]);n.uploadTo(v);return f};b.isModelUpload=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/workflowUtils":function(){define("require exports ../../Graphic ../../core/arrayUtils ../../core/asyncUtils ../../core/has ../../core/handleUtils ../../core/lang ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/diffUtils ../../layers/support/fieldUtils ../../renderers/support/clickToleranceUtils ../../renderers/support/lengthUtils ../../renderers/visualVariables/support/sizeVariableUtils ../../renderers/visualVariables/support/visualVariableUtils ../../symbols/support/symbolConversion ../../symbols/support/symbolUtils ../../views/3d/layers/graphics/GraphicState ../../views/support/drapedUtils ../../views/support/hitTestSelectUtils ../support/templateUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P){function z(da){const Z=da.sourceLayer;var ka;if(!(ka=!Z||"feature"!==Z.type)){a:switch(Z.renderer?.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":case "pie-chart":ka=!0;break a;default:ka=!1}ka=!ka}if(ka)return{rotation:null,size:null};let la=ka=null;var T=Z.renderer.getVisualVariablesForType("rotation").filter(U=>(!U.axis||"heading"===U.axis)&&U.field&&!U.valueExpression&&null!=n.getRotationAngle(U,
da));1===T.length&&(ka=C(T[0],Z));T=Z.renderer.getVisualVariablesForType("size").filter(U=>U.field&&!U.useSymbolValue&&!U.valueExpression&&B.getTransformationType(U)===B.TransformationType.RealWorldSize&&null!=n.getSize(U,da));1===T.length&&(la=r(T[0],Z));return{rotation:ka,size:la}}function C(da,Z){const ka="heading"===(da.axis||"heading")&&"arithmetic"===da.rotationType?-1:1,la=da.field,T=(Z=Z.fields&&Z.fields.filter(ha=>ha.name===la))&&1===Z.length?Z[0].type:"double";var U=0,ba=0;return{field:la,
fieldType:T,getDefault:()=>Promise.resolve(0),getValue:ha=>{ba=U-ka*ha;return J((ba+360)%360,T)},setInitialValue:ha=>{U=ha;ba=0},isUpdatingInteractively:!1,rotationType:da.rotationType??"geographic"}}function L(da,Z){switch(Z){case "width":return da[0];case "depth":return da[1];case "height":return da[2];default:return da[2]||da[1]||da[0]}}async function S(da,Z,ka){if(null==Z)return 0;({symbol:Z}=w.to3D(Z));if(null==Z||"web-style"===Z.type||"cim"===Z.type)return 0;Z=Z.symbolLayers.at(0);if(!Z)return 0;
switch(Z.type){case "icon":return{computeIconLayerResourceSize:ka}=await new Promise((T,U)=>a(["../../symbols/support/symbolLayerUtils"],T,U)),Z.size||Math.min(fa.icon,(await ka(Z,fa.icon))[0])||fa.icon;case "text":return Z.size||fa.text;case "line":return Z.size||fa.line;case "object":const {computeObjectLayerResourceSize:la}=await new Promise((T,U)=>a(["../../symbols/support/symbolLayerUtils"],T,U));da=await la(Z,da.scale/fa.viewScaleSizeFactor);return L(da,ka);case "path":return(null!=Z.width?
Z.width:Z.height)||da.scale/fa.viewScaleSizeFactor;case "extrude":return Z.size||da.scale/fa.viewScaleSizeFactor;case "fill":case "water":return 0;default:return 0}}function r(da,Z){const ka=da.field,la=da.axis,T=(Z=Z.fields&&Z.fields.filter(Q=>Q.name===ka))&&1===Z.length?Z[0].type:"double";var U=0,ba=0;const ha=v.meterIn[da.valueUnit]??1;let ma;ma="area"===da.valueRepresentation?Q=>(Q*ha/2)**2*Math.PI:"radius"===da.valueRepresentation||"distance"===da.valueRepresentation?Q=>Q*ha/2:Q=>Q*ha;return{field:ka,
fieldType:T,getDefault:async(Q,X)=>J(ma(await S(X,Q,la)),T),getValue:(Q,X)=>{U||=X.pixelSizeAt(X.center);ba=U*Q;return J(ba,T)},setInitialValue:Q=>{U=Q;ba=0},isUpdatingInteractively:!1,displayUnit:V(da.valueUnit),axis:da.axis}}function J(da,Z){switch(Z){case "small-integer":case "integer":case "long":return Math.round(da);case "double":case "single":return da;default:return 0}}async function M(da,Z,ka){Z=await D.getDisplayedSymbol(da,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:Z,scale:ka});
null!=t.diff(da.symbol,Z)&&(da.symbol=Z)}function y(da){if(!da)throw Error("no geometry type");return"multipatch"===da?"mesh":da}function H(da){return{...da.template?.prototype.attributes,...da.attributeOverrides}}async function h(da,Z,ka,la,T){Z=new d({sourceLayer:Z,attributes:ka});const {rotation:U,size:ba}=z(Z);let ha=await D.getDisplayedSymbol(Z,{useSourceLayer:!0,webStyleCache:la,scale:T}),ma=!1;for(const Q of[ba,U])null!=Q&&null==ka[Q.field]&&(ka[Q.field]=await Q.getDefault(ha,da.view),ma=!0);
ma&&(ha=await D.getDisplayedSymbol(Z,{useSourceLayer:!0,webStyleCache:la,scale:T}));switch(ha?.type){case "simple-fill":case "polygon-3d":da.polygonSymbol=ha;break;case "simple-line":case "line-3d":da.polylineSymbol=ha;break;case "simple-marker":case "picture-marker":case "point-3d":case "cim":da.pointSymbol=ha;break;case "mesh-3d":da.meshSymbol=ha}e(da.tooltipOptions,ba,U)}function e(da,Z,ka){da.visualVariables=null!=Z||null!=ka?{size:null!=Z?{unit:Z.displayUnit,axis:Z.axis,valueType:Z.fieldType}:
null,rotation:null!=ka?{valueType:ka.fieldType,rotationType:ka.rotationType??"geographic"}:null}:null}async function c(da,Z,ka,la){if(0===da.length)return[];const {updatable:T,graphicsByLayer:U}=await ka.async(async()=>{var {results:ba}=await q.whenOrAbort(G.hitTestSelectSimilarDistance(Z,ka),la);const ha=new Map;G.filterGraphicHits(ba).forEach(({graphic:ma})=>{var Q=ma.layer;var X=ha.get(Q);X?Q=X:(X=[],ha.set(Q,X),Q=X);return Q.push(ma)});ba=da.filter(({capabilities:ma,layer:Q})=>ma.update.enabled&&
ha.has(Q));0!==ba.length&&ka.stopPropagation();return{updatable:ba,graphicsByLayer:ha}});return q.whenOrAbort(Promise.allSettled(T.map(async({layer:ba})=>{var ha=U.get(ba);const ma=F(ba);if(ha.every(ea=>A.featureHasFields(ma,ea)))return ha;const Q=[];for(var X of ha)Q.push(X.getObjectId()),ha=Object.keys(X.attributes),m.addMany(ma,ha);X=ba.createQuery();X.returnGeometry=!1;X.objectIds=Q;X.outFields=A.fixFields(ba.fieldsIndex,ma);return ba.queryFeatures(X,{signal:la}).then(({features:ea})=>ea)})),
la)}async function g(da,Z,ka,la){if(0===da.length)return[];const {mapPoint:T}=ka;if(null==T)return[];let U=null;const ba=await ka.async(async()=>{var {results:ha}=await q.whenOrAbort(Z.hitTest(ka),la);if(0===ha.length)return[];const ma=new Set;U=G.filterGraphicHits(ha);U.forEach(({graphic:Q})=>Q&&ma.add(Q.layer));ha=da.filter(Q=>ma.has(Q.layer)&&Q.supportsUpdateWorkflow);0<ha.length&&ka.stopPropagation();return ha});return q.whenOrAbort(Promise.allSettled(ba.map(async({layer:ha})=>{const ma=ha.createQuery();
ma.returnGeometry=!1;ma.outFields=F(ha);const Q="renderer"in ha?x.calculateTolerance({renderer:ha.renderer,pointerType:ka.pointerType}):0;ma.geometry=N.createQueryGeometry(T,Q,Z);ma.outSpatialReference=Z.spatialReference;const {features:X}=await ha.queryFeatures(ma,{signal:la});U?.forEach(({graphic:ea})=>{ea.layer!==ha||X.some(ia=>ia.getObjectId()===ea.getObjectId())||X.push(ea)});return X})),la)}function F(da){return A.fixFields(da.fieldsIndex,[da.objectIdField,A.getDisplayFieldName({displayField:"displayField"in
da?da.displayField:null,fields:da.fields})])}async function I(da){const {graphic:Z,sketchViewModel:ka,sourceLayer:la,visualVariables:T,webStyleCache:U}=da;let ba=!1;const {rotation:ha,size:ma}=T;[ha,ma].forEach(async Q=>{if(null!=Q){var X=Z.getAttribute(Q.field);null!=X?Q.setInitialValue(X):(X=await Q.getDefault(Z.symbol,ka.view),Q.setInitialValue(X),Z.setAttribute(Q.field,X),ba=!0)}});ba&&await M(Z,U,"2d"===ka.view?.type?ka.view.scale:null);da={multipleSelectionEnabled:!1};"point"===la.geometryType&&
(da.enableRotation=null!=ha,da.enableScaling=null!=ma);e(ka.tooltipOptions,ma,ha);ka.layer.elevationInfo=la.elevationInfo;return ka.update(Z,da)}async function O(da,Z,ka,la,T){if(null!=Z.geometry&&"point"===Z.geometry?.type){var U=la.rotation;var ba=ka.toolEventInfo;ba=null==ba||"rotate-start"!==ba.type&&"rotate"!==ba.type&&"rotate-stop"!==ba.type?null:ba;if(null!=U&&null!=ba){const {field:ha,getValue:ma}=U;"rotate-stop"===ba.type?(U.isUpdatingInteractively=!1,U.setInitialValue(Z.getAttribute(ha))):
(U.isUpdatingInteractively=!0,Z.setAttribute(ha,ma(ba.angle,da)))}la=la.size;ka=ka.toolEventInfo;ka=null==ka||"scale-start"!==ka.type&&"scale"!==ka.type&&"scale-stop"!==ka.type?null:ka;if(null!=la&&null!=ka){const {field:ha,getValue:ma}=la;"scale-stop"===ka.type?(la.isUpdatingInteractively=!1,la.setInitialValue(Z.getAttribute(ha))):(la.isUpdatingInteractively=!0,Z.setAttribute(ha,ma(ka.xScale,da)))}await M(Z,T,"2d"===da.type?da.scale:null)}}function R(da,Z,ka){if("3d"===da.type){const la=new K.GraphicState({graphic:Z});
return k.handlesGroup([da.trackGraphicState(la),f.watch(()=>la.displaying,ka)])}return f.watch(()=>Z.visible,ka)}async function W(da,Z){if("3d"===da.type){const ka=new K.GraphicState({graphic:Z});da=da.trackGraphicState(ka);await f.whenOnce(()=>ka.displaying||ka.error);da.remove()}else await f.whenOnce(()=>Z.visible)}function V(da){switch(da){case "unknown":return null;default:return da}}function aa(da){const Z=da.geometry;if("mesh"===Z?.type){const ka=da.cloneShallow();ka.attributes=E.clone(da.attributes);
ka.geometry=Z.cloneShallow();ka.geometry.transform=Z.transform?.clone()??null;return ka}return da.clone()}const fa={icon:u.px2pt(24),text:u.px2pt(12),line:u.px2pt(1),viewScaleSizeFactor:100},ja=(da,Z)=>da.whenLayerView("subtype-sublayer"===Z.type?Z.parent:Z);b.avoidFeatureTemplateSelectionWithOnlyOneItem=function(da,Z){da.viewModel.syncFeatureTemplates();da=da.creationInfo;if("awaiting-feature-creation-info"===Z[0].id&&da){const ka=da.layer,la=P.getAllTemplatesForLayer(ka);1===la.length&&"scene"!==
ka.type&&(da.template=la[0],Z.shift())}return Z};b.canCreateInteractiveEditSession=function(da){return"createInteractiveEditSession"in da};b.cloneGraphicExceptMesh=aa;b.createWorkflowSteps=function(da,Z,ka){let la=!1;return da.filter(T=>la?!0:la=T===Z).map(T=>ka[T]())};b.fetchCandidates=async function(da,Z,ka,la){switch(Z.type){case "3d":return c(da,Z,ka,la);case "2d":return g(da,Z,ka,la)}};b.fetchFullFeature=async function(da,Z,ka){const {sourceLayer:la}=da,T=la.createQuery();T.objectIds=[da.getAttribute(la.objectIdField)];
T.outFields=["*"];T.returnM=la.capabilities.data.supportsM;T.returnZ=la.capabilities.data.supportsZ;if("scene"!==la.type||null==la.infoFor3D)T.outSpatialReference=Z;da=await la.queryFeatures(T,{signal:ka});q.throwIfAborted(ka);return da.features[0]};b.findLayerInfo=function(da,Z){return da?.find(ka=>ka.layer===Z)};b.getCreationAttributes=H;b.getVisualVariableAttributes=z;b.isTerminalUpdateEventType=da=>/-stop/.test(da)||/vertex-/.test(da);b.isUpdateWorkflow=function(da){return"update"===da.type};
b.prepareAttachmentsForCreateFeaturesWorkflow=function(da){da.filesEnabled=!0;da.mode="view";da.capabilities={editing:!0,operations:{add:!0,update:!0,delete:!0}}};b.setUpGeometryUpdate=async function({feature:da,featureClone:Z,visualVariableAttributes:ka,sketchViewModel:la,view:T,onUpdate:U,webStyleCache:ba,addUpdatingPromise:ha,addHandle:ma}){await M(Z,ba,"2d"===T.type?T.scale:null);let Q=null;if("2d"===la?.view?.type){const oa=q.debounce(xa=>M(Z,ba,xa));Q=f.watch(()=>la?.view?.scale,xa=>oa(xa))}const X=
Z.sourceLayer;var ea=ja(T,X);await I({graphic:Z,sketchViewModel:la,sourceLayer:X,visualVariables:ka,webStyleCache:ba});let ia=null;ea.then(oa=>ia=oa).catch(()=>{});const na=ka.size,ra=ka.rotation;ea=f.watch(()=>da.attributes,async oa=>{let xa=!1;for(const ua in oa){const za=oa[ua];za!==Z.getAttribute(ua)&&(Z.setAttribute(ua,za),null==na||na.isUpdatingInteractively||na.field!==ua||na.setInitialValue(za),null==ra||ra.isUpdatingInteractively||ra.field!==ua||ra.setInitialValue(za),null==ia||ia.requiredFields.includes(ua))&&
(xa=!0)}xa&&await M(Z,ba,"2d"===T.type?T.scale:null)});const ta=la.on("update",async oa=>{const xa=oa.graphics[0],ua={graphic:xa,sketchViewModel:la,sourceLayer:X,visualVariables:ka,webStyleCache:ba};if("complete"===oa.state){if(null===T.activeTool)return I(ua);const za=new AbortController;oa=k.abortHandle(za);ma(oa);return ha(f.whenOnce(()=>null===T.activeTool,za.signal).then(()=>{za.abort();return I(ua)}))}await O(T,xa,oa,ka,ba);U(aa(xa),oa)}),pa=la.on(["undo","redo"],async oa=>{U(aa(oa.graphics[0]),
oa)});return k.handlesGroup([pa,ta,k.makeHandle(()=>la.cancel()),ea,Q])};b.showProgressCursor=function(da){const Z=da.cursor;da.cursor="progress";return k.makeHandle(()=>da.cursor=Z)};b.sizeDefaults=fa;b.sizeVariableUnitToLengthUnit=V;b.startCreatingNewFeature=async function(da,Z,ka){const la=Z.layer,T=H(Z);let U=null;const {view:ba}=da,ha="2d"===ba?.type;await h(da,la,T,ka,ha?ba.scale:null);if(ha){const X=q.debounce(ea=>h(da,la,T,ka,ea));U=f.watch(()=>ba.scale,ea=>X(ea))}const {data:ma,editing:Q}=
la.capabilities;da.layer.elevationInfo=la.elevationInfo;null==Z.geometryToPlace?await da.create(y(la.geometryType),{graphicProperties:{attributes:T,sourceLayer:la},hasZ:ma.supportsZ,defaultZ:(ha?Q.zDefault:null)??da.defaultCreateOptions.defaultZ}):await da.place(Z.geometryToPlace,{graphicProperties:{attributes:T,sourceLayer:la}});return U??k.makeHandle()};b.startUpdatingFeature=I;b.swapForEditingSession=async function(da,Z,ka){function la(ma){ha?.abort();ha=p.createTask(async Q=>{const X=await ja(T,
U);q.throwIfAborted(Q);X.setVisibility?.(ba,ma)})}const T=da.view;da.layer.add(ka);const U=Z.sourceLayer,ba=Z.getAttribute(Z.layer.objectIdField);let ha=null;await W(T,ka);la(!1);return k.handlesGroup([R(T,ka,ma=>la(!ma)),k.makeHandle(async()=>{la(!0);try{const ma=await ja(T,U);await f.whenOnce(()=>!ma.updating)}finally{da.layer.remove(ka)}})])};b.updateGraphicSymbolWhenRequired=M;b.visualVariableInteractiveUpdate=O;b.whenEditorLayerView=ja;b.whenGraphicDisplayed=W;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(p,l){return l?"xoffset"in l&&l.xoffset?Math.max(p,Math.abs(l.xoffset)):"yoffset"in l&&l.yoffset?Math.max(p,Math.abs(l.yoffset||0)):p:p}function d(p,l){if("number"===typeof p)return p;if(p?.stops?.length){p=p.stops;let k=l=0;for(let E=0;E<p.length;E++){const q=p[E].size;"number"===typeof q&&(l+=q,k++)}return l/k}return l}function m(p,l){if(!l)return p;l=l.filter(q=>"size"===q.type).map(q=>
{const {maxSize:f,minSize:u}=q;return(d(f,p)+d(u,p))/2});let k=0;const E=l.length;if(0===E)return p;for(let q=0;q<E;q++)k+=l[q];return Math.max(Math.floor(k/E),p)}a.calculateTolerance=function(p){const l=p?.renderer;p="touch"===p?.pointerType?9:6;if(!l)return p;p="visualVariables"in l?m(p,l.visualVariables):p;if("simple"===l.type)return b(p,l.symbol);if("unique-value"===l.type){let k=p;l.uniqueValueInfos?.forEach(E=>{k=b(k,E.symbol)});return k}if("class-breaks"===l.type){let k=p;l.classBreakInfos.forEach(E=>
{k=b(k,E.symbol)});return k}return p};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l,k,E){a.GraphicState=class extends d.EventedAccessor{constructor(q){super(q);
this.displaying=this.tracking=!1;this.error=null;this.isDraped=!1}};b.__decorate([m.property({constructOnly:!0})],a.GraphicState.prototype,"graphic",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"tracking",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"displaying",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"error",void 0);b.__decorate([m.property()],a.GraphicState.prototype,"isDraped",void 0);a.GraphicState=b.__decorate([E.subclass("esri.views.3d.layers.graphics.GraphicState")],
a.GraphicState);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils","../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,b,d,m,p){function l(E,q,f,u=new p){let t=0;if("2d"===f.type)t=q*(f.resolution??0);else if("3d"===f.type){var A=f.overlayPixelSizeInMapUnits(E),x=f.basemapSpatialReference;t=null==x||x.equals(f.spatialReference)?q*A:d.getMetersPerUnitForSR(x)/
d.getMetersPerUnitForSR(f.spatialReference)}q=E.x-t;A=E.y-t;x=E.x+t;E=E.y+t;({spatialReference:f}=f);u.xmin=Math.min(q,x);u.ymin=Math.min(A,E);u.xmax=Math.max(q,x);u.ymax=Math.max(A,E);u.spatialReference=f;return u}const k=new p;a.createQueryGeometry=l;a.intersectsDrapedGeometry=function(E,q,f){E=f.toMap(E);if(null==E)return!1;const u=m.calculateTolerance();return l(E,u,f,k).intersects(q)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/hitTestSelectUtils":function(){define(["exports"],
function(a){function b(d){return"graphic"===d?.type}a.filterGraphicHits=function(d){return d.filter(b)};a.findFirstGraphicHit=function(d){return d.find(b)??null};a.hitTestSelectSimilarDistance=async function(d,m){if("2d"===d.type)return d.hitTest(m);d=await d.hitTest(m);if(0===d.results.length)return d;m=d.results[0];const p=1.05*(m.distance??0),l=d.results.findIndex(k=>(k.distance??0)>p);-1!==l&&(d.results=d.results.slice(0,l));m&&d.ground.distance>p&&(d.ground.mapPoint=null);return d};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/Workflow":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/Evented ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/support/UpdatingHandles".split(" "),function(a,b,d,m,p,l,k,E,q,f){d=class extends d.EventedAccessor{constructor(u){super(u);this._indexHistory=[];this._stepIndex=this._lastStepIndex=
-1;this._updatingHandles=new f.UpdatingHandles;this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"};this.data=void 0;this.started=!1;this.steps=[];this._pendingOperation=this.type=null}destroy(){this._updatingHandles.destroy()}get hasNextStep(){const {steps:u}=this;return!!(u&&this._stepIndex<u.filter(t=>!t.parent).length-1)}get hasPreviousStep(){return 0<this._stepIndex}get reliesOnOwnerAdminPrivileges(){return!1}get hasInvalidFormTemplate(){return!1}get shouldShowAttachments(){return!1}get shouldAllowAttachmentEditing(){return!1}get stepId(){var {steps:u}=
this;return(u=u&&u[this._stepIndex])&&u.id}get helpMessage(){}get hasPendingEdits(){return!1}get keyboardCancellationEnabled(){return!0}get updating(){return this._updatingHandles.updating}async back(u=()=>Promise.resolve(!0)){if(!this.hasPendingEdits||await u())this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})}async cancel(u={force:!0}){return!1!==u.force?this._cancel(u):new Promise((t,A)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel({...u,
force:!0}).then(t)},deny:()=>A(new b("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.removeHandles(this._handleKeys.beforeCommit);this.onCommit&&await this.onCommit(this.data);this.removeHandles(this._handleKeys.afterCommit);this.emit("commit")}async go(u){var {steps:t}=this;t=t.findIndex(A=>A.id===u);this._indexHistory.push(this._stepIndex);await this._go(t)}async next(){this._indexHistory.push(this._stepIndex);await this._go(this._stepIndex+1)}async previous(u=
{cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),u.cancelCurrentStep)}async reset(){await this._cancel({emitCancelEvent:!1});await this.start()}async save(){await this.commit();await this.reset()}async start(){this._set("started",!0);await this._go(-1===this._stepIndex?0:this._stepIndex)}async _cancel({emitCancelEvent:u=!0,error:t}={}){this.started&&(this._set("started",!1),await this._transaction(()=>this.steps[this._stepIndex]?.tearDown({canceled:!0})));this.removeHandles([this._handleKeys.afterCommit,
this._handleKeys.beforeCommit]);this._resetIndexing(u);u&&this.emit("cancel",{error:t})}_go(u=-1,t=!1){return this._transaction(async()=>{const {steps:A}=this;if(!(-1>=u||u>=A.length)){if(this.started){-1<this._lastStepIndex&&await A[this._lastStepIndex].tearDown({canceled:t});try{await A[u].setUp()}catch(x){m.throwIfNotAbortError(x)}this._lastStepIndex=u}this._stepIndex=u;this._notifyStepProps()}})}async _transaction(u){const t=this._pendingOperation,A=m.createResolver(),x=(t??Promise.resolve()).then(()=>
A.promise);this._pendingOperation=x;this._updatingHandles.addPromise(x);try{t&&await t,await u()}finally{A.resolve(),x===this._pendingOperation&&(this._pendingOperation=null)}}_resetIndexing(u=!0){this._lastStepIndex=this._stepIndex=-1;this._indexHistory.length=0;u&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId");this.notifyChange("hasPreviousStep");this.notifyChange("hasNextStep")}};a.__decorate([p.property()],d.prototype,"data",void 0);a.__decorate([p.property()],d.prototype,
"hasNextStep",null);a.__decorate([p.property()],d.prototype,"hasPreviousStep",null);a.__decorate([p.property()],d.prototype,"onCommit",void 0);a.__decorate([p.property()],d.prototype,"reliesOnOwnerAdminPrivileges",null);a.__decorate([p.property()],d.prototype,"hasInvalidFormTemplate",null);a.__decorate([p.property()],d.prototype,"shouldShowAttachments",null);a.__decorate([p.property()],d.prototype,"shouldAllowAttachmentEditing",null);a.__decorate([p.property()],d.prototype,"started",void 0);a.__decorate([p.property({readOnly:!0})],
d.prototype,"stepId",null);a.__decorate([p.property()],d.prototype,"steps",void 0);a.__decorate([p.property({readOnly:!0})],d.prototype,"type",void 0);a.__decorate([p.property()],d.prototype,"helpMessage",null);a.__decorate([p.property()],d.prototype,"hasPendingEdits",null);a.__decorate([p.property()],d.prototype,"keyboardCancellationEnabled",null);a.__decorate([p.property()],d.prototype,"updating",null);return d=a.__decorate([q.subclass("esri.widgets.Editor.Workflow")],d)})},"esri/widgets/Sketch/SketchViewModel":function(){define("require ../../chunks/tslib.es6 ../../symbols ../../core/Collection ../../core/Error ../../core/Evented ../../core/handleUtils ../../core/has ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/ellipsoidUtils ../../geometry/projection ../../geometry/support/coordsUtils ../../geometry/support/spatialReferenceUtils ../../layers/GraphicsLayer ../../layers/support/layerUtils ../../views/3d/interactive/editingTools/isSupportedObjectUtils ../../views/3d/interactive/editingTools/move/isSupportedObject ../../views/3d/interactive/editingTools/reshape/isSupportedObject ../../views/3d/interactive/editingTools/transform/isSupportedGraphic ../../views/draw/support/layerUtils ../../views/input/InputManager ../../views/interactive/keybindings ../../views/interactive/sketch/SketchLabelOptions ../../views/interactive/sketch/SketchOptions ../../views/interactive/sketch/SketchTooltipOptions ../../views/interactive/sketch/SketchValueOptions ../../views/interactive/snapping/SnappingManager ../../views/interactive/snapping/SnappingOptions ../../views/interactive/snapping/snappingUtils ../../views/support/hitTestSelectUtils ../../views/support/screenUtils ./support/OperationHandle ../../symbols/SimpleMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/MeshSymbol3D ../../symbols/FillSymbol3DLayer".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S,r,J,M,y,H,h,e,c,g,F,I,O,R,W,V,aa){function fa(Q){return"polygon"===Q||"rectangle"===Q||"circle"===Q}function ja(Q,X){Z("undo",Q.history.undo,Q.history.redo,X)}function da(Q,X){Z("redo",Q.history.redo,Q.history.undo,X)}function Z(Q,X,ea,ia){if(X=X.pop()){var na=X.updates,ra=[];ia.forEach((ta,pa)=>{pa=na[pa];null!=pa&&("geometry"in pa&&null!=pa.geometry&&(ra.push({geometry:ta.geometry}),ta.geometry=pa.geometry),"symbol"in pa&&null!=pa.symbol&&
(ra.push({symbol:ta.symbol}),ta.symbol=pa.symbol),"undo"in pa&&(ra.push(pa),pa[Q](ta)))});ea.push({updates:ra})}}function ka(Q){return{updates:Q.map(({geometry:X})=>"mesh"===X?.type?{geometry:X.cloneShallow()}:{geometry:X})}}function la(Q,X){Q.tools?.remove(X);X.destroyed||X.destroy()}function T(Q){return"requireError"in Q&&"aborted"===Q.requireError}const U=Q=>Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"})),ba={defaultZ:0},ha={reshapeOptions:{edgeOperation:"split",
shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};l=class extends l.EventedAccessor{constructor(Q){super(Q);this._numUpdating=0;this._defaultSnappingManager=null;this._internalGraphicsLayer=new K({listMode:"hide",internal:!0,title:"SVM Internal"});this._operationHandle=null;this._viewHandlesKey="viewHandles";this.activeVertexSymbol=
this.activeLineSymbol=this.activeFillSymbol=null;this.allowDeleteKey=!0;this.layer=null;this.pointSymbol=new O({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}});this.polygonSymbol=new R({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}});this.polylineSymbol=new W({color:[130,130,130,1],width:2});this.meshSymbol=new V({symbolLayers:new m([new aa])});this.updateGraphics=new m;this.updateOnGraphicClick=!0;this.vertexSymbol=new O({style:"circle",size:6,color:[255,
255,255],outline:{color:[50,50,50],width:1}});this.sketchOptions=new M;this._originalPopupEnabled=this._viewReadyAbortController=this._moduleLoaderAbortController=null;this.defaultCreateOptions=ba;this.defaultUpdateOptions=ha;this.snappingOptions=Q?.snappingManager?.options??Q?.snappingOptions??new e}initialize(){this.addHandles([t.on(()=>this.view?.map?.layers,"change",Q=>{Q.removed.includes(this.layer)&&this.cancel()}),t.on(()=>this.layer?.graphics,"change",Q=>{if(null!=this._operationHandle)for(const X of Q.removed)this.updateGraphics.includes(X)&&
(1<this.updateGraphics.length?this._operationHandle.removeFromSelection(X):this._operationHandle.cancel())}),t.watch(()=>this.layer?.elevationInfo??null,Q=>{Q!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=Q)},t.syncAndInitial),t.watch(()=>this.view,Q=>{this._defaultSnappingManager=f.destroyMaybe(this._defaultSnappingManager);Q&&(this.snappingManager||(this._defaultSnappingManager=new h.SnappingManager({view:Q,options:this.snappingOptions})),
"2d"===Q.type?new Promise((X,ea)=>a(["../../views/2d/interactive/editingTools"],X,ea)):"3d"===Q.type&&(new Promise((X,ea)=>a(["../../views/3d/interactive/editingTools"],X,ea)),new Promise((X,ea)=>a(["../../views/3d/layers/GraphicsLayerView3D"],ia=>X(U(ia)),ea))))},t.syncAndInitial),t.watch(()=>this.view?.spatialReference,(Q,X)=>{Q&&X&&!Q.equals(X)&&this.cancel()})]);c.setupSnappingToggleHandles(this)}destroy(){this.cancel();this._removeDefaultLayer();this._defaultSnappingManager=f.destroyMaybe(this._defaultSnappingManager);
this._set("snappingManager",null);this._set("view",null);this.emit("destroy")}get updating(){return 0<this._numUpdating||null!=this.snappingManager&&this.snappingManager.updating}get activeTool(){return this._operationHandle?.tool??null}get activeTooltip(){const {activeComponent:Q,destroyed:X}=this,ea=!X&&Q&&"tooltip"in Q?Q.tooltip:null;return ea?.visible?ea:null}get activeComponent(){return this._operationHandle?.activeComponent??null}get createGraphic(){return null==this.activeComponent||"draw-3d"!==
this.activeComponent.type&&"draw-2d"!==this.activeComponent.type?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(Q){this._set("defaultCreateOptions",{...ba,...Q})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(Q){this._set("defaultUpdateOptions",{...ha,...Q,reshapeOptions:{...ha.reshapeOptions,...Q?.reshapeOptions},highlightOptions:{...ha.highlightOptions,
...Q?.highlightOptions}})}get labelOptions(){return this.sketchOptions.labels}set labelOptions(Q){this.sketchOptions.labels=Q}get snappingOptions(){return this.snappingManager?.options??this._get("snappingOptions")}set snappingOptions(Q){null!=this._defaultSnappingManager&&(this._defaultSnappingManager.options=Q);this._set("snappingOptions",Q)}get snappingManager(){this._isOverridden("snappingManager")&&this._get("snappingManager");return this._defaultSnappingManager}set snappingManager(Q){Q?(this._isOverridden("snappingManager")||
(this._defaultSnappingManager=f.destroyMaybe(this._defaultSnappingManager)),this._override("snappingManager",Q)):({view:Q}=this,!this._defaultSnappingManager&&Q&&(this._defaultSnappingManager=new h.SnappingManager({options:this.snappingOptions,view:Q})),this._clearOverride("snappingManager"))}get state(){const Q=!(!this.view?.ready||!this.layer),X=this._operationHandle;return Q&&X?"active":Q?"ready":"disabled"}get tooltipOptions(){return this.sketchOptions.tooltips}set tooltipOptions(Q){this.sketchOptions.tooltips=
Q}get valueOptions(){return this.sketchOptions.values}set valueOptions(Q){this.sketchOptions.values=Q}get view(){return this._get("view")}set view(Q){const X=this._get("view");if(X){const {container:ea,map:ia}=X;ea&&(X.cursor=null);ia?.remove(this._internalGraphicsLayer);this.removeHandles(this._viewHandlesKey);this.cancel()}this.removeHandles("view-ready");Q&&this.addHandles(t.when(()=>Q.ready,ea=>{this.removeHandles(this._viewHandlesKey);ea&&this.addHandles(this._generateViewHandles(Q),this._viewHandlesKey)},
t.syncAndInitial),"view-ready");this._set("view",Q)}cancel(){this._moduleLoaderAbortController=f.abortMaybe(this._moduleLoaderAbortController);this._viewReadyAbortController=f.abortMaybe(this._viewReadyAbortController);this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const {state:Q,updateGraphics:X}=this;if("active"===Q&&X.length){const {activeTool:ea,layer:ia}=this,na=X.toArray();ia.removeMany(na);this.cancel();this._emitDeleteEvent({graphics:na,
tool:ea})}}duplicate(){if("active"===this.state&&this.updateGraphics.length){const Q=this.updateGraphics.map(X=>X.clone()).toArray();this.layer.addMany(Q);this.emit("duplicate",{graphics:Q,type:"duplicate"});return Q}return[]}async create(Q,X){this.cancel();await this._waitViewReady();const {view:ea,layer:ia}=this;if(!ea||"disabled"===this.state)throw ia||this._logMissingLayer(),u.createAbortError();null!=ea.activeTool&&(ea.activeTool=null);if(Q){L.addUniqueLayer(ea,this._internalGraphicsLayer);var na=
await this._setupCreateOperation(Q,X);null==na||this.destroyed?ea.map.remove(this._internalGraphicsLayer):(na.on("complete",()=>{if(na===this._operationHandle){const ra=this.createGraphic,ta=this._operationHandle.cancelled;this._operationHandle.destroy();this._operationHandle=null;this._set("createGraphic",null);this.view?.map&&this.view.map.remove(this._internalGraphicsLayer);na.cancelled||null==ra||ia.add(ra);this.emit("create",{graphic:ra,state:ta?"cancel":"complete",tool:Q,toolEventInfo:null,
type:"create"})}}),this._operationHandle=na,ea.ready&&ea.focus())}else this._logError("sketch:missing-parameter","Missing parameter 'tool'.")}async place(Q,X){return this.create("mesh",{mode:"click",hasZ:Q.hasZ,geometryToPlace:Q,...X})}async update(Q,X){this.cancel();await this._waitViewReady();const {layer:ea,view:ia,state:na}=this;if(!ia||"disabled"===na)throw ea||this._logMissingLayer(),u.createAbortError();null!=ia.activeTool&&(ia.activeTool=null);const ra=Array.isArray(Q)?Q:[Q];null!=Q&&ra?.length?
ra.some(ta=>ta.layer!==ea?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):null==ta.geometry?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0):!1)||(Q=await this._setupUpdateOperation(ra,X),this.destroyed||null==Q||T(Q)||(L.addUniqueLayer(ia,this._internalGraphicsLayer),this._setUpdateOperationHandle(Q,X),this.emit("update",{graphics:ra,
state:"start",aborted:!1,tool:Q.tool,toolEventInfo:null,type:"update"}))):this._logError("sketch:missing-parameter","Missing parameter 'graphics'.")}async _updateSpatialReference(Q){const X=this.view;if(X){this._beginAsyncOperation();Q=Array.isArray(Q)?Q:[Q];for(const ea of Q)null==ea.geometry||"mesh"===ea.geometry.type||D.equals(ea.geometry.spatialReference,X.spatialReference)||(n.canProjectWithoutEngine(ea.geometry.spatialReference,X.spatialReference)||n.isLoaded()||await n.load(),ea.geometry=n.project(ea.geometry,
X.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){this.canUndo()&&this._operationHandle?.undo()}redo(){this.canRedo()&&this._operationHandle?.redo()}canUndo(){return!!this._operationHandle?.canUndo()}canRedo(){return!!this._operationHandle?.canRedo()}toggleUpdateTool(){this._operationHandle?.toggleTool()}async _getFirstHit(Q){var X=this.view;if(!X)return this._logMissingView(),null;if("2d"===X.type){const ia=[];X.map.allLayers.forEach(na=>{"vector-tile"!==na.type&&
"imagery"!==na.type||ia.push(na)});X=await X.hitTest(Q,{exclude:ia});return g.findFirstGraphicHit(X.results)}const ea=[X.map.ground];X.map.allLayers.forEach(ia=>{N.isIntegratedMeshLayer(ia.type)&&ea.push(ia)});Q=await X.hitTest(Q,{exclude:ea});if(0<Q.results.length){const ia=Q.results[0];if(null!=ia&&"graphic"===ia.type&&ia.graphic&&(!Q.ground.mapPoint||1>X.map.ground.opacity||Q.ground.distance-(ia.distance??0)>-Math.min(3*Q.ground.distance,"global"===X.viewingMode?B.getReferenceEllipsoid(X.renderCoordsHelper.spatialReference).radius/
X.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return ia}return null}_generateViewHandles(Q){return[Q.on("immediate-click",async X=>{var ea="active"===this.state&&"create"===this._operationHandle?.type;if("disabled"!==this.state&&!ea&&this.updateOnGraphicClick){this._beginAsyncOperation();var ia=await X.async(()=>this._getFirstHit(F.createScreenPointFromEvent(X)));ea=null;null!=ia?(ia=ia.graphic,this.updateGraphics.includes(ia)||ia.layer===this.layer?(X.stopPropagation(),ea=ia):"2d"!==
Q.type||this._isComponentGraphic(ia)||"active"!==this.state||this.cancel()):"active"===this.state&&this.cancel();null==ea||this.updateGraphics.includes(ea)||await this.update([ea],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}});this._endAsyncOperation()}},S.ViewEventPriorities.WIDGET)]}async _setupCreateOperation(Q,X){const ea=this.view;if(!ea)return this._logMissingView(),null;Q=await this._setupDrawGraphicTool(Q,ea,{hasZ:"3d"===ea.type,...this.defaultCreateOptions,
...X});if(null==Q)return null;ea.tools.add(Q);ea.activeTool=Q;return this._setupCreateOperationHandle(Q)}async _setupDrawGraphicTool(Q,X,ea){if("multipoint"===Q&&"3d"===X.type)return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!X)return this._logMissingView(),null;const {cursor:ia,defaultZ:na,hasZ:ra,geometryToPlace:ta,graphicProperties:pa,mode:oa,preserveAspectRatio:xa}=ea;ea="rectangle"===Q||"circle"===Q?"hybrid":"click";const ua=xa??"rectangle"!==
Q;Q={centered:"rectangle"!==Q&&!("circle"===Q&&!ua),cursor:ia,defaultZ:na,forceUniformSize:ua,graphicProperties:pa,geometryToPlace:ta,geometryType:Q,graphicSymbol:this._getGraphicSymbolFromTool(Q),hasZ:ra,mode:oa??ea,snappingManager:this.snappingManager,snapToScene:!1,view:X};return"2d"===X.type?this._makeDrawGraphicTool2D(Q):this._makeDrawGraphicTool3D(Q)}async _makeDrawGraphicTool2D(Q){const X=await this._requireModule(new Promise((ea,ia)=>a(["../../views/2d/interactive/editingTools"],ea,ia)));
return T(X)||this.destroyed?null:new X.module.DrawGraphicTool2D({...Q,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:fa(Q.geometryType)?this.activeFillSymbol:null,sketchOptions:this.sketchOptions})}async _makeDrawGraphicTool3D(Q){const X=await this._requireModule(new Promise((ia,na)=>a(["../../views/3d/interactive/editingTools"],ia,na)));if(T(X)||this.destroyed)return null;const {elevationInfo:ea}=this.layer;
return new X.module.DrawGraphicTool3D({...Q,elevationInfo:ea,snapToScene:!0,sketchOptions:this.sketchOptions})}_setupCreateOperationHandle(Q){const X=this.view;if(!X)return this._logMissingView(),null;let ea=null;const ia=Q.forceUniformSize,na=Q.centered,ra=[X.on("key-down",pa=>{if(pa.key===r.sketchKeys.pan)pa.stopPropagation(),pa.repeat||(Q.enabled=!1);else if(pa.key===r.sketchKeys.complete)pa.stopPropagation(),Q.completeCreateOperation();else if(pa.key!==r.sketchKeys.vertexAdd||pa.repeat)pa.key===
r.sketchKeys.undo?(pa.stopPropagation(),ta.undo()):pa.key===r.sketchKeys.redo?(pa.stopPropagation(),ta.redo()):pa.key!==r.sketchKeys.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType||pa.repeat?pa.key!==r.sketchKeys.center||pa.repeat||(Q.centered=!na,pa.stopPropagation()):(Q.forceUniformSize=!ia,pa.stopPropagation());else{const oa=Q.drawOperation.geometryType;if("polyline"===oa||"polygon"===oa||"multipoint"===oa)pa.stopPropagation(),Q.drawOperation.commitStagedVertex()}},S.ViewEventPriorities.WIDGET),
X.on("key-up",pa=>{pa.key===r.sketchKeys.pan?Q.enabled=!0:pa.key!==r.sketchKeys.constraint||"rectangle"!==Q.geometryType&&"circle"!==Q.geometryType?pa.key===r.sketchKeys.center&&(Q.centered=na,pa.stopPropagation()):(Q.forceUniformSize=ia,pa.stopPropagation())},S.ViewEventPriorities.WIDGET),Q.on("vertex-add",pa=>{ea=null==ea?"start":"active";switch(pa.operation){case "apply":this.emit("create",{graphic:Q.graphic,state:ea,tool:this.activeTool,toolEventInfo:pa,type:"create"});break;case "undo":this._emitUndoEvent({graphics:[Q.graphic],
tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[Q.graphic],tool:Q.geometryType})}}),Q.on("cursor-update",pa=>{0<Q.drawOperation.numCommittedVertices&&this.emit("create",{graphic:Q.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:pa.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),Q.on("vertex-remove",pa=>{switch(pa.operation){case "apply":this.emit("create",{graphic:Q.graphic,state:"active",tool:this.activeTool,toolEventInfo:pa,type:"create"});
break;case "undo":this._emitUndoEvent({graphics:[Q.graphic],tool:Q.geometryType});break;case "redo":this._emitRedoEvent({graphics:[Q.graphic],tool:Q.geometryType})}}),Q.on("complete",pa=>{this._set("createGraphic",pa.graphic);ea="complete";pa.aborted?ta&&ta.cancel():ta&&ta.complete()}),t.watch(()=>this._getGraphicSymbolFromTool(Q.geometryType),pa=>{Q.graphicSymbol=pa})],ta=new I.CreateOperationHandle({activeComponent:Q,tool:Q.geometryType,type:"create",onEnd:()=>{k.drainHandles(ra);X.tools?.remove(Q)},
undo:()=>{Q.canUndo&&Q.undo()},redo:()=>{Q.canRedo&&Q.redo()},canUndo:()=>Q.canUndo,canRedo:()=>Q.canRedo});return ta}_getGraphicSymbolFromTool(Q){switch(Q){case "point":case "multipoint":return this.pointSymbol;case "polyline":return this.polylineSymbol;case "circle":case "rectangle":case "polygon":return this.polygonSymbol;case "mesh":return this.meshSymbol}}async _setupUpdateOperation(Q,X){const {layer:ea,view:ia}=this;if(!ia)return this._logMissingView(),null;X={...this.defaultUpdateOptions,...X,
reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...X?.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...X?.highlightOptions}};let na=X.tool??ha.tool;for(var ra of Q)ea.remove(ra),ea.add(ra);if("3d"===ia.type){if(0===Q.length)return null;switch(na){case "move":return this._setupMove3DOperation(Q,X,ia,na);case "reshape":return 1<Q.length?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupReshape3DOperation(Q[0],
X,ia);case "transform":return this._setupGraphicTransform3DOperation(Q,X,ia)}}switch(na){case "move":return this._setupMove2DOperation(Q,X,ia);case "reshape":return 1<Q.length?(this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null):this._setupTransformOrReshape2DOperation(Q,na,X,ia);case "transform":return 1===Q.length&&(ra=Q[0].geometry?.type,"point"===ra||"multipoint"===ra)&&(na="reshape"),this._setupTransformOrReshape2DOperation(Q,na,X,ia)}}async _setupMove3DOperation(Q,
X,ea,ia,na=!1){var ra=await this._requireModule(new Promise((va,Y)=>a(["../../views/3d/interactive/editingTools"],va,Y)));if(T(ra))return ra;const {ManipulatedObject3DGraphic:ta,MoveTool3D:pa}=ra.module,oa=new Map,xa=()=>{oa.forEach(va=>va.destroy());oa.clear()};for(const va of Q){ra=new ta({view:ea,graphic:va});const Y=P.isSupportedObject(ra);if(Y!==G.SupportedObjectResult.SUPPORTED)return xa(),this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${G.isSupportedObjectResultMessage(Y)}).`),
null;oa.set(va,ra)}const ua=new pa({view:ea,enableZ:X.enableZ,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});ea.tools.add(ua);ua.objects.addMany(Array.from(oa.values()));na||this.updateGraphics.addMany(Q);const za=[],ya=new I.UpdateOperationHandle({activeComponent:ua,tool:ia,type:"update",onEnd:()=>{k.drainHandles(za);la(ea,ua);xa()},undo:()=>{var va=this.view;null!=va&&ua.hasGrabbedManipulators&&(va.activeTool=null);ja(ya,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),
tool:ia})},redo:()=>{da(ya,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:ia})},addToSelection:va=>{this.updateGraphics.push(va);const Y=new ta({view:ea,graphic:va});oa.set(va,Y);ua.objects.push(Y);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[va],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:va=>{const Y=this.updateGraphics.indexOf(va);ya.history.undo.forEach(qa=>
qa.updates.splice(Y,1));ya.history.redo.forEach(qa=>qa.updates.splice(Y,1));this.updateGraphics.remove(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[va],type:"selection-change"},type:"update"});if(0===this.updateGraphics.length)ya.complete();else{var ca=oa.get(va);ca&&(ua.objects.remove(ca),ca.destroy(),oa.delete(va))}},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==X.toggleToolOnClick&&
"transform"===ia){var va=this.updateGraphics.at(0);(va=await this._setupReshape3DOperation(va,X,ea,!0))&&!T(va)&&(ya.onEnd(),ya.destroy(),this._setUpdateOperationHandle(va,X))}}});za.push(...this._getHandlesForComponent(ya,X),ea.on("immediate-click",va=>this._getCommonUpdateOperationClickHandlers(ya,va,X),S.ViewEventPriorities.WIDGET),ea.on("key-down",va=>{this._getCommonUpdateOperationKeyDownHandlers(ya,va)},S.ViewEventPriorities.WIDGET));return ya}_setupGraphicTransform3DOperation(Q,X,ea,ia=!1){if(1===
Q.length&&C.isSupportedGraphic(Q[0])===G.SupportedObjectResult.SUPPORTED){const na=Q[0],ra=na.geometry;if(null!=ra&&("point"===ra.type||"mesh"===ra.type))return this._setupPointTransform3DOperation(na,X,ea);if(null!=ra&&("polygon"===ra.type||"polyline"===ra.type))return this._setupPolyTransform3DOperation(na,X,ea,ia)}return this._setupMove3DOperation(Q,X,ea,"transform",ia)}async _setupPointTransform3DOperation(Q,X,ea){const {enableRotation:ia,enableScaling:na,enableZ:ra}=X,ta=await this._requireModule(new Promise((va,
Y)=>a(["../../views/3d/interactive/editingTools"],va,Y)));if(T(ta))return ta;const {TransformTool3D:pa,ManipulatedObject3DGraphic:oa}=ta.module,xa=new oa({graphic:Q,view:ea}),ua=new pa({object:xa,view:ea,enableRotation:ia,enableScaling:na,enableZ:ra,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});ea.tools.add(ua);this.updateGraphics.add(Q);const za=[],ya=new I.UpdateOperationHandle({activeComponent:ua,tool:"transform",type:"update",onEnd:()=>{k.drainHandles(za);la(ea,ua);xa.destroy()},
undo:()=>{var va=this.view;null!=va&&ua.hasGrabbedManipulators&&(va.activeTool=null);ja(ya,this.updateGraphics.toArray());this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},redo:()=>{da(ya,this.updateGraphics.toArray());this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"})},addToSelection:async va=>{this.updateGraphics.add(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[va],
removed:[],type:"selection-change"},type:"update"});ya.onEnd();ya.destroy();va=await this._setupMove3DOperation(this.updateGraphics.toArray(),X,ea,"transform",!0);T(va)||this._setUpdateOperationHandle(va,X)},removeFromSelection:va=>{this.updateGraphics.remove(va);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[va],type:"selection-change"},type:"update"});ya.complete()},toggleTool:()=>{}});za.push(...this._getHandlesForComponent(ya,
X),ea.on("immediate-click",va=>this._getCommonUpdateOperationClickHandlers(ya,va,X),S.ViewEventPriorities.WIDGET),ea.on("key-down",va=>{this._getCommonUpdateOperationKeyDownHandlers(ya,va)},S.ViewEventPriorities.WIDGET));return ya}async _setupPolyTransform3DOperation(Q,X,ea,ia=!1){const {enableRotation:na,enableScaling:ra,enableZ:ta,preserveAspectRatio:pa}=X;var oa=await this._requireModule(new Promise((ca,qa)=>a(["../../views/3d/interactive/editingTools"],ca,qa)));if(T(oa))return oa;const {ManipulatedObject3DGraphic:xa,
ExtentTransformTool:ua}=oa.module;oa=this.view?.inputManager?.isModifierKeyDown(r.sketchKeys.constraint);const za=new xa({view:ea,graphic:Q}),ya=new ua({object:za,view:ea,enableRotation:na,enableScaling:ra,enableZ:ta,preserveAspectRatio:!!pa!==!!oa,sketchOptions:this.sketchOptions});ea.tools.add(ya);ia||this.updateGraphics.add(Q);const va=[],Y=new I.UpdateOperationHandle({activeComponent:ya,tool:"transform",type:"update",onEnd:()=>{k.drainHandles(va);la(ea,ya);za.destroy()},canUndo:()=>!ya.destroyed&&
ya.canUndo,undo:()=>{ya.destroyed||(ya.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"}))},canRedo:()=>!ya.destroyed&&ya.canRedo,redo:()=>{ya.destroyed||(ya.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"transform"}))},addToSelection:async ca=>{this.updateGraphics.add(ca);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[ca],removed:[],type:"selection-change"},
type:"update"});Y.onEnd();Y.destroy();ca=await this._setupMove3DOperation(this.updateGraphics.toArray(),X,ea,"transform",!0);T(ca)||this._setUpdateOperationHandle(ca,X)},removeFromSelection:ca=>{this.updateGraphics.remove(ca);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[ca],type:"selection-change"},type:"update"});Y.complete()},toggleTool:async()=>{if(1===this.updateGraphics.length&&!1!==X.toggleToolOnClick){var ca=
await this._setupReshape3DOperation(Q,X,ea,!0);ca&&!T(ca)&&(Y.onEnd(),Y.destroy(),this._setUpdateOperationHandle(ca,X))}}});va.push(...this._getHandlesForComponent(Y,X),ea.on("immediate-click",ca=>this._getCommonUpdateOperationClickHandlers(Y,ca,X),S.ViewEventPriorities.WIDGET),ea.on("key-down",ca=>this._getCommonUpdateOperationKeyDownHandlers(Y,ca),S.ViewEventPriorities.WIDGET),ea.on("key-down",ca=>{ca.key!==r.sketchKeys.constraint||ca.repeat||(ya.preserveAspectRatio=!ya.preserveAspectRatio,ca.stopPropagation())},
S.ViewEventPriorities.WIDGET),ea.on("key-up",ca=>{ca.key===r.sketchKeys.constraint&&(ya.preserveAspectRatio=!ya.preserveAspectRatio,ca.stopPropagation())},S.ViewEventPriorities.WIDGET));return Y}async _setupMove2DOperation(Q,X,ea){this.updateGraphics.addMany(Q);await this._updateSpatialReference(Q);const ia=await this._getGraphicMover(Q,X,ea);if(T(ia))return ia;const na=new I.UpdateOperationHandle({activeComponent:ia,tool:"move",type:"update",onEnd:()=>{this._displayDefaultCursor();k.drainHandles(pa);
k.drainHandles(ta);ia.destroy();this._internalGraphicsLayer?.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const oa=this.updateGraphics.toArray();ja(na,oa);na.refreshComponent();this._emitUndoEvent({graphics:oa,tool:"move"})},redo:()=>{const oa=this.updateGraphics.toArray();da(na,oa);na.refreshComponent();this._emitRedoEvent({graphics:oa,tool:"move"})},addToSelection:async oa=>{await this._updateSpatialReference(oa);this.updateGraphics.push(oa);ia.graphics=this.updateGraphics.toArray();
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[oa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:oa=>{const xa=this.updateGraphics.indexOf(oa);na.history.undo.forEach(za=>za.updates.splice(xa,1));na.history.redo.forEach(za=>za.updates.splice(xa,1));this.updateGraphics.remove(oa);const ua=this.updateGraphics.toArray();this.emit("update",{graphics:ua,state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{added:[],removed:[oa],type:"selection-change"},type:"update"});0===this.updateGraphics.length?na.complete():ia.graphics=ua}});let ra=!1;const ta=[ea.on("immediate-click",oa=>this._getCommonUpdateOperationClickHandlers(na,oa,X),S.ViewEventPriorities.WIDGET),ea.on("key-down",oa=>{this._getCommonUpdateOperationKeyDownHandlers(na,oa);oa.key!==r.sketchKeys.constraint||oa.repeat||(ra=!0,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET),ea.on("key-up",oa=>
{oa.key===r.sketchKeys.constraint&&ra&&(ra=!1,ia.enableMoveAllGraphics=!ia.enableMoveAllGraphics)},S.ViewEventPriorities.WIDGET)],pa=this._getHandlesForComponent(na,X);return na}async _setupReshape3DOperation(Q,X,ea,ia=!1){const na=await this._requireModule(new Promise((za,ya)=>a(["../../views/3d/interactive/editingTools"],za,ya)));if(T(na))return na;const {ManipulatedObject3DGraphic:ra,ReshapeTool3D:ta}=na.module,pa=new ra({view:ea,graphic:Q});Q=z.isSupportedObject(pa);if(Q!==G.SupportedObjectResult.SUPPORTED)return pa.destroy(),
this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${G.isSupportedObjectResultMessage(Q)}).`),null;Q=X.reshapeOptions;const oa=new ta({view:ea,object:pa,enableZVertex:X.enableZ&&"move"===Q?.vertexOperation,enableZShape:X.enableZ&&"move"===Q?.shapeOperation,enableMoveObject:"move"===Q?.shapeOperation||"move-xy"===Q?.shapeOperation,enableMidpoints:"split"===Q?.edgeOperation,enableEdgeOffset:"offset"===Q?.edgeOperation,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions});
ea.tools.add(oa);ia||this.updateGraphics.add(pa.graphic);const xa=[],ua=new I.UpdateOperationHandle({activeComponent:oa,tool:"reshape",type:"update",onEnd:()=>{k.drainHandles(xa);la(ea,oa);pa.destroy()},canUndo:()=>!oa.destroyed&&oa.canUndo,undo:()=>{oa.destroyed||(oa.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"}))},canRedo:()=>!oa.destroyed&&oa.canRedo,redo:()=>{oa.destroyed||(oa.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:"reshape"}))},
addToSelection:async za=>{this.updateGraphics.add(za);this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[za],removed:[],type:"selection-change"},type:"update"});ua.onEnd();ua.destroy();za=await this._setupMove3DOperation(this.updateGraphics.toArray(),X,ea,"transform",!0);T(za)||this._setUpdateOperationHandle(za,X)},removeFromSelection:za=>{this.updateGraphics.remove(za);this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[za],type:"selection-change"},type:"update"});ua.complete()},toggleTool:async()=>{if(!1!==X.toggleToolOnClick){ua.onEnd();ua.destroy();var za=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),X,ea,!0);T(za)||this._setUpdateOperationHandle(za,X)}}});xa.push(...this._getHandlesForComponent(ua,X),ea.on("immediate-click",za=>this._getCommonUpdateOperationClickHandlers(ua,za,X),S.ViewEventPriorities.WIDGET),
ea.on("key-down",za=>{this._getCommonUpdateOperationKeyDownHandlers(ua,za)},S.ViewEventPriorities.WIDGET));return ua}async _setupTransformOrReshape2DOperation(Q,X,ea,ia){this.updateGraphics.addMany(Q);await this._updateSpatialReference(Q);Q="transform"===X?await this._getBox(Q,ea,ia):await this._getReshape(Q,ea,ia);if(T(Q))return Q;const na=new I.UpdateOperationHandle({activeComponent:Q,type:"update",onEnd:()=>{k.drainHandles(ta);k.drainHandles(ra);na.activeComponent&&!na.activeComponent.destroyed&&
na.activeComponent.destroy();this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{ja(na,this.updateGraphics.toArray());na.refreshComponent();this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:na.tool})},redo:()=>{da(na,this.updateGraphics.toArray());na.refreshComponent();this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:na.tool})},addToSelection:async pa=>{var oa=na.activeComponent;if("reshape"===oa?.type){oa=[...this.updateGraphics,pa];this.updateGraphics.removeAll();
na.onEnd();na.destroy();oa=await this._setupTransformOrReshape2DOperation(oa,"transform",ea,ia);if(T(oa))return;this._setUpdateOperationHandle(oa,ea)}else this.updateGraphics.add(pa),oa.graphics=this.updateGraphics.toArray(),oa.refresh(),na.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[pa],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async pa=>{const oa=this.updateGraphics.indexOf(pa);
na.history.undo.forEach(ua=>ua.updates.splice(oa,1));na.history.redo.forEach(ua=>ua.updates.splice(oa,1));this.updateGraphics.remove(pa);const xa=this.updateGraphics.toArray();if(0===xa.length)na.complete();else{const ua=xa[0].geometry;1!==xa.length||null==ua||"point"!==ua.type&&"multipoint"!==ua.type?na.activeComponent.graphics=xa:na.toggleTool()}this.emit("update",{graphics:xa,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[pa],type:"selection-change"},type:"update"})},
toggleTool:async()=>{if(!(1<this.updateGraphics.length)){var pa=this.updateGraphics.at(0),oa=pa.geometry;if(null==oa||("reshape"!==na.tool||"point"!==oa.type&&"multipoint"!==oa.type)&&("transform"!==na.tool||"extent"!==oa.type))oa=null,"transform"===na.tool?oa=await this._getReshape([pa],ea,ia):"reshape"===na.tool&&(oa=await this._getBox([pa],ea,ia)),T(oa)||(na.activeComponent?.destroy(),na.activeComponent=oa,na.activeComponent&&(k.drainHandles(ta),ta=this._getHandlesForComponent(na,ea)))}}}),ra=
[ia.on("immediate-click",pa=>this._getCommonUpdateOperationClickHandlers(na,pa,ea),S.ViewEventPriorities.WIDGET),ia.on("key-down",pa=>{this._getCommonUpdateOperationKeyDownHandlers(na,pa);pa.key===r.sketchKeys.constraint&&!pa.repeat&&na&&(pa=na.activeComponent)&&"box"===pa.type&&(pa.preserveAspectRatio=!pa.preserveAspectRatio)},S.ViewEventPriorities.WIDGET),ia.on("key-up",pa=>{pa.key===r.sketchKeys.constraint&&na&&(pa=na.activeComponent)&&"box"===pa.type&&(pa.preserveAspectRatio=!pa.preserveAspectRatio)},
S.ViewEventPriorities.WIDGET)];let ta=this._getHandlesForComponent(na,ea);return na}async _getGraphicMover(Q,X,ea){const {enableMoveAllGraphics:ia,highlightOptions:na}=X;X=await this._requireModule(new Promise((ra,ta)=>a(["../../views/draw/support/GraphicMover"],pa=>ra(U(pa)),ta)));return T(X)?X:new X.module.default({enableMoveAllGraphics:ia,highlightsEnabled:!!na?.enabled,indicatorsEnabled:!1,graphics:Q,view:ea,callbacks:{onGraphicMoveStart:({dx:ra,dy:ta,graphic:pa})=>{this._displayGrabbingCursor();
this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:ta,mover:pa,type:"move-start"},type:"update"})},onGraphicMove:({dx:ra,dy:ta,graphic:pa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:ta,mover:pa,type:"move"},type:"update"}),onGraphicMoveStop:({dx:ra,dy:ta,graphic:pa})=>{this._displayPointerCursor();this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ra,dy:ta,mover:pa,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(Q,X,ea){const {enableRotation:ia,enableScaling:na,highlightOptions:ra,preserveAspectRatio:ta}=X;X=await this._requireModule(new Promise((oa,xa)=>a(["../../views/draw/support/Box"],ua=>oa(U(ua)),xa)));if(T(X))return X;const pa=this.view?.inputManager?.isModifierKeyDown(r.sketchKeys.constraint);
return new X.module.default({graphics:Q,enableRotation:ia,enableScaling:na,highlightsEnabled:!!ra?.enabled,preserveAspectRatio:!!ta!==!!pa,layer:this._internalGraphicsLayer,view:ea,sketchOptions:this.sketchOptions,callbacks:{onMoveStart:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onMove:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,
toolEventInfo:{...oa},type:"update"}),onMoveStop:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onScaleStart:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onScale:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),
onScaleStop:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onRotateStart:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onRotate:oa=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"}),onRotateStop:oa=>this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...oa},type:"update"})}})}async _getReshape(Q,X,ea){const ia="split"===X.reshapeOptions?.edgeOperation,na="move"===X.reshapeOptions?.shapeOperation;X=!!X.highlightOptions?.enabled;const ra=await this._requireModule(new Promise((ta,pa)=>a(["../../views/draw/support/Reshape"],oa=>ta(U(oa)),pa)));return T(ra)?ra:new ra.module.default({enableMidpoints:ia,enableMovement:na,graphic:Q[0],highlightsEnabled:X,
layer:this._internalGraphicsLayer,snappingManager:this.snappingManager,sketchOptions:this.sketchOptions,view:ea,callbacks:{onReshapeStart:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onReshape:ta=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ta},type:"update"}),onReshapeStop:({mover:ta,type:pa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ta,type:pa},type:"update"}),onMoveStart:({dx:ta,dy:pa,mover:oa,type:xa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ta,dy:pa,mover:oa,type:xa},type:"update"}),onMove:({dx:ta,dy:pa,mover:oa,type:xa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ta,dy:pa,mover:oa,type:xa},
type:"update"}),onMoveStop:({dx:ta,dy:pa,mover:oa,type:xa})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ta,dy:pa,mover:oa,type:xa},type:"update"}),onVertexAdd:({added:ta,type:pa,vertices:oa})=>{ta=ta.map(xa=>w.geometryToCoordinates(xa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:ta,vertices:oa,type:pa},type:"update"})},onVertexRemove:({removed:ta,
type:pa,vertices:oa})=>{ta=ta.map(xa=>w.geometryToCoordinates(xa.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:ta,vertices:oa,type:pa},type:"update"})}}})}_getHandlesForComponent(Q,X){const ea=Q.activeComponent;if(!ea)return[];switch(ea.type){case "graphic-mover":return[ea.on("graphic-click",({graphic:ia,viewEvent:na})=>{na.native?.shiftKey&&(na.stopPropagation(),Q.removeFromSelection(ia))}),ea.on("graphic-move-start",
ia=>Q.addToHistory(ka(ia.allGraphics)))];case "box":return[ea.on("graphic-click",ia=>this._onTransformOrReshape2DGraphicClick(Q,X,ia)),ea.on("move-start",ia=>Q.addToHistory(ka(ia.graphics))),ea.on("rotate-start",ia=>Q.addToHistory(ka(ia.graphics))),ea.on("scale-start",ia=>Q.addToHistory(ka(ia.graphics)))];case "reshape":return[ea.on("graphic-click",ia=>this._onTransformOrReshape2DGraphicClick(Q,X,ia)),ea.on("move-start",ia=>Q.addToHistory(ka([ia.mover]))),ea.on("reshape-start",ia=>Q.addToHistory(ka([ia.graphic]))),
ea.on("vertex-add",ia=>Q.addToHistory(ka([ia.oldGraphic]))),ea.on("vertex-remove",ia=>Q.addToHistory(ka([ia.oldGraphic])))];case "move-3d":return[ea.events.on("record-undo",({updates:ia})=>{Q.addToHistory({updates:ia})}),ea.events.on("move-start",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ia.objects.length?ia.objects[0].graphic:null,type:"move-start"},type:"update"})}),ea.events.on("move",ia=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:ia.dx,dy:ia.dy,mover:0<ia.objects.length?ia.objects[0].graphic:null,type:"move"},type:"update"})}),ea.events.on("move-stop",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:0<ia.objects.length?ia.objects[0].graphic:null,type:"move-stop"},type:"update"})}),ea.events.on("immediate-click",ia=>{ia.shiftKey?
this._toggleSelection([ia.object.graphic],Q,X):Q.toggleTool()})];case "transform-3d":return[ea.events.on("record-undo",({updates:ia})=>{Q.addToHistory({updates:ia})}),ea.events.on("translate-start",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,dx:ia.dxScreen,dy:ia.dyScreen,type:"move-start"},type:"update"})}),ea.events.on("translate-stop",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),
state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,dx:ia.dxScreen,dy:ia.dyScreen,type:"move-stop"},type:"update"})}),ea.events.on("rotate-start",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,angle:ia.angle,type:"rotate-start"},type:"update"})}),ea.events.on("rotate-stop",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,angle:ia.angle,type:"rotate-stop"},type:"update"})}),ea.events.on("scale-start",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,xScale:ia.xScale,yScale:ia.yScale,type:"scale-start"},type:"update"})}),ea.events.on("scale-stop",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,
xScale:ia.xScale,yScale:ia.yScale,type:"scale-stop"},type:"update"})}),ea.events.on("translate",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,dx:ia.dxScreen,dy:ia.dyScreen,type:"move"},type:"update"})}),ea.events.on("rotate",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,angle:ia.angle,type:"rotate"},
type:"update"})}),ea.events.on("scale",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:ia.object.graphic,xScale:ia.xScale,yScale:ia.yScale,type:"scale"},type:"update"})}),ea.events.on("immediate-click",ia=>{ia.shiftKey?this._toggleSelection([ia.object.graphic],Q,X):Q.toggleTool()})];case "reshape-3d":return[ea.events.on("reshape",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,
tool:this.activeTool,toolEventInfo:{...ia,mover:ia.object.graphic},type:"update"})}),ea.events.on("move",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...ia,mover:ia.object.graphic},type:"update"})}),ea.events.on("vertex-add",ia=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ia,type:"update"})}),ea.events.on("vertex-remove",ia=>{this.emit("update",
{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:ia,type:"update"})}),ea.events.on("immediate-click",ia=>{ia.shiftKey?this._toggleSelection([ia.object.graphic],Q,X):Q.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(Q,X,ea){const {graphic:ia,viewEvent:na}=ea;if(na.native?.shiftKey&&ia.layer===this.layer)return na.stopPropagation(),Q.removeFromSelection(ia);if(X.toggleToolOnClick)return na.stopPropagation(),Q.toggleTool()}_setUpdateOperationHandle(Q,
X){this._operationHandle=Q;const ea=this.view?.map;this._disablePopup(X);Q.on("complete",()=>{if(Q===this._operationHandle){const ia=this.updateGraphics.toArray(),na=this._operationHandle.tool;this._operationHandle.destroy();this._operationHandle=null;this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray());this.updateGraphics.removeAll();ea&&ea.remove(this._internalGraphicsLayer);this._restorePopup(X);this.emit("update",{graphics:ia,state:"complete",aborted:Q.cancelled,tool:na,toolEventInfo:null,
type:"update"})}})}async _getCommonUpdateOperationClickHandlers(Q,X,ea){const ia=F.createScreenPointFromEvent(X),na=await X.async(()=>this._getFirstHit(ia));null==na?Q.complete():X.native.shiftKey&&this._toggleSelection([na.graphic],Q,ea)?X.stopPropagation():this.updateGraphics.includes(na.graphic)?X.stopPropagation():Q.complete()}_toggleSelection(Q,X,ea){const ia=!!ea.multipleSelectionEnabled;return Q.some(na=>null==na?!1:ia&&na.layer===this.layer?(this.updateGraphics.includes(na)?X.removeFromSelection(na):
X.addToSelection(na),!0):!1)}_getCommonUpdateOperationKeyDownHandlers(Q,X){if(Q){var ea=X.key;ea===r.sketchKeys.undo&&Q.canUndo()?(X.stopPropagation(),Q.undo()):ea===r.sketchKeys.redo&&Q.canRedo()?(X.stopPropagation(),Q.redo()):ea===r.sketchKeys.cancel?(X.stopPropagation(),Q.cancel()):this.allowDeleteKey&&r.sketchKeys.delete.includes(ea)&&this._onDeleteKey(X)}}_onDeleteKey(Q){if(this._operationHandle&&"update"===this._operationHandle.type){var X=this.activeComponent,ea=this.updateGraphics.toArray();
null!=X&&("reshape"!==X.type||1===ea.length&&"point"===ea[0].geometry?.type)&&(Q.stopPropagation(),this.delete())}}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view?.map?.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=f.destroyMaybe(this._internalGraphicsLayer))}_isComponentGraphic(Q){const {activeComponent:X}=this;return Q&&null!=X?Q.attributes?.esriSketchTool||"draw-2d"===X.type&&X.graphic===Q||("box"===X.type||"reshape"===X.type)&&X.isUIGraphic(Q):!1}_displayPointerCursor(){this.view?.container&&
"pointer"!==this.view.cursor&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view?.container&&"grabbing"!==this.view.cursor&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view?.container&&null!==this.view.cursor&&(this.view.cursor=null)}_logError(Q,X,ea){q.getLogger(this).error(new p(Q,X,ea))}async _requireModule(Q){const X=new AbortController;this._moduleLoaderAbortController=X;Q=await Q;return this._moduleLoaderAbortController!==X||X.signal.aborted?{requireError:"aborted"}:
{module:Q}}_emitUndoEvent(Q){this.emit("undo",{...Q,type:"undo"})}_emitRedoEvent(Q){this.emit("redo",{...Q,type:"redo"})}_emitDeleteEvent(Q){this.emit("delete",{...Q,type:"delete"})}get test(){}wait(){return t.whenOnce(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1;this.notifyChange("updating")}_endAsyncOperation(){--this._numUpdating;this.notifyChange("updating")}_disablePopupEnabled(Q){return"3d"!==this.view?.type||this.updateOnGraphicClick||(Q?.toggleToolOnClick??!1)}_disablePopup(Q){this._disablePopupEnabled(Q)&&
this.view&&null==this._originalPopupEnabled&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(Q){this._disablePopupEnabled(Q)&&this.view&&null!=this._originalPopupEnabled&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const Q=this.view;Q?(f.abortMaybe(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await u.whenOrAbort(t.whenOnce(()=>Q?.ready),this._viewReadyAbortController.signal)):
this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",ma("view"))}_logMissingLayer(){this._logError("sketch:missing-property",ma("layer"))}};b.__decorate([A.property()],l.prototype,"_defaultSnappingManager",void 0);b.__decorate([A.property()],l.prototype,"updating",null);b.__decorate([A.property()],l.prototype,"_operationHandle",void 0);b.__decorate([A.property({readOnly:!0})],l.prototype,"activeTool",null);b.__decorate([A.property()],l.prototype,"activeTooltip",null);
b.__decorate([A.property()],l.prototype,"activeFillSymbol",void 0);b.__decorate([A.property()],l.prototype,"activeLineSymbol",void 0);b.__decorate([A.property()],l.prototype,"activeVertexSymbol",void 0);b.__decorate([A.property()],l.prototype,"allowDeleteKey",void 0);b.__decorate([A.property({readOnly:!0})],l.prototype,"createGraphic",null);b.__decorate([A.property()],l.prototype,"defaultCreateOptions",null);b.__decorate([A.property()],l.prototype,"defaultUpdateOptions",null);b.__decorate([A.property({type:J,
nonNullable:!0})],l.prototype,"labelOptions",null);b.__decorate([A.property()],l.prototype,"layer",void 0);b.__decorate([A.property({types:d.symbolTypes})],l.prototype,"pointSymbol",void 0);b.__decorate([A.property({types:d.symbolTypes})],l.prototype,"polygonSymbol",void 0);b.__decorate([A.property({types:d.symbolTypes})],l.prototype,"polylineSymbol",void 0);b.__decorate([A.property()],l.prototype,"meshSymbol",void 0);b.__decorate([A.property({type:e,nonNullable:!0})],l.prototype,"snappingOptions",
null);b.__decorate([A.property()],l.prototype,"snappingManager",null);b.__decorate([A.property({readOnly:!0})],l.prototype,"state",null);b.__decorate([A.property({type:y,nonNullable:!0})],l.prototype,"tooltipOptions",null);b.__decorate([A.property({readOnly:!0})],l.prototype,"updateGraphics",void 0);b.__decorate([A.property()],l.prototype,"updateOnGraphicClick",void 0);b.__decorate([A.property({type:H,nonNullable:!0})],l.prototype,"valueOptions",null);b.__decorate([A.property({types:d.symbolTypes})],
l.prototype,"vertexSymbol",void 0);b.__decorate([A.property({value:null})],l.prototype,"view",null);b.__decorate([A.property({constructOnly:!0,type:M})],l.prototype,"sketchOptions",void 0);l=b.__decorate([v.subclass("esri.widgets.Sketch.SketchViewModel")],l);const ma=Q=>`Property '${Q}' is missing on SketchViewModel.`;return l})},"esri/views/3d/interactive/editingTools/isSupportedObjectUtils":function(){define(["exports","../../../../core/has"],function(a,b){a.SupportedObjectResult=void 0;(function(d){d[d.SUPPORTED=
0]="SUPPORTED";d[d.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";d[d.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";d[d.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";d[d.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";d[d.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedObjectResult||(a.SupportedObjectResult={}));a.isSupportedObjectResultMessage=function(d){switch(d){case a.SupportedObjectResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case a.SupportedObjectResult.GEOMETRY_MISSING:return"no geometry";
case a.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedObjectResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/move/isSupportedObject":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils",
"../isSupportedObjectUtils"],function(a,b,d,m){a.isSupportedObject=function(p){if(p.graphic&&"graphics"!==p.graphic.layer?.type)return m.SupportedObjectResult.GRAPHICS_LAYER_MISSING;const l=p.operations?.data.type;if(!l)return m.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED;switch(l){case "polygon":case "point":case "polyline":case "mesh":break;default:return m.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}return d.hasEffectiveFeatureExpressionInfo(p.elevationInfo)?m.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:
m.SupportedObjectResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/isSupportedObject":function(){define(["exports","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,d){function m(p){if(p.graphic&&"graphics"!==p.graphic.layer?.type)return{result:d.SupportedObjectResult.GRAPHICS_LAYER_MISSING};if(!p.operations)return{result:d.SupportedObjectResult.GEOMETRY_MISSING};if(b.hasEffectiveFeatureExpressionInfo(p.elevationInfo))return{result:d.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED};
const l=p.operations.data.type;p=p.operations.data.geometry;return"point"===l||"mesh"===l||"polyline"===l||"polygon"===l?{result:d.SupportedObjectResult.SUPPORTED,geometry:p}:{result:d.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}}a.geometryOfSupportedObject=function(p){return m(p).geometry};a.isSupportedObject=function(p){return m(p).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/isSupportedGraphic":function(){define(["exports",
"../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,d,m){a.isSupportedGraphic=function(p){if("graphics"!==p.layer?.type)return m.SupportedObjectResult.GRAPHICS_LAYER_MISSING;if(null==p.geometry)return m.SupportedObjectResult.GEOMETRY_MISSING;switch(p.geometry.type){case "point":break;case "polygon":case "polyline":case "multipoint":case "extent":case "mesh":return m.SupportedObjectResult.SUPPORTED;default:return m.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}const l=
null!=p.symbol&&"point-3d"===p.symbol.type&&p.symbol.symbolLayers;return l&&l.some(k=>"object"===k.type)?"on-the-ground"!==d.getGraphicEffectiveElevationMode(p)&&d.hasGraphicFeatureExpressionInfo(p)?m.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:m.SupportedObjectResult.SUPPORTED:m.SupportedObjectResult.SYMBOL_TYPE_UNSUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/layerUtils":function(){define(["exports"],function(a){a.addUniqueLayer=function(b,
d,m){if(d&&b?.map){({map:b}=b);var p=b.layers.find(l=>l===d);p||b.add(d,m);p&&null!=m&&b.layers.reorder(p,m)}};a.findLayerView=function(b,d){const m="subtype-sublayer"===d?.type?d.parent:d;return b.allLayerViews.find(p=>{p=p.layer;return p===m||"sublayers"in p&&null!=p.sublayers&&p.sublayers.includes(m)})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Sketch/support/OperationHandle":function(){define("exports ../../../chunks/tslib.es6 ../../../core/compilerUtils ../../../core/Evented ../../../core/accessorSupport/decorators/property ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k,E){a.OperationHandle=class extends m.EventedAccessor{constructor(q){super(q);this.cancelled=!1;this.history={undo:[],redo:[]};this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case "graphic-mover":case "move-3d":return"move";case "box":case "transform-3d":return"transform";case "reshape":case "reshape-3d":return"reshape";case "draw-2d":case "draw-3d":return this.activeComponent.geometryType;default:d.neverReached(this.activeComponent)}return null}addToHistory(q){this.history.redo=
[];this.history.undo.push(q)}resetHistory(){this.history.redo=[];this.history.undo=[]}canUndo(){return 0<this.history.undo.length}canRedo(){return 0<this.history.redo.length}complete(){this._reset();this.onEnd();this.emit("complete")}cancel(){this.cancelled=!0;this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const q=this.activeComponent;q&&("box"!==q.type&&"reshape"!==q.type&&"graphic-mover"!==q.type||q.refresh())}set undo(q){this._set("undo",()=>{this.canUndo()&&q()})}set redo(q){this._set("redo",
()=>{this.canRedo()&&q()})}};b.__decorate([p.property()],a.OperationHandle.prototype,"activeComponent",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"cancelled",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"history",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"tool",null);b.__decorate([p.property()],a.OperationHandle.prototype,"type",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"canUndo",null);b.__decorate([p.property()],
a.OperationHandle.prototype,"canRedo",null);b.__decorate([p.property()],a.OperationHandle.prototype,"onEnd",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"undo",null);b.__decorate([p.property()],a.OperationHandle.prototype,"redo",null);b.__decorate([p.property()],a.OperationHandle.prototype,"toggleTool",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"addToSelection",void 0);b.__decorate([p.property()],a.OperationHandle.prototype,"removeFromSelection",void 0);a.OperationHandle=
b.__decorate([E.subclass("esri.widgets.Sketch.support.OperationHandle")],a.OperationHandle);a.CreateOperationHandle=class extends a.OperationHandle{};b.__decorate([p.property()],a.CreateOperationHandle.prototype,"activeComponent",void 0);a.CreateOperationHandle=b.__decorate([E.subclass("esri.widgets.Sketch.support.OperationHandle.CreateOperationHandle")],a.CreateOperationHandle);a.UpdateOperationHandle=class extends a.OperationHandle{};b.__decorate([p.property()],a.UpdateOperationHandle.prototype,
"activeComponent",void 0);a.UpdateOperationHandle=b.__decorate([E.subclass("esri.widgets.Sketch.support.OperationHandle.UpdateOperationHandle")],a.UpdateOperationHandle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflow":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Error ../../core/handleUtils ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/reactiveUtils ../../core/SetUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/editableLayers ../../layers/support/layerUtils ../../views/draw/support/HighlightHelper ../../views/input/InputManager ../../views/interactive/sketch/SketchOptions ./CreateFeaturesWorkflow ./UpdateFeatureWorkflow ./UpdateRecordWorkflow ./UpdateWorkflowData ./Workflow ./workflowUtils ../Feature/support/featureUtils ../support/templateUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S){function r(y,{keyField:H}){return y.getField(H)?.name??H}var J;t=J=class extends z{constructor(y){super(y);this._workflowStack=new E(f.last);this._sketchStack=new E(f.last);this.data=void 0;this.type="update"}get activeEditorItem(){return this.activeWorkflow?.data.editorItem??void 0}get activeFeatureFormViewModel(){return this.activeWorkflow?.featureFormViewModel}get activeSketchViewModel(){return this._sketchStack.peek()?.viewModel}get activeWorkflow(){return this._workflowStack.last()}get updating(){return this._updatingHandles.updating||
!!this.activeWorkflow?.updating}get hasPreviousStep(){return 0<this._stepIndex||1<this.nestedWorkflowCount||null!=this.activeWorkflow?.featureFormViewModel.relationshipId||"view"!==this.data.viewModel.attachmentsViewModel.mode}get hasUpdatableCandidates(){const {candidates:y,viewModel:H}=this.data;return y.some(({layer:h})=>H.findEditorItemForLayer(h)?.supportsUpdateWorkflow)}get nestedWorkflowCount(){return this._workflowStack.length}get shouldShowAttachments(){return!!this.activeEditorItem?.capabilities.attachments.enabled}get shouldAllowAttachmentEditing(){return!!this.activeEditorItem?.capabilities.update.attachments.enabled}get hasPendingEdits(){return Array.from(this._workflowStack).some(y=>
y.hasPendingEdits)}get helpMessage(){return this.activeWorkflow?.helpMessage?this.activeWorkflow.helpMessage:"awaiting-feature-to-update"===this.stepId?"select":void 0}get reliesOnOwnerAdminPrivileges(){return this.activeWorkflow?.reliesOnOwnerAdminPrivileges??!1}get hasInvalidFormTemplate(){return!!this.activeEditorItem?.hasInvalidFormTemplate}async back(y=()=>Promise.resolve(!0)){const {activeWorkflow:H}=this;if(null!=H?.featureFormViewModel.relationshipId)H.featureFormViewModel.relationshipId=
null;else if(H){if(!H.hasPendingEdits||await y())H.hasPreviousStep?await H.previous({cancelCurrentStep:!0}):await this.cancelActiveWorkflow({force:!0})}else this.hasPreviousStep?await this.previous({cancelCurrentStep:!0}):await this.cancel({force:!0})}async cancelActiveWorkflow(y){await this.activeWorkflow?.cancel(y);await this._popWorkflow()}async commit(){await this._drainWorkflowStack(y=>y.commit());await super.commit()}static create(y){const {viewModel:H,snappingManager:h,startAt:e,addAttachmentsCallback:c,
applyEditsCallback:g}=y;y=y.sketchOptions??new D;y=new J({data:new P({addAttachmentsCallback:c,applyEditsCallback:g,sketchOptions:y,snappingManager:h,viewModel:H}),onCommit:async()=>{}});y._set("steps",this._createWorkflowSteps(y,e));return y}async save(){1<this.nestedWorkflowCount?(await this.activeWorkflow?.commit(),await this._popWorkflow()):await this.commit()}async startCreatingRelatedRecord(y){try{const H=await this._createNestedCreateFeaturesWorkflow(y);await this._pushWorkflow(H)}catch(H){throw new d("editor:unable-to-start-creating",
"Could not begin updating the provided feature or table record.",{error:H});}}async startUpdating(y){try{const H=await this._createNestedUpdateWorkflow(y);await this._pushWorkflow(H)}catch(H){throw new d("editor:unable-to-start-updating","Could not begin updating the provided feature or table record.",{error:H});}}async deleteActiveFeature(){const {activeWorkflow:y}=this;if(!y)throw new d("editor:nothing-to-delete","There is no feature to delete");y&&/update-/.test(y.type)?await y.deleteAndCommit():
await y.cancel();1===this.nestedWorkflowCount?await this.reset():await this._popWorkflow()}async cancelAll(){await this._drainWorkflowStack(y=>y.cancel({force:!0}))}async _createNestedCreateFeaturesWorkflow(y){const {relatedLayer:H}=y,{addAttachmentsCallback:h,applyEditsCallback:e,sketchOptions:c,snappingManager:g,viewModel:F}=this.data;if(!v.isEditableLayer(H))throw new d("editor:unsupported-layer","Editing is not supported on the provided layer");y=this._getCreationInfoForNestedCreateFeaturesWorkflow(y);
return K.create({addAttachmentsCallback:h,applyEditsCallback:e,creationInfo:y,isNested:!0,parent:"create-features"!==this.activeWorkflow?.type?this.activeWorkflow:void 0,sketchOptions:c,snappingManager:g,startAt:y.template||y.initialFeature?"creating-features":"awaiting-feature-creation-info",viewModel:F})}_getCreationInfoForNestedCreateFeaturesWorkflow(y){const {relatedLayer:H}=y;if(!v.isEditableLayer(H)||B.isSubtypeGroupLayer(H))throw new d("editor:unsupported-layer","Editing is not supported on the provided layer");
const h={layer:H,maxFeatures:1};y=this._makeRelatedRecordAttributes(y);const e=S.getAllTemplatesForLayer(H);0<e?.length?(h.attributeOverrides=y,1===e.length&&(h.template=e[0])):h.initialFeature=new b({sourceLayer:H,attributes:y});return h}async _createNestedUpdateWorkflow(y){const H=B.isTable(y.sourceLayer)?G.UpdateRecordWorkflow:N.UpdateFeatureWorkflow,{applyEditsCallback:h,sketchOptions:e,snappingManager:c,viewModel:g}=this.data,F=await H.create({feature:y,parent:"create-features"!==this.activeWorkflow?.type?
this.activeWorkflow:void 0,sketchOptions:e,snappingManager:c,viewModel:g,applyEdits:h,relatedRecordCallbacks:{addRelatedRecord:async I=>await this.startCreatingRelatedRecord(I),editRelatedRecord:async({relatedFeature:I})=>await this.startUpdating(I)}});await q.whenOnce(()=>!F.updating);return F}async _drainWorkflowStack(y){const H=this._workflowStack,h=[];for(;0<H.length;){const e=H.pop();this._sketchStack.pop();const c=y(e).then(()=>e.destroy());this._updatingHandles.addPromise(c);h.push(c)}await Promise.all(h)}_makeRelatedRecordAttributes(y){const {parentFeature:H,
relatedLayer:h,relationshipId:e}=y;if(L.isGraphicForRelatableFeatureSupportedLayer(H))if(y=h.relationships?.find(F=>F.id===e))if("origin"===y.role)M("unsupported-role","Creating new related records in the 'origin' table of a relationship is not yet supported");else{var c=H.sourceLayer;y.relatedTableId!==c.layerId&&M("invalid-argument-combination","The given parent feature does not belong to the relationship designated by the given relationship ID.");var g=c.relationships?.find(F=>F.id===e);if(g)return c=
r(c,g),(c=H.getAttribute(c))||M("no-key-on-origin-feature","The given parent feature does not have a value for the relationship's origin primary key field."),{[r(h,y)]:c};M("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the origin layer.")}else M("relationship-not-found","Could not begin creating a related record because the relationship specified could not be found on the destination layer.")}async _popWorkflow(){this._workflowStack.pop()?.destroy();
this._sketchStack.pop();const y=await this._reconcileWorkflowStack();if(0<y.failureCount)throw new d("editor:next-workflow-failed","Popped the top workflow, but the next workflow in the stack failed to activate",y);}async _pushWorkflow(y){var H=this._workflowRequiresSketchViewModel(y);this.activeWorkflow?.exit({removeSketchHandles:H});H=this._sketchStack;const h=await y?.start(),e=H.peek();h?(e?.exit(),H.push(h)):H.push(this._cloneSketchController(e));this._workflowStack.push(y);y=await this._reconcileWorkflowStack();
if(0<y.failureCount)throw new d("editor:failed-to-start-updating-feature","Failed to enter the provided workflow.",y);}async _reconcileWorkflowStack(){const y=this._workflowStack,H=this._sketchStack;try{const h=y.peek();await h?.enter();await H.peek()?.enter();return{activeWorkflow:h,failureCount:0}}catch(h){y.pop().destroy();H.pop();const {activeWorkflow:e,failureCount:c}=await this._reconcileWorkflowStack();return{activeWorkflow:e,failureCount:c+1}}}_cloneSketchController(y){return{enter:y?.enter??
(async()=>{}),exit:y?.exit??(async()=>{}),viewModel:y?.viewModel}}_workflowRequiresSketchViewModel(y){const {type:H}=y;return"update-feature"===H||"create-features"===H&&!B.isTable(y.data.creationInfo?.layer)}static _createWorkflowSteps(y,H="awaiting-feature-to-update"){const {data:h}=y;return C.createWorkflowSteps(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],H,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",
async setUp(){const {spinnerViewModel:e}=h.viewModel,c=h.viewModel.view;let g=c.activeTool=null;y.addHandles(m.makeHandle(()=>{g=l.abortMaybe(g)}),this.id);h.rootFeature=null;h.candidates=[];const F=c.on("immediate-click",async O=>{const R=k.createResolver();y._updatingHandles.addPromise(R.promise);try{e.location=O.mapPoint;e.visible=!0;g?.abort();const {editorItems:W}=h.viewModel;g=new AbortController;const V=await O.async(()=>new Promise((aa,fa)=>{k.onAbort(g?.signal,()=>fa(k.createAbortError()));
aa(C.fetchCandidates(W,c,O,g?.signal))}));k.throwIfAborted(g);h.candidates=V.filter(aa=>"fulfilled"===aa.status).flatMap(aa=>aa.value).filter(aa=>!aa.isAggregate);e.visible=1===h.candidates.length;0!==h.candidates.length&&(O.stopPropagation(),1===h.candidates.length?(h.rootFeature=h.candidates[0],y.go("editing-existing-feature").catch(()=>{}).then(()=>e.visible=!1)):y.next())}finally{R.resolve()}},w.ViewEventPriorities.TOOL),I=q.when(()=>null!=c.activeTool,()=>y.cancel({force:!0}),{once:!0});c.focus();
y.addHandles([F,I],this.id)},async tearDown(){0===h.candidates.length&&(h.viewModel.spinnerViewModel.visible=!1);y.removeHandles(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){h.rootFeature=null;const {view:e}=h.viewModel;if(e){var c=new n({view:e});y.addHandles([q.watch(()=>h.rootFeature,(g,F)=>{c.remove(F);c.add(g)},q.sync),m.makeHandle(()=>c.removeAll())],this.id)}},async tearDown(){y.removeHandles(this.id)}}),"editing-existing-feature":()=>
({id:"editing-existing-feature",async setUp(){const {rootFeature:e,viewModel:c}=y.data;if(!e)throw new d("editor:no-feature-specified","Cannot setup the 'updating-existing-feature' step until the root feature is defined");await y.startUpdating(e);c.spinnerViewModel.visible=!1;const g=k.debounce(async()=>{await q.whenOnce(()=>!y.updating);y.previous()});y.addHandles([q.watch(()=>y.nestedWorkflowCount,(F,I)=>{0===F&&0!==I&&g()},q.sync)],this.id)},async tearDown(){await y.cancelAll();y.removeHandles(this.id)}}),
"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){h.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){h.viewModel.attachmentsViewModel.mode="view"}})})}};a.__decorate([u.property()],t.prototype,"activeEditorItem",null);a.__decorate([u.property()],t.prototype,"activeFeatureFormViewModel",null);a.__decorate([u.property()],
t.prototype,"activeSketchViewModel",null);a.__decorate([u.property()],t.prototype,"activeWorkflow",null);a.__decorate([u.property()],t.prototype,"updating",null);a.__decorate([u.property()],t.prototype,"data",void 0);a.__decorate([u.property()],t.prototype,"hasPreviousStep",null);a.__decorate([u.property()],t.prototype,"hasUpdatableCandidates",null);a.__decorate([u.property()],t.prototype,"nestedWorkflowCount",null);a.__decorate([u.property()],t.prototype,"shouldShowAttachments",null);a.__decorate([u.property()],
t.prototype,"shouldAllowAttachmentEditing",null);a.__decorate([u.property()],t.prototype,"hasPendingEdits",null);a.__decorate([u.property()],t.prototype,"helpMessage",null);a.__decorate([u.property()],t.prototype,"reliesOnOwnerAdminPrivileges",null);a.__decorate([u.property()],t.prototype,"hasInvalidFormTemplate",null);t=J=a.__decorate([x.subclass("esri.widgets.Editor.UpdateWorkflow")],t);const M=(y,H)=>p.getLogger("esri.widgets.Editor.UpdateWorkflow").warn(`editor:${y}`,H,"The create operation will be allowed to proceed, but the resulting feature may not be related to the given parent feature.");
return t})},"esri/views/draw/support/HighlightHelper":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./layerUtils ../../support/layerViewUtils ../../../widgets/Feature/support/featureUtils".split(" "),function(a,b,d,m,p,l,k,E,q,f){b=class extends b{constructor(u){super(u);this.view=null}add(u){u=!u||Array.isArray(u)?
u:[u];u?.length&&u.forEach(t=>this._highlight(t))}remove(u){u=!u||Array.isArray(u)?u:[u];u?.length&&u.forEach(t=>this._removeHighlight(t))}removeAll(){this.removeAllHandles()}_highlight(u){const t=E.findLayerView(this.view,u.layer);q.highlightsSupported(t)&&this.addHandles(t.highlight(u),f.getHighlightKeyForFeature(u))}_removeHighlight(u){u&&this.removeHandles(f.getHighlightKeyForFeature(u))}};a.__decorate([d.property()],b.prototype,"view",void 0);return b=a.__decorate([k.subclass("esri.views.draw.support.HighlightHelper")],
b)})},"esri/widgets/Editor/UpdateFeatureWorkflow":function(){define("exports ../../chunks/tslib.es6 ../../core/Error ../../core/handleUtils ../../core/has ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../support/elevationInfoUtils ../../views/support/layerViewUtils ./UpdateFeatureWorkflowData ./UpdateRecordWorkflow ./workflowUtils ../Sketch/SketchViewModel".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w){var D;const K={...B.handleKeys,highlights:Symbol(),sketchGraphics:Symbol(),sketchViewModel:Symbol(),waitingForTool:Symbol()};a.UpdateFeatureWorkflow=D=class extends B.UpdateRecordWorkflow{constructor(N){super(N);this.type="update-feature";this._sketchViewModel=this._sketchGraphicClone=this._layerViewEditSession=null;this._webStyleCache=new Map}destroy(){this._layerViewEditSession?.rollback()}async commit(){this.removeHandles(K.sketchGraphics);try{const N=
this.data.edits.stagedForDelete;await super.commit();const G=this._layerViewEditSession;N?G?.rollback():G?.commit()}catch(N){throw await this._configureSketchViewModel(),new d("editor-workflow:failed-to-commit","An error occurred when sending the updates to the service",{error:N});}}async start(){await super.start();return await this._initializeSketchViewModel()}_initializeFeatureFormViewModel(){super._initializeFeatureFormViewModel();this.addHandles([this._featureFormViewModel.on("value-change",
N=>{this._layerViewEditSession?.setAttribute(N.fieldName,N.value)}),k.watch(()=>this._featureFormViewModel.feature?.sourceLayer,N=>this._sketchGraphicClone.sourceLayer=N)])}_configureHighlight(){const {edits:N,layerView:G}=this.data;x.highlightsSupported(G)&&this.addHandles(G.highlight(N.feature),K.highlights)}async _configureSketchViewModel(){const N=this._sketchViewModel;if(N){var {data:G,_featureFormViewModel:P,_sketchGraphicClone:z}=this,{edits:C,viewModel:L}=G,S=C.feature,{view:r}=L,J=n.getVisualVariableAttributes(S);
S=await n.setUpGeometryUpdate({feature:S,featureClone:z,visualVariableAttributes:J,sketchViewModel:N,view:r,onUpdate:({geometry:M,attributes:y},H)=>{C.updateAttributes(y);C.updateGeometry(M);P.feature&&(P.feature.geometry=M);null!=J.rotation&&({field:M}=J.rotation,P.setValue(M,y[M]));null!=J.size&&({field:M}=J.size,P.setValue(M,y[M]));("undo"===H.type||"redo"===H.type||"update"===H.type&&null!=H.toolEventInfo&&n.isTerminalUpdateEventType(H.toolEventInfo.type))&&P.notifyFeatureGeometryChanged()},addUpdatingPromise:M=>
{this._updatingHandles.addPromise(M)},addHandle:M=>{this.addHandles(M,K.waitingForTool)},webStyleCache:this._webStyleCache});this.addHandles(S,K.sketchGraphics);N.addHandles(S)}}async _initializeSketchViewModel(){const {data:N,_sketchGraphicClone:G}=this,P=N.edits.feature,{capabilities:z,layer:C}=N.editorItem,{view:L}=N.viewModel;this.removeHandles([K.highlights,K.sketchGraphics,K.sketchViewModel,K.waitingForTool]);if(!z.update.geometry||"3d"===L?.type&&A.hasEffectiveFeatureExpressionInfo(C.elevationInfo))return{enter:async()=>
{this.hasHandles(K.highlights)||this._configureHighlight()},exit:()=>this.removeHandles([K.highlights])};const S=new t({elevationInfo:C.elevationInfo,internal:!0,listMode:"hide"}),r=new w({allowDeleteKey:!1,layer:S,sketchOptions:N.sketchOptions,snappingManager:N.snappingManager,updateOnGraphicClick:!1,view:L});this._sketchViewModel=r;L?.map.add(S);this.addHandles(m.makeHandle(()=>{L?.destroyed||L?.map.remove(S);S.destroy();this._sketchViewModel=l.destroyMaybe(r)}),K.sketchViewModel);await n.updateGraphicSymbolWhenRequired(G,
this._webStyleCache,"2d"===L?.type?L.scale:null);this.addHandles([await n.swapForEditingSession(r,P,G)]);return{enter:async()=>{this.hasHandles(K.sketchGraphics)||await this._configureSketchViewModel()},exit:()=>this.removeHandles([K.sketchGraphics]),viewModel:r}}_onFullFeatureLoaded(N){super._onFullFeatureLoaded(N);const G=this._sketchGraphicClone=n.cloneGraphicExceptMesh(N),{edits:P,layerView:z}=this.data;P.updateGeometry(N.geometry);P.trackChanges();n.canCreateInteractiveEditSession(z)&&(this._layerViewEditSession=
z.createInteractiveEditSession(G))}static async create(N){N=new D({data:await v.create(N),onCommit:this._onCommitFactory(N.applyEdits)});N._set("steps",this._createWorkflowSteps(N));return N}get test(){}};b.__decorate([E.property()],a.UpdateFeatureWorkflow.prototype,"_layerViewEditSession",void 0);b.__decorate([E.property()],a.UpdateFeatureWorkflow.prototype,"_sketchGraphicClone",void 0);b.__decorate([E.property()],a.UpdateFeatureWorkflow.prototype,"_sketchViewModel",void 0);a.UpdateFeatureWorkflow=
D=b.__decorate([u.subclass("esri.widgets.Editor.UpdateFeatureWorkflow")],a.UpdateFeatureWorkflow);a.handleKeys=K;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateFeatureWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../views/interactive/sketch/SketchOptions ./UpdateRecordWorkflowData ./workflowUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f){var u;m=u=class extends q{constructor(t){super(t);this.snappingManager=this.sketchOptions=null}static async create(t){const {feature:A,snappingManager:x,viewModel:v}=t,B=t.sketchOptions??new E;var {view:n}=v;if(!n)throw new b("editor:cannot-create-workflow-data","The provided EditorViewModel does not have an associated view");n=await f.whenEditorLayerView(n,A.layer);return new u({...u._makeConstructorProps(t),layerView:n,sketchOptions:B,snappingManager:x})}};a.__decorate([d.property()],
m.prototype,"layerView",void 0);a.__decorate([d.property({constructOnly:!0})],m.prototype,"sketchOptions",void 0);a.__decorate([d.property()],m.prototype,"snappingManager",void 0);return m=u=a.__decorate([k.subclass("esri.widgets.Editor.UpdateFeatureWorkflowData")],m)})},"esri/widgets/Editor/UpdateRecordWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./Edits".split(" "),
function(a,b,d,m,p,l,k,E,q){var f;b=f=class extends b{constructor(u){super(u);this.viewModel=this.relatedRecordCallbacks=this.parent=this.edits=this.editorItem=null}get attachmentsCapabilities(){const u=this.editorItem.capabilities.update.attachments.enabled;return{editing:!0,operations:{add:u,update:u,delete:u}}}get formTemplate(){return this.editorItem.formTemplate}static async create(u){u=f._makeConstructorProps(u);return new f(u)}static _makeConstructorProps(u){const {feature:t,parent:A,relatedRecordCallbacks:x,
viewModel:v}=u;u=v.editorItems.find(B=>B.layer===t.layer);if(!u)throw new d("no-editorItem-found","The EditorViewModel provided did not have an EditorItem associated with the specified Graphic's layer");return{editorItem:u,edits:new q.Edits({feature:t}),parent:A,relatedRecordCallbacks:x,viewModel:v}}};a.__decorate([m.property()],b.prototype,"attachmentsCapabilities",null);a.__decorate([m.property({constructOnly:!0})],b.prototype,"editorItem",void 0);a.__decorate([m.property()],b.prototype,"edits",
void 0);a.__decorate([m.property()],b.prototype,"formTemplate",null);a.__decorate([m.property()],b.prototype,"parent",void 0);a.__decorate([m.property()],b.prototype,"relatedRecordCallbacks",void 0);a.__decorate([m.property()],b.prototype,"viewModel",void 0);return b=f=a.__decorate([E.subclass("esri.widgets.Editor.UpdateRecordWorkflowData")],b)})},"esri/widgets/Editor/UpdateRecordWorkflow":function(){define("exports ../../chunks/tslib.es6 ../../core/Error ../../core/handleUtils ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../views/draw/support/HighlightHelper ./UpdateRecordWorkflowData ./Workflow ./workflowUtils ../FeatureForm/FeatureFormViewModel".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B){var n;const w={exit:Symbol()};a.UpdateRecordWorkflow=n=class extends x{constructor(D){super(D);this.fullFeature=this._highlightHelper=null;this.type="update-table-record"}initialize(){const {data:D}=this;var {edits:K}=D;const {view:N}=D.viewModel;K=K.feature;const G=new AbortController;this.addHandles(m.abortHandle(G));this._updatingHandles.addPromise(v.fetchFullFeature(K,D.viewModel.view.spatialReference,G.signal).then(P=>{p.isAborted(G)||(this._onFullFeatureLoaded(P),
this._initializeFeatureFormViewModel())},P=>this.cancel({force:!0,error:new d("editor:failed-to-fetch-full-feature","Failed to retrieve all information for this feature. The update cannot proceed.",{detail:{error:P}})})));N&&(this._highlightHelper=new t({view:N}),this.addHandles(m.makeHandle(()=>this._highlightHelper?.removeAll())))}get editorItem(){return this.data.editorItem}get featureFormViewModel(){return this._featureFormViewModel}get hasPendingEdits(){return this.data.edits.modified}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get parentLayer(){return this.parent?.data.editorItem.layer}get shouldShowAttachments(){return this.editorItem.capabilities.attachments.enabled}get shouldAllowAttachmentEditing(){return this.editorItem.capabilities.update.attachments.enabled}get reliesOnOwnerAdminPrivileges(){const D=
this.editorItem.capabilities;return D.update.reliesOnOwnerAdminPrivileges||D.delete.reliesOnOwnerAdminPrivileges}async deleteAndCommit(){this.data.edits.stageDelete();return this.commit()}async enter(){this._configureAttachmentsViewModel()}exit(D){this.removeHandles(w.exit)}async start(){await super.start();return null}_configureAttachmentsViewModel(){const {data:D,fullFeature:K}=this,{attachmentsCapabilities:N,viewModel:G}=D,{attachmentsViewModel:P}=G;P.set({capabilities:N,graphic:K,filesEnabled:!1,
mode:"view"});this.addHandles([m.makeHandle(()=>P.fileInfos.removeAll()),l.watch(()=>P.mode,z=>{switch(z){case "add":this.go("adding-attachment");break;case "edit":this.go("editing-attachment")}})],w.exit)}_initializeFeatureFormViewModel(){const {edits:D,formTemplate:K,viewModel:{view:N}}=this.data,G=this._featureFormViewModel=new B({arcadeEditType:"UPDATE",feature:this.fullFeature,formTemplate:K,highlightHelper:this._highlightHelper,map:N?.map,spatialReference:N.spatialReference,timeZone:N?.timeZone});
G.relatedRecordCallbacks={...this.data.relatedRecordCallbacks,showAllRelatedRecords:z=>G.relationshipId=z.relationshipId};const {initialFeature:P}=D;P&&G.overrideInitialFeature(P);this.addHandles([G.on("value-change",()=>{D.updateAttributes(G.getValues());this.fullFeature.attributes=D.feature.attributes}),l.watch(()=>N?.timeZone,z=>G.timeZone=z)])}_onFullFeatureLoaded(D){this.fullFeature=D;const {edits:K}=this.data;K.updateAttributes(D.attributes);K.trackChanges()}static async create(D){D=new n({data:await A.create(D),
onCommit:this._onCommitFactory(D.applyEdits)});D._set("steps",this._createWorkflowSteps(D));return D}static _createWorkflowSteps(D){const {attachmentsViewModel:K}=D.data.viewModel;return[{id:"editing-attributes",async setUp(){},async tearDown(){}},{id:"adding-attachment",async setUp(){},async tearDown(){K.mode="view"}},{id:"editing-attachment",async setUp(){},async tearDown(){K.mode="view"}}]}};a.UpdateRecordWorkflow._onCommitFactory=D=>async K=>{({edits:K}=K);const {feature:N}=K;if(N){var G=N.sourceLayer,
P=N.clone();if(!K.attributesModified||K.stagedForDelete){var z=G.objectIdField;P.attributes={[z]:N.getAttribute(z)};"scene"===G.type&&null!=G.infoFor3D&&(z=G.associatedLayer?.globalIdField,null!=z&&P.setAttribute(z,N.getAttribute(z)))}if(!K.geometryModified||K.stagedForDelete)P.geometry=null;await D(G,{[K.stagedForDelete?"deleteFeatures":"updateFeatures"]:[P]})}};b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"editorItem",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,
"featureFormViewModel",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"fullFeature",void 0);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"hasPendingEdits",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"layer",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"parent",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"parentLayer",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"shouldShowAttachments",
null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"shouldAllowAttachmentEditing",null);b.__decorate([k.property()],a.UpdateRecordWorkflow.prototype,"reliesOnOwnerAdminPrivileges",null);a.UpdateRecordWorkflow=n=b.__decorate([u.subclass("esri.widgets.Editor.UpdateRecordWorkflow")],a.UpdateRecordWorkflow);a.handleKeys=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/UpdateWorkflowData":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.viewModel=this.snappingManager=this.sketchOptions=this.rootFeature=this.candidates=this.applyEditsCallback=this.addAttachmentsCallback=null}};a.__decorate([d.property()],b.prototype,"addAttachmentsCallback",void 0);a.__decorate([d.property()],b.prototype,"applyEditsCallback",void 0);a.__decorate([d.property()],b.prototype,"candidates",void 0);a.__decorate([d.property()],b.prototype,"rootFeature",void 0);a.__decorate([d.property({constructOnly:!0})],
b.prototype,"sketchOptions",void 0);a.__decorate([d.property()],b.prototype,"snappingManager",void 0);a.__decorate([d.property()],b.prototype,"viewModel",void 0);return b=a.__decorate([k.subclass("esri.widgets.Editor.UpdateWorkflowData")],b)})},"esri/widgets/Editor/support/EditorItem":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/support/layerUtils ./EditorEditingCapabilities ../../FeatureForm/featureFormUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f){b=class extends b{constructor(u){super(u);this.disabled=!1;this.layerView=this.layerInfo=this.layer=null}get _suspended(){return!!this.layerView?.suspended}get capabilities(){return new q({layer:this.layer,layerInfo:this.layerInfo,layerView:this.layerView})}get editable(){const {create:u,relationship:t,update:A,delete:{enabled:x}}=this.capabilities,v=u.attachments.enabled||A.attachments.enabled;return!this.disabled&&(u.enabled||A.enabled||v||x||t.enabled)}get formTemplate(){return this.capabilities.formTemplate}get hasInvalidFormTemplate(){return f.formTemplateHasInvalidFields(this.layer,
this.formTemplate)}get isTable(){return E.isTable(this.layer)}get supportsCreateFeaturesWorkflow(){if(this.disabled)return!1;const {enabled:u,geometry:t}=this.capabilities.create;return this.isTable?u:u&&t}get supportsUpdateWorkflow(){const {capabilities:u}=this;return!this.disabled&&(u.update.enabled||u.update.attachments.enabled||u.delete.enabled)}get visible(){const {layer:u}=this,t=u.parent;return!this._suspended&&u.visible&&(!t||!("visible"in t)||t.visible)}};a.__decorate([d.property()],b.prototype,
"_suspended",null);a.__decorate([d.property()],b.prototype,"capabilities",null);a.__decorate([d.property()],b.prototype,"disabled",void 0);a.__decorate([d.property()],b.prototype,"editable",null);a.__decorate([d.property()],b.prototype,"formTemplate",null);a.__decorate([d.property()],b.prototype,"hasInvalidFormTemplate",null);a.__decorate([d.property()],b.prototype,"isTable",null);a.__decorate([d.property()],b.prototype,"layer",void 0);a.__decorate([d.property()],b.prototype,"layerInfo",void 0);a.__decorate([d.property()],
b.prototype,"layerView",void 0);a.__decorate([d.property()],b.prototype,"supportsCreateFeaturesWorkflow",null);a.__decorate([d.property()],b.prototype,"supportsUpdateWorkflow",null);a.__decorate([d.property()],b.prototype,"visible",null);return b=a.__decorate([k.subclass("esri.widgets.Editor.support.EditorItem")],b)})},"esri/widgets/Editor/support/EditorEditingCapabilities":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/support/EditingCapabilities ../../../views/layers/support/editableLayerViews ../../Feature/support/featureUtils".split(" "),
function(a,b,d,m,p,l,k,E,q){function f(u,t){return"scene"!==u.type?!0:null!=t&&"type"in t&&"scene-layer-3d"===t.type?E.isGeometryEditableSceneLayer(u,t):!1}d=class extends k{constructor(u){super(u);this.layerView=this.layerInfo=null}get attachments(){const u=this.layerInfo;return{enabled:this.defaults.attachments.enabled&&!1!==u?.enabled}}get create(){const {attachments:u,defaults:t,layerInfo:A,layer:x,layerView:v}=this,B=t.create,n=B.enabled&&!1!==A?.enabled&&!1!==A?.addEnabled,w=n&&B.attributes,
D=n&&B.geometry&&f(x,v);return{attributes:w,enabled:n,geometry:D,attachments:{enabled:u.enabled&&n&&!1!==A?.attachmentsOnCreateEnabled},reliesOnOwnerAdminPrivileges:B.reliesOnOwnerAdminPrivileges}}get defaults(){return new k({layer:this.layer})}get delete(){const {defaults:u,layerInfo:t}=this,A=u.delete;return{enabled:A.enabled&&!1!==t?.enabled&&!1!==t?.deleteEnabled,reliesOnOwnerAdminPrivileges:A.reliesOnOwnerAdminPrivileges}}get formTemplate(){const {layer:u,layerInfo:t}=this;return t?.formTemplate?
t.formTemplate:u&&"formTemplate"in u?u.formTemplate:null}get relationship(){var {layer:u}=this;u=!(!q.isRelatableFeatureSupportedLayer(u)||!u.relationships?.length);const t=!!this.formTemplate?.elements?.some(A=>"relationship"===A.type);return{enabled:u&&t}}get update(){const {attachments:u,defaults:t,layerInfo:A,layer:x,layerView:v}=this,B=t.update,n=B.enabled&&!1!==A?.enabled&&!1!==A?.updateEnabled,w=n&&B.attributes&&!1!==A?.attributeUpdatesEnabled,D=n&&B.geometry&&!1!==A?.geometryUpdatesEnabled&&
f(x,v),K=u.enabled&&!1!==A?.attachmentsOnUpdateEnabled;return{attributes:w,enabled:n,geometry:D,attachments:{enabled:K,create:K&&B.attachments.create,update:K&&B.attachments.update},reliesOnOwnerAdminPrivileges:B.reliesOnOwnerAdminPrivileges}}};a.__decorate([b.property()],d.prototype,"attachments",null);a.__decorate([b.property()],d.prototype,"create",null);a.__decorate([b.property()],d.prototype,"defaults",null);a.__decorate([b.property()],d.prototype,"delete",null);a.__decorate([b.property()],d.prototype,
"formTemplate",null);a.__decorate([b.property()],d.prototype,"layerInfo",void 0);a.__decorate([b.property()],d.prototype,"layerView",void 0);a.__decorate([b.property()],d.prototype,"relationship",null);a.__decorate([b.property()],d.prototype,"update",null);return d=a.__decorate([l.subclass("esri.widgets.Editor.support.EditorEditingCapabilities")],d)})},"esri/layers/support/EditingCapabilities":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./layerUtils".split(" "),
function(a,b,d,m,p,l,k,E){b=class extends b{constructor(q){super(q);this.layer=null}get attachments(){return{enabled:this._effectiveEnabled&&!!this._effectiveCapabilities?.data.supportsAttachment}}get create(){const {_effectiveCapabilities:q,layer:f}=this,u=this._createEnabled;return{attachments:{enabled:u&&this.attachments.enabled},attributes:u,enabled:u,geometry:u,reliesOnOwnerAdminPrivileges:!f.capabilities?.operations.supportsAdd&&!!q?.operations.supportsAdd}}get delete(){const {_effectiveCapabilities:q,
layer:f}=this;return{enabled:this._effectiveEnabled&&!!q?.operations.supportsDelete,reliesOnOwnerAdminPrivileges:!f.capabilities?.operations.supportsDelete&&!!q?.operations.supportsDelete}}get reliesOnOwnerAdminPrivileges(){return this._effectiveEnabled&&!this.layer.editingEnabled||this.create.reliesOnOwnerAdminPrivileges||this.update.reliesOnOwnerAdminPrivileges||this.delete.reliesOnOwnerAdminPrivileges}get update(){const {_effectiveCapabilities:q,layer:f}=this,u=this._updateEnabled,t=this.attachments.enabled,
A=t&&this._canCreateOrUpdate;return{attachments:{enabled:t,create:A,update:A},attributes:u,enabled:u,geometry:!(!u||!q?.editing.supportsGeometryUpdate),reliesOnOwnerAdminPrivileges:!f.capabilities?.operations.supportsUpdate&&!!q?.operations.supportsUpdate}}get _createEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsAdd}get _updateEnabled(){return this._effectiveEnabled&&!!this._effectiveCapabilities?.operations.supportsUpdate}get _canCreateOrUpdate(){return!(!this._createEnabled&&
!this._updateEnabled)}get _effectiveEnabled(){return E.getEffectiveEditingEnabled(this.layer)}get _effectiveCapabilities(){return E.getEffectiveLayerCapabilities(this.layer)}};a.__decorate([d.property()],b.prototype,"attachments",null);a.__decorate([d.property()],b.prototype,"create",null);a.__decorate([d.property()],b.prototype,"delete",null);a.__decorate([d.property()],b.prototype,"layer",void 0);a.__decorate([d.property()],b.prototype,"reliesOnOwnerAdminPrivileges",null);a.__decorate([d.property()],
b.prototype,"update",null);a.__decorate([d.property()],b.prototype,"_createEnabled",null);a.__decorate([d.property()],b.prototype,"_updateEnabled",null);a.__decorate([d.property()],b.prototype,"_canCreateOrUpdate",null);a.__decorate([d.property()],b.prototype,"_effectiveEnabled",null);a.__decorate([d.property()],b.prototype,"_effectiveCapabilities",null);return b=a.__decorate([k.subclass("esri.layers.support.EditingCapabilities")],b)})},"esri/views/layers/support/editableLayerViews":function(){define(["exports",
"../../../core/Logger","../../../geometry/support/spatialReferenceUtils","../../../layers/support/infoFor3D","../../ViewingMode"],function(a,b,d,m,p){a.isGeometryEditableSceneLayer=function(l,k){var {associatedLayer:E}=l,q=E?.infoFor3D;if(!q)return!1;var f=m.getGlbFormatId(q);if(null==f||!q.queryFormats.includes(f))return b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??"Untitled layer"}, ${l.id}) does not support geometry edits because it does not support GLB queries.`),
!1;q=l.spatialReference;f=E.spatialReference;if(!d.equals(q,f))return b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??"Untitled layer"}, ${l.id}) does not support geometry edits because its spatial reference (wkid:${q.wkid}) is different from its associated FeatureLayer's spatial reference (wkid:${f.wkid}).`),!1;E=E.sourceJSON.sourceSpatialReference;if(null!=E&&!d.equals(E,f))return b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??
"Untitled layer"}, ${l.id}) does not support geometry edits because the spatial reference of its associated FeatureLayer's service (wkid:${f.wkid}) is different from its source spatial reference (wkid:${E.wkid}).`),!1;({view:E}=k);if(k.destroyed||null==E)return!1;k=E.spatialReference;({viewingMode:f}=E.state);E=d.isGeographic(q);f=f===p.ViewingMode.Global;return E&&!f?(b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??"Untitled layer"}, ${l.id}) does not support geometry edits in local viewing mode because its spatial reference (wkid:${q.wkid}) is geographic. Please consider changing the viewing mode to global.`),
!1):!E&&f?(b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??"Untitled layer"}, ${l.id}) does not support geometry edits in global viewing mode because its spatial reference (wkid:${q.wkid}) is projected. Please consider changing the viewing mode to local.`),!1):d.equals(q,k)||f&&d.isWebMercator(k)&&d.isWGS84(q)?!0:(b.getLogger("esri.views.layers.support.editableLayerViews").warnOnce(`SceneLayer (${l.title??"Untitled layer"}, ${l.id}) does not support geometry edits because its spatial reference (wkid:${q.wkid}) does not match the view spatial reference (wkid:${k.wkid}).`),
!1)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/VisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/SnappingControls/VisibleElements".split(" "),function(a,b,d,m,p,l,k,E){b=class extends b{constructor(q){super(q);this.createFeaturesSection=!0;this.directionModePicker=!1;this.snappingControls=
this.settingsMenu=this.labelsToggle=this.editFeaturesSection=!0;this.snappingControlsElements=new E;this.tooltipsToggle=!0;this.undoRedoButtons=!1}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"createFeaturesSection",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"directionModePicker",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"editFeaturesSection",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],
b.prototype,"labelsToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"settingsMenu",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"snappingControls",void 0);a.__decorate([d.property({type:E,nonNullable:!0})],b.prototype,"snappingControlsElements",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"undoRedoButtons",
void 0);return b=a.__decorate([k.subclass("esri.widgets.Editor.VisibleElements")],b)})},"esri/widgets/support/SnappingControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../GridControls/VisibleElements".split(" "),function(a,b,d,m,p,l,k,E){b=class extends b{constructor(q){super(q);this.gridEnabledToggle=
this.featureEnabledToggle=this.enabledToggle=!0;this.header=!1;this.gridControls=this.layerList=!0;this.gridControlsElements=new E({gridSnapEnabledToggle:!1,gridEnabledToggle:!1});this.selfEnabledToggle=this.layerListToggleLayersButton=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"enabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"featureEnabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,
"gridEnabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"layerList",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"gridControls",void 0);a.__decorate([d.property({type:E,nonNullable:!0})],b.prototype,"gridControlsElements",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"layerListToggleLayersButton",void 0);a.__decorate([d.property({type:Boolean,
nonNullable:!0})],b.prototype,"selfEnabledToggle",void 0);return b=a.__decorate([k.subclass("esri.widgets.support.SnappingControls.VisibleElements")],b)})},"esri/widgets/support/GridControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);
this.rotateWithMapToggle=this.placementButtons=this.outOfScaleWarning=this.lineIntervalInput=this.gridSnapEnabledToggle=this.numericInputs=this.gridEnabledToggle=this.dynamicScaleToggle=this.colorSelection=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"colorSelection",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"dynamicScaleToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"gridEnabledToggle",void 0);a.__decorate([d.property({type:Boolean,
nonNullable:!0})],b.prototype,"numericInputs",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"gridSnapEnabledToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"lineIntervalInput",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"outOfScaleWarning",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"placementButtons",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],
b.prototype,"rotateWithMapToggle",void 0);return b=a.__decorate([k.subclass("esri.widgets.support.GridControls.VisibleElements")],b)})},"esri/widgets/Editor/components/CreateFeaturesPanelContent":function(){define(["exports","./PanelContent","../../support/widgetUtils","../../support/jsxFactory"],function(a,b,d,m){a.CreateFeaturesPanelContent=function({helpMessage:p}){return m.tsx(b.PanelContent,{key:"creating-features-panel-content"},m.tsx(b.PanelContentMessage,{key:"content-message"},p))};a.loadCreateFeaturesPanelContentComponents=
()=>b.loadPanelContentComponents();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/PanelContent":function(){define(["require","exports","../../../chunks/componentsUtils","../../support/widgetUtils","../../support/jsxFactory"],function(a,b,d,m,p){const l={base:"esri-editor__panel-content",message:"esri-editor__panel-content__message",section:"esri-editor__panel-content__section",sectionGroup:"esri-editor__panel-content__section__group",scrimContainer:"esri-editor__panel-content__scrim-container"};
b.PanelContent=function(k,...E){return p.tsx("div",{class:m.classes(l.base,k?.showScrimOverlay?l.scrimContainer:void 0),key:k?.key??"panel-content"},...E,k?.showScrimOverlay?p.tsx("calcite-scrim",null):void 0)};b.PanelContentMessage=function(k,...E){return p.tsx("div",{class:l.message,"data-testid":"panel-content-message",key:k?.key??"panel-content-message"},...E)};b.PanelContentSection=function(k,...E){return p.tsx("div",{class:l.section,key:k?.key??"panel-content-section"},...E)};b.PanelContentSectionGroup=
function(k,...E){return p.tsx("div",{class:l.sectionGroup,key:k?.key??"panel-content-section-group"},...E)};b.css=l;b.loadPanelContentComponents=()=>d.loadCalciteComponents({scrim:()=>new Promise((k,E)=>a(["../../../chunks/calcite-scrim"],k,E))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/FeatureList":function(){define("exports ../../../core/arrayUtils ../../../layers/support/fieldUtils ./PanelContent ../../FeatureTemplates/ItemList ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k){a.FeatureList=function({editorItems:E,filterText:q,id:f,messagesTemplates:u,onFilterTextChange:t,onSelectFeature:A,workflow:x}){const v=new Map;let B=0;x.data.candidates.map(n=>{var w=n.layer;if(w){var D=w.fieldsIndex.get(w.objectIdField);var K=D.alias||D.name,{attributes:N}=n;D=(w=d.getDisplayFieldName(w))&&N[w]&&`${N[w]}`||`${K}: ${N[D.name]}`}else D=null;return{label:D,id:n.attributes[n.layer.objectIdField],data:n}}).filter(({label:n,data:w})=>{const D=q.toLowerCase(),{title:K}=
w.layer,N=E.find(G=>G.layer===w.sourceLayer);return N?N.supportsUpdateWorkflow&&(!D||n?.toLowerCase().includes(D)||K?.toLowerCase().includes(D)):null}).filter(b.isSome).forEach(n=>{B++;const w=n.data.layer;v.has(w)?v.get(w)?.items.push(n):v.set(w,{id:`${w.id}`,label:w.title??"",items:[n]})});x=E.toArray().map(({layer:n})=>v.get(n)).filter(b.isSome);return k.tsx(m.PanelContent,{key:"feature-list"},k.tsx(m.PanelContentSection,null,p.ItemList({enableListScroll:!1,filterEnabled:10<B||0<q.length,filterText:q,
id:f,items:x,messages:{filterPlaceholder:u.filterPlaceholder,noItems:u.noItems,noMatches:u.noMatches},onFilterChange:n=>t(n),onItemMouseEnter:n=>A(n.data),onItemMouseLeave:()=>A(null),onItemSelect:n=>A(n.data,!0)})))};a.loadFeatureListComponents=()=>m.loadPanelContentComponents();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/FooterActions":function(){define("require exports ../../../core/arrayUtils ../../../chunks/componentsUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,p,l){const k={base:"esri-editor__actions"};b.FooterActions=function({buttons:E,key:q}){return l.tsx("div",{class:k.base,key:q??"footer-actions",slot:"footer"},E.filter(d.isSome).map(({disabled:f,onClick:u,label:t,...A},x)=>l.tsx("calcite-button",{disabled:f??!1,key:`action-${x}`,onclick:()=>{(f??!1)||u()},width:"full",...A},t)))};b.css=k;b.loadFooterActionsComponents=()=>m.loadCalciteComponents({button:()=>new Promise((E,q)=>a(["../../../chunks/calcite-button"],E,q))});Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/Notices":function(){define("require exports ../../../chunks/componentsUtils ../../support/iconUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,p,l){function k(q){const f=q.kind??"brand";return l.tsx("calcite-notice",{class:E.notice,icon:m.iconByKind[f],key:q.key,kind:f,open:!0,scale:"s"},q.title?l.tsx("div",{slot:"title"},q.title):null,l.tsx("div",{slot:"message"},q.message))}const E={notice:"esri-editor__notice"};
b.Notice=k;b.Notices=function({workflow:q,messages:f}){const u=[];q?.reliesOnOwnerAdminPrivileges&&u.push(l.tsx(k,{key:"owner-admin-notice",message:f.ownerAdminNotice,slot:"content-start"}));q?.hasInvalidFormTemplate&&u.push(l.tsx(k,{key:"form-field-error",kind:"warning",message:f.formFieldUpdateError,slot:"content-start"}));"create-features"===q?.type&&"georeferenced-reprojected"===q.data.upload?.result?.type&&u.push(l.tsx(k,{key:"mesh-reprojected",kind:"warning",message:f.helpMessages3d.meshReprojected,
slot:"content-start"}));return l.tsx(l.tsxFragment,null,u)};b.css=E;b.loadNoticesComponents=()=>d.loadCalciteComponents({notice:()=>new Promise((q,f)=>a(["../../../chunks/calcite-notice"],q,f))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/PanelToolbar":function(){define(["require","exports","./Settings","../../../chunks/componentsUtils","../../support/jsxFactory"],function(a,b,d,m,p){const l={base:"esri-editor__panel-toolbar"};b.PanelToolbar=function({editorViewModel:k,
messagesCommon:E,visibleElements:q}){const {sketchViewModel:f}=k;return p.tsx("div",{class:l.base,key:"panel-toolbar"},p.tsx(d.Settings,{editorViewModel:k,messagesCommon:E,visibleElements:q}),q.undoRedoButtons?[p.tsx("calcite-button",{alignment:"center",appearance:"transparent",disabled:!f?.canUndo(),iconStart:"undo",key:"undo-button",kind:"neutral",label:E.undo,onclick:()=>f?.undo(),scale:"l"},E.undo),p.tsx("calcite-button",{alignment:"center",appearance:"transparent",disabled:!f?.canRedo(),iconStart:"redo",
key:"redo-button",kind:"neutral",label:E.redo,onclick:()=>f?.redo(),scale:"l"},E.redo)]:null)};b.css=l;b.loadPanelToolbarComponents=()=>Promise.all([m.loadCalciteComponents({button:()=>new Promise((k,E)=>a(["../../../chunks/calcite-button"],k,E))}),d.loadSettingsComponents()]);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/Settings":function(){define("require exports ../../../chunks/componentsUtils ../../support/SketchTooltipControls ../../support/SnappingControls ../../support/widgetUtils ../../support/jsxFactory ../../support/SnappingControls/VisibleElements".split(" "),
function(a,b,d,m,p,l,k,E){const q={settingsContainer:"esri-editor__settings"};b.Settings=function({editorViewModel:f,messagesCommon:u,visibleElements:t}){const {snappingOptions:A,sketchOptions:x,view:v,snappingManager:B}=f;f=[];const n={directionModePicker:t.directionModePicker,labelsToggle:t.labelsToggle,tooltipsToggle:t.tooltipsToggle};Object.values(n).includes(!0)&&f.push(k.tsx(m,{sketchOptions:x,viewType:v?.type,visibleElements:n}));t.snappingControls&&f.push(k.tsx(p,{afterCreate:w=>w.layerListOpen=
!1,snappingManager:B,snappingOptions:A,view:v,visibleElements:t.snappingControlsElements??new E}));return 0===f.length?null:k.tsx("calcite-accordion",{appearance:"transparent",class:q.settingsContainer,key:"settings"},k.tsx("calcite-accordion-item",{"data-testid":"settings",heading:u.settings,iconStart:"gear"},f))};b.css=q;b.loadSettingsComponents=()=>d.loadCalciteComponents({accordion:()=>new Promise((f,u)=>a(["../../../chunks/calcite-accordion"],f,u)),"accordion-item":()=>new Promise((f,u)=>a(["../../../chunks/calcite-accordion-item"],
f,u))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../views/interactive/sketch/SketchOptions ../../views/interactive/tooltip/components/directionModeIcons ../Widget ../../chunks/componentsUtils ./globalCss ./LabeledSwitch ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SketchTooltipControls/VisibleElements".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){p=class extends f{constructor(w,D){super(w,D);this.viewModel=null;this.visibleElements=new n;this.sketchOptions=new E;this.viewType=void 0;this._onTooltipsEnabledChange=K=>{this.sketchOptions.tooltips.enabled=K};this._onLabelsEnabledChange=K=>{this.sketchOptions.labels.enabled=K};this._onDirectionModeChange=K=>{this.sketchOptions.values.directionMode=K.target.selectedItem.value}}loadDependencies(){return Promise.all([u.loadCalciteComponents({block:()=>new Promise((w,
D)=>a(["../../chunks/calcite-block"],w,D)),label:()=>new Promise((w,D)=>a(["../../chunks/calcite-label"],w,D)),icon:()=>new Promise((w,D)=>a(["../../chunks/calcite-icon"],w,D)),"radio-button":()=>new Promise((w,D)=>a(["../../chunks/calcite-radio-button"],w,D)),"radio-button-group":()=>new Promise((w,D)=>a(["../../chunks/calcite-radio-button-group"],w,D))}),A.loadLabeledSwitchComponents()])}render(){const {label:w,visibleElements:D}=this,K=this._renderContent();return B.tsx("div",{"aria-label":w,class:this.classes("esri-sketch-tooltip-controls",
t.globalCss.widget)},K?B.tsx("calcite-block",{class:"esri-sketch-tooltip-controls__block",heading:D.header?this.label:"",key:"content-block",open:!0},B.tsx("div",{class:"esri-sketch-tooltip-controls__block-content",key:"content"},K)):void 0)}get label(){return this.messages?.widgetLabel??""}set label(w){this._overrideIfSome("label",w)}_renderContent(){const {visibleElements:w,viewType:D}=this,K=[w.tooltipsToggle?this._renderTooltipsToggle():null,w.labelsToggle&&"2d"!==D?this._renderLabelsToggle():
null,w.directionModePicker?this._renderDirectionModePicker():null].filter(d.isSome);return 0===K.length?null:K}_renderTooltipsToggle(){const {messages:w,sketchOptions:D}=this;return B.tsx(A.LabeledSwitch,{checked:D.tooltips.effectiveEnabled,hint:w.tooltipsToggleHint,key:`${this.id}__tooltips`,label:w.tooltipsToggle,onChange:this._onTooltipsEnabledChange})}_renderLabelsToggle(){const {messages:w,sketchOptions:D}=this;return B.tsx(A.LabeledSwitch,{checked:D.labels.enabled,hint:w.labelsToggleHint,key:`${this.id}__labels`,
label:w.labelsToggle,onChange:this._onLabelsEnabledChange})}_renderDirectionModePicker(){const {messages:w,sketchOptions:D}=this,{directionMode:K}=D.values;return B.tsx("calcite-label",{key:"direction-mode",layout:"default",scale:"s"},w.directionModePicker,B.tsx("calcite-radio-button-group",{key:"radio-button-group",layout:"horizontal",name:this.id,scale:"s",value:K,onCalciteRadioButtonGroupChange:this._onDirectionModeChange},this._renderDirectionModeOption("relative",K,w.directionModeRelative),this._renderDirectionModeOption("absolute",
K,w.directionModeAbsolute)))}_renderDirectionModeOption(w,D,K){return B.tsx("calcite-label",{key:w,layout:"inline",scale:"s"},B.tsx("calcite-radio-button",{checked:w===D,scale:"s",value:w}),B.tsx("div",{class:"esri-sketch-tooltip-controls__radio-button-label-wrapper",key:"label-wrapper"},B.tsx("calcite-icon",{icon:q.directionModeIcons[w],scale:"s"}),K))}};b.__decorate([m.property()],p.prototype,"label",null);b.__decorate([m.property({type:n,nonNullable:!0})],p.prototype,"visibleElements",void 0);
b.__decorate([m.property(),v.messageBundle("esri/widgets/support/SketchTooltipControls/t9n/SketchTooltipControls")],p.prototype,"messages",void 0);b.__decorate([m.property({nonNullable:!0,type:E})],p.prototype,"sketchOptions",void 0);b.__decorate([m.property({type:String})],p.prototype,"viewType",void 0);return p=b.__decorate([k.subclass("esri.widgets.support.SketchTooltipControls")],p)})},"esri/views/interactive/tooltip/components/directionModeIcons":function(){define(["exports"],function(a){a.directionModeIcons=
{absolute:"absolute-direction",relative:"relative-direction"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/LabeledSwitch":function(){define(["require","exports","../../chunks/componentsUtils","./widgetUtils","./jsxFactory"],function(a,b,d,m,p){b.LabeledSwitch=function({checked:l,disabled:k,hint:E,key:q,label:f,onChange:u,hintIcon:t,hintKind:A}){return p.tsx("calcite-label",{class:"esri-labeled-switch__label",disabled:k,key:q,layout:"inline-space-between",scale:"s"},
p.tsx("div",{class:"esri-labeled-switch__label-content",key:"label-content"},E?p.tsx(p.tsxFragment,null,p.tsx("div",null,f),p.tsx("calcite-icon",{class:"warning"!==A?"esri-labeled-switch__icon_info":"esri-labeled-switch__icon_warning",icon:t??"information",id:q,scale:"s",tabIndex:0}),p.tsx("calcite-tooltip",{class:"esri-labeled-switch__tooltip",referenceElement:q},E)):f),p.tsx("calcite-switch",{checked:l,disabled:k,scale:"s",onCalciteSwitchChange:x=>u(x.target.checked)}))};b.loadLabeledSwitchComponents=
()=>d.loadCalciteComponents({icon:()=>new Promise((l,k)=>a(["../../chunks/calcite-icon"],l,k)),label:()=>new Promise((l,k)=>a(["../../chunks/calcite-label"],l,k)),switch:()=>new Promise((l,k)=>a(["../../chunks/calcite-switch"],l,k)),tooltip:()=>new Promise((l,k)=>a(["../../chunks/calcite-tooltip"],l,k))});Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SketchTooltipControls/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,d,m,p,l,k){b=class extends b{constructor(E){super(E);this.header=this.directionModePicker=!1;this.tooltipsToggle=this.labelsToggle=!0}};a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"directionModePicker",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"labelsToggle",void 0);a.__decorate([d.property({type:Boolean,nonNullable:!0})],b.prototype,"tooltipsToggle",
void 0);return b=a.__decorate([k.subclass("esri.widgets.support.SketchTooltipControls.VisibleElements")],b)})},"esri/widgets/support/SnappingControls":function(){define("require ../../chunks/tslib.es6 ../../core/arrayUtils ../../core/asyncUtils ../../core/maybe ../../core/reactiveUtils ../../core/uid ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../Widget ../../chunks/componentsUtils ./globalCss ./LabeledSwitch ./widgetUtils ./decorators/messageBundle ./jsxFactory ./SnappingControls/SnappingControlsViewModel ./SnappingControls/snappingLayerListUtils ./SnappingControls/VisibleElements".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N){q=class extends t{constructor(G,P){super(G,P);this._gridLoadTask=this._layerListFilter=this._defaultViewModel=null;this.layerListOpen=!0;this.gridOptionsOpen=!1;this.snappingManager=this.messagesCommon=this.messages=null;this.visibleElements=new N;this._enableSnappingSwitchChange=S=>{this.snappingOptions.enabled=S};this._featureEnabledSwitchChange=S=>{this.snappingOptions.featureEnabled=S};this._gridEnabledSwitchChange=S=>{(this.snappingOptions.gridEnabled=
S)&&this._startLoadGrid()};this._selfEnabledSwitchChange=S=>{this.snappingOptions.selfEnabled=S};this._onToggleLayersButtonClick=S=>{this.viewModel.toggleSnappingForAllLayers(!this.viewModel.allLayersEnabled);B.setFocus(S.target)};const {snappingOptions:z,view:C,viewModel:L}=G;this.viewModel=L??(this._defaultViewModel=new D({snappingOptions:z,view:C}))}normalizeCtorArgs(G){const {snappingOptions:P,view:z,viewModel:C,...L}=G;return L}destroy(){this.viewModel!==this._defaultViewModel&&(this._defaultViewModel=
p.destroyMaybe(this._defaultViewModel))}loadDependencies(){return Promise.all([A.loadCalciteComponents({block:()=>new Promise((G,P)=>a(["../../chunks/calcite-block"],G,P)),button:()=>new Promise((G,P)=>a(["../../chunks/calcite-button"],G,P)),input:()=>new Promise((G,P)=>a(["../../chunks/calcite-input"],G,P)),list:()=>new Promise((G,P)=>a(["../../chunks/calcite-list"],G,P)),"list-item":()=>new Promise((G,P)=>a(["../../chunks/calcite-list-item"],G,P)),checkbox:()=>new Promise((G,P)=>a(["../../chunks/calcite-checkbox"],
G,P)),loader:()=>new Promise((G,P)=>a(["../../chunks/calcite-loader"],G,P))}),v.loadLabeledSwitchComponents()])}initialize(){this.addHandles(l.watch(()=>"2d"===this.view?.type&&!!this.view.grid,G=>{this.visibleElements.gridControls&&(this.snappingOptions.gridEnabled=G)}))}get _openAndReady(){return this.gridOptionsOpen&&this.snappingOptions.gridEnabled&&this.snappingOptions.enabled}get icon(){return"snap-to-point"}set icon(G){this._overrideIfSome("icon",G)}get label(){return this.messages?.widgetLabel??
""}set label(G){this._overrideIfSome("label",G)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(G){this.viewModel.snappingOptions=G}get view(){return this.viewModel.view}set view(G){this.viewModel.view=G}set viewModel(G){if(G!==this._get("viewModel")){if(null==this._defaultViewModel||this._defaultViewModel!==G)this._defaultViewModel=p.destroyMaybe(this._defaultViewModel);this._set("viewModel",G)}}render(){const {label:G}=this;return w.tsx("div",{"aria-label":G,class:this.classes("esri-snapping-controls",
x.globalCss.widget)},w.tsx("div",{class:"esri-snapping-controls__container"},this._renderContent()))}_renderContent(){return[this._renderToggles(),this._renderLayerList(),"2d"===this.view?.type&&this.visibleElements.gridControls?this._renderGridOptions():null]}_renderToggles(){const {visibleElements:G,view:P}=this;var z=[G.selfEnabledToggle?this._renderSelfEnabledToggle():null,G.featureEnabledToggle?this._renderFeatureEnabledToggle():null,G.gridEnabledToggle&&"2d"===P?.type?this._renderGridEnabledToggle():
null].filter(d.isSome);z=[G.enabledToggle?this._renderEnabledToggle():null,0<z.length?w.tsx("div",{class:"esri-snapping-controls__nested-container"},z):null].filter(d.isSome);return 0===z.length?null:w.tsx("calcite-block",{class:"esri-snapping-controls__toggle-block",heading:G.header?this.label:"",key:"toggle-block",open:!0},z)}_renderEnabledToggle(){return w.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.enabled,disabled:this._enabledToggleDisabled,key:`${this.id}__enabled-toggle`,label:this.messages.enableSnapping,
onChange:this._enableSnappingSwitchChange})}_renderSelfEnabledToggle(){return w.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.selfEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__self-enabled-toggle`,label:this.messages.geometryGuides,onChange:this._selfEnabledSwitchChange})}_renderFeatureEnabledToggle(){return w.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.featureEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__feature-enabled-toggle`,
label:this.messages.featureToFeature,onChange:this._featureEnabledSwitchChange})}_renderGridEnabledToggle(){return w.tsx(v.LabeledSwitch,{checked:this.viewModel.snappingOptions.gridEnabled,disabled:this._secondaryElementsDisabled,key:`${this.id}__grid-enabled-toggle`,label:this.messages.grid,onChange:this._gridEnabledSwitchChange})}_renderLayerList(){if(!this.visibleElements.layerList)return null;const {messages:G,viewModel:P}=this;var z=({target:{value:L}})=>{this._layerListFilter=""===L?null:new RegExp(L,
"i")};z=9<P.layerListViewModel.operationalItems.length?w.tsx("calcite-input",{class:"esri-snapping-controls__layer-list__filter",clearable:!0,placeholder:G?.searchLayers,onCalciteInputInput:z}):null;const C=this._secondaryElementsDisabled;return w.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:this._secondaryElementsDisabled,heading:G.snappingLayers,key:"list-block",open:this.layerListOpen&&!C,onCalciteBlockToggle:L=>this.layerListOpen=L.target.open},
z,this._renderToggleLayersButton(),w.tsx("calcite-list",{class:"esri-snapping-controls__layer-list",selectionMode:"none"},this._renderLayerListItemCollection(P.layerListViewModel.operationalItems)))}_renderGridOptions(){const {view:G,visibleElements:P,snappingManager:z,snappingOptions:C,_openAndReady:L}=this,{gridEnabled:S,enabled:r}=C;(L||"2d"===G?.type&&G.grid)&&this._startLoadGrid();var J=this._gridLoadTask?.value;J=J&&"2d"===G?.type&&w.tsx(J,{snappingManager:z,snappingOptions:C,view:G,visibleElements:P.gridControlsElements});
return w.tsx("calcite-block",{class:"esri-snapping-controls__layer-list-block",collapsible:!0,disabled:!S||!r,heading:this.messages.gridOptionsHeading,key:"grid-block",open:L,onCalciteBlockClose:()=>this.gridOptionsOpen=!1,onCalciteBlockOpen:()=>this.gridOptionsOpen=!0},J??w.tsx("calcite-loader",{label:this.messagesCommon.loading,scale:"s",text:this.messagesCommon.loading}))}async _startLoadGrid(){!this._gridLoadTask&&this.visibleElements.gridControls&&"2d"===this.view?.type&&(this._gridLoadTask=
m.createTask(async()=>(await new Promise((G,P)=>a(["./GridControls"],z=>G(Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}))),P))).default))}_renderLayerListItemCollection(G){const P=this._layerListFilter;return G.map(z=>{switch(P?K.itemTitleMatchesFilter(z,P):null){case "children":const C=z.children.filter(L=>!1!==K.itemTitleMatchesFilter(L,P));return this._renderLayerListItemGroup(z,C);case "self":case null:return this._renderLayerListItemOrGroup(z);
case !1:return"self"===K.itemTitleMatchesFilter(z.parent,P)?this._renderLayerListItemOrGroup(z):null}}).toArray().filter(d.isSome)}_renderToggleLayersButton(){if(!this.visibleElements.layerListToggleLayersButton)return null;const {viewModel:{allLayersEnabled:G},messages:P}=this,z=G?P.disableAllLayers:P.enableAllLayers;return w.tsx("calcite-button",{appearance:"transparent",class:"esri-snapping-controls__layer-list__button",label:z,name:"layer-toggle",onclick:this._onToggleLayersButtonClick},z)}_renderLayerListItemOrGroup(G){if(G.children.length)return this._renderLayerListItemGroup(G);
const {messages:{untitledLayer:P}}=this,z=()=>{this.viewModel.toggleSnappingForLayers([G.layer.id],"enabled"!==G.enabled)};return w.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__item",key:`${this.id}-list-item-${G.uid}`,label:G.title||P,onCalciteListItemSelect:C=>{C.stopPropagation();z()}},w.tsx("calcite-checkbox",{checked:"enabled"===G.enabled,slot:"actions-start",onCalciteCheckboxChange:z}))}_renderLayerListItemGroup(G,P){const {children:z,title:C}=G,L=C||this.messages.untitledLayer,
S=C&&""!==C?C:k.generateUID(),r=P??z,J=()=>{this.viewModel.toggleSnappingForLayers(G.childLayerIds,"enabled"!==G.enabled)};return w.tsx("calcite-list-item",{class:"esri-snapping-controls__layer-list__group",key:S,label:L,open:!!P?.length,onCalciteListItemSelect:M=>{M.stopPropagation();J()}},w.tsx("calcite-checkbox",{checked:"enabled"===G.enabled,indeterminate:"indeterminate"===G.enabled,slot:"actions-start",onCalciteCheckboxChange:J}),w.tsx("calcite-list",null,this._renderLayerListItemCollection(r)))}get _enabledToggleDisabled(){const G=
this.snappingOptions;return G.enabledToggled||G.forceDisabled}get _secondaryElementsDisabled(){return this._enabledToggleDisabled||!this.snappingOptions.enabled}};b.__decorate([E.property()],q.prototype,"_defaultViewModel",void 0);b.__decorate([E.property()],q.prototype,"_layerListFilter",void 0);b.__decorate([E.property()],q.prototype,"_gridLoadTask",void 0);b.__decorate([E.property()],q.prototype,"_openAndReady",null);b.__decorate([E.property()],q.prototype,"label",null);b.__decorate([E.property({type:Boolean,
nonNullable:!0})],q.prototype,"layerListOpen",void 0);b.__decorate([E.property({type:Boolean,nonNullable:!0})],q.prototype,"gridOptionsOpen",void 0);b.__decorate([E.property(),n.messageBundle("esri/widgets/support/SnappingControls/t9n/SnappingControls")],q.prototype,"messages",void 0);b.__decorate([E.property(),n.messageBundle("esri/t9n/common")],q.prototype,"messagesCommon",void 0);b.__decorate([E.property()],q.prototype,"snappingOptions",null);b.__decorate([E.property()],q.prototype,"snappingManager",
void 0);b.__decorate([E.property()],q.prototype,"view",null);b.__decorate([E.property()],q.prototype,"viewModel",null);b.__decorate([E.property({type:N,nonNullable:!0})],q.prototype,"visibleElements",void 0);b.__decorate([E.property()],q.prototype,"_enabledToggleDisabled",null);b.__decorate([E.property()],q.prototype,"_secondaryElementsDisabled",null);return q=b.__decorate([u.subclass("esri.widgets.support.SnappingControls")],q)})},"esri/widgets/support/SnappingControls/SnappingControlsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../views/interactive/snapping/FeatureSnappingLayerSource ../../../views/interactive/snapping/SnappingOptions ../../LayerList/support/layerListUtils ./SnappingLayerListViewModel".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A){b=class extends b{constructor(x){super(x);this.layerListViewModel=new A.SnappingLayerListViewModel;this.snappingOptions=new u;this.view=null}initialize(){this.addHandles([m.watch(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:x,view:v})=>{x.view=v},m.initial),m.watch(()=>({viewModel:this.layerListViewModel,sources:this.snappingOptions?.featureSources}),({viewModel:x,sources:v})=>{x.featureSnappingSources=v},m.initial)])}get allLayersEnabled(){return(this.layerListViewModel?.selectableItems??
[]).every(x=>"enabled"===x.enabled)}get allLayersDisabled(){return(this.layerListViewModel?.selectableItems??[]).every(x=>!x.enabled)}get layersEnabledCount(){return this.layerListViewModel?.selectableItems?.filter(x=>"enabled"===x.enabled).length??0}get state(){return this.snappingOptions?"ready":"disabled"}toggleSnappingForLayers(x,v){x?.forEach(B=>v?this.enableSnappingForLayer(B):this.disableSnappingForLayer(B))}toggleSnappingForAllLayers(x){this.layerListViewModel.selectableItems.forEach(({layer:{id:v}})=>
{x?this.enableSnappingForLayer(v):this.disableSnappingForLayer(v)})}enableSnappingForLayer(x){if(x=this._findSnappingSourceForLayer(x)??this._makeSnappingSourceForLayer(x))x.enabled=!0}disableSnappingForLayer(x){if(x=this._findSnappingSourceForLayer(x))x.enabled=!1}updateEnabledFeatureSources(x){for(const v of this.snappingOptions.featureSources)t.canDisplayLayer(v.layer)&&(v.enabled=x.includes(v.layer.id))}_findSnappingSourceForLayer(x){return this.snappingOptions.featureSources.find(v=>v.layer.id===
x)}_makeSnappingSourceForLayer(x){var v=this.layerListViewModel.operationalItemsFlat.find(B=>B.layer.id===x)?.layer;if(!v)throw new d("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${x} because no such layer was found in the view`);if("group"!==v.type)return v=new f({layer:v}),this.snappingOptions.featureSources.add(v),v}};a.__decorate([p.property()],b.prototype,"allLayersEnabled",null);a.__decorate([p.property()],b.prototype,"allLayersDisabled",null);a.__decorate([p.property({constructOnly:!0})],
b.prototype,"layerListViewModel",void 0);a.__decorate([p.property()],b.prototype,"layersEnabledCount",null);a.__decorate([p.property({type:u,nonNullable:!0})],b.prototype,"snappingOptions",void 0);a.__decorate([p.property()],b.prototype,"state",null);a.__decorate([p.property()],b.prototype,"view",void 0);return b=a.__decorate([q.subclass("esri.widgets.support.SnappingControls.SnappingControlsViewModel")],b)})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(a){function b(q){return q?.listMode??
void 0}function d(q){return null!=q&&"minScale"in q&&null!=q.minScale?q.minScale:void 0}function m(q){return null!=q&&"maxScale"in q&&null!=q.maxScale?q.maxScale:void 0}function p(q){if(q&&!("type"in q&&"wmts"===q.type))return"sublayers"in q?"sublayers":"layers"in q?"layers":void 0}function l(q,f){q?.sort((u,t)=>{u="uid"in u?f.indexOf(u.uid):-1;t="uid"in t?f.indexOf(t.uid):-1;return u>t?-1:u<t?1:0})}function k(q){return null!=q&&"layer"in q&&null!=q.layer}function E(q){return q&&"capabilities"in q&&
null!=q.capabilities&&"exportMap"in q.capabilities?q.capabilities.exportMap:void 0}a.areChildrenHidden=function(q){return"hide-children"===q?.listMode};a.canDisplayLayer=function(q){return"hide"!==b(q)};a.canSortSublayers=function(q){q=(q?.layer&&k(q.layer)?q.layer.layer:void 0)??q?.layer;if(!q)return!1;"catalog"===q.type?q=!1:(q=E(q),q=(null!=q&&"supportsDynamicLayers"in q?q.supportsDynamicLayers:void 0)??!0);return q};a.findLayerListMode=b;a.findLayerMaxScale=m;a.findLayerMinScale=d;a.findLayerVisibilityMode=
function(q){if(!q)return"inherited";var f=k(q)?q.layer:q;f=E(f);f=null!=f&&"supportsSublayerVisibility"in f?f.supportsSublayerVisibility:void 0;return null!=f?f?"independent":"inherited":"visibilityMode"in q&&null!=q.visibilityMode?q.visibilityMode:"independent"};a.getItem=function(q){return q?.["data-item"]};a.getItemLayers=function(q){return(q=q?.layer)&&"layers"in q?q.layers:null};a.getLayerType=function(q){return q?.getAttribute("data-layer-type")};a.getNormalizedChildLayerProperty=p;a.getSingleAction=
function(q){for(const f of q)for(const u of f)if("button"===u.type||"toggle"===u.type)return u};a.getStatusIcon=function({connectionStatus:q,publishing:f}){return q?"connected"===q?"beacon":"offline":f?"square":"bullet-point"};a.getVisibilityIcon=function({exclusive:q,visible:f,visibilityAppearance:u}){u="checkbox"===u;return f?q?"circle-f":u?"check-square-f":"view-visible":q?"circle":u?"square":"view-hide"};a.isLayerOutsideScaleRange=function(q,f){if(!q||null==f||isNaN(f))return!1;var u=d(q);q=m(q);
u=null!=u&&!isNaN(u)&&0<u&&f>u;f=null!=q&&!isNaN(q)&&0<q&&f<q;return u||f};a.isSublayer=k;a.listItemHasChildren=function({children:q,error:f,incompatible:u}){return!!q?.filter(t=>!t.hidden).length&&!f&&!u};a.minDragEnabledItems=2;a.minFilterItems=10;a.sortChildLayersToIds=function(q,f){if(q=q?.layer){var u=p(q);if(u){if("layers"===u&&"layers"in q)var t=q.layers;else"sublayers"===u&&"sublayers"in q&&(t=q.sublayers);l(t,f)}}};a.sortLayersToIds=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/support/SnappingControls/SnappingLayerListViewModel":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../LayerList/LayerListViewModel ./snappingLayerListUtils ./SnappingListItem".split(" "),function(a,b,d,m,p,l,k,E,q,f,u){a.SnappingLayerListViewModel=class extends q{constructor(){super(...arguments);
this.featureSnappingSources=new d}get operationalItemsFlat(){return this.operationalItems.flatten(t=>t.children)}get selectableItems(){return this.operationalItemsFlat.filter(t=>!t.children?.length)}_compileList(){var t=this.view?.map?.layers;t&&(t=t.filter(f.isValidSnappingLayer),this._watchLayersListMode(t),t=this._getViewableLayers(t),t?.length?(this._createNewItems(t),this._removeItems(t),this._sortItems(t)):this._removeAllItems())}_createListItem(t){return new u.SnappingListItem({layer:t,view:this.view,
getFeatureSnappingSources:()=>this.featureSnappingSources})}};b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"featureSnappingSources",void 0);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"operationalItems",void 0);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"operationalItemsFlat",null);b.__decorate([m.property()],a.SnappingLayerListViewModel.prototype,"selectableItems",null);a.SnappingLayerListViewModel=b.__decorate([E.subclass("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],
a.SnappingLayerListViewModel);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../linkChart/utils ./ListItem ./support/layerListUtils".split(" "),function(a,b,d,m,p,l,k,E,q,f,u,t){const A=
b.ofType(u);b=class extends d.EventedAccessor{constructor(x){super(x);this.checkPublishStatusEnabled=!1;this.listItemCreatedFunction=null;this.listModeDisabled=!1;this.operationalItems=new A;this.view=null}initialize(){this.addHandles([m.watch(()=>!0===this.view?.ready,()=>this._viewHandles(),m.initial),m.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),m.watch(()=>f.isLinkChartView(this.view)?this.view.inGeographicLayout:null,
()=>this._compileList())],"view")}destroy(){this._removeAllItems();this.view=null}get state(){const {view:x}=this;return x?.ready?"ready":x?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(x=>x.children).length}triggerAction(x,v){x&&!x.disabled&&this.emit("trigger-action",{action:x,item:v})}moveListItem(x,v,B,n){const w=x?.layer;if(w&&"subtype-sublayer"!==w.type&&"sublayer"!==w.type){var D=this.view?.map?.layers,K=v?t.getItemLayers(v):D;D=B?t.getItemLayers(B):D;if(K&&D){var {operationalItems:N}=
this,G=B?.children||N;n=D.length-n;x.parent=B||null;(v?.children||N).remove(x);K.remove(w);G.includes(x)||G.add(x,n);D.includes(w)||D.add(w,n);this._compileList()}}}_createLayerViewHandles(x){this.removeHandles("layer-views");this._compileList();x&&this.addHandles(x.on("change",()=>this._compileList()),"layer-views")}_createMapLayerHandles(x){this.removeHandles("map-layers");this._compileList();x&&this.addHandles(x.on("change",()=>this._compileList()),"map-layers")}_createListItem(x){const {view:v,
listItemCreatedFunction:B,checkPublishStatusEnabled:n,listModeDisabled:w}=this;return new u({checkPublishStatusEnabled:n,listModeDisabled:w,layer:x,listItemCreatedFunction:B,view:v})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(x){return x?this.listModeDisabled?x:x.filter(v=>"hide"!==t.findLayerListMode(v)):void 0}_watchLayersListMode(x){this.removeHandles("layer-list-mode");x&&!this.listModeDisabled&&this.addHandles(m.watch(()=>x.filter(v=>"listMode"in v).map(v=>v.listMode).toArray(),
()=>this._compileList()),"layer-list-mode")}_compileList(){var x=this.view?.map?.layers;x=f.isLinkChartView(this.view)&&!this.view.inGeographicLayout?x?.filter(({type:v})=>"link-chart"===v):x;this._watchLayersListMode(x);x=this._getViewableLayers(x);x?.length?(this._createNewItems(x),this._removeItems(x),this._sortItems(x)):this._removeAllItems()}_createNewItems(x){const {operationalItems:v}=this;x.forEach(B=>{v.some(n=>n.layer===B)||v.add(this._createListItem(B))})}_removeItems(x){const {operationalItems:v}=
this,B=[];v.forEach(n=>{n&&x&&x.includes(n.layer)||B.push(n)});v.destroyMany(B)}_sortItems(x){const {operationalItems:v}=this;v.sort((B,n)=>{B=x.indexOf(B.layer);n=x.indexOf(n.layer);return B>n?-1:B<n?1:0})}_recompileList(){this._removeAllItems();this._compileList()}_viewHandles(){const {view:x}=this;this.removeHandles(["map-layers","layer-views","view-layers"]);x?.ready?this.addHandles([m.watch(()=>this.view?.map?.allLayers,v=>this._createMapLayerHandles(v),m.initial),m.watch(()=>this.view?.allLayerViews,
v=>this._createLayerViewHandles(v),m.initial)],"view-layers"):this._removeAllItems()}};a.__decorate([p.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([p.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([p.property({nonNullable:!0})],b.prototype,"listModeDisabled",void 0);a.__decorate([p.property({type:A})],b.prototype,"operationalItems",void 0);a.__decorate([p.property({readOnly:!0})],b.prototype,"state",null);a.__decorate([p.property()],b.prototype,
"totalItems",null);a.__decorate([p.property()],b.prototype,"view",void 0);return b=a.__decorate([q.subclass("esri.widgets.LayerList.LayerListViewModel")],b)})},"esri/linkChart/utils":function(){define(["exports"],function(a){a.isLinkChartView=function(b){return null!=b&&"object"===typeof b&&"2d"===b.type&&"linkchart"===b.view2dType};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/ListItem":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Identifiable ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionSlider ../../support/actions/ActionToggle ./ListItemPanel ./support/layerListUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n){var w;q=m.ofType({key:"type",defaultKeyValue:"button",base:t,typeMap:{button:A,toggle:v,slider:x}});const D=m.ofType(q);b=w=class extends p.IdentifiableMixin(b){constructor(K){super(K);this.actionsSections=new D;this.checkPublishStatusEnabled=this.actionsOpen=!1;this.children=new (m.ofType(w));this.childrenSortable=!0;this.hidden=!1;this.listItemCreatedFunction=this.layer=null;this.open=this.listModeDisabled=!1;this.view=this.parent=this.panel=null}initialize(){this.addHandles([l.watch(()=>
[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),l.initial),l.watch(()=>this.checkPublishStatusEnabled,K=>this._updateChildrenPublishing(K),l.initial),l.watch(()=>this.view,K=>this._updateChildrenView(K),l.initial),l.watch(()=>this.panel,K=>this._setListItemOnPanel(K),l.initial)]);"function"===typeof this.listItemCreatedFunction&&this.listItemCreatedFunction.call(null,{item:this})}destroy(){this.panel?.destroy();this.children.destroyAll();this.view=
null}get connectionStatus(){const {layerView:K,publishing:N}=this;if(!N&&K&&"connectionStatus"in K)return K.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const {layerView:K}=this;return K&&"spatialReferenceSupported"in K?!K.spatialReferenceSupported:!1}get layerView(){const {layer:K,view:N}=this;if(!K||!N||"sublayer"===K.type)return null;const G="subtype-sublayer"===K.type?K.parent:K;return N.allLayerViews.find(P=>P.layer===G)??null}castPanel(K){this.panel?.open&&!K.hasOwnProperty("open")&&
(K.open=!0);return K?new B(K):null}get sortable(){return"knowledge-graph-sublayer"===this.layer?.type?!1:this._get("sortable")}set sortable(K){this._set("sortable",K)}get title(){const K=u.get(this,"layer.layer");return(!K||K&&u.get(this,"layer.layer.loaded"))&&u.get(this,"layer.title")||u.get(this,"layer.attributes.title")||""}set title(K){this._override("title",K)}get publishing(){const {layer:K,checkPublishStatusEnabled:N}=this;return N&&K&&"publishingInfo"in K&&"publishing"===K.publishingInfo?.status}get updating(){const {layerView:K,
connectionStatus:N,layer:G,publishing:P}=this;return P||N?!1:K?K.updating:"loading"===G?.loadStatus||!1}get visible(){return this.layer?.visible}set visible(K){const N=this.layer;N&&(N.visible=K)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!n.isLayerOutsideScaleRange(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return n.findLayerVisibilityMode(this.layer)}clone(){return new w({actionsSections:this.actionsSections.clone(),
actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(K){K&&(K.listItem=this)}_updateChildrenPublishing(K){const N=this.children;
N&&N.forEach(G=>G.checkPublishStatusEnabled=K)}_updateChildrenView(K){const N=this.children;N&&N.forEach(G=>G.view=K)}_createChildren(K){const {listModeDisabled:N,children:G}=this;K=K.filter(P=>!G.some(z=>z.layer===P));G.addMany(this._createChildItems(K,N))}_destroyChildren(K){const {children:N}=this,G=N.filter(P=>!K.includes(P.layer));N.destroyMany(G)}_sortChildren(K){this.children.sort((N,G)=>K.indexOf(G.layer)-K.indexOf(N.layer))}_destroyAllChildren(){this.removeHandles("child-list-mode");this.children.destroyAll()}_watchChildLayerListMode(K){this.removeHandles("child-list-mode");
this.listModeDisabled||this.addHandles(K.toArray().map(N=>l.watch(()=>N.listMode,()=>this._compileChildren(K))),"child-list-mode")}_compileChildren(K){const N=this.listModeDisabled?K:K?.filter(G=>"hide"!==n.findLayerListMode(G));N?.length?(this._createChildren(N),this._destroyChildren(N),this._sortChildren(N),this._watchChildLayerListMode(K)):this._destroyAllChildren()}_watchSublayerChanges(K){K&&this.addHandles(K.on("change",()=>this._compileChildren(K)),"layer")}_initializeChildLayers(K){this._compileChildren(K);
this._watchSublayerChanges(K)}_createChildItems(K,N){return K.map(G=>N||n.canDisplayLayer(G)?new w({layer:G,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(d.isSome).reverse()}_watchLayerProperties(K){this.removeHandles("layer");this.removeHandles("child-list-mode");if(K)if("hide-children"===(!this.listModeDisabled&&n.findLayerListMode(K)))this.children.destroyAll();
else{var N=n.getNormalizedChildLayerProperty(K);N&&this.addHandles(l.watch(()=>K[N],G=>{K.hasOwnProperty(N)&&this._initializeChildLayers(G)},l.initial),"layer")}}};a.__decorate([k.property({type:D})],b.prototype,"actionsSections",void 0);a.__decorate([k.property()],b.prototype,"actionsOpen",void 0);a.__decorate([k.property()],b.prototype,"checkPublishStatusEnabled",void 0);a.__decorate([k.property({type:m})],b.prototype,"children",void 0);a.__decorate([k.property()],b.prototype,"childrenSortable",
void 0);a.__decorate([k.property({readOnly:!0})],b.prototype,"connectionStatus",null);a.__decorate([k.property({readOnly:!0})],b.prototype,"error",null);a.__decorate([k.property()],b.prototype,"hidden",void 0);a.__decorate([k.property({readOnly:!0})],b.prototype,"incompatible",null);a.__decorate([k.property()],b.prototype,"layer",void 0);a.__decorate([k.property({readOnly:!0})],b.prototype,"layerView",null);a.__decorate([k.property()],b.prototype,"listItemCreatedFunction",void 0);a.__decorate([k.property({nonNullable:!0})],
b.prototype,"listModeDisabled",void 0);a.__decorate([k.property()],b.prototype,"open",void 0);a.__decorate([k.property({type:B})],b.prototype,"panel",void 0);a.__decorate([E.cast("panel")],b.prototype,"castPanel",null);a.__decorate([k.property()],b.prototype,"parent",void 0);a.__decorate([k.property({value:!0})],b.prototype,"sortable",null);a.__decorate([k.property()],b.prototype,"title",null);a.__decorate([k.property({readOnly:!0})],b.prototype,"publishing",null);a.__decorate([k.property({readOnly:!0})],
b.prototype,"updating",null);a.__decorate([k.property()],b.prototype,"view",void 0);a.__decorate([k.property()],b.prototype,"visible",null);a.__decorate([k.property({readOnly:!0})],b.prototype,"visibleAtCurrentScale",null);a.__decorate([k.property({readOnly:!0})],b.prototype,"visibleAtCurrentTimeExtent",null);a.__decorate([k.property({readOnly:!0})],b.prototype,"visibilityMode",null);return b=w=a.__decorate([f.subclass("esri.widgets.LayerList.ListItem")],b)})},"esri/support/actions/ActionSlider":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./ActionBase".split(" "),
function(a,b,d,m,p,l,k){var E;d=E=class extends k{constructor(q){super(q);this.displayValueEnabled=!1;this.max=1;this.min=0;this.step=.1;this.type="slider";this.value=null}clone(){return new E({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};a.__decorate([b.property()],d.prototype,"displayValueEnabled",
void 0);a.__decorate([b.property()],d.prototype,"max",void 0);a.__decorate([b.property()],d.prototype,"min",void 0);a.__decorate([b.property()],d.prototype,"step",void 0);a.__decorate([b.property()],d.prototype,"value",void 0);return d=E=a.__decorate([l.subclass("esri.support.actions.ActionSlider")],d)})},"esri/widgets/LayerList/ListItemPanel":function(){define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u,t,A,x){d=class extends d.IdentifiableMixin(u){constructor(v,B){super(v,B);this.content=this.className=this._legend=null;this.flowEnabled=!1;this.listItem=this.image=null;this.open=!1;this.visible=!0}initialize(){this.addHandles([p.watch(()=>this._canCreateLegend,()=>this._createLegend(),p.initial),p.watch(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),p.initial)])}destroy(){this._legend=m.destroyMaybe(this._legend)}get _canCreateLegend(){const {content:v,
listItem:B}=this;return B?"legend"===v?!0:null!=v&&(Array.isArray(v)?v.includes("legend"):!1):!1}get _legendOptions(){const {listItem:v,_legendLayerInfo:B}=this,n=v?.view;return B&&n?{view:n,layerInfos:[B]}:{}}get _legendLayerInfo(){const v=this.listItem?.layer;if(!v||"subtype-sublayer"===v.type)return null;var B=t.isSublayer(v)?v:null;const n=v?.parent;return(B=null!=n&&"type"in n&&"map-image"===n.type?B?.source:null)&&n?{layer:n,title:"",sublayerIds:[B.mapLayerId]}:{layer:v,title:""}}get disabled(){const {listItem:v,
_legend:B,content:n}=this;return v?Array.isArray(n)&&1<n.length?!1:B?!B.activeLayerInfos?.length||!v.visibleAtCurrentScale||!v.visible:!1:!0}set disabled(v){this._overrideIfSome("disabled",v)}get icon(){const {image:v}=this,B=this._getFirstWidget();return this._get("icon")??(!v&&B?B.icon:null)}set icon(v){this._overrideIfSome("icon",v)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(v){this._override("title",v)}render(){return x.tsx("div",{class:"esri-list-item-panel"},
this._renderContents())}_renderContent(v){const {_legend:B,disabled:n,open:w}=this;return v&&!n&&w?"legend"===v&&B?x.tsx("div",{key:"legend-widget"},B.render()):"string"===typeof v?x.tsx("div",{innerHTML:v,key:v}):A.isWidget(v)?x.tsx("div",{key:"content-widget"},v.render()):v instanceof HTMLElement?x.tsx("div",{afterCreate:this._attachToNode,bind:v,key:"content-element"}):null:null}_renderContents(){const {content:v,open:B}=this;return B?Array.isArray(v)?v.map(n=>this._renderContent(n)):this._renderContent(v):
null}async _createLegend(){m.destroyMaybe(this._legend);this._legend=null;if(this._canCreateLegend){var {default:v}=await new Promise((B,n)=>a(["../Legend"],w=>B(Object.freeze(Object.defineProperty({__proto__:null,default:w},Symbol.toStringTag,{value:"Module"}))),n));this._legend=new v(this._legendOptions)}}_attachToNode(v){v.appendChild(this)}_updateLegend(){const v=this._legend;v&&v.set(this._legendOptions)}_getWidget(v){return"legend"===v?this._legend:A.isWidget(v)?v:null}_getFirstWidget(){const {content:v}=
this;return Array.isArray(v)?v.map(B=>this._getWidget(B)).find(B=>B):this._getWidget(v)}};b.__decorate([l.property()],d.prototype,"_legend",void 0);b.__decorate([l.property()],d.prototype,"_canCreateLegend",null);b.__decorate([l.property()],d.prototype,"_legendOptions",null);b.__decorate([l.property()],d.prototype,"_legendLayerInfo",null);b.__decorate([l.property()],d.prototype,"className",void 0);b.__decorate([l.property()],d.prototype,"content",void 0);b.__decorate([l.property()],d.prototype,"disabled",
null);b.__decorate([l.property()],d.prototype,"flowEnabled",void 0);b.__decorate([l.property()],d.prototype,"icon",null);b.__decorate([l.property()],d.prototype,"image",void 0);b.__decorate([l.property()],d.prototype,"listItem",void 0);b.__decorate([l.property()],d.prototype,"open",void 0);b.__decorate([l.property()],d.prototype,"title",null);b.__decorate([l.property()],d.prototype,"visible",void 0);return d=b.__decorate([f.subclass("esri.widgets.LayerList.ListItemPanel")],d)})},"esri/widgets/support/SnappingControls/snappingLayerListUtils":function(){define(["exports",
"../../LayerList/support/layerListUtils"],function(a,b){const d=k=>m(k)||p(k),m=k=>{if(!("type"in k))return!1;switch(k.type){case "feature":case "geojson":case "csv":case "graphics":case "wfs":case "map-notes":case "oriented-imagery":case "scene":case "building-scene":case "subtype-sublayer":return!0;default:return!1}},p=k=>{const E=b.getNormalizedChildLayerProperty(k);if(null!=E&&k.hasOwnProperty(E)&&null!=k[E])for(const q of k[E])if(d(q))return!0;return!1},l=(k,E)=>{if(null!=E&&null!=k){if(E.test(k.title))return"self";
if(k.children.some(q=>!1!==l(q,E)))return"children"}return!1};a.isValidSnappingLayer=d;a.isValidSnappingLayerGroup=p;a.isValidSnappingLayerSource=m;a.itemTitleMatchesFilter=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/SnappingControls/SnappingListItem":function(){define("exports ../../../chunks/tslib.es6 ../../../core/arrayUtils ../../../core/Collection ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../LayerList/ListItem ../../LayerList/support/layerListUtils ./snappingLayerListUtils".split(" "),
function(a,b,d,m,p,l,k,E,q,f,u){var t;a.SnappingListItem=t=class extends q{constructor(A){super(A);this.children=new m;this.parent=null}get enabled(){const {children:A}=this;if(0===A.length)return null!=this.featureSource?this.featureSource.enabled?"enabled":"disabled":"disabled";let x=!1,v=!1;for(const B of A){if("indeterminate"===B.enabled)return B.enabled;"enabled"===B.enabled?x=!0:"disabled"===B.enabled&&(v=!0);if(v&&x)return"indeterminate"}return v?"disabled":"enabled"}get childLayerIds(){return this.children.toArray().flatMap(A=>
[A.layer.id,...A.childLayerIds])}get featureSource(){const {layer:A,getFeatureSnappingSources:x}=this;return x().find(v=>v.layer===A)}_initializeChildLayers(A){A&&(A=A.filter(u.isValidSnappingLayer),super._initializeChildLayers(A))}_createChildItems(A){return A.map(x=>f.canDisplayLayer(x)?new t({layer:x,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).filter(d.isSome).reverse()}};b.__decorate([p.property()],a.SnappingListItem.prototype,"enabled",null);b.__decorate([p.property()],
a.SnappingListItem.prototype,"children",void 0);b.__decorate([p.property()],a.SnappingListItem.prototype,"childLayerIds",null);b.__decorate([p.property()],a.SnappingListItem.prototype,"featureSource",null);b.__decorate([p.property({constructOnly:!0})],a.SnappingListItem.prototype,"getFeatureSnappingSources",void 0);b.__decorate([p.property()],a.SnappingListItem.prototype,"parent",void 0);a.SnappingListItem=t=b.__decorate([E.subclass("esri.widgets.support.SnappingControls.SnappingListItem")],a.SnappingListItem);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/UpdateFeaturePanelContent":function(){define("exports ../../../intl/substitute ../workflowUtils ./FooterActions ./Notices ./PanelContent ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),function(a,b,d,m,p,l,k,E,q){a.UpdateFeaturePanelContent=function({editorViewModel:f,headingLevel:u,messages:t,messagesCommon:A,onDelete:x,onSave:v,renderAttachments:B,renderFeatureForm:n}){const {activeWorkflow:w,
featureFormViewModel:D,syncing:K}=f;if(!w||!D)return null;var N=d.isUpdateWorkflow(w)?w.activeWorkflow??w:w,G=N.type.includes("update");const P=G&&!N.hasPendingEdits||K||D.updating,z=G?A.update:A.create;G="create-features"===N?.type&&"create-new"===N.createFeatureState;N="create-features"===N?.type?N.numPendingFeatures:0;N=1<N?b.substitute(t.createFeaturesTemplate,{numFeatures:N}):z;const C=w.shouldShowAttachments&&!D.activeRelationshipInput;u=D.inputs.every(L=>!L.visible)&&!C?q.tsx(l.PanelContentMessage,
{key:"panel-content-message"},b.substitute(t.clickToFinishTemplate,{button:z})):q.tsx(l.PanelContentSection,{key:"panel-content-section"},q.tsx(p.Notices,{messages:t,workflow:w}),q.tsx(l.PanelContentSectionGroup,null,n(),C?q.tsx("div",{key:"attachments"},q.tsx(k.Heading,{level:k.incrementHeadingLevel(u)},t.attachments),B()):null));return q.tsx(q.tsxFragment,null,q.tsx(l.PanelContent,{key:"attribute-panel-content",showScrimOverlay:G},u),q.tsx(m.FooterActions,{buttons:[{onClick:v,disabled:P,label:N},
f.shouldShowDeleteButton?{appearance:"outline",onClick:x,disabled:K,kind:"danger",label:A.delete}:void 0]}))};a.loadUpdateFeaturePanelContentComponents=()=>Promise.all([m.loadFooterActionsComponents(),p.loadNoticesComponents(),l.loadPanelContentComponents()]);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Editor/components/UploadDetails":function(){define("require exports ../../../core/Error ../../../layers/graphics/sources/support/uploadAssetErrors ./FooterActions ./PanelContent ../../../chunks/componentsUtils ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,b,d,m,p,l,k,E,q){function f(B){const n=u(B);return n?q.tsx("div",{class:x.base,"data-testid":"upload-details",key:"upload-details-content"},q.tsx("div",{class:x.status,key:"status"},n.iconContent,q.tsx("div",{class:x.titleWrapper,key:"text"},q.tsx("div",{class:x.title,key:"title"},n.title),q.tsx("div",{class:x.description,key:"description"},n.description))),A(B.upload)):null}function u({helpMessage:B,messages:n,upload:w}){switch(w.state){case "pending":const {title:D,description:K}=n.modelUploads.pending;
return{title:D,description:K,iconContent:q.tsx("calcite-loader",{"aria-hidden":"true",class:x.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*w.progress),1===w.progress?100:99)})};case "success":return{title:w}=n.modelUploads.success,{title:w,description:B||n.helpMessages3d.mesh,iconContent:q.tsx("calcite-icon",{class:E.classes(x.iconSuccess),icon:"check",scale:"l"})};case "error":return{title:B}=n.modelUploads.error,{title:B,description:t(w.error,n),iconContent:q.tsx("calcite-icon",
{class:E.classes(x.iconError),icon:"exclamation-mark-circle",scale:"l"})};default:return null}}function t(B,n){if(!B)return null;n=n.modelUploads.error.messages;switch(B.constructor){case m.NoModelError:return n.noModel;case m.MultipleModelsError:return n.multipleModels;case m.Convert3DFailedError:return n.conversionFailed;case d:switch(B.name){case "glt-loader-error":case "gltf-loader-invalid-glb":return n.loadFailed;case "gltf-loader-unsupported-feature":return n.unsupportedFeature;case "glt-loader-request-error":return n.resourceRequestFailed;
default:return n.default}default:return n.default}}function A(B){return q.tsx("div",{class:x.fileList,key:"file-list"},B.files.map(n=>{var w=q.tsx,D={class:x.file,key:`file-${n.name}`},K=q.tsx,N=x.fileIcon;const G=n.name.split(".").pop()?.toLowerCase();return w.call(q,"div",D,K.call(q,"calcite-icon",{class:N,icon:(G?v[G]:null)??"file",scale:"s"}),q.tsx("span",{class:x.fileName},n.name.split("/").pop()?.split("\\").pop()??""))}))}const x={base:"esri-editor__upload-details",status:"esri-editor__upload-details__status",
titleWrapper:"esri-editor__upload-details__title-wrapper",title:"esri-editor__upload-details__title",description:"esri-editor__upload-details__description",loader:"esri-editor__upload-details__loader",iconSuccess:"esri-editor__upload-details__icon esri-editor__upload-details__icon--success",iconError:"esri-editor__upload-details__icon esri-editor__upload-details__icon--error",fileList:"esri-editor__upload-details__file-list",file:"esri-editor__upload-details__file",fileIcon:"esri-editor__upload-details__file-icon",
fileName:"esri-editor__upload-details__file-name"},v={glb:"file-shape",gltf:"file-shape",jpeg:"file-image",jpg:"file-image",png:"file-image",svg:"file-image",zip:"file-zip"};b.UploadDetails=function(B){const {messages:n,key:w,upload:D}=B;return q.tsx(q.tsxFragment,null,q.tsx(l.PanelContent,{key:w??"upload-details"},q.tsx(l.PanelContentSection,null,f(B))),"error"===D.state?q.tsx(p.FooterActions,{buttons:[{onClick:()=>D.retry(),label:n.modelUploads.error.uploadNew,iconStart:"upload-to"}],key:"upload-details-footer-actions"}):
null)};b.css=x;b.loadUploadDetailsComponents=()=>Promise.all([k.loadCalciteComponents({icon:()=>new Promise((B,n)=>a(["../../../chunks/calcite-icon"],B,n)),loader:()=>new Promise((B,n)=>a(["../../../chunks/calcite-loader"],B,n))}),p.loadFooterActionsComponents(),l.loadPanelContentComponents()]);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/support/uploadAssetErrors":function(){define(["exports","../../../../core/Error"],function(a,b){class d extends b{constructor(){super("upload-assets:unsupported",
"Layer does not support asset uploads.",Error())}}class m extends b{constructor(){super("upload-assets:no-glb-support","Layer does not support glb.",Error())}}class p extends b{constructor(){super("upload-assets:no-supported-source","No supported external source found",Error())}}class l extends b{constructor(){super("upload-assets:not-base-64","Expected gltf data in base64 format after conversion.",Error())}}class k extends b{constructor(){super("upload-assets:unable-to-prepare-options","Unable to prepare uploadAsset request options.",
Error())}}class E extends b{constructor(x,v){super("upload-assets:bad-response",`Bad response. Uploaded ${x} items and received ${v} results.`,Error())}}class q extends b{constructor(x,v){super("upload-assets-layer:upload-failed",`Failed to upload mesh file ${x}. Error code: ${v?.code??"-1"}. Error message: ${v?.messages??"unknown"}`,Error())}}class f extends b{constructor(x){super("upload-assets-layer:unsupported-format",`The service allowed us to upload an asset of FormatID ${x}, but it does not list it in its supported formats.`,
Error())}}class u extends b{constructor(){super("upload-assets:convert3D-failed","convert3D failed.")}}class t extends b{constructor(){super("invalid-input:no-model","No supported model found")}}class A extends b{constructor(){super("invalid-input:multiple-models","Multiple supported models found")}}a.BadResponseError=E;a.Convert3DFailedError=u;a.MultipleModelsError=A;a.NoGlbSupportError=m;a.NoModelError=t;a.NoSupportedSourceError=p;a.NotBase64Error=l;a.UnableToPrepareOptionsError=k;a.UnsupportedError=
d;a.UnsupportedFormatUploadedError=f;a.UploadFailedError=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/deprecate ../core/handleUtils ../core/Logger ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../views/interactive/sketch/SketchValueOptions ./Attachments ./FeatureForm ./FeatureTemplates ./Spinner ./Widget ./Editor/css ./Editor/EditorViewModel ./Editor/modelUploadUtils ./Editor/VisibleElements ./Editor/components/CreateFeaturesPanelContent ./Editor/components/FeatureList ./Editor/components/FooterActions ./Editor/components/Notices ./Editor/components/PanelContent ./Editor/components/PanelToolbar ./Editor/components/Prompt ./Editor/components/UpdateFeaturePanelContent ./Editor/components/UploadDetails ./FeatureTemplates/ItemList ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,
b,d,m,p,l,k,E,q,f,u,t,A,x,v,B,n,w,D,K,N,G,P,z,C,L,S,r,J,M,y,H,h,e,c,g,F,I,O,R,W){d=class extends D{constructor(V,aa){super(V,aa);this._featureForm=new B;this._attachments=new v({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}});this._featureTemplates=new n({enableListScroll:!1,renderItemContentEnd:fa=>fa.supportsUpload?R.tsx("calcite-icon",{class:K.css.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):
null,renderItemLabel:fa=>fa.label,renderCustomGroupContent:fa=>this._renderCustomTemplateGroupContent(fa)});this._filterText="";this._prompt=null;this._spinner=new w;this._loading=!1;this.headingLevel=4;this.supportingWidgetDefaults=this.messagesTemplates=this.messagesCommon=this.messages=null;this.viewModel=new N;this.visibleElements=new P;this._renderAttachments=()=>this._attachments.render();this._renderFeatureForm=()=>this._featureForm.render();this._renderFeatureTemplates=()=>this._featureTemplates.render();
this._renderSelectIcon=()=>R.tsx("calcite-icon",{icon:"cursor",slot:"content-start"});this.EditorPanel=({heading:fa,key:ja},...da)=>{const {visibleElements:Z}=this;return R.tsx("calcite-flow-item",{closable:!1,heading:fa,headingLevel:this.headingLevel,key:ja,loading:this._loading,onCalciteFlowItemBack:this._onBack},Z.settingsMenu?R.tsx(J.PanelToolbar,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:Z}):null,...da)};this._showDiscardEditsPrompt=()=>{const {messages:fa,
activeWorkflow:ja}=this;return"create-features"===ja?.type&&G.isModelUpload(ja.data.creationInfo)?this._showPromptAndWait("success"===ja.data.upload?.state?fa.modelUploads.cancelPlacementPrompt:fa.modelUploads.cancelUploadPrompt):this._showPromptAndWait({title:fa.cancelEditTitle,message:fa.cancelEditWarningMessage,yesLabel:fa.discardEdits,noLabel:fa.continueEditing})};this._showGenericCancelPrompt=()=>{const {messages:fa,messagesCommon:ja}=this;return this._showPromptAndWait({title:fa.cancelRequestTitle,
message:fa.cancelRequestWarningMessage,yesLabel:ja.form.yes,noLabel:ja.form.no})};this._showPrompt=fa=>{this._prompt?.cancel?.();this._prompt=fa};this._clearPrompt=()=>{this._prompt=null};this._onSave=()=>{this.viewModel.saveWorkflow()};this._onDelete=()=>{const {messages:fa,messagesCommon:ja}=this;this._showPrompt({title:fa.deleteWarningTitle,message:fa.deleteWarningMessage,context:"danger",actions:{primary:{label:ja.delete,action:()=>{this.deleteFeatureFromWorkflow();this._clearPrompt()}},secondary:{label:fa.keepFeature,
action:this._clearPrompt}}})};this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow();this._onBack=fa=>{fa?.stopPropagation();return this.viewModel.back()};this._onAttachmentAdd=()=>{const {activeWorkflow:fa}=this.viewModel;fa&&("create-features"===fa.type||"update"===fa.type&&"create-features"===fa.activeWorkflow?.type?(this._attachments.addFile(),fa.back()):this._attachments.addAttachment().then(()=>fa.back()))};this._onAttachmentUpdate=()=>{const {activeWorkflow:fa}=this.viewModel;
fa&&("create-features"===fa.type?(this._attachments.updateFile(),fa.back()):this._attachments.updateAttachment().then(()=>fa.back()))};this._onAttachmentDelete=()=>{const {messages:fa,messagesCommon:ja}=this;this._showPrompt({title:fa.deleteAttachmentWarningTitle,message:fa.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:ja.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:fa.keepAttachment,action:this._clearPrompt}}})};this._onAttachmentDeleteConfirm=async()=>
{const fa=this._attachments,{activeWorkflow:ja}=this.viewModel;ja&&("create-features"===ja.type?fa.deleteFile():(await fa.deleteAttachment(fa.viewModel.activeAttachmentInfo),this._clearPrompt()),await ja.back(),this._clearPrompt())};this._onAttachmentsError=fa=>{this._showPrompt({title:this.messages.errorWarningTitle,message:fa.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}})}}initialize(){this._featureForm.showPrompt=this._showPrompt;this._featureForm.clearPrompt=
this._clearPrompt;this.addHandles([q.watch(()=>g.incrementHeadingLevel(this.headingLevel),V=>{this._featureForm.headingLevel=V;this._featureTemplates.headingLevel=V},q.initial),q.on(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:V})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(aa=>aa?V.allow():V.deny())}),q.when(()=>this.viewModel.featureFormViewModel,V=>{this._featureForm.viewModel=V},q.initial),q.watch(()=>this.viewModel,
V=>{this._attachments.viewModel=V?.attachmentsViewModel??null;this._featureTemplates.viewModel=V?.featureTemplatesViewModel??null;this._spinner.viewModel=V?.spinnerViewModel??null;V.showDiscardEditsPrompt=this._showDiscardEditsPrompt},q.initial),q.watch(()=>this.view,(V,aa)=>{const fa=`editor-${this.id}-spinner`;aa?.ui.remove(this._spinner,fa);V?.ui.add(this._spinner,{key:fa,position:"manual"})},q.initial),q.watch(()=>[this.supportingWidgetDefaults,this.viewModel.sketchViewModel],([V])=>{V&&(this._featureForm.set(V.featureForm),
this._attachments.set(V.attachments),this._featureTemplates.set(V.featureTemplates),this.viewModel.sketchViewModel?.set(V.sketch))},q.initial),q.when(()=>this._attachments?.error,V=>this._onAttachmentsError(V)),q.when(()=>this.viewModel?.failures,V=>{const {messages:aa}=this,[{error:fa,retry:ja,cancel:da}]=V;this._showPrompt({title:aa.errorWarningTitle,message:W.substitute(aa.errorWarningMessageTemplate,{errorMessage:fa.message}),context:"warning",actions:{primary:{label:aa.retry,action:()=>{ja();
this._clearPrompt()}},secondary:{label:aa.ignore,action:()=>{da();this._clearPrompt()}}}})}),q.watch(()=>this.viewModel?.state,V=>{switch(V){case "awaiting-feature-to-update":case "ready":case "disabled":this._filterText="",this._featureTemplates.filterText=""}}),q.watch(()=>this.viewModel.featureFormDisabled,V=>this._featureForm.disabled=V),this._connectDelayedLoading()])}destroy(){this._attachments.destroy();this._featureForm.destroy();this._featureTemplates.destroy()}loadDependencies(){return Promise.all([e.loadCalciteComponents({"flow-item":()=>
new Promise((V,aa)=>a(["../chunks/calcite-flow-item"],V,aa)),flow:()=>new Promise((V,aa)=>a(["../chunks/calcite-flow"],V,aa)),icon:()=>new Promise((V,aa)=>a(["../chunks/calcite-icon"],V,aa)),list:()=>new Promise((V,aa)=>a(["../chunks/calcite-list"],V,aa))}),z.loadCreateFeaturesPanelContentComponents(),C.loadFeatureListComponents(),L.loadFooterActionsComponents(),S.loadNoticesComponents(),r.loadPanelContentComponents(),J.loadPanelToolbarComponents(),M.loadPromptComponents(),y.loadUpdateFeaturePanelContentComponents(),
H.loadUploadDetailsComponents()])}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}_connectDelayedLoading(){let V=void 0;return p.handlesGroup([q.watch(()=>{const {viewModel:aa}=this;return aa.syncing||aa.updating||this._attachments.submitting},aa=>{clearTimeout(V);V=void 0;aa?V=setTimeout(()=>{clearTimeout(V);V=void 0;this._loading=aa},250):this._loading=aa},q.syncAndInitial),p.makeHandle(()=>clearTimeout(V))])}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(V){m.deprecatedProperty(l.getLogger(this),
"allowedWorkflows",{replacement:"visibleElements",version:"4.29",warnOnce:!0});this.viewModel.allowedWorkflows=V}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(V){this.viewModel.hideTemplatesForInactiveLayers=V}get icon(){return"pencil"}set icon(V){this._overrideIfSome("icon",V)}get label(){return this.messages?.widgetLabel??""}set label(V){this._overrideIfSome("label",V)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(V){this.viewModel.labelOptions=
V}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(V){this.viewModel.layerInfos=V}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(V){this.viewModel.snappingOptions=V}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(V){this.viewModel.tooltipOptions=V}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(V){this.viewModel.valueOptions=V}get view(){return this.viewModel.view}set view(V){this.viewModel.view=V}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureCreation(V){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(V)}startCreateFeaturesWorkflowAtFeatureEdit(V){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(V)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(V){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(V)}startUpdateWorkflowAtFeatureEdit(V){return this.viewModel.startUpdateWorkflowAtFeatureEdit(V)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(V){return this.viewModel.cancelWorkflow(V)}render(){const {viewModel:V}=
this,aa=this.classes(K.css.base,c.globalCss.widget,c.globalCss.panel);return V?R.tsx("div",{class:aa,key:"base"},R.tsx("calcite-flow",{key:"flow"},V.pageStack.map(fa=>this._renderPage(fa))),this._prompt?R.tsx(M.Prompt,{...this._prompt,headingLevel:this.headingLevel}):void 0):R.tsx("div",{class:aa,key:"empty"})}_renderPage(V){switch(V){case "ready":return this._renderReady();case "awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo();case "creating-features-upload-details":return this._renderUploadDetails();
case "creating-features":return this._renderCreatingFeatures();case "editing-existing-feature":case "editing-attributes":return this._renderUpdateFeature();case "awaiting-update-feature-candidate":return this._renderFeatureList();case "adding-attachment":return this._renderAttachmentAdding();case "editing-attachment":return this._renderAttachmentEditing()}return R.tsx("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(){const {EditorPanel:V,messages:aa}=this;return R.tsx(V,{heading:aa.selectTemplate,
key:"templates-panel"},R.tsx(r.PanelContent,{key:"feature-templates"},R.tsx(r.PanelContentSection,null,this._renderFeatureTemplates())))}_renderUploadDetails(){const {EditorPanel:V,activeWorkflow:aa,messages:fa}=this;if("create-features"!==aa?.type)return null;const ja=aa.data.upload;return ja?R.tsx(V,{heading:fa.createFeatures,key:"upload-details-panel"},R.tsx(H.UploadDetails,{helpMessage:this._helpMessage,messages:fa,upload:ja})):null}_renderCreatingFeatures(){const {EditorPanel:V,activeWorkflow:aa,
messages:fa,messagesCommon:ja,headingLevel:da,viewModel:Z}=this;return aa?R.tsx(V,{heading:fa.createFeatures,key:"create-features-panel"},"create-features"===aa.type&&0<aa.numPendingFeatures||"update"===aa.type&&"create-features"===aa?.activeWorkflow?.type&&0<aa.activeWorkflow?.numPendingFeatures?R.tsx(y.UpdateFeaturePanelContent,{editorViewModel:Z,headingLevel:da,messages:fa,messagesCommon:ja,renderAttachments:this._renderAttachments,renderFeatureForm:this._renderFeatureForm,onDelete:this._onDelete,
onSave:this._onSave}):R.tsx(z.CreateFeaturesPanelContent,{helpMessage:this._helpMessage})):null}_renderUpdateFeature(){const {EditorPanel:V,messages:aa,messagesCommon:fa,headingLevel:ja,viewModel:da}=this;return R.tsx(V,{heading:aa.editFeature,key:"update-feature-panel"},R.tsx(y.UpdateFeaturePanelContent,{editorViewModel:da,headingLevel:ja,messages:aa,messagesCommon:fa,renderAttachments:this._renderAttachments,renderFeatureForm:this._renderFeatureForm,onDelete:this._onDelete,onSave:this._onSave}))}_renderCustomTemplateGroupContent(V){const {messages:aa,
viewModel:fa}=this;return(V=k.mappedFind(V.group.items,ja=>fa.itemHasInvalidFormTemplate(ja)?aa.formFieldCreateError:void 0))?R.tsx(S.Notice,{kind:"warning",message:V}):null}_renderAttachmentAdding(){const {EditorPanel:V,_attachments:aa,messages:fa,messagesCommon:ja}=this;return R.tsx(V,{heading:fa.addAttachment,key:"attachment-adding-panel"},R.tsx(r.PanelContent,{key:"attachments"},this._renderAttachments()),R.tsx(L.FooterActions,{buttons:[{label:aa.submitting?ja.cancel:ja.add,disabled:aa.submitting||
!aa.selectedFile,onClick:this._onAttachmentAdd}]}))}_renderAttachmentEditing(){const {EditorPanel:V,_attachments:aa,activeWorkflow:fa,messages:ja,messagesCommon:da}=this;return fa?R.tsx(V,{heading:ja.editAttachment,key:"attachment-editing-panel"},R.tsx(r.PanelContent,{key:"attachments"},this._renderAttachments()),fa.shouldAllowAttachmentEditing?R.tsx(L.FooterActions,{buttons:[{label:da.update,disabled:aa.submitting||!aa.selectedFile,onClick:this._onAttachmentUpdate},{...this._deleteButtonCommonInfo,
onClick:this._onAttachmentDelete,disabled:aa.submitting,label:da.delete}]}):void 0):null}_renderReady(){const {EditorPanel:V,messages:aa,viewModel:fa,visibleElements:ja}=this,da=this._helpMessage;return R.tsx(V,{heading:aa.widgetLabel,key:"landing-panel"},R.tsx(r.PanelContent,{key:"landing-content"},fa.editorItems.length?[ja.editFeaturesSection?R.tsx(r.PanelContentSection,{key:"edit-actions"},this._renderUpdateActions()):null,ja.createFeaturesSection&&fa.canCreateVisible?R.tsx(r.PanelContentSection,
{key:"create-actions"},this._renderCreateActions()):null]:R.tsx(r.PanelContentMessage,{key:"no-content"},aa.noEditableLayers)),da?R.tsx("div",{class:K.css.helpMessage,key:"footer-actions",slot:"footer"},da):void 0)}get _helpMessage(){const {activeWorkflow:V,messages:aa,view:fa}=this,ja=V?.helpMessage;return ja?aa["3d"===fa?.type?"helpMessages3d":"helpMessages2d"]?.[ja]:void 0}_renderUpdateActions(){const {messages:V,messagesCommon:aa,viewModel:fa}=this,ja={id:"select",label:aa.select};return R.tsx("div",
{class:K.css.updateActions,key:"update-actions"},R.tsx(g.Heading,{level:g.incrementHeadingLevel(this.headingLevel)},V.editFeatures),R.tsx("calcite-list",{class:K.css.updateActionsList,selectionAppearance:"border",selectionMode:"single"},h.renderItem({disabled:!fa.canUpdateVisible,grouped:!1,item:ja,selectedItem:"awaiting-feature-to-update"===fa.activeWorkflow?.stepId?ja:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return R.tsx("div",
{key:"create-actions"},R.tsx(g.Heading,{level:g.incrementHeadingLevel(this.headingLevel)},this.messages.createFeatures),R.tsx("div",{class:K.css.featureTemplatesContainer,key:"templates"},this._renderFeatureTemplates()))}_renderFeatureList(){const {EditorPanel:V,viewModel:aa}=this,{activeWorkflow:fa}=aa;if("update"!==fa?.type)return null;const ja=W.substitute(this.messages.multipleFeaturesTemplate,{total:fa.data.candidates.length});return R.tsx(V,{heading:ja,key:"feature-list"},R.tsx(C.FeatureList,
{editorItems:aa.editorItems,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:fa,onFilterTextChange:da=>this._filterText=da,onSelectFeature:(da,Z)=>aa.selectFeature(da,Z)}))}_showPromptAndWait({title:V,message:aa,yesLabel:fa,noLabel:ja}){const da=E.createResolver(),{view:Z}=this,ka=Z?.focused;this._showPrompt({title:V,message:aa,context:"danger",actions:{primary:{label:fa,action:()=>da.resolve(!0)},secondary:{label:ja,action:()=>da.resolve(!1)}}});return da.promise.finally(()=>
{this._clearPrompt();ka&&Z?.focus()})}};b.__decorate([f.property()],d.prototype,"_featureForm",void 0);b.__decorate([f.property()],d.prototype,"_attachments",void 0);b.__decorate([f.property()],d.prototype,"_featureTemplates",void 0);b.__decorate([f.property()],d.prototype,"_filterText",void 0);b.__decorate([f.property()],d.prototype,"_prompt",void 0);b.__decorate([f.property()],d.prototype,"_spinner",void 0);b.__decorate([f.property()],d.prototype,"_deleteButtonCommonInfo",null);b.__decorate([f.property()],
d.prototype,"_loading",void 0);b.__decorate([f.property({readOnly:!0})],d.prototype,"activeWorkflow",null);b.__decorate([f.property()],d.prototype,"allowedWorkflows",null);b.__decorate([f.property()],d.prototype,"headingLevel",void 0);b.__decorate([f.property()],d.prototype,"hideTemplatesForInactiveLayers",null);b.__decorate([f.property()],d.prototype,"icon",null);b.__decorate([f.property()],d.prototype,"label",null);b.__decorate([f.property()],d.prototype,"labelOptions",null);b.__decorate([f.property()],
d.prototype,"layerInfos",null);b.__decorate([f.property(),I.messageBundle("esri/widgets/Editor/t9n/Editor")],d.prototype,"messages",void 0);b.__decorate([f.property(),I.messageBundle("esri/t9n/common")],d.prototype,"messagesCommon",void 0);b.__decorate([f.property(),I.messageBundle("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],d.prototype,"messagesTemplates",void 0);b.__decorate([f.property()],d.prototype,"snappingOptions",null);b.__decorate([f.property()],d.prototype,"tooltipOptions",null);
b.__decorate([f.property()],d.prototype,"supportingWidgetDefaults",void 0);b.__decorate([f.property({type:x,nonNullable:!0})],d.prototype,"valueOptions",null);b.__decorate([f.property()],d.prototype,"view",null);b.__decorate([f.property(),O.vmEvent(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],d.prototype,"viewModel",void 0);b.__decorate([f.property({type:P,nonNullable:!0})],d.prototype,"visibleElements",void 0);b.__decorate([f.property()],d.prototype,"_helpMessage",
null);return d=b.__decorate([A.subclass("esri.widgets.Editor")],d)});