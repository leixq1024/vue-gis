// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("require ../../chunks/tslib.es6 ../../Color ../../intl ../../core/reactiveUtils ../../core/unitFormatUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ../../chunks/componentsUtils ./globalCss ./LabeledSwitch ./widgetUtils ./decorators/messageBundle ./jsxFactory ./GridControls/GridControlsViewModel ./GridControls/gridUtils ./GridControls/VisibleElements ../../intl/substitute".split(" "),
function(l,g,v,e,x,E,h,N,O,P,F,G,H,y,m,I,z,c,A,B,C,J){var K={light:"circle",dark:"circle-area",custom:"palette"},L={interactive:"maximum-territory-distance",place:"move",rotate:"rotate"};const p=v.fromArray([115,115,115]),w=v.fromArray([200,200,200]),M=["interactive","place","rotate"];e=class extends G{constructor(a,b){super(a,b);this.messagesUnits=this.messages=this.customColor=null;this.viewModel=new A;this.visibleElements=new C}initialize(){this.addHandles([x.watch(()=>this.view?.grid?.majorLineColor,
a=>{!a||p.equals(a)||w.equals(a)||(this.customColor=a)},x.initial)])}loadDependencies(){return Promise.all([H.loadCalciteComponents({action:()=>new Promise((a,b)=>l(["../../chunks/calcite-action"],a,b)),"action-bar":()=>new Promise((a,b)=>l(["../../chunks/calcite-action-bar"],a,b)),label:()=>new Promise((a,b)=>l(["../../chunks/calcite-label"],a,b)),icon:()=>new Promise((a,b)=>l(["../../chunks/calcite-icon"],a,b)),popover:()=>new Promise((a,b)=>l(["../../chunks/calcite-popover"],a,b)),tooltip:()=>
new Promise((a,b)=>l(["../../chunks/calcite-tooltip"],a,b)),"color-picker":()=>new Promise((a,b)=>l(["../../chunks/calcite-color-picker"],a,b)),"input-number":()=>new Promise((a,b)=>l(["../../chunks/calcite-input-number"],a,b))}),m.loadLabeledSwitchComponents()])}get icon(){return"grid-unit"}set icon(a){this._overrideIfSome("icon",a)}get label(){return this.messages.widgetLabel}set label(a){this._overrideIfSome("label",a)}get snappingManager(){return this.viewModel.snappingManager}set snappingManager(a){this.viewModel.snappingManager=
a}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(a){this.viewModel.snappingOptions=a}get theme(){const a=this.viewModel.grid?.majorLineColor;return a?p.equals(a)?"dark":w.equals(a)?"light":"custom":null}set theme(a){const {viewModel:b,customColor:d,view:f}=this;switch(a){case "light":b.gridColor=w;break;case "dark":b.gridColor=p;break;case "custom":b.gridColor=d??f?.effectiveTheme.accentColor??p}}get view(){return this.viewModel.view}set view(a){this.viewModel.view=
a}render(){return c.tsx("div",{"aria-label":this.label,class:this.classes("esri-grid-controls",y.globalCss.widget,y.globalCss.panel)},c.tsx("div",{class:"esri-grid-controls__container"},this._renderContent()))}_renderContent(){const {visibleElements:a}=this;return[a.gridEnabledToggle?this._renderEnabledToggle():null,a.placementButtons?this._renderGridPlacementButtons():null,a.numericInputs?this._renderNumericInputs():null,a.lineIntervalInput?this._renderIntervalInput():null,a.gridSnapEnabledToggle&&
this.viewModel.snappingOptions?this._renderSnappingToggle():null,a.dynamicScaleToggle?this._renderDynamicScaleToggle():null,a.rotateWithMapToggle?this._renderRotateToggle():null,a.colorSelection?this._renderColorSelection():null]}_renderGridPlacementButtons(){const {interactivePlacementState:a,placementDisabled:b,gridControlsEnabled:d}=this.viewModel,f=b||!d;return c.tsx("calcite-label",{key:"grid-placement-buttons",scale:"s"},this.messages.placementOptions,c.tsx("calcite-action-bar",{expandDisabled:!0,
layout:"horizontal"},M.map(k=>this._renderPlacementModeButton(k,f,a))))}_renderPlacementModeButton(a,b,d){const f=this.messages.placementState[a],k=`__placement-action-${a}`;return c.tsx("div",null,c.tsx("calcite-action",{active:d===a,alignment:"center",disabled:b,icon:L[a],id:k,onclick:()=>this.viewModel.togglePlacementState(a),text:f}),c.tsx("calcite-tooltip",{placement:"top",referenceElement:k},f))}_renderNumericInputs(){const {rotation:a,spacing:b,effectiveSpacingAfterDynamicScaling:d,numericSpacingInputShouldBeVisible:f,
unit:k="meters"}=this.viewModel,q=this.messagesUnits.units[k].abbr,r=this.viewModel.gridControlsEnabled,n=null!=d&&d!==this.viewModel.spacing,t=`__spacing_input_scaled-${this.id}`;return c.tsx("div",{class:this.classes("esri-grid-controls__numeric-inputs__container")},[f?c.tsx("calcite-label",{key:"spacing-label",scale:"s"},c.tsx("span",null,this.messages.inputLabel.spacing,n?c.tsx("calcite-icon",{class:this.classes("esri-grid-controls__inline-icon"),icon:"exclamation-mark-triangle",id:t,scale:"s",
tabIndex:0}):void 0),c.tsx("div",{class:"esri-grid-controls__input-with-suffix__container"},c.tsx("calcite-input-number",{disabled:!r,numberButtonType:"none",suffixText:q,value:`${b?.toFixed(2)}`,onCalciteInputNumberChange:({target:u})=>{const D=parseFloat(u.value);this.viewModel.spacing=D;D!==this.viewModel.spacing&&(u.value=`${this.viewModel.spacing}`)}}),n?c.tsx("calcite-tooltip",{overlayPositioning:"fixed",placement:"leading",referenceElement:t},J.substitute(this.messages.warnings.dynamicSpacing,
{actualSpacingIncludingUnit:E.formatDecimal(this.messagesUnits,d,k,2,"plural")})):void 0)):void 0,c.tsx("calcite-label",{key:"angle-label",scale:"s"},this.messages.inputLabel.angle,c.tsx("calcite-input-number",{disabled:!r,integer:!0,numberButtonType:"none",suffixText:this.messagesUnits.units.degrees.abbr,value:`${B.gridRotationToDegrees(a)}`,onCalciteInputNumberChange:({target:u})=>this.viewModel.rotation=B.userInputToGridRotation(u.value)}))])}_renderIntervalInput(){const {majorLineInterval:a,gridControlsEnabled:b}=
this.viewModel;return c.tsx("div",{class:this.classes("esri-grid-controls__numeric-inputs__container")},c.tsx("calcite-label",{scale:"s"},this.messages.inputLabel.interval,c.tsx("calcite-input-number",{disabled:!b,integer:!0,max:15,min:1,numberButtonType:"vertical",value:`${a}`,onCalciteInputNumberChange:({target:d})=>{const f=Number.parseInt(d.value,10);this.viewModel.majorLineInterval=f;f!==this.viewModel.majorLineInterval&&(d.value=`${this.viewModel.majorLineInterval}`)}})))}_renderSnappingToggle(){const {snappingOptions:a,
gridControlsEnabled:b}=this.viewModel;return c.tsx(m.LabeledSwitch,{checked:!!(a?.gridEnabled??!1),disabled:!(b&&a),key:"grid-snap-enabled-toggle",label:this.messages.switchLabel.snap,onChange:d=>this.viewModel.snappingOptions?.set("gridEnabled",d)})}_renderDynamicScaleToggle(){const {viewModel:a,messages:b}=this;return c.tsx(m.LabeledSwitch,{checked:a.dynamicScaling,disabled:!a.gridControlsEnabled,hint:this.visibleElements.outOfScaleWarning&&a.gridOutOfScale?b.warnings.outOfScale:void 0,hintIcon:"exclamation-mark-triangle",
hintKind:"warning",key:`grid-dynamic-scale-toggle-${this.id}`,label:b.switchLabel.scaling,onChange:d=>a.dynamicScaling=d})}_renderRotateToggle(){const {gridControlsEnabled:a,rotateWithMap:b}=this.viewModel;return c.tsx(m.LabeledSwitch,{checked:b,disabled:!a,key:"grid-rotate-map-toggle",label:this.messages.switchLabel.rotateWithMap,onChange:d=>this.viewModel.rotateWithMap=d})}_renderEnabledToggle(){return c.tsx("div",{class:"esri-grid-controls__switch--bordered"},c.tsx(m.LabeledSwitch,{checked:this.viewModel.displayEnabled,
disabled:!!this.viewModel.interactivePlacementState,key:"grid-enabled-toggle",label:this.messages.switchLabel.display,onChange:a=>this.viewModel.trySetDisplayEnabled(a)}))}_renderColorSelection(){const {customColor:a}=this,b=`${this.id}--custom-grid-color-button`;return c.tsx("calcite-label",{scale:"s"},this.messages.inputLabel.theme,c.tsx("div",{class:"esri-grid-controls__tilegroup"},[this._renderThemeTile({value:"dark"}),this._renderThemeTile({value:"light"}),this._renderThemeTile({value:"custom",
id:b}),c.tsx("calcite-popover",{autoClose:!0,label:this.messages.gridLineColorPopoverLabel,overlayPositioning:"fixed",referenceElement:b},c.tsx("calcite-color-picker",{alphaChannel:!0,savedDisabled:!0,value:a?.toHex({digits:8})??"#000000ff",onCalciteColorPickerChange:d=>{if(d=v.fromHex(d.target.value))this.customColor=d,this.theme="custom"}}))]))}_renderThemeTile(a){const {theme:b}=this,{value:d}=a,f=this.messages.gridTheme[d],k=`${this.id}--theme_tile_${d}`,q=`${k}__label`,r=K[d],n=this.viewModel.gridControlsEnabled;
return c.tsx("div",{class:I.classes({["esri-grid-controls__tile"]:!0,["esri-grid-controls__tile--disabled"]:!n}),id:a.id,role:"button"},c.tsx("input",{"aria-labelledby":q,checked:b===d,disabled:!n,id:k,name:`${this.id}--theme`,onchange:t=>{this.theme=d;t.target?.focus()},tabIndex:0,type:"radio"}),c.tsx("div",{class:"esri-grid-controls__tile__content"},c.tsx("calcite-icon",{icon:r,scale:"l"}),c.tsx("calcite-label",{for:k,id:q},f)))}};g.__decorate([h.property()],e.prototype,"customColor",void 0);g.__decorate([h.property()],
e.prototype,"icon",null);g.__decorate([h.property()],e.prototype,"label",null);g.__decorate([h.property(),z.messageBundle("esri/widgets/support/GridControls/t9n/GridControls")],e.prototype,"messages",void 0);g.__decorate([h.property(),z.messageBundle("esri/core/t9n/Units")],e.prototype,"messagesUnits",void 0);g.__decorate([h.property()],e.prototype,"snappingManager",null);g.__decorate([h.property()],e.prototype,"snappingOptions",null);g.__decorate([h.property()],e.prototype,"theme",null);g.__decorate([h.property()],
e.prototype,"view",null);g.__decorate([h.property({type:A})],e.prototype,"viewModel",void 0);g.__decorate([h.property({type:C,nonNullable:!0})],e.prototype,"visibleElements",void 0);return e=g.__decorate([F.subclass("esri.widgets.support.GridControls")],e)});