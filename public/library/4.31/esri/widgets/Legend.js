// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../views/2d/layers/features/layerAdapters/featureReductionUtils ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(m,H,O,F,l,C,w,G,
R,D,t,c,e,d){const h=F.ofType(e),f=new Set("esri.layers.BuildingSceneLayer esri.layers.CatalogLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.OrientedImageryLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.catalog.CatalogFootprintLayer esri.layers.catalog.CatalogDynamicGroupLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer esri.layers.KnowledgeGraphLayer".split(" ")),
v=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];H=class extends O{constructor(p){super(p);this._layerViewByLayerId={};this._layerInfosByLayerViewId={};this._activeLayerInfosByLayerViewId={};this._activeLayerInfosWithNoParent=new F;this.activeLayerInfos=new h;this.respectLayerDefinitionExpression=this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=this.groundLegendVisible=this.basemapLegendVisible=!1;this.respectLayerVisibility=
!0;this.layerInfos=[];this.view=null}initialize(){this.addHandles(l.watch(()=>this.view,()=>this._viewHandles(),l.initial),"view");this.addHandles(d.onLocaleChange(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos();this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles("state");this.view&&this.addHandles(l.watch(()=>this.state,()=>this._stateHandles(),l.initial),"state")}_stateHandles(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(p){this.removeHandles(p);const n=this._activeLayerInfosByLayerViewId[p];delete this._activeLayerInfosByLayerViewId[p];n?.parent&&n.parent.children.remove(n)}_watchPropertiesAndAllLayerViews(){var {view:p}=this;p&&({allLayerViews:p}=p,p.length&&this._refresh(),
this.addHandles(p.on("change",n=>this._allLayerViewsChangeHandle(n)),"all-layer-views"),this.addHandles(l.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))}_allLayerViewsChangeHandle(p){p.moved.length?this._propertiesChangeHandle():(p.removed.forEach(n=>this._destroyViewActiveLayerInfo(n.uid)),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos();this._refresh()}_refresh(){this._layerInfosByLayerViewId=
{};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(p){const n=this.view;if(!(2>p.length)&&n){var k=[];p.forEach(E=>{if(!E.parent){var I=E.layer.parent;(I=(I=I&&"uid"in I&&this._layerViewByLayerId[I.uid])&&this._activeLayerInfosByLayerViewId[I.uid])&&p.includes(I)&&(k.push(E),E.parent=
I,I.children.add(E),this._sortActiveLayerInfos(I.children))}});p.removeMany(k);var x={};n.allLayerViews.forEach((E,I)=>x[E.layer.uid]=I);p.sort((E,I)=>(x[I.layer.uid]||0)-(x[E.layer.uid]||0))}}_generateLayerViews(){const p=[];v.filter(this._filterLayerViews,this).map(n=>t.get(this,n)).filter(n=>null!=n).forEach(this._collectLayerViews("layerViews",p));return p}_filterLayerViews(p){const n=!this.groundLegendVisible&&"view.groundView.layerViews"===p;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===
p||"view.basemapView.referenceLayerViews"===p))&&!n}_collectLayerViews(p,n){const k=x=>{x&&x.forEach(E=>{n.push(E);k(E[p])});return n};return k}_filterLayerViewsByLayerInfos(p){const n=this.layerInfos;return n&&n.length?n.some(k=>this._hasLayerInfo(k,p)):!0}_hasLayerInfo(p,n){const k=this._isLayerUIDMatching(p.layer,n.layer.uid);k&&(this._layerInfosByLayerViewId[n.uid]=p);return k}_isLayerUIDMatching(p,n){return p&&(p.uid===n||this._hasLayerUID(p.layers,n))}_hasLayerUID(p,n){return p&&p.some(k=>this._isLayerUIDMatching(k,
n))}_isLayerViewSupported(p){return f.has(p.layer.declaredClass)?(this._layerViewByLayerId[p.layer.uid]=p,!0):!1}_generateActiveLayerInfo(p){this._isLayerActive(p)?this._buildActiveLayerInfo(p):(this.removeHandles(p.uid),this.addHandles(l.watch(()=>[p.legendEnabled,p.layer?.legendEnabled],()=>this._layerActiveHandle(p)),p.uid))}_layerActiveHandle(p){this._isLayerActive(p)&&(this.removeHandles(p.uid),this._buildActiveLayerInfo(p))}_isLayerActive(p){return this.respectLayerVisibility?p.legendEnabled&&
p.layer?.legendEnabled:!0}_buildActiveLayerInfo(p){const n=p.layer,k=p.uid;var x=this._layerInfosByLayerViewId[k];let E=this._activeLayerInfosByLayerViewId[k];E||(E=new e({layer:n,layerView:p,title:void 0!==x?.title&&x.layer.uid===n.uid?x.title:n.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:x?.sublayerIds||
[]}),this._activeLayerInfosByLayerViewId[k]=E);E.parent=this._activeLayerInfosByLayerViewId[(n.parent&&"uid"in n.parent?this._layerViewByLayerId[n.parent?.uid]:null)?.uid];if(!this.hasHandles(k)){x=l.watch(()=>n.title,S=>this._titleHandle(S,E));var I=l.watch(()=>[n.opacity,"renderer"in n&&n.renderer,"pointSymbol"in n&&n.pointSymbol,"lineSymbol"in n&&n.lineSymbol,"polygonSymbol"in n&&n.polygonSymbol],()=>this._constructLegendElements(E)),b=l.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(E),
l.initial);const g=l.watch(()=>p.layer?c.getEffectiveFeatureReduction(p.layer,p.view):null,()=>this._constructLegendElements(E)),u=l.watch(()=>p.updating,()=>{null!=p.layer&&null!=c.getEffectiveFeatureReduction(p.layer,p.view)&&this._constructLegendElements(E)}),y=l.watch(()=>"effect"in n&&n.effect,()=>this._constructLegendElements(E)),M=l.when(()=>this.view?.timeZone,()=>this._constructLegendElements(E),l.initial);x=[x,I,b,g,u,y,M];this.respectLayerVisibility&&(I=l.watch(()=>p.legendEnabled,S=>this._legendEnabledHandle(S,
E)),b=l.watch(()=>n.legendEnabled,S=>this._legendEnabledHandle(S,E)),x.push(I,b));this.respectLayerDefinitionExpression&&"definitionExpression"in n&&(I=l.watch(()=>[n.definitionExpression,this.respectLayerDefinitionExpression],()=>{E.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression;this._constructLegendElements(E)}),x.push(I));this.addHandles(x,k)}E.isScaleDriven||this._constructLegendElements(E);this._addActiveLayerInfo(E)}_titleHandle(p,n){n.title=p;this._constructLegendElements(n)}_legendEnabledHandle(p,
n){p?this._addActiveLayerInfo(n):this._removeActiveLayerInfo(n)}_scaleHandle(p){(p.isScaleDriven||p.hideLayersNotInCurrentView)&&this._constructLegendElements(p)}_addActiveLayerInfo(p){const {layerView:n,layer:k}=p;if(this._isLayerActive(n)&&!this.activeLayerInfos.includes(p)){var x=p.parent;if(x)x.children.includes(p)||x.children.push(p),this._sortActiveLayerInfos(x.children);else{x=this.layerInfos?.some(I=>I.layer.uid===k.uid);const E=k.parent;E&&"uid"in E&&this._layerViewByLayerId[E.uid]&&!x?this._activeLayerInfosWithNoParent.add(p):
(this.activeLayerInfos.add(p),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const E=[];this._activeLayerInfosWithNoParent.forEach(I=>{var b=I.layer.parent;if(b=this._activeLayerInfosByLayerViewId[(b&&"uid"in b?this._layerViewByLayerId[b?.uid]:null)?.uid])E.push(I),I.parent=b});E.length&&(this._activeLayerInfosWithNoParent.removeMany(E),E.forEach(I=>this._addActiveLayerInfo(I)))}}}_removeActiveLayerInfo(p){const n=p.parent;n?n.children.remove(p):this.activeLayerInfos.remove(p)}_constructLegendElements(p){const n=
p.layer;"featureCollections"in n&&n.featureCollections?p.buildLegendElementsForFeatureCollections(n.featureCollections):"featureReduction"in n&&n.featureReduction&&"renderer"in n.featureReduction&&("binning"===n.featureReduction.type||"cluster"===n.featureReduction.type)&&(!this.view||n.featureReduction.maxScale<=this.view.scale)?p.buildLegendElementsForFeatureReduction(n.featureReduction):"renderer"in n&&n.renderer&&!("sublayers"in n)?p.buildLegendElementsForRenderer(n.renderer):"url"in n&&n.url&&
"catalog"!==n.type&&"knowledge-graph"!==n.type?p.buildLegendElementsForTools():p.children.forEach(k=>this._constructLegendElements(k))}};m.__decorate([C.property({type:h})],H.prototype,"activeLayerInfos",void 0);m.__decorate([C.property()],H.prototype,"basemapLegendVisible",void 0);m.__decorate([C.property()],H.prototype,"groundLegendVisible",void 0);m.__decorate([C.property()],H.prototype,"hideLayersNotInCurrentView",void 0);m.__decorate([C.property()],H.prototype,"keepCacheOnDestroy",void 0);m.__decorate([C.property()],
H.prototype,"respectLayerDefinitionExpression",void 0);m.__decorate([C.property()],H.prototype,"respectLayerVisibility",void 0);m.__decorate([C.property()],H.prototype,"layerInfos",void 0);m.__decorate([C.property({readOnly:!0})],H.prototype,"state",null);m.__decorate([C.property()],H.prototype,"view",void 0);return H=m.__decorate([D.subclass("esri.widgets.Legend.LegendViewModel")],H)})},"esri/views/2d/layers/features/layerAdapters/featureReductionUtils":function(){define(["exports"],function(m){m.getEffectiveFeatureReduction=
function(H,O){return(H=H.featureReduction)&&"selection"!==H.type?!("maxScale"in H&&H.maxScale)||H.maxScale<O.scale?H:null:null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/has ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/sql ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../smartMapping/renderers/support/referenceSizeUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol ../../../intl/messages ../../../intl/substitute".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c,e,d,h,f,v,p,n,k,x,E,I,b,g,u,y,M,S,A,J,T,r,L,Q,z,K,U,W,ba,Y,ia,ja,fa,X,da,oa,aa){function ma(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function ka(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function ra(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function va(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function wa(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function za(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function Aa(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function Da(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function La(a){return"esri.renderers.PieChartRenderer"===a.declaredClass}function Ha(a){return"esri.layers.SubtypeGroupLayer"===a.declaredClass}function Sa(a){return"esri.layers.MapImageLayer"===a.declaredClass}function $a(a){a="authoringInfo"in a?a?.authoringInfo:null;return"univariate-color-size"===a?.type&&"above-and-below"===
a?.univariateTheme}async function Ba(a,q){const B=await oa.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==a||q||(a="previewAriaLabel");return aa.substitute(B[a],{label:q})}const Ma=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,ab=new c.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Na=new X({size:6,outline:{color:[128,128,128,.5],width:.5}}),
bb=new da({style:"solid"}),cb=new X({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ea={};F=class extends G{constructor(a){super(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._webStyleSymbolCache=new Map;this._dotDensityUrlCache=new Map;this._scaleDrivenSizeVariable=null;this._hasClusterSizeVariable=!1;this._layerDefinitionExpressionClause=this._layerDefinitionExpression=null;this.children=new D;this.layer=this.layerView=null;
this.legendElements=[];this.parent=null;this.respectLayerDefinitionExpression=this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=!1;this.respectLayerVisibility=!0;this.sublayerIds=[];this.view=this.title=null}initialize(){const a=()=>this.notifyChange("ready");this.addHandles([h.on(()=>this.children,"change",q=>{const {added:B,removed:N}=q;B.forEach(P=>{const V=`activeLayerInfo-ready-watcher-${P.layer.uid}`;this.addHandles(h.watch(()=>P.ready,a,h.initial),V)});N.forEach(P=>this.removeHandles(P.layer.uid));
a()})]);this.keepCacheOnDestroy||(Ea={})}destroy(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=null;this.keepCacheOnDestroy||(Ea=null);this._layerDefinitionExpressionClause=null}get effectList(){const a=this.layer;let q=null;"effect"in a&&a.effect&&(q=new E.EffectView,q.effect=a.effect,q.endTransition(),q.scale=this.scale);return q}get opacity(){const a=this.layer.opacity,q=this.parent?.opacity;var B=this.layer.parent;B=B&&"uid"in B?this._getParentLayerOpacity(B):
null;return null!=q?q*a:null!=B?B*a:a}get ready(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}get scale(){return this.view?.scale??0}get isScaleDriven(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===a.featureReduction.type&&"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in
a&&a.renderer?this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,q=>{if(u.isFeatureLayer(q))return this._getRendererLegendElements(q.renderer,{title:q.title});if(q.featureSet?.features.length){var B=q.layerDefinition,N=B?.drawingInfo;N=N&&
M.fromJSON(N.renderer);B=ab.read(B.geometryType);return N?this._getRendererLegendElements(N,{title:q.name,geometryType:B}):(e.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const q=[],B=await Promise.allSettled(a);for(const N of B)if("fulfilled"===N.status)for(const P of N.value??[])q.push(P);this.legendElements=q;this.notifyChange("ready")}catch(q){e.getLogger(this).warn("error while building legend for layer!",q)}}}async buildLegendElementsForRenderer(a){try{this.legendElements=
(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(q){e.getLogger(this).warn("error while building legend for layer!",q)}}async buildLegendElementsForFeatureReduction(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(q){e.getLogger(this).warn("error while building legend for layer!",
q)}}async buildLegendElementsForTools(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxelLayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Sa(a)||"esri.layers.TileLayer"===
a.declaredClass||Ha(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var q="default";if("esri.layers.ImageryLayer"===a.declaredClass){q=a?.rasterFunction?.functionName||"default";const B=a.bandIds?.length?a.bandIds.join(""):"###";q=q+"_"+B}"esri.layers.ImageryTileLayer"!==a.declaredClass&&"link-chart"!==a.type&&await this._getLegendLayers(`${a.uid}-${q}`).then(async B=>{this.legendElements=[];this.notifyChange("ready");B=B.map(async N=>{if("esri.layers.ImageryLayer"===
a.declaredClass){const P=h.watch(()=>[a.rasterFunction,a.bandIds],()=>d.debounce(async()=>{Ea["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());this.addHandles(P,"imageryLayers-watcher")}N=this._generateSymbolTableElementForLegendLayer(N);N?.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(N.title=a.title),this.legendElements.push(N));this.notifyChange("ready")});await Promise.allSettled(B)}).catch(B=>{e.getLogger(this).warn("Request to server for legend has failed!",
B)})}}async _isLayerInCurrentView(){const a=this.layer,q=this.layerView,B=q&&"createQuery"in q&&"queryFeatureCount"in q;if(!(B||q&&"createQuery"in a&&"queryFeatureCount"in a))return!0;await h.whenOnce(()=>!q.updating);const N=B?"createQuery"in q&&q.createQuery():"createQuery"in a&&a.createQuery();if(!N)return!0;N.geometry=this.view.extent;return 0!==(B?"queryFeatureCount"in q&&await q.queryFeatureCount(N):"queryFeatureCount"in a&&await a.queryFeatureCount(N))}_getParentLayerOpacity(a){let q=1;const B=
a.parent;B&&"uid"in B&&(q=this._getParentLayerOpacity(B));return a.opacity*q}_isGroupActive(){return this.children.some(a=>a.ready)}_isRendererScaleDriven(a){return"dot-density"===a.type||Ma.test("valueExpression"in a?a.valueExpression:null)||("visualVariables"in a?a.visualVariables:null)?.some(q=>this._isScaleDrivenSizeVariable(q))?!0:this._hasScaleDrivenSymbols(a)}_hasScaleDrivenSymbols(a){switch(a.type){case "simple":return this._isScaleDrivenSymbol(a.symbol);case "class-breaks":return this._isScaleDrivenSymbol(a.defaultSymbol)||
a.classBreakInfos.some(q=>this._isScaleDrivenSymbol(q.symbol));case "unique-value":return this._isScaleDrivenSymbol(a.defaultSymbol)||!!a.uniqueValueInfos?.some(q=>this._isScaleDrivenSymbol(q.symbol))}return!1}_isScaleDrivenSymbol(a){if("cim"===a?.type){const {primitiveOverrides:q,minScale:B,maxScale:N}=a.data;a=q?.some(P=>/\$view\.scale/.test(P.valueExpressionInfo?.expression||""))??!1;return null!=B||null!=N||a}return!1}_isScaleDrivenSizeVariable(a){if(a&&"size"!==a.type)return!1;const q=a.minSize,
B=a.maxSize;return"object"===typeof q&&q&&this._isScaleDrivenSizeVariable(q)||"object"===typeof B&&B&&this._isScaleDrivenSizeVariable(B)?!0:Ma.test(a.valueExpression)}_isLayerScaleDriven(a){if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(B=>this._isLayerScaleDriven(B));const q=a.parent;if(!1===a.loaded&&q&&Sa(q)&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const B of q.sourceJSON.layers??[])if(B.id===a.source.mapLayerId&&
(0<B.minScale||0<B.maxScale))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");const a=this.layer;this.addHandles(h.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable");this.addHandles(h.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");var q=a.getVariableStyle(null);const B=
[];if(q)if(q.uniqueValues?.length){const P=[];q.uniqueValues.forEach(V=>{V.enabled&&P.push({label:V.label||`${V.value}`,value:V.value,symbol:new da({color:V.color,outline:null})})});P.length&&B.push({type:"symbol-table",title:q.label,infos:P})}else if(q.transferFunction){const {colorStops:P,stretchRange:V}=q.transferFunction,Z=P.toArray().reverse(),ca=V.map((ua,na)=>`${0===na?ja.specialCharsLessThan:ja.specialCharsGreaterThan} ${fa.formatNumberLabel(ua)}`).reverse(),ea=Z.map(ua=>({color:ua.color,
value:null,label:null}));ea[0].label=ca[0];ea[ea.length-1].label=ca[1];B.push({type:"color-ramp",title:q.label,infos:ea,preview:z.renderColorRampPreviewHTML(Z.map(ua=>ua.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})})}const N=a.opacity;q=B.reduce((P,V)=>[...P,...this._getAllInfos(V)],[]).filter(P=>!!P?.symbol).map(P=>this._getSymbolPreview(P,N));await Promise.allSettled(q);this.legendElements=B;this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");
const a=this.layer.activeLayer;this.addHandles(h.watch(()=>{const {layer:B}=this;return B&&"activeLayer"in B&&B.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");const q=a.styleId?a.styles?.find(({id:B})=>B===a.styleId)?.legendUrl:void 0;q&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:q,opacity:this.opacity}]}]);this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");
const a=this.layer;let q=null;if(a.customParameters||a.customLayerParameters)q={...a.customParameters,...a.customLayerParameters};this.addHandles(h.watch(()=>{const {layer:B}=this;return B&&"sublayers"in B&&B.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,q);this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(a,q){const B=this.layer,N=[];this.addHandles(a.on("change",
()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const P=this.sublayerIds?.map(V=>B.findSublayerById(V))?.filter(R.isSome)??[];a=P.length?P:a.toArray();for(const V of a)if(a=h.watch(()=>[V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled)a=await this._generateSymbolTableElementForWMSSublayer(V,q),a?.infos.length&&N.unshift(a);return N}async _generateSymbolTableElementForWMSSublayer(a,
q){return!a.legendUrl&&a.sublayers?(q=(await this._generateLegendElementsForWMSSublayers(a.sublayers,q)).filter(B=>B),{type:"symbol-table",title:a.title,infos:q}):this._generateSymbolTableElementForLegendUrl(a,q)}async _generateSymbolTableElementForLegendUrl(a,q){let B=a.legendUrl;if(B){var N={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};q&&(B=p.addQueryParameters(B,q));q=null;a=a.layer?.opacity;try{if(q=(await C(B,{responseType:"image"})).data)q.style.opacity=a}catch{}N.infos.push({src:B,
preview:q,opacity:a});return N}}_getLegendLayers(a,q){const B=Ea&&Ea[a];return B?Promise.resolve(B):this._legendRequest(q).then(N=>{N=N.layers;return Ea[a]=N})}_legendRequest(a){var q=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===q.declaredClass){var B=q.exportImageServiceParameters.rasterFunction;B&&(a.renderingRule=JSON.stringify(B.functionDefinition?.toJSON()||B.toJSON()));q.bandIds&&(a.bandIds=q.bandIds.join());if(q.raster||q.viewId||q.customParameters){const {raster:N,
viewId:P,customParameters:V}=q;a={raster:N,viewId:P,...a,...V}}}B=q.url.replace(/(\/)+$/,"");"version"in q&&10.01<=+q.version?(q=B.indexOf("?"),B=-1<q?B.slice(0,q)+"/legend"+B.slice(q):B+"/legend"):(q=B.toLowerCase().indexOf("/rest/"),q=-1===q?B:B.slice(0,q)+B.slice(q+5),B="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(q)+"\x26returnbytes\x3dtrue");return C(B,{query:a}).then(N=>N.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[];this.removeHandles("sublayers-watcher");
const a=this.layer;this.addHandles(h.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(q){e.getLogger(this).warn("Request to server for legend has failed!",q)}}async _generateLegendElementsForBuildingSublayers(a,q){let B=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),
"sublayers-watcher");a=a.toArray();for(const P of a)if(a=h.watch(()=>["renderer"in P&&P.renderer,P.opacity,P.title,P.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||P.visible){a=null!=P?.opacity?P.opacity:null;var N=null!=a?a*q:q;"building-group"===P.type?(a={type:"symbol-table",title:P.title,infos:[]},N=await this._generateLegendElementsForBuildingSublayers(P.sublayers,N),a.infos.push(...N),B=[a,...B]):P.renderer&&
(B=[...(await this._getRendererLegendElements(P.renderer,{title:P.title,opacity:N,sublayer:P})),...B])}return B.filter(P=>!!P&&("infos"in P&&P.infos?0<P.infos.length:!0))}async _constructLegendElementsForSublayers(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;if(Sa(a)||"esri.layers.TileLayer"===a.declaredClass||Ha(a)){this.addHandles(h.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(q){e.getLogger(this).warn("Request to server for legend has failed!",q)}}}async _generateLegendElementsForSublayers(a,q,B){const N=this.layer;let P=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!B&&this.sublayerIds&&this.sublayerIds.length&&(a=Ha(N)?this.sublayerIds.map(V=>N.findSublayerForSubtypeCode(V)).filter(R.isSome):this.sublayerIds.map(V=>N.findSublayerById(V)).filter(R.isSome));
for(const V of a)if(a=h.watch(()=>[V.renderer,V.opacity,V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled&&this._isSublayerInScale(V)){a=null!=V?.opacity?V.opacity:null;a=null!=a?a*q:q;const Z="sublayers"in V?V.originIdOf("renderer")>x.OriginId.SERVICE&&!V.sublayers:!0;V.renderer&&Z?(await V.load(),P=[...(await this._getRendererLegendElements(V.renderer,{title:V.title,
opacity:a,sublayer:V})),...P]):"sublayers"in V&&(a=await this._generateSymbolTableElementForSublayer(V,a,B))&&P.unshift(a)}return P.filter(V=>!!V&&("infos"in V&&V.infos?0<V.infos.length:!0))}async _generateSymbolTableElementForSublayer(a,q,B){if(!B){B=new Map;var N=this.layer,P=a.source;let V=null;if(P&&("map-layer"!==P.type||P.mapLayerId!==a.id||P.gdbVersion&&P.gdbVersion!==("gdbVersion"in N&&N.gdbVersion))||a.originIdOf("renderer")>x.OriginId.SERVICE||a.originIdOf("labelingInfo")>x.OriginId.SERVICE||
a.originIdOf("labelsVisible")>x.OriginId.SERVICE)P=new b.ExportImageParameters({layer:this.layer}),V=P.hasDynamicLayers?P.dynamicLayers:null,P.destroy();(await this._getLegendLayers(V||`${N.uid}-default`,V)).forEach(Z=>B.set(Z.layerId,Z))}N=B.get(a.id);return(!N||N?.subLayerIds&&N.defaultVisibility)&&a.sublayers?(q=await this._generateLegendElementsForSublayers(a.sublayers,q,B),{type:"symbol-table",title:a.title,infos:q}):this._generateSymbolTableElementForLegendLayer(N,a,q)}_generateSymbolTableElementForLegendLayer(a,
q,B){if(!a?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,q))return null;var N=q?.renderer;let P=q?.title||a.layerName;N&&(!q||q?.originIdOf("renderer")>x.OriginId.SERVICE)&&(N=q?.title||this._getRendererTitle(N,q))&&(P&&"string"!==typeof N&&"title"in N&&(N.title=P),P=N);const V={type:"symbol-table",title:P,legendType:a.legendType||null,infos:[]},Z=q?this._sanitizeLegendForSublayer(a.legend.slice(),q):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(ca=>
{const ea={type:"symbol-table",title:ca.heading,legendType:a.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(Z.filter(ua=>ua.groupId===ca.id),a.layerId,B)};0<ea.infos?.length&&V.infos.push(ea)}):V.infos=this._generateSymbolTableElementInfosForLegendLayer(Z,a.layerId,B);return 0<V.infos.length?V:null}_generateSymbolTableElementInfosForLegendLayer(a,q,B){return a.map(N=>{let P=N.url;if(N.imageData&&0<N.imageData.length)P=`data:image/png;base64,${N.imageData}`;else if(0!==
P.indexOf("http"))P=l.addTokenParameter(`${this.layer.url}/${q}/images/${P}`);else return null;return{label:N.label,src:P,opacity:null==B?this.opacity:B,width:N.width,height:N.height}}).filter(R.isSome)}_isSublayerInScale(a){const q=a.minScale||0;a=a.maxScale||0;return 0<q&&q<this.scale||a>this.scale?!1:!0}_isLegendLayerInScale(a,q){q=q||this.layer;let B=null,N=null,P=!0;!q.minScale&&0!==q.minScale||!q.maxScale&&0!==q.maxScale?(0===a.minScale&&q.tileInfo&&(B=q.tileInfo.lods[0].scale),0===a.maxScale&&
q.tileInfo&&(N=q.tileInfo.lods[q.tileInfo.lods.length-1].scale)):(B=Math.min(q.minScale,a.minScale)||q.minScale||a.minScale,N=Math.max(q.maxScale,a.maxScale));if(0<B&&B<this.scale||N>this.scale)P=!1;return P}_sanitizeLegendForSublayer(a,q){if("version"in this.layer&&10.1>+this.layer.version||0===a.length)return a;q=q.renderer;let B=0,N=null;a.some(P=>P.values)&&a.some((P,V)=>{P.values||(B=V,N=P,N.label||(N.label="others"));return null!=N});q?"unique-value"===q.type?N&&(a.splice(B,1),a.push(N)):"class-breaks"===
q.type&&(N&&a.splice(B,1),a.reverse(),N&&a.push(N)):N&&(a.splice(B,1),a.push(N));return a}async _getRendererLegendElements(a,q={}){var B=this.view;B=ma(a)||ka(a)||ra(a)||va(a)||Da(a)||La(a)?"2d"===B.type||S.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||wa(a)||za(a)||Aa(a)||"vector-field"===a.type||"flow"===a.type;if(!B)return e.getLogger(this).warn(`Renderer of type '${a.type}' not supported!`),[];if(wa(a)||za(a)||Aa(a)||"esri.renderers.PointCloudRGBRenderer"===
a.declaredClass)return this._constructPointCloudRendererLegendElements(a,q);if(Da(a))return this._constructDotDensityRendererLegendElements(a);a=await this._loadRenderer(a);return La(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,q)}async _getLegendElementsForFeatureReduction(a){let q=null;"binning"===a.type?q=a.renderer:"cluster"===a.type&&(q=this._getClusterRenderer(a));return q?this._getRendererLegendElements(q):[]}_getPointCloudRendererTitle(a){return(a.legendOptions?.title||
a.field)??""}async _constructPointCloudRendererLegendElements(a,q={}){var B=q.title;q=[];let N=null;var P=null;if(wa(a))N={type:"symbol-table",title:B||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(V=>{N.infos.unshift({label:V.label||V.minValue+" - "+V.maxValue,value:[V.minValue,V.maxValue],symbol:this._getAppliedCloneSymbol(Na,V.color)})});else if(za(a)){P=a.stops;let V=null;if(P?.length&&(1===P.length&&(V=P[0].color),!V)){const Z=P[0].value,ca=P[P.length-1].value;
null!=Z&&null!=ca&&(V=W.getColorFromPointCloudStops(Z+(ca-Z)/2,P))}N={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Na,V||Na.color)}]};P=W.getRampStopsForPointCloud(a.stops??[])??[];P={type:"color-ramp",title:B||this._getPointCloudRendererTitle(a),infos:P,preview:z.renderColorRampPreviewHTML(P.map(Z=>Z.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}}else Aa(a)&&(N={type:"symbol-table",title:B||this._getPointCloudRendererTitle(a),infos:[]},
a.colorUniqueValueInfos?.forEach(V=>{N.infos.push({label:V.label||V.values.join(", "),value:V.values.join(", "),symbol:this._getAppliedCloneSymbol(Na,V.color)})}));N?.infos.length&&q.push(N);P?.infos.length&&q.push(P);B=q.reduce((V,Z)=>[...V,...(Z.infos??[])],[]).filter(V=>!!V.symbol).map(V=>this._getSymbolPreview(V,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));await Promise.allSettled(B);return q}async _getElementInfoForDotDensity(a,q){const {color:B,label:N,valueExpressionTitle:P}=
q,{backgroundColor:V,outline:Z,dotSize:ca}=a;q=this.effectList?.effects.map(na=>na.toJSON());var ea=I.effectFunctionsFromJSON(q);q=await Ba("previewTemplateAriaLabel",N||P);ea=ca+"-"+B+"-"+V+"-"+(Z&&JSON.stringify(Z.toJSON()))+"-"+ea;const ua=this._dotDensityUrlCache;a=ua.has(ea)?ua.get(ea):z.renderDotDensityPreviewHTML(a,B,{ariaLabel:q});ua.set(ea,a);q=Q.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList,
ariaLabel:q});return{opacity:1,src:a.src,preview:q,width:a.width,height:a.height}}async _constructDotDensityRendererLegendElements(a){var q=a.calculateDotValue(this.view.scale);q={type:"symbol-table",title:{value:q&&Math.round(q),unit:a.legendOptions?.unit||""},infos:[]};for(const B of a.attributes){const N=await this._getElementInfoForDotDensity(a,B);N.label=B.label||B.valueExpressionTitle||B.field;q.infos.push(N)}return[q]}async _constructPieChartRendererLegendElements(a){const q=this.layer.opacity,
B=[];let N=null;const P=a.outline;a.attributes.forEach(ca=>{const ea=new X({color:ca.color,outline:P});B.push({label:ca.label||ca.valueExpressionTitle||ca.field,symbol:ea})});var V=B.length?[...B]:[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var Z=new X({color:a.othersCategory.color,outline:P});N=a.othersCategory.label||"Other";B.push({label:N,symbol:Z})}a.defaultColor?.a&&(Z=new X({color:a.defaultColor,outline:P}),B.push({label:a.defaultLabel,symbol:Z}));Z=await this._getVisualVariableLegendElements(a,
this.layer)||[];B.length&&(Z.unshift({type:"symbol-table",title:null,infos:B}),V=V.filter(ca=>ca.label!==N).map(ca=>ca.symbol.color).filter(Boolean),V=z.renderPieChartPreviewHTML(V,{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,effectList:this.effectList,outline:P,ariaLabel:await Ba("previewPieChartAriaLabel")}),Z.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:B,preview:V}));a=Z.reduce((ca,ea)=>[...ca,...this._getAllInfos(ea)],[]).filter(ca=>
!!ca?.symbol&&!ca?.preview).map(ca=>this._getSymbolPreview(ca,q,{effectList:this.effectList}));await Promise.allSettled(a);return Z}async _constructRendererLegendElements(a,q={}){const {title:B,sublayer:N}=q,P=N||this.layer,V=ja.getReferenceSizeAuthoringInfoVisualVariable(a);if("definitionExpression"in P){var Z=P.definitionExpression;if(Z&&this.respectLayerDefinitionExpression&&ra(a)){if(this._layerDefinitionExpression!==Z){this._layerDefinitionExpressionClause=await v.parseWhereClause(Z,P.fieldsIndex);
const la=new Set((await g.getRendererFields(a,P.fieldsIndex)).map(sa=>sa.toLowerCase()));var ca=this._layerDefinitionExpressionClause?.fieldNames.map(sa=>sa.toLowerCase());ca?.every(sa=>la.has(sa))||(this._layerDefinitionExpressionClause=null,ca?.length&&e.getLogger(this).warn("Definition expression will be ignored in the Legend, as fields in the expression do not match with renderer fields"))}}else this._layerDefinitionExpressionClause=null;this._layerDefinitionExpression=Z}this._hasSizeRamp=this._hasOpacityRamp=
this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;Z=await this._getVisualVariableLegendElements(a,P)||[];const ea={type:"symbol-table",title:B||this._getRendererTitle(a,P),infos:[]};ca=null;let ua=!1;const na=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in a?a?.authoringInfo:null)?.type){var ha=B,qa=$a(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ta=Z.findIndex(la=>"color-ramp"===la.type);ta=-1!==ta?Z.splice(ta,1)[0]:null;var pa=
Z.findIndex(la=>"size-ramp"===la.type);pa=-1!==pa?Z.splice(pa,1)[0]:null;var xa=[];ta&&(ha=ta.title,xa.push(ta));pa&&(ha=pa.title,xa.push(pa));0<xa.length&&Z.push({type:qa,title:ha,infos:xa})}else if(va(a))ha=ba.getHeatmapRampStops(a),Z.push({type:"heatmap-ramp",title:B||this._getRendererTitle(a,P),infos:ha,preview:z.renderColorRampPreviewHTML(ha.map(la=>la.color),{effectList:this.effectList,ariaLabel:await Ba("previewColorRampAriaLabel")})});else if(ra(a)){if((qa=a.authoringInfo)&&"relationship"===
qa.type){const {numClasses:la,field1:sa,field2:ya}=qa;qa=qa.focus;if(la&&sa&&ya){pa=[sa,ya];ta=Y.getRotationAngleForFocus(qa)||0;for(ha of pa){const {field:Ia,normalizationField:Ja,label:Oa}=ha;pa=Oa||{field:this._getFieldAlias(Ia,P),normField:Ja&&this._getFieldAlias(Ja,P)};xa=cb.clone();xa.angle=ta;ea.infos.push({label:pa,symbol:xa});na.add(xa);ta+=90}ha=Y.getRelationshipRampElement({focus:qa,numClasses:la,infos:a.uniqueValueInfos??[]});Z.unshift(ha)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||
"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(la=>{la.symbol&&this._checkDefinitionExpressionForUVR(a,la.value)&&ea.infos.push({label:la.label||la.value,value:la.value,symbol:la.symbol})});else{const {field:la,field2:sa,field3:ya,fieldDelimiter:Ia,valueExpression:Ja,defaultSymbol:Oa}=a,db=!(!la&&!Ja||!sa&&!ya),Fa=[];a.uniqueValueGroups?.forEach(Wa=>{const Ta={type:"symbol-table",title:Wa.heading,infos:[]};Wa.classes?.forEach(Ga=>{const {symbol:Xa,values:eb}=
Ga;if(Xa){const Ua=[];var Ca=[];for(var Pa of eb??[]){const {value:Qa,value2:Ya,value3:Za}=Pa,Ka=[],Ra=[];if(la||Ja)Ka.push(Qa),Ra.push(this._getDomainName(la,Qa,P));sa&&(Ka.push(Ya),Ra.push(this._getDomainName(sa,Ya,P)));ya&&(Ka.push(Za),Ra.push(this._getDomainName(ya,Za,P)));Ua.push(db?Ka.join(Ia||""):Ka[0]);Ca.push(Ra.join(" - "))}Pa=Ua.join(", ");Ga=Ga.label;Ga||(Ca=Ca.filter(Boolean),Ga=Ca.length?Ca.join(", "):Pa);Ca=Xa.clone();"cim"===Ca.type&&V&&T.updateReferenceSizeSymbol(Ca,{innerDotSize:8,
outerRingSize:16});Ua.some(Qa=>this._checkDefinitionExpressionForUVR(a,Qa))&&Ta.infos.push({label:Ga,value:Pa,symbol:Ca})}});Ta.infos.length&&Fa.push(Ta)});Fa.length&&(ha=Fa[0],1===Fa.length&&"title"in ha&&!ha.title?ea.infos.push(...(ha.infos??[])):(Oa&&(Fa.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Oa}]}),ua=!0),ea.infos.push(...Fa)),B||a.legendOptions?.title||a.valueExpressionTitle||(ea.title=null))}a.defaultSymbol&&!ua&&(ea.infos.push({label:a.defaultLabel||"others",
symbol:a.defaultSymbol}),ua=!0)}else if(ka(a)){if(!V){ca=this._isUnclassedRenderer(a);if(!ca||!this._hasSizeRamp){ha=a.classBreakInfos.filter(({symbol:la})=>la);for(const {label:la,minValue:sa,maxValue:ya,symbol:Ia}of ha)ea.infos.unshift({label:la||(ca?null:`${sa} - ${ya}`),value:[sa,ya],symbol:Ia});ca&&(ea.title=null);this._updateInfosForClassedSizeRenderer(a,ea.infos)}a.defaultSymbol&&!ca&&(ea.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),ua=!0)}}else if("raster-stretch"===
a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=await this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?Z.push(ha):ea.infos=ha;else{ha=this.layer;a.customStatistics?.length&&({min:qa,max:ta}=a.customStatistics[0]);pa=[];pa=ha.serviceRasterInfo;if(ha.rasterFunction)try{pa=await ha.generateRasterInfo(ha.rasterFunction)}catch{}xa=y.getPixelValueRange(pa.pixelType);if(1===pa.bandCount)ha=ha.bandIds?.[0]||
0,qa=null!=qa?qa:pa.statistics?pa.statistics[ha].min:xa[0],ta=null!=ta?ta:pa.statistics?pa.statistics[ha].max:xa[1],qa||ta?Z.push(await this._getStretchLegendElements(a,{min:qa,max:ta})):this._getServerSideLegend();else if(ha.bandIds&&1===ha.bandIds.length)qa=null!=qa?qa:pa.statistics?pa.statistics[ha.bandIds[0]].min:xa[0],ta=null!=ta?ta:pa.statistics?pa.statistics[ha.bandIds[0]].max:xa[1],qa||ta?Z.push(await this._getStretchLegendElements(a,{min:qa,max:ta})):this._getServerSideLegend();else if(3<=
pa.bandCount){const {bandInfos:la}=pa;({bandIds:qa}=ha);la.length>=pa.bandCount?3===qa?.length?(pa=qa.map(sa=>la[sa].name),ea.infos=this._createSymbolTableElementMultiBand(pa)):"lerc"===ha.format?(pa=[0,1,2].map(sa=>la[sa].name),ea.infos=this._createSymbolTableElementMultiBand(pa)):this._getServerSideLegend():"lerc"===ha.format?(pa=["band1","band2","band3"],ea.infos=this._createSymbolTableElementMultiBand(pa)):this._getServerSideLegend()}else this._getServerSideLegend()}else if("raster-colormap"===
a.type)a.colormapInfos.forEach(la=>{ea.infos.push({label:la.label,value:la.value,symbol:this._getAppliedCloneSymbol(bb,la.color)})});else if(ma(a)){ha=a.symbol;switch(q.geometryType){case "point":ha="pointSymbol"in P?P.pointSymbol:null;break;case "polyline":ha="lineSymbol"in P?P.lineSymbol:null;break;case "polygon":ha="polygonSymbol"in P?P.polygonSymbol:null}qa=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&qa&&ea.infos.push({label:a.label,symbol:ha})}else"vector-field"===
a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),ea.title=a.attributeField,ha=a.getClassBreakInfos(),ha?.length?ha.forEach(la=>{ea.infos.push({label:la.minValue+" - "+la.maxValue,symbol:la.symbol})}):ea.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&Z.push(await this._getStretchLegendElements(a,{min:0,max:255}));else ha=await ja.getSymbolForFlowRenderer(a),ea.infos.push({label:null,symbol:ha});const Va=a.defaultSymbol;!Va||ua||ma(a)||
ca&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||Z.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Va}]});ea.infos.length&&Z.unshift(ea);const fb=null==q.opacity?this.opacity:q.opacity,gb=this._isTallSymbol("visualVariables"in a?a.visualVariables:null),hb="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;q=Z.reduce((la,sa)=>[...la,...this._getAllInfos(sa)],[]).filter(la=>!!la?.symbol).filter(la=>
{if("cim"===la.symbol.type){const {minScale:sa,maxScale:ya}=la.symbol.data;if(sa&&sa<this.scale||ya&&ya>this.scale)return!1}return!0}).map(la=>this._getSymbolPreview(la,fb,{isDefault:la.symbol===Va,applyScaleDrivenSize:!na.has(la.symbol),symbolConfig:{isTall:gb,isSquareFill:hb},effectList:na.has(la.symbol)?null:this.effectList}));a=null;await Promise.allSettled(q);return Z}_checkDefinitionExpressionForUVR(a,q){if(!this._layerDefinitionExpressionClause)return!0;{const {field:B,field2:N,field3:P,fieldDelimiter:V,
valueExpression:Z}=a;if(B){a=(B||Z)&&(N||P)?q?.toString().split(V||""):[q];if(q=B?{[B]:a?.[0]}:null)N&&(q[N]=a?.[1]),P&&(q[P]=a?.[2]);a=q}else a=null}return(a&&this._layerDefinitionExpressionClause.testFeature(a))??!0}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(a){const q=a?.infos;return q?q.reduce((B,N)=>B.concat(this._getAllInfos(N)),[]):[a]}async _constructTileImageryStretchRendererElements(a){const q=this.layer,B=q.symbolizer.rasterInfo??q.raster.rasterInfo;
var N;if(N=a?.customStatistics?.length?a.customStatistics:B?.statistics)({min:N,max:P}=N[0]);else{var P=y.getPixelValueRange(B.pixelType);N=P[0];P=P[1]}q.hasStandardTime()&&(N=q.getStandardTimeValue(N),P=q.getStandardTimeValue(P));if(1===B.bandCount||1===q.bandIds?.length)return this._getStretchLegendElements(a,{min:N,max:P});a=(q?.bandIds?.length?q.bandIds:Array.from(Array(Math.min(B.bandCount,3)).keys())).map(V=>B.bandInfos[V].name);3>a.length?a.push(a[1]):3<a.length&&a.splice(3);return this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(a,
q){a=W.getStretchRampStops(a.colorRamp,q);return{type:"stretch-ramp",title:"",infos:a,preview:z.renderColorRampPreviewHTML(a.map(B=>B.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}}_getClusterSymbol(){var a=this.layer;const q=(a="featureReduction"in a&&a.featureReduction)&&"symbol"in a&&a.renderer;return q&&!0!==q?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?a.symbol:null}async _getSizeLegendElement(a,q,B,N){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(q):
a,infos:await ia.getRampStops(B,q,await ja.getMedianColor(B),this.scale,this.view,N,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(a){const q=[],B=["red","green","blue"];a.forEach((N,P)=>{q.push({label:{colorName:B[P],bandName:N},src:ja.rgbImgSource[P],opacity:this.opacity??1})});return q}_updateInfosForClassedSizeRenderer(a,q){const B=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,N=a.classBreakInfos.some(P=>K.isVolumetricSymbol(P.symbol));
if(B&&N){const P=ia.realWorldMaxSize;a=a.classBreakInfos.length;const V=(P-ia.realWorldMinSize)/(1<a?a-1:a);q.forEach((Z,ca)=>{Z.size=P-V*ca})}}_isTallSymbol(a){let q=!1,B=!1;if(a)for(let N=0;N<a.length&&(!q||!B);N++){const P=a[N];"size"===P.type&&("height"===P.axis&&(q=!0),"width-and-depth"===P.axis&&(B=!0))}return q&&B}async _getSymbolPreview(a,q,B){var N=!B?.isDefault&&null==a.size&&this._hasSizeRamp?f.px2pt(L.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&B?.applyScaleDrivenSize&&
({getSize:N}=await new Promise((P,V)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],P,V)),N=N(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return z.renderPreviewHTML(a.symbol,{size:N,opacity:q,scale:!1,symbolConfig:B?.symbolConfig,effectView:B?.effectList,style:"legend",cimOptions:{allowScalingUp:!B?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!B?.applyScaleDrivenSize),
viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null},ariaLabel:a.label&&"string"!==typeof a.label?null:await Ba("previewTemplateAriaLabel",a.label)}).then(P=>{a.preview=P;return a}).catch(()=>{a.preview=null;return a})}_getClusterRenderer(a){this._hasClusterSizeVariable=!1;var q="renderer"in this.layer?this.layer.renderer:null;q=a.renderer?.clone()||q?.clone();const B=U.getEffectiveClusterSizeVariable(a,this.layerView,this.view);
if(B&&null!=q&&"visualVariables"in q&&!q.visualVariables?.some(N=>"size"===N.type&&"outline"!==N.target&&!Ma.test(N.valueExpression))){if("clusterMinSize"in a&&"clusterMaxSize"in a){const {clusterMinSize:N,clusterMaxSize:P}=a;B.legendOptions=new J({showLegend:N!==P})}q.visualVariables=(q.visualVariables||[]).concat([B]);this._hasClusterSizeVariable=!0}return q}async _loadRenderer(a){const q=[],B=a.clone(),N=await ja.getMedianColor(B);if(ka(B)||ra(B))a=(B.classBreakInfos||B.uniqueValueInfos).map(P=>
this._fetchSymbol(P.symbol,N).then(V=>{P.symbol=V}).catch(()=>{P.symbol=null})),Array.prototype.push.apply(q,a);q.push(this._fetchSymbol(B.symbol||B.defaultSymbol,B.defaultSymbol?null:N).then(P=>{this._applySymbolToRenderer(B,P,ma(B))}).catch(()=>{this._applySymbolToRenderer(B,null,ma(B))}));await Promise.allSettled(q);return B}_applySymbolToRenderer(a,q,B){B?a.symbol=q:a.defaultSymbol=q}async _fetchSymbol(a,q){if(!a)throw Error();if("web-style"===a.type){const B=this._webStyleSymbolCache;try{const N=
await ("2d"===this.view.type?a.fetchCIMSymbol({cache:B}):a.fetchSymbol({cache:B}));return this._getAppliedCloneSymbol(N,q)}catch{throw e.getLogger(this).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,q)}_getAppliedCloneSymbol(a,q){if(!a||!q)return a;a=a.clone();const B=q&&q.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,B):"cim"===a.type?r.applyCIMSymbolColor(a,q):a.color&&(a.color=new O(B||a.color));return a}_applyColorTo3dSymbol(a,q){q&&a.symbolLayers.forEach(B=>
{B&&(B.material||(B.material={}),B.material.color=new O(q))})}async _getVisualVariableLegendElements(a,q){if(!("visualVariables"in a)||"vector-field"===a.type)return null;var B=a.visualVariables??[],N=[];const P=[],V=[],Z=ja.getReferenceSizeAuthoringInfoVisualVariable(a);if(2===Z?.sizeStops?.length&&(ka(a)||ra(a))){const [na,ha]=Z.sizeStops;P.push(new A({field:Z.field??void 0,normalizationField:Z.normalizationField,minSize:na.size,maxSize:ha.size,minDataValue:na.value,maxDataValue:ha.value}))}for(const na of B)"color"===
na.type?N.push(na):"size"===na.type?P.push(na):"opacity"===na.type&&V.push(na);B=[...N,...P,...V];let ca;if(0===N.length&&ka(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ea=(ea=a.classBreakInfos[0])&&ea.symbol;0===N.length&&ma(a)&&(ea=a.symbol);ea&&(ea.type.includes("3d")?(N=ea.symbolLayers.at(0),"water"===N.type?null!=N.color&&(ca=N.color):null!=N.material?.color&&(ca=N.material.color)):ea.url||(ca=ea.color));const ua=this.effectList;return(await Promise.all(B.map(async na=>{if(!na.legendOptions||
!1!==na.legendOptions.showLegend){const ha="flow"===a.type?na.field:this._getRampTitle(na,q);let qa=null;const ta=ja.getDateFormatOptions(q,na,this.view.timeZone);"color"===na.type?(na=await W.getRampStops(na,null,ta)??[],qa={type:"color-ramp",title:ha,infos:na,preview:z.renderColorRampPreviewHTML(na.map(pa=>pa.color),{effectList:ua,ariaLabel:await Ba("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=0<na.length)):"size"===na.type&&"outline"!==na.target?Ma.test(na.valueExpression)?
this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=na):(qa=await this._getSizeLegendElement(ha,na,a,ta),this._hasSizeRamp||(this._hasSizeRamp=!(null==qa.infos||!qa.infos.length))):"opacity"===na.type&&(na=await W.getRampStops(na,ca,ta)??[],qa={type:"opacity-ramp",title:ha,infos:na,preview:z.renderColorRampPreviewHTML(na.map(pa=>pa.color),{effectList:ua,ariaLabel:await Ba("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=0<na.length));return qa?.infos?qa:null}}))).filter(R.isSome)}_getDomainName(a,
q,B){return a&&"function"!==typeof a?(B=(a="getField"in B&&B.getField?.(a))&&"getFieldDomain"in B&&B.getFieldDomain?B.getFieldDomain(a.name,{excludeImpliedDomains:t("esri-widget-legacy-field-domain-calculation")}):null,"coded-value"===B?.type?B.getName(q):null):null}_getClusterTitle(a){var q=this.layer;a=a.field;if("featureReduction"in q&&q.featureReduction&&"cluster"===q.featureReduction.type&&(q=q.featureReduction,q=(q="popupTemplate"in q&&q.popupTemplate)&&q.fieldInfos))for(const B of q)if(B.fieldName===
a)return"cluster_count"===a?B.label||{showCount:!0}:B.label;return{showCount:!0}}_getRampTitle(a,q){let B=a.field,N=a.normalizationField,P=!1,V=!1,Z=!1;var ca=null;B="function"===typeof B?null:B;N="function"===typeof N?null:N;ca=a.legendOptions?.title;if(null==ca)if(a.valueExpressionTitle)ca=a.valueExpressionTitle;else{if("renderer"in q&&q.renderer&&"authoringInfo"in q.renderer&&q.renderer.authoringInfo?.visualVariables)for(a=q.renderer.authoringInfo.visualVariables,ca=0;ca<a.length;ca++){const ea=
a[ca];if("color"===ea.type){if("ratio"===ea.style){P=!0;break}if("percent"===ea.style){V=!0;break}if("percent-of-total"===ea.style){Z=!0;break}}}ca={field:B&&this._getFieldAlias(B,q),normField:N&&this._getFieldAlias(N,q),ratio:P,ratioPercent:V,ratioPercentTotal:Z}}return ca}_getRendererTitle(a,q){if(a.legendOptions?.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var B=a.field;let N=null,P=null;ka(a)&&(N=a.normalizationField,P="percent-of-total"===a.normalizationType);
B="function"===typeof B?null:B;N="function"===typeof N?null:N;if(ra(a)){const {field2:V,field3:Z,fieldDelimiter:ca}=a;B=B&&this._getFieldAlias(B,q);V&&(B=`<${B}>${ca}<${this._getFieldAlias(V,q)}>`,Z&&(B=`${B}${ca}<${this._getFieldAlias(Z,q)}>`));return B}a=null;if(B||N)a={field:B&&this._getFieldAlias(B,q),normField:N&&this._getFieldAlias(N,q),normByPct:P};return a}_getFieldAlias(a,q){let B=("popupTemplate"in q?q.popupTemplate:null)?.fieldInfos?.find(Z=>a===Z.fieldName),N=null;"getField"in q&&q.getField?
N=q.getField(a):"fieldsIndex"in q&&q.fieldsIndex&&(N=q.fieldsIndex.get(a));let P=null;if(q="featureReduction"in q&&q.featureReduction)B??="popupTemplate"in q?q.popupTemplate?.fieldInfos?.find(Z=>a?.toLowerCase()===Z.fieldName?.toLowerCase()):void 0,"fields"in q&&q.fields&&(P=q.fields.find(Z=>Z.name?.toLowerCase()===a?.toLowerCase()));q=B||N||P;let V=null;q&&(V=B?.label||N?.alias||P?.alias||"name"in q&&q.name||"fieldName"in q&&q.fieldName||null);return V}_isUnclassedRenderer(a){const q=a.visualVariables;
let B=!1;ka(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&q&&(B=a.field?q.some(N=>!(!N||a.field!==N.field||(a.normalizationField||N.normalizationField)&&a.normalizationField!==N.normalizationField)):!!q.length);return B}};H.__decorate([n.property()],F.prototype,"children",void 0);H.__decorate([n.property({readOnly:!0})],F.prototype,"effectList",null);H.__decorate([n.property()],F.prototype,"layerView",void 0);H.__decorate([n.property()],F.prototype,"layer",void 0);H.__decorate([n.property()],
F.prototype,"legendElements",void 0);H.__decorate([n.property({readOnly:!0})],F.prototype,"opacity",null);H.__decorate([n.property()],F.prototype,"parent",void 0);H.__decorate([n.property({readOnly:!0,dependsOn:[]})],F.prototype,"ready",null);H.__decorate([n.property()],F.prototype,"hideLayersNotInCurrentView",void 0);H.__decorate([n.property()],F.prototype,"keepCacheOnDestroy",void 0);H.__decorate([n.property()],F.prototype,"respectLayerDefinitionExpression",void 0);H.__decorate([n.property()],F.prototype,
"respectLayerVisibility",void 0);H.__decorate([n.property({readOnly:!0})],F.prototype,"scale",null);H.__decorate([n.property()],F.prototype,"sublayerIds",void 0);H.__decorate([n.property({readOnly:!0})],F.prototype,"isScaleDriven",null);H.__decorate([n.property()],F.prototype,"title",void 0);H.__decorate([n.property({readOnly:!0,dependsOn:["ready"],value:0})],F.prototype,"version",null);H.__decorate([n.property()],F.prototype,"view",void 0);return F=H.__decorate([k.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],
F)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(m,H,O,F,l,C,w,G,R,D){function t(d){d=R.parse(d)||[];var h=(h=d[0])?"type"in h:!1;return h?[{scale:-1,effects:d}]:d}function c(d,h,f){return d[0]?.effects&&h[0]?.effects?(-1===d[0]?.scale||-1===h[0]?.scale)&&(1<d.length||
1<h.length)&&0>=f?!1:D.canInterpolateEffects(d[0].effects,h[0].effects):!0}function e(d,h,f){const v=d.length>h.length?d:h;d=d.length>h.length?h:d;var p=d[d.length-1];h=p?.scale??f;p=p?.effects??[];for(let n=d.length;n<v.length;n++)d.push({scale:h,effects:[...p]});for(h=0;h<v.length;h++)d[h].scale=-1===d[h].scale?f:d[h].scale,v[h].scale=-1===v[h].scale?f:v[h].scale,D.normalizeEffects(d[h].effects,v[h].effects)}m.EffectView=class extends O{constructor(d){super(d);this._final=this._to=this._from=null;
this._current=[];this._time=0;this.duration=F("mapview-transitions-duration");this.effects=[]}set effect(d){const h=this._get("effect");d=d||"";if(h!==d){this._set("effect",d);try{this._transitionTo(t(d))}catch(f){this._transitionTo([]),C.getLogger(this).warn("Invalid Effect",{effect:d,error:f})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(d){this._updateForScale(d)}get transitioning(){return null!==this._to}canTransitionTo(d){try{return 0<
this.scale&&c(this._current,t(d),this.scale)}catch{return!1}}transitionStep(d,h){this._applyTimeTransition(d);this._updateForScale(h)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(d){0<this.scale&&c(this._current,d,this.scale)?(this._final=d,this._to=l.clone(d),e(this._current,this._to,this.scale),this._from=l.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=d);this._set("effects",this._current[0]?l.clone(this._current[0].effects):[])}_applyTimeTransition(d){if(this._to&&
this._from&&this._current&&this._final){this._time+=d;d=Math.min(1,this._time/this.duration);for(let f=0;f<this._current.length;f++){const v=this._current[f],p=this._from[f],n=this._to[f];var h=p.scale;v.scale=h+(n.scale-h)*d;for(h=0;h<v.effects.length;h++)v.effects[h].interpolate(p.effects[h],n.effects[h],d)}1===d&&(this._current=this._final,this._set("effects",this._current[0]?l.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}}_updateForScale(d){this._set("scale",d);if(0!==
this._current.length){var h=this._current,f=this._current.length-1,v,p=1;if(1===h.length||d>=h[0].scale)var n=v=h[0].effects;else if(d<=h[f].scale)n=v=h[f].effects;else for(let k=0;k<f;k++){const x=h[k],E=h[k+1];if(x.scale>=d&&E.scale<=d){p=(d-x.scale)/(E.scale-x.scale);v=x.effects;n=E.effects;break}}for(d=0;d<this.effects.length;d++)this.effects[d].interpolate(v[d],n[d],p)}}};H.__decorate([w.property()],m.EffectView.prototype,"_to",void 0);H.__decorate([w.property()],m.EffectView.prototype,"duration",
void 0);H.__decorate([w.property({value:""})],m.EffectView.prototype,"effect",null);H.__decorate([w.property({readOnly:!0})],m.EffectView.prototype,"effects",void 0);H.__decorate([w.property({readOnly:!0})],m.EffectView.prototype,"final",null);H.__decorate([w.property({readOnly:!0})],m.EffectView.prototype,"hasEffects",null);H.__decorate([w.property({value:0})],m.EffectView.prototype,"scale",null);H.__decorate([w.property({readOnly:!0})],m.EffectView.prototype,"transitioning",null);m.EffectView=H.__decorate([G.subclass("esri.layers.effects.EffectView")],
m.EffectView);m.canInterpolateEffectStops=c;m.convertEffectToStops=t;m.normalizeEffectStops=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/sql ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/scaleUtils ./floorFilterUtils ./sublayerUtils".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c){const e={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};m.ExportImageParameters=class extends O{constructor(d){super(d);this.floors=null;this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const d=this.visibleSublayers.map(h=>
{const f=t.getLayerFloorFilterClause(this.floors,h);return h.toExportImageJSON(f)});return d.length?JSON.stringify(d):null}get hasDynamicLayers(){return this.layer&&c.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(d){this._get("layer")!==d&&(this._set("layer",d),this.removeHandles("layer"),d&&this.addHandles([d.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),d.on("sublayer-update",h=>this.notifyChange(e[h.propertyName]))],"layer"))}get layers(){const d=
this.visibleSublayers;return d?d.length?"show:"+d.map(h=>h.id).join(","):"show:-1":null}get layerDefs(){const d=!!this.floors?.length,h=this.visibleSublayers.filter(f=>null!=f.definitionExpression||d&&null!=f.floorInfo);return h.length?JSON.stringify(h.reduce((f,v)=>{var p=t.getLayerFloorFilterClause(this.floors,v);p=F.sqlAnd(p,v.definitionExpression);null!=p&&(f[v.id]=p);return f},{})):null}get version(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
const d=this.layer;d&&(d.commitProperty("dpi"),d.commitProperty("imageFormat"),d.commitProperty("imageTransparency"),d.commitProperty("gdbVersion"));return(this._get("version")||0)+1}get visibleSublayers(){const d=[];if(!this.layer)return d;var h=this.layer.sublayers;const f=this.scale,v=p=>{p.visible&&(0===f||D.isInScaleRange(f,p.minScale,p.maxScale))&&(p.sublayers?p.sublayers.forEach(v):d.unshift(p))};h&&h.forEach(v);h=this._get("visibleSublayers");return!h||h.length!==d.length||h.some((p,n)=>d[n]!==
p)?d:h}toJSON(){var d=this.layer;d={dpi:d.dpi,format:d.imageFormat,transparent:d.imageTransparency,gdbVersion:d.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?d.dynamicLayers=this.dynamicLayers:d={...d,layers:this.layers,layerDefs:this.layerDefs};return d}};H.__decorate([l.property({readOnly:!0})],m.ExportImageParameters.prototype,"dynamicLayers",null);H.__decorate([l.property()],m.ExportImageParameters.prototype,"floors",void 0);H.__decorate([l.property({readOnly:!0})],m.ExportImageParameters.prototype,
"hasDynamicLayers",null);H.__decorate([l.property()],m.ExportImageParameters.prototype,"layer",null);H.__decorate([l.property({readOnly:!0})],m.ExportImageParameters.prototype,"layers",null);H.__decorate([l.property({readOnly:!0})],m.ExportImageParameters.prototype,"layerDefs",null);H.__decorate([l.property({type:Number})],m.ExportImageParameters.prototype,"scale",void 0);H.__decorate([l.property({readOnly:!0})],m.ExportImageParameters.prototype,"version",null);H.__decorate([l.property({readOnly:!0})],
m.ExportImageParameters.prototype,"visibleSublayers",null);m.ExportImageParameters=H.__decorate([R.subclass("esri.layers.support.ExportImageParameters")],m.ExportImageParameters);Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(m,H,O){function F(l,C){C=O.getMetersPerUnitForSR(C);return l/(C*O.inchesPerMeter*96)}m.getExtentForScale=function(l,C){const w=l.extent;l=
l.width-(l.padding?l.padding.left+l.padding.right:0);C=F(C,w.spatialReference);return w.clone().expand(C*l/w.width)};m.getResolutionForScale=F;m.getResolutionInMetersForScale=function(l){return l/(96*O.inchesPerMeter)};m.getScale=function(l,C){C=C||l.extent;l=l.width;const w=O.getMetersPerUnitForSR(C?.spatialReference);return C&&l?C.width/l*w*O.inchesPerMeter*96:0};m.getScaleForResolution=function(l,C){C=O.getMetersPerUnitForSR(C);return l*C*O.inchesPerMeter*96};m.isInScaleRange=function(l,C,w){if(C=
0===C||H.floatEqualAbsolute(l,C)||l<C)C=0===w||H.floatEqualAbsolute(l,w)||l>w;return C};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(m){function H(O,F){if(!O?.length)return null;O=O.filter(l=>""!==l).map(l=>`'${l}'`);O.push("''");return`${F} IN (${O.join(",")}) OR ${F} IS NULL`}m.getFloorFilterClause=function(O){const F=O.layer;return"floorInfo"in F&&F.floorInfo?.floorField&&"floors"in O.view?H(O.view.floors,
F.floorInfo.floorField):null};m.getLayerFloorFilterClause=function(O,F){return"floorInfo"in F&&F.floorInfo?.floorField?H(O,F.floorInfo.floorField):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(m,H){function O(F,l){if(!F?.length||null==l)return!0;l=l.slice().reverse().flatten(({sublayers:G})=>G&&G.toArray().reverse()).map(G=>G.id).toArray();if(F.length>l.length)return!1;
let C=0;const w=l.length;for(const {id:G}of F){for(;C<w&&l[C]!==G;)C++;if(C>=w)return!1}return!0}m.isExportDynamic=function(F,l,C){return F.some(w=>{var G=w.source;G=!G||"map-layer"===G.type&&G.mapLayerId===w.id&&(null==G.gdbVersion||G.gdbVersion===C);w.commitProperty("renderer");w.commitProperty("labelingInfo");w.commitProperty("opacity");w.commitProperty("labelsVisible");return!G||w.originIdOf("renderer")>H.OriginId.SERVICE||w.originIdOf("labelingInfo")>H.OriginId.SERVICE||w.originIdOf("opacity")>
H.OriginId.SERVICE||w.originIdOf("labelsVisible")>H.OriginId.SERVICE})?!0:!O(F,l)};m.isSublayerOverhaul=function(F){return!!F&&F.some(l=>null!=l.minScale||null!=l.layerDefinition?.minScale)};m.shouldWriteSublayerStructure=function(F,l,C){return l.flatten(({sublayers:w})=>w).length!==F.length||F.some(w=>w.originIdOf("minScale")>C||w.originIdOf("maxScale")>C||w.originIdOf("renderer")>C||w.originIdOf("labelingInfo")>C||w.originIdOf("opacity")>C||w.originIdOf("labelsVisible")>C||w.originIdOf("source")>
C)?!0:!O(F,l)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(m){function H(l){return F[l]??[-3.4028234663852886E38,3.4028234663852886E38]}function O(l){return(l?.startsWith("s")||l?.startsWith("u"))??!1}const F={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],
f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};m.clipBandToPixelTypeRange=function(l,C,w,G){let [R,D]=H(w);var t=O(w);t&&(R-=1E-5,D+=1E-5);if(t)if(w.startsWith("u")){const [c,e]=[R,D];for(w=0;w<C.length;w++)C[w]&&(t=l[w],t<c||t>e?C[w]=0:G[w]=t+.5<<0)}else{const [c,e]=[R,D];for(w=0;w<C.length;w++)C[w]&&(t=l[w],t<c||t>e?C[w]=0:G[w]=t+(0<t?.5:-.5)<<0)}else{const [c,e]=[R,D];for(w=0;w<C.length;w++)C[w]&&(t=l[w],t<c||t>e?C[w]=0:G[w]=t)}};m.convertNoDataToMask=function(l,
C,w){if(!(l.depthCount&&1<l.depthCount)){var {pixels:G,statistics:R,pixelType:D}=l,t=G[0].length,c=l.bandMasks??[];t=l.mask??(new Uint8Array(t)).fill(255);var e="f32"===D||"f64"===D,d=H(D),h=!1;for(let p=0;p<G.length;p++){const n="number"===typeof C?C:C[p];if(null==n)continue;var f=R?.[p]?.maxValue??d[1];if((R?.[p]?.minValue??d[0])>n+Number.EPSILON||f<n-Number.EPSILON)continue;f=c[p]||t.slice();const k=G[p];var v=w?.customFloatTolerance;if(e&&0!==v){v||=9.999999E37<=Math.abs(n)?2E-7*Math.abs(n):"f32"===
D?2**-23:Number.EPSILON;for(let x=0;x<k.length;x++)f[x]&&Math.abs(k[x]-n)<v&&(k[x]=0,f[x]=0,t[x]=0,h=!0)}else for(v=0;v<k.length;v++)f[v]&&k[v]===n&&(k[v]=0,f[v]=0,t[v]=0,h=!0);c[p]=f}h&&(l.bandMasks=l.bandMasks||1<l.pixels.length?c:null,l.mask=t);h&&"updateStatistics"in l&&l.updateStatistics()}};m.fixNaN=function(l,C){for(let w=0;w<C.length;w++)C[w]&&isNaN(l[w])&&(C[w]=0,l[w]=0)};m.getIntegerPixelType=function(l,C){return null==l||null==C?"s32":0>l?-128<=l&&128>C?"s8":-32768<=l&&32768>C?"s16":"s32":
256>C?"u8":65536>C?"u16":"u32"};m.getPixelValueRange=H;m.isIntegerPixelType=O;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(m,H,O,F,l){function C(D){return null==D||"simple"===D.type||"unique-value"===D.type||"class-breaks"===D.type||"dictionary"===D.type||"heatmap"===D.type}function w(D,t){if(!t)return null;
t=Array.isArray(t)?t:[t];if(0<t.length){const c=t.map(d=>d.details.symbol.type||d.details.symbol.declaredClass).filter(d=>!!d);c.sort();const e=[];c.forEach((d,h)=>{0!==h&&d===c[h-1]||e.push(d)});return new F("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${e.join(", ")}) which are not supported in 3D`,{renderer:D,symbolErrors:t})}return null}function G(D,t){const c={...l.defaultTo3DOptions,...t,cimFallbackEnabled:!0};t=D.uniqueValueInfos?.map(d=>l.to3D(d.symbol,c).error).filter(H.isSome);
const e=l.to3D(D.defaultSymbol,c);e.error&&t?.unshift(e.error);return w(D,t)}function R(D,t){const c={...l.defaultTo3DOptions,...t,cimFallbackEnabled:!0};t=D.classBreakInfos.map(d=>l.to3D(d.symbol,c).error).filter(H.isSome);const e=l.to3D(D.defaultSymbol,c);e.error&&t.unshift(e.error);return w(D,t)}m.isSupportedRenderer3D=C;m.validateTo3D=function(D,t){if(null==D)return null;if(!C(D))return new F("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${D.type||D.declaredClass}'`,
{renderer:D});switch(D.type){case "simple":return w(D,l.to3D(D.symbol,{...l.defaultTo3DOptions,...t,cimFallbackEnabled:!0}).error);case "unique-value":return G(D,t);case "class-breaks":return R(D,t)}return null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/renderers/support/referenceSizeUtils":function(){define("exports ../../../symbols ../../../core/Error ../../../core/lang ../../../renderers/visualVariables/support/SizeStop ../../../symbols/cim/enums ../../../symbols/CIMSymbol".split(" "),
function(m,H,O,F,l,C,w){function G(c){switch(c){case "circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],
[9.94,.33],[8.5,.2]]]};case "square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case "diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case "hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case "hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function R(c){return"CIMVectorMarker"===c?.type?c.markerGraphics?.[0]:void 0}
function D(c){return"CIMPolygonSymbol"===c?.symbol?.type?c.symbol.symbolLayers?.[0]:void 0}var t;(function(c){c.OuterRing="reference-size-outer-ring";c.InnerDot="reference-size-inner-dot"})(t||={});m.createPrimitiveOverrides=function(c){const {view:e,field:d,normalizationField:h,sizeStops:f,sizeByScaleEnabled:v}=c,{value:p,size:n}=f[0],{value:k,size:x}=f[1];c=0;let E;d&&(c=`$feature["${d}"]`,E=`\n      if(!HasValue($feature, "${d}")){\n        return 0;\n      }\n      $feature["${d}"];\n    `);h&&
(c=`$feature["${d}"] / $feature["${h}"]`,E=`if(!HasValue($feature, "${d}") || !HasValue($feature, "${h}") || $feature["${h}"] <= 0){\n        return 0;\n      }\n      $feature["${d}"];\n      $feature["${h}"];`);return[{type:"CIMPrimitiveOverride",primitiveName:t.OuterRing,propertyName:"Size",valueExpressionInfo:{type:"CIMExpressionInfo",title:"Size in pixels of outer ring",expression:v?`\n      ${E}\n      var maxSize = ${x};\n      var referenceScale = ${e.scale};\n      return (maxSize * (referenceScale / $view.scale));\n    `:
`${E}\n      return ${x}`,returnType:"Default"}},{type:"CIMPrimitiveOverride",primitiveName:t.InnerDot,propertyName:"Size",valueExpressionInfo:{type:"CIMExpressionInfo",title:"Size in pixels of inner ring",expression:`\n        ${E}\n        var value = ${c};\n\n        var referenceScale = ${e.scale};\n        var referenceScaleRatio = ${v?"(referenceScale / $view.scale)":1};\n        var maxSize = ${x} * referenceScaleRatio;\n        var minSize = ${n} * referenceScaleRatio;\n\n        var minDataValue = ${p};\n        var maxDataValue = ${k};\n\n        var ratio = Constrain(( value - minDataValue ) / ( maxDataValue - minDataValue ), 0, 1);\n\n        var innerDotSize = Constrain(maxSize * ratio, minSize, maxSize);\n        return innerDotSize;\n      `,
returnType:"Default"}}]};m.createReferenceSizeSymbol=function(c){const {primitiveOverrides:e}=c;const {type:d,color:h,colorLocked:f}=c;var v={type:"CIMVectorMarker",enable:!0,colorLocked:!1,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:t.OuterRing,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:G(d),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:h.toArray(),colorLocked:!!f,effects:[{type:"CIMGeometricEffectDonut",
width:.75}]}]}}],scaleSymbolsProportionally:!1,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:C.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:20};const {type:p,color:n}=c;c={type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:t.InnerDot,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:G(p),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:n.toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:C.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:10};return new w({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[v,c]},primitiveOverrides:e}})};m.getReferenceSizeStops=function(c){if(null!=c.minDataValue&&null!=c.maxDataValue&&null!=c.minSize&&null!=c.maxSize&&"number"===typeof c.minSize&&
"number"===typeof c.maxSize)return[new l({value:c.minDataValue,size:c.minSize}),new l({value:c.maxDataValue,size:c.maxSize})];throw new O("create-reference-size-symbol","Invalid size variable");};m.updateReferenceSizeSymbol=function(c,e){const {outerRingSize:d,innerDotSize:h,type:f,color:v,colorLocked:p,primitiveOverrides:n}=e;e="CIMPolygonSymbol"===c.data.symbol?.type?c.data.symbol.symbolLayers:null;if(2===e?.length)for(const E of e){var k=(e=E.primitiveName===t.OuterRing)?d:h;"CIMVectorMarker"===
E?.type&&null!=k&&(E.size=k);k=f;var x=R(E);x&&null!=k&&(x.geometry=G(k));k=v;(x=D(R(E)))&&null!=k&&(x.color=k.toArray());k=p;(x=D(R(E)))&&null!=k&&e&&(x.colorLocked=k)}null!=d&&null!=h&&(c.data.primitiveOverrides=null);void 0!==n&&(c.data.primitiveOverrides=F.clone(n));return c};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(m,H,O){function F(c){c=O.toCIMSymbolJSON(c);if("CIMTextSymbol"===
c?.type)return c.height??0;let e=0;if(c?.symbolLayers)for(const d of c.symbolLayers)O.isCIMMarker(d)&&null!=d.size&&d.size>e?e=d.size:O.isCIMStroke(d)&&null!=d.width&&d.width>e?e=d.width:O.isCIMFill(d);return e}function l(c,e,d,h){if(c)if("CIMTextSymbol"===c.type)null!=c.height&&(c.height*=e);else{if(d&&c.effects)for(const f of c.effects)G(f,e);if(c.symbolLayers)for(const f of c.symbolLayers)switch(f.type){case "CIMPictureMarker":case "CIMVectorMarker":C(f,e,h);break;case "CIMPictureStroke":case "CIMSolidStroke":!h?.preserveOutlineWidth&&
f.width&&(f.width*=e);break;case "CIMPictureFill":f.height&&(f.height*=e);f.offsetX&&(f.offsetX*=e);f.offsetY&&(f.offsetY*=e);break;case "CIMHatchFill":l(f.lineSymbol,e,!0,{...h,preserveOutlineWidth:!1}),f.offsetX&&(f.offsetX*=e),f.offsetY&&(f.offsetY*=e),f.separation&&(f.separation*=e)}}}function C(c,e,d){if(c&&(c.markerPlacement&&w(c.markerPlacement,e),c.offsetX&&(c.offsetX*=e),c.offsetY&&(c.offsetY*=e),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*e,y:c.anchorPoint.y*
e}),c.size=null!=c.size?c.size*e:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const h of c.markerGraphics)c.scaleSymbolsProportionally||l(h.symbol,e,!0,d)}function w(c,e){O.isCIMMarkerStrokePlacement(c)&&c.offset&&(c.offset*=e);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=e);if(c.placementTemplate&&c.placementTemplate.length){var d=c.placementTemplate.map(h=>
h*e);c.placementTemplate=d}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=e);c.placementTemplate&&c.placementTemplate.length&&(d=c.placementTemplate.map(h=>h*e),c.placementTemplate=d);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=e);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=e);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=e);c.endPosition&&(c.endPosition*=
e);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=e),c.offsetY&&(c.offsetY*=e),c.stepX&&(c.stepX*=e),c.stepY&&(c.stepY*=e)}}function G(c,e){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=e);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=e);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=e);c.endCut&&(c.endCut*=e);
c.middleCut&&(c.middleCut*=e);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=e);c.offsetAlongLine&&(c.offsetAlongLine*=e);if(c.dashTemplate&&c.dashTemplate.length){const d=c.dashTemplate.map(h=>h*e);c.dashTemplate=d}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=e);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=e);c.offsetY&&(c.offsetY*=e);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&
(c.offset*=e);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=e);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=e);c.length&&(c.length*=e);c.toWidth&&(c.toWidth*=e);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=e),c.period&&(c.period*=e)}}function R(c,e){if(c){var d="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(d?.symbolLayers)for(const h of d.symbolLayers)if(!(h.colorLocked||c&&(O.isCIMStroke(h)||O.isCIMMarker(h)&&
h.markerPlacement&&O.isCIMMarkerStrokePlacement(h.markerPlacement))))switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor&&D(e,h.tintColor);break;case "CIMVectorMarker":h.markerGraphics?.forEach(f=>{R(f.symbol,e)});break;case "CIMSolidStroke":case "CIMSolidFill":D(e,h.color);break;case "CIMHatchFill":R(h.lineSymbol,e)}}}function D(c,e){for(const d of c)if(d.join(".")===e.join("."))return;c.push(e)}function t(c,e,d){if(c){var h="CIMTextSymbol"===c.type?c.symbol:
c;c="CIMPolygonSymbol"===h?.type;if(h?.symbolLayers)for(const f of h.symbolLayers)if(!f.colorLocked){if(c)if(d){if({layersToColor:h}=d,(O.isCIMStroke(f)||O.isCIMMarker(f)&&f.markerPlacement&&O.isCIMMarkerStrokePlacement(f.markerPlacement))&&"fill"===h||O.isCIMFill(f)&&"outline"===h)continue}else if(O.isCIMStroke(f)||O.isCIMMarker(f)&&f.markerPlacement&&O.isCIMMarkerStrokePlacement(f.markerPlacement))continue;h=e.toArray();switch(f.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":f.tintColor=
h;break;case "CIMVectorMarker":f.markerGraphics?.forEach(v=>{t(v.symbol,e,d)});break;case "CIMSolidStroke":case "CIMSolidFill":f.color=h;break;case "CIMHatchFill":t(f.lineSymbol,e,d)}}}}m.applyCIMSymbolColor=function(c,e,d){e instanceof H||(e=new H(e));(c=O.toCIMSymbolJSON(c))&&t(c,e,d)};m.applyCIMSymbolRotation=function(c,e,d=!1){c=O.toCIMSymbolJSON(c);d&&(e=360-e);if("CIMTextSymbol"===c?.type)c.angle=e;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){d=e-(c.angle||0);for(const h of c.symbolLayers)if(O.isCIMMarker(h)){let f=
h.rotation||0;f=h.rotateClockwise?f-d:f+d;h.rotation=f}c.angle=e}};m.getCIMSymbolColor=function(c){c=O.toCIMSymbolJSON(c);const e=[];R(c,e);return e.length?new H(O.normalizeAlpha(e[0])):null};m.getCIMSymbolRotation=function(c,e=!1){c=O.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&e?360-c:c??0):0};m.getCIMSymbolSize=F;m.getCIMSymbolType=function(c){c=O.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};m.scaleCIMMarker=C;m.scaleCIMSymbol=l;m.scaleCIMSymbolTo=function(c,e,d){if(c){var h=O.toCIMSymbolJSON(c);c=F(c);if(0===c){if(h)if("CIMTextSymbol"===h.type)h.height=e;else if(h.symbolLayers)for(const f of h.symbolLayers)switch(f.type){case "CIMPictureMarker":case "CIMVectorMarker":f.size=e;break;case "CIMPictureStroke":case "CIMSolidStroke":f.width=
e}}else l(h,e/c,!1,d)}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(m,H){function O(F,l){return Math.round(Math.min(Math.max(F+191.25*l,0),255))}m.SymbolSizeDefaults=void 0;(function(F){F[F.size=22]="size";F[F.lineWidth=50]="lineWidth";F[F.maxSize=120]="maxSize";F[F.maxOutlineSize=80]="maxOutlineSize";F[F.tallSymbolWidth=20]="tallSymbolWidth"})(m.SymbolSizeDefaults||(m.SymbolSizeDefaults={}));
m.adjustColorBrightness=function(F,l){if(null==F)return new H;if("type"in F&&("linear"===F.type||"pattern"===F.type))return F;F=new H(F);return new H([O(F.r,l),O(F.g,l),O(F.b,l),F.a])};m.adjustColorComponentBrightness=O;m.getConeShapes=function(F,l){let C=l?m.SymbolSizeDefaults.tallSymbolWidth:F;l=l?4:6;C=C<=m.SymbolSizeDefaults.size?C-.5*l:C-l;l=.15*C;const w=C;F-=l;return[{type:"ellipse",cx:.5*C,cy:F,rx:.5*C,ry:l},{type:"path",path:[{command:"M",values:[.5*w,0]},{command:"L",values:[w,F]},{command:"L",
values:[0,F]},{command:"Z",values:[]}]}]};m.getCubeShapes=function(F,l){let C=l?m.SymbolSizeDefaults.tallSymbolWidth:F;var w=l?4:6;w=C=C<=m.SymbolSizeDefaults.size?C-.5*w:C-w;l=l?.35*C:.5*C;return[{type:"path",path:[{command:"M",values:[.5*w,0]},{command:"L",values:[w,.5*l]},{command:"L",values:[.5*w,l]},{command:"L",values:[0,.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*w,l]},{command:"L",values:[.5*w,F]},{command:"L",values:[0,F-.5*l]},
{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*w,l]},{command:"L",values:[.5*w,F]},{command:"L",values:[w,F-.5*l]},{command:"L",values:[w,.5*l]},{command:"Z",values:[]}]}]};m.getCylinderShapes=function(F,l){var C=l?m.SymbolSizeDefaults.tallSymbolWidth:F;l=l?4:6;C=C<=m.SymbolSizeDefaults.size?C-.5*l:C-l;l=.5*C;const w=.15*C;F-=w;return[{type:"ellipse",cx:.5*C,cy:F,rx:l,ry:w},{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[0,F]},{command:"L",values:[C,F]},{command:"L",
values:[C,w]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*C,cy:w,rx:l,ry:w}]};m.getDiamondShapes=function(F){var l=F;l=l<m.SymbolSizeDefaults.size?l-2:l-4;const C=Math.floor(F/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[l,.5*F-C]},{command:"L",values:[.45*l-C,.5*F+C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[.45*l-C,.5*F+C]},{command:"L",values:[0,.5*F-C]},{command:"Z",values:[]}]},{type:"path",
path:[{command:"M",values:[0,.5*F-C]},{command:"L",values:[.45*l-C,.5*F+C]},{command:"L",values:[.45*l,F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,F]},{command:"L",values:[l,.5*F-C]},{command:"L",values:[.45*l-C,.5*F+C]},{command:"Z",values:[]}]}]};m.getExtrudeSymbolShapes=function(F){const l=m.SymbolSizeDefaults.size;F*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*l]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[.3*l,.7*l+F]},{command:"L",values:[0,
.7*l+F-.35*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,.7*l]},{command:"L",values:[.3*l,.7*l+F]},{command:"L",values:[l,F]},{command:"L",values:[l,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*l,0]},{command:"L",values:[l,0]},{command:"L",values:[.3*l,.7*l]},{command:"L",values:[0,.35*l]},{command:"Z",values:[]}]}]};m.getInvertedConeShapes=function(F){let l=F;l=l<m.SymbolSizeDefaults.size?l-3:l-6;const C=.15*l,w=l;return[{type:"path",path:[{command:"M",
values:[0,0]},{command:"L",values:[w,0]},{command:"L",values:[.5*w,F-C]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*l,cy:0,rx:.5*l,ry:C}]};m.getPathSymbolShapes=function(F,l,C){var w=m.SymbolSizeDefaults.size;let G=w,R=w;1>F?G*=.75:1<F&&(R*=1.25);F=w;l&&C&&(G=R=F=w=0);return[{type:"path",path:[{command:"M",values:[F,0]},{command:"L",values:[C?F:.875*F,0]},{command:"L",values:[C?G-.5*F:0,R-.5*w]},{command:"L",values:[G-.5*F,R-.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[F,
0]},{command:"L",values:[F,l?0:.125*w]},{command:"L",values:[G-.5*F,l?R-.5*w:w]},{command:"L",values:[G-.5*F,R-.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[G-.5*F,R-.5*w]},{command:"L",values:[C?G-.5*F:0,R-.5*w]},{command:"L",values:[C?G-.5*F:0,l?R-.5*w:w]},{command:"L",values:[G-.5*F,l?R-.5*w:w]},{command:"Z",values:[]}]}]};m.getTetrahedronShapes=function(F){var l=F;l=l<m.SymbolSizeDefaults.size?l-1:l-2;return[{type:"path",path:[{command:"M",values:[.45*F,0]},{command:"L",
values:[F,l]},{command:"L",values:[.45*F,.6*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*F,0]},{command:"L",values:[.45*F,.6*l]},{command:"L",values:[0,l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.45*F,.6*l]},{command:"L",values:[F,l]},{command:"Z",values:[]}]}]};m.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
m.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(m,H,O,F,l,C,w,G,R,D){function t(d,h){e.append(d,h);e.detach(h)}function c(d,h,f){return d?O(d,{responseType:"image"}).then(v=>{v=v.data;const p=v.width,n=
v.height,k=p/n;let x=h;f&&(x=Math.min(x,Math.max(p,n)));return{image:v,width:1>=k?Math.ceil(x*k):x,height:1>=k?x:Math.ceil(x/k)}}):Promise.reject(new l("renderUtils: imageDataSize","href not provided."))}const e=G.createProjector();m.renderOnce=t;m.renderSymbol=function(d,h,f){const v=Math.ceil(h[0]),p=Math.ceil(h[1]);if(!d.some(n=>!!n.length))return null;h=f?.node||document.createElement("div");null!=f.opacity&&(h.style.opacity=f.opacity.toString());null!=f.effectView&&(h.style.filter=D.getCSSFilterFromEffectList(f.effectView));
t(h,()=>R.renderSVG(d,v,p,f));return h};m.tintImageWithColor=function(d,h,f,v,p){return c(d,h,p).then(n=>{const k=n.width??h,x=n.height??h;var E;if(E=n.image)E=f&&"ignore"!==v?"multiply"===v&&255===f.r&&255===f.g&&255===f.b&&1===f.a?!1:!0:!1;if(E){var I=n.image.width,b=n.image.height;C("edge")&&/\.svg$/i.test(d)&&(--I,--b);E=Math.ceil(k);var g=Math.ceil(x);var u=document.createElement("canvas");u.width=E;u.height=g;u.style.width=E+"px";u.style.height=g+"px";u=u.getContext("2d");u.clearRect(0,0,E,
g);E=u;E.drawImage(n.image,0,0,I,b,0,0,k,x);g=E.getImageData(0,0,k,x);u=[f.r/255,f.g/255,f.b/255,f.a];const M=F.toHSV(f);for(let S=0;S<g.data.length;S+=4){n=g.data;I=S;b=u;var y=M;switch(v){case "multiply":n[I]*=b[0];n[I+1]*=b[1];n[I+2]*=b[2];n[I+3]*=b[3];break;default:const A=F.toHSV({r:n[I],g:n[I+1],b:n[I+2]});A.h=y.h;A.s=y.s;A.v=A.v/100*y.v;y=F.toRGB(A);n[I]=y.r;n[I+1]=y.g;n[I+2]=y.b;n[I+3]*=b[3]}}E.putImageData(g,0,0);d=E.canvas.toDataURL("image/png")}else E=H.id?.findCredential(d),E?.token&&
(n=d.includes("?")?"\x26":"?",d=`${d}${n}token=${E.token}`);return{url:d,width:k,height:x}}).catch(()=>({url:d,width:h,height:h}))};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ./svgGlobalState ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(m,
H,O,F,l,C,w,G,R,D){function t(r,L){r*=T/180;return Math.abs(L*Math.sin(r))+Math.abs(L*Math.cos(r))}function c(r){return r.map(L=>`${L.command} ${L.values.join(" ")}`).join(" ").trim()}function e(r,L,Q,z,K){if(r){if("circle"===r.type)return D.tsx("circle",{cx:r.cx,cy:r.cy,fill:L,"fill-rule":"evenodd",r:r.r,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-dashoffset":Q.dashOffset,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("ellipse"===r.type)return D.tsx("ellipse",
{cx:r.cx,cy:r.cy,fill:L,"fill-rule":"evenodd",rx:r.rx,ry:r.ry,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("rect"===r.type)return D.tsx("rect",{fill:L,"fill-rule":"evenodd",height:r.height,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width,width:r.width,x:r.x,y:r.y});if("image"===r.type)return D.tsx("image",{alt:K||
"image",height:r.height,href:r.src,preserveAspectRatio:"none",width:r.width,x:r.x,y:r.y});if("path"===r.type)return r="string"!==typeof r.path?c(r.path):r.path,D.tsx("path",{d:r,fill:L,"fill-rule":"evenodd",stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("text"===r.type)return F.assertIsSome(z),D.tsx("text",{"dominant-baseline":z.dominantBaseline,fill:L,"fill-rule":"evenodd","font-family":z.font.family,
"font-size":z.font.size,"font-style":z.font.style,"font-variant":z.font.variant,"font-weight":z.font.weight,kerning:z.kerning,rotate:z.rotate,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width,"text-anchor":z.align,"text-decoration":z.decoration,"text-rendering":y,x:r.x,y:r.y},r.text)}return null}function d(r){if(!r)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in r))return{fill:(new H(r)).toString(),
pattern:null,linearGradient:null};if("pattern"===r.type){var L=`patternId-${G.nextPatternId()}`;return{fill:`url(#${L})`,pattern:{id:L,x:r.x,y:r.y,width:r.width,height:r.height,image:{x:0,y:0,width:r.width,height:r.height,href:r.src}},linearGradient:null}}L=`linearGradientId-${G.nextLinearGradientId()}`;return{fill:`url(#${L})`,pattern:null,linearGradient:{id:L,x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2,stops:r.colors.map(Q=>({offset:Q.offset,color:Q.color&&(new H(Q.color)).toString()}))}}}function h(r){const L=
{color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};r&&(null!=r.width&&(L.width=r.width),r.cap&&(L.cap=r.cap),r.join&&(L.join=r.join.toString()),r.color&&(L.color=(new H(r.color)).toString()),r.dashArray&&(L.dashArray=r.dashArray),r.dashoffset&&(L.dashOffset=r.dashoffset),r.style&&!r.dashArray&&(L.dashArray=w.getDashArray(r).join(",")||"none"));return L}function f(r,L){const Q={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,
family:null}};if(r){const z=r.alignBaseline;Q.align=r.align;Q.dominantBaseline="baseline"===z?"auto":"top"===z?"text-top":"bottom"===z?"hanging":z;Q.decoration=r.decoration;Q.kerning=r.kerning?"auto":"0";Q.rotate=r.rotated?"90":"0";F.assertIsSome(L);Q.font.style=L.style||"normal";Q.font.variant=L.variant||"normal";Q.font.weight=L.weight||"normal";Q.font.size=L.size&&L.size.toString()||"10pt";Q.font.family=L.family||"serif"}return Q}function v(r){const {pattern:L,linearGradient:Q}=r;return L?D.tsx("pattern",
{height:L.height,id:L.id,patternUnits:"userSpaceOnUse",width:L.width,x:L.x,y:L.y},D.tsx("image",{height:L.image.height,href:L.image.href,width:L.image.width,x:L.image.x,y:L.image.y})):Q?(r=Q.stops.map((z,K)=>D.tsx("stop",{key:`${K}-stop`,offset:z.offset,"stop-color":z.color})),D.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:Q.id,x1:Q.x1,x2:Q.x2,y1:Q.y1,y2:Q.y2},r)):null}function p(r,L){if(!r||0===r.length)return null;const Q=[];for(const z of r){const {shape:K,fill:U,stroke:W,font:ba}=z;
r=d(U);const Y=h(W),ia="text"===K.type?f(K,ba):null;(r=e(K,r.fill,Y,ia))&&Q.push(r)}return D.tsx("mask",{id:L,maskUnits:"userSpaceOnUse"},D.tsx("g",null,Q))}function n(r,L,Q,z,K){C.scale(r,C.identity(r),[L,Q]);r[4]=r[4]*L-z*L+z;r[5]=r[5]*Q-K*Q+K;return r}function k(r,L){if(A&&"left"in A){null!=A.left&&A.left>r&&(A.left=r);if(null==A.right||A.right<r)A.right=r;if(null==A.top||A.top>L)A.top=L;if(null==A.bottom||A.bottom<L)A.bottom=L}else A={left:r,bottom:L,right:r,top:L}}function x(r){const L=r.args,
Q=L.length;switch(r.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(r=0;r<Q;r+=2)k(L[r],L[r+1]);J.x=L[Q-2];J.y=L[Q-1];break;case "H":for(r=0;r<Q;++r)k(L[r],J.y);J.x=L[Q-1];break;case "V":for(r=0;r<Q;++r)k(J.x,L[r]);J.y=L[Q-1];break;case "m":r=0;"x"in J||(k(J.x=L[0],J.y=L[1]),r=2);for(;r<Q;r+=2)k(J.x+=L[r],J.y+=L[r+1]);break;case "l":case "t":for(r=0;r<Q;r+=2)k(J.x+=L[r],J.y+=L[r+1]);break;case "h":for(r=0;r<Q;++r)k(J.x+=L[r],J.y);break;case "v":for(r=0;r<Q;++r)k(J.x,J.y+=L[r]);break;
case "c":for(r=0;r<Q;r+=6)k(J.x+L[r],J.y+L[r+1]),k(J.x+L[r+2],J.y+L[r+3]),k(J.x+=L[r+4],J.y+=L[r+5]);break;case "s":case "q":for(r=0;r<Q;r+=4)k(J.x+L[r],J.y+L[r+1]),k(J.x+=L[r+2],J.y+=L[r+3]);break;case "A":for(r=0;r<Q;r+=7)k(L[r+5],L[r+6]);J.x=L[Q-2];J.y=L[Q-1];break;case "a":for(r=0;r<Q;r+=7)k(J.x+=L[r+5],J.y+=L[r+6])}}function E(r,L,Q){const z=M[r.toLowerCase()];"number"===typeof z&&(z?L.length>=z&&(r={action:r,args:L.slice(0,L.length-L.length%z)},Q.push(r),x(r)):(r={action:r,args:[]},Q.push(r),
x(r)))}function I(r){const L={x:0,y:0,width:0,height:0};if("circle"===r.type)L.x=r.cx-r.r,L.y=r.cy-r.r,L.width=2*r.r,L.height=2*r.r;else if("ellipse"===r.type)L.x=r.cx-r.rx,L.y=r.cy-r.ry,L.width=2*r.rx,L.height=2*r.ry;else if("image"===r.type||"rect"===r.type)L.x=r.x,L.y=r.y,L.width=r.width,L.height=r.height;else if("path"===r.type){{const K=("string"!==typeof r.path?c(r.path):r.path).match(S),U=[];A={};J={};if(K){r="";var Q=[],z=K.length;for(let W=0;W<z;++W){const ba=K[W],Y=parseFloat(ba);isNaN(Y)?
(r&&E(r,Q,U),Q=[],r=ba):Q.push(Y)}E(r,Q,U);r={x:0,y:0,width:0,height:0};A&&"left"in A&&(r.x=A.left,r.y=A.top,r.width=A.right-A.left,r.height=A.bottom-A.top)}else r=null}L.x=r.x;L.y=r.y;L.width=r.width;L.height=r.height}return L}function b(r){const L={x:0,y:0,width:0,height:0};let Q=null,z=Number.NEGATIVE_INFINITY,K=Number.NEGATIVE_INFINITY;for(const U of r)Q?(Q.x=Math.min(Q.x,U.x),Q.y=Math.min(Q.y,U.y),z=Math.max(z,U.x+U.width),K=Math.max(K,U.y+U.height)):(Q=L,Q.x=U.x,Q.y=U.y,z=U.x+U.width,K=U.y+
U.height);Q&&(Q.width=z-Q.x,Q.height=K-Q.y);return Q}function g(r,L,Q,z,K,U,W,ba,Y){var ia=(W&&U?t(U,L):L)/2,ja=(W&&U?t(U,Q):Q)/2;if(Y){var fa=Y[0];Y=Y[1];ia=(W&&U?t(U,fa):fa)/2;ja=(W&&U?t(U,Y):Y)/2}fa=r.width+z;const X=r.height+z;W=l.create();Y=l.create();var da=!1;if(K&&0!==fa&&0!==X){K=L!==Q?L/Q:fa/X;da=L>Q?L:Q;let oa=1,aa=1;isNaN(da)||(1<K?(oa=da/fa,aa=da/K/X):(aa=da/X,oa=da*K/fa));C.multiply(Y,Y,n(W,oa,aa,ia,ja));da=!0}K=r.x+(fa-z)/2;r=r.y+(X-z)/2;z=C.multiply;ia-=K;ja-=r;ia=C.translate(W,C.identity(W),
[ia,ja]);z.call(C,Y,Y,ia);!da&&(fa>L||X>Q)&&(ia=fa/L>X/Q,L=(ia?L:Q)/(ia?fa:X),C.multiply(Y,Y,n(W,L,L,K,r)));ba&&(L=C.multiply,Q=ba[0],ba=ba[1],ba=C.translate(W,C.identity(W),[Q,ba]),L.call(C,Y,Y,ba));U&&(ba=C.multiply,L=U%360*Math.PI/180,C.rotate(W,C.identity(W),L),U=Math.cos(L),L=Math.sin(L),Q=W[4],fa=W[5],W[4]=Q*U-fa*L+r*L-K*U+K,W[5]=fa*U+Q*L-K*L-r*U+r,ba.call(C,Y,Y,W));return`matrix(${Y[0]},${Y[1]},${Y[2]},${Y[3]},${Y[4]},${Y[5]})`}function u(r,L,Q){r=r?.effects.find(ba=>"bloom"===ba.type);if(!r)return null;
const {strength:z,radius:K}=r;r=0<z?K:0;const U=(z+r)*L,W=4*z+1;return D.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${Q}`,width:"300%",x:"-100%",y:"-100%"},D.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(z+.5*r)*5**(L/100)*(.4+L/100),result:"dilate"}),D.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:U/25}),D.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:U/50}),D.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
D.tsx("feFuncR",{slope:W,type:"linear"}),D.tsx("feFuncG",{slope:W,type:"linear"}),D.tsx("feFuncB",{slope:W,type:"linear"})),D.tsx("feMerge",null,D.tsx("feMergeNode",{in:"intensityBlur"}),D.tsx("feMergeNode",{in:"intensityBrightness"}),D.tsx("feGaussianBlur",{stdDeviation:z/10})))}R=O("android");const y=O("chrome")||R&&4<=R?"auto":"optimizeLegibility",M={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},S=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let A={},J={};const T=Math.PI;m.computeBBox=b;m.generateFillAttributes=
d;m.generateStrokeAttributes=h;m.generateTextAttributes=f;m.getBoundingBox=I;m.getTransformMatrix=g;m.renderDef=v;m.renderSVG=function(r,L,Q,z={}){const K=[],U=[],W=G.nextBloomId(),ba=u(z.effectView,L,W);var Y=null;ba&&(Y=z.effectView?.effects.find(ka=>"bloom"===ka.type),Y=(Y.strength?Y.strength+Y.radius/2:0)/3,Y=[Math.max(L+L*Y,10),Math.max(Q+Q*Y,10)]);let ia=L,ja=Q;if(z.useRotationSize)for(var fa=0;fa<r.length;fa++){var X=z.rotations?.[fa]??0;ia=Math.max(t(X,L),ia);ja=Math.max(t(X,Q),ja)}for(fa=
0;fa<r.length;fa++){var da=r[fa];X=[];var oa=[],aa=0,ma=0;let ka=0;for(const ra of da){const {shape:va,fill:wa,stroke:za,font:Aa,offset:Da}=ra;z.ignoreStrokeWidth||"text"===va.type||(aa+=za?.width||0);da=d(wa);const La=h(za),Ha="text"===va.type?f(va,Aa):null;K.push(v(da));X.push(e(va,da.fill,La,Ha,z.ariaLabel));oa.push(I(va));Da&&(ma+=Da[0],ka+=Da[1])}da=z.rotations?.[fa]??0;z.useRotationSize&&(ma+=(ia-t(da,L))/2,ka+=(ja-t(da,Q))/2);oa=b(oa);aa=g(oa,L,Q,aa,z.scale??!1,da,z.useRotationSize??!1,[ma,
ka],Y);ma=null;z.masking&&(ma=`mask-${fa}`,K.push(p(z.masking[fa],ma)),ma=`url(#${ma})`);U.push(ma?D.tsx("g",{mask:ma},D.tsx("g",{transform:aa},X)):D.tsx("g",{transform:aa},X))}ba&&(F.assertIsSome(Y),ia=Y[0],ja=Y[1]);return D.tsx("svg",{"aria-label":z.ariaLabel,focusable:!1,height:ja,role:"img",style:"display: block;",width:ia,xmlns:"http://www.w3.org/2000/svg"},ba,D.tsx("defs",null,K),ba?D.tsx("g",{filter:`url(#bloom${W})`},U):U)};m.renderShape=e;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],function(m){function H(){const R=new Float32Array(6);R[0]=1;R[3]=1;return R}function O(R){const D=new Float32Array(6);D[0]=R[0];D[1]=R[1];D[2]=R[2];D[3]=R[3];D[4]=R[4];D[5]=R[5];return D}function F(R,D,t,c,e,d){const h=new Float32Array(6);h[0]=R;h[1]=D;h[2]=t;h[3]=c;h[4]=e;h[5]=d;return h}function l(R,D){return new Float32Array(R,D,6)}function C(R,D,t,c){const e=D[c];D=D[c+1];R[c]=t[0]*e+t[2]*D+t[4];R[c+1]=t[1]*e+t[3]*D+
t[5]}function w(R,D,t,c=0,e=0,d=2){for(e=e||D.length/d;c<e;c++)C(R,D,t,c*d)}const G=Object.freeze(Object.defineProperty({__proto__:null,clone:O,create:H,createView:l,fromValues:F,transform:C,transformMany:w},Symbol.toStringTag,{value:"Module"}));m.clone=O;m.create=H;m.createView=l;m.fromValues=F;m.mat2df32=G;m.transform=C;m.transformMany=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(m,H){function O(b,
g){b[0]=g[0];b[1]=g[1];b[2]=g[2];b[3]=g[3];b[4]=g[4];b[5]=g[5];return b}function F(b){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=0;b[5]=0;return b}function l(b,g,u,y,M,S,A){b[0]=g;b[1]=u;b[2]=y;b[3]=M;b[4]=S;b[5]=A;return b}function C(b,g){const u=g[0],y=g[1],M=g[2],S=g[3],A=g[4];g=g[5];let J=u*S-y*M;if(!J)return null;J=1/J;b[0]=S*J;b[1]=-y*J;b[2]=-M*J;b[3]=u*J;b[4]=(M*g-S*A)*J;b[5]=(y*A-u*g)*J;return b}function w(b){return b[0]*b[3]-b[1]*b[2]}function G(b,g,u){const y=g[0],M=g[1],S=g[2],A=g[3],J=g[4];g=g[5];
const T=u[0],r=u[1],L=u[2],Q=u[3],z=u[4];u=u[5];b[0]=y*T+S*r;b[1]=M*T+A*r;b[2]=y*L+S*Q;b[3]=M*L+A*Q;b[4]=y*z+S*u+J;b[5]=M*z+A*u+g;return b}function R(b,g,u){const y=g[0],M=g[1],S=g[2],A=g[3],J=g[4];g=g[5];const T=Math.sin(u);u=Math.cos(u);b[0]=y*u+S*T;b[1]=M*u+A*T;b[2]=y*-T+S*u;b[3]=M*-T+A*u;b[4]=J;b[5]=g;return b}function D(b,g,u){const y=g[1],M=g[2],S=g[3],A=g[4],J=g[5],T=u[0];u=u[1];b[0]=g[0]*T;b[1]=y*T;b[2]=M*u;b[3]=S*u;b[4]=A;b[5]=J;return b}function t(b,g,u){const y=g[0],M=g[1],S=g[2],A=g[3],
J=g[4];g=g[5];const T=u[0];u=u[1];b[0]=y;b[1]=M;b[2]=S;b[3]=A;b[4]=y*T+S*u+J;b[5]=M*T+A*u+g;return b}function c(b,g){const u=Math.sin(g);g=Math.cos(g);b[0]=g;b[1]=u;b[2]=-u;b[3]=g;b[4]=0;b[5]=0;return b}function e(b,g){b[0]=g[0];b[1]=0;b[2]=0;b[3]=g[1];b[4]=0;b[5]=0;return b}function d(b,g){b[0]=1;b[1]=0;b[2]=0;b[3]=1;b[4]=g[0];b[5]=g[1];return b}function h(b){return"mat2d("+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+")"}function f(b){return Math.sqrt(b[0]**2+b[1]**2+b[2]**2+b[3]**2+b[4]**
2+b[5]**2+1)}function v(b,g,u){b[0]=g[0]+u[0];b[1]=g[1]+u[1];b[2]=g[2]+u[2];b[3]=g[3]+u[3];b[4]=g[4]+u[4];b[5]=g[5]+u[5];return b}function p(b,g,u){b[0]=g[0]-u[0];b[1]=g[1]-u[1];b[2]=g[2]-u[2];b[3]=g[3]-u[3];b[4]=g[4]-u[4];b[5]=g[5]-u[5];return b}function n(b,g,u){b[0]=g[0]*u;b[1]=g[1]*u;b[2]=g[2]*u;b[3]=g[3]*u;b[4]=g[4]*u;b[5]=g[5]*u;return b}function k(b,g,u,y){b[0]=g[0]+u[0]*y;b[1]=g[1]+u[1]*y;b[2]=g[2]+u[2]*y;b[3]=g[3]+u[3]*y;b[4]=g[4]+u[4]*y;b[5]=g[5]+u[5]*y;return b}function x(b,g){return b[0]===
g[0]&&b[1]===g[1]&&b[2]===g[2]&&b[3]===g[3]&&b[4]===g[4]&&b[5]===g[5]}function E(b,g){const u=b[0],y=b[1],M=b[2],S=b[3],A=b[4];b=b[5];const J=g[0],T=g[1],r=g[2],L=g[3],Q=g[4];g=g[5];const z=H.getEpsilon();return Math.abs(u-J)<=z*Math.max(1,Math.abs(u),Math.abs(J))&&Math.abs(y-T)<=z*Math.max(1,Math.abs(y),Math.abs(T))&&Math.abs(M-r)<=z*Math.max(1,Math.abs(M),Math.abs(r))&&Math.abs(S-L)<=z*Math.max(1,Math.abs(S),Math.abs(L))&&Math.abs(A-Q)<=z*Math.max(1,Math.abs(A),Math.abs(Q))&&Math.abs(b-g)<=z*Math.max(1,
Math.abs(b),Math.abs(g))}const I=Object.freeze(Object.defineProperty({__proto__:null,add:v,copy:O,determinant:w,equals:E,exactEquals:x,frob:f,fromRotation:c,fromScaling:e,fromTranslation:d,identity:F,invert:C,mul:G,multiply:G,multiplyScalar:n,multiplyScalarAndAdd:k,rotate:R,scale:D,set:l,str:h,sub:p,subtract:p,translate:t},Symbol.toStringTag,{value:"Module"}));m.add=v;m.copy=O;m.determinant=w;m.equals=E;m.exactEquals=x;m.frob=f;m.fromRotation=c;m.fromScaling=e;m.fromTranslation=d;m.identity=F;m.invert=
C;m.mat2d=I;m.mul=G;m.multiply=G;m.multiplyScalar=n;m.multiplyScalarAndAdd=k;m.rotate=R;m.scale=D;m.set=l;m.str=h;m.sub=p;m.subtract=p;m.translate=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(m,H,O,F,l,C,w){function G(e){if(!e)return null;let d=null;switch(e.type){case "simple-fill":case "picture-fill":case "simple-marker":d=
G(e.outline);break;case "simple-line":const h=C.pt2px(e.width);null!=e.style&&"none"!==e.style&&0!==h&&(d={color:e.color,style:c(e.style),width:h,cap:e.cap,join:"miter"===e.join?C.pt2px(e.miterLimit):e.join},d.dashArray=R(d).join(",")||"none");break;default:d=null}return d}function R(e){if(!e?.style)return[];const {dashArray:d,style:h,width:f}=e;if("string"===typeof d&&"none"!==d)return d.split(",").map(n=>Number(n));const v=f??0,p=D.has(h)?D.get(h).map(n=>n*v):[];if("butt"!==e.cap)for(const [n,k]of p.entries())p[n]=
1===n%2?k+v:Math.max(k-v,1);return p}const D=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),t=new l.LRUCache(1E3),c=(()=>{const e={};return d=>{if(e[d])return e[d];const h=d.replaceAll("-","");return e[d]=h}})();O=new O([128,128,128]);m.defaultThematicColor=O;m.dekebabifyLineStyle=c;m.getDashArray=
R;m.getFill=function(e){const d=e.style;let h=null;if(e)switch(e.type){case "simple-marker":"cross"!==d&&"x"!==d&&(h=e.color);break;case "simple-fill":d&&"solid"!==d?"none"!==d&&(h={type:"pattern",x:0,y:0,src:H.getAssetUrl(`esri/symbols/patterns/${d}.png`),width:5,height:5}):h=e.color;break;case "picture-fill":h={type:"pattern",src:e.url,width:C.pt2px(e.width)*e.xscale,height:C.pt2px(e.height)*e.yscale,x:C.pt2px(e.xoffset),y:C.pt2px(e.yoffset)};break;case "text":h=e.color;break;case "cim":h=w.getCIMSymbolColor(e)}return h};
m.getPatternUrlWithColor=function(e,d){const h=e+"-"+d;return void 0!==t.get(h)?Promise.resolve(t.get(h)):F(e,{responseType:"image"}).then(f=>{f=f.data;const v=f.naturalWidth,p=f.naturalHeight,n=document.createElement("canvas");n.width=v;n.height=p;const k=n.getContext("2d");k.fillStyle=d;k.fillRect(0,0,v,p);k.globalCompositeOperation="destination-in";k.drawImage(f,0,0);f=n.toDataURL();t.put(h,f);return f})};m.getStroke=G;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgGlobalState":function(){define(["exports"],
function(m){function H(G=0){l=G}function O(G=0){C=G}function F(G=0){w=G}let l=0,C=0,w=0;m.nextBloomId=function(){return w++};m.nextLinearGradientId=function(){return C++};m.nextPatternId=function(){return l++};m.resetBloomId=F;m.resetLinearGradientId=O;m.resetPatternId=H;m.resetSVGGlobalState=function(){H();O();F()};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c){function e(b){b=b.symbolLayers;if(!b)return null;let g=null;b.forEach(u=>{"object"===u.type&&u.resource?.href||(g="water"===u.type?u.color:u.material?u.material.color:null)});return g?new O(g):null}function d(b,g){if(null==g||null==b)return b;b=b.toRgba();b[3]*=g;return new O(b)}function h(b,g,u){if(b=b.symbolLayers){var y=M=>{g=g??M??(null!=u?I:null);return d(g,u)};b.forEach(M=>{if("object"!==M.type||!M.resource?.href||g)if("water"===M.type)M.color=y(M.color);else{const S=
y(null!=M.material?M.material.color:null);null==M.material?M.material=new c.Symbol3DMaterial({color:S}):M.material.color=S;null!=u&&"outline"in M&&null!=M.outline?.color&&(M.outline.color=d(M.outline.color,u))}})}}async function f(b,g){(b=b.symbolLayers)&&await l.forEach(b,async u=>v(u,g))}async function v(b,g){switch(b.type){case "extrude":b.size="number"===typeof g[2]?g[2]:0;break;case "icon":case "line":case "text":g=p(g);null!=g&&(b.size=g);break;case "path":const u=k(g,G.ONES,[b.width,void 0,
b.height]);b.width=E(g[0],b.width,1,u);b.height=E(g[2],b.height,1,u);break;case "object":await n(b,g)}}function p(b){for(const g of b)if("number"===typeof g)return g;return null}async function n(b,g){const {resourceSize:u,symbolSize:y}=await x(b),M=k(g,u,y);b.width=E(g[0],y[0],u[0],M);b.depth=E(g[1],y[1],u[1],M);b.height=E(g[2],y[2],u[2],M)}function k(b,g,u){for(let y=0;3>y;y++){const M=b[y];switch(M){case "symbol-value":return b=u[y],null!=b?b/g[y]:1;case "proportional":break;default:if(M&&g[y])return M/
g[y]}}return 1}async function x(b){var {computeObjectLayerResourceSize:g}=await new Promise((J,T)=>m(["./symbolLayerUtils"],J,T));g=await g(b,10);const {width:u,height:y,depth:M}=b;b=[u,M,y];let S=1;for(var A=0;3>A;A++){const J=b[A];if(null!=J){S=J/g[A];break}}for(A=0;3>A;A++)null==b[A]&&(b[A]=g[A]*S);return{resourceSize:g,symbolSize:b}}function E(b,g,u,y){switch(b){case "proportional":return u*y;case "symbol-value":return null!=g?g:u;default:return b}}const I=new O("white");H.applyColorToSymbol=
function(b,g,u){if(b&&(g||null!=u))if(g&&=new O(g),F.isSymbol3D(b))h(b,g,u);else if(F.isSymbol2D(b)){if(g=g??b.color)b.color=d(g,u);null!=u&&"outline"in b&&b.outline?.color&&(b.outline.color=d(b.outline.color,u))}};H.applyOpacityToColor=d;H.applyRotationToSymbol=function(b,g,u){b&&null!=g&&(F.isSymbol3D(b)?(b=b.symbolLayers)&&b.forEach(y=>{if("object"===y.type)switch(u){case "tilt":y.tilt=(y.tilt??0)+g;break;case "roll":y.roll=(y.roll??0)+g;break;default:y.heading=(y.heading??0)+g}"icon"===y.type&&
(y.angle+=g)}):!F.isSymbol2D(b)||"simple-marker"!==b.type&&"picture-marker"!==b.type&&"text"!==b.type||(b.angle+=g))};H.applySizesToSymbol=async function(b,g){if(b&&g){if(F.isSymbol3D(b))return f(b,g);if(F.isSymbol2D(b)&&(g=p(g),null!=g))switch(b.type){case "simple-marker":b.size=g;break;case "picture-marker":const u=b.width/b.height;1<u?(b.width=g,b.height=g*u):(b.width=g*u,b.height=g);break;case "simple-line":b.width=g;break;case "text":b.font.size=g}}};H.fetchWebStyleSymbol=async function(b,g){const u=
await b.fetchSymbol(g);return u?u:b.fetchCIMSymbol(g)};H.getCSSFilterFromEffectList=function(b){if(!b)return null;b=b.effects.filter(g=>"bloom"!==g.type).map(g=>g.toJSON());return R.effectFunctionsFromJSON(b)};H.getColorFromSymbol=function(b,g){if(!b)return null;let u=null;F.isSymbol3D(b)?u=e(b):F.isSymbol2D(b)&&(u="cim"===b.type?D.getCIMSymbolColor(b):b.color?new O(b.color):null);return u?d(u,g):null};H.getIconHref=function(b){return b.resource?.href??""};H.getSymbolOutlineSize=function(b){return b?
F.isSymbol3D(b)?(b=(b=b.symbolLayers?.at(-1))&&"outline"in b?b?.outline?.size:void 0,null!=b?b:0):w.px2pt(t.getStroke(b)?.width):0};H.isVolumetricSymbol=function(b){if(null==b||!("symbolLayers"in b)||null==b.symbolLayers)return!1;switch(b.type){case "point-3d":return b.symbolLayers.some(g=>"object"===g.type);case "line-3d":return b.symbolLayers.some(g=>"path"===g.type);case "polygon-3d":return b.symbolLayers.some(g=>"object"===g.type||"extrude"===g.type);default:return!1}};H.symbolHasExtrudeSymbolLayer=
function(b){return null!=b&&"polygon-3d"===b.type&&b.symbolLayers.some(g=>"extrude"===g.type)};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(m,H,O,F,l,C,w,G,R,D){function t(v,p){if(p&&(v.style.filter=
G.getCSSFilterFromEffectList(p),p=p.effects))for(const n of p)if("drop-shadow"===n?.type){0>n.offsetX?v.style.marginLeft=`${Math.abs(n.offsetX)}px`:v.style.marginRight=`${n.offsetX}px`;break}}async function c(v,p){switch(v.type){case "web-style":var {previewWebStyleSymbol:n}=await new Promise((k,x)=>m(["./previewWebStyleSymbol"],k,x));return n(v,c,p);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:n}=await new Promise((k,x)=>m(["./previewSymbol3D"],
k,x)),n(v,p);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:n}=await new Promise((k,x)=>m(["./previewSymbol2D"],k,x)),n(v,p);case "cim":return{previewCIMSymbol:n}=await new Promise((k,x)=>m(["./previewCIMSymbol"],k,x)),n(v,p)}}function e(v){return v&&"opacity"in v?v.opacity*e(v.parent):1}function d(v){if(v)return"renderer"in v?v.renderer:void 0}let h=null;const f=[255,255,255];H.getDisplayedColor=async function(v,
p){if(v){var {layer:n,sourceLayer:k}=v,x=e(n??k);if(null!=v.symbol&&(null==p||!0!==p.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await G.fetchWebStyleSymbol(v.symbol,p):v.symbol.clone(),G.getColorFromSymbol(v,x);var E=p?.renderer??d(n)??d(k),I=E&&"getSymbolAsync"in E?await E.getSymbolAsync(v,p):void 0;if(I){I="web-style"===I.type?await G.fetchWebStyleSymbol(I,p):I.clone();I=G.getColorFromSymbol(I,x);if(!(E&&"visualVariables"in E)||"visualVariables"in E&&!E.visualVariables||"visualVariables"in
E&&!E.visualVariables?.length)return I;"arcadeRequiredForVisualVariables"in E&&E.arcadeRequiredForVisualVariables&&null==p?.arcade&&(p={...p},p.arcade=await F.loadArcade());var {getColor:b,getOpacity:g}=await new Promise((M,S)=>m(["../../renderers/visualVariables/support/visualVariableUtils"],M,S)),u=[],y=[];if(E.visualVariables)for(const M of E.visualVariables)switch(M.type){case "color":u.push(M);break;case "opacity":y.push(M)}E=(E=0<u.length?u[u.length-1]:null)?b(E,v,p):I;v=(I=0<y.length?y[y.length-
1]:null)?g(I,v,p):null;null!=x&&(v=null!=v?v*x:x);return E?G.applyOpacityToColor(E,v):null}}};H.getDisplayedSymbol=async function(v,p){if(v){var n=v.sourceLayer,k=(null!=p&&(p.useSourceLayer??!1)?n:v.layer)??n;n=e(k);if(null!=v.symbol&&(null==p||!0!==p.ignoreGraphicSymbol))return v="web-style"===v.symbol.type?await G.fetchWebStyleSymbol(v.symbol,{...p,cache:null!=p?p.webStyleCache:null}):v.symbol.clone(),G.applyColorToSymbol(v,null,n),v;var x=p?.renderer??d(k);if(k=x&&"getSymbolAsync"in x?await x.getSymbolAsync(v,
p):null){k="web-style"===k.type?await k.fetchSymbol({...p,cache:null!=p?p.webStyleCache:null}):k.clone();if(!(x&&"visualVariables"in x&&x.visualVariables?.length))return G.applyColorToSymbol(k,null,n),k;"arcadeRequiredForVisualVariables"in x&&x.arcadeRequiredForVisualVariables&&null==p?.arcade&&(p={...p},p.arcade=await F.loadArcade());var {getColor:E,getOpacity:I,getAllSizes:b,getRotationAngle:g}=await new Promise((J,T)=>m(["../../renderers/visualVariables/support/visualVariableUtils"],J,T)),u=[],
y=[],M=[],S=[];for(var A of x.visualVariables)switch(A.type){case "color":u.push(A);break;case "opacity":y.push(A);break;case "rotation":S.push(A);break;case "size":A.target||M.push(A)}A=(A=!!u.length&&u[u.length-1])?E(A,v,p):null;y=(y=!!y.length&&y[y.length-1])?I(y,v,p):null;null!=n&&(y=null!=y?y*n:n);G.applyColorToSymbol(k,A,y);M.length&&(n=b(M,v,p),await G.applySizesToSymbol(k,n));for(const J of S)G.applyRotationToSymbol(k,g(J,v,p),J.axis);return k}}};H.getLegendLabel=async function(v,p,n){if(v){var {layer:k,
sourceLayer:x}=v,E=n?.renderer??d(k)??d(x);if(!E)return null;if("visualVariables"in E&&E.visualVariables?.length){const {getRampStops:b}=await new Promise((M,S)=>m(["../../widgets/Legend/support/colorRampUtils"],M,S)),{getRampStops:g}=await new Promise((M,S)=>m(["../../widgets/Legend/support/sizeRampUtils"],M,S)),{getDateFormatOptions:u}=await new Promise((M,S)=>m(["../../widgets/Legend/support/utils"],M,S));let y=null;for(const M of E.visualVariables){var I=p?u(k,M,p.timeZone):null;let S=null;switch(M.type){case "color":S=
await b(M,null,I);break;case "opacity":S=await b(M);break;case "size":M.target||(S=await g(E,M,null,n?.scale||p?.scale,p,I))}if(S?.length&&(I=S.find((A,J)=>{const T=v.attributes[M.field];return 0===J?T>=A.value:J===S?.length-1?T<=A.value:A.value===T}))){y=I.label;break}}if(y)return y}switch(E.type){case "class-breaks":return p="getClassBreakInfo"in E?await E.getClassBreakInfo(v,n):null,p?.label??(p&&1<E.classBreakInfos?.length)?`${p.minValue} - ${p.maxValue}`:null;case "unique-value":return("getUniqueValueInfo"in
E?await E.getUniqueValueInfo(v,n):null)?.label}return null}};H.renderColorRampPreviewHTML=function(v,p={}){var n="horizontal"===p.align;const k=p.width??(n?75:24),x=p.height??(n?24:75);var E=p.gradient??!0,I=window.devicePixelRatio,b=k*I,g=x*I;I=document.createElement("canvas");I.width=b;I.height=g;I.ariaLabel=p.ariaLabel??null;I.style.width=`${k}px`;I.style.height=`${x}px`;const u=I.getContext("2d");var y=n?b:0;const M=n?0:g;if(E){const S=u.createLinearGradient(0,0,y,M);n=v.length;const A=1===n?
0:1/(n-1);v.forEach((J,T)=>S.addColorStop(T*A,J.toString()));u.fillStyle=S;u.fillRect(0,0,b,g)}else{b=n?b/v.length:b;g=n?g:g/v.length;y=E=0;for(const S of v)u.fillStyle=S.toString(),u.fillRect(E,y,b,g),E=n?E+b:0,y=n?0:y+g}v=document.createElement("div");v.style.width=`${k}px`;v.style.height=`${x}px`;t(v,p?.effectList);v.appendChild(I);return v};H.renderDotDensityPreviewHTML=function(v,p,n){const {backgroundColor:k,outline:x,dotSize:E}=v;var I=n?.swatchSize||C.SymbolSizeDefaults.size;const b=Math.round(I*
I/Math.max(E,.5)**2*.8),g=window.devicePixelRatio;v=document.createElement("canvas");const u=I*g;v.width=u;v.height=u;v.style.width=`${v.width/g}px`;v.style.height=`${v.height/g}px`;const y=v.getContext("2d");k&&(y.fillStyle=k.toCss(!0),y.fillRect(0,0,u,u),y.fill());y.fillStyle=p?.toCss(!0)??"";if(h&&h.length/2===b)for(p=0;p<2*b;p+=2)y.fillRect(h[p],h[p+1],E*g,E*g),y.fill();else for(h=[],p=0;p<2*b;p+=2){const M=Math.floor(Math.random()*(u-0+1)),S=Math.floor(Math.random()*(u-0+1));h.push(M,S);y.fillRect(M,
S,E*g,E*g);y.fill()}x&&(x.color&&(y.strokeStyle=x.color.toCss(!0)),y.lineWidth=x.width,y.strokeRect(0,0,u,u));I=new Image(I,I);I.src=v.toDataURL();I.ariaLabel=n?.ariaLabel??null;I.alt=n?.ariaLabel??"";return I};H.renderPieChartPreviewHTML=function(v,p={}){const n=p.radius||40;var k=2*Math.PI*n,x=v.length;const E=k/x,I=[],b=l.getStroke(p.outline);null!=b?.width&&(b.width*=2);(b||p.backgroundColor)&&I.push({shape:{type:"circle",cx:n,cy:n,r:n},fill:p.backgroundColor,stroke:b,offset:[0,0]});const g=p.values,
u=g&&g.length===x&&100===g.reduce((M,S)=>M+S,0),y=[0];for(let M=0;M<x;M++){let S=null;u&&(S=g[M]*k/100,y.push(S+y[M]));I.push({shape:{type:"circle",cx:n,cy:n,r:n/2},fill:[0,0,0,0],stroke:{width:n,dashArray:`${(S??E)/2} ${k}`,dashoffset:`-${u?y[M]/2:E/2*M}`,color:v[M]},offset:[0,0]})}x=null;v=2*n+(b?.width||0);if(k=p.holePercentage)b&&I.push({shape:{type:"circle",cx:n,cy:n,r:n*k},fill:null,stroke:b,offset:[0,0]}),x=v/2,x=[[{shape:{type:"circle",cx:x,cy:x,r:x},fill:f,stroke:b?{...b,color:f}:null,offset:[0,
0]},{shape:{type:"circle",cx:x,cy:x,r:n*k},fill:[0,0,0],stroke:null,offset:[0,0]}]];return w.renderSymbol([I],[v,v],{effectView:p.effectList,ignoreStrokeWidth:!0,masking:x,rotations:[-90],ariaLabel:p.ariaLabel})};H.renderPreviewHTML=c;H.renderRelationshipRampPreviewHTML=function(v,p={}){const n=v?.authoringInfo;if("relationship"!==n?.type||!n?.numClasses||!v.uniqueValueInfos)return null;const {focus:k,numClasses:x}=n,E=D.getRelationshipRampElement({focus:k,numClasses:x,infos:v.uniqueValueInfos});
v=p?.node||document.createElement("div");w.renderOnce(v,()=>R.renderRelationshipRamp(E,p.id||"relationship",{opacity:p.opacity||1,effectList:p.effectList,ariaLabel:p.ariaLabel}));return v};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(m,H,O,F,l){function C(R,
D,t){const c=`${t}_arrowStart`;t=`${t}_arrowEnd`;R="left"===R;const e={markerStart:null,markerEnd:null};switch(D){case "HL":R?e.markerStart=`url(#${t})`:e.markerEnd=`url(#${c})`;break;case "LL":e.markerStart=`url(#${t})`;break;case "LH":R?e.markerEnd=`url(#${c})`:e.markerStart=`url(#${t})`;break;default:e.markerEnd=`url(#${c})`}return e}function w(R,D,t={}){const {focus:c,numClasses:e,colors:d,rotation:h}=R,{opacity:f,effectList:v,ariaLabel:p}=t;R=t.size??60;t=!!c;const n=Math.sqrt(R**2+R**2)+(t?
0:5),k=[],x=[];var E=[],I=(R||75)/e;for(var b=0;b<e;b++){var g=b*I;for(var u=0;u<e;u++){var y=u*I,M=H.generateFillAttributes(d[b][u]);const S=H.generateStrokeAttributes(null);y={type:"rect",x:y,y:g,width:I,height:I};const A=H.renderDef(M);A&&k.push(A);(M=H.renderShape(y,M.fill,S,null))&&x.push(M);E.push(H.getBoundingBox(y))}}I=null;t||(I="margin: -15px -15px -18px -15px");b=C("left",c,D);g=C("right",c,D);u=H.computeBBox(E);E=H.getTransformMatrix(u,n,n,0,!1,h,!1);u=H.getTransformMatrix(u,n,n,0,!1,
t?-45:null,!1);M={filter:O.getCSSFilterFromEffectList(v)??void 0,opacity:null==f?"":`${f}`};return l.tsx("div",{class:t?G.diamondMidColRamp:G.squareTableCell,styles:M},l.tsx("svg",{"aria-label":p,focusable:!1,height:n,role:"image",style:I,width:n,xmlns:"http://www.w3.org/2000/svg"},l.tsx("defs",null,l.tsx("marker",{id:`${D}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},l.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555",
"stroke-width":"1"})),l.tsx("marker",{id:`${D}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},l.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),k),l.tsx("g",{transform:E},x),l.tsx("g",{transform:u},l.tsx("line",{fill:"none","marker-end":b.markerEnd,"marker-start":b.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:R-15,y2:15}),l.tsx("line",{fill:"none","marker-end":g.markerEnd,"marker-start":g.markerStart,
stroke:"#555555","stroke-width":"1",x1:15,x2:R-15,y1:R+10,y2:R+10}))))}const G={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",
squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};
m.renderRelationshipRamp=function(R,D,t={}){const {focus:c,labels:e}=R,d=!!c;R=w(R,D,t);const h={justifyContent:"center"},f=F.isRTL();D=t.key??D;return d?l.tsx("div",{class:G.diamondContainer,key:`${D}-container`,styles:h},l.tsx("div",{class:G.diamondLeftCol},f?e.right:e.left),l.tsx("div",{class:G.diamondMidCol},l.tsx("div",{class:G.diamondMidColLabel},e.top),R,l.tsx("div",{class:G.diamondMidColLabel},e.bottom)),l.tsx("div",{class:G.diamondRightCol},f?e.left:e.right)):l.tsx("div",{class:G.squareTable,
key:`${D}-container`},l.tsx("div",{class:G.squareTableRow},l.tsx("div",{class:F.classes(G.squareTableCell,G.squareTableLabel,G.squareTableLabelRightBottom)},f?e.top:e.left),l.tsx("div",{class:G.squareTableCell}),l.tsx("div",{class:F.classes(G.squareTableCell,G.squareTableLabel,G.squareTableLabelLeftBottom)},f?e.left:e.top)),l.tsx("div",{class:G.squareTableRow},l.tsx("div",{class:G.squareTableCell}),R,l.tsx("div",{class:G.squareTableCell})),l.tsx("div",{class:G.squareTableRow},l.tsx("div",{class:F.classes(G.squareTableCell,
G.squareTableLabel,G.squareTableLabelRightTop)},f?e.right:e.bottom),l.tsx("div",{class:G.squareTableCell}),l.tsx("div",{class:F.classes(G.squareTableCell,G.squareTableLabel,G.squareTableLabelLeftTop)},f?e.bottom:e.right)))};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(m,H,O,F){function l(D){if(D){var {type:t}=
D;return t.includes("3d")?F.getSymbolLayerFill(D.symbolLayers.at(0)):"simple-line"===t||"simple-marker"===D.type&&("x"===D.style||"cross"===D.style)?(D=O.getStroke(D))&&D.color:O.getFill(D)}}function C(D,t){const c=t.HH.label,e=t.LL.label,d=t.HL.label;t=t.LH.label;switch(D){case "HH":return{top:c,bottom:e,left:d,right:t};case "HL":return{top:d,bottom:t,left:e,right:c};case "LL":return{top:e,bottom:c,left:t,right:d};case "LH":return{top:t,bottom:d,left:c,right:e};default:return{top:c,bottom:e,left:d,
right:t}}}function w(D){let t=G[D];D&&null==t&&(t=G.HH);return t||0}const G={HH:315,HL:45,LL:135,LH:225},R={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};m.getRelationshipRampColors2D=function(D,t){const c=[],e=D.length**.5;D=H.clone(D);var d=(t||"HH").split("");t=d[0];for(d="H"===d[1];D.length;){const h=[];for(;h.length<e;)h.push(D.shift());d&&h.reverse();
c.push(h)}"L"===t&&c.reverse();return c};m.getRelationshipRampElement=function(D){const {focus:t,infos:c,numClasses:e}=D;var d=R[e];const h={};c.forEach(f=>{h[f.value]={label:f.label,fill:l(f.symbol)}});D=[];for(let f=0;f<e;f++){const v=[];for(let p=0;p<e;p++)v.push(h[d[f][p]].fill);D.push(v)}d=C(t,h);return{type:"relationship-ramp",numClasses:e,focus:t,colors:D,labels:d,rotation:w(t)}};m.getRotationAngleForFocus=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c,e,d){function h(z){const K=z.outline;var U=null!=z.material?z.material.color:null;U=null!=U?U.toHex():null;if(null==K||"pattern"in K&&null!=K.pattern&&"style"===K.pattern.type&&"none"===K.pattern.style)return"fill"===z.type&&"#ffffff"===U?{color:"#bdc3c7",width:.75}:null;z=w.pt2px(K.size)||0;return{color:"rgba("+(null!=K.color?K.color.toRgba():"255,255,255,1")+")",width:Math.min(z,r),style:"pattern"in K&&null!=K.pattern&&"style"===K.pattern.type?G.dekebabifyLineStyle(K.pattern.style):
null,join:"butt",cap:"patternCap"in K?K.patternCap:"butt"}}async function f(z,K){if(z.thumbnail?.url)return z.thumbnail.url;if("icon"===K.type&&K?.resource?.href)return e.getIconHref(K);K=H.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return z.styleOrigin&&(z.styleOrigin.styleName||z.styleOrigin.styleUrl)&&(z=await d.resolveWebStyleSymbol(z.styleOrigin,{portal:z.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in z&&z.thumbnail?.url?z.thumbnail.url:K}function v(z,K=1){const U=
z.a;z=O.toHSV(z);const {r:W,g:ba,b:Y}=O.toRGB({h:z.h,s:z.s/K,v:100-(100-z.v)/K});return[W,ba,Y,U]}function p(z){return"water"===z.type?null==z.color?null:z.color:null==z.material?.color?null:z.material.color}function n(z,K=0){var U=p(z);if(!U){if("fill"===z.type)return null;K=t.adjustColorComponentBrightness(G.defaultThematicColor.r,K);return[K,K,K,100]}z=U.toRgba();for(U=0;3>U;U++)z[U]=t.adjustColorComponentBrightness(z[U],K);return z}async function k(z,K){z=z.style;return"none"===z?null:{type:"pattern",
x:0,y:0,src:await G.getPatternUrlWithColor(H.getAssetUrl(`esri/symbols/patterns/${z}.png`),K.toCss(!0)),width:5,height:5}}function x(z){return z.outline?h(z):{color:"rgba(0, 0, 0, 1)",width:1.5}}function E(z,K){z=p(z);if(!z)return null;let U;U="rgba("+(t.adjustColorComponentBrightness(z.r,K)+",");U+=t.adjustColorComponentBrightness(z.g,K)+",";U+=t.adjustColorComponentBrightness(z.b,K)+",";return U+z.a+");"}function I(z,K){K=E(z,K);if(!K)return{};if("pattern"in z&&null!=z.pattern&&"style"===z.pattern.type&&
"none"===z.pattern.style)return null;const U=Math.min(z.size?w.pt2px(z.size):.75,r);return{color:K,width:U,style:"pattern"in z&&null!=z.pattern&&"style"===z.pattern.type?G.dekebabifyLineStyle(z.pattern.style):null,cap:"cap"in z?z.cap:null,join:"join"in z?"miter"===z.join?w.pt2px(2):z.join:null}}function b(z,K,U){U=null!=U?.75*U:0;return{type:"linear",x1:U?.25*U:0,y1:U?.5*U:0,x2:U||4,y2:U?.5*U:4,colors:[{color:z,offset:0},{color:K,offset:1}]}}function g(z){const K=z.depth,U=z.height;z=z.width;return 0!==
z&&0!==K&&0!==U&&z===K&&null!=z&&null!=U&&z<U}function u(z,K,U){const W=[];if(!z)return W;switch(z.type){case "icon":switch(z.resource?.primitive??R.defaultPrimitive){case "circle":W.push({shape:{type:"circle",cx:0,cy:0,r:.5*K},fill:n(z,0),stroke:h(z)});break;case "square":W.push({shape:{type:"path",path:[{command:"M",values:[0,K]},{command:"L",values:[0,0]},{command:"L",values:[K,0]},{command:"L",values:[K,K]},{command:"Z",values:[]}]},fill:n(z,0),stroke:h(z)});break;case "triangle":W.push({shape:{type:"path",
path:[{command:"M",values:[0,K]},{command:"L",values:[.5*K,0]},{command:"L",values:[K,K]},{command:"Z",values:[]}]},fill:n(z,0),stroke:h(z)});break;case "cross":W.push({shape:{type:"path",path:[{command:"M",values:[.5*K,0]},{command:"L",values:[.5*K,K]},{command:"M",values:[0,.5*K]},{command:"L",values:[K,.5*K]}]},stroke:x(z)});break;case "x":W.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[K,K]},{command:"M",values:[K,0]},{command:"L",values:[0,K]}]},stroke:x(z)});
break;case "kite":W.push({shape:{type:"path",path:[{command:"M",values:[0,.5*K]},{command:"L",values:[.5*K,0]},{command:"L",values:[K,.5*K]},{command:"L",values:[.5*K,K]},{command:"Z",values:[]}]},fill:n(z,0),stroke:h(z)})}break;case "object":switch(z.resource?.primitive??D.defaultPrimitive){case "cone":var ba=n(z,0);z=n(z,-.6);z=b(ba,z,U?Q:K);K=t.getConeShapes(K,U);W.push({shape:K[0],fill:z},{shape:K[1],fill:z});break;case "inverted-cone":U=n(z,0);z=n(z,-.6);z=b(U,z,K);K=t.getInvertedConeShapes(K);
W.push({shape:K[0],fill:z},{shape:K[1],fill:U});break;case "cube":K=t.getCubeShapes(K,U);W.push({shape:K[0],fill:n(z,0)},{shape:K[1],fill:n(z,-.3)},{shape:K[2],fill:n(z,-.5)});break;case "cylinder":ba=n(z,0);const Y=n(z,-.6);ba=b(ba,Y,U?Q:K);K=t.getCylinderShapes(K,U);W.push({shape:K[0],fill:ba},{shape:K[1],fill:ba},{shape:K[2],fill:n(z,0)});break;case "diamond":K=t.getDiamondShapes(K);W.push({shape:K[0],fill:n(z,-.3)},{shape:K[1],fill:n(z,0)},{shape:K[2],fill:n(z,-.3)},{shape:K[3],fill:n(z,-.7)});
break;case "sphere":U=n(z,0);z=n(z,-.6);z=b(U,z);z.x1=0;z.y1=0;z.x2=.25*K;z.y2=.25*K;W.push({shape:{type:"circle",cx:0,cy:0,r:.5*K},fill:z});break;case "tetrahedron":K=t.getTetrahedronShapes(K),W.push({shape:K[0],fill:n(z,-.3)},{shape:K[1],fill:n(z,0)},{shape:K[2],fill:n(z,-.6)})}}return W}function y(z){return(z="number"===typeof z?.size?z?.size:null)?w.pt2px(z):null}async function M(z,K){const U=y(K),W=K?.maxSize?w.pt2px(K.maxSize):null,ba=K?.disableUpsampling??!1,Y=[],ia=[];let ja=!1,fa=0,X=0,da=
0;z.symbolLayers.forEach(aa=>{if("icon"===aa.type||"object"===aa.type){aa&&"icon"===aa.type&&(da=Math.max(aa.size&&w.pt2px(aa.size),da));var ma="icon"===aa.type?aa.size&&w.pt2px(aa.size):0,ka=U||ma?Math.ceil(Math.min(U||ma,W||T)):J,ra="icon"===aa.type?aa.angle:null;null!=K?.rotation&&(ra=(ra??0)+K.rotation);ia.push(ra);if(aa?.resource?.href){var va=f(z,aa).then(wa=>{const za=aa?.material?.color;var Aa="icon"===aa.type?"multiply":"tint";return c.tintImageWithColor(wa,ka,za,Aa,ba)}).then(wa=>{const za=
wa.width,Aa=wa.height;fa=Math.max(fa,za);X=Math.max(X,Aa);ra&&(ja=!0);return[{shape:{type:"image",x:0,y:0,width:za,height:Aa,src:wa.url},fill:null,stroke:null}]});Y.push(va)}else va=ka,"icon"===aa.type&&U&&(va=ma/da*ka),ma="tall"===K?.symbolConfig||K?.symbolConfig?.isTall||("object"===aa.type?g(aa):!1),fa=Math.max(fa,ma?Q:va),X=Math.max(X,va),ra&&aa.resource?.primitive&&["square","triangle","x"].includes(aa.resource?.primitive)&&(ja=!0),Y.push(Promise.resolve(u(aa,va,ma)))}});const oa=[];(await Promise.allSettled(Y)).forEach(aa=>
{"fulfilled"===aa.status?oa.push(aa.value):aa.reason&&C.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",aa.reason)});return c.renderSymbol(oa,[fa,X],{node:K?.node,scale:!1,opacity:K?.opacity,ariaLabel:K?.ariaLabel,rotations:ia,useRotationSize:ja})}function S(z,K){const U=z.symbolLayers,W=[];z=e.isVolumetricSymbol(z);const ba=y(K),Y=(K?.maxSize?w.pt2px(K.maxSize):null)||r;let ia=0,ja=0,fa;U.forEach((X,da)=>{if(X&&("line"===X.type||"path"===X.type)){var oa=
[];switch(X.type){case "line":var aa=I(X,0);if(null==aa)break;var ma=aa?.width||0;0===da&&(fa=ma);X=Math.min(ba||ma,Y);da=0===da?X:ba?ma/fa*X:X;ma=da>L/2?2*da:L;ja=Math.max(ja,da);ia=Math.max(ia,ma);aa.width=da;oa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ja]},{command:"L",values:[ia,.5*ja]}]},stroke:aa});break;case "path":aa=Math.min(ba||J,Y);da=n(X,0);ma=n(X,-.2);var ka=E(X,-.4);ka=ka?{color:ka,width:1}:{};if("quad"===X.profile){const ra=X.width;X=X.height;X=t.getPathSymbolShapes(ra&&
X?ra/X:1,0===X,0===ra);ka={...ka,join:"bevel"};oa.push({shape:X[0],fill:ma,stroke:ka},{shape:X[1],fill:ma,stroke:ka},{shape:X[2],fill:da,stroke:ka})}else oa.push({shape:t.shapes.pathSymbol3DLayer[0],fill:ma,stroke:ka},{shape:t.shapes.pathSymbol3DLayer[1],fill:da,stroke:ka});ia=ja=Math.max(ja,aa)}W.push(oa)}});return Promise.resolve(c.renderSymbol(W,[ia,ja],{node:K?.node,scale:z,opacity:K?.opacity,ariaLabel:K?.ariaLabel}))}async function A(z,K){const U="mesh-3d"===z.type;z=z.symbolLayers;var W=y(K);
const ba=K?.maxSize?w.pt2px(K.maxSize):null;W=W||J;const Y=[];let ia=0,ja=0;var fa=!1;for(let ma=0;ma<z.length;ma++){var X=z.at(ma);const ka=[];if(!U||"fill"===X.type){switch(X.type){case "fill":fa=Math.min(W,ba||T);ia=Math.max(ia,fa);ja=Math.max(ja,fa);fa=!0;if(U){var da=t.shapes.meshSymbol3DFill,oa=E(X,-.4);oa=oa?{color:oa,width:1,join:"round"}:{};ka.push({shape:da[0],fill:n(X,0),stroke:oa},{shape:da[1],fill:n(X,-.2),stroke:oa},{shape:da[2],fill:n(X,-.6),stroke:oa})}else{da=n(X,0);oa="pattern"in
X?X.pattern:null;var aa=h(X);X=p(X);null!=oa&&"style"===oa.type&&"solid"!==oa.style&&X&&(da=await k(oa,X));ka.push({shape:t.shapes.fill[0],fill:da,stroke:aa})}break;case "line":X=I(X,0);if(null==X)break;X={stroke:X,shape:t.shapes.fill[0]};ia=Math.max(ia,J);ja=Math.max(ja,J);ka.push(X);break;case "extrude":da={join:"round",width:1,...I(X,-.4)};oa=n(X,0);X=n(X,-.2);aa=Math.min(W,ba||T);const ra=t.getExtrudeSymbolShapes(aa);da.width=1;ka.push({shape:ra[0],fill:X,stroke:da},{shape:ra[1],fill:X,stroke:da},
{shape:ra[2],fill:oa,stroke:da});X=.7*J+.5*aa;ia=Math.max(ia,J);ja=Math.max(ja,X);break;case "water":fa=p(X),X=v(fa),da=v(fa,2),oa=v(fa,3),aa=t.getWaterSymbolShapes(),fa=!0,ka.push({shape:aa[0],fill:X},{shape:aa[1],fill:da},{shape:aa[2],fill:oa}),X=Math.min(W,ba||T),ia=Math.max(ia,X),ja=Math.max(ja,X)}Y.push(ka)}}return c.renderSymbol(Y,[ia,ja],{node:K?.node,scale:fa,opacity:K?.opacity,ariaLabel:K?.ariaLabel})}const J=t.SymbolSizeDefaults.size,T=t.SymbolSizeDefaults.maxSize,r=t.SymbolSizeDefaults.maxOutlineSize,
L=t.SymbolSizeDefaults.lineWidth,Q=t.SymbolSizeDefaults.tallSymbolWidth;m.getPatternDescriptor=k;m.getSizeFromOptions=y;m.getSymbolLayerFill=n;m.previewSymbol3D=function(z,K){if(0===z.symbolLayers.length)return Promise.reject(new l("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(z.type){case "point-3d":return M(z,K);case "line-3d":return S(z,K);case "polygon-3d":case "mesh-3d":return A(z,K)}return Promise.reject(new l("symbolPreview: swatchInfo3D","symbol not supported."))};
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(m,H,O,F,l,C,w,G,R,D,t){function c(h,f){return f.items.find(v=>v.name===h)}function e(h,f,v,p,n,k){const x=null!=v?.portal?v.portal:C.getDefault(),E={portal:x,url:l.urlToObject(h.baseUrl),
origin:"portal-item"},I=c(f,h.data);if(!I)return Promise.reject(new F("symbolstyleutils:symbol-name-not-found",`The symbol name '${f}' could not be found`,{symbolName:f}));n=w.fromJSON(n(I,p),E);let b=I.thumbnail?.href??null;const g=I.thumbnail?.imageData;O.isDevEnvironment()&&(n=O.adjustStaticAGOUrl(n)??"",b=O.adjustStaticAGOUrl(b));const u={portal:x,url:l.urlToObject(l.removeFile(n)),origin:"portal-item"};return D.requestJSON(n,k).then(y=>{y="cimRef"===p?D.makeCIMSymbolRef(y.data):y.data;if((y=
G.fromJSON(y,u))&&H.isSymbol3D(y)){if(b){const M=w.fromJSON(b,E);y.thumbnail=new t.Thumbnail({url:M})}else g&&(y.thumbnail=new t.Thumbnail({url:`data:image/png;base64,${g}`}));h.styleUrl?y.styleOrigin=new R({portal:v.portal,styleUrl:h.styleUrl,name:f}):h.styleName&&(y.styleOrigin=new R({portal:v.portal,styleName:h.styleName,name:f}))}return y})}function d(h,f,v){const p=D.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,h),n=null!=f.portal?f.portal:C.getDefault();return D.requestJSON(p,v).then(k=>
{k=D.makeCIMSymbolRef(k.data);return G.fromJSON(k,{portal:n,url:l.urlToObject(l.removeFile(p)),origin:"portal-item"})})}m.fetchSymbolFromStyle=e;m.getStyleItemFromStyle=c;m.resolveWebStyleSymbol=function(h,f,v,p){const n=h.name;return null==n?Promise.reject(new F("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):"Esri2DPointSymbolsStyle"===h.styleName?d(n,f,p):D.fetchStyle(h,f,p).then(k=>e(k,n,f,v,D.symbolUrlFromStyleItem,p))};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(m){const H=/^devext\.arcgis\.com$/,O=/^qaext\.arcgis\.com$/,F=/^[\w-]*\.mapsdevext\.arcgis\.com$/,l=/^[\w-]*\.mapsqa\.arcgis\.com$/,C=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,H,O,/^jsapps\.esri\.com$/,F,l];m.adjustStaticAGOUrl=function(w,G){return w?(G=G||globalThis.location.hostname)?null!=G.match(H)||null!=G.match(F)?w.replace("static.arcgis.com","staticdev.arcgis.com"):null!=G.match(O)||
null!=G.match(l)?w.replace("static.arcgis.com","staticqa.arcgis.com"):w:w:null};m.devHostnames=C;m.isDevEnvironment=function(w){w=w||globalThis.location.hostname;return C.some(G=>null!=w?.match(G))};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],function(m,H){m.getEffectiveClusterSizeVariable=function(O,F,l){var C=O.effectiveClusterRenderer;if(!(C&&"visualVariables"in
C&&C.visualVariables))return null;C=C.visualVariables.find(R=>"size"===R.type);if(!("stops"in C&&C.stops))return null;const w=C.stops.find(R=>R.useMinValue),G=C.stops.find(R=>R.useMaxValue);if(null==w||null==G)return null;l=l.featuresTilingScheme.getClosestInfoForScale(l.scale).level;return(F=F.getDisplayStatistics(l,C.field))?new H({field:C.field,minSize:O.clusterMinSize,minDataValue:F.minValue,maxSize:O.clusterMaxSize,maxDataValue:F.maxValue}):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(m,H,O,F){function l(D,t){const c=[],e=D.length-1;5===D.length?c.push(0,2,4):c.push(0,e);return D.map((d,h)=>c.includes(h)?F.createStopLabel(d,h,e,t):null)}async function C(D,t,c){c=new O(c??R);D=(await new Promise((e,d)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],e,d))).getOpacity(t,D);null!=D&&(c.a=D);return c}function w(D,t){const {startIndex:c,endIndex:e,
weight:d}=G(D,t);if(c===e)return t[c].color;D=O.blendColors(t[c].color,t[e].color,d);return new O(D)}function G(D,t){let c=0,e=t.length-1;t.some((d,h)=>{if(D<d.value)return e=h,!0;c=h;return!1});return{startIndex:c,endIndex:e,weight:(D-t[c].value)/(t[e].value-t[c].value)}}const R=new O([64,64,64]);H.getColorFromPointCloudStops=w;H.getRampStops=async function(D,t,c){let e=!1,d=[],h=[];if(D.stops){var f=D.stops;d=f.map(p=>p.value);(e=f.some(p=>!!p.label))&&(h=f.map(p=>p.label))}f=d[d.length-1];if(null==
d[0]&&null==f)return null;const v=e?null:l(d,c);return(await Promise.all(d.map(async(p,n)=>{const k="opacity"===D.type?await C(p,D,t):(await new Promise((x,E)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],x,E))).getColor(D,p);return{value:p,color:k,label:e?h[n]:v?.[n]??""}}))).reverse()};H.getRampStopsForPointCloud=function(D){let t=!1,c=[],e=[];c=D.map(f=>f.value);(t=D.some(f=>!!f.label))&&(e=D.map(f=>f.label??""));const d=c[c.length-1];if(null==c[0]&&null==d)return null;
const h=t?null:l(c);return c.map((f,v)=>{const p=w(f,D);return{value:f,color:p,label:t?e[v]:h?.[v]??""}}).reverse()};H.getStretchRampStops=function(D,t){let c=[];if(D&&"multipart"===D.type)D.colorRamps.reverse().forEach((e,d)=>{0===d?c.push({value:t.max,color:new O(e.toColor),label:"high"}):c.push({value:null,color:new O(e.toColor),label:""});d===D.colorRamps.length-1?c.push({value:t.min,color:new O(e.fromColor),label:"low"}):c.push({value:null,color:new O(e.fromColor),label:""})});else{let e,d;D&&
"algorithmic"===D.type?(e=D.fromColor,d=D.toColor):(e=[0,0,0,1],d=[255,255,255,1]);c=[{value:t.max,color:new O(d),label:"high"},{value:t.min,color:new O(e),label:"low"}]}return c};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(m,H,O,F,l,C,w,G){async function R(c){if(!("visualVariables"in c&&c.visualVariables))return null;c=c.visualVariables.find(h=>"color"===h.type);if(!c)return null;var e=null,d=null;if(c.stops){if(1===c.stops.length)return c.stops[0].color;e=c.stops[0].value;d=c.stops[c.stops.length-1].value}e=null!=e&&null!=d?e+(d-e)/2:0;({getColor:d}=await new Promise((h,f)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],h,f)));return d(c,e)??null}function D(c,e){if(!e.field)return null;
if("featureReduction"in c)switch(c.featureReduction?.type){case "cluster":case "binning":const d=c.featureReduction.fields.find(({name:h})=>h.toLowerCase()===e.field.toLowerCase());return d&&"getField"in c?c.getField(d.onStatisticField):null}return"getField"in c?c.getField?.(e.field):null}function t(c,e){c="popupTemplate"in c?c.popupTemplate?.fieldInfos:null;if(c?.length&&e)return c.find(d=>d.fieldName?.toLowerCase()===e.toLowerCase())?.format?.dateFormat}H.createStopLabel=function(c,e,d,h){let f=
"";0===e?f="\x3c ":e===d&&(f="\x3e ");c=h?w.formatAnyDate(c,h):C.format(c);return f+c};H.getDateFormatOptions=function(c,e,d){const h=D(c,e);if(!h||!w.isAnyDateField(h)&&!l.isTimeOnlyField(h))return null;var f=t(c,h.name);if(!f&&"date"===h.type){let v=f=0;e.stops?(f=e.stops?.at(0)?.value??f,v=e.stops?.at(-1)?.value??v):"minDataValue"in e&&"maxDataValue"in e&&(f=e.minDataValue??f,v=e.maxDataValue??v);f=v-f>2*F.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:h.type,
format:f,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in c?c.preferredTimeZone:null,viewTimeZone:d,datesInUnknownTimezone:"datesInUnknownTimezone"in c&&c.datesInUnknownTimezone}}};H.getMedianColor=R;H.getReferenceSizeAuthoringInfoVisualVariable=function(c){if("authoringInfo"in c)return c.authoringInfo?.visualVariables?.find(({theme:e})=>"reference-size"===e)};H.getSymbolForFlowRenderer=async function(c,e){const d=c.trailCap,h=c.trailWidth||1;c=e||await R(c)||c.color;return new G({cap:d,color:c,
width:h})};H.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
H.specialCharsGreaterThan="\x3e";H.specialCharsLessThan="\x3c";Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(m,H,O){function F(t,c){return t-c}function l(t,c){let e;e=Number(t.toFixed(c));e<t?t=e+1/10**c:(t=e,e-=1/10**c);e=Number(e.toFixed(c));t=Number(t.toFixed(c));return[e,t]}function C(t,c,e,d,h){t=G(t,c,e,d);c=null==t.next||t.next<=h;return(null==t.previous||t.previous<=
h)&&c||t.previous+t.next<=2*h}function w(t){t=String(t);var c=t.match(R);if(c?.[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(t.toLowerCase().includes("e")&&(c=t.split("e"),t=c[0],c=c[1],t&&c)){t=Number(t);c=Number(c);const e=0<c;e||(c=Math.abs(c));t=w(t);e?(t.integer+=c,t.fractional=c>t.fractional?0:t.fractional-c):(t.fractional+=c,t.integer=c>t.integer?1:t.integer-c);return t}return{integer:0,fractional:0}}function G(t,c,e,d){const h={previous:null,next:null};
if(null!=e){const f=t-e;h.previous=Math.floor(Math.abs(100*(c-e-f)/f))}null!=d&&(t=d-t,h.next=Math.floor(Math.abs(100*(d-c-t)/t)));return h}const R=/^-?(\d+)(\.(\d+))?$/i,D={maximumFractionDigits:20};m.format=function(t){return O.formatNumber(t,D)};m.numDigits=w;m.percentChange=G;m.round=function(t,c={}){t=t.slice();const {tolerance:e=2,strictBounds:d=!1,indexes:h=t.map((v,p)=>p)}=c;h.sort(F);for(c=0;c<h.length;c++){const v=h[c],p=t[v],n=0===v?null:t[v-1],k=v===t.length-1?null:t[v+1],x=w(p).fractional;
if(x){let E=0,I=!1;for(var f=void 0;E<=x&&!I;)f=l(p,E),f=d&&0===c?f[1]:f[0],I=C(p,f,n,k,e),E++;I&&(t[v]=f)}}return t};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(m,H,O,F,l,C){function w(d){return String(d).padStart(2,"0")}function G(d,h,f){if("date"===h||"number"===h){"number"===
h&&(d=new Date(d));h=f?d.getFullYear():d.getUTCFullYear();const v=w((f?d.getMonth():d.getUTCMonth())+1),p=w(f?d.getDate():d.getUTCDate()),n=w(f?d.getHours():d.getUTCHours()),k=w(f?d.getMinutes():d.getUTCMinutes());d=w(f?d.getSeconds():d.getUTCSeconds());d=`TIMESTAMP'${h}-${v}-${p} ${n}:${k}:${d}'`}return d}function R(d,h){if(h instanceof Date)return"date";if("number"===typeof h)return"number";if("string"===typeof h&&(d=d.getField(h),"\x3cnow\x3e"!==h.toLowerCase()&&O.isDateField(d)))return"field"}
const D={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},t={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},c=new Set(["integer","small-integer"]);let e=null;m.castIntegerFieldToFloat=function(d){return`cast(${d} as float)`};m.dateTypes=
["date","date-only","timestamp-offset"];m.defaultBasemapGroups=D;m.defaultStatisticTypes={exclude:["median"]};m.fieldDelimiter=",";m.formatAnyDate=function(d,h){const {format:f,timeZoneOptions:v,fieldType:p}=h??{};let n;v&&({timeZone:k,timeZoneName:n}=C.getTimeZoneFormattingOptions(v.layerTimeZone,v.datesInUnknownTimezone,v.viewTimeZone,H.convertDateFormatToIntlOptions(f||"short-date-short-time"),p));if("string"===typeof d&&isNaN(Date.parse("time-only"===p?`1970-01-01T${d}Z`:d)))return d;switch(p){case "date-only":var k=
H.convertDateFormatToIntlOptions(f||"short-date");return"string"===typeof d?H.formatDateOnly(d,{...k}):H.formatDate(d,{...k,timeZone:C.utc});case "time-only":return k=H.convertDateFormatToIntlOptions(f||"short-time"),"string"===typeof d?H.formatTimeOnly(d,k):H.formatDate(d,{...k,timeZone:C.utc});case "timestamp-offset":if(!k&&"string"===typeof d&&(new Date(d)).toISOString()!==d)return d;k=(h=f||v?H.convertDateFormatToIntlOptions(f||"short-date-short-time"):void 0)?{...h,timeZone:k,timeZoneName:n}:
void 0;return"string"===typeof d?H.formatTimestamp(d,k):H.formatDate(d,k);default:return h=f||v?H.convertDateFormatToIntlOptions(f||"short-date-short-time"):void 0,H.formatDate("string"===typeof d?new Date(d):d,h?{...h,timeZone:k,timeZoneName:n}:void 0)}};m.getBasemapGroup=function(d,h=D){for(const f in h)if(h[f].includes(d))return f};m.getBasemapId=function(d,h,f=!0){let v=null;d&&("string"===typeof d?h.includes(d)&&(v=d):v=l.getWellKnownBasemapId(d));return f?v||"gray":v};m.getDateDiffSQL=function(d,
h,f,v){const {hasQueryEngine:p}=d;f=G(f,R(d,f),p);d=G(h,R(d,h),p);d=`(${f} - ${d})`;v=t[v];h="/";1>v&&(v=1/v,h="*");return{sqlExpression:1===v?d:`(${d} ${h} ${v})`,sqlWhere:null}};m.getDateType=R;m.getFieldsList=async function(d){const {field:h,field2:f,field3:v,normalizationField:p,valueExpression:n}=d;d=[];n&&(e||({arcadeUtils:d}=await F.loadArcade(),e=d),d=e.extractFieldNames(n));h&&d.push(h);f&&d.push(f);v&&d.push(v);p&&d.push(p);return d};m.getNormalizationType=function(d){let h=d.normalizationType;
h||(d.normalizationField?h="field":null!=d.normalizationTotal&&(h="percent-of-total"));return h??void 0};m.isAnyDateField=function(d){return O.isDateField(d)||O.isDateOnlyField(d)||O.isTimestampOffsetField(d)};m.isIntegerField=function(d,h){d=h&&d.getField(h);return!!d&&c.has(d.type)};m.unitValueInDays=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(m,
H){m.getHeatmapRampStops=function(O){if(!O.colorStops)return[];const F=[...O.colorStops].filter(C=>0<C.color?.a);let l=F.length-1;if(F&&F[0]){const C=F[l];C&&1!==C.ratio&&(F.push(new H({ratio:1,color:C.color})),l++)}return F.map((C,w)=>{let G="";0===w?G=O.legendOptions?.minLabel||"low":w===l&&(G=O.legendOptions?.maxLabel||"high");return{color:C.color,label:G,ratio:C.ratio}}).reverse()};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/renderers/support/referenceSizeUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c,e){function d(A,J){const T=A.length-1;return A.map((r,L)=>R.createStopLabel(r,L,T,J))}function h(A,J){A=A?.authoringInfo;const T="univariate-color-size"===A?.type;let r=[12,30];if(T){const L=J[0],Q=J[J.length-1];r=J.map(z=>12+(z-L)/(Q-L)*18)}T&&"below"===A?.univariateTheme&&r.reverse();return r}function f(A,J,T,r){const L="class-breaks"===A.type;A=L?A.classBreakInfos?.[0]?.symbol?.clone():A.uniqueValueInfos?.[0]?.symbol?.clone();if(!(A&&"type"in A&&"cim"===A.type))return null;
C.updateReferenceSizeSymbol(A,{color:r??(L?null:new O(M)),innerDotSize:24/T*J||1,outerRingSize:24});return A}function v(A,J){const T=A.classBreakInfos,r=T.length;J=2>r||!(2<=J)?T[0].symbol.clone():T[r-1].symbol.clone();A.visualVariables?.some(L=>"color"===L.type)&&(J.type.includes("3d")?k(J):x(J));return J}async function p(A,J){if("flow"===A.type)return R.getSymbolForFlowRenderer(A,J);if("pie-chart"===A.type)return new c({color:null,outline:A.outline?.width?A.outline:new e});let T=null,r=null;"simple"===
A.type?T=A.symbol:"class-breaks"===A.type?(T=(A=A.classBreakInfos)&&A[0]&&A[0].symbol,r=1<A.length):"unique-value"===A.type&&(A=A.uniqueValueInfos,T=A?.[0]?.symbol,r=null!=A&&1<A.length);if(!T||n(T))return null;T=T.clone();if(J||r)T.type.includes("3d")?k(T):x(T);return T}function n(A){return A?F.isSymbol3D(A)?A.symbolLayers?A.symbolLayers.some(J=>J&&"fill"===J.type):!1:A.type.includes("fill"):!1}function k(A){"line-3d"===A.type?A.symbolLayers.forEach(J=>{J.material={color:S}}):A.symbolLayers.forEach(J=>
{"icon"!==J.type||J.resource?.href?J.material={color:M}:(J.material={color:y},J.outline={color:S,size:1.5})})}function x(A){const J=t.isDarkTheme();if("cim"===A.type)w.applyCIMSymbolColor(A,new O(M));else if(A.type.includes("line"))A.color=S;else if(A.color=J?S:y,"simple-marker"===A.type)A.outline?"#ffffff"===A.outline?.color?.toHex()&&(A.outline.color=S):A.outline={color:S,width:1.5}}async function E(A,J,T,r){const L=(await new Promise((K,U)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],
K,U))).getSizeRangeAtScale(A,T,r),Q=L&&I(L);if(L&&Q){var z=Q.map(K=>{const U=L.minSize,W=L.maxSize,ba=A.minDataValue,Y=A.maxDataValue;return K<=U?ba:K>=W?Y:(K-U)/(W-U)*(Y-ba)+ba});z=l.round(z);for(let K=1;K<z.length-1;K++){const U=await b(A,J,z[K],z[K-1],T,r);U&&(z[K]=U[0],Q[K]=U[1])}return z}}function I(A){const J=A.minSize;A=(A.maxSize-J)/4;const T=[];for(let r=0;5>r;r++)T.push(J+A*r);return T}async function b(A,J,T,r,L,Q){const z=await g(A,J,T,L,Q);r=await g(A,J,r,L,Q);var K=l.numDigits(T),U=K.fractional,
W=K.integer;let ba=K=null;0<T&&1>T&&(K=10**U,T*=K,W=l.numDigits(T).integer);for(U=W-1;0<=U;U--){var Y=10**U;W=Math.floor(T/Y)*Y;Y*=Math.ceil(T/Y);null!=K&&(W/=K,Y/=K);let ia=(W+Y)/2;[,ia]=l.round([W,ia,Y],{indexes:[1]});const ja=await g(A,J,W,L,Q),fa=await g(A,J,Y,L,Q),X=await g(A,J,ia,L,Q),da=l.percentChange(z,ja,r,null),oa=l.percentChange(z,fa,r,null),aa=l.percentChange(z,X,r,null);let ma=20>=da.previous,ka=20>=oa.previous;ma&&ka&&(da.previous<=oa.previous?(ma=!0,ka=!1):(ka=!0,ma=!1));ma?ba=[W,
ja]:ka?ba=[Y,fa]:20>=aa.previous&&(ba=[ia,X]);if(ba)break}return ba}async function g(A,J,T,r,L){const {getSize:Q}=await new Promise((z,K)=>m(["../../../renderers/visualVariables/support/visualVariableUtils"],z,K));return Q(A,T,{scale:r,view:L,shape:"simple-marker"===J.type?J.style:null})}function u(A,J){A=A.clone();if(F.isSymbol3D(A))G.isVolumetricSymbol(A)||A.symbolLayers.forEach(T=>{"fill"!==T.type&&(T.size=J)});else if("esri.symbols.SimpleMarkerSymbol"===A.declaredClass)A.size=J;else if("esri.symbols.PictureMarkerSymbol"===
A.declaredClass){const T=A.width,r=A.height;A.height=J;A.width=T/r*J}else"esri.symbols.SimpleLineSymbol"===A.declaredClass?A.width=J:"esri.symbols.TextSymbol"===A.declaredClass&&A.font&&(A.font.size=J);return A}const y=[255,255,255],M=[200,200,200],S=[128,128,128];H.getRampStops=async function(A,J,T,r,L,Q,z){var K=J.legendOptions?.customValues;const U=z||await p(A,T);z=J.stops;var W=null!=J.minSize&&null!=J.maxSize;const ba=z&&1<z.length;var Y=!!J.target;if(U&&(K||W||ba&&!Y)){var ia=G.isVolumetricSymbol(U),
ja=!1,fa=W=null;W=ia&&!ba?l.round([J.minDataValue,J.maxDataValue]):K??await E(J,U,r,L?.type);K=A?.authoringInfo;var X=(Y="univariate-color-size"===K?.type)&&"above-and-below"===K?.univariateTheme,da=!!R.getReferenceSizeAuthoringInfoVisualVariable(A);!W&&ba&&(W=z.map(ka=>ka.value),ja=z.some(ka=>!!ka.label),"flow"===A.type&&(W=l.round(W)),ja&&(fa=z.map(ka=>ka.label)));ia&&null!=W&&2<W?.length&&!X&&(W=[W[0],W[W.length-1]]);if(!W)return null;Y&&5!==W?.length&&(W=I({minSize:W[0],maxSize:W[W.length-1]}));
var oa=ia?h(A,W):null,aa=G.getSymbolOutlineSize(U),ma=ja?null:d(W,Q);return(await Promise.all(W.map(async(ka,ra)=>{const va=ia?oa[ra]:await g(J,U,ka,r,L?.type),wa=!da||"class-breaks"!==A.type&&"unique-value"!==A.type?u(X&&"class-breaks"===A.type?v(A,ra):U,va):f(A,va,J.maxSize,T)??U;return{value:ka,symbol:wa,label:ja?fa[ra]:ma[ra],size:da?24:va,outlineSize:aa}}))).reverse()}};H.getReferenceSizeSymbol=f;H.realWorldMaxSize=30;H.realWorldMinSize=12;Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(m,H,O,F,l,C){m.formatDateLabel=function(w){return O.formatDate(new Date(w),l.timelineDateFormatOptions)};m.formatNumberLabel=function(w){const G=Math.floor(Math.log10(Math.abs(w)))+1;return F.formatNumber(w,{notation:1E6<=Math.abs(w)?"compact":"standard",minimumSignificantDigits:2,
maximumSignificantDigits:4>G||6<G?4:G})};m.getDeviationValues=function(w,G,R){if(null==G||null==w)return[];const D=[];for(let t=-1*R;t<=R;t++)0!==t&&D.push(G+t*w);return D};m.getDynamicPathForSizeStops=function(w){const {max:G,min:R,padding:D,pathHeight:t,pathWidth:c,stops:e}=w,d=G-R;let h=`M0 0 L${c} 0 `,f;w=3===e.length?[e[0],e[1],e[2]]:[e[0],e[2],e[4]];const v=Math.min.apply(Math,w.map(n=>n.size)),p=Math.max(Math.abs(w[0].size-w[1].size),Math.abs(w[2].size-w[1].size));w.reverse();w.forEach(({size:n,
value:k},x)=>{k=Math.round(t-(k-R)/d*t);f=Math.round((n-v)/p*100)/100*c;0===f&&(f=D*c);0===x&&(h+=`L${f} 0 `);h+=`L${f} ${k} `});return h+=`L${f} ${t} L0 ${t} L0 0 Z`};m.getFillFromColor=function(w){return w instanceof H?w.toCss(!0):H.fromString(w??"").toCss(!0)};m.getPathForSizeStops=function(w){const {bottomValue:G,bottomWidth:R,max:D,min:t,pathHeight:c,pathWidth:e,topValue:d,topWidth:h}=w;w=h*e;const f=R*e,v=D-t;return`M${w} 0 L${w} ${Math.round(c-(d-t)/v*c)} L${f} ${Math.round(c-(G-t)/v*c)} L${f} ${c} L0 ${c} L0 0 Z`};
m.getSizesFromVariable=function(w){let G=w.maxSize;w=w.minSize;G instanceof C&&(G=G.stops[0].size);w instanceof C&&(w=w.stops[0].size);return[G,w]};m.getStopChanges=function(w,G,R){const D=R.length-1;if(0>D)return[];const t=R[0],c=R[D]-t,e=G-w,d=[];for(let h=1;h<D;h++)d.push({index:h,value:(R[h]-t)/c*e+w});d.unshift({index:0,value:w});d.push({index:D,value:G});return d};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c){async function e(k,x,E){F.getOrCreateMapValue(k,x,()=>[]).push(...E)}async function d(k,x,E){k=F.getOrCreateMapValue(k,x,()=>new Map);for(const I of E)k.set(I.value,I.color)}function h(k){let x=k.minValue,E=k.maxValue;const I=k.isFirstBreak?"":v.gt+" ";k="percent-of-total"===k.normalizationType?v.pct:"";x=null==x?"":w.format(x);E=null==E?"":w.format(E);return I+x+k+" "+v.ld+" "+E+k}function f(k,x){return"normalizationField"in k&&k.normalizationField?{type:"normalized-field",
field:k.field,normalizationField:k.normalizationField}:"field"in k&&k.field?{type:"field",field:k.field}:"valueExpression"in k&&k.valueExpression?{type:"expression",expression:k.valueExpression,title:k.valueExpressionTitle,returnType:x}:null}const v={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},p={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},n=l.convertDateFormatToIntlOptions("short-date");m.calculateDateFormatInterval=function(k){k=k.map(g=>new Date(g));
const x=k.length;let E=Infinity,I=null;for(let g=0;g<x-1;g++){const u=k[g];let y=Infinity,M=null;for(let S=g+1;S<x;S++){var b=k[S];b=u.getFullYear()!==b.getFullYear()&&"year"||u.getMonth()!==b.getMonth()&&"month"||u.getDate()!==b.getDate()&&"day"||u.getHours()!==b.getHours()&&"hour"||u.getMinutes()!==b.getMinutes()&&"minute"||u.getSeconds()!==b.getSeconds()&&"second"||"millisecond";const A=p[b];A<y&&(y=A,M=b)}y<E&&(E=y,I=M)}return I};m.createClassBreakLabel=h;m.createColorStops=function(k){const {values:x,
colors:E,labelIndexes:I,isDate:b}=k;return x.map((g,u)=>{var y=null;if(!I||I.includes(u)){const M=b?l.formatDate(g):w.format(g);M&&(y="",0===u?y=v.lt+" ":u===x.length-1&&(y=v.gt+" "),y+=M)}return new G({value:g,color:E[u],label:y})})};m.createUniqueValueLabel=function(k){const {value:x,domain:E,fieldInfo:I,dateFormatOptions:b}=k;k=String(x);const g=E&&"codedValues"in E&&E.codedValues?E.getName(x):null;g?k=g:null!=x&&I&&(R.isAnyDateField(I)||C.isTimeOnlyField(I))?k=R.formatAnyDate(x,b??{fieldType:I.type}):
"number"===typeof x&&(k=w.format(x));return k};m.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};m.getAttribute=f;m.getAttributes=function(k,x){const E=[];if("class-breaks"===k.type||"heatmap"===k.type)E.push(f(k,"number"));else if("unique-value"===k.type){var I=k.authoringInfo;if(I&&"relationship"===
I.type){if(I.field1&&I.field2){var b=I.field2.field;const g=I.field2.normalizationField;E.push(f({field:I.field1.field,normalizationField:I.field1.normalizationField}));E.push(f({field:b,normalizationField:g}))}}else b=k.uniqueValueInfos?.[0],I=null,b?.value&&(b=typeof b.value,"string"===b||"number"===b)&&(I=b),E.push(f(k,I)),[k.field2,k.field3].forEach(g=>g&&E.push({type:"field",field:g}))}else"attributes"in k&&k.attributes?.forEach(g=>E.push(f(g,"number")));(k=x?x(k):"visualVariables"in k?k.visualVariables:
null)&&k.forEach(g=>E.push(f(g,"number")));return H.unique(E.filter(H.isSome),(g,u)=>"field"===g.type&&"field"===u.type?g.field===u.field:"normalized-field"===g.type&&"normalized-field"===u.type?g.field===u.field&&g.normalizationField===u.normalizationField:"expression"===g.type&&"expression"===u.type?g.expression===u.expression:!1)};m.getColorsForRendererValues=async function(k){const x=new Map;if(!k)return x;if("unique-value"!==k.type||k.authoringInfo?.type)if("class-breaks"===k.type){var E=k.classBreakInfos.map(g=>
({value:g.minValue,color:D.getColorFromSymbol(g.symbol,null)})).reverse();const {field:I,valueExpression:b}=k;await d(x,I??b,E)}else"simple"===k.type&&await d(x,"default",[{value:"default",color:D.getColorFromSymbol(k.symbol,null)}]);else{E=(k.uniqueValueInfos??[]).map(S=>({value:S.value,color:D.getColorFromSymbol(S.symbol,null)}));const {field:I,field2:b,field3:g,valueExpression:u,fieldDelimiter:y}=k,M=[I,b,g].filter(Boolean).join(y||"");(M||u)&&await d(x,M||u,E)}"defaultSymbol"in k&&k.defaultSymbol&&
await d(x,"default",[{value:"default",color:D.getColorFromSymbol(k.defaultSymbol,null)}]);if("visualVariables"in k&&k.visualVariables){k=k.visualVariables.filter(I=>"color"===I.type);for(const I of k)k=await t.getRampStops(I)??[],await d(x,I.field||I.valueExpression,k)}return x};m.getColorsFromRenderer=async function(k){const x=new Map;if(!k)return x;if("visualVariables"in k&&k.visualVariables){var E=k.visualVariables.filter(b=>"color"===b.type);for(var I of E)E=(await t.getRampStops(I)??[]).map(b=>
b.color),await e(x,I.field||I.valueExpression,E)}if("heatmap"===k.type)I=c.getHeatmapRampStops(k).map(b=>b.color),await e(x,k.field||k.valueExpression,I);else if("pie-chart"===k.type){for(const b of k.attributes)await e(x,b.field||b.valueExpression,[b.color]);await e(x,"default",[k?.othersCategory?.color,D.getColorFromSymbol(k.backgroundFillSymbol,null)])}else if("dot-density"===k.type){for(const b of k.attributes)await e(x,b.field||b.valueExpression,[b.color]);await e(x,"default",[k.backgroundColor])}else if("unique-value"===
k.type)if("predominance"===k.authoringInfo?.type)for(const b of k.uniqueValueInfos??[])await e(x,b.value.toString(),[D.getColorFromSymbol(b.symbol,null)]);else{I=(k.uniqueValueInfos??[]).map(M=>D.getColorFromSymbol(M.symbol,null));const {field:b,field2:g,field3:u,valueExpression:y}=k;(b||y)&&await e(x,b||y,I);g&&await e(x,g,I);u&&await e(x,u,I)}else if("class-breaks"===k.type){I=k.classBreakInfos.map(u=>D.getColorFromSymbol(u.symbol,null));const {field:b,valueExpression:g}=k;await e(x,b??g,I)}else"simple"===
k.type&&await e(x,"default",[D.getColorFromSymbol(k.symbol,null)]);"defaultSymbol"in k&&k.defaultSymbol&&await e(x,"default",[D.getColorFromSymbol(k.defaultSymbol,null)]);x.forEach((b,g)=>{b=H.unique(b.filter(Boolean),(u,y)=>JSON.stringify(u)===JSON.stringify(y));x.set(g,b)});return x};m.setLabelsForClassBreaks=function(k){const x=k.classBreakInfos,E=k.normalizationType;let I=[];if(x?.length)if("standard-deviation"===k.classificationMethod)O.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks",
"cannot set labels for class breaks generated using 'standard-deviation' method.");else if(k.round){I.push(x[0].minValue);for(const b of x)I.push(b.maxValue);I=w.round(I);x.forEach((b,g)=>{b.label=h({minValue:0===g?I[0]:I[g],maxValue:I[g+1],isFirstBreak:0===g,normalizationType:E})})}else x.forEach((b,g)=>{b.label=h({minValue:b.minValue,maxValue:b.maxValue,isFirstBreak:0===g,normalizationType:E})})};m.timelineDateFormatOptions=n;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c,e,d,h,f,v,p,n,k,x,E){const I=window.devicePixelRatio;H=class extends c{constructor(b,g){super(b,g);this._hasIndicators=!1;this._selectedSectionName=null;this._sectionNames=[];this._sectionMap=new Map;this.activeLayerInfos=null;this.headingLevel=3;this.layout="stack";this.messagesCommon=this.messages=null;this.type="card";this.view=null}initialize(){this.addHandles(O.watch(()=>this.activeLayerInfos,b=>{this.removeAllHandles();this._watchForSectionChanges(b)}))}render(){var {view:b}=
this;this._hasIndicators="auto"===this.layout&&b&&768>=b.container.clientWidth||"stack"===this.layout;b=this.activeLayerInfos?.toArray().map(y=>this._renderLegendForLayer(y)).filter(y=>!!y);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const g=this._sectionNames.length;var u=this._sectionNames.map((y,M)=>{M=E.substitute(this.messagesCommon.pagination.pageText,
{index:M+1,total:g});return k.tsx("div",{"aria-controls":`${y}-panel`,"aria-label":M,"aria-selected":(this._selectedSectionName===y).toString(),bind:this,class:this.classes(e.css.indicator,{[e.css.activated]:this._selectedSectionName===y}),"data-section-name":y,id:y,key:y,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===y?0:-1,title:M})});u=this._hasIndicators&&1<g?k.tsx("div",{class:e.css.indicatorContainer,key:"carousel-navigation",role:"tablist"},
u):null;b=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):b?.length?b:null;return k.tsx("div",{class:this.classes(e.css.base,{[e.css.stacked]:this._hasIndicators})},b||k.tsx("div",{class:e.css.message},this.messages.noLegend),u)}_selectSection(b){if(b=b.target.getAttribute("data-section-name"))this._selectedSectionName=b}_focusSection(b){switch(b.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(b);break;case "Enter":case " ":this._selectSection(b)}}_switchSectionOnArrowPress(b){const g=
b.key,u="ArrowLeft"===g?-1:1;b=b.target.getAttribute("data-section-name");b=this._sectionNames.indexOf(b);const y=this._sectionNames;let M=null;-1!==b&&(y[b+u]?M=document.getElementById(y[b+u]):"ArrowLeft"===g?M=document.getElementById(y[y.length-1]):"ArrowRight"===g&&(M=document.getElementById(y[0])),M?.focus())}_watchForSectionChanges(b){this._generateSectionNames();b&&(b.forEach(g=>{const u=`activeLayerInfo-${g.layer.uid}-version-change`;this.removeHandles(u);this._watchForSectionChanges(g.children);
this.addHandles(O.watch(()=>g.version,()=>this._generateSectionNames()),u)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(b.on("change",()=>this._watchForSectionChanges(b)),"activeLayerInfos-collection-change"))}_generateSectionNames(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(b,g,u){return`${this.id}${b.uid}-type-${g.type}-${u}`}_generateSectionNamesForActiveLayerInfo(b){b.children.forEach(this._generateSectionNamesForActiveLayerInfo,
this);b.legendElements&&b.legendElements.forEach((g,u)=>{this._sectionNames.push(this._getSectionName(b.layer,g,u))})}_renderLegendForLayer(b){if(!b.ready)return null;if(b.children.length){var g=b.children.map(y=>this._renderLegendForLayer(y)).toArray();return k.tsx("div",{class:this.classes(e.css.service,e.css.groupLayer),key:b.layer.uid},k.tsx("div",{class:e.css.serviceCaptionContainer},b.title),g)}if((g=b.legendElements)&&!g.length)return null;const u=g.some(y=>"relationship-ramp"===y.type);g=
g.map((y,M)=>this._renderLegendForElement(y,b,M,u)).filter(y=>!!y);return g.length?k.tsx("div",{class:this.classes(e.css.service,{[e.css.groupLayerChild]:!!b.parent}),key:b.layer.uid},k.tsx("div",{class:e.css.serviceCaptionContainer},k.tsx("div",{class:e.css.serviceCaptionText},b.title)),k.tsx("div",{class:e.css.serviceContent},g)):null}_renderLegendForElement(b,g,u,y=!1,M=!1){var S="color-ramp"===b.type,A="opacity-ramp"===b.type,J=g.layer,T=null;"string"===typeof b.title?T=b.title:b.title&&(T=b.title,
S=f.getTitle(this.messages,T,S||A),T=T.title?`${T.title} (${S})`:S);u=this._getSectionName(J,b,u);S=this._hasIndicators&&!M?k.tsx("div",null,k.tsx(v.Heading,{class:e.css.carouselTitle,level:this.headingLevel},g.title),k.tsx(v.Heading,{class:e.css.layerCaption,level:v.incrementHeadingLevel(this.headingLevel)},T)):T?k.tsx(v.Heading,{class:e.css.layerCaption,level:this.headingLevel},T):null;T=g.effectList;A=null;switch(b.type){case "symbol-table":J=b.infos.map((r,L)=>this._renderLegendForElementInfo(r,
g,b.legendType,L)).filter(r=>!!r);J.length&&(A=k.tsx("div",{class:this.classes({[e.css.labelContainer]:!J[0].properties.classes?.[e.css.symbolRow]&&!y,[e.css.relationshipLabelContainer]:y})},J));break;case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":A=this._renderLegendForRamp(b,J.opacity,T);break;case "size-ramp":A=this._renderSizeRamp(b,J.opacity);break;case "pie-chart-ramp":A=this._renderPieChartRamp(b);break;case "relationship-ramp":A=d.renderRelationshipRamp(b,this.id,
{opacity:J.opacity,effectList:T,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case "univariate-above-and-below-ramp":A=this._renderUnivariateAboveAndBelowRamp(b,J.opacity,T);break;case "univariate-color-size-ramp":A=this._renderUnivariateColorSizeRamp(b,J.opacity,T)}if(!A)return null;y=k.tsx("div",{"aria-labelledby":u,class:e.css.section,id:`${u}-panel`,key:u,role:"tabpanel",tabIndex:0},[S,A]);M||this._sectionMap.set(u,y);return y}_renderPieChartRamp(b){return k.tsx("div",{afterCreate:f.attachToNode,
bind:b.preview,class:e.css.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(b,g,u){const {sizeRampElement:y,colorRampElement:M}=h.getUnivariateAboveAndBelowRampElements(b,g,"horizontal");if(!y)return null;b=h.getUnivariateSizeRampSize(y,"full",!0,"horizontal");var S=h.getUnivariateColorRampSize(y,"above",!0,"horizontal"),A=h.getUnivariateColorRampSize(y,"below",!0,"horizontal"),J=this.messages?.previewColorRampAriaLabel;S=h.getUnivariateColorRampPreview(M,{width:S,height:12,rampAlignment:"horizontal",
opacity:g,type:"above",effectList:u,ariaLabel:J});g=h.getUnivariateColorRampPreview(M,{width:A,height:12,rampAlignment:"horizontal",opacity:g,type:"below",effectList:u,ariaLabel:J});u=h.getUnivariateColorRampMargin(y,"card");A=y.infos.map(r=>r.label);const T=A.length-1;A=A.map((r,L)=>0===L||L===T?k.tsx("div",{key:L},r):null);J={marginTop:"3px",display:"flex"};x.isRTL(this.container)?J.marginRight=`${u}px`:J.marginLeft=`${u}px`;b={width:`${b}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return k.tsx("div",{class:e.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},k.tsx("div",{class:this.classes(e.css.symbolContainer,e.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},y.infos.map((r,L)=>k.tsx("div",{afterCreate:f.attachToNode,bind:r.preview,class:e.css.symbol,key:L}))),S?k.tsx("div",{class:e.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:J},k.tsx("div",{afterCreate:f.attachToNode,bind:S}),k.tsx("div",{afterCreate:f.attachToNode,
bind:g})):null,k.tsx("div",{class:e.css.layerInfo},k.tsx("div",{class:e.css.rampLabelsContainer,styles:b},A)))}_renderUnivariateColorSizeRamp(b,g,u){const {sizeRampElement:y,colorRampElement:M}=h.getUnivariateColorSizeRampElements(b,"horizontal");if(!y)return null;b=h.getUnivariateSizeRampSize(y,"full",!1,"horizontal");var S=h.getUnivariateColorRampSize(y,"full",!1,"horizontal");g=h.getUnivariateColorRampPreview(M,{width:S,height:12,rampAlignment:"horizontal",opacity:g,type:"full",effectList:u,ariaLabel:this.messages?.previewColorRampAriaLabel});
const A=h.getUnivariateColorRampMargin(y,"card"),J=y.infos.length-1;u=y.infos.map((T,r)=>0===r||r===J?k.tsx("div",{key:r},T.label):null);S={marginTop:"3px",display:"flex"};x.isRTL(this.container)?S.marginRight=`${A}px`:S.marginLeft=`${A}px`;b={width:`${b}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return k.tsx("div",{class:e.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},k.tsx("div",{class:this.classes(e.css.symbolContainer,e.css.sizeRampHorizontal),
styles:{display:"flex",flexDirection:"row"}},y.infos.map((T,r)=>k.tsx("div",{afterCreate:f.attachToNode,bind:T.preview,class:e.css.symbol,key:r}))),k.tsx("div",{class:e.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:S},k.tsx("div",{afterCreate:f.attachToNode,bind:g})),k.tsx("div",{class:e.css.layerInfo},k.tsx("div",{class:e.css.rampLabelsContainer,styles:b},u)))}_renderLegendForElementInfo(b,g,u,y){var M=g.layer;if(b.type)return this._renderLegendForElement(b,g,y,!1,!0);var S=
f.isImageryStretchedLegend(M,u);u=f.getTitle(this.messages,b.label,!1)??"";if(b.preview){if(!b.symbol?.type.includes("simple-fill")){if(!b.label)return k.tsx("div",{afterCreate:f.attachToNode,bind:b.preview,key:y});g={[e.css.symbolCell]:this._hasIndicators};return k.tsx("div",{class:this.classes(e.css.layerRow,{[e.css.symbolRow]:this._hasIndicators}),key:y},k.tsx("div",{afterCreate:f.attachToNode,bind:b.preview,class:this.classes(g)}),k.tsx("div",{class:this.classes(e.css.imageLabel,{[e.css.labelCell]:this._hasIndicators})},
u))}let A=S=255,J=255,T=0,r=255,L=255,Q=255,z=0;const K=b.symbol.color?.a,U=b.symbol.outline?.color?.a;K&&(S=b.symbol.color.r,A=b.symbol.color.g,J=b.symbol.color.b,T=b.symbol.color.a*M.opacity);U&&(r=b.symbol.outline.color.r,L=b.symbol.outline.color.g,Q=b.symbol.outline.color.b,z=b.symbol.outline.color.a*M.opacity);M=(b=b.symbol.color?.isBright??!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";g={background:K?`rgba(${S}, ${A}, ${J}, ${T})`:"none",color:b?"black":"white",textShadow:`-1px -1px 0 ${M},\n                                              1px -1px 0 ${M},\n                                              -1px 1px 0 ${M},\n                                              1px 1px 0 ${M}`,
border:U?`1px solid rgba(${r}, ${L}, ${Q}, ${z})`:"none",filter:t.getCSSFilterFromEffectList(g.effectList)??void 0};return k.tsx("div",{class:e.css.layerRow,key:y},k.tsx("div",{class:e.css.labelElement,styles:g},u))}if(b.src)return g=this._renderImage(b,M,S),k.tsx("div",{class:e.css.layerRow,key:y},g,k.tsx("div",{class:e.css.imageLabel},u))}_renderImage(b,g,u){const {label:y,src:M,opacity:S}=b;u={[e.css.imageryLayerStretchedImage]:u,[e.css.symbol]:!u};g={opacity:`${null!=S?S:g.opacity}`};return k.tsx("img",
{alt:f.getTitle(this.messages,y,!1),"aria-label":f.getTitle(this.messages,y,!1),border:0,class:this.classes(u),height:b.height,src:M,styles:g,width:b.width})}_renderSizeRampLines(b){b=b.infos;var g=b[0],u=b[b.length-1],y=g.symbol;b=this._hasIndicators;g=F.pt2px(g.size+g.outlineSize)*I;u=F.pt2px(u.size+u.outlineSize)*I;const M=b?g:g+50*I,S=b?g/2+50*I:g;var A;y?y.type.includes("3d")?(A=y.symbolLayers?.length)?(A=y.symbolLayers.at(A-1).get("resource.primitive"),A="triangle"===A||"cone"===A||"tetrahedron"===
A):A=void 0:A="triangle"===y.style:A=void 0;if(y)if(y.type.includes("3d")){var J=y.symbolLayers?.length;J?(y=y.symbolLayers.at(J-1).resource?.primitive,y="circle"===y||"cross"===y||"kite"===y||"sphere"===y||"cube"===y||"diamond"===y):y=void 0}else y=y.style,y="circle"===y||"diamond"===y||"cross"===y;else y=void 0;J=document.createElement("canvas");J.width=M;J.height=S;J.style.width=`${J.width/I}px`;J.style.height=`${J.height/I}px`;const T=J.getContext("2d");if(b){T.beginPath();var r=M/2-u/2;T.moveTo(0,
0);T.lineTo(r,S);r=M/2+u/2;T.moveTo(M,0);T.lineTo(r,S)}else T.beginPath(),T.moveTo(0,S/2-u/2),T.lineTo(M,0),T.moveTo(0,S/2+u/2),T.lineTo(M,S);T.strokeStyle="#ddd";T.stroke();return k.tsx("div",{afterCreate:f.attachToNode,bind:J,styles:b?{display:"flex",marginTop:`-${A?0:y?g/2:0}px`,marginBottom:`-${A?u:y?u/2:0}px`}:{display:"flex",marginRight:`-${A?0:y?g/2:0}px`,marginLeft:`-${A?0:y?u/2:0}px`}})}_renderSizeRamp(b,g){var u=b.infos;const y=u[0].label,M=u[u.length-1].label;let S=u[0].preview;u=u[u.length-
1].preview;const A=this._hasIndicators,J={"flex-direction":A?"column":"row-reverse"};S&&(S=S.cloneNode(!0),S.style.display="flex");u&&(u=u.cloneNode(!0),u.style.display="flex");g={opacity:null!=g?`${g}`:""};return k.tsx("div",{class:this.classes(e.css.layerRow,{[e.css.sizeRampRow]:A})},k.tsx("div",{class:e.css.rampLabel},A?y:M),k.tsx("div",{class:e.css.sizeRampContainer,styles:J},k.tsx("div",{afterCreate:f.attachToNode,bind:S,class:e.css.sizeRampPreview,styles:g}),this._renderSizeRampLines(b),k.tsx("div",
{afterCreate:f.attachToNode,bind:u,class:e.css.sizeRampContainer,styles:g})),k.tsx("div",{class:e.css.rampLabel},A?M:y))}_getRampStopLabel(b,g){switch(g){case "heatmap-ramp":return this.messages[b.label];case "stretch-ramp":return f.getStretchStopLabel(b,this.messages);default:return b.label}}_renderLegendForRamp(b,g,u){var y=b.infos;b=b.type;const M="heatmap-ramp"===b,S=y.length-1;var A=2<S&&!M?25*S:100,J=A+20;y=y.slice().reverse();const T=y.length-1;var r=0!==y.length%2?y[y.length/2|0]:null;r=r&&
k.tsx("div",{class:e.css.intervalSeparatorsContainer},k.tsx("div",{class:e.css.intervalSeparator},"|"),k.tsx("div",{class:e.css.rampLabel},this._getRampStopLabel(r,b)));A=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:y[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:A,height:25},fill:{type:"linear",x1:10,y1:0,x2:A+10,y2:0,colors:y.map((L,Q)=>({color:L.color,offset:M&&"ratio"in L?L.ratio:Q/S}))},stroke:{width:0}},{shape:{type:"path",path:`M${A+10} 0 L${J} ${12.5} L${A+10} ${25} Z`},
fill:y[T].color,stroke:{width:0}}]];J=D.renderSVG(A,J,25);g={filter:t.getCSSFilterFromEffectList(u)??void 0,opacity:null==g?void 0:`${g}`};return k.tsx("div",{class:e.css.layerRow,styles:{justifyContent:"center"}},k.tsx("div",{class:e.css.rampLabel},this._getRampStopLabel(y[0],b)),k.tsx("div",{class:e.css.symbolContainer},k.tsx("div",{styles:g},J),r),k.tsx("div",{class:e.css.rampLabel},this._getRampStopLabel(y[T],b)))}};m.__decorate([l.property()],H.prototype,"activeLayerInfos",void 0);m.__decorate([l.property()],
H.prototype,"headingLevel",void 0);m.__decorate([l.property()],H.prototype,"layout",void 0);m.__decorate([l.property(),n.messageBundle("esri/widgets/Legend/t9n/Legend")],H.prototype,"messages",void 0);m.__decorate([l.property(),n.messageBundle("esri/t9n/common")],H.prototype,"messagesCommon",void 0);m.__decorate([l.property({readOnly:!0})],H.prototype,"type",void 0);m.__decorate([l.property()],H.prototype,"view",void 0);m.__decorate([p.accessibleHandler()],H.prototype,"_selectSection",null);return H=
m.__decorate([R.subclass("esri.widgets.Legend.styles.Card")],H)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],function(m){m.css={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",
imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",
service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",
labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",
univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(m,H,O,F,l,C,w){function G(d="vertical"){return"vertical"===
d?w.tsx("svg",{height:"4",width:"10"},w.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"0",x2:"10",y1:"2",y2:"2"})):w.tsx("svg",{height:"10",width:"10"},w.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"5",x2:"5",y1:"0",y2:"10"}))}function R(d,h="vertical"){const f=document.createElement("div");f.style.height="20px";f.className=e.univariateAboveAndBelowSymbol;null!=d&&(f.style.opacity=d.toString());c.append(f,G.bind(null,h));return f}function D(d,h,f="vertical",v){d.infos.forEach((p,
n)=>{if(v&&2===n)p.preview=R(h,f);else{n=H.pt2px(p.size)+("horizontal"===f?20:10);const k=p.preview,x="div"===k?.tagName.toLowerCase(),E=x?k:document.createElement("div");E.className=e.univariateAboveAndBelowSymbol;"horizontal"===f?E.style.width=`${n}px`:E.style.height=`${n}px`;!x&&k&&E.appendChild(k);p.preview=E}})}function t(d,h,f,v="vertical"){let p=0;d=d.infos;const n=Math.floor(d.length/2);var k="full"===h||"above"===h?0:n;for(h="full"===h||"below"===h?d.length-1:n;k<=h;k++)if(f&&k===n)p+="horizontal"===
v?10:20;else{const x=H.pt2px(d[k].size)+("horizontal"===v?20:10);p+=x}return Math.round(p)}const c=F.createProjector(),e={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};m.getUnivariateAboveAndBelowRampElements=function(d,h,f="vertical"){var v=d.infos;d=v.find(({type:p})=>"size-ramp"===p);v=v.find(({type:p})=>"color-ramp"===p);d&&(d={...d},d.infos=[...d.infos],D(d,h,f,!0));v&&(v={...v},v.infos=[...v.infos]);"horizontal"===f&&(d?.infos.reverse(),
v?.infos.reverse());return{sizeRampElement:d,colorRampElement:v}};m.getUnivariateColorRampMargin=function(d,h="classic"){d=d.infos;return"classic"===h?(H.pt2px(d[0].size)+10)/2:(H.pt2px(d[0].size)-H.pt2px(d[d.length-1].size))/2};m.getUnivariateColorRampPreview=function(d,h){if(!d)return null;d=d.infos.map(f=>f.color);d=l.renderColorRampPreviewHTML("full"===h.type?d:"above"===h.type?d.slice(0,3):d.slice(2,5),{width:h.width,height:h.height,align:h.rampAlignment,effectList:h.effectList,ariaLabel:h.ariaLabel});
d.className=e.colorRamp;null!=h.opacity&&(d.style.opacity=h.opacity.toString());return d};m.getUnivariateColorRampSize=function(d,h,f,v="vertical"){const p=t(d,h,f,v);d=d.infos;var n=Math.floor(d.length/2);const k="full"===h||"above"===h?0:n;n="full"===h||"below"===h?d.length-1:n;f=f?"vertical"===v?20:10:0;v="vertical"===v?10*("full"===h?2:1):20*("full"===h?2:1);return Math.round(p-(H.pt2px("full"===h?d[k].size+d[n].size:"above"===h?d[k].size:d[n].size)/2+f/2+v/2))};m.getUnivariateColorSizeRampElements=
function(d,h="vertical"){var f=d.infos;d=f.find(({type:v})=>"size-ramp"===v);f=f.find(({type:v})=>"color-ramp"===v);d&&(d={...d},d.infos=[...d.infos],D(d,null,h,!1));f&&(f={...f},f.infos=[...f.infos]);"horizontal"===h&&(d?.infos.reverse(),f?.infos.reverse());return{sizeRampElement:d,colorRampElement:f}};m.getUnivariateSizeRampSize=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../core/string",
"../../../intl/substitute","../../../intl/number"],function(m,H,O,F,l){m.attachToNode=function(C){C.appendChild(this)};m.getStretchStopLabel=function(C,w){return C.label?w[C.label]+": "+("string"===typeof C.value?C.value:l.formatNumber(C.value??0,{style:"decimal",notation:C.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""};m.getTitle=function(C,w,G){if(w){if("number"===typeof w)return w;if("string"===typeof w)return O.stripHTML(w);if("value"in w||"unit"in w)return F.substitute(C.dotValue,
w);if("colorName"in w&&"bandName"in w)return C[w.colorName]+": "+(C[w.bandName]||w.bandName);if("showCount"in w)return w.showCount?C.clusterCountTitle:void 0;var R=null;G?R=w.ratioPercentTotal?"showRatioPercentTotal":w.ratioPercent?"showRatioPercent":w.ratio?"showRatio":w.normField?"showNormField":w.field?"showField":null:G||(R=w.normField?"showNormField":w.normByPct?"showNormPct":w.field?"showField":null);return R?F.substitute("showField"===R?"{field}":C[R],{field:w.field,normField:w.normField}):
void 0}};m.isImageryStretchedLegend=function(C,w){return!!(w&&"Stretched"===w&&10.3<=C.version&&"esri.layers.ImageryLayer"===C.declaredClass)};m.isRendererTitle=function(C,w){return!w};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(m,H,O,F,l){m.Heading=function({level:C,class:w,...G},R){C=H.clamp(Math.ceil(C),1,6);return l.tsx(`h${C}`,{...G,"aria-level":String(C),
class:F.classes(O.globalCss.heading,w),role:"heading"},R)};m.incrementHeadingLevel=function(C,w=1){return H.clamp(Math.ceil(C+w),1,6)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(m){m.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",
buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",
menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/globalCss ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory".split(" "),
function(m,H,O,F,l,C,w,G,R,D,t,c,e,d,h,f){const v=`${G.legend}__`,p={display:"flex",alignItems:"flex-start"},n={marginLeft:"3px"},k={display:"table-cell",verticalAlign:"middle"};O=class extends w{constructor(x,E){super(x,E);this.activeLayerInfos=null;this.headingLevel=3;this.messages=null;this.type="classic"}render(){const x=this.activeLayerInfos?.toArray().map(E=>this._renderLegendForLayer(E)).filter(E=>!!E);return f.tsx("div",null,x?.length?x:f.tsx("div",{class:G.css.message},this.messages.noLegend))}_renderLegendForLayer(x,
E){if(!x.ready)return null;var I=!!x.children.length;const b=`${x.layer.uid}-version-${x.version}`,g=`${v}${E?`${E}-`:""}${b}`;E=x.title?e.Heading({level:this.headingLevel,class:this.classes(c.globalCss.heading,G.css.label)},x.title):null;if(I)return I=x.children.map(u=>this._renderLegendForLayer(u,b)).toArray(),f.tsx("div",{class:this.classes(G.css.service,G.css.groupLayer),key:g},E,I);if((I=x.legendElements)&&!I.length)return null;I=I.map(u=>this._renderLegendForElement(u,x.layer,x.effectList,g)).filter(u=>
!!u);return I.length?f.tsx("div",{class:this.classes(G.css.service,{[G.css.groupLayerChild]:!!x.parent}),key:g},E,f.tsx("div",{class:G.css.layer},I)):null}_renderLegendForElement(x,E,I,b,g){var u="color-ramp"===x.type,y="opacity-ramp"===x.type;const M="size-ramp"===x.type;let S=null;const A=`${b}-${x.type}`;if("symbol-table"===x.type||M){var J=x.infos.map(r=>this._renderLegendForElementInfo(r,E,I,M,x.legendType,A)).filter(r=>!!r);J.length&&(S=f.tsx("div",{class:G.css.layerBody},J))}else"color-ramp"===
x.type||"opacity-ramp"===x.type||"heatmap-ramp"===x.type||"stretch-ramp"===x.type?S=this._renderLegendForRamp(x,E.opacity,A):"relationship-ramp"===x.type?S=R.renderRelationshipRamp(x,this.id,{opacity:E.opacity,effectList:I,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:A}):"pie-chart-ramp"===x.type?S=this._renderPieChartRamp(x,A):"univariate-above-and-below-ramp"===x.type?S=this._renderUnivariateAboveAndBelowRamp(x,E.opacity,I,A):"univariate-color-size-ramp"===x.type&&(S=this._renderUnivariateColorSizeRamp(x,
E.opacity,I,A));if(!S)return null;J=x.title;var T=null;"string"===typeof J?T=J:J&&(T=t.getTitle(this.messages,J,u||y),T=t.isRendererTitle(J,u||y)&&J.title?`${J.title} (${T})`:T);u=g?G.css.layerChildTable:G.css.layerTable;y=T?f.tsx("div",{class:G.css.layerCaption},T):null;return f.tsx("div",{class:this.classes(u,{[G.css.layerTableSizeRamp]:M||!g}),key:`${b}-table`},y,S)}_renderPieChartRamp(x,E){return f.tsx("div",{afterCreate:t.attachToNode,bind:x.preview,key:`${E}-preview`})}_renderUnivariateAboveAndBelowRamp(x,
E,I,b){const {sizeRampElement:g,colorRampElement:u}=D.getUnivariateAboveAndBelowRampElements(x,E);if(!g)return null;var y=this.messages?.previewColorRampAriaLabel,M=D.getUnivariateColorRampSize(g,"above",!0);x=D.getUnivariateColorRampSize(g,"below",!0);const S=D.getUnivariateColorRampPreview(u,{width:12,height:M,rampAlignment:"vertical",opacity:E,type:"above",effectList:I,ariaLabel:y});E=D.getUnivariateColorRampPreview(u,{width:12,height:x,rampAlignment:"vertical",opacity:E,type:"below",effectList:I,
ariaLabel:y});var A=D.getUnivariateColorRampMargin(g);const J=g.infos.map(Q=>Q.label);I=J.map((Q,z)=>{const K=2===z;return 0===z?f.tsx("div",{class:Q?S?G.css.univariateAboveAndBelowLabel:G.css.rampLabel:void 0,key:`${b}-color-ramp-above-label-${Q??z}`},Q):K?f.tsx("div",null):null});const T=J.length-1,r=Math.floor(J.length/2);y=J.map((Q,z)=>{const K=z===T;return z===r||K?f.tsx("div",{class:Q?S?G.css.univariateAboveAndBelowLabel:G.css.rampLabel:void 0,key:`${b}-color-ramp-below-label-${Q??z}`},Q):null});
const L={display:"table-cell",verticalAlign:"middle"};A={marginTop:`${A}px`};M={height:`${M}px`};x={height:`${x}px`};return f.tsx("div",{key:`${b}-container`,styles:p},f.tsx("div",{class:G.css.layerBody},g.infos.map((Q,z)=>f.tsx("div",{class:this.classes(G.css.layerRow,G.css.sizeRamp),key:`${b}-row-${z}`},f.tsx("div",{afterCreate:t.attachToNode,bind:Q.preview,class:G.css.symbol,styles:L}),S||0!==z%2?null:f.tsx("div",{class:G.css.layerInfo},J[z])))),S?f.tsx("div",{styles:A},f.tsx("div",{styles:n},
f.tsx("div",{styles:k},f.tsx("div",{afterCreate:t.attachToNode,bind:S,class:G.css.rampContainer})),f.tsx("div",{styles:k},f.tsx("div",{class:G.css.rampLabelsContainer,styles:M},I))),f.tsx("div",{styles:n},f.tsx("div",{styles:k},f.tsx("div",{afterCreate:t.attachToNode,bind:E,class:G.css.rampContainer})),f.tsx("div",{styles:k},f.tsx("div",{class:G.css.rampLabelsContainer,styles:x},y)))):null)}_renderUnivariateColorSizeRamp(x,E,I,b){const {sizeRampElement:g,colorRampElement:u}=D.getUnivariateColorSizeRampElements(x);
if(!g)return null;var y=D.getUnivariateColorRampMargin(g);x=D.getUnivariateColorRampSize(g,"full",!1);E=D.getUnivariateColorRampPreview(u,{width:12,height:x,rampAlignment:"vertical",opacity:E,type:"full",effectList:I,ariaLabel:this.messages?.previewColorRampAriaLabel});const M=g.infos.length-1;I=g.infos.map((A,J)=>0===J||J===M?f.tsx("div",{class:A.label?u?G.css.univariateAboveAndBelowLabel:G.css.rampLabel:void 0,key:`${b}-color-ramp-label-${A.label??J}`},A.label):null);const S={display:"table-cell",
verticalAlign:"middle"};y={marginTop:`${y}px`};x={height:`${x}px`};return f.tsx("div",{key:`${b}-container`,styles:p},f.tsx("div",{class:G.css.layerBody},g.infos.map((A,J)=>f.tsx("div",{class:this.classes(G.css.layerRow,G.css.sizeRamp),key:`${b}-row-${J}`},f.tsx("div",{afterCreate:t.attachToNode,bind:A.preview,class:G.css.symbol,styles:S})))),f.tsx("div",{styles:y},f.tsx("div",{styles:n},f.tsx("div",{styles:k},f.tsx("div",{afterCreate:t.attachToNode,bind:E,class:G.css.rampContainer})),f.tsx("div",
{styles:k},f.tsx("div",{class:G.css.rampLabelsContainer,styles:x},I)))))}_renderLegendForRamp(x,E,I){const b=x.infos,g="heatmap-ramp"===x.type,u="stretch-ramp"===x.type,y=x.preview;y.className=`${G.css.colorRamp} ${"opacity-ramp"===x.type?G.css.opacityRamp:""}`;null!=E&&(y.style.opacity=E.toString());x=b.map((M,S)=>f.tsx("div",{class:M.label?G.css.rampLabel:void 0,key:`${I}-stop-${M.label??S}-label`},g?this.messages[M.label]||M.label:u?t.getStretchStopLabel(M,this.messages):M.label));E={height:y.style.height};
return f.tsx("div",{class:G.css.layerRow,key:`${I}-row`},f.tsx("div",{class:G.css.symbolContainer,styles:{width:"24px"}},f.tsx("div",{afterCreate:t.attachToNode,bind:y,class:G.css.rampContainer})),f.tsx("div",{class:G.css.layerInfo},f.tsx("div",{class:G.css.rampLabelsContainer,styles:E},x)))}_renderLegendForElementInfo(x,E,I,b,g,u){u=`${u}-${x.label}`;if(x.type)return this._renderLegendForElement(x,E,I,u,!0);I=null;g=t.isImageryStretchedLegend(E,g);x.preview?I=f.tsx("div",{afterCreate:t.attachToNode,
bind:x.preview,class:G.css.symbol}):x.src&&(I=this._renderImage(x,E,g));if(!I)return null;E={[G.css.imageryLayerInfoStretched]:g};return f.tsx("div",{class:G.css.layerRow,key:`${u}-row`},f.tsx("div",{class:this.classes(G.css.symbolContainer,{[G.css.imageryLayerInfoStretched]:g,[G.css.sizeRamp]:!g&&b})},I),f.tsx("div",{class:this.classes(G.css.layerInfo,E)},t.getTitle(this.messages,x.label,!1)||""))}_renderImage(x,E,I){const {label:b,src:g,opacity:u}=x;I={[G.css.imageryLayerStretchedImage]:I,[G.css.symbol]:!I};
E={opacity:`${null!=u?u:E.opacity}`};return f.tsx("img",{alt:t.getTitle(this.messages,b,!1),"aria-label":t.getTitle(this.messages,b,!1),border:0,class:this.classes(I),height:x.height,src:g,styles:E,width:x.width})}};m.__decorate([H.property()],O.prototype,"activeLayerInfos",void 0);m.__decorate([H.property()],O.prototype,"headingLevel",void 0);m.__decorate([H.property(),h.messageBundle("esri/widgets/Legend/t9n/Legend")],O.prototype,"messages",void 0);m.__decorate([H.property({readOnly:!0})],O.prototype,
"type",void 0);return O=m.__decorate([C.subclass("esri.widgets.Legend.styles.Classic")],O)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],function(m){m.css={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",
layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",
symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",message:"esri-legend__message",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};
m.legend="esri-legend";Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(m,H,O,F,l,C,w,G,R,D,t,c,e,d,h){l=class extends G{constructor(f,v){super(f,v);this.headingLevel=
3;this.messages=null;this.style=new t;this.viewModel=new R}initialize(){this.addHandles([H.on(()=>this.view,"resize",()=>this.scheduleRender()),H.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),H.watch(()=>this.headingLevel,f=>{const {style:v}=this;v&&(v.headingLevel=f)}),H.watch(()=>this.style,(f,v)=>{v&&f!==v&&v.destroy();f&&(f.activeLayerInfos=this.activeLayerInfos,"card"===f.type&&(f.view=this.view),f.headingLevel=this.headingLevel)},H.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(f){this.viewModel.activeLayerInfos=
f}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(f){this.viewModel.basemapLegendVisible=f}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(f){this.viewModel.groundLegendVisible=f}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(f){this.viewModel.hideLayersNotInCurrentView=f}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(f){this.viewModel.keepCacheOnDestroy=
f}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(f){this.viewModel.respectLayerDefinitionExpression=f}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(f){this.viewModel.respectLayerVisibility=f}get icon(){return"legend"}set icon(f){this._overrideIfSome("icon",f)}get label(){return this.messages?.widgetLabel??""}set label(f){this._overrideIfSome("label",f)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(f){this.viewModel.layerInfos=
f}castStyle(f){if(f instanceof D||f instanceof t)return f;if("string"===typeof f)return"card"===f?new D:new t;if(f&&"string"===typeof f.type){const v={...f};delete v.type;return new ("card"===f.type?D:t)(v)}return new t}get view(){return this.viewModel.view}set view(f){this.viewModel.view=f}render(){return h.tsx("div",{class:this.classes("esri-legend",c.globalCss.widget,this.style instanceof t?c.globalCss.panel:null)},this.style.render())}_refreshActiveLayerInfos(f){f.forEach(v=>{this.removeHandles(`version_${v.layer.uid}`);
this._renderOnActiveLayerInfoChange(v)});this.scheduleRender()}_renderOnActiveLayerInfoChange(f){var v=H.watch(()=>f.version,()=>this.scheduleRender());this.addHandles(v,`version_${f.layer.uid}`);v=H.on(()=>f.children,"change",()=>f.children.forEach(p=>this._renderOnActiveLayerInfoChange(p)),H.initial);this.addHandles(v,`version_${f.layer.uid}`);f.children.forEach(p=>this._renderOnActiveLayerInfoChange(p))}};m.__decorate([O.property()],l.prototype,"activeLayerInfos",null);m.__decorate([O.property()],
l.prototype,"basemapLegendVisible",null);m.__decorate([O.property()],l.prototype,"groundLegendVisible",null);m.__decorate([O.property()],l.prototype,"headingLevel",void 0);m.__decorate([O.property()],l.prototype,"hideLayersNotInCurrentView",null);m.__decorate([O.property()],l.prototype,"keepCacheOnDestroy",null);m.__decorate([O.property()],l.prototype,"respectLayerDefinitionExpression",null);m.__decorate([O.property()],l.prototype,"respectLayerVisibility",null);m.__decorate([O.property()],l.prototype,
"icon",null);m.__decorate([O.property()],l.prototype,"label",null);m.__decorate([O.property()],l.prototype,"layerInfos",null);m.__decorate([O.property(),d.messageBundle("esri/widgets/Legend/t9n/Legend")],l.prototype,"messages",void 0);m.__decorate([O.property()],l.prototype,"style",void 0);m.__decorate([F.cast("style")],l.prototype,"castStyle",null);m.__decorate([O.property()],l.prototype,"view",null);m.__decorate([O.property()],l.prototype,"viewModel",void 0);return l=m.__decorate([w.subclass("esri.widgets.Legend")],
l)});