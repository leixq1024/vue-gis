// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../core/libs/gl-matrix-2/math/vec2 ../../../chunks/NoiseTextureAtlas.glsl ./NoiseTextureAtlasConfiguration ./NoiseTextureAtlasDimensions ./NoiseTextureAtlasTechnique ../../webgl/FramebufferObject ../../webgl/TextureDescriptor".split(" "),function(c,
h,m,k,n,u,v,w,p,l,q,d,f,g,r,t){c.NoiseTextureAtlas=class extends m{constructor(a){super(a);this._needsRender=!0;this._passParameters=new q.NoiseTextureAtlasPassParameters;this._configuration=new d.NoiseTextureAtlasTechniqueConfiguration;this._fbo=new r.FramebufferObject(a.context.renderContext.rctx,new t.TextureDescriptor(f.atlasSize));this._configuration.mode=d.NoiseTextureRenderMode.Full;a.context.techniques.precompile(g.NoiseTextureAtlasTechnique,this._configuration);this._configuration.mode=d.NoiseTextureRenderMode.WeatherMap;
a.context.techniques.precompile(g.NoiseTextureAtlasTechnique,this._configuration)}get textureAtlas(){if(this._texture&&!this._needsRender)return this._texture;this._configuration.mode=this._texture?d.NoiseTextureRenderMode.WeatherMap:d.NoiseTextureRenderMode.Full;const a=this.context.techniques.acquire(g.NoiseTextureAtlasTechnique,this._configuration);a.compiled&&(this._texture=this._render(a));a.release();return this._texture}updateWeatherMap(a){l.equals(this._passParameters.weatherTile,a)||(l.copy(this._passParameters.weatherTile,
a),this._needsRender=!0)}destroy(){this._weatherMapTechniqueCached=k.releaseMaybe(this._weatherMapTechniqueCached);this._fbo=k.disposeMaybe(this._fbo)}_render(a){if(!this._fbo)return null;const b=this.context.renderContext.rctx,e=b.getViewport();b.setViewport(0,0,f.atlasSize,f.atlasSize);b.bindFramebuffer(this._fbo);b.bindTechnique(a,this.context.renderContext.bind,this._passParameters);b.screen.draw();b.setViewport(e.x,e.y,e.width,e.height);this._needsRender=!1;return this._fbo.colorTexture}};h.__decorate([n.property({constructOnly:!0})],
c.NoiseTextureAtlas.prototype,"context",void 0);c.NoiseTextureAtlas=h.__decorate([p.subclass("esri.views.3d.environment.NoiseTextureAtlas")],c.NoiseTextureAtlas);Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});