// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../chunks/vec32 ../../../../geometry/support/Indices ./AttributeArray ./BoundingInfo ./ContentObject ./ContentObjectType ./geometryDataUtils ./Object3DStateID ./Util ./VertexAttribute".split(" "),function(l,h,q,m,r,t,u,f,g,v,w,e){class n extends u.ContentObject{constructor(a,b,c=null,d=f.ContentObjectType.Mesh,x=null,y=-1){super();this.material=a;this.mapPositions=c;this.type=d;this.objectAndLayerIdColor=x;this.edgeIndicesLength=
y;this.highlights=new Set;this._highlightGroupCounts=new Map;this.visible=!0;this._attributes=new Map;this._boundingInfo=null;for(const [k,p]of b)this._attributes.set(k,{...p,indices:m.compactIndices(p.indices)}),k===e.VertexAttribute.POSITION&&(this.edgeIndicesLength=0>this.edgeIndicesLength?this._attributes.get(k).indices.length:this.edgeIndicesLength)}instantiate(a={}){const b=new n(a.material||this.material,[],this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);this._attributes.forEach((c,
d)=>{c.exclusive=!1;b._attributes.set(d,c)});b._boundingInfo=this._boundingInfo;b.transformation=a.transformation||this.transformation;return b}get attributes(){return this._attributes}getMutableAttribute(a){let b=this._attributes.get(a);b&&!b.exclusive&&(b={...b,exclusive:!0,data:r.cloneAttributeData(b.data)},this._attributes.set(a,b));return b}setAttributeData(a,b){const c=this._attributes.get(a);c&&this._attributes.set(a,{...c,exclusive:!0,data:b})}get indexCount(){return this._attributes.values().next().value.indices?.length??
0}get faceCount(){return this.indexCount/3}get boundingInfo(){null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo());return this._boundingInfo}computeAttachmentOrigin(a){return(this.type===f.ContentObjectType.Mesh?this._computeAttachmentOriginTriangles(a):this.type===f.ContentObjectType.Line?this._computeAttachmentOriginLines(a):this._computeAttachmentOriginPoints(a))?(null!=this._transformation&&q.transformMat4(a,a,this._transformation),!0):!1}_computeAttachmentOriginTriangles(a){const b=
this.attributes.get(e.VertexAttribute.POSITION);return g.computeAttachmentOriginTriangles(b,a)}_computeAttachmentOriginLines(a){const b=this.attributes.get(e.VertexAttribute.POSITION);var c=g.computeAttachmentOriginLines;var d=this.material.parameters;d="isClosed"in d&&d.isClosed?2<b.indices.length:!1;return c.call(g,b,d,a)}_computeAttachmentOriginPoints(a){const b=this.attributes.get(e.VertexAttribute.POSITION);return g.computeAttachmentOriginPoints(b,a)}invalidateBoundingInfo(){this._boundingInfo=
null}_calculateBoundingInfo(){const a=this.attributes.get(e.VertexAttribute.POSITION);if(!a||0===a.indices.length)return null;const b=this.type===f.ContentObjectType.Mesh?3:1;w.assert(0===a.indices.length%b,"Indexing error: "+a.indices.length+" not divisible by "+b);const c=m.getContinuousIndexArray(a.indices.length/b);return new t.BoundingInfo(c,b,a)}get transformation(){return this._transformation??h.IDENTITY}set transformation(a){this._transformation=a&&a!==h.IDENTITY?h.clone(a):null}get highlightGroups(){return this._highlightGroupCounts}get hasHighlights(){return 0<
this._highlightGroupCounts.size}foreachHighlightGroup(a){this._highlightGroupCounts.forEach((b,c)=>a(c))}allocateIdAndHighlight(a){a=new v.Object3DHighlightStateID(a);return this.addHighlight(a)}addHighlight(a){this.highlights.add(a);const {highlightGroupName:b}=a,c=(this._highlightGroupCounts.get(b)??0)+1;this._highlightGroupCounts.set(b,c);return a}removeHighlight(a){if(this.highlights.delete(a)){({highlightGroupName:a}=a);const b=this._highlightGroupCounts.get(a)??0;1>=b?this._highlightGroupCounts.delete(a):
this._highlightGroupCounts.set(a,b-1)}}}l.Geometry=n;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});