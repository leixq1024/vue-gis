// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../core/shaderLibrary/util/AlphaCutoff ../effects/geometry/olidUtils ../lib/basicInterfaces ../lib/GLMaterial ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/VertexAttribute ./DefaultBufferWriter ./TriangleMaterial ./VisualVariablePassParameters ../shaders/ColorMaterialTechnique ../shaders/ColorMaterialTechniqueConfiguration".split(" "),function(f,
h,k,c,l,m,n,p,q,d,e,r,t,u,v,w){class x extends t.TriangleMaterial{constructor(a){super(a,g);this._configuration=new w.ColorMaterialTechniqueConfiguration;this.supportsEdges=!0;this.produces=new Map([[d.RenderSlot.OPAQUE_MATERIAL,b=>this._isOpaqueMaterialPass(b)],[d.RenderSlot.OPAQUE_MATERIAL_WITHOUT_NORMALS,b=>this._isOpaqueNoSSAODepthPass(b)],[d.RenderSlot.TRANSPARENT_MATERIAL,b=>c.isColorOrOID(b)&&this._transparent&&this.parameters.writeDepth],[d.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,
b=>c.isDepth(b)&&this._transparent&&this.parameters.writeDepth],[d.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,b=>c.isColorOrOID(b)&&this._transparent&&!this.parameters.writeDepth],[d.RenderSlot.DRAPED_MATERIAL,b=>c.is2DGeometryOutput(b)]])}getConfiguration(a,b){this._configuration.output=a;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;
this._configuration.transparent=this._transparent;this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(a)&&this.parameters.discardInvisibleFragments;this._configuration.polygonOffset=this.parameters.polygonOffset;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.hasOccludees=b.hasOccludees;this._configuration.oitPass=b.oitPass;this._configuration.enableOffset=b.camera.relativeElevation<q.OITPolygonOffsetLimit;this._configuration.terrainDepthTest=
b.terrainDepthTest;this._configuration.cullAboveTerrain=b.cullAboveTerrain;this._configuration.vvColor=!!this.parameters.vvColor;this._configuration.draped=this.parameters.draped;return this._configuration}get visible(){return this.parameters.color[3]>=l.alphaCutoff}get _transparent(){return 1>this.parameters.color[3]||this.parameters.forceTransparentMode}_isOpaquePass(a){return this._isOpaqueMaterialPass(a)||this._isOpaqueNoSSAODepthPass(a)}_isOpaqueMaterialPass(a){return a===c.ShaderOutput.Highlight||
c.isColorOrOID(a)&&!this._transparent}_isOpaqueNoSSAODepthPass(a){return c.isDepth(a)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(a){return new y(a)}createBufferWriter(){const a=k.newLayout().vec3f(e.VertexAttribute.POSITION);m.olidEnabled()&&a.vec4u8(e.VertexAttribute.OBJECTANDLAYERIDCOLOR);this.parameters.vvColor?a.f32(e.VertexAttribute.COLORFEATUREATTRIBUTE):a.vec4u8(e.VertexAttribute.COLOR);return new r.DefaultBufferWriter(a)}}class y extends p{beginSlot(a){return this.acquireTechnique(v.ColorMaterialTechnique,
a)}}class g extends u.VisualVariablePassParameters{constructor(){super(...arguments);this.color=h.ZEROS;this.forceTransparentMode=!1;this.writeDepth=!0;this.hasSlicePlane=this.polygonOffset=this.hasVertexColors=!1;this.cullFace=n.CullFaceOptions.None;this.discardInvisibleFragments=this.draped=!1}}f.ColorMaterial=x;f.Parameters=g;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});