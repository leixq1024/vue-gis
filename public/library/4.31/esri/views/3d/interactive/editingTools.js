// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/3d/interactive/editingTools/draw/DrawGraphicTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/colorUtils ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../support/elevationInfoUtils ../../../../../symbols/support/ElevationInfo ../../SegmentLabels3D ../../SnappingVisualizer3D ../meshFastUpdateUtils ../settings ../../visualElements/ExtendedLineVisualElement ../../visualElements/OutlineVisualElement ../../visualElements/VerticesVisualElement ../../../layers/graphics/elevationAlignmentUtils ../../../layers/graphics/ElevationContext ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/Material ../../../../draw/DrawGraphicTool ../../../../draw/DrawOperation ../../../../draw/drawSurfaces ../../../../interactive/tooltip/tooltipCommonUtils ../../../../../core/accessorSupport/trackingUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I){a.DrawGraphicTool3D=class extends B.DrawGraphicTool{constructor(M){super(M);this._verticalLineVisualElement=this._verticesVisualElement=this._outlineVisualElement=this._createGraphicState=this._activeVertexVisualElement=null;this._settings=new H.Settings({getTheme:()=>this.view.effectiveTheme});this.geometryType=null;this.type="draw-3d"}initialize(){const {mode:M,offset:N,unit:K}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=
new m({mode:M,offset:N,unit:K})}normalizeCtorArgs(M){return M.elevationInfo?M:{...M,elevationInfo:k.getEffectiveElevationInfo(M.hasZ??!0)}}initializeGraphic(M){const {view:N}=this,K=this._createGraphicState=new y.GraphicState({graphic:M});return f.handlesGroup([N.maskOccludee(M),N.trackGraphicState(K),n.watch(()=>({element:this._outlineVisualElement,isDraped:K.isDraped}),({element:O,isDraped:U})=>{O&&(O.isDraped=U)},n.syncAndInitial),I.autorun(()=>{G.updateMeshTransformFromTooltipInfo(this.tooltipInfos.mesh,
this.geometryToPlace)}),this._setupLoadingIndicator(K),...z.meshTransformFastUpdateHandles(K)])}makeDrawOperation(){const {geometryType:M}=this,N="circle"!==M&&"rectangle"!==M;return new p.DrawOperation({view:this.view,manipulators:this.manipulators,geometryType:B.geometryTypeToDrawOperationGeometryType(M),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new A.SceneDrawSurface(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new A.ElevationDrawSurface(this.elevationInfo,
this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new r.SnappingVisualizer3D,segmentLabels:N?new l.SegmentLabels3D:null,labelOptions:this.sketchOptions.labels,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===k.getEffectiveElevationMode(this.hasZ,this.elevationInfo),cursor:this.cursor,constraintsEnabled:!0})}onActiveVertexChanged(M){var {view:N}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=
[M],this._activeVertexVisualElement.recreate(),this._updateVerticalLineVisualElement(M),f.makeHandle();const K=this._settings,O=K.manipulators.vertex,U=new x.VerticesVisualElement({view:N,spatialReference:N.spatialReference,vertices:[M],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});this._activeVertexVisualElement=U;const V=new D.ExtendedLineVisualElement({view:N,extensionType:K.visualElements.zVerticalLine.extensionType,
innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:d.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});this._verticalLineVisualElement=V;N=f.handlesGroup([n.watch(()=>K.visualElements.zVerticalLine,ea=>ea.apply(V),n.initial),n.watch(()=>({selectedColor:g.unitRGBAFromColor(K.colors.selected),outlineColor:g.unitRGBAFromColor(K.manipulators.vertex.outlineColor)}),({selectedColor:ea,outlineColor:Y})=>{U.color=ea;U.outlineColor=Y},n.initial),f.makeHandle(()=>{this._activeVertexVisualElement=
e.destroyMaybe(this._activeVertexVisualElement);this._verticalLineVisualElement=e.destroyMaybe(this._verticalLineVisualElement)})]);U.attached=!0;this._updateVerticalLineVisualElement(M);return N}_updateVerticalLineVisualElement(M){const N=this._verticalLineVisualElement;if(N){var {renderCoordsHelper:K,elevationProvider:O}=this.view;q.set(L,M[0],M[1],M[2]);J.setFromElevationInfo(this.elevationInfo);L[2]=C.evaluateElevationAlignmentAtPoint(L,O,J,K);K.toRenderCoords(L,this.view.spatialReference,L)?
(N.setStartEndFromWorldDownAtLocation(L),N.attached=!0):N.attached=!1}}onOutlineChanged(M){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=M,f.makeHandle();const N=this.internalGraphicsLayer.elevationInfo,{view:K}=this,O=this._settings,U=new w.OutlineVisualElement({view:K,geometry:M,elevationInfo:N,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===k.getEffectiveElevationMode(this.hasZ,N),attached:!1,isDecoration:!0});this._outlineVisualElement=
U;M=f.handlesGroup([n.watch(()=>O.visualElements.lineObjects.outline,V=>V.apply(U),n.initial),n.watch(()=>O.visualElements.lineObjects.shadowStyle,V=>V.apply(U),n.initial),f.makeHandle(()=>{this._outlineVisualElement=e.destroyMaybe(this._outlineVisualElement)})]);U.attached=!0;U.laserlineEnabled=!0;return M}onRegularVerticesChanged(M){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=M,f.makeHandle();const {view:N}=this,K=this._settings,O=K.manipulators.vertex,U=new x.VerticesVisualElement({view:N,
spatialReference:N.spatialReference,vertices:M,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});M=f.handlesGroup([n.watch(()=>({color:g.unitRGBAFromColor(K.manipulators.vertex.color),outlineColor:g.unitRGBAFromColor(K.manipulators.vertex.outlineColor)}),({color:V,outlineColor:ea})=>{U.color=V;U.outlineColor=ea},n.initial),f.makeHandle(()=>{this._verticesVisualElement=e.destroyMaybe(this._verticesVisualElement)})]);
U.attached=!0;this._verticesVisualElement=U;return M}updateGraphicGeometry(M){if("mesh"===this.geometryType&&"point"===M?.type){const N=this.geometryToPlace;N?.centerAt(M);G.updateMeshTransformFromTooltipInfo(this.tooltipInfos.mesh,N);M=this._graphic;N&&M.geometry===N||(M.geometry=N)}else super.updateGraphicGeometry(M)}_setupLoadingIndicator(M){const {drawOperation:N}=this;if(!this.geometryToPlace)return N.loading=!1,null;N.loading=!0;const K=f.makeHandle(()=>{N.loading=!1});let O=void 0;return f.handlesGroup([n.when(()=>
M.displaying,()=>{O&&cancelAnimationFrame(O);O=requestAnimationFrame(()=>K.remove())},{...n.syncAndInitial,once:!0}),f.makeHandle(()=>O&&cancelAnimationFrame(O)),K])}};b.__decorate([u.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"elevationInfo",void 0);b.__decorate([u.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"geometryType",void 0);b.__decorate([u.property()],a.DrawGraphicTool3D.prototype,"type",void 0);b.__decorate([u.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,
"view",void 0);a.DrawGraphicTool3D=b.__decorate([E.subclass("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],a.DrawGraphicTool3D);const J=new h.ElevationContext,L=c.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SegmentLabels3D":function(){define("exports ../../../chunks/tslib.es6 ../../../core/screenUtils ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../../../core/libs/gl-matrix-2/factories/vec3f64 ./support/viewUtils ../../interactive/SegmentLabels".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.SegmentLabels3D=class extends E.SegmentLabels{getCameraOrExtent({view:c}){return c.state.camera}toScreenPointArray({view:c,elevationInfo:k,editGeometryOperations:m},l,r=g.createScreenPointArray()){({spatialReference:m}=m.data.coordinateHelper);F.vectorToRender(l,m,k,c,q);c.state.camera.projectToScreen(q,r);return r}};a.SegmentLabels3D=b.__decorate([v.subclass("esri.views.3d.interactive.SegmentLabels3D")],a.SegmentLabels3D);const q=t.create();Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/support/viewUtils":function(){define("exports ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../support/elevationInfoUtils".split(" "),function(a,b,g,f,e,n){const u=e.create(),v=b.createRenderScreenPointArray(),t=b.createRenderScreenPointArray();a.renderScreenSpaceTangent=function(F,E,q,c){q.projectToRenderScreen(F,v);q.projectToRenderScreen(E,
t);g.subtract(c,t,v);g.normalize(c,c)};a.vectorToRender=function(F,E,q,c,k=e.create()){F=f.copy(u,F);F[2]=n.getConvertedElevationFromVector(c,F,E,q)||0;c.renderCoordsHelper.toRenderCoords(F,E,k);return k};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/SegmentLabels":function(){define("exports ../../chunks/tslib.es6 ../../Color ../../intl ../../core/Accessor ../../core/asyncUtils ../../core/colorUtils ../../core/handleUtils ../../core/has ../../core/mathUtils ../../core/quantityFormatUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../geometry/support/coordsUtils ../../geometry/support/vectorStacks ../../intl/messages ../../support/elevationInfoUtils ../../support/getDefaultUnitForView ../overlay/TextOverlayItem ../support/automaticLengthMeasurementUtils ../../intl/locale".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A){function G(O,U,V,ea,Y){const ra=[];U.data.components[Y].iterateVertices(R=>{ra.push(ea.toXYZ(R.pos,C.sv3d.get()))});0===Y&&null!=V&&ra.push(ea.toXYZ(V,C.sv3d.get()));if(2>ra.length)return ra;U=ra[0];V=ra[ra.length-1];"polygon"===O.type&&2<ra.length&&!w.equals(U,V)&&ra.push(U);return ra}const I={default:15,far:25};a.SegmentLabels=class extends e{constructor(O){super(O);this.stagedVertex=this.context=null;this.visible=!0;this.edgeDistance=
"default";this._messageUnitsTask=null;this._labelInfos=[];this._nextLabelIndex=0}initialize(){this.addHandles([q.watch(()=>[null!=this.context&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits],()=>this._update()),...["vertex-add","vertex-update","vertex-remove"].map(O=>q.on(()=>this.context?.editGeometryOperations,O,()=>this._update())),q.watch(()=>this._colors,O=>this._updateStyle(O)),A.onLocaleChange(()=>this._refreshMessages()),v.makeHandle(()=>
this._messageUnitsTask?.abort())]);this._refreshMessages()}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){}get _messagesUnits(){return this._messageUnitsTask?.value}get _edgeDistancePixels(){return I[this.edgeDistance]}get _colors(){const O=this.context?.view.effectiveTheme.textColor??g.fromArray([255,255,255]),U=u.multiplyOpacity(u.getContrast(O,u.BrightnessThreshold.Low),.6);return{textColor:O,
backgroundColor:U}}_update(){if(!this.destroyed){this._nextLabelIndex=0;var {context:O,stagedVertex:U}=this;if(!O)return this._destroyUnusedLabels();var {editGeometryOperations:V}=O,{components:ea,geometry:Y,coordinateHelper:ra}=V.data;if(!Y)return this._destroyUnusedLabels();var R=ea.length;for(let ha=0;ha<R;++ha){const ka=G(Y,V,U,ra,ha);var T;if(!(T=2>ka.length)){a:{T=ka;var aa=O.view,ba=O.elevationInfo,ca=ra.spatialReference;if("2d"===aa.type)T=!0;else{var la=k.getMetersPerUnit(ca)??1,sa=k.getMetersPerVerticalUnitForSR(ca);
for(let W=1;W<T.length;++W){var ua=T[W-1];const fa=T[W],oa=(fa[0]-ua[0])*la,ta=(fa[1]-ua[1])*la;ua=((y.getConvertedElevationFromVector(aa,fa,ca,ba,y.absoluteHeightElevationInfo)??0)-(y.getConvertedElevationFromVector(aa,ua,ca,ba,y.absoluteHeightElevationInfo)??0))*sa;if(Math.abs(ua)/Math.sqrt(oa*oa+ta*ta)>J){T=!1;break a}}T=!0}}T=!T}if(!T)for(T=1===R?!x.isClockwise(ka):!1,aa=N,ba=K,this.toScreenPointArray(O,ka[0],aa),ca=1;ca<ka.length;++ca)la=ka[ca-1],sa=ka[ca],this.toScreenPointArray(O,sa,ba),this._addLabel(O,
la,aa,sa,ba,T),[aa,ba]=[ba,aa]}this._destroyUnusedLabels()}}_updateStyle({textColor:O,backgroundColor:U}){const V=this._nextLabelIndex,ea=this._labelInfos;for(let Y=0;Y<V;++Y){const {label:ra}=ea[Y];ra.textColor=O;ra.backgroundColor=U}}_addLabel(O,U,V,ea,Y,ra){const {label:R}=this._getOrCreateLabel(O);if(!this.visible||3025>H.squaredDistance(V,Y))R.visible=!1;else{var {spatialReference:T}=O.editGeometryOperations.data;U=p.autoDistance2D(U,ea,T);ea=this._messagesUnits;O=d.getDefaultUnitForView(O.view);
R.text=null!=ea&&null!=U?E.formatLength(ea,U,O):"";R.visible=!0;O=Y[0]-V[0];U=Y[1]-V[1];ra?H.set(L,-U,O):H.set(L,U,-O);H.normalize(L,L);H.scale(L,L,this._edgeDistancePixels);H.lerp(M,V,Y,.5);H.add(M,M,L);R.position=[M[0],M[1]];R.anchor=Math.abs(L[0])>Math.abs(L[1])?0<L[0]?"left":"right":0>-L[1]?"top":"bottom"}}_getOrCreateLabel(O){var U=this._labelInfos.length>this._nextLabelIndex;const {textColor:V,backgroundColor:ea}=this._colors;if(U)return O=this._labelInfos[this._nextLabelIndex++],{label:U}=
O,U.textColor=V,U.backgroundColor=ea,O;U=new B({anchor:"center",fontSize:8,textColor:V,backgroundColor:ea});O.view.overlay?.items.add(U);O={label:U};this._labelInfos.push(O);this._nextLabelIndex=this._labelInfos.length;return O}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:O}){this.context?.view.overlay?.items.remove(O);O.destroy()}_refreshMessages(){this._messageUnitsTask?.abort();this._messageUnitsTask=n.createTask(()=>
h.fetchMessageBundle("esri/core/t9n/Units"))}};b.__decorate([m.property()],a.SegmentLabels.prototype,"context",void 0);b.__decorate([m.property()],a.SegmentLabels.prototype,"stagedVertex",void 0);b.__decorate([m.property()],a.SegmentLabels.prototype,"visible",void 0);b.__decorate([m.property()],a.SegmentLabels.prototype,"edgeDistance",void 0);b.__decorate([m.property()],a.SegmentLabels.prototype,"updating",null);b.__decorate([m.property()],a.SegmentLabels.prototype,"_messageUnitsTask",void 0);b.__decorate([m.property()],
a.SegmentLabels.prototype,"_messagesUnits",null);b.__decorate([m.property()],a.SegmentLabels.prototype,"_edgeDistancePixels",null);b.__decorate([m.property()],a.SegmentLabels.prototype,"_colors",null);a.SegmentLabels=b.__decorate([z.subclass("esri.views.interactive.SegmentLabels")],a.SegmentLabels);const J=F.deg2rad(5),L=D.create(),M=D.create(),N=c.createScreenPointArray(),K=c.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityFormatUtils":function(){define(["exports",
"./Cyclical","./quantityUtils","./unitFormatUtils"],function(a,b,g,f){function e(r,z,H,D=2,w="abbr"){return f.formatDecimal(r,g.toUnit(z,H).value,H,D,w)}function n(r,z,H,D=2,w="abbr"){return f.formatRelativeDecimal(r,g.toUnit(z,H).value,H,D,w)}function u(r,z,H=2,D="abbr"){return f.formatMetricLength(r,z.value,z.unit,H,D)}function v(r,z,H=2,D="abbr"){return f.formatMetricRelativeLength(r,z.value,z.unit,H,D)}function t(r,z,H=2,D="abbr"){return f.formatMetricVerticalLength(r,z.value,z.unit,H,D)}function F(r,
z,H=2,D="abbr"){return f.formatMetricRelativeVerticalLength(r,z.value,z.unit,H,D)}function E(r,z,H=2,D="abbr"){return f.formatMetricArea(r,z.value,z.unit,H,D)}function q(r,z,H=2,D="abbr"){return f.formatImperialLength(r,z.value,z.unit,H,D)}function c(r,z,H=2,D="abbr"){return f.formatImperialRelativeLength(r,z.value,z.unit,H,D)}function k(r,z,H=2,D="abbr"){return f.formatImperialVerticalLength(r,z.value,z.unit,H,D)}function m(r,z,H=2,D="abbr"){return f.formatImperialRelativeVerticalLength(r,z.value,
z.unit,H,D)}function l(r,z,H=2,D="abbr"){return f.formatImperialArea(r,z.value,z.unit,H,D)}a.formatAngle=function(r,z,H,D=b.cyclicalDegrees,w=!0){return f.formatAngleDegrees(r.value,r.unit,r.rotationType,z,H,D,w)};a.formatArea=function(r,z,H,D=2,w="abbr"){switch(H){case "imperial":return l(r,z,D,w);case "metric":return E(r,z,D,w);default:return e(r,z,H,D,w)}};a.formatDMS=function(r){return f.formatDMS(r.value,r.unit)};a.formatDecimal=e;a.formatImperialArea=l;a.formatImperialLength=q;a.formatImperialRelativeLength=
c;a.formatImperialRelativeVerticalLength=m;a.formatImperialVerticalLength=k;a.formatLength=function(r,z,H,D,w="abbr"){D=D??2;switch(H){case "imperial":return q(r,z,D,w);case "metric":return u(r,z,D,w);default:return e(r,z,H,D,w)}};a.formatMetricArea=E;a.formatMetricLength=u;a.formatMetricRelativeLength=v;a.formatMetricRelativeVerticalLength=F;a.formatMetricVerticalLength=t;a.formatRelativeAngle=function(r,z,H){return f.formatRelativeAngleDegrees(r.value,r.unit,r.rotationType,z,H??void 0)};a.formatRelativeDecimal=
n;a.formatRelativeLength=function(r,z,H,D=2,w="abbr"){switch(H){case "imperial":return c(r,z,D,w);case "metric":return v(r,z,D,w);default:return n(r,z,H,D,w)}};a.formatRelativeVerticalLength=function(r,z,H,D=2,w="abbr"){switch(H){case "imperial":return m(r,z,D,w);case "metric":return F(r,z,D,w);default:return n(r,z,H,D,w)}};a.formatVerticalLength=function(r,z,H,D=2,w="abbr"){switch(H){case "imperial":return k(r,z,D,w);case "metric":return t(r,z,D,w);default:return e(r,z,H,D,w)}};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/support/getDefaultUnitForView":function(){define(["exports","../core/unitUtils","../portal/Portal"],function(a,b,g){a.getDefaultUnitForView=function(f){if(null==f)return"metric";var e=f.map;e=(e&&"portalItem"in e?e.portalItem?.portal:null)??g.getDefault();switch(e.user?.units??e.units){case "metric":return"metric";case "english":return"imperial"}return b.getDefaultUnitSystem(f.spatialReference)??"metric"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/overlay/TextOverlayItem":function(){define("../../chunks/tslib.es6 ../../Color ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../libs/maquette/projection ../../libs/maquette/h ../../libs/maquette/projector".split(" "),function(a,b,g,f,e,n,u,v,t,F,E){const q={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right",
"bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};g=class extends g{get position(){return[this.x,this.y]}set position(m){this._set("x",m[0]);this._set("y",m[1])}get _textShadowColor(){const {textColor:m,backgroundColor:l}=
this,r=l.clone();r.a*=m.a;return r}get _textShadow(){const m=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${m}`}get padding(){return.5*this.fontSize}get borderRadius(){return this.padding}set borderRadius(m){this._overrideIfSome("borderRadius",m)}constructor(m){super(m);this.y=this.x=0;this.text="-";this.fontSize=14;this.anchor="center";this.isDecoration=this.visible=!0;this.backgroundColor=new b([0,0,0,.6]);this.textColor=new b([255,255,255]);this._textShadowSize=1}render(){return F.h("div",
{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this.borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(m){if(this.visible){var l=m.font.replace(/^(.*?)px/,"");m.font=`${this.fontSize}px ${l}`;var {padding:r,borderRadius:z}=
this,H=m.measureText(this.text).width,D=""!==this.text?this.fontSize:0;l=c[this.anchor];m.textAlign="center";m.textBaseline="middle";H+=2*r;D+=2*r;this._roundedRect(m,this.x+l.x*H,this.y+l.y*D,H,D,z);m.fillStyle=this.backgroundColor.toCss(!0);m.fill();H=this.x+(l.x+.5)*H;l=this.y+(l.y+.5)*D;this._renderTextShadow(m,this.text,H,l);m.fillStyle=this.textColor.toCss(!0);m.fillText(this.text,H,l)}}_renderTextShadow(m,l,r,z){m.lineJoin="miter";m.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/
k.length})`;const H=this._textShadowSize;for(const [D,w]of k)m.fillText(l,r+H*D,z+H*w)}_roundedRect(m,l,r,z,H,D){D=Math.min(D,H/2,z/2);m.beginPath();m.moveTo(l,r+D);m.arcTo(l,r,l+D,r,D);m.lineTo(l+z-D,r);m.arcTo(l+z,r,l+z,r+D,D);m.lineTo(l+z,r+H-D);m.arcTo(l+z,r+H,l+z-D,r+H,D);m.lineTo(l+D,r+H);m.arcTo(l,r+H,l,r+H-D,D);m.closePath()}_cssClasses(){const m={"esri-text-overlay-item":!0};let l;for(l in q)m[q[l]]=this.anchor===l;return m}};a.__decorate([f.property()],g.prototype,"x",void 0);a.__decorate([f.property()],
g.prototype,"y",void 0);a.__decorate([f.property()],g.prototype,"position",null);a.__decorate([f.property()],g.prototype,"text",void 0);a.__decorate([f.property()],g.prototype,"fontSize",void 0);a.__decorate([f.property()],g.prototype,"anchor",void 0);a.__decorate([f.property()],g.prototype,"visible",void 0);a.__decorate([f.property()],g.prototype,"isDecoration",void 0);a.__decorate([f.property()],g.prototype,"backgroundColor",void 0);a.__decorate([f.property()],g.prototype,"textColor",void 0);a.__decorate([f.property()],
g.prototype,"_textShadowSize",void 0);a.__decorate([f.property()],g.prototype,"_textShadowColor",null);a.__decorate([f.property()],g.prototype,"_textShadow",null);a.__decorate([f.property()],g.prototype,"padding",null);a.__decorate([f.property()],g.prototype,"borderRadius",null);g=a.__decorate([v.subclass("esri.views.overlay.TextOverlayItem")],g);const c={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,
y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},k=[];for(a=0;360>a;a+=22.5)k.push([Math.cos(Math.PI*a/180),Math.sin(Math.PI*a/180)]);return g})},"esri/libs/maquette/h":function(){define(["exports"],
function(a){let b=(g,f,e)=>{for(let n=0,u=f.length;n<u;n++){let v=f[n];Array.isArray(v)?b(g,v,e):null!==v&&void 0!==v&&!1!==v&&("string"===typeof v&&(v={vnodeSelector:"",properties:void 0,children:void 0,text:v.toString(),domNode:null}),e.push(v))}};a.h=function(g,f,e){if(Array.isArray(f))e=f,f=void 0;else if(f&&("string"===typeof f||f.hasOwnProperty("vnodeSelector"))||e&&("string"===typeof e||e.hasOwnProperty("vnodeSelector")))throw Error("h called with invalid arguments");let n,u;e&&1===e.length&&
"string"===typeof e[0]?n=e[0]:e&&(u=[],b(g,e,u),0===u.length&&(u=void 0));return{vnodeSelector:g,properties:f,children:u,text:""===n?void 0:n,domNode:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticLengthMeasurementUtils":function(){define(["exports","../../core/libs/gl-matrix-2/factories/vec3f64","./euclideanLengthMeasurementUtils","./geodesicLengthMeasurementUtils"],function(a,b,g,f){const e=b.create(),n=b.create();a.autoDistance2D=function(u,
v,t){e[0]=u[0];e[1]=u[1];e[2]=3===u.length?u[2]:0;n[0]=v[0];n[1]=v[1];n[2]=3===v.length?v[2]:0;return f.geodesicDistance(e,n,t)??g.euclideanHorizontalDistance(e,n,t)};a.autoDistanceBetweenPoints2D=function(u,v){return f.geodesicDistanceBetweenPoints(u,v)??g.euclideanHorizontalDistanceBetweenPoints(u,v)};a.autoLength2D=function(u){return f.geodesicLength(u)??g.euclideanHorizontalLength(u)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanLengthMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/spatialReferenceUtils ./measurementUtils".split(" "),
function(a,b,g,f,e,n,u,v){function t(x,C){const {hasZ:h,spatialReference:y}=x;var d=v.computeEuclideanMeasurementSR(y);let B=0;d=g.lengthUnitFromSpatialReference(d);if(null==d)return null;C=C===l.Direct?q:c;for(const A of x.paths)if(!(2>A.length)){x=A.length-1;for(let G=0;G<x;++G){var p=A[G];r[0]=p[0];r[1]=p[1];r[2]=h?p[2]:0;p=A[G+1];z[0]=p[0];z[1]=p[1];z[2]=h?p[2]:0;p=C(r,z,y);if(null==p)return null;B+=p.value}}return b.createLength(B,d)}function F(x,C){C=g.verticalLengthUnitFromSpatialReference(C);
return null!=C?b.createLength(x??0,C):null}function E(x,C,h){x=m(x,C,h);return null!=x?{direct:b.createLength(x.direct,x.unit),horizontal:b.createLength(x.horizontal,x.unit),vertical:b.createLength(x.vertical,x.unit)}:null}function q(x,C,h){x=m(x,C,h,l.Direct);return null!=x?b.createLength(x.direct,x.unit):null}function c(x,C,h){x=m(x,C,h,l.Horizontal);return null!=x?b.createLength(x.horizontal,x.unit):null}function k(x,C,h){x=m(x,C,h,l.Vertical);return null!=x?b.createLength(x.verticalSigned,x.unit):
null}function m(x,C,h,y){const d=v.computeEuclideanMeasurementSR(h),B=g.lengthUnitFromSpatialReference(d);if(null==B)return null;const p=C[2]-x[2];if(y===l.Vertical)return{verticalSigned:p,unit:B};if(!n.projectVectorToVector(x,h,H,d)||!n.projectVectorToVector(C,h,D,d))return null;if(y===l.Direct)return{direct:f.distance(D,H),unit:B};f.set(w,x[0],x[1],C[2]);if(!n.projectVectorToVector(w,h,w,d))return null;x=f.distance(w,D);return y===l.Horizontal?{horizontal:x,unit:B}:{direct:f.distance(D,H),horizontal:x,
vertical:Math.abs(p),unit:B}}var l;(function(x){x[x.Direct=0]="Direct";x[x.Horizontal=1]="Horizontal";x[x.Vertical=2]="Vertical"})(l||={});const r=e.create(),z=e.create(),H=e.create(),D=e.create(),w=e.create();a.elevationFromPoint=function(x){return null!=x?F(x.hasZ?x.z:0,x.spatialReference):null};a.elevationFromZ=F;a.euclideanDirectDistance=q;a.euclideanDirectDistanceBetweenPoints=function(x,C){const {spatialReference:h}=x;if(!u.equals(h,C.spatialReference))return null;r[0]=x.x;r[1]=x.y;r[2]=x.hasZ?
x.z:0;z[0]=C.x;z[1]=C.y;z[2]=C.hasZ?C.z:0;return q(r,z,h)};a.euclideanDistance=E;a.euclideanDistanceBetweenPoints=function(x,C){const {spatialReference:h}=x;if(!u.equals(h,C.spatialReference))return null;r[0]=x.x;r[1]=x.y;r[2]=x.hasZ?x.z:0;z[0]=C.x;z[1]=C.y;z[2]=C.hasZ?C.z:0;return E(r,z,h)};a.euclideanHorizontalDistance=c;a.euclideanHorizontalDistanceBetweenPoints=function(x,C){const {spatialReference:h}=x;if(!u.equals(h,C.spatialReference))return null;r[0]=x.x;r[1]=x.y;r[2]=x.hasZ?x.z:0;z[0]=C.x;
z[1]=C.y;z[2]=C.hasZ?C.z:0;return c(r,z,h)};a.euclideanHorizontalLength=function(x){return t(x,l.Horizontal)};a.euclideanLength=function(x){return t(x,l.Direct)};a.verticalDistance=function(x,C,h){x=m(x,C,h,l.Vertical);return null!=x?b.createLength(Math.abs(x.verticalSigned),x.unit):null};a.verticalSignedDistance=k;a.verticalSignedDistanceBetweenPoints=function(x,C){const {spatialReference:h}=x;if(!u.equals(h,C.spatialReference))return null;r[0]=x.x;r[1]=x.y;r[2]=x.hasZ?x.z:0;z[0]=C.x;z[1]=C.y;z[2]=
C.hasZ?C.z:0;return k(r,z,h)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/measurementUtils":function(){define(["exports","../../geometry/ellipsoidUtils","../../geometry/spatialReferenceEllipsoidUtils","../../geometry/support/spatialReferenceUtils"],function(a,b,g,f){a.computeEuclideanMeasurementSR=function(e){return f.isEarth(e)?f.isWGS84(e)||f.isWebMercator(e)||f.isCGCS2000(e)||b.isSphericalECEF(e)?g.WGS84ECEFSpatialReference:e:g.getSphericalPCPF(e)};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicLengthMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/geometryEngine ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils ./geodesicMeasurementUtils".split(" "),function(a,b,g,f,e,n,u){function v(l,r,z){return u.geodesicMeasure(z,t,F,l,r,z)}function t(l,r,z){return b.createLength(e.inverseGeodeticSolver(c,l,r,z).distance,
"meters")}function F(l,r,z){return b.createLength(f.geodesicLength({type:"polyline",spatialReference:z,paths:[[[...l],[...r]]]},"meters"),"meters")}function E(l){return b.createLength(e.geodesicLengths([l],"meters")[0],"meters")}function q(l){return b.createLength(f.geodesicLength(l,"meters"),"meters")}const c=new e.InverseGeodeticSolverResult,k=g.create(),m=g.create();a.geodesicDistance=v;a.geodesicDistanceBetweenPoints=function(l,r){if(!n.equals(l.spatialReference,r.spatialReference))return null;
const {spatialReference:z}=l;k[0]=l.x;k[1]=l.y;k[2]=l.hasZ?l.z:0;m[0]=r.x;m[1]=r.y;m[2]=r.hasZ?r.z:0;return v(k,m,z)};a.geodesicLength=function(l){const {spatialReference:r}=l;return u.geodesicMeasure(r,E,q,l)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ../../core/accessorSupport/ensureType ./geodesicConstants ./spatialReferenceUtils ../SpatialReference ../Polyline ../Polygon ../Point".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){function q(w){if(!w)return null;var x=w.wkid;if(x)return n.spheroids[x];(w=w.wkt2??w.wkt)?(w=n.wktSpheroidRegex.exec(w))&&2===w.length?(x=w[1].split(","),!x||3>x.length?w=null:(w=parseFloat(x[1]),x=parseFloat(x[2]),w=isNaN(w)||isNaN(x)?null:{a:w,f:0===x?0:1/x})):w=null:w=null;return w}function c(w){w=q(w);if(null!=w&&"b"in w&&"eSq"in w&&"radius"in w)return w;const x=w.a*(1-w.f);return Object.assign(w,{b:x,eSq:1-(x/w.a)**2,radius:(2*w.a+x)/3,densificationRatio:1E4/((2*
w.a+x)/3)})}function k(w){return null!=w&&0>w?w+360:w}function m(w,x,C){const {a:h,eSq:y}=c(C);C=Math.sqrt(y);const d=Math.sin(x[1]*n.toRadians);x=h*x[0]*n.toRadians;C=0<y?h*(1-y)*(d/(1-y*d*d)-1/(2*C)*Math.log((1-C*d)/(1+C*d)))*.5:h*d;w[0]=x;w[1]=C;return w}function l(w){return u.isGeographic(w)&&!!q(w)}function r(w,x){if("polyline"!==w.type&&"polygon"!==w.type)throw new g("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:C}=w;if(!l(C))throw new g("geodesic-densify:invalid-spatial-reference",
"the input geometry spatial reference is not supported");var h="polyline"===w.type?w.paths:w.rings;const y=[],d=[0,0],B=new D;for(const G of h){h=[];y.push(h);h.push([G[0][0],G[0][1]]);var p=G[0][0],A=G[0][1];let I,J;for(let L=0;L<G.length-1;L++){I=G[L+1][0];J=G[L+1][1];if(p===I&&A===J)continue;const M=[p,A];H(B,[p,A],[I,J],C);const {azimuth:N,distance:K}=B;p=K/x;if(1<p){for(A=1;A<=p-1;A++)z(d,M,N,A*x,C),h.push(d.slice());z(d,M,N,(K+Math.floor(p-1)*x)/2,C);h.push(d.slice())}z(d,M,N,K,C);h.push(d.slice());
p=d[0];A=d[1]}}x=e.ensureClass(v,C);return"polyline"===w.type?new t({paths:y,spatialReference:x}):new F({rings:y,spatialReference:x})}function z(w,x,C,h,y){const d=x[0]*n.toRadians;x=x[1]*n.toRadians;C=(C??0)*n.toRadians;const {a:B,b:p,f:A}=c(y);y=Math.sin(C);C=Math.cos(C);var G=(1-A)*Math.tan(x);x=1/Math.sqrt(1+G*G);const I=G*x,J=Math.atan2(G,C);G=x*y;const L=G*G;var M=1-L,N=M*(B*B-p*p)/(p*p);const K=1+N/16384*(4096+N*(-768+N*(320-175*N))),O=N/1024*(256+N*(-128+N*(74-47*N)));N=h/(p*K);let U=2*Math.PI,
V,ea,Y,ra;for(;1E-12<Math.abs(N-U);)Y=Math.cos(2*J+N),V=Math.sin(N),ea=Math.cos(N),ra=O*V*(Y+O/4*(ea*(-1+2*Y*Y)-O/6*Y*(-3+4*V*V)*(-3+4*Y*Y))),U=N,N=h/(p*K)+ra;h=I*V-x*ea*C;M=A/16*M*(4+A*(4-3*M));h=Math.atan2(I*ea+x*V*C,(1-A)*Math.sqrt(L+h*h))/n.toRadians;w[0]=(d+(Math.atan2(V*y,x*ea-I*V*C)-(1-M)*A*G*(N+M*V*(Y+M*ea*(-1+2*Y*Y)))))/n.toRadians;w[1]=h;return w}function H(w,x,C,h){var y=x[0]*n.toRadians;x=x[1]*n.toRadians;var d=C[0]*n.toRadians;C=C[1]*n.toRadians;const {a:B,b:p,f:A,radius:G}=c(h),I=d-
y;var J=Math.atan((1-A)*Math.tan(x)),L=Math.atan((1-A)*Math.tan(C));h=Math.sin(J);J=Math.cos(J);const M=Math.sin(L);L=Math.cos(L);let N=1E3,K=I,O,U,V;let ea,Y,ra;do{var R=Math.sin(K);var T=Math.cos(K);V=Math.sqrt(L*R*L*R+(J*M-h*L*T)*(J*M-h*L*T));if(0===V)return w.distance=0,w.azimuth=void 0,w.reverseAzimuth=void 0,w;T=h*M+J*L*T;ea=Math.atan2(V,T);Y=J*L*R/V;U=1-Y*Y;R=T-2*h*M/U;isNaN(R)&&(R=0);ra=A/16*U*(4+A*(4-3*U));O=K;K=I+(1-ra)*A*Y*(ea+ra*V*(R+ra*T*(-1+2*R*R)))}while(1E-12<Math.abs(K-O)&&0<--N);
if(0===N)return h=Math.acos(Math.sin(x)*Math.sin(C)+Math.cos(x)*Math.cos(C)*Math.cos(d-y))*G,y=d-y,w.azimuth=Math.atan2(Math.sin(y)*Math.cos(C),Math.cos(x)*Math.sin(C)-Math.sin(x)*Math.cos(C)*Math.cos(y))/n.toRadians,w.distance=h,w.reverseAzimuth=void 0,w;y=U*(B*B-p*p)/(p*p);x=y/1024*(256+y*(-128+y*(74-47*y)));d=Math.atan2(J*Math.sin(K),J*M*Math.cos(K)-h*L);w.azimuth=Math.atan2(L*Math.sin(K),J*M-h*L*Math.cos(K))/n.toRadians;w.distance=p*(1+y/16384*(4096+y*(-768+y*(320-175*y))))*(ea-x*V*(R+x/4*(T*
(-1+2*R*R)-x/6*R*(-3+4*V*V)*(-3+4*R*R))));w.reverseAzimuth=d/n.toRadians;return w}class D{constructor(w=0,x,C){this.distance=w;this.azimuth=x;this.reverseAzimuth=C}}a.InverseGeodeticSolverResult=D;a.directGeodeticSolver=z;a.geodesicAreas=function(w,x="square-meters"){if(w.some(d=>!l(d.spatialReference)))throw new g("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const C=[];for(var h=0;h<w.length;h++){var y=w[h];const {radius:d,densificationRatio:B}=
c(y.spatialReference);C.push(r(y,d*B))}w=[];h=[0,0];y=[0,0];for(let d=0;d<C.length;d++){const {rings:B,spatialReference:p}=C[d];let A=0;for(let G=0;G<B.length;G++){const I=B[G];m(h,I[0],p);m(y,I[I.length-1],p);let J=y[0]*h[1]-h[0]*y[1];for(let L=0;L<I.length-1;L++)m(h,I[L+1],p),m(y,I[L],p),J+=y[0]*h[1]-h[0]*y[1];A+=J}A=f.convertUnit(A,"square-meters",x);w.push(A/-2)}return w};a.geodesicCompatibleSpatialReference=function(w){return l(w)?w:u.isWebMercator(w)?v.WGS84:null};a.geodesicDensify=r;a.geodesicDistance=
function(w,x,C="meters"){if(!w||!x)throw new g("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!w.spatialReference||!x.spatialReference)throw new g("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!u.equals(w.spatialReference,x.spatialReference))throw new g("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");const {spatialReference:h}=w;if(!l(h))throw new g("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");if(w.x===x.x&&w.y===x.y)return new D(0,0,0);const y=new D;H(y,[w.x,w.y],[x.x,x.y],h);y.distance=f.convertUnit(y.distance,"meters",C);y.azimuth=k(y.azimuth);y.reverseAzimuth=k(y.reverseAzimuth);return y};a.geodesicLengths=function(w,x="meters"){if(!w)throw new g("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(w.some(y=>!l(y.spatialReference)))throw new g("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");
const C=[];for(let y=0;y<w.length;y++){var h=w[y];const {spatialReference:d}=h;h="polyline"===h.type?h.paths:h.rings;let B=0;for(let p=0;p<h.length;p++){const A=h[p];let G=0;for(let I=1;I<A.length;I++){const J=A[I-1][0],L=A[I][0],M=A[I-1][1],N=A[I][1];if(M!==N||J!==L){const K=new D;H(K,[J,M],[L,N],d);G+=K.distance}}B+=G}B=f.convertUnit(B,"meters",x);C.push(B)}return C};a.inverseGeodeticSolver=H;a.isSupported=l;a.pointFromDistance=function(w,x,C){if(!w||null==x||null==C)throw new g("point-from-distance:missing-parameters",
"one or more input parameters are missing or undefined");if(0>C||360<C)throw new g("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!w.spatialReference)throw new g("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:h}=w;if(!l(h))throw new g("geodesic-distance:not-supported","input geometry spatial reference is not supported");const y=[0,0];z(y,[w.x,w.y],
C,x,h);return new E({x:y[0],y:y[1],spatialReference:h})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicMeasurementUtils":function(){define(["exports","../../geometry/support/geodesicUtils","../../geometry/support/spatialReferenceUtils"],function(a,b,g){a.geodesicDistanceThreshold=1E5;a.geodesicMeasure=function(f,e,n,...u){return b.isSupported(f)?e.apply(void 0,u):g.isWebMercator(f)?n.apply(void 0,u):null};a.supportsGeodesicMeasurement=function(f){return b.isSupported(f)||
g.isWebMercator(f)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SnappingVisualizer3D":function(){define("exports ../../../Color ../../../core/colorUtils ../../../core/has ../../../core/handleUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/projection/projectVectorToVector ../../../support/elevationInfoUtils ./support/viewUtils ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../layers/interfaces ../webgl-engine/lib/Material ../../interactive/sketch/normalizedPoint ../../interactive/snapping/Settings ../../interactive/snapping/SnappingDomain ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ../../interactive/snapping/hints/LineSnappingHint".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x){function C(A){({effectiveTheme:A}=A.view);const G=b.toUnitRGBA(A.accentColor),I=[0,0,0,0];return{intersectionPointColor:I,intersectionPointOutlineColor:G,pointColor:I,pointOutlineColor:G,lineColor:G,lineOutlineColor:void 0,parallelSignColor:G,rightAngleColor:G,rightAngleColorDraped:b.toUnitRGBA(g.multiplyOpacity(A.accentColor,.5)),rightAngleOutlineColor:G}}function h(A,G,{selfSnappingZ:I,view:J,spatialReference:L}){return 0!==(G&H.SnappingDomain.SELF)&&
r.isTarget(A)&&null!=I?r.withSelfSnappingZ(A,I,J,L):A}function y(A){return A.isDraped?t.onTheGroundElevationInfo:t.absoluteHeightElevationInfo}function d(A,G,I,J,L,M,N,K=!1,O=!0,U=!0){G=B(G,J,L,M,K);I=B(I,J,L,M,K);M=new E.ExtendedLineVisualElement({view:M,extensionType:E.ExtensionType.FADED,start:G,end:I,isDraped:K,color:N.lineColor,renderOccluded:K?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Opaque,renderGroup:m.DrapedRenderGroup.SnappingHint,isDecoration:!0});switch(A){case D.LineSegmentHintType.TARGET:M.width=
z.defaults.lineHintWidthTarget;M.fadedExtensions={start:0,end:z.defaults.lineHintFadedExtensions};break;case D.LineSegmentHintType.REFERENCE_EXTENSION:M.width=z.defaults.lineHintWidthReference;M.fadedExtensions={start:0,end:0};break;case D.LineSegmentHintType.REFERENCE:M.width=z.defaults.lineHintWidthReference,M.fadedExtensions={start:O?z.defaults.lineHintFadedExtensions:0,end:U?z.defaults.lineHintFadedExtensions:0}}M.attached=!0;return M}function B(A,G,I,J,L){const M=u.create();L?v.projectVectorToVector(A,
G,M,J.basemapTerrain.overlayManager.renderer.spatialReference):F.vectorToRender(A,G,I,J,M);return M}class p extends w.SnappingVisualizer{sortUniqueHints(A){return A.sort((G,I)=>(I instanceof x.LineSnappingHint?I.length:0)-(G instanceof x.LineSnappingHint?G.length:0))}visualizeIntersectionPoint(A,G){const {spatialReference:I,view:J}=G;G=C(G);return e.destroyHandle(new c.PointVisualElement({view:J,primitive:"circle",geometry:r.toDehydratedPoint(A.intersectionPoint,I),elevationInfo:A.isDraped?t.onTheGroundElevationInfo:
t.absoluteHeightElevationInfo,size:20,outlineSize:2,color:G.intersectionPointColor,outlineColor:G.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(A,G){const {view:I,spatialReference:J}=G,L=C(G);G=h(A.point,A.domain,G);return e.destroyHandle(new c.PointVisualElement({view:I,primitive:"circle",geometry:r.toDehydratedPoint(G,J),elevationInfo:y(A),size:20,outlineSize:2,color:L.pointColor,outlineColor:L.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,
attached:!0}))}visualizeLine(A,G){const {view:I,spatialReference:J}=G,L=C(G),M=h(A.lineStart,A.domain,G);G=h(A.lineEnd,A.domain,G);return e.destroyHandle(d(A.type,M,G,J,y(A),I,L,A.isDraped,A.fadeLeft,A.fadeRight))}visualizeParallelSign(A,G){const {view:I,spatialReference:J}=G;var L=C(G);const {isDraped:M}=A;var N=y(A),K=h(A.lineStart,A.domain,G);A=h(A.lineEnd,A.domain,G);K=B(K,J,N,I,M);N=B(A,J,N,I,M);N=n.lerp(N,K,N,.5);L=new q.ParallelLineVisualElement({view:I,attached:!1,offset:z.defaults.parallelLineHintOffset,
length:z.defaults.parallelLineHintLength,width:z.defaults.parallelLineHintWidth,color:L.parallelSignColor,location:N,renderOccluded:M?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Opaque,isDraped:M,renderGroup:m.DrapedRenderGroup.SnappingHint,isDecoration:!0});L.setDirectionFromPoints(K,N);L.attached=!0;return e.destroyHandle(L)}visualizeRightAngleQuad(A,G){const {view:I,spatialReference:J}=G,L=C(G);var M=y(A);const {isDraped:N}=A;var K=h(A.previousVertex,A.domain,G),O=h(A.centerVertex,
A.domain,G);A=h(A.nextVertex,A.domain,G);K=B(K,J,M,I,N);O=B(O,J,M,I,N);M=B(A,J,M,I,N);return e.destroyHandle(new k.RightAngleQuadVisualElement({view:I,attached:!0,color:N?L.rightAngleColorDraped:L.rightAngleColor,renderOccluded:N?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Transparent,outlineRenderOccluded:N?l.RenderOccludedFlag.OccludeAndTransparent:l.RenderOccludedFlag.Opaque,outlineColor:L.rightAngleOutlineColor,outlineSize:z.defaults.rightAngleHintOutlineSize,size:z.defaults.rightAngleHintSize,
isDraped:N,geometry:{previous:K,center:O,next:M},renderGroup:m.DrapedRenderGroup.SnappingHint,isDecoration:!0}))}}a.SnappingVisualizer3D=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ExtendedLineVisualElement":function(){define("exports ../../../../core/has ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/support/clipRay ../../../../geometry/support/frustum ../../../../geometry/support/lineSegment ../../../../geometry/support/ray ./EngineVisualElement ./LaserlineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){function H(d){d.geometries=[]}class D extends E.EngineVisualElement{constructor(d){super(d);this._ray=F.create();this._isWorldDown=!1;this._start=f.create();this._end=f.fromValues(1,0,0);this._width=1;this._color=n.fromValues(1,0,1,1);this._polygonOffset=!1;this._writeDepthEnabled=!0;this._innerWidth=0;this._innerColor=n.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._stipplePreferContinuous=!0;this._falloff=0;this._extensionType=
a.ExtensionType.LINE;this._laserlineStyle=null;this._laserlineEnabled=!1;this._renderOccluded=m.RenderOccludedFlag.OccludeAndTransparent;this._fadedExtensions=y;this._laserline=new q.LaserlineVisualElement({view:this.view,isDecoration:d.isDecoration});this.applyProperties(d)}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(d){return{view:d,createResources:B=>this._createObject3DResources(B),destroyResources:H,recreateGeometry:(B,p)=>this._recreateObject3DGeometry(B,
p),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(d){return{view:d,createResources:()=>this._createDrapedResources(),destroyResources:H,recreateGeometry:B=>this._recreateDrapedGeometry(B)}}updateVisibility(d){super.updateVisibility(d);this._laserline.visible=d}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(d){this._isWorldDown=!0;g.copy(this._start,d);this.view.renderCoordsHelper.worldUpAtPosition(d,this._end);g.subtract(this._end,
d,this._end);F.fromPoints(this._start,this._end,this._ray);this._updateGeometry()}get start(){return this._start}set start(d){this._isWorldDown=!1;g.exactEquals(this._start,d)||(g.copy(this._start,d),F.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(d){this._isWorldDown=!1;g.exactEquals(this._end,d)||(g.copy(this._end,d),F.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(d){d!==this._width&&
(this._width=d,this._updateMaterial())}get color(){return this._color}set color(d){e.exactEquals(d,this._color)||(e.copy(this._color,d),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(d){d!==this._polygonOffset&&(this._polygonOffset=d,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(d){this._writeDepthEnabled!==d&&(this._writeDepthEnabled=d,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(d){d!==
this._innerWidth&&(this._innerWidth=d,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(d){e.exactEquals(d,this._innerColor)||(e.copy(this._innerColor,d),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(d){const B=null!=d!==(null!=this._stipplePattern);this._stipplePattern=d;B?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(d){null!=d&&null!=this._stippleOffColor&&
e.exactEquals(d,this._stippleOffColor)||(this._stippleOffColor=null!=d?n.clone(d):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(d){d!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=d,this._updateMaterial())}get falloff(){return this._falloff}set falloff(d){d!==this._falloff&&(this._falloff=d,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(d){d!==this._extensionType&&
(this._extensionType=d,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(d){this._laserlineStyle=d;this._laserline.attached=this._laserlineAttached;null!=d&&(this._laserline.style=d)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(d){this._laserlineEnabled!==d&&(this._laserlineEnabled=d,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(d){d!==
this._renderOccluded&&(this._renderOccluded=d,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===m.RenderOccludedFlag.OccludeAndTransparentStencil?m.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(d){this._fadedExtensions=d??y;this.recreateGeometry()}_updateMaterial(){const {materialParameters:d}=this;this.object3dResources.resources?.material.setParameters(d);this.drapedResources.resources?.material.setParameters(d)}get materialParameters(){return{width:this._width,
color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(d){const B=new z.RibbonLineMaterial(this.materialParameters),p=[];this._createObject3DGeometry(B,d,p);
return{material:B,geometries:p,forEach:A=>{A(B);p.forEach(A)}}}_recreateObject3DGeometry(d,B){d.geometries.length=0;this._createObject3DGeometry(d.material,B,d.geometries)}_createObject3DGeometry(d,B,p){d=this._createGeometry(d);p.push(d);B.addGeometry(d);this._updateVerticesObject3D(B)}_createDrapedResources(){const d=new z.RibbonLineMaterial(this.materialParameters),B=this._createDrapedGeometry(d);return{material:d,geometries:[B]}}_recreateDrapedGeometry(d){d.geometries=[this._createDrapedGeometry(d.material)]}_createDrapedGeometry(d){d=
this._createGeometry(d);this._updateVerticesDraped(d);return new l.RenderGeometry(d)}_createGeometry(d){const B=this.extensionType===a.ExtensionType.FADED,p=B?[f.create(),f.create(),f.create(),f.create()]:[f.create(),f.create()];return k.createPolylineGeometry(d,p,null,B?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const d=this.object3dResources.object;d&&this._updateVerticesObject3D(d)}}_updateVerticesObject3D(d){const B=
this._lineSegment;this._updateVertexAttributesObject3D(d,B);this._laserline.intersectsLine=B}_updateVerticesDraped(d){this._updateVertexAttributesDraped(d,this._lineSegment)}get _lineSegment(){return this._extensionType===a.ExtensionType.FADED?this._updateLineSegmentFinite(h):this._updateLineSegmentInfinite(this._extensionType,h)}_updateLineSegmentFinite(d){return t.fromPoints(this._start,this._end,d)}_updateLineSegmentInfinite(d,B){var p=this.view.state.camera;u.fromRay(this._ray,w);switch(d){case a.ExtensionType.LINE:w.c0=
-Number.MAX_VALUE;break;case a.ExtensionType.RAY:case a.ExtensionType.GROUND_RAY:var A=this._ray.origin;d=this.view.elevationProvider.getElevation(A[0],A[1],A[2],this.view.renderCoordsHelper.spatialReference,"ground")??0;A=this.view.renderCoordsHelper.getAltitude(A);this._isWorldDown&&A<d&&g.negate(w.ray.direction,w.ray.direction);this._extensionType===a.ExtensionType.GROUND_RAY&&null!=d&&(w.c1=Math.abs(A-d))}if(!v.intersectClipRay(p.frustum,w))return this._updateLineSegmentFinite(B);p=u.getStart(w,
x);d=u.getEnd(w,C);return t.fromPoints(p,d,B)}_updateVertexAttributesObject3D(d,B){const p=d.geometries[0].getMutableAttribute(r.VertexAttribute.POSITION)?.data;if(p){var A=0;for(const G of this._lineVertices(B))p[A++]=G[0],p[A++]=G[1],p[A++]=G[2];d.geometryVertexAttributeUpdated(d.geometries[0],r.VertexAttribute.POSITION)}}_updateVertexAttributesDraped(d,B){const p=d.getMutableAttribute(r.VertexAttribute.POSITION)?.data;if(p){var A=0;for(const G of this._lineVertices(B))p[A++]=G[0],p[A++]=G[1],p[A++]=
c.drapedZ;d.invalidateBoundingInfo()}}*_lineVertices(d){this.extensionType===a.ExtensionType.FADED?(yield t.pointAt(d,-this.fadedExtensions.start,x),yield t.pointAt(d,0,x),yield t.pointAt(d,1,x),yield t.pointAt(d,1+this.fadedExtensions.end,x)):(yield t.pointAt(d,0,x),yield t.pointAt(d,1,x))}}const w=u.create(),x=f.create(),C=f.create(),h=t.create();a.ExtensionType=void 0;(function(d){d[d.LINE=0]="LINE";d[d.RAY=1]="RAY";d[d.GROUND_RAY=2]="GROUND_RAY";d[d.FADED=3]="FADED"})(a.ExtensionType||(a.ExtensionType=
{}));b=1/3;const y={start:b,end:b};a.ExtendedLineVisualElement=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/EngineVisualElement":function(){define(["exports","./DrapedVisualElementResources","./VisualElement","./VisualElementResources"],function(a,b,g,f){class e extends g.VisualElement{constructor(n){super(n);this._isDraped=!1;this.object3dResources=new f.VisualElementResources(this.createObject3DResourceFactory(n.view));this.drapedResources=
new b.DrapedVisualElementResources(this.createDrapedResourceFactory(n.view));this.isDraped=n.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(n){n!==this._isDraped&&(this._isDraped=n,this.object3dResources.attached=this.attached&&!n,this.drapedResources.attached=this.attached&&n)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(n){this.drapedResources.renderGroup=n}createResources(){this.object3dResources.attached=!this._isDraped;this.drapedResources.attached=
this._isDraped}destroyResources(){this.object3dResources.attached=!1;this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate();this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry();this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy();this.drapedResources.destroy();super.destroy()}updateVisibility(n){this.object3dResources.visible=n;this.drapedResources.visible=n}}a.EngineVisualElement=e;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/DrapedVisualElementResources":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Identifiable ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../layers/interfaces ../../webgl-engine/lib/ModelDirtyTypes ../../webgl-engine/lib/UpdatePolicy".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){class c{constructor(m){this._resourceFactory=m;this._resources=null;this._visible=!0;this._attached=!1;this._renderGroup=F.DrapedRenderGroup.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(m){m!==this._visible&&(this._visible=m,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(m){m!==this._attached&&(this._attached=
m,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(m){this._renderGroup=m;const l=this._resources?.layerView;l&&(l.renderGroup=m)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?
null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const m=this._resourceFactory.createResources(),l=new k({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new k({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:m,geometriesAdded:!1};r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(l));this._syncGeometriesToRenderer()}_destroyResources(){if(null!=
this._resources){this._ensureRenderGeometriesRemoved();var m=this._resourceFactory.view.basemapTerrain?.overlayManager;m&&m.unregisterDrapeSource(this._resources.layerView);this._resourceFactory.destroyResources(this._resources.external);this._resources=null}}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,
E.DirtyOperation.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null==this._resources?.drapeSourceRenderer||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,E.DirtyOperation.UPDATE),this._resources.geometriesAdded=!0)}}let k=class extends f.IdentifiableMixin(g){constructor(m){super(m);this.drapeSourceType=F.DrapeSourceType.Features;this.updatePolicy=q.UpdatePolicy.SYNC;this.renderGroup=F.DrapedRenderGroup.Outline}};
b.__decorate([e.property({constructOnly:!0})],k.prototype,"view",void 0);b.__decorate([e.property({readOnly:!0})],k.prototype,"drapeSourceType",void 0);b.__decorate([e.property()],k.prototype,"renderGroup",void 0);k=b.__decorate([t.subclass("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],k);a.DrapedVisualElementResources=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports",
"../../../../core/has","../../../../core/reactiveUtils"],function(a,b,g){class f{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._resourcesCreated=this._attached=this._isDecoration=!1;this._visible=!0;this.view=e.view;this._handle=g.watch(()=>e.view.ready,n=>{this._resourcesCreated&&(n?this._createResources():this._destroyResources())})}applyProperties(e){let n=!1;for(const u in e)u in this&&("attached"===u?n=!!e[u]:this[u]=e[u]);this.attached=
n}destroy(){this.attached=!1;this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&((this._attached=e)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources();this._resourcesCreated=
!0;this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources();this._resourcesCreated=!1}}a.VisualElement=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElementResources":function(){define("exports ../../../../core/reactiveUtils ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,b,g,f,e,n){class u{constructor(v){this._resourceFactory=
v;this._resources=null;this._visible=!0;this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(v){v!==this._visible&&(this._visible=v,this._syncVisible())}get attached(){return this._attached}set attached(v){v!==this._attached&&(this._attached=v,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(this._resourceFactory.recreateGeometry){var v=
this._resourceFactory.view._stage;if(null!=this._resources&&v){var t=this._resources.object;this._resources.external.forEach(F=>{F.type!==g.ContentObjectType.Mesh&&F.type!==g.ContentObjectType.Line&&F.type!==g.ContentObjectType.Point||v.remove(F)});t.removeAllGeometries();this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer);this._resources.external.forEach(F=>{F.type!==g.ContentObjectType.Mesh&&F.type!==g.ContentObjectType.Line&&F.type!==g.ContentObjectType.Point||
v.add(F)})}}else this.recreate()}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();var v=this._resourceFactory;const t=v.view,F=t._stage;if(F){var E=new n.WebGLLayer(F,{pickable:!1,updatePolicy:e.UpdatePolicy.SYNC}),q=new f.Object3D({castShadow:!1}),c=v.createResources(q,E);c.forEach(m=>{F.add(m);m.type===g.ContentObjectType.Texture&&m.load(F.renderView.renderingContext)});F.add(q);E.add(q);var k=
v.cameraChanged;v=k?b.watch(()=>t.state.camera,m=>k(m),b.initial):null;this._resources={layer:E,object:q,external:c,cameraHandle:v};this._syncVisible()}}_destroyResources(){if(null!=this._resources){var v=this._resourceFactory.view._stage;v&&(v.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach(t=>{v.remove(t);t.type===g.ContentObjectType.Texture&&t.unload()}));this._resources.object.dispose();this._resources.cameraHandle?.remove();this._resourceFactory.destroyResources(this._resources.external);
this._resources=null}}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}a.VisualElementResources=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../core/has ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../webgl-engine/effects/laserlines/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),
function(a,b,g,f,e,n,u,v){class t extends n.VisualElement{constructor(E){super(E);this._angleCutoff=v.defaultAngleCutoff;this._style={};this._heightManifoldTarget=f.create();this._heightManifoldEnabled=!1;this._intersectsLine=e.create();this._intersectsLineInfinite=this._intersectsLineEnabled=!1;this._pointDistanceLine=this._pathVerticalPlaneBuffers=this._lineVerticalPlaneSegment=null;this.applyProperties(E)}get testData(){}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer();
this._syncHeightManifold();this._syncIntersectsLine();this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(E){this._angleCutoff!==E&&(this._angleCutoff=E,this._syncAngleCutoff())}get style(){return this._style}set style(E){this._style=E;this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(E){null!=E?(g.copy(this._heightManifoldTarget,
E),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this._syncRenderer();this._syncHeightManifold()}set intersectsWorldUpAtLocation(E){if(null==E)this.intersectsLine=null;else{var q=this.view.renderCoordsHelper.worldUpAtPosition(E,F);this.intersectsLine=e.fromValues(E,q);this.intersectsLineInfinite=!0}}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(E){null!=E?(e.copy(E,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=
!1;this._syncIntersectsLine();this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(E){this._intersectsLineInfinite=E;this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(E){this._lineVerticalPlaneSegment=null!=E?e.copy(E):null;this._syncLineVerticalPlane();this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(E){this._pathVerticalPlaneBuffers=
E;this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance();this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(E){this._pointDistanceLine=null!=E?{origin:f.clone(E.origin),target:E.target?f.clone(E.target):null}:null;this._syncPointDistance();this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?
this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new u.LaserLineRenderer({view:this.view,contrastControlEnabled:!0,isDecoration:this.isDecoration}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff())}_syncStyle(){null!=this._renderer&&(this._renderer.setParameters(this._style),null!=
this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){null!=this._renderer&&this._renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=
this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=
this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null!=this._renderer){var E=this._pointDistanceLine,q=null!=E;this._renderer.pointDistanceEnabled=q&&null!=E.target&&this.visible;q&&(this._renderer.pointDistanceOrigin=E.origin,null!=E.target&&(this._renderer.pointDistanceTarget=E.target))}}_disposeRenderer(){null!=
this._renderer&&this.view._stage&&(this._renderer.destroy(),this._renderer=null)}}const F=f.create();a.LaserlineVisualElement=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/effects/laserlines/LaserLineRenderer":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/has ../../../../../core/maybe ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec32 ../../../../../geometry/support/clipRay ../../../../../geometry/support/frustum ../../../../../geometry/support/lineSegment ../../../../../geometry/support/ray ../../../../ViewingMode ../../../webgl ../../../webgl/RenderNode ../blit/Blit ./LaserlinePathData ./LaserlinePathTechnique ./LaserlinePathTechniqueConfiguration ./LaserlineTechnique ./LaserlineTechniqueConfiguration ../../lib/basicInterfaces ../../materials/internal/MaterialUtil ../../shaders/CompositingTechniqueConfiguration ../../../../webgl/enums".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d){a.LaserLineRenderer=class extends l{constructor(p){super(p);this.produces=m.InternalRenderCategory.LASERLINES;this.consumes={required:[m.InternalRenderCategory.LASERLINES,"normals"]};this.requireGeometryDepth=!0;this._configuration=new x.LaserlineTechniqueConfiguration;this._pathTechniqueConfiguration=new D.LaserlinePathTechniqueConfiguration;this._pathVerticalPlaneEnabled=this._intersectsLineInfinite=this._intersectsLineEnabled=this._lineVerticalPlaneEnabled=
this._pointDistanceEnabled=this._heightManifoldEnabled=!1;this._passParameters=new H.LaserlinePathPassParameters;const A=p.view._stage.renderView.techniques,G=new D.LaserlinePathTechniqueConfiguration;G.contrastControlEnabled=p.contrastControlEnabled;A.precompile(H.LaserlinePathTechnique,G)}initialize(){this._passParameters.renderCoordsHelper=this.view.renderCoordsHelper;this._pathTechniqueConfiguration.spherical=this.view.state.viewingMode===k.ViewingMode.Global;this._pathTechniqueConfiguration.contrastControlEnabled=
this.contrastControlEnabled;this._techniques.precompile(H.LaserlinePathTechnique,this._pathTechniqueConfiguration);this._blit=new r.Blit(this._techniques,y.BlitMode.PremultipliedAlpha)}destroy(){this._pathVerticalPlaneData=f.disposeMaybe(this._pathVerticalPlaneData);this._blit=null}get _techniques(){return this.view._stage.renderView.techniques}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(p){this._heightManifoldEnabled!==p&&(this._heightManifoldEnabled=
p,this.requestRender(C.RenderRequestType.UPDATE))}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(p){t.copy(this._passParameters.heightManifoldTarget,p);this.requestRender(C.RenderRequestType.UPDATE)}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(p){p!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=p,this.requestRender(C.RenderRequestType.UPDATE))}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(p){t.copy(this._passParameters.pointDistanceTarget,
p);this.requestRender(C.RenderRequestType.UPDATE)}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(p){t.copy(this._passParameters.pointDistanceOrigin,p);this.requestRender(C.RenderRequestType.UPDATE)}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(p){p!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=p,this.requestRender(C.RenderRequestType.UPDATE))}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(p){q.copy(p,
this._passParameters.lineVerticalPlaneSegment);this.requestRender(C.RenderRequestType.UPDATE)}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(p){p!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=p,this.requestRender(C.RenderRequestType.UPDATE))}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(p){q.copy(p,this._passParameters.intersectsLineSegment);this.requestRender(C.RenderRequestType.UPDATE)}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(p){p!==
this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=p,this.requestRender(C.RenderRequestType.UPDATE))}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(p){p!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=p,this.requestRender(C.RenderRequestType.UPDATE))}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(p){p!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=
p,null!=this._pathVerticalPlaneData&&this.requestRender(C.RenderRequestType.UPDATE))}set pathVerticalPlaneVertices(p){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new z.LaserlinePathData(this._passParameters.renderCoordsHelper));this._pathVerticalPlaneData.vertices=p;this.pathVerticalPlaneEnabled&&this.requestRender(C.RenderRequestType.UPDATE)}set pathVerticalPlaneBuffers(p){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new z.LaserlinePathData(this._passParameters.renderCoordsHelper));
this._pathVerticalPlaneData.buffers=p;this.pathVerticalPlaneEnabled&&this.requestRender(C.RenderRequestType.UPDATE)}setParameters(p){h.updateParameters(this._passParameters,p)&&this.requestRender(C.RenderRequestType.UPDATE)}precompile(){this._acquireTechnique().release()}render(p){const A=p.find(({name:J})=>J===m.InternalRenderCategory.LASERLINES);if(!this.bindParameters.decorations||null==this._blit)return A;const G=this.renderingContext;p=p.find(({name:J})=>"normals"===J);this._passParameters.normals=
p?.getTexture();p=()=>{(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified();this.pathVerticalPlaneEnabled&&this._renderPath()};if(!this.contrastControlEnabled)return G.bindFramebuffer(A.fbo),p(),A;this._passParameters.colors=A.getTexture();const I=this.fboCache.acquire(A.fbo.width,A.fbo.height,"laser lines");G.bindFramebuffer(I.fbo);G.setClearColor(0,0,0,0);G.clear(d.FramebufferBit.COLOR|d.FramebufferBit.DEPTH);p();
G.unbindTexture(A.getTexture());this._blit.blend(G,I,A,this.bindParameters)||this.requestRender(C.RenderRequestType.UPDATE);I.release();return A}_acquireTechnique(){this._configuration.heightManifoldEnabled=this.heightManifoldEnabled;this._configuration.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled;this._configuration.pointDistanceEnabled=this.pointDistanceEnabled;this._configuration.intersectsLineEnabled=this.intersectsLineEnabled;this._configuration.contrastControlEnabled=this.contrastControlEnabled;
this._configuration.spherical=this.view.state.viewingMode===k.ViewingMode.Global;return this._techniques.acquire(w.LaserlineTechnique,this._configuration)}_renderUnified(){if(this._updatePassParameters()){var p=this._acquireTechnique();if(p.compiled){const A=this.renderingContext;A.bindTechnique(p,this.bindParameters,this._passParameters);A.screen.draw()}else this.requestRender(C.RenderRequestType.UPDATE);p.release()}}_renderPath(){if(null!=this._pathVerticalPlaneData){var p=this._techniques.acquire(H.LaserlinePathTechnique,
this._pathTechniqueConfiguration);if(p.compiled){const A=this.renderingContext;this._passParameters.origin=this._pathVerticalPlaneData.origin;A.bindTechnique(p,this.bindParameters,this._passParameters);this._pathVerticalPlaneData.draw(A)}else this.requestRender(C.RenderRequestType.UPDATE);p.release()}}_updatePassParameters(){if(!this._intersectsLineEnabled)return!0;const p=this.bindParameters.camera,A=this._passParameters;if(this._intersectsLineInfinite){F.fromRay(c.wrap(A.intersectsLineSegment.origin,
A.intersectsLineSegment.vector),B);B.c0=-Number.MAX_VALUE;if(!E.intersectClipRay(p.frustum,B))return!1;F.getStart(B,A.lineStartWorld);F.getEnd(B,A.lineEndWorld)}else t.copy(A.lineStartWorld,A.intersectsLineSegment.origin),t.add(A.lineEndWorld,A.intersectsLineSegment.origin,A.intersectsLineSegment.vector);return!0}get test(){}};b.__decorate([e.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"contrastControlEnabled",void 0);b.__decorate([e.property({constructOnly:!0})],a.LaserLineRenderer.prototype,
"isDecoration",void 0);b.__decorate([e.property()],a.LaserLineRenderer.prototype,"produces",void 0);b.__decorate([e.property()],a.LaserLineRenderer.prototype,"consumes",void 0);a.LaserLineRenderer=b.__decorate([v.subclass("esri.views.3d.webgl-engine.effects.laserlines.LaserLineRenderer")],a.LaserLineRenderer);const B=F.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/effects/laserlines/LaserlinePathData":function(){define("exports ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/DoubleArray ../../../../ViewingMode ../../../support/buffer/glUtil ../../../support/buffer/InterleavedLayout ./LaserlinePathTechnique ../../lib/VertexArrayObject ../../lib/VertexAttribute ../../../../webgl/BufferObject ../../../../webgl/enums".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){class c{constructor(z){this._renderCoordsHelper=z;this._buffers=null;this._origin=g.create();this._dirty=!1;this._count=0;this._vao=null}set vertices(z){const H=f.newDoubleArray(3*z.length);let D=0;for(const w of z)H[D++]=w[0],H[D++]=w[1],H[D++]=w[2];this.buffers=[H]}set buffers(z){this._buffers=z;if(0<this._buffers.length){z=this._buffers[0];const H=3*Math.floor(z.length/3/2);b.set(this._origin,z[H],z[H+1],z[H+2])}else b.set(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(z){const H=
this._ensureVAO(z);null!=H&&(z.bindVAO(H),z.drawArrays(q.PrimitiveType.TRIANGLES,0,this._count))}dispose(){null!=this._vao&&this._vao.dispose()}get _layout(){return this._renderCoordsHelper.viewingMode===e.ViewingMode.Global?l:r}_ensureVAO(z){if(null==this._buffers)return null;this._vao??(this._vao=this._createVAO(z,this._buffers));this._ensureVertexData(this._vao,this._buffers);return this._vao}_createVAO(z,H){H=this._createDataBuffer(H);this._dirty=!1;return new t.VertexArrayObject(z,v.vertexAttributeLocations,
new Map([["data",n.glLayout(this._layout)]]),new Map([["data",E.BufferObject.createVertex(z,q.Usage.STATIC_DRAW,H)]]))}_ensureVertexData(z,H){this._dirty&&(H=this._createDataBuffer(H),z.vertexBuffers.get("data")?.setData(H),this._dirty=!1)}_createDataBuffer(z){var H=z.reduce((d,B)=>d+6*(B.length/3-1),0);this._count=H;H=this._layout.createBuffer(H);const D=this._origin;let w=0,x=0;const C="startUp"in H?this._setUpVectors.bind(this,H):void 0;for(const d of z){for(z=0;z<d.length;z+=3){var h=b.set(m,
d[z],d[z+1],d[z+2]);0===z?x=this._renderCoordsHelper.getAltitude(h):this._renderCoordsHelper.setAltitude(h,x);const B=w+2*z;C?.(z,B,d,h);h=b.subtract(m,h,D);if(z<d.length-3){for(var y=0;6>y;y++)H.start.setVec(B+y,h);H.extrude.setValues(B,0,-1);H.extrude.setValues(B+1,1,-1);H.extrude.setValues(B+2,1,1);H.extrude.setValues(B+3,0,-1);H.extrude.setValues(B+4,1,1);H.extrude.setValues(B+5,0,1)}if(0<z)for(y=-6;0>y;y++)H.end.setVec(B+y,h)}w+=6*(d.length/3-1)}return H.buffer}_setUpVectors(z,H,D,w,x){x=this._renderCoordsHelper.worldUpAtPosition(x,
k);if(H<w.length-3)for(w=0;6>w;w++)z.startUp.setVec(D+w,x);if(0<H)for(H=-6;0>H;H++)z.endUp.setVec(D+H,x)}}const k=g.create(),m=g.create(),l=u.newLayout().vec3f(F.VertexAttribute.START).vec3f(F.VertexAttribute.END).vec2f(F.VertexAttribute.EXTRUDE).vec3f(F.VertexAttribute.START_UP).vec3f(F.VertexAttribute.END_UP),r=u.newLayout().vec3f(F.VertexAttribute.START).vec3f(F.VertexAttribute.END).vec2f(F.VertexAttribute.EXTRUDE);a.LaserlinePathData=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/webgl-engine/effects/laserlines/LaserlinePathTechnique":function(){define("require exports ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../core/shaderTechnique/ReloadableShaderModule ../../core/shaderTechnique/ShaderTechnique ./LaserlineTechnique ../../lib/VertexAttribute ../../../../../chunks/LaserlinePath.glsl".split(" "),function(a,b,g,f,e,n,u,v){class t extends n.LaserlinePassParameters{constructor(){super(...arguments);this.origin=g.create()}}class F extends e.ShaderTechnique{constructor(q,
c,k){super(q,c,new f.ReloadableShaderModule(v.LaserlinePath,()=>new Promise((m,l)=>a(["../../shaders/LaserlinePath.glsl"],m,l))),k,E)}}const E=new Map([[u.VertexAttribute.START,0],[u.VertexAttribute.END,1],[u.VertexAttribute.EXTRUDE,2],[u.VertexAttribute.START_UP,3],[u.VertexAttribute.END_UP,4]]);b.LaserlinePathPassParameters=t;b.LaserlinePathTechnique=F;b.vertexAttributeLocations=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/effects/laserlines/LaserlineTechnique":function(){define("require exports ../../../../../core/mathUtils ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/lineSegment ../../core/shaderModules/interfaces ../../core/shaderTechnique/ReloadableShaderModule ../../core/shaderTechnique/ShaderTechnique ../../../../../chunks/Laserlines.glsl".split(" "),
function(a,b,g,f,e,n,u,v,t){class F extends n.NoParameters{constructor(){super(...arguments);this.innerColor=f.fromValues(1,1,1);this.innerWidth=1;this.glowColor=f.fromValues(1,.5,0);this.glowFalloff=this.glowWidth=8;this.globalAlpha=.75;this.globalAlphaContrastBoost=2;this.angleCutoff=g.deg2rad(6);this.pointDistanceOrigin=f.create();this.pointDistanceTarget=f.create();this.lineVerticalPlaneSegment=e.create();this.intersectsLineSegment=e.create();this.intersectsLineRadius=3;this.heightManifoldTarget=
f.create();this.lineStartWorld=f.create();this.lineEndWorld=f.create()}}class E extends v.ShaderTechnique{constructor(q,c,k){super(q,c,new u.ReloadableShaderModule(t.Laserlines,()=>new Promise((m,l)=>a(["../../shaders/Laserlines.glsl"],m,l))),k)}}b.LaserlinePassParameters=F;b.LaserlineTechnique=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../core/libs/gl-matrix-2/math/vec2 ../core/libs/gl-matrix-2/factories/vec2f64 ./vec32 ../core/libs/gl-matrix-2/factories/vec3f64 ./vec42 ../core/libs/gl-matrix-2/factories/vec4f64 ../geometry/support/lineSegment ../geometry/support/plane ./sphere ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H){function D(J){const L=new H.ShaderBuilder;L.include(c.ScreenSpacePass);L.include(q.Laserline,J);const M=L.fragment;if(J.lineVerticalPlaneEnabled||J.heightManifoldEnabled)M.uniforms.add(new r.FloatPassUniform("maxPixelDistance",(N,K)=>J.heightManifoldEnabled?2*K.camera.computeScreenPixelSizeAt(N.heightManifoldTarget):2*K.camera.computeScreenPixelSizeAt(N.lineVerticalPlaneSegment.origin))),M.code.add(z.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),J.spherical?(M.uniforms.add(new l.Float4PassUniform("heightManifoldOrigin",(N,K)=>{e.transformMat4(y,N.heightManifoldTarget,K.camera.viewMatrix);e.transformMat4(p,[0,0,0],K.camera.viewMatrix);e.subtract(p,p,y);e.normalize(d,p);d[3]=e.length(p);return d}),new m.Float3PassUniform("globalOrigin",(N,K)=>e.transformMat4(y,[0,0,0],K.camera.viewMatrix)),new r.FloatPassUniform("cosSphericalAngleThreshold",(N,K)=>1-Math.max(2,e.distance(K.camera.eye,N.heightManifoldTarget)*K.camera.perRenderPixelRatio)/
e.length(N.heightManifoldTarget))),M.code.add(z.glsl`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)):M.code.add(z.glsl`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);J.pointDistanceEnabled&&(M.uniforms.add(new r.FloatPassUniform("maxPixelDistance",(N,K)=>2*K.camera.computeScreenPixelSizeAt(N.pointDistanceTarget))),M.code.add(z.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`));J.intersectsLineEnabled&&(M.uniforms.add(new r.FloatPassUniform("perScreenPixelRatio",(N,K)=>K.camera.perScreenPixelRatio)),M.code.add(z.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`));(J.lineVerticalPlaneEnabled||J.intersectsLineEnabled)&&M.code.add(z.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);M.main.add(z.glsl`vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
fragColor = vec4(0.0);
return;
}
vec4 color = vec4(0.0);`);if(J.heightManifoldEnabled){M.uniforms.add(new k.Float2PassUniform("angleCutoff",K=>w(K)),new l.Float4PassUniform("heightPlane",(K,O)=>x(K.heightManifoldTarget,K.renderCoordsHelper.worldUpAtPosition(K.heightManifoldTarget,y),O.camera.viewMatrix)));const N=J.spherical?z.glsl`normalize(globalOrigin - pos)`:z.glsl`heightPlane.xyz`;M.main.add(z.glsl`
      vec2 angleCutoffAdjusted = angleCutoff - angleCutoffAdjust;
      // Fade out laserlines on flat surfaces
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoffAdjusted.x, angleCutoffAdjusted.y, abs(dot(normal, ${N})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);`)}J.pointDistanceEnabled&&(M.uniforms.add(new k.Float2PassUniform("angleCutoff",N=>w(N)),new l.Float4PassUniform("pointDistanceSphere",(N,K)=>{e.transformMat4(E.getCenter(I),N.pointDistanceOrigin,K.camera.viewMatrix);I[3]=e.distance(N.pointDistanceOrigin,N.pointDistanceTarget);return I})),M.main.add(z.glsl`float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);`));J.lineVerticalPlaneEnabled&&(M.uniforms.add(new k.Float2PassUniform("angleCutoff",N=>w(N)),new l.Float4PassUniform("lineVerticalPlane",(N,K)=>{var O=t.pointAt(N.lineVerticalPlaneSegment,.5,y);O=N.renderCoordsHelper.worldUpAtPosition(O,B);const U=e.normalize(p,N.lineVerticalPlaneSegment.vector);O=e.cross(y,O,U);e.normalize(O,O);return x(N.lineVerticalPlaneSegment.origin,O,K.camera.viewMatrix)}),new m.Float3PassUniform("lineVerticalStart",
(N,K)=>{const O=e.copy(y,N.lineVerticalPlaneSegment.origin);N.renderCoordsHelper.setAltitude(O,0);return e.transformMat4(O,O,K.camera.viewMatrix)}),new m.Float3PassUniform("lineVerticalEnd",(N,K)=>{const O=e.add(y,N.lineVerticalPlaneSegment.origin,N.lineVerticalPlaneSegment.vector);N.renderCoordsHelper.setAltitude(O,0);return e.transformMat4(O,O,K.camera.viewMatrix)})),M.main.add(z.glsl`if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}`));J.intersectsLineEnabled&&(M.uniforms.add(new k.Float2PassUniform("angleCutoff",N=>w(N)),new m.Float3PassUniform("intersectsLineStart",(N,K)=>e.transformMat4(y,N.lineStartWorld,K.camera.viewMatrix)),new m.Float3PassUniform("intersectsLineEnd",(N,K)=>e.transformMat4(y,N.lineEndWorld,K.camera.viewMatrix)),new m.Float3PassUniform("intersectsLineDirection",(N,K)=>{e.copy(d,N.intersectsLineSegment.vector);d[3]=0;return e.normalize(y,u.transformMat4(d,d,K.camera.viewMatrix))}),new r.FloatPassUniform("intersectsLineRadius",
N=>N.intersectsLineRadius)),M.main.add(z.glsl`if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}`));M.main.add(z.glsl`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);`);return L}function w(J){return g.set(h,Math.cos(J.angleCutoff),Math.cos(Math.max(0,J.angleCutoff-b.deg2rad(2))))}function x(J,L,M){e.transformMat4(A,J,M);e.copy(d,L);d[3]=0;u.transformMat4(d,d,M);return F.fromPositionAndNormal(A,d,G)}const C=b.deg2rad(6),h=f.create(),y=n.create(),d=v.create(),B=n.create(),p=n.create(),A=n.create(),G=F.create(),I=E.create();f=Object.freeze(Object.defineProperty({__proto__:null,build:D,
defaultAngleCutoff:C},Symbol.toStringTag,{value:"Module"}));a.Laserlines=f;a.build=D;a.defaultAngleCutoff=C})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define("exports ./output/ReadDepth.glsl ./util/CameraSpace.glsl ../shaderModules/Float3PassUniform ../shaderModules/FloatPassUniform ../shaderModules/interfaces ../shaderModules/Texture2DPassUniform".split(" "),function(a,b,g,f,e,n,u){a.Laserline=function(v,t){const F=v.fragment;F.include(b.ReadDepth);v.include(g.CameraSpace);
F.uniforms.add(new e.FloatPassUniform("globalAlpha",E=>E.globalAlpha),new f.Float3PassUniform("glowColor",E=>E.glowColor),new e.FloatPassUniform("glowWidth",(E,q)=>E.glowWidth*q.camera.pixelRatio),new e.FloatPassUniform("glowFalloff",E=>E.glowFalloff),new f.Float3PassUniform("innerColor",E=>E.innerColor),new e.FloatPassUniform("innerWidth",(E,q)=>E.innerWidth*q.camera.pixelRatio),new u.Texture2DPassUniform("depthMap",(E,q)=>q.depth?.attachment),new u.Texture2DPassUniform("normalMap",E=>E.normals));
F.code.add(n.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);F.code.add(n.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);F.code.add(n.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);F.code.add(n.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float angleCutoffAdjust, out float depthDiscontinuityAlpha) {
float depth = depthFromTexture(depthMap, uv);
if (depth == 1.0) {
return false;
}
float linearDepth = linearizeDepth(depth);
pos = reconstructPosition(gl_FragCoord.xy, linearDepth);
float minStep = 6e-8;
float depthStep = clamp(depth + minStep, 0.0, 1.0);
float linearDepthStep = linearizeDepth(depthStep);
float depthError = abs(linearDepthStep - linearDepth);
if (depthError > 0.2) {
normal = texture(normalMap, uv).xyz * 2.0 - 1.0;
angleCutoffAdjust = 0.004;
} else {
normal = normalize(cross(dFdx(pos), dFdy(pos)));
angleCutoffAdjust = 0.0;
}
float ddepth = fwidth(linearDepth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / linearDepth);
return true;
}`);t.contrastControlEnabled?(F.uniforms.add(new u.Texture2DPassUniform("frameColor",(E,q)=>E.colors),new e.FloatPassUniform("globalAlphaContrastBoost",E=>null!=E.globalAlphaContrastBoost?E.globalAlphaContrastBoost:1)),F.code.add(n.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):F.code.add(n.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/LaserlinePath.glsl":function(){define("exports ../core/libs/gl-matrix-2/math/mat4 ../core/libs/gl-matrix-2/factories/mat4f64 ../core/libs/gl-matrix-2/math/vec2 ../core/libs/gl-matrix-2/factories/vec2f64 ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){function c(l){const r=new E.ShaderBuilder;r.include(n.Laserline,l);const {vertex:z,fragment:H}=r;z.uniforms.add(new F.Matrix4PassUniform("modelView",(D,{camera:w})=>b.translate(m,w.viewMatrix,D.origin)),new F.Matrix4PassUniform("proj",(D,{camera:w})=>w.projectionMatrix),new v.FloatPassUniform("glowWidth",(D,{camera:w})=>D.glowWidth*w.pixelRatio),new u.Float2PassUniform("pixelToNDC",(D,{camera:w})=>f.set(k,2/w.fullViewport[2],2/w.fullViewport[3])));r.attributes.add(q.VertexAttribute.START,
"vec3");r.attributes.add(q.VertexAttribute.END,"vec3");l.spherical&&(r.attributes.add(q.VertexAttribute.START_UP,"vec3"),r.attributes.add(q.VertexAttribute.END_UP,"vec3"));r.attributes.add(q.VertexAttribute.EXTRUDE,"vec2");r.varyings.add("uv","vec2");r.varyings.add("vViewStart","vec3");r.varyings.add("vViewEnd","vec3");r.varyings.add("vViewSegmentNormal","vec3");r.varyings.add("vViewStartNormal","vec3");r.varyings.add("vViewEndNormal","vec3");l=!l.spherical;z.main.add(t.glsl`
    vec3 pos = mix(start, end, extrude.x);

    vec4 viewPos = modelView * vec4(pos, 1);
    vec4 projPos = proj * viewPos;
    vec2 ndcPos = projPos.xy / projPos.w;

    // in planar we hardcode the up vectors to be Z-up */
    ${t.If(l,t.glsl`vec3 startUp = vec3(0, 0, 1);`)}
    ${t.If(l,t.glsl`vec3 endUp = vec3(0, 0, 1);`)}

    // up vector corresponding to the location of the vertex, selecting either startUp or endUp */
    vec3 up = extrude.y * mix(startUp, endUp, extrude.x);
    vec3 viewUp = (modelView * vec4(up, 0)).xyz;

    vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
    vec2 projUp = normalize(projPosUp.xy / projPosUp.w - ndcPos);

    // extrude ndcPos along projUp to the edge of the screen
    vec2 lxy = abs(sign(projUp) - ndcPos);
    ndcPos += length(lxy) * projUp;

    vViewStart = (modelView * vec4(start, 1)).xyz;
    vViewEnd = (modelView * vec4(end, 1)).xyz;

    vec3 viewStartEndDir = vViewEnd - vViewStart;

    vec3 viewStartUp = (modelView * vec4(startUp, 0)).xyz;

    // the normal of the plane that aligns with the segment and the up vector
    vViewSegmentNormal = normalize(cross(viewStartUp, viewStartEndDir));

    // the normal orthogonal to the segment normal and the start up vector
    vViewStartNormal = -normalize(cross(vViewSegmentNormal, viewStartUp));

    // the normal orthogonal to the segment normal and the end up vector
    vec3 viewEndUp = (modelView * vec4(endUp, 0)).xyz;
    vViewEndNormal = normalize(cross(vViewSegmentNormal, viewEndUp));

    // Add enough padding in the X screen space direction for "glow"
    float xPaddingPixels = sign(dot(vViewSegmentNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
    ndcPos.x += xPaddingPixels * pixelToNDC.x;

    // uv is used to read back depth to reconstruct the position at the fragment
    uv = ndcPos * 0.5 + 0.5;

    gl_Position = vec4(ndcPos, 0, 1);
  `);H.uniforms.add(new v.FloatPassUniform("perScreenPixelRatio",(D,w)=>w.camera.perScreenPixelRatio));H.code.add(t.glsl`float planeDistance(vec3 planeNormal, vec3 planeOrigin, vec3 pos) {
return dot(planeNormal, pos - planeOrigin);
}
float segmentDistancePixels(vec3 segmentNormal, vec3 startNormal, vec3 endNormal, vec3 pos, vec3 start, vec3 end) {
float distSegmentPlane = planeDistance(segmentNormal, start, pos);
float distStartPlane = planeDistance(startNormal, start, pos);
float distEndPlane = planeDistance(endNormal, end, pos);
float dist = max(max(distStartPlane, distEndPlane), abs(distSegmentPlane));
float width = fwidth(distSegmentPlane);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}`);H.main.add(t.glsl`fragColor = vec4(0.0);
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
return;
}
vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
return;
}
float distance = segmentDistancePixels(
vViewSegmentNormal,
vViewStartNormal,
vViewEndNormal,
pos,
vViewStart,
vViewEnd
);
vec4 color = laserlineProfile(distance);
float alpha = (1.0 - smoothstep(0.995 - angleCutoffAdjust, 0.999 - angleCutoffAdjust, abs(dot(normal, vViewSegmentNormal))));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);`);return r}const k=e.create(),m=g.create();g=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}));a.LaserlinePath=g;a.build=c})},"esri/views/3d/webgl-engine/effects/laserlines/LaserlinePathTechniqueConfiguration":function(){define(["exports","../../../../../chunks/tslib.es6","../../core/shaderTechnique/ShaderTechniqueConfiguration"],function(a,b,g){class f extends g.ShaderTechniqueConfiguration{constructor(){super(...arguments);
this.spherical=this.contrastControlEnabled=!1}}b.__decorate([g.parameter()],f.prototype,"contrastControlEnabled",void 0);b.__decorate([g.parameter()],f.prototype,"spherical",void 0);a.LaserlinePathTechniqueConfiguration=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/effects/laserlines/LaserlineTechniqueConfiguration":function(){define(["exports","../../../../../chunks/tslib.es6","../../core/shaderTechnique/ShaderTechniqueConfiguration","./LaserlinePathTechniqueConfiguration"],
function(a,b,g,f){class e extends f.LaserlinePathTechniqueConfiguration{constructor(){super(...arguments);this.intersectsLineEnabled=this.lineVerticalPlaneEnabled=this.pointDistanceEnabled=this.heightManifoldEnabled=!1}}b.__decorate([g.parameter()],e.prototype,"heightManifoldEnabled",void 0);b.__decorate([g.parameter()],e.prototype,"pointDistanceEnabled",void 0);b.__decorate([g.parameter()],e.prototype,"lineVerticalPlaneEnabled",void 0);b.__decorate([g.parameter()],e.prototype,"intersectsLineEnabled",
void 0);a.LaserlineTechniqueConfiguration=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ParallelLineVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r){function z(G){return[c.createPolylineGeometry(G,[u.create(),u.create()]),c.createPolylineGeometry(G,[u.create(),u.create()])]}function H(G,I,J,L,M,N){J=f.scale(h,f.set(h,G[1]*J,G[0]*-J),L+M/2);I=f.add(y,f.add(y,f.add(y,I,f.scale(y,G,N/2)),J),J);G=f.add(d,I,f.scale(d,G,-N));return{start:I,end:G}}function D(G){G.geometries.length=0}function w(G){G.pixelRatioHandle.remove();G.geometries=[]}class x extends E.EngineVisualElement{constructor(G){super(G);this._location=
u.create();this._direction=u.fromValues(1,0,0);this._offset=this._width=1;this._length=18;this._color=t.fromValues(1,0,1,1);this._renderOccluded=k.RenderOccludedFlag.OccludeAndTransparent;this.applyProperties(G)}createObject3DResourceFactory(G){return{view:G,createResources:I=>this._createObject3DResources(I),destroyResources:D,recreateGeometry:(I,J)=>this._recreateObject3DGeometry(I,J),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(G){return{view:G,createResources:()=>this._createDrapedResources(),
destroyResources:w,recreateGeometry:I=>this._recreateDrapedGeometry(I)}}get location(){return this._location}set location(G){n.exactEquals(this._location,G)||(n.copy(this._location,G),this._updateGeometry())}get direction(){return this._direction}set direction(G){n.exactEquals(this._direction,G)||(n.copy(this._direction,G),this._updateGeometry())}setDirectionFromPoints(G,I){n.normalize(this._direction,n.subtract(this._direction,I,G));this._updateGeometry()}get width(){return this._width}set width(G){G!==
this._width&&(this._width=G,this._updateMaterial())}get offset(){return this._offset}set offset(G){G!==this._offset&&(this._offset=G,this._updateGeometry())}get length(){return this._length}set length(G){G!==this._length&&(this._length=G,this._updateGeometry())}get color(){return this._color}set color(G){v.exactEquals(G,this._color)||(v.copy(this._color,G),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(G){G!==this._renderOccluded&&(this._renderOccluded=
G,this._updateMaterial())}_createObject3DResources(G){const I=new r.RibbonLineMaterial(this.materialParameters),J=[];this._createObject3DGeometry(I,G,J);return{material:I,geometries:J,forEach:L=>{L(I);J.forEach(L)}}}_recreateObject3DGeometry(G,I){G.geometries.length=0;this._createObject3DGeometry(G.material,I,G.geometries)}_createObject3DGeometry(G,I,J){const [L,M]=z(G);I.addGeometry(L);I.addGeometry(M);J.push(L);J.push(M);this._updateVerticesObject3D(I)}_createDrapedResources(){const G=new r.RibbonLineMaterial(this.materialParameters),
I=b.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});return{material:G,geometries:this._createDrapedGeometry(G),pixelRatioHandle:I}}_recreateDrapedGeometry(G){G.geometries=this._createDrapedGeometry(G.material)}_createDrapedGeometry(G){G=z(G);this._updateVerticesDraped(G);return G.map(I=>new m.RenderGeometry(I))}_updateMaterial(){const {materialParameters:G}=this;this.object3dResources.resources?.material.setParameters(G);this.drapedResources.resources?.material.setParameters(G)}get materialParameters(){return{width:this._width,
color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const G=this.object3dResources.object;G&&this._updateVerticesObject3D(G)}}_updateVerticesObject3D(G){const I=this.view.state.camera;I.projectToScreen(this.location,B);n.add(C,this.location,this.direction);I.projectToScreen(C,p);f.normalize(p,f.subtract(p,p,B));this._updateVertexAttributesObject3D(I,G,0,B,p,1);this._updateVertexAttributesObject3D(I,
G,1,B,p,-1)}_updateVertexAttributesObject3D(G,I,J,L,M,N){J=I.geometries[J];const K=J.getMutableAttribute(l.VertexAttribute.POSITION)?.data;if(K){var {start:O,end:U}=H(M,L,N,this.offset,this.width,this.length);G.unprojectFromScreen(g.castScreenPointArray(O),C);K[0]=C[0];K[1]=C[1];K[2]=C[2];G.unprojectFromScreen(g.castScreenPointArray(U),C);K[3]=C[0];K[4]=C[1];K[5]=C[2];I.geometryVertexAttributeUpdated(J,l.VertexAttribute.POSITION)}}_updateVerticesDraped(G){const {view:{basemapTerrain:{overlayManager:I},
state:{contentPixelRatio:J}}}=this,{location:L,width:M,length:N,offset:K}=this;var O=A;O.spatialReference=I.renderer.spatialReference;O.x=L[0];O.y=L[1];var U=this.view.overlayPixelSizeInMapUnits(O)*J;O=M*U;const V=N*U;U*=K;this._updateVertexAttributesDraped(G[0],O,V,U,-1);this._updateVertexAttributesDraped(G[1],O,V,U,1)}_updateVertexAttributesDraped(G,I,J,L,M){const N=G.getMutableAttribute(l.VertexAttribute.POSITION)?.data;if(N){var {location:K,direction:O}=this,{start:U,end:V}=H(O,K,M,L,I,J);N[0]=
U[0];N[1]=U[1];N[2]=q.drapedZ;N[3]=V[0];N[4]=V[1];N[5]=q.drapedZ;G.invalidateBoundingInfo()}}}const C=u.create(),h=e.create(),y=e.create(),d=e.create(),B=g.createScreenPointArray(),p=g.createScreenPointArray(),A=F.makeDehydratedPoint(0,0,void 0,null);a.ParallelLineVisualElement=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/PointVisualElement":function(){define("exports ../../../../core/mathUtils ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ../../../ViewingMode ./Object3DVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r){class z extends E.Object3DVisualElement{constructor(x){super(x);this._geometry=this._texture=this._material=null;this._size=3;this._color=n.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=n.fromValues(1,1,1,1);this._elevationInfo=null;this.applyProperties(x)}get geometry(){return this._geometry}set geometry(x){this._geometry=x;this.recreateGeometry()}get size(){return this._size}set size(x){if(x!==
this._size){const C=this._preferredTextureSize;this._size=x;C<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(x){e.exactEquals(x,this._color)||(e.copy(this._color,x),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(x){this._pixelSnappingEnabled!==x&&(this._pixelSnappingEnabled=x,this._updateMaterial())}get primitive(){return this._primitive}set primitive(x){this._primitive!==
x&&(this._primitive=x,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(x){x!==this._outlineSize&&(this._outlineSize=x,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(x){e.exactEquals(x,this._outlineColor)||(e.copy(this._outlineColor,x),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(x){this._elevationInfo=x;this.recreateGeometry()}_updateMaterial(){this._material?.setParameters(this._materialParameters)}_updateSizeAttribute(){const x=
this.object;if(null!=x){var C=x.geometries[0];if(null!=C){C=C.getMutableAttribute(l.VertexAttribute.SIZE).data;var h=this._geometrySize;C[0]=h;C[1]=h;x.geometryVertexAttributeUpdated(x.geometries[0],l.VertexAttribute.SIZE)}}}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:k.requiresHalfTexelOffset(this._primitive),distanceFieldBoundingBox:D,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,
polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/H}createExternalResources(){this._texture=k.createTexture(this._primitive,this._preferredTextureSize);this._material=new r.HUDMaterial(this._materialParameters,this.view.state.viewingMode===F.ViewingMode.Global);const x=this.view._stage;this._texture.load(x.renderView.renderingContext);x.add(this._texture)}destroyExternalResources(){this._texture&&
(this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null);this._material=null}createGeometries(x){const C=this._createRenderGeometry();null!=C&&x.addGeometry(C)}forEachExternalMaterial(x){this._material&&x(this._material)}get _preferredTextureSize(){return b.clamp(2*this._geometrySize,16,128)}calculateMapBounds(x){var C=this.object?.geometries[0];if(!C)return!1;C=C.attributes.get(l.VertexAttribute.POSITION).data;u.projectVectorToVector(C,this.view.renderCoordsHelper.spatialReference,
w,this.view.spatialReference);v.expandWithBuffer(x,w);return!0}_createRenderGeometry(){const {geometry:x,_material:C}=this;if(null==x||null==C)return null;const {renderCoordsHelper:h,elevationProvider:y}=this.view;var d=q.evaluateElevationAlignmentAtPoint(x,y,c.ElevationContext.fromElevationInfo(this.elevationInfo),h),B=g.set(t.sv3d.get(),x.x,x.y,d);d=t.sv3d.get();u.projectVectorToVector(B,x.spatialReference,d,h.spatialReference);B=this._geometrySize;return m.createPointGeometry(C,null,d,null,null,
[B,B],[0,0,0,1])}}const H=k.defaultSymbolSizeRatio,D=[H/2,H/2,1-H/2,1-H/2],w=f.create();a.PointVisualElement=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/Object3DVisualElement":function(){define("exports ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ./VisualElement ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,
b,g,f,e,n,u){class v extends f.VisualElement{constructor(t){super(t);this._resources=null;this._transform=g.create()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(t){b.copy(this._transform,t);null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null!=this._resources){var t=this._resources.object,F=this.view._stage;F.removeMany(t.geometries);
t.removeAllGeometries();this.createGeometries(t);t.visible=this.visible;F.addMany(t.geometries)}}createResources(){this.destroyResources();const t=this.view._stage;if(t){var F=new u.WebGLLayer(t,{pickable:!1,updatePolicy:n.UpdatePolicy.SYNC}),E=new e.Object3D({castShadow:!1});E.transformation=this._transform;this.createExternalResources();this.createGeometries(E);t.addMany(E.geometries);this.forEachExternalMaterial(q=>t.add(q));t.add(E);F.add(E);E.visible=this.visible;this._resources={layer:F,object:E}}}destroyResources(){const t=
this.view._stage;null!=this._resources&&t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial(F=>{t.remove(F)}),t.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(t){null!=this._resources&&(this._resources.object.visible=t)}}a.Object3DVisualElement=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/RightAngleQuadVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/support/vectorStacks ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D){function w(y){y.pixelRatioHandle.remove();y.geometries=[]}class x extends E.EngineVisualElement{constructor(y){super(y);this._maxSize=0;this._position=n.create();this._up=n.create();this._right=n.create();this._renderOccluded=l.RenderOccludedFlag.OccludeAndTransparent;this._color=v.fromValues(1,0,0,1);this._outlineColor=v.fromValues(0,0,0,1);this._outlineSize=0;this._size=32;this._outlineRenderOccluded=l.RenderOccludedFlag.Opaque;this.applyProperties(y)}createObject3DResourceFactory(y){return{view:y,
createResources:d=>this._createObject3DResources(d),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(y){return{view:y,createResources:()=>this._createDrapedResources(),destroyResources:w}}get renderOccluded(){return this._renderOccluded}set renderOccluded(y){y!==this._renderOccluded&&(this._renderOccluded=y,this._updateQuadMaterial())}get color(){return this._color}set color(y){u.copy(this._color,y);this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(y){u.copy(this._outlineColor,
y);this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(y){const d=0===this._outlineSize!==(0===y);this._outlineSize=y;d?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(y){y!==this._size&&(this._size=y,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(y){this._outlineRenderOccluded=y;this._updateOutlineMaterial()}set geometry({previous:y,center:d,next:B}){this._maxSize=
Math.min(e.distance(d,y),e.distance(d,B))/3;e.normalize(this._up,e.subtract(this._up,y,d));e.normalize(this._right,e.subtract(this._right,B,d));e.copy(this._position,d);this.recreateGeometry()}_createObject3DResources(y){const d=new H.ColorMaterial(this._quadMaterialParameters),B=0===this._outlineSize?void 0:new D.RibbonLineMaterial(this._outlineMaterialParameters);this._createObject3DGeometries(y,d,B);return{quadMaterial:d,outlineMaterial:B,forEach:p=>{p(d);B&&p(B)}}}_createObject3DGeometries(y,
d,B){if(!e.exactEquals(this._up,n.ZEROS)||!e.exactEquals(this._right,n.ZEROS)){d=this._createGeometries(d,B);for(const p of d)y.addGeometry(p);this._updateTransformObject3D(y)}}_createDrapedResources(){const y=new H.ColorMaterial(this._quadMaterialParameters),d=0===this._outlineSize?void 0:new D.RibbonLineMaterial(this._outlineMaterialParameters),B=this._createGeometries(y,d).map(A=>new r.RenderGeometry(A));this._setTransformDraped(B);const p=b.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});
return{quadMaterial:y,outlineMaterial:d,geometries:B,pixelRatioHandle:p}}_createGeometries(y,d){const {up:B,right:p,corner:A}=this._getVertices();y=new k.Geometry(y,[[z.VertexAttribute.POSITION,new c.Attribute([0,0,0,...p,...B,...A],[0,1,2,1,2,3],3,!0)]]);if(!d)return[y];d=m.createPolylineGeometry(d,[B,A,p]);return[y,d]}_getVertices(){let y=this._up,d=this._right;const B=e.add(t.sv3d.get(),y,d);this.isDraped&&(y=e.copy(t.sv3d.get(),y),d=e.copy(t.sv3d.get(),d),y[2]=0,d[2]=0,B[2]=0);return{up:y,right:d,
corner:B}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(y=this.object3dResources.object){if(y){var d=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position);d=Math.min(this._maxSize,d);g.fromTranslation(C,this._position);g.scale(C,C,[d,d,d]);y.transformation=C}}_setTransformDraped(y){if(0!==y.length){var {view:{basemapTerrain:{overlayManager:d},state:{contentPixelRatio:B}}}=this,{_position:p,_size:A}=
this,G=e.copy(t.sv3d.get(),p);G[2]=q.drapedZ;var I=h;I.spatialReference=d.renderer.spatialReference;I.x=G[0];I.y=G[1];I=this.view.overlayPixelSizeInMapUnits(I)*B;I=Math.min(this._maxSize,A*I);g.fromTranslation(C,G);g.scale(C,C,[I,I,1]);for(const J of y)J.transformation=C}}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters);
this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters);this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const C=f.create(),h=F.makeDehydratedPoint(0,
0,void 0,null);a.RightAngleQuadVisualElement=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ColorMaterial":function(){define("exports ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../core/shaderLibrary/util/AlphaCutoff ../effects/geometry/olidUtils ../lib/basicInterfaces ../lib/GLMaterial ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/VertexAttribute ./DefaultBufferWriter ./TriangleMaterial ./VisualVariablePassParameters ../shaders/ColorMaterialTechnique ../shaders/ColorMaterialTechniqueConfiguration".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l){class r extends c.TriangleMaterial{constructor(D){super(D,H);this._configuration=new l.ColorMaterialTechniqueConfiguration;this.supportsEdges=!0;this.produces=new Map([[F.RenderSlot.OPAQUE_MATERIAL,w=>this._isOpaqueMaterialPass(w)],[F.RenderSlot.OPAQUE_MATERIAL_WITHOUT_NORMALS,w=>this._isOpaqueNoSSAODepthPass(w)],[F.RenderSlot.TRANSPARENT_MATERIAL,w=>f.isColorOrOID(w)&&this._transparent&&this.parameters.writeDepth],[F.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,
w=>f.isDepth(w)&&this._transparent&&this.parameters.writeDepth],[F.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,w=>f.isColorOrOID(w)&&this._transparent&&!this.parameters.writeDepth],[F.RenderSlot.DRAPED_MATERIAL,w=>f.is2DGeometryOutput(w)]])}getConfiguration(D,w){this._configuration.output=D;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;
this._configuration.transparent=this._transparent;this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(D)&&this.parameters.discardInvisibleFragments;this._configuration.polygonOffset=this.parameters.polygonOffset;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.hasOccludees=w.hasOccludees;this._configuration.oitPass=w.oitPass;this._configuration.enableOffset=w.camera.relativeElevation<t.OITPolygonOffsetLimit;this._configuration.terrainDepthTest=
w.terrainDepthTest;this._configuration.cullAboveTerrain=w.cullAboveTerrain;this._configuration.vvColor=!!this.parameters.vvColor;this._configuration.draped=this.parameters.draped;return this._configuration}get visible(){return this.parameters.color[3]>=e.alphaCutoff}get _transparent(){return 1>this.parameters.color[3]||this.parameters.forceTransparentMode}_isOpaquePass(D){return this._isOpaqueMaterialPass(D)||this._isOpaqueNoSSAODepthPass(D)}_isOpaqueMaterialPass(D){return D===f.ShaderOutput.Highlight||
f.isColorOrOID(D)&&!this._transparent}_isOpaqueNoSSAODepthPass(D){return f.isDepth(D)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(D){return new z(D)}createBufferWriter(){const D=g.newLayout().vec3f(E.VertexAttribute.POSITION);n.olidEnabled()&&D.vec4u8(E.VertexAttribute.OBJECTANDLAYERIDCOLOR);this.parameters.vvColor?D.f32(E.VertexAttribute.COLORFEATUREATTRIBUTE):D.vec4u8(E.VertexAttribute.COLOR);return new q.DefaultBufferWriter(D)}}class z extends v{beginSlot(D){return this.acquireTechnique(m.ColorMaterialTechnique,
D)}}class H extends k.VisualVariablePassParameters{constructor(){super(...arguments);this.color=b.ZEROS;this.forceTransparentMode=!1;this.writeDepth=!0;this.hasSlicePlane=this.polygonOffset=this.hasVertexColors=!1;this.cullFace=u.CullFaceOptions.None;this.discardInvisibleFragments=this.draped=!1}}a.ColorMaterial=r;a.Parameters=H;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/TriangleMaterial":function(){define(["exports","../lib/Material","../lib/RayIntersections"],
function(a,b,g){class f extends b.Material{intersect(e,n,u,v,t,F){return g.intersectTriangleGeometry(e,u,v,t,void 0,F)}}a.TriangleMaterial=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ColorMaterialTechnique":function(){define("require exports ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/OITPass ../lib/OrderIndependentTransparency ../lib/StencilUtils ../materials/VisualVariablePassParameters ../../../../chunks/ColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c){class k extends F.VisualVariablePassParameters{constructor(){super(...arguments);this.color=g.ZEROS}}class m extends n.ShaderTechnique{constructor(r,z,H){super(r,z,new e.ReloadableShaderModule(E.ColorMaterial,()=>new Promise((D,w)=>a(["./ColorMaterial.glsl"],D,w))),H)}_createPipeline(r,z){const {oitPass:H,output:D,transparent:w,cullFace:x,draped:C,hasOccludees:h,polygonOffset:y,enableOffset:d}=r,B=H===u.OITPass.NONE,p=H===u.OITPass.FrontFace;return c.makePipelineState({blending:D===
f.ShaderOutput.Color&&w?v.blending(H):null,culling:c.cullingParams(x),depthTest:C?null:{func:v.oitDepthTest(H)},depthWrite:v.depthWrite(r),drawBuffers:D===f.ShaderOutput.Depth?{buffers:[q.SpecialDrawBuffers.NONE]}:v.getDrawBuffers(H,D),colorWrite:c.defaultColorWrite,stencilWrite:h?t.stencilWriteMaskOn:null,stencilTest:h?z?t.stencilToolMaskBaseParams:t.stencilBaseAllZerosParams:null,polygonOffset:B||p?y?l:null:v.getOITPolygonOffset(d)})}initializePipeline(r){this._occludeePipelineState=this._createPipeline(r,
!0);return this._createPipeline(r,!1)}getPipeline(r){return r?this._occludeePipelineState:super.getPipeline()}}const l={factor:1,units:1};b.ColorMaterialPassParameters=k;b.ColorMaterialTechnique=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ColorMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute ../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m){function l(z){const H=new c.ShaderBuilder,{vertex:D,fragment:w,attributes:x,varyings:C}=H;F.addProjViewLocalOrigin(D,z);H.include(f.Transform,z);H.include(n.VertexColor,z);H.include(v.VisualVariables,z);H.include(e.ObjectAndLayerIdColor,z);H.include(g.SliceDraw,z);H.include(m.outputColorHighlightOID,z);x.add(k.VertexAttribute.POSITION,"vec3");z.vvColor&&x.add(k.VertexAttribute.COLORFEATUREATTRIBUTE,"float");C.add("vColor","vec4");C.add("vpos","vec3");const h=
z.terrainDepthTest&&z.output===b.ShaderOutput.Color;h&&C.add("depth","float");D.uniforms.add(new E.Float4PassUniform("eColor",y=>y.color));D.main.add(q.glsl`
      vpos = position;
      forwardNormalizedVertexColor();
      forwardObjectAndLayerIdColor();

      ${z.hasVertexColors?"vColor *\x3d eColor;":z.vvColor?"vColor \x3d eColor * interpolateVVColor(colorFeatureAttribute);":"vColor \x3d eColor;"}
      ${h?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
      gl_Position = transformPosition(proj, view, vpos);`);H.include(g.SliceDraw,z);h&&H.include(u.terrainDepthTest,z);w.include(t.ColorConversion);w.main.add(q.glsl`
    discardBySlice(vpos);
    ${h?"terrainDepthTest(depth);":""}
    vec4 fColor = vColor;
    outputColorHighlightOID(fColor, vpos);`);return H}const r=Object.freeze(Object.defineProperty({__proto__:null,build:l},Symbol.toStringTag,{value:"Module"}));a.ColorMaterial=r;a.build=l})},"esri/views/3d/webgl-engine/shaders/ColorMaterialTechniqueConfiguration":function(){define("exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl ../core/shaderLibrary/output/Emissions.glsl ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../materials/DefaultTechniqueConfiguration".split(" "),
function(a,b,g,f,e,n,u){class v extends u.DefaultTechniqueConfiguration{constructor(){super(...arguments);this.cullFace=n.CullFaceOptions.None;this.polygonOffset=this.discardInvisibleFragments=this.transparent=this.hasVertexColors=this.hasSlicePlane=!1;this.writeDepth=this.enableOffset=!0;this.draped=this.vvColor=this.objectAndLayerIdColorInstanced=this.cullAboveTerrain=this.terrainDepthTest=this.hasOccludees=!1;this.textureCoordinateType=g.TextureCoordinateType.None;this.emissionSource=f.EmissionSource.None;
this.occlusionPass=!1;this.hasVvInstancing=!0;this.vvOpacity=this.vvSize=!1}}b.__decorate([e.parameter({count:n.CullFaceOptions.COUNT})],v.prototype,"cullFace",void 0);b.__decorate([e.parameter()],v.prototype,"hasSlicePlane",void 0);b.__decorate([e.parameter()],v.prototype,"hasVertexColors",void 0);b.__decorate([e.parameter()],v.prototype,"transparent",void 0);b.__decorate([e.parameter()],v.prototype,"discardInvisibleFragments",void 0);b.__decorate([e.parameter()],v.prototype,"polygonOffset",void 0);
b.__decorate([e.parameter()],v.prototype,"enableOffset",void 0);b.__decorate([e.parameter()],v.prototype,"writeDepth",void 0);b.__decorate([e.parameter()],v.prototype,"hasOccludees",void 0);b.__decorate([e.parameter()],v.prototype,"terrainDepthTest",void 0);b.__decorate([e.parameter()],v.prototype,"cullAboveTerrain",void 0);b.__decorate([e.parameter()],v.prototype,"objectAndLayerIdColorInstanced",void 0);b.__decorate([e.parameter()],v.prototype,"vvColor",void 0);b.__decorate([e.parameter()],v.prototype,
"draped",void 0);a.ColorMaterialTechniqueConfiguration=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,g,f){function e(t=0,F=0,E=0){return b.fromValues(t,F,E)}function n(t,F,E,q=e()){q[0]=t.x;q[1]=t.y;q[2]=t.z??0;if(null==F)return q;q[2]="2d"===F.type?0:f.getConvertedElevation(F,
t,E,f.absoluteHeightElevationInfo)??0;return q}var u;(function(t){t[t.NONE=0]="NONE";t[t.TARGET=1]="TARGET"})(u||={});const v=g.makeDehydratedPoint(0,0,0,null);a.asVec2=function(t){return t};a.clone=function(t){const [F,E,q]=t;return 3<t.length?[F,E,q,t[3]]:[F,E,q]};a.create=function(t,F,E){return e(t,F,E)};a.createWritable=e;a.fromAnyMapPoint=function(t,F,{coordinateHelper:E,elevationInfo:q},c){return t?n(E.vectorToDehydratedPoint(t,v),F,q,c):null};a.fromPoint=n;a.fromValues=function(t,F,E){return b.fromValues(t,
F,E)};a.fromVec3=function(t){return t};a.isTarget=function(t){return!!(((3<t.length?t[3]:void 0)??u.NONE)&u.TARGET)};a.markAsTarget=function(t){t[3]=((3<t.length?t[3]:void 0)??u.NONE)|u.TARGET;return t};a.toDehydratedPoint=function(t,F,E){return E?(g.setDehydratedPoint(E,t[0],t[1],t[2],F),E):g.makeDehydratedPoint(t[0],t[1],t[2],F)};a.toElevationAlignedDehydratedPoint=function(t,F,{z:E,m:q},c,k){const {spatialReference:m,elevationInfo:l}=c;F=null==E&&null==q?void 0:null==F||"2d"===F.type?E??void 0:
f.getConvertedElevationFromVector(F,t,m,f.absoluteHeightElevationInfo,l)??0;const [r,z]=t;k?g.setDehydratedPoint(k,r,z,F,m):k=g.makeDehydratedPoint(r,z,F,m);null!=q&&(k.m=q,k.hasM=!0);return k};a.withSelfSnappingZ=function(t,F,E,q,c=e()){const [k,m]=t;c[0]=k;c[1]=m;3<t.length&&(c[3]=t[3]??u.NONE);if("3d"!==E?.type)return c[2]=F.value,c;c[2]=f.getConvertedElevationFromXYZ(E,k,m,F.value,q,F.elevationInfo,f.absoluteHeightElevationInfo)??0;return c};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,g,f,e,n){let u=class extends f.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([e.property({type:Boolean})],u.prototype,"enabled",void 0);u=b.__decorate([n.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],
u);f=class extends f.JSONSupport{constructor(v){super(v);this.lineSnapper=new u;this.parallelLineSnapper=new u;this.rightAngleSnapper=new u;this.rightAngleTriangleSnapper=new u;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThresholdMeters=.3;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=1E-6;this.orange=new g([255,127,0]);this.orangeTransparent=new g([255,127,0,.5]);this.lineHintWidthTarget=
this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=1}};b.__decorate([e.property({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"lineSnapper",void 0);b.__decorate([e.property({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"parallelLineSnapper",void 0);
b.__decorate([e.property({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleSnapper",void 0);b.__decorate([e.property({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleTriangleSnapper",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,"shortLineThreshold",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,
"distance",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointThreshold",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"parallelLineThreshold",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,
max:1},json:{write:!0}})],f.prototype,"verticalLineThresholdMeters",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointOnLineThreshold",void 0);b.__decorate([e.property({type:g,nonNullable:!0})],f.prototype,"orange",void 0);b.__decorate([e.property({type:g,nonNullable:!0})],f.prototype,"orangeTransparent",
void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthReference",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthTarget",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],f.prototype,"lineHintFadedExtensions",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],
f.prototype,"parallelLineHintWidth",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],f.prototype,"parallelLineHintLength",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],f.prototype,"parallelLineHintOffset",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],f.prototype,"rightAngleHintSize",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,
range:{min:0,max:6},json:{write:!0}})],f.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([e.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],f.prototype,"satisfiesConstraintScreenThreshold",void 0);f=b.__decorate([n.subclass("esri.views.interactive.snapping.Settings.Defaults")],f);b=new f;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],function(a){a.SnappingDomain=
void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec32 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint ../../../webmap/utils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){function c(l,r){const z=l.x-r.x;l=l.y-r.y;return z*z+l*l}const k=Symbol("grid-placement-graphic");a.LineSegmentHintType=void 0;(function(l){l[l.TARGET=0]="TARGET";l[l.REFERENCE=1]="REFERENCE";l[l.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));const m=Symbol("snapping-toggle");a.editEdgeToSnappingEdge=function(l,r,z){return{left:E.fromAnyMapPoint(l.leftVertex.pos,r,z),right:E.fromAnyMapPoint(l.rightVertex.pos,r,z)}};
a.gridPlacementGraphicSymbol=k;a.isUtilityNetworkWebMap=function(l){return q.isWebMap(l)&&"utilityNetworks"in l&&!!l.utilityNetworks?.length};a.makeFilter=function(l){return l.createQuery()};a.makeSnappingQuery=function({point:l,distance:r,returnEdge:z,vertexMode:H,coordinateHelper:{spatialReference:D},filter:w},x,C){C=null!=C?C.clone():new v({where:"1\x3d1"});if(w){C.geometry=w.geometry;C.distance=w.distance;C.spatialRelationship=w.spatialRelationship;C.where=f.sqlAnd(C.where,w.where);C.timeExtent=
e.mergeTimeExtents(C.timeExtent,w.timeExtent);var h=C;var y=C.objectIds;w=w.objectIds;y=y||w?w?y?Array.from(g.intersection(new Set(y),new Set(w))):w:y:null;h.objectIds=y}return{point:u.makeDehydratedPoint(l[0],l[1],l[2],D.toJSON()),mode:x,distance:r,returnEdge:z,vertexMode:H,query:C.toJSON()}};a.objectEqual=function(l,r){const z=l.length===r.length&&l[0]===r[0]&&l[1]===r[1];switch(l.length){case 2:return z;case 3:return z&&l[2]===r[2];case 4:return z&&l[2]===r[2]&&l[3]===r[3]}return!1};a.screenDistance=
function(l,r){return Math.sqrt(c(l,r))};a.setupSnappingToggleHandles=function(l,r=()=>{}){const z=b.watch(()=>({view:l.view,snappingOptions:l.snappingOptions}),({view:H,snappingOptions:D})=>{l.removeHandles(m);if(H&&D){var w=t.ViewEventPriorities.TOOL;H=[H.on("key-down",x=>{x.key!==F.snappingKeys.toggle||x.repeat||(D.enabledToggled=!0,r())},w),H.on("key-up",x=>{x.key===F.snappingKeys.toggle&&(D.enabledToggled=!1,r())},w),H.on("pointer-move",x=>{x=x.native.ctrlKey;D.enabledToggled!==x&&(D.enabledToggled=
x,r())},w)];l.addHandles(H,m)}},b.syncAndInitial);l.addHandles(z)};a.sortCandidatesInPlace=function(l,r){r.sort((z,H)=>{z=n.squaredDistance(z.targetPoint,l);H=n.squaredDistance(H.targetPoint,l);return z-H})};a.squaredScreenDistance=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define("exports ../../core/arrayUtils ../../core/handleUtils ../../core/MapUtils ../input/InputManager ../input/keys".split(" "),function(a,b,g,f,e,n){n={moveUp:{key:"ArrowUp",
modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:n.primaryKey,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},undo:"z",redo:"r"};class u{constructor(){this._bindings=
new Map}add(t,F){return this.addToggle(t,E=>{"key-down"===E.type&&F(E)})}addToggle(t,F){const E=v.fromDefinition(t,F),q=f.getOrCreateMapValue(this._bindings,E.key,()=>[]);q.push(E);return g.makeHandle(()=>b.remove(q,E))}register(t,F=e.ViewEventPriorities.WIDGET){return g.handlesGroup([t.on("key-down",E=>this.dispatch(t.inputManager,E),F),t.on("key-up",E=>this.dispatch(t.inputManager,E),F)])}dispatch(t,F){const E=this._bindings.get(F.key);if(E)for(const q of E)q.process(t,F)}}class v{constructor(t,
F,E,q,c){this.key=t;this.modifiers=F;this.repeats=E;this.continuePropagation=q;this.callback=c}process(t,F){if(!(F.key!==this.key||"repeat"in F&&F.repeat&&!this.repeats)){for(const E of this.modifiers)if(!t.isModifierKeyDown(E))return;this.continuePropagation||F.stopPropagation();this.callback(F)}}static fromDefinition(t,F){if("string"===typeof t)return new v(t,[],!1,!1,F);const {key:E,modifier:q,repeats:c,continuePropagation:k}=t;return new v(E,q?Array.isArray(q)?q:[q]:[],!!c,!!k,F)}}a.KeyBindings=
u;a.mediaKeys=n;a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys={toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingVisualizer":function(){define("exports ../../../core/handleUtils ./hints/IntersectionSnappingHint ./hints/LineSnappingHint ./hints/ParallelSnappingHint ./hints/PointSnappingHint ./hints/RightAngleSnappingHint".split(" "),
function(a,b,g,f,e,n,u){class v{draw(t,F){var E=[];for(var q of t){t=!0;for(const c of E)if(q.equals(c)){t=!1;break}t&&E.push(q)}E=this.sortUniqueHints(E);q=[];for(const c of E)c instanceof g.IntersectionSnappingHint&&q.push(this.visualizeIntersectionPoint(c,F)),c instanceof f.LineSnappingHint&&q.push(this.visualizeLine(c,F)),c instanceof e.ParallelSnappingHint&&q.push(this.visualizeParallelSign(c,F)),c instanceof u.RightAngleSnappingHint&&q.push(this.visualizeRightAngleQuad(c,F)),c instanceof n.PointSnappingHint&&
q.push(this.visualizePoint(c,F));return b.handlesGroup(q)}sortUniqueHints(t){return t}}a.SnappingVisualizer=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec32","../SnappingDomain","./SnappingHint"],function(a,b,g,f){class e extends f.SnappingHint{constructor(n,u,v=g.SnappingDomain.ALL){super(u,v);this.intersectionPoint=n}equals(n){return n instanceof e?b.exactEquals(this.intersectionPoint,
n.intersectionPoint):!1}}a.IntersectionSnappingHint=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(g,f){this.isDraped=g;this.domain=f}}a.SnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,g,f,e,n){class u extends n.SnappingHint{constructor(v,t,F,E,q=e.SnappingDomain.ALL,c=!0,k=!0){super(E,q);this.type=v;this.lineStart=t;this.lineEnd=F;this.fadeLeft=c;this.fadeRight=k}equals(v){return v instanceof u?this.type===v.type&&f.exactEquals(this.lineStart,v.lineStart)&&f.exactEquals(this.lineEnd,v.lineEnd)&&this.fadeLeft===v.fadeLeft&&this.fadeRight===v.fadeRight:!1}get length(){return f.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=u;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,g,f,e,n){class u extends n.SnappingHint{constructor(v,t,F,E=e.SnappingDomain.ALL){super(F,E);this.lineStart=v;this.lineEnd=t}equals(v){return v instanceof u?f.exactEquals(this.lineStart,v.lineStart)&&f.exactEquals(this.lineEnd,v.lineEnd):!1}}a.ParallelSnappingHint=
u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/PointSnappingHint":function(){define(["exports","../../../../chunks/vec32","./SnappingHint"],function(a,b,g){class f extends g.SnappingHint{constructor(e,n,u){super(n,u);this.point=e}equals(e){return e instanceof f?b.exactEquals(this.point,e.point):!1}}a.PointSnappingHint=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,g,f,e,n){class u extends n.SnappingHint{constructor(v,t,F,E,q=e.SnappingDomain.ALL){super(E,q);this.previousVertex=v;this.centerVertex=t;this.nextVertex=F}equals(v){return v instanceof u?f.exactEquals(this.previousVertex,v.previousVertex)&&f.exactEquals(this.centerVertex,v.centerVertex)&&f.exactEquals(this.nextVertex,v.nextVertex):!1}}a.RightAngleSnappingHint=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/meshFastUpdateUtils":function(){define(["exports",
"../../../../core/handleUtils","../../../../core/reactiveUtils","../../../../layers/graphics/sources/interfaces"],function(a,b,g,f){a.meshTransformFastUpdateHandles=function(e){const n=e.graphic;return n?[g.watch(()=>"visible"in e?e.visible:e.displaying,u=>{u&&n.notifyMeshTransformChanged({action:f.MeshTransformUpdateAction.EnableFastUpdates})},{...g.syncAndInitial}),b.makeHandle(()=>n.notifyMeshTransformChanged({action:f.MeshTransformUpdateAction.DisableFastUpdates}))]:[]};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/sources/interfaces":function(){define(["exports"],function(a){a.MeshTransformUpdateAction=void 0;var b=a.MeshTransformUpdateAction||(a.MeshTransformUpdateAction={});b[b.EnableFastUpdates=0]="EnableFastUpdates";b[b.DisableFastUpdates=1]="DisableFastUpdates";b[b.UpdateFastLocalOrigin=2]="UpdateFastLocalOrigin";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/settings":function(){define("exports ../../../../chunks/tslib.es6 ../../../../Color ../../../../core/Accessor ../../../../core/colorUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../visualElements/ExtendedLineVisualElement ../../webgl-engine/lib/Material ../../webgl-engine/materials/lineStippleUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c){function k(d,B){B&&Object.assign(d,B)}class m{constructor(d){this.height=90;this.coneHeight=40;this.coneWidth=23;this.width=3;this.renderOccluded=q.RenderOccludedFlag.Opaque;this.color=d.accent}}class l{constructor({colors:d,...B}){this.size=11;this.outlineSize=1;this.collisionPadding=9;this.color=d.accent;this.outlineColor=d.outline;this.renderOccluded=q.RenderOccludedFlag.Opaque;this.hoverOutlineColor=d.selectedOutline;k(this,B)}applyColor(d){this._apply(this.color,
d)}applyOutline(d){this._apply(this.outlineColor,d)}applyHoverOutline(d){this._apply(this.hoverOutlineColor,d)}_apply(d,B){B.setParameters({color:e.unitRGBAFromColor(d),renderOccluded:this.renderOccluded})}}class r{constructor({colors:d,...B}){this.size=40;this.height=.2;this.offset=.25;this.collisionPadding=2;this.renderOccluded=q.RenderOccludedFlag.Transparent;this.minSquaredEdgeLength=900;this.color=e.multiplyOpacity(d.accent,.5);this.hoverColor=d.accent;k(this,B)}applyColor(d){this._apply(this.color,
d)}applyHover(d){this._apply(this.hoverColor,d)}_apply(d,B){B.setParameters({color:e.unitRGBAFromColor(d),renderOccluded:this.renderOccluded})}}class z{constructor(d){this.vertex=new l({colors:d,color:d.accent,outlineColor:d.outline});this.edge=new l({colors:d,color:e.desaturate(e.multiplyOpacity(d.accent,2/3),.5),outlineColor:e.multiplyOpacity(d.outline,.5),size:8,collisionPadding:8});this.selected=new l({colors:d,color:d.selected,outlineColor:d.outline});this.edgeOffset=new r({colors:d})}}class H{constructor({colors:d,
...B}){this.width=1.5;this.stipplePattern=c.createStipplePatternSimple(3.3);this.falloff=0;this.innerWidth=1.5;this.renderOccluded=q.RenderOccludedFlag.OccludeAndTransparent;this.color=d.selected;this.stippleOffColor=d.outline;this.innerColor=d.selected;k(this,B)}apply(d){d.color=e.unitRGBAFromColor(this.color);d.width=this.width;d.stipplePattern=this.stipplePattern;d.stippleOffColor=e.unitRGBAFromColor(this.stippleOffColor);d.falloff=this.falloff;d.innerWidth=this.innerWidth;d.innerColor=e.unitRGBAFromColor(this.innerColor);
d.renderOccluded=this.renderOccluded}}class D{constructor({colors:d,...B}){this.size=4;this.outlineSize=1;this.shape="square";this.color=d.selected;this.outlineColor=d.outline;k(this,B)}apply(d){d.color=e.unitRGBAFromColor(this.color);d.size=this.size;d.outlineSize=this.outlineSize;d.outlineColor=e.unitRGBAFromColor(this.outlineColor);d.primitive=this.shape}}class w{constructor({colors:d,...B}){this.innerWidth=1;this.glowFalloff=this.glowWidth=8;this.globalAlpha=.3;this.globalAlphaContrastBoost=1.5;
this.radius=3;this.innerColor=d.selected;this.heightFillColor=this.glowColor=d.accent;k(this,B)}apply(d,B=1){B={glowColor:g.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:g.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*B*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in d?d.style=B:d.laserlineStyle=B}}class x{constructor(d){this.outline=new H({colors:d,
color:d.stippleOff,renderOccluded:q.RenderOccludedFlag.OccludeAndTransparentStencil,stippleOffColor:d.stippleOn,innerWidth:0});this.staged=new H({colors:d,color:d.stippleOn,renderOccluded:q.RenderOccludedFlag.OccludeAndTransparentStencil,innerColor:d.stagedSolid,stippleOffColor:d.stippleOff});this.shadowStyle=new w({colors:d,globalAlpha:.3,glowColor:d.accent,glowFalloff:8,glowWidth:8,innerColor:d.selected,innerWidth:1})}}class C{constructor(d){this.outline=new D({colors:d,color:d.selected,outlineColor:d.outline,
outlineSize:1,shape:"circle",size:4});this.shadowStyle=new w({colors:d,globalAlpha:.3,glowColor:d.accent,glowFalloff:1.5,glowWidth:6,innerColor:d.selected,innerWidth:1,radius:2})}}class h extends H{constructor({colors:d,...B}){super({colors:d});this.extensionType=E.ExtensionType.GROUND_RAY;k(this,B)}}class y{constructor(d){this.laserlineAlphaMultiplier=1.5;this.heightPlaneAngleCutoff=20;this.lineObjects=new x(d);this.pointObjects=new C(d);this.heightPlane=new w({colors:d,globalAlpha:.3,glowColor:d.accent,
glowFalloff:8,glowWidth:8,innerColor:d.selected,innerWidth:1});this.heightBox=new w({colors:d,globalAlpha:.3,glowColor:d.accent,glowFalloff:8,glowWidth:8,innerColor:d.selected,innerWidth:0,heightFillColor:d.accent});this.zVerticalLine=new h({colors:d,color:e.multiplyOpacity(d.accent,.5),falloff:2,innerColor:e.multiplyOpacity(d.selected,0),renderOccluded:q.RenderOccludedFlag.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:E.ExtensionType.GROUND_RAY})}}a.Settings=class extends f{constructor(d){super(d)}get colors(){const d=
this.getTheme().accentColor,B=d.a;return{accent:d,contrast:e.getContrast(d),selected:g.fromArray([255,255,255,B]),selectedOutline:g.fromArray([255,255,255,B]),staged:g.fromArray([12,207,255,B]),stagedSolid:g.fromArray([12,207,255,1]),outline:g.fromArray([0,0,0,.5*B]),stippleOn:g.fromArray([255,255,255,1]),stippleOff:g.fromArray([0,0,0,.5])}}get visualElements(){return new y(this.colors)}get manipulators(){return new z(this.colors)}get zManipulator(){return new m(this.colors)}};b.__decorate([n.property()],
a.Settings.prototype,"colors",null);b.__decorate([n.property()],a.Settings.prototype,"visualElements",null);b.__decorate([n.property()],a.Settings.prototype,"manipulators",null);b.__decorate([n.property()],a.Settings.prototype,"zManipulator",null);b.__decorate([n.property()],a.Settings.prototype,"getTheme",void 0);a.Settings=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.settings")],a.Settings);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/lineStippleUtils":function(){define(["exports"],
function(a){function b(e){null!=e?(e=f[e],e=null==e?e:{pattern:e.slice(),pixelRatio:8}):e=null;return e}const g={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},f={dash:g.dash,"dash-dot":[...g.dash,...g.dot],dot:g.dot,"long-dash":g["long-dash"],"long-dash-dot":[...g["long-dash"],...g.dot],"long-dash-dot-dot":[...g["long-dash"],...g.dot,...g.dot],none:null,"short-dash":g["short-dash"],"short-dash-dot":[...g["short-dash"],...g["short-dot"]],"short-dash-dot-dot":[...g["short-dash"],
...g["short-dot"],...g["short-dot"]],"short-dot":g["short-dot"],solid:null};a.createStipplePatternSimple=function(e){return{pattern:[e,e],pixelRatio:2}};a.getStipplePatternForLinePattern=function(e){return"style"===e?.type?b(e.style):null};a.getStipplePatternForPatternStyle=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/OutlineVisualElement":function(){define("exports ../../../../core/Evented ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/projection/projectBuffer ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/DoubleArray ../../../../layers/graphics/dehydratedPoint ../../../../support/elevationInfoUtils ../../../../symbols/support/ElevationInfo ./EngineVisualElement ./LaserlineVisualElement ../../layers/graphics/ElevationContext ../../support/engineContent/line ../../support/renderInfoUtils/line ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w){function x(d){d.geometries=[]}class C extends c.EngineVisualElement{constructor(d){super(d);this._attachmentOrigin=F.makeDehydratedPoint(0,0,0,null);this._attachmentOriginDirty=!0;this.events=new b;this._geometry=null;this._width=1;this._color=n.fromValues(1,0,1,1);this._innerWidth=0;this._innerColor=n.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._falloff=0;this._laserlineStyle=this._elevationInfo=null;this._laserlineEnabled=
!1;this._renderOccluded=z.RenderOccludedFlag.OccludeAndTransparentStencil;this._attachmentOrigin.spatialReference=d.view.spatialReference;this._laserline=new k.LaserlineVisualElement({view:d.view,isDecoration:d.isDecoration});this.applyProperties(d);this.attached=d.attached??!0}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(d){return{view:d,createResources:B=>this._createObject3DResources(B),destroyResources:x,recreateGeometry:(B,p)=>{B.geometries.length=0;this._recreateGeometry(p,
B.material,B.geometries)}}}createDrapedResourceFactory(d){return{view:d,createResources:()=>this._createDrapedResources(),destroyResources:x,recreateGeometry:B=>{B.geometries=this._createRenderGeometriesDraped(B.material);this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(d){this._laserline.attached=this._laserlineAttached;d&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(d){this._geometry=
d;this.recreateGeometry()}get width(){return this._width}set width(d){d!==this._width&&(this._width=d,this._updateMaterial())}get color(){return this._color}set color(d){e.exactEquals(d,this._color)||(e.copy(this._color,d),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(d){d!==this._innerWidth&&(this._innerWidth=d,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(d){e.exactEquals(d,this._innerColor)||(e.copy(this._innerColor,d),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(d){const B=
null!=d!==(null!=this._stipplePattern);this._stipplePattern=d;B?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(d){d&&this._stippleOffColor&&e.exactEquals(d,this._stippleOffColor)||(this._stippleOffColor=d?n.clone(d):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(d){d!==this._falloff&&(this._falloff=d,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(d){this._elevationInfo=
d;this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(d){this._laserlineStyle=d;this._laserline.attached=this._laserlineAttached;null!=d&&(this._laserline.style=d)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(d){this._laserlineEnabled!==d&&(this._laserlineEnabled=d,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(d){d!==this._renderOccluded&&(this._renderOccluded=
d,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const d=this.object3dResources.resources?.geometries;if(!d||0===d.length)return null;g.set(y,0,0,0);let B=0;for(const p of d)p.computeAttachmentOrigin(h)&&(g.add(y,y,h),B++);if(0===B)return null;g.scale(y,y,1/B);this.view.renderCoordsHelper.fromRenderCoords(y,this._attachmentOrigin);this._attachmentOriginDirty=!1;return this._attachmentOrigin}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters);
this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,
isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===z.RenderOccludedFlag.OccludeAndTransparentStencil?z.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(d,B,p){this._createRenderGeometries(B,p);for(const A of p)d.addGeometry(A);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0;this.events.emit("attachment-origin-changed")}_createObject3DResources(d){const B=new w.RibbonLineMaterial(this._materialParameters),
p=[];this._recreateGeometry(d,B,p);return{material:B,geometries:p,forEach:A=>{A(B);p.forEach(A)}}}_createDrapedResources(){const d=new w.RibbonLineMaterial(this._materialParameters),B=this._createRenderGeometriesDraped(d);return{material:d,geometries:B}}_createRenderGeometriesDraped(d){const {geometry:B,view:p}=this,A=p.basemapTerrain.spatialReference;return null==B||null==A?[]:r.geometryToRenderInfoDraped(B,A).lines.map(({position:G})=>new H.RenderGeometry(l.createGeometry(d,{overlayInfo:{spatialReference:A,
renderCoordsHelper:p.renderCoordsHelper},attributeData:{position:G},removeDuplicateStartEnd:this._isClosed})))}calculateMapBounds(d){if(null==this.object3dResources.resources)return!1;const B=this.view.renderCoordsHelper;for(const p of this.object3dResources.resources.geometries){const A=p.attributes.get(D.VertexAttribute.POSITION),G=t.newDoubleArray(A.data.length);u.projectBuffer(A.data,B.spatialReference,0,G,this.view.spatialReference,0);v.expandWithBuffer(d,G)}return!0}_createRenderGeometries(d,
B){var p=this.geometry;if(null!=p){p=r.geometryToRenderInfo(p,this.view.elevationProvider,this.view.renderCoordsHelper,m.ElevationContext.fromElevationInfo(this.elevationInfo??new q({mode:E.getGeometryEffectiveElevationMode(p,null)})));var A=[];for(const {position:G,mapPositions:I}of p.lines)B.push(l.createGeometry(d,{mapPositions:I,attributeData:{position:G},removeDuplicateStartEnd:this._isClosed})),A.push(G);this._laserline.pathVerticalPlane=A}}}const h=f.create(),y=f.create();a.OutlineVisualElement=
C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/engineContent/line":function(){define("exports ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/ellipsoidUtils ../../../../geometry/projection/projectors ../../../../geometry/support/DoubleArray ../../../../geometry/support/FloatArray ../../../../geometry/support/Indices ../../../ViewingMode ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){const m=g.create(),l=g.create();a.createGeometry=function(r,z,H=null){const D=[],w=z.mapPositions,{attributeData:{position:x},removeDuplicateStartEnd:C}=z;var h=x.length;h=x[0]===x[h-3]&&x[1]===x[h-2]&&x[2]===x[h-1]&&C;var y=x.length/3-(h?1:0),d=Array(2*(y-1)),B=h?x.slice(0,-3):x,p=0;for(var A=0;A<y-1;A++)d[p++]=A,d[p++]=A+1;D.push([k.VertexAttribute.POSITION,new E.Attribute(B,d,3,h)]);y=D[0][1].data;h=t.getZeroIndexArray(D[0][1].indices.length);null==z.attributeData.colorFeature&&
D.push([k.VertexAttribute.COLOR,new E.Attribute(z.attributeData.color??f.ONES,h,4)]);null==z.attributeData.sizeFeature&&D.push([k.VertexAttribute.SIZE,new E.Attribute([z.attributeData.size??1],h,1,!0)]);z.attributeData.normal&&D.push([k.VertexAttribute.NORMAL,new E.Attribute(z.attributeData.normal,h,3)]);null!=z.attributeData.colorFeature&&D.push([k.VertexAttribute.COLORFEATUREATTRIBUTE,new E.Attribute([z.attributeData.colorFeature],h,1,!0)]);null!=z.attributeData.sizeFeature&&D.push([k.VertexAttribute.SIZEFEATUREATTRIBUTE,
new E.Attribute([z.attributeData.sizeFeature],h,1,!0)]);null!=z.attributeData.opacityFeature&&D.push([k.VertexAttribute.OPACITYFEATUREATTRIBUTE,new E.Attribute([z.attributeData.opacityFeature],h,1,!0)]);if(null!=z.overlayInfo&&z.overlayInfo.renderCoordsHelper.viewingMode===F.ViewingMode.Global&&z.overlayInfo.spatialReference.isGeographic){h=u.newDoubleArray(y.length);z=e.getReferenceEllipsoid(z.overlayInfo.spatialReference);for(d=0;d<h.length;d+=3)n.lonLatToWebMercatorComparable(y,d,h,d,z);z=y.length/
3;y=v.newFloatArray(z+1);d=m;B=l;A=p=0;b.set(d,h[A++],h[A++]);A++;y[0]=0;for(let G=1;G<z+1;++G)G===z&&(A=0),b.set(B,h[A++],h[A++]),A++,p+=b.dist(d,B),y[G]=p,[d,B]=[B,d];D.push([k.VertexAttribute.DISTANCETOSTART,new E.Attribute(y,D[0][1].indices,1,!0)])}return new c.Geometry(r,D,w,q.ContentObjectType.Line,H)};a.lineStripsToParameters=function(r,z){if(null==r||0===r.length)return[];const H=[];r.forEach(D=>{const w=u.newDoubleArray(3*D.length);D.forEach((x,C)=>{w[3*C]=x[0];w[3*C+1]=x[1];w[3*C+2]=x[2]});
H.push({attributeData:{position:w,normal:z},removeDuplicateStartEnd:!1})});return H};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/renderInfoUtils/line":function(){define("exports ../../../../geometry/projection/projectBuffer ../../../../geometry/support/DoubleArray ../../../../geometry/support/triangulationUtils ../../layers/graphics/elevationAlignmentUtils ../../terrain/OverlayRenderer".split(" "),function(a,b,g,f,e,n){function u(v,t,F=null){const E=[];for(const {index:q,
count:c}of v){if(1>=c)continue;v=3*q;const k=3*c;E.push({position:g.doubleSubArray(t,3*q,3*c),mapPositions:null!=F?g.doubleSubArray(F,v,k):void 0})}return E}a.geometryToRenderInfo=function(v,t,F,E){const {position:q,outlines:c}=f.ringsToTriangulationInfo("polygon"===v.type?v.rings:v.paths,!!v.hasZ,"polygon"===v.type?f.CounterClockwiseMode.CCW_IS_HOLE:f.CounterClockwiseMode.NONE,v.spatialReference),k=g.newDoubleArray(q.length);v=e.applyPerVertexElevationAlignment(q,v.spatialReference,0,k,0,q,0,q.length/
3,t,F,E);t=null!=v;return{lines:t?u(c,q,k):[],projectionSuccess:t,sampledElevation:v}};a.geometryToRenderInfoDraped=function(v,t){const {position:F,outlines:E}=f.ringsToTriangulationInfo("polygon"===v.type?v.rings:v.paths,!1,"polygon"===v.type?f.CounterClockwiseMode.CCW_IS_HOLE:f.CounterClockwiseMode.NONE);v=b.projectBuffer(F,v.spatialReference,0,F,t,0);for(t=2;t<F.length;t+=3)F[t]=n.drapedZ;return{lines:v?u(E,F):[],projectionSuccess:v}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/visualElements/VerticesVisualElement":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../layers/graphics/ElevationContext ../../support/renderInfoUtils/point ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){class c extends n.Object3DVisualElement{constructor(m){super(m);this.view=null;this._renderOccluded=E.RenderOccludedFlag.OccludeAndTransparent;this._spatialReference=this._vertices=null;this._color=e.fromArray([1,127/255,0,1]);this._size=11;this._outlineColor=e.fromArray([0,0,0,.5]);this._outlineSize=1;this._elevationInfo=null;this.applyProperties(m)}get renderOccluded(){return this._renderOccluded}set renderOccluded(m){m!==this._renderOccluded&&(this._renderOccluded=
m,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(m){this._vertices=m;this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(m){this._spatialReference=m;this.recreateGeometry()}get color(){return this._color}set color(m){f.exactEquals(m,this._color)||(f.copy(this._color,m),this._updateMaterial())}get size(){return this._size}set size(m){m!==this._size&&(this._size=m,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(m){f.exactEquals(m,
this._outlineColor)||(f.copy(this._outlineColor,m),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(m){m!==this._outlineSize&&(this._outlineSize=m,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(m){this._elevationInfo=m;this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,
screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){var m=this.vertices;if(null==m||0===m.length)return[];var l=v.geometryToRenderInfo(m,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,
u.ElevationContext.fromElevationInfo(this.elevationInfo));m=[];const r=l.numVertices;l=l.position;for(let H=0;H<r;++H){var z=b.set(k,l[3*H],l[3*H+1],l[3*H+2]);const D=F.createSphereGeometry(this._vertexMaterial,.5,16,16,{offset:z});z=F.createSphereGeometry(this._vertexOutlineMaterial,.5,16,16,{offset:z});m.push({vertexGeometry:D,vertexOutlineGeometry:z})}return m}createGeometries(m){const l=this._createRenderGeometries();for(const {vertexGeometry:r,vertexOutlineGeometry:z}of l)m.addGeometry(r),m.addGeometry(z)}createExternalResources(){this._vertexMaterial=
new q.ShadedColorMaterial({...this._vertexMaterialParameters,writeDepth:!0,cullFace:t.CullFaceOptions.Back,screenSizeEnabled:!0});this._vertexOutlineMaterial=new q.ShadedColorMaterial({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:t.CullFaceOptions.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexOutlineMaterial=this._vertexMaterial=null}forEachExternalMaterial(m){m(this._vertexMaterial);m(this._vertexOutlineMaterial)}}
const k=g.create();a.VerticesVisualElement=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/renderInfoUtils/point":function(){define(["exports","../../../../geometry/support/DoubleArray","../../layers/graphics/elevationAlignmentUtils"],function(a,b,g){a.geometryToRenderInfo=function(f,e,n,u,v){const t=b.newDoubleArray(3*f.length),F=b.newDoubleArray(t.length);f.forEach((E,q)=>{t[3*q]=E[0];t[3*q+1]=E[1];t[3*q+2]=2<E.length?E[2]:0});e=g.applyPerVertexElevationAlignment(t,
e,0,F,0,t,0,t.length/3,n,u,v);return{numVertices:f.length,position:t,mapPositions:F,projectionSuccess:null!=e,sampledElevation:e}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ShadedColorMaterial":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../core/shaderLibrary/util/AlphaCutoff ../lib/basicInterfaces ../lib/GLMaterial ../lib/Material ../lib/RayIntersections ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./internal/bufferWriterUtils ../shaders/ShadedColorMaterialTechnique ../shaders/ShadedColorMaterialTechniqueConfiguration".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H){class D extends q.Material{constructor(d){super(d,x);this._configuration=new H.ShadedColorMaterialTechniqueConfiguration;this.vertexAttributeLocations=z.vertexAttributeLocations;this.supportsEdges=!0;this.produces=new Map([[k.RenderSlot.OPAQUE_MATERIAL,B=>B===v.ShaderOutput.Highlight||v.isColorOrOID(B)&&!this.parameters.transparent],[k.RenderSlot.TRANSPARENT_MATERIAL,B=>v.isColorOrOID(B)&&this.parameters.transparent&&this.parameters.writeDepth],[k.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,
B=>v.isColorOrOID(B)&&this.parameters.transparent&&!this.parameters.writeDepth]])}getConfiguration(d,B){this._configuration.output=d;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.transparent=this.parameters.transparent;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled;this._configuration.shadingEnabled=this.parameters.shadingEnabled;
this._configuration.oitPass=B.oitPass;this._configuration.terrainDepthTest=B.terrainDepthTest;this._configuration.cullAboveTerrain=B.cullAboveTerrain;return this._configuration}get visible(){return this.parameters.color[3]>=t.alphaCutoff}intersect(d,B,p,A,G,I){if(this.parameters.screenSizeEnabled){const J=d.attributes.get(l.VertexAttribute.OFFSET);c.intersectTriangleGeometry(d,p,A,G,{applyToVertex:(L,M,N,K)=>{K=b.set(h,J.data[3*K],J.data[3*K+1],J.data[3*K+2]);L=b.set(y,L,M,N);b.scale(K,K,this.parameters.screenSizeScale*
p.camera.computeScreenPixelSizeAt(K));b.add(L,L,K);return[L[0],L[1],L[2]]},applyToAabb:L=>{const M=e.center(L,h);return e.scale(L,this.parameters.screenSizeScale*p.camera.computeScreenPixelSizeAt(M))}},I)}else c.intersectTriangleGeometry(d,p,A,G,void 0,I)}createGLMaterial(d){return new w(d)}createBufferWriter(){return new C(this.parameters.screenSizeEnabled)}}class w extends E{beginSlot(d){return this.acquireTechnique(z.ShadedColorMaterialTechnique,d)}}class x extends q.MaterialParameters{constructor(){super(...arguments);
this.color=f.fromValues(1,1,1,1);this.shadingTint=f.fromValues(0,0,0,.25);this.shadingDirection=b.normalize(g.create(),[.5,-.5,-.5]);this.screenSizeScale=14;this.forceTransparentMode=!1;this.writeDepth=!0;this.hasSlicePlane=!1;this.cullFace=F.CullFaceOptions.None;this.screenSizeEnabled=!1;this.shadingEnabled=!0}get transparent(){return 1>this.color[3]||this.forceTransparentMode}}class C{constructor(d){this.screenSizeEnabled=d;d=u.newLayout().vec3f(l.VertexAttribute.POSITION).vec3f(l.VertexAttribute.NORMAL);
this.screenSizeEnabled&&d.vec3f(l.VertexAttribute.OFFSET);this.vertexBufferLayout=d}elementCount(d){return d.get(l.VertexAttribute.POSITION).indices.length}write(d,B,p,A,G,I){r.writeDefaultAttributes(p,A,this.vertexBufferLayout,d,B,G,I);if(this.screenSizeEnabled)if(p.has(l.VertexAttribute.OFFSET))if(d=p.get(l.VertexAttribute.OFFSET),m.assert(3===d.size),G=G.getField(l.VertexAttribute.OFFSET,n.BufferViewVec3f))r.writePosition(d,B,G,I);else throw Error("unable to acquire view for "+l.VertexAttribute.OFFSET);
else throw Error(`${l.VertexAttribute.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);}}const h=g.create(),y=g.create();a.Parameters=x;a.ShadedColorMaterial=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":function(){define("require exports ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/OITPass ../lib/OrderIndependentTransparency ../lib/VertexAttribute ../../../../chunks/ShadedColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){class q extends e.ShaderTechnique{constructor(k,m,l){super(k,m,new f.ReloadableShaderModule(t.ShadedColorMaterial,()=>new Promise((r,z)=>a(["./ShadedColorMaterial.glsl"],r,z))),l,c)}initializePipeline(k){const {oitPass:m,output:l,transparent:r,cullFace:z,shadingEnabled:H}=k,D=m===n.OITPass.NONE,w=m===n.OITPass.FrontFace;return E.makePipelineState({blending:l===g.ShaderOutput.Color&&r?u.blending(m):null,culling:E.cullingParams(z),depthTest:{func:w?F.CompareFunction.LESS:
H?F.CompareFunction.LEQUAL:F.CompareFunction.LESS},depthWrite:u.depthWrite(k),drawBuffers:u.getDrawBuffers(m,l),colorWrite:E.defaultColorWrite,polygonOffset:D||w?null:u.OITPolygonOffset})}}const c=new Map([[v.VertexAttribute.POSITION,0],[v.VertexAttribute.NORMAL,1],[v.VertexAttribute.OFFSET,2]]);b.ShadedColorMaterialTechnique=q;b.vertexAttributeLocations=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ShadedColorMaterial.glsl":function(){define("exports ../core/libs/gl-matrix-2/factories/vec4f64 ../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute ../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m){function l(z){const H=new c.ShaderBuilder,D=z.terrainDepthTest&&z.output===f.ShaderOutput.Color;H.include(n.Transform,z);H.include(g.ScreenSizeScaling,z);H.include(e.SliceDraw,z);H.include(m.outputColorHighlightOID,z);const {vertex:w,fragment:x}=H;x.include(v.ColorConversion);t.addProjViewLocalOrigin(w,z);x.uniforms.add(new E.Float4PassUniform("uColor",C=>C.color));H.attributes.add(k.VertexAttribute.POSITION,"vec3");H.varyings.add("vWorldPosition","vec3");D&&
H.varyings.add("depth","float");z.screenSizeEnabled&&H.attributes.add(k.VertexAttribute.OFFSET,"vec3");z.shadingEnabled&&(t.addViewNormal(w),H.attributes.add(k.VertexAttribute.NORMAL,"vec3"),H.varyings.add("vViewNormal","vec3"),x.uniforms.add(new F.Float3PassUniform("shadingDirection",C=>C.shadingDirection)),x.uniforms.add(new E.Float4PassUniform("shadedColor",C=>{{var h=C.shadingTint;C=C.color;const y=1-h[3],d=h[3]+C[3]*y;0===d?r[3]=d:(r[0]=(h[0]*h[3]+C[0]*C[3]*y)/d,r[1]=(h[1]*h[3]+C[1]*C[3]*y)/
d,r[2]=(h[2]*h[3]+C[2]*C[3]*y)/d,r[3]=C[3]);h=r}return h})));w.main.add(q.glsl`
      vWorldPosition = ${z.screenSizeEnabled?q.glsl`screenSizeScaling(offset, position)`:q.glsl`position`};
      ${z.shadingEnabled?q.glsl`vec3 worldNormal = normal;
                 vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`:""}
      ${D?q.glsl`depth = (view * vec4(vWorldPosition, 1.0)).z;`:""}
      gl_Position = transformPosition(proj, view, vWorldPosition);
  `);D&&H.include(u.terrainDepthTest,z);x.main.add(q.glsl`
      discardBySlice(vWorldPosition);
      ${D?q.glsl`terrainDepthTest(depth);`:""}
      ${z.shadingEnabled?q.glsl`vec3 viewNormalNorm = normalize(vViewNormal);
             float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
             vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`:q.glsl`vec4 finalColor = uColor;`}
      outputColorHighlightOID(finalColor, vWorldPosition);`);return H}const r=b.create();b=Object.freeze(Object.defineProperty({__proto__:null,build:l},Symbol.toStringTag,{value:"Module"}));a.ShadedColorMaterial=b;a.build=l})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl":function(){define(["exports","./util/View.glsl","../shaderModules/FloatPassUniform","../shaderModules/interfaces"],function(a,b,g,f){a.ScreenSizeScaling=function(e,n){n.screenSizeEnabled&&(e=e.vertex,b.addCameraPosition(e,
n),e.uniforms.add(new g.FloatPassUniform("perScreenPixelRatio",(u,v)=>v.camera.perScreenPixelRatio),new g.FloatPassUniform("screenSizeScale",u=>u.screenSizeScale)).code.add(f.glsl`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechniqueConfiguration":function(){define("exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl ../core/shaderLibrary/output/Emissions.glsl ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../materials/DefaultTechniqueConfiguration".split(" "),function(a,b,g,f,e,n,u){class v extends u.DefaultTechniqueConfiguration{constructor(){super(...arguments);
this.cullFace=n.CullFaceOptions.None;this.transparent=this.hasSlicePlane=!1;this.shadingEnabled=this.screenSizeEnabled=this.writeDepth=!0;this.cullAboveTerrain=this.terrainDepthTest=!1;this.textureCoordinateType=g.TextureCoordinateType.None;this.emissionSource=f.EmissionSource.None;this.objectAndLayerIdColorInstanced=this.occlusionPass=!1}get discardInvisibleFragments(){return this.transparent}}b.__decorate([e.parameter({count:n.CullFaceOptions.COUNT})],v.prototype,"cullFace",void 0);b.__decorate([e.parameter()],
v.prototype,"hasSlicePlane",void 0);b.__decorate([e.parameter()],v.prototype,"transparent",void 0);b.__decorate([e.parameter()],v.prototype,"writeDepth",void 0);b.__decorate([e.parameter()],v.prototype,"screenSizeEnabled",void 0);b.__decorate([e.parameter()],v.prototype,"shadingEnabled",void 0);b.__decorate([e.parameter()],v.prototype,"terrainDepthTest",void 0);b.__decorate([e.parameter()],v.prototype,"cullAboveTerrain",void 0);a.ShadedColorMaterialTechniqueConfiguration=v;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,g,f,e,n,u,v){a.GraphicState=class extends g.EventedAccessor{constructor(t){super(t);this.displaying=this.tracking=!1;this.error=null;
this.isDraped=!1}};b.__decorate([f.property({constructOnly:!0})],a.GraphicState.prototype,"graphic",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"tracking",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"displaying",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"error",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"isDraped",void 0);a.GraphicState=b.__decorate([v.subclass("esri.views.3d.layers.graphics.GraphicState")],a.GraphicState);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawGraphicTool":function(){define("exports ../../chunks/tslib.es6 ../../Graphic ../../UndoRedo ../../core/asyncUtils ../../core/Evented ../../core/handleUtils ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/coordinateFormatter ../../layers/GraphicsLayer ../../layers/graphics/dehydratedFeatureComparison ./support/CreateOperationGeometry ./support/createUtils ./support/surfaceCoordinateSystems ./support/tooltipUtils ../interactive/InteractiveToolBase ../interactive/sketch/SketchOptions ../interactive/tooltip/tooltipCommonUtils ../../core/accessorSupport/trackingUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y){a.DrawGraphicTool=class extends n.EventedMixin(x.InteractiveToolBase){constructor(p){super(p);this._createOperationGeometry=this._coordinateFormatterLoadTask=this._graphic=null;this.defaultZ=0;this.geometryType=this.directionOptions=null;this.hasZ=!0;this.snappingManager=this.geometryToPlace=null;this.snapToScene=!1;this.sketchOptions=new C}initialize(){const {view:p}=this;this.internalGraphicsLayer=new l({listMode:"hide",internal:!0});this.view.map.layers.add(this.internalGraphicsLayer);
const A=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=w.createTooltipInfos(p.type,this.sketchOptions);const G=h.makeTooltip(()=>({view:p,options:this.sketchOptions.tooltips}));this.tooltip=G;w.initializeConstraints(this._tooltipsContext);this._coordinateFormatterLoadTask=e.createTask(()=>m.load());this.addHandles([A.on("vertex-add",I=>this.onVertexAdd(I)),A.on("vertex-remove",I=>this.onVertexRemove(I)),A.on("vertex-update",I=>this.onVertexUpdate(I)),A.on("cursor-update",I=>this.onCursorUpdate(I)),
A.on("cursor-remove",()=>this._updateGraphic()),A.on("complete",I=>this.onComplete(I)),this._coordinateFormatterLoadTask,G.on("paste",I=>h.pasteLocation(I,this.activeTooltipInfo)),t.watch(()=>this.cursor,I=>{A.cursor=I},t.syncAndInitial),y.autorun(()=>{const {activeTooltipInfo:I,sketchOptions:J}=this;w.updateTooltipInfo(I,this._tooltipsContext);G.info=J.tooltips.effectiveEnabled?I:null}),y.autorun(()=>{A.constraintZ=w.getConstraintZ(this._tooltipsContext)},t.sync)]);this.finishToolCreation()}destroy(){this.drawOperation=
v.destroyMaybe(this.drawOperation);this.tooltip=v.destroyMaybe(this.tooltip);this._destroyAllVisualizations();this.view.map.remove(this.internalGraphicsLayer);this.internalGraphicsLayer=v.destroyMaybe(this.internalGraphicsLayer);this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,
forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(p){this._set("centered",p);this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(p){this._set("cursor",p)}set enabled(p){this.drawOperation.interactive=p;this._set("enabled",p)}set forceUniformSize(p){this._set("forceUniformSize",
p);this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(p){this._set("graphicSymbol",p);null!=this._graphic&&(this._graphic.symbol=p)}set mode(p){const A=this.drawOperation;A&&(A.drawingMode=p);this._set("mode",p)}get updating(){return this.drawOperation?.updating??!1}get undoRedo(){const {view:{type:p,map:A}}=this;return"2d"===p&&A&&"undoRedo"in A&&A.undoRedo instanceof f.UndoRedo?A.undoRedo:null}set undoRedo(p){this._override("undoRedo",p)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(p){if(!this.destroyed&&
!h.enterInputModeIfAvailable(p,this.tooltip))this.drawOperation.onInputEvent(p)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo();0===this.drawOperation.numCommittedVertices&&w.initializeConstraints(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(B.outline);this.removeHandles(B.regularVertices);this.removeHandles(B.activeVertex);this.removeHandles(B.activeEdge);this.removeHandles(d)}_createOrUpdateGraphic(p){if(null!=this._graphic)return this.updateGraphicGeometry(p),
this._graphic;const A=new g({...this.graphicProperties,symbol:this.graphicSymbol});this._graphic=A;this.updateGraphicGeometry(p);this.internalGraphicsLayer.add(A);this.addHandles(this.initializeGraphic(A));this.notifyChange("graphic");this.addHandles(u.makeHandle(()=>{this.internalGraphicsLayer.remove(A);this._graphic===A&&(this._graphic=null)}),d);return A}updateGraphicGeometry(p){this._graphic.geometry=p}_getCreateOperationGeometry(p={operationComplete:!1}){if(null!=this.drawOperation){var {coordinateHelper:A,
view:G,visualizationCursorVertex:I,lastVertex:J,committedVertices:L,geometryIncludingUncommittedVertices:M,numCommittedVertices:N}=this.drawOperation;if(0<N||null!=I){var K=p.operationComplete?L:M,O=K.length,U=null!=I?A.pointToArray(I):null,V=this._drawSpatialReference,ea="3d"===G.type&&"global"===G.viewingMode,Y=new z.CreateOperationGeometry;Y.committedVertices=L;Y.cursorVertex=U;var {geometryType:ra}=this;switch(ra){case "point":case "mesh":Y.full=A.arrayToPoint(K[0]);break;case "multipoint":Y.full=
0<O?H.createMultipoint(K,V):null;break;case "polyline":case "polygon":0<O&&(Y.full="polygon"===ra?H.createPolygon([K],V,ea,!0):H.createPolyline([K],V,ea),Y.cursorEdge=null!=U&&J&&!r.pointEquals(I,J)?H.createPolyline([[U,A.pointToArray(J)]],V,ea):null,Y.outline=1<O?Y.full:null);break;case "circle":case "rectangle":Y.committedVertices=Y.cursorVertex=null;if(!O)break;U=D.createViewAlignedCoordinateSystem(G,K[0]);V=K[0];ea=U.makeMapPoint(V[0]+48*G.resolution,V[1]);"circle"===ra?1===O&&p.operationComplete?
Y.circle=H.createCircle([V,ea],U,!0):2===O&&(this.forceUniformSize?Y.circle=H.createCircle(K,U,this.centered):Y.rectangle=H.createEllipse(K,U,this.centered)):1===O&&p.operationComplete?Y.rectangle=H.createSquare([V,ea],U,!0):2===O&&(Y.rectangle=this.forceUniformSize?H.createSquare(K,U,this.centered):H.createRectangle(K,U,this.centered));Y.full=null!=Y.circle?Y.circle.geometry:Y.rectangle?.geometry;Y.outline="polygon"===Y.full?.type?Y.full:null;break;default:return null}return Y}}}initializeGraphic(p){return u.makeHandle()}onComplete(p){if(this.drawOperation){this._updateGraphic();
var A=null;if(this.drawOperation.isCompleted){const G=this._getCreateOperationGeometry({operationComplete:!0});null!=G&&(A=this._createOrUpdateGraphic(G.full))}this._createOperationGeometry=null;this.emit("complete",{graphic:A,...p})}}onCursorUpdate(p){this._updateGraphic();this.emit("cursor-update",p)}onDeactivate(){const {drawOperation:p}=this;p&&(p.isCompleted||p.cancel())}onOutlineChanged(p){return u.makeHandle()}onCursorEdgeChanged(p){return u.makeHandle()}onVertexAdd(p){w.unlockConstraintsOnVertexAddOrRemove(this._tooltipsContext);
this._updateGraphic();w.lockElevationOnVertexAdd(p.vertices.at(0)?.coordinates,this._tooltipsContext);this.emit("vertex-add",p)}onVertexRemove(p){w.unlockConstraintsOnVertexAddOrRemove(this._tooltipsContext);this._updateGraphic();this.emit("vertex-remove",p)}onVertexUpdate(p){this._updateGraphic();this.emit("vertex-update",p)}_updateGraphic(){const p=this._getCreateOperationGeometry();this._createOperationGeometry=p;null==p?this._destroyAllVisualizations():(null!=p.cursorEdge?this.addHandles(this.onCursorEdgeChanged(p.cursorEdge),
B.activeEdge):this.removeHandles(B.activeEdge),null!=p.outline?this.addHandles(this.onOutlineChanged(p.outline),B.outline):this.removeHandles(B.outline),null!=p.committedVertices?this.addHandles(this.onRegularVerticesChanged(p.committedVertices),B.regularVertices):this.removeHandles(B.regularVertices),null!=p.cursorVertex?this.addHandles(this.onActiveVertexChanged(p.cursorVertex),B.activeVertex):this.removeHandles(B.activeVertex),null!=p.full?this._createOrUpdateGraphic(p.full):this.removeHandles(d))}get activeTooltipInfo(){return this._coordinateFormatterLoadTask?.finished?
w.getActiveTooltipInfo(this._tooltipsContext):null}};b.__decorate([F.property()],a.DrawGraphicTool.prototype,"_coordinateFormatterLoadTask",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"_createOperationGeometry",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"_tooltipsContext",null);b.__decorate([F.property({value:!0})],a.DrawGraphicTool.prototype,"centered",null);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"cursor",null);b.__decorate([F.property({nonNullable:!0})],
a.DrawGraphicTool.prototype,"defaultZ",void 0);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"directionOptions",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"drawOperation",void 0);b.__decorate([F.property({value:!0})],a.DrawGraphicTool.prototype,"enabled",null);b.__decorate([F.property({value:!0})],a.DrawGraphicTool.prototype,"forceUniformSize",null);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"geometryType",void 0);b.__decorate([F.property()],
a.DrawGraphicTool.prototype,"graphic",null);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"graphicProperties",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"graphicSymbol",null);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"hasZ",void 0);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"geometryToPlace",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"mode",null);b.__decorate([F.property()],
a.DrawGraphicTool.prototype,"snappingManager",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"snapToScene",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"tooltip",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"tooltipInfos",void 0);b.__decorate([F.property({constructOnly:!0,type:C})],a.DrawGraphicTool.prototype,"sketchOptions",void 0);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"updating",null);b.__decorate([F.property({constructOnly:!0,
nonNullable:!0})],a.DrawGraphicTool.prototype,"view",void 0);b.__decorate([F.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"undoRedo",null);b.__decorate([F.property()],a.DrawGraphicTool.prototype,"activeTooltipInfo",null);a.DrawGraphicTool=b.__decorate([k.subclass("esri.views.draw.DrawGraphicTool")],a.DrawGraphicTool);const d=Symbol("create-operation-graphic"),B={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),
activeEdge:Symbol("active-edge-visual")};a.geometryTypeToDrawOperationGeometryType=function(p){switch(p){case "point":case "polyline":case "polygon":case "multipoint":return p;case "circle":case "rectangle":return"segment";case "mesh":return"point"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/UndoRedo":function(){define("exports ./chunks/tslib.es6 ./core/Accessor ./core/Collection ./core/reactiveUtils ./core/accessorSupport/decorators/property ./core/has ./core/Logger ./core/RandomLCG ./core/accessorSupport/decorators/subclass ./core/support/UpdatingHandles ./undoredo/OperationStatus ./undoredo/UndoableOperation ./undoredo/UndoRedoError".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){a.UndoRedo=class extends g{constructor(){super(...arguments);this._stack=new f;this._stackPosition=-1;this._updatingHandles=new E.UpdatingHandles}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return 0<=this._stackPosition}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+
1,this._stack.length-this._stackPosition).forEach(m=>m.destroy())}_drainStack(){this._stack.drain(m=>m.destroy());this._stackPosition=-1}async undo(){if(!this.hasUndo)throw new k.UndoInvalidError;if(this.updating)throw new k.UndoRedoUpdatingError;const m=this._stack.getItemAt(this._stackPosition);m&&await this._updatingHandles.addPromise((async()=>{await m.executeUndoRedoOperation(c.UndoRedoExecutionMethod.Undo);--this._stackPosition;m.canRedo||this._truncateForwardStack()})())}async redo(){if(!this.hasRedo)throw new k.RedoInvalidError;
if(this.updating)throw new k.UndoRedoUpdatingError;const m=this._stack.getItemAt(this._stackPosition+1);if(!m)throw new k.RedoInvalidError;await this._updatingHandles.addPromise((async()=>{await m.executeUndoRedoOperation(c.UndoRedoExecutionMethod.Redo);++this._stackPosition})())}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}async inject(m){if(this.updating)throw new k.UndoRedoUpdatingError;
await this._updatingHandles.addPromise((async()=>{m.status===q.OperationStatus.NeverApplied&&await m.executeUndoRedoOperation(c.UndoRedoExecutionMethod.Apply);m.canUndo?(this._stack.splice(this._stackPosition+1,0,m),this._stackPosition++):-1<this._stackPosition&&(this._stack.splice(0,this._stackPosition+1).forEach(l=>l.destroy()),this._stackPosition=-1)})())}async add(m){if(this.updating)throw new k.UndoRedoUpdatingError;await this._updatingHandles.addPromise((async()=>{m.status===q.OperationStatus.NeverApplied&&
await m.executeUndoRedoOperation(c.UndoRedoExecutionMethod.Apply);-1<=this._stackPosition&&this._truncateForwardStack();m.canUndo?(this._stack.push(m),this._stackPosition=this._stack.length-1):this._drainStack()})())}async removeTagged(m,l=!1){if(!this.updating||l){await e.whenOnce(()=>!this.updating);l=new f;for(let r=0;r<this._stack.length;r++){const z=this._stack.getItemAt(r);z&&(z.tag===m?(z.destroy(),r===this._stackPosition&&(this._stackPosition=l.length-1)):l.push(z))}this._stack=l;this._stackPosition>
l.length-1&&(this._stackPosition=l.length-1)}}async clear(m=!1){if(this.updating&&!m)throw new k.UndoRedoUpdatingError;await e.whenOnce(()=>!this.updating);this._drainStack()}};b.__decorate([n.property()],a.UndoRedo.prototype,"_stack",void 0);b.__decorate([n.property()],a.UndoRedo.prototype,"_stackPosition",void 0);b.__decorate([n.property()],a.UndoRedo.prototype,"updating",null);b.__decorate([n.property({readOnly:!0})],a.UndoRedo.prototype,"canUndo",null);b.__decorate([n.property({readOnly:!0})],
a.UndoRedo.prototype,"hasUndo",null);b.__decorate([n.property({readOnly:!0})],a.UndoRedo.prototype,"canRedo",null);b.__decorate([n.property({readOnly:!0})],a.UndoRedo.prototype,"hasRedo",null);a.UndoRedo=b.__decorate([F.subclass("esri.UndoRedo")],a.UndoRedo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/undoredo/OperationStatus":function(){define(["exports"],function(a){a.OperationStatus=void 0;var b=a.OperationStatus||(a.OperationStatus={});b[b.NeverApplied=0]="NeverApplied";
b[b.Applied=1]="Applied";b[b.Undone=2]="Undone";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/undoredo/UndoableOperation":function(){define("exports ../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./OperationStatus ./UndoRedoError".split(" "),function(a,b,g,f,e,n,u,v,t,F){a.UndoRedoExecutionMethod=void 0;(function(E){E[E.Apply=0]="Apply";E[E.Undo=1]="Undo";
E[E.Redo=2]="Redo"})(a.UndoRedoExecutionMethod||(a.UndoRedoExecutionMethod={}));a.UndoableOperation=class extends g{constructor(){super(...arguments);this.name="";this.tag=Symbol();this.status=t.OperationStatus.NeverApplied}get canUndo(){return this.status===t.OperationStatus.Applied}get canRedo(){return this.status===t.OperationStatus.Undone}async executeUndoRedoOperation(E){switch(E){case a.UndoRedoExecutionMethod.Apply:if(this.status!==t.OperationStatus.NeverApplied)throw new F.ApplyInvalidError;
await this.apply();this.status=t.OperationStatus.Applied;break;case a.UndoRedoExecutionMethod.Undo:if(this.status!==t.OperationStatus.Applied)throw new F.UndoInvalidError;await this.undo();this.status=t.OperationStatus.Undone;break;case a.UndoRedoExecutionMethod.Redo:if(this.status!==t.OperationStatus.Undone)throw new F.UndoInvalidError;await this.redo();this.status=t.OperationStatus.Applied}}};b.__decorate([f.property()],a.UndoableOperation.prototype,"name",void 0);b.__decorate([f.property()],a.UndoableOperation.prototype,
"tag",void 0);a.UndoableOperation=b.__decorate([v.subclass("esri.undoredo.UndoableOperation")],a.UndoableOperation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/undoredo/UndoRedoError":function(){define(["exports"],function(a){a.UndoRedoErrorCodes=void 0;(function(u){u.UndoRedoUpdating="UndoRedoUpdating";u.UndoInvalidError="UndoInvalidError";u.RedoInvalidError="RedoInvalidError";u.ApplyInvalidError="ApplyInvalidError"})(a.UndoRedoErrorCodes||(a.UndoRedoErrorCodes={}));const b=
{[a.UndoRedoErrorCodes.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[a.UndoRedoErrorCodes.UndoInvalidError]:"There are no items to Undo",[a.UndoRedoErrorCodes.RedoInvalidError]:"There are no items to Redo",[a.UndoRedoErrorCodes.ApplyInvalidError]:"Cannot apply an item that is already applied"};class g extends Error{constructor(){super(b[a.UndoRedoErrorCodes.UndoRedoUpdating]);this.type="undo-redo-updating-error"}}class f extends Error{constructor(){super(b[a.UndoRedoErrorCodes.UndoInvalidError]);
this.type="undo-redo-undo-error"}}class e extends Error{constructor(){super(b[a.UndoRedoErrorCodes.RedoInvalidError]);this.type="undo-redo-redo-error"}}class n extends Error{constructor(){super(b[a.UndoRedoErrorCodes.ApplyInvalidError]);this.type="undo-redo-apply-error"}}a.ApplyInvalidError=n;a.RedoInvalidError=e;a.UndoInvalidError=f;a.UndoRedoErrorMessages=b;a.UndoRedoUpdatingError=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/coordinateFormatter":function(){define("exports ../core/Error ../chunks/pe ./Point ./SpatialReference ../intl/number".split(" "),
function(a,b,g,f,e,n){function u(){return g.isLoaded()}function v(q,c){const k=[];q=q.replaceAll(/[\u00B0\u00BA]/g,"^");q=q.replaceAll("\u2032","'");q=q.replaceAll("\u2033",'"');const m=t(c);return g.PeNotationDms.dmsToGeog(m,1,[q],k)?new f(k[0][0],k[0][1],c||e.WGS84):null}function t(q){let c=null;q||(q=e.WGS84);if(q.wkid){if(c=g.PeFactory.geogcs(q.wkid),!c)throw new b("coordinate-formatter:invalid-spatial-reference","wkid is not valid");}else if(q.wkt2||q.wkt){if(c=g.PeFactory.fromString(g.PeDefs.PE_TYPE_GEOGCS,
q.wkt2||q.wkt),!c)throw new b("coordinate-formatter:invalid-spatial-reference","wkt is not valid");}else throw new b("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");return c}function F(q){let c=-1;switch(q){case "automatic":c=g.PeNotationMgrs.PE_MGRS_STYLE_AUTO;break;case "new-180-in-zone-01":c=g.PeNotationMgrs.PE_MGRS_STYLE_NEW|g.PeNotationMgrs.PE_MGRS_180_ZONE_1_PLUS;break;case "new-180-in-zone-60":c=g.PeNotationMgrs.PE_MGRS_STYLE_NEW;break;case "old-180-in-zone-01":c=
g.PeNotationMgrs.PE_MGRS_STYLE_OLD|g.PeNotationMgrs.PE_MGRS_180_ZONE_1_PLUS;break;case "old-180-in-zone-60":c=g.PeNotationMgrs.PE_MGRS_STYLE_OLD}return c}function E(q){let c=-1;switch(q){case "latitude-band-indicators":c=g.PeNotationUtm.PE_UTM_OPTS_NONE;break;case "north-south-indicators":c=g.PeNotationUtm.PE_UTM_OPTS_NS}return c}a.fromLatitude=function(q){return q&&u()?n.parseNumber(q)??v(`${q} | 0\u00b0 0' 0" E`)?.latitude??v(`${q} | 0`)?.latitude??null:null};a.fromLatitudeLongitude=v;a.fromLongitude=
function(q){return q&&u()?n.parseNumber(q)??v(`0\u00b0 0' 0" N | ${q}`)?.longitude??v(`0 | ${q}`)?.longitude??null:null};a.fromMgrs=function(q,c,k){const m=[],l=F(k);if(-1===l)return console.warn(`invalid conversionMode: ${k}`),null;k=t(c);return g.PeNotationMgrs.mgrsToGeogExtended(k,1,[q],l,m)?new f(m[0][0],m[0][1],c||e.WGS84):null};a.fromUsng=function(q,c){const k=[];!c&&/\(.+27/.test(q)&&(c=e.GCS_NAD_1927);const m=t(c);return g.PeNotationUsng.usngToGeog(m,1,[q],k)?new f(k[0][0],k[0][1],c||e.WGS84):
null};a.fromUtm=function(q,c,k){const m=[],l=E(k);if(-1===l)return console.warn(`invalid conversionMode: ${k}`),null;k=t(c);return g.PeNotationUtm.utmToGeog(k,1,[q],l,m)?new f(m[0][0],m[0][1],c||e.WGS84):null};a.isLoaded=u;a.isSupported=function(){return g.isSupported()};a.load=function(){return g.load()};a.toLatitudeLongitude=function(q,c,k=0){const m=[[q.x,q.y]],l=[];q=t(q.spatialReference);let r=0;switch(c){case "dd":r=g.PeNotationDms.geogToDd(q,1,m,k,l);break;case "ddm":r=g.PeNotationDms.geogToDdm(q,
1,m,k,l);break;case "dms":r=g.PeNotationDms.geogToDms(q,1,m,k,l);break;default:return console.warn(`invalid format: ${c}`),null}return r?l[0]:null};a.toMgrs=function(q,c,k=0,m=!1){const l=[[q.x,q.y]],r=[];q=t(q.spatialReference);let z=F(c);if(-1===z)return console.warn(`invalid conversionMode: ${c}`),null;m&&(z|=g.PeNotationMgrs.PE_MGRS_ADD_SPACES);return g.PeNotationMgrs.geogToMgrsExtended(q,1,l,k,!1,z,r)?r[0]:null};a.toUsng=function(q,c=0,k=!1){const m=[[q.x,q.y]],l=[];q=t(q.spatialReference);return g.PeNotationUsng.geogToUsng(q,
1,m,c,!1,k,l)?l[0]:null};a.toUtm=function(q,c,k=!1){const m=[[q.x,q.y]],l=[];q=t(q.spatialReference);let r=E(c);if(-1===r)return console.warn(`invalid conversionMode: ${c}`),null;k&&(r|=g.PeNotationUtm.PE_UTM_OPTS_ADD_SPACES);return g.PeNotationUtm.geogToUtm(q,1,m,r,l)?l[0]:null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){g=class extends t.BlendLayer(F.ScaleRangeLayer(v)){constructor(c){super(c);this.elevationInfo=null;this.graphics=new E.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(c){this.graphics.add(c);return this}addMany(c){this.graphics.addMany(c);return this}removeAll(){this.graphics.removeAll();return this}remove(c){this.graphics.remove(c)}removeMany(c){this.graphics.removeMany(c)}on(c,
k){return super.on(c,k)}graphicChanged(c){this.emit("graphic-update",c)}};a.__decorate([b.property({type:q})],g.prototype,"elevationInfo",void 0);a.__decorate([b.property(u.owningCollectionProperty(E.GraphicsCollection,"graphics"))],g.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],g.prototype,"listMode",void 0);a.__decorate([b.property()],g.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],g.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
g.prototype,"internal",void 0);return g=a.__decorate([n.subclass("esri.layers.GraphicsLayer")],g)})},"esri/views/draw/support/CreateOperationGeometry":function(){define(["exports"],function(a){class b{constructor(){this.rectangle=this.circle=this.cursorEdge=this.outline=this.full=this.cursorVertex=this.committedVertices=null}}a.CreateOperationGeometry=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/createUtils":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils ./surfaceCoordinateSystems ../../../geometry/Point ../../../geometry/Multipoint ../../../geometry/Polyline ../../../geometry/Polygon".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l){function r(h,y){y=new c({x:h[0],y:h[1],spatialReference:y});2<h.length&&(y.z=h[2]);return y}function z(h,y,d,B=!0){h=f.clone(h);h.forEach(p=>{g.equals(p[0],p[p.length-1])&&1!==p.length||p.push(p[0])});h=new l({rings:h,spatialReference:y});h.rings.forEach(p=>{F.isClockwise(p)||p.reverse()});d&&F.unnormalizeGeometryOnDatelineCrossing(h);B&&h.isSelfIntersecting&&E.isValid(y)&&(h=t.simplify(h));return h}function H(h,y,d){const B=D(y[3],y[2],d),p=D(y[1],y[2],d),
A=D(y[0],y[1],d);y=D(y[0],y[3],d);return{geometry:h,midpoints:null!=B&&null!=p&&null!=A&&null!=y?{top:B,right:p,bottom:A,left:y}:null}}function D(h,y,d){x[0]=h.x;x[1]=h.y;x[2]=0;C[0]=y.x;C[1]=y.y;C[2]=0;n.lerp(x,x,C,.5);w.x=x[0];w.y=C[1];w.z=C[2];h=d.localToMap(w);return null!=h?r(h,d.spatialReference):null}const w=q.makeSurfacePoint(0,0,0),x=u.create(),C=u.create();a.createCircle=function(h,y,d,B){var p=y.mapToLocalMultiple(h),A=h=null;d?(h=p[0],A=p[1]):(h=p[0],d=p[1],A=Math.round(d.x-h.x),d=Math.round(d.y-
h.y),p=Math.max(Math.abs(A),Math.abs(d)),h=q.makeSurfacePoint(0<A?h.x+p/2:h.x-p/2,0<d?h.y+p/2:h.y-p/2),A=q.makeSurfacePoint(Math.abs(A)>Math.abs(d)?h.x-p/2:h.x,Math.abs(A)>Math.abs(d)?h.y:h.y-p/2));d=y.localToMap(h);p=y.localToMap(A);if(null==d||null==p)return null;y.doUnnormalization&&F.unnormalizeVerticesOnDatelineCrossing([[d,p]],y.spatialReference);d=r(d,y.spatialReference);p=r(p,y.spatialReference);const G=e.getMetersPerUnitForSR(y.spatialReference);var I=0;E.isValid(y.spatialReference)?I=G*
t.distance(d,p,null):(I=h.x-A.x,h=h.y-A.y,I=G*Math.sqrt(I*I+h*h)*(B||1));y=new v({center:d,radius:I,radiusUnit:"meters",spatialReference:y.spatialReference});return{geometry:z(y.rings,y.spatialReference,!1),center:d,edge:p}};a.createEllipse=function(h,y,d){function B(K){return q.makeSurfacePoint(I*Math.cos(K)+G.x,J*Math.sin(K)+G.y)}var p=y.mapToLocalMultiple(h);h=p[0];var A=p[1];p=Math.round(A.x-h.x);A=Math.round(A.y-h.y);const G=q.makeSurfacePoint(d?h.x:h.x+p/2,d?h.y:h.y+A/2),I=d?p:p/2,J=d?A:A/2;
d=[];h=2*Math.PI/60;for(p=0;60>p;p++)d.push(B(p*h));d.push(d[0]);const {spatialReference:L,doUnnormalization:M}=y;d=z([d.map(K=>y.localToMap(K)).filter(g.isSome)],L,M,!1);h=y.localToMap(B(Math.PI/2));p=y.localToMap(B(0));A=y.localToMap(B(-Math.PI/2));const N=y.localToMap(B(Math.PI));return{geometry:d,midpoints:null!=h&&null!=p&&null!=A&&null!=N?{top:r(h,L),right:r(p,L),bottom:r(A,L),left:r(N,L)}:null}};a.createMultipoint=function(h,y){return new k({points:h,spatialReference:y})};a.createPoint=r;a.createPolygon=
z;a.createPolyline=function(h,y,d){h=new m({paths:h,spatialReference:y});d&&F.unnormalizeGeometryOnDatelineCrossing(h);return h};a.createRectangle=function(h,y,d){var B=y.mapToLocalMultiple(h);1===B.length&&(h=B[0],B=[q.makeSurfacePoint(h.x-48,h.y+48),q.makeSurfacePoint(h.x+48,h.y-48),q.makeSurfacePoint(h.x+48,h.y-48),q.makeSurfacePoint(h.x-48,h.y+48)]);h=[];var p=B[0].x,A=B[0].y,G=B[1].x;B=B[1].y;if(d){d=Math.round(G-p);const I=Math.round(B-A);h.push(q.makeSurfacePoint(p-d,A-I),q.makeSurfacePoint(G,
A-I),q.makeSurfacePoint(G,B),q.makeSurfacePoint(p-d,B))}else h.push(q.makeSurfacePoint(p,A),q.makeSurfacePoint(G,A),q.makeSurfacePoint(G,B),q.makeSurfacePoint(p,B));d=z([h.map(I=>y.localToMap(I)).filter(g.isSome)],y.spatialReference,y.doUnnormalization,!0);return H(d,h,y)};a.createSquare=function(h,y,d){var B=y.mapToLocalMultiple(h);h=[];var p=B[0].x,A=B[0].y,G=Math.round(B[1].x-p);const I=Math.round(B[1].y-A);B=Math.max(Math.abs(G),Math.abs(I));d?(d=p+B,G=A+B,p-=B,A-=B,h.push(q.makeSurfacePoint(d,
A),q.makeSurfacePoint(p,A),q.makeSurfacePoint(p,G),q.makeSurfacePoint(d,G))):(d=0<G?p+B:p-B,B=0<I?A+B:A-B,h.push(q.makeSurfacePoint(p,A),q.makeSurfacePoint(d,A),q.makeSurfacePoint(d,B),q.makeSurfacePoint(p,B)));A=z([h.map(J=>y.localToMap(J)).filter(g.isSome)],y.spatialReference,y.doUnnormalization,!0);return H(A,h,y)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./SpatialReference ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){var m;f=m=class extends F{constructor(l){super(l);this.center=null;this.geodesic=!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}initialize(){var l=this.center;const r=this.numberOfPoints;this.hasZ=l?.hasZ??!1;if(0===this.rings.length&&l){var z=b.convertUnit(this.radius,this.radiusUnit,"meters"),H=l.spatialReference,D="geographic";if(H.isWebMercator)D="webMercator";else if(null!=(H.wkid&&k[H.wkid])||(H.wkt2||H.wkt)&&b.isProjectedWKT(H.wkt2||
H.wkt))D="projected";if(this.geodesic){let w;switch(D){case "webMercator":w=c.webMercatorToGeographic(l);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":w=l}l=this._createGeodesicCircle(w,z,r);"webMercator"===D&&(l=c.geographicToWebMercator(l))}else{let w;"webMercator"===D||"projected"===D?w=z/b.getMetersPerUnit(l.spatialReference):"geographic"===D&&(w=b.lengthToDegrees(z,
"meters",v.getReferenceEllipsoid(l.spatialReference).radius));l=this._createPlanarCircle(l,w,r)}this.spatialReference=l.spatialReference;this.addRing(l.rings[0])}}clone(){const {center:l,numberOfPoints:r,radius:z,radiusUnit:H,geodesic:D}=this;return new m({center:l?.clone(),numberOfPoints:r,radius:z,radiusUnit:H,geodesic:D})}_createGeodesicCircle(l,r,z){let H=0;const D=[];for(;360>H;){const w=[0,0];q.directGeodeticSolver(w,[l.x,l.y],H,r,E.WGS84);this.hasZ&&w.push(l.z);D.push(w);H+=360/z}D.push(D[0]);
return new F({rings:[D]})}_createPlanarCircle(l,r,z){const H=[],D=2*Math.PI/z;for(let x=0;x<z;++x){var w=D*x;w=[l.x+Math.cos(-w)*r,l.y+Math.sin(-w)*r];this.hasZ&&w.push(l.z);H.push(w)}H.push(H[0]);return new F({spatialReference:l.spatialReference,rings:[H]})}};a.__decorate([g.property({type:t})],f.prototype,"center",void 0);a.__decorate([g.property()],f.prototype,"geodesic",void 0);a.__decorate([g.property()],f.prototype,"numberOfPoints",void 0);a.__decorate([g.property()],f.prototype,"radius",void 0);
a.__decorate([g.property()],f.prototype,"radiusUnit",void 0);return f=m=a.__decorate([u.subclass("esri.geometry.Circle")],f)})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/libs/gl-matrix-2/math/mat2d ../../../core/libs/gl-matrix-2/factories/mat2df64 ../../../core/libs/gl-matrix-2/math/quat ../../../core/libs/gl-matrix-2/factories/quatf64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/Axis ../../../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){function q(r,z,H=null){return null!=H?[r,z,H]:[r,z]}function c(r,z,H=null){return null!=H?{x:r,y:z,z:H}:{x:r,y:z}}class k{constructor(r){this.spatialReference=r}mapToLocalMultiple(r){return r.map(z=>this.mapToLocal(z)).filter(g.isSome)}get doUnnormalization(){return!1}}class m extends k{constructor(r,z,H=null){super(z);this._defaultZ=H;this.transform=e.create();this.transformInv=e.create();this.transform=e.clone(r);f.invert(this.transformInv,this.transform)}makeMapPoint(r,
z){return q(r,z,this._defaultZ)}mapToLocal(r){return c(this.transform[0]*r[0]+this.transform[2]*r[1]+this.transform[4],this.transform[1]*r[0]+this.transform[3]*r[1]+this.transform[5])}localToMap(r){return q(this.transformInv[0]*r.x+this.transformInv[2]*r.y+this.transformInv[4],this.transformInv[1]*r.x+this.transformInv[3]*r.y+this.transformInv[5],this._defaultZ)}}class l extends k{constructor(r,z){super(r.spatialReference);this.view=r;this.defaultZ=null;this.pWS=t.create();this.tangentFrameUpWS=t.create();
this.tangentFrameRightWS=t.create();this.tangentFrameForwardWS=t.create();this.localFrameRightWS=t.create();this.localFrameUpWS=t.create();this.worldToLocalTransform=u.create();this.localToWorldTransform=u.create();this.scale=1;this.scale=r.resolution;this.referenceMapPoint=z;this.defaultZ=z.hasZ?z.z:null;r=r.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,F.Axis.X,this.tangentFrameRightWS);
this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,F.Axis.Y,this.tangentFrameUpWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,F.Axis.Z,this.tangentFrameForwardWS);z=t.create();v.scale(z,this.tangentFrameForwardWS,v.dot(r,this.tangentFrameForwardWS));v.subtract(this.localFrameRightWS,r,z);v.normalize(this.localFrameRightWS,this.localFrameRightWS);v.cross(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS);n.rotationTo(this.worldToLocalTransform,this.localFrameRightWS,
this.tangentFrameRightWS);n.invert(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(r,z){return q(r,z,this.defaultZ)}mapToLocal(r){const z=t.create();this.view.renderCoordsHelper.toRenderCoords(new E({x:r[0],y:r[1],spatialReference:this.spatialReference}),z);v.transformQuat(z,z,this.worldToLocalTransform);r=this.view.renderCoordsHelper.fromRenderCoords(z,new E({spatialReference:this.view.spatialReference}));return null!=
r?c(r.x/this.scale,r.y/this.scale):null}localToMap(r){const z=t.create();this.view.renderCoordsHelper.toRenderCoords(new E({x:r.x*this.scale,y:r.y*this.scale,spatialReference:this.spatialReference}),z);v.transformQuat(z,z,this.localToWorldTransform);r=this.view.renderCoordsHelper.fromRenderCoords(z,new E({spatialReference:this.view.spatialReference}));return null!=r?q(r.x,r.y,this.defaultZ):null}}a.AffineCoordinateSystem=m;a.SceneViewCoordinateSystem=l;a.SurfaceCoordinateSystem=k;a.createViewAlignedCoordinateSystem=
function(r,z){return"2d"===r.type?new m(r.state.transform,r.spatialReference,2<z.length?z[2]:null):"3d"===r.type?(z=2<z.length?new E({x:z[0],y:z[1],z:z[2],spatialReference:r.spatialReference}):new E({x:z[0],y:z[1],spatialReference:r.spatialReference}),new l(r,z)):null};a.makeMapPoint=q;a.makeSurfacePoint=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(a,b){function g(h,y){h[0]=y[0];h[1]=y[1];
h[2]=y[2];h[3]=y[3];h[4]=y[4];h[5]=y[5];return h}function f(h){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=0;h[5]=0;return h}function e(h,y,d,B,p,A,G){h[0]=y;h[1]=d;h[2]=B;h[3]=p;h[4]=A;h[5]=G;return h}function n(h,y){const d=y[0],B=y[1],p=y[2],A=y[3],G=y[4];y=y[5];let I=d*A-B*p;if(!I)return null;I=1/I;h[0]=A*I;h[1]=-B*I;h[2]=-p*I;h[3]=d*I;h[4]=(p*y-A*G)*I;h[5]=(B*G-d*y)*I;return h}function u(h){return h[0]*h[3]-h[1]*h[2]}function v(h,y,d){const B=y[0],p=y[1],A=y[2],G=y[3],I=y[4];y=y[5];const J=d[0],L=d[1],
M=d[2],N=d[3],K=d[4];d=d[5];h[0]=B*J+A*L;h[1]=p*J+G*L;h[2]=B*M+A*N;h[3]=p*M+G*N;h[4]=B*K+A*d+I;h[5]=p*K+G*d+y;return h}function t(h,y,d){const B=y[0],p=y[1],A=y[2],G=y[3],I=y[4];y=y[5];const J=Math.sin(d);d=Math.cos(d);h[0]=B*d+A*J;h[1]=p*d+G*J;h[2]=B*-J+A*d;h[3]=p*-J+G*d;h[4]=I;h[5]=y;return h}function F(h,y,d){const B=y[1],p=y[2],A=y[3],G=y[4],I=y[5],J=d[0];d=d[1];h[0]=y[0]*J;h[1]=B*J;h[2]=p*d;h[3]=A*d;h[4]=G;h[5]=I;return h}function E(h,y,d){const B=y[0],p=y[1],A=y[2],G=y[3],I=y[4];y=y[5];const J=
d[0];d=d[1];h[0]=B;h[1]=p;h[2]=A;h[3]=G;h[4]=B*J+A*d+I;h[5]=p*J+G*d+y;return h}function q(h,y){const d=Math.sin(y);y=Math.cos(y);h[0]=y;h[1]=d;h[2]=-d;h[3]=y;h[4]=0;h[5]=0;return h}function c(h,y){h[0]=y[0];h[1]=0;h[2]=0;h[3]=y[1];h[4]=0;h[5]=0;return h}function k(h,y){h[0]=1;h[1]=0;h[2]=0;h[3]=1;h[4]=y[0];h[5]=y[1];return h}function m(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"}function l(h){return Math.sqrt(h[0]**2+h[1]**2+h[2]**2+h[3]**2+h[4]**2+h[5]**2+1)}function r(h,
y,d){h[0]=y[0]+d[0];h[1]=y[1]+d[1];h[2]=y[2]+d[2];h[3]=y[3]+d[3];h[4]=y[4]+d[4];h[5]=y[5]+d[5];return h}function z(h,y,d){h[0]=y[0]-d[0];h[1]=y[1]-d[1];h[2]=y[2]-d[2];h[3]=y[3]-d[3];h[4]=y[4]-d[4];h[5]=y[5]-d[5];return h}function H(h,y,d){h[0]=y[0]*d;h[1]=y[1]*d;h[2]=y[2]*d;h[3]=y[3]*d;h[4]=y[4]*d;h[5]=y[5]*d;return h}function D(h,y,d,B){h[0]=y[0]+d[0]*B;h[1]=y[1]+d[1]*B;h[2]=y[2]+d[2]*B;h[3]=y[3]+d[3]*B;h[4]=y[4]+d[4]*B;h[5]=y[5]+d[5]*B;return h}function w(h,y){return h[0]===y[0]&&h[1]===y[1]&&h[2]===
y[2]&&h[3]===y[3]&&h[4]===y[4]&&h[5]===y[5]}function x(h,y){const d=h[0],B=h[1],p=h[2],A=h[3],G=h[4];h=h[5];const I=y[0],J=y[1],L=y[2],M=y[3],N=y[4];y=y[5];const K=b.getEpsilon();return Math.abs(d-I)<=K*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(B-J)<=K*Math.max(1,Math.abs(B),Math.abs(J))&&Math.abs(p-L)<=K*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(A-M)<=K*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(G-N)<=K*Math.max(1,Math.abs(G),Math.abs(N))&&Math.abs(h-y)<=K*Math.max(1,Math.abs(h),Math.abs(y))}
const C=Object.freeze(Object.defineProperty({__proto__:null,add:r,copy:g,determinant:u,equals:x,exactEquals:w,frob:l,fromRotation:q,fromScaling:c,fromTranslation:k,identity:f,invert:n,mul:v,multiply:v,multiplyScalar:H,multiplyScalarAndAdd:D,rotate:t,scale:F,set:e,str:m,sub:z,subtract:z,translate:E},Symbol.toStringTag,{value:"Module"}));a.add=r;a.copy=g;a.determinant=u;a.equals=x;a.exactEquals=w;a.frob=l;a.fromRotation=q;a.fromScaling=c;a.fromTranslation=k;a.identity=f;a.invert=n;a.mat2d=C;a.mul=v;
a.multiply=v;a.multiplyScalar=H;a.multiplyScalarAndAdd=D;a.rotate=t;a.scale=F;a.set=e;a.str=m;a.sub=z;a.subtract=z;a.translate=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["exports"],function(a){function b(){return[1,0,0,1,0,0]}function g(v){return[v[0],v[1],v[2],v[3],v[4],v[5]]}function f(v,t,F,E,q,c){return[v,t,F,E,q,c]}function e(v,t){return new Float64Array(v,t,6)}const n=b(),u=Object.freeze(Object.defineProperty({__proto__:null,
IDENTITY:n,clone:g,create:b,createView:e,fromValues:f},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=n;a.clone=g;a.create=b;a.createView=e;a.fromValues=f;a.mat2df64=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/tooltipUtils":function(){define("exports ../../../core/quantityUtils ../../../core/unitUtils ../../../support/elevationInfoUtils ./helpMessageUtils ./helpMessageUtils3d ../../interactive/sketch/constraintUtils ../../interactive/tooltip/tooltipCommonUtils ../../interactive/tooltip/infos/DrawCircleTooltipInfo ../../interactive/tooltip/infos/DrawMeshTooltipInfo ../../interactive/tooltip/infos/DrawPointTooltipInfo ../../interactive/tooltip/infos/DrawPolygonTooltipInfo ../../interactive/tooltip/infos/DrawPolylineTooltipInfo ../../interactive/tooltip/infos/DrawRectangleTooltipInfo ../../support/angularMeasurementUtils ../../support/automaticAreaMeasurementUtils ../../support/automaticLengthMeasurementUtils ../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){function H({geometryType:I,graphic:J,tooltipInfos:L}){return"multipoint"===I||J?.geometry?.type!==G[I]?null:L[I]}function D(I,J,L){const {drawOperation:M,view:N,sketchOptions:K}=L,{cursorVertex:O}=M;I.sketchOptions=K;I.viewType=N.type;I.setLocationFromPoint(J,L.drawOperation.coordinateHelper.spatialReference);C(I.elevation,L);M.constraints=O?{context:A(O,L),x:I.x.committed,y:I.y.committed,longitude:I.longitude.committed,latitude:I.latitude.committed,elevation:I.elevation.committed,
distance:null,direction:null}:void 0}function w(I,J){const {drawOperation:L,sketchOptions:M,view:N}=J,{cursorVertex:K,lastVertex:O,secondToLastVertex:U}=L;var V=M.values.effectiveDirectionMode;I.sketchOptions=M;I.viewType=N.type;const ea=O&&K?r.autoDistanceBetweenPoints2D(O,K)??b.zeroMeters:null;I.distance.actual=ea;I.distance.readOnly=null==O;I.direction.actual=null;I.direction.readOnly=!0;O&&K&&("absolute"===V||U)&&(V=m.directionForVertices(U,O,K,V),I.direction.actual=V??b.zeroDegreesGeographic,
I.direction.readOnly=!1);I.setLocationFromPoint(K,J.drawOperation.coordinateHelper.spatialReference);C(I.elevation,J);V=x(O,J);I.xyMode=V;I.direction.visible="direction-distance"===V;I.distance.visible="direction-distance"===V;I.effectiveX.visible="coordinates"===V;I.effectiveY.visible="coordinates"===V;V=K??O;L.constraints=V?{context:A(V,J),x:I.x.committed,y:I.y.committed,longitude:I.longitude.committed,latitude:I.latitude.committed,elevation:I.elevation.committed,distance:I.distance.committed,direction:I.direction.committed}:
void 0}function x(I,{sketchOptions:J}){J=J.tooltips.xyMode;return"auto"===J?I?"direction-distance":"coordinates":J}function C(I,J){const {drawOperation:L}=J;I.actual=z.elevationFromPoint(L?.cursorVertex??L?.lastVertex)??p(J);I.visible=L.hasZ;I.readOnly=!1;I.showAsZ=!0}function h(I){I=I.createOperationGeometry?.full;return"polygon"!==I?.type?b.zeroSquareMeters:l.autoArea2D(I)??b.zeroSquareMeters}function y(I){I=I.createOperationGeometry?.rectangle?.midpoints;return(null!=I?r.autoDistanceBetweenPoints2D(I.left,
I.right):null)??b.zeroMeters}function d(I){I=I.createOperationGeometry?.rectangle?.midpoints;return(null!=I?r.autoDistanceBetweenPoints2D(I.top,I.bottom):null)??b.zeroMeters}function B({createOperationGeometry:I}){return(null!=I?.circle?.center&&null!=I.circle.edge?r.autoDistanceBetweenPoints2D(I.circle.center,I.circle.edge):null)??b.zeroMeters}function p(I){const J=g.getMetersPerVerticalUnitForSR(I.drawOperation.coordinateHelper.spatialReference);return b.createLength(I.defaultZ*J,"meters")}function A(I,
J){return u.getConstraintContext(I,J.view,J.drawOperation.coordinateHelper.spatialReference,J.drawOperation.elevationInfo??f.absoluteHeightElevationInfo,J.drawOperation.coordinateHelper.hasZ(),J.sketchOptions.values.effectiveDirectionMode)}const G={point:"point",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon"};a.createTooltipInfos=function(I,J){return{point:new E.DrawPointTooltipInfo({sketchOptions:J,viewType:I}),polyline:new c.DrawPolylineTooltipInfo({sketchOptions:J,
viewType:I}),polygon:new q.DrawPolygonTooltipInfo({sketchOptions:J,viewType:I}),mesh:new F.DrawMeshTooltipInfo({sketchOptions:J,viewType:I}),rectangle:new k.DrawRectangleTooltipInfo({sketchOptions:J}),circle:new t.DrawCircleTooltipInfo({sketchOptions:J})}};a.getActiveTooltipInfo=H;a.getConstraintZ=function(I){const {geometryType:J,tooltipInfos:L}=I;switch(J){case "point":case "mesh":case "polyline":case "polygon":const M=L[J].elevation.committed;return M?b.valueInUnit(M,"meters")/g.getMetersPerVerticalUnitForSR(I.drawOperation.coordinateHelper.spatialReference):
void 0}};a.initializeConstraints=function(I){const {directionOptions:J,geometryType:L,sketchOptions:M,tooltipInfos:N}=I,K=U=>{const V=(I.drawOperation.elevationInfo??f.absoluteHeightElevationInfo).mode;U=N[U].elevation;"relative-to-ground"===V||"relative-to-scene"===V||"on-the-ground"===V?U.lock(p(I)):U.unlock()},O=U=>{J&&(U=N[U].direction,U.committed=J.angle,U.unlockOnVertexPlacement=!1,M.values.directionMode=J.mode)};switch(L){case "polygon":case "polyline":K(L);O(L);break;case "point":case "mesh":K(L)}};
a.lockElevationOnVertexAdd=function(I,J){const {drawOperation:L,view:M}=J,N=H(J);var K=J.drawOperation.elevationInfo??f.absoluteHeightElevationInfo;if("2d"!==M.type&&I&&"absolute-height"===K.mode&&1===L?.numCommittedVertices&&N&&("draw-polyline"===N.type||"draw-polygon"===N.type)&&!N.elevation.locked){var [O,U,V]=I;{var ea=V;const {view:Y,drawOperation:ra}=J;"3d"===Y.type&&ra?(ea??=0,I=J.drawOperation.coordinateHelper.spatialReference,K=f.getConvertedElevationFromXYZ(Y,O,U,ea,I,J.drawOperation.elevationInfo??
f.absoluteHeightElevationInfo,K),J=z.elevationFromZ(K,I)??p(J)):J=void 0}null!=J&&N.elevation.lock(J)}};a.unlockConstraintsOnVertexAddOrRemove=function(I){H(I)?.allFields.forEach(J=>{J.unlockOnVertexPlacement&&J.unlock()})};a.updateTooltipInfo=function(I,J){switch(I?.type){case "draw-point":var L=J.graphic?.geometry;"point"===L?.type&&(D(I,L,J),I.helpMessage=e.getDrawHelpMessage("point",L));break;case "draw-polyline":{const {createOperationGeometry:K,drawOperation:O}=J;L=null!=K?K.full:null;L&&"polyline"!==
L.type||(w(I,J),I.totalLength.actual=O.lastVertex?(L?r.autoLength2D(L):null)??b.zeroMeters:null,I.helpMessage=e.getDrawHelpMessage("polyline",L))}break;case "draw-polygon":{const {createOperationGeometry:K,drawOperation:O}=J;L=null!=K?K.full:null;L&&"polygon"!==L.type||(w(I,J),I.area.actual=O.lastVertex?(L?l.autoArea2D(L):null)??b.zeroSquareMeters:null,I.helpMessage=e.getDrawHelpMessage("polygon",L))}break;case "draw-rectangle":I.sketchOptions=J.sketchOptions;I.xSize=y(J);I.ySize=d(J);I.area=h(J);
break;case "draw-circle":const {forceUniformSize:M,sketchOptions:N}=J;I.sketchOptions=N;I.radius=M?B(J):null;I.xSize=M?null:y(J);I.ySize=M?null:d(J);I.area=h(J);break;case "draw-mesh":{const {graphic:K,view:O}=J;L=K?.geometry;"3d"!==O.type||L&&"mesh"!==L.type||(D(I,L?.origin,J),L&&v.updateTooltipInfoFromMeshTransform(I,L),I.helpMessage=n.getDrawMeshHelpMessage(K,O))}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports"],
function(a){a.getDrawHelpMessage=function(b,g){switch(b){case "point":case "multipoint":return"point";case "polyline":return 2>(null!=g&&"polyline"===g.type&&g.paths.length?g.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return b=null!=g&&"polygon"===g.type&&g.rings.length?g.rings[0].length:0,b=3>b?"polylineZeroVertices":4>b?"polygonOneVertex":"polygonTwoVertices",b}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils3d":function(){define(["exports",
"../../../core/unitUtils","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../support/elevationInfoUtils"],function(a,b,g,f,e){const n=f.create();a.getDrawMeshHelpMessage=function(u,v){var t=u?.geometry;if(u&&"mesh"===t?.type&&v){var {renderCoordsHelper:F,elevationProvider:E}=v,{camera:q}=v.state,{extent:c}=t,{center:k,spatialReference:m}=c,l=b.getMetersPerUnitForSR(m),r=b.getMetersPerVerticalUnitForSR(m),z=b.getMetersPerUnitForSR(F.spatialReference),H=(c.zmax??0)*
r;t=H-(c.zmin??0)*r;l=Math.max(c.width*l,c.height*r,t)/z;var {x:D,y:w}=k;c=k.z??0;g.set(n,D,w,c);F.toRenderCoords(n,m,n);l/=q.computeScreenPixelSizeAt(n);if(l>1*q.width)return"meshTooClose";if(20>l)return"meshTooFar";u=e.getGraphicEffectiveElevationInfo(u);({absoluteZ:v}=e.zValueInAbsoluteHeightMode(D,w,H,m,v,u));r*=E.getElevation(D,w,c,m,"ground")??0;return v<r+.1*t?"meshUnderground":"mesh"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraintUtils":function(){define("exports ../../../geometry ../../../core/quantityUtils ../../../core/unitUtils ../../../chunks/vec32 ../../../geometry/projection/projectVectorToVector ../../../geometry/support/geodesicUtils ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils ./constraints ./normalizedPoint ../../support/angularMeasurementUtils ../../../geometry/SpatialReference".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c){function k(d,B,p,A){if(null!=p&&null!=d){var G=D(d,A);if(null!=G){p=q.getDegreesGeographic(p);var I=L=>{if(null!=L){var M=E.createWritable();L=g.createAngle(L,"degrees","geographic");if(q.pointFromDistanceAlongAzimuth(M,G,A.measurementSR,10,L,A.mode))return new F.VerticalHalfPlaneConstraint(G,M)}},J=()=>{if(null!=B&&null!=d)return q.getDegreesGeographic(q.directionBetweenPoints(B,d))};switch(A.directionMode){case q.DirectionMode.Absolute:return I(p);case q.DirectionMode.Relative:return J=
J(),null==J?void 0:I(J+p);case q.DirectionMode.RelativeBilateral:return J=J(),null==J?void 0:F.constraintOrSet([I(J+p),I(J-p)])}}}}function m(d,B){d=w(d,B)?.value??void 0;return null!=d?new F.HorizontalPlaneConstraint(d):void 0}function l(d,B,p){const {context:A,longitude:G,latitude:I,direction:J,distance:L,elevation:M}=p;if(null!=G||null!=I||null!=L||null!=M||null!=J)return null!=G||null!=I?(d=q.getDegreesGeographic(G),B=q.getDegreesGeographic(I),p=w(M,A)?.value??void 0,new F.CoordinateConstraint(d,
B,p)):r(d,B,p)}function r(d,B,{context:p,direction:A,distance:G,elevation:I}){if(null==B)return m(I,p);const {view:J,elevationInfo:L,measurementSR:M}=p,N=E.fromPoint(B,J,L);if(M&&n.projectVectorToVector(N,B.spatialReference,x,M)){var [K,O]=x,U=null!=G?g.valueInUnit(G,"meters"):void 0;A=q.getDegreesGeographic(A);var V=w(I,p)?.value??void 0;I=ea=>{const Y=new F.GeodesicConstraint([K,O],M,U,V,ea);return null==U||null==ea||null==V&&p.hasZ?Y:new F.PointConstraint(Y.closestTo(N))};if(null==A)return I(void 0);
G=()=>{if(null!=d&&null!=B)return q.getDegreesGeographic(q.directionBetweenPoints(d,B))};switch(p.directionMode){case q.DirectionMode.Absolute:return I(A);case q.DirectionMode.Relative:return G=G(),null==G?void 0:I(G+A);case q.DirectionMode.RelativeBilateral:return G=G(),null==G?void 0:F.constraintOrSet([I(G+A),I(G-A)])}}}function z({x:d,y:B,elevation:p,context:A}){y.x=d?.value??0;y.y=B?.value??0;y.spatialReference=A.spatialReference;const G=D(y,A,C);return new F.CoordinateConstraint(null!=d&&null!=
G?G[0]:void 0,null!=B&&null!=G?G[1]:void 0,w(p,A)?.value??void 0)}function H(d){let B;for(const p of d)p&&(B=B?.intersect(p)??p);return B}function D(d,B,p=E.createWritable()){const {view:A,elevationInfo:G,measurementSR:I,origin:J,mode:L}=B;E.fromPoint(d,A,G,p);if(n.projectVectorToVector(p,d.spatialReference,p,I))return"geodesic"!==L&&e.subtract(p,p,J),p}function w(d,{view:B,origin:p,elevationInfo:A,hasZ:G,measurementSR:I}){if(null!=d&&G&&(G=f.verticalLengthUnitFromSpatialReference(I),null!=G)){var [J,
L]=p;d=g.valueInUnit(d,G);B="3d"===B?.type?t.getConvertedElevationFromXYZ(B,J,L,d,I,A):d;if(null!=B)return g.createLength(B,G)}}const x=E.createWritable(),C=E.createWritable(),h=E.createWritable(),y=v.makeDehydratedPoint(0,0,0,c.WGS84);a.constraintSpaceToPoint=function(d,B,p,A){const {view:G,measurementSR:I,spatialReference:J,origin:L,mode:M}=p;"geodesic"===M?e.copy(h,d):e.add(h,d,L);if(n.projectVectorToVector(h,I,h,J))return E.toElevationAlignedDehydratedPoint(h,G,B,p,A)};a.getConstraintContext=
function(d,B,p,A,G,I){let J="geodesic",L=u.geodesicCompatibleSpatialReference(p);const M=E.createWritable();E.fromPoint(d,B,A,M);M[2]=0;L&&n.projectVectorToVector(M,p,M,L)||(J="euclidean",L=p);return{mode:J,view:B,elevationInfo:A,hasZ:G,directionMode:I,spatialReference:d.spatialReference,measurementSR:L,origin:M}};a.getGeodesicConstraint=l;a.getPointConstraint=function(d){return"geodesic"===d.context.mode?l(null,null,d):z(d)};a.getPolylineOrPolygonConstraint=function(d,B,p){const {context:A,x:G,y:I,
distance:J,direction:L,elevation:M}=p;if("geodesic"===A.mode)return l(B,d,p);if(null!=G||null!=I)return z(p);if(null==J||null==d)p=void 0;else{var N=f.lengthUnitFromSpatialReference(A.measurementSR);null==N?p=void 0:(p=D(d,A),null==p?p=void 0:(N=g.valueInUnit(J,N),p=new F.VerticalCylinderConstraint(p,N)))}return H([p,k(d,B,L,A),m(M,A)])};a.intersectAll=H;a.pointToConstraintSpace=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../core/mathUtils ../../../core/libs/gl-matrix-2/math/vec2 ../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../chunks/vec42 ../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../geometry/support/geodesicConstants ../../../geometry/support/geodesicUtils ../../../geometry/support/plane ../../../chunks/sphere ../../3d/support/mathUtils ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r){function z(Q,S){if(Q instanceof Y){var na=[];for(const qa of Q.constraints)(Q=qa.intersect(S))&&na.push(Q);return B(na)}if(S instanceof Y)return z(S,Q);if(Q instanceof pa)return C(Q,S);if(S instanceof pa)return C(S,Q);if(p(Q)){({point:na}=Q);if(p(S))return n.exactEquals(na,S.point)?Q:void 0;S=S.closestTo(na);return n.equals(S,na)?Q:void 0}if(A(Q)){if(p(S))return z(S,Q);if(A(S))return y(l.intersectLineLikes(Q.lineLike,S.lineLike));if(G(S))return da(Q,S);
if(I(S))return y(l.intersectVerticalPlaneAndLineLike(S.planeLike,Q.lineLike));if(J(S))return y(l.intersectLineLikeAndVerticalCylinder(Q.lineLike,S.center,S.radius));if(M(S))return y(l.intersectLineLikeAndCircle(Q.lineLike,S));if(L(S))return H(Q,S);if(N(S))return D(Q,S)}else if(G(Q)){if(p(S)||A(S))return z(S,Q);if(G(S))return l.isClose(Q.z,S.z)?Q:void 0;if(I(S))return w(Q,S);if(J(S)){const [qa,wa]=S.center;return new R(m.fromValues(qa,wa,Q.z),S.radius)}if(M(S))return ja(Q,S);if(L(S))return l.isClose(S.center[2],
Q.z)?S:void 0;if(N(S))return x(Q,S)}else if(I(Q)){if(p(S)||A(S)||G(S))return z(S,Q);if(I(S))return h(l.intersectVerticalPlanes(Q.planeLike,S.planeLike));if(J(S))return h(l.intersectVerticalPlaneAndVerticalCylinder(Q.planeLike,S.center,S.radius));if(M(S))return Aa(Q,S);if(L(S))return va(Q,S);if(N(S))return ya(Q,S)}else if(J(Q)){if(p(S)||A(S)||G(S)||I(S))return z(S,Q);if(J(S))return h(l.intersectVerticalCylinders(m.asVec2(Q.center),Q.radius,m.asVec2(S.center),S.radius));if(!M(S)){if(L(S))return na=
f.squaredDistance(m.asVec2(Q.center),m.asVec2(S.center)),l.isClose(na,0)&&l.isClose(Q.radius,S.radius)||(Q=l.intersectVerticalCylinders(m.asVec2(Q.center),Q.radius,m.asVec2(S.center),S.radius),S=d(Q,S.center[2])),S;N(S)}}else if(M(Q)){if(p(S)||A(S)||G(S)||I(S)||J(S))return z(S,Q);M(S)||(L(S)?S.asCircle():N(S))}else if(L(Q)){if(p(S)||A(S)||G(S)||I(S)||J(S)||M(S))return z(S,Q);if(L(S))return l.vectorsHaveCloseZ(S.center,Q.center)?(na=f.squaredDistance(m.asVec2(S.center),m.asVec2(Q.center)),l.isClose(na,
0)&&l.isClose(S.radius,Q.radius)||(Q=l.intersectVerticalCylinders(m.asVec2(S.center),S.radius,m.asVec2(Q.center),Q.radius),S=d(Q,S.center[2]))):S=void 0,S;N(S)}else if(N(Q)){if(p(S)||A(S)||G(S)||I(S)||J(S)||L(S))return z(S,Q);N(S)}}function H({lineLike:Q},{center:S,radius:na}){const qa=S[2];Q=l.intersectLineLikeAndVerticalCylinder(Q,S,na).filter(wa=>l.isClose(wa[2],qa));return y(Q)}function D({lineLike:Q},{sphere:S}){return y(c.intersectLine(S,Q.start,Q.end))}function w({z:Q},{planeLike:S}){const [na,
qa]=S.start,[wa,za]=S.end,Ba=m.fromValues(na,qa,Q);Q=m.fromValues(wa,za,Q);return S.type===l.VerticalPlaneType.PLANE?new V(Ba,Q):new ea(Ba,Q)}function x(Q,{center:S,radius:na}){const qa=Math.abs(S[2]-Q.z);if(!(qa>na)||l.isClose(qa,na))if(Q=m.fromValues(S[0],S[1],Q.z),na=Math.sqrt(na**2-qa**2),!l.isClose(na,0))return new R(Q,na)}function C(Q,S){const {planeLike:na,getZ:qa}=Q,wa=[];if(p(S))Q.addIfOnTheGround(wa,l.intersectVerticalPlaneAndPoint(na,S.point));else if(A(S))Q.addIfOnTheGround(wa,l.intersectVerticalPlaneAndLineLike(na,
S.lineLike));else if(J(S))for(const [za,Ba]of l.intersectVerticalPlaneAndVerticalCylinder(na,S.center,S.radius))Q=qa(za,Ba),null!=Q&&wa.push(u.fromValues(za,Ba,Q));else if(I(S)||S instanceof pa)for(const [za,Ba]of l.intersectVerticalPlanes(na,S.planeLike))Q=qa(za,Ba)??0,wa.push(u.fromValues(za,Ba,Q));return y(wa)}function h(Q){return B(Q.map(([S,na])=>{const qa=m.fromValues(S,na,0);S=m.fromValues(S,na,1);return new V(qa,S)}))}function y(Q){return B(Q.map(S=>S?new O(m.fromVec3(S)):void 0))}function d(Q,
S){return y(Q.map(([na,qa])=>[na,qa,S]))}function B(Q){if(0!==Q.length)return 1===Q.length?Q[0]??void 0:new Y(Q.filter(b.isSome))}function p(Q){return Q instanceof O}function A(Q){return Q instanceof U}function G(Q){return Q instanceof ca}function I(Q){return Q instanceof sa}function J(Q){return Q instanceof ra}function L(Q){return Q instanceof R}function M(Q){return Q instanceof T}function N(Q){return Q instanceof ta}class K{intersect(Q){return z(this,Q)}closestPoints(Q){return[this.closestTo(Q)]}}
class O extends K{constructor(Q){super();this.point=Q}equals(Q){return this===Q||p(Q)&&n.exactEquals(this.point,Q.point)}closestTo(){return m.clone(this.point)}}class U extends K{constructor(Q,S,na){super();this.start=Q;this.end=S;this.lineLike={start:Q,end:S,type:na}}equals(Q){return this===Q||A(Q)&&this.lineLike.type===Q.lineLike.type&&n.exactEquals(this.start,Q.start)&&n.exactEquals(this.end,Q.end)}closestTo(Q){const S=m.createWritable();l.projectPointToLineLike(Q,this.lineLike,S);return S}}class V extends U{constructor(Q,
S){super(Q,S,r.LineType.LINE)}}class ea extends U{constructor(Q,S){super(Q,S,r.LineType.RAY)}}class Y extends K{constructor(Q){super();this.constraints=Q}equals(Q){return this===Q||Q instanceof Y&&b.equals(this.constraints,Q.constraints,(S,na)=>S.equals(na))}closestTo(Q){let S=Infinity,na;for(const qa of this.constraints){const wa=qa.closestTo(Q),za=n.squaredDistance(Q,wa);za<S&&(S=za,na=wa)}return m.clone(na??Q)}closestPoints(Q){return this.constraints.flatMap(S=>S===this?[]:S.closestPoints(Q))}}
class ra extends K{constructor(Q,S){super();this.center=Q;this.radius=S}equals(Q){return this===Q||J(Q)&&this.center[0]===Q.center[0]&&this.center[1]===Q.center[1]&&this.radius===Q.radius}closestTo(Q){const S=m.createWritable();l.projectPointToVerticalCylinder(Q,this.center,this.radius,S);return S}}class R extends K{constructor(Q,S){super();this.center=Q;this.radius=S}equals(Q){return this===Q||L(Q)&&n.exactEquals(this.center,Q.center)&&this.radius===Q.radius}closestTo(Q){const S=m.createWritable();
l.projectPointToVerticalCylinder(Q,this.center,this.radius,S);S[2]=this.center[2];return S}asCircle(){return new T(m.clone(this.center),this.radius,m.fromValues(0,0,1))}}class T extends K{constructor(Q,S,na,qa){super();this.center=Q;this.radius=S;this.normal=na;this.slicePlane=qa}equals(Q){return this===Q||M(Q)&&n.exactEquals(this.center,Q.center)&&n.exactEquals(this.normal,Q.normal)&&this.radius===Q.radius}closestTo(Q){const {center:S,radius:na}=this;q.projectPoint(this.getPlane(ba),Q,aa);var qa=
n.sub(aa,aa,S),wa=n.squaredLength(qa);if(l.isClose(wa,0))return m.clone(Q);const za=na/Math.sqrt(wa);wa=m.createWritable();n.scaleAndAdd(wa,S,qa,za);({slicePlane:qa}=this);return qa&&!l.isPointInsidePlane(qa,wa)?ia(qa,this)?.closestTo(Q)??m.clone(Q):wa}getPlane(Q=q.create()){return q.fromPositionAndNormal(this.center,this.normal,Q)}}const aa=u.create(),ba=q.create();class ca extends K{constructor(Q){super();this.z=Q}equals(Q){return this===Q||G(Q)&&this.z===Q.z}closestTo(Q){return m.fromValues(Q[0],
Q[1],this.z)}getPlane(Q=q.create()){n.set(la,0,0,this.z);return q.fromPositionAndNormal(la,u.UNIT_Z,Q)}}const la=u.create();class sa extends K{constructor(Q,S,na){super();this.start=Q;this.end=S;this.planeLike={start:m.asVec2(Q),end:m.asVec2(S),type:na}}equals(Q){return this===Q||I(Q)&&this.planeLike.type===Q.planeLike.type&&n.exactEquals(this.start,Q.start)&&n.exactEquals(this.end,Q.end)}closestTo(Q){const S=m.createWritable();l.projectPointToVerticalPlane(Q,this.planeLike,S);return S}closestEndTo(Q){const {start:S,
end:na}=this.planeLike;return 0<Math.sign(f.dot(f.subtract(ua,na,S),f.subtract(ha,m.asVec2(Q),S)))?this.end:this.start}getPlane(Q=q.create()){const S=n.copy(ka,this.end);S[2]+=1;return q.fromPoints(this.start,this.end,S,Q)}getSlicePlane(Q=q.create()){const {start:S,end:na,type:qa}=this.planeLike;if(qa!==l.VerticalPlaneType.PLANE){var wa=n.set(ka,S[0],S[1],0),za=n.set(W,na[0],na[1],0);za=n.subtract(W,za,wa);q.fromPositionAndNormal(wa,za,Q);return Q}}}const ua=e.create(),ha=e.create(),ka=u.create(),
W=u.create();class fa extends sa{constructor(Q,S){super(Q,S,l.VerticalPlaneType.HALF_PLANE)}}class oa extends sa{constructor(Q,S){super(Q,S,l.VerticalPlaneType.PLANE)}}class ta extends K{constructor(Q,S){super();this.sphere=c.fromCenterAndRadius(Q,S)}equals(Q){return this===Q||N(Q)&&c.exactEquals(this.sphere,Q.sphere)}closestTo(Q){const S=m.createWritable();c.projectPoint(this.sphere,Q,S);return S}get center(){return c.getCenter(this.sphere)}get radius(){return this.sphere[3]}}class pa extends K{constructor(Q,
S,na){super();this.start=Q;this.end=S;this.getZ=na;this.planeLike={start:m.asVec2(Q),end:m.asVec2(S),type:l.VerticalPlaneType.PLANE}}equals(Q){return this===Q||Q instanceof pa&&n.exactEquals(this.start,Q.start)&&n.exactEquals(this.end,Q.end)&&this.getZ===Q.getZ}closestTo(Q){const S=m.createWritable();l.projectPointToVerticalPlane(Q,this.planeLike,S);S[2]=this.getZ(S[0],S[1])??0;return S}addIfOnTheGround(Q,S){for(const na of S)S=this.getZ(na[0],na[1])??0,l.isClose(na[2],S)&&(na[2]=S,Q.push(na))}}class ma extends K{constructor(Q,
S,na){super();this._x=Q;this._y=S;this._z=na}equals(Q){return this===Q||Q instanceof ma&&this._x===Q._x&&this._y===Q._y&&this._z===Q._z}closestTo([Q,S,na]){return m.create(this._x??Q,this._y??S,this._z??na)}}class xa extends K{constructor(Q,S,na,qa,wa){super();this._origin=Q;this._spatialReference=S;this._distanceMeters=na;this._z=qa;this._directionDegrees=wa}equals(Q){return this===Q||Q instanceof xa&&f.exactEquals(this._origin,Q._origin)&&this._spatialReference===Q._spatialReference&&this._distanceMeters===
Q._distanceMeters&&this._z===Q._z&&this._directionDegrees===Q._directionDegrees}closestTo([Q,S,na]){f.set(P,Q,S);f.exactEquals(P,this._origin)||this._applyDirectionAndDistance(P);return m.create(P[0],P[1],this._z??na)}_applyDirectionAndDistance(Q){if(null!=this._directionDegrees&&null!=this._distanceMeters)E.directGeodeticSolver(Q,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees){var S=this._origin,na=this._directionDegrees,qa=this._spatialReference;
let {azimuth:wa,distance:za}=E.inverseGeodeticSolver(Z,S,Q,qa);wa??=0;let Ba=za*Math.cos((wa-na)*F.toRadians);Ba=Math.max(0,Ba);E.directGeodeticSolver(Q,S,na,Ba,qa)}else null!=this._distanceMeters&&({azimuth:S}=E.inverseGeodeticSolver(X,this._origin,Q,this._spatialReference),E.directGeodeticSolver(Q,this._origin,S??0,this._distanceMeters,this._spatialReference))}}const P=[0,0],X=new E.InverseGeodeticSolverResult,Z=new E.InverseGeodeticSolverResult,da=(()=>{const Q=q.create();return(S,na)=>{const {start:qa,
end:wa}=S;if(l.vectorsHaveCloseZ(qa,wa)&&l.isClose(qa[2],na.z))return S;S=m.createWritable();if(q.intersectLine(na.getPlane(Q),qa,wa,S))return new O(S)}})(),ia=(()=>{const Q=t.create(),S=u.create(),na=u.create();return(qa,wa,za)=>{const {normal:Ba,center:Ea,radius:Ca}=wa;k.tangentFrame(Ba,S,na);const Ga=q.getNormal(qa);var Fa=Ca*n.dot(Ga,S),Da=Ca*n.dot(Ga,na);v.set(Q,Ea[0],Ea[1],Ea[2],1);const Ja=v.dot(qa,Q),Ha=Math.hypot(Fa,Da),Ia=l.isClose(Ha,0);if(l.isClose(q.distance(qa,Ea),0)){if(Ia)return wa;
if(l.isClose(Ca,0))return!za||l.isPointInsidePlane(za,Ea)?new O(m.clone(Ea)):void 0;n.cross(S,Ga,Ba);n.normalize(S,S);Fa=[];Da=u.clone(Ea);n.scaleAndAdd(Da,Da,S,Ca);za&&!l.isPointInsidePlane(za,Da)||Fa.push(Da);Da=u.clone(Ea);n.scaleAndAdd(Da,Da,S,-Ca);za&&!l.isPointInsidePlane(za,Da)||Fa.push(Da);return y(Fa)}if(!(Ia||(qa=-Ja/Ha,1<Math.abs(qa)||l.isClose(qa,1))))return Fa=Math.atan(Fa/Da),qa=g.asinClamped(qa)-Fa,Fa=Math.PI-qa,Da=[],wa=u.create(),n.scaleAndAdd(wa,Ea,S,Ca*Math.cos(qa)),n.scaleAndAdd(wa,
wa,na,Ca*Math.sin(qa)),Da.push(wa),qa=u.create(),n.scaleAndAdd(qa,Ea,S,Ca*Math.cos(Fa)),n.scaleAndAdd(qa,qa,na,Ca*Math.sin(Fa)),Da.push(qa),y(za?l.pointsInsidePlane(za,Da):Da)}})(),ja=(()=>{const Q=q.create();return(S,na)=>ia(S.getPlane(Q),na,na.slicePlane)})(),va=(()=>{const Q=q.create();return(S,{center:na,radius:qa})=>{qa=l.intersectVerticalPlaneAndVerticalCylinder(S.planeLike,na,qa);na=na[2];S.getSlicePlane(Q);S=[];for(const [wa,za]of qa)qa=[wa,za,na],l.isPointInsidePlane(Q,qa)&&S.push(qa);return y(S)}})(),
Aa=(()=>{const Q=q.create(),S=q.create();return(na,qa)=>ia(na.getPlane(Q),qa,na.getSlicePlane(S))})(),ya=(()=>{const Q=q.create();return(S,{center:na,radius:qa})=>{var wa=S.getPlane(Q);const za=q.signedDistance(wa,na);var Ba=Math.abs(za);if(!(Ba>qa)||l.isClose(Ba,qa)){qa=Math.sqrt(qa**2-za**2);if(l.isClose(qa,0))return S=m.createWritable(),q.projectPoint(wa,na,S),new O(S);Ba=m.createWritable();wa=u.clone(q.getNormal(wa));n.scaleAndAdd(Ba,na,wa,za);return new T(Ba,qa,wa,S.getSlicePlane())}}})();a.CircleConstraint=
T;a.Constraint=K;a.CoordinateConstraint=ma;a.DrapedLineConstraint=pa;a.GeodesicConstraint=xa;a.HorizontalCircleConstraint=R;a.HorizontalPlaneConstraint=ca;a.LineConstraint=V;a.LineLikeConstraint=U;a.PointConstraint=O;a.RayConstraint=ea;a.SetConstraint=Y;a.SphereConstraint=ta;a.VerticalCylinderConstraint=ra;a.VerticalHalfPlaneConstraint=fa;a.VerticalPlaneConstraint=oa;a.VerticalPlaneLikeConstraint=sa;a.constraintOrSet=B;a.isPoint=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../core/libs/gl-matrix-2/math/common ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F){function E(J,{start:L,end:M,type:N},K=n.create()){J=e.sub(x,J,L);M=e.sub(C,M,L);J=e.dot(J,M)/e.dot(M,M);return e.scaleAndAdd(K,L,M,N===F.LineType.RAY?Math.max(J,0):J)}function q({start:J,end:L,type:M},N){const K=e.sub(x,N,J);L=e.sub(C,L,J);if(M===F.LineType.RAY&&e.dot(L,K)<-u.getEpsilon())return e.distance(J,N);J=e.cross(h,L,K);return e.len(J)/e.len(L)}function c(J,L){const M=J.start,N=L.start;var K=L.end;const O=e.sub(x,J.end,M);K=e.sub(C,K,N);var U=e.sub(h,N,M),V=e.cross(y,
O,K),ea=e.dot(U,V);if(!l(ea,0))return[];ea=e.sqrLen(V);if(l(ea,0))return[];U=e.cross(d,U,K);V=e.dot(U,V)/ea;V=e.scaleAndAdd(B,M,O,V);return J.type===F.LineType.RAY&&(J=e.sub(p,V,M),e.dot(O,J)<-u.getEpsilon())||L.type===F.LineType.RAY&&(L=e.sub(p,V,N),e.dot(K,L)<-u.getEpsilon())?[]:[n.clone(V)]}function k({start:J,end:L,type:M},N){const K=e.sub(x,N,J);J=e.sub(C,L,J);L=e.cross(h,J,K);L=e.sqrLen(L)/e.sqrLen(J);const O=u.getEpsilon();if(L<O)switch(M){case F.LineType.LINE:return[n.clone(N)];case F.LineType.RAY:return e.dot(J,
K)<-O?[]:[n.clone(N)]}return[]}function m(J,L,{start:M,end:N,type:K}){e.set(J.start,M[0],M[1],L);e.set(J.end,N[0],N[1],L);J.type=H[K];return J}function l(J,L){return b.floatEqualAbsolute(Math.abs(J-L),0,u.getEpsilon())}function r(J,L){return v.isPointInside(J,L)}const z=(()=>{const J=n.create(),L=n.create(),M=n.create();return({start:N,end:K},{center:O,radius:U,normal:V,slicePlane:ea})=>{var Y=v.fromPositionAndNormal(O,V,A);if(l(v.distance(Y,N),0)&&l(v.distance(Y,K),0)){t.tangentFrame(V,J,L);Y=(ra,
R)=>{e.subtract(M,R,O);g.set(ra,e.dot(M,J),e.dot(M,L));return ra};K=F.intersectLineLikeAndCircle({start:Y(D,N),end:Y(w,K),type:F.LineType.LINE},f.ZEROS,U);N=[];for(const [ra,R]of K)K=e.copy(n.create(),O),e.scaleAndAdd(K,K,J,ra),e.scaleAndAdd(K,K,L,R),ea&&!r(ea,K)||N.push(K);return N}V=n.create();return v.intersectLine(Y,N,K,V)?!l(e.distance(V,O),U)||ea&&!r(ea,V)?[]:[V]:[]}})();a.VerticalPlaneType=void 0;(function(J){J[J.PLANE=0]="PLANE";J[J.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType=
{}));const H={[a.VerticalPlaneType.PLANE]:F.LineType.LINE,[a.VerticalPlaneType.HALF_PLANE]:F.LineType.RAY},D=f.create(),w=f.create(),x=n.create(),C=n.create(),h=n.create(),y=n.create(),d=n.create(),B=n.create(),p=n.create(),A=v.create(),G={start:n.create(),end:n.create(),type:F.LineType.LINE},I={start:n.create(),end:n.create(),type:F.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>F.LineType});a.intersectLineAndPoint=k;a.intersectLineLikeAndCircle=z;a.intersectLineLikeAndVerticalCylinder=
function({start:J,end:L,type:M},N,K){const O=[];L=e.subtract(x,L,J);var U=g.subtract(w,J,N);N=g.squaredLength(L);const V=2*g.dot(L,U);K=g.squaredLength(U)-K*K;K=V*V-4*N*K;0===K?(N=-V/(2*N),(M===F.LineType.LINE||0<=N)&&O.push(e.scaleAndAdd(n.create(),J,L,N))):0<K&&(K=Math.sqrt(K),U=(-V+K)/(2*N),(M===F.LineType.LINE||0<=U)&&O.push(e.scaleAndAdd(n.create(),J,L,U)),N=(-V-K)/(2*N),(M===F.LineType.LINE||0<=N)&&O.push(e.scaleAndAdd(n.create(),J,L,N)));return O};a.intersectLineLikes=c;a.intersectVerticalCylinderAndPoint=
function(J,L,M){return l(g.squaredDistance(M,J),L*L)?[n.clone(M)]:[]};a.intersectVerticalCylinders=function(J,L,M,N){const [K,O]=J,[U,V]=M;var ea=U-K,Y=V-O;const ra=ea*ea+Y*Y,R=Math.sqrt(ra);if(R>L+N||R<Math.abs(L-N)||l(R,0)&&l(L,N))return[];N=(L*L-N*N+ra)/(2*R);L=Math.sqrt(L*L-N*N);Y=L*Y/R;ea=L*ea/R;const [T,aa]=g.lerp(D,J,M,N/R);return l(Y,ea)?[f.fromValues(T,aa)]:[f.fromValues(T+Y,aa-ea),f.fromValues(T-Y,aa+ea)]};a.intersectVerticalPlaneAndLineLike=function(J,L){const M=J.start,N=g.subtract(D,
J.end,M);var K=e.set(C,-N[1],N[0],0);const O=L.start,U=e.sub(h,L.end,O);var V=e.dot(U,K),ea=e.set(y,M[0],M[1],0);ea=e.sub(d,ea,O);ea=e.dot(ea,K);K=u.getEpsilon();if(Math.abs(V)<K)return[];V=e.scaleAndAdd(B,O,U,ea/V);return L.type===F.LineType.RAY&&(L=e.sub(p,V,O),e.dot(L,U)<-K)||J.type===a.VerticalPlaneType.HALF_PLANE&&(J=g.sub(w,V,M),g.dot(J,N)<-K)?[]:[n.clone(V)]};a.intersectVerticalPlaneAndPoint=function(J,L){return k(m(G,L[2],J),L)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:J,
end:L,type:M},N,K){const O=[];L=g.subtract(D,L,J);var U=g.subtract(w,J,N);N=g.squaredLength(L);const V=2*g.dot(L,U);K=g.squaredLength(U)-K*K;K=V*V-4*N*K;0===K?(N=-V/(2*N),(M===a.VerticalPlaneType.PLANE||0<=N)&&O.push(g.scaleAndAdd(f.create(),J,L,N))):0<K&&(K=Math.sqrt(K),U=(-V+K)/(2*N),(M===a.VerticalPlaneType.PLANE||0<=U)&&O.push(g.scaleAndAdd(f.create(),J,L,U)),N=(-V-K)/(2*N),(M===a.VerticalPlaneType.PLANE||0<=N)&&O.push(g.scaleAndAdd(f.create(),J,L,N)));return O};a.intersectVerticalPlanes=function(J,
L){J=m(G,0,J);L=m(I,0,L);return c(J,L).map(([M,N])=>f.fromValues(M,N))};a.isClose=l;a.isPointInsidePlane=r;a.pointToLineLikeDistance=q;a.pointToVerticalCylinderDistance=function(J,L,M){return g.distance(J,L)-M};a.pointToVerticalPlaneDistance=function(J,L){return q(m(G,J[2],L),J)};a.pointsInsidePlane=function(J,L){return L.filter(M=>r(J,M))};a.projectPointToLineLike=E;a.projectPointToVerticalCylinder=function(J,L,M,N=n.create()){const K=g.subtract(D,J,L),O=g.length(K);g.scaleAndAdd(N,L,K,0===O?1:M/
O);N[2]=J[2];return N};a.projectPointToVerticalPlane=function(J,L,M){return E(J,m(G,J[2],L),M)};a.vectorsHaveCloseZ=function(J,L){return l(J[2],L[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64"],function(a,b,g,f){function e(c,k){return c[0]*k[1]-c[1]*k[0]}function n(c,k,m){k=g.dot(m,k)/g.squaredLength(m);
return g.scale(c,m,k)}function u(c,k,m,l,r=m){g.subtract(t,l,m);g.subtract(E,k,r);n(q,E,t);return g.add(c,r,q)}function v(c,k,m,l){g.subtract(t,k,m);k=l/g.length(t);return g.scaleAndAdd(c,m,t,k)}a.LineType=void 0;(function(c){c[c.RAY=0]="RAY";c[c.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const t=f.create(),F=f.create(),E=f.create(),q=f.create();a.cross=e;a.intersectCircleAndPoint=function(c,k,m){v(E,m,c,k);return b.floatEqualAbsolute(E[0],m[0])&&b.floatEqualAbsolute(E[1],m[1])?[f.clone(m)]:[]};
a.intersectLineAndPoint=function(c,k){u(E,k,c.start,c.end);return b.floatEqualAbsolute(E[0],k[0])&&b.floatEqualAbsolute(E[1],k[1])?[f.clone(k)]:[]};a.intersectLineAndRay=function(c,k){const m=c.start;var l=k.start,r=k.end;const z=g.subtract(t,c.end,m);var H=g.subtract(F,r,l);r=e(z,H);if(1E-6>=Math.abs(r))return[];l=g.subtract(E,m,l);H=e(H,l)/r;r=e(z,l)/r;if(0<=H){if(0<=r||k.type===a.LineType.LINE)return[g.scaleAndAdd(q,m,z,H)]}else if(c.type===a.LineType.LINE&&(0<=r||k.type===a.LineType.LINE))return[g.scaleAndAdd(q,
m,z,H)];return[]};a.intersectLineLikeAndCircle=function(c,k,m){const l=[],r=g.subtract(t,c.end,c.start);var z=g.subtract(F,c.start,k);k=g.squaredLength(r);const H=2*g.dot(r,z);m=g.squaredLength(z)-m*m;m=H*H-4*k*m;0===m?(k=-H/(2*k),(c.type===a.LineType.LINE||0<=k)&&l.push(g.scaleAndAdd(q,c.start,r,k))):0<m&&(m=Math.sqrt(m),z=(-H+m)/(2*k),(c.type===a.LineType.LINE||0<=z)&&l.push(g.scaleAndAdd(q,c.start,r,z)),k=(-H-m)/(2*k),(c.type===a.LineType.LINE||0<=k)&&l.push(g.scaleAndAdd(E,c.start,r,k)));return l};
a.pointToLineDistance=function(c,k,m){return Math.abs((k[0]-c[0])*(m[1]-c[1])-(k[1]-c[1])*(m[0]-c[0]))/g.distance(k,m)};a.projectPoint=n;a.projectPointToCircle=v;a.projectPointToLine=u;a.projectPointToRay=function(c,k,m,l){g.subtract(t,l,m);g.subtract(E,k,m);k=g.dot(t,E)/g.squaredLength(t);return 0<k?g.scaleAndAdd(c,m,t,k):g.copy(c,m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/angularMeasurementUtils":function(){define("exports ../../core/Cyclical ../../core/quantityUtils ../../core/unitUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){function q(h,y){if(null!=h&&null!=y)return h=r(h,y),null!=h?g.createAngle(h,"radians","geographic"):void 0}function c(h,y,d){if(h&&y&&d&&(h=r(h,y),y=r(y,d),null!=h&&null!=y))return g.createAngle(y-h,"radians","geographic")}function k(h,y){if(null!=h)switch(y){case a.DirectionMode.Absolute:return m(h);case a.DirectionMode.Relative:return h=l(h),h=C.normalize(h,0,!0),-180===h&&(h=180),g.createAngle(h,"degrees","geographic");case a.DirectionMode.RelativeBilateral:return h=
l(h),h=Math.abs(C.normalize(h,0,!0)),g.createAngle(h,"degrees","geographic")}}function m(h){h=l(h);h=x.normalize(h,0,!0);return g.createAngle(h,"degrees","geographic")}function l(h){if(null!=h)return g.convertRotationType(f.convertUnit(h.value,h.unit,"degrees"),h.rotationType,"geographic")}a.DirectionMode=void 0;(function(h){h.Absolute="absolute";h.Relative="relative";h.RelativeBilateral="relative-bilateral"})(a.DirectionMode||(a.DirectionMode={}));const r=(()=>{const h=v.create(),y=v.create();return(d,
B)=>{u.set(h,d.x,d.y,d.z??0);u.set(y,B.x,B.y,B.z??0);return z(h,y,d.spatialReference,B.spatialReference)}})(),z=(()=>{const h=n.create(),y=v.create(),d=v.create();return(B,p,A,G)=>{if(!u.exactEquals(B,p)){var I=F.geodesicCompatibleSpatialReference(A),J=F.geodesicCompatibleSpatialReference(G);if(I&&J&&E.equals(I,J)&&t.projectVectorToVector(B,A,y,I)&&t.projectVectorToVector(p,G,d,J))return{azimuth:B}=F.inverseGeodeticSolver(D,y,d,I),null!=B?f.convertUnit(B,"degrees","radians"):void 0;h[0]=p[0]-B[0];
h[1]=p[1]-B[1];B=e.angle(n.UNIT_Y,h);0>h[0]&&(B=w-B);return B}}})(),H=(()=>{const h=v.create();return(y,d,B,p,A,G="geodesic")=>{u.copy(h,d);A=l(A);if("geodesic"===G&&(G=F.geodesicCompatibleSpatialReference(B))&&t.projectVectorToVector(h,B,h,G))return F.directGeodeticSolver(y,h,A,p,G),y[2]=d[2],t.projectVectorToVector(y,G,y,B)?!0:!1;B=g.convertRotationType(A,"geographic","arithmetic");B=f.convertUnit(B,"degrees","radians");u.set(y,d[0]+p*Math.cos(B),d[1]+p*Math.sin(B),d[2]);return!0}})(),D=new F.InverseGeodeticSolverResult,
w=2*Math.PI,x=b.cyclicalDegrees,C=new b.Cyclical(-180,180);a.convertAngle=function(h,y,d){let B=f.convertUnit(h.value,h.unit,"degrees");B=g.convertRotationType(B,h.rotationType,d);B=f.convertUnit(B,"degrees",y);return g.createAngle(B,y,d)};a.directionBetweenPoints=q;a.directionForVertices=function(h,y,d,B=a.DirectionMode.Absolute){if(y&&d)switch(B){case a.DirectionMode.Absolute:return q(y,d);case a.DirectionMode.Relative:return k(c(h,y,d),a.DirectionMode.Relative);case a.DirectionMode.RelativeBilateral:return k(c(h,
y,d),a.DirectionMode.RelativeBilateral)}};a.getDegreesArithmetic=function(h){if(null!=h)return g.convertRotationType(f.convertUnit(h.value,h.unit,"degrees"),h.rotationType,"arithmetic")};a.getDegreesGeographic=l;a.getNormalizedDirection=k;a.getNormalizedGeographicOrientation=m;a.pointFromDistanceAlongAzimuth=H;a.radiansGeographicBetweenVec=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/tooltipCommonUtils":function(){define("exports ../../../core/asyncUtils ../../../core/handleUtils ../../../core/mathUtils ../../../core/quantityUtils ../../../core/reactiveUtils ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/coordinateFormatter ../../../geometry/Point ../../../geometry/support/MeshTransform ../../../geometry/support/meshVertexSpaceUtils ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils ../keybindings ../Tooltip ./fields/parsingAndFormattingUtils ../../support/angularMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H){function D(B,p){const {x:A,y:G,z:I}=p,{x:J,y:L,z:M}=w(B,p.spatialReference);B=null==J||f.floatEqualUlp(J,A)?0:J-A;p=null==L||f.floatEqualUlp(L,G)?0:L-G;const N=null==M||null==I||f.floatEqualUlp(M,I)?0:M-I;return{dx:B,dy:p,dz:N}}function w(B,p){let A,G;B.geographic?(A=H.getDegreesGeographic(B.longitude.actual),G=H.getDegreesGeographic(B.latitude.actual),k.isWebMercator(p)&&(null!=A&&null!=G?[A,G]=m.lngLatToXY(A,G,y):null!=A?A=m.lngLatToXY(A,0,y)[0]:null!=
G&&(G=m.lngLatToXY(0,G,y)[1]))):(A=B.x.actual?.value,G=B.y.actual?.value);B=B.elevation.actual;p=u.verticalLengthUnitFromSpatialReference(p);p=null!=p&&null!=B?e.valueInUnit(B,p):void 0;return{x:A,y:G,z:p}}function x(B){return v.equals(B,t.UNIT_Z)?1:v.equals(B,d)?-1:null}function C(B){const p=B?.sketchOptions;if(!p)return!1;const {inputEnabled:A,visibleElements:G}=p.tooltips;return A&&!0===B.editableFields.some(({name:I})=>"x"===I||"y"===I?G.coordinates:G[I])}function h(B,p,A){if(p&&"geographic"in
p){var G=B.clipboardData?.getData("text");if(G){var I=J=>{B.stopPropagation();B.preventDefault();A?.onBeforePaste();J();A?.onAfterPaste()};if(p.geographic){const J=z.parseLatitudeLongitude(G);J&&I(()=>{p.longitude.applyValue(J.longitude);p.latitude.applyValue(J.latitude)})}else{const J=z.parseXY(G);J&&I(()=>{p.x.applyValue(J.x);p.y.applyValue(J.y)})}}}}const y=[0,0],d=v.negate(t.create(),t.UNIT_Z);a.connectPasteEvent=function(B,p){let A=null;return g.handlesGroup([B.on("paste",async G=>{A?.abort();
A=b.createTask(async()=>{F.isLoaded()||await F.load();h(G,B.info,p)})}),b.createTask(()=>F.load()),g.makeHandle(()=>A?.abort())])};a.enterInputModeIfAvailable=function(B,p){return"key-down"===B.type&&B.key===l.tooltipKeys.enterInputMode&&p&&C(p.info)?(p.enterInputMode(),B.preventDefault(),B.stopPropagation(),!0):!1};a.getXYZDeltasFromTooltipInfo=D;a.makeTooltip=function(B){const p=new r(B());p.addHandles(n.watch(()=>B(),({view:A,options:G,info:I})=>{p.view=A;void 0!==G&&(p.options=G);void 0!==I&&
(p.info=I)}));return p};a.pasteLocation=h;a.updateMeshOriginFromTooltipInfo=function(B,p,A){if(p&&c.isRelativeVertexSpace(p.vertexSpace)){var {origin:G,spatialReference:I}=p,{x:J,y:L,z:M}=w(B,I),{dx:N,dy:K,dz:O}=D(B,G);if(0!==N||0!==K||0!==O)A.onMoveStart(),p.centerAt(new E({x:J??G.x,y:L??G.y,z:M??G.z,spatialReference:I})),A.onMove(N,K,O),A.onMoveStop()}};a.updateMeshTransformFromTooltipInfo=function(B,p,A){if(p&&c.isRelativeVertexSpace(p.vertexSpace)){p=p.transform??(p.transform=new q);{var G=H.getDegreesArithmetic(B.orientation.actual);
const L=x(p.rotationAxis);if(null!=G&&null!=L){var I=p.rotationAngle,J=G*L;G=(G-I)*L;I!==J&&(A?.onRotateStart(0),p.rotationAngle=J,A?.onRotate(G),A?.onRotateStop(G))}}I=B.scale.actual?.value;J=p?Math.max(...p.scale):1;null!=I&&I!==J&&({scale:B}=p,0===J?I=t.clone(t.ONES):(I/=J,I=v.scale(t.create(),B,I)),A?.onScaleStart(B[0],B[1],B[2]),p.scale=I,A?.onScale(I[0],I[1],I[2]),A?.onScaleStop(I[0],I[1],I[2]))}};a.updateTooltipInfoFromMeshTransform=function(B,p){const A=c.isRelativeVertexSpace(p.vertexSpace),
{scale:G,orientation:I}=B;({transform:B}=p);B?(p=x(B.rotationAxis),p=null!=p?p*B.rotationAngle:null):p=0;A&&null!=p?(I.actual=e.createAngle(p,"degrees","arithmetic"),I.visible=!0):(I.actual=null,I.visible=!1);A?(G.actual=e.createScalar(B?Math.max(...B.scale):1),G.visible=!0):(G.actual=null,G.visible=!1)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/Tooltip":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/events ../../core/maybe ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../support/themeUtils ./tooltip/css ./tooltip/content/tooltipContentFactory ../../widgets/support/widgetUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m){function l({classList:H},D){z.forEach(w=>H.remove(w));H.add(`${r.base}--${D}`)}const r={base:`${c.base}`,ltr:`${c.base}--ltr`,rtl:`${c.base}--rtl`,debug:`${c.base}--debug`};b=class extends b.EventedAccessor{constructor(H){super(H);this.content=this.position=this.options=this.info=null;this._focused=!1;this.outerContainer=document.createElement("div");this.debug=!1;this._lastPosition=null;this._rtl=!1;this._prevXY=[0,0]}initialize(){const {outerContainer:H}=
this;this.addHandles([e.watch(()=>this.view.overlay?.surface,D=>{H.remove();D?.appendChild(H);this._rtl=m.isRTL(D)},e.syncAndInitial),e.watch(()=>this.info,(D,w)=>{null!=this.content&&null!=D&&null!=w&&D.type===w.type?this.content.info=D:(f.destroyMaybe(this.content),(D=k.tooltipContentFactory(this,D))?(this.content=D,D.container&&H.appendChild(D.container),this.exitInputMode()):this.content=null)},e.syncAndInitial),e.watch(()=>({container:this.outerContainer,style:this._outerContainerStyle}),({container:D,
style:w})=>{Object.assign(D.style,w)},e.initial),e.watch(()=>({outerContainer:this.outerContainer,placement:this.effectivePlacement,effectiveOffset:this._effectiveOffset,rtl:this._rtl,debug:this.debug}),({outerContainer:D,placement:w,effectiveOffset:x,rtl:C,debug:h})=>{const {classList:y}=D;y.add(r.base);y.toggle(r.rtl,C);y.toggle(r.ltr,!C);y.toggle(r.debug,h);this.outerContainer.style.setProperty("--offset",`${x}px`);q.setCalciteThemeClass(D);l(D,w)},e.initial),e.when(()=>"feedback"===this.mode,
()=>{this.position=null;this._clearOverride("effectivePlacement")},e.sync),g.on(this.outerContainer,"paste",D=>{this.emit("paste",D)}),g.on(this.outerContainer,["focusin","focusout"],()=>{setTimeout(()=>{this._focused=this.content?.container?.contains(document.activeElement)??!1})})])}destroy(){this.info=null;this.content=f.destroyMaybe(this.content);this.outerContainer.remove()}get mode(){return this.content?.mode??"feedback"}get focused(){return this._focused}get visible(){return"none"!==this._outerContainerStyle.display}get contentContainer(){return this.content?.container}get effectivePlacement(){const H=
this.options?.placement;return"auto"===H?"bottom-end":H??"bottom-end"}get _screenPoint(){const {inputManager:H}=this.view;return H?.multiTouchActive?null:H?.latestPointerLocation}get _effectiveOffset(){return this.options?.offset??20}get _outerContainerStyle(){const H=this.position??this._screenPoint;this._lastPosition=n.cloneScreenPoint(H);return null!=H&&null!=this.content?{display:"block",transform:`translate(${Math.round(H.x)}px, ${Math.round(H.y)}px)`}:{display:"none",transform:"none"}}clear(){this.info=
null}async enterInputMode(H){const D=this.position=n.cloneScreenPoint(this.position??this._lastPosition??this._screenPoint),{effectivePlacement:w}=this;this._override("effectivePlacement",w);await this.content?.enterInputMode(H,()=>{if(D){var x=this.contentContainer;var C=this._effectiveOffset;var h=this.view;if(x&&h.container){x=x.getBoundingClientRect();var {left:y,top:d}=h.container.getBoundingClientRect(),{x:B,y:p}=D,A=x.left-y-C;0>A&&(B-=A);A=x.right-y+C-h.width;0<A&&(B-=A);A=x.top-d-C;0>A&&
(p-=A);C=x.bottom-d+C-h.height;0<C&&(p-=C);C=n.createScreenPoint(B,p)}else C=D;this.position=C;Object.assign(this.outerContainer.style,this._outerContainerStyle)}})}async exitInputMode(H){await this.content?.exitInputMode(H)}onDragStart(H,D){this._prevXY=[H,D]}onDrag(H,D){const w=H-this._prevXY[0],x=D-this._prevXY[1];this._prevXY=[H,D];const {position:C}=this;if(C){const {view:h}=this;H-=h.position[0];D-=h.position[1];0>H||H>h.width||0>D||D>h.height-16||(this.position=n.createScreenPoint(C.x+w,C.y+
x))}}onDragEnd(){this._prevXY=[0,0]}};a.__decorate([u.property({nonNullable:!0})],b.prototype,"view",void 0);a.__decorate([u.property()],b.prototype,"info",void 0);a.__decorate([u.property()],b.prototype,"options",void 0);a.__decorate([u.property()],b.prototype,"position",void 0);a.__decorate([u.property()],b.prototype,"content",void 0);a.__decorate([u.property({readOnly:!0})],b.prototype,"mode",null);a.__decorate([u.property()],b.prototype,"_focused",void 0);a.__decorate([u.property({readOnly:!0})],
b.prototype,"focused",null);a.__decorate([u.property({readOnly:!0})],b.prototype,"outerContainer",void 0);a.__decorate([u.property({readOnly:!0})],b.prototype,"contentContainer",null);a.__decorate([u.property({readOnly:!0})],b.prototype,"effectivePlacement",null);a.__decorate([u.property()],b.prototype,"debug",void 0);a.__decorate([u.property()],b.prototype,"_lastPosition",void 0);a.__decorate([u.property()],b.prototype,"_screenPoint",null);a.__decorate([u.property()],b.prototype,"_rtl",void 0);a.__decorate([u.property()],
b.prototype,"_effectiveOffset",null);a.__decorate([u.property()],b.prototype,"_outerContainerStyle",null);b=a.__decorate([E.subclass("esri.views.interactive.Tooltip")],b);const z=["top","bottom","leading","trailing"].flatMap(H=>[`${r.base}--${`${H}-start`}`,`${r.base}--${H}`,`${r.base}--${`${H}-end`}`]);return b})},"esri/views/interactive/tooltip/css":function(){define(["exports"],function(a){a.base="esri-tooltip";a.content="esri-tooltip-content";a.contentHeader="esri-tooltip-content__header";a.contentHeaderActions=
"esri-tooltip-content__header__actions";a.contentHeaderSpacer="esri-tooltip-content__header__spacer";a.contentInputMode="esri-tooltip-content--input";a.drawContentHeaderActions="esri-tooltip-draw-header-actions";a.helpMessage="esri-tooltip-help-message";a.helpMessageIcon="esri-tooltip-help-message__icon";a.helpMessageText="esri-tooltip-help-message__text";a.table="esri-tooltip-table";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/tooltipContentFactory":function(){define("exports ./TooltipContentDrawCircle ./TooltipContentDrawMesh ./TooltipContentDrawPoint ./TooltipContentDrawPolygon ./TooltipContentDrawPolyline ./TooltipContentDrawRectangle ./TooltipContentExtentRotate ./TooltipContentExtentScale ./TooltipContentMovePoint ./TooltipContentReshapeEdgeOffset ./TooltipContentSelectedVertex ./TooltipContentTransformMesh ./TooltipContentTransformPoint ./TooltipContentTranslate ./TooltipContentTranslateVertex ./TooltipContentTranslateXY ./TooltipContentTranslateZ".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){a.tooltipContentFactory=function(H,D){if(null==D)return null;const w=document.createElement("div");switch(D.type){case "draw-point":return new f.TooltipContentDrawPoint({tooltip:H,info:D,container:w});case "draw-polygon":return new e.TooltipContentDrawPolygon({tooltip:H,info:D,container:w});case "draw-polyline":return new n.TooltipContentDrawPolyline({tooltip:H,info:D,container:w});case "draw-mesh":return new g.TooltipContentDrawMesh({tooltip:H,info:D,
container:w});case "draw-rectangle":return new u.TooltipContentDrawRectangle({tooltip:H,info:D,container:w});case "draw-circle":return new b.TooltipContentDrawCircle({tooltip:H,info:D,container:w});case "extent-rotate":return new v.TooltipContentExtentRotate({tooltip:H,info:D,container:w});case "extent-scale":return new t.TooltipContentExtentScale({tooltip:H,info:D,container:w});case "move-point":return new F.TooltipContentMovePoint({tooltip:H,info:D,container:w});case "selected-vertex":return new q.TooltipContentSelectedVertex({tooltip:H,
info:D,container:w});case "transform-point":return new k.TooltipContentTransformPoint({tooltip:H,info:D,container:w});case "transform-mesh":return new c.TooltipContentTransformMesh({tooltip:H,info:D,container:w});case "translate":return new m.TooltipContentTranslate({tooltip:H,info:D,container:w});case "translate-vertex":return new l.TooltipContentTranslateVertex({tooltip:H,info:D,container:w});case "translate-z":return new z.TooltipContentTranslateZ({tooltip:H,info:D,container:w});case "translate-xy":return new r.TooltipContentTranslateXY({tooltip:H,
info:D,container:w});case "reshape-edge-offset":return new E.TooltipContentReshapeEdgeOffset({tooltip:H,info:D,container:w})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawCircle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipContentDrawCircle=class extends F.TooltipContent{_renderContent(){const {area:c,radius:k,xSize:m,ySize:l,visibleElements:r}=this.info,z=this._messagesTooltip.sketch,H=this._formatters;return q.tsx(q.tsxFragment,null,r.radius&&null!=k?q.tsx(v.TooltipField,{title:z.radius,value:H.length(k)}):null,r.size&&null!=m&&null!=l?q.tsx(v.TooltipField,{title:z.size,value:q.tsx(t.ValueByValue,{left:H.length(m),right:H.length(l)})}):null,r.area?q.tsx(v.TooltipField,{title:z.area,
value:H.area(c)}):null)}};a.TooltipContentDrawCircle=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],a.TooltipContentDrawCircle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/TooltipField":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ../../../../widgets/Widget ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){const q=`${v.base}-field`;var c=`${q}--input`,k=`${q}__title`,m=`${q}__value`;a.TooltipField=class extends t{constructor(){super(...arguments);this.hidden=!1;this.mode="feedback"}render(){return E.tsx("div",{class:this.classes({[q]:!0,[c]:"input"===this.mode})},E.tsx("div",{class:k,key:"title"},this.title),E.tsx("div",{class:m,key:"value"},this.value))}};b.__decorate([g.property()],a.TooltipField.prototype,"hidden",void 0);b.__decorate([g.property()],a.TooltipField.prototype,
"mode",void 0);b.__decorate([g.property()],a.TooltipField.prototype,"title",void 0);b.__decorate([g.property()],a.TooltipField.prototype,"value",void 0);a.TooltipField=b.__decorate([u.subclass("esri.views.interactive.tooltip.components.TooltipField")],a.TooltipField);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/ValueByValue":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ../../../../widgets/Widget ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){var q=`${v.base}-value-by-value`;a.ValueByValue=class extends t{constructor(){super(...arguments);this.divider="\u00d7"}render(){return E.tsx("div",{class:q},E.tsx("span",null,this.left),E.tsx("span",null,this.divider),E.tsx("span",null,this.right))}};b.__decorate([g.property()],a.ValueByValue.prototype,"left",void 0);b.__decorate([g.property()],a.ValueByValue.prototype,"divider",void 0);b.__decorate([g.property()],a.ValueByValue.prototype,"right",void 0);a.ValueByValue=
b.__decorate([u.subclass("esri.views.interactive.tooltip.components.ValueByValue")],a.ValueByValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContent":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../core/a11yUtils ../../../../core/events ../../../../core/has ../../../../core/memoize ../../../../core/promiseUtils ../../../../core/scheduling ../../../../core/unitFormatUtils ../../../../core/unitUtils ../../../../core/accessorSupport/decorators/property ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../support/getDefaultUnitForView ../../keybindings ../css ../fields/parsingAndFormattingUtils ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/decorators/messageBundle ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h){async function y(p){await p?.setFocus()}function d(p){return(Array.isArray(p)?p:[p]).flat(10).filter(A=>!!A)}const B=Symbol("dragHandles");b.TooltipContent=class extends D{constructor(){super(...arguments);this._focusAbortController=new AbortController;this._transitionInfo=null;this._mode="feedback";this._getFormatters=u.memoize(H.getFormatters);this._onHeaderPointerDown=p=>{const A=p.target;A instanceof HTMLElement&&"calcite-button"!==A?.tagName?.toLowerCase()&&
(this.removeHandles(B),A.setPointerCapture(p.pointerId),this.tooltip.onDragStart(p.clientX,p.clientY),this.addHandles([e.on(A,"pointermove",({clientX:G,clientY:I})=>{this.tooltip.onDrag(G,I)}),e.on(A,["pointerup","pointercancel"],G=>{this.removeHandles(B);A.releasePointerCapture(p.pointerId);this.tooltip.onDragEnd()}),e.on(A,"touchstart",G=>G.preventDefault())],B))};this._onDiscard=()=>{this.destroyed||(this.tooltip.emit("discard"),this.info.clearInputValues(),this.exitInputMode())};this._onCommit=
(p,A)=>{if(!this.destroyed)if(this.tooltip.emit("commit",{type:A}),"commit-and-exit"===A)this.exitInputMode();else if("commit-on-blur"!==A){var G=this._getFocusableElements(),I=G.length;p=G.indexOf(p);-1===p?this.exitInputMode():y(G.at(((p+("commit-and-next"===A?1:-1))%I+I)%I))}};this._onKeyDown=p=>{switch(p.code){case r.tooltipKeys.next:return this._onNextKey(p);case r.tooltipKeys.discard:return p.stopPropagation(),this._onDiscard()}}}get mode(){return this._mode}get _displayUnits(){const {displayUnits:p}=
this.info.sketchOptions.values,A=l.getDefaultUnitForView(this.tooltip.view);return{length:p.length??A,verticalLength:p.verticalLength??A,area:p.area??A}}get _inputUnitInfos(){const p=this._messagesUnits,A=M=>({unit:M,abbreviation:F.unitName(p,M,"abbr")}),{inputUnits:G}=this.info.sketchOptions.values,I=l.getDefaultUnitForView(this.tooltip.view),J=G.verticalLength??I,L=G.area??I;return{length:A(E.defaultLengthUnit(G.length??I)),verticalLength:A(E.defaultVerticalLengthUnit(J)),area:A(E.defaultAreaUnit(L)),
angle:A("degrees")}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){const {visibleElements:p}=this.info.sketchOptions.tooltips,A=this._renderedContent,G=this._renderedActions,I=this._renderedHelpMessage,J=0<A.length,L=J||!!I,M="input"===this.mode;
return h.tsx("div",{class:x.classes(z.content,M&&z.contentInputMode),onkeydown:this._onKeyDown,tabIndex:-1},M&&L&&p.header?h.tsx("div",{class:z.contentHeader,"data-testid":"tooltip-header",key:"header",onpointerdown:this._onHeaderPointerDown},h.tsx("calcite-button",{appearance:"transparent","data-testid":"tooltip-back-button",iconFlipRtl:"both",iconStart:"chevron-left",key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),0<G.length?h.tsx(h.tsxFragment,null,h.tsx("div",
{class:z.contentHeaderSpacer,key:"spacer"}),h.tsx("div",{class:z.contentHeaderActions,key:"actions"},G)):null):null,J?h.tsx("div",{class:z.table,key:"content"},...A):null,I)}destroy(){this._focusAbortController.abort();this._transitionInfo?.transition.skipTransition()}_renderActions(){return null}loadDependencies(){return w.loadCalciteComponents({button:()=>new Promise((p,A)=>a(["../../../../chunks/calcite-button"],p,A)),icon:()=>new Promise((p,A)=>a(["../../../../chunks/calcite-icon"],p,A)),input:()=>
new Promise((p,A)=>a(["../../../../chunks/calcite-input"],p,A))})}async enterInputMode(p,A){try{await this._transitionTo("input",A),await this._focusField(p)}catch(G){v.throwIfNotAbortError(G)}}async exitInputMode({focusOnView:p=!0}={}){try{const {container:A,info:G}=this;G.clearInputValues();p=p?A?.closest(".esri-view")?.querySelector(".esri-view-surface"):null;await this._transitionTo("feedback");p instanceof HTMLElement&&p.focus()}catch(A){v.throwIfNotAbortError(A)}}_onNextKey(p){var A=this._getFocusableElements();
const G=A.at(0);A=A.at(-1);G&&A&&(p.shiftKey?document.activeElement===G&&(p.preventDefault(),p.stopPropagation(),y(A)):document.activeElement===A&&(p.preventDefault(),p.stopPropagation(),y(G)))}get _renderedContent(){return d(this._renderContent())}get _renderedActions(){return d(this._renderActions())}get _renderedHelpMessage(){const {sketchOptions:p,visibleElements:A}=this.info;if(!A.helpMessage)return null;const G=p.tooltips.helpMessage??this._defaultHelpMessage;if(!G)return null;const I=p.tooltips.helpMessageIcon??
"information";return h.tsx("div",{class:z.helpMessage,key:"help-message"},I?h.tsx("calcite-icon",{class:z.helpMessageIcon,icon:I,scale:"s"}):null,h.tsx("div",{class:z.helpMessageText},G))}get _defaultHelpMessage(){const {helpMessage:p,viewType:A}=this.info;return null==p?null:this._messagesTooltip?.sketch?.["3d"===A?"helpMessages3d":"helpMessages2d"]?.[p]}async _focusField(p){this._focusAbortController?.abort();this._focusAbortController=new AbortController;var {signal:A}=this._focusAbortController;
await this._waitForInputs();v.throwIfAborted(A);A=this._getFocusableInputs();A=p?A.find(G=>G.getAttribute("data-field-name")===p):A.at(0);await y(A)}async _transitionTo(p,A){if(this._mode!==p||this._transitionInfo){if(this._transitionInfo?.mode===p)return this._transitionInfo.transition.finished;this._transitionInfo?.transition.skipTransition();var G=async()=>{this.destroyed||(this._mode=p,await t.waitTick(),this.destroyed||(this.renderNow(),await t.waitTick(),this.destroyed||A?.()))};if(this.domNode?.firstChild&&
document.startViewTransition&&!f.prefersReducedMotion()){this.autoRenderingEnabled=!1;var I=this._transitionInfo={transition:document.startViewTransition(async()=>{this.destroyed||I!==this._transitionInfo||(this.autoRenderingEnabled=!0,await G())}),mode:p};try{await I.transition.finished}finally{I===this._transitionInfo&&(this._transitionInfo=null)}}else await G()}}async _waitForInputs(){const p=()=>Array.from(this.domNode?.querySelectorAll("calcite-input")??[]);for(;0===p().length;)await v.after(20);
await t.waitAnimationFrame()}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("calcite-input:not([read-only]):not([disabled])")??[])}_getFocusableElements(){const p=this.domNode?.querySelector(`.${z.drawContentHeaderActions}`);return[...Array.from(p?.querySelectorAll(`.${z.contentHeaderActions} calcite-button:not([disabled])`)??[]),...this._getFocusableInputs()]}};g.__decorate([C.messageBundle("esri/core/t9n/Units"),q.property()],b.TooltipContent.prototype,"_messagesUnits",void 0);
g.__decorate([C.messageBundle("esri/views/interactive/tooltip/t9n/Tooltip"),q.property()],b.TooltipContent.prototype,"_messagesTooltip",void 0);g.__decorate([q.property()],b.TooltipContent.prototype,"info",void 0);g.__decorate([q.property()],b.TooltipContent.prototype,"tooltip",void 0);g.__decorate([q.property()],b.TooltipContent.prototype,"_mode",void 0);g.__decorate([q.property()],b.TooltipContent.prototype,"mode",null);g.__decorate([q.property()],b.TooltipContent.prototype,"_displayUnits",null);
g.__decorate([q.property()],b.TooltipContent.prototype,"_inputUnitInfos",null);g.__decorate([q.property()],b.TooltipContent.prototype,"_formatters",null);g.__decorate([q.property()],b.TooltipContent.prototype,"fieldContext",null);g.__decorate([q.property()],b.TooltipContent.prototype,"_renderedContent",null);g.__decorate([q.property()],b.TooltipContent.prototype,"_renderedActions",null);g.__decorate([q.property()],b.TooltipContent.prototype,"_renderedHelpMessage",null);g.__decorate([q.property()],
b.TooltipContent.prototype,"_defaultHelpMessage",null);b.TooltipContent=g.__decorate([m.subclass("esri.views.interactive.tooltip.content.TooltipContent")],b.TooltipContent);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/memoize":function(){define(["exports"],function(a){a.memoize=function(b){let g,f=[],e,n=!1;return function(...u){var v;if(v=n&&g===this)a:if(u.length!==f.length)v=!1;else{for(v=0;v<u.length;++v)if(u[v]!==f[v]){v=!1;break a}v=!0}if(v)return e;e=b.apply(this,
u);g=this;f=u;n=!0;return e}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/parsingAndFormattingUtils":function(){define("exports ../../../../core/Cyclical ../../../../core/quantityFormatUtils ../../../../core/quantityUtils ../../../../geometry/coordinateFormatter ../../../../intl/number ../../../support/angularMeasurementUtils".split(" "),function(a,b,g,f,e,n,u){function v(d){return n.formatNumber(d,{signDisplay:"exceptZero",...H(1)})}function t(d){return g.formatAngle(d,
d.rotationType,1)}function F(d){d=u.getDegreesGeographic(d);return n.formatNumber(d,{style:"unit",unitDisplay:"narrow",unit:"degree",signDisplay:0<d?"never":"exceptZero",...H(1)})}function E(d){return g.formatAngle(d,d.rotationType,1)}function q(d){return k(d,h)}function c(d){return k(d,y)}function k(d,B){return g.formatAngle(f.toUnit(d,"degrees"),"geographic",6,B,!1)}function m(d,B){d=B.normalize(f.toUnit(d,"degrees").value,void 0,!1);return z(f.createScalar(d),6)}function l(d){return n.formatNumber(d.value,
{style:"percent"})}function r(d){return n.formatNumber(d,{style:"percent",maximumFractionDigits:0})}function z(d,B){return n.formatNumber(d.value,H(B))}function H(d){return{minimumFractionDigits:d,maximumFractionDigits:d}}function D(d,B,p){d=d.replaceAll(/[\s+]/g,"");""!==p&&(d=d.replaceAll(p,""));""!==B&&(d=d.replaceAll(B,"."));return d}function w(d){return null!=d?f.createAngle(d,"degrees","geographic"):null}const x=d=>{let B=`[-+]?[0-9${d.thousands}]+`;""!==d.decimal&&(B+=`${d.decimal}[0-9]+`);
return new RegExp(`^(${B}\\s*)${d.separator}(\\s*${B})$`,"i")},C=[];for(const d of[",","\\|","\\s+"])for(const B of["\\.",",",""])for(const p of["",",","\\.","\u202f","\\s+"])d!==B&&d!==p&&B!==p&&C.push({separator:d,decimal:B,thousands:p,pattern:x({decimal:B,thousands:p,separator:d})});const h=new b.Cyclical(-180,180),y=new b.Cyclical(-90,90);a.cleanNumber=D;a.createGeographicCoordinate=w;a.formatLatitudeDecimalDegreesForInputMode=function(d){return m(d,y)};a.formatLongitudeDecimalDegreesForInputMode=
function(d){return m(d,h)};a.getFormatters=function(d,B){return{angleRelative:v,direction:t,directionRelative:F,directionRelativeBilateral:E,latitudeDecimalDegrees:c,longitudeDecimalDegrees:q,area:(p,A)=>g.formatArea(d,p,A??B.area),length:(p,A,G)=>g.formatLength(d,p,A??B.length,G),lengthRelative:(p,A)=>g.formatRelativeLength(d,p,A??B.length),totalLength:(p,A)=>g.formatLength(d,p,A??B.length),verticalLength:(p,A)=>g.formatVerticalLength(d,p,A??B.verticalLength),verticalLengthRelative:(p,A)=>g.formatRelativeVerticalLength(d,
p,A??B.verticalLength),percentage:l,scalar:z,scale:r}};a.makeQuantityParser=function({createQuantity:d,sanitize:B}){return(p,A)=>{if(null==p)return null;B&&(p=B(p));p=n.parseNumber(p);return null==p?null:d(p,A)}};a.parseLatitude=function(d){return w(e.fromLatitude(d))};a.parseLatitudeLongitude=function(d){if(!d||null!=n.parseNumber(d)||!e.isLoaded())return null;var B=e.fromLatitudeLongitude(d);d=w(B?.latitude);B=w(B?.longitude);return null!=B&&null!=d?{latitude:d,longitude:B}:null};a.parseLongitude=
function(d){return w(e.fromLongitude(d))};a.parseXY=function(d){for(const {decimal:p,thousands:A,pattern:G}of C){G.lastIndex=0;var B=d.match(G);if(!B)continue;const I=n.parseNumber(D(B[1],p,A));B=n.parseNumber(D(B[2],p,A));if(null!=I&&null!=B)return{x:f.createScalar(I),y:f.createScalar(B)}}return null};a.sanitizeAngle=function(d){return d.replaceAll(/[*^~\u00b0\u00ba]/g,"")};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawMesh":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentDrawMesh=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.coordinates?c.effectiveX:void 0,m.coordinates?c.effectiveY:void 0,m.elevation?c.elevation:void 0,m.orientation?c.orientation:void 0,m.scale?c.scale:void 0],mode:k})}};a.TooltipContentDrawMesh=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],a.TooltipContentDrawMesh);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/Fields":function(){define(["exports","../components/TooltipEditableField","../../../../widgets/support/jsxFactory"],function(a,b,g){a.Fields=function(f){const e=f.fields.filter(n=>!0===n?.visible);return 0===e.length?null:g.tsx(g.tsxFragment,null,e.map(n=>g.tsx(b.TooltipEditableField,{context:f.context,field:n,key:n.id,mode:f.mode})))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/components/TooltipEditableField":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../core/reactiveUtils ../../../../core/scheduling ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../keybindings ../css ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l){const r=`${q.base}-editable-field`;var z=`${r}--input`,H=`${r}--feedback`,D=`${r}--read-only`,w=`${r}--locked`,x=`${r}__title`,C=`${r}__value`,h=`${r}__value__content`,y=`${r}__value__content--read-only`,d=`${r}__lock-icon`,B=`${r}__input`,p=`${r}__input-suffix`,A=`${r}__button`;b.TooltipEditableField=class extends c{constructor(){super(...arguments);this._lock=this._input=null;this._onLockClick=()=>{this.field.toggleLock(this.context)};this._onLockAfterCreate=
G=>{this._lock=G};this._onLockAfterRemoved=()=>{this._lock=null};this._onKeyDown=G=>{if(G.key===E.tooltipKeys.discard&&"input"===this.mode&&this._input)this.context.onDiscard(this._input)};this._onInputKeyDown=G=>{const I=this._input;if(I)switch(G.key){case E.tooltipKeys.commit:return this.field.onCommit("commit-and-exit",I,this.context);case E.tooltipKeys.next:return G.preventDefault(),G.stopPropagation(),this.field.onCommit(G.shiftKey?"commit-and-previous":"commit-and-next",I,this.context)}};this._onInput=
G=>{this.field.onInput(G.target.value)};this._onInputBlur=G=>{const I=this._input;if(I&&G.relatedTarget!==this._lock)this.field.onCommit("commit-on-blur",I,this.context)};this._selectText=()=>{const G=()=>{this._input===document.activeElement&&this._input?.selectText()};G();e.waitAnimationFrame().then(G)};this._onAfterCreate=G=>{this._input=G;G.addEventListener("paste",this._onPaste);G.addEventListener("beforeinput",this._onBeforeInput)};this._onAfterRemoved=G=>{G.removeEventListener("paste",this._onPaste);
G.removeEventListener("beforeinput",this._onBeforeInput)};this._onPaste=G=>{const I=G.clipboardData?.getData("text");I&&null!=this.field.parse(I,this.context)&&(G.stopPropagation(),this.field.onInput(I))};this._onBeforeInput=G=>{"historyUndo"!==G.inputType&&"historyRedo"!==G.inputType||this.field.dirty||G.preventDefault()}}initialize(){this.addHandles(f.watch(()=>this._rawDisplayValue,()=>{const {committed:G,inputValue:I}=this.field;G||I||this._input!==document.activeElement||this._selectText()}))}loadDependencies(){return k.loadCalciteComponents({button:()=>
new Promise((G,I)=>a(["../../../../chunks/calcite-button"],G,I)),icon:()=>new Promise((G,I)=>a(["../../../../chunks/calcite-icon"],G,I)),input:()=>new Promise((G,I)=>a(["../../../../chunks/calcite-input"],G,I))})}render(){const {field:G,mode:I}=this,J="input"===I,{locked:L,readOnly:M}=G;return l.tsx("div",{class:this.classes({[r]:!0,[H]:"feedback"===I,[z]:"input"===I,[w]:L,[D]:M})},l.tsx("div",{class:x,key:"title"},this._title),l.tsx("div",{class:C,key:"value",onkeydown:this._onKeyDown},J?this._renderValueInputMode():
this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||"\u2014"}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){const {title:G}=this.field;return"string"===typeof G?G:G(this.context)}_renderValueFeedbackMode(){return l.tsx(l.tsxFragment,null,l.tsx("div",{class:h,key:"value-feedback"},this._formattedValue),this.field.locked&&"input"!==this.mode?l.tsx("calcite-icon",
{class:d,icon:"lock",key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return l.tsx("div",{class:this.classes(h,y),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){const {field:G}=this,{name:I,invalid:J,locked:L}=G;var M=this.context?.messages.sketch??{};M=L?M.unlockConstraint:M.lockConstraint;return l.tsx(l.tsxFragment,null,l.tsx("calcite-input",{afterCreate:this._onAfterCreate,
afterRemoved:this._onAfterRemoved,class:B,"data-field-name":I,"data-testid":`tooltip-field-${I}`,key:"input",onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:J?"invalid":"idle",type:"text",value:this._rawDisplayValue??"\u2014",onCalciteInputInput:this._onInput}),l.tsx("div",{class:p,key:"suffix"},this._suffix),G.lockable?l.tsx("calcite-button",{afterCreate:this._onLockAfterCreate,afterRemoved:this._onLockAfterRemoved,alignment:"center",appearance:"transparent",
class:A,"data-testid":`tooltip-field-${I}-lock`,iconStart:L?"lock":"unlock",key:"lock",kind:"neutral",label:M,onclick:this._onLockClick,scale:"s",tabIndex:-1,title:M}):l.tsx("div",{key:"lock-empty"}))}};g.__decorate([n.property()],b.TooltipEditableField.prototype,"field",void 0);g.__decorate([n.property()],b.TooltipEditableField.prototype,"context",void 0);g.__decorate([n.property()],b.TooltipEditableField.prototype,"mode",void 0);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_input",
void 0);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_lock",void 0);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_formattedValue",null);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_rawDisplayValue",null);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_suffix",null);g.__decorate([n.property()],b.TooltipEditableField.prototype,"_title",null);b.TooltipEditableField=g.__decorate([F.subclass("esri.views.interactive.tooltip.components.TooltipEditableField")],
b.TooltipEditableField);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPoint":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,
F,E){a.TooltipContentDrawPoint=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{elevation:m,visibleElements:l}=c;return E.tsx(v.Fields,{context:q,fields:[l.coordinates?c.effectiveX:void 0,l.coordinates?c.effectiveY:void 0,l.elevation?m:void 0],mode:k})}};a.TooltipContentDrawPoint=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],a.TooltipContentDrawPoint);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/content/TooltipContentDrawPolygon":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/DrawHeaderActions ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipContentDrawPolygon=class extends F.TooltipContent{_renderContent(){const {fieldContext:c,
info:k,mode:m}=this,{xyMode:l,visibleElements:r}=k;return q.tsx(t.Fields,{context:c,fields:[...("direction-distance"===l?[r.direction?k.direction:void 0,r.distance?k.distance:void 0]:[r.coordinates?k.effectiveX:void 0,r.coordinates?k.effectiveY:void 0]),r.elevation?k.elevation:void 0,r.area?k.area:void 0],mode:m})}_renderActions(){const {xyMode:c,sketchOptions:k}=this.info;return q.tsx(v.DrawHeaderActions,{sketchOptions:k,visibleElements:{direction:"direction-distance"===c}})}};a.TooltipContentDrawPolygon=
b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],a.TooltipContentDrawPolygon);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/DrawHeaderActions":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ./directionModeIcons ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/decorators/messageBundle ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m){function l(r){const {directionMode:z}=r.sketchOptions.values,H=r.messages?.sketch,D=H?.directionModeSelect?.title;return m.tsx("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:w=>{w=w.target.selectedItems?.[0]?.getAttribute("data-mode");r.sketchOptions.values.directionMode=w??"absolute"}},m.tsx("calcite-button",{alignment:"end",appearance:"transparent",iconStart:F.directionModeIcons[z],kind:"neutral",
label:D,scale:"s",slot:"trigger",title:D}),m.tsx("calcite-dropdown-group",{selectionMode:"single"},m.tsx("calcite-dropdown-item",{"data-mode":"relative","data-testid":"tooltip-direction-mode-relative",iconStart:F.directionModeIcons.relative,key:"relative",selected:"relative"===z},H?.directionModeSelect?.relative),m.tsx("calcite-dropdown-item",{"data-mode":"absolute","data-testid":"tooltip-direction-mode-absolute",iconStart:F.directionModeIcons.absolute,key:"absolute",selected:"absolute"===z},H?.directionModeSelect?.absolute)))}
b.DrawHeaderActions=class extends E{constructor(r){super(r);this.visibleElements={}}render(){return m.tsx("div",{class:t.drawContentHeaderActions},this._isElementVisible("direction")?m.tsx(l,{messages:this.messages,sketchOptions:this.sketchOptions}):null)}loadDependencies(){return q.loadCalciteComponents({button:()=>new Promise((r,z)=>a(["../../../../chunks/calcite-button"],r,z)),dropdown:()=>new Promise((r,z)=>a(["../../../../chunks/calcite-dropdown"],r,z)),"dropdown-item":()=>new Promise((r,z)=>
a(["../../../../chunks/calcite-dropdown-item"],r,z)),"dropdown-group":()=>new Promise((r,z)=>a(["../../../../chunks/calcite-dropdown-group"],r,z))})}_isElementVisible(r){return this.visibleElements?.[r]??this.sketchOptions.tooltips.visibleElements[r]}};g.__decorate([k.messageBundle("esri/views/interactive/tooltip/t9n/Tooltip"),f.property()],b.DrawHeaderActions.prototype,"messages",void 0);g.__decorate([f.property()],b.DrawHeaderActions.prototype,"sketchOptions",void 0);g.__decorate([f.property()],
b.DrawHeaderActions.prototype,"visibleElements",void 0);b.DrawHeaderActions=g.__decorate([v.subclass("esri.views.interactive.tooltip.components.DrawHeaderActions")],b.DrawHeaderActions);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/directionModeIcons":function(){define(["exports"],function(a){a.directionModeIcons={absolute:"absolute-direction",relative:"relative-direction"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/content/TooltipContentDrawPolyline":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/DrawHeaderActions ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipContentDrawPolyline=class extends F.TooltipContent{_renderContent(){const {fieldContext:c,
info:k,mode:m}=this,{xyMode:l,visibleElements:r}=k;return q.tsx(t.Fields,{context:c,fields:[...("direction-distance"===l?[r.direction?k.direction:void 0,r.distance?k.distance:void 0]:[r.coordinates?k.effectiveX:void 0,r.coordinates?k.effectiveY:void 0]),r.elevation?k.elevation:void 0,r.totalLength?k.totalLength:void 0],mode:m})}_renderActions(){const {xyMode:c,sketchOptions:k}=this.info;return q.tsx(v.DrawHeaderActions,{sketchOptions:k,visibleElements:{direction:"direction-distance"===c}})}};a.TooltipContentDrawPolyline=
b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],a.TooltipContentDrawPolyline);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawRectangle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipContentDrawRectangle=class extends F.TooltipContent{_renderContent(){const {area:c,xSize:k,ySize:m,visibleElements:l}=this.info,r=this._messagesTooltip.sketch,z=this._formatters;return q.tsx(q.tsxFragment,null,l.size&&null!=k&&null!=m?q.tsx(v.TooltipField,{title:r.size,value:q.tsx(t.ValueByValue,{left:z.length(k),right:z.length(m)})}):null,l.area?q.tsx(v.TooltipField,{title:r.area,value:z.area(c)}):null)}};a.TooltipContentDrawRectangle=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],
a.TooltipContentDrawRectangle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentRotate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentExtentRotate=class extends t.TooltipContent{_renderContent(){const {angle:q,visibleElements:c}=this.info,k=this._messagesTooltip.sketch;return E.tsx(E.tsxFragment,null,c.rotation?E.tsx(v.TooltipField,{title:k.rotation,value:this._formatters.angleRelative(q)}):null)}};a.TooltipContentExtentRotate=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],a.TooltipContentExtentRotate);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentScale":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipContentExtentScale=
class extends F.TooltipContent{_renderContent(){const c=this.info,{visibleElements:k}=c,m=this._messagesTooltip.sketch,l=this._formatters;return q.tsx(q.tsxFragment,null,k.size?q.tsx(v.TooltipField,{title:m.size,value:q.tsx(t.ValueByValue,{left:l.length(c.xSize),right:l.length(c.ySize)})}):null,k.scale?q.tsx(v.TooltipField,{title:m.scale,value:q.tsx(t.ValueByValue,{left:l.scale(c.xScale),right:l.scale(c.yScale)})}):null)}};a.TooltipContentExtentScale=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],
a.TooltipContentExtentScale);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentMovePoint":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,
v,t,F,E){a.TooltipContentMovePoint=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.coordinates?c.effectiveX:void 0,m.coordinates?c.effectiveY:void 0,m.elevation?c.elevation:void 0],mode:k})}};a.TooltipContentMovePoint=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentMovePoint")],a.TooltipContentMovePoint);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/content/TooltipContentReshapeEdgeOffset":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentReshapeEdgeOffset=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,
info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.distance?c.distance:void 0,m.area?c.area:void 0,m.totalLength?c.totalLength:void 0],mode:k})}};a.TooltipContentReshapeEdgeOffset=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],a.TooltipContentReshapeEdgeOffset);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentSelectedVertex":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentSelectedVertex=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.coordinates?c.effectiveX:void 0,m.coordinates?c.effectiveY:void 0,m.elevation?c.elevation:void 0,m.area&&"polygon"===c.geometryType?c.area:null,m.totalLength&&"polyline"===c.geometryType?c.totalLength:null],mode:k})}};a.TooltipContentSelectedVertex=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentSelectedVertex")],
a.TooltipContentSelectedVertex);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformMesh":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,
f,e,n,u,v,t,F,E){a.TooltipContentTransformMesh=class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.coordinates?c.effectiveX:void 0,m.coordinates?c.effectiveY:void 0,m.elevation?c.elevation:void 0,m.orientation?c.orientation:void 0,m.scale?c.scale:void 0],mode:k})}};a.TooltipContentTransformMesh=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformMesh")],a.TooltipContentTransformMesh);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformPoint":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentTransformPoint=
class extends t.TooltipContent{_renderContent(){const {fieldContext:q,info:c,mode:k}=this,{visibleElements:m}=c;return E.tsx(v.Fields,{context:q,fields:[m.coordinates?c.effectiveX:void 0,m.coordinates?c.effectiveY:void 0,m.elevation?c.elevation:void 0,m.orientation?c.orientation:void 0,m.size?c.size:void 0],mode:k})}};a.TooltipContentTransformPoint=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformPoint")],a.TooltipContentTransformPoint);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentTranslate=
class extends t.TooltipContent{_renderContent(){const {info:q}=this,{visibleElements:c}=q,k=this._messagesTooltip.sketch,m=this._formatters;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(v.TooltipField,{title:k.distance,value:m.length(q.distance)}):null)}};a.TooltipContentTranslate=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslate")],a.TooltipContentTranslate);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertex":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentTranslateVertex=class extends t.TooltipContent{_renderContent(){const {distance:q,elevation:c,area:k,totalLength:m,visibleElements:l}=this.info,r=this._messagesTooltip.sketch,z=this._formatters;return E.tsx(E.tsxFragment,null,l.distance?E.tsx(v.TooltipField,{title:r.distance,value:z.length(q)}):null,l.elevation&&null!=c?.actual?E.tsx(v.TooltipField,{title:r.elevation,value:z.verticalLength(c.actual)}):null,l.area&&null!=k?E.tsx(v.TooltipField,{title:r.area,
value:z.area(k)}):null,l.totalLength&&null!=m?E.tsx(v.TooltipField,{title:r.totalLength,value:z.length(m)}):null)}};a.TooltipContentTranslateVertex=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],a.TooltipContentTranslateVertex);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateXY":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentTranslateXY=class extends t.TooltipContent{_renderContent(){const {info:q}=this,{visibleElements:c}=q,k=this._messagesTooltip.sketch,m=this._formatters;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(v.TooltipField,{title:k.distance,value:m.length(q.distance)}):null)}};a.TooltipContentTranslateXY=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateXY")],a.TooltipContentTranslateXY);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateZ":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,g,f,e,n,u,v,t,F,E){a.TooltipContentTranslateZ=class extends t.TooltipContent{_renderContent(){const {info:q}=
this,{visibleElements:c}=q,k=this._messagesTooltip.sketch;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(v.TooltipField,{title:k.distance,value:this._formatters.verticalLengthRelative(q.distance)}):null)}};a.TooltipContentTranslateZ=b.__decorate([u.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],a.TooltipContentTranslateZ);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawCircleTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t){a.DrawCircleTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="draw-circle";this.ySize=this.xSize=this.radius=null;this.area=g.zeroSquareMeters}get allFields(){return[]}};b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"radius",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"xSize",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,
"ySize",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"allFields",null);a.DrawCircleTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],a.DrawCircleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/SketchTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u,v){a.SketchTooltipInfo=class extends g{constructor(t){super(t);this.viewType=this.helpMessage=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter(t=>t.visible&&!t.readOnly)}clearInputValues(){this.allFields.forEach(t=>t.clearInputValue())}};b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"sketchOptions",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,
"visibleElements",null);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"helpMessage",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"viewType",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"editableFields",null);a.SketchTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.SketchTooltipInfo")],a.SketchTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawMeshTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),function(a,b,g,f,e,n,u,v,t,F){a.DrawMeshTooltipInfo=class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);
this.type="draw-mesh";this.orientation=v.makeOrientationField({lockable:!1});this.scale=v.makeScaleField({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};b.__decorate([g.property()],a.DrawMeshTooltipInfo.prototype,"helpMessage",void 0);b.__decorate([g.property()],a.DrawMeshTooltipInfo.prototype,"allFields",null);a.DrawMeshTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],a.DrawMeshTooltipInfo);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/fields":function(){define("exports ../../../../core/quantityUtils ./parsingAndFormattingUtils ./TooltipField ./TooltipFieldElevation ./TooltipFieldOrientation ./TooltipFieldSize ../../../support/angularMeasurementUtils".split(" "),function(a,b,g,f,e,n,u,v){function t(E){return new f.TooltipField({name:"distance",actual:b.zeroMeters,parse:g.makeQuantityParser({createQuantity:(q,c)=>b.createLength(Math.max(q,
0),c.inputUnitInfos.length.unit)}),format:(q,c)=>c.formatters.length(q),formatForInputMode:(q,c)=>c.formatters.scalar(b.toUnit(q,c.inputUnitInfos.length.unit)),suffix:q=>q.inputUnitInfos.length.abbreviation,title:q=>q.messages.sketch.distance,...E})}function F(E,q){return new f.TooltipField({actual:b.createScalar(0),parse:g.makeQuantityParser({createQuantity:c=>b.createScalar(c)}),format:(c,k)=>k.formatters.scalar(c),formatForInputMode:(c,k)=>k.formatters.scalar(c),title:c=>c.messages.sketch[E],...q})}
a.makeAreaField=function(E){return new f.TooltipField({name:"area",actual:b.zeroSquareMeters,parse:g.makeQuantityParser({createQuantity:(q,c)=>b.createArea(q,c.inputUnitInfos.area.unit)}),format:(q,c)=>c.formatters.area(q),formatForInputMode:(q,c)=>c.formatters.scalar(b.toUnit(q,c.inputUnitInfos.area.unit)),suffix:q=>q.inputUnitInfos.area.abbreviation,title:q=>q.messages.sketch.area,readOnly:!0,...E})};a.makeDirectionField=function(E){return new f.TooltipField({name:"direction",actual:b.zeroDegrees,
parse:g.makeQuantityParser({createQuantity:(q,c)=>b.createAngle(q,c.inputUnitInfos.angle.unit,"geographic"),sanitize:g.sanitizeAngle}),format:(q,c)=>{const k=c.sketchOptions.values.effectiveDirectionMode;q=v.getNormalizedDirection(q,k);switch(k){case v.DirectionMode.Absolute:return c.formatters.direction(q);case v.DirectionMode.Relative:return c.formatters.directionRelative(q);case v.DirectionMode.RelativeBilateral:return c.formatters.directionRelativeBilateral(q)}},formatForInputMode:(q,c)=>{q=v.getNormalizedDirection(q,
c.sketchOptions.values.effectiveDirectionMode);return c.formatters.scalar(b.toUnit(q,c.inputUnitInfos.angle.unit))},suffix:q=>q.inputUnitInfos.angle.abbreviation,title:q=>{const c=q.sketchOptions.values.effectiveDirectionMode,{absolute:k,relative:m}=q.messages.sketch.direction;switch(c){case v.DirectionMode.Absolute:return k;case v.DirectionMode.Relative:case v.DirectionMode.RelativeBilateral:return m}},...E})};a.makeDistanceField=function(E){return t({...E})};a.makeElevationField=function(E){return new e.TooltipFieldElevation(E)};
a.makeLatitudeField=function(E){return new f.TooltipField({name:"y",actual:b.zeroDegrees,parse:g.parseLatitude,format:(q,c)=>c.formatters.latitudeDecimalDegrees(q),formatForInputMode:q=>g.formatLatitudeDecimalDegreesForInputMode(q),suffix:q=>q.inputUnitInfos.angle.abbreviation,title:q=>q.messages.sketch.latitude,...E})};a.makeLengthField=t;a.makeLongitudeField=function(E){return new f.TooltipField({name:"x",actual:b.zeroDegrees,parse:g.parseLongitude,format:(q,c)=>c.formatters.longitudeDecimalDegrees(q),
formatForInputMode:q=>g.formatLongitudeDecimalDegreesForInputMode(q),suffix:q=>q.inputUnitInfos.angle.abbreviation,title:q=>q.messages.sketch.longitude,...E})};a.makeOrientationField=function(E){return new n.TooltipFieldOrientation(E)};a.makeRelativeDistanceField=function(E){return t({...E,parse:g.makeQuantityParser({createQuantity:(q,c)=>b.createLength(q,c.inputUnitInfos.length.unit)}),format:(q,c)=>c.formatters.lengthRelative(q)})};a.makeScaleField=function(E){return F("scale",{name:"scale",actual:null,
parse:g.makeQuantityParser({createQuantity:q=>b.createScalar(Math.abs(q))}),...E})};a.makeSizeField=function(E){return new u.TooltipFieldSize(E)};a.makeTotalLengthField=function(E){return t({format:(q,c)=>c.formatters.totalLength(q),title:q=>q.messages.sketch.totalLength,readOnly:!0,...E})};a.makeXField=function(E){return F("x",{name:"x",...E})};a.makeYField=function(E){return F("y",{name:"y",...E})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipField":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/uuid ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u,v,t){function F(E){return null!=E&&""===E.trim()}a.TooltipField=class extends g{constructor(E){super(E);this.actual=null;this.lockable=!0;this.id=f.generateUUID();this.inputValue=null;this.readOnly=!1;this.suffix=null;this.visible=!0;this.invalid=!1;this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(E){this.lockable&&this._set("committed",E)}get dirty(){return null!=this.inputValue}get locked(){return this.lockable&&
null!=this.committed}onInput(E){this.inputValue=E}onCommit(E,q,c){this.lockable?this._onCommitLockable(E,c):this._onCommitNonLockable(c);if(!this.invalid||"commit-and-exit"!==E)c.onCommit(q,E)}_onCommitLockable(E,q){const {inputValue:c,locked:k}=this;k&&F(c)?this.unlock():("commit-and-exit"===E&&!k||null!=c)&&this._parseInputAndLock(q)}_onCommitNonLockable(E){const {inputValue:q}=this;F(q)?this.setActual(null):null!=q&&this._parseInputAndSetActual(E)}applyValue(E){this.lockable?this.lock(E):this.setActual(E)}clearInputValue(){this.inputValue=
null;this.invalid=!1}setActual(E){this.actual=E;this.clearInputValue()}lock(E){this.lockable&&(this.committed=E??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(E){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(E))}getSuffix(E){const {suffix:q}=this;return"function"===typeof q?q(E):q}getFormattedValue(E){const {actual:q,committed:c,format:k}=this;return null!=c?k(c,E):null!=q?k(q,E):null}getRawDisplayValue(E){const {actual:q,
committed:c,inputValue:k}=this;return null!=k?k:this.lockable&&null!=c?this.formatForInputMode(c,E):null!=q?this.formatForInputMode(q,E):null}_parseInputAndSetActual(E){const {inputValue:q}=this;if(null==q||F(q))return this.setActual(null);E=this.parse(q,E);null==E?this.invalid=!0:this.setActual(E)}_parseInputAndLock(E){const {inputValue:q,actual:c}=this;if(F(q))return this.unlock();if(null==q)return this.lock(c);E=this.parse(q,E);null==E?this.invalid=!0:this.lock(E)}};b.__decorate([e.property()],
a.TooltipField.prototype,"actual",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"committed",null);b.__decorate([e.property()],a.TooltipField.prototype,"dirty",null);b.__decorate([e.property()],a.TooltipField.prototype,"format",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"formatForInputMode",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"lockable",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"locked",null);b.__decorate([e.property()],a.TooltipField.prototype,
"id",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"inputValue",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"name",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"parse",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"readOnly",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"suffix",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"title",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"visible",void 0);
b.__decorate([e.property()],a.TooltipField.prototype,"invalid",void 0);b.__decorate([e.property()],a.TooltipField.prototype,"unlockOnVertexPlacement",void 0);a.TooltipField=b.__decorate([t.subclass("esri.views.interactive.tooltip.fields.TooltipField")],a.TooltipField);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipFieldElevation":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./parsingAndFormattingUtils ./TooltipField".split(" "),
function(a,b,g,f,e,n,u,v,t,F){a.TooltipFieldElevation=class extends F.TooltipField{constructor(E){super(E);this.showAsZ=!1}normalizeCtorArgs(E){return{name:"elevation",actual:g.zeroMeters,parse:t.makeQuantityParser({createQuantity:(q,c)=>g.createLength(q,c.inputUnitInfos.verticalLength.unit)}),format:(q,c)=>c.formatters.verticalLength(q),formatForInputMode:(q,c)=>c.formatters.scalar(g.toUnit(q,c.inputUnitInfos.verticalLength.unit)),suffix:q=>q.inputUnitInfos.verticalLength.abbreviation,title:q=>q.messages.sketch[this.showAsZ?
"z":"elevation"],unlockOnVertexPlacement:!1,...E}}};b.__decorate([f.property()],a.TooltipFieldElevation.prototype,"showAsZ",void 0);a.TooltipFieldElevation=b.__decorate([v.subclass("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],a.TooltipFieldElevation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipFieldOrientation":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityFormatUtils ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./parsingAndFormattingUtils ./TooltipField ../../../support/angularMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){a.TooltipFieldOrientation=class extends E.TooltipField{constructor(c){super(c);this.precision=1}normalizeCtorArgs(c){return{name:"orientation",actual:null,parse:F.makeQuantityParser({createQuantity:(k,m)=>f.createAngle(k,m.inputUnitInfos.angle.unit,"geographic"),sanitize:F.sanitizeAngle}),format:k=>{k=q.getNormalizedGeographicOrientation(k);return g.formatAngle(k,"geographic",this.precision)},formatForInputMode:(k,m)=>{k=q.getNormalizedGeographicOrientation(k);return m.formatters.scalar(k)},
suffix:k=>k.inputUnitInfos.angle.abbreviation,title:k=>k.messages.sketch.orientation,...c}}};b.__decorate([e.property()],a.TooltipFieldOrientation.prototype,"precision",void 0);a.TooltipFieldOrientation=b.__decorate([t.subclass("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],a.TooltipFieldOrientation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipFieldSize":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./parsingAndFormattingUtils ./TooltipField".split(" "),
function(a,b,g,f,e,n,u,v,t,F){a.TooltipFieldSize=class extends F.TooltipField{constructor(E){super(E);this.precision=null}normalizeCtorArgs(E){return{name:"size",actual:null,parse:t.makeQuantityParser({createQuantity:(q,c)=>g.createLength(q,c.inputUnitInfos.length.unit)}),format:(q,c)=>c.formatters.length(q),formatForInputMode:(q,c)=>c.formatters.scalar(g.toUnit(q,c.inputUnitInfos.length.unit)),suffix:q=>q.inputUnitInfos.length.abbreviation,title:q=>q.messages.sketch.size,...E}}};b.__decorate([f.property()],
a.TooltipFieldSize.prototype,"precision",void 0);a.TooltipFieldSize=b.__decorate([v.subclass("esri.views.interactive.tooltip.fields.TooltipFieldSize")],a.TooltipFieldSize);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/TooltipInfoWithCoordinates":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/support/pointUtils ../fields/fields ../fields/parsingAndFormattingUtils ../../../support/geodesicMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){const c=[0,0];a.TooltipInfoWithCoordinates=k=>{k=class extends k{constructor(){super(...arguments);this.longitude=F.makeLongitudeField();this.latitude=F.makeLatitudeField();this.x=F.makeXField();this.y=F.makeYField();this.elevation=F.makeElevationField();this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,
x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(m,l=m?.spatialReference){this.geographic=l?q.supportsGeodesicMeasurement(l):!1;null==m?(this._setActualLonLat(null,null),this._setActualXY(null,null)):this.geographic?(m=t.getLongitudeLatitude(m,c),this._setActualLonLat(E.createGeographicCoordinate(m?.[0]),E.createGeographicCoordinate(m?.[1]))):this._setActualXY(g.createScalar(m.x),g.createScalar(m.y))}_setActualLonLat(m,l){this.longitude.actual=
m;this.latitude.actual=l}_setActualXY(m,l){this.x.actual=m;this.y.actual=l}};b.__decorate([f.property()],k.prototype,"geographic",void 0);b.__decorate([f.property()],k.prototype,"effectiveX",null);b.__decorate([f.property()],k.prototype,"effectiveY",null);b.__decorate([f.property()],k.prototype,"key",null);return k=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],k)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawPointTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),
function(a,b,g,f,e,n,u,v,t){a.DrawPointTooltipInfo=class extends t.TooltipInfoWithCoordinates(v.SketchTooltipInfo){constructor(F){super(F);this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};b.__decorate([g.property()],a.DrawPointTooltipInfo.prototype,"helpMessage",void 0);b.__decorate([g.property()],a.DrawPointTooltipInfo.prototype,"allFields",null);a.DrawPointTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],
a.DrawPointTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawPolygonTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),function(a,b,g,f,e,n,u,v,t,F){a.DrawPolygonTooltipInfo=
class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);this.type="draw-polygon";this.direction=v.makeDirectionField();this.distance=v.makeDistanceField();this.area=v.makeAreaField();this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};b.__decorate([g.property()],a.DrawPolygonTooltipInfo.prototype,"xyMode",void 0);b.__decorate([g.property()],a.DrawPolygonTooltipInfo.prototype,
"helpMessage",void 0);b.__decorate([g.property()],a.DrawPolygonTooltipInfo.prototype,"allFields",null);a.DrawPolygonTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],a.DrawPolygonTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawPolylineTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),
function(a,b,g,f,e,n,u,v,t,F){a.DrawPolylineTooltipInfo=class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);this.type="draw-polyline";this.direction=v.makeDirectionField();this.distance=v.makeDistanceField();this.totalLength=v.makeTotalLengthField();this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};b.__decorate([g.property()],a.DrawPolylineTooltipInfo.prototype,
"helpMessage",void 0);b.__decorate([g.property()],a.DrawPolylineTooltipInfo.prototype,"xyMode",void 0);b.__decorate([g.property()],a.DrawPolylineTooltipInfo.prototype,"allFields",null);a.DrawPolylineTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],a.DrawPolylineTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/DrawRectangleTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t){a.DrawRectangleTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="draw-rectangle";this.ySize=this.xSize=g.zeroMeters;this.area=g.zeroSquareMeters}get allFields(){return[]}};b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"xSize",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"ySize",void 0);b.__decorate([f.property()],
a.DrawRectangleTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"allFields",null);a.DrawRectangleTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],a.DrawRectangleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticAreaMeasurementUtils":function(){define(["exports","./euclideanAreaMeasurementUtils","./geodesicAreaMeasurementUtils"],function(a,
b,g){function f(e,n,u=b.createEuclideanPlanarAreaCache()){return"on-the-ground"===n?(n=g.geodesicArea(e),null!=n?n:b.euclideanHorizontalPlanarArea(e,u)):b.euclideanPlanarArea(e,u)}a.autoArea2D=function(e,n=b.createEuclideanPlanarAreaCache()){return f(e,"on-the-ground",n)};a.autoAreaByElevationMode=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanAreaMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/earcut ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/plane ../../geometry/support/triangle ./measurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F){function E(l,r,z=l.hasZ){const H=F.computeEuclideanMeasurementSR(l.spatialReference),D=g.areaUnitFromSpatialReference(H);if(null==D)return null;let w=0;for(const B of l.rings){var x=B.length;if(3>x)continue;const {positionsWorldCoords:p}=r;for(;p.length<x;)p.push(n.create());var C=k,h=e.set(m,0,0,0),y=1/x;for(let A=0;A<x;A++){var d=B[A];2>d.length?d=!1:(e.set(C,d[0],d[1],z?d[2]||0:0),d=!0);if(!d||!u.projectVectorToVector(C,l.spatialReference,p[A],H))return null;e.scaleAndAdd(h,
h,p[A],y)}C=v.fromPoints(p[0],p[1],h,v.wrap());if(0!==e.squaredLength(v.getNormal(C))){for(y=0;y<x;y++)v.projectPointLocal(C,h,p[y],p[y]);x=c(p);for(h=0;h<x.length;h+=3)w+=t.areaPoints2d(p[x[h]],p[x[h+1]],p[x[h+2]])}}return b.createArea(w,D)}function q(){return{positionsWorldCoords:[]}}function c(l){var r=f.earcut;const z=new Float64Array(2*l.length);for(let H=0;H<l.length;++H){const D=l[H],w=2*H;z[w]=D[0];z[w+1]=D[1]}return r.call(f,z,[],2)}const k=n.create(),m=n.create();a.computeEuclideanPlanarArea=
E;a.createEuclideanPlanarAreaCache=q;a.euclideanHorizontalPlanarArea=function(l,r=q()){return E(l,r,!1)};a.euclideanPlanarArea=function(l,r=q()){return E(l,r)};a.triangulate=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicAreaMeasurementUtils":function(){define(["exports","../../core/quantityUtils","../../geometry/geometryEngine","../../geometry/support/geodesicUtils","./geodesicMeasurementUtils"],function(a,b,g,f,e){function n(v){return b.createArea(Math.abs(f.geodesicAreas([v],
"square-meters")[0]),"square-meters")}function u(v){try{return b.createArea(Math.abs(g.geodesicArea(v,"square-meters")),"square-meters")}catch(t){return null}}a.geodesicArea=function(v){const {spatialReference:t}=v;return e.geodesicMeasure(t,n,u,v)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/Logger ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./interfaces ./ManipulatorCollection".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.InteractiveToolBase=class extends g{constructor(q){super(q);this.manipulators=new E.ManipulatorCollection;this.automaticManipulatorSelection=!0;this.hasHoveredManipulators=this.hasGrabbedManipulators=!1;this.firstGrabbedManipulator=null;this.created=!1;this.removeIncompleteOnCancel=!0;this._editableFlags=new Map([[F.EditableFlag.MANAGER,!0],[F.EditableFlag.USER,!0]]);this._creationFinishedResolver=n.createResolver()}get active(){return null!=this.view&&this.view.activeTool===
this}set visible(q){this._get("visible")!==q&&(this._set("visible",q),this._syncVisible())}get editable(){return this.getEditableFlag(F.EditableFlag.USER)}set editable(q){this.setEditableFlag(F.EditableFlag.USER,q)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy();this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(q){this.onInputEvent(q)}handleInputEventAfter(q){this.onInputEventAfter(q)}setEditableFlag(q,
c){this._editableFlags.set(q,c);this.manipulators.isToolEditable=this.internallyEditable;this._updateManipulatorAttachment();q===F.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange();this.onManipulatorSelectionChanged()}getEditableFlag(q){return this._editableFlags.get(q)??!1}endDrag(){const q=this.view.inputManager.latestPointerLocation;if(q){var c=!1;this.manipulators.forEach(({manipulator:k})=>{k.dragging&&(c=!0,k.events.emit("drag",{action:"end",start:q,screenPoint:q}))});
c&&(this.view.toolViewManager.activeTool=null)}}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(q){}onInputEventAfter(q){}get internallyEditable(){return this.getEditableFlag(F.EditableFlag.USER)&&this.getEditableFlag(F.EditableFlag.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this);this._set("created",!0)}_syncVisible(){this.initialized&&
(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))}_show(){this._updateManipulatorAttachment();this.onShow()}_hide(){this._updateManipulatorAttachment();this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};b.__decorate([u.property({constructOnly:!0})],a.InteractiveToolBase.prototype,"view",void 0);b.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"active",null);b.__decorate([u.property({value:!0})],
a.InteractiveToolBase.prototype,"visible",null);b.__decorate([u.property({value:!0})],a.InteractiveToolBase.prototype,"editable",null);b.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"manipulators",void 0);b.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"updating",null);b.__decorate([u.property()],a.InteractiveToolBase.prototype,"cursor",null);b.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"automaticManipulatorSelection",
void 0);b.__decorate([u.property()],a.InteractiveToolBase.prototype,"hasFocusedManipulators",null);b.__decorate([u.property()],a.InteractiveToolBase.prototype,"hasGrabbedManipulators",void 0);b.__decorate([u.property()],a.InteractiveToolBase.prototype,"hasHoveredManipulators",void 0);b.__decorate([u.property()],a.InteractiveToolBase.prototype,"firstGrabbedManipulator",void 0);b.__decorate([u.property({readOnly:!0})],a.InteractiveToolBase.prototype,"created",void 0);b.__decorate([u.property({readOnly:!0})],
a.InteractiveToolBase.prototype,"removeIncompleteOnCancel",void 0);a.InteractiveToolBase=b.__decorate([t.subclass("esri.views.interactive.InteractiveToolBase")],a.InteractiveToolBase);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../core/Collection"],function(a,b){a.ManipulatorVisibilityPredicate=void 0;(function(f){f[f.WhenToolEditable=0]="WhenToolEditable";f[f.WhenToolNotEditable=1]="WhenToolNotEditable";
f[f.Always=2]="Always"})(a.ManipulatorVisibilityPredicate||(a.ManipulatorVisibilityPredicate={}));class g{constructor(){this._isToolEditable=!0;this._manipulators=new b;this._resourceContexts={manipulator3D:{}};this._attached=!1}set isToolEditable(f){this._isToolEditable=f}get length(){return this._manipulators.length}add(f,e=a.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([f],e)}addMany(f,e=a.ManipulatorVisibilityPredicate.WhenToolEditable){for(const n of f)f={manipulator:n,visibilityPredicate:e,
attached:!1},this._manipulators.add(f),this._attached&&this._updateManipulatorAttachment(f)}remove(f){for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.at(e).manipulator===f){f=this._manipulators.splice(e,1)[0];this._detachManipulator(f);break}}removeAll(){this._manipulators.forEach(f=>{this._detachManipulator(f)});this._manipulators.removeAll()}attach(){this._manipulators.forEach(f=>{this._updateManipulatorAttachment(f)});this._attached=!0}detach(){this._manipulators.forEach(f=>{this._detachManipulator(f)});
this._attached=!1}destroy(){this.detach();this._manipulators.forEach(({manipulator:f})=>f.destroy());this._manipulators.destroy();this._resourceContexts=null}on(f,e){return this._manipulators.on(f,n=>{e(n)})}forEach(f){for(const e of this._manipulators.items)f(e)}some(f){return this._manipulators.items.some(f)}toArray(){const f=[];this.forEach(e=>f.push(e.manipulator));return f}intersect(f,e){let n=null,u=Number.MAX_VALUE;this._manipulators.forEach(({manipulator:v,attached:t})=>{t&&v.interactive&&
(t=v.intersectionDistance(f,e),null!=t&&t<u&&(u=t,n=v))});return n}_updateManipulatorAttachment(f){this._isManipulatorItemVisible(f)?this._attachManipulator(f):this._detachManipulator(f)}_attachManipulator(f){f.attached||(f.manipulator.attach&&f.manipulator.attach(this._resourceContexts),f.attached=!0)}_detachManipulator(f){if(f.attached){var e=f.manipulator;e.grabbing=!1;e.dragging=!1;e.hovering=!1;e.selected=!1;e.detach&&e.detach(this._resourceContexts);f.attached=!1}}_isManipulatorItemVisible(f){return f.visibilityPredicate===
a.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?f.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolEditable:f.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolNotEditable}}a.ManipulatorCollection=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchLabelOptions ./SketchTooltipOptions ./SketchValueOptions".split(" "),
function(a,b,g,f,e,n,u,v,t,F){b=class extends b{constructor(E){super(E);this.labels=new v;this.tooltips=new t;this.values=new F}};a.__decorate([g.property({nonNullable:!0,type:v})],b.prototype,"labels",void 0);a.__decorate([g.property({nonNullable:!0,type:t})],b.prototype,"tooltips",void 0);a.__decorate([g.property({nonNullable:!0,type:F})],b.prototype,"values",void 0);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.SketchOptions")],b)})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u){b=class extends b{constructor(v){super(v);this.enabled=!1}};a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,g,f,e,n,u,v,t){b=class extends b{constructor(F){super(F);this.forceEnabled=this.enabled=!1;this.helpMessageIcon=this.helpMessage=null;this.inputEnabled=!0;this.elevation=new v.SketchTooltipElevationOptions;this.placement="auto";this.offset=null;this.visibleElements=new t;this.visualVariables=null;this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([g.property()],
b.prototype,"forceEnabled",void 0);a.__decorate([g.property()],b.prototype,"effectiveEnabled",null);a.__decorate([g.property()],b.prototype,"helpMessage",void 0);a.__decorate([g.property()],b.prototype,"helpMessageIcon",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",void 0);a.__decorate([g.property({type:v.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([g.property()],b.prototype,"placement",void 0);a.__decorate([g.property()],
b.prototype,"offset",void 0);a.__decorate([g.property({type:t,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([g.property()],b.prototype,"visualVariables",void 0);a.__decorate([g.property()],b.prototype,"xyMode",void 0);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u,v){a.SketchTooltipElevationOptions=class extends g{constructor(t){super(t);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([f.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([v.subclass("esri.views.interactive.sketch.SketchTooltipElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u){b=class extends b{constructor(v){super(v);this.header=this.elevation=this.distance=this.direction=this.coordinates=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}};a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"area",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"coordinates",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,
"direction",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"distance",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"helpMessage",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"orientation",void 0);a.__decorate([g.property({type:Boolean,
nonNullable:!0})],b.prototype,"radius",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"rotation",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"scale",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"size",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"totalLength",void 0);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.SketchTooltipVisibleElements")],b)})},"esri/views/interactive/sketch/SketchValueOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./Units ../../support/angularMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t){b=class extends b{constructor(F){super(F);this.directionMode="relative";this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case "relative":return this.relativeDirectionIsBilateral?t.DirectionMode.RelativeBilateral:t.DirectionMode.Relative;case "absolute":return t.DirectionMode.Absolute}}get displayUnits(){return this._get("displayUnits")??new v}set displayUnits(F){this._set("displayUnits",F)}get inputUnits(){return this._get("inputUnits")??
new v}set inputUnits(F){this._set("inputUnits",F)}};a.__decorate([g.property({type:String,nonNullable:!0})],b.prototype,"directionMode",void 0);a.__decorate([g.property({type:Boolean,nonNullable:!0})],b.prototype,"relativeDirectionIsBilateral",void 0);a.__decorate([g.property()],b.prototype,"effectiveDirectionMode",null);a.__decorate([g.property({type:v,nonNullable:!0})],b.prototype,"displayUnits",null);a.__decorate([g.property({type:v,nonNullable:!0})],b.prototype,"inputUnits",null);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.SketchValueOptions")],
b)})},"esri/views/interactive/sketch/Units":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,g,f,e,n,u){b=class extends b{constructor(v){super(v);this.area=this.verticalLength=this.length=null}};a.__decorate([g.property()],b.prototype,"length",void 0);a.__decorate([g.property()],b.prototype,"verticalLength",
void 0);a.__decorate([g.property()],b.prototype,"area",void 0);return b=a.__decorate([u.subclass("esri.views.interactive.sketch.Units")],b)})},"esri/views/draw/DrawOperation":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/lang ../../core/maybe ../../core/memoize ../../core/promiseUtils ../../core/ReactiveSet ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/diffUtils ../../core/support/UpdatingHandles ../../layers/graphics/dehydratedFeatureComparison ../../support/elevationInfoUtils ../ViewingMode ./DrawingMode ./DrawManipulator ../interactive/coordinateHelper ../interactive/dragEventPipeline ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryOperations ../interactive/sketch/constraints ../interactive/sketch/constraintUtils ../interactive/sketch/SketchLabelOptions ../interactive/snapping/SnappingContext ../interactive/snapping/SnappingDragPipelineStep ../interactive/snapping/SnappingOperation ../interactive/snapping/snappingUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L){const M=Symbol(),N=Symbol();a.DrawOperation=class extends f.EventedMixin(g){constructor(K){super(K);this._hideDefaultCursor=this._createOperationCompleted=!1;this._pointerDownStates=new t;this._stagedPointerType=this._stagedScreenPoint=null;this._updatingHandles=new r.UpdatingHandles;this._stagedPointerId=null;this.constraintsEnabled=!1;this.constraints=void 0;this._getPointConstraint=u.memoize(p.getPointConstraint);this._getPolylineOrPolygonConstraint=
u.memoize(p.getPolylineOrPolygonConstraint);this.defaultZ=this.constraintZ=null;this.isDraped=!0;this.labelOptions=new A;this.cursor=null;this.loading=!1;this.secondToLastVertex=this.lastVertex=this.firstVertex=this.snapToSceneEnabled=null;null==K.elevationInfo&&(this.elevationInfo=H.getEffectiveElevationInfo(!!K.hasZ))}initialize(){const {geometryType:K,view:O}=this,U=O.spatialReference,V="viewingMode"in O.state?O.state.viewingMode:D.ViewingMode.Local,ea="segment"===K||"multipoint"===K?"polyline":
K;this.coordinateHelper=C.createCoordinateHelper(this.hasZ,this.hasM,U);this._editGeometryOperations=new d.EditGeometryOperations(new y.EditGeometry(ea,this.coordinateHelper),V);this._snappingOperation=new J.SnappingOperation({view:O});this.addHandles([F.watch(()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint}),({stagedPoint:R,constraint:T},aa)=>{const {snappingOptions:ba}=this;ba&&(ba.forceDisabled=null!=T&&B.isPoint(T));if(null!=aa&&R===aa.stagedPoint&&T!==aa.constraint)return this._onKeyboardBasedChange();
this._processCursor(R??this._screenToMap(this._stagedScreenPoint))},{equals:(R,T)=>R.stagedPoint===T.stagedPoint&&n.equalsMaybe(R.constraint,T.constraint)}),F.watch(()=>this.view.viewpoint,(R,T)=>{R&&T&&l.diff(R,T)&&this._onKeyboardBasedChange()})]);this._activeComponent=new y.Component(U,V);this._editGeometryOperations.data.components.push(this._activeComponent);const Y=this.segmentLabels;null!=Y&&(Y.context={view:O,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,
labelOptions:this.labelOptions},this.addHandles(F.watch(()=>this.labelOptions.enabled,R=>{Y.visible=R},F.syncAndInitial)));this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],R=>{const T=R.vertices.map(ca=>({componentIndex:0,vertexIndex:ca.index,coordinates:this.coordinateHelper.vectorToArray(ca.pos)})),aa=T.map(ca=>ca.coordinates);var ba=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;z.pointEquals(ba,this.firstVertex)||
(this.firstVertex=ba);ba=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;z.pointEquals(ba,this.lastVertex)||(this.lastVertex=ba);ba=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;z.pointEquals(ba,this.secondToLastVertex)||(this.secondToLastVertex=ba);this._processCursor(this.cursorVertex);switch(R.type){case "vertex-add":this.emit(R.type,{...R,added:aa,vertices:T});break;case "vertex-update":this.emit(R.type,
{...R,updated:aa,vertices:T});break;case "vertex-remove":this.emit(R.type,{...R,removed:aa,vertices:T})}}));const ra=this._manipulator=new x.DrawManipulator({consumesClicks:!1,grabbableForEvent:R=>"click"!==this.drawingMode?!0:"touch"===R.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(ra);ra.grabbable="point"!==K;this.addHandles([ra.events.on("immediate-click",R=>this._onImmediateClick(R)),ra.events.on("immediate-double-click",R=>this._onImmediateDoubleClick(R)),
F.watch(()=>this.drawingMode,()=>{this.removeHandles(M);this.addHandles(this._createManipulatorDragPipeline(ra),M)},F.syncAndInitial),F.watch(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:R})=>{ra.cursor=R},F.syncAndInitial)]);L.setupSnappingToggleHandles(this,()=>{var R=this._getSnappingContext(this.view.inputManager.latestPointerType??"mouse");null!=this.snappingManager&&(R=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,R),this._updatingHandles.addPromise(v.ignoreAbortErrors(R)))})}destroy(){n.destroyMaybe(this.segmentLabels);
n.destroyMaybe(this._snappingOperation);this._editGeometryOperations=n.destroyMaybe(this._editGeometryOperations);this._updatingHandles.destroy()}get _isDragging(){const {_stagedPointerId:K,_manipulator:O}=this;return null!=K&&this._pointerDownStates.has(K)||O.grabbing||!O.interactive}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const K=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==
K}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(K=>this.coordinateHelper.vectorToArray(K.pos))}get _constraint(){const {constraints:K,constraintsEnabled:O}=this;if(K&&O)switch(this.geometryType){case "point":return this._getPointConstraint(K);case "polygon":case "polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,K)}}set drawingMode(K){this._set("drawingMode",
K??w.defaultDrawingMode)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(K){this._manipulator.interactive=K}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===
this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const {cursorVertex:K,lastVertex:O,firstVertex:U,geometryType:V}=this;return"polygon"===V&&z.pointNear(K,U)||z.pointNear(K,O)?null:K}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const {committedVertices:K,committableVertex:O,coordinateHelper:U}=this,V=K.slice();null!=O&&V.push(U.pointToArray(O));return V}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();
const {committableVertex:K}=this;null!=K&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(K))}complete(K){K=K?.aborted||!1;this._snappingOperation.abort();this.snappingManager?.doneSnapping();const {geometryType:O,numCommittedVertices:U}=this,V="multipoint"===O&&0===U||"polyline"===O&&2>U||"polygon"===O&&3>U;"segment"!==O&&"point"!==O||this.commitStagedVertex();this._createOperationCompleted=!V;if(this.isCompleted||K)this._stagedPointerType=this._stagedPointerId=this._stagedScreenPoint=
null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((ea,Y)=>({componentIndex:0,vertexIndex:Y,coordinates:ea})),aborted:K,type:"complete"})}onInputEvent(K){switch(K.type){case "pointer-down":this._pointerDownStates.add(K.pointerId);break;case "pointer-up":this._pointerDownStates.delete(K.pointerId)}switch(K.type){case "pointer-move":return this._onPointerMove(K);case "hold":return this._onHold(K)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&
this.snappingManager.doneSnapping();this._editGeometryOperations.undo()}_processCursor(K){const O=e.clone(this.cursorVertex);K=(K=e.clone(K))&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(K)??K);K=this._snapToClosingVertex(K);K=this._applyConstraints(K);z.pointNear(O,K)||(this._set("cursorVertex",K),this.segmentLabels?.set("stagedVertex",null!=K?this.coordinateHelper.pointToVector(K):null),null==K||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,
vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(K)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(K){if(null==K||this._isDragging||"polygon"!==this.geometryType||2>=this.numCommittedVertices)return K;const O=this._mapToScreen(K);if(!O)return K;const U=this._activeComponent;return this._vertexWithinPointerDistance(U.vertices[0].pos,O)?this.firstVertex:this._vertexWithinPointerDistance(U.vertices.at(-1).pos,
O)?this.lastVertex:K}_createManipulatorDragPipeline(K){switch(this.drawingMode){case "click":return this._createManipulatorDragPipelineClick(K);case "freehand":return this._createManipulatorDragPipelineFreehand(K);case "hybrid":return this._createManipulatorDragPipelineHybrid(K)}}_createManipulatorDragPipelineClick(K){return h.createManipulatorDragEventPipeline(K,(O,U,V,ea)=>{const Y="touch"===ea&&this._snappingEnabled;if(!this.isCompleted&&Y){var {snappingStep:ra,cancelSnapping:R}=I.createSnapDragEventPipelineStep({predicate:()=>
Y,snappingManager:this.snappingManager,snappingContext:new G.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:ea,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});V=V.next(T=>{Y&&null!=this.snappingManager&&this.snappingManager.doneSnapping();return T}).next(R);U.next(this._screenToMapDragEventStep()).next(T=>{"start"===T.action&&
(this._processCursor(T.mapStart),("segment"===this.geometryType||Y&&!this.numCommittedVertices)&&this.commitStagedVertex());return T}).next(h.sceneSnappingAtLocation(this.view,this.elevationInfo)).next(...ra).next(T=>{Y&&(this._processCursor(T.mapEnd),"end"===T.action&&this.commitStagedVertex());return T}).next(T=>{"end"===T.action&&("mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete());return T})}})}_createManipulatorDragPipelineFreehand(K){return h.createManipulatorDragEventPipeline(K,
(O,U)=>{this.isCompleted||U.next(this._screenToMapDragEventStep()).next(V=>{"start"===V.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(V.mapStart),"segment"===this.geometryType&&this.commitStagedVertex());return V}).next(V=>{switch(V.action){case "start":case "update":this._processCursor(V.mapEnd);"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return V})})}_createManipulatorDragPipelineHybrid(K){return h.createManipulatorDragEventPipeline(K,
(O,U)=>{this.isCompleted||U.next(this._screenToMapDragEventStep()).next(V=>{"start"===V.action&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),N),this._processCursor(V.mapStart),this.commitStagedVertex());return V}).next(V=>{switch(V.action){case "start":case "update":this._processCursor(V.mapEnd);"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),
this.removeHandles(N),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return V})})}get _drawAtFixedElevation(){const {constraintsEnabled:K,constraintZ:O,geometryType:U,numCommittedVertices:V}=this;return K?null!=O||"segment"===U&&0<V:("segment"===U||"polygon"===U)&&0<V}_updateAndGetEffectiveDrawSurface(){const {constraintsEnabled:K,coordinateHelper:O,drawSurface:U,elevationDrawSurface:V,snapToSceneEnabled:ea}=this;if(null==V)return U;if(!this.hasZ)return V.defaultZ=null,
V;const Y=this.elevationInfo?.mode;let ra=this.defaultZ,R=K||"absolute-height"===Y;null!=ea&&(R=ea);"on-the-ground"===Y&&(R=!1);this._drawAtFixedElevation&&(ra=(K?this.constraintZ:null)??O.getZ(this._activeComponent.vertices[0].pos),R=!1);if(R)return U;V.defaultZ=ra;return V}_mapToScreen(K){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(K)}_onHold(K){this._snappingOperation.abort();"click"===this.drawingMode&&"touch"===K.pointerType&&this._snappingEnabled&&this._processCursor(K.mapPoint);
K.stopPropagation()}_onImmediateClick(K){if(!("mouse"===K.pointerType&&2===K.button||this._manipulator.dragging))try{const {drawingMode:O,geometryType:U}=this;this._stagedPointerType=K.pointerType;this._stagedScreenPoint=K.screenPoint;const V=this._screenToMap(K.screenPoint);null==V||null==V||"freehand"===O&&"point"!==U||(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(V),null==this.committableVertex?this.complete():(this.commitStagedVertex(),"mouse"!==K.pointerType&&this._processCursor(null),
("freehand"===O||"point"===U||"segment"===U&&2===this.numCommittedVertices||"segment"===U&&"hybrid"===O&&1===this.numCommittedVertices)&&this.complete()))}finally{K.stopPropagation()}}_onImmediateDoubleClick(K){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),K.stopPropagation())}_onPointerMove(K){const O=E.createScreenPoint(K.x,K.y);this._stagedScreenPoint=O;this._stagedPointerType=K.pointerType;this._stagedPointerId=K.pointerId;this._isDragging?this._snappingOperation.abort():
(K.stopPropagation(),this._processCursorMovementRelativeToSurface(O,K.pointerType))}_onKeyboardBasedChange(){"mouse"!==this._stagedPointerType||!this._stagedScreenPoint||null==this._stagedPointerId||this._isDragging?this._snappingOperation.abort():this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType)}_processCursorMovementRelativeToSurface(K,O){const U=this._snappingOperation,V=this._screenToMap(K);K=this._requiresScenePoint?this.drawSurface?.screenToMap(K):
null;if(null==V)this._hideDefaultCursor=!0,this._processCursor(null),U.abort();else{this._hideDefaultCursor=!1;var ea=this.snappingManager;null==ea?(this._processCursor(V),U.abort()):(O=this._getSnappingContext(O),this._updatingHandles.addPromise(v.ignoreAbortErrors(U.snap({point:V,scenePoint:K},ea,O))))}}_applyConstraints(K){const {_constraint:O,constraints:U}=this;if(!K||!U||!O)return K;var {context:V}=U,ea=p.pointToConstraintSpace(K,V);ea=ea?O.closestTo(ea):void 0;if(!ea)return K;K=p.constraintSpaceToPoint(ea,
K,V);V="2d"===this.view.type||"absolute-height"!==V.elevationInfo.mode;null!=K&&V&&null!=this.constraintZ&&this.hasZ&&(K.z=this.constraintZ);return K}_screenToMap(K){return K?this._updateAndGetEffectiveDrawSurface()?.screenToMap(K):null}_screenToMapDragEventStep(){let K=null;return O=>{"start"===O.action&&(K=this._screenToMap(O.screenStart));if(null==K)return null;const U=this._screenToMap(O.screenEnd);return null!=U?{...O,mapStart:K,mapEnd:U}:null}}_vertexWithinPointerDistance(K,O){const U=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(K));
null!=U?(K=U.x-O.x,O=U.y-O.y,O=25>=K*K+O*O):O=!1;return O}_getSnappingContext(K){const O=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new G.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:K,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=O?{value:O,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};b.__decorate([q.property()],a.DrawOperation.prototype,"_hideDefaultCursor",
void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"_stagedPointerId",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"_isDragging",null);b.__decorate([q.property()],a.DrawOperation.prototype,"_snappingOperation",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"_snappingEnabled",null);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"graphic",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"constraintsEnabled",void 0);b.__decorate([q.property()],
a.DrawOperation.prototype,"constraints",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"_constraint",null);b.__decorate([q.property()],a.DrawOperation.prototype,"constraintZ",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"defaultZ",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"isDraped",void 0);b.__decorate([q.property({value:w.defaultDrawingMode})],a.DrawOperation.prototype,"drawingMode",null);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,
"elevationDrawSurface",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"elevationInfo",void 0);b.__decorate([q.property({constructOnly:!0,type:A})],a.DrawOperation.prototype,"labelOptions",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"geometryType",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"hasM",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"hasZ",void 0);b.__decorate([q.property()],
a.DrawOperation.prototype,"cursor",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"effectiveCursor",null);b.__decorate([q.property()],a.DrawOperation.prototype,"loading",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"manipulators",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"drawSurface",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"segmentLabels",void 0);b.__decorate([q.property({constructOnly:!0})],
a.DrawOperation.prototype,"snappingManager",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"snappingVisualizer",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"snapToSceneEnabled",void 0);b.__decorate([q.property({readOnly:!0})],a.DrawOperation.prototype,"cursorVertex",null);b.__decorate([q.property({readOnly:!0})],a.DrawOperation.prototype,"visualizationCursorVertex",null);b.__decorate([q.property()],a.DrawOperation.prototype,"committableVertex",null);
b.__decorate([q.property()],a.DrawOperation.prototype,"firstVertex",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"lastVertex",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"secondToLastVertex",void 0);b.__decorate([q.property()],a.DrawOperation.prototype,"updating",null);b.__decorate([q.property({constructOnly:!0})],a.DrawOperation.prototype,"view",void 0);a.DrawOperation=b.__decorate([m.subclass("esri.views.draw.DrawOperation")],a.DrawOperation);a.defaultCursor="crosshair";
a.defaultLoadingCursor="progress";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawingMode":function(){define(["exports"],function(a){a.defaultDrawingMode="click";a.drawingModes=["freehand","hybrid","click"];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawManipulator":function(){define(["exports","../../core/Evented"],function(a,b){class g{constructor({consumesClicks:f,grabbableForEvent:e}){this.events=new b;this.interactive=
!0;this.selectable=!1;this.cursor=null;this.grabbable=!0;this.consumesClicks=f;this.grabbableForEvent=e}destroy(){}intersectionDistance(f,e){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}a.DrawManipulator=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ../../core/libs/gl-matrix-2/factories/vec4f64 ../../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v){var t;(function(c){c[c.Z=0]="Z";c[c.M=1]="M"})(t||={});class F{constructor(c){this.spatialReference=c}createVector(){return this._tag(g.create())}pointToVector(c){return this._tag(g.fromValues(c.x,c.y))}arrayToVector(c){return this._tag(g.fromValues(c[0],c[1]))}vectorToArray(c){return[c[0],c[1]]}pointToArray(c){return[c.x,c.y]}vectorToPoint(c,k=new v){k.x=c[0];k.y=c[1];k.z=void 0;k.m=void 0;k.spatialReference=this.spatialReference;return k}arrayToPoint(c,k=new v){k.x=c[0];
k.y=c[1];k.z=void 0;k.m=void 0;k.spatialReference=this.spatialReference;return k}vectorToDehydratedPoint(c,k){if(c)return k??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},k.x=c[0],k.y=c[1],k.z=void 0,k.m=void 0,k.hasZ=!1,k.hasM=!1,k.spatialReference=this.spatialReference,k}lerp(c,k,m,l){return b.lerp(l,c,k,m)}addDelta(c,k,m){c[0]+=k;c[1]+=m}distance(c,k){return b.distance(c,k)}getZ(c,k){return k}hasZ(){return!1}getM(c,k){return k}hasM(){return!1}clone(c){return this._tag(g.fromArray(c))}copy(c,
k){return b.copy(k,c)}fromXYZ(c){return this._tag(g.fromValues(c[0],c[1]))}toXYZ(c,k=e.create()){return f.set(k,c[0],c[1],0)}pointToXYZ(c,k=e.create()){return f.set(k,c.x,c.y,0)}equals(c,k){return b.equals(c,k)}_tag(c){return c}}class E{constructor(c,k){this._valueType=c;this.spatialReference=k}createVector(){return this._tag(e.create())}pointToVector(c){return this._tag(e.fromValues(c.x,c.y,this._valueType===t.Z?c.z:c.m))}arrayToVector(c){return this._tag(e.fromValues(c[0],c[1],c[2]||0))}vectorToArray(c){return[c[0],
c[1],c[2]]}pointToArray(c){return this._valueType===t.Z?[c.x,c.y,c.z]:[c.x,c.y,c.m]}vectorToPoint(c,k=new v){k.x=c[0];k.y=c[1];k.z=this._valueType===t.Z?c[2]:void 0;k.m=this._valueType===t.M?c[2]:void 0;k.spatialReference=this.spatialReference;return k}arrayToPoint(c,k=new v){k.x=c[0];k.y=c[1];k.z=this._valueType===t.Z?c[2]:void 0;k.m=this._valueType===t.M?c[2]:void 0;k.spatialReference=this.spatialReference;return k}vectorToDehydratedPoint(c,k){if(c){k??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,
hasM:void 0,spatialReference:void 0,type:"point"};var m=this._valueType===t.Z,l=this._valueType===t.M;k.x=c[0];k.y=c[1];k.z=m?c[2]:void 0;k.m=l?c[2]:void 0;k.hasZ=m;k.hasM=l;k.spatialReference=this.spatialReference;return k}}lerp(c,k,m,l){return f.lerp(l,c,k,m)}addDelta(c,k,m,l){c[0]+=k;c[1]+=m;this._valueType===t.Z&&(c[2]+=l)}distance(c,k){return this._valueType===t.Z?f.distance(c,k):b.distance(c,k)}getZ(c,k){return this._valueType===t.Z?c[2]:k}hasZ(){return this._valueType===t.Z}getM(c,k){return this._valueType===
t.M?c[2]:k}hasM(){return this._valueType===t.M}clone(c){return this._tag(e.fromArray(c))}copy(c,k){return f.copy(k,c)}fromXYZ(c,k=0,m=0){return this._tag(e.fromValues(c[0],c[1],this._valueType===t.Z?2<c.length?c[2]:k:m))}toXYZ(c,k=e.create()){return f.set(k,c[0],c[1],this._valueType===t.Z?c[2]:0)}pointToXYZ(c,k=e.create()){return f.set(k,c.x,c.y,this._valueType===t.Z?c.z??0:0)}equals(c,k){return f.equals(c,k)}_tag(c){return c}}class q{constructor(c){this.spatialReference=c}createVector(){return this._tag(u.create())}pointToVector(c){return this._tag(u.fromValues(c.x,
c.y,c.z,c.m))}arrayToVector(c){return this._tag(u.fromValues(c[0],c[1],c[2]||0,c[3]||0))}vectorToArray(c){return[c[0],c[1],c[2],c[3]]}pointToArray(c){return[c.x,c.y,c.z,c.m]}vectorToPoint(c,k=new v){k.x=c[0];k.y=c[1];k.z=c[2];k.m=c[3];k.spatialReference=this.spatialReference;return k}arrayToPoint(c,k=new v){k.x=c[0];k.y=c[1];k.z=c[2];k.m=c[3];k.spatialReference=this.spatialReference;return k}vectorToDehydratedPoint(c,k){if(c)return k??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,
spatialReference:void 0,type:"point"},k.x=c[0],k.y=c[1],k.z=c[2],k.m=c[3],k.hasZ=!0,k.hasM=!0,k.spatialReference=this.spatialReference,k}lerp(c,k,m,l){return n.lerp(l,c,k,m)}addDelta(c,k,m,l){c[0]+=k;c[1]+=m;c[2]+=l}distance(c,k){return f.distance(c,k)}getZ(c){return c[2]}hasZ(){return!0}getM(c){return c[3]}hasM(){return!0}clone(c){return this._tag(u.fromArray(c))}copy(c,k){return n.copy(k,c)}fromXYZ(c,k=0,m=0){return this._tag(u.fromValues(c[0],c[1],2<c.length?c[2]:k,m))}toXYZ(c,k=e.create()){return f.set(k,
c[0],c[1],c[2])}pointToXYZ(c,k=e.create()){return f.set(k,c.x,c.y,c.z??0)}equals(c,k){return n.equals(c,k)}_tag(c){return c}}a.CoordinateHelper2D=F;a.CoordinateHelper3D=E;a.CoordinateHelper4D=q;a.createCoordinateHelper=function(c,k,m){return c&&k?new q(m):k?new E(t.M,m):c?new E(t.Z,m):new F(m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../core/arrayUtils ../../core/has ../../core/lang ../../core/mathUtils ../../core/screenUtils ../../geometry/projection ../../geometry/support/meshVertexSpaceUtils ../../layers/graphics/hydratedFeatures ../../support/elevationInfoUtils ./editGeometry/EditGeometryOperations".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){function q(w,x){let C=null,h=null;return y=>{if("cancel"===y.action)null!=h&&(h.execute({action:"cancel"}),h=C=null);else{var d={action:y.action,screenStart:y.start,screenEnd:y.screenPoint};"start"===y.action&&null==C&&(C=new D,h=new D,x(w,C,h,y.pointerType,d));null!=C&&C.execute(d);"end"===y.action&&null!=C&&(h=C=null)}}}function c(w){let x=null;return C=>{"start"===C.action&&(x=m(w,C.mapStart.spatialReference));if(null==x)return null;const h=C.mapEnd.x-C.mapStart.x,
y=C.mapEnd.y-C.mapStart.y,d=(C.mapEnd.z??0)-(C.mapStart.z??0);x.move(h,y,d,C.action);return{...C,translationX:h,translationY:y,translationZ:d}}}function k(w,x){return null==w?null:w.spatialReference.equals(x)?w.clone():u.project(w,x)}function m(w,x){const C=w.operations;if(!C)return null;const h=C.data.geometry;x=t.hydratedSpatialReference(x);if(h.spatialReference.equals(x))return l(w,C,()=>{});if("mesh"!==h.type){x=k(h,x);if(null==x)return null;const y=h.spatialReference;x=E.EditGeometryOperations.fromGeometry(x,
C.viewingMode);return l(w,x,()=>{const d=u.project(h,y);C.trySetGeometry(d)})}if(v.isMeshWithRelativeVertexSpace(h)){x=k(h.origin,x);if(!x)return null;const y=h.spatialReference,d=E.EditGeometryOperations.fromGeometry(x,C.viewingMode);return l(w,C,()=>{const B=u.project(d.data.geometry,y);C.move(B.x-h.origin.x,B.y-h.origin.y,(B.z??0)-(h.origin.z??0))})}return null}function l(w,x,C){let h=0,y=0,d=0;return{move:(B,p,A,G)=>{"start"===G&&(d=y=h=0);B-=h;p-=y;A-=d;x.move(B,p,A);h+=B;y+=p;d+=A;C();"end"===
G&&w.endInteraction?.()}}}function r(w){const x=w.operations?.createResetState();return C=>{x?.remove();return C}}function z(w,x,C){const h=x.elevationProvider.getElevation(w.x,w.y,w.z??0,w.spatialReference,"scene")??0;w=t.clonePoint(w);w.z=h;w.hasZ=!0;w.z=F.getZForElevationMode(w,x,C);return w}const H=()=>{};class D{constructor(){this.execute=H}next(w,x=new D){null!=w&&(this.execute=C=>{C=w(C);null!=C&&x.execute(C)});return x}}a.EventPipeline=D;a.addMapDelta=function(){let w=0,x=0,C=0;return h=>
{"start"===h.action&&(w=h.mapStart.x,x=h.mapStart.y,C=h.mapStart.z);const y=h.mapEnd.x-w,d=h.mapEnd.y-x,B=h.mapEnd.z-C;w=h.mapEnd.x;x=h.mapEnd.y;C=h.mapEnd.z;return{...h,mapDeltaX:y,mapDeltaY:d,mapDeltaZ:B,mapDeltaSpatialReference:h.mapStart.spatialReference}}};a.addScreenDelta=function(){let w=0,x=0;return C=>{"start"===C.action&&(w=C.screenStart.x,x=C.screenStart.y);const h=C.screenEnd.x-w,y=C.screenEnd.y-x;w=C.screenEnd.x;x=C.screenEnd.y;return{...C,screenDeltaX:h,screenDeltaY:y}}};a.constrainToMapAxis=
function(w,x){const C=[w.x,w.y,w.z??0],h=[Math.cos(x),Math.sin(x)];w=Math.sqrt(h[0]*h[0]+h[1]*h[1]);if(0===w)return null;h[0]/=w;h[1]/=w;const y=d=>{const B=(d.x-C[0])*h[0]+(d.y-C[1])*h[1];d.x=C[0]+B*h[0];d.y=C[1]+B*h[1]};return d=>{y(d.mapStart);y(d.mapEnd);return{...d,axis:h}}};a.createDragEventPipelineCallback=q;a.createManipulatorDragEventPipeline=function(w,x){return w.events.on("drag",q(w,x))};a.dragAtLocation=function(w,x){let C=null,h=0,y=0;return d=>{"start"===d.action&&(C=w.toScreen?.(x),
null!=C&&(0>C.x||C.x>w.width||0>C.y||C.y>w.height?C=null:(h=d.screenStart.x-C.x,y=d.screenStart.y-C.y)));if(null==C)return null;var B=e.clamp(d.screenEnd.x-h,0,w.width);const p=e.clamp(d.screenEnd.y-y,0,w.height);B=n.createScreenPoint(B,p);d.screenStart=C;d.screenEnd=B;return d}};a.dragManipulatedObject=c;a.dragManipulatedObjectMany=function(w){const x=w.map(C=>c(C)).filter(b.isSome);return C=>{const h=C.mapEnd.x-C.mapStart.x,y=C.mapEnd.y-C.mapStart.y,d=C.mapEnd.z-C.mapStart.z;x.forEach(B=>B(C));
return{...C,translationX:h,translationY:y,translationZ:d}}};a.resetManipulatedObject=r;a.resetManipulatedObjectMany=function(w){const x=w.map(C=>r(C)).filter(C=>null!=C);return C=>{x.forEach(h=>h(C));return C}};a.resetProperties=function(w,x){const C=new Map;for(const h of x)C.set(h,f.clone(w[h]));return h=>{C.forEach((y,d)=>{w[d]=y});return h}};a.sceneSnappingAtLocation=function(w,x,C=[]){if("2d"===w.type)return y=>y;let h=null;return y=>{"start"===y.action&&(h=w.toMap(y.screenStart,{exclude:C}),
null!=h&&(h.z=F.getZForElevationMode(h,w,x)));const d=w.toMap(y.screenEnd,{exclude:C});null!=d&&(d.z=F.getZForElevationMode(d,w,x));return{...y,scenePoints:null!=h&&null!=d?{sceneStart:h,sceneEnd:d}:null}}};a.sceneSnappingAtProjectedLocation=function(w,x){if("2d"===w.type)return h=>h;let C=null;return h=>{"start"===h.action&&(C=z(h.mapStart,w,x));const y=z(h.mapEnd,w,x);return{...h,scenePoints:null!=C&&null!=y?{sceneStart:C,sceneEnd:y}:null}}};a.screenToMap=function(w,x=null,C){let h=null;const y=
null==x||w.spatialReference?.equals(x)?B=>B:B=>null!=B?u.project(B,x):B,d={exclude:[],...C};return B=>{"start"===B.action&&(h=y(w.toMap(B.screenStart,d)));if(null==h)return null;const p=y(w.toMap(B.screenEnd,d));return null!=p?{...B,mapStart:h,mapEnd:p}:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometryOperations":function(){define("exports ../../../core/Evented ../../../core/handleUtils ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/coordsUtils ./EditGeometry ./interfaces ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/CloseComponent ./operations/MoveMesh ./operations/MoveVertex ./operations/OffsetEdgeVertex ./operations/RotateVertex ./operations/ScaleVertex ./operations/SetAllVertexPositions ./operations/UndoGroup".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D){class w extends b{constructor(x,C){super();this.data=x;this.viewingMode=C;this._undoStack=[];this._redoStack=[];this._listener=this.data.on("change",h=>{h.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:h.addedVertices,operation:h.operation});h.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:h.removedVertices,operation:h.operation});h.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:h.updatedVertices,
operation:h.operation})})}destroy(){this._listener.remove()}splitEdge(x,C){return this._apply(new E.SplitEdge(this.data,x,C))}updateVertices(x,C,h=u.AccumulationBehavior.ACCUMULATE_STEPS){return this._apply(new t.UpdateVertices(this.data,x,C),h)}move(x,C,h,y=u.AccumulationBehavior.ACCUMULATE_STEPS){return n.isMeshEditGeometry(this.data)?this._apply(new k.MoveMesh(this.data,x,C,h),y):this.moveVertices(this.data.allVertices,x,C,h,y)}moveVertices(x,C,h,y,d=u.AccumulationBehavior.ACCUMULATE_STEPS){return n.isMeshEditGeometry(this.data)?
this._apply(new k.MoveMesh(this.data,C,h,y),d):this.updateVertices(x,new m.MoveVertex(this.data.coordinateHelper,C,h,y),d)}scale(x,C,h,y,d=u.AccumulationBehavior.ACCUMULATE_STEPS,B=t.AccumulationType.CUMULATIVE){return this.scaleVertices(this.data.allVertices,x,C,h,y,d,B)}scaleVertices(x,C,h,y,d,B=u.AccumulationBehavior.ACCUMULATE_STEPS,p=t.AccumulationType.CUMULATIVE){return this.updateVertices(x,new z.ScaleVertex(C,h,y,d,p),B)}rotate(x,C,h=u.AccumulationBehavior.ACCUMULATE_STEPS,y=t.AccumulationType.CUMULATIVE){return this.rotateVertices(this.data.allVertices,
x,C,h,y)}rotateVertices(x,C,h,y=u.AccumulationBehavior.ACCUMULATE_STEPS,d=t.AccumulationType.CUMULATIVE){return this.updateVertices(x,new r.RotateVertex(C,h,d),y)}removeVertices(x){return this._apply(new F.RemoveVertices(this.data,x,this._minNumVerticesPerType))}appendVertex(x){return 0===this.data.components.length?null:this._apply(new v.AppendVertex(this.data,this.data.components[0],x))}setVertexPosition(x,C){return this._apply(new q.SetVertexPosition(this.data,x,C))}offsetEdge(x,C,h,y=u.AccumulationBehavior.ACCUMULATE_STEPS){return this.updateVertices([C.leftVertex,
C.rightVertex],new l.OffsetEdgeVertex(this.data.coordinateHelper,x,C,h),y)}trySetGeometry(x,C=u.AccumulationBehavior.ACCUMULATE_STEPS){const {data:h}=this,{coordinateHelper:y}=h;if(h.type===x.type&&h.spatialReference.equals(x.spatialReference)&&y.hasZ()===x.hasZ&&y.hasM()===x.hasM&&e.hasCompatibleTopology(h.geometry,x)&&!n.isMeshEditGeometry(h))return x=Array.from(n.EditGeometry.fromGeometry(x,this.viewingMode).iterateVertices(),d=>d.pos),this.setVertexPositions(x,C)}setVertexPositions(x,C=u.AccumulationBehavior.ACCUMULATE_STEPS){return this._apply(new H.SetAllVertexPositions(this.data,
x),C)}createResetState(){if(n.isMeshEditGeometry(this.data))return this._createResetStateMesh();const x=this.data.geometry.clone();return g.makeHandle(()=>this.trySetGeometry(x))}closeComponent(x){return this.data.components.includes(x)?this._apply(new c.CloseComponent(this.data,x)):null}canRemoveVertex(x){return x.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const x=new D.UndoGroup;this._apply(x);return g.makeHandle(()=>x.close())}undo(){if(0<this._undoStack.length){const x=this._undoStack.pop();
x.undo();this._redoStack.push(x);return x}return null}redo(){if(0<this._redoStack.length){const x=this._redoStack.pop();x.apply();this._undoStack.push(x);return x}return null}get canUndo(){return 0<this._undoStack.length}get canRedo(){return 0<this._redoStack.length}get lastOperation(){return 0<this._undoStack.length?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case "point":return 1;case "polyline":return 2;case "polygon":return 3;default:return 0}}_apply(x,
C=u.AccumulationBehavior.ACCUMULATE_STEPS){C!==u.AccumulationBehavior.NEW_STEP&&null!=this.lastOperation&&this.lastOperation.accumulate(x)||(x.apply(),this._undoStack.push(x),this._redoStack=[]);return x}_createResetStateMesh(){if(!n.isMeshEditGeometry(this.data))return g.makeHandle();const x=this.data.geometry,{vertexSpace:C}=x;if(C.origin){const y=f.clone(C.origin);return g.makeHandle(()=>{x.vertexSpace.origin=y})}const h=x.vertexAttributes.clonePositional();return g.makeHandle(()=>{x.vertexAttributes=
h;x.vertexAttributesChanged()})}static fromGeometry(x,C){return new w(n.EditGeometry.fromGeometry(x,C),C)}}a.EditGeometryOperations=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../core/arrayUtils ../../../core/compilerUtils ../../../core/Evented ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper ./unnormalizationHelper".split(" "),function(a,b,g,f,e,n,u,v){function t(k,m,
l){const r=k.coordinateHelper;l=new q(m.spatialReference,l);l.index=0;const z=new F(l);z.index=0;z.pos=r.pointToVector(m);l.vertices.push(z);k.components.push(l)}class F{constructor(k){this.component=k;this.rightEdge=this.leftEdge=null;this.type="vertex";this.index=null}get pos(){return this._pos}set pos(k){this._pos=k;this.component.unnormalizeVertexPositions()}}class E{constructor(k,m,l){this.component=k;this.leftVertex=m;this.rightVertex=l;this.type="edge";m.rightEdge=this;l.leftEdge=this}}class q{constructor(k,
m){this._spatialReference=k;this._viewingMode=m;this.vertices=[];this.edges=[];this.index=null}unnormalizeVertexPositions(){1>=this.vertices.length||v.unnormalize(this.vertices,v.getUnnormalizationInfo(this._spatialReference,this._viewingMode))}updateVertexIndex(k,m){if(0!==this.vertices.length){var l=this.vertices[0],r=null;do r=k,r.index=m++,k=r.rightEdge?r.rightEdge.rightVertex:null;while(null!=k&&k!==l);r.leftEdge&&r!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(r),
this.vertices.length-1)}}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return 2<this.vertices.length&&null!==this.vertices[0].leftEdge}swapVertices(k,m){const l=this.vertices[k];this.vertices[k]=this.vertices[m];this.vertices[m]=l}iterateVertices(k){if(0!==this.vertices.length){var m=this.vertices[0],l=m;do k(l,l.index),l=null!=l.rightEdge?l.rightEdge.rightVertex:null;while(l!==m&&null!=l)}}}class c extends f{constructor(k,m){super();this.type=
k;this.coordinateHelper=m;this._geometry=null;this._dirty=!0;this.components=[]}get geometry(){if(this._dirty){switch(this.type){case "point":this._geometry=this._toPoint();break;case "polyline":this._geometry=this._toPolyline();break;case "polygon":this._geometry=this._toPolygon();break;case "mesh":break;default:g.neverReached(this.type)}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}get allVertices(){return Array.from(this.iterateVertices())}*iterateVertices(){for(const k of this.components)for(const m of k.vertices)yield m}notifyChanges(k){this._dirty=
!0;this.emit("change",k)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const k=[],m=this.coordinateHelper.vectorToArray;for(const l of this.components){if(1>l.vertices.length)continue;const r=[];let z=l.vertices.find(D=>null==D.leftEdge);const H=z;do r.push(m(z.pos)),z=z.rightEdge?z.rightEdge.rightVertex:null;while(z&&z!==H);k.push(r)}return new n({paths:k,spatialReference:this.spatialReference,
hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const k=[],m=this.coordinateHelper.vectorToArray;for(const l of this.components){if(1>l.vertices.length)continue;const r=[],z=l.vertices[0];let H=z;const D=H;do r.push(m(H.pos)),H=null!=H.rightEdge?H.rightEdge.rightVertex:null;while(H&&H!==D);l.isClosed()&&r.push(m(z.pos));k.push(r)}return new e({rings:k,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(k,
m){var l=u.createCoordinateHelper(k.hasZ,k.hasM,k.spatialReference);l=new c(k.type,l);switch(k.type){case "polygon":var r=k.spatialReference,z=l.coordinateHelper;k=k.rings;for(var H=0;H<k.length;++H){var D=k[H],w=new q(r,m);w.index=H;var x=2<D.length&&b.equals(D[0],D[D.length-1]),C=x?D.length-1:D.length;for(var h=0;h<C;++h){var y=z.arrayToVector(D[h]);const d=new F(w);w.vertices.push(d);d.pos=y;d.index=h}D=w.vertices.length-1;for(C=0;C<D;++C)h=new E(w,w.vertices[C],w.vertices[C+1]),w.edges.push(h);
x&&(x=new E(w,w.vertices[w.vertices.length-1],w.vertices[0]),w.edges.push(x));l.components.push(w)}break;case "polyline":r=k.spatialReference;z=l.coordinateHelper;k=k.paths;for(H=0;H<k.length;++H){x=k[H];w=new q(r,m);w.index=H;D=x.length;for(C=0;C<D;++C)h=z.arrayToVector(x[C]),y=new F(w),w.vertices.push(y),y.pos=h,y.index=C;x=w.vertices.length-1;for(D=0;D<x;++D)C=new E(w,w.vertices[D],w.vertices[D+1]),w.edges.push(C);l.components.push(w)}break;case "point":t(l,k,m);break;case "mesh":t(l,k.origin,
m),l._geometry=k,l._dirty=!1}return l}}a.Component=q;a.Edge=E;a.EditGeometry=c;a.Vertex=F;a.isMeshEditGeometry=function(k){return"mesh"===k.type};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/unnormalizationHelper":function(){define(["exports","../../../geometry/support/spatialReferenceUtils","../../ViewingMode"],function(a,b,g){a.getUnnormalizationInfo=function(f,e){f=b.getInfo(f);return e===g.ViewingMode.Global&&f?{supported:!0,lowerBoundX:f.valid[0],
upperBoundX:f.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}};a.unnormalize=function(f,e){if(e.supported){var n=Infinity,u=-Infinity,v=e.upperBoundX-e.lowerBoundX;f.forEach(F=>{let E=F.pos[0];for(;E<e.lowerBoundX;)E+=v;for(;E>e.upperBoundX;)E-=v;n=Math.min(n,E);u=Math.max(u,E);F.pos[0]=E});var t=u-n;v-t<t&&f.forEach(F=>{0>F.pos[0]&&(F.pos[0]+=v)})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/interfaces":function(){define(["exports"],
function(a){a.AccumulationBehavior=void 0;var b=a.AccumulationBehavior||(a.AccumulationBehavior={});b[b.NEW_STEP=0]="NEW_STEP";b[b.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports","../EditGeometry"],function(a,b){class g{constructor(f,e,n){this._editGeometry=f;this._component=e;this._pos=n;this._right=this._left=this._originalEdge=this._addedVertex=null}apply(){let f=
"redo";null==this._addedVertex&&(f="apply",this._addedVertex=new b.Vertex(this._component));const e=this._component.getLastVertex();if(null==e)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let n=null;e.rightEdge&&(this._originalEdge=e.rightEdge,n=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1));this._component.vertices.push(this._addedVertex);this._addedVertex.pos=this._pos;
null==this._left&&(this._left=new b.Edge(this._component,e,this._addedVertex));this._component.edges.push(this._left);e.rightEdge=this._left;null!=this._originalEdge&&null!=n&&(null==this._right&&(this._right=new b.Edge(this._component,this._addedVertex,n)),this._component.edges.push(this._right),n.leftEdge=this._right);this._component.updateVertexIndex(this._addedVertex,e.index+1)}this._editGeometry.notifyChanges({operation:f,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),
1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,
this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}a.AppendVertex=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],function(a){class b{constructor(g,f,e){this._editGeometry=g;this._vertices=f;this.operation=e;this._undone=!1}apply(){this._vertices.forEach(g=>
this.operation.apply(g));this._editGeometry.components.forEach(g=>g.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(g=>this.operation.undo(g));this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices});this._undone=!0}canAccumulate(g){if(this._undone||g._vertices.length!==this._vertices.length)return!1;for(let f=0;f<g._vertices.length;++f)if(g._vertices[f]!==
this._vertices[f])return!1;return this.operation.canAccumulate(g.operation)}accumulate(g){return g instanceof b&&this.canAccumulate(g)?(this._vertices.forEach(f=>this.operation.accumulate(f,g.operation)),this.operation.accumulateParams(g.operation),this._editGeometry.components.forEach(f=>f.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0):!1}}a.AccumulationType=void 0;(function(g){g[g.CUMULATIVE=0]="CUMULATIVE";g[g.REPLACE=1]="REPLACE"})(a.AccumulationType||
(a.AccumulationType={}));a.UpdateVertices=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../EditGeometry"],function(a,b){class g{constructor(f,e,n=0){this._editGeometry=f;this._vertices=e;this._minNumberOfVertices=n;this.removedVertices=null}apply(){let f="redo";if(null==this.removedVertices){const e=this.removedVertices=[];this._vertices.forEach(n=>{n=this._removeVertex(n);null!=n&&e.push(n)});
f="apply"}else this.removedVertices.forEach(e=>{this._removeVertex(e.removedVertex)});this._editGeometry.notifyChanges({operation:f,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(f=>{this._undoRemoveVertex(f)});this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(f){const e=f.component;if(e.vertices.length<=this._minNumberOfVertices)return null;const n={removedVertex:f,createdEdge:null},u=f.leftEdge,v=f.rightEdge;
e.vertices.splice(e.vertices.indexOf(f),1);u&&(e.edges.splice(e.edges.indexOf(u),1),u.leftVertex.rightEdge=null);v&&(e.edges.splice(e.edges.indexOf(v),1),v.rightVertex.leftEdge=null);0===f.index&&v&&0<this._vertices.length&&e.swapVertices(e.vertices.indexOf(v.rightVertex),0);u&&v&&(n.createdEdge=new b.Edge(e,u.leftVertex,v.rightVertex),e.edges.push(n.createdEdge));v&&e.updateVertexIndex(v.rightVertex,v.rightVertex.index-1);return n}_undoRemoveVertex(f){const e=f.removedVertex,n=f.removedVertex.component,
u=e.leftEdge,v=e.rightEdge;f.createdEdge&&n.edges.splice(n.edges.indexOf(f.createdEdge),1);n.vertices.push(e);u&&(n.edges.push(u),u.leftVertex.rightEdge=u);v&&(n.edges.push(v),v.rightVertex.leftEdge=v);n.updateVertexIndex(e,e.index)}}a.RemoveVertices=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports","../EditGeometry"],function(a,b){class g{constructor(f,e,n){this._editGeometry=f;this._edge=e;this._t=
n;this._right=this._left=this.createdVertex=null}apply(){let f="redo";const e=this._edge,n=e.component,u=e.leftVertex,v=e.rightVertex;n.edges.splice(n.edges.indexOf(e),1);null==this.createdVertex&&(f="apply",this.createdVertex=new b.Vertex(e.component));n.vertices.push(this.createdVertex);this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(e.leftVertex.pos,e.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector());null==this._left&&(this._left=new b.Edge(n,u,this.createdVertex));
this._left.leftVertex.leftEdge?n.edges.push(this._left):n.edges.unshift(this._left);u.rightEdge=this._left;null==this._right&&(this._right=new b.Edge(n,this.createdVertex,v));n.edges.push(this._right);v.leftEdge=this._right;n.updateVertexIndex(this.createdVertex,u.index+1);this._editGeometry.notifyChanges({operation:f,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const f=this._edge,e=f.component,n=this.createdVertex.leftEdge?.leftVertex,
u=this.createdVertex.rightEdge?.rightVertex;e.vertices.splice(e.vertices.indexOf(this.createdVertex),1);e.edges.splice(e.edges.indexOf(this._left),1);e.edges.splice(e.edges.indexOf(this._right),1);this._edge.leftVertex.leftEdge?e.edges.push(this._edge):e.edges.unshift(this._edge);n&&(n.rightEdge=f);u&&(u.leftEdge=f);n&&e.updateVertexIndex(n,n.index);this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}a.SplitEdge=g;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports"],function(a){class b{constructor(g,f,e){this._editGeometry=g;this._vertex=f;this._pos=e}apply(){const g=null==this._originalPosition;g&&(this._originalPosition=this._vertex.pos);this._apply(g?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition;this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(g){return g instanceof
b&&g._vertex===this._vertex?(this._pos=g._pos,this._apply("apply"),!0):!1}_apply(g){this._vertex.pos=this._pos;this._editGeometry.components.forEach(f=>f.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:g,updatedVertices:[this._vertex]})}}a.SetVertexPosition=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/CloseComponent":function(){define(["exports","../../../../core/arrayUtils","../EditGeometry"],function(a,
b,g){class f{constructor(e,n){this._editGeometry=e;this._component=n;this._createdEdge=null}apply(){let e="redo";if(null==this._createdEdge){e="apply";const n=this._component.getFirstVertex(),u=this._component.getLastVertex();if(this._component.isClosed()||3>this._component.vertices.length||null==n||null==u)return;this._createdEdge=new g.Edge(this._component,u,n)}this._createdEdge.leftVertex.rightEdge=this._createdEdge;this._createdEdge.rightVertex.leftEdge=this._createdEdge;this._component.edges.push(this._createdEdge);
this._editGeometry.notifyChanges({operation:e})}undo(){null!=this._createdEdge&&(b.remove(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}a.CloseComponent=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveMesh":function(){define(["exports"],function(a){class b{constructor(g,
f,e,n){this._editGeometry=g;this.dx=f;this.dy=e;this.dz=n;this._firstTime=!0}apply(){const g=this._firstTime?"apply":"redo";this._firstTime=!1;this._apply(g,this.dx,this.dy,this.dz)}undo(){this._apply("undo",-this.dx,-this.dy,-this.dz)}accumulate(g){const f=this._editGeometry.geometry;return g instanceof b&&g._editGeometry.geometry===f?(this._apply("apply",g.dx,g.dy,g.dz),this.dx+=g.dx,this.dy+=g.dy,this.dz+=g.dz,!0):!1}_apply(g,f,e,n){const u=this._editGeometry.geometry;u.offset(f,e,n);if(f=this._editGeometry.components[0].getFirstVertex())f.pos=
this._editGeometry.coordinateHelper.pointToVector(u.origin),this._editGeometry.notifyChanges({operation:g,updatedVertices:[f]})}}a.MoveMesh=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports"],function(a){class b{constructor(g,f,e,n){this._helper=g;this.dx=f;this.dy=e;this.dz=n}_move(g,f,e,n){this._helper.addDelta(g.pos,f,e,n)}apply(g){this._move(g,this.dx,this.dy,this.dz)}undo(g){this._move(g,-this.dx,
-this.dy,-this.dz)}canAccumulate(g){return g instanceof b}accumulate(g,f){this._move(g,f.dx,f.dy,f.dz)}accumulateParams(g){this.dx+=g.dx;this.dy+=g.dy;this.dz+=g.dz}}a.MoveVertex=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/OffsetEdgeVertex":function(){define("exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/vector ../../../support/geometry2dUtils".split(" "),
function(a,b,g,f,e,n,u,v,t){class F{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(c,k,m,l=0,r=q.IMMEDIATE){this._helper=c;this._planeType=k;this._edge=m;this.distance=l;this._plane=u.create();this._offsetPlane=u.create();this._minDistance=-Infinity;this._maxDistance=Infinity;this._selectedArrow=1;r===q.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors();
this._initializePlane();this._initializeDistanceConstraints()}_initializeNeighbors(){const c=this._toXYZ(this._edge.leftVertex.pos),k=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),m=this._toXYZ(this._edge.rightVertex.pos),l=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=e.direction(n.create(),c,m);k?(this._left=this._computeNeighbor(c,k,this._edgeDirection),this._right=this._computeNeighbor(m,l,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(m,
l,this._edgeDirection),this._left=this._computeNeighbor(c,k,this._edgeDirection,this._right))}_toXYZ(c){return null!=c?this._helper.toXYZ(c):null}_pointToXYZ(c){return this._toXYZ(this._helper.pointToVector(c))}_computeNeighbor(c,k,m,l){const r=n.create();if(k)return e.direction(r,c,k),l=!this._passesBisectingAngleThreshold(r,m),{start:c,end:k,direction:l?this._bisectVectorsPerpendicular(m,r):r,isOriginalDirection:!l};this._helper.hasZ()?l&&(e.cross(r,m,l.direction),e.cross(r,r,m),e.normalize(r,r),
Math.sign(r[1])!==Math.sign(m[0])&&e.scale(r,r,-1)):e.set(r,-m[1],m[0],0);return{start:c,end:k,direction:r,isOriginalDirection:!0}}_passesBisectingAngleThreshold(c,k){c=Math.abs(v.angle(k,c));return c>=E&&c<=Math.PI-E}_bisectVectorsPerpendicular(c,k){c=0>e.dot(c,k)?c:e.negate(n.create(),c);const m=Math.abs(e.dot(c,k));if(!(.001>m||.999<m))return this._bisectDirection(c,k);k=e.cross(n.create(),c,[0,0,1]);return e.normalize(k,k)}_bisectDirection(c,k){c=e.add(n.create(),c,k);return e.normalize(c,c)}_initializePlane(){const c=
this._computeNormalDirection(this._left),k=this._computeNormalDirection(this._right);0>e.dot(c,k)&&e.negate(k,k);u.fromPositionAndNormal(this._left.start,this._bisectDirection(c,k),this._plane)}_computeNormalDirection(c){c=e.cross(n.create(),c.direction,this._edgeDirection);e.normalize(c,c);c=e.cross(n.create(),this._edgeDirection,c);this._planeType===a.PlaneType.XY&&(c[2]=0);return e.normalize(c,c)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint(u.signedDistance(this._plane,
this._left.end));null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint(u.signedDistance(this._plane,this._right.end));this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(c){0>=c&&(this._minDistance=Math.max(this._minDistance,c));0<=c&&(this._maxDistance=Math.min(this._maxDistance,c))}_updateIntersectDistanceConstraint(c){var k=u.getNormal(c);const m=this._edgeDirection;var l=e.add(n.create(),this._left.start,this._left.direction);const r=e.add(n.create(),
this._right.start,this._right.direction);var z=this._pointInBasis2D(f.create(),k,m,this._left.start),H=this._pointInBasis2D(f.create(),k,m,l),D=this._pointInBasis2D(f.create(),k,m,this._right.start);k=this._pointInBasis2D(f.create(),k,m,r);[D]=t.intersectLineAndRay({start:H,end:z,type:t.LineType.LINE},{start:k,end:D,type:t.LineType.LINE});D&&(z=g.subtract(f.create(),z,H),g.normalize(z,z),H=g.subtract(f.create(),D,H),H=g.dot(z,H),l=e.add(n.create(),l,e.scale(n.create(),this._left.direction,-H)),c=
u.signedDistance(c,l),this._updateDistanceConstraint(c))}_pointInBasis2D(c,k,m,l){c[0]=v.projectPointSignedLength(k,l);c[1]=v.projectPointSignedLength(m,l);return c}_offset(c,k){Number.isFinite(this._minDistance)&&(k=Math.max(this._minDistance,k));Number.isFinite(this._maxDistance)&&(k=Math.min(this._maxDistance,k));u.copy(this._offsetPlane,this._plane);this._offsetPlane[3]-=k;k=(l,r,z)=>null!=r&&u.intersectLine(this._offsetPlane,l,e.add(n.create(),l,r),z);const m=n.create();(c===this._edge.leftVertex?
k(this._left.start,this._left.direction,m):k(this._right.start,this._right.direction,m))&&this._helper.copy(this._helper.fromXYZ(m,void 0,this._helper.getM(c.pos)),c.pos)}selectArrowFromStartPoint(c){this._selectedArrow=u.isPointInside(this.plane,this._pointToXYZ(c))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(c){return u.signedDistance(this.plane,this._pointToXYZ(c))}clampedStartAndEnd(c){c=this._helper.toXYZ(this._helper.pointToVector(c));const k=u.projectPoint(this._plane,
c,n.create()),m=u.signedDistance(this._plane,c),l=b.clamp(m,this._minDistance,this._maxDistance);e.lerp(c,k,c,l/m);return{start:k,end:c}}apply(c){this._offset(c,this.distance)}undo(c){this._offset(c,0)}canAccumulate(c){return c instanceof F&&this._edge.leftVertex.index===c._edge.leftVertex.index&&this._edge.rightVertex.index===c._edge.rightVertex.index&&this._edge.component===c._edge.component&&this._maybeEqualsVec3(this._left.direction,c._left.direction)&&this._maybeEqualsVec3(this._right.direction,
c._right.direction)&&e.equals(u.getNormal(this._plane),u.getNormal(c._plane))}accumulate(c,k){this._offset(c,this._plane[3]-k._plane[3]+k.distance)}accumulateParams(c){this.distance=c.distance-c._plane[3]+this._plane[3]}clone(){const c=new F(this._helper,this._planeType,this._edge,this.distance,q.DEFERRED);u.copy(c._plane,this._plane);u.copy(c._offsetPlane,this._offsetPlane);c._maxDistance=this._maxDistance;c._minDistance=this._minDistance;c._left=this._cloneNeighbor(this._left);c._right=this._cloneNeighbor(this._right);
c._edgeDirection=e.copy(n.create(),this._edgeDirection);return c}_maybeEqualsVec3(c,k){return null==c&&null==k||null!=c&&null!=k&&e.equals(c,k)}_cloneNeighbor({start:c,end:k,direction:m,isOriginalDirection:l}){return{start:e.copy(n.create(),c),end:null!=k?e.copy(n.create(),k):null,direction:e.copy(n.create(),m),isOriginalDirection:l}}}const E=b.deg2rad(15);a.PlaneType=void 0;(function(c){c[c.XYZ=0]="XYZ";c[c.XY=1]="XY"})(a.PlaneType||(a.PlaneType={}));var q;(function(c){c[c.IMMEDIATE=0]="IMMEDIATE";
c[c.DEFERRED=1]="DEFERRED"})(q||={});a.OffsetEdgeVertex=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../core/arrayUtils","../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,g,f){class e{constructor(n,u,v=f.AccumulationType.CUMULATIVE){this.origin=n;this.angle=u;this._accumulationType=v}_rotate(n,u){g.rotate(n.pos,n.pos,this.origin,u)}apply(n){this._rotate(n,
this.angle)}undo(n){this._rotate(n,-this.angle)}canAccumulate(n){return n instanceof e&&b.equals(this.origin,n.origin)}accumulate(n,u){this._rotate(n,u._accumulationType===f.AccumulationType.REPLACE?u.angle-this.angle:u.angle)}accumulateParams(n){this.angle=n._accumulationType===f.AccumulationType.REPLACE?n.angle:this.angle+n.angle}}a.RotateVertex=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define(["exports",
"../../../../core/arrayUtils","../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,g,f,e){class n{constructor(u,v,t,F,E=e.AccumulationType.CUMULATIVE){this.origin=u;this.axis1=v;this.factor1=t;this.factor2=F;this._accumulationType=E;this.axis2=g.fromValues(v[1],-v[0])}_scale(u,v,t){f.projectAndScale(u.pos,u.pos,this.origin,this.axis1,v);f.projectAndScale(u.pos,u.pos,this.origin,this.axis2,t)}apply(u){this._scale(u,this.factor1,
this.factor2)}undo(u){this._scale(u,1/this.factor1,1/this.factor2)}canAccumulate(u){return u instanceof n&&b.equals(this.origin,u.origin)&&b.equals(this.axis1,u.axis1)}accumulate(u,v){v._accumulationType===e.AccumulationType.REPLACE?this._scale(u,v.factor1/this.factor1,v.factor2/this.factor2):this._scale(u,v.factor1,v.factor2)}accumulateParams(u){const v=u._accumulationType===e.AccumulationType.REPLACE;this.factor1=v?u.factor1:this.factor1*u.factor1;this.factor2=v?u.factor2:this.factor2*u.factor2}}
a.ScaleVertex=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetAllVertexPositions":function(){define(["exports"],function(a){class b{constructor(g,f){this._editGeometry=g;this._newPositions=f}apply(){const g=null==this._originalPositions?"apply":"redo";if(!this._originalPositions){const f=this._editGeometry.coordinateHelper;this._originalPositions=this._editGeometry.allVertices.map(e=>f.clone(e.pos))}this._apply(g,this._newPositions)}undo(){this._originalPositions&&
this._apply("undo",this._originalPositions)}accumulate(g){return g instanceof b?(this._newPositions=g._newPositions,this._apply("apply",this._newPositions),!0):!1}_apply(g,f){const e=this._editGeometry.coordinateHelper,n=this._editGeometry.allVertices;for(let u=0;u<n.length;u++)e.copy(f[u],n[u].pos);this._editGeometry.components.forEach(u=>u.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:g,updatedVertices:n})}}a.SetAllVertexPositions=b;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UndoGroup":function(){define(["exports"],function(a){const b=Symbol();class g{constructor(e){this._operations=[];this._closed=!1;this[f]=!0;e&&(this._operations=e,this._closed=!0)}close(){this._closed=!0}apply(){for(const e of this._operations)e.apply()}undo(){for(let e=this._operations.length-1;0<=e;e--)this._operations[e].undo()}accumulate(e){if(this._closed)return!1;const n=this._operations.length?this._operations[this._operations.length-
1]:null;n&&n.accumulate(e)||(this._operations.push(e),e.apply());return!0}}var f=b;a.UndoGroup=g;a.isUndoGroup=function(e){return b in e};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingContext":function(){define(["exports"],function(a){class b{constructor(g){this.drawConstraints=this.selfSnappingZ=this.visualizer=this.excludeFeature=this.vertexHandle=null;this.editGeometryOperations=g.editGeometryOperations;this.elevationInfo=g.elevationInfo;
this.pointer=g.pointer;this.vertexHandle=g.vertexHandle;this.excludeFeature=g.excludeFeature;this.feature=g.feature;this.visualizer=g.visualizer;this.selfSnappingZ=g.selfSnappingZ;this.drawConstraints=g.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}a.SnappingContext=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDragPipelineStep":function(){define("exports ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../layers/graphics/dehydratedFeatureComparison ../../../layers/graphics/hydratedFeatures ../../../support/elevationInfoUtils ../dragEventPipeline ./SnappingContext ../../support/Scheduler".split(" "),
function(a,b,g,f,e,n,u,v,t,F){function E(H,D,w){return g.debounce(async({frameTask:x,point:C,scenePoint:h,context:y,event:d,delta:B,getLastState:p},A)=>{const G=await x.schedule(()=>H.snap({point:C,scenePoint:h,context:y,signal:A}),A);G.valid&&(x=await x.schedule(()=>G.apply(),A),p=p(),null!=p.point&&C!==p.point&&(x=H.update({point:p.point,scenePoint:p.scenePoint,context:y})),null!=p.updatePoint&&e.pointEquals(x,p.updatePoint)||(l(d.mapEnd,x,B,D),w.execute(d)))})}function q(H){return"3d"===H.type?
H.resourceController.scheduler.registerTask(F.TaskPriority.SNAPPING):F.ImmediateTask}function c(H,D,w){return{context:new t.SnappingContext({editGeometryOperations:H.editGeometryOperations,elevationInfo:H.elevationInfo,pointer:H.pointer,vertexHandle:null!=D.info?D.info.handle:null,excludeFeature:H.excludeFeature,feature:H.feature,visualizer:H.visualizer}),originalPos:null!=D.snapOrigin?H.coordinateHelper.vectorToDehydratedPoint(D.snapOrigin):D.mapStart,originalScenePos:null!=D.scenePoints?D.scenePoints.sceneStart:
null,frameTask:w}}function k(H,[D,w,x]){H=n.clonePoint(H);H.x+=D;H.y+=w;H.hasZ&&(H.z+=x);return H}function m(H,D){return[H.x-D.x,H.y-D.y,H.hasZ&&D.hasZ?H.z-D.z:0]}function l(H,D,[w,x,C],h){H.x=D.x+w;H.y=D.y+x;h&&H.hasZ&&D.hasZ&&(H.z=D.z+C)}function r(H,D){if(!H.hasZ())return null;var w=D.vertices;D=null;for(const x of w){w=H.getZ(x.pos);if(null!=D&&null!=w&&1E-6<Math.abs(w-D))return null;null==D&&(D=w)}return D}function z(H){return H}a.createSnapDragEventPipelineStep=function({predicate:H=()=>!0,
snappingManager:D,snappingContext:w,updatingHandles:x,useZ:C=!0}){const h=new v.EventPipeline;if(null==D)return{snappingStep:[z,h],cancelSnapping:z};let y=null,d=null,B,p=null;const A=()=>{y=b.abortMaybe(y);D.doneSnapping();d?.frameTask.remove();d=null;B=b.removeMaybe(B);p=null},G=E(D,C,h);let I=null,J=null,L=null;return{snappingStep:[M=>{if(!H(M))return M;const {action:N}=M;if("start"===N){var {info:K}=M;const U=q(D.view);d=c(w,M,U);d.context.selfSnappingZ=null;C||null==K||(K=r(w.coordinateHelper,
K.handle.component),null!=K&&(d.context.selfSnappingZ={value:K,elevationInfo:w.elevationInfo??u.absoluteHeightElevationInfo}))}if(null!=d){const {context:U,originalScenePos:V,originalPos:ea}=d,{mapEnd:Y,mapStart:ra,scenePoints:R}=M,T=k(ea,m(Y,ra)),aa=m(ra,ea),ba={...M,action:"update"},ca=d.context;var O=null==V||null==R?null:k(V,m(R.sceneEnd,R.sceneStart));L=K=D.update({point:T,scenePoint:O,context:U});l(Y,K,aa,C);I=T;J=O;if("end"!==N){const {frameTask:la}=d;null==y&&(y=new AbortController);p=sa=>
{x.addPromise(g.ignoreAbortErrors(G({frameTask:la,event:ba,context:ca,point:T,scenePoint:O,delta:aa,getLastState:()=>({point:I,scenePoint:J,updatePoint:sa.forceUpdate?null:L})},y.signal)))};p({forceUpdate:!1});null==B&&(B=f.watch(()=>D.options.effectiveEnabled,()=>p?.({forceUpdate:!0})))}}"end"===N&&A();return M},h],cancelSnapping:M=>{A();return M}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOperation":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.SnappingOperation=class extends g{constructor(q){super(q);this.constrainResult=c=>c;this._stagedPoint=this._abortController=this._frameTask=this._snapPoints=null;this._snap=e.debounce(async(c,k,m,l)=>{const r=this._frameTask;if(null!=r){var z=await r.schedule(()=>k.snap({...c,context:m,signal:l}),l);z.valid&&await r.schedule(()=>{this.stagedPoint=z.apply();c!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=k.update({...this._snapPoints,context:m}))},
l)}})}get stagedPoint(){return this._stagedPoint}set stagedPoint(q){this._stagedPoint=this.constrainResult(q)}initialize(){const q="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=q?q.registerTask(E.TaskPriority.SNAPPING):E.ImmediateTask}destroy(){this._abortController=f.abortMaybe(this._abortController);this._frameTask=f.removeMaybe(this._frameTask)}update(q,c,k){this._snapPoints=q;const {point:m,scenePoint:l}=q;return this.stagedPoint=q=c.update({point:m,
scenePoint:l,context:k})}async snap(q,c,k){const {point:m,scenePoint:l}=q;this.stagedPoint=c.update({point:m,scenePoint:l,context:k});this._snapPoints=q;null==this._abortController&&(this._abortController=new AbortController);return this._snap(q,c,k,this._abortController.signal)}async snapAgainNearPreviousMapPoint(q,c){null!=this._snapPoints&&await this.snap(this._snapPoints,q,c)}abort(){this._abortController=f.abortMaybe(this._abortController);this._snapPoints=null}};b.__decorate([n.property({constructOnly:!0})],
a.SnappingOperation.prototype,"view",void 0);b.__decorate([n.property()],a.SnappingOperation.prototype,"stagedPoint",null);b.__decorate([n.property()],a.SnappingOperation.prototype,"constrainResult",void 0);b.__decorate([n.property()],a.SnappingOperation.prototype,"_stagedPoint",void 0);a.SnappingOperation=b.__decorate([F.subclass("esri.views.interactive.snapping.SnappingOperation")],a.SnappingOperation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/drawSurfaces":function(){define("exports ../../geometry ../../core/screenUtils ../../layers/graphics/dehydratedPoint ../../layers/graphics/hydratedFeatures ../../support/elevationInfoUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v){class t{constructor(c,k,m,l=null){this._elevationInfo=c;this.defaultZ=k;this._view=m;this._excludeGraphics=l}screenToMap(c){const {defaultZ:k,_view:m}=this;c=m.sceneIntersectionHelper.intersectElevationFromScreen(g.createScreenPointArray(c.x,c.y),this._elevationInfo,k??0,this._excludeGraphics);null==k&&null!=c&&(c.z=void 0);return c}mapToScreen(c){c=f.makeDehydratedPoint(c.x,c.y,n.getConvertedElevation(this._view,c,this._elevationInfo),c.spatialReference);return this._view.toScreen(c)}constrainZ(c){const {defaultZ:k}=
this;null!=k&&c.z!==k&&(c=e.clonePoint(c),c.z=k);return c}}class F{constructor(c,k,m=[]){this.view=c;this.elevationInfo=k;this.exclude=m}screenToMap(c){c=this.view.toMap(c,{exclude:this.exclude,excludeLabels:!0});null!=c&&(c.z=n.getZForElevationMode(c,this.view,this.elevationInfo));return c}mapToScreen(c){let k=c;null!=this.elevationInfo&&(k=f.makeDehydratedPoint(c.x,c.y,n.getConvertedElevation(this.view,c,this.elevationInfo),c.spatialReference));return this.view.toScreen(k)}constrainZ(c){return c}}
class E{constructor(c,k=!1,m=0){this.view=c;this.hasZ=k;this.defaultZ=m;this.mapToScreen=l=>c.toScreen(l);this.screenToMap=k?l=>{l=c.toMap(l);l.z=m;return l}:l=>c.toMap(l)}constrainZ(c){const {defaultZ:k}=this;this.hasZ&&c.z!==k&&(c=e.clonePoint(c),c.z=k);return c}}class q{screenToMap(c){const {x:k,y:m}=c;return new v({x:k,y:m,spatialReference:q.spatialReference})}mapToScreen(c){return g.createScreenPoint(c.x,c.y)}constrainZ(c){return c}}q.spatialReference=new u;a.ElevationDrawSurface=t;a.MapDrawSurface=
E;a.SceneDrawSurface=F;a.ScreenDrawSurface=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/move/MoveTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/arrayUtils ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../SnappingVisualizer3D ../geometryUtils ../isSupportedObjectUtils ../manipulatedObjectUtils ../manipulatorUtils ../meshFastUpdateUtils ../tooltipUtils3D ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYObjectManipulation ./isSupportedObject ../../visualElements/OutlineVisualElement ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/tooltipCommonUtils ../../../../interactive/tooltip/infos/MovePointTooltipInfo ../../../../interactive/tooltip/infos/TranslateTooltipInfo ../../../../interactive/tooltip/infos/TranslateXYTooltipInfo ../../../../interactive/tooltip/infos/TranslateZTooltipInfo ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L,M,N,K,O,U,V,ea,Y,ra,R){function T(ha,ka,W){if(null==ka||"end"===ka.action)ha.distance=v.zeroMeters;else{var {mapStart:fa,mapEnd:oa}=ka;ka=W(fa,oa);ha.distance=null!=ka?ka:v.zeroMeters}}class aa{constructor(ha){this.objects=ha;this.type="move-start"}}class ba{constructor(ha,ka,W){this.dx=ha;this.dy=ka;this.objects=W;this.type="move"}}class ca{constructor(ha){this.objects=ha;this.type="move-stop"}}const la=Symbol("manipulators"),
sa=Symbol("tooltips");a.MoveTool3D=class extends J.InteractiveToolBase{constructor(ha){super(ha);this._infos=new Map;this.events=new e;this.objects=new f;this.enableZ=!0;this.sketchOptions=new M;this.type="move-3d";this._translateZTooltipInfo=this._translateXYTooltipInfo=this._translateTooltipInfo=this._latestTooltipInfo=null;this._updatingHandles=new k.UpdatingHandles;this._moveManipulation=null}initialize(){const {view:ha}=this;this.tooltip=O.makeTooltip(()=>({view:ha,options:this.sketchOptions.tooltips}));
this.addHandles([this.objects.on("change",W=>{W.removed.forEach(fa=>this.removeHandles(fa));this._updateObjectInfos(W);this._setupFastTransformUpdates(W.added);this._refreshManipulators()}),this.objects.on("change",()=>this._connectTooltips())]);const ka=this.objects.toArray();this._updateObjectInfos({added:ka,removed:[]});this._setupFastTransformUpdates(ka);this._refreshManipulators();this._connectTooltips();this.finishToolCreation()}destroy(){this.tooltip=u.destroyMaybe(this.tooltip);this._moveManipulation=
u.destroyMaybe(this._moveManipulation);this._set("view",null);this._updatingHandles.destroy()}onInputEvent(ha){if(!this.destroyed&&!O.enterInputModeIfAvailable(ha,this.tooltip))return super.onInputEvent(ha)}get updating(){return this._updatingHandles.updating}get _shouldShowMovePointTooltip(){var {objects:ha}=this;if(1!==ha.length)return!1;ha=D.manipulatedObjectGeometry(ha.at(0))?.type;return"point"===ha||"mesh"===ha}get activeTooltipInfo(){return this._shouldShowMovePointTooltip?this._movePointTooltipInfo:
this._latestTooltipInfo}reset(){}_updateObjectInfos({added:ha,removed:ka}){for(const W of ha)A.isSupportedObject(W)===H.SupportedObjectResult.SUPPORTED&&(ha=new ua(W),this._infos.set(W,ha));for(const W of ka)this._infos.delete(W)}_setupFastTransformUpdates(ha){for(const ka of ha)ha=this._infos.get(ka),this.addHandles(x.meshTransformFastUpdateHandles(ha.object),ka)}_refreshManipulators(){this.removeHandles(la);this._moveManipulation=u.destroyMaybe(this._moveManipulation);this.manipulators.removeAll();
if(0!==this._infos.size){var ha=Array.from(this._infos.values());this._createManipulators(ha);this._createVisualElements(ha);this._updateMoveManipulation(ha)}}_createManipulators(ha){for(const ka of ha){const W=ka.object;ka.manipulationXY=new p.MoveXYObjectManipulation({tool:this,view:this.view,object:W});ka.manipulationXY.forEachManipulator(fa=>{this.addHandles([fa.events.on("immediate-click",oa=>{this.events.emit("immediate-click",{...oa,object:W});oa.stopPropagation()}),fa.events.on("grab-changed",
({action:oa})=>{"start"===oa?this._showTooltip(d.ManipulationType.XY):this._hideTooltip()})],la)});this.addHandles(ka.manipulationXY.createDragPipeline((fa,oa,ta,pa)=>this._buildDragEventPipeline(ha,d.ManipulationType.XY,fa,oa,ta,pa)),la)}this._createMoveManipulation(ha)}_createMoveManipulation(ha){const ka=new d.MoveManipulation({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===ha.length?d.MoveManipulation.radiusForSymbol(ha[0].object.graphic?.symbol):
y.discRadius});this._moveManipulation=ka;ka.elevationInfo={mode:"absolute-height",offset:0};ka.forEachManipulator(ta=>{this.addHandles(ta.events.on("immediate-click",pa=>{const ma=this.objects.at(0);!ka.zManipulation.hasManipulator(ta)&&1===this.objects.length&&ma&&this.events.emit("immediate-click",{...pa,object:ma});pa.stopPropagation()}),la)});var W=ta=>pa=>{this.addHandles([pa.events.on("focus-changed",({action:ma})=>{"focus"===ma?this._showTooltip(ta):this._hideTooltip()}),pa.events.on("grab-changed",
()=>{this._latestTooltipInfo&&(this._latestTooltipInfo.distance=v.zeroMeters)})],la)};this._moveManipulation.xyManipulation.forEachManipulator(W(d.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(W(d.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(W(d.ManipulationType.Z));W=()=>this._updateMoveManipulation(ha);for(const ta of ha)this.addHandles([ta.object.on("committed",W),t.watch(()=>ta.object.visible,W)],la);const fa=ha[ha.length-
1];this.addHandles(fa.object.on("committed",()=>this._updateMoveManipulationAngle(fa)),la);({object:W}=fa);const {operations:oa}=W;oa&&this.addHandles(ka.createDragPipeline((ta,pa,ma,xa,P)=>this._buildDragEventPipeline(ha,ta,pa,ma,xa,P),W.elevationInfo,oa.data.spatialReference,W.graphic),la);this._updateMoveManipulationAngle(fa)}_createVisualElements(ha){for(const ka of ha){const W=h.createVisualElements({view:this.view,object:ka.object,forEachManipulator:fa=>{ka.manipulationXY?.forEachManipulator(fa);
this._moveManipulation?.forEachManipulator(fa)},onManipulatorsChanged:()=>n.makeHandle()});null!=W&&(ka.geometryRepresentation=W.visualElement,ka.geometryRepresentation instanceof G.OutlineVisualElement&&this.addHandles([ka.geometryRepresentation.events.on("attachment-origin-changed",()=>{ka.object.isDraped||this._updateMoveManipulation(ha)}),t.watch(()=>ka.object.isDraped,()=>this._updateMoveManipulation(ha))],la),this.addHandles(W,la))}}_updateMoveManipulationAngle(ha){this._moveManipulation&&(this._moveManipulation.angle=
z.orientation(D.manipulatedObjectGeometry(ha.object)))}_updateMoveManipulation(ha){const ka=m.makeDehydratedPoint(0,0,0,this.view.spatialReference);let W=0,fa=!1;const oa=this._moveManipulation;if(oa){for(const ta of ha)if(ta.object.visible&&(this.enableZ&&w.canMoveZOperations(ta.object.operations,ta.object.elevationInfo)&&(fa=!0),ha=ta.geometryRepresentation instanceof G.OutlineVisualElement&&!ta.object.isDraped?ta.geometryRepresentation.attachmentOrigin:ta.object.origin,null!=ha)){const {x:pa,y:ma,
z:xa}=ha;ka.x+=pa;ka.y+=ma;if(xa){let P;(P=ka).z??(P.z=0);ka.z+=xa}W++}0<W?(ka.x/=W,ka.y/=W,ka.z??(ka.z=0),ka.z/=W,oa.location=ka,oa.xyManipulation.available=!0,oa.xyAxisManipulation.available=!0,oa.zManipulation.available=fa):oa.available=!1}}_buildDragEventPipeline(ha,ka,W,fa,oa,ta){const pa=[],ma=[];let xa=null,P=null;const X=()=>{for(const Z of pa)Z.dragging=!1;pa.length=0;ma.length=0;P=xa=null;this._moveManipulation&&(this._moveManipulation.interactive=!0)};if(1===ha.length&&ka===d.ManipulationType.XY){const Z=
ha[0].object;({steps:fa,cancel:oa}=this._buildSnappingPipelineSteps(Z,Z.elevationInfo,fa,oa,ta))}oa=oa.next(Z=>P?.(Z)).next(()=>{ma.length&&this.events.emit("move-stop",new ca(ma));this.destroyed||X();return null});fa=fa.next(Z=>{if("start"===Z.action){pa.length=0;ma.length=0;for(const da of ha)da.dragging||!da.manipulationXY?.hasManipulator(W)&&da.manipulationXY?.grabbing||(pa.push(da),ma.push(da.object),da.dragging=!0);if(0!==ma.length&&(this._moveManipulation&&(this._moveManipulation.interactive=
!1),xa=I.dragManipulatedObjectMany(ma),P=I.resetManipulatedObjectMany(ma),this._emitRecordUndo(),this.events.emit("move-start",new aa(ma)),this.destroyed))return null}return 0!==ma.length?Z:null}).next(Z=>xa?.(Z)).next(Z=>{this._updateMoveTooltip(ka,Z);return Z}).next(Z=>{switch(Z.action){case "start":case "update":if(Z.translationX||Z.translationY||Z.translationZ){const da=this.view.toScreen(Z.mapStart);Z=this.view.toScreen(Z.mapEnd);this.events.emit("move",new ba(Z.x-da.x,Z.y-da.y,ma))}break;case "end":this.events.emit("move-stop",
new ca(ma)),this.destroyed||X()}return null});return{steps:fa,cancel:oa}}_connectTooltips(){this.removeHandles(sa);let ha;if(this._shouldShowMovePointTooltip){const ka=this.objects.at(0),{events:W}=this;this._movePointTooltipInfo??(this._movePointTooltipInfo=new U.MovePointTooltipInfo({viewType:this.view.type,sketchOptions:this.sketchOptions}));const fa={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo();W.emit("move-start",new aa([ka]))},onMove:()=>W.emit("move",new ba(0,0,
[ka])),onMoveStop:()=>W.emit("move-stop",new ca([ka])),onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},onScaleStart:()=>{},onScale:()=>{},onScaleStop:()=>{}};ha=C.connectTooltipToManipulatedObject(this.tooltip,ka,()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this._movePointTooltipInfo,callbacks:fa}))}else ha=t.watch(()=>this.sketchOptions.tooltips.effectiveEnabled?this._latestTooltipInfo:null,ka=>{this.tooltip.info=ka},t.syncAndInitial);this.addHandles(ha,sa)}_showTooltip(ha){this._shouldShowMovePointTooltip||
this._updateMoveTooltip(ha)}_hideTooltip(){this._shouldShowMovePointTooltip||(this.tooltip?.clear(),this._latestTooltipInfo=null)}_updateMoveTooltip(ha,ka){if(!this._shouldShowMovePointTooltip){var {sketchOptions:W}=this;switch(ha){case d.ManipulationType.XY:this._latestTooltipInfo=this._translateTooltipInfo??(this._translateTooltipInfo=new V.TranslateTooltipInfo({sketchOptions:W}));T(this._latestTooltipInfo,ka,(fa,oa)=>ra.autoDistanceBetweenPoints2D(fa,oa));break;case d.ManipulationType.XY_AXIS:this._latestTooltipInfo=
this._translateXYTooltipInfo??(this._translateXYTooltipInfo=new ea.TranslateXYTooltipInfo({sketchOptions:W}));T(this._latestTooltipInfo,ka,(fa,oa)=>v.scale(ra.autoDistanceBetweenPoints2D(fa,oa),B.axisConstrainedDragSign(ka)));break;case d.ManipulationType.Z:this._latestTooltipInfo=this._translateZTooltipInfo??(this._translateZTooltipInfo=new Y.TranslateZTooltipInfo({sketchOptions:W})),T(this._latestTooltipInfo,ka,R.verticalSignedDistanceBetweenPoints)}this._latestTooltipInfo.sketchOptions=W}}_emitRecordUndo(){const ha=
this.objects.toArray().map(ka=>ka.createUndoRecord?.()).filter(g.isSome);0<ha.length&&this.events.emit("record-undo",{updates:ha})}_buildSnappingPipelineSteps(ha,ka,W,fa,oa){const ta=D.manipulatedObjectGeometry(ha);if(null==ta||"point"!==ta.type&&"mesh"!==ta.type)return{steps:W,cancel:fa};const pa=("point"===ta.type?ta:ta.origin).clone(),ma=new N.SnappingContext({elevationInfo:ka,pointer:oa,editGeometryOperations:L.EditGeometryOperations.fromGeometry(pa,this.view.state.viewingMode),visualizer:new r.SnappingVisualizer3D,
excludeFeature:ha.graphic}),{snappingStep:xa,cancelSnapping:P}=K.createSnapDragEventPipelineStep({snappingContext:ma,snappingManager:this.snappingManager,updatingHandles:this._updatingHandles});fa=fa.next(P);W=W.next(X=>{pa.z=l.getConvertedElevation(this.view,pa,ha.elevationInfo,{mode:"absolute-height",offset:0});const Z=ma.coordinateHelper.pointToVector(pa);return{...X,snapOrigin:Z}}).next(...xa);return{steps:W,cancel:fa}}};b.__decorate([F.property({constructOnly:!0,nonNullable:!0})],a.MoveTool3D.prototype,
"view",void 0);b.__decorate([F.property()],a.MoveTool3D.prototype,"objects",void 0);b.__decorate([F.property({constructOnly:!0,nonNullable:!0})],a.MoveTool3D.prototype,"enableZ",void 0);b.__decorate([F.property({constructOnly:!0,type:M})],a.MoveTool3D.prototype,"sketchOptions",void 0);b.__decorate([F.property({constructOnly:!0})],a.MoveTool3D.prototype,"snappingManager",void 0);b.__decorate([F.property()],a.MoveTool3D.prototype,"type",void 0);b.__decorate([F.property()],a.MoveTool3D.prototype,"updating",
null);b.__decorate([F.property()],a.MoveTool3D.prototype,"_latestTooltipInfo",void 0);b.__decorate([F.property()],a.MoveTool3D.prototype,"_shouldShowMovePointTooltip",null);b.__decorate([F.property()],a.MoveTool3D.prototype,"activeTooltipInfo",null);a.MoveTool3D=b.__decorate([c.subclass("esri.views.3d.interactive.editingTools.move.MoveTool3D")],a.MoveTool3D);class ua{constructor(ha){this.object=ha;this.manipulationXY=this.geometryRepresentation=null;this.dragging=!1}}a.MoveEvent=ba;a.MoveStartEvent=
aa;a.MoveStopEvent=ca;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/geometryUtils":function(){define(["exports","../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../../core/libs/gl-matrix-2/math/common"],function(a,b,g){function f(e){if(null==e||"polyline"!==e.type&&"polygon"!==e.type)return 0;var n="polyline"===e.type?e.paths:e.rings;e=g.getEpsilon();for(const u of n)for(n=0;n<u.length-1;n++){const v=u[n],t=u[n+1],F=v[0]-t[0],E=
v[1]-t[1];if(F*F+E*E>e)return Math.atan2(t[1]-v[1],t[0]-v[0])}return 0}a.mainAxis=function(e){e=f(e);return b.fromValues(Math.cos(e),Math.sin(e))};a.orientation=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/isSupportedObjectUtils":function(){define(["exports","../../../../core/has"],function(a,b){a.SupportedObjectResult=void 0;(function(g){g[g.SUPPORTED=0]="SUPPORTED";g[g.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";g[g.GEOMETRY_MISSING=
2]="GEOMETRY_MISSING";g[g.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";g[g.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";g[g.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedObjectResult||(a.SupportedObjectResult={}));a.isSupportedObjectResultMessage=function(g){switch(g){case a.SupportedObjectResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case a.SupportedObjectResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";
case a.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedObjectResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulatedObjectUtils":function(){define(["exports"],function(a){a.manipulatedObjectGeometry=function(b){return b?.operations?.data.geometry};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/manipulatorUtils":function(){define(["exports","../../../../core/handleUtils","../../../../support/elevationInfoUtils"],function(a,b,g){a.canMoveZOperations=function(f,e){return!!f?.data.coordinateHelper.hasZ()&&"on-the-ground"!==e.mode&&!g.hasFeatureExpressionInfo(e)};a.disableDisplayOnGrab=function(f,e){let n=null;const u=f.events.on("grab-changed",v=>{null!=n&&(n.remove(),n=null);"start"===v.action&&(n=f.disableDisplay());e&&e(v)});return b.makeHandle(()=>
{n?.remove();u.remove()})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/tooltipUtils3D":function(){define("exports ../../../../core/handleUtils ../../../../core/quantityUtils ../../../../core/reactiveUtils ./manipulatedObjectUtils ../../../interactive/editGeometry/interfaces ../../../interactive/tooltip/tooltipCommonUtils ../../../support/euclideanLengthMeasurementUtils".split(" "),function(a,b,g,f,e,n,u,v){function t(k,{activeTooltipInfo:m,
callbacks:l}){if(m){l.onBeforeUpdate();var r=e.manipulatedObjectGeometry(k);switch(r?.type){case "mesh":F(m,r.origin,k,l);"orientation"in m&&"scale"in m&&u.updateMeshTransformFromTooltipInfo(m,r,l);break;case "point":F(m,r,k,l)}}}function F(k,m,l,r){const {dx:z,dy:H,dz:D}=u.getXYZDeltasFromTooltipInfo(k,m);if(0!==z||0!==H||0!==D)r.onMoveStart(),l.operations?.move(z,H,D,n.AccumulationBehavior.NEW_STEP),r.onMove(z,H,D),r.onMoveStop()}function E(k,m){const l=e.manipulatedObjectGeometry(m);var r=l?.type;
if(k&&l&&("mesh"===r||"point"===r)){var z=(r="mesh"===r)?l.origin:l;k.setLocationFromPoint(z);q(k,z,m);"transform-mesh"===k.type&&r&&u.updateTooltipInfoFromMeshTransform(k,l);k.clearInputValues()}}function q(k,m,l){k.elevation.actual=v.elevationFromPoint(m);k.elevation.visible=!!l.operations?.data.coordinateHelper.hasZ();k.elevation.readOnly=!1;k.elevation.showAsZ=!0}function c(k){switch(k){case "integer":case "long":return 0;default:return null}}a.connectTooltipToManipulatedObject=function(k,m,l){function r(){const w=
l();return{...w,activeTooltipInfo:w.sketchOptions.tooltips.effectiveEnabled?w.activeTooltipInfo:null}}function z(w){D||(D=!0,w(),D=!1)}function H({activeTooltipInfo:w,sketchOptions:x,scaleRotateTransform:C}){z(()=>{if(w&&(w.sketchOptions=x,E(w,m),"transform-point"===w?.type))if(C){var h=C.mode,{size:y,orientationClockwise:d}=C.adapter,{visualVariables:B}=w.sketchOptions.tooltips,p=B?.rotation,A=null!=d&&(null==h||"rotate"===h);w.orientation.actual=A?g.createAngle(d,"radians",p?.rotationType??"geographic"):
void 0;w.orientation.precision=c(p?.valueType);w.orientation.visible=A;B=B?.size;h=null!=y&&(null==h||"scale"===h);w.size.actual=h?g.createLength(y,B?.unit??"meters"):void 0;w.size.precision=c(B?.valueType);w.size.visible=h}else w.orientation.actual=void 0,w.size.actual=void 0,w.orientation.visible=!1,w.size.visible=!1;k.info=w})}let D=!1;return b.handlesGroup([f.watch(r,H,f.syncAndInitial),f.watch(()=>{const w=r(),{activeTooltipInfo:x}=w;if(x)return{context:w,activeTooltipInfo:x,key:x.key,geometry:e.manipulatedObjectGeometry(m)}},
(w,x)=>{w&&x&&x.key!==w.key&&z(()=>t(m,w.context))},f.sync),m.on("committed",()=>{queueMicrotask(()=>H(r()))}),u.connectPasteEvent(k,{onBeforePaste:()=>{D=!0},onAfterPaste:()=>{t(m,r());D=!1}})])};a.updateElevationFromPoint=q;a.updateTooltipInfoFromManipulatedObject=E;a.updateXYZFromTooltipInfo=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/visualElementUtils":function(){define(["exports","./lineObjectVisualElementUtils","./manipulatedObjectUtils",
"./originGeometryVisualElementUtils"],function(a,b,g,f){a.createVisualElements=function(e){switch(g.manipulatedObjectGeometry(e.object)?.type){case "point":case "mesh":return f.createVisualElements(e);case "polygon":case "polyline":return b.createVisualElements(e);default:return null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/lineObjectVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../Manipulator3D ./GrabbingState ./manipulatedObjectUtils ./ManipulatorState ./ManipulatorType ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/OutlineVisualElement ../../webgl-engine/lib/Material".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r){function z(C){const {view:h,object:y}=C;C=F.manipulatedObjectGeometry(y);const d=new l.OutlineVisualElement({view:h,geometry:w(C)?C:null,elevationInfo:y.elevationInfo,attached:!1,isDecoration:!0}),B=new c.Settings({getTheme:()=>h.effectiveTheme}),p=b.handlesGroup([f.watch(()=>B.visualElements.lineObjects.outline,A=>A.apply(d),f.initial),f.watch(()=>B.visualElements.lineObjects.shadowStyle,A=>A.apply(d),f.initial),f.watch(()=>y.visible,()=>{d.attached=y.visible}),
f.watch(()=>y.isDraped,A=>{d.isDraped=A},f.initial),y.on("committed",()=>{const A=F.manipulatedObjectGeometry(y);d.geometry=w(A)?A:null}),b.destroyHandle(d)]);d.attached=y.visible;return{visualElement:d,remove:()=>p.remove()}}function H(C,h){const {object:y,view:d}=C,B=[];var p=y.elevationInfo;const A="on-the-ground"===p.mode||!p.offset&&"absolute-height"!==p.mode,G=new E.ManipulatorState,I=new c.Settings({getTheme:()=>d.effectiveTheme}),J=I.visualElements,L=new k.ExtendedLineVisualElement({view:d,
extensionType:J.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:r.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});p=g.deg2rad(J.heightPlaneAngleCutoff);const M=new m.LaserlineVisualElement({view:d,attached:!1,angleCutoff:p,isDecoration:!0}),N=e.signal(1);B.push(f.watch(()=>({lineShadowStyle:I.visualElements.lineObjects.shadowStyle,pointShadowStyle:I.visualElements.pointObjects.shadowStyle,alpha:N.value}),({lineShadowStyle:V,pointShadowStyle:ea,alpha:Y})=>
{V.apply(h,Y);ea.apply(L,Y)},f.initial));const K=e.signal(1);B.push(f.watch(()=>({heightPlane:I.visualElements.heightPlane,alpha:K.value}),({heightPlane:V,alpha:ea})=>V.apply(M,ea),f.initial));const O=()=>{G.update(C);var V=F.manipulatedObjectGeometry(y);y.visible&&(!A||!y.isDraped&&w(V)&&V.hasZ)?(h.laserlineEnabled=!0,N.value=G.grabbingState&t.GrabbingState.XY?J.laserlineAlphaMultiplier:1,K.value=G.grabbingState&t.GrabbingState.Z?J.laserlineAlphaMultiplier:1,V=1===G.numSelected?G.firstSelected:1<
G.numSelected&&null!=G.firstGrabbedXY?G.firstGrabbedXY:null,null!=V?(L.setStartEndFromWorldDownAtLocation(V.renderLocation),L.attached=!0):L.attached=!1,D(C,h,M,G)):(h.laserlineEnabled=!1,L.attached=!1,M.attached=!1)};B.push(f.watch(()=>I.visualElements.zVerticalLine,V=>V.apply(L),f.initial));B.push(y.on("committed",O),f.watch(()=>y.visible,O),h.events.on("attachment-origin-changed",O),b.destroyHandle(L),b.destroyHandle(M));const U=[];p=()=>{b.removeHandles(U);U.length=0;C.forEachManipulator(V=>U.push(V.events.on("grab-changed",
O)));C.forEachManipulator(V=>U.push(V.events.on("select-changed",O)));O()};p();B.push(C.onManipulatorsChanged(p),b.refHandle(()=>b.handlesGroup(U)));return b.handlesGroup(B)}function D(C,h,y,d){if(0<d.numSelected){n.set(x,0,0,0);let B=0;C.forEachManipulator((p,A)=>{A===q.ManipulatorType.TRANSLATE_XY&&p.selected&&p instanceof v.Manipulator3D&&(n.add(x,x,p.renderLocation),B++)});0<B?(y.heightManifoldTarget=n.scale(x,x,1/B),y.attached=!0):y.attached=!1}else h=h.attachmentOrigin,null!=h&&C.view.renderCoordsHelper.toRenderCoords(h,
x)?(y.heightManifoldTarget=x,y.attached=!0):y.attached=!1}function w(C){return null!=C&&("polygon"===C.type||"polyline"===C.type)}const x=u.create();a.createVisualElements=function(C){const {object:h}=C,y=z(C);C=H(C,y.visualElement);const d=[y,C];h.maskOccludee&&d.push(h.maskOccludee());return{visualElement:y.visualElement,remove:()=>b.removeHandles(d)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/Manipulator3D":function(){define("exports ../../../geometry ../../../core/compilerUtils ../../../core/Evented ../../../core/handleUtils ../../../core/has ../../../core/mathUtils ../../../core/maybe ../../../core/screenUtils ../../../core/libs/gl-matrix-2/math/mat3 ../../../core/libs/gl-matrix-2/factories/mat3f64 ../../../core/libs/gl-matrix-2/math/mat4 ../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../core/libs/gl-matrix-2/math/vec2 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/ellipsoidUtils ../../../geometry/projection ../../../geometry/projection/localRotationUtils ../../../geometry/projection/projectors ../../../geometry/support/aaBoundingRect ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ../../../support/elevationInfoUtils ../support/ElevationProvider ../support/geometryUtils/ray ../webgl/RenderCamera ../webgl-engine/lib/Object3D ../webgl-engine/lib/UpdatePolicy ../webgl-engine/lib/WebGLLayer ../../interactive/interfaces ../../../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L,M,N){function K(W){return 0!==W[12]||0!==W[13]||0!==W[14]}class O{constructor(W){this.metadata=void 0;this._camera=new G;this._elevation={offset:0,override:null};this.collisionType={type:"point"};this.collisionPriority=0;this._renderObjects=[];this._available=this.autoScaleRenderObjects=!0;this._noDisplayCount=0;this._radius=10;this._worldSized=!1;this.focusMultiplier=2;this.touchMultiplier=2.5;this.worldOriented=!1;this._modelTransform=
c.create();this._worldFrame=null;this._renderLocation=l.create();this._renderLocationDirty=!0;this._location=new N({x:0,y:0,z:0});this._elevationAlignedLocation=new N;this.interactive=this._elevationAlignedLocationDirty=!0;this.selectable=!1;this.consumesClicks=this.grabbable=!0;this.grabCursor=this.cursor=null;this._selected=this._hovering=this.dragging=this._grabbing=!1;this._state=M.ManipulatorStateCustomFlags.None;this._focused=!1;this.events=new f.EventEmitter;this._screenLocation={screenPointArray:t.createScreenPointArray(),
renderScreenPointArray:t.createRenderScreenPointArray3(),pixelSize:0};this._screenLocationDirty=!0;this._attached=this._engineResourcesAddedToStage=!1;this._location.spatialReference=W.view.spatialReference;Object.assign(this,W);(W=this.view.state?.camera)&&this._camera.copyFrom(W)}destroy(){this._applyObjectTransform=ka;this._removeResourcesFromStage();this._camera=this.view=this._engineResources=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(W){this._elevationInfo=
W;this._renderLocationDirty=this._elevationAlignedLocationDirty=!0;this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(W){this._removeResourcesFromStage();this._engineResources=null;this._renderObjects=W.slice();this._updateEngineObject()}set available(W){W!==this._available&&(this._available=W,this._updateEngineObject())}get available(){return this._available}disableDisplay(){this._noDisplayCount++;1===this._noDisplayCount&&this._updateEngineObject();return e.makeHandle(()=>
{this._noDisplayCount--;0===this._noDisplayCount&&this._updateEngineObject()})}set radius(W){W!==this._radius&&(this._radius=W,this._updateEngineObject())}get radius(){return this._radius}set worldSized(W){W!==this._worldSized&&(this._worldSized=W,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(W){K(W)&&(this._screenLocationDirty=!0);q.copy(this._modelTransform,W);this._updateEngineObject()}get renderLocation(){if(this._renderLocationDirty)if(this._renderLocationDirty=
!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented){this._worldFrame||(this._worldFrame=c.create());a:{var W=this.view,fa=this._renderLocation,oa=this._worldFrame;switch(W.viewingMode){case "local":q.identity(oa);break a;case "global":W=r.getReferenceEllipsoid(W.renderCoordsHelper.spatialReference),D.sphericalPCPFtoLonLatElevation(fa,0,aa,0,W.radius),H.computeENUToPCPFLocalRotation(u.deg2rad(aa[0]),u.deg2rad(aa[1]),oa)}}}else this._worldFrame&&
(this._worldFrame=null);return this._renderLocation}set renderLocation(W){this.view.renderCoordsHelper.fromRenderCoords(W,this._location);this.elevationAlignedLocation=this._location}get location(){return this._location}set location(W){d.clonePoint(W,this._location);this._notifyLocationChanged()}_notifyLocationChanged(){this._elevationAlignedLocationDirty=this._screenLocationDirty=this._renderLocationDirty=!0;this._updateEngineObject();this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){if(!this._elevationAlignedLocationDirty)return this._elevationAlignedLocation;
this._evaluateElevationAlignment();this._updateElevationAlignedLocation();return this._elevationAlignedLocation}set elevationAlignedLocation(W){d.clonePoint(W,this._location);this._evaluateElevationAlignment();this._location.z-=this._elevation.offset;this._updateElevationAlignedLocation();this._updateEngineObject();this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const W=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=
this.location.x;this._elevationAlignedLocation.y=this.location.y;this._elevationAlignedLocation.z=W+this._elevation.offset;this._elevationAlignedLocation.spatialReference=d.hydratedSpatialReference(this.location.spatialReference);this._screenLocationDirty=this._renderLocationDirty=!0;this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(W){W!==this._grabbing&&(this._grabbing=W,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(W){W!==
this._hovering&&(this._hovering=W,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(W){W!==this._selected&&(this._selected=W,this._updateEngineObject(),this.events.emit("select-changed",{action:W?"select":"deselect"}))}get state(){return this._state}set state(W){W!==this._state&&(this._state=W,this._updateEngineObject())}updateStateEnabled(W,fa){this.state=fa?this.state|W:this.state&~W}_setFocused(W){W!==this._focused&&(this._focused=
W,this.events.emit("focus-changed",{action:!0===W?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){this._ensureScreenLocation();return this._screenLocation}_ensureScreenLocation(){if(this._screenLocationDirty){this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation);this._screenLocationDirty=!1;if(K(this._modelTransform)){var W=this._calculateModelTransformOffset(ua);W=m.add(W,W,this.renderLocation)}else W=this.renderLocation;this._camera.projectToRenderScreen(W,
this._screenLocation.renderScreenPointArray);this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(W){this._applyObjectTransform=W;this._screenLocationDirty=!0;this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(W,fa){if(!this.available)return null;W=t.screenPointObjectToArray(W,U);var oa=this._getCollisionRadius(fa);fa=-1*
this.collisionPriority;switch(this.collisionType.type){case "point":if(k.squaredDistance(this.screenLocation.screenPointArray,W)<oa*oa)return this.screenLocation.renderScreenPointArray[2]+fa;break;case "line":var ta=this.collisionType.paths,pa=this._getWorldToScreenObjectScale();pa=this._calculateObjectTransform(pa,R);oa*=this.screenLocation.pixelSize;W=A.fromScreen(this._camera,W,ea);if(null==W)break;for(var ma of ta)if(0!==ma.length){ta=m.transformMat4(aa,ma[0],pa);for(var xa=1;xa<ma.length;xa++){var P=
m.transformMat4(ba,ma[xa],pa),X=x.closestRayDistance2(x.fromPoints(ta,P,V),W);if(null!=X&&X<oa*oa)return pa=m.add(y.sv3d.get(),ta,P),m.scale(pa,pa,.5),W=t.castRenderScreenPointArray(y.sv3d.get()),this._camera.projectToRenderScreen(pa,W),W[2]+fa;m.copy(ta,P)}}break;case "disc":ta=this.collisionType.direction;pa=this.collisionType.offset??l.ZEROS;ma=this._getWorldToScreenObjectScale();xa=this._calculateObjectTransform(ma,R);ma=oa*this.screenLocation.pixelSize;W=A.fromScreen(this._camera,W,ea);if(null==
W)break;oa=F.fromMat4(Y,xa);oa=m.transformMat3(la,ta,oa);pa=m.transformMat4(sa,pa,xa);C.fromPositionAndNormal(pa,oa,T);oa=ca;if(C.intersectRay(T,W,oa)&&m.squaredDistance(oa,pa)<ma*ma)return this.screenLocation.renderScreenPointArray[2]+fa;break;case "ribbon":const {paths:Z,direction:da}=this.collisionType;ma=this._getWorldToScreenObjectScale();ma=this._calculateObjectTransform(ma,R);oa*=this._camera.computeScreenPixelSizeAt(this.renderLocation);ta=A.fromScreen(this._camera,W,ea);if(null==ta)break;
W=F.fromMat4(Y,ma);W=m.transformMat3(la,da,W);xa=this._calculateModelTransformPosition(sa);C.fromPositionAndNormal(xa,W,T);W=ca;if(!C.intersectRay(T,ta,W))break;for(pa of Z)if(0!==pa.length)for(ta=m.transformMat4(aa,pa[0],ma),xa=1;xa<pa.length;xa++){P=m.transformMat4(ba,pa[xa],ma);X=x.distance2(x.fromPoints(ta,P,V),W);if(null!=X&&X<oa*oa)return pa=m.add(y.sv3d.get(),ta,P),m.scale(pa,pa,.5),W=t.castRenderScreenPointArray(y.sv3d.get()),this._camera.projectToRenderScreen(pa,W),W[2]+fa;m.copy(ta,P)}break;
default:g.neverReached(this.collisionType)}return null}attach(W={manipulator3D:{}}){const fa=this._stage;fa&&(W=W.manipulator3D,null==W.engineLayerId?(this._engineLayer=new L.WebGLLayer(fa,{pickable:!1,updatePolicy:J.UpdatePolicy.SYNC}),W.engineLayerId=this._engineLayer.id):fa?.getObject&&(this._engineLayer=fa.getObject(W.engineLayerId)),W.engineLayerReferences=(W.engineLayerReferences||0)+1,this._materialIdReferences=W.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=
new Map,W.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),z.canProjectWithoutEngine(this._location.spatialReference,this.view.spatialReference)||(this.location=new N({x:0,y:0,z:0,spatialReference:this.view.spatialReference})))}detach(W={manipulator3D:{}}){W=W.manipulator3D;W.engineLayerReferences--;const fa=0===W.engineLayerReferences;this._removeResourcesFromStage();fa&&(W.engineLayerId=null,v.destroyMaybe(this._engineLayer));
this._materialIdReferences=this._engineLayer=this._engineResources=null;this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera);this._screenLocationDirty=!0;this._updateEngineObject()}onElevationChange(W){z.projectPoint(this.location,ha,W.spatialReference)&&w.containsPointObject(W.extent,ha)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null!=this.elevationInfo){var W=null,fa=0,oa=B.getElevationOffset(this.elevationInfo,this.location.spatialReference??this.view.elevationProvider.spatialReference);
switch(this.elevationInfo.mode){case "on-the-ground":W=p.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0;break;case "relative-to-ground":fa=(p.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0)+oa;break;case "relative-to-scene":fa=(p.getElevationAtPoint(this.view.elevationProvider,this.location,"scene")??0)+oa;break;case "absolute-height":fa=oa}if(fa!==this._elevation.offset||W!==this._elevation.override)this._elevation.offset=fa,this._elevation.override=
W}}_updateEngineObject(){if(this._attached)if(this.available){var W=this._getWorldToScreenObjectScale(),fa=R;!0===this.autoScaleRenderObjects?(W*=this._getFocusedSize(this._radius,this.focused),this._calculateObjectTransform(W,fa)):this._calculateObjectTransform(W,fa);var {objectsByState:oa}=this._ensureEngineResources();W=(this.focused?M.ManipulatorStateFlags.Focused:M.ManipulatorStateFlags.Unfocused)|(this.selected?M.ManipulatorStateFlags.Selected:M.ManipulatorStateFlags.Unselected);var ta=0<this._noDisplayCount;
for(const {stateMask:pa,objects:ma}of oa)if(ta)for(const xa of ma)xa.visible=!1;else if(oa=(pa&M.ManipulatorStateCustomFlags.All)===M.ManipulatorStateCustomFlags.None||(this.state&pa)===(pa&M.ManipulatorStateCustomFlags.All),(pa&M.ManipulatorStateFlags.All)!==M.ManipulatorStateFlags.None&&(W&pa)!==(pa&M.ManipulatorStateFlags.All)||!oa)for(const xa of ma)xa.visible=!1;else for(const xa of ma)xa.visible=!0,xa.transformation=fa}else this._removeResourcesFromStage()}_ensureEngineResources(){if(null==
this._engineResources){const W=this._engineLayer,fa=[],oa=new Set;this.renderObjects.forEach(({geometry:{material:ma}})=>{oa.has(ma)||(fa.push(ma),oa.add(ma))});const ta=new Map;this._renderObjects.forEach(ma=>{const xa=new I.Object3D({castShadow:!1,geometries:[ma.geometry]}),P=ta.get(ma.stateMask)||[];P.push(xa);ta.set(ma.stateMask,P)});const pa=[];ta.forEach((ma,xa)=>pa.push({stateMask:xa,objects:ma}));this._engineResources={objectsByState:pa,layer:W,materials:fa}}this._addResourcesToStage();return this._engineResources}_addResourcesToStage(){const W=
this._stage;if(!this._engineResourcesAddedToStage&&null!=this._engineResources&&W){var {objectsByState:fa,layer:oa,materials:ta}=this._engineResources;ta.forEach(pa=>{const ma=this._materialIdReferences,xa=ma.get(pa.id)||0;0===xa&&W.add(pa);ma.set(pa.id,xa+1)});fa.forEach(({objects:pa})=>{oa.addMany(pa);W.addMany(pa)});this._engineResourcesAddedToStage=!0}}_removeResourcesFromStage(){const W=this._stage;if(this._engineResourcesAddedToStage&&null!=this._engineResources&&W){var {objectsByState:fa,layer:oa,
materials:ta}=this._engineResources;fa.forEach(({objects:pa})=>{oa.removeMany(pa);W.removeMany(pa)});ta.forEach(pa=>{const ma=this._materialIdReferences,xa=ma.get(pa.id);1===xa?(W.remove(pa),ma.delete(pa.id)):ma.set(pa.id,xa-1)});this._engineResourcesAddedToStage=!1}}_getCollisionRadius(W){return this._getFocusedSize(this.radius,!0)*("touch"===W?this.touchMultiplier:1)}_getFocusedSize(W,fa){return W*(fa?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(W){var fa=
this._getWorldToScreenObjectScale();fa=this._calculateObjectTransform(fa,ra);return m.set(W,fa[12],fa[13],fa[14])}_calculateModelTransformOffset(W){const fa=this._calculateModelTransformPosition(W);return m.subtract(W,fa,this.renderLocation)}_calculateObjectTransform(W,fa){q.set(fa,W,0,0,0,0,W,0,0,0,0,W,0,0,0,0,1);this._worldFrame&&q.multiply(fa,fa,this._worldFrame);q.multiply(fa,fa,this._modelTransform);fa[12]+=this.renderLocation[0];fa[13]+=this.renderLocation[1];fa[14]+=this.renderLocation[2];
fa[15]=1;null!=this._applyObjectTransform&&this._applyObjectTransform(fa);return fa}get test(){}}const U=t.createScreenPointArray(),V=x.create(),ea=h.create(),Y=E.create(),ra=c.create(),R=c.create(),T=C.create(),aa=l.create(),ba=l.create(),ca=l.create(),la=l.create(),sa=l.create(),ua=l.create(),ha=new N({x:0,y:0,z:0,spatialReference:null}),ka=()=>{};a.Manipulator3D=O;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/GrabbingState":function(){define(["exports"],
function(a){a.GrabbingState=void 0;var b=a.GrabbingState||(a.GrabbingState={});b[b.NONE=0]="NONE";b[b.ANY=1]="ANY";b[b.Z=2]="Z";b[b.XY=4]="XY";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorState":function(){define(["exports","../Manipulator3D","./GrabbingState","./ManipulatorType"],function(a,b,g,f){class e{constructor(){this.grabbingState=g.GrabbingState.NONE;this.firstSelected=this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=
null}update(n){this.grabbingState=g.GrabbingState.NONE;this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=this.firstSelected=null;n.forEachManipulator((u,v)=>{v===f.ManipulatorType.TRANSLATE_Z&&(this.zManipulator=u);u instanceof b.Manipulator3D&&(u.selected&&(0===this.numSelected&&(this.firstSelected=u),this.numSelected++),null==this.firstGrabbedXY&&u.grabbing&&v===f.ManipulatorType.TRANSLATE_XY&&(this.firstGrabbedXY=u));if(u.grabbing)switch(this.grabbingState|=g.GrabbingState.ANY,v){case f.ManipulatorType.TRANSLATE_Z:this.grabbingState|=
g.GrabbingState.Z;break;case f.ManipulatorType.TRANSLATE_XY:this.grabbingState|=g.GrabbingState.XY}})}}a.ManipulatorState=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorType":function(){define(["exports"],function(a){a.ManipulatorType=void 0;var b=a.ManipulatorType||(a.ManipulatorType={});b[b.TRANSLATE_Z=0]="TRANSLATE_Z";b[b.TRANSLATE_XY=1]="TRANSLATE_XY";b[b.SCALE=2]="SCALE";b[b.ROTATE=3]="ROTATE";b[b.SCALE_ROTATE=4]="SCALE_ROTATE";
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/originGeometryVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection/projectPointToVector ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../support/elevationInfoUtils ./GrabbingState ./manipulatedObjectUtils ./ManipulatorState ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/PointVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../webgl-engine/lib/Material".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x){function C(I,J,L){const {view:M,object:N}=I,K=new l.Settings({getTheme:()=>M.effectiveTheme}),O=new r.ExtendedLineVisualElement({view:M,extensionType:K.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:x.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});J.push(f.watch(()=>K.visualElements.zVerticalLine,ca=>ca.apply(O),f.initial));const U=new z.LaserlineVisualElement({view:M,intersectsLineInfinite:!0,
attached:!1,isDecoration:!0});var V=g.deg2rad(K.visualElements.heightPlaneAngleCutoff);const ea=new z.LaserlineVisualElement({view:M,attached:!1,angleCutoff:V,isDecoration:!0});V=N.elevationInfo;const Y=w.ElevationContext.fromElevationInfo(V),ra="on-the-ground"===V.mode||!V.offset&&"absolute-height"!==V.mode,R=new m.ManipulatorState,T=e.signal(1);J.push(f.watch(()=>({heightPlane:K.visualElements.heightPlane,alpha:T.value}),({heightPlane:ca,alpha:la})=>ca.apply(ea,la),f.initial));const aa=e.signal(1);
J.push(f.watch(()=>({shadowStyle:K.visualElements.pointObjects.shadowStyle,alpha:aa.value}),({shadowStyle:ca,alpha:la})=>ca.apply(U,la),f.initial));const ba=()=>{R.update(I);var ca=y(k.manipulatedObjectGeometry(N)),la=ra&&(N.isDraped||null==ca||!ca.hasZ);let sa=!0;if(la||null==ca)sa=!1;else{q.featureExpressionInfoIsZero(N.elevationInfo)&&(ca=ca.clone(),ca.z=0);const ua=D.evaluateElevationAlignmentAtPoint(ca,M.elevationProvider,Y,M.renderCoordsHelper);n.set(A,ca.x,ca.y,ua);t.projectVectorToVector(A,
ca.spatialReference,A,M.renderCoordsHelper.spatialReference);O.setStartEndFromWorldDownAtLocation(A);U.intersectsWorldUpAtLocation=A}T.value=R.grabbingState&c.GrabbingState.Z?K.visualElements.laserlineAlphaMultiplier:1;ca=F.empty(G);!la&&N.visible&&L.calculateMapBounds(ca)&&t.projectVectorToVector(F.getMin(ca,A),M.spatialReference,A,M.renderCoordsHelper.spatialReference)?(ea.heightManifoldTarget=A,ea.attached=!0):ea.attached=!1;aa.value=R.grabbingState&c.GrabbingState.XY?K.visualElements.laserlineAlphaMultiplier:
1;la=sa&&N.visible&&!la;U.attached=la;O.attached=la};J.push(f.watch(()=>[N.visible,N.isDraped],ba),N.on("committed",ba));I.forEachManipulator(ca=>{J.push(ca.events.on("grab-changed",ba))});J.push(b.destroyHandle(U));J.push(b.destroyHandle(O));J.push(b.destroyHandle(ea));ba()}function h(I,J){const {view:L,object:M}=I,N=new H.PointVisualElement({view:L,geometry:y(k.manipulatedObjectGeometry(M)),elevationInfo:M.elevationInfo,isDecoration:!0});d(I,N,J);J.push(b.destroyHandle(N));return N}function y(I){return null==
I?null:"point"===I.type?I:"mesh"===I.type?I.origin.clone():null}function d(I,J,L){const {view:M,object:N}=I,K=new l.Settings({getTheme:()=>M.effectiveTheme});B(I,J,L);K.visualElements.pointObjects.outline.apply(J);L.push(f.watch(()=>N.visible,()=>{J.attached=N.visible},f.initial))}function B(I,J,L){const {view:M,object:N}=I;let K=null;const O=U=>{null!=K&&(K.remove(),K=null);N.isDraped&&null!=U&&(K=p(M,U,()=>{J.geometry=U}))};I=()=>{const U=y(k.manipulatedObjectGeometry(N));null!=U&&q.featureExpressionInfoIsZero(N.elevationInfo)&&
(U.z=0);O(U);J.geometry=U};L.push(N.on("committed",I),b.refHandle(()=>K));I()}function p(I,J,L){v.projectPointToVector(J,A,I.elevationProvider.spatialReference);const M=A[0],N=A[1];return I.elevationProvider.on("elevation-change",K=>{E.containsXY(K.extent,M,N)&&L()})}const A=u.create(),G=F.create();a.createVisualElements=function(I){const J=[],L=h(I,J);C(I,J,L);return{visualElement:L,remove:()=>b.removeHandles(J)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/config":function(){define(["exports"],
function(a){const b=Math.ceil(70/3*2),g=5*Math.PI/12,f=1*Math.PI/3;a.alignArrowsScaleThreshold=1E6;a.discCollisionRadius=80;a.discHeight=.02;a.discRadius=70;a.discRadiusSmall=b;a.discTranslateArrowOffset=100;a.discTranslateArrowSize=54;a.dragThresholdPx=10;a.geometrySegments=128;a.indicatorThickness=9;a.innerIndicatorRadius=190;a.outerIndicatorRadius=213;a.ringHeight=.5;a.ringIndicatorDelayMs=200;a.ringRadius=160;a.ringResetAnimationSpeedFactor=3;a.ringThickness=24;a.rotateIndicatorArcLength=g;a.rotateIndicatorArrowPlacementPercentage=
.2;a.rotateIndicatorArrowTipLength=60;a.rotateIndicatorArrowTipRadius=23;a.rotateIndicatorDirectionBuffer=.3;a.scaleIndicatorArcLength=f;a.scaleIndicatorDirectionBuffer=.2;a.scaleIndicatorOffset1=30;a.scaleIndicatorOffset2=53;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveManipulation":function(){define("exports ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/reactiveUtils ../ManipulatorType ./config ./InteractiveManipulation ./MoveXYAxisManipulation ./MoveXYDiscManipulation ./MoveZManipulation".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){class q extends v.InteractiveManipulation{constructor(c){super();this._handles=new b;const {tool:k,view:m,snapToScene:l,radius:r}=c;this._view=m;this.xyManipulation=new F.MoveXYDiscManipulation({tool:k,view:m,snapToScene:l,radius:r});this.xyAxisManipulation=new t.MoveXYAxisManipulation({tool:k,view:m,radius:r});this.zManipulation=new E.MoveZManipulation({tool:k,view:m,radius:r});this.xyManipulation.available=c.xyAvailable;this.xyAxisManipulation.available=c.xyAxisAvailable;
this.zManipulation.available=c.zAvailable;this._autoHideXYAxis();this.forEachManipulator(z=>this._handles.add(z.events.on("grab-changed",()=>this._updateManipulatorInteractivity())))}destroy(){this._handles.destroy();this.xyManipulation.destroy();this.xyAxisManipulation.destroy();this.zManipulation.destroy()}createManipulatedObjectDragPipeline(c,k,m){return g.handlesGroup([this.xyManipulation.createManipulatedObjectDragPipeline((l,r,z,H,D)=>c(a.ManipulationType.XY,l,r,z,H,D),k,m),this.xyAxisManipulation.createManipulatedObjectDragPipeline((l,
r,z,H,D)=>c(a.ManipulationType.XY_AXIS,l,r,z,H,D),k,m),this.zManipulation.createManipulatedObjectDragPipeline((l,r,z,H,D)=>c(a.ManipulationType.Z,l,r,z,H,D),k,m)])}createDragPipeline(c,k,m,l){return g.handlesGroup([this.xyManipulation.createDragPipeline((r,z,H,D,w)=>c(a.ManipulationType.XY,r,z,H,D,w),k,m,l),this.xyAxisManipulation.createDragPipeline((r,z,H,D,w)=>c(a.ManipulationType.XY_AXIS,r,z,H,D,w),k,m,l),this.zManipulation.createDragPipeline((r,z,H,D,w)=>c(a.ManipulationType.Z,r,z,H,D,w),m)])}set snapToScene(c){this.xyManipulation.snapToScene=
c}set angle(c){this.xyAxisManipulation.angle=c}set radius(c){this.xyAxisManipulation.radius=c;this.xyManipulation.radius=c;this.zManipulation.radius=c}set displayScale(c){this.xyManipulation.displayScale=c;this.xyAxisManipulation.displayScale=c}forEachManipulator(c){this.xyManipulation.forEachManipulator(k=>c(k,n.ManipulatorType.TRANSLATE_XY));this.xyAxisManipulation.forEachManipulator(k=>c(k,n.ManipulatorType.TRANSLATE_XY));this.zManipulation.forEachManipulator(k=>c(k,n.ManipulatorType.TRANSLATE_Z))}get _xyAxisVisible(){const c=
this.xyManipulation.someManipulator(k=>k.focused)||this.xyAxisManipulation.someManipulator(k=>k.focused);return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||c}_autoHideXYAxis(){const c=this.xyAxisManipulation;var k=this.xyManipulation;if(!f("esri-mobile")){var m=[];k.forEachManipulator(l=>m.push(l));c.forEachManipulator(l=>m.push(l));k=()=>{const l=[];this._xyAxisVisible||c.forEachManipulator(r=>l.push(r.disableDisplay()));this._handles.remove("disable-xy-axis-display");
this._handles.add(l,"disable-xy-axis-display")};for(const l of m)this._handles.add(l.events.on("focus-changed",k));this._view.inputManager&&this._handles.add(e.when(()=>this._view.inputManager?.latestPointerType,k));k()}}static radiusForSymbol(c){return(c=null!=c&&"point-3d"===c.type&&c.symbolLayers)&&c.some(k=>"icon"===k.type)?u.discRadiusSmall:u.discRadius}}a.ManipulationType=void 0;(function(c){c[c.XY=0]="XY";c[c.XY_AXIS=1]="XY_AXIS";c[c.Z=2]="Z"})(a.ManipulationType||(a.ManipulationType={}));
a.MoveManipulation=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/InteractiveManipulation":function(){define(["exports","./Manipulation"],function(a,b){class g extends b.Manipulation{constructor(){super(...arguments);this._interactive=!0}get interactive(){return this._interactive}set interactive(f){this._interactive!==f&&(this._interactive=f);this._updateManipulatorInteractivity()}_updateManipulatorInteractivity(){const f=!this.grabbing&&
this._interactive;this.forEachManipulator(e=>{e.interactive=f||e.grabbing})}}a.InteractiveManipulation=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/Manipulation":function(){define(["exports","../../Manipulator3D"],function(a,b){class g{constructor(){this._available=!0}set location(f){this._forEachManipulator3D(e=>e.location=f)}set elevationAlignedLocation(f){this._forEachManipulator3D(e=>e.elevationAlignedLocation=f)}set elevationInfo(f){this._forEachManipulator3D(e=>
e.elevationInfo=f)}get renderLocation(){let f;this._forEachManipulator3D(e=>{f||(f=e.renderLocation)});return f}set renderLocation(f){this._forEachManipulator3D(e=>e.renderLocation=f)}get available(){return this._available}set available(f){this._available=f;this._forEachManipulator3D(e=>e.available=f)}get hovering(){return this.someManipulator(f=>f.hovering)}get grabbing(){return this.someManipulator(f=>f.grabbing)}get dragging(){return this.someManipulator(f=>f.dragging)}get selected(){return this.someManipulator(f=>
f.selected)}hasManipulator(f){return this.someManipulator(e=>e===f)}someManipulator(f){let e=!1;this.forEachManipulator(n=>{!e&&f(n)&&(e=!0)});return e}_forEachManipulator3D(f){this.forEachManipulator((e,n)=>{e instanceof b.Manipulator3D&&f(e,n)})}}a.Manipulation=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYAxisManipulation":function(){define("exports ../../../../../Color ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/vectorStacks ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d){class B extends H.Manipulation{constructor(p){super();this._handles=new f;this._arrowManipulatorInfos=[];this._angle=0;this._scale=1;this._radius=z.discRadius;this._updateAfterDrag=!1;this.events=new g;this._tool=p.tool;this._view=p.view;this._opaqueMaterial=this._createMaterial();this._transparentMaterial=this._createMaterial(.5);null!=p.radius&&(this._radius=p.radius);this._createManipulators();this.forEachManipulator(A=>this._tool.manipulators.add(A))}set orthogonalAvailable(p){3<=
this._arrowManipulatorInfos.length&&(this._arrowManipulatorInfos[1].manipulator.available=p,this._arrowManipulatorInfos[3].manipulator.available=p)}destroy(){this._handles=u.destroyMaybe(this._handles);this.forEachManipulator(p=>{this._tool.manipulators.remove(p);p.destroy()});this._view=this._tool=null;this._arrowManipulatorInfos.length=0}forEachManipulator(p){for(const {manipulator:A}of this._arrowManipulatorInfos)p(A,r.ManipulatorType.TRANSLATE_XY)}createManipulatedObjectDragPipeline(p,A,G){if(!A.operations)return e.makeHandle();
const I=A.operations.data.spatialReference,J=A.graphic;return D.createManipulatedMoveDragPipeline(A,G,L=>this.createDragPipeline((M,N,K,O,U)=>{({steps:N,cancel:K}=p(M,N,K,O,U));return L(M,N,K)},A.elevationInfo,I,J))}createDragPipeline(p,A,G,I){return e.handlesGroup(this._arrowManipulatorInfos.map(({manipulator:J},L)=>y.createManipulatorDragEventPipeline(J,(M,N,K,O,U)=>{N=N.next(V=>({...V,manipulatorType:r.ManipulatorType.TRANSLATE_XY})).next(y.dragAtLocation(this._view,M.elevationAlignedLocation)).next(l.screenToMapXYAtLocation(this._view,
M.elevationAlignedLocation,A,G,I)).next(y.constrainToMapAxis(M.location,this.angle+(L+1)*Math.PI*.5)).next(y.addScreenDelta());p(M,N,K,O,U)})))}get angle(){return this._angle}set angle(p){this._angle=p;this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(p){this._scale=p;this._updateManipulatorTransform()}get radius(){return this._radius}set radius(p){this._radius!==p&&(this._radius=p,this._updateManipulators())}_updateManipulators(){for(let p=
0;p<this._arrowManipulatorInfos.length;p++)this._updateArrowManipulator(this._arrowManipulatorInfos[p],p);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:p,transform:A},G){var I=this._radius/z.discRadius,J=z.discTranslateArrowSize*I;const L=J*Math.sqrt(3)/2;J=x.createExtrudedTriangle(this._opaqueMaterial,L,J/2,J/2,z.discHeight);x.transformInPlace(J,t.fromTranslation(c.sm4d.get(),E.set(c.sv3d.get(),0,-L/3,0)));p.renderObjects=[new m.RenderObject(J,d.ManipulatorStateFlags.Focused),
new m.RenderObject(J.instantiate({material:this._transparentMaterial}),d.ManipulatorStateFlags.Unfocused)];p.radius=L/3*2.4;p=t.fromZRotation(c.sm4d.get(),G*Math.PI/2);I=t.fromTranslation(c.sm4d.get(),E.set(c.sv3d.get(),0,z.discTranslateArrowOffset*I,0));t.multiply(A,p,I)}_createManipulators(){for(let p=0;4>p;p++){const A=this._createArrowManipulator(p);this._arrowManipulatorInfos.push(A)}this._updateManipulatorTransform()}_updateManipulatorTransform(){var p=this.angle;p=t.fromRotation(c.sm4d.get(),
p,q.fromValues(0,0,1));if(null!=p){var A=t.fromScaling(c.sm4d.get(),E.set(c.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));p=t.multiply(c.sm4d.get(),A,p);for(const G of this._arrowManipulatorInfos)A=t.multiply(c.sm4d.get(),p,G.transform),G.manipulator.modelTransform=A}}_createArrowManipulator(p){const A=new k.Manipulator3D({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:q.fromValues(0,0,1)}}),
G={manipulator:A,transform:F.create()};this._updateArrowManipulator(G,p);this._handles.add(A.events.on("drag",I=>{this._updateAfterDrag&&"end"===I.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}));return G}_createMaterial(p=1){const A=new h.ColorMaterial({cullFace:w.CullFaceOptions.Back,renderOccluded:C.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(v.watch(()=>b.toUnitRGBA(this._view.effectiveTheme.accentColor),G=>{G[3]*=p;A.setParameters({color:G})},
v.initial));return A}get test(){}}a.MoveXYAxisManipulation=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/RenderObject":function(){define(["exports","../../interactive/interfaces"],function(a,b){class g{constructor(f,e=b.ManipulatorStateFlags.None){this.geometry=f;this.stateMask=e}}a.RenderObject=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/dragEventPipeline3D":function(){define("exports ../../../../geometry ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ../../../../support/elevationInfoUtils ../../support/geometryUtils/ray ../../webgl-engine/lib/Intersector ../../webgl-engine/lib/IntersectorInterfaces ../../webgl-engine/lib/verticalOffsetUtils ../../../interactive/dragEventPipeline ../../../../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){function H(G,I){return D(G,()=>I)}function D(G,I){const J=n.create(),L=n.create();let M=!1;return N=>{const K=I(N);if("start"===N.action){var O=g.screenPointObjectToArray(N.screenStart,g.castScreenPointArray(E.sv2d.get()));O=c.fromScreen(G.state.camera,O,A);null!=O&&(M=v.intersectRay(K,O,J))}if(!M)return null;O=g.screenPointObjectToArray(N.screenEnd,g.castScreenPointArray(E.sv2d.get()));O=c.fromScreen(G.state.camera,O,A);return null==O?null:v.intersectRay(K,
O,L)?{...N,renderStart:J,renderEnd:L,plane:K,ray:O}:null}}function w(G,I,J=0,L=null,M=null){let N=null;return K=>{if("start"===K.action&&(N=G.sceneIntersectionHelper.intersectElevationFromScreen(g.createScreenPointArray(K.screenStart.x,K.screenStart.y),I,J,M),null!=N&&null!=L&&!u.projectPoint(N,N,L))||null==N)return null;const O=G.sceneIntersectionHelper.intersectElevationFromScreen(g.createScreenPointArray(K.screenEnd.x,K.screenEnd.y),I,J,M);return null!=O?null==L||u.projectPoint(O,O,L)?{...K,mapStart:N,
mapEnd:O}:null:null}}function x(G,I,J,L=null,M=null){I=q.getZForElevationMode(I,G,J);return w(G,J,I,L,M)}function C(G,I){const J=B,L=p,M=v.create();G.renderCoordsHelper.worldUpAtPosition(I,J);G=e.cross(v.getNormal(M),J,e.subtract(L,I,G.state.camera.eye));e.cross(G,G,J);return v.fromPositionAndNormal(I,G,M)}function h(G,I){const J=n.create(),L=e.length(I);G.renderCoordsHelper.worldUpAtPosition(I,J);const M=n.create(),N=n.create(),K=O=>{e.subtract(O,O,I);F.projectPoint(J,O,O);"global"===G.viewingMode&&
e.length(O)*Math.sign(e.dot(J,O))<-L+.001&&e.subtract(O,e.scale(O,J,.001),I);e.add(O,O,I);return O};return O=>{O.renderStart=K(e.copy(M,O.renderStart));O.renderEnd=K(e.copy(N,O.renderEnd));return O}}function y(G,I){const J=G.renderCoordsHelper;return L=>{const M=J.fromRenderCoords(L.renderStart,new z({spatialReference:I})),N=J.fromRenderCoords(L.renderEnd,new z({spatialReference:I}));return null!=M&&null!=N?{...L,mapStart:M,mapEnd:N}:null}}a.SurfaceType=void 0;(function(G){G[G.GROUND=0]="GROUND";
G[G.OTHER=1]="OTHER"})(a.SurfaceType||(a.SurfaceType={}));const d=f.create(),B=n.create(),p=n.create(),A=t.create();a.convertToMapCoordinates=y;a.hideManipulatorWhileDragging=function(G){let I=null;return J=>{switch(J.action){case "start":I=G.disableDisplay();break;case "end":case "cancel":null!=I&&(I.remove(),I=null)}return J}};a.projectToWorldUp=h;a.screenToMap3D=function(G,I=null){const J=k.newIntersector(G.state.viewingMode);J.options.selectionMode=!0;J.options.store=m.StoreResults.MIN;J.options.hud=
!1;const L=g.createScreenPointArray(),M={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},N=n.create(),K=I??G.spatialReference,O=V=>{G.map.ground&&1>G.map.ground.opacity?M.exclude.add(l.terrainId):M.exclude.delete(l.terrainId);G.sceneIntersectionHelper.intersectIntersectorScreen(g.screenPointObjectToArray(V,L),J,M);V=J.results.min;if(V.getIntersectionPoint(N))V=V.intersector===m.IntersectorType.TERRAIN?a.SurfaceType.GROUND:a.SurfaceType.OTHER;else if(J.results.ground.getIntersectionPoint(N))V=
a.SurfaceType.GROUND;else return null;return{location:G.renderCoordsHelper.fromRenderCoords(N,new z({spatialReference:K})),surfaceType:V}};let U;return V=>{if("start"===V.action){var ea=O(V.screenStart);U=null!=ea?ea.location:null}if(null==U)return null;ea=O(V.screenEnd);return null!=ea?.location?{...V,mapStart:U,mapEnd:ea.location,surfaceType:ea.surfaceType}:null}};a.screenToMapXYAtLocation=x;a.screenToMapXYForManipulatedObject=function(G,I,J,L){G=J.toMap(G.screenStart);return null!=G?x(I,G,J.elevationInfo,
L):null};a.screenToRenderPlane=H;a.screenToRenderPlaneFromEvent=function(G){return D(G,I=>I.plane)};a.screenToRenderRay=function(G,I){const J=L=>{L=g.screenPointObjectToArray(L,g.castScreenPointArray(d));L=c.fromScreen(G.state.camera,L,A);return null==L?null:t.closestPoints(I,L,B,p)?.[0]};return L=>{const M=J(L.screenStart);if(null==M)return null;const N=J(L.screenEnd);return null==N?null:{...L,renderStart:M,renderEnd:N}}};a.screenToZConstrained=function(G,I,J){let L=null;const M=new r.EventPipeline;
M.next(H(G,C(G,I))).next(h(G,I)).next(y(G,J)).next(N=>{N.mapEnd.x=N.mapStart.x;N.mapEnd.y=N.mapStart.y;L=N});return N=>{L=null;M.execute(N);return L}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/moveUtils":function(){define(["exports","../../../../interactive/dragEventPipeline"],function(a,b){a.axisConstrainedDragSign=function(g){if(null==g?.axis)return 1;const {mapStart:f,mapEnd:e,axis:n}=g;g=[e.x-f.x,e.y-f.y];return 0<g[0]*
n[0]+g[1]*n[1]?1:-1};a.createManipulatedMoveDragPipeline=function(g,f,e){const n=(u,v)=>{f({action:u,object:g,dxScreen:v.screenDeltaX,dyScreen:v.screenDeltaY})};return e((u,v,t)=>{v.next(F=>{"start"===F.action&&n("start",F);return F}).next(b.dragManipulatedObject(g)).next(F=>{switch(F.action){case "start":case "update":(F.translationX||F.translationY||F.translationZ)&&n("update",F);break;case "end":n("end",F)}return F});t=t.next(b.resetManipulatedObject(g)).next(F=>{n("end",{screenDeltaX:0,screenDeltaY:0});
return F});return{steps:v,cancel:t}})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYDiscManipulation":function(){define("exports ../../../../../Color ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/vectorStacks ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../snapping/SnapToScene ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d){class B extends z.Manipulation{constructor(p){super();this._handles=new g;this._snapToScene=new D.SnapToScene;this._scale=1;this._radius=r.discRadius;this._view=p.view;this._tool=p.tool;this._discMaterial=this._createMaterial();this._discMaterialTransparent=this._createMaterial(.5);null!=p.snapToScene&&(this.snapToScene=p.snapToScene);null!=p.radius&&(this._radius=p.radius);this._createManipulator();this.forEachManipulator(A=>this._tool.manipulators.add(A))}destroy(){this._handles=
n.destroyMaybe(this._handles);this.forEachManipulator(p=>{this._tool.manipulators.remove(p);p.destroy()});this._manipulator=this._view=this._tool=null}forEachManipulator(p){p(this._manipulator,l.ManipulatorType.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(p){this._scale=p;this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(p){this._snapToScene.enabled=p}get radius(){return this._radius}set radius(p){p!==this._radius&&(this._radius=
p,this._updateManipulator())}get discManipulator(){return this._manipulator}createManipulatedObjectDragPipeline(p,A,G){if(!A.operations)return f.makeHandle();const I=A.graphic,J=A.elevationInfo,L=A.operations.data.spatialReference;return H.createManipulatedMoveDragPipeline(A,G,M=>this.createDragPipeline((N,K,O,U,V)=>{({steps:K,cancel:O}=p(N,K,O,U,V));return M(N,K,O)},J,L,I))}createDragPipeline(p,A,G,I){const J=this._view;return y.createManipulatorDragEventPipeline(this._manipulator,(L,M,N,K,O)=>{M=
M.next(y.dragAtLocation(J,L.elevationAlignedLocation)).next(m.screenToMapXYAtLocation(J,L.elevationAlignedLocation,A,G,I)).next(...this._snapToScene.createDragEventPipelineStep(J,A)).next(U=>({...U,manipulatorType:l.ManipulatorType.TRANSLATE_XY})).next(y.addScreenDelta());p(L,M,N,K,O)})}_updateManipulatorTransform(){const p=v.fromScaling(q.sm4d.get(),F.set(q.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=p}_createManipulator(){this._manipulator=
new c.Manipulator3D({view:this._view,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:E.fromValues(0,0,1)},worldOriented:!0});this._updateManipulator()}_updateManipulator(){const p=x.createCylinderGeometry(this._discMaterial,r.discHeight,1,r.geometrySegments,E.fromValues(0,0,1),E.fromValues(0,0,0));p.transformation=v.fromScaling(t.create(),E.fromValues(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[new k.RenderObject(p,
d.ManipulatorStateFlags.Focused),new k.RenderObject(p.instantiate({material:this._discMaterialTransparent}),d.ManipulatorStateFlags.Unfocused)];this._manipulator.radius=this._radius/r.discRadius*r.discCollisionRadius}_createMaterial(p=1){const A=new h.ColorMaterial({cullFace:w.CullFaceOptions.Back,renderOccluded:C.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(u.watch(()=>b.toUnitRGBA(this._view.effectiveTheme.accentColor),G=>{G[3]*=p;A.setParameters({color:G})},u.initial));return A}get test(){}}
a.MoveXYDiscManipulation=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/snapping/SnapToScene":function(){define(["exports","../../../../../support/elevationInfoUtils","../../../../interactive/dragEventPipeline"],function(a,b,g){class f{constructor(){this._next=this._lastDragEvent=this._elevationInfo=this._view=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&null!=this._lastDragEvent&&null!=this._next){const n=
this._lastDragEvent.mapEnd,u=this._snap(this._lastDragEvent.screenEnd);null!=u&&this._next.execute({action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===e?u:n,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd})}this._enabled=e}_snap(e){e=null!=this._view?this._view.toMap(e,{exclude:[]}):null;null!=e&&null!=this._view&&(e.z=b.getZForElevationMode(e,this._view,this._elevationInfo));return e}createDragEventPipelineStep(e,n){this._view=e;this._elevationInfo=
n;this._lastDragEvent=null;this._next=e=new g.EventPipeline;return[u=>{this._lastDragEvent="end"!==u.action?{...u}:null;if(this._enabled){const v=this._snap(u.screenEnd);return null!=v?{action:u.action,mapStart:u.mapStart,mapEnd:v,screenStart:u.screenStart,screenEnd:u.screenEnd}:null}return{action:u.action,mapStart:u.mapStart,mapEnd:u.mapEnd,screenStart:u.screenStart,screenEnd:u.screenEnd}},e]}}a.SnapToScene=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveZManipulation":function(){define("exports ../../../../../Color ../../../../../core/colorUtils ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../settings ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d){function B(L,M,N){L=g.darken(L,N);L.a*=M;return b.toUnitRGBA(L)}class p extends w.Manipulation{constructor(L){super();this._radius=D.discRadius;this.events=new f;this._tool=L.tool;this._view=L.view;const M=new H.Settings({getTheme:()=>this._view.effectiveTheme});this._settings=M;null!=L.radius&&(this._radius=L.radius);L=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:m.createManipulatorMaterial(B(L,1,.25),h.RenderOccludedFlag.Occlude),
materialFocused:m.createManipulatorMaterial(B(L,1,0),h.RenderOccludedFlag.Occlude),materialOccludedUnfocused:m.createManipulatorMaterial(B(L,.7,0),M.zManipulator.renderOccluded),materialOccludedFocused:m.createManipulatorMaterial(B(L,.85,0),M.zManipulator.renderOccluded)};this._themeHandle=t.watch(()=>this._view.effectiveTheme.accentColor,N=>{const K=B(N,1,.25),O=B(N,1,0),U=B(N,.7,0);N=B(N,.85,0);const {materialUnfocused:V,materialFocused:ea,materialOccludedUnfocused:Y,materialOccludedFocused:ra}=
this._materials;V.setParameters({color:K});ea.setParameters({color:O});Y.setParameters({color:U});ra.setParameters({color:N})});this._createManipulator();this.forEachManipulator(N=>this._tool.manipulators.add(N))}destroy(){this._themeHandle=v.removeMaybe(this._themeHandle);this._manipulator.applyObjectTransform=J;this.forEachManipulator(L=>{this._tool.manipulators.remove(L);L.destroy()})}forEachManipulator(L){L(this._manipulator,z.ManipulatorType.TRANSLATE_Z)}createManipulatedObjectDragPipeline(L,
M,N){if(!M.operations)return e.makeHandle();const K=M.operations.data.spatialReference;return x.createManipulatedMoveDragPipeline(M,N,O=>this.createDragPipeline((U,V,ea,Y,ra)=>{({steps:V,cancel:ea}=L(U,V,ea,Y,ra));return O(U,V,ea)},K))}createDragPipeline(L,M){const N=this._view;return y.createManipulatorDragEventPipeline(this._manipulator,(K,O,U,V,ea)=>{O=O.next(Y=>({...Y,manipulatorType:z.ManipulatorType.TRANSLATE_Z})).next(r.screenToZConstrained(N,K.renderLocation,M)).next(y.addScreenDelta());L(K,
O,U,V,ea)})}get radius(){return this._radius}set radius(L){L!==this._radius&&(this._radius=L,this._updateManipulator())}_updateManipulator(){var L=this._settings,M=this._radius/D.discRadius,N=L.zManipulator.height*M,K=L.zManipulator.coneHeight*M;const O=L.zManipulator.coneWidth*M;L=L.zManipulator.width*M;const U=[c.fromValues(0,0,0),c.fromValues(0,0,N)];M=[c.fromValues(0,0,0),c.fromValues(0,0,N+K)];const V=E.create();F.translate(V,V,[0,0,N]);F.rotateX(V,V,Math.PI/2);const {materialUnfocused:ea,materialFocused:Y,
materialOccludedUnfocused:ra,materialOccludedFocused:R}=this._materials;N=C.createTubeGeometry(ea,U,L/2,16,!1);K=C.createConeGeometry(ea,K,O/2,16,!1);K.transformation=V;this._manipulator.renderObjects=[new l.RenderObject(K,d.ManipulatorStateFlags.Unfocused),new l.RenderObject(N,d.ManipulatorStateFlags.Unfocused),new l.RenderObject(K.instantiate({material:Y}),d.ManipulatorStateFlags.Focused),new l.RenderObject(N.instantiate({material:Y}),d.ManipulatorStateFlags.Focused),new l.RenderObject(K.instantiate({material:ra}),
d.ManipulatorStateFlags.Unfocused),new l.RenderObject(N.instantiate({material:ra}),d.ManipulatorStateFlags.Unfocused),new l.RenderObject(K.instantiate({material:R}),d.ManipulatorStateFlags.Focused),new l.RenderObject(N.instantiate({material:R}),d.ManipulatorStateFlags.Focused)];this._manipulator.radius=L/2+2;this._manipulator.collisionType={type:"line",paths:[M]}}_createManipulator(){const L=this._view,M=new k.Manipulator3D({view:L,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",
elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});M.applyObjectTransform=N=>{var K=L.state.camera,O=A;L.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,O);const U=q.dist(K.eye,O),V=K.computeRenderPixelSizeAtDist(U);var ea=q.subtract(G,O,K.eye);q.normalize(ea,ea);var Y=I;L.renderCoordsHelper.worldUpAtPosition(A,Y);O=Math.abs(q.dot(ea,Y));ea=q.cross(G,ea,Y);Y=q.cross(G,ea,Y);O=u.clamp(O,.01,1);K=1-Math.sqrt(1-O*O)/O/K.fullWidth;O=this._radius/D.discRadius*
this._settings.zManipulator.width;q.scale(Y,q.normalize(Y,Y),(1/K-1)*U+V*O);N[12]-=G[0];N[13]-=G[1];N[14]-=G[2]};this._manipulator=M;this._updateManipulator()}get test(){}}const A=c.create(),G=c.create(),I=c.create(),J=()=>{};a.MoveZManipulation=p;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/manipulatorUtils":function(){define("exports ../../../core/colorUtils ../../../core/libs/gl-matrix-2/math/mat4 ../../../chunks/vec32 ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ./editingTools/manipulatedObjectUtils ../layers/graphics/graphicUtils ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/Material ../webgl-engine/materials/ColorMaterial ../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){function c(l,r,z,H){l=f.normalize(e.sv3d.get(),l);r=f.normalize(e.sv3d.get(),r);const D=f.cross(e.sv3d.get(),l,r);H[0]=l[0];H[1]=l[1];H[2]=l[2];H[3]=0;H[4]=r[0];H[5]=r[1];H[6]=r[2];H[7]=0;H[8]=D[0];H[9]=D[1];H[10]=D[2];H[11]=0;H[12]=z[0];H[13]=z[1];H[14]=z[2];H[15]=1;return H}const k=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),m=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});a.calculateInputRotationTransform=function(l,
r,z,H){l=f.subtract(e.sv3d.get(),l,z);H=f.cross(e.sv3d.get(),H,l);z=c(l,H,z,e.sm4d.get());g.invert(z,z);r=f.transformMat4(e.sv3d.get(),r,z);return Math.atan2(r[1],r[0])};a.calculateTranslateRotateFromBases=c;a.createManipulatorMaterial=function(l,r=F.RenderOccludedFlag.OccludeAndTransparent,z=!0){const H=b.colorVectorToColorAndOpacity(l);l=!(1>l[3]);return z?new q.ShadedColorMaterial({color:H,writeDepth:l,cullFace:t.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0}):new E.ColorMaterial({color:H,
writeDepth:l,cullFace:t.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0})};a.createManipulatorOutlineMaterial=function(l,r=F.RenderOccludedFlag.OccludeAndTransparent){l=b.colorVectorToColorAndOpacity(l);return new E.ColorMaterial({color:l,writeDepth:!0,cullFace:t.CullFaceOptions.Front,renderOccluded:r,isDecoration:!0})};a.getGraphicAttachmentOrigin=function(l,r){const z=l.getViewForGraphic(r);return null!=z&&"computeAttachmentOrigin"in z?z.computeAttachmentOrigin(r,l.spatialReference):null};
a.placeAtObject=function(l,r){const z=r.origin;null!=z?l.elevationAlignedLocation=z:(r=u.manipulatedObjectGeometry(r),null!=r&&(r="mesh"===r.type?r.origin:v.computeCentroid(r),null!=r&&(l.location=n.hydrateGeometry(r))))};a.rotateManipulatorDefaults=k;a.worldScaledManipulatorSettings=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYObjectManipulation":function(){define("exports ../../../../../core/handleUtils ../dragEventPipeline3D ../ManipulatorType ./Manipulation ./moveUtils ../../../../interactive/dragEventPipeline".split(" "),
function(a,b,g,f,e,n,u){class v extends e.Manipulation{constructor(t){super();this._view=t.view;this._tool=t.tool;this._object=t.object;this._manipulator=this._object.createManipulator?.({selectable:!0,cursor:"move"});this.forEachManipulator(F=>this._tool.manipulators.add(F))}destroy(){this.forEachManipulator(t=>{this._tool.manipulators.remove(t);t.destroy()});this._manipulator=this._view=this._tool=null}forEachManipulator(t){this._manipulator&&t(this._manipulator,f.ManipulatorType.TRANSLATE_XY)}createManipulatedObjectDragPipeline(t){return n.createManipulatedMoveDragPipeline(this._object,
t,F=>this.createDragPipeline(F))}createDragPipeline(t){if(!this._manipulator)return b.makeHandle();const F=this._view;return u.createManipulatorDragEventPipeline(this._manipulator,(E,q,c,k,m)=>{const l=this._object.operations?.data.spatialReference;q=q.next(r=>l?r:null).next(g.screenToMapXYForManipulatedObject(m,F,this._object,l)).next(u.addMapDelta()).next(u.addScreenDelta());t(E,q,c,k,m)})}}a.MoveXYObjectManipulation=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/move/isSupportedObject":function(){define(["exports",
"../../../../../core/has","../../../../../support/elevationInfoUtils","../isSupportedObjectUtils"],function(a,b,g,f){a.isSupportedObject=function(e){if(e.graphic&&"graphics"!==e.graphic.layer?.type)return f.SupportedObjectResult.GRAPHICS_LAYER_MISSING;const n=e.operations?.data.type;if(!n)return f.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED;switch(n){case "polygon":case "point":case "polyline":case "mesh":break;default:return f.SupportedObjectResult.GEOMETRY_TYPE_UNSUPPORTED}return g.hasEffectiveFeatureExpressionInfo(e.elevationInfo)?
f.SupportedObjectResult.ELEVATION_MODE_UNSUPPORTED:f.SupportedObjectResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/MovePointTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),
function(a,b,g,f,e,n,u,v,t){a.MovePointTooltipInfo=class extends t.TooltipInfoWithCoordinates(v.SketchTooltipInfo){constructor(F){super(F);this.type="move-point";this.allFields.forEach(E=>{E.lockable=!1;E.setActual(null)})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};b.__decorate([g.property()],a.MovePointTooltipInfo.prototype,"allFields",null);a.MovePointTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.MovePointTooltipInfo")],a.MovePointTooltipInfo);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/TranslateTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,b,g,f,e,n,u,v,t){a.TranslateTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);
this.type="translate";this.distance=g.zeroMeters}clear(){this.distance=g.zeroMeters}};b.__decorate([f.property()],a.TranslateTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateTooltipInfo.prototype,"distance",void 0);a.TranslateTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.TranslateTooltipInfo")],a.TranslateTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/TranslateXYTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t){a.TranslateXYTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="translate-xy";this.distance=g.zeroMeters}};b.__decorate([f.property()],a.TranslateXYTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateXYTooltipInfo.prototype,"distance",void 0);a.TranslateXYTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.TranslateXYTooltipInfo")],a.TranslateXYTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/infos/TranslateZTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,b,g,f,e,n,u,v,t){a.TranslateZTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="translate-z";
this.distance=g.zeroMeters}clear(){this.distance=g.zeroMeters}};b.__decorate([f.property()],a.TranslateZTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateZTooltipInfo.prototype,"distance",void 0);a.TranslateZTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.TranslateZTooltipInfo")],a.TranslateZTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/ReshapeTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ./ReshapeOperation ../../../../interactive/InteractiveToolBase ../../../../interactive/keybindings ../../../../interactive/sketch/SketchOptions".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c){a.ReshapeTool3D=class extends E.InteractiveToolBase{constructor(k){super(k);this._reshapeOperation=null;this.events=new g;this.enableDeleteVertices=this.enableMoveObject=this.enableZVertex=this.enableZShape=!0;this.autoHideManipulators=!1;this.enableMidpoints=!0;this.enableEdgeOffset=!1;this.type="reshape-3d";this.sketchOptions=new c;this.snappingManager=null;this.automaticManipulatorSelection=!1}initialize(){const k=this._reshapeOperation=new F.ReshapeOperation({tool:this});
this.addHandles([k.events.on("reshape",m=>this.events.emit("reshape",m)),k.events.on("move",m=>this.events.emit("move",m)),k.events.on("vertex-add",m=>this.events.emit("vertex-add",m)),k.events.on("vertex-remove",m=>this.events.emit("vertex-remove",m)),k.events.on("immediate-click",m=>this.events.emit("immediate-click",{...m,object:this.object})),this.view.on("pointer-down",["Shift"],m=>m.stopPropagation())]);this.finishToolCreation()}destroy(){this._reshapeOperation=f.destroyMaybe(this._reshapeOperation)}get updating(){return((this.object.updating??
!1)||this._reshapeOperation?.updating)??!1}get activeTooltipInfo(){return this._reshapeOperation?.activeTooltipInfo??null}get tooltip(){return this._reshapeOperation?.tooltip??null}onManipulatorSelectionChanged(){this._reshapeOperation?.onManipulatorSelectionChanged()}get canUndo(){return this._reshapeOperation?.canUndo??!1}undo(){this.snappingManager?.doneSnapping();this._reshapeOperation?.undo()}get canRedo(){return this._reshapeOperation?.canRedo??!1}redo(){this.snappingManager?.doneSnapping();
this._reshapeOperation?.redo()}onInputEvent(k){const m=this._reshapeOperation;m&&(m.enterInputModeIfAvailable(k)||this.enableDeleteVertices&&"key-down"===k.type&&q.sketchKeys.delete.includes(k.key)&&0<m.removeSelectedVertices()&&k.stopPropagation())}reset(){}};b.__decorate([e.property()],a.ReshapeTool3D.prototype,"_reshapeOperation",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"view",void 0);b.__decorate([e.property({constructOnly:!0})],a.ReshapeTool3D.prototype,"object",void 0);
b.__decorate([e.property()],a.ReshapeTool3D.prototype,"enableZShape",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"enableZVertex",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"enableMoveObject",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"enableDeleteVertices",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"autoHideManipulators",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"enableMidpoints",void 0);b.__decorate([e.property()],
a.ReshapeTool3D.prototype,"enableEdgeOffset",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"type",void 0);b.__decorate([e.property({type:c})],a.ReshapeTool3D.prototype,"sketchOptions",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"snappingManager",void 0);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"updating",null);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"activeTooltipInfo",null);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"tooltip",
null);b.__decorate([e.property()],a.ReshapeTool3D.prototype,"automaticManipulatorSelection",void 0);a.ReshapeTool3D=b.__decorate([t.subclass("esri.views.3d.interactive.editingTools.reshape.ReshapeTool3D")],a.ReshapeTool3D);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/ReshapeOperation":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/colorUtils ../../../../../core/has ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../core/support/UpdatingHandles ../../../../../geometry/Point ../../../../../geometry/Polyline ../../../../../geometry/SpatialReference ../../../../../layers/graphics/dehydratedPoint ../../../../../symbols/support/utils ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../../SegmentLabels3D ../../SnappingVisualizer3D ../dragEventPipeline3D ../geometryUtils ../ManipulatorType ../manipulatorUtils ../settings ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/MoveXYObjectManipulation ./edgeOffsetUtils ./reshapeTooltipUtils3D ../../visualElements/OutlineVisualElement ../../../webgl-engine/lib/GeometryUtil ../../../../input/IViewEvents ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/keybindings ../../../../interactive/editGeometry/interfaces ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/tooltipCommonUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L,M,N,K,O,U,V,ea,Y,ra,R,T,aa,ba,ca,la,sa){function ua(){return P=>{const {operation:X,mapEnd:Z}=P;return null==X||null==Z?P:{...P,signedDistance:X.signedDistanceToPoint(Z)}}}function ha(P){const X=P.size/2,Z=X+P.collisionPadding;return{size:X/Z,outlineSize:(X+P.outlineSize)/Z}}function ka(P){return new H({x:0,y:0,z:0,spatialReference:P})}function W(P){return"edge"===P.type&&"edgeManipulator"in P}const fa=Symbol();a.ReshapeOperation=
class extends g{get _operations(){return this.object.operations}constructor(P){super(P);this._selectedIndex=0;this._manipulatorHandles=new v;this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0;this._reshapeEventState=ma.NONE;this._pendingEdgeOffsetInfo=null;this._updatingHandles=new z.UpdatingHandles;this._recreatingManipulators=!1;this._settings=new L.Settings({getTheme:()=>this.view.effectiveTheme});this.events=new u;this._vertexLaserLineVisualElement=this.activeTooltipInfo=null;this._tooltipCallbacks=
{onBeforeReshape:()=>this.tool.endDrag(),onReshapeStart:()=>this._updateEventState(ma.RESHAPING),onReshape:()=>this.events.emit("reshape",{type:"reshape",object:this.object}),onReshapeStop:()=>this._updateEventState(ma.NONE,{forceEnd:!0}),onMoveStart:()=>this._updateEventState(ma.MOVING),onMove:()=>this.events.emit("move",{type:"move",object:this.object,dx:0,dy:0}),onMoveStop:()=>this._updateEventState(ma.NONE,{forceEnd:!0})}}initialize(){const {view:P}=this;var X=this._settings.manipulators,Z=X.vertex;
this.tooltipInfos=V.createTooltipInfos(this._sketchOptions,P);this._vertexManipulatorMaterial=y.createManipulatorMaterial(e.unitRGBAFromColor(Z.color),Z.renderOccluded);this._vertexManipulatorOutlineMaterial=y.createManipulatorOutlineMaterial(e.unitRGBAFromColor(Z.outlineColor),Z.renderOccluded);this._vertexManipulatorHoverOutlineMaterial=y.createManipulatorOutlineMaterial(e.unitRGBAFromColor(Z.hoverOutlineColor),Z.renderOccluded);Z=X.edge;this._edgeManipulatorMaterial=y.createManipulatorMaterial(e.unitRGBAFromColor(Z.color),
Z.renderOccluded);this._edgeManipulatorOutlineMaterial=y.createManipulatorOutlineMaterial(e.unitRGBAFromColor(Z.outlineColor),Z.renderOccluded);Z=X.edgeOffset;this._edgeOffsetManipulatorMaterial=y.createManipulatorMaterial(e.unitRGBAFromColor(Z.color),Z.renderOccluded,!1);this._edgeOffsetManipulatorHoverMaterial=y.createManipulatorMaterial(e.unitRGBAFromColor(Z.hoverColor),Z.renderOccluded,!1);X=X.selected;this._selectedManipulatorMaterial=y.createManipulatorMaterial(e.unitRGBAFromColor(X.color),
X.renderOccluded);this._selectedManipulatorOutlineMaterial=y.createManipulatorOutlineMaterial(e.unitRGBAFromColor(X.outlineColor),X.renderOccluded);this._selectedManipulatorHoverOutlineMaterial=y.createManipulatorOutlineMaterial(e.unitRGBAFromColor(X.hoverOutlineColor),X.renderOccluded);this.tooltip=sa.makeTooltip(()=>({view:P,options:this._sketchOptions.tooltips}));this.addHandles([E.watch(()=>{const da=this._settings.manipulators;return{vertexSettings:da.vertex,edgeSettings:da.edge,edgeOffsetSettings:da.edgeOffset,
selectedSettings:da.selected}},({vertexSettings:da,edgeSettings:ia,edgeOffsetSettings:ja,selectedSettings:va})=>{da.applyColor(this._vertexManipulatorMaterial);da.applyOutline(this._vertexManipulatorOutlineMaterial);da.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial);ia.applyColor(this._edgeManipulatorMaterial);ia.applyOutline(this._edgeManipulatorOutlineMaterial);ja.applyColor(this._edgeOffsetManipulatorMaterial);ja.applyHover(this._edgeOffsetManipulatorHoverMaterial);va.applyColor(this._selectedManipulatorMaterial);
va.applyOutline(this._selectedManipulatorOutlineMaterial);va.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)}),E.watch(()=>this.object.visible,da=>{for(const ia of this._manipulatorInfos)ia.manipulator.available=da,W(ia)&&(ia.edgeManipulator.available=da)}),E.watch(()=>0===this._numGrabbing+this._numDragging,da=>this._toggleAutoHideManipulators(da)),E.watch(()=>({labels:this._segmentLabels,enabled:this._sketchOptions.labels.enabled,edgeOffsetEnabled:this.enableEdgeOffset}),({labels:da,
enabled:ia,edgeOffsetEnabled:ja})=>{null!=da&&(da.visible=ia,da.edgeDistance=ja?"far":"default")},E.initial),V.connectTooltipToManipulatedObject(this.tooltip,this.object,()=>this._tooltipsContext),E.watch(()=>this.tooltip.mode,(da,ia)=>{"input"===ia&&"input"!==da&&this._resetTooltip()}),E.on(()=>this._operations,"vertex-update",da=>this._updateManipulatorPositions(da.vertices),{onListenerAdd:()=>this._recreateManipulators()}),E.on(()=>this._operations?.data,"change",da=>{"undo"!==da.operation&&"redo"!==
da.operation||this._recreateManipulators()})])}destroy(){this._removeManipulators();this._updatingHandles.destroy();this._segmentLabels=F.destroyMaybe(this._segmentLabels);this.tooltip=F.destroyMaybe(this.tooltip)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get object(){return this.tool.object}get enableZShape(){return this.tool.enableZShape}get enableDeleteVertices(){return this.tool.enableDeleteVertices}get enableZVertex(){return this.tool.enableZVertex}get autoHideManipulators(){return this.tool.autoHideManipulators}get enableMoveObject(){return this.tool.enableMoveObject}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _sketchOptions(){return this.tool.sketchOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}enterInputModeIfAvailable(P){return"key-down"!==
P.type||P.key!==aa.tooltipKeys.enterInputMode?!1:"reshape-edge-offset"===this.activeTooltipInfo?.type?this._enterInputModeDuringEdgeOffset(P):sa.enterInputModeIfAvailable(P,this.tooltip)?(this.tool.endDrag(),!0):!1}removeSelectedVertices(){const P=this._manipulatorInfos.filter(X=>X.manipulator.selected&&"vertex"===X.type);this._removeVertices(P);return P.length}onManipulatorSelectionChanged(){this.events.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll();this._moveManipulation=
F.destroyMaybe(this._moveManipulation);this._objectMoveManipulation=F.destroyMaybe(this._objectMoveManipulation);this.manipulators.removeAll();this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0}_createManipulators(P){if(null!=this._operations){var X=this.object.elevationInfo;for(const Z of this._operations.data.components){const da=P?.byComponentIndex.get(Z.index);for(const ia of Z.vertices){const ja=da?.has(ia.index);this._createVertexOrEdgeManipulator(ia,X,ja)}for(const ia of Z.edges)this._createVertexOrEdgeManipulator(ia,
X)}this._createObjectMoveManipulation();this._createMoveManipulation(X);this._createVisualElements()}}get canRedo(){return null!=this._operations&&this._operations.canRedo}get canUndo(){return null!=this._operations&&this._operations.canUndo}redo(){return this._operations?.redo()}undo(){this.events.emit("undo");return this._operations?.undo()}_recreateManipulators(){if(!this._recreatingManipulators){this._recreatingManipulators=!0;this._removeManipulators();this._resetTooltip();this._operations&&
this._segmentLabels?.context?.editGeometryOperations===this._operations||(this._segmentLabels=F.destroyMaybe(this._segmentLabels));this._createManipulators();if(!this._segmentLabels&&this._operations){const P=this._sketchOptions.labels;this._segmentLabels=new B.SegmentLabels3D({context:{view:this.view,editGeometryOperations:this._operations,elevationInfo:this.object.elevationInfo,labelOptions:P},visible:P.enabled})}this._recreatingManipulators=!1}}_perObjectManipulatorDragAction(P,X){if("end"===X.action)return X;
let Z=0;const da=[],ia=this._manipulatorInfos.some(ja=>"vertex"===ja.type&&ja.manipulator.selected);P=P===xa.SELECTED_OR_ALL&&ia;for(const ja of this._manipulatorInfos)"vertex"===ja.type&&(ja.manipulator.grabbing||P&&!ja.manipulator.selected||da.push(ja),Z++);this._moveVertices(da,X);if(da.length===Z){this._updateEventState(ma.MOVING);if(this.destroyed)return X;this.events.emit("move",{type:"move",dx:X.screenDeltaX,dy:X.screenDeltaY,object:this.object})}else{this._updateEventState(ma.RESHAPING);if(this.destroyed)return X;
this.events.emit("reshape",{type:"reshape",object:this.object})}return X}_toggleAutoHideManipulators(P){this.autoHideManipulators&&(P?this.removeHandles(fa):this.tool.manipulators.forEach(({manipulator:X})=>{(X=X.disableDisplay?.())&&this.addHandles(X,fa)}))}_isMultiVertexSelection(){return 1<this._manipulatorInfos.reduce((P,X)=>"vertex"===X.type&&X.manipulator.selected?P+1:P,0)}_perVertexManipulatorDragAction(P){this._updateEventState(ma.RESHAPING);if(!this.destroyed){var {mapDeltaX:X,mapDeltaY:Z,
mapDeltaZ:da}=P;if(X||Z||da){var ia=[];for(const ja of this._manipulatorInfos)"vertex"===ja.type&&(ja.manipulator.selected&&!ja.manipulator.grabbing||ja===P.info)&&ia.push(ja);this._moveVertices(ia,P,ba.AccumulationBehavior.ACCUMULATE_STEPS);this.events.emit("reshape",{type:"reshape",object:this.object})}}}_updateEventState(P,X={}){if(P===this._reshapeEventState)return!1;switch(P){case ma.NONE:if(!X.forceEnd&&(0!==this._numGrabbing||0!==this._numDragging))return!1;switch(this._reshapeEventState){case ma.MOVING:this.events.emit("move",
{type:"move-stop",dx:0,dy:0,object:this.object});break;case ma.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object})}break;case ma.MOVING:switch(this._reshapeEventState){case ma.NONE:this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object});break;case ma.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object}),this.destroyed||this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object})}break;case ma.RESHAPING:switch(this._reshapeEventState){case ma.NONE:this.events.emit("reshape",
{type:"reshape-start",object:this.object});break;case ma.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object}),this.destroyed||this.events.emit("reshape",{type:"reshape-start",object:this.object})}}if(this.destroyed)return!1;X=this._reshapeEventState!==P;this._reshapeEventState=P;return X}_createObjectMoveManipulation(){const {tool:P,view:X,object:Z,_operations:da}=this;if(da){this._objectMoveManipulation=new O.MoveXYObjectManipulation({tool:P,view:X,object:Z});if(this.enableMoveObject){let ia=
null;this._manipulatorHandles.add(this._objectMoveManipulation.createDragPipeline((ja,va,Aa)=>{va.next(ya=>this._trackNumDragging(ya)).next(ya=>{"start"===ya.action&&(ia=da.createUndoGroup());return ya}).next(ya=>this._perObjectManipulatorDragAction(xa.ALL,ya)).next(ya=>{this._updateTranslateObjectTooltip(K.ManipulationType.XY,ya);return ya}).next(ya=>{"end"===ya.action&&(this._resetTooltip(),ia=F.removeMaybe(ia))});Aa.next(()=>this._onDragCancel(!0,()=>ia=F.removeMaybe(ia)))}));this._objectMoveManipulation.forEachManipulator(ja=>
this._manipulatorHandles.add(this._watchAndUpdateGrabState(ja,!1)))}else this._objectMoveManipulation.forEachManipulator(ia=>{ia.grabbable=!1;ia.cursor=null});this._objectMoveManipulation.forEachManipulator(ia=>this._manipulatorHandles.add(ia.events.on("immediate-click",ja=>{this._manipulatorInfos.some(va=>va.manipulator.selected)?this._clearSelection():this.events.emit("immediate-click",{...ja,object:this.object});ja.stopPropagation()})))}}_createMoveManipulation(P){const {object:X,tool:Z,view:da,
_operations:ia}=this;if(ia){this._moveManipulation=new K.MoveManipulation({tool:Z,view:da,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&J.canMoveZOperations(X.operations,X.elevationInfo),snapToScene:!1,radius:K.MoveManipulation.radiusForSymbol(X.graphic?.symbol)});this._moveManipulation.forEachManipulator(va=>this.addHandles([va.events.on("immediate-click",Aa=>{this._moveManipulation.zManipulation.hasManipulator(va)||this._manipulatorInfos.some(ya=>ya.manipulator.selected)||this.events.emit("immediate-click",
{...Aa,object:this.object});Aa.stopPropagation()}),this._watchAndUpdateGrabState(va,!1)]));var ja=va=>Aa=>{this.addHandles([Aa.events.on("focus-changed",({action:ya})=>{"focus"===ya?this._updateTranslateTooltip(va):this._resetTooltip()})])};this._moveManipulation.xyManipulation.forEachManipulator(ja(K.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(ja(K.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(ja(K.ManipulationType.Z));this._moveManipulation.elevationInfo=
{mode:"absolute-height",offset:0};this.addHandles([this._moveManipulation.createDragPipeline((va,Aa,ya,Q,S)=>{const {snappingStep:na,cancelSnapping:qa}=la.createSnapDragEventPipelineStep({predicate:wa=>!!wa.info,snappingManager:Z.snappingManager,snappingContext:new ca.SnappingContext({editGeometryOperations:ia,elevationInfo:P,pointer:S,excludeFeature:X.graphic,visualizer:new p.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});Q=Q.next(wa=>{this._onDragCancel();return wa}).next(qa);
ya=ya.next(wa=>this._trackNumDragging(wa)).next(wa=>{const za=this._manipulatorInfos.filter(Ba=>"vertex"===Ba.type&&Ba.manipulator.selected);return wa.manipulatorType===I.ManipulatorType.TRANSLATE_XY&&1===za.length?{...wa,info:za[0],snapOrigin:za[0].handle.pos}:wa}).next(R.sceneSnappingAtLocation(this.view,P,X.graphic??void 0)).next(...na).next(R.addMapDelta()).next(wa=>this._perObjectManipulatorDragAction(xa.SELECTED_OR_ALL,wa)).next(wa=>{this._updateTranslateTooltip(va,wa);return wa});return{steps:ya,
cancel:Q}},P,ia.data.spatialReference,X.graphic),E.watch(()=>X.visible,()=>this._updateMoveManipulationPosition(),E.initial),X.on("committed",()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()}),E.watch(()=>X.isDraped,va=>{this._updateMoveManipulationPosition();va?this.addHandles(this.view.elevationProvider.on("elevation-change",()=>this._updateMoveManipulationPosition()),"align-move-manipulation"):this.removeHandles("align-move-manipulation")},E.initial)])}}_createVisualElements(){const {object:P,
view:X}=this,Z=M.createVisualElements({view:X,object:P,forEachManipulator:ia=>{if(!this.destroyed&&!this._recreatingManipulators){this._objectMoveManipulation.forEachManipulator(ia);this._moveManipulation.forEachManipulator(ia);for(const ja of this._manipulatorInfos)ia(ja.manipulator,I.ManipulatorType.TRANSLATE_XY)}},onManipulatorsChanged:ia=>this.events.on("manipulators-changed",ia)});null!=Z&&(this._outlineVisualElement=Z.visualElement instanceof ea.OutlineVisualElement?Z.visualElement:null);const da=
this._outlineVisualElement;if(null!=da){const ia=()=>{P.isDraped||this._updateMoveManipulationPosition()};this._manipulatorHandles.add(E.on(()=>da.events,"attachment-origin-changed",ia,{onListenerAdd:ia}))}this._manipulatorHandles.add(Z)}_createEdgeOffsetManipulator(P,X=this.object.elevationInfo){var Z=this.view;const da=this._operations;if(2>=P.component.vertices.length||!da)return null;const ia=da.data.spatialReference,ja=this._settings.manipulators.edgeOffset;var va=ja.size/2,Aa=va+ja.collisionPadding,
ya=va/Aa;va=ya/2;ya=ya*Math.sqrt(3)/2;const {height:Q,offset:S}=ja,na=this._edgeOffsetManipulatorMaterial;this._edgeOffsetManipulatorGeometryInside||(this._edgeOffsetManipulatorGeometryInside=Y.createExtrudedTriangle(na,ya,va,va,Q,S));this._edgeOffsetManipulatorGeometryOutside||(this._edgeOffsetManipulatorGeometryOutside=Y.createExtrudedTriangle(na,-ya,va,va,Q,-S));va=[new d.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate(),T.ManipulatorStateFlags.Unfocused),new d.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),
T.ManipulatorStateFlags.Focused),new d.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate(),T.ManipulatorStateFlags.Unfocused),new d.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),T.ManipulatorStateFlags.Focused)];Aa=new h.Manipulator3D({view:Z,renderObjects:va,elevationInfo:"on-the-ground"!==X.mode||C.isVolumetricSymbol(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:X,worldOriented:!1,focusMultiplier:1,
radius:Aa,available:this.object.visible,collisionType:{type:"disc",direction:r.fromValues(0,0,1)},collisionPriority:1,metadata:{deleting:!1},location:ka(ia)});Z=new h.Manipulator3D({view:Z,worldSized:!0,worldOriented:!1,available:this.object.visible,collisionPriority:-10,cursor:this.enableMoveObject?"move":"default",metadata:{deleting:!1},location:ka(ia)});const qa={manipulator:Aa,handle:P,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:Z,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(qa,
ja.minSquaredEdgeLength);const wa=()=>this._updateEdgeOffsetManipulator(qa);wa();qa.locationUpdateHandle=t.handlesGroup([P.leftVertex,P.rightVertex].map(za=>this._getManipulatorInfoFromHandle(za)?.manipulator.events.on("location-update",wa)));P=za=>{this._manipulatorInfos.some(Ba=>Ba.manipulator.selected)?this._clearSelection():this.events.emit("immediate-click",{...za,object:this.object});za.stopPropagation()};this._manipulatorHandles.add([qa.locationUpdateHandle,this._watchAndUpdateGrabState(Aa,
!0),this._watchAndUpdateGrabState(Z,!0),R.createManipulatorDragEventPipeline(Aa,this._createEdgeOffsetPipeline(qa,X,da)),R.createManipulatorDragEventPipeline(Z,this._createEdgePipeline(qa,X,da)),Z.events.on("immediate-click",P),Aa.events.on("immediate-click",P),Aa.events.on("focus-changed",()=>this._resetTooltip()),Aa.events.on("grab-changed",({screenPoint:za,action:Ba})=>{qa.grabMapPoint="start"===Ba?U.getMapPointAtEdgeOffsetManipulatorElevation(za,this.view,this.object,qa):null})],Aa);this._manipulatorInfos.push(qa);
this.manipulators.addMany([Aa,Z]);this.events.emit("manipulators-changed");return qa}_autoHideEdgeOffsetManipulator(P,X){const Z=P.manipulator,da=P.edgeManipulator,ia=()=>{P.visibilityHandle=F.removeMaybe(P.visibilityHandle);var ja=this._getManipulatorInfoFromHandle(P.handle.leftVertex);const va=this._getManipulatorInfoFromHandle(P.handle.rightVertex);ja=null!=ja&&null!=va&&U.screenEdgeLengthSquared(ja.manipulator.renderLocation,va.manipulator.renderLocation,this.view.state.camera)<X;if(!Z.focused&&
!da.focused||ja)Z.grabbable=!ja,da.grabbable=!ja,P.visibilityHandle=t.handlesGroup([Z.disableDisplay(),t.makeHandle(()=>{Z.grabbable=!0;da.grabbable=this.enableMoveObject})])};this._manipulatorHandles.add([Z.events.on("focus-changed",ia),da.events.on("focus-changed",ia),t.makeHandle(()=>{F.removeMaybe(P.visibilityHandle);da.metadata.deleting=!0;this.manipulators.remove(da)})],Z);ia()}_updateEdgeOffsetManipulator(P){if(this._operations){this._updateManipulatorPosition(P);var {coordinateHelper:X}=this._operations.data;
X=U.createEdgeOffsetIntersectionPlane(this.view,P.manipulator.elevationAlignedLocation,U.createEdgeOffsetOperation(X,P.handle,P.manipulator.elevationInfo));var Z=this._getManipulatorInfoFromHandle(P.handle.leftVertex),da=this._getManipulatorInfoFromHandle(P.handle.rightVertex);null!=Z&&null!=da&&(Z=Z.manipulator.renderLocation,da=da.manipulator.renderLocation,X=null!=X?U.edgeOffsetRotationMatrix(X,Z,da):m.IDENTITY,P.manipulator.modelTransform=X,P.edgeManipulator.elevationAlignedLocation=P.manipulator.elevationAlignedLocation,
P.edgeManipulator.modelTransform=X,X=l.length(l.subtract(ta,Z,da))/2,P.edgeManipulator.collisionType={type:"line",paths:[[[-X,0,0],[X,0,0]]]})}}_createEdgePipeline(P,X,Z){return(da,ia,ja,va)=>{if("touch"===va)this._createEdgeOffsetPipeline(P,X,Z)(da,ia,ja);else if(this.enableMoveObject){va=this.object.graphic;const Aa=Z.data.spatialReference,{elevationAlignedLocation:ya}=da;ia.next(Q=>this._trackNumDragging(Q)).next(R.dragAtLocation(this.view,ya)).next(A.screenToMapXYAtLocation(this.view,ya,X,Aa,
va)).next(R.addScreenDelta()).next(R.addMapDelta()).next(Q=>this._perObjectManipulatorDragAction(xa.ALL,Q)).next(Q=>{this._updateTranslateObjectTooltip(K.ManipulationType.XY,Q);return Q}).next(Q=>{"end"===Q.action&&this._resetTooltip()});ja.next(()=>this._onDragCancel(!da.metadata.deleting))}}}_createEdgeOffsetPipeline(P,X,Z){return(da,ia,ja)=>{const va=this._pendingEdgeOffsetInfo;if(va?.manipulatorInfo===P&&"drag"!==va.mode)ja.execute({action:"cancel"});else{this._clearSelection();var {initializeStep:Aa,
cleanup:ya}=this._initializeEdgeOffset(P,X,Z,ja),Q=this._applyEdgeOffsetStep(P);ia.next(S=>this._trackNumDragging(S)).next(R.dragAtLocation(this.view,da.elevationAlignedLocation)).next(Aa).next(A.screenToRenderPlaneFromEvent(this.view)).next(A.convertToMapCoordinates(this.view,Z.data.spatialReference)).next(R.addMapDelta()).next(ua()).next(S=>this._pendingEdgeOffsetInfo?S:Q(S)).next(S=>{"end"!==S.action||this._pendingEdgeOffsetInfo||ya()});ja.next(()=>{this._exitEdgeOffsetInputMode();da.metadata.deleting||
(ya(),this._onDragCancel())})}}}_initializeEdgeOffset(P,X,Z,da){const {view:ia,object:ja}=this,va=U.createEdgeOffsetOperation(Z.data.coordinateHelper,P.handle,X),Aa=Z.createUndoGroup(),ya=U.createEdgeOffsetIntersectionPlane(ia,P.manipulator.elevationAlignedLocation,va);this._splitEdgesBeforeEdgeOffset(P,va);this._selectEdgeOffsetArrow(P,va);let Q;const S=()=>{this._cleanEdgeOffsetCollapsedEdges(P,Z);Q=F.removeMaybe(Q)},na=this.events.on("undo",S);Q=t.handlesGroup([this._initializeEdgeOffsetVisualElement(P,
ja,X,Z),Aa,na,this._connectEdgeOffsetTooltip(P,va,Z,()=>{da.execute({action:"cancel"})})]);return{initializeStep:qa=>null==va||null==ya?(S(),null):{...qa,operation:va,plane:ya},cleanup:S}}_initializeEdgeOffsetVisualElement(P,X,Z,da){const ia=()=>new D({paths:[[P.handle.leftVertex.pos,P.handle.rightVertex.pos]],spatialReference:da.data.spatialReference}),ja=new ea.OutlineVisualElement({view:this.view,isDraped:X.isDraped,geometry:ia(),elevationInfo:Z,width:this._settings.visualElements.lineObjects.outline.width,
attached:!1,isDecoration:!0});Z=t.handlesGroup([E.watch(()=>({color:this._accentColor,draped:X.isDraped}),({color:va,draped:Aa})=>{ja.color=e.unitRGBAFromColor(va);ja.isDraped=Aa},E.syncAndInitial),X.on("committed",()=>{ja.geometry=ia()}),t.destroyHandle(ja)]);ja.attached=!0;return Z}_applyEdgeOffsetStep(P){return X=>{if(this.destroyed||null==X.operation||!this._operations)return X;this._updateEventState(ma.RESHAPING);if(null==X.signedDistance)this._resetTooltip();else{if(X.mapDeltaX||X.mapDeltaY||
X.mapDeltaZ)this._offsetEdge(P,X.operation,X.signedDistance),this.events.emit("reshape",{type:"reshape",object:this.object});this._updateEdgeOffsetTooltip(X)}return X}}_cleanEdgeOffsetCollapsedEdges(P,X){var Z=P.handle.leftVertex.leftEdge?.leftVertex,da=P.handle.leftVertex;const ia=P.handle.rightVertex.rightEdge?.rightVertex;P=P.handle.rightVertex;const ja=X.data.coordinateHelper,va=this.view.pixelSizeAt(ja.vectorToDehydratedPoint(da.pos),ja.spatialReference);X=[];Z&&1E-6>ja.distance(Z.pos,da.pos)&&
(Z=this._getManipulatorInfoFromHandle(da),null!=Z&&X.push(Z));if(ja.distance(da.pos,P.pos)<va||ia&&1E-6>ja.distance(ia.pos,P.pos))da=this._getManipulatorInfoFromHandle(P),null!=da&&X.push(da);X.length&&this._removeVertices(X)}_enterInputModeDuringEdgeOffset(P){const X=this._findActiveEdgeOffsetManipulatorInfo();if(!X)return!1;if(sa.enterInputModeIfAvailable(P,this.tooltip)){if(X.manipulator.dragging)return this._pendingEdgeOffsetInfo={manipulatorInfo:X,mode:"drag"},!0;this._clearSelection();this._pendingEdgeOffsetInfo=
{manipulatorInfo:X,mode:"hover"};this._connectEdgeOffsetTooltipOnHover(X);return!0}return!1}_exitEdgeOffsetInputMode(){this.tooltip&&(this._pendingEdgeOffsetInfo=null,this._resetTooltip(),this.tooltip.exitInputMode())}_findActiveEdgeOffsetManipulatorInfo(){return this._manipulatorInfos.filter(W).find(({manipulator:P})=>P.hovering||P.grabbing||P.dragging)}_connectEdgeOffsetTooltipOnHover(P){const {_operations:X,object:Z}=this;if(X){var {elevationInfo:da}=Z,ia=U.createEdgeOffsetOperation(X.data.coordinateHelper,
P.handle,da);this._selectEdgeOffsetArrow(P,ia);this.addHandles([this._initializeEdgeOffsetVisualElement(P,Z,da,X),this._connectEdgeOffsetTooltip(P,ia,X,()=>{this.removeHandles(ia);this._exitEdgeOffsetInputMode()})],ia)}}_splitEdgesBeforeEdgeOffset(P,X){if(X.requiresSplitEdgeLeft){const Z=this._getManipulatorInfoFromHandle(P.handle.leftVertex.leftEdge);null!=Z&&this._splitEdgeManipulator(Z,1)}X.requiresSplitEdgeRight&&(P=this._getManipulatorInfoFromHandle(P.handle.rightVertex.rightEdge),null!=P&&this._splitEdgeManipulator(P,
0))}_selectEdgeOffsetArrow(P,X){(P=P.grabMapPoint??U.getMapPointAtEdgeOffsetManipulatorElevation(this.view.inputManager?.latestPointerLocation,this.view,this.object,P))&&X.selectArrowFromStartPoint(P)}_connectEdgeOffsetTooltip(P,X,Z,da){const ia=()=>this.tooltipInfos.edgeOffset.distance.actual,ja=va=>{da();queueMicrotask(()=>{this.view.focus();const Aa=Z.createUndoGroup();this._tooltipCallbacks.onReshapeStart?.();this._splitEdgesBeforeEdgeOffset(P,X);this._offsetEdge(P,X,U.getDistanceInGeometrySR(va,
P.manipulator.location,X,Z));this._tooltipCallbacks.onReshape?.();this._tooltipCallbacks.onReshapeStop?.();this._cleanEdgeOffsetCollapsedEdges(P,Z);Aa.remove()})};return t.handlesGroup([E.when(()=>this.tooltip&&!this.tooltip.focused,()=>{const va=ia();null!=va?ja(va):da()},E.sync),this.tooltip.on("discard",da),this.tooltip.on("commit",va=>{"commit-and-exit"===va.type&&(va=ia(),null!=va?ja(va):da())})])}_createVertexOrEdgeManipulator(P,X=this.object.elevationInfo,Z=!1){const da=this.view,ia=this._operations;
var ja=this._settings;if(!ia)return null;const va=ia.data.type,Aa=ia.data.spatialReference;if("edge"===P.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(P,X);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const {size:S,outlineSize:na}=ha(ja.manipulators.vertex);this._vertexManipulatorGeometry=Y.createSphereGeometry(this._vertexManipulatorMaterial,S,16,16);this._vertexManipulatorOutlineGeometry=Y.createSphereGeometry(this._vertexManipulatorOutlineMaterial,
na,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const {size:S,outlineSize:na}=ha(ja.manipulators.edge);this._edgeManipulatorGeometry=Y.createSphereGeometry(this._edgeManipulatorMaterial,S,16,16);this._edgeManipulatorOutlineGeometry=Y.createSphereGeometry(this._edgeManipulatorOutlineMaterial,na,16,16)}ja="point"===va||"mesh"===va?[]:[new d.RenderObject(this._vertexManipulatorGeometry.instantiate(),pa.Vertex|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate(),
pa.Vertex|T.ManipulatorStateFlags.Unfocused|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),pa.Vertex|T.ManipulatorStateFlags.Focused|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),T.ManipulatorStateFlags.Selected),new d.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),
T.ManipulatorStateFlags.Selected|T.ManipulatorStateFlags.Unfocused),new d.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),T.ManipulatorStateFlags.Selected|T.ManipulatorStateFlags.Focused)];this.enableMidpoints&&ja.push(new d.RenderObject(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),pa.Edge|T.ManipulatorStateFlags.Focused|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),
pa.Edge|T.ManipulatorStateFlags.Focused|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._edgeManipulatorGeometry.instantiate(),pa.Edge|T.ManipulatorStateFlags.Unfocused|T.ManipulatorStateFlags.Unselected),new d.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate(),pa.Edge|T.ManipulatorStateFlags.Unfocused|T.ManipulatorStateFlags.Unselected));ja=new h.Manipulator3D({view:da,renderObjects:ja,elevationInfo:X,focusMultiplier:1,touchMultiplier:1,available:this.object.visible,metadata:{deleting:!1},
location:ka(Aa)});ja.selected=Z;this._setTypeSpecificManipulatorSettings(ja,P,X);const ya="edge"===P.type?{manipulator:ja,handle:P,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:ja,handle:P,type:"vertex",selectedIndex:0};this._manipulatorInfos.push(ya);this.manipulators.add(ja);this._updateManipulatorPosition(ya);if("edge"===ya.type){P=[];for(var Q of[ya.handle.leftVertex,ya.handle.rightVertex])Z=this._getManipulatorInfoFromHandle(Q),null!=Z&&P.push(Z.manipulator.events.on("location-update",
()=>this._updateManipulatorPosition(ya)));ya.locationUpdateHandle=t.handlesGroup(P);this._manipulatorHandles.add(ya.locationUpdateHandle,ja)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(ja,!0),ja);Q=R.createManipulatorDragEventPipeline(ja,(S,na,qa,wa)=>{let za=null;const {snappingStep:Ba,cancelSnapping:Ea}=la.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new ca.SnappingContext({editGeometryOperations:ia,
elevationInfo:X,pointer:wa,excludeFeature:this.object.graphic,visualizer:new p.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});qa=qa.next(Ca=>{this._onDragCancel(!S.metadata.deleting,()=>za=F.removeMaybe(za));return Ca}).next(Ea);({elevationAlignedLocation:qa}=S);wa=this.object.graphic??void 0;na.next(Ca=>this._trackNumDragging(Ca)).next(Ca=>{"start"===Ca.action&&ia&&(za=ia.createUndoGroup());if("edge"===ya.type){const Ga=this._splitEdgeManipulator(ya);return{...Ca,info:Ga,
snapOrigin:Ga.handle.pos}}return{...Ca,info:ya,snapOrigin:ya.handle.pos}}).next(R.dragAtLocation(da,qa)).next(A.screenToMapXYAtLocation(da,qa,X,Aa,wa)).next(R.sceneSnappingAtLocation(da,X,wa)).next(...Ba).next(R.addMapDelta()).next(Ca=>{this._perVertexManipulatorDragAction(Ca);"end"===Ca.action&&(za=F.removeMaybe(za));this._resetTooltip()})});this._manipulatorHandles.add([Q,ja.events.on("immediate-click",S=>this._manipulatorClickCallback(S,ya)),ja.events.on("select-changed",()=>{ya.selectedIndex=
++this._selectedIndex;this._updateMoveManipulationPosition();this._resetTooltip()}),ja.events.on("focus-changed",()=>{this._resetTooltip()})],ja);this.events.emit("manipulators-changed");return ya}_trackNumDragging(P){switch(P.action){case "start":this._numDragging++;break;case "end":this._numDragging--}return P}_onDragCancel(P=!0,X){this._numDragging--;P&&this.undo();this.tool.snappingManager?.doneSnapping();this._resetTooltip();switch(this._reshapeEventState){case ma.MOVING:this.events.emit("move",
{type:"move",dx:0,dy:0,object:this.object});break;case ma.RESHAPING:this.events.emit("reshape",{type:"reshape",object:this.object})}X?.();this.destroyed||this._updateEventState(ma.NONE)}_setTypeSpecificManipulatorSettings(P,X,Z){const da=this._settings;switch(X.type){case "vertex":P.state=pa.Vertex;P.selectable=!0;P.cursor="move";P.collisionPriority=2;const {size:ia,collisionPadding:ja}=da.manipulators.vertex;P.radius=ia/2+ja;P.elevationInfo=Z;X=this._operations?.data.type;P.interactive=null!=X&&
"point"!==X&&"mesh"!==X;break;case "edge":P.state=pa.Edge;P.selectable=!1;P.cursor="copy";P.collisionPriority=-1;const {size:va,collisionPadding:Aa}=da.manipulators.edge;P.radius=va/2+Aa;P.elevationInfo="on-the-ground"!==Z.mode||C.isVolumetricSymbol(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:Z}}_watchAndUpdateGrabState(P,X){return P.events.on("grab-changed",Z=>{this._onGrabStateChanged(P,X,Z.action,Z.pointerType)})}_onGrabStateChanged(P,X,Z,da="mouse"){if(!this._recreatingManipulators){if("start"===
Z)X&&this._updateSelection(P),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(ma.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing;if("touch"!==da||this.enableEdgeOffset)this._manipulatorInfos.forEach(ia=>{const {manipulator:ja}=ia,va=this._operations?.data.type;ja.interactive=ja.grabbing||!this._numGrabbing&&null!=va&&"point"!==va&&"mesh"!==va;W(ia)&&(ia.edgeManipulator.interactive=ia.edgeManipulator.grabbing||!this._numGrabbing)}),this._objectMoveManipulation.forEachManipulator(ia=>
{ia.interactive=ia.grabbing||!this._numGrabbing})}}_clearSelection(){for(const P of this._manipulatorInfos)P.manipulator.grabbing||(P.manipulator.selected=!1);this._pendingEdgeOffsetInfo=null}_updateSelection(P){P.grabbing&&!P.selected&&P.selectable&&(this._clearSelection(),P.selected=!0,this.events.emit("manipulators-changed"))}_removeManipulator(P){null!=P&&(P.manipulator.metadata.deleting=!0,this.manipulators.remove(P.manipulator),this._manipulatorHandles.remove(P.manipulator),f.removeUnordered(this._manipulatorInfos,
P),this.events.emit("manipulators-changed"),this._resetTooltip())}_getManipulatorInfoFromHandle(P){if(P)for(const X of this._manipulatorInfos)if(P===X.handle)return X;return null}_updateManipulatorPositions(P){for(const X of P)this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(X))}_updateManipulatorPosition(P){const X=this._operations;if(null!=P&&X)if("vertex"===P.type)P.manipulator.location=X.data.coordinateHelper.vectorToDehydratedPoint(P.handle.pos,oa),P.manipulator.grabbing&&null!=
this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=P.manipulator.renderLocation);else if("edge"===P.type){var Z=this._getManipulatorInfoFromHandle(P.handle.leftVertex),da=this._getManipulatorInfoFromHandle(P.handle.rightVertex);null!=Z&&null!=da&&(Z=Z.manipulator,da=da.manipulator,"on-the-ground"===P.manipulator.elevationInfo?.mode?(Z=Z.location,da=da.location,P.manipulator.location=x.makeDehydratedPoint(Z.x+.5*(da.x-Z.x),Z.y+.5*(da.y-
Z.y),Z.hasZ&&da.hasZ?0:void 0,X.data.spatialReference)):(l.lerp(ta,Z.renderLocation,da.renderLocation,.5),P.manipulator.renderLocation=ta))}}_splitEdgeManipulator(P,X=.5){var Z=this._operations;X=Z.splitEdge(P.handle,X).createdVertex;P.locationUpdateHandle=F.removeMaybe(P.locationUpdateHandle);var da=this.object.elevationInfo;let ia;this.enableEdgeOffset?(this._removeManipulator(P),ia=this._createVertexOrEdgeManipulator(X)):(ia=P,ia.handle=X,ia.type="vertex",this._setTypeSpecificManipulatorSettings(P.manipulator,
P.handle,da));X.leftEdge&&this._createVertexOrEdgeManipulator(X.leftEdge);X.rightEdge&&this._createVertexOrEdgeManipulator(X.rightEdge);this._updateManipulatorPosition(ia);this.enableEdgeOffset||this._resetTooltip();this._updateSelection(P.manipulator);P=this._updateEventState(ma.RESHAPING);da=Z.data.coordinateHelper.vectorToArray(ia.handle.pos);Z=Z.data.components.indexOf(X.component);this.events.emit("vertex-add",{type:"vertex-add",object:this.object,vertices:[{coordinates:da,componentIndex:Z,vertexIndex:X.index}],
added:da});P&&this._updateEventState(ma.NONE);return ia}_updateMoveManipulationPosition(){const P=l.set(ta,0,0,0);let X=0,Z=!1;var da=null;let ia=null;for(var ja of this._manipulatorInfos)if("vertex"===ja.type)if(ja.manipulator.selected)if(X++,l.add(P,P,ja.manipulator.renderLocation),null==da||ja.selectedIndex>da.selectedIndex)ia=da,da=ja;else{if(null==ia||ja.selectedIndex>ia.selectedIndex)ia=ja}else Z=!0;ja=this.object;var va=this._operations?.data.geometry;if(0===X)da=ja.visible&&this.enableMoveObject,
this._moveManipulation.xyManipulation.available=da,this._moveManipulation.xyAxisManipulation.available=da,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=da,this._moveManipulation.zManipulation.available=da&&this.enableZShape&&J.canMoveZOperations(this._operations,ja.elevationInfo),this._moveManipulation.angle=G.orientation(va),this._moveManipulation.radius=K.MoveManipulation.radiusForSymbol(ja.graphic?.symbol);else{ja=ja.visible;this._moveManipulation.xyManipulation.available=ja;this._moveManipulation.xyAxisManipulation.available=
ja;this._moveManipulation.zManipulation.available=ja&&this.enableZVertex&&J.canMoveZOperations(this._operations,this.object.elevationInfo);this._moveManipulation.xyAxisManipulation.orthogonalAvailable=ja&&1!==X;ja=0;if(null!=da){va=da.handle.pos;const Aa=null!=ia?ia.handle.pos:da.handle.leftEdge?.leftVertex?da.handle.leftEdge.leftVertex.pos:null;da=null==ia&&da.handle.rightEdge?.rightVertex?da.handle.rightEdge.rightVertex.pos:null;Aa&&da?this._moveManipulation.xyAxisManipulation.available=!1:Aa?ja=
Math.atan2(va[1]-Aa[1],va[0]-Aa[0])+Math.PI/2:da&&(ja=Math.atan2(da[1]-va[1],da[0]-va[0])+Math.PI/2)}this._moveManipulation.angle=ja;this._moveManipulation.radius=N.discRadiusSmall}0!==X&&Z?(l.scale(P,P,1/X),oa.spatialReference=this._operations.data.spatialReference,oa.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(P,oa),this._moveManipulation.elevationAlignedLocation=oa):null==this._outlineVisualElement||this.object.isDraped||null==this._outlineVisualElement.attachmentOrigin?y.placeAtObject(this._moveManipulation,
this.object):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(P){var X=[];const Z=this._operations;if(Z){for(var da of P)if(P=da.handle.component,"vertex"===da.type&&Z.canRemoveVertex(P)){X.push(da.handle);this._removeManipulator(da);this._removeManipulator(this._getManipulatorInfoFromHandle(da.handle.leftEdge));this._removeManipulator(this._getManipulatorInfoFromHandle(da.handle.rightEdge));const ia=Z.removeVertices([da.handle]).removedVertices?.[0].createdEdge;
ia?this._createVertexOrEdgeManipulator(ia):this.enableEdgeOffset&&2>=P.vertices.length&&this._removeManipulator(this._getManipulatorInfoFromHandle(P.edges[0]))}if(0<X.length&&(X=X.map(ia=>{const ja=Z.data.components.indexOf(ia.component);return{coordinates:Z.data.coordinateHelper.vectorToArray(ia.pos),componentIndex:ja,vertexIndex:ia.index}}),da=this._updateEventState(ma.RESHAPING),!this.destroyed&&(this.events.emit("vertex-remove",{type:"vertex-remove",object:this.object,removed:X.map(ia=>ia.coordinates),
vertices:X}),!this.destroyed))){if(da&&(this._updateEventState(ma.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}}_moveVertices(P,X,Z="start"===X.action?ba.AccumulationBehavior.NEW_STEP:ba.AccumulationBehavior.ACCUMULATE_STEPS){const da=this._operations;if(da){0<P.length&&da.moveVertices(P.map(ia=>ia.handle),X.mapDeltaX,X.mapDeltaY,X.mapDeltaZ,Z);for(const ia of P)this._updateManipulatorPosition(ia)}}_offsetEdge(P,X,Z){this._operations&&(X=X.clone(),X.distance=Z,this._operations.updateVertices([P.handle.leftVertex,
P.handle.rightVertex],X),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(P.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(P.handle.rightVertex)))}_manipulatorClickCallback(P,X){P.shiftKey||this._clearSelection();"vertex"===X.type&&(X.manipulator.selected=!X.manipulator.selected,this.enableDeleteVertices&&P.button===ra.MouseButton.Right&&this._removeVertices([X]));"edge"===X.type&&P.button===ra.MouseButton.Left&&this._splitEdgeManipulator(X);
P.stopPropagation()}_updateTranslateTooltip(P,X){null!=this._defaultTooltipInfo?this._resetTooltip():this._updateTranslateObjectTooltip(P,X)}_updateTranslateObjectTooltip(P,X){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=V.getUpdatedTranslateObjectTooltipInfo(P,X,this._tooltipsContext))}_updateEdgeOffsetTooltip(P){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=V.getUpdatedEdgeOffsetTooltipInfo(this.object,P,this._tooltipsContext))}_resetTooltip(){const P=this.activeTooltipInfo;if(!this._pendingEdgeOffsetInfo||
"reshape-edge-offset"!==P?.type){var X=null;X=this._pendingEdgeOffsetInfo||null!=this._findActiveEdgeOffsetManipulatorInfo()?V.getUpdatedEdgeOffsetTooltipInfo(this.object,null,this._tooltipsContext):this._defaultTooltipInfo;X===P||null!=P&&null!=X&&"input"===this.tooltip.mode||(this.activeTooltipInfo=X)}}get _defaultTooltipInfo(){switch(this._operations?.data.type){case "polyline":case "polygon":return this._selectedVertexManipulatorInfo?this.tooltipInfos.selectedVertex:null;case "point":case "mesh":return this.tooltipInfos.movePoint;
default:return null}}get _selectedVertexManipulatorInfo(){const P=this._manipulatorInfos.filter(X=>"vertex"===X.type&&X.manipulator.selected);return 1===P.length?P[0]:null}get _tooltipsContext(){return{sketchOptions:this._sketchOptions,tooltipInfos:this.tooltipInfos,activeTooltipInfo:this.activeTooltipInfo,selectedVertexManipulatorInfo:this._selectedVertexManipulatorInfo,callbacks:this._tooltipCallbacks}}get test(){}};b.__decorate([q.property()],a.ReshapeOperation.prototype,"_numGrabbing",void 0);
b.__decorate([q.property()],a.ReshapeOperation.prototype,"_numDragging",void 0);b.__decorate([q.property()],a.ReshapeOperation.prototype,"_pendingEdgeOffsetInfo",void 0);b.__decorate([q.property()],a.ReshapeOperation.prototype,"_operations",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"_segmentLabels",void 0);b.__decorate([q.property({constructOnly:!0})],a.ReshapeOperation.prototype,"tool",void 0);b.__decorate([q.property()],a.ReshapeOperation.prototype,"tooltip",void 0);b.__decorate([q.property()],
a.ReshapeOperation.prototype,"activeTooltipInfo",void 0);b.__decorate([q.property({readOnly:!0})],a.ReshapeOperation.prototype,"updating",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"manipulators",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"view",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"object",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableZShape",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableDeleteVertices",
null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableZVertex",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"autoHideManipulators",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableMoveObject",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableMidpoints",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"enableEdgeOffset",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"_sketchOptions",null);b.__decorate([q.property()],
a.ReshapeOperation.prototype,"_accentColor",null);b.__decorate([q.property()],a.ReshapeOperation.prototype,"_tooltipsContext",null);a.ReshapeOperation=b.__decorate([k.subclass("esri.views.3d.interactive.editingTools.reshape.ReshapeOperation")],a.ReshapeOperation);const oa=x.makeDehydratedPoint(0,0,void 0,w.WGS84),ta=r.create();var pa;(function(P){P.Vertex=T.ManipulatorStateCustomFlags.Custom1;P.Edge=T.ManipulatorStateCustomFlags.Custom2})(pa||={});var ma;(function(P){P[P.NONE=0]="NONE";P[P.MOVING=
1]="MOVING";P[P.RESHAPING=2]="RESHAPING"})(ma||={});var xa;(function(P){P[P.ALL=0]="ALL";P[P.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"})(xa||={});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/edgeOffsetUtils":function(){define("exports ../../../../../core/quantityUtils ../../../../../core/screenUtils ../../../../../core/unitUtils ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/projection ../../../../../geometry/projection/projectVectorToVector ../../../../../geometry/support/geodesicUtils ../../../../../geometry/support/plane ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../../../interactive/editGeometry/operations/OffsetEdgeVertex".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){function m(l,r,z){z=q.makeDehydratedPoint(r.x+z[0],r.y+z[1],r.z+z[2],r.spatialReference);const H=u.create(),D=u.create();return l.renderCoordsHelper.toRenderCoords(r,H)&&l.renderCoordsHelper.toRenderCoords(z,D)?n.direction(D,H,D):null}a.createEdgeOffsetIntersectionPlane=function(l,r,z){const H=u.create();if(!l.renderCoordsHelper.toRenderCoords(r,H))return null;var D=m(l,r,E.getNormal(z.plane));l=m(l,r,z.edgeDirection);if(null==D||null==l)return null;D=n.cross(u.create(),
D,l);return E.fromPositionAndNormal(H,D,E.create())};a.createEdgeOffsetOperation=function(l,r,z){return new k.OffsetEdgeVertex(l,"on-the-ground"===z.mode?k.PlaneType.XY:k.PlaneType.XYZ,r,0)};a.edgeOffsetRotationMatrix=function(l,r,z){l=E.getNormal(l);r=n.direction(u.create(),r,z);z=n.cross(u.create(),r,l);l=n.cross(u.create(),r,z);return e.fromValues(r[0],r[1],r[2],0,z[0],z[1],z[2],0,l[0],l[1],l[2],0,0,0,0,1)};a.getDistanceInGeometrySR=function(l,r,z,{data:{coordinateHelper:H,spatialReference:D}}){const w=
b.valueInUnit(l,"meters");var x=f.getMetersPerUnitForSR(D);const C=Math.sign(w*z.selectedArrow),h=F.geodesicCompatibleSpatialReference(D);l=E.getNormal(z.plane);const y=H.pointToXYZ(r);H=u.create();n.scaleAndAdd(H,y,l,10/x*C);z=w*z.selectedArrow/x;if(!h||!t.projectVectorToVector(y,D,y,h)||!t.projectVectorToVector(H,D,H,h))return z;x=new F.InverseGeodeticSolverResult;F.inverseGeodeticSolver(x,y,H,h);F.directGeodeticSolver(H,y,x.azimuth,w,h);if(!t.projectVectorToVector(H,h,H,D))return z;D=H[0]-r.x;
r=H[1]-r.y;r=Math.sqrt(D*D+r*r)*C;const [d,B]=l;l=Math.sqrt(d*d+B*B);return 0===l?0:r/l};a.getMapPointAtEdgeOffsetManipulatorElevation=function(l,r,z,H){const {elevationInfo:D,operations:w}=z;if(!w||!l)return null;z=c.getZForElevationMode(H.manipulator.elevationAlignedLocation,r,D);return(l=r.sceneIntersectionHelper.intersectElevationFromScreen(g.createScreenPointArray(l.x,l.y),D,z))&&v.projectPoint(l,l,w.data.spatialReference)?l:null};a.screenEdgeLengthSquared=function(l,r,z){l=z.projectToRenderScreen(l,
g.createRenderScreenPointArray3());r=z.projectToRenderScreen(r,g.createRenderScreenPointArray3());return null!=l&&null!=r?n.squaredLength(n.subtract(l,l,r)):0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshape/reshapeTooltipUtils3D":function(){define("exports ../../../../../core/handleUtils ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../manipulatedObjectUtils ../tooltipUtils3D ../manipulations/MoveManipulation ../manipulations/moveUtils ../../../../interactive/editGeometry/interfaces ../../../../interactive/tooltip/tooltipCommonUtils ../../../../interactive/tooltip/infos/MovePointTooltipInfo ../../../../interactive/tooltip/infos/ReshapeEdgeOffsetTooltipInfo ../../../../interactive/tooltip/infos/SelectedVertexTooltipInfo ../../../../interactive/tooltip/infos/TranslateTooltipInfo ../../../../interactive/tooltip/infos/TranslateXYTooltipInfo ../../../../interactive/tooltip/infos/TranslateZTooltipInfo ../../../../support/automaticAreaMeasurementUtils ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H){function D(C,{activeTooltipInfo:h,selectedVertexManipulatorInfo:y,callbacks:d}){if(h){d.onBeforeReshape();var B=e.manipulatedObjectGeometry(C);switch(B?.type){case "mesh":"move-point"===h.type&&n.updateXYZFromTooltipInfo(h,B.origin,C,d);break;case "point":"move-point"===h.type&&n.updateXYZFromTooltipInfo(h,B,C,d);break;case "polyline":case "polygon":if("selected-vertex"===h.type&&y){var {dx:p,dy:A,dz:G}=F.getXYZDeltasFromTooltipInfo(h,y.manipulator.location);
if(0!==p||0!==A||0!==G)d.onReshapeStart(),C.operations?.moveVertices([y.handle],p,A,G,t.AccumulationBehavior.NEW_STEP),d.onReshape(),d.onReshapeStop()}}}}function w(C,{activeTooltipInfo:h,selectedVertexManipulatorInfo:y,sketchOptions:d}){if(h)switch(h.sketchOptions=d,h?.type){case "move-point":n.updateTooltipInfoFromManipulatedObject(h,C);break;case "selected-vertex":if(h&&"selected-vertex"===h.type)switch(y=y?.manipulator.location,h.setLocationFromPoint(y),n.updateElevationFromPoint(h,y,C),C=C.operations?.data.geometry,
C?.type){case "polygon":h.geometryType="polygon";h.totalLength.visible=!1;h.area.actual=r.autoArea2D(C);break;case "polyline":h.geometryType="polyline",h.totalLength.actual=z.autoLength2D(C),h.area.visible=!1}}}function x(C,h,y){if(null!=h&&"end"!==h.action){const {mapStart:d,mapEnd:B}=h;h=y(d,B);C.distance=null!=h?h:g.zeroMeters}else C.distance=g.zeroMeters}a.connectTooltipToManipulatedObject=function(C,h,y){function d(){const G=y();return{...G,activeTooltipInfo:G.sketchOptions.tooltips.effectiveEnabled?
G.activeTooltipInfo:null}}function B(G){A||(A=!0,G(),A=!1)}function p(G){B(()=>{w(h,G);C.info=G.activeTooltipInfo})}let A=!1;return b.handlesGroup([f.watch(d,p,f.syncAndInitial),f.watch(()=>{const G=d(),{activeTooltipInfo:I}=G;if(I&&"key"in I)return{context:G,activeTooltipInfo:I,key:I.key,geometry:e.manipulatedObjectGeometry(h)}},(G,I)=>{G&&I&&I.key!==G.key&&B(()=>D(h,G.context))},f.sync),h.on("committed",()=>p(d())),F.connectPasteEvent(C,{onBeforePaste:()=>{A=!0},onAfterPaste:()=>{D(h,d());A=!1}})])};
a.createTooltipInfos=function(C,h){h=h?.type;return{edgeOffset:new q.ReshapeEdgeOffsetTooltipInfo({sketchOptions:C,viewType:h}),movePoint:new E.MovePointTooltipInfo({sketchOptions:C,viewType:h}),selectedVertex:new c.SelectedVertexTooltipInfo({sketchOptions:C,viewType:h}),translate:new k.TranslateTooltipInfo({sketchOptions:C,viewType:h}),translateXY:new m.TranslateXYTooltipInfo({sketchOptions:C,viewType:h}),translateZ:new l.TranslateZTooltipInfo({sketchOptions:C,viewType:h})}};a.getUpdatedEdgeOffsetTooltipInfo=
function({operations:C},h,{sketchOptions:y,tooltipInfos:d}){d=d.edgeOffset;d.distance.committed=null;if(null!=h&&null!=h.signedDistance&&"end"!==h.action&&null!=C){var B=C.data.coordinateHelper;const {start:p,end:A}=h.operation.clampedStartAndEnd(h.mapEnd);B=z.autoDistance2D(p,A,B.spatialReference);h=Math.sign(h.signedDistance*h.operation.selectedArrow);d.distance.actual=null!=B?g.scale(B,h):null}else d.distance.actual=g.zeroMeters;C=C?.data.geometry;d.area.actual=null;d.area.visible=!1;d.totalLength.actual=
null;d.totalLength.visible=!1;switch(C?.type){case "polygon":d.area.actual=r.autoArea2D(C);d.area.visible=!0;break;case "polyline":d.totalLength.actual=z.autoLength2D(C),d.totalLength.visible=!0}d.sketchOptions=y;return d};a.getUpdatedTranslateObjectTooltipInfo=function(C,h,{sketchOptions:y,tooltipInfos:d}){let B=null;switch(C){case u.ManipulationType.XY:B=d.translate;x(B,h,(p,A)=>z.autoDistanceBetweenPoints2D(p,A));break;case u.ManipulationType.XY_AXIS:B=d.translateXY;x(B,h,(p,A)=>g.scale(z.autoDistanceBetweenPoints2D(p,
A),v.axisConstrainedDragSign(h)));break;case u.ManipulationType.Z:B=d.translateZ,x(B,h,H.verticalSignedDistanceBetweenPoints)}B.sketchOptions=y;return B};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/ReshapeEdgeOffsetTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t){a.ReshapeEdgeOffsetTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="reshape-edge-offset";this.distance=v.makeRelativeDistanceField({lockable:!1});this.area=v.makeAreaField({visible:!1});this.totalLength=v.makeTotalLengthField({visible:!1})}get allFields(){return[this.distance,this.area,this.totalLength]}};b.__decorate([g.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"type",void 0);b.__decorate([g.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,
"distance",void 0);b.__decorate([g.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"area",void 0);b.__decorate([g.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"totalLength",void 0);b.__decorate([g.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"allFields",null);a.ReshapeEdgeOffsetTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.ReshapeEdgeOffsetTooltipInfo")],a.ReshapeEdgeOffsetTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/infos/SelectedVertexTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),function(a,b,g,f,e,n,u,v,t,F){a.SelectedVertexTooltipInfo=class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);
this.type="selected-vertex";this.area=v.makeAreaField();this.totalLength=v.makeTotalLengthField();this.geometryType="polyline";this.allFields.forEach(q=>{q.lockable=!1;q.setActual(null)})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,"polygon"===this.geometryType?this.area:this.totalLength]}};b.__decorate([g.property()],a.SelectedVertexTooltipInfo.prototype,"geometryType",void 0);b.__decorate([g.property()],a.SelectedVertexTooltipInfo.prototype,"allFields",null);
a.SelectedVertexTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.SelectedVertexTooltipInfo")],a.SelectedVertexTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/TransformTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/arrayUtils ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Point ../../../../ViewingMode ../../Manipulator3D ../../manipulatorUtils ../../SnappingVisualizer3D ../manipulatedObjectUtils ../manipulatorUtils ../meshFastUpdateUtils ../tooltipUtils3D ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ./ScaleRotateMeshAdapter ./ScaleRotateObjectSymbol3DAdapter ./ScaleRotateTransform ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/tooltipCommonUtils ../../../../interactive/tooltip/infos/TransformMeshTooltipInfo ../../../../interactive/tooltip/infos/TransformPointTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L,M,N,K){a.TransformTool3D=class extends A.InteractiveToolBase{constructor(O){super(O);this.events=new f;this.enableScaling=this.enableRotation=this.enableZ=!0;this.sketchOptions=new I;this.type="transform-3d";this._updatingHandles=new q.UpdatingHandles;this._scaleRotate=null}initialize(){const {events:O,object:U,view:V}=this;this.tooltip=M.makeTooltip(()=>({view:V,options:this.sketchOptions.tooltips}));this._moveManipulation=
new h.MoveManipulation({tool:this,view:V,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&H.canMoveZOperations(U.operations,U.elevationInfo),radius:h.MoveManipulation.radiusForSymbol(U.graphic?.symbol)});this._moveManipulation.forEachManipulator(aa=>this.addHandles(aa.events.on("immediate-click",ba=>{O.emit("immediate-click",{...ba,object:this.object});ba.stopPropagation()})));const ea=U.elevationInfo;this._moveManipulation.elevationInfo=ea;this.addHandles(D.meshTransformFastUpdateHandles(U));
this._moveManipulation.createManipulatedObjectDragPipeline((aa,ba,ca,la,sa)=>{if(aa===h.ManipulationType.XY){const {snappingStep:ua,cancelSnapping:ha}=L.createSnapDragEventPipelineStep({snappingContext:new J.SnappingContext({elevationInfo:ea,pointer:sa,editGeometryOperations:G.EditGeometryOperations.fromGeometry(new c({spatialReference:U.operations?.data.spatialReference}),V.state.viewingMode),visualizer:new r.SnappingVisualizer3D,excludeFeature:U.graphic}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,
useZ:!1});la=la.next(ha);ca=ca.next(p.sceneSnappingAtProjectedLocation(this.view,ea)).next(...ua)}return{steps:ca,cancel:la}},U,aa=>{const {action:ba,object:ca,dxScreen:la,dyScreen:sa}=aa;aa={object:ca,dxScreen:la,dyScreen:sa};switch(ba){case "start":this._emitRecordUndo();O.emit("translate-start",aa);break;case "update":O.emit("translate",aa);break;case "end":O.emit("translate-stop",aa)}});this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0;this._scaleRotateAdapter=this._createScaleRotateAdapter();
this.addHandles(v.watch(()=>this._scaleRotateAdapter.angle,()=>this._updateMoveAngle()));if(this.enableScaling||this.enableRotation)this._scaleRotate=new B.ScaleRotateTransform({tool:this,mode:this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate",adapter:this._scaleRotateAdapter,sketchOptions:this.sketchOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",()=>this._onScaleChanged()));this.addHandles([x.createVisualElements({view:this.view,object:U,forEachManipulator:aa=>
this._forEachManipulator(aa),onManipulatorsChanged:()=>e.makeHandle()}),U.on("committed",()=>this._onGeometryChanged()),this._hideManipulatorsForObjectState(),v.watch(()=>V.scale,()=>this._updateMoveAngle())].filter(g.isSome));this._onGeometryChanged();this._updateMoveAngle();this._forEachManipulator(aa=>{aa instanceof m.Manipulator3D&&this.addHandles(aa.events.on("grab-changed",()=>this._updateManipulatorsInteractive()))});const Y=V?.type,{sketchOptions:ra}=this;this._meshTooltipInfo=new N.TransformMeshTooltipInfo({viewType:Y,
sketchOptions:ra});this._pointTooltipInfo=new K.TransformPointTooltipInfo({viewType:Y,sketchOptions:ra});const R={object:U,dxScreen:0,dyScreen:0},T={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo();O.emit("translate-start",{...R})},onMove:()=>O.emit("translate",{...R}),onMoveStop:()=>O.emit("translate-stop",{...R}),onRotateStart:aa=>{this._emitRecordUndo();O.emit("rotate-start",{object:U,angle:aa})},onRotate:aa=>O.emit("rotate",{object:U,angle:aa}),onRotateStop:aa=>O.emit("rotate-stop",
{object:U,angle:aa}),onScaleStart:(aa,ba)=>{this._emitRecordUndo();O.emit("scale-start",{object:U,xScale:aa,yScale:ba})},onScale:(aa,ba)=>O.emit("scale",{object:U,xScale:aa,yScale:ba}),onScaleStop:(aa,ba)=>O.emit("scale-stop",{object:U,xScale:aa,yScale:ba})};this.addHandles(w.connectTooltipToManipulatedObject(this.tooltip,this.object,()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this.activeTooltipInfo,callbacks:T,scaleRotateTransform:this._scaleRotate})));this.finishToolCreation()}destroy(){this.tooltip.destroy();
this._moveManipulation.destroy();this._scaleRotate=u.destroyMaybe(this._scaleRotate);this._scaleRotateAdapter=u.destroyMaybe(this._scaleRotateAdapter);this._updatingHandles.destroy();this._set("view",null);this._set("object",null)}onInputEvent(O){if(!this.destroyed&&!M.enterInputModeIfAvailable(O,this.tooltip))return super.onInputEvent(O)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){const O=
z.manipulatedObjectGeometry(this.object);return"mesh"===O?.type?new y.ScaleRotateMeshAdapter({object:this.object,geometry:O,viewingMode:this.view.state.viewingMode}):new d.ScaleRotateObjectSymbol3DAdapter({graphic:this.object.graphic,sizeFilter:U=>this._enforceNonZeroSize(U),findLayerView:()=>this.view.allLayerViews.find(U=>U.layer===this.object.graphic?.layer),sizeAxis:this.sketchOptions?.tooltips?.visualVariables?.size?.axis??null})}_forEachManipulator(O){this._moveManipulation?.forEachManipulator(O);
this._scaleRotate?.forEachManipulator(O)}_hideManipulatorsForObjectState(){return v.watch(()=>this.object.visible,O=>{this._forEachManipulator(U=>U.available=O);this._moveManipulation.zManipulation.available=O&&this.enableZ&&H.canMoveZOperations(this.object.operations,this.object.elevationInfo)})}_emitRecordUndo(){this.events.emit("record-undo",{updates:[this.object.createUndoRecord()]})}set snapToScene(O){this._moveManipulation&&(this._moveManipulation.snapToScene=O);this._set("snapToScene",O)}get updating(){return this._updatingHandles.updating||
!!this._scaleRotate?.updating}get activeTooltipInfo(){return"mesh"===z.manipulatedObjectGeometry(this.object)?.type?this._meshTooltipInfo:this._pointTooltipInfo}set location(O){this._moveManipulation.location=O;this._scaleRotate&&(this._scaleRotate.location=O)}set elevationAlignedLocation(O){this._moveManipulation.elevationAlignedLocation=O;this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=O)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&
(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){const {view:O}=this;this._moveManipulation.angle=O.state.viewingMode===k.ViewingMode.Local||O.scale<C.alignArrowsScaleThreshold?this._scaleRotateAdapter.angle:0}_onGeometryChanged(){l.placeAtObject(this,this.object)}_enforceNonZeroSize(O){return O||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}get test(){}};b.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.TransformTool3D.prototype,
"view",void 0);b.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.TransformTool3D.prototype,"object",void 0);b.__decorate([t.property({constructOnly:!0,nonNullable:!0})],a.TransformTool3D.prototype,"enableZ",void 0);b.__decorate([t.property()],a.TransformTool3D.prototype,"enableRotation",void 0);b.__decorate([t.property()],a.TransformTool3D.prototype,"enableScaling",void 0);b.__decorate([t.property({constructOnly:!0,type:I})],a.TransformTool3D.prototype,"sketchOptions",void 0);b.__decorate([t.property({value:!1})],
a.TransformTool3D.prototype,"snapToScene",null);b.__decorate([t.property({constructOnly:!0})],a.TransformTool3D.prototype,"snappingManager",void 0);b.__decorate([t.property({readOnly:!0})],a.TransformTool3D.prototype,"type",void 0);b.__decorate([t.property({readOnly:!0})],a.TransformTool3D.prototype,"updating",null);b.__decorate([t.property()],a.TransformTool3D.prototype,"activeTooltipInfo",null);a.TransformTool3D=b.__decorate([E.subclass("esri.views.3d.interactive.editingTools.transform.TransformTool3D")],
a.TransformTool3D);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/ScaleRotateMeshAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/axisAngleDegrees".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E){a.ScaleRotateMeshAdapter=class extends g{constructor(c){super(c);this._interactionState=null}initialize(){this.addHandles([e.when(()=>{const c=this._interactionState;return c&&c.angle!==c.previousAngle?{interactionState:c,angle:c.state.angle}:null},({interactionState:c})=>{this._updateMeshRotation(c)},e.sync),e.when(()=>{const c=this._interactionState;return c&&c.scale!==c.previousScale?{interactionState:c,scale:c.state.scale}:null},({interactionState:c})=>{this._updateMeshSize(c)},
e.sync)])}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const c=this.geometry.transform;if(null==c)return this._interactionState?.angle??0;const k=E.axis(c.rotation)[2];return.999999<Math.abs(k)?f.deg2rad(E.angle(c.rotation))*Math.sign(k):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const c=
new q({angle:this.angle});this._interactionState=c;const k=()=>{this._interactionState=null};return{state:c,done:k,cancel:()=>{c.cancel();k()}}}createUndoRecord(){return this.object.createUndoRecord()}_updateMeshRotation(c){const {angle:k,previousAngle:m}=c;c.previousAngle=k;c=f.rad2deg(k-m);this.geometry.rotate(0,0,c)}_updateMeshSize(c){const {scale:k,previousScale:m}=c;c.previousScale=k;this.geometry.scale(k/m)}};b.__decorate([n.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"object",
void 0);b.__decorate([n.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"geometry",void 0);b.__decorate([n.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"viewingMode",void 0);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"initialAngle",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"angle",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"angleClockwise",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,
"relativeAngle",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"relativeAngleClockwise",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"scale",null);b.__decorate([n.property()],a.ScaleRotateMeshAdapter.prototype,"_interactionState",void 0);a.ScaleRotateMeshAdapter=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter")],a.ScaleRotateMeshAdapter);let q=class extends g{get state(){const {angle:c,scale:k}=this;return{angle:c,
scale:k}}constructor(c){super(c);this.previousAngle=this.initialAngle=this.angle=0;this.scale=this.previousScale=1;this.previousAngle=this.initialAngle=c.angle}cancel(){this.angle=this.initialAngle;this.scale=1}};b.__decorate([n.property()],q.prototype,"angle",void 0);b.__decorate([n.property()],q.prototype,"initialAngle",void 0);b.__decorate([n.property()],q.prototype,"previousAngle",void 0);b.__decorate([n.property()],q.prototype,"previousScale",void 0);b.__decorate([n.property()],q.prototype,"scale",
void 0);b.__decorate([n.property()],q.prototype,"state",null);q=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter.InteractionState")],q);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/ScaleRotateObjectSymbol3DAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,g,f,e,n,u,v,t,F){function E(k){return-f.deg2rad(k)}a.ScaleRotateObjectSymbol3DAdapter=class extends g{constructor(k){super(k);this._interactionState=this.sizeAxis=null}initialize(){this.addHandles(e.when(()=>null!=this._interactionState?this._interactionState.state:null,k=>{this._updateSymbol(k)},e.sync))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?
E(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const k=this._sizeReferenceSymbolLayer;if(null==k)return null;var m=this.findLayerView(),l=this._graphicSymbol;if(null==m||null==l||"point-3d"!==
l.type)return null;m=m.getSymbolLayerSize(l,k);if("size"in m&&null!=m.size)return m.size;l=this.sizeAxis;return"width"in m&&null!=m.width&&(null==l||"width"===l||"all"===l||"width-and-depth"===l)?m.width:"depth"in m&&null!=k.depth&&(null==l||"depth"===l||"all"===l||"width-and-depth"===l)?m.depth:"height"in m&&null!=k.height&&(null==l||"height"===l||"all"===l)?m.height:null}get _sizeReferenceSymbolLayer(){const k=this._graphicSymbol;return null==k||0===k.symbolLayers.length?null:k.symbolLayers.find(m=>
"object"===m.type)}get _orientationReferenceSymbolLayer(){const k=this._graphicSymbol;return null==k||0===k.symbolLayers.length?null:k.symbolLayers.find(m=>"object"===m.type&&null!=m.heading)}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(k){this.graphic.symbol=k}startInteraction(){const k=this._graphicSymbol,m=this.findLayerView();if(null!=this._interactionState||null==k||null==m)return q;var l=k.symbolLayers.map(H=>
"object"===H.type?m.getSymbolLayerSize(k,H):null).toArray();const r=k.clone();this._interactionState=l=new c({originalSymbol:r,angle:this.angle,initialSizes:l});const z=()=>{this._interactionState=null};return{state:l,done:z,cancel:()=>{this._graphicSymbol=r;z()}}}createUndoRecord(){let k=this.graphic.symbol,m=null;return{undo:l=>{m=l.symbol;l.symbol=k},redo:l=>{k=l.symbol;l.symbol=m}}}_updateSymbol({scale:k,angle:m,originalSymbol:l,initialSizes:r}){var z=this._graphicSymbol;if(null!=z&&"point-3d"===
z.type){z=z.clone();var H=-f.rad2deg(m-this.initialAngle),D=!1;this._forEachObjectSymbolLayerPair(l,z,(w,x,C)=>{w=(w.heading??0)+H;x.heading!==w&&(x.heading=w,D=!0);C=r[C];null!=C&&"width"in C&&(C.width=this.sizeFilter(C.width),C.height=this.sizeFilter(C.height),C.depth=this.sizeFilter(C.depth),w=C.width*k,x.width!==w&&(x.width=w,D=!0),w=C.depth*k,x.depth!==w&&(x.depth=w,D=!0),C=C.height*k,x.height!==C&&(x.height=C,D=!0))});D&&(this._graphicSymbol=z)}}_forEachObjectSymbolLayerPair(k,m,l){k.symbolLayers.forEach((r,
z)=>{const H=m.symbolLayers.at(z);"object"===r.type&&"object"===H.type&&l(r,H,z)})}};b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angle",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angleClockwise",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"orientation",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,
"orientationClockwise",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngleClockwise",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"scale",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);b.__decorate([n.property({constructOnly:!0})],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_interactionState",void 0);b.__decorate([n.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);b.__decorate([n.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);b.__decorate([n.property()],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",null);b.__decorate([n.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);a.ScaleRotateObjectSymbol3DAdapter=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter")],a.ScaleRotateObjectSymbol3DAdapter);const q={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let c=class extends g{get state(){const {originalSymbol:k,angle:m,initialAngle:l,
scale:r,initialSizes:z}=this;return{originalSymbol:k,angle:m,initialAngle:l,scale:r,initialSizes:z}}constructor(k){super(k);this.initialAngle=this.angle=0;this.scale=1;this.initialAngle=k.angle}};b.__decorate([n.property()],c.prototype,"originalSymbol",void 0);b.__decorate([n.property()],c.prototype,"angle",void 0);b.__decorate([n.property()],c.prototype,"initialAngle",void 0);b.__decorate([n.property()],c.prototype,"initialSizes",void 0);b.__decorate([n.property()],c.prototype,"scale",void 0);b.__decorate([n.property()],
c.prototype,"state",null);c=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter.InteractionState")],c);a.headingToAngle=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/ScaleRotateTransform":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/colorUtils ../../../../../core/Cyclical ../../../../../core/Evented ../../../../../core/has ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/scheduling ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/plane ../../../../../geometry/support/ray ../../../../../geometry/support/vectorStacks ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../manipulations/config ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A,G,I,J,L,M,N){function K(T,aa){var ba=H.subtract(C.sv3d.get(),aa.renderStart,T.origin);T=H.subtract(C.sv3d.get(),aa.renderEnd,T.origin);ba=H.length(ba);T=H.length(T);return 0===ba?0:T/ba}function O(T,aa,ba,ca){const {renderStart:la,renderEnd:sa}=T;var ua=U(la,ca,C.sv3d.get());T=U(sa,ca,C.sv3d.get());if(H.squaredDistance(ua,T)<A.dragThresholdPx*A.dragThresholdPx)return null;const ha=H.subtract(C.sv3d.get(),la,ba);aa=H.cross(C.sv3d.get(),
ha,w.getNormal(aa));aa=H.add(C.sv3d.get(),la,aa);ba=U(ba,ca,C.sv3d.get());ca=U(aa,ca,C.sv3d.get());aa=H.subtract(C.sv3d.get(),ca,ua);ca=H.subtract(C.sv3d.get(),ua,ba);ua=x.wrap(ua,aa);ca=x.wrap(ba,ca);return x.distance2(ua,T)<x.distance2(ca,T)?"rotate":"scale"}function U(T,aa,ba){aa.projectToScreen(T,R);return H.set(ba,R[0],R[1],0)}function V(T,aa){let ba=null,ca=1;const la=()=>ca;return{start:()=>{ca=T.getScale();ba=T.getScale;T.getScale=la;aa()},update:sa=>{ca+=((ca+1)/2-ca)*Math.min(sa*A.ringResetAnimationSpeedFactor,
1);aa();return.01>Math.abs(ca-1)?ra.STOP:ra.CONTINUE},destroy:()=>{ba&&(T.getScale=ba);aa()}}}function ea(T,aa,ba){let ca=0,la=null;const sa=()=>!1;return{start:()=>{la=T.getFocused;T.getFocused=sa;ca=0;aa()},update:ua=>{ca+=ua;return!la?.()||ca>=ba.delayMs?ra.STOP:ra.CONTINUE},destroy:()=>{la&&(T.getFocused=la);aa()}}}var Y;(function(T){T.ScaleIn=N.ManipulatorStateCustomFlags.Custom2;T.ScaleOut=N.ManipulatorStateCustomFlags.Custom3;T.RotateLeft=N.ManipulatorStateCustomFlags.Custom4;T.RotateRight=
N.ManipulatorStateCustomFlags.Custom5;T.Unlocked=N.ManipulatorStateCustomFlags.Custom7;T.DelayedFocused=N.ManipulatorStateCustomFlags.Custom8;T.TouchInput=N.ManipulatorStateCustomFlags.Custom12})(Y||={});a.ScaleRotateTransform=class extends g{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(T){this._ringManipulator.location=T}set elevationAlignedLocation(T){this._ringManipulator.elevationAlignedLocation=T}get grabbing(){return this._ringManipulator.grabbing}set interactive(T){this._ringManipulator.interactive=
T}get updating(){return!!this._activeAnimation}constructor(T){super(T);this._activeAnimation=this._scaleRotateDragData=this.mode=null;this._ringIndicatorDelayMs=A.ringIndicatorDelayMs;this.events=new n;this.getFocused=()=>this._ringManipulator.focused;this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:1}initialize(){this._createManipulator();this._updateDragState();this._updateManipulatorTransform();this.addHandles([F.watch(()=>{const {adapter:T}=this;return[T.angle,T.scale]},
()=>this._updateManipulatorTransform())])}destroy(){this._activeAnimation?.frameTask.remove();this._activeAnimation=null;this.tool.manipulators.remove(this._ringManipulator);this._ringManipulator=null}startAnimation(T){this.cancelActiveAnimation();T.start();const aa=E.addFrameTask({update:({deltaTime:ba})=>{T.update(ba)&&this.cancelActiveAnimation()}});this._activeAnimation={...T,frameTask:aa}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove();this._activeAnimation=t.destroyMaybe(this._activeAnimation)}forEachManipulator(T){T(this._ringManipulator,
p.ManipulatorType.SCALE_ROTATE)}_createManipulator(){const T=this._createRingManipulator();this._ringManipulator=T;this.tool.manipulators.add(T);const aa=this.tool.object,ba=M.createManipulatorDragEventPipeline(T,(ca,la,sa)=>{this._scaleRotateDragData=null;const ua=this.adapter.startInteraction(),ha={mode:"none",origin:D.clone(ca.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=ha;this._updateDragState();const ka=C.sv3d.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(ca.renderLocation,
ka);la.next(B.screenToRenderPlane(this.tool.view,w.fromPositionAndNormal(ca.renderLocation,ka,w.create()))).next(W=>{var fa=w.getNormal(W.plane);fa=y.calculateInputRotationTransform(W.renderStart,W.renderEnd,ha.origin,fa);var oa=e.cyclicalPI.shortestSignedDiff(ha.angle,fa);ha.angleDir=v.clamp(ha.angleDir+oa,-A.rotateIndicatorDirectionBuffer,A.rotateIndicatorDirectionBuffer);ha.angle=fa;oa=K(ha,W);ha.scaleDir=v.clamp(ha.scaleDir+(oa-this.adapter.scale),-A.scaleIndicatorDirectionBuffer,A.scaleIndicatorDirectionBuffer);
this._onScaleChanged();if("none"===ha.mode){const ta=this.mode||O(W,W.plane,ha.origin,this.tool.view.state.camera);if(null!=ta){switch(ta){case "rotate":this.tool.events.emit("rotate-start",{object:aa,angle:0});this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]});break;case "scale":this.tool.events.emit("scale-start",{object:aa,xScale:1,yScale:1}),this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]})}ha.mode=ta}}switch(ha.mode){case "rotate":ua.state.angle=
ha.initialAngle+fa;break;case "scale":ua.state.scale=oa,this._onScaleChanged()}this._updateDragState();this._updateManipulatorTransform();switch(W.action){case "start":case "update":switch(ha.mode){case "rotate":this.tool.events.emit("rotate",{object:aa,angle:v.rad2deg(ha.angle)});break;case "scale":this.tool.events.emit("scale",{object:aa,xScale:oa,yScale:oa})}break;case "end":switch(ha.mode){case "rotate":this.tool.events.emit("rotate-stop",{object:aa,angle:v.rad2deg(ha.angle)});break;case "scale":this.tool.events.emit("scale-stop",
{object:aa,xScale:oa,yScale:oa})}}"end"===W.action&&(this.startAnimation(V(this,()=>this._onScaleChanged())),this._scaleRotateDragData=null,this._updateDragState(),ua.done());return W});sa.next(()=>{ua.cancel();if(null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case "rotate":this.tool.events.emit("rotate-stop",{object:aa,angle:0});break;case "scale":this.tool.events.emit("scale-stop",{object:aa,xScale:1,yScale:1})}this.startAnimation(V(this,()=>this._onScaleChanged()));this._scaleRotateDragData=
null;this._updateDragState()}})});this.addHandles([ba,T.events.on("focus-changed",ca=>{"focus"===ca.action?this.startAnimation(ea(this,()=>this._updateDelayedFocusedState(),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()}),T.events.on("immediate-click",ca=>{ca.stopPropagation()}),F.watch(()=>this.tool.object.visible,ca=>this._ringManipulator.available=ca,F.initial)])}_onScaleChanged(){this.events.emit("scale-changed");this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(Y.DelayedFocused,
this.getFocused())}_updateDragState(){this._ringManipulator.updateStateEnabled(Y.Unlocked,!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode));if(null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case "rotate":this._ringManipulator.updateStateEnabled(Y.ScaleIn|Y.ScaleOut,!1);this._ringManipulator.updateStateEnabled(Y.RotateLeft,0>this._scaleRotateDragData.angleDir);this._ringManipulator.updateStateEnabled(Y.RotateRight,0<=this._scaleRotateDragData.angleDir);
break;case "scale":this._ringManipulator.updateStateEnabled(Y.RotateLeft|Y.RotateRight,!1),this._ringManipulator.updateStateEnabled(Y.ScaleIn,0>this._scaleRotateDragData.scaleDir),this._ringManipulator.updateStateEnabled(Y.ScaleOut,0<=this._scaleRotateDragData.scaleDir)}else this._ringManipulator.updateStateEnabled(Y.ScaleIn|Y.ScaleOut|Y.RotateLeft|Y.RotateRight,!1)}_updateManipulatorTransform(){const T=r.fromRotation(C.sm4d.get(),this.adapter.angle,D.fromValues(0,0,1));if(null!=T){var aa=this.getScale();
aa=r.fromScaling(C.sm4d.get(),H.set(C.sv3d.get(),aa,aa,aa));this._ringManipulator.modelTransform=r.multiply(C.sm4d.get(),aa,T)}}_createRingManipulator(){var T=(P,X,Z)=>{const da=[],ia=Math.ceil(A.geometrySegments*(X-P)/(2*Math.PI));for(let ja=0;ja<ia+1;ja++){const va=P+ja*(X-P)/ia;da.push(D.fromValues(Z*Math.cos(va),Z*Math.sin(va),0))}return da};const aa=this._createMaterial(1);var ba=(P,X,Z=aa)=>I.createPathExtrusionGeometry(Z,[[-X/2,0],[X/2,0],[X/2,A.ringHeight/2],[-X/2,A.ringHeight/2]],P,[],[],
!1),ca=T(0,2*Math.PI,A.ringRadius),la=ba(ca,A.ringThickness),sa=[],ua=[];const ha=[];for(var ka=0;2>ka;ka++){var W=ka*Math.PI-Math.PI/4,fa=Math.PI/2-A.rotateIndicatorArcLength,oa=W+fa;W=W+Math.PI/2-fa;fa=T(oa,W,A.innerIndicatorRadius);var ta=ba(fa,A.indicatorThickness);ha.push(fa);ha.push(T(oa,W,A.outerIndicatorRadius-A.ringThickness/2));sa.push(ta);ua.push(ta.instantiate());for(ta=0;2>ta;ta++){var pa=0===ta,ma=z.create();if(pa){r.scale(ma,ma,[1,-1,1]);r.rotate(ma,ma,-oa,[0,0,1]);var xa=Math.round(A.rotateIndicatorArrowPlacementPercentage*
(fa.length-1));ma[12]=fa[xa][0];ma[13]=fa[xa][1];ma[14]=fa[xa][2]}else r.rotate(ma,ma,W,[0,0,1]),xa=Math.round((1-A.rotateIndicatorArrowPlacementPercentage)*(fa.length-1)),ma[12]=fa[xa][0],ma[13]=fa[xa][1],ma[14]=fa[xa][2];xa=I.createExtrudedTriangle(aa,A.rotateIndicatorArrowTipLength,0,A.rotateIndicatorArrowTipRadius,A.ringHeight);I.transformInPlace(xa,ma);(pa?sa:ua).push(xa)}}ka=[];for(oa=0;2>oa;oa++)W=oa*Math.PI-Math.PI/4,fa=Math.PI/2-A.scaleIndicatorArcLength,W=T(W+fa,W+Math.PI/2-fa,A.outerIndicatorRadius),
ka.push(ba(W,A.indicatorThickness));pa=this._createMaterial(.66);oa=this._createMaterial(.5);fa=this._createMaterial(.33);W=T(0,2*Math.PI,A.ringRadius+A.scaleIndicatorOffset1);ta=T(0,2*Math.PI,A.ringRadius+A.scaleIndicatorOffset2);W=ba(W,A.indicatorThickness,pa);ta=ba(ta,A.indicatorThickness,fa);ma=T(0,2*Math.PI,A.ringRadius-A.scaleIndicatorOffset1);T=T(0,2*Math.PI,A.ringRadius-A.scaleIndicatorOffset2);pa=ba(ma,A.indicatorThickness,pa);ba=ba(T,A.indicatorThickness,fa);la=[new d.RenderObject(la,Y.DelayedFocused),
new d.RenderObject(la.instantiate({material:oa}),N.ManipulatorStateFlags.None)];this.mode&&"scale"!==this.mode||(la=la.concat([...ka.map(P=>new d.RenderObject(P,Y.DelayedFocused|Y.Unlocked)),new d.RenderObject(W,Y.DelayedFocused|Y.ScaleIn),new d.RenderObject(ta,Y.DelayedFocused|Y.ScaleIn),new d.RenderObject(pa,Y.DelayedFocused|Y.ScaleOut),new d.RenderObject(ba,Y.DelayedFocused|Y.ScaleOut)]));this.mode&&"rotate"!==this.mode||(la=la.concat([...ua.map(P=>new d.RenderObject(P.instantiate(),Y.DelayedFocused|
Y.Unlocked)),...sa.map(P=>new d.RenderObject(P,Y.DelayedFocused|Y.RotateLeft)),...ua.map(P=>new d.RenderObject(P,Y.DelayedFocused|Y.RotateRight))]));ca=[ca,...ha];return new h.Manipulator3D({view:this.tool.view,renderObjects:la,autoScaleRenderObjects:!1,worldOriented:!0,radius:A.ringThickness,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:this.tool.object.elevationInfo,collisionType:{type:"ribbon",paths:ca,direction:D.fromValues(0,0,1)}})}_createMaterial(T){const aa=new L.ColorMaterial({cullFace:G.CullFaceOptions.Back,
renderOccluded:J.RenderOccludedFlag.Transparent,isDecoration:!0});this.addHandles(F.watch(()=>f.multiplyOpacityToUnitRGBA(this.tool.view.effectiveTheme.accentColor,T),ba=>aa.setParameters({color:ba}),F.initial));return aa}get test(){}};b.__decorate([c.property({constructOnly:!0})],a.ScaleRotateTransform.prototype,"tool",void 0);b.__decorate([c.property({constructOnly:!0})],a.ScaleRotateTransform.prototype,"adapter",void 0);b.__decorate([c.property({constructOnly:!0})],a.ScaleRotateTransform.prototype,
"sketchOptions",void 0);b.__decorate([c.property()],a.ScaleRotateTransform.prototype,"mode",void 0);b.__decorate([c.property()],a.ScaleRotateTransform.prototype,"_activeAnimation",void 0);b.__decorate([c.property()],a.ScaleRotateTransform.prototype,"updating",null);a.ScaleRotateTransform=b.__decorate([l.subclass("esri.views.3d.interactive.editingTools.transform.ScaleRotateTransform")],a.ScaleRotateTransform);var ra;(function(T){T[T.CONTINUE=0]="CONTINUE";T[T.STOP=1]="STOP"})(ra||={});const R=q.createScreenPointArray();
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/TransformMeshTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),function(a,b,g,f,e,n,u,v,t,F){a.TransformMeshTooltipInfo=class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);
this.type="transform-mesh";this.orientation=v.makeOrientationField();this.scale=v.makeScaleField();this.allFields.forEach(q=>{q.lockable=!1;q.setActual(null)})}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic,orientation:this.orientation.actual,scale:this.scale.actual}}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};
b.__decorate([g.property()],a.TransformMeshTooltipInfo.prototype,"key",null);b.__decorate([g.property()],a.TransformMeshTooltipInfo.prototype,"allFields",null);a.TransformMeshTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.TransformMeshTooltipInfo")],a.TransformMeshTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/TransformPointTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../fields/fields ./SketchTooltipInfo ./TooltipInfoWithCoordinates".split(" "),
function(a,b,g,f,e,n,u,v,t,F){a.TransformPointTooltipInfo=class extends F.TooltipInfoWithCoordinates(t.SketchTooltipInfo){constructor(E){super(E);this.type="transform-point";this.orientation=v.makeOrientationField({readOnly:!0});this.size=v.makeSizeField({readOnly:!0});this.allFields.forEach(q=>{q.lockable=!1;q.setActual(null)})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.size]}};b.__decorate([g.property()],a.TransformPointTooltipInfo.prototype,
"allFields",null);a.TransformPointTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.TransformPointTooltipInfo")],a.TransformPointTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/ExtentTransformTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/sliceToolUtils ../../Manipulator3D ../manipulatedObjectUtils ../ManipulatorType ../manipulatorUtils ../visualElementUtils ./extentTransform/ExtentMove ./extentTransform/ExtentRotate ./extentTransform/ExtentScale ./extentTransform/extentUtils ./extentTransform/PreserveAspectRatio ./extentTransform/SnapRotation ../../visualElements/OutlineVisualElement ../../../../interactive/InteractiveToolBase ../../../../interactive/sketch/SketchOptions ../../../../interactive/tooltip/tooltipCommonUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p){a.ExtentTransformTool=class extends d.InteractiveToolBase{get updating(){return!!this.object.updating}constructor(A){super(A);this.events=new g;this.enableRotation=this.enableScaling=this.enableZ=!0;this.sketchOptions=new B;this._preserveAspectRatio=new C.PreserveAspectRatio;this._snapRotation=new h.SnapRotation;this.grabbing=!1;this._attachmentOrigin=this.inputState=null;this.type="transform-3d";this._outlineVisualElement=null}initialize(){const {view:A,
object:G}=this,I=this._bounds=new x.TransformBounds(this,()=>this._updateManipulators());this._extentMove=new H.ExtentMove(this,I);this._extentScale=new w.ExtentScale(this,I,()=>this._preserveAspectRatio.createDragEventPipelineStep());this._extentRotate=new D.ExtentRotate(this,I,()=>this._snapRotation.createDragEventPipelineStep());this.addHandles([n.watch(()=>this.enableZ,()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,l.ManipulatorType.TRANSLATE_Z)),n.watch(()=>this.enableScaling,
()=>this._extentScale.forEachManipulator(L=>this._updateManipulatorAvailability(L,l.ManipulatorType.SCALE))),n.watch(()=>this.enableRotation,()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,l.ManipulatorType.ROTATE))]);this._updateManipulators();this._updateAllManipulatorAvailability();const J=z.createVisualElements({view:A,object:G,forEachManipulator:L=>this._forEachManipulator(L),onManipulatorsChanged:()=>f.makeHandle()});if(null!=J){const {visualElement:L}=J;L instanceof
y.OutlineVisualElement&&(this._outlineVisualElement=L,this.addHandles(L.events.on("attachment-origin-changed",()=>this._bounds.updateDisplayBounds())));this.addHandles(J)}this.addHandles([G.on("committed",()=>this._onGeometryChanged()),n.watch(()=>this.object.visible,()=>this._updateAllManipulatorAvailability()),n.watch(()=>this.object.isDraped,()=>this._graphicDrapedChanged(),n.initial),n.watch(()=>A.pointsOfInterest?.centerOnSurfaceFrequent.location,()=>I.updateDisplayBounds())]);this._forEachManipulator(L=>
{this.addHandles(L.events.on("grab-changed",()=>{this.grabbing=L.grabbing;this._updateAllManipulatorAvailability()}))});this._forEachManipulator((L,M)=>{this.addHandles(L.events.on("immediate-click",N=>{M===l.ManipulatorType.TRANSLATE_XY&&this.events.emit("immediate-click",{...N,object:G});N.stopPropagation()}))});this._initializeTooltip();this.finishToolCreation()}destroy(){this._extentMove.destroy();this._extentScale.destroy();this._extentRotate.destroy();this.tooltip.destroy();this._set("view",
null);this._set("object",null)}_initializeTooltip(){const {view:A}=this;this.tooltip=p.makeTooltip(()=>({view:A,options:this.sketchOptions.tooltips}));const G=()=>{this.tooltip.info=this._getUpdatedTooltipInfo()};this.addHandles([n.watch(()=>this.sketchOptions.tooltips.effectiveEnabled,G),n.watch(()=>this.preserveAspectRatio,G)]);this._forEachManipulator(I=>{this.addHandles([I.events.on(["focus-changed","grab-changed"],G),I.events.on("drag",J=>{"cancel"===J.action?this.tooltip.clear():G()})])})}_getUpdatedTooltipInfo(){return this.sketchOptions.tooltips.effectiveEnabled?
this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles("draped-elevation-changes");this._bounds.updateDisplayBounds();this.object.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",A=>{null!=this._attachmentOrigin&&E.containsXY(A.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()}),
"draped-elevation-changes")}_updateManipulators(){if(this.visible){var A=this._bounds.displayBounds,G=c.calculateBoundedPlaneTranslateRotate(A,q.sm4d.get());this._extentMove.updateManipulators(G,A);this._extentScale.updateManipulators(G,A);this._extentRotate.updateManipulators(G,A)}}_updateAllManipulatorAvailability(){this._forEachManipulator((A,G)=>this._updateManipulatorAvailability(A,G))}_updateManipulatorAvailability(A,G){const I=this.grabbing&&!A.grabbing;A.interactive=!I;if(A instanceof k.Manipulator3D){const J=
this.object.visible,L=this.enableZ&&r.canMoveZOperations(this.object.operations,this.object.elevationInfo);switch(G){case l.ManipulatorType.ROTATE:A.available=J&&this.enableRotation;break;case l.ManipulatorType.SCALE:A.available=J&&(this.enableScaling||this.enableRotation||L);A.interactive=!I&&this.enableScaling;A.state=this.enableScaling?c.resizeNormal:c.resizeOutlineOnly;break;case l.ManipulatorType.TRANSLATE_Z:A.available=J&&L;break;default:A.available=J}}}_forEachManipulator(A){this._extentMove.forEachManipulator(A);
this._extentScale.forEachManipulator(A);this._extentRotate.forEachManipulator(A)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(A){this._preserveAspectRatio.enabled=A;this._set("preserveAspectRatio",A)}get snapRotation(){return this._snapRotation.enabled}set snapRotation(A){this._snapRotation.enabled=A;this._set("snapRotation",A)}get attachmentOrigin(){return this._attachmentOrigin=(this.object.isDraped?null:this._outlineVisualElement?.attachmentOrigin)??
this.object.origin??m.manipulatedObjectGeometry(this.object)?.extent?.center}reset(){}cancel(){if(this.canUndo){const A=this.object.operations?.undo();A&&this._bounds.updateMapBoundsFromOperationInverse(A)}this.inputState=null}get canUndo(){return!!this.object.operations?.canUndo}undo(){if(null!=this.inputState)this.view.activeTool=null;else if(this.canUndo){const A=this.object.operations?.undo();A&&this._bounds.updateMapBoundsFromOperationInverse(A)}}get canRedo(){return!!this.object.operations?.canRedo}redo(){if(this.canRedo){const A=
this.object.operations?.redo();A&&this._bounds.updateMapBoundsFromOperation(A)}}get test(){}};b.__decorate([u.property()],a.ExtentTransformTool.prototype,"updating",null);b.__decorate([u.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"view",void 0);b.__decorate([u.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"object",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"enableZ",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,
"enableScaling",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"enableRotation",void 0);b.__decorate([u.property({constructOnly:!0,type:B})],a.ExtentTransformTool.prototype,"sketchOptions",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"preserveAspectRatio",null);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"snapRotation",null);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"grabbing",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,
"inputState",void 0);b.__decorate([u.property({readOnly:!0})],a.ExtentTransformTool.prototype,"type",void 0);b.__decorate([u.property()],a.ExtentTransformTool.prototype,"tooltip",void 0);a.ExtentTransformTool=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.transform.ExtentTransformTool")],a.ExtentTransformTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolUtils":function(){define("exports ../../../../geometry ../../../../analysis/SlicePlane ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection ../../../../geometry/support/Axis ../../../../chunks/boundedPlane ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ./settings ./sliceToolConfig ../support/projectionUtils ../../interactive/manipulatorUtils ../../interactive/visualElements/LineVisualElement ../../interactive/visualElements/SlicePlaneVisualElement ../../support/RenderCoordsHelper ../../support/geometryUtils/ray ../../webgl-engine/lib/Material ../../../interactive/interfaces ../../../../geometry/Point ../../../../geometry/Extent".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w,x,C,h,y,d,B,p,A){function G(R,T,aa,ba,ca,la){const sa=t.dot(R,T),ua=r.sv3d.get(),ha=r.sv3d.get();switch(ba===a.SliceOrientation.HORIZONTAL_OR_VERTICAL?Math.abs(sa)>H.verticalDotThreshold?a.SliceOrientation.HORIZONTAL:a.SliceOrientation.VERTICAL:ba){case a.SliceOrientation.VERTICAL:t.cross(ua,Math.abs(sa)<=H.smallAngleDotThreshold?R:aa.viewUp,T);t.copy(ha,T);break;case a.SliceOrientation.HORIZONTAL:t.cross(ua,aa.viewUp,T);t.cross(ha,T,ua);break;case a.SliceOrientation.TILTED:t.cross(ua,
Math.abs(sa)<=H.smallAngleDotThreshold?T:aa.viewUp,R),t.cross(ha,R,ua)}R=t.cross(r.sv3d.get(),ua,ha);0<t.dot(R,aa.viewForward)&&t.scale(ha,ha,-1);t.normalize(ca,ua);t.normalize(la,ha)}function I(R,T,aa){var ba=T.worldUpAtPosition(R.origin,r.sv3d.get());T=R.basis1;ba=l.angleAroundAxis(ba,R.basis2,R.basis1)+ra;return c.rotate(R,Math.round(ba/ra)*ra-ba,T,aa)}function J(R,T){switch(T){case V.POSITIVE_X:return{basis:R.basis1,direction:1,position:t.add(r.sv3d.get(),R.origin,R.basis1),edge:T};case V.POSITIVE_Y:return{basis:R.basis2,
direction:1,position:t.add(r.sv3d.get(),R.origin,R.basis2),edge:T};case V.NEGATIVE_X:return{basis:R.basis1,direction:-1,position:t.subtract(r.sv3d.get(),R.origin,R.basis1),edge:T};case V.NEGATIVE_Y:return{basis:R.basis2,direction:-1,position:t.subtract(r.sv3d.get(),R.origin,R.basis2),edge:T}}}function L(R,T,aa){const ba=aa.projectToRenderScreen(t.add(r.sv3d.get(),R,T),u.castRenderScreenPointArray3(r.sv3d.get()));R=aa.projectToRenderScreen(t.subtract(r.sv3d.get(),R,T),u.castRenderScreenPointArray3(r.sv3d.get()));
return t.squaredLength(t.subtract(ba,ba,R))}function M(R){const T=t.length(R.basis1);R=t.length(R.basis2);return H.resizeHandleEdgePaddingFrac*Math.min(T,R)}function N(R){return 0!==R.direction[0]&&0!==R.direction[1]}function K(R,T,aa,ba,ca,la,sa=c.create()){if(!la.toRenderCoords(R,sa.origin))return e.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${R.spatialReference.wkid} is not supported`),null;la.worldBasisAtPosition(sa.origin,
q.Axis.X,sa.basis1);la.worldBasisAtPosition(sa.origin,q.Axis.Y,sa.basis2);k.fromVectorsAndPoint(sa.basis2,sa.basis1,sa.origin,sa.plane);c.rotate(sa,-n.deg2rad(T),c.normal(sa),sa);c.rotate(sa,n.deg2rad(aa),sa.basis1,sa);t.scale(sa.basis1,sa.basis1,ba/2);t.scale(sa.basis2,sa.basis2,ca/2);c.updateUnboundedPlane(sa);return sa}function O(R,T){if(null==R?.position)return null;const aa=D.applyProjectionAndElevationAlignment(R.position,T.spatialReference,T.elevationProvider);if(null==aa)return null;T=h.RenderCoordsHelper.renderUnitScaleFactor(R.position.spatialReference,
T.spatialReference);return{position:aa,heading:R.heading,tilt:R.tilt,renderWidth:R.width*T,renderHeight:R.height*T}}function U(R,T,aa,ba=c.create()){if(null==R)return null;R=K(R.position,R.heading,R.tilt,R.renderWidth,R.renderHeight,T.renderCoordsHelper,ba);aa.tiltEnabled||null==R||I(R,T.renderCoordsHelper,R);return R}var V;(function(R){R[R.POSITIVE_X=0]="POSITIVE_X";R[R.POSITIVE_Y=1]="POSITIVE_Y";R[R.NEGATIVE_X=2]="NEGATIVE_X";R[R.NEGATIVE_Y=3]="NEGATIVE_Y"})(V||={});b=B.ManipulatorStateCustomFlags.Custom1;
a.RotationAxis=void 0;(function(R){R[R.HEADING=1]="HEADING";R[R.TILT=2]="TILT"})(a.RotationAxis||(a.RotationAxis={}));a.SliceOrientation=void 0;(function(R){R[R.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL";R[R.HORIZONTAL=1]="HORIZONTAL";R[R.VERTICAL=2]="VERTICAL";R[R.TILTED=3]="TILTED"})(a.SliceOrientation||(a.SliceOrientation={}));const ea=B.ManipulatorStateCustomFlags.Custom2,Y=m.create(),ra=Math.PI/2;m=B.ManipulatorStateCustomFlags.Custom1;B=B.ManipulatorStateCustomFlags.Custom2;a.DidPointerMoveRecentlyFlag=
b;a.IsShiftEdgeOnScreenFlag=ea;a.calculateBoundedPlaneTranslateRotate=function(R,T){return w.calculateTranslateRotateFromBases(R.basis1,R.basis2,R.origin,T)};a.calculateDiagonalResizeHandleScale=function(R){return M(R)};a.calculatePlaneHalfSize=function(R,T){return H.initialPlaneHalfSizeViewProportion*Math.min(T.width,T.height)*T.computeRenderPixelSizeAt(R)};a.createGridVisualElement=function(R){return new C.SlicePlaneVisualElement({view:R,attached:!1,backgroundColor:z.planeColor,gridColor:z.getGridColor(R.effectiveTheme),
gridWidth:4,renderOccluded:d.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0})};a.createOutlineVisualElement=function(R){return new x.LineVisualElement({view:R,attached:!1,color:z.getOutlineColor(R.effectiveTheme),width:H.planeOutlineWidth,renderOccluded:d.RenderOccludedFlag.OccludeAndTransparent,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]],isDecoration:!0})};a.createPlane=function(R,T,aa,ba,ca,la,sa,ua){sa=sa.worldUpAtPosition(R,r.sv3d.get());G(T,sa,ca,la,ua.basis1,ua.basis2);
t.scale(ua.basis1,ua.basis1,aa);t.scale(ua.basis2,ua.basis2,ba);t.copy(ua.origin,R);k.fromVectorsAndPoint(ua.basis2,ua.basis1,ua.origin,ua.plane);return ua};a.createRotatePlane=function(R,T,aa,ba){T=T.worldUpAtPosition(R.origin,r.sv3d.get());const ca=r.sv3d.get();switch(aa){case a.RotationAxis.HEADING:t.copy(ca,T);break;case a.RotationAxis.TILT:t.copy(ca,R.basis1)}return k.fromPositionAndNormal(R.origin,ca,ba)};a.createShiftPlane=function(R,T,aa,ba){aa=t.cross(r.sv3d.get(),T,aa);t.cross(aa,aa,T);
return k.fromPositionAndNormal(R,aa,ba)};a.forceHorizontalOrVertical=I;a.isDiagonalResizeHandle=N;a.isIBuildingSceneLayerView3D=function(R){return null!=("building-scene-3d"===R.type?R:null)};a.normalToBases=G;a.planeToExtent=function(R,T,aa){if(null==R)return null;const ba=R.origin,ca=r.sv3d.get(),la=r.sv3d.get(),sa=r.sv3d.get(),ua=r.sv3d.get();t.add(ca,ba,R.basis1);t.add(ca,ca,R.basis2);t.add(la,ba,R.basis1);t.sub(la,la,R.basis2);t.sub(sa,ba,R.basis1);t.sub(sa,sa,R.basis2);t.sub(ua,ba,R.basis1);
t.add(ua,ua,R.basis2);let ha,ka,W,fa,oa,ta;for(const pa of[ca,la,sa,ua]){R=T.fromRenderCoords(pa,pa,aa);if(null==R)return null;ha=null==ha?R[0]:Math.min(ha,R[0]);ka=null==ka?R[0]:Math.max(ka,R[0]);W=null==W?R[1]:Math.min(W,R[1]);fa=null==fa?R[1]:Math.max(fa,R[1]);oa=null==oa?R[2]:Math.min(oa,R[2]);ta=null==ta?R[2]:Math.max(ta,R[2])}return new A({xmin:ha,xmax:ka,ymin:W,ymax:fa,zmin:oa,zmax:ta,spatialReference:aa})};a.planeToShape=function(R,T,aa,ba=new g){if(null==R)return null;const {renderCoordsHelper:ca}=
T;var la=ca.fromRenderCoords(R.origin,new p({spatialReference:T.spatialReference}));if(null==la)return null;la=E.tryProjectWithZConversion(la,aa);if(null==la)return null;ba.position=la;la=2*t.length(R.basis1);const sa=2*t.length(R.basis2);T=h.RenderCoordsHelper.renderUnitScaleFactor(T.spatialReference,aa);ba.width=la*T;ba.height=sa*T;T=ca.worldUpAtPosition(R.origin,r.sv3d.get());ba.tilt=n.rad2deg(l.angleAroundAxis(T,R.basis2,R.basis1)+ra);ba.heading=ca.headingAtPosition(R.origin,R.basis1)-90;return ba};
a.projectAndElevationAlignShape=O;a.projectedShapeToPlane=U;a.resizeNormal=m;a.resizeOutlineOnly=B;a.resizePlane=function(R,T,aa,ba,ca,la){const sa=t.copy(r.sv3d.get(),ca.origin);t.add(sa,sa,t.scale(r.sv3d.get(),ca.basis1,0>R.direction[0]?1:-1));t.add(sa,sa,t.scale(r.sv3d.get(),ca.basis2,0>R.direction[1]?1:-1));var ua=t.length(ca.basis1);const ha=t.length(ca.basis2);aa=t.subtract(r.sv3d.get(),aa,sa);var ka=t.subtract(r.sv3d.get(),T,sa);let W=0;T=0;if(N(R)){var fa=M(ca);const oa=M(la);W=ua-.5*R.direction[0]*
t.dot(ca.basis1,ka)/ua;T=ha-.5*R.direction[1]*t.dot(ca.basis2,ka)/ha;ka=oa/fa;W*=ka;T*=ka}ka=.5*R.direction[0]*t.dot(ca.basis1,aa)/ua;fa=.5*R.direction[1]*t.dot(ca.basis2,aa)/ha;aa=W+ka;T+=fa;ua=t.scale(r.sv3d.get(),ca.basis1,aa/ua);ca=t.scale(r.sv3d.get(),ca.basis2,T/ha);(0>=aa||L(la.origin,ua,ba)<=H.planeMinBasisScreenLen2)&&t.copy(ua,la.basis1);(0>=T||L(la.origin,ca,ba)<=H.planeMinBasisScreenLen2)&&t.copy(ca,la.basis2);ba=t.copy(r.sv3d.get(),sa);t.add(ba,ba,t.scale(r.sv3d.get(),ua,0>R.direction[0]?
-1:1));t.add(ba,ba,t.scale(r.sv3d.get(),ca,0>R.direction[1]?-1:1));return c.fromValues(ba,ua,ca,la)};a.shapeToPlane=function(R,T,aa,ba=c.create()){R=O(R,T);return null==R?null:U(R,T,aa,ba)};a.updateResizeHandle=function(R,T,aa,ba){var ca=t.length(ba.basis1);const la=t.length(ba.basis2),sa=M(ba),ua=M(ba),ha=t.set(r.sv3d.get(),0,0,0);t.add(ha,t.scale(r.sv3d.get(),ba.basis1,T.direction[0]),t.scale(r.sv3d.get(),ba.basis2,T.direction[1]));t.add(ha,ba.origin,ha);ba=0;let ka=1;N(T)?(1===T.direction[0]&&
-1===T.direction[1]?ba=ra:1===T.direction[0]&&1===T.direction[1]?ba=Math.PI:-1===T.direction[0]&&1===T.direction[1]&&(ba=3*Math.PI/2),ka=ua):(T=0!==T.direction[0]?1:2,ba=1===T?ra:0,ka=(1===T?la:ca)-sa);ca=v.fromZRotation(r.sm4d.get(),ba);v.scale(ca,ca,t.set(r.sv3d.get(),ka,ka,ka));v.multiply(ca,aa,ca);ca[12]=0;ca[13]=0;ca[14]=0;R.modelTransform=ca;R.renderLocation=ha};a.updateRotateHeadingHandle=function(R,T,aa,ba){ba=ba.worldUpAtPosition(aa.origin,r.sv3d.get());const ca=J(aa,V.POSITIVE_X),la=v.fromZRotation(r.sm4d.get(),
ca.edge*Math.PI/2);v.rotateX(la,la,-(l.angleAroundAxis(ba,aa.basis2,aa.basis1)+ra));v.multiply(la,T,la);la[12]=0;la[13]=0;la[14]=0;R.modelTransform=la;R.renderLocation=ca.position};a.updateRotateTiltHandle=function(R,T,aa){aa=J(aa,V.POSITIVE_Y);const ba=v.fromZRotation(r.sm4d.get(),aa.edge*Math.PI/2);v.rotateX(ba,ba,ra);v.multiply(ba,T,ba);ba[12]=0;ba[13]=0;ba[14]=0;R.modelTransform=ba;R.renderLocation=aa.position};a.updateShiftRestartHandle=function(R,T,aa,ba){var ca=J(aa,V.NEGATIVE_X);const la=
r.sm4d.get();v.rotateZ(la,T,ca.edge*Math.PI/2);T=t.normalize(r.sv3d.get(),ca.basis);T=t.scale(r.sv3d.get(),T,ca.direction*ba.computeScreenPixelSizeAt(ca.position)*H.shiftRestartOffsetDistance);t.add(T,T,ca.position);ca=ba.projectToRenderScreen(T,u.castRenderScreenPointArray3(r.sv3d.get()));const [sa,ua,ha,ka]=ba.viewport;var W=Math.min(ha,ka)/16;let fa=!0;ca[0]<sa+W?(ca[0]=sa+W,fa=!1):ca[0]>sa+ha-W&&(ca[0]=sa+ha-W,fa=!1);ca[1]<ua+W?(ca[1]=ua+W,fa=!1):ca[1]>ua+ka-W&&(ca[1]=ua+ka-W,fa=!1);W=fa;y.fromRender(ba,
ca,Y);t.normalize(Y.direction,Y.direction);ba=r.sv3d.get();!W&&c.intersectRay(aa,Y,ba)&&(T=ba);la[12]=0;la[13]=0;la[14]=0;R.modelTransform=la;R.renderLocation=F.clone(T);R.state=W?R.state|ea:R.state&~ea};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/analysis/SlicePlane":function(){define("../chunks/tslib.es6 ../geometry ../core/Clonable ../core/Cyclical ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/persistable ../geometry/Point".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){b=class extends g.ClonableMixin(e.JSONSupport){constructor(m){super(m);this.type="plane";this.position=null;this.tilt=this.heading=0;this.height=this.width=10}equals(m){return this.heading===m.heading&&this.tilt===m.tilt&&n.equalsMaybe(this.position,m.position)&&this.width===m.width&&this.height===m.height}};a.__decorate([u.property({readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);a.__decorate([u.property({type:k}),c.persistable()],b.prototype,
"position",void 0);a.__decorate([u.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),c.persistable(),v.cast(m=>f.cyclicalDegrees.normalize(q.ensureNumber(m),0,!0))],b.prototype,"heading",void 0);a.__decorate([u.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),c.persistable(),v.cast(m=>f.cyclicalDegrees.normalize(q.ensureNumber(m),0,!0))],b.prototype,"tilt",void 0);a.__decorate([u.property({type:Number,nonNullable:!0}),c.persistable()],b.prototype,"width",void 0);a.__decorate([u.property({type:Number,
nonNullable:!0}),c.persistable()],b.prototype,"height",void 0);return b=a.__decorate([E.subclass("esri.analysis.SlicePlane")],b)})},"esri/views/3d/analysis/Slice/settings":function(){define(["exports","../../../../core/colorUtils","../../../../core/libs/gl-matrix-2/factories/vec4f64"],function(a,b,g){g=g.fromValues(0,0,0,.04);a.getGridColor=function({accentColor:f}){return b.multiplyOpacityToUnitRGBA(f,.5)};a.getOutlineColor=function({accentColor:f}){return b.multiplyOpacityToUnitRGBA(f,.7)};a.planeColor=
g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolConfig":function(){define(["exports","../../../../core/has","../../../../core/mathUtils"],function(a,b,g){b=b("mac")?"Meta":"Control";const f=Math.cos(g.deg2rad(45));g=Math.cos(g.deg2rad(5));a.displayFocusMultiplier=2;a.forceHorizontalModifier=b;a.forceVerticalModifier="Shift";a.initialDepthOffsetFrac=.02;a.initialPlaneHalfSizeViewProportion=.4;a.planeMinBasisScreenLen2=1600;a.planeOutlineWidth=
1;a.planePreviewOutlineWidth=2;a.pointerMoveTimerMs=2500;a.previewFadeDotThreshold=.95;a.previewFadeDurationSeconds=.3;a.resizeHandleCornerInputRadius=6;a.resizeHandleCornerWidth=4;a.resizeHandleEdgeInputRadius=4;a.resizeHandleEdgePaddingFrac=.3;a.resizeHandleEdgeWidth=1;a.shiftRestartArrowLength=48;a.shiftRestartArrowOutlineWidth=2.25;a.shiftRestartOffsetDistance=40;a.shiftRestartTipFocusMultiplier=1.15;a.shiftRestartTipLength=22.5;a.shiftRestartTipRadius=11;a.shiftRestartTubeFocusMultiplier=1.15;
a.shiftRestartTubeRadius=3;a.smallAngleDotThreshold=g;a.verticalDotThreshold=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/support/projectionUtils":function(){define(["exports","../../../../geometry/projection","../../support/ElevationProvider"],function(a,b,g){a.applyProjectionAndElevationAlignment=function(f,e,n,u=!1){f=b.tryProjectWithZConversion(f,e);if(null==f)return null;f.hasZ&&!u||null==n||(f.z=g.getElevationAtPoint(n,f)??0);return f};a.logFailedGeometryProjectionError=
function(f,e,n){n.warnOnce(`Failed to project analysis geometry (id: '${f.id}'), projection from spatial reference `+`(wkid: '${e.wkid}') to view spatial reference is not supported. `+"Projection may be possible after calling projection.load().")};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LineVisualElement":function(){define("exports ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../support/engineContent/line ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,g,f,e,n,u,v,t,F){class E extends u.Object3DVisualElement{constructor(c,k){super(c);this._hasExternalMaterial=!1;this._hasExternalMaterial=null!=k;this._material=null!=k?k:new F.RibbonLineMaterial({width:1,color:n.fromValues(1,0,1,1),stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerWidth:1,hasPolygonOffset:!1,renderOccluded:t.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!!c.isDecoration,writeDepth:!0});this.applyProperties(c)}setGeometryFromPoint(c,k=1E3){const m=e.create();
this.view.renderCoordsHelper.toRenderCoords(c,m)&&this.setGeometryFromRenderSpacePoint(m,k)}setGeometryFromRenderSpacePoint(c,k=1E3){this.geometry=[[[c[0]-k,c[1],c[2]],[c[0]+k,c[1],c[2]]],[[c[0],c[1]-k,c[2]],[c[0],c[1]+k,c[2]]],[[c[0],c[1],c[2]-k],[c[0],c[1],c[2]+k]]]}setGeometryFromExtent(c){const k=this.view.spatialReference,m=e.create(),l=e.create(),r=[];f.set(m,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(m,k,l);r.push([l[0],l[1],l[2]]);f.set(m,c[2],c[1],100);this.view.renderCoordsHelper.toRenderCoords(m,
k,l);r.push([l[0],l[1],l[2]]);f.set(m,c[2],c[3],100);this.view.renderCoordsHelper.toRenderCoords(m,k,l);r.push([l[0],l[1],l[2]]);f.set(m,c[0],c[3],100);this.view.renderCoordsHelper.toRenderCoords(m,k,l);r.push([l[0],l[1],l[2]]);f.set(m,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(m,k,l);r.push([l[0],l[1],l[2]]);f.set(m,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(m,k,l);r.push([l[0],l[1],l[2]]);this.geometry=[r]}setGeometryFromFrustum(c){const k=[];c.lines.forEach(m=>{k.push([m.origin[0],
m.origin[1],m.origin[2]]);k.push([m.endpoint[0],m.endpoint[1],m.endpoint[2]])});this.geometry=[k]}setGeometryFromBoundedPlane(c){const k=[],m=c.origin,l=c.basis1;c=c.basis2;const r=e.create(),z=e.create(),H=e.create(),D=e.create();r[0]=m[0]-.5*l[0]-.5*c[0];r[1]=m[1]-.5*l[1]-.5*c[1];r[2]=m[2]-.5*l[2]-.5*c[2];z[0]=m[0]-.5*l[0]+.5*c[0];z[1]=m[1]-.5*l[1]+.5*c[1];z[2]=m[2]-.5*l[2]+.5*c[2];H[0]=m[0]+.5*l[0]+.5*c[0];H[1]=m[1]+.5*l[1]+.5*c[1];H[2]=m[2]+.5*l[2]+.5*c[2];D[0]=m[0]+.5*l[0]-.5*c[0];D[1]=m[1]+
.5*l[1]-.5*c[1];D[2]=m[2]+.5*l[2]-.5*c[2];k.push([r[0],r[1],r[2]]);k.push([z[0],z[1],z[2]]);k.push([H[0],H[1],H[2]]);k.push([D[0],D[1],D[2]]);k.push([r[0],r[1],r[2]]);this.geometry=[k]}setGeometryFromSegment(c){const k=c.endRenderSpace;this.transform=b.fromTranslation(q,k);({points:c}=c.createRenderGeometry(k,this.view.renderCoordsHelper));this.geometry=[c]}setGeometryFromSegments(c,k=e.ZEROS){this.transform=b.fromTranslation(q,k);this.geometry=c.map(m=>m.createRenderGeometry(k,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return null==
this._geometry?null:this._geometry.map(c=>c.map(k=>f.transformMat4(e.create(),k,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(c){this._material.setParameters({renderOccluded:c})}get geometry(){return this._geometry}set geometry(c){this._geometry=c;this.recreateGeometry()}get width(){return this._material.parameters.width}set width(c){this._material.setParameters({width:c})}get color(){return this._material.parameters.color}set color(c){this._material.setParameters({color:c,
writeDepth:1===c[3]})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(c){this._material.setParameters({innerWidth:c})}get innerColor(){return this._material.parameters.innerColor}set innerColor(c){this._material.setParameters({innerColor:c})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(c){null!=this._material&&this._material.setParameters({stipplePattern:c})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(c){this._material.setParameters({stippleOffColor:c})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(c){this._material.setParameters({stipplePreferContinuous:c})}get falloff(){return this._material.parameters.falloff}set falloff(c){this._material.setParameters({falloff:c})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(c){this._material.setParameters({hasPolygonOffset:c})}createExternalResources(){}destroyExternalResources(){}createGeometries(c){for(const k of v.lineStripsToParameters(this.geometry)){const m=
v.createGeometry(this._material,k);c.addGeometry(m)}}forEachExternalMaterial(c){this._hasExternalMaterial||c(this._material)}}const q=g.create();a.LineVisualElement=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/SlicePlaneVisualElement":function(){define("exports ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/SlicePlaneMaterial".split(" "),
function(a,b,g,f,e,n,u){class v extends f.Object3DVisualElement{constructor(t){super(t);this._material=null;this._renderOccluded=n.RenderOccludedFlag.OccludeAndTransparent;this._gridWidth=1;this._gridColor=g.fromValues(1,0,0,1);this._backgroundColor=g.fromValues(1,0,0,1);this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==
t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){b.copy(this._gridColor,t);this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){b.copy(this._backgroundColor,t);this._updateMaterial()}createExternalResources(){this._material=new u.SlicePlaneMaterial(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){null!=this._material&&t(this._material)}createGeometries(t){if(null!=
this._material){const F=e.createSquareGeometry(this._material);t.addGeometry(F)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){null!=this._material&&this._material.setParameters(this._materialParameters)}}a.SlicePlaneVisualElement=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/SlicePlaneMaterial":function(){define("exports ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ShaderTechniqueRepository ../lib/GLMaterial ../lib/Material ../lib/RenderSlot ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ../shaders/SlicePlaneMaterialTechnique".split(" "),
function(a,b,g,f,e,n,u,v,t,F){class E extends t.TriangleMaterial{constructor(k){super(k,c);this.produces=new Map([[n.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,m=>m===b.ShaderOutput.Color]])}get visible(){return!0}createGLMaterial(k){return new q(k)}createBufferWriter(){return new u.DefaultBufferWriter(v.PositionUVLayout)}getConfiguration(){return g.NoConfiguration}}class q extends f{constructor(k){super(k)}beginSlot(k){return this.acquireTechnique(F.SlicePlaneMaterialTechnique,k)}}class c extends F.SlicePlaneMaterialPassParameters{constructor(){super(...arguments);
this.renderOccluded=e.RenderOccludedFlag.Occlude;this.isDecoration=!1}}a.Parameters=c;a.SlicePlaneMaterial=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/DefaultLayouts":function(){define(["exports","../../support/buffer/InterleavedLayout","../lib/VertexAttribute"],function(a,b,g){const f=b.newLayout().vec3f(g.VertexAttribute.POSITION),e=b.newLayout().vec3f(g.VertexAttribute.POSITION).vec2f(g.VertexAttribute.UV0),n=b.newLayout().vec3f(g.VertexAttribute.POSITION).vec4u8(g.VertexAttribute.COLOR);
b=b.newLayout().vec3f(g.VertexAttribute.POSITION).vec2f(g.VertexAttribute.UV0).vec4u8(g.VertexAttribute.OBJECTANDLAYERIDCOLOR);a.PositionColorLayout=n;a.PositionLayout=f;a.PositionUVLayout=e;a.PositionUVLayoutObjectAndLayerId=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique":function(){define("require exports ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../../../../chunks/SlicePlaneMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,g,f,e,n,u,v,t){class F extends f.NoParameters{constructor(){super(...arguments);this.backgroundColor=g.fromValues(1,0,0,.5);this.gridColor=g.fromValues(0,1,0,.5);this.gridWidth=4}}class E extends n.ShaderTechnique{constructor(q,c,k){super(q,c,new e.ReloadableShaderModule(u.SlicePlaneMaterial,()=>new Promise((m,l)=>a(["./SlicePlaneMaterial.glsl"],m,l))),k)}initializePipeline(){return t.makePipelineState({blending:t.blendWithPremultipliedAlpha,depthTest:{func:v.CompareFunction.LESS},colorWrite:t.defaultColorWrite})}}
b.SlicePlaneMaterialPassParameters=F;b.SlicePlaneMaterialTechnique=E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/SlicePlaneMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,g,f,e,n,u){function v(F){const E=new n.ShaderBuilder,{vertex:q,fragment:c,attributes:k,varyings:m}=E;b.addProjViewLocalOrigin(q,F);k.add(u.VertexAttribute.POSITION,"vec3");k.add(u.VertexAttribute.UV0,"vec2");m.add("vUV","vec2");q.main.add(e.glsl`vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);`);c.uniforms.add(new g.Float4PassUniform("backgroundColor",l=>l.backgroundColor),new g.Float4PassUniform("gridColor",l=>l.gridColor),new f.FloatPassUniform("gridWidth",l=>l.gridWidth)).main.add(e.glsl`const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;`);return E}const t=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}));a.SlicePlaneMaterial=t;a.build=v})},"esri/views/3d/interactive/editingTools/transform/extentTransform/ExtentMove":function(){define("exports ../../../../../../core/handleUtils ../../../../../../core/quantityUtils ../../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../../chunks/vec32 ../../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../../geometry/support/vectorStacks ../../../../analysis/Slice/ShiftManipulator ../../../../analysis/Slice/sliceToolUtils ../../dragEventPipeline3D ../../ManipulatorType ../../manipulations/MoveXYObjectManipulation ../../../../../interactive/dragEventPipeline ../../../../../interactive/editGeometry/interfaces ../../../../../interactive/tooltip/infos/TranslateTooltipInfo ../../../../../interactive/tooltip/infos/TranslateZTooltipInfo ../../../../../support/automaticLengthMeasurementUtils ../../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){class H{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(D,w){this._tool=D;this._bounds=w;this._moveZTooltipInfo=this._moveXYTooltipInfo=null;D=this._tool;w=D.view;this.moveXYObjectManipulation=new q.MoveXYObjectManipulation({view:w,tool:D,object:this._object});D.addHandles(this._createMoveXYObjectDragPipeline());this.moveZManipulator=new v.ShiftManipulator(w,v.OffsetMode.CENTER_ON_CALLOUT);this.moveZManipulator.state|=
t.IsShiftEdgeOnScreenFlag;D.manipulators.add(this.moveZManipulator);D.addHandles([this._createMoveZDragPipeline()]);D.addHandles([D.events.on("translate-stop",()=>{this._moveZTooltipInfo=this._moveXYTooltipInfo=null})])}destroy(){this.moveXYObjectManipulation.destroy();this._tool.manipulators.remove(this.moveZManipulator);this.moveZManipulator.destroy()}forEachManipulator(D){this.moveXYObjectManipulation.forEachManipulator(D);D(this.moveZManipulator,E.ManipulatorType.TRANSLATE_Z)}updateManipulators(D,
w){const x=this.moveZManipulator;D=f.rotateZ(u.sm4d.get(),D,Math.PI);D[12]=0;D[13]=0;D[14]=0;x.modelTransform=D;x.renderLocation=e.subtract(u.sv3d.get(),w.origin,w.basis1)}getUpdatedTooltipInfo(){return this.moveXYObjectManipulation.grabbing||this.moveXYObjectManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){var D=this._tool;const w=this._moveXYTooltipInfo??(this._moveXYTooltipInfo=new m.TranslateTooltipInfo({sketchOptions:D.sketchOptions}));
if(this.moveXYObjectManipulation.dragging){var x=this._bounds,C=x.mapBoundsStart.origin;x=x.mapBounds.origin;({renderSpatialReference:D}=D.view);if(!D)return null;C=r.autoDistance2D(C,x,D);if(null==C)return null;w.distance=C}else w.distance=g.zeroMeters;return w}_computeMoveZTooltipInfo(){var D=this._tool;const w=this._moveZTooltipInfo??(this._moveZTooltipInfo=new l.TranslateZTooltipInfo({sketchOptions:D.sketchOptions}));if(this.moveZManipulator.dragging){var x=this._bounds,C=x.mapBoundsStart.origin;
x=x.mapBounds.origin;({renderSpatialReference:D}=D.view);if(!D)return null;C=z.verticalSignedDistance(C,x,D);if(null==C)return null;w.distance=C}else w.distance=g.zeroMeters;return w}_createMoveXYObjectDragPipeline(){return this.moveXYObjectManipulation.createDragPipeline((D,w,x)=>this._applyObjectMoveSteps(w,x))}_createMoveZDragPipeline(){if(!this._operations)return b.makeHandle();const D=this._operations.data.spatialReference;return c.createManipulatorDragEventPipeline(this.moveZManipulator,(w,
x,C)=>{w=n.clone(w.renderLocation);x=x.next(F.screenToZConstrained(this._tool.view,w,D)).next(c.addScreenDelta());this._applyObjectMoveSteps(x,C)})}_applyObjectMoveSteps(D,w){const {_tool:x,_object:C}=this;D=D.next(h=>{"start"===h.action&&(x.inputState={type:"move"},this._bounds.backupMapBounds(),x.events.emit("translate-start",{object:C,dxScreen:h.screenDeltaX,dyScreen:h.screenDeltaY}));return h}).next(c.addMapDelta()).next(this._moveDragUpdateGeometry()).next(h=>{const y={object:C,dxScreen:h.screenDeltaX,
dyScreen:h.screenDeltaY};switch(h.action){case "start":case "update":(h.mapEnd.x-h.mapStart.x||h.mapEnd.y-h.mapStart.y||(h.mapEnd.z??0)-(h.mapStart.z??0))&&x.events.emit("translate",y);break;case "end":x.inputState=null,x.events.emit("translate-stop",y)}return h});w.next(()=>{null!=x.inputState&&x.events.emit("translate-stop",{object:C,dxScreen:0,dyScreen:0});x.cancel()});return D}_moveDragUpdateGeometry(){const D=this._tool;return w=>{if(null==D.inputState||"move"!==D.inputState.type)return w;var x=
"start"===w.action?k.AccumulationBehavior.NEW_STEP:k.AccumulationBehavior.ACCUMULATE_STEPS;this._operations&&(x=this._operations.move(w.mapDeltaX,w.mapDeltaY,w.mapDeltaZ,x),this._bounds.updateMapBoundsFromOperation(x));return w}}}a.ExtentMove=H;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/ShiftManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../core/libs/gl-matrix-2/math/quat ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/vectorStacks ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/RenderObject ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D){function w({offsetMode:y,tubeMaterial:d,tipMaterial:B,capMaterial:p,outlineMaterial:A,calloutMaterial:G}){const I=y===a.OffsetMode.CENTER_ON_CALLOUT?E.shiftRestartOffsetDistance:0,J=[t.fromValues(I,0,-E.shiftRestartArrowLength/2),t.fromValues(I,0,E.shiftRestartArrowLength/2)];y=C(J);d=x({vertices:J,padding:0,materials:{tube:d,tip:B,cap:p}});A=x({vertices:J,padding:E.shiftRestartArrowOutlineWidth,materials:{tube:A,tip:A,cap:A}});B=l.createPolylineGeometry(G,
[[I,0,0],[I-E.shiftRestartOffsetDistance,0,0]]);G=l.createPolylineGeometry(G,[[I,0,0],[I-E.shiftRestartOffsetDistance,0,0]]);return{renderObjects:[...d.normal.map(L=>new k.RenderObject(L,D.ManipulatorStateFlags.Unfocused|q.DidPointerMoveRecentlyFlag)),...A.normal.map(L=>new k.RenderObject(L,D.ManipulatorStateFlags.Unfocused|q.DidPointerMoveRecentlyFlag)),new k.RenderObject(B,D.ManipulatorStateFlags.Unfocused|q.DidPointerMoveRecentlyFlag|q.IsShiftEdgeOnScreenFlag),...d.focused.map(L=>new k.RenderObject(L,
D.ManipulatorStateFlags.Focused|q.DidPointerMoveRecentlyFlag)),...A.focused.map(L=>new k.RenderObject(L,D.ManipulatorStateFlags.Focused|q.DidPointerMoveRecentlyFlag)),new k.RenderObject(G,D.ManipulatorStateFlags.Focused|q.DidPointerMoveRecentlyFlag|q.IsShiftEdgeOnScreenFlag)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[y]},collisionPriority:1,radius:E.shiftRestartTipRadius,state:q.DidPointerMoveRecentlyFlag}}function x({vertices:y,padding:d,materials:B}){const p=A=>{const G=y.slice();
var I=v.subtract(F.sv3d.get(),G[0],G[1]);v.normalize(I,I);var J=v.subtract(F.sv3d.get(),G[G.length-1],G[G.length-2]);v.normalize(J,J);if(0<d){var L=v.scale(t.create(),J,-d);G[G.length-1]=v.add(L,L,G[G.length-1]);L=v.scale(t.create(),I,-d);G[0]=v.add(L,L,G[0])}L=A?E.shiftRestartTipFocusMultiplier:1;var M=E.shiftRestartTipLength*L;const N=E.shiftRestartTipRadius*L;L=e.identity(F.sm4d.get());if(0<d){var K=M/4,O=v.set(F.sv3d.get(),0,K,0);K=1+d/K;e.translate(L,L,O);e.scale(L,L,v.set(F.sv3d.get(),K,K,K));
e.translate(L,L,v.scale(O,O,-1/K))}K=e.identity(n.create());O=t.fromValues(0,1,0);J=e.fromQuat(n.create(),u.rotationTo(F.sq4d.get(),O,J));J[12]=G[G.length-1][0];J[13]=G[G.length-1][1];J[14]=G[G.length-1][2];e.multiply(J,J,L);A=E.shiftRestartTubeRadius*(A?E.shiftRestartTubeFocusMultiplier:1)+d;var U=B.tube;const V=[];for(let ea=0;12>ea;ea++){const Y=ea/12*2*Math.PI;V.push([Math.cos(Y)*A,Math.sin(Y)*A])}A=l.createPathExtrusionGeometry(U,V,G,[],[],!1);A.transformation=K;A=[A];K=l.createConeGeometry(B.tip,
M,N,24,!1,!1,!0);K.transformation=J;A.push(K);M=l.createConeGeometry(B.cap,M,N,24,!1,!0,!1);M.transformation=J;A.push(M);I=e.fromQuat(n.create(),u.rotationTo(F.sq4d.get(),O,I));I[12]=G[0][0];I[13]=G[0][1];I[14]=G[0][2];e.multiply(I,I,L);A.push(K.instantiate({transformation:I}));A.push(M.instantiate({transformation:I}));return A};return{normal:p(!1),focused:p(!0)}}function C(y,d){d=v.subtract(t.create(),y[y.length-1],y[y.length-2]);v.normalize(d,d);v.scale(d,d,E.shiftRestartTipLength);v.add(d,d,y[y.length-
1]);const B=v.subtract(t.create(),y[0],y[1]);v.normalize(B,B);v.scale(B,B,E.shiftRestartTipLength);v.add(B,B,y[0]);return[B,...y,d]}a.OffsetMode=void 0;(function(y){y[y.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT";y[y.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(a.OffsetMode||(a.OffsetMode={}));class h extends c.Manipulator3D{constructor(y,d){const B=new H.RibbonLineMaterial({width:1,renderOccluded:r.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0}),p=new z.ColorMaterial({cullFace:m.CullFaceOptions.Back,
renderOccluded:r.RenderOccludedFlag.Opaque,isDecoration:!0}),A=new z.ColorMaterial({cullFace:m.CullFaceOptions.Back,renderOccluded:r.RenderOccludedFlag.Opaque,isDecoration:!0}),G=new z.ColorMaterial({cullFace:m.CullFaceOptions.Back,renderOccluded:r.RenderOccludedFlag.Opaque,isDecoration:!0}),I=new z.ColorMaterial({writeDepth:!1,cullFace:m.CullFaceOptions.Front,renderOccluded:r.RenderOccludedFlag.Transparent,isDecoration:!0});super({view:y,...w({offsetMode:d,tubeMaterial:p,tipMaterial:A,capMaterial:G,
outlineMaterial:I,calloutMaterial:B})});this._themeHandle=f.watch(()=>y.effectiveTheme.accentColor,J=>{const L=g.getContrast(J),M=b.toUnitRGBA(J),N=b.toUnitRGBA(L),K=b.toUnitRGBA(b.blendColors(L,J,.4));J=b.toUnitRGBA(b.blendColors(L,J,.14));B.setParameters({color:M});p.setParameters({color:J});A.setParameters({color:N});G.setParameters({color:K});I.setParameters({color:M})},f.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ShiftManipulator=h;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/extentTransform/ExtentRotate":function(){define("exports ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../../chunks/vec32 ../../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../../chunks/boundedPlane ../../../../../../geometry/support/plane ../../../../../../geometry/support/vectorStacks ../../../../analysis/images/Factory ../../../../analysis/Slice/RotateManipulator ../../../../analysis/Slice/sliceToolUtils ../../../manipulatorUtils ../../dragEventPipeline3D ../../ManipulatorType ../../../../support/geometryUtils/ray ../../../../../interactive/dragEventPipeline ../../../../../interactive/editGeometry/interfaces ../../../../../interactive/editGeometry/operations/UpdateVertices ../../../../../interactive/tooltip/infos/ExtentRotateTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H){class D{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(w,x,C){this._tool=w;this._bounds=x;this._snapRotation=C;this._rotateTooltipInfo=null;this._endAngle=this._startAngle=0;w=this._tool;const h=w.view,y=!h._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new F.RotateManipulator(h,(d,B)=>t.getRotateHeadingTexture(h.textures,{accentColor:d,contrastColor:B,
preMultiplyAlpha:y}));w.addHandles([this.rotateManipulator.events.on("grab-changed",d=>this._onRotateGrab(d)),this._createRotateDragPipeline(this.rotateManipulator)]);w.manipulators.add(this.rotateManipulator);w.addHandles([w.events.on("rotate-start",d=>this._startAngle=d.angle),w.events.on("rotate",d=>this._endAngle=d.angle),w.events.on("rotate-stop",()=>{this._endAngle=this._startAngle=0})])}destroy(){this._tool.manipulators.remove(this.rotateManipulator);this.rotateManipulator.destroy()}forEachManipulator(w){w(this.rotateManipulator,
k.ManipulatorType.ROTATE)}updateManipulators(w,x){const C=0>this._bounds.mapBounds.plane[2]?Math.PI:0;w=g.rotateX(v.sm4d.get(),w,C);w[12]=0;w[13]=0;w[14]=0;this.rotateManipulator.modelTransform=w;this.rotateManipulator.renderLocation=f.add(v.sv3d.get(),x.origin,x.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){const w=this._rotateTooltipInfo??(this._rotateTooltipInfo=new H.ExtentRotateTooltipInfo({sketchOptions:this._tool.sketchOptions}));
w.angle=this._startAngle-this._endAngle;return w}_onRotateGrab({action:w,screenPoint:x}){const C=this._tool,h=this._bounds;"start"===w&&x&&(w=E.createRotatePlane(h.displayBounds,C.view.renderCoordsHelper,E.RotationAxis.HEADING,u.create()),x=m.fromScreenNormalized(C.view.state.camera,x),u.intersectRay(w,x,v.sv3d.get())&&(h.backupMapBounds(),C.inputState={type:"rotate",rotatePlane:w}))}_createRotateDragPipeline(w){const {_tool:x,_object:C}=this;return l.createManipulatorDragEventPipeline(w,(h,y,d)=>
{h=x.inputState;null!=h&&(y.next(B=>{"start"===B.action&&x.events.emit("rotate-start",{object:C,angle:0});return B}).next(c.screenToRenderPlane(x.view,h.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(h)).next(...this._snapRotation()).next(this._rotateDragUpdateGeometry()).next(B=>{const p={object:C,angle:b.rad2deg(B.rotateAngle)};switch(B.action){case "start":case "update":x.events.emit("rotate",p);break;case "end":x.inputState=null,x.events.emit("rotate-stop",p)}return B}),d.next(()=>{null!=
x.inputState&&x.events.emit("rotate-stop",{object:C,angle:0});x.cancel()}))})}_rotateDragRenderPlaneToRotate(w){return x=>{const C=u.getNormal(w.rotatePlane),h=q.calculateInputRotationTransform(x.renderStart,x.renderEnd,this._bounds.displayBounds.origin,C);return{...x,rotateAxis:C,rotateAngle:h}}}_rotateDragUpdateGeometry(){const w=this._bounds;return x=>{var C=f.copy(e.create(),w.mapBoundsStart.origin);const h="start"===x.action?r.AccumulationBehavior.NEW_STEP:r.AccumulationBehavior.ACCUMULATE_STEPS;
this._operations&&(C=this._operations.rotate(C,x.rotateAngle,h,z.AccumulationType.REPLACE),n.copy(w.mapBoundsStart,w.mapBounds),w.updateMapBoundsFromOperation(C));return x}}}a.ExtentRotate=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/Factory":function(){define(["exports","./generateTextures","./heading-rotate-svg","./tilt-rotate-svg","../../webgl-engine/lib/Texture"],function(a,b,g,f,e){a.getRotateHeadingTexture=function(n,u){const {accentColor:v,
contrastColor:t,preMultiplyAlpha:F}=u;return n.fromData(`heading-rotate:[accent:${v},contrast:${t},size:${64}]`,()=>new e.Texture(b.generateStyledTexture(g,{accentColor:v,contrastColor:t,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:F}))};a.getTiltRotateTexture=function(n,u){const {accentColor:v,contrastColor:t,preMultiplyAlpha:F}=u;return n.fromData(`tilt-rotate:[accent:${v},contrast:${t},size:${64}]`,()=>new e.Texture(b.generateStyledTexture(f,{accentColor:v,contrastColor:t,size:64}),{mipmap:!0,
reloadable:!0,preMultiplyAlpha:F}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/generateTextures":function(){define(["exports"],function(a){function b(g,{accentColor:f,contrastColor:e}){const n=f.toHex();f=f.a;const u=e.toHex();e=e.a;const v=g.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem("theme-style");v&&(v.innerHTML=`\n      .contrast-fill { fill: ${u}; fill-opacity: ${e}; }\n      .contrast-stroke { stroke: ${u}; stroke-opacity: ${e};  }\n      .accent-fill { fill: ${n}; fill-opacity: ${f}; }\n      .accent-stroke { stroke: ${n}; stroke-opacity:  ${f}; }`);
return g}a.generateStyledTexture=function(g,f){g=g.split(",")[1];g=atob(g);g=(new DOMParser).parseFromString(g,"image/svg+xml");g=b(g,f);g=(new XMLSerializer).serializeToString(g);g=`data:image/svg+xml;base64,${btoa(g)}`;f=f.size;f=new Image(f,f);f.src=g;return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/heading-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NiIgY2xhc3M9ImFjY2VudC1maWxsIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI0Ljk5IiBkPSJNMjAuMDUgNDAuODZhMTUuMDUgMTUuMDUgMCAwIDAgMTcuMTQtMS41IDE1LjA1IDE1LjA1IDAgMCAwIDQuNDctMTYuNjUgMTUuMDUgMTUuMDUgMCAwIDAtMjIuNzItNy4xNSAxNS4wNSAxNS4wNSAwIDAgMC01LjUgNy4xNSIgY2xhc3M9ImNvbnRyYXN0LXN0cm9rZSIvPjxwYXRoIGQ9Im0xMC45NyAzNS41NyA1LjM4IDEyLjA3IDcuNzktMTMuNDd6IiBjbGFzcz0iY29udHJhc3QtZmlsbCIvPjwvc3ZnPg\x3d\x3d"})},
"esri/views/3d/analysis/images/tilt-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxjaXJjbGUgY3g9IjM5LjQ3OCIgY3k9IjMuMDc4IiByPSIyOCIgY2xhc3M9ImFjY2VudC1maWxsIiB0cmFuc2Zvcm09InJvdGF0ZSg0MC41NDIpIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI1IiBkPSJtNy4wNzQgMzAuMDUzIDI5LjM5NyAxMS45ODUtMy42NzMtMzMuNDkzIiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyLjk5NiIgZD0iTTI0LjUwNCAyMy4yMDdhMTEuOTggMTEuOTggMCAwIDAtOS44IDcuNTA3IiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIGNvbnRyYXN0LWZpbGwiLz48cGF0aCBkPSJtMjkuODE4IDIyLjgwOC02LjE4NCA0LjYtLjU0MS04LjM2NHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+"})},
"esri/views/3d/analysis/Slice/RotateManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ImageMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l){function r({imageMaterial:H,calloutMaterial:D}){const {focusMultiplier:w,calloutLength:x,discRadius:C}=u.rotateManipulatorDefaults,h=C*w,y=(p,A)=>{const G=[0,1,2,2,3,0];return new F.Geometry(A,[[c.VertexAttribute.POSITION,new t.Attribute([x-p,-p,0,x+p,-p,0,x+p,p,0,x-p,p,0],G,3,!0)],[c.VertexAttribute.UV0,new t.Attribute([0,0,1,0,1,1,0,1],G,2,!0)]])},d=E.createPolylineGeometry(D,[[0,0,0],[x-C,0,0]]);D=E.createPolylineGeometry(D,[[0,0,0],[x-h,0,0]]);const B=
e.DidPointerMoveRecentlyFlag;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[x,0,0]},focusMultiplier:w,radius:C,renderObjects:[new v.RenderObject(y(C,H),l.ManipulatorStateFlags.Unfocused|B),new v.RenderObject(d,l.ManipulatorStateFlags.Unfocused|B),new v.RenderObject(y(h,H),l.ManipulatorStateFlags.Focused|B),new v.RenderObject(D,l.ManipulatorStateFlags.Focused|B)],state:B}}class z extends n.Manipulator3D{constructor(H,D){const w=new k.ImageMaterial({writeDepth:!1,
renderOccluded:q.RenderOccludedFlag.Opaque,isDecoration:!0}),x=new m.RibbonLineMaterial({width:u.rotateManipulatorDefaults.calloutWidth,renderOccluded:q.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});super({view:H,...r({imageMaterial:w,calloutMaterial:x})});this._currentTexture=null;this._themeHandle=f.watch(()=>H.effectiveTheme.accentColor,C=>{var h=g.multiplyOpacity(C,.5);const y=g.getContrast(C),d=this._currentTexture;h=D(h,y);w.setParameters({textureId:h.texture.id});x.setParameters({color:b.toUnitRGBA(C)});
this._currentTexture=h;d?.release()},f.initial)}destroy(){this._themeHandle.remove();this._currentTexture?.release();super.destroy()}}a.RotateManipulator=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ImageMaterial":function(){define("exports ../../../../geometry/support/buffer/BufferView ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLTextureMaterial ../lib/Material ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ./internal/bufferWriterUtils ../shaders/ImageMaterialTechnique ../shaders/ImageMaterialTechniqueConfiguration".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l){class r extends c.TriangleMaterial{constructor(w){super(w,D);this._configuration=new l.ImageMaterialTechniqueConfiguration;this.vertexAttributeLocations=m.vertexAttributeLocations;this.supportsEdges=!0;this.produces=new Map([[v.RenderSlot.OPAQUE_MATERIAL,x=>g.isHighlightOrOID(x)],[v.RenderSlot.TRANSPARENT_MATERIAL,x=>g.isColor(x)&&this.parameters.writeDepth],[v.RenderSlot.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,x=>g.isColor(x)&&!this.parameters.writeDepth],[v.RenderSlot.DRAPED_MATERIAL,
x=>g.isColor(x)||g.isHighlightOrOID(x)]])}getConfiguration(w,x){this._configuration.output=w;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.hasOccludees=x.hasOccludees;this._configuration.oitPass=x.oitPass;this._configuration.enableOffset=x.camera.relativeElevation<u.OITPolygonOffsetLimit;this._configuration.terrainDepthTest=x.terrainDepthTest;this._configuration.cullAboveTerrain=
x.cullAboveTerrain;this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation;return this._configuration}get visible(){return!0}createGLMaterial(w){return new z(w)}createBufferWriter(){const w=q.PositionUVLayout.clone();this.parameters.perspectiveInterpolation&&w.f32(F.VertexAttribute.PERSPECTIVEDIVIDE);return new H(w)}}class z extends e.GLTextureMaterial{constructor(w){super({...w,...w.material.parameters})}beginSlot(w){this.updateTexture(this._material.parameters.textureId);
this._material.setParameters(this.textureBindParameters);return this.acquireTechnique(m.ImageMaterialTechnique,w)}}class H extends E.DefaultBufferWriter{write(w,x,C,h,y,d){for(const B of this.vertexBufferLayout.fields.keys())if(h=C.get(B))if(B===F.VertexAttribute.PERSPECTIVEDIVIDE){t.assert(1===h.size);const p=y.getField(B,b.BufferViewFloat);p&&k.writeBufferFloat(h,p,d)}else k.writeDefaultAttribute(B,h,w,x,y,d)}}class D extends n.MaterialParameters{constructor(){super(...arguments);this.writeDepth=
!0;this.hasSlicePlane=!1;this.cullFace=f.CullFaceOptions.None;this.opacity=1;this.textureId=null;this.initTextureTransparent=!0;this.perspectiveInterpolation=!1}}a.ImageMaterial=r;a.Parameters=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ImageMaterialTechnique":function(){define("require exports ../core/shaderLibrary/ShaderOutput ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/OITPass ../lib/OrderIndependentTransparency ../lib/StencilUtils ../lib/VertexAttribute ../../../../chunks/ImageMaterial.glsl ../../../webgl/renderState".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q){class c extends f.NoParameters{}class k extends n.ShaderTechnique{constructor(l,r,z){super(l,r,new e.ReloadableShaderModule(E.ImageMaterial,()=>new Promise((H,D)=>a(["./ImageMaterial.glsl"],H,D))),z,m)}_getPipelineState(l,r){const {oitPass:z,output:H,hasOccludees:D,enableOffset:w,cullFace:x}=l,C=z===u.OITPass.NONE,h=z===u.OITPass.FrontFace;return q.makePipelineState({blending:H===g.ShaderOutput.Color?C?q.blendWithPremultipliedAlpha:v.oitBlending(z):null,culling:q.cullingParams(x),
depthTest:{func:v.oitDepthTest(z)},depthWrite:v.depthWrite(l),drawBuffers:v.getDrawBuffers(z,H),colorWrite:q.defaultColorWrite,stencilWrite:D?t.stencilWriteMaskOn:null,stencilTest:D?r?t.stencilToolMaskBaseParams:t.stencilBaseAllZerosParams:null,polygonOffset:C||h?null:v.getOITPolygonOffset(w)})}initializePipeline(l){this._occludeePipeline=this._getPipelineState(l,!0);return this._getPipelineState(l,!1)}getPipeline(l){return l?this._occludeePipeline:super.getPipeline()}}const m=new Map([[F.VertexAttribute.POSITION,
0],[F.VertexAttribute.UV0,2],[F.VertexAttribute.PERSPECTIVEDIVIDE,3]]);b.ImageMaterialPassParameters=c;b.ImageMaterialTechnique=k;b.vertexAttributeLocations=m;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ImageMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform ../views/3d/webgl-engine/lib/VertexAttribute ../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k){function m(r){const z=new E.ShaderBuilder,{vertex:H,fragment:D}=z;v.addProjViewLocalOrigin(H,r);z.include(f.Transform,r);z.include(n.terrainDepthTest,r);z.include(g.SliceDraw,r);z.include(e.ObjectAndLayerIdColor,r);z.include(k.outputColorHighlightOID,r);z.attributes.add(c.VertexAttribute.POSITION,"vec3");z.attributes.add(c.VertexAttribute.UV0,"vec2");r.perspectiveInterpolation&&z.attributes.add(c.VertexAttribute.PERSPECTIVEDIVIDE,"float");z.varyings.add("vpos",
"vec3");r.terrainDepthTest&&z.varyings.add("depth","float");H.main.add(F.glsl`
    vpos = position;
    ${r.terrainDepthTest?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
    vTexCoord = uv0;
    gl_Position = transformPosition(proj, view, vpos);
    ${r.perspectiveInterpolation?"gl_Position *\x3d perspectiveDivide;":""}`);D.uniforms.add(new q.Texture2DPassUniform("tex",w=>w.texture),new t.FloatPassUniform("opacity",w=>w.opacity));z.varyings.add("vTexCoord","vec2");D.include(u.ColorConversion);D.main.add(F.glsl`
    discardBySlice(vpos);
    ${r.terrainDepthTest?"terrainDepthTest(depth);":""}
    ${r.output===b.ShaderOutput.ObjectAndLayerIdColor?"fragColor \x3d vec4(0, 0, 0, 1);\n           return;":""}
    vec4 finalColor = texture(tex, vTexCoord) * opacity;
    outputColorHighlightOID(finalColor, vpos);`);return z}const l=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:"Module"}));a.ImageMaterial=l;a.build=m})},"esri/views/3d/webgl-engine/shaders/ImageMaterialTechniqueConfiguration":function(){define("exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl ../core/shaderLibrary/output/Emissions.glsl ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../materials/DefaultTechniqueConfiguration".split(" "),
function(a,b,g,f,e,n,u){class v extends u.DefaultTechniqueConfiguration{constructor(){super(...arguments);this.cullFace=n.CullFaceOptions.None;this.hasSlicePlane=!1;this.writeDepth=this.enableOffset=!0;this.cullAboveTerrain=this.terrainDepthTest=this.hasOccludees=!1;this.perspectiveInterpolation=!0;this.textureCoordinateType=g.TextureCoordinateType.None;this.emissionSource=f.EmissionSource.None;this.discardInvisibleFragments=!0;this.objectAndLayerIdColorInstanced=this.occlusionPass=!1}}b.__decorate([e.parameter({count:n.CullFaceOptions.COUNT})],
v.prototype,"cullFace",void 0);b.__decorate([e.parameter()],v.prototype,"hasSlicePlane",void 0);b.__decorate([e.parameter()],v.prototype,"enableOffset",void 0);b.__decorate([e.parameter()],v.prototype,"writeDepth",void 0);b.__decorate([e.parameter()],v.prototype,"hasOccludees",void 0);b.__decorate([e.parameter()],v.prototype,"terrainDepthTest",void 0);b.__decorate([e.parameter()],v.prototype,"cullAboveTerrain",void 0);b.__decorate([e.parameter()],v.prototype,"perspectiveInterpolation",void 0);a.ImageMaterialTechniqueConfiguration=
v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/ExtentRotateTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,b,g,f,e,n,u,v){a.ExtentRotateTooltipInfo=class extends v.SketchTooltipInfo{constructor(t){super(t);
this.type="extent-rotate";this.angle=0}};b.__decorate([g.property()],a.ExtentRotateTooltipInfo.prototype,"type",void 0);b.__decorate([g.property()],a.ExtentRotateTooltipInfo.prototype,"angle",void 0);a.ExtentRotateTooltipInfo=b.__decorate([u.subclass("esri.views.interactive.tooltip.infos.ExtentRotateTooltipInfo")],a.ExtentRotateTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/extentTransform/ExtentScale":function(){define("exports ../../../../../../core/libs/gl-matrix-2/math/vec2 ../../../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../../../chunks/vec32 ../../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../../chunks/boundedPlane ../../../../../../geometry/support/plane ../../../../../../geometry/support/vectorStacks ../../../../analysis/Slice/ResizeManipulator ../../../../analysis/Slice/sliceToolUtils ../../dragEventPipeline3D ../../ManipulatorType ./extentUtils ../../../../support/geometryUtils/ray ../../../../../interactive/dragEventPipeline ../../../../../interactive/editGeometry/interfaces ../../../../../interactive/editGeometry/operations/UpdateVertices ../../../../../interactive/tooltip/infos/ExtentScaleTooltipInfo".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){class H{get _object(){return this._tool.object}get _operations(){return this._object.operations}get zMax(){if(!this._zMaxDirty||!this._operations)return this._zMax;var D=this._operations.data;if(D.geometry.hasZ){const w=D.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const x of D.components)for(const C of x.vertices)D=w.getZ(C.pos)??0,this._zMax=Math.max(D,this._zMax)}else this._zMax=0;this._zMaxDirty=!1;return this._zMax}constructor(D,w,x){this._tool=
D;this._bounds=w;this._preserveAspectRatioStep=x;this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}];this._displayBoundsStart=n.create();this._zMax=this._displayBoundsMarginStart=0;this._zMaxDirty=!0;const C=this._tool,h=C.view;this.resizeManipulators=this._resizeHandles.map(y=>{const d=new t.ResizeManipulator(h,y);C.addHandles([d.events.on("grab-changed",B=>this._onResizeGrab(B)),
this._createResizeDragPipeline(d,y)]);return d});C.manipulators.addMany(this.resizeManipulators);this._operations&&C.addHandles(this._operations.data.on("change",()=>{"resize"!==C.inputState?.type&&(this._zMaxDirty=!0)}))}destroy(){this.forEachManipulator(D=>{this._tool.manipulators.remove(D);D.destroy()})}forEachManipulator(D){this.resizeManipulators.forEach(w=>D(w,q.ManipulatorType.SCALE))}updateManipulators(D,w){this.resizeManipulators.forEach((x,C)=>{F.updateResizeHandle(x,this._resizeHandles[C],
D,w)})}getUpdatedTooltipInfo(){if(!this.resizeManipulators.some(x=>x.focused))return null;const D=this._tooltipInfo??(this._tooltipInfo=new z.ExtentScaleTooltipInfo({sketchOptions:this._tool.sketchOptions})),w=c.mapPlaneAutoSize2D(this._bounds.mapBounds,this.zMax,this._bounds.spatialReference);w&&(D.xSize=w.xSize,D.ySize=w.ySize);this.resizeManipulators.some(x=>x.dragging)||(D.xScale=1,D.yScale=1);return D}_onResizeGrab({action:D,screenPoint:w}){const x=this._tool,C=this._bounds;"start"===D&&w&&(D=
k.fromScreenNormalized(x.view.state.camera,w),u.intersectRay(C.displayBounds.plane,D,v.sv3d.get())&&(C.backupMapBounds(),n.copy(C.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=C.displayBoundsMargin,x.inputState={type:"resize"}))}_createResizeDragPipeline(D,w){const {_tool:x,_object:C}=this;return m.createManipulatorDragEventPipeline(D,(h,y,d)=>{null!=x.inputState&&(y.next(B=>{"start"===B.action&&x.events.emit("scale-start",{object:C,xScale:1,yScale:1});return B}).next(E.screenToRenderPlane(x.view,
this._displayBoundsStart.plane)).next(B=>({...B,handle:w})).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next(B=>{var p=this._tooltipInfo;p&&(p.xScale=B.factor1,p.yScale=B.factor2);p={object:C,xScale:B.factor1,yScale:B.factor2};switch(B.action){case "start":case "update":x.events.emit("scale",p);break;case "end":x.inputState=null,x.events.emit("scale-stop",p)}return B}),d.next(()=>{null!=x.inputState&&x.events.emit("scale-stop",
{object:C,xScale:1,yScale:1});x.cancel()}))})}_resizeDragRenderPlaneToFactors(){const D=this._bounds;return w=>{const x=this._displayBoundsStart,C=w.handle.direction,h=D.displayBoundsMargin,y=this._displayBoundsMarginStart;var d=f.copy(v.sv3d.get(),x.origin);f.scaleAndAdd(d,d,x.basis1,-C[0]);f.scaleAndAdd(d,d,x.basis2,-C[1]);const B=f.subtract(v.sv3d.get(),w.renderEnd,d),p=f.subtract(v.sv3d.get(),w.renderStart,d),A=F.isDiagonalResizeHandle(w.handle);d=F.calculateDiagonalResizeHandleScale(x);const G=
F.calculateDiagonalResizeHandleScale(D.displayBounds)/d;d=(I,J)=>{if(0===I)return 1;let L=f.length(J),M=.5*I*f.dot(J,B)/L;const N=0>M?-1:1;A&&(I=L-.5*I*f.dot(J,p)/L,M+=I*N*G);I=L<1.5*y?1:1E-6;L=Math.max(L-y,1E-6);0<N&&(M-=h);return N*Math.max(M/L*N,I)};return{...w,factor1:d(C[0],x.basis1),factor2:d(C[1],x.basis2)}}}_resizeDragUpdateGeometry(){const D=this._bounds;return w=>{var x=f.copy(e.create(),D.mapBoundsStart.origin);f.scaleAndAdd(x,x,D.mapBoundsStart.basis1,-w.handle.direction[0]);f.scaleAndAdd(x,
x,D.mapBoundsStart.basis2,-w.handle.direction[1]);const C=b.set(g.create(),D.mapBoundsStart.basis1[0],D.mapBoundsStart.basis1[1]);b.normalize(C,C);const h="start"===w.action?l.AccumulationBehavior.NEW_STEP:l.AccumulationBehavior.ACCUMULATE_STEPS;this._operations&&(x=this._operations.scale(x,C,w.factor1,w.factor2,h,r.AccumulationType.REPLACE),n.copy(D.mapBoundsStart,D.mapBounds),D.updateMapBoundsFromOperation(x));return w}}}a.ExtentScale=H;a.scaleEpsilon=1E-6;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/analysis/Slice/ResizeManipulator":function(){define("exports ../../../../Color ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/factories/vec3f64 ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),function(a,
b,g,f,e,n,u,v,t,F,E,q,c){function k({isCorner:l,unfocusedMaterial:r,focusedMaterial:z,outlineMaterial:H}){const D=l?[f.fromValues(1,0,0),f.fromValues(0,0,0),f.fromValues(0,1,0)]:[f.fromValues(1,0,0),f.fromValues(-1,0,0)];return{renderObjects:[new t.RenderObject(F.createPolylineGeometry(r,D),c.ManipulatorStateFlags.Unfocused|n.resizeNormal),new t.RenderObject(F.createPolylineGeometry(z,D),c.ManipulatorStateFlags.Focused|n.resizeNormal),new t.RenderObject(F.createPolylineGeometry(H,D),n.resizeOutlineOnly)],
collisionType:{type:"line",paths:[D]},radius:l?e.resizeHandleCornerInputRadius:e.resizeHandleEdgeInputRadius,state:n.resizeNormal}}class m extends u.Manipulator3D{constructor(l,r){const z=(r=n.isDiagonalResizeHandle(r))?e.resizeHandleCornerWidth:e.resizeHandleEdgeWidth,H=z*e.displayFocusMultiplier,D=e.resizeHandleEdgeWidth,w={renderOccluded:E.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0},x=new q.RibbonLineMaterial({...w,width:z}),C=new q.RibbonLineMaterial({...w,width:H}),h=new q.RibbonLineMaterial({...w,
width:D});super({view:l,...v.worldScaledManipulatorSettings,...k({isCorner:r,unfocusedMaterial:x,focusedMaterial:C,outlineMaterial:h})});this._themeHandle=g.watch(()=>l.effectiveTheme.accentColor,y=>{y=b.toUnitRGBA(y);x.setParameters({color:y});C.setParameters({color:y});h.setParameters({color:y})},g.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ResizeManipulator=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/extentTransform/extentUtils":function(){define("exports ../../../../../../core/reactiveUtils ../../../../../../core/libs/gl-matrix-2/math/vec2 ../../../../../../chunks/vec32 ../../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../../chunks/boundedPlane ../../../../../../geometry/support/vectorStacks ../../geometryUtils ../../manipulatedObjectUtils ../../../../layers/graphics/elevationAlignmentUtils ../../../../layers/graphics/ElevationContext ../../../../../interactive/editGeometry/support/editPlaneUtils ../../../../../support/extentUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c){function k(D,w,x,C=0,h){h||=n.create();w.toRenderCoords(D.origin,x,h.origin);var y=u.sv3d.get();f.add(y,D.origin,D.basis1);f.add(y,y,D.basis2);w.toRenderCoords(y,x,y);var d=u.sv3d.get();f.add(d,D.origin,D.basis1);f.subtract(d,d,D.basis2);w.toRenderCoords(d,x,d);const B=u.sv3d.get();f.subtract(B,D.origin,D.basis1);f.subtract(B,B,D.basis2);w.toRenderCoords(B,x,B);const p=u.sv3d.get();f.subtract(p,D.origin,D.basis1);f.add(p,p,D.basis2);w.toRenderCoords(p,x,p);D=f.lerp(u.sv3d.get(),
y,d,.5);f.subtract(D,D,h.origin);w=f.lerp(u.sv3d.get(),B,p,.5);f.subtract(w,h.origin,w);f.lerp(h.basis1,D,w,.5);y=f.lerp(u.sv3d.get(),p,y,.5);f.subtract(y,y,h.origin);d=f.lerp(u.sv3d.get(),d,B,.5);f.subtract(d,h.origin,d);f.lerp(h.basis2,y,d,.5);d=f.cross(u.sv3d.get(),h.basis1,h.basis2);d=f.cross(d,d,h.basis1);f.normalize(d,d);f.scale(h.basis2,d,f.dot(h.basis2,d));f.scale(h.basis1,h.basis1,1+C/f.length(h.basis1));f.scale(h.basis2,h.basis2,1+C/f.length(h.basis2));n.updateUnboundedPlane(h);return h}
class m{constructor(D,w){this._tool=D;this.mapBounds=n.create();this.mapBoundsStart=n.create();this.displayBounds=n.create();D.addHandles(b.on(()=>D.object,"modified-externally",()=>this._resetMapBounds(),{onListenerAdd:()=>this._resetMapBounds()}));this._onDisplayBoundsChanged=w}get displayBoundsMargin(){const {view:D,object:w}=this._tool;var x=t.manipulatedObjectGeometry(w);return(x=D.pointsOfInterest?.centerOnSurfaceFrequent.location??x?.extent?.center)?10*D.pixelSizeAt(x):0}backupMapBounds(){n.copy(this.mapBounds,
this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds();this._onDisplayBoundsChanged?.()}updateMapBoundsFromOperation(D){q.apply(D,this.mapBounds);this.updateDisplayBounds()}updateMapBoundsFromOperationInverse(D){q.applyInverse(D,this.mapBounds);this.updateDisplayBounds()}_resetMapBounds(){this._calculateMapBounds();this.updateDisplayBounds()}_calculateMapBounds(){const {view:D,attachmentOrigin:w,object:x}=this._tool,C=x.operations?.data;if(C){var h=C.geometry;this.spatialReference=
h.spatialReference;var y=v.mainAxis(h);g.scale(y,y,-1);h=w?D.pixelSizeAt(w,h.spatialReference):0;q.calculateOrientedBounds(y,C,80*h,this.mapBounds)}}_calculateDisplayBounds(){const {view:D,attachmentOrigin:w}=this._tool,x=w?.z??F.evaluateElevationAlignmentAtPoint(this.mapBounds.origin,D.elevationProvider,E.ElevationContext.fromElevationInfo(this._tool.object.elevationInfo),D.renderCoordsHelper),C=n.copy(this.mapBounds);C.origin[2]=x??0;k(C,D.renderCoordsHelper,this.spatialReference,this.displayBoundsMargin,
this.displayBounds)}}const l=e.create(),r=e.create(),z=e.create(),H=e.create();a.TransformBounds=m;a.mapPlaneAutoSize2D=function(D,w,x){f.subtract(H,f.subtract(H,D.origin,D.basis1),D.basis2);f.scaleAndAdd(z,H,D.basis1,2);f.scaleAndAdd(r,z,D.basis2,2);f.scaleAndAdd(l,H,D.basis2,2);H[2]=z[2]=r[2]=l[2]=w;return c.autoSize2D({topLeft:l,topRight:r,bottomRight:z,bottomLeft:H,spatialReference:x})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/support/editPlaneUtils":function(){define("exports ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/boundedPlane ../../../../geometry/support/vectorStacks ../operations/MoveVertex ../operations/RotateVertex ../operations/ScaleVertex ../operations/UpdateVertices".split(" "),
function(a,b,g,f,e,n,u,v,t,F){function E(m,l,r){if(m instanceof F.UpdateVertices){if(m.operation instanceof u.MoveVertex)return q(m.operation,l,r),!0;if(m.operation instanceof v.RotateVertex)return c(m.operation,l,r),!0;if(m.operation instanceof t.ScaleVertex)return k(m.operation,l,r),!0}return!1}function q(m,l,r=!1){r=r?-1:1;m=f.fromValues(r*m.dx,r*m.dy,r*m.dz);g.add(l.origin,l.origin,m);e.updateUnboundedPlane(l)}function c(m,l,r=!1){m=r?-m.angle:m.angle;g.rotateZ(l.basis1,l.basis1,f.ZEROS,m);g.rotateZ(l.basis2,
l.basis2,f.ZEROS,m);e.updateUnboundedPlane(l)}function k(m,l,r=!1){const z=r?1/m.factor1:m.factor1;r=r?1/m.factor2:m.factor2;g.scale(l.basis1,l.basis1,z);g.scale(l.basis2,l.basis2,r);b.projectAndScale(l.origin,l.origin,m.origin,m.axis1,z);b.projectAndScale(l.origin,l.origin,m.origin,m.axis2,r);e.updateUnboundedPlane(l)}a.apply=function(m,l){return E(m,l,!1)};a.applyInverse=function(m,l){return E(m,l,!0)};a.calculateOrientedBounds=function(m,l,r,z){z||=e.create();const H=b.set(n.sv2d.get(),m[1],-m[0]),
D=b.set(n.sv2d.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),w=b.set(n.sv2d.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),x=n.sv2d.get();l.components.forEach(C=>C.vertices.forEach(({pos:h})=>{b.set(x,b.dot(m,h),b.dot(H,h));b.min(D,D,x);b.max(w,w,x)}));l=b.set(n.sv2d.get(),1E-6>w[0]-D[0]?r/2:0,1E-6>w[1]-D[1]?r/2:0);b.subtract(D,D,l);b.add(w,w,l);b.scale(z.basis1,m,(w[0]-D[0])/2);b.scale(z.basis2,H,(w[1]-D[1])/2);b.set(z.origin,D[0]*m[0]+D[1]*H[0],D[0]*m[1]+D[1]*H[1]);b.add(z.origin,
z.origin,z.basis1);b.add(z.origin,z.origin,z.basis2);e.updateUnboundedPlane(z);return z};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/extentUtils":function(){define(["exports","../../core/quantityUtils","./automaticLengthMeasurementUtils"],function(a,b,g){a.autoSize2D=function({topLeft:f,topRight:e,bottomRight:n,bottomLeft:u,spatialReference:v}){const t=b.max(g.autoDistance2D(u,n,v),g.autoDistance2D(f,e,v));if(null==t)return null;f=b.max(g.autoDistance2D(n,e,
v),g.autoDistance2D(u,f,v));return null==f?null:{xSize:t,ySize:f}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/infos/ExtentScaleTooltipInfo":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,
b,g,f,e,n,u,v,t){a.ExtentScaleTooltipInfo=class extends t.SketchTooltipInfo{constructor(F){super(F);this.type="extent-scale";this.yScale=this.xScale=0;this.ySize=this.xSize=g.zeroMeters}};b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"xScale",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"yScale",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"xSize",void 0);
b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"ySize",void 0);a.ExtentScaleTooltipInfo=b.__decorate([v.subclass("esri.views.interactive.tooltip.infos.ExtentScaleTooltipInfo")],a.ExtentScaleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/extentTransform/PreserveAspectRatio":function(){define(["exports","../../../../../../core/has","../../../../analysis/Slice/sliceToolUtils","../../../../../interactive/dragEventPipeline"],
function(a,b,g,f){function e(u){const v=g.isDiagonalResizeHandle(u.handle)?Math.max(Math.abs(u.factor1),Math.abs(u.factor2)):0===u.handle.direction[0]?Math.abs(u.factor2):Math.abs(u.factor1);u.factor1=0>u.factor1?-v:v;u.factor2=0>u.factor2?-v:v}class n{constructor(){this._next=this._lastDragEvent=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(u){if(this._enabled!==u&&null!=this._lastDragEvent&&null!=this._next){const v={...this._lastDragEvent,action:"update"};u&&e(v);this._next.execute(v)}this._enabled=
u}createDragEventPipelineStep(){this._lastDragEvent=null;const u=new f.EventPipeline;this._next=u;return[v=>{this._lastDragEvent="end"!==v.action?{...v}:null;this._enabled&&e(v);return v},u]}get test(){}}a.PreserveAspectRatio=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transform/extentTransform/SnapRotation":function(){define(["exports","../../../../../../core/mathUtils","../../../../../interactive/dragEventPipeline"],function(a,b,g){class f{constructor(){this._next=
this._lastDragEvent=null;this.incrementRadians=b.deg2rad(5);this._enabled=!1}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&null!=this._lastDragEvent&&null!=this._next){const n={...this._lastDragEvent,action:"update"};e&&this._adjustRotation(n);this._next.execute(n)}this._enabled=e}createDragEventPipelineStep(){this._lastDragEvent=null;const e=new g.EventPipeline;this._next=e;return[n=>{this._lastDragEvent="end"!==n.action?{...n}:null;this._enabled&&this._adjustRotation(n);
return n},e]}_adjustRotation(e){e.rotateAngle=Math.round(e.rotateAngle/this.incrementRadians)*this.incrementRadians}}a.SnapRotation=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatedObject3DGraphic":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/maybe ../../../../core/reactiveUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../core/support/UpdatingHandles ../../../../layers/graphics/sources/interfaces ../../../../support/elevationInfoUtils ../manipulatorUtils ./undoRecords ../../layers/graphics/GraphicState ../../../interactive/GraphicManipulator ../../../interactive/editGeometry/EditGeometryOperations".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z){const H=Symbol();a.ManipulatedObject3DGraphic=class extends g.EventedAccessor{get operations(){return this._operations}get updating(){return this._updatingHandles.updating}get elevationInfo(){return c.getGraphicEffectiveElevationInfo(this.graphic)}get visible(){return this._graphicState.displaying}get isDraped(){return this._graphicState.isDraped}get origin(){return k.getGraphicAttachmentOrigin(this.view,this.graphic)}constructor(D){super(D);this._updatingHandles=
new E.UpdatingHandles}destroy(){this._operations=f.destroyMaybe(this._operations);this._updatingHandles.destroy()}initialize(){this._graphicState=new l.GraphicState({graphic:this.graphic});this._graphicState.on("changed",()=>this.emit("committed"));this.addHandles(this.view.trackGraphicState(this._graphicState));this.addHandles(this._updatingHandles.add(()=>this.graphic.geometry,D=>{if(D!==this._operations?.data.geometry)if(D&&"multipoint"!==D?.type&&"extent"!==D?.type)if(this._operations?.trySetGeometry(D))this.emit("modified-externally");
else{f.destroyMaybe(this._operations);this.removeHandles(H);const w=z.EditGeometryOperations.fromGeometry(D,this.view.state.viewingMode);this._operations=w;this.addHandles(w.data.on("change",()=>this.graphic.geometry=w.data.geometry),H)}else f.destroyMaybe(this._operations),this.removeHandles(H),this._operations=null},e.syncAndInitial))}createManipulator(D){return new r.GraphicManipulator({view:this.view,graphic:this.graphic,...D})}maskOccludee(){return this.view.maskOccludee(this.graphic)}endInteraction(){"mesh"===
this.graphic.geometry?.type&&this.graphic.notifyMeshTransformChanged({action:q.MeshTransformUpdateAction.UpdateFastLocalOrigin})}toMap(D){return this.view.toMap(D,{include:[this.graphic]})}createUndoRecord(){const {graphic:{geometry:D}}=this;return m.createGraphicGeometryUndoRecord(D)}};b.__decorate([n.property({constructOnly:!0})],a.ManipulatedObject3DGraphic.prototype,"view",void 0);b.__decorate([n.property({constructOnly:!0})],a.ManipulatedObject3DGraphic.prototype,"graphic",void 0);b.__decorate([n.property()],
a.ManipulatedObject3DGraphic.prototype,"_operations",void 0);b.__decorate([n.property()],a.ManipulatedObject3DGraphic.prototype,"operations",null);b.__decorate([n.property()],a.ManipulatedObject3DGraphic.prototype,"updating",null);a.ManipulatedObject3DGraphic=b.__decorate([F.subclass("esri.views.3d.interactive.editingTools.ManipulatedObject3DGraphic")],a.ManipulatedObject3DGraphic);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/undoRecords":function(){define(["exports",
"../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/meshVertexSpaceUtils"],function(a,b,g){function f(u){let v=u,t=null;return{undo(F){t=F.geometry;F.geometry=v},redo(F){v=F.geometry;F.geometry=t}}}function e(u,v,t){let F=v?.clone(),E=b.clone(t.origin),q=null,c=null;return{undo:()=>{q=u.transform?.clone();c=b.clone(t.origin);u.transform=F;u.vertexSpace.origin=E},redo:()=>{F=u.transform?.clone();E=b.clone(t.origin);u.transform=q;u.vertexSpace.origin=c}}}function n(u){let v=
u.vertexAttributes.clonePositional(),t;return{undo:()=>{t=u.vertexAttributes.clonePositional();u.vertexAttributes=v},redo:()=>{v=u.vertexAttributes.clonePositional();u.vertexAttributes=t}}}a.createGraphicGeometryUndoRecord=function(u){return null!=u&&"mesh"===u.type?g.isRelativeVertexSpace(u.vertexSpace)?e(u,u.transform,u.vertexSpace):n(u):f(u)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/GraphicManipulator":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/math/vec2 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection ../../geometry/projection/projectPointToVector ../../support/elevationInfoUtils ../../symbols/support/defaults ../../symbols/support/ElevationInfo ./support/utils ../support/drapedUtils".split(" "),
function(a,b,g,f,e,n,u,v,t,F,E,q,c,k,m,l,r,z,H,D,w){a.GraphicManipulator=class extends g{set graphic(h){this._circleCollisionCache=null;this._originalSymbol=h.symbol;this._set("graphic",h);this.attachSymbolChanged()}get elevationInfo(){var {layer:h}=this.graphic;h=h&&"elevationInfo"in h?h.elevationInfo:null;const y=r.getGraphicEffectiveElevationMode(this.graphic);return new H({mode:y,offset:h?h.offset:0})}set focusedSymbol(h){h!==this._get("focusedSymbol")&&(this._set("focusedSymbol",h),this._updateGraphicSymbol(),
this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(h){h!==this._get("grabbing")&&(this._set("grabbing",h),this._updateGraphicSymbol())}set hovering(h){h!==this._get("hovering")&&(this._set("hovering",h),this._updateGraphicSymbol())}set selected(h){h!==this._get("selected")&&(this._set("selected",h),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:h?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(h){super(h);
this.layer=null;this.interactive=!0;this.selectable=!1;this.grabbable=!0;this.dragging=!1;this.cursor=null;this.consumesClicks=!0;this.events=new f.EventEmitter;this._originalSymbol=this._graphicSymbolChangedHandle=this._circleCollisionCache=null}destroy(){this.detachSymbolChanged();this._resetGraphicSymbol();this._set("view",null)}intersectionDistance(h){const y=this.graphic;if(!1===y.visible)return null;const d=y.geometry;if(null==d)return null;var B=this._get("focusedSymbol");B=null!=B?B:y.symbol;
return"2d"===this.view.type?this._intersectDistance2D(this.view,h,d,B):this._intersectDistance3D(this.view,h,y)}attach(){this.attachSymbolChanged();null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged();this._resetGraphicSymbol();null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged();this._graphicSymbolChangedHandle=e.watch(()=>this.graphic?.symbol,h=>{null!=h&&h!==this.focusedSymbol&&h!==this._originalSymbol&&(this._originalSymbol=
h,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))},e.sync)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(h,y,d,B){B=B||z.getDefaultSymbol2D(d);
if(null==B)return null;var p=this._circleCollisionCache;if("point"===d.type&&"cim"===B.type&&"CIMPointSymbol"===B.data.symbol?.type&&B.data.symbol.symbolLayers){const {offsetX:A,offsetY:G,size:I}=D.getSymbolInfo(B);B=n.screenPointObjectToArray(y,C);p=I/2;h=h.toScreen(d);return q.squaredDistance(B,[h.x+A,h.y+G])<p*p?1:null}if("point"!==d.type||"simple-marker"!==B.type)return w.intersectsDrapedGeometry(y,d,h)?1:null;if(null==p||!p.originalPoint.equals(d)){const A=h.spatialReference;m.canProjectWithoutEngine(d.spatialReference,
A)&&(p=m.project(d,A),this._circleCollisionCache=p={originalPoint:d.clone(),mapPoint:p,radiusPx:n.pt2px(B.size)})}if(null!=p){d=n.screenPointObjectToArray(y,C);h=h.toScreen?.(p.mapPoint);if(!h)return null;p=p.radiusPx;y=h.x+n.pt2px(B.xoffset);B=h.y-n.pt2px(B.yoffset);return q.squaredDistance(d,[y,B])<p*p?1:null}return null}_intersectDistance3D(h,y,d){return(y=h.toMap(y,{include:[d]}))&&l.projectPointToVector(y,x,h.renderSpatialReference)?c.distance(x,h.state.camera.eye):null}};b.__decorate([u.property({constructOnly:!0,
nonNullable:!0})],a.GraphicManipulator.prototype,"graphic",null);b.__decorate([u.property()],a.GraphicManipulator.prototype,"elevationInfo",null);b.__decorate([u.property({constructOnly:!0,nonNullable:!0})],a.GraphicManipulator.prototype,"view",void 0);b.__decorate([u.property({value:null})],a.GraphicManipulator.prototype,"focusedSymbol",null);b.__decorate([u.property({constructOnly:!0})],a.GraphicManipulator.prototype,"layer",void 0);b.__decorate([u.property()],a.GraphicManipulator.prototype,"interactive",
void 0);b.__decorate([u.property()],a.GraphicManipulator.prototype,"selectable",void 0);b.__decorate([u.property()],a.GraphicManipulator.prototype,"grabbable",void 0);b.__decorate([u.property({value:!1})],a.GraphicManipulator.prototype,"grabbing",null);b.__decorate([u.property()],a.GraphicManipulator.prototype,"dragging",void 0);b.__decorate([u.property()],a.GraphicManipulator.prototype,"hovering",null);b.__decorate([u.property({value:!1})],a.GraphicManipulator.prototype,"selected",null);b.__decorate([u.property()],
a.GraphicManipulator.prototype,"cursor",void 0);a.GraphicManipulator=b.__decorate([E.subclass("esri.views.interactive.GraphicManipulator")],a.GraphicManipulator);const x=k.create(),C=n.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/utils":function(){define(["exports","../../../core/screenUtils"],function(a,b){a.getSymbolInfo=function(g){let f=0,e=0,n=0;if(!g)return{offsetX:f,offsetY:e,size:n};"cim"===g.type&&g.data.symbol&&
"symbolLayers"in g.data.symbol&&g.data.symbol.symbolLayers&&g.data.symbol.symbolLayers.map(u=>{"CIMVectorMarker"===u.type&&u.anchorPoint&&(Math.abs(u.anchorPoint.x)>f&&(f=u.anchorPoint.x),Math.abs(u.anchorPoint.y)>e&&(e=u.anchorPoint.y),null!=u.size&&u.size>n&&(n=u.size))});f=b.pt2px(f);e=b.pt2px(e);n=b.pt2px(n);return{offsetX:f,offsetY:e,size:n}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils",
"../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,b,g,f,e){function n(v,t,F,E=new e){let q=0;if("2d"===F.type)q=t*(F.resolution??0);else if("3d"===F.type){var c=F.overlayPixelSizeInMapUnits(v),k=F.basemapSpatialReference;q=null==k||k.equals(F.spatialReference)?t*c:g.getMetersPerUnitForSR(k)/g.getMetersPerUnitForSR(F.spatialReference)}t=v.x-q;c=v.y-q;k=v.x+q;v=v.y+q;({spatialReference:F}=F);E.xmin=Math.min(t,k);E.ymin=Math.min(c,v);E.xmax=Math.max(t,k);E.ymax=Math.max(c,
v);E.spatialReference=F;return E}const u=new e;a.createQueryGeometry=n;a.intersectsDrapedGeometry=function(v,t,F){v=F.toMap(v);if(null==v)return!1;const E=f.calculateTolerance();return n(v,E,F,u).intersects(t)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(e,n){return n?"xoffset"in n&&n.xoffset?Math.max(e,Math.abs(n.xoffset)):"yoffset"in n&&n.yoffset?Math.max(e,Math.abs(n.yoffset||0)):
e:e}function g(e,n){if("number"===typeof e)return e;if(e?.stops?.length){e=e.stops;let u=n=0;for(let v=0;v<e.length;v++){const t=e[v].size;"number"===typeof t&&(n+=t,u++)}return n/u}return n}function f(e,n){if(!n)return e;n=n.filter(t=>"size"===t.type).map(t=>{const {maxSize:F,minSize:E}=t;return(g(F,e)+g(E,e))/2});let u=0;const v=n.length;if(0===v)return e;for(let t=0;t<v;t++)u+=n[t];return Math.max(Math.floor(u/v),e)}a.calculateTolerance=function(e){const n=e?.renderer;e="touch"===e?.pointerType?
9:6;if(!n)return e;e="visualVariables"in n?f(e,n.visualVariables):e;if("simple"===n.type)return b(e,n.symbol);if("unique-value"===n.type){let u=e;n.uniqueValueInfos?.forEach(v=>{u=b(u,v.symbol)});return u}if("class-breaks"===n.type){let u=e;n.classBreakInfos.forEach(v=>{u=b(u,v.symbol)});return u}return e};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("exports ./editingTools/draw/DrawGraphicTool3D ./editingTools/move/MoveTool3D ./editingTools/reshape/ReshapeTool3D ./editingTools/transform/TransformTool3D ./editingTools/transform/ExtentTransformTool ./editingTools/ManipulatedObject3DGraphic".split(" "),function(a,b,g,f,e,n,u){Object.defineProperty(a,"DrawGraphicTool3D",{enumerable:!0,get:()=>b.DrawGraphicTool3D});Object.defineProperty(a,"MoveTool3D",{enumerable:!0,get:()=>g.MoveTool3D});Object.defineProperty(a,"ReshapeTool3D",{enumerable:!0,
get:()=>f.ReshapeTool3D});Object.defineProperty(a,"TransformTool3D",{enumerable:!0,get:()=>e.TransformTool3D});Object.defineProperty(a,"ExtentTransformTool",{enumerable:!0,get:()=>n.ExtentTransformTool});Object.defineProperty(a,"ManipulatedObject3DGraphic",{enumerable:!0,get:()=>u.ManipulatedObject3DGraphic});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});