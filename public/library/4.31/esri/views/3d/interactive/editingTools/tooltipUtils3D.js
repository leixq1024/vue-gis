// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/handleUtils ../../../../core/quantityUtils ../../../../core/reactiveUtils ./manipulatedObjectUtils ../../../interactive/editGeometry/interfaces ../../../interactive/tooltip/tooltipCommonUtils ../../../support/euclideanLengthMeasurementUtils".split(" "),function(m,E,v,p,r,F,q,G){function w(b,{activeTooltipInfo:c,callbacks:e}){if(c){e.onBeforeUpdate();var d=r.manipulatedObjectGeometry(b);switch(d?.type){case "mesh":t(c,d.origin,b,e);"orientation"in c&&"scale"in c&&q.updateMeshTransformFromTooltipInfo(c,
d,e);break;case "point":t(c,d,b,e)}}}function t(b,c,e,d){const {dx:f,dy:l,dz:g}=q.getXYZDeltasFromTooltipInfo(b,c);if(0!==f||0!==l||0!==g)d.onMoveStart(),e.operations?.move(f,l,g,F.AccumulationBehavior.NEW_STEP),d.onMove(f,l,g),d.onMoveStop()}function x(b,c){const e=r.manipulatedObjectGeometry(c);var d=e?.type;if(b&&e&&("mesh"===d||"point"===d)){var f=(d="mesh"===d)?e.origin:e;b.setLocationFromPoint(f);y(b,f,c);"transform-mesh"===b.type&&d&&q.updateTooltipInfoFromMeshTransform(b,e);b.clearInputValues()}}
function y(b,c,e){b.elevation.actual=G.elevationFromPoint(c);b.elevation.visible=!!e.operations?.data.coordinateHelper.hasZ();b.elevation.readOnly=!1;b.elevation.showAsZ=!0}function z(b){switch(b){case "integer":case "long":return 0;default:return null}}m.connectTooltipToManipulatedObject=function(b,c,e){function d(){const a=e();return{...a,activeTooltipInfo:a.sketchOptions.tooltips.effectiveEnabled?a.activeTooltipInfo:null}}function f(a){g||(g=!0,a(),g=!1)}function l({activeTooltipInfo:a,sketchOptions:h,
scaleRotateTransform:u}){f(()=>{if(a&&(a.sketchOptions=h,x(a,c),"transform-point"===a?.type))if(u){var k=u.mode,{size:A,orientationClockwise:B}=u.adapter,{visualVariables:n}=a.sketchOptions.tooltips,C=n?.rotation,D=null!=B&&(null==k||"rotate"===k);a.orientation.actual=D?v.createAngle(B,"radians",C?.rotationType??"geographic"):void 0;a.orientation.precision=z(C?.valueType);a.orientation.visible=D;n=n?.size;k=null!=A&&(null==k||"scale"===k);a.size.actual=k?v.createLength(A,n?.unit??"meters"):void 0;
a.size.precision=z(n?.valueType);a.size.visible=k}else a.orientation.actual=void 0,a.size.actual=void 0,a.orientation.visible=!1,a.size.visible=!1;b.info=a})}let g=!1;return E.handlesGroup([p.watch(d,l,p.syncAndInitial),p.watch(()=>{const a=d(),{activeTooltipInfo:h}=a;if(h)return{context:a,activeTooltipInfo:h,key:h.key,geometry:r.manipulatedObjectGeometry(c)}},(a,h)=>{a&&h&&h.key!==a.key&&f(()=>w(c,a.context))},p.sync),c.on("committed",()=>{queueMicrotask(()=>l(d()))}),q.connectPasteEvent(b,{onBeforePaste:()=>
{g=!0},onAfterPaste:()=>{w(c,d());g=!1}})])};m.updateElevationFromPoint=y;m.updateTooltipInfoFromManipulatedObject=x;m.updateXYZFromTooltipInfo=t;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});