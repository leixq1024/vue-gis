// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["../../../../core/arrayUtils","../../../../core/handleUtils","../II3SMeshView3D"],function(g,h,e){class k{constructor(){this.ids=new Set}}class l{constructor({collection:a,forAllFeatures:b,forAllFeaturesOfNode:c}){this._highlights=new Map;this._collection=a;this._forAllFeatures=b;this._forAllFeaturesOfNode=c}destroy(){this._highlights.forEach(a=>a.forEach(b=>this._releaseSet(b)));this._highlights=null}acquireSet(a){const b=new k;var c=this._highlights.get(a);c||(c=[],this._highlights.set(a,
c));c.push(b);c=h.makeHandle(()=>{if(this._highlights){var d=this._highlights.get(a);d&&(this._releaseSet(b),g.removeUnordered(d,b))}});return{set:b,handle:c}}setFeatureIds(a,b,c){b.forEach(d=>a.ids.add(d));this._initializeSet(a,c)}_initializeSet(a,b){this._forAllFeatures((c,d,f)=>{a.ids.has(c)&&this._collection.addComponentHighlight(f.objectHandle,d,b);return e.ForAllFeaturesReturnType.CONTINUE})}_releaseSet(a){this._forAllFeatures((b,c,d)=>{a.ids.has(b)&&this._collection.removeComponentHighlight(d.objectHandle,
c);return e.ForAllFeaturesReturnType.CONTINUE})}objectCreated(a){this._highlights.forEach((b,c)=>{b.forEach(d=>{this._forAllFeaturesOfNode(a,(f,m)=>{d.ids.has(f)&&this._collection.addComponentHighlight(a.objectHandle,m,c);return e.ForAllFeaturesReturnType.CONTINUE})})})}objectDeleted(a){this._collection.clearHighlights(a.objectHandle)}}return l});