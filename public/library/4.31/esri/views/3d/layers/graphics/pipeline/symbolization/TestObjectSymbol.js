// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../chunks/tslib.es6 ../../../../../../core/Accessor ../../../../../../core/Logger ../../../../../../core/has ../../../../../../core/RandomLCG ../../../../../../core/Error ../../../../../../core/accessorSupport/decorators/subclass ../../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../../geometry/projection/computeTranslationToOriginAndRotation ../../../../../../geometry/support/aaBoundingBox ../../../../../../symbols/support/symbolLayerUtils3D ../../graphicUtils ../featureData/interfaces ./primitiveObjectUtils".split(" "),
function(f,w,x,G,H,I,J,y,m,n,k,z,p,q,A,r,B){f.TestObjectSymbol=class extends x{constructor(a){super();this._context=a;this.lodRendererId=null;this._loaded=!1}get loaded(){return this._loaded}async load(a){var b=a.createMaterial("default");b=B.createPrimitiveGeometry("cone",b);this.lodRendererId=a.createLodRenderer(b);this._loaded=!0}async add(a,b){if(null==this.lodRendererId)throw Error("expected lod renderer id to not be null");await this._provisionFeatureData(a);const c=a.numFeatures;var d=p.create(q.objectSymbolLayerPrimitiveBoundingBox("cone"));
d=k.fromArray(p.size(d));const g=k.fromArray(q.objectSymbolLayerSizeWithResourceSize(d,{isPrimitive:!0,width:100,depth:null,height:null})),t=new Float64Array(16*c),u=new Float64Array(16*c),l=a.mapCoordinates;for(let e=0;e<c;++e){const v=e,D=this._computeGlobalTransform(l[3*e],l[3*e+1],l[3*e+2],this._context.viewSpatialReference,C),F=this._computeLocalTransform(g,d,E);this._writeMatrixToTypedBuffer(t,v,F);this._writeMatrixToTypedBuffer(u,v,D)}a={featureIds:new Uint32Array(a.objectIds),localTransforms:t,
globalTransforms:u};b.addLodInstances(this.lodRendererId,a)}async remove(a,b){null!=this.lodRendererId&&(a=new Uint32Array(a.objectIds),b.removeLodInstances(this.lodRendererId,a))}async _provisionFeatureData(a){await a.provision([r.FeatureDataItem.GEOMETRY_MAP_COORDINATES,r.FeatureDataItem.OBJECT_ID],this._context)}_writeMatrixToTypedBuffer(a,b,c){b*=16;for(let d=0;16>d;d++)a[b++]=c[d]}_computeGlobalTransform(a,b,c,d,g){h[0]=a;h[1]=b;h[2]=c;z.computeTranslationToOriginAndRotation(d,h,g,this._context.renderSpatialReference);
return g}_computeLocalTransform(a,b,c){m.identity(c);this._applyObjectScale(a,b,c);return c}_applyObjectScale(a,b,c){a=A.computeObjectScale(a,a,b,this._context.renderCoordsHelper.unitInMeters);1===a[0]&&1===a[1]&&1===a[2]||m.scale(c,c,a)}};f.TestObjectSymbol=w.__decorate([y.subclass("esri.views.3d.layers.graphics.pipeline.symbolization.TestObjectSymbol")],f.TestObjectSymbol);const h=k.create(),E=n.create(),C=n.create();Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});