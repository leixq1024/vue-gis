// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports"],function(h){class m{constructor(a){this._objectType=a;this._active=new Map}get _stack(){const a=Error().stack.split("\n");a.shift();a.shift();a.shift();return a.join("\n")}add(a){this._active.set(a,new n(this._stack))}remove(a){this._active.delete(a)}addReference(a){(a=this._active.get(a))&&a.retains.push(this._stack)}removeReference(a){(a=this._active.get(a))&&a.releases.push(this._stack)}resetLog(){const a=new Map;let k="";this._active.forEach((b,{usedMemory:d})=>{a.has(b.from)||
(a.set(b.from,new Map),0<b.retains.length&&(k+=`  First reference count mismatch:\n  Retain:\n    ${b.retains.join("\n\n    ")}\n\n  Release:    ${b.releases.join("\n\n    ")}\n`));b=a.get(b.from);b.set(d??0,b.get(d??0)??1)});this._active.clear();let l=0;const e=[];a.forEach((b,d)=>{let c=0;b.forEach((f,g)=>c+=f*g);b.set(-1,c);l+=c;e.push([d,b])});a.clear();e.sort((b,d)=>d[1].get(-1)-b[1].get(-1));return e.reduce((b,[d,c])=>{const f=Math.round(c.get(-1)/1024);c.delete(-1);c=Array.from(c.values()).reduce((g,
p)=>g+p,0);return b+=`  ${f}KB from ${c} allocations at ${d}\n`},`Total ${this._objectType} memory: ${Math.round(l/1024)}KB\n${k}`)}}class n{constructor(a){this.from=a;this.retains=[];this.releases=[]}}h.AllocationTracer=m;Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});