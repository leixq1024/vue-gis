// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../core/Evented ../../core/events ../../core/maybe ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../support/themeUtils ./tooltip/css ./tooltip/content/tooltipContentFactory ../../widgets/support/widgetUtils".split(" "),function(d,c,v,w,l,q,e,E,F,G,y,z,r,A,B){function C({classList:a},b){D.forEach(g=>a.remove(g));a.add(`${m.base}--${b}`)}
const m={base:`${r.base}`,ltr:`${r.base}--ltr`,rtl:`${r.base}--rtl`,debug:`${r.base}--debug`};c=class extends c.EventedAccessor{constructor(a){super(a);this.content=this.position=this.options=this.info=null;this._focused=!1;this.outerContainer=document.createElement("div");this.debug=!1;this._lastPosition=null;this._rtl=!1;this._prevXY=[0,0]}initialize(){const {outerContainer:a}=this;this.addHandles([l.watch(()=>this.view.overlay?.surface,b=>{a.remove();b?.appendChild(a);this._rtl=B.isRTL(b)},l.syncAndInitial),
l.watch(()=>this.info,(b,g)=>{null!=this.content&&null!=b&&null!=g&&b.type===g.type?this.content.info=b:(w.destroyMaybe(this.content),(b=A.tooltipContentFactory(this,b))?(this.content=b,b.container&&a.appendChild(b.container),this.exitInputMode()):this.content=null)},l.syncAndInitial),l.watch(()=>({container:this.outerContainer,style:this._outerContainerStyle}),({container:b,style:g})=>{Object.assign(b.style,g)},l.initial),l.watch(()=>({outerContainer:this.outerContainer,placement:this.effectivePlacement,
effectiveOffset:this._effectiveOffset,rtl:this._rtl,debug:this.debug}),({outerContainer:b,placement:g,effectiveOffset:h,rtl:f,debug:k})=>{const {classList:p}=b;p.add(m.base);p.toggle(m.rtl,f);p.toggle(m.ltr,!f);p.toggle(m.debug,k);this.outerContainer.style.setProperty("--offset",`${h}px`);z.setCalciteThemeClass(b);C(b,g)},l.initial),l.when(()=>"feedback"===this.mode,()=>{this.position=null;this._clearOverride("effectivePlacement")},l.sync),v.on(this.outerContainer,"paste",b=>{this.emit("paste",b)}),
v.on(this.outerContainer,["focusin","focusout"],()=>{setTimeout(()=>{this._focused=this.content?.container?.contains(document.activeElement)??!1})})])}destroy(){this.info=null;this.content=w.destroyMaybe(this.content);this.outerContainer.remove()}get mode(){return this.content?.mode??"feedback"}get focused(){return this._focused}get visible(){return"none"!==this._outerContainerStyle.display}get contentContainer(){return this.content?.container}get effectivePlacement(){const a=this.options?.placement;
return"auto"===a?"bottom-end":a??"bottom-end"}get _screenPoint(){const {inputManager:a}=this.view;return a?.multiTouchActive?null:a?.latestPointerLocation}get _effectiveOffset(){return this.options?.offset??20}get _outerContainerStyle(){const a=this.position??this._screenPoint;this._lastPosition=q.cloneScreenPoint(a);return null!=a&&null!=this.content?{display:"block",transform:`translate(${Math.round(a.x)}px, ${Math.round(a.y)}px)`}:{display:"none",transform:"none"}}clear(){this.info=null}async enterInputMode(a){const b=
this.position=q.cloneScreenPoint(this.position??this._lastPosition??this._screenPoint),{effectivePlacement:g}=this;this._override("effectivePlacement",g);await this.content?.enterInputMode(a,()=>{if(b){var h=this.contentContainer;var f=this._effectiveOffset;var k=this.view;if(h&&k.container){h=h.getBoundingClientRect();var {left:p,top:x}=k.container.getBoundingClientRect(),{x:t,y:u}=b,n=h.left-p-f;0>n&&(t-=n);n=h.right-p+f-k.width;0<n&&(t-=n);n=h.top-x-f;0>n&&(u-=n);f=h.bottom-x+f-k.height;0<f&&(u-=
f);f=q.createScreenPoint(t,u)}else f=b;this.position=f;Object.assign(this.outerContainer.style,this._outerContainerStyle)}})}async exitInputMode(a){await this.content?.exitInputMode(a)}onDragStart(a,b){this._prevXY=[a,b]}onDrag(a,b){const g=a-this._prevXY[0],h=b-this._prevXY[1];this._prevXY=[a,b];const {position:f}=this;if(f){const {view:k}=this;a-=k.position[0];b-=k.position[1];0>a||a>k.width||0>b||b>k.height-16||(this.position=q.createScreenPoint(f.x+g,f.y+h))}}onDragEnd(){this._prevXY=[0,0]}};
d.__decorate([e.property({nonNullable:!0})],c.prototype,"view",void 0);d.__decorate([e.property()],c.prototype,"info",void 0);d.__decorate([e.property()],c.prototype,"options",void 0);d.__decorate([e.property()],c.prototype,"position",void 0);d.__decorate([e.property()],c.prototype,"content",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"mode",null);d.__decorate([e.property()],c.prototype,"_focused",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"focused",null);d.__decorate([e.property({readOnly:!0})],
c.prototype,"outerContainer",void 0);d.__decorate([e.property({readOnly:!0})],c.prototype,"contentContainer",null);d.__decorate([e.property({readOnly:!0})],c.prototype,"effectivePlacement",null);d.__decorate([e.property()],c.prototype,"debug",void 0);d.__decorate([e.property()],c.prototype,"_lastPosition",void 0);d.__decorate([e.property()],c.prototype,"_screenPoint",null);d.__decorate([e.property()],c.prototype,"_rtl",void 0);d.__decorate([e.property()],c.prototype,"_effectiveOffset",null);d.__decorate([e.property()],
c.prototype,"_outerContainerStyle",null);c=d.__decorate([y.subclass("esri.views.interactive.Tooltip")],c);const D=["top","bottom","leading","trailing"].flatMap(a=>[`${m.base}--${`${a}-start`}`,`${m.base}--${a}`,`${m.base}--${`${a}-end`}`]);return c});