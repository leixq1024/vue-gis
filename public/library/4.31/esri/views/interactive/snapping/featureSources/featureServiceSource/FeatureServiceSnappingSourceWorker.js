// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
require({cache:{"esri/core/support/UpdatingHandles":function(){define("exports ../../chunks/tslib.es6 ../Accessor ../handleUtils ../reactiveUtils ../scheduling ../accessorSupport/decorators/property ../accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m){a.UpdatingHandles=class extends n{constructor(){super(...arguments);this.updating=!1;this._scheduleHandleId=this._handleId=0;this._pendingPromises=new Set}destroy(){this.removeAll()}add(f,v,x={}){return this._installWatch(f,v,
x,r.watch)}addWhen(f,v,x={}){return this._installWatch(f,v,x,r.when)}addOnCollectionChange(f,v,{initial:x=!1,final:B=!1}={}){const D=++this._handleId;this.addHandles([r.on(f,"after-changes",this._createSyncUpdatingCallback(),r.sync),r.on(f,"change",v,{onListenerAdd:x?p=>v({added:p.toArray(),removed:[]}):void 0,onListenerRemove:B?p=>v({added:[],removed:p.toArray()}):void 0})],D);return z.makeHandle(()=>this.removeHandles(D))}addPromise(f){if(null==f)return f;const v=++this._handleId;this.addHandles(z.makeHandle(()=>
{this._pendingPromises.delete(f)&&(0!==this._pendingPromises.size||this.hasHandles(-42)||this._set("updating",!1))}),v);this._pendingPromises.add(f);this._set("updating",!0);const x=()=>this.removeHandles(v);f.then(x,x);return f}removeAll(){this._pendingPromises.clear();this.removeAllHandles();this._set("updating",!1)}_installWatch(f,v,x={},B){const D=++this._handleId;x.sync||this._installSyncUpdatingWatch(f,D);f=B(f,v,x);this.addHandles(f,D);return z.makeHandle(()=>this.removeHandles(D))}_installSyncUpdatingWatch(f,
v){const x=this._createSyncUpdatingCallback();f=r.watch(f,x,{sync:!0,equals:()=>!1});this.addHandles(f,v);return f}_createSyncUpdatingCallback(){return()=>{this.removeHandles(-42);++this._scheduleHandleId;const f=this._scheduleHandleId;this._get("updating")||this._set("updating",!0);this.addHandles(G.schedule(()=>{f===this._scheduleHandleId&&(this._set("updating",0<this._pendingPromises.size),this.removeHandles(-42))}),-42)}}};d.__decorate([b.property({readOnly:!0})],a.UpdatingHandles.prototype,"updating",
void 0);a.UpdatingHandles=d.__decorate([m.subclass("esri.core.support.UpdatingHandles")],a.UpdatingHandles);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/FeatureStore":function(){define("../../../core/arrayUtils ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./BoundsStore ./geometryUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(a,d,n,z,r,G,b,m,f,v){const x=r.create();class B{constructor(D){this.geometryInfo=D;this._boundsStore=new m.BoundsStore;this._featuresById=new Map;this.events=new n;this.featureAdapter=v.optimizedFeatureQueryEngineAdapter}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let D=0;
this._featuresById.forEach(p=>{null!=p.geometry&&p.geometry.coords&&(D+=p.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:D/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(D){if(null==this.fullBounds)return null;const [p,A,F,q]=this.fullBounds;return{xmin:p,ymin:A,xmax:F,ymax:q,spatialReference:f.cleanFromGeometryEngine(D)}}add(D){this._add(D);this._emitChanged()}addMany(D){for(const p of D)this._add(p);this._emitChanged()}upsertMany(D){D=D.map(p=>this._upsert(p));
this._emitChanged();return D.filter(a.isSome)}clear(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()}removeById(D){D=this._featuresById.get(D);if(!D)return null;this._remove(D);this._emitChanged();return D}removeManyById(D){this._boundsStore.invalidateIndex();for(const p of D)(D=this._featuresById.get(p))&&this._remove(D);this._emitChanged()}forEachBounds(D,p){for(const A of D)(D=this._boundsStore.get(A.objectId))&&p(r.fromRect(x,D))}getFeature(D){return this._featuresById.get(D)}has(D){return this._featuresById.has(D)}forEach(D){this._featuresById.forEach(p=>
D(p))}forEachInBounds(D,p){this._boundsStore.forEachInBounds(D,A=>{p(this._featuresById.get(A))})}_emitChanged(){this.events.emit("changed",void 0)}_add(D){if(D){var p=D.objectId;if(null==p)z.getLogger("esri.layers.graphics.data.FeatureStore").error(new d("featurestore:invalid-feature","feature id is missing",{feature:D}));else{var A=this._featuresById.get(p);if(A){D.displayId=A.displayId;var F=this._boundsStore.get(p);this._boundsStore.delete(p)}else if(null!=this.onFeatureAdd)this.onFeatureAdd(D);
D.geometry?.coords?.length?(F=b.getBoundsOptimizedGeometry(null!=F?F:G.create(),D.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=F&&this._boundsStore.set(p,F)):this._boundsStore.set(p,null);this._featuresById.set(p,D)}}}_upsert(D){const p=D?.objectId;if(null==p)return z.getLogger("esri.layers.graphics.data.FeatureStore").error(new d("featurestore:invalid-feature","feature id is missing",{feature:D})),null;const A=this._featuresById.get(p);if(!A)return this._add(D),D;const {geometry:F,
attributes:q}=D;for(const c in q)A.attributes[c]=q[c];F&&(A.geometry=F,this._boundsStore.set(p,b.getBoundsOptimizedGeometry(G.create(),F,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null));return A}_remove(D){if(null!=this.onFeatureRemove)this.onFeatureRemove(D);const p=D.objectId;this._boundsStore.delete(p);this._featuresById.delete(p);return D}}return B})},"esri/geometry/support/aaBoundingBox":function(){define(["exports","../Extent","./aaBoundingRect","./DoubleArray"],function(a,d,n,z){function r(c=
F){return[c[0],c[1],c[2],c[3],c[4],c[5]]}function G(c,l,H,g,I,E,C=r()){C[0]=c;C[1]=l;C[2]=H;C[3]=g;C[4]=I;C[5]=E;return C}function b(c,l,H,g=r()){D(g,A);m(g,c,l,H);return g}function m(c,l,H=0,g=l.length/3){let I=c[0],E=c[1],C=c[2],N=c[3],Q=c[4],T=c[5];for(let y=0;y<g;y++)I=Math.min(I,l[H+3*y]),E=Math.min(E,l[H+3*y+1]),C=Math.min(C,l[H+3*y+2]),N=Math.max(N,l[H+3*y]),Q=Math.max(Q,l[H+3*y+1]),T=Math.max(T,l[H+3*y+2]);c[0]=I;c[1]=E;c[2]=C;c[3]=N;c[4]=Q;c[5]=T}function f(c){return c[0]>=c[3]?0:c[3]-c[0]}
function v(c){return c[1]>=c[4]?0:c[4]-c[1]}function x(c){return c[2]>=c[5]?0:c[5]-c[2]}function B(c,l){return Math.max(l[0],c[0])<=Math.min(l[3],c[3])&&Math.max(l[1],c[1])<=Math.min(l[4],c[4])&&Math.max(l[2],c[2])<=Math.min(l[5],c[5])}function D(c,l){c[0]=l[0];c[1]=l[1];c[2]=l[2];c[3]=l[3];c[4]=l[4];c[5]=l[5];return c}function p(c){return 6===c.length}const A=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],F=[0,0,0,0,0,0],q=r();a.allFinite=function(c){for(let l=0;6>l;l++)if(!isFinite(c[l]))return!1;
return!0};a.center=function(c,l=[0,0,0]){l[0]=c[0]+f(c)/2;l[1]=c[1]+v(c)/2;l[2]=c[2]+x(c)/2;return l};a.contains=function(c,l){return l[0]>=c[0]&&l[1]>=c[1]&&l[2]>=c[2]&&l[3]<=c[3]&&l[4]<=c[4]&&l[5]<=c[5]};a.containsPoint=function(c,l){return l[0]>=c[0]&&l[1]>=c[1]&&l[2]>=c[2]&&l[0]<=c[3]&&l[1]<=c[4]&&l[2]<=c[5]};a.containsPointWithMargin=function(c,l,H){return l[0]>=c[0]-H&&l[1]>=c[1]-H&&l[2]>=c[2]-H&&l[0]<=c[3]+H&&l[1]<=c[4]+H&&l[2]<=c[5]+H};a.create=r;a.depth=v;a.diameter=function(c){const l=f(c),
H=x(c);c=v(c);return Math.sqrt(l*l+H*H+c*c)};a.empty=function(c){return c?D(c,A):r(A)};a.equals=function(c,l,H){if(null==c||null==l)return c===l;if(!p(c)||!p(l))return!1;if(H)for(let g=0;g<c.length;g++){if(!H(c[g],l[g]))return!1}else for(H=0;H<c.length;H++)if(c[H]!==l[H])return!1;return!0};a.expandWithAABB=function(c,l){c[0]=Math.min(c[0],l[0]);c[1]=Math.min(c[1],l[1]);c[2]=Math.min(c[2],l[2]);c[3]=Math.max(c[3],l[3]);c[4]=Math.max(c[4],l[4]);c[5]=Math.max(c[5],l[5])};a.expandWithBuffer=m;a.expandWithNestedArray=
function(c,l,H){const g=l.length;let I=c[0],E=c[1],C=c[2],N=c[3],Q=c[4],T=c[5];if(H)for(H=0;H<g;H++){var y=l[H];I=Math.min(I,y[0]);E=Math.min(E,y[1]);C=Math.min(C,y[2]);N=Math.max(N,y[0]);Q=Math.max(Q,y[1]);T=Math.max(T,y[2])}else for(H=0;H<g;H++)y=l[H],I=Math.min(I,y[0]),E=Math.min(E,y[1]),N=Math.max(N,y[0]),Q=Math.max(Q,y[1]);c[0]=I;c[1]=E;c[2]=C;c[3]=N;c[4]=Q;c[5]=T};a.expandWithOffset=function(c,l,H,g){c[0]=Math.min(c[0],c[0]+l);c[3]=Math.max(c[3],c[3]+l);c[1]=Math.min(c[1],c[1]+H);c[4]=Math.max(c[4],
c[4]+H);c[2]=Math.min(c[2],c[2]+g);c[5]=Math.max(c[5],c[5]+g)};a.expandWithRect=function(c,l){c[0]=Math.min(c[0],l[0]);c[1]=Math.min(c[1],l[1]);c[3]=Math.max(c[3],l[2]);c[4]=Math.max(c[4],l[3])};a.expandWithVec3=function(c,l){c[0]=Math.min(c[0],l[0]);c[1]=Math.min(c[1],l[1]);c[2]=Math.min(c[2],l[2]);c[3]=Math.max(c[3],l[0]);c[4]=Math.max(c[4],l[1]);c[5]=Math.max(c[5],l[2])};a.fromBuffer=function(c,l=r()){return b(c,0,c.length/3,l)};a.fromExtent=function(c,l=r()){l[0]=c.xmin;l[1]=c.ymin;l[2]=c.hasZ?
c.zmin:-Infinity;l[3]=c.xmax;l[4]=c.ymax;l[5]=c.hasZ?c.zmax:Infinity;return l};a.fromMinMax=function(c,l,H=r()){H[0]=c[0];H[1]=c[1];H[2]=c[2];H[3]=l[0];H[4]=l[1];H[5]=l[2];return H};a.fromRect=function(c,l){c[0]=l[0];c[1]=l[1];c[2]=Number.NEGATIVE_INFINITY;c[3]=l[2];c[4]=l[3];c[5]=Number.POSITIVE_INFINITY;return c};a.fromRectValues=function(c,l,H,g,I){c[0]=l;c[1]=H;c[2]=Number.NEGATIVE_INFINITY;c[3]=g;c[4]=I;c[5]=Number.POSITIVE_INFINITY;return c};a.fromSubBuffer=b;a.fromValues=G;a.getMax=function(c,
l){l[0]=c[3];l[1]=c[4];l[2]=c[5];return l};a.getMin=function(c,l){l[0]=c[0];l[1]=c[1];l[2]=c[2];return l};a.height=x;a.intersects=B;a.intersectsClippingArea=function(c,l){return null==l?!0:B(c,l)};a.is=p;a.isPoint=function(c){return 0===f(c)&&0===v(c)&&0===x(c)};a.maximumDimension=function(c){return Math.max(f(c),x(c),v(c))};a.negativeInfinity=A;a.offset=function(c,l,H,g,I=c){I[0]=c[0]+l;I[1]=c[1]+H;I[2]=c[2]+g;I[3]=c[3]+l;I[4]=c[4]+H;I[5]=c[5]+g;return I};a.positiveInfinity=[-Infinity,-Infinity,
-Infinity,Infinity,Infinity,Infinity];a.scale=function(c,l,H=c){const g=c[0]+f(c)/2,I=c[1]+v(c)/2,E=c[2]+x(c)/2;H[0]=g+(c[0]-g)*l;H[1]=I+(c[1]-I)*l;H[2]=E+(c[2]-E)*l;H[3]=g+(c[3]-g)*l;H[4]=I+(c[4]-I)*l;H[5]=E+(c[5]-E)*l;return H};a.set=D;a.setMax=function(c,l,H=c){H[3]=l[0];H[4]=l[1];H[5]=l[2];H!==c&&(H[0]=c[0],H[1]=c[1],H[2]=c[2]);return c};a.setMin=function(c,l,H=c){H[0]=l[0];H[1]=l[1];H[2]=l[2];H!==c&&(H[3]=c[3],H[4]=c[4],H[5]=c[5]);return H};a.size=function(c,l=[0,0,0]){l[0]=f(c);l[1]=v(c);l[2]=
x(c);return l};a.toCorners=function(c,l=z.newDoubleArray(24)){const [H,g,I,E,C,N]=c;l[0]=H;l[1]=g;l[2]=I;l[3]=H;l[4]=g;l[5]=N;l[6]=H;l[7]=C;l[8]=I;l[9]=H;l[10]=C;l[11]=N;l[12]=E;l[13]=g;l[14]=I;l[15]=E;l[16]=g;l[17]=N;l[18]=E;l[19]=C;l[20]=I;l[21]=E;l[22]=C;l[23]=N;return l};a.toExtent=function(c,l){return isFinite(c[2])||isFinite(c[5])?new d({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],zmin:c[2],zmax:c[5],spatialReference:l}):new d({xmin:c[0],xmax:c[3],ymin:c[1],ymax:c[4],spatialReference:l})};a.toRect=
function(c,l){l||=n.create();l[0]=c[0];l[1]=c[1];l[2]=c[3];l[3]=c[4];return l};a.width=f;a.wrap=function(c,l,H,g,I,E){return G(c,l,H,g,I,E,q)};a.zero=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/DoubleArray":function(){define(["exports","../../core/typedArrayUtil"],function(a,d){a.copyInto=function(n,z){for(let r=0;r<z.length;++r)n[r]=z[r];return n};a.doubleArrayFrom=function(n){return(d.isArray(n)?n.length:n.byteLength/8)<=d.nativeArrayMaxSize?Array.from(n):
new Float64Array(n)};a.doubleSubArray=function(n,z,r){return Array.isArray(n)?n.slice(z,z+r):n.subarray(z,z+r)};a.newDoubleArray=function(n,z=!1){return n<=d.nativeArrayMaxSize?z?Array(n).fill(0):Array(n):new Float64Array(n)};a.toFloat64Array=function(n){return Array.isArray(n)?new Float64Array(n):n};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/featureConversionUtils":function(){define("exports ../../core/Error ../../core/Logger ../../core/maybe ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),
function(a,d,n,z,r,G,b,m,f,v){function x(L,P){return L?P?4:3:P?3:2}function B(L,P,S,W){if(L){if(S)return P&&W?O:La;if(P&&W)return u}else if(P&&W)return La;return ab}function D({scale:L,translate:P},S){return Math.round((S-P[0])/L[0])}function p({scale:L,translate:P},S){return Math.round((P[1]-S)/L[1])}function A({scale:L,translate:P},S,W){return S*L[W]+P[W]}function F(L){L=L.coords;return{x:L[0],y:L[1]}}function q(L,P){L.coords[0]=P.x;L.coords[1]=P.y;return L}function c(L){L=L.coords;return{x:L[0],
y:L[1],z:L[2]}}function l(L,P){L.coords[0]=P.x;L.coords[1]=P.y;L.coords[2]=P.z;return L}function H(L){L=L.coords;return{x:L[0],y:L[1],m:L[2]}}function g(L,P){L.coords[0]=P.x;L.coords[1]=P.y;L.coords[2]=P.m;return L}function I(L){L=L.coords;return{x:L[0],y:L[1],z:L[2],m:L[3]}}function E(L,P){L.coords[0]=P.x;L.coords[1]=P.y;L.coords[2]=P.z;L.coords[3]=P.m;return L}function C(L,P){return L&&P?E:L?l:P?g:q}function N(L,P,S,W,aa){S=C(S,W);for(const {geometry:ca,attributes:ea}of P)P=null!=ca?S(new v,ca):
null,L.push(new m.OptimizedFeature(P,ea,null,aa?ea[aa]:void 0));return L}function Q(L,P,S=C(null!=P.z,null!=P.m)){return S(L,P)}function T(L,P,S,W){for(const {geometry:aa,attributes:ca}of P)L.push({attributes:ca,geometry:null!=aa?y(aa,S,W):null});return L}function y(L,P,S){if(null==L)return null;const W=x(P,S),aa=[];for(let ca=0;ca<L.coords.length;ca+=W){const ea=[];for(let la=0;la<W;la++)ea.push(L.coords[ca+la]);aa.push(ea)}return P?S?{points:aa,hasZ:P,hasM:S}:{points:aa,hasZ:P}:S?{points:aa,hasM:S}:
{points:aa}}function R(L,P,S,W,aa){S=x(S,W);for(const {geometry:ca,attributes:ea}of P)P=null!=ca?k(new v,ca,S):null,L.push(new m.OptimizedFeature(P,ea,null,aa?ea[aa]:void 0));return L}function k(L,P,S=x(P.hasZ,P.hasM)){L.lengths[0]=P.points.length;const W=L.coords;let aa=0;for(const ca of P.points)for(P=0;P<S;P++)W[aa++]=ca[P];return L}function h(L,P,S){if(!L)return null;const W=x(P,S),{coords:aa,lengths:ca}=L;L=[];let ea=0;for(const la of ca){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=
0;ra<W;ra++)qa.push(aa[ea++]);ma.push(qa)}L.push(ma)}return P?S?{paths:L,hasZ:P,hasM:S}:{paths:L,hasZ:P}:S?{paths:L,hasM:S}:{paths:L}}function t(L,P,S,W,aa){S=x(S,W);for(const {geometry:ca,attributes:ea,centroid:la}of P)P=null!=ca?J(new v,ca,S):null,W=null!=la?Q(new v,la):null,L.push(new m.OptimizedFeature(P,ea,W,aa?ea[aa]:void 0));return L}function J(L,P,S=x(P.hasZ,P.hasM)){const {lengths:W,coords:aa}=L;let ca=0;for(const ea of P.paths){for(const la of ea)for(P=0;P<S;P++)aa[ca++]=la[P];W.push(ea.length)}return L}
function U(L,P,S){if(!L)return null;const W=x(P,S),{coords:aa,lengths:ca}=L;L=[];let ea=0;for(const la of ca){const ma=[];for(let ua=0;ua<la;ua++){const qa=[];for(let ra=0;ra<W;ra++)qa.push(aa[ea++]);ma.push(qa)}L.push(ma)}return P?S?{rings:L,hasZ:P,hasM:S}:{rings:L,hasZ:P}:S?{rings:L,hasM:S}:{rings:L}}function Y(L,P,S=P.hasZ,W=P.hasM){return da(L,P.rings,S,W)}function da(L,P,S,W){S=x(S,W);const {lengths:aa,coords:ca}=L;W=0;Da(L);for(const ea of P){for(const la of ea)for(P=0;P<S;P++)ca[W++]=la[P];
aa.push(ea.length)}return L}function ia(L,P,S,W,aa,ca){Ea(L);if(!S){for(const ea of P)L.push(new m.OptimizedFeature(null,ea.attributes,null,ca?ea.attributes[ca]:void 0));return L}switch(S){case "esriGeometryPoint":return N(L,P,W,aa,ca);case "esriGeometryMultipoint":return R(L,P,W,aa,ca);case "esriGeometryPolyline":return t(L,P,W,aa,ca);case "esriGeometryPolygon":case "esriGeometryMultiPatch":for(const {geometry:ea,centroid:la,attributes:ma}of P)P=null!=ea?Y(new v,ea,W,aa):null,S=ca?ma[ca]:void 0,
null!=la?L.push(new m.OptimizedFeature(P,ma,q(new v,la),S)):L.push(new m.OptimizedFeature(P,ma,null,S));break;default:Ja().error("convertToFeatureSet:unknown-geometry",new d(`Unable to parse unknown geometry type '${S}'`)),Ea(L)}return L}function na(L,P,S,W){L=L&&("coords"in L?L:L.geometry);if(null==L)return null;switch(P){case "esriGeometryPoint":return P=F,S&&W?P=I:S?P=c:W&&(P=H),P(L);case "esriGeometryMultipoint":return y(L,S,W);case "esriGeometryPolyline":return h(L,S,W);case "esriGeometryPolygon":return U(L,
S,W);default:return Ja().error("convertToGeometry:unknown-geometry",new d(`Unable to parse unknown geometry type '${P}'`)),null}}function oa(L,P,S,W,aa){Ea(L);if(null==S){for(const ea of P)L.push({attributes:ea.attributes});return L}switch(S){case "esriGeometryPoint":S=F;W&&aa?S=I:W?S=c:aa&&(S=H);for(var ca of P){const {geometry:ea,attributes:la}=ca;W=null!=ea?S(ea):null;L.push({attributes:la,geometry:W})}break;case "esriGeometryMultipoint":return T(L,P,W,aa);case "esriGeometryPolyline":for(const {geometry:ea,
attributes:la}of P)L.push({attributes:la,geometry:null!=ea?h(ea,W,aa):null});break;case "esriGeometryPolygon":for(const {geometry:ea,attributes:la,centroid:ma}of P)ca=null!=ea?U(ea,W,aa):null,null!=ma?(P=F(ma),L.push({attributes:la,centroid:P,geometry:ca})):L.push({attributes:la,geometry:ca});break;default:Ja().error("convertToFeatureSet:unknown-geometry",new d(`Unable to parse unknown geometry type '${S}'`))}return L}function pa(L,P,S,W,aa,ca,ea=S,la=W){Da(L);if(!P?.coords.length)return null;aa=
Sa[aa];const {coords:ma,lengths:ua}=P;P=x(S,W);const qa=x(S&&ea,W&&la);S=B(S,W,ea,la);if(!ua.length)return S(L.coords,ma,0,0,D(ca,ma[0]),p(ca,ma[1])),Da(L,P,0),L;let ra,Ba=0,ya,Aa=0;for(const Ca of ua){if(Ca<aa)continue;let za=0;ya=Aa;la=W=D(ca,ma[Ba]);ra=ea=p(ca,ma[Ba+1]);S(L.coords,ma,ya,Ba,la,ra);za++;Ba+=P;ya+=qa;for(let Fa=1;Fa<Ca;Fa++,Ba+=P)if(la=D(ca,ma[Ba]),ra=p(ca,ma[Ba+1]),la!==W||ra!==ea)S(L.coords,ma,ya,Ba,la-W,ra-ea),ya+=qa,za++,W=la,ea=ra;za>=aa&&(L.lengths.push(za),Aa=ya)}Ea(L.coords,
Aa);return L.coords.length?L:null}function sa(L,P,S,W,aa,ca,ea){let la=W,ma=0;for(let qa=ca+S;qa<ea;qa+=S){var ua=P[qa];const ra=P[qa+1],Ba=P[ea],ya=P[ea+1];let Aa=P[ca],Ca=P[ca+1],za=Ba-Aa,Fa=ya-Ca;if(0!==za||0!==Fa){const Ra=((ua-Aa)*za+(ra-Ca)*Fa)/(za*za+Fa*Fa);1<Ra?(Aa=Ba,Ca=ya):0<Ra&&(Aa+=za*Ra,Ca+=Fa*Ra)}za=ua-Aa;Fa=ra-Ca;ua=za*za+Fa*Fa;ua>la&&(ma=qa,la=ua)}la>W&&(ma-ca>S&&sa(L,P,S,W,aa,ca,ma),aa(L,P,L.length,ma,P[ma],P[ma+1]),ea-ma>S&&sa(L,P,S,W,aa,ma,ea))}function wa(L,P,S,W,aa){const {coords:ca,
lengths:ea}=P;S=x(S,W);if(!ca.length)return L!==P&&Da(L),L;z.assertIsSome(aa);const {originPosition:la,scale:ma,translate:ua}=aa;aa=ja;aa.originPosition=la;W=aa.scale;W[0]=ma[0]??1;W[1]=-(ma[1]??1);W[2]=ma[2]??1;W[3]=ma[3]??1;var qa=aa.translate;qa[0]=ua[0]??0;qa[1]=ua[1]??0;qa[2]=ua[2]??0;qa[3]=ua[3]??0;if(!ea.length){for(W=0;W<S;++W)L.coords[W]=A(aa,ca[W],W);L!==P&&Da(L,S,0);return L}qa=0;for(let Ba=0;Ba<ea.length;Ba++){const ya=ea[Ba];L.lengths[Ba]=ya;for(var ra=0;ra<S;++ra)L.coords[qa+ra]=A(aa,
ca[qa+ra],ra);ra=L.coords[qa];let Aa=L.coords[qa+1];qa+=S;for(let Ca=1;Ca<ya;Ca++,qa+=S){ra+=ca[qa]*W[0];Aa+=ca[qa+1]*W[1];L.coords[qa]=ra;L.coords[qa+1]=Aa;for(let za=2;za<S;++za)L.coords[qa+za]=A(aa,ca[qa+za],za)}}L!==P&&Da(L,ca.length,ea.length);return L}function xa(L,P,S,W){let aa=0,ca=L[W*P],ea=L[W*(P+1)];for(let la=1;la<S;la++){const ma=ca+L[W*(P+la)],ua=ea+L[W*(P+la)+1],qa=(ma-ca)*(ua+ea);ca=ma;ea=ua;aa+=qa}return.5*aa}function Da(L,P=0,S=0){Ea(L.lengths,S);Ea(L.coords,P)}function Ea(L,P=0){L.length!==
P&&(L.length=P)}const Ja=()=>n.getLogger("esri.layers.graphics.featureConversionUtils"),Sa={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},ab=(L,P,S,W,aa,ca)=>{L[S]=aa;L[S+1]=ca},La=(L,P,S,W,aa,ca)=>{L[S]=aa;L[S+1]=ca;L[S+2]=P[W+2]},u=(L,P,S,W,aa,ca)=>{L[S]=aa;L[S+1]=ca;L[S+2]=P[W+3]},O=(L,P,S,W,aa,ca)=>{L[S]=aa;L[S+1]=ca;L[S+2]=P[W+2];L[S+3]=P[W+3]},X=[],ba=[],ja={originPosition:"lowerLeft",scale:[1,1,1,1],
translate:[0,0,0,0]};a.convertFromFeature=function(L,P,S,W,aa){X[0]=L;[L]=ia(ba,X,P,S,W,aa);Ea(X);Ea(ba);return L};a.convertFromFeatureSet=function(L,P){const S=new f,{hasM:W,hasZ:aa,features:ca,objectIdFieldName:ea,spatialReference:la,geometryType:ma,exceededTransferLimit:ua,transform:qa,fields:ra}=L;ra&&(S.fields=ra);S.geometryType=ma??null;S.objectIdFieldName=ea??P??null;S.spatialReference=la??null;if(!S.objectIdFieldName)return Ja().error(new d("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),
S;ca&&ia(S.features,ca,ma,aa,W,S.objectIdFieldName);ua&&(S.exceededTransferLimit=ua);W&&(S.hasM=W);aa&&(S.hasZ=aa);qa&&(S.transform=qa);return S};a.convertFromFeatures=ia;a.convertFromGeometry=function(L,P,S){if(null==L)return null;const W=new v;"hasZ"in L&&null==P&&(P=L.hasZ);"hasM"in L&&null==S&&(S=L.hasM);if(b.isPoint(L))return C(null!=P?P:null!=L.z,null!=S?S:null!=L.m)(W,L);if(b.isPolygon(L))return Y(W,L,P,S);if(b.isPolyline(L))return J(W,L,x(P,S));if(b.isMultipoint(L))return k(W,L,x(P,S));Ja().error("convertFromGeometry:unknown-geometry",
new d(`Unable to parse unknown geometry type '${L}'`))};a.convertFromMultipoint=k;a.convertFromMultipointFeatures=R;a.convertFromNestedArray=da;a.convertFromPoint=Q;a.convertFromPointFeatures=N;a.convertFromPolygon=Y;a.convertFromPolyline=J;a.convertFromPolylineFeatures=t;a.convertToFeature=function(L,P,S,W){ba[0]=L;oa(X,ba,P,S,W);L=X[0];Ea(X);Ea(ba);return L};a.convertToFeatureSet=function(L){const {objectIdFieldName:P,spatialReference:S,transform:W,fields:aa,hasM:ca,hasZ:ea,features:la,geometryType:ma,
exceededTransferLimit:ua,uniqueIdField:qa,queryGeometry:ra,queryGeometryType:Ba}=L;L=oa([],la,ma,ea,ca);const ya=na(ra,Ba,!1,!1);L={features:L,fields:aa,geometryType:ma,objectIdFieldName:P,spatialReference:S,uniqueIdField:qa,queryGeometry:ya};W&&(L.transform=W);ua&&(L.exceededTransferLimit=ua);ca&&(L.hasM=ca);ea&&(L.hasZ=ea);return L};a.convertToFeatures=oa;a.convertToGeometry=na;a.convertToMultipoint=y;a.convertToMultipointFeatures=T;a.convertToPoint=function(L,P,S){return L?P?S?I(L):c(L):S?H(L):
F(L):null};a.convertToPolygon=U;a.convertToPolyline=h;a.generalizeOptimizedGeometry=function(L,P,S,W,aa,ca,ea=S,la=W){Da(L);if(!P?.coords.length)return null;aa=Sa[aa];const {coords:ma,lengths:ua}=P;P=x(S,W);const qa=x(S&&ea,W&&la);S=B(S,W,ea,la);if(!ua.length)return S(L.coords,ma,0,0,ma[0],ma[1]),Da(L,P,0),L;W=0;ca*=ca;for(const ra of ua){if(ra<aa){W+=ra*P;continue}ea=L.coords.length/qa;la=W;const Ba=W+(ra-1)*P;S(L.coords,ma,L.coords.length,la,ma[la],ma[la+1]);sa(L.coords,ma,P,ca,S,la,Ba);S(L.coords,
ma,L.coords.length,Ba,ma[Ba],ma[Ba+1]);la=L.coords.length/qa-ea;la>=aa?L.lengths.push(la):Ea(L.coords,ea*qa);W+=ra*P}return L.coords.length?L:null};a.getBoundsOptimizedGeometry=function(L,P,S,W){if(!P?.coords?.length)return null;S=x(S,W);let aa=W=Number.POSITIVE_INFINITY,ca=Number.NEGATIVE_INFINITY,ea=Number.NEGATIVE_INFINITY;if(P&&P.coords){P=P.coords;for(let la=0;la<P.length;la+=S){const ma=P[la],ua=P[la+1];W=Math.min(W,ma);ca=Math.max(ca,ma);aa=Math.min(aa,ua);ea=Math.max(ea,ua)}}r.is(L)?r.fromRectValues(L,
W,aa,ca,ea):G.fromValues(W,aa,ca,ea,L);return L};a.getQuantizedArea=function(L,P){const {coords:S,lengths:W}=L;let aa=L=0;for(let ca=0;ca<W.length;ca++){const ea=W[ca];aa+=xa(S,L,ea,P);L+=ea}return Math.abs(aa)};a.getQuantizedBoundsOptimizedGeometry=function(L,P,S,W){S=x(S,W);const {lengths:aa,coords:ca}=P;W=P=Number.POSITIVE_INFINITY;let ea=Number.NEGATIVE_INFINITY,la=Number.NEGATIVE_INFINITY,ma=0;for(const ua of aa){let qa=ca[ma],ra=ca[ma+1];P=Math.min(qa,P);W=Math.min(ra,W);ea=Math.max(qa,ea);
la=Math.max(ra,la);ma+=S;for(let Ba=1;Ba<ua;Ba++,ma+=S){const ya=ca[ma],Aa=ca[ma+1];qa+=ya;ra+=Aa;0>ya&&(P=Math.min(P,qa));0<ya&&(ea=Math.max(ea,qa));0>Aa?W=Math.min(W,ra):0<Aa&&(la=Math.max(la,ra))}}L[0]=P;L[1]=W;L[2]=ea;L[3]=la;return L};a.getSignedQuantizedRingArea=xa;a.quantizeOptimizedFeatureSet=function(L,P){const {geometryType:S,features:W,hasM:aa,hasZ:ca}=P;if(!L)return P;for(let ea=0;ea<W.length;ea++){const la=W[ea],ma=la.weakClone();ma.geometry=new v;pa(ma.geometry,la.geometry,aa,ca,S,L);
la.centroid&&(ma.centroid=new v,pa(ma.centroid,la.centroid,aa,ca,"esriGeometryPoint",L));W[ea]=ma}P.transform=L;return P};a.quantizeOptimizedGeometry=pa;a.quantizeX=D;a.quantizeY=p;a.removeCollinearVertices=function(L,P,S,W,aa){if(!P?.coords?.length)return null;S=Sa[S];const {coords:ca,lengths:ea}=P;P=B(W,aa,W,aa);W=x(W,aa);let la=aa=0,ma=0,ua=0;for(const Ba of ea){la=ua;P(L.coords,ca,la,aa,ca[aa],ca[aa+1]);aa+=W;var qa=ca[aa];let ya=ca[aa+1],Aa=qa,Ca=ya;var ra=ya/qa;la+=W;P(L.coords,ca,la,aa,Aa,
Ca);aa+=W;for(let za=2;za<Ba;za++){qa=ca[aa];ya=ca[aa+1];const Fa=ya/qa,Ra=ra===Fa||!isFinite(ra)&&!isFinite(Fa);ra=Ra&&isFinite(Fa)?0<=ra&&0<=Fa||0>=ra&&0>=Fa:0<=Ca&&0<=ya||0>=Ca&&0>=ya;Ra&&ra?(Aa+=qa,Ca+=ya):(Aa=qa,Ca=ya,la+=W);P(L.coords,ca,la,aa,Aa,Ca);aa+=W;ra=Fa}la+=W;qa=(la-ua)/W;qa>=S&&(L.lengths[ma]=qa,ua=la,ma++)}L.coords.length>ua&&(L.coords.length=ua);L.lengths.length>ma&&(L.lengths.length=ma);return L.coords.length&&L.lengths.length?L:null};a.removeZMValues=function(L,P,S,W,aa,ca){Da(L);
L.lengths.push(...P.lengths);if(S===aa&&W===ca)for(var ea=0;ea<P.coords.length;ea++)L.coords.push(P.coords[ea]);else for(ea=x(S,W),S=B(S,W,aa,ca),P=P.coords,W=0;W<P.length;W+=ea)S(L.coords,P,L.coords.length,W,P[W],P[W+1]);return L};a.unquantizeOptimizedFeatureSet=function(L){const {transform:P,features:S,hasM:W,hasZ:aa}=L;if(!P)return L;for(const ca of S)null!=ca.geometry&&wa(ca.geometry,ca.geometry,W,aa,P),null!=ca.centroid&&wa(ca.centroid,ca.centroid,W,aa,P);L.transform=null;return L};a.unquantizeOptimizedGeometry=
wa;a.unquantizeValue=A;a.unquantizeX=function(L,P){return A(L,P,0)};a.unquantizeY=function(L,P){return A(L,-P,1)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedFeature":function(){define(["exports","./OptimizedGeometry"],function(a,d){class n{constructor(r=null,G={},b,m){this.geometry=r;this.attributes=G;this.centroid=b;this.objectId=m;this.geohashY=this.geohashX=this.displayId=0}static fromJSON(r,G){const b=r.geometry?d.fromJSON(r.geometry):null,m=
r.centroid?d.fromJSON(r.centroid):null;return new n(b,r.attributes,m,r.attributes[G])}weakClone(){const r=new n(this.geometry,this.attributes,this.centroid,this.objectId);r.displayId=this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}clone(){var r=this.geometry?.clone();r=new n(r,{...this.attributes},this.centroid?.clone(),this.objectId);r.displayId=this.displayId;r.geohashX=this.geohashX;r.geohashY=this.geohashY;return r}}class z extends n{}a.OptimizedFeature=n;a.OptimizedFeatureWithGeometry=
z;a.hasGeometry=function(r){return!!r.geometry?.coords?.length};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/OptimizedGeometry":function(){define(function(){class a{constructor(d=[],n=[]){this.lengths=d??[];this.coords=n??[]}static fromJSON(d){return new a(d.lengths,d.coords)}static fromRect(d){const [n,z,r,G]=d;d=r-n;const b=G-z;return new a([5],[n,z,d,0,0,b,-d,0,0,-b])}get isPoint(){return 0===this.lengths.length&&2<=this.coords.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((d,
n)=>d+n)}forEachVertex(d){let n=0;this.lengths.length||d(this.coords[0],this.coords[1]);for(let z=0;z<this.lengths.length;z++){const r=this.lengths[z];for(let G=0;G<r;G++)d(this.coords[2*(G+n)],this.coords[2*(G+n)+1]);n+=r}}deltaDecode(){const d=this.clone(),{coords:n,lengths:z}=d;let r=0;for(const G of z){for(let b=1;b<G;b++)n[2*(r+b)]+=n[2*(r+b)-2],n[2*(r+b)+1]+=n[2*(r+b)-1];r+=G}return d}clone(d){if(0===this.lengths.length)return new a([],[this.coords[0],this.coords[1]]);var n=2*(0===this.lengths.length?
1:this.lengths.reduce((z,r)=>z+r));n=this.coords.slice(0,n);return d?(d.set(n),new a(this.lengths,d)):new a(Array.from(this.lengths),Array.from(n))}}return a})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(function(){class a{constructor(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1;this.queryGeometry=
this.queryGeometryType=this.uniqueIdField=null}weakClone(){const d=new a;d.objectIdFieldName=this.objectIdFieldName;d.globalIdFieldName=this.globalIdFieldName;d.geohashFieldName=this.geohashFieldName;d.geometryProperties=this.geometryProperties;d.geometryType=this.geometryType;d.spatialReference=this.spatialReference;d.hasZ=this.hasZ;d.hasM=this.hasM;d.features=this.features;d.fields=this.fields;d.transform=this.transform;d.exceededTransferLimit=this.exceededTransferLimit;d.uniqueIdField=this.uniqueIdField;
d.queryGeometry=this.queryGeometry;d.queryGeometryType=this.queryGeometryType;return d}}return a})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],function(a,d,n,z){function r(m,f,v){G.minX=f[0];G.minY=f[1];G.maxX=f[2];G.maxY=f[3];m.search(G,v)}const G={minX:0,minY:0,maxX:0,maxY:0};class b{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=
new Map;this._index=new n.PooledRBush(9,d("esri-csp-restrictions")?m=>({minX:m[0],minY:m[1],maxX:m[2],maxY:m[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const m=Array(this._idByBounds.size);let f=0;this._idByBounds.forEach((v,x)=>{m[f++]=x});this._indexInvalid=!1;this._index.clear();this._index.load(m)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(m=>this._idByBounds.has(m))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;
const m=z.empty();for(const f of this._boundsById.values())f&&(m[0]=Math.min(f[0],m[0]),m[1]=Math.min(f[1],m[1]),m[2]=Math.max(f[2],m[2]),m[3]=Math.max(f[3],m[3]));return m}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(m){const f=this._boundsById.get(m);this._boundsById.delete(m);f&&(this._idByBounds.delete(f),this._indexInvalid||this._index.remove(f))}forEachInBounds(m,f){this._loadIndex();
r(this._index,m,v=>f(this._idByBounds.get(v)))}get(m){return this._boundsById.get(m)}has(m){return this._boundsById.has(m)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(m,f){if(!this._indexInvalid){const v=this._boundsById.get(m);v&&(this._index.remove(v),this._idByBounds.delete(v))}this._boundsById.set(m,f);f&&(this._idByBounds.set(f,m),this._indexInvalid||(this._boundsToLoad.push(f),5E4<this._boundsToLoad.length&&this._loadIndex()))}}a.BoundsStore=
b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../has","../../PooledArray","../../../chunks/quickselect"],function(a,d,n,z,r){function G(Q,T){for(l.clear();Q;){if(!0===Q.leaf)for(const y of Q.children)T(y);else l.pushArray(Q.children);Q=l.pop()??null}}function b(Q,T){m(Q,0,Q.children.length,T,Q)}function m(Q,T,y,R,k){k||=new C([]);k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;
for(let h=T,t;h<y;h++)t=Q.children[h],f(k,Q.leaf?R(t):t);return k}function f(Q,T){Q.minX=Math.min(Q.minX,T.minX);Q.minY=Math.min(Q.minY,T.minY);Q.maxX=Math.max(Q.maxX,T.maxX);Q.maxY=Math.max(Q.maxY,T.maxY)}function v(Q,T){return Q.minX-T.minX}function x(Q,T){return Q.minY-T.minY}function B(Q){return(Q.maxX-Q.minX)*(Q.maxY-Q.minY)}function D(Q){return Q.maxX-Q.minX+(Q.maxY-Q.minY)}function p(Q,T){return Q.minX<=T.minX&&Q.minY<=T.minY&&T.maxX<=Q.maxX&&T.maxY<=Q.maxY}function A(Q,T){return T.minX<=Q.maxX&&
T.minY<=Q.maxY&&T.maxX>=Q.minX&&T.maxY>=Q.minY}function F(Q,T,y,R,k){for(T=[T,y];T.length;){y=T.pop();const h=T.pop();if(y-h<=R)continue;const t=h+Math.ceil((y-h)/R/2)*R;r.quickselect(Q,t,h,y,k);T.push(h,t,t,y)}}class q{constructor(Q=9,T){this._compareMinX=v;this._compareMinY=x;this._toBBox=y=>y;this._maxEntries=Math.max(4,Q||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));T&&("function"===typeof T?this._toBBox=T:this._initFormat(T));this.clear()}destroy(){this.clear();c.prune();l.prune();
H.prune();g.prune()}all(Q){G(this._data,Q)}search(Q,T){let y=this._data;const R=this._toBBox;if(A(Q,y))for(c.clear();y;){for(let k=0,h=y.children.length;k<h;k++){const t=y.children[k],J=y.leaf?R(t):t;A(Q,J)&&(y.leaf?T(t):p(Q,J)?G(t,T):c.push(t))}y=c.pop()}}collides(Q){let T=this._data;const y=this._toBBox;if(!A(Q,T))return!1;for(c.clear();T;){for(let R=0,k=T.children.length;R<k;R++){const h=T.children[R],t=T.leaf?y(h):h;if(A(Q,t)){if(T.leaf||p(Q,t))return!0;c.push(h)}}T=c.pop()}return!1}load(Q){if(!Q.length)return this;
if(Q.length<this._minEntries){for(let T=0,y=Q.length;T<y;T++)this.insert(Q[T]);return this}Q=this._build(Q.slice(),0,Q.length-1,0);if(this._data.children.length)if(this._data.height===Q.height)this._splitRoot(this._data,Q);else{if(this._data.height<Q.height){const T=this._data;this._data=Q;Q=T}this._insert(Q,this._data.height-Q.height-1,!0)}else this._data=Q;return this}insert(Q){Q&&this._insert(Q,this._data.height-1);return this}clear(){this._data=new C([]);return this}remove(Q){if(!Q)return this;
let T=this._data,y=null,R=0,k=!1,h;const t=this._toBBox(Q);H.clear();for(g.clear();T||0<H.length;){T||(T=H.pop(),y=H.data[H.length-1],R=g.pop()??0,k=!0);if(T.leaf&&(h=d.indexOf(T.children,Q,T.children.length,T.indexHint),-1!==h)){T.children.splice(h,1);H.push(T);this._condense(H);break}k||T.leaf||!p(T,t)?y?(R++,T=y.children[R],k=!1):T=null:(H.push(T),g.push(R),R=0,y=T,T=T.children[0])}return this}toJSON(){return this._data}fromJSON(Q){this._data=Q;return this}_build(Q,T,y,R){var k=y-T+1,h=this._maxEntries;
if(k<=h)return Q=new C(Q.slice(T,y+1)),b(Q,this._toBBox),Q;R||(R=Math.ceil(Math.log(k)/Math.log(h)),h=Math.ceil(k/h**(R-1)));const t=new N([]);t.height=R;k=Math.ceil(k/h);h=k*Math.ceil(Math.sqrt(h));for(F(Q,T,y,h,this._compareMinX);T<=y;T+=h){const J=Math.min(T+h-1,y);F(Q,T,J,k,this._compareMinY);for(let U=T;U<=J;U+=k)t.children.push(this._build(Q,U,Math.min(U+k-1,J),R-1))}b(t,this._toBBox);return t}_insert(Q,T,y){var R=this._toBBox;y=y?Q:R(Q);H.clear();R=this._data;for(var k=T,h=H;;){h.push(R);if(!0===
R.leaf||h.length-1===k)break;let t=Infinity,J=Infinity,U=void 0;for(let Y=0,da=R.children.length;Y<da;Y++){const ia=R.children[Y],na=B(ia),oa=(Math.max(ia.maxX,y.maxX)-Math.min(ia.minX,y.minX))*(Math.max(ia.maxY,y.maxY)-Math.min(ia.minY,y.minY))-na;oa<J?(J=oa,t=na<t?na:t,U=ia):oa===J&&na<t&&(t=na,U=ia)}R=U||R.children[0]}R.children.push(Q);for(f(R,y);0<=T;)if(H.data[T].children.length>this._maxEntries)this._split(H,T),T--;else break;for(Q=H;0<=T;T--)f(Q.data[T],y)}_split(Q,T){const y=Q.data[T];var R=
y.children.length;const k=this._minEntries;this._chooseSplitAxis(y,k,R);if(R=this._chooseSplitIndex(y,k,R))R=y.children.splice(R,y.children.length-R),R=y.leaf?new C(R):new N(R),R.height=y.height,b(y,this._toBBox),b(R,this._toBBox),T?Q.data[T-1].children.push(R):this._splitRoot(y,R)}_splitRoot(Q,T){this._data=new N([Q,T]);this._data.height=Q.height+1;b(this._data,this._toBBox)}_chooseSplitIndex(Q,T,y){let R,k,h=void 0;R=k=Infinity;for(let J=T;J<=y-T;J++){var t=m(Q,0,J,this._toBBox);const U=m(Q,J,y,
this._toBBox),Y=Math.max(0,Math.min(t.maxX,U.maxX)-Math.max(t.minX,U.minX))*Math.max(0,Math.min(t.maxY,U.maxY)-Math.max(t.minY,U.minY));t=B(t)+B(U);Y<R?(R=Y,h=J,k=t<k?t:k):Y===R&&t<k&&(k=t,h=J)}return h}_chooseSplitAxis(Q,T,y){const R=Q.leaf?this._compareMinX:v,k=Q.leaf?this._compareMinY:x,h=this._allDistMargin(Q,T,y,R);T=this._allDistMargin(Q,T,y,k);h<T&&Q.children.sort(R)}_allDistMargin(Q,T,y,R){Q.children.sort(R);R=this._toBBox;var k=m(Q,0,T,R);const h=m(Q,y-T,y,R);let t=D(k)+D(h);for(let J=T;J<
y-T;J++){const U=Q.children[J];f(k,Q.leaf?R(U):U);t+=D(k)}for(y=y-T-1;y>=T;y--)k=Q.children[y],f(h,Q.leaf?R(k):k),t+=D(h);return t}_condense(Q){for(let T=Q.length-1;0<=T;T--){const y=Q.data[T];if(0===y.children.length)if(0<T){const R=Q.data[T-1],k=R.children;k.splice(d.indexOf(k,y,k.length,R.indexHint),1)}else this.clear();else b(y,this._toBBox)}}_initFormat(Q){const T=["return a"," - b",";"];this._compareMinX=new Function("a","b",T.join(Q[0]));this._compareMinY=new Function("a","b",T.join(Q[1]));
this._toBBox=new Function("a","return {minX: a"+Q[0]+", minY: a"+Q[1]+", maxX: a"+Q[2]+", maxY: a"+Q[3]+"};")}}const c=new z,l=new z,H=new z,g=new z({deallocator:void 0});class I{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class E extends I{constructor(){super(...arguments);this.height=1;this.indexHint=new d.PositionHint}}class C extends E{constructor(Q){super();this.children=Q;this.leaf=!0}}class N extends E{constructor(Q){super();this.children=Q;this.leaf=!1}}a.BBox=
I;a.PooledRBush=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports"],function(a){function d(r,G,b,m,f){for(;m>b;){if(600<m-b){var v=m-b+1,x=G-b+1,B=Math.log(v),D=.5*Math.exp(2*B/3);B=.5*Math.sqrt(B*D*(v-D)/v)*(0>x-v/2?-1:1);d(r,G,Math.max(b,Math.floor(G-x*D/v+B)),Math.min(m,Math.floor(G+(v-x)*D/v+B)),f)}v=r[G];x=b;D=m;n(r,b,G);for(0<f(r[m],v)&&n(r,b,m);x<D;){n(r,x,D);x++;for(D--;0>f(r[x],v);)x++;for(;0<f(r[D],v);)D--}0===f(r[b],
v)?n(r,b,D):(D++,n(r,D,m));D<=G&&(b=D+1);G<=D&&(m=D-1)}}function n(r,G,b){var m=r[G];r[G]=r[b];r[b]=m}function z(r,G){return r<G?-1:r>G?1:0}a.quickselect=function(r,G,b,m,f){d(r,G,b||0,m||r.length-1,f||z)}})},"esri/layers/graphics/data/geometryUtils":function(){define(["exports","../featureConversionUtils","../OptimizedGeometry"],function(a,d,n){const z=new n,r=new n,G=new n,b={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint},
m=(f,v)=>"_geVersion"!==f?v:void 0;a.cleanFromGeometryEngine=function(f){return f&&"_geVersion"in f?JSON.parse(JSON.stringify(f,m)):f};a.getGeometry=function(f,v,x,B,D,p,A=v,F=x){const q=v&&A,c=x&&F;B=null!=B?"coords"in B?B:B.geometry:null;if(null==B)return null;if(D)return v=d.generalizeOptimizedGeometry(r,B,v,x,f,D,A,F),p&&(v=d.quantizeOptimizedGeometry(G,v,q,c,f,p)),b[f]?.(v,q,c)??null;if(p)return p=d.quantizeOptimizedGeometry(G,B,v,x,f,p,A,F),b[f]?.(p,q,c)??null;d.removeZMValues(z,B,v,x,A,F);
return b[f]?.(z,q,c)??null};a.transformCentroid=function(f,v,x,B=f.hasZ,D=f.hasM){if(null==v)return null;const p=f.hasZ&&B,A=f.hasM&&D;return x?(f=d.quantizeOptimizedGeometry(G,v,f.hasZ,f.hasM,"esriGeometryPoint",x,B,D),d.convertToPoint(f,p,A)):d.convertToPoint(v,p,A)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(a,d,n,
z){a.optimizedFeatureQueryEngineAdapter={getObjectId(r){return r.objectId},getAttributes(r){return r.attributes},getAttribute(r,G){return r.attributes[G]},cloneWithGeometry(r,G){return new n.OptimizedFeature(G,r.attributes,null,r.objectId)},getGeometry(r){return r.geometry},getCentroid(r,G){null==r.centroid&&(r.centroid=d.getCentroidOptimizedGeometry(new z,r.geometry,G.hasZ,G.hasM));return r.centroid}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/centroid":function(){define(["exports"],
function(a){function d(z,r,G,b,m,f){f=m?f?4:3:f?3:2;let v=G,x=G+f,B=0,D=0,p=G=0,A=0;for(let F=0,q=b-1;F<q;F++,v+=f,x+=f){b=r[v];const c=r[v+1],l=r[v+2],H=r[x],g=r[x+1],I=r[x+2];let E=b*g-H*c;p+=E;B+=(b+H)*E;D+=(c+g)*E;m&&(E=b*I-H*l,G+=(l+I)*E,A+=E);b<z[0]&&(z[0]=b);b>z[1]&&(z[1]=b);c<z[2]&&(z[2]=c);c>z[3]&&(z[3]=c);m&&(l<z[4]&&(z[4]=l),l>z[5]&&(z[5]=l))}0<p&&(p*=-1);0<A&&(A*=-1);if(!p)return null;z=[B,D,.5*p];m&&(z[3]=G,z[4]=.5*A);return z}function n(z,r,G,b,m){m=b?m?4:3:m?3:2;let f=r,v=r+m,x=0,B=
0,D=0,p=0;for(let c=0,l=G-1;c<l;c++,f+=m,v+=m){var A=z[f];const H=z[f+1],g=z[f+2],I=z[v],E=z[v+1],C=z[v+2];if(b){var F=I-A;var q=E-H;const N=C-g;F=Math.sqrt(F*F+q*q+N*N)}else F=I-A,q=E-H,F=Math.sqrt(F*F+q*q);F&&(x+=F,b?(A=[A+.5*(I-A),H+.5*(E-H),g+.5*(C-g)],B+=F*A[0],D+=F*A[1],p+=F*A[2]):(A=[A+.5*(I-A),H+.5*(E-H)],B+=F*A[0],D+=F*A[1]))}return 0<x?b?[B/x,D/x,p/x]:[B/x,D/x]:0<G?b?[z[r],z[r+1],z[r+2]]:[z[r],z[r+1]]:null}a.getCentroidOptimizedGeometry=function(z,r,G,b){if(!r?.lengths.length)return null;
z.lengths.length&&(z.lengths.length=0);z.coords.length&&(z.coords.length=0);const m=z.coords,f=[],v=G?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:x,coords:B}=r;var D=G?b?4:3:b?3:2;let p=0;for(const A of x){const F=d(v,B,p,A,G,b);F&&f.push(F);p+=A*D}f.sort((A,F)=>{let q=A[2]-F[2];0===
q&&G&&(q=A[4]-F[4]);return q});f.length&&(D=6*f[0][2],m[0]=f[0][0]/D,m[1]=f[0][1]/D,G&&(D=6*f[0][4],m[2]=0!==D?f[0][3]/D:0),m[0]<v[0]||m[0]>v[1]||m[1]<v[2]||m[1]>v[3]||G&&(m[2]<v[4]||m[2]>v[5]))&&(m.length=0);if(!m.length)if(r=r.lengths[0]?n(B,0,x[0],G,b):null)m[0]=r[0],m[1]=r[1],G&&2<r.length&&(m[2]=r[2]);else return null;return z};a.lineCentroid=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngine":function(){define("exports ../../../core/arrayUtils ../../../core/Error ../../../core/JSONSupport ../../../core/lang ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./attributeSupport ./geometryUtils ./projectionSupport ./QueryEngineCache ./QueryEngineCapabilities ./QueryEngineResult ./queryUtils ./queryValidationUtils ./spatialQuerySupport ./timeSupport ../../support/FieldsIndex ../../../views/support/Scheduler".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H,g,I,E,C,N,Q,T,y){function R(t){if(N.canQueryWithRBush(t)){if(D.isExtent(t))return[x.fromValues(Math.min(t.xmin,t.xmax),Math.min(t.ymin,t.ymax),Math.max(t.xmin,t.xmax),Math.max(t.ymin,t.ymax))];if(D.isPolygon(t))return t.rings.map(J=>x.fromValues(Math.min(J[0][0],J[2][0]),Math.min(J[0][1],J[2][1]),Math.max(J[0][0],J[2][0]),Math.max(J[0][1],J[2][1])))}return[B.getBoundsXY(x.create(),t)]}class k{constructor(t,J=null,U,Y,da){this.attributes=t;this.geometry=
U;this.centroid=Y;this.filterFlags=da;this.groupId=-1;this.displayId=J}}class h{constructor(t){this._cache=new H.QueryEngineCache;this._changeHandle=null;this.capabilities={query:g.queryCapabilities};this.geometryType=t.geometryType;this.hasM=!!t.hasM;this.hasZ=!!t.hasZ;this.objectIdField=t.objectIdField;this.spatialReference=t.spatialReference;this.definitionExpression=t.definitionExpression;this.featureStore=t.featureStore;this.aggregateAdapter=t.aggregateAdapter;this._changeHandle=this.featureStore.events.on("changed",
()=>this.clearCache());this.timeInfo=t.timeInfo;this.fieldsIndex=z.isSerializable(t.fieldsIndex)?t.fieldsIndex:T.fromJSON(t.fieldsIndex);this.availableFields=!t.availableFields||1===t.availableFields.length&&"*"===t.availableFields[0]?new Set(this.fieldsIndex.fields.map(J=>J.name)):new Set(t.availableFields.map(J=>this.fieldsIndex.get(J)?.name).filter(J=>null!=J));t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}destroy(){this._frameTask=G.removeMaybe(this._frameTask);
this.clearCache();G.destroyMaybe(this._cache);this._changeHandle=G.removeMaybe(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._cache.clear();this._fullExtentPromise=this._timeExtentPromise=this._allFeaturesPromise=null}async executeQuery(t,J){J=b.signalFromSignalOrOptions(J);try{return await (await this._executeQuery(t,{},J)).createQueryResponse()}catch(U){if(U!==E.queryEngineEmptyResult)throw U;return(new I.QueryEngineResult([],t,this)).createQueryResponse()}}async executeQueryForCount(t=
{},J){J=b.signalFromSignalOrOptions(J);try{return(await this._executeQuery(t,{returnGeometry:!1,returnCentroid:!1,outSR:null},J)).createQueryResponseForCount()}catch(U){if(U!==E.queryEngineEmptyResult)throw U;return 0}}async executeQueryForExtent(t,J){J=b.signalFromSignalOrOptions(J);const U=t.outSR;try{const Y=await this._executeQuery(t,{returnGeometry:!0,returnCentroid:!1,outSR:null},J),da=Y.size;if(!da)return{count:0,extent:null};const ia=await this._getBounds(Y.items,Y.spatialReference,U||this.spatialReference);
return{count:da,extent:ia}}catch(Y){if(Y===E.queryEngineEmptyResult)return{count:0,extent:null};throw Y;}}async executeQueryForIds(t,J){return this.executeQueryForIdSet(t,J).then(U=>Array.from(U))}async executeQueryForIdSet(t,J){J=b.signalFromSignalOrOptions(J);try{const U=await this._executeQuery(t,{returnGeometry:!0,returnCentroid:!1,outSR:null},J),Y=U.items,da=new Set;await this._reschedule(()=>{for(const ia of Y)da.add(U.featureAdapter.getObjectId(ia))},J);return da}catch(U){if(U===E.queryEngineEmptyResult)return new Set;
throw U;}}async executeQueryForSnapping(t,J){const U=b.signalFromSignalOrOptions(J),{point:Y,distance:da,returnEdge:ia,vertexMode:na}=t;if(!ia&&"none"===na)return{candidates:[]};let oa=r.clone(t.query);oa=await this._schedule(()=>E.normalizeQueryLike(oa,this.definitionExpression,this.spatialReference),U);oa=await this._reschedule(()=>C.validateQuery(oa,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),U);(J=!A.equals(Y.spatialReference,
this.spatialReference))&&await l.checkProjectionSupport(Y.spatialReference,this.spatialReference);var pa="number"===typeof da?da:da.x,sa="number"===typeof da?da:da.y;pa={xmin:Y.x-pa,xmax:Y.x+pa,ymin:Y.y-sa,ymax:Y.y+sa,spatialReference:Y.spatialReference};pa=J?l.project(pa,this.spatialReference):pa;if(!pa)return{candidates:[]};sa=(await p.normalizeCentralMeridian(D.fromJSON(Y),null,{signal:U}))[0];const wa=(await p.normalizeCentralMeridian(D.fromJSON(pa),null,{signal:U}))[0];if(null==sa||null==wa)return{candidates:[]};
const xa=new I.QueryEngineResult(await this._reschedule(()=>this._searchFeatures(R(wa.toJSON())),U),oa,this);await this._reschedule(()=>this._executeObjectIdsQuery(xa),U);await this._reschedule(()=>this._executeTimeQuery(xa),U);await this._reschedule(()=>this._executeAttributesQuery(xa),U);await this._reschedule(()=>this._executeGeometryQueryForSnapping(xa,U),U);sa=sa.toJSON();sa=J?l.project(sa,this.spatialReference):sa;return xa.createSnappingResponse({...t,point:sa,distance:J?Math.max(pa.xmax-pa.xmin,
pa.ymax-pa.ymin)/2:da},Y.spatialReference)}async executeQueryForLatestObservations(t,J){J=b.signalFromSignalOrOptions(J);if(!this.timeInfo?.trackIdField)throw new n("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:this.timeInfo});try{const U=await this._executeQuery(t,{},J);await this._reschedule(()=>this._filterLatest(U),J);return await U.createQueryResponse()}catch(U){if(U!==E.queryEngineEmptyResult)throw U;return(new I.QueryEngineResult([],t,this)).createQueryResponse()}}async executeQueryForSummaryStatistics(t=
{},J,U){U=b.signalFromSignalOrOptions(U);const {field:Y,normalizationField:da,valueExpression:ia}=J;return(await this._executeQueryForStatistics(t,{field:Y,normalizationField:da,valueExpression:ia},U)).createSummaryStatisticsResponse(J)}async executeQueryForUniqueValues(t={},J,U){U=b.signalFromSignalOrOptions(U);const {field:Y,field2:da,field3:ia,valueExpression:na}=J;return(await this._executeQueryForStatistics(t,{field:Y,field2:da,field3:ia,valueExpression:na},U)).createUniqueValuesResponse(J)}async executeQueryForClassBreaks(t=
{},J,U){U=b.signalFromSignalOrOptions(U);const {field:Y,normalizationField:da,valueExpression:ia}=J;return(await this._executeQueryForStatistics(t,{field:Y,normalizationField:da,valueExpression:ia},U)).createClassBreaksResponse(J)}async executeQueryForHistogram(t={},J,U){U=b.signalFromSignalOrOptions(U);const {field:Y,normalizationField:da,valueExpression:ia}=J;return(await this._executeQueryForStatistics(t,{field:Y,normalizationField:da,valueExpression:ia},U)).createHistogramResponse(J)}async fetchRecomputedExtents(t){t=
b.signalFromSignalOrOptions(t);this._timeExtentPromise||(this._timeExtentPromise=Q.getTimeExtent(this.timeInfo,this.featureStore));const [J,U]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);b.throwIfAborted(t);return{fullExtent:J,timeExtent:U}}async _getBounds(t,J,U){const Y=v.set(v.create(),v.negativeInfinity);await this.featureStore.forEachBounds(t,da=>v.expandWithAABB(Y,da));t={xmin:Y[0],ymin:Y[1],xmax:Y[3],ymax:Y[4],spatialReference:c.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(Y[2])&&isFinite(Y[5])&&(t.zmin=Y[2],t.zmax=Y[5],t.hasZ=!0);J=l.project(t,J,U);J.spatialReference=c.cleanFromGeometryEngine(U);0===J.xmax-J.xmin&&(U=m.getMetersPerUnitForSR(J.spatialReference),J.xmin-=U,J.xmax+=U);0===J.ymax-J.ymin&&(U=m.getMetersPerUnitForSR(J.spatialReference),J.ymin-=U,J.ymax+=U);this.hasZ&&null!=J.zmin&&null!=J.zmax&&0===J.zmax-J.zmin&&(U=m.getMetersPerUnitForSR(J.spatialReference),J.zmin-=U,J.zmax+=U);return J}_getFullExtent(){this._fullExtentPromise||(this._fullExtentPromise=
"getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then(t=>this._getBounds(t,this.spatialReference,this.spatialReference)));return this._fullExtentPromise}async _schedule(t,J){return null!=this._frameTask?this._frameTask.schedule(t,J):t(y.noBudget)}async _reschedule(t,J){return null!=this._frameTask?this._frameTask.reschedule(t,J):t(y.noBudget)}async _getAllFeaturesQueryEngineResult(t){return new I.QueryEngineResult(await this._getAllFeatures(),
t,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const U=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach(Y=>U.push(Y))})().then(()=>U)}const t=this._allFeaturesPromise,J=await t;return t===this._allFeaturesPromise?J.slice():this._getAllFeatures()}async _executeQuery(t,J,U){t=r.clone(t);t=await this._schedule(()=>E.normalizeQuery(t,this.definitionExpression,this.spatialReference),U);t=await this._reschedule(()=>C.validateQuery(t,{availableFields:this.availableFields,
fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference}),U);t={...t,...J};const Y=await this._reschedule(()=>this._executeSceneFilterQuery(t,U),U),da=await this._reschedule(()=>this._executeGeometryQuery(t,Y,U),U);await this._reschedule(()=>this._executeAggregateIdsQuery(da),U);await this._reschedule(()=>this._executeObjectIdsQuery(da),U);await this._reschedule(()=>this._executeTimeQuery(da),U);await this._reschedule(()=>this._executeAttributesQuery(da),
U);return da}async _executeSceneFilterQuery(t,J){if(null==t.sceneFilter)return null;const {outSR:U,returnGeometry:Y,returnCentroid:da}=t;var ia=this.featureStore.featureSpatialReference,na=t.sceneFilter.geometry;const oa=null==ia||A.equals(ia,na.spatialReference)?na:l.project(na,ia);if(!oa)return null;ia=Y||da;ia=A.isValid(U)&&!A.equals(this.spatialReference,U)&&ia?async xa=>this._project(xa,U):xa=>xa;const pa=this.featureAdapter;na=await this._reschedule(()=>this._searchFeatures(R(oa)),J);if("disjoint"===
t.sceneFilter.spatialRelationship){if(!na.length)return null;const xa=new Set;for(var sa of na)xa.add(pa.getObjectId(sa));const Da=await this._reschedule(()=>this._getAllFeatures(),J);sa=await this._reschedule(async()=>{const Ea=await N.getSpatialQueryOperator("esriSpatialRelDisjoint",oa,this.geometryType,this.hasZ,this.hasM),Ja=await this._runSpatialFilter(Da,Sa=>!xa.has(pa.getObjectId(Sa))||Ea(pa.getGeometry(Sa)),J);return new I.QueryEngineResult(Ja,t,this)},J);return ia(sa)}if(!na.length)return new I.QueryEngineResult([],
t,this);if(this._canExecuteSinglePass(oa,t))return ia(new I.QueryEngineResult(na,t,this));const wa=await N.getSpatialQueryOperator("esriSpatialRelContains",oa,this.geometryType,this.hasZ,this.hasM);sa=await this._runSpatialFilter(na,xa=>wa(pa.getGeometry(xa)),J);return ia(new I.QueryEngineResult(sa,t,this))}async _executeGeometryQuery(t,J,U){if(null!=J&&0===J.items.length)return J;t=null!=J?J.query:t;const {geometry:Y,outSR:da,spatialRel:ia,returnGeometry:na,returnCentroid:oa}=t;var pa=this.featureStore.featureSpatialReference;
const sa=!Y||null==pa||A.equals(pa,Y.spatialReference)?Y:l.project(Y,pa),wa=na||oa,xa=A.isValid(da)&&!A.equals(this.spatialReference,da),Da=null==J?this._getCacheKey(t):null;pa=Da?this._cache.get(Da):null;if(null!=pa)return new I.QueryEngineResult(pa,t,this);pa=async La=>{xa&&wa&&await this._project(La,da);Da&&this._cache.put(Da,La.items);return La};if(!sa)return pa(null!=J?J:await this._getAllFeaturesQueryEngineResult(t));const Ea=this.featureAdapter;let Ja=await this._reschedule(()=>this._searchFeatures(R(Y)),
U);if("esriSpatialRelDisjoint"===ia){if(!Ja.length)return pa(null!=J?J:await this._getAllFeaturesQueryEngineResult(t));const La=new Set;for(var Sa of Ja)La.add(Ea.getObjectId(Sa));const u=null!=J?J.items:await this._reschedule(()=>this._getAllFeatures(),U);Sa=await this._reschedule(async()=>{const O=await N.getSpatialQueryOperator(ia,sa,this.geometryType,this.hasZ,this.hasM),X=await this._runSpatialFilter(u,ba=>!La.has(Ea.getObjectId(ba))||O(Ea.getGeometry(ba)),U);return new I.QueryEngineResult(X,
t,this)},U);return pa(Sa)}if(null!=J){const La=new d.PositionHint;Ja=Ja.filter(u=>0<=d.indexOf(J.items,u,J.items.length,La))}if(!Ja.length)return pa=new I.QueryEngineResult([],t,this),Da&&this._cache.put(Da,pa.items),pa;if(this._canExecuteSinglePass(sa,t))return pa(new I.QueryEngineResult(Ja,t,this));const ab=await N.getSpatialQueryOperator(ia,sa,this.geometryType,this.hasZ,this.hasM);Sa=await this._runSpatialFilter(Ja,La=>ab(Ea.getGeometry(La)),U);return pa(new I.QueryEngineResult(Sa,t,this))}async _executeGeometryQueryForSnapping(t,
J){const {query:U}=t,{spatialRel:Y}=U;if(t?.items?.length&&U.geometry&&Y){var da=await N.getSpatialQueryOperator(Y,U.geometry,this.geometryType,this.hasZ,this.hasM);J=await this._runSpatialFilter(t.items,ia=>da(ia.geometry),J);t.items=J}}_executeAggregateIdsQuery(t){if(0!==t.items.length&&t.query.aggregateIds?.length&&null!=this.aggregateAdapter){var J=new Set;for(const Y of t.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(Y).forEach(da=>J.add(da));var U=this.featureAdapter.getObjectId;
t.items=t.items.filter(Y=>J.has(U(Y)))}}_executeObjectIdsQuery(t){if(0!==t.items.length&&t.query.objectIds?.length){var J=new Set(t.query.objectIds),U=this.featureAdapter.getObjectId;t.items=t.items.filter(Y=>J.has(U(Y)))}}_executeTimeQuery(t){if(0!==t.items.length){var J=Q.getTimeOperator(this.timeInfo,t.query.timeExtent,this.featureAdapter);null!=J&&(t.items=t.items.filter(J))}}_executeAttributesQuery(t){if(0!==t.items.length){var J=q.getWhereClause(t.query.where,this.fieldsIndex);if(J){if(!J.isStandardized)throw new TypeError("Where clause is not standardized");
t.items=t.items.filter(U=>J.testFeature(U,this.featureAdapter))}}}async _runSpatialFilter(t,J,U){if(!J)return t;if(null==this._frameTask)return t.filter(na=>J(na));let Y=0;const da=[],ia=async na=>{for(;Y<t.length;){const oa=t[Y++];J(oa)&&(da.push(oa),na.madeProgress());na.done&&await this._reschedule(pa=>ia(pa),U)}};return this._reschedule(na=>ia(na),U).then(()=>da)}_filterLatest(t){const {trackIdField:J,startTimeField:U,endTimeField:Y}=this.timeInfo,da=Y||U,ia=new Map,na=this.featureAdapter.getAttribute;
for(const oa of t.items){const pa=na(oa,J),sa=na(oa,da),wa=ia.get(pa);(!wa||sa>na(wa,da))&&ia.set(pa,oa)}t.items=Array.from(ia.values())}_getCacheKey(t){const {geometry:J,spatialRel:U,returnGeometry:Y,returnCentroid:da,outSR:ia,resultType:na,cacheHint:oa}=t;if("tile"!==na&&!oa)return null;t=Y||da;return A.isValid(ia)&&!A.equals(this.spatialReference,ia)&&t?JSON.stringify([J,U,ia]):JSON.stringify([J,U])}_canExecuteSinglePass(t,J){({spatialRel:J}=J);return N.canQueryWithRBush(t)&&("esriSpatialRelEnvelopeIntersects"===
J||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===J||"esriSpatialRelContains"===J))}async _project(t,J){if(!J||A.equals(this.spatialReference,J))return t;const U=this.featureAdapter;let Y=void 0;try{const da=await this._getFullExtent();Y=f.getTransformation(this.spatialReference,J,da)}catch{}J=await l.projectMany(t.items.map(da=>c.getGeometry(this.geometryType,this.hasZ,this.hasM,U.getGeometry(da))),this.spatialReference,J,Y);t.items=J.map((da,ia)=>U.cloneWithGeometry(t.items[ia],
F.convertFromGeometry(da,this.hasZ,this.hasM)));return t}async _searchFeatures(t){const J=new Set;await Promise.all(t.map(U=>this.featureStore.forEachInBounds(U,Y=>J.add(Y))));t=Array.from(J.values());J.clear();return t}async _executeQueryForStatistics(t,J,U){t=r.clone(t);try{t=await this._schedule(()=>E.normalizeQuery(t,this.definitionExpression,this.spatialReference),U);t=await this._reschedule(()=>C.validateStatisticsQuery(t,J,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,
geometryType:this.geometryType,spatialReference:this.spatialReference}),U);const Y=await this._reschedule(()=>this._executeSceneFilterQuery(t,U),U),da=await this._reschedule(()=>this._executeGeometryQuery(t,Y,U),U);await this._reschedule(()=>this._executeAggregateIdsQuery(da),U);await this._reschedule(()=>this._executeObjectIdsQuery(da),U);await this._reschedule(()=>this._executeTimeQuery(da),U);await this._reschedule(()=>this._executeAttributesQuery(da),U);return da}catch(Y){if(Y!==E.queryEngineEmptyResult)throw Y;
return new I.QueryEngineResult([],t,this)}}}a.Feature=k;a.QueryEngine=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtils":function(){define("exports ../../config ../../core/Error ../../core/Logger ../Polygon ../Polyline ./normalizeUtilsCommon ./spatialReferenceUtils ./webMercatorUtils ../../rest/geometryService/cut ../../rest/geometryService/simplify".split(" "),function(a,d,n,z,r,G,b,m,f,v,x){function B(l){const H=[];let g=0,I=0;for(let E=0;E<
l.length;E++){const C=l[E];let N=null;for(let Q=0;Q<C.length;Q++)N=C[Q],H.push(N),0===Q?I=g=N[0]:(g=Math.min(g,N[0]),I=Math.max(I,N[0]));N&&H.push([(g+I)/2,0])}return H}function D(l,H){if(!(l instanceof G||l instanceof r))throw c().error("straightLineDensify: the input geometry is neither polyline nor polygon"),new n("straightLineDensify: the input geometry is neither polyline nor polygon");var g=b.getGeometryParts(l);const I=[];for(const C of g){g=[];I.push(g);g.push([C[0][0],C[0][1]]);for(let N=
0;N<C.length-1;N++){const Q=C[N][0],T=C[N][1],y=C[N+1][0],R=C[N+1][1];var E=Math.sqrt((y-Q)*(y-Q)+(R-T)*(R-T));const k=(R-T)/E,h=(y-Q)/E,t=E/H;if(1<t){for(let J=1;J<=t-1;J++){const U=J*H;g.push([h*U+Q,k*U+T])}E=(E+Math.floor(t-1)*H)/2;g.push([h*E+Q,k*E+T])}g.push([y,R])}}return"polygon"===l.type?new r({rings:I,spatialReference:l.spatialReference}):new G({paths:I,spatialReference:l.spatialReference})}function p(l,H,g){H&&(l=D(l,1E6),l=f.webMercatorToGeographic(l,!0));g&&(l=b.updatePolyGeometry(l,g));
return l}function A(l,H,g){if(Array.isArray(l)){var I=l[0];I>H?(g=b.offsetMagnitude(I,H),l[0]=I+-2*g*H):I<g&&(H=b.offsetMagnitude(I,g),l[0]=I+-2*H*g)}else I=l.x,I>H?(g=b.offsetMagnitude(I,H),l=l.clone().offset(-2*g*H,0)):I<g&&(H=b.offsetMagnitude(I,g),l=l.clone().offset(-2*H*g,0));return l}function F(l,H){let g=-1;for(let I=0;I<H.cutIndexes.length;I++){const E=H.cutIndexes[I],C=H.geometries[I],N=b.getGeometryParts(C);for(let Q=0;Q<N.length;Q++){const T=N[Q];T.some(y=>{if(180>y[0])return!0;y=0;for(var R=
0;R<T.length;R++){var k=T[R][0];y=k>y?k:y}y=Number(y.toFixed(9));y=-360*b.offsetMagnitude(y,180);for(R=0;R<T.length;R++)k=C.getPoint(Q,R),C.setPoint(Q,R,k.clone().offset(y,0));return!0})}if(E===g)if("polygon"===l[0].type)for(const Q of b.getGeometryParts(C))l[E]=l[E].addRing(Q);else{if("polyline"===l[0].type)for(const Q of b.getGeometryParts(C))l[E]=l[E].addPath(Q)}else g=E,l[E]=C}return l}async function q(l,H,g){if(!Array.isArray(l))return q([l],H);H&&"string"!==typeof H&&c().warn("normalizeCentralMeridian()",
"The url object is deprecated, use the url string instead");var I="string"===typeof H?H:H?.url??d.geometryServiceUrl;let E,C,N;let Q=0;var T=[];H=[];for(var y of l)if(null==y)H.push(y);else{if(!R){var R=y.spatialReference;var k=m.getInfo(R);var h=(E=R.isWebMercator)?102100:4326;C=b.cutParams[h].maxX;N=b.cutParams[h].minX;var t=b.cutParams[h].plus180Line;h=b.cutParams[h].minus180Line}if(k)if("mesh"===y.type)H.push(y);else if("point"===y.type)H.push(A(y.clone(),C,N));else if("multipoint"===y.type){var J=
y.clone();J.points=J.points.map(U=>A(U,C,N));H.push(J)}else if("extent"===y.type)J=y.clone()._normalize(!1,!1,k),H.push(J.rings?new r(J):J);else if(y.extent){J=y.extent;const U=2*b.offsetMagnitude(J.xmin,N)*C;let Y=0===U?y.clone():b.updatePolyGeometry(y.clone(),U);J.offset(U,0);let {xmin:da,xmax:ia}=J;da=Number(da.toFixed(9));ia=Number(ia.toFixed(9));J.intersects(t)&&ia!==C?(Q=ia>Q?ia:Q,Y=p(Y,E),T.push(Y),H.push("cut")):J.intersects(h)&&da!==N?(Q=2*ia*C>Q?2*ia*C:Q,Y=p(Y,E,360),T.push(Y),H.push("cut")):
H.push(Y)}else H.push(y.clone());else H.push(y)}R=b.offsetMagnitude(Q,C);k=-90;t=R;for(y=new G;0<R;)h=-180+360*R,y.addPath([[h,k],[h,-1*k]]),k*=-1,R--;if(0<T.length&&0<t){R=await v.cut(I,T,y,g);R=F(T,R);k=[];T=[];for(t=0;t<H.length;t++)y=H[t],"cut"!==y?T.push(y):(y=R.shift(),h=l[t],null!=h&&"polygon"===h.type&&h.rings&&1<h.rings.length&&y.rings.length>=h.rings.length?(k.push(y),T.push("simplify")):T.push(E?f.geographicToWebMercator(y):y));if(!k.length)return T;H=await x.simplify(I,k,g);l=[];for(g=
0;g<T.length;g++)I=T[g],"simplify"!==I?l.push(I):l.push(E?f.geographicToWebMercator(H.shift()):H.shift());return l}l=[];for(g=0;g<H.length;g++)I=H[g],"cut"!==I?l.push(I):(I=T.shift(),l.push(!0===E?f.geographicToWebMercator(I):I));return l}const c=()=>z.getLogger("esri.geometry.support.normalizeUtils");a.getClosestDenormalizedXToReference=function(l,H,g){g=m.getInfo(g);if(null==g)return l;const [I,E]=g.valid;g=2*E;let C=0,N=0;H>E?C=Math.ceil(Math.abs(H-E)/g):H<I&&(C=-Math.ceil(Math.abs(H-I)/g));l>
E?N=Math.ceil(Math.abs(l-E)/g):l<I&&(N=-Math.ceil(Math.abs(l-I)/g));l+=(C-N)*g;H=l-H;H>E?l-=g:H<I&&(l+=g);return l};a.getDenormalizedExtent=function(l){if(!l)return null;const H=l.extent;if(!H)return null;var g=l.spatialReference&&m.getInfo(l.spatialReference);if(!g)return H;const [I,E]=g.valid;({width:g}=H);let {xmin:C,xmax:N}=H;[C,N]=[N,C];if("extent"===l.type||0===g||g<=E||g>2*E||C<I||N>E)return H;let Q;switch(l.type){case "polygon":if(1<l.rings.length)Q=B(l.rings);else return H;break;case "polyline":if(1<
l.paths.length)Q=B(l.paths);else return H;break;case "multipoint":Q=l.points}l=H.clone();for(let T=0;T<Q.length;T++){let y=Q[T][0];0>y?(y+=E,N=Math.max(y,N)):(y-=E,C=Math.min(y,C))}l.xmin=C;l.xmax=N;return l.width<g?(l.xmin-=E,l.xmax-=E,l):H};a.normalizeCentralMeridian=q;a.normalizeMapX=function(l,H){if(H=m.getInfo(H)){const [g,I]=H.valid;H=I-g;if(l<g)for(;l<g;)l+=H;if(l>I)for(;l>I;)l-=H}return l};a.straightLineDensify=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsCommon":function(){define(["exports",
"../Polyline","../SpatialReference","./jsonUtils"],function(a,d,n,z){function r(G){return z.isPolygon(G)?G.rings:G.paths}d={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:new d({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:n.WebMercator}),minus180Line:new d({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:n.WebMercator})},4326:{maxX:180,
minX:-180,plus180Line:new d({paths:[[[180,-180],[180,180]]],spatialReference:n.WGS84}),minus180Line:new d({paths:[[[-180,-180],[-180,180]]],spatialReference:n.WGS84})}};a.cutParams=d;a.getGeometryParts=r;a.offsetMagnitude=function(G,b){return Math.ceil((G-b)/(2*b))};a.updatePolyGeometry=function(G,b){const m=r(G);for(const f of m)for(const v of f)v[0]+=b;return G};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/cut":function(){define("exports ../../geometry ../../request ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ../utils".split(" "),
function(a,d,n,z,r,G){a.cut=async function(b,m,f,v){b=G.parseUrl(b);const x=m[0].spatialReference;m={...v,responseType:"json",query:{...b.query,f:"json",sr:r.srToRESTValue(x),target:JSON.stringify({geometryType:z.getJsonType(m[0]),geometries:m}),cutter:JSON.stringify(f)}};m=await n(b.path+"/cut",m);const {cutIndexes:B,geometries:D=[]}=m.data;return{cutIndexes:B,geometries:D.map(p=>{p=z.fromJSON(p);p.spatialReference=x;return p})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/utils":function(){define("exports ../config ../kernel ../core/lang ../core/urlUtils ../support/apiKeyUtils".split(" "),
function(a,d,n,z,r,G){function b(m,f,v){const x={};for(const D in m)if("declaredClass"!==D){var B=m[D];null!=B&&"function"!==typeof B&&(Array.isArray(B)?x[D]=B.map(p=>b(p)):"object"===typeof B?B.toJSON?(B=B.toJSON(v?.[D]),x[D]=f?B:JSON.stringify(B)):x[D]=f?B:JSON.stringify(B):x[D]=B)}return x}a.asValidOptions=function(m,f){return f?{...f,query:{...(m??{}),...f.query}}:{query:m}};a.encode=b;a.getToken=function(m,f){return m?G.isApiKeyApplicable(m,f)?f||d.apiKey:n.id?.findCredential(m)?.token:null};
a.parseUrl=function(m){return"string"===typeof m?r.urlToObject(m):z.clone(m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/simplify":function(){define("exports ../../request ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils ./utils".split(" "),function(a,d,n,z,r,G){a.simplify=async function(b,m,f){const v="string"===typeof b?n.urlToObject(b):b;b=m[0].spatialReference;const x=z.getJsonType(m[0]);m={...f,query:{...v.query,
f:"json",sr:r.srToRESTValue(b),geometries:JSON.stringify(G.encodeGeometries(m))}};({data:m}=await d(v.path+"/simplify",m));return G.decodeGeometries(m.geometries,x,b)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/utils":function(){define(["exports","../../geometry/support/jsonUtils"],function(a,d){a.decodeGeometries=function(n,z,r){const G=d.getGeometryType(z);return n.map(b=>{b=G.fromJSON(b);b.spatialReference=r;return b})};a.encodeGeometries=function(n){return{geometryType:d.getJsonType(n[0]),
geometries:n.map(z=>z.toJSON())}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/attributeSupport":function(){define(["exports","../../../core/Error","../../../core/sql/WhereClauseCache","../../support/fieldType"],function(a,d,n,z){function r(p,A,F={}){const q=G(A,p);if(!q)throw F=x.getError(A,p),new d("unsupported-query","invalid SQL expression",{expression:A,error:F});p=F.expressionName||"expression";if(F.validateStandardized&&!q.isStandardized)throw new d("unsupported-query",
`${p} is not standard`,{expression:A});if(F.validateAggregate&&!q.isAggregate)throw new d("unsupported-query",`${p} does not contain a valid aggregate function`,{expression:A});return q.fieldNames}function G(p,A){return p?x.get(p,A):null}function b(p){return/\((.*?)\)/.test(p)?p:p.split(" as ")[0]}function m(p,A,F,q={}){const c=new Map;f(c,p,A,q.allowedFieldTypes??D,F);if(c.size)throw new d("unsupported-query",`${q.expressionName??"expression"} contains invalid or missing fields`,{errors:Array.from(c.values()),
query:q.query});}function f(p,A,F,q,c){c=c.includes("*")?[...F,...c.filter(l=>"*"!==l)]:c;for(const l of c)if(A.get(l))v(p,A,F,q,l);else try{const H=b(l),g=r(A,H,{validateStandardized:!0});for(const I of g)v(p,A,F,q,I)}catch(H){p.set(l,{type:"expression-error",expression:l,error:H})}}function v(p,A,F,q,c){(A=A.get(c))?F.has(A.name)?"all"!==q&&!1===q?.has(A.type)&&p.set(c,{type:"invalid-type",fieldName:A.name,fieldType:z.kebabDict.fromJSON(A.type),allowedFieldTypes:Array.from(q,l=>z.kebabDict.fromJSON(l))}):
p.set(c,{type:"missing-field",fieldName:A.name}):p.set(c,{type:"invalid-field",fieldName:c})}const x=new n.WhereClauseCache(50,500);n=new Set("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeBigInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong".split(" "));const B=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),D=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...n,
...B]);a.allDateAndTimeFieldTypes=B;a.getAliasFromFieldName=function(p){return p.split(" as ")[1]};a.getExpressionFromFieldName=b;a.getWhereClause=G;a.numericFieldTypes=n;a.validateFields=m;a.validateHaving=function(p,A,F,q,c){if(!F)return!0;const l=r(p,F,{validateAggregate:!0,expressionName:"having clause"});m(p,A,l,{expressionName:"having clause",query:c});if(!G(F,p)?.getExpressions().every(H=>{const {aggregateType:g,field:I}=H,E=p.get(I)?.name;return q.some(C=>{const {onStatisticField:N,statisticType:Q}=
C;return p.get(N)?.name===E&&Q.toLowerCase().trim()===g})}))throw new d("unsupported-query","expressions in having clause should also exist in outStatistics",{having:F});return!0};a.validateWhere=function(p,A,F,q){if(!F)return!0;F=r(p,F,{validateStandardized:!0,expressionName:"where clause"});m(p,A,F,{expressionName:"where clause",query:q});return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClauseCache":function(){define(["exports","../LRUCache","./WhereClause"],
function(a,d,n){class z{constructor(r,G){this._cache=new d.LRUCache(r);this._invalidCache=new d.LRUCache(G)}get(r,G){const b=`${G.uid}:${r}`,m=this._cache.get(b);if(m)return m;if(null!=this._invalidCache.get(b))return null;try{const f=n.WhereClause.create(r,{fieldsIndex:G});this._cache.put(b,f);return f}catch(f){return this._invalidCache.put(b,f),null}}getError(r,G){return this._invalidCache.get(`${G.uid}:${r}`)??null}}a.WhereClauseCache=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/core/LRUCache":function(){define(["exports","./MemCache"],function(a,d){class n{constructor(z,r){this._storage=new d.MemCacheStorage;this.name=this.id="";this.size=0;this._storage.maxSize=z;this._storage.register(this);r&&this._storage.registerRemoveFunc("",r)}destroy(){this._storage.deregister(this);this._storage.destroy()}put(z,r,G=1){this._storage.put(this,z,r,G,1)}pop(z){return this._storage.pop(this,z)}get(z){return this._storage.get(this,z)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(z){this._storage.maxSize=
z}resetHitRate(){}}a.LRUCache=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/MemCache":function(){define(["exports","./PooledArray"],function(a,d){a.RemoveMode=void 0;(function(b){b[b.ALL=0]="ALL";b[b.SOME=1]="SOME"})(a.RemoveMode||(a.RemoveMode={}));class n{constructor(b,m,f){this.name=b;this._storage=m;this.id=`${r++}:`;this.size=0;this.maxSize=-1;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);f&&(this._storage.registerRemoveFunc(this.id,f),
this._removeFunc=!0)}destroy(){this._storage.clear(this);this._removeFunc&&this._storage.deregisterRemoveFunc(this.id);this._storage.deregister(this);this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(b){return this._storage.getSize(this,b)}resetHitRate(){this._hit=this._miss=0}put(b,m,f,v=0){this._storage.put(this,b,m,f,v)}pop(b){b=this._storage.pop(this,b);void 0===b?++this._miss:++this._hit;return b}get(b){b=this._storage.get(this,
b);void 0===b?++this._miss:++this._hit;return b}peek(b){return this._storage.peek(this,b)}updateSize(b,m,f){this._storage.updateSize(this,b,m,f)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class z{get size(){return this._size}constructor(b=10485760){this._maxSize=b;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=new d;this._users=new d}destroy(){this.clearAll();
this._removeFuncs.clear();this._users.clear();this._db=null}register(b){this._users.push(b)}deregister(b){this._users.removeUnordered(b)}registerRemoveFunc(b,m){this._removeFuncs.push([b,m])}deregisterRemoveFunc(b){this._removeFuncs.filterInPlace(m=>m[0]!==b)}get maxSize(){return this._maxSize}set maxSize(b){this._maxSize=Math.max(b,-1);this._checkSize()}getSize(b,m){return this._db.get(b.id+m)?.size??0}put(b,m,f,v,x){m=b.id+m;const B=this._db.get(m);B&&(this._size-=B.size,b.size-=B.size,this._db.delete(m),
B.entry!==f&&this._notifyRemove(m,B.entry,B.size,a.RemoveMode.ALL));v>this._maxSize?this._notifyRemove(m,f,v,a.RemoveMode.ALL):void 0===f?console.warn("Refusing to cache undefined entry "):!v||0>v?(console.warn(`Refusing to cache entry with size ${v} for key ${m}`),this._notifyRemove(m,f,0,a.RemoveMode.ALL)):(this._db.set(m,new G(f,v,1+Math.max(x,-4)- -3)),this._size+=v,b.size+=v,this._checkSize())}updateSize(b,m,f,v){m=b.id+m;const x=this._db.get(m);if(x&&x.entry===f){this._size-=x.size;for(b.size-=
x.size;v>this._maxSize;)if(v=this._notifyRemove(m,f,v,a.RemoveMode.SOME),!(null!=v&&0<v)){this._db.delete(m);return}x.size=v;this._size+=v;b.size+=v;this._checkSize()}}pop(b,m){m=b.id+m;const f=this._db.get(m);if(f)return this._size-=f.size,b.size-=f.size,this._db.delete(m),++this._hit,f.entry;++this._miss}get(b,m){m=b.id+m;b=this._db.get(m);if(void 0===b)++this._miss;else return this._db.delete(m),b.lives=b.lifetime,this._db.set(m,b),++this._hit,b.entry}peek(b,m){(b=this._db.get(b.id+m))?++this._hit:
++this._miss;return b?.entry}get performanceInfo(){const b={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},m={},f=[];this._db.forEach((B,D)=>{const p=B.lifetime;f[p]=(f[p]||0)+B.size;this._users.forAll(A=>{const {id:F,name:q}=A;D.startsWith(F)&&(m[q]=(m[q]||0)+B.size)})});const v={};this._users.forAll(B=>{const D=B.name;"hitRate"in B&&"number"===typeof B.hitRate&&!isNaN(B.hitRate)&&
0<B.hitRate?(m[D]=m[D]||0,v[D]=Math.round(100*B.hitRate)+"%"):v[D]="0%"});var x=Object.keys(m);x.sort((B,D)=>m[D]-m[B]);x.forEach(B=>b[B]=Math.round(m[B]/2**20)+"MB / "+v[B]);for(x=f.length-1;0<=x;--x){const B=f[x];B&&(b["Priority "+(x+-3-1)]=Math.round(B/this._size*100)+"%")}return b}resetStats(){this._hit=this._miss=0;this._users.forAll(b=>b.resetHitRate())}clear(b){const m=b.id;this._db.forEach((f,v)=>{v.startsWith(m)&&(this._size-=f.size,this._db.delete(v),this._notifyRemove(v,f.entry,f.size,
a.RemoveMode.ALL))});b.size=0}clearAll(){this._db.forEach((b,m)=>this._notifyRemove(m,b.entry,b.size,a.RemoveMode.ALL));this._users.forAll(b=>b.size=0);this._size=0;this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(b,m,f,v){let x;this._removeFuncs.some(B=>b.startsWith(B[0])?(B=B[1](m,v,f),"number"===typeof B&&(x=B),!0):!1);return x}_checkSize(){this._users.forAll(b=>this._checkSizeLimits(b));this._checkSizeLimits()}_checkSizeLimits(b){const m=b??this;if(!(0>m.maxSize||
m.size<=m.maxSize)){for(var f=b?.id,v=!0;v;){v=!1;for(const [x,B]of this._db)if(0===B.lifetime&&(!f||x.startsWith(f))){this._purgeItem(x,B,b);if(m.size<=.9*m.maxSize)return;v||=this._db.has(x)}}for(const [x,B]of this._db)if(!f||x.startsWith(f))if(this._purgeItem(x,B,b),m.size<=.9*m.maxSize)break}}_purgeItem(b,m,f=this._users.find(v=>b.startsWith(v.id))){this._db.delete(b);if(1>=m.lives){this._size-=m.size;f&&(f.size-=m.size);const v=this._notifyRemove(b,m.entry,m.size,a.RemoveMode.SOME);null!=v&&
0<v&&(this._size+=v,f&&(f.size+=v),m.lives=m.lifetime,m.size=v,this._db.set(b,m))}else--m.lives,this._db.set(b,m)}}let r=0;class G{constructor(b,m,f){this.entry=b;this.size=m;this.lives=this.lifetime=f}}a.MemCache=n;a.MemCacheStorage=z;a.MinPriority=-3;a.NoPriority=-4;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereClause":function(){define("exports ../../arcade/ArcadeDate ../has ./AggregateFunctions ./DateOnly ./errorSupport ./sqlArithmeticUtils ./sqlCompareUtils ./sqlDateParsingUtils ./SqlInterval ./SqlTimestampOffset ./StandardizedFunctions ./TimeOnly ./WhereGrammar ../../chunks/datetime".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A){function F(y){return Array.isArray(y)?y:[y]}function q(y){return null!==y?!0!==y:null}function c(y,R){return null!=y&&null!=R?!0===y&&!0===R:!1===y||!1===R?!1:null}function l(y,R){return null!=y&&null!=R?!0===y||!0===R:!0===y||!0===R?!0:null}function H(y,R,k){if(null==y)return null;k=!1;for(const h of R)if(null==h)k=null;else if(y===h){k=!0;break}else if(m.isDateOrTimeValue(y)&&m.isDateOrTimeValue(h)&&(k=m.sqlCompare(y,h,"\x3d")))break;return k}function g(y,
R,k){if(null==y)return null;let h="",t=Q.Normal;for(let J=0;J<R.length;J++){const U=R.charAt(J);switch(t){case Q.Normal:U===k?t=Q.Escaped:h="-[]/{}()*+?.\\^$|".includes(U)?h+("\\"+U):"%"===U?h+".*":"_"===U?h+".":h+U;break;case Q.Escaped:h="-[]/{}()*+?.\\^$|".includes(U)?h+("\\"+U):h+U,t=Q.Normal}}return(new RegExp("^"+h+"$","m")).test(y)}function I(y,R,k,h){y=h.getAttribute(y,R);R=k?.get(R);return null==y||"esriFieldTypeDate"!==R?.type&&"date"!==R?.type?null==y||"esriFieldTypeDateOnly"!==R?.type&&
"date-only"!==R?.type?null==y||"esriFieldTypeTimeOnly"!==R?.type&&"time-only"!==R?.type?null==y||"esriFieldTypeTimestampOffset"!==R?.type&&"timestamp-offset"!==R?.type?y:new x.SqlTimeStampOffset(y):D.TimeOnly.fromReader(y):r.DateOnly.fromReader(y):f.convertToExecutingTimeZone(new Date(y),k?.getLuxonTimeZone(R.name)??A.FixedOffsetZone.utcInstance)}const E=new Set(["current_timestamp","current_date","current_time"]);class C{static makeBool(y){return!0===y}static featureValue(y,R,k,h){return I(y,R,k,
h)}static equalsNull(y){return null===y}static applyLike(y,R,k){return g(y,R,k)}static ensureArray(y){return F(y)}static applyIn(y,R,k){return H(y,R)}static currentTimestamp(y){return f.convertToExecutingTimeZone(new Date,y)}static currentDate(y){return r.DateOnly.fromNow(y)}static currentTime(y){y=f.convertToExecutingTimeZone(new Date,y);return D.TimeOnly.fromDateTime(y)}static makeSqlInterval(y,R,k){return v.SqlInterval.createFromValueAndQualifier(y,R,k)}static convertInterval(y){return y instanceof
v.SqlInterval?y.valueInMilliseconds():y}static compare(y,R,k,h){return m.sqlCompare(R,k,y)}static calculate(y,R,k,h){return b.sqlCalculateFunction(y,R,k,h)}static evaluateTime(y){return f.parseTime(y)}static evaluateTimestamp(y,R,k){return f.parseTimestamp(y,R,k)}static evaluateDate(y,R){return f.parseDate(y,R)}static evaluateFunction(y,R,k){return B.evaluateFunction(y,R,k)}static lookup(y,R){y=R[y];return void 0===y?null:y}static between(y,R,k){return null==y||null==R[0]||null==R[1]?null:m.sqlCompare(y,
R[0],"\x3e\x3d")&&m.sqlCompare(y,R[1],"\x3c\x3d")}static notbetween(y,R,k){return null==y||null==R[0]||null==R[1]?null:m.sqlCompare(y,R[0],"\x3c")||m.sqlCompare(y,R[1],"\x3e")}static ternaryNot(y){return q(y)}static ternaryAnd(y,R){return c(y,R)}static ternaryOr(y,R){return l(y,R)}}class N{constructor(y,R,k="UTC",h=null){this.fieldsIndex=R;this.timeZone=k;this.currentUser=h;this.parameters={};this._hasDateFunctions=void 0;this.parseTree=p.WhereGrammar.parse(y);const {isStandardized:t,isAggregate:J,
currentUserRequired:U,referencedFieldNames:Y}=this._extractExpressionInfo(R);this._referencedFieldNames=Y;this.isStandardized=t;this.isAggregate=J;this.currentUserRequired=U}static convertValueToStorageFormat(y,R=null){if(null===R)return f.isDate(y)?y.getTime():f.isDateTime(y)?y.toMillis():f.isTimestampOffset(y)?y.toStorageFormat():f.isTimeOnly(y)?y.toStorageString():f.isDateOnly(y)?y.toStorageFormat():y;switch(R){case "date":if(f.isDate(y))return y.getTime();if(f.isDateTime(y))return y.toMillis();
if(f.isTimestampOffset(y))return y.toMilliseconds();if(f.isDateOnly(y))return y.toNumber();break;case "date-only":if(f.isDate(y))return r.DateOnly.fromDateJS(y).toString();if(f.isTimestampOffset(y))return r.DateOnly.fromSqlTimeStampOffset(y).toString();if(f.isDateTime(y))return r.DateOnly.fromDateTime(y).toString();break;case "time-only":if(f.isDate(y))return D.TimeOnly.fromDateJS(y).toStorageString();if(f.isDateTime(y))return D.TimeOnly.fromDateTime(y).toStorageString();if(f.isTimestampOffset(y))return D.TimeOnly.fromSqlTimeStampOffset(y).toStorageString();
if(f.isTimeOnly(y))return y.toStorageString();break;case "timestamp-offset":if(f.isDate(y))return x.SqlTimeStampOffset.fromJSDate(y).toStorageFormat();if(f.isDateTime(y))return x.SqlTimeStampOffset.fromDateTime(y).toStorageFormat();if(f.isTimestampOffset(y))return y.toStorageFormat()}return y}static create(y,R={}){return new N(y,R.fieldsIndex,R.timeZone??void 0,R.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(y,R=T,k=this.currentUser){return!!this._evaluateNode(this.parseTree,
null,R,y,k)}calculateValue(y,R=T,k=this.currentUser){y=this._evaluateNode(this.parseTree,y,R,null,k);return y instanceof v.SqlInterval?y.valueInMilliseconds()/864E5:y}calculateValueCompiled(y,R=T,k=this.currentUser){if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(y,this.parameters,R,this.fieldsIndex,this.timeZone,k??null);if(n("esri-csp-restrictions"))return this.calculateValue(y,R);this._compileMe();return this.parseTree._compiledVersion(y,this.parameters,R,this.fieldsIndex,
this.timeZone,k??null)}testFeature(y,R=T,k=this.currentUser){return!!this._evaluateNode(this.parseTree,y,R,null,k)}testFeatureCompiled(y,R=T,k=this.currentUser){if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(y,this.parameters,R,this.fieldsIndex,this.timeZone,k??null);if(n("esri-csp-restrictions"))return this.testFeature(y,R);this._compileMe();return!!this.parseTree._compiledVersion(y,this.parameters,R,this.fieldsIndex,this.timeZone,k??null)}get hasDateFunctions(){if(null!=
this._hasDateFunctions)return this._hasDateFunctions;this._hasDateFunctions=!1;p.visitAll(this.parseTree,y=>{"current-time"===y.type?this._hasDateFunctions=!0:"function"===y.type&&(this._hasDateFunctions=this._hasDateFunctions||E.has(y.name.toLowerCase()))});return this._hasDateFunctions}getFunctions(){const y=new Set;p.visitAll(this.parseTree,R=>{"function"===R.type&&y.add(R.name.toLowerCase())});return Array.from(y)}getExpressions(){const y=new Map;p.visitAll(this.parseTree,R=>{if("function"===
R.type){const k=R.name.toLowerCase();R=R.args.value[0];if("column-reference"===R.type){R=R.column;const h=`${k}-${R}`;y.has(h)||y.set(h,{aggregateType:k,field:R})}}});return[...y.values()]}getVariables(){const y=new Set;p.visitAll(this.parseTree,R=>{"parameter"===R.type&&y.add(R.value.toLowerCase())});return Array.from(y)}_compileMe(){const y="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter",
"fieldsIndex","timeZone","currentUser",y)).bind(C)}_extractExpressionInfo(y){const R=[],k=new Set;let h=!0,t=!1,J=!1;p.visitAll(this.parseTree,U=>{switch(U.type){case "column-reference":var Y=y?.get(U.column);let da;Y?Y=da=Y.name??"":(da=U.column,Y=da.toLowerCase());k.has(Y)||(k.add(Y),R.push(da));U.column=da;break;case "current-user":J=!0;break;case "function":const {name:ia,args:na}=U;U=na.value.length;h&&=B.isStandardized(ia,U);!1===t&&(t=z.isAggregate(ia,U))}});return{referencedFieldNames:Array.from(R),
isStandardized:h,isAggregate:t,currentUserRequired:J}}evaluateNodeToJavaScript(y){switch(y.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(y.value)+", "+JSON.stringify(y.qualifier)+","+JSON.stringify(y.op)+")";case "case-expression":var R="";if("simple"===y.format){var k=this.evaluateNodeToJavaScript(y.operand);R="( ";for(let h=0;h<y.clauses.length;h++)R+=" (this.compare('\x3d',"+k+","+this.evaluateNodeToJavaScript(y.clauses[h].operand)+") ? ("+this.evaluateNodeToJavaScript(y.clauses[h].value)+
") : "}else for(R="( ",k=0;k<y.clauses.length;k++)R+=" this.makeBool("+this.evaluateNodeToJavaScript(y.clauses[k].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(y.clauses[k].value)+") : ";R=null!==y.else?R+this.evaluateNodeToJavaScript(y.else):R+"null";return R+" )";case "parameter":return"this.lookup("+JSON.stringify(y.value.toLowerCase())+",lookups)";case "expression-list":R="[";for(k of y.value)"["!==R&&(R+=","),R+=this.evaluateNodeToJavaScript(k);return R+"]";case "unary-expression":return"this.ternaryNot("+
this.evaluateNodeToJavaScript(y.expr)+")";case "binary-expression":switch(y.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+" )";case "IS":if("null"!==y.right.type)throw new G.SqlError(G.SqlErrorCodes.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(y.left)+")";case "ISNOT":if("null"!==
y.right.type)throw new G.SqlError(G.SqlErrorCodes.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(y.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(y.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(y.right)+"), timeZone)";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(y.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(y.right)+"), timeZone))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(y.left)+
","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+","+JSON.stringify(y.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+","+JSON.stringify(y.escape)+
"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(y.operator)+","+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";case "*":case "-":case "+":case "/":case "||":return"this.calculate("+JSON.stringify(y.operator)+","+this.evaluateNodeToJavaScript(y.left)+","+this.evaluateNodeToJavaScript(y.right)+", timeZone)";default:throw new G.SqlError(G.SqlErrorCodes.UnsupportedOperator,{operator:y.operator});
}case "null":case "boolean":case "string":case "number":return JSON.stringify(y.value);case "time":return"this.evaluateTime("+JSON.stringify(y.value)+")";case "date":return"this.evaluateDate("+JSON.stringify(y.value)+", 'unknown')";case "timestamp":return"this.evaluateTimestamp("+JSON.stringify(y.value)+", 'unknown')";case "current-time":return"date"===y.mode?"this.currentDate(timeZone)":"time"===y.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case "current-user":return"currentUser";
case "column-reference":return"this.featureValue(feature,"+JSON.stringify(y.column)+",fieldsIndex,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(y.name)+","+this.evaluateNodeToJavaScript(y.args)+", timeZone)"}throw new G.SqlError(G.SqlErrorCodes.UnsupportedSyntax,{node:y.type});}_evaluateNode(y,R,k,h,t){switch(y.type){case "interval":return k=this._evaluateNode(y.value,R,k,h,t),v.SqlInterval.createFromValueAndQualifier(k,y.qualifier,y.op);case "case-expression":if("simple"===
y.format){var J=this._evaluateNode(y.operand,R,k,h,t);for(var U=0;U<y.clauses.length;U++)if(m.sqlCompare(J,this._evaluateNode(y.clauses[U].operand,R,k,h,t),"\x3d",this.timeZone))return this._evaluateNode(y.clauses[U].value,R,k,h,t)}else for(J=0;J<y.clauses.length;J++)if(!0===this._evaluateNode(y.clauses[J].operand,R,k,h,t))return this._evaluateNode(y.clauses[J].value,R,k,h,t);return null!==y.else?this._evaluateNode(y.else,R,k,h,t):null;case "parameter":return y=this.parameters[y.value.toLowerCase()],
f.isDate(y)?A.DateTime.fromJSDate(y):y instanceof d.ArcadeDate?y.toDateTime():y;case "expression-list":J=[];for(var Y of y.value)J.push(this._evaluateNode(Y,R,k,h,t));return J;case "unary-expression":return q(this._evaluateNode(y.expr,R,k,h,t));case "binary-expression":switch(y.operator){case "AND":return c(this._evaluateNode(y.left,R,k,h,t),this._evaluateNode(y.right,R,k,h,t));case "OR":return l(this._evaluateNode(y.left,R,k,h,t),this._evaluateNode(y.right,R,k,h,t));case "IS":if("null"!==y.right.type)throw new G.SqlError(G.SqlErrorCodes.UnsupportedIsRhs);
return null===this._evaluateNode(y.left,R,k,h,t);case "ISNOT":if("null"!==y.right.type)throw new G.SqlError(G.SqlErrorCodes.UnsupportedIsRhs);return null!==this._evaluateNode(y.left,R,k,h,t);case "IN":return J=F(this._evaluateNode(y.right,R,k,h,t)),H(this._evaluateNode(y.left,R,k,h,t),J,this.timeZone);case "NOT IN":return J=F(this._evaluateNode(y.right,R,k,h,t)),q(H(this._evaluateNode(y.left,R,k,h,t),J,this.timeZone));case "BETWEEN":return J=this._evaluateNode(y.left,R,k,h,t),y=this._evaluateNode(y.right,
R,k,h,t),null==J||null==y[0]||null==y[1]?null:m.sqlCompare(J,y[0],"\x3e\x3d",this.timeZone)&&m.sqlCompare(J,y[1],"\x3c\x3d",this.timeZone);case "NOTBETWEEN":return J=this._evaluateNode(y.left,R,k,h,t),y=this._evaluateNode(y.right,R,k,h,t),null==J||null==y[0]||null==y[1]?null:m.sqlCompare(J,y[0],"\x3c",this.timeZone)||m.sqlCompare(J,y[1],"\x3e",this.timeZone);case "LIKE":return g(this._evaluateNode(y.left,R,k,h,t),this._evaluateNode(y.right,R,k,h,t),y.escape);case "NOT LIKE":return q(g(this._evaluateNode(y.left,
R,k,h,t),this._evaluateNode(y.right,R,k,h,t),y.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return m.sqlCompare(this._evaluateNode(y.left,R,k,h,t),this._evaluateNode(y.right,R,k,h,t),y.operator,this.timeZone);case "-":case "+":case "*":case "/":case "||":return b.sqlCalculateFunction(y.operator,this._evaluateNode(y.left,R,k,h,t),this._evaluateNode(y.right,R,k,h,t),this.timeZone)}case "null":case "boolean":case "string":case "number":return y.value;case "date":return y.parsedValue??
(y.parsedValue=f.parseDate(y.value,"unknown")),y.parsedValue;case "timestamp":return y.parsedValue??(y.parsedValue=f.parseTimestamp(y.value,"unknown")),y.parsedValue;case "time":return f.parseTime(y.value);case "current-time":return"date"===y.mode?C.currentDate(this.timeZone):"time"===y.mode?C.currentTime(this.timeZone):C.currentTimestamp(this.timeZone);case "current-user":return t??null;case "column-reference":return I(R,y.column,this.fieldsIndex,k);case "data-type":return y.value;case "function":if(this.isAggregate&&
z.isAggregate(y.name,y.args.value.length)){R=[];for(J of y.args?.value||[]){Y=[];for(U of h||[])Y.push(this._evaluateNode(J,U,k,null,t));R.push(Y)}return z.aggregateFunction(y.name,R)}k=this._evaluateNode(y.args,R,k,h,t);return B.evaluateFunction(y.name,k,this.timeZone)}throw new G.SqlError(G.SqlErrorCodes.UnsupportedSyntax,{node:y.type});}}var Q;(function(y){y[y.Normal=0]="Normal";y[y.Escaped=1]="Escaped"})(Q||={});const T={getAttribute(y,R){return(y&&"object"===typeof y.attributes?y.attributes:
y)[R]}};a.WhereClause=N;a.defaultAttributeAdapter=T;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/ArcadeDate":function(){define(["exports","../core/string","../core/sql/UnknownTimeZone","../chunks/datetime"],function(a,d,n,z){function r(v,x,B){return v<x?v-x:v>B?v-B:0}function G(v,x=!0){if(v instanceof z.Zone)return v;if("system"===v.toLowerCase())return"system";if("utc"===v.toLowerCase())return"UTC";if("unknown"===v.toLowerCase())return n.UnknownTimeZone.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(v)){const B=
z.FixedOffsetZone.parseSpecifier("UTC"+(v.startsWith("+")||v.startsWith("-")?"":"+")+v);if(B)return B}v=z.IANAZone.create(v);if(!v.isValid){if(x)throw new m(a.ArcadeDateErrorCodes.TimeZoneNotRecognized);return null}return v}a.ArcadeDateErrorCodes=void 0;(a.ArcadeDateErrorCodes||(a.ArcadeDateErrorCodes={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const b={[a.ArcadeDateErrorCodes.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class m extends Error{constructor(v,x){super(d.replace(b[v],
x));this.declaredRootClass="esri.arcade.arcadedate.dateerror";Error.captureStackTrace&&Error.captureStackTrace(this,m)}}class f{constructor(v){this._date=v;this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(v=0,x=1,B=1,D=0,p=0,A=0,F=0,q){if(isNaN(v)||isNaN(x)||isNaN(B)||isNaN(D)||isNaN(p)||isNaN(A)||isNaN(F))return null;const c=z.DateTime.local(v,x).daysInMonth;v=z.DateTime.fromObject({day:1>B?1:B>c?c:B,year:v,month:1>x?1:12<x?12:x,hour:0>D?0:23<D?23:D,minute:0>p?0:59<p?59:p,second:0>
A?0:59<A?59:A,millisecond:0>F?0:999<F?999:F},{zone:G(q)});v=v.plus({months:r(x,1,12),days:r(B,1,c),hours:r(D,0,23),minutes:r(p,0,59),seconds:r(A,0,59),milliseconds:r(F,0,999)});return new f(v)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(v,x){x=G(x);return v.isUnknownTimeZone||x===n.UnknownTimeZone.instance?f.fromParts(v.year,v.monthJS+1,v.day,v.hour,v.minute,v.second,v.millisecond,x):new f(v._date.setZone(x))}static dateJSToArcadeDate(v){return new f(z.DateTime.fromJSDate(v,
{zone:"system"}))}static dateJSAndZoneToArcadeDate(v,x="system"){x=G(x);return new f(z.DateTime.fromJSDate(v,{zone:x}))}static unknownEpochToArcadeDate(v){return new f(z.DateTime.fromMillis(v,{zone:n.UnknownTimeZone.instance}))}static unknownDateJSToArcadeDate(v){return new f(z.DateTime.fromMillis(v.getTime(),{zone:n.UnknownTimeZone.instance}))}static epochToArcadeDate(v,x="system"){x=G(x);return new f(z.DateTime.fromMillis(v,{zone:x}))}static dateTimeToArcadeDate(v){return new f(v)}clone(){return new f(this._date)}changeTimeZone(v){v=
G(v);return f.dateTimeToArcadeDate(this._date.setZone(v))}static dateTimeAndZoneToArcadeDate(v,x){x=G(x);return v.zone===n.UnknownTimeZone.instance||x===n.UnknownTimeZone.instance?f.fromParts(v.year,v.month,v.day,v.hour,v.minute,v.second,v.millisecond,x):new f(v.setZone(x))}static nowToArcadeDate(v){v=G(v);return new f(z.DateTime.fromJSDate(new Date,{zone:v}))}static nowUTCToArcadeDate(){return new f(z.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===f.systemTimeZoneCanonicalName}equals(v){return this.isSystem&&
v.isSystem?this.toNumber()===v.toNumber():this.isUnknownTimeZone!==v.isUnknownTimeZone?!1:this._date.equals(v._date)}get isUnknownTimeZone(){return this._date.zone===n.UnknownTimeZone.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let v=this._date.weekday;6<v&&(v=0);return v}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-
1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const v=this.zone;return"fixed"===v.type?0===v.fixed?"UTC":v.formatOffset(0,"short"):v.name}stringify(){return JSON.stringify(this.toJSDate())}plus(v){return new f(this._date.plus(v))}diff(v,x="milliseconds"){return this._date.diff(v._date,
x)[x]}toISODate(){return this._date.toISODate()}toISOString(v){return v?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(v,x){return this._date.toISOTime({suppressMilliseconds:v,includeOffset:x&&!this.isUnknownTimeZone})}toFormat(v,x){this.isUnknownTimeZone&&(v=v.replaceAll("Z",""));return this._date.toFormat(v,x)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new f(this._date.toUTC())}toLocal(){return new f(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(v){if(!v)return null;
v=z.DateTime.fromISO(v,{setZone:!0});return new f(v)}}a.ArcadeDate=f;a.ArcadeDateError=m;a.arcadeDateErrorMessages=b;a.createDateTimeZone=G;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/UnknownTimeZone":function(){define(["exports","../../chunks/datetime"],function(a,d){function n(r){return r instanceof d.Zone?r===z.instance?!0:!1:"unknown"===r?.toString().toLowerCase()?!0:!1}class z{}z.instance=new d.IANAZone("Etc/UTC");a.UnknownTimeZone=z;a.adoptTimeZone=function(r,
G){return d.DateTime.fromObject({day:r.day,year:r.year,month:r.month,hour:r.hour,minute:r.minute,second:r.second,millisecond:r.millisecond},{zone:G})};a.isUnknownTimeZone=n;a.substituteUnknownTimezone=function(r){return n(r)?z.instance:r};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/AggregateFunctions":function(){define("exports ./DateOnly ./errorSupport ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(a,d,n,z,r,G){function b(x){if(null===
x)return null;let B=0,D=0;for(let p=0;p<x.length;p++){const A=x[p];if(null!==A){if("number"!==typeof A)throw new n.SqlError(n.SqlErrorCodes.InvalidValueForAggregateFunction);D++;B+=A}}return 0===D?null:B/x.length}function m(x,B){if(null===x)return null;let D=null,p=null;for(const A of x)x=A,x=A instanceof d.DateOnly?A.toNumber():A instanceof r.TimeOnly?A.toNumber():A instanceof G.DateTime?A.toMillis():A instanceof z.SqlTimeStampOffset?A.toMilliseconds():A,null===D?(D=A,p=x):"max"===B&&null!==p&&null!==
x&&p<=x?(D=A,p=x):"min"===B&&null!==p&&null!==x&&p>=x&&(D=A,p=x);return D}function f(x){if(null===x)return null;x=x.filter(p=>null!==p);if(0===x.length)return null;const B=b(x);if(null===B)return null;let D=0;for(const p of x){if("number"!==typeof p)throw new n.SqlError(n.SqlErrorCodes.InvalidValueForAggregateFunction);D+=(B-p)**2}return D/(x.length-1)}const v={min:{minParams:1,maxParams:1,evaluate:x=>m(x[0],"min")},max:{minParams:1,maxParams:1,evaluate:x=>m(x[0],"max")},avg:{minParams:1,maxParams:1,
evaluate:x=>b(x[0])},sum:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];if(null===x)x=null;else{var B=0;for(let D=0;D<x.length;D++){const p=x[D];if(null!==p){if("number"!==typeof p)throw new n.SqlError(n.SqlErrorCodes.InvalidValueForAggregateFunction);B+=p}}x=B}return x}},stddev:{minParams:1,maxParams:1,evaluate:x=>{x=x[0];null===x?x=null:(x=f(x),x=null===x?null:Math.sqrt(x));return x}},count:{minParams:1,maxParams:1,evaluate:x=>null==x[0]?null:x[0].length},var:{minParams:1,maxParams:1,evaluate:x=>
f(x[0])}};a.aggregateFunction=function(x,B){const D=v[x.toLowerCase()];if(null==D)throw new n.SqlError(n.SqlErrorCodes.FunctionNotRecognized);if(B.length<D.minParams||B.length>D.maxParams)throw new n.SqlError(n.SqlErrorCodes.InvalidParameterCount,{name:x.toUpperCase()});return D.evaluate(B)};a.isAggregate=function(x,B){x=v[x.toLowerCase()];return null!=x&&B>=x.minParams&&B<=x.maxParams};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports",
"../../arcade/ArcadeDate","../../intl/locale","../../chunks/datetime"],function(a,d,n,z){function r(b){b=b.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let m="";const f=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const v of b.match(f)||[])switch(v){case "D":m+="d";break;case "DD":m+="dd";break;case "DDD":m+="o";break;case "d":m+="c";break;case "ddd":m+=
"ccc";break;case "dddd":m+="cccc";break;case "M":m+="L";break;case "MM":m+="LL";break;case "MMM":m+="LLL";break;case "MMMM":m+="LLLL";break;case "YY":m+="yy";break;case "Y":case "YYYY":m+="yyyy";break;case "Q":m+="q";break;case "X":case "x":m+=v;break;default:m=2<=v.length&&"["===v.slice(0,1)&&"]"===v.slice(-1)?m+`'${v.slice(1,-1)}'`:m+`'${v}'`}return m}class G{constructor(b,m,f){this._year=b;this._month=m;this._day=f;this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-
1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(b){return b instanceof G&&b.day===this.day&&b.month===this.month&&b.year===this.year}clone(){return new G(this._year,this._month,this._day)}toDateTime(b){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:d.createDateTimeZone(b)})}toDateTimeLuxon(b){return z.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:d.createDateTimeZone(b)})}toString(){return`${this.year.toString().padStart(4,
"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(b=null,m=!0){if(null===b||""===b)return this.toString();m&&(b=r(b));if(!b)return"";m=this.toDateTime("unknown");return d.ArcadeDate.dateTimeToArcadeDate(m).toFormat(b,{locale:n.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const b=this.toDateTime("unknown");return d.ArcadeDate.dateTimeToArcadeDate(b)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(b,m){return G.fromDateTime(this.toUTCDateTime().plus({[b]:m}))}toUTCDateTime(){return z.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(b,m){switch(m.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(b.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(b.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
m?this.toUTCDateTime().diff(b.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(b.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(b.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(b.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(b.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(b.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(b.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(b){b=z.DateTime.fromMillis(b,{zone:z.FixedOffsetZone.utcInstance});return b.isValid?G.fromParts(b.year,b.month,b.day):null}static fromSeconds(b){b=z.DateTime.fromSeconds(b,{zone:z.FixedOffsetZone.utcInstance});return b.isValid?G.fromParts(b.year,b.month,b.day):null}static fromReader(b){if(!b)return null;b=b.split("-");return 3!==b.length?null:new G(parseInt(b[0],10),parseInt(b[1],
10),parseInt(b[2],10))}static fromParts(b,m,f){b=new G(b,m,f);return!1===b.isValid?null:b}static fromDateJS(b){return G.fromParts(b.getFullYear(),b.getMonth()+1,b.getDay())}static fromDateTime(b){return G.fromParts(b.year,b.month,b.day)}static fromSqlTimeStampOffset(b){return this.fromDateTime(b.toDateTime())}static fromString(b,m=null){if(""===b||null===b)return null;var f=[];if(m)(m=r(m))&&f.push(m);else if(null===m||""===m)return b=z.DateTime.fromISO(b,{setZone:!0}),b.isValid?G.fromParts(b.year,
b.month,b.day):null;for(const v of f)if(f=z.DateTime.fromFormat(b,m??v),f.isValid)return new G(f.year,f.month,f.day);return null}static fromNow(b="system"){b=z.DateTime.fromJSDate(new Date).setZone(d.createDateTimeZone(b));return new G(b.year,b.month,b.day)}}a.DateOnly=G;a.standardizeDateOnlyFormat=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/errorSupport":function(){define(["exports","../string"],function(a,d){a.SqlErrorCodes=void 0;(function(r){r.InvalidFunctionParameters=
"InvalidFunctionParameters";r.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction";r.UnsupportedSqlFunction="UnsupportedSqlFunction";r.UnsupportedOperator="UnsupportedOperator";r.UnsupportedSyntax="UnsupportedSyntax";r.UnsupportedIsRhs="UnsupportedIsRhs";r.UnsupportedIsLhs="UnsupportedIsLhs";r.InvalidDataType="InvalidDataType";r.CannotCastValue="CannotCastValue";r.FunctionNotRecognized="FunctionNotRecognized";r.InvalidTime="InvalidTime";r.InvalidParameterCount="InvalidParameterCount";
r.InvalidTimeStamp="InvalidTimeStamp";r.InvalidDate="InvalidDate";r.InvalidOperator="InvalidOperator";r.IllegalInterval="IllegalInterval";r.YearMonthIntervals="YearMonthIntervals";r.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers";r.MissingStatisticParameters="MissingStatisticParameters"})(a.SqlErrorCodes||(a.SqlErrorCodes={}));const n={[a.SqlErrorCodes.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[a.SqlErrorCodes.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",
[a.SqlErrorCodes.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[a.SqlErrorCodes.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[a.SqlErrorCodes.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[a.SqlErrorCodes.UnsupportedOperator]:"Unsupported operator - {operator}",[a.SqlErrorCodes.UnsupportedSyntax]:"Unsupported syntax - {node}",[a.SqlErrorCodes.UnsupportedSqlFunction]:"Sql function not found \x3d {function}",[a.SqlErrorCodes.InvalidDataType]:"Invalid sql data type",
[a.SqlErrorCodes.InvalidDate]:"Invalid date encountered",[a.SqlErrorCodes.InvalidOperator]:"Invalid operator encountered",[a.SqlErrorCodes.InvalidTime]:"Invalid time encountered",[a.SqlErrorCodes.IllegalInterval]:"Illegal interval",[a.SqlErrorCodes.FunctionNotRecognized]:"Function not recognized",[a.SqlErrorCodes.InvalidTimeStamp]:"Invalid timestamp encountered",[a.SqlErrorCodes.InvalidParameterCount]:"Invalid parameter count for call to {name}",[a.SqlErrorCodes.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",
[a.SqlErrorCodes.YearMonthIntervals]:"Year-Month Intervals not supported",[a.SqlErrorCodes.CannotCastValue]:"Cannot cast value to the required data type"};class z extends Error{constructor(r,G){super(d.replace(n[r],G));this.declaredRootClass="esri.arcade.featureset.support.sqlerror";Error.captureStackTrace&&Error.captureStackTrace(this,z)}}a.SqlError=z;a.sqlErrorMessages=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlTimestampOffset":function(){define(["exports",
"../../chunks/datetime"],function(a,d){function n(r){return Number.isNaN(r)||0===r?r:Math.trunc(r)}class z{constructor(r){this._timeStampOffset=r;this._date=null}toDateTime(){this._date??(this._date=d.DateTime.fromISO(this._timeStampOffset,{setZone:!0}));return this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return n(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return n(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return z.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(r){return new z(d.DateTime.fromJSDate(r).toISO({includeOffset:!0}))}static fromDateTime(r){return new z(r.toISO({includeOffset:!0}))}static fromParts(r,
G,b=0,m=0,f=0,v=0,x=0,B=!1,D=0,p=0){r=`${r.toString().padStart(4,"0")}-${G.toString().padStart(2,"0")}-${b.toString().padStart(2,"0")}`;G="";10>v&&(G="0");m=`${m.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}:${G+v.toString()}`;0!==x&&(m+="."+x.toString().padStart(3,"0"));x=`${B?"-":"+"}${D.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`;return new z(r+"T"+m+x)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let r=this.toDateTime().toSQL({includeOffset:!0,
includeOffsetSpace:!0});r&&=r.replace(".000","");return r}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(r){r=this.toDateTime().plus(r);return z.fromDateTime(r)}}a.SqlTimeStampOffset=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(a,d,n,z){function r(b){if(!b)return"";const m=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let f="";for(const v of b.match(m)||
[])switch(v){case "SSS":f+=v;break;case "A":case "a":f+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":f+=v;break;default:f+=`'${v}'`}return f}class G{constructor(b,m,f,v){this._hour=b;this._minute=m;this._second=f;this._millisecond=v;this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(b){return b instanceof G&&b.hour===
this.hour&&b.minute===this.minute&&b.second===this.second&&b.millisecond===this.millisecond}clone(){return new G(this.hour,this.minute,this.second,this.millisecond)}isValid(){return d.isInteger(this.hour)&&d.isInteger(this.minute)&&d.isInteger(this.second)&&d.isInteger(this.millisecond)&&0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,
"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}`}toFormat(b=null){return null===b||""===b?this.toString():(b=r(b))?z.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(b,{locale:n.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+36E5*this.hour}static fromParts(b,m,f,v){b=new G(b,m,f,v);return b.isValid()?b:null}static fromReader(b){if(!b)return null;b=b.split(":");return 3!==b.length?null:new G(parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],
10),0)}static fromMilliseconds(b){return 864E5<b||0>b?null:new G(Math.floor(b/36E5%24),Math.floor(b/6E4%60),Math.floor(b/1E3%60),Math.floor(b%1E3))}static fromDateJS(b){return new G(b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds())}static fromDateTime(b){return new G(b.hour,b.minute,b.second,b.millisecond)}static fromSqlTimeStampOffset(b){return this.fromDateTime(b.toDateTime())}static fromString(b,m=null){if(""===b||null===b)return null;const f=[];if(m)(m=r(m))&&f.push(m);else if(null===
m||""===m)f.push("HH:mm:ss"),f.push("HH:mm:ss.SSS"),f.push("hh:mm:ss a"),f.push("hh:mm:ss.SSS a"),f.push("HH:mm"),f.push("hh:mm a"),f.push("H:mm"),f.push("h:mm a"),f.push("H:mm:ss"),f.push("h:mm:ss a"),f.push("H:mm:ss.SSS"),f.push("h:mm:ss.SSS a");for(const v of f)if(m=z.DateTime.fromFormat(b,v),m.isValid)return new G(m.hour,m.minute,m.second,m.millisecond);return null}plus(b,m){switch(b){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return G.fromDateTime(this.toUTCDateTime().plus({[b]:m}))}return null}toUTCDateTime(){return z.DateTime.utc(1970,
1,1,this.hour,this.minute,this.second,this.millisecond)}difference(b,m){switch(m.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(b.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(b.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===m?this.toUTCDateTime().diff(b.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(b.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(b.toUTCDateTime(),
"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(b.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(b.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(b.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(b.toUTCDateTime(),"milliseconds").milliseconds}}}a.TimeOnly=G;a.standardizeTimeFormat=r;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(a,d){a.cloneGeometry=function(n){if(null==n)return null;const z=n.clone();void 0!==n.cache._geVersion&&(z.cache._geVersion=n.cache._geVersion);return z};a.convertLinearUnitsToCode=function(n){if(null==n)return null;if("number"===typeof n)return n;n=n.toLowerCase();n=n.replaceAll(/\s/g,"");n=n.replaceAll("-","");switch(n){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 9001;
case "miles":case "mile":case "squaremile":case "squaremiles":return 9093;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 9036;case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 9096;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 9002;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 9030}return null};a.convertSquareUnitsToCode=
function(n){if(null==n)return null;if("number"===typeof n)return n;n=n.toLowerCase();n=n.replaceAll(/\s/g,"");n=n.replaceAll("-","");switch(n){case "meters":case "meter":case "m":case "squaremeters":case "squaremeter":return 109404;case "miles":case "mile":case "squaremile":case "squaremiles":return 109439;case "kilometers":case "kilometer":case "squarekilometers":case "squarekilometer":case "km":return 109414;case "acres":case "acre":case "ac":return 109402;case "hectares":case "hectare":case "ha":return 109401;
case "yard":case "yd":case "yards":case "squareyards":case "squareyard":return 109442;case "feet":case "ft":case "foot":case "squarefeet":case "squarefoot":return 109405;case "nmi":case "nauticalmile":case "nauticalmiles":case "squarenauticalmile":case "squarenauticalmiles":return 109409}return null};a.isInteger=function(n){return"number"===typeof n&&isFinite(n)&&Math.floor(n)===n};a.sameGeomType=function(n,z){return n===z||"point"===n&&"esriGeometryPoint"===z||"polyline"===n&&"esriGeometryPolyline"===
z||"polygon"===n&&"esriGeometryPolygon"===z||"extent"===n&&"esriGeometryEnvelope"===z||"multipoint"===n&&"esriGeometryMultipoint"===z||"point"===z&&"esriGeometryPoint"===n||"polyline"===z&&"esriGeometryPolyline"===n||"polygon"===z&&"esriGeometryPolygon"===n||"extent"===z&&"esriGeometryEnvelope"===n||"multipoint"===z&&"esriGeometryMultipoint"===n?!0:!1};a.shapeExtent=function(n){if(null==n)return null;switch(n.type){case "polygon":case "multipoint":case "polyline":return n.extent;case "point":return new d({xmin:n.x,
ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});case "extent":return n}return null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlArithmeticUtils":function(){define(["exports","./errorSupport","./sqlDateParsingUtils","./SqlInterval","./StandardizedFunctions"],function(a,d,n,z,r){function G(L,P,S){switch(S){case "+":return L+P;case "-":return L-P;case "*":return L*P;case "/":return L/P}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function b(L,
P,S){switch(S){case "+":return P.plus({milliseconds:L.valueInMilliseconds()});case "-":return L.valueInMilliseconds()-P.toMillis()}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function m(L,P,S){switch(S){case "+":return P.plus("milliseconds",L.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function f(L,P,S){switch(S){case "+":return P.plus("milliseconds",L.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function v(L,P,S){switch(S){case "+":return L.plus("milliseconds",
P.valueInMilliseconds());case "-":return L.plus("milliseconds",-1*P.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function x(L,P,S){switch(S){case "+":return P.addMilliseconds(L.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function B(L,P,S){switch(S){case "+":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()+P.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()-P.valueInMilliseconds());
case "*":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()*P.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()/P.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function D(L,P,S){switch(S){case "+":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()+P);case "-":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()-P);case "*":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()*
P);case "/":return z.SqlInterval.createFromMilliseconds(L.valueInMilliseconds()/P)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function p(L,P,S){switch(S){case "+":return z.SqlInterval.createFromMilliseconds(L+P.valueInMilliseconds());case "-":return z.SqlInterval.createFromMilliseconds(L-P.valueInMilliseconds());case "*":return z.SqlInterval.createFromMilliseconds(L*P.valueInMilliseconds());case "/":return z.SqlInterval.createFromMilliseconds(L/P.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function A(L,P,S){switch(S){case "+":return L.plus("milliseconds",P.valueInMilliseconds());case "-":return L.plus("milliseconds",-1*P.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function F(L,P,S){switch(S){case "+":return L.plus({milliseconds:P.valueInMilliseconds()});case "-":return L.minus({milliseconds:P.valueInMilliseconds()})}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function q(L,P,S){switch(S){case "+":return L.addMilliseconds(P.valueInMilliseconds());
case "-":return L.addMilliseconds(-1*P.valueInMilliseconds())}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function c(L,P,S){P*=864E5;switch(S){case "+":return L.plus({milliseconds:P});case "-":return L.minus({milliseconds:P})}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function l(L,P,S){P*=864E5;switch(S){case "+":return L.plus("milliseconds",P);case "-":return L.plus("milliseconds",-1*P)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function H(L,P,S){P*=864E5;switch(S){case "+":return L.plus("milliseconds",
P);case "-":return L.plus("milliseconds",-1*P)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function g(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function I(L,P,S){P*=864E5;switch(S){case "+":return L.addMilliseconds(P);case "-":return L.addMilliseconds(-1*P)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function E(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function C(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function N(L,
P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Q(L,P,S){P=parseFloat(P);if(isNaN(P))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);return G(L,P,S)}function T(L,P,S){L=parseFloat(L);if(isNaN(L))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);return G(L,P,S)}function y(L,P,S){switch(S){case "+":return L+P}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function R(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function k(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function h(L,P,S){switch(S){case "-":return L.toDateTimeLuxon(P.zone).diff(P).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function t(L,P,S){switch(S){case "-":return L.toDateTimeLuxon(P.toDateTime().zone).diff(P.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function J(L,P,S){switch(S){case "-":return L.toDateTimeLuxon("UTC").diff(P.toDateTimeLuxon("UTC")).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function U(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function Y(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function da(L,P,S){switch(S){case "-":return L.toDateTime().diff(P.toDateTimeLuxon(L.toDateTime().zone)).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ia(L,P,S){switch(S){case "-":return L.toDateTime().diff(P).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function na(L,P,S){switch(S){case "-":return L.toDateTime().diff(P.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function oa(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function pa(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function sa(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function wa(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function xa(L,P,S){switch(S){case "-":return L.diff(P).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Da(L,P,S){switch(S){case "-":return L.diff(P.toDateTimeLuxon(L.zone)).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function Ea(L,P,S){switch(S){case "-":return L.diff(P.toDateTime()).as("days")}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Ja(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function Sa(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ab(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function La(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function u(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}function O(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function X(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ba(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}function ja(L,P,S){throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}a.calculateDateOnlyAndDateOnly=J;a.calculateDateOnlyAndDateTime=h;a.calculateDateOnlyAndNumber=l;a.calculateDateOnlyAndSqlInterval=A;a.calculateDateOnlyAndString=Sa;a.calculateDateOnlyAndTimeOnly=U;a.calculateDateOnlyAndTimestamp=
t;a.calculateDateTimeAndDateOnly=Da;a.calculateDateTimeAndDateTime=xa;a.calculateDateTimeAndNumber=c;a.calculateDateTimeAndSqlInterval=F;a.calculateDateTimeAndString=La;a.calculateDateTimeAndTimeOnly=Ja;a.calculateDateTimeAndTimestamp=Ea;a.calculateNumberAndDateOnly=N;a.calculateNumberAndDateTime=g;a.calculateNumberAndNumber=G;a.calculateNumberAndSqlInterval=p;a.calculateNumberAndString=Q;a.calculateNumberAndTimeOnly=C;a.calculateNumberAndTimestamp=E;a.calculateSqlIntervalAndDateOnly=f;a.calculateSqlIntervalAndDateTime=
b;a.calculateSqlIntervalAndNumber=D;a.calculateSqlIntervalAndSqlInterval=B;a.calculateSqlIntervalAndString=R;a.calculateSqlIntervalAndTimeOnly=m;a.calculateSqlIntervalAndTimestamp=x;a.calculateStringAndDateOnly=X;a.calculateStringAndDateTime=ba;a.calculateStringAndNumber=T;a.calculateStringAndSqlInterval=k;a.calculateStringAndString=y;a.calculateStringAndTimeOnly=O;a.calculateStringAndTimestamp=ja;a.calculateTimeOnlyAndDateOnly=pa;a.calculateTimeOnlyAndDateTime=oa;a.calculateTimeOnlyAndNumber=H;a.calculateTimeOnlyAndSqlInterval=
v;a.calculateTimeOnlyAndString=ab;a.calculateTimeOnlyAndTimeOnly=wa;a.calculateTimeOnlyAndTimestamp=sa;a.calculateTimestampAndDateOnly=da;a.calculateTimestampAndDateTime=ia;a.calculateTimestampAndNumber=I;a.calculateTimestampAndSqlInterval=q;a.calculateTimestampAndString=u;a.calculateTimestampAndTimeOnly=Y;a.calculateTimestampAndTimestamp=na;a.sqlCalculateFunction=function(L,P,S,W){if("||"===L)return r.evaluateFunction("concat",[P,S],W);if(null===P||null===S)return null;if(n.isNumber(P)){if(n.isNumber(S))return G(P,
S,L);if(n.isSqlInterval(S))return p(P,S,L);if(n.isTimeOnly(S))return C();if(n.isDateOnly(S))return N();if(n.isTimestampOffset(S))return E();if(n.isDateTime(S))return g();if(n.isString(S))return Q(P,S,L)}else if(n.isDateOnly(P)){if(n.isNumber(S))return l(P,S,L);if(n.isSqlInterval(S))return A(P,S,L);if(n.isTimeOnly(S))return U();if(n.isDateOnly(S))return J(P,S,L);if(n.isTimestampOffset(S))return t(P,S,L);if(n.isDateTime(S))return h(P,S,L);if(n.isString(S))return Sa()}else if(n.isTimeOnly(P)){if(n.isNumber(S))return H(P,
S,L);if(n.isSqlInterval(S))return v(P,S,L);if(n.isTimeOnly(S))return wa();if(n.isDateOnly(S))return pa();if(n.isTimestampOffset(S))return sa();if(n.isDateTime(S))return oa();if(n.isString(S))return ab()}else if(n.isSqlInterval(P)){if(n.isNumber(S))return D(P,S,L);if(n.isSqlInterval(S))return B(P,S,L);if(n.isTimeOnly(S))return m(P,S,L);if(n.isDateOnly(S))return f(P,S,L);if(n.isTimestampOffset(S))return x(P,S,L);if(n.isDateTime(S))return b(P,S,L);if(n.isString(S))return R()}else if(n.isDateTime(P)){if(n.isNumber(S))return c(P,
S,L);if(n.isSqlInterval(S))return F(P,S,L);if(n.isTimeOnly(S))return Ja();if(n.isDateOnly(S))return Da(P,S,L);if(n.isTimestampOffset(S))return Ea(P,S,L);if(n.isDateTime(S))return xa(P,S,L);if(n.isString(S))return La()}else if(n.isTimestampOffset(P)){if(n.isNumber(S))return I(P,S,L);if(n.isSqlInterval(S))return q(P,S,L);if(n.isTimeOnly(S))return Y();if(n.isDateOnly(S))return da(P,S,L);if(n.isTimestampOffset(S))return na(P,S,L);if(n.isDateTime(S))return ia(P,S,L);if(n.isString(S))return u()}else if(n.isString(P)){if(n.isNumber(S))return T(P,
S,L);if(n.isSqlInterval(S))return k();if(n.isTimeOnly(S))return O();if(n.isDateOnly(S))return X();if(n.isTimestampOffset(S))return ja();if(n.isDateTime(S))return ba();if(n.isString(S))return y(P,S,L)}throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/sqlDateParsingUtils":function(){define("exports ./DateOnly ./errorSupport ./SqlInterval ./SqlTimestampOffset ./TimeOnly ./UnknownTimeZone ../../chunks/datetime".split(" "),
function(a,d,n,z,r,G,b,m){function f(c,l,H){H=p.exec(c);if(null!==H){const [,g,I,E,C,N,Q,T]=H;c=m.DateTime.fromObject({year:parseInt(g,10),month:parseInt(I,10),day:parseInt(E,10),hour:parseInt(C,10),minute:parseInt(N,10),second:parseInt(Q,10),millisecond:T?parseInt(T.replace(".",""),10):0},{zone:b.substituteUnknownTimezone(l)});if(!1===c.isValid)throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);return c}H=A.exec(c);if(null!==H){const [,g,I,E,C,N,Q,T,y,R,k]=H;c=r.SqlTimeStampOffset.fromParts(parseInt(g,
10),parseInt(I,10),parseInt(E,10),parseInt(C,10),parseInt(N,10),parseInt(Q,10),T?parseInt(T.replace(".",""),10):0,"-"===y,parseInt(R,10),parseInt(k,10));if(!1===c.isValid)throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);return c}H=F.exec(c);if(null!==H){const [,g,I,E,C,N,Q,T,y]=H;c=r.SqlTimeStampOffset.fromParts(parseInt(g,10),parseInt(I,10),parseInt(E,10),parseInt(C,10),parseInt(N,10),0,0,"-"===Q,parseInt(T,10),parseInt(y,10));if(!1===c.isValid)throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);
return c}H=q.exec(c);if(null!==H){const [,g,I,E,C,N]=H;c=m.DateTime.fromObject({year:parseInt(g,10),month:parseInt(I,10),day:parseInt(E,10),hour:parseInt(C,10),minute:parseInt(N,10),second:0},{zone:b.substituteUnknownTimezone(l)});if(!1===c.isValid)throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);return c}H=D.exec(c);if(null!==H){const [,g,I,E]=H;c=m.DateTime.fromObject({year:parseInt(g,10),month:parseInt(I,10),day:parseInt(E,10),hour:0,minute:0,second:0},{zone:b.substituteUnknownTimezone(l)});
if(!1===c.isValid)throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);return c}throw new n.SqlError(n.SqlErrorCodes.InvalidTimeStamp);}const v=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,x=/^(\d{1,2}):(\d{1,2})$/,B=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,p=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,
q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;a.convertToExecutingTimeZone=function(c,l){if(l instanceof m.Zone)return l===b.UnknownTimeZone.instance?m.DateTime.fromMillis(c.getTime(),{zone:b.UnknownTimeZone.instance}):m.DateTime.fromJSDate(c,{zone:l});switch(l){case "system":case "local":case null:return m.DateTime.fromJSDate(c);default:return"unknown"===l?.toLowerCase()?m.DateTime.fromMillis(c.getTime(),{zone:b.UnknownTimeZone.instance}):m.DateTime.fromJSDate(c,{zone:l})}};a.isDate=function(c){return c instanceof
Date};a.isDateOnly=function(c){return c instanceof d.DateOnly};a.isDateTime=function(c){return c instanceof m.DateTime};a.isNumber=function(c){return"number"===typeof c};a.isSqlInterval=function(c){return c instanceof z.SqlInterval};a.isString=function(c){return"string"===typeof c||c instanceof String};a.isTimeOnly=function(c){return c instanceof G.TimeOnly};a.isTimestampOffset=function(c){return c instanceof r.SqlTimeStampOffset};a.parseDate=function(c,l){const H=D.exec(c);if(null===H)try{return f(c,
l)}catch{throw new n.SqlError(n.SqlErrorCodes.InvalidDate);}const [,g,I,E]=H;c=d.DateOnly.fromParts(parseInt(g,10),parseInt(I,10),parseInt(E,10));if(null===c)throw new n.SqlError(n.SqlErrorCodes.InvalidDate);return c};a.parseTime=function(c){let l=v.exec(c);if(null!==l){const [,H,g,I]=l;c=G.TimeOnly.fromParts(parseInt(H,10),parseInt(g,10),parseInt(I,10),0);if(null!==c)return c;throw new n.SqlError(n.SqlErrorCodes.InvalidTime);}l=x.exec(c);if(null!==l){const [,H,g]=l;c=G.TimeOnly.fromParts(parseInt(H,
10),parseInt(g,10),0,0);if(null!==c)return c;throw new n.SqlError(n.SqlErrorCodes.InvalidTime);}l=B.exec(c);if(null!==l){const [,H,g,I,E]=l;c=G.TimeOnly.fromParts(parseInt(H,10),parseInt(g,10),parseInt(I,10),parseInt(E,10));if(null!==c)return c}throw new n.SqlError(n.SqlErrorCodes.InvalidTime);};a.parseTimestamp=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/SqlInterval":function(){define(["exports","./errorSupport"],function(a,d){class n{constructor(){this.op="+";
this.millis=this.minute=this.year=this.month=this.hour=this.second=this.day=0}static _fixDefaults(z){if(null!==z.precision||null!==z.secondary)throw new d.SqlError(d.SqlErrorCodes.PrimarySecondaryQualifiers);}static _parseSecondsComponent(z,r){r.includes(".")?(r=r.split("."),z.second=parseFloat(r[0]),z.millis=parseInt(r[1],10)):z.second=parseFloat(r)}static createFromMilliseconds(z){const r=new n;r.second=z/1E3;return r}static createFromValueAndQualifier(z,r,G){let b=null;const m=new n;m.op="-"===
G?"-":"+";if("interval-period"===r.type){n._fixDefaults(r);G=RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new d.SqlError(d.SqlErrorCodes.YearMonthIntervals);if("second"===r.period)if(/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(z))n._parseSecondsComponent(m,z);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);else if(G.test(z))m[r.period]=parseFloat(z);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}else{n._fixDefaults(r.start);n._fixDefaults(r.end);if("year"===
r.start.period||"month"===r.start.period||"year"===r.end.period||"month"===r.end.period)throw new d.SqlError(d.SqlErrorCodes.YearMonthIntervals);switch(r.start.period){case "day":switch(r.end.period){case "hour":b=RegExp("^[0-9]{1,} [0-9]{1,}$");if(b.test(z))m[r.start.period]=parseFloat(z.split(" ")[0]),m[r.end.period]=parseFloat(z.split(" ")[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "minute":b=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$");if(b.test(z))m[r.start.period]=
parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),m.hour=parseFloat(z[0]),m.minute=parseFloat(z[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "second":b=RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(b.test(z))m[r.start.period]=parseFloat(z.split(" ")[0]),z=z.split(" ")[1].split(":"),m.hour=parseFloat(z[0]),m.minute=parseFloat(z[1]),n._parseSecondsComponent(m,z[2]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);
}break;case "hour":switch(r.end.period){case "minute":b=RegExp("^[0-9]{1,}:[0-9]{1,}$");if(b.test(z))m.hour=parseFloat(z.split(":")[0]),m.minute=parseFloat(z.split(":")[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;case "second":b=RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(b.test(z))z=z.split(":"),m.hour=parseFloat(z[0]),m.minute=parseFloat(z[1]),n._parseSecondsComponent(m,z[2]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);
}break;case "minute":switch(r.end.period){case "second":b=RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$");if(b.test(z))z=z.split(":"),m.minute=parseFloat(z[0]),n._parseSecondsComponent(m,z[1]);else throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}break;default:throw new d.SqlError(d.SqlErrorCodes.IllegalInterval);}}return m}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1E3*this.second+6E4*this.minute+36E5*
this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)}}a.SqlInterval=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/StandardizedFunctions":function(){define("exports ../mathUtils ../string ./DateOnly ./errorSupport ./sqlCompareUtils ./sqlDateParsingUtils ./TimeOnly ../../chunks/datetime".split(" "),function(a,d,n,z,r,G,b,m,f){function v(q){return"string"===typeof q||q instanceof String}function x(q){return b.isDate(q)||b.isDateOnly(q)||b.isDateTime(q)||
b.isTimeOnly(q)||b.isTimestampOffset(q)?!1:!0}function B(q){return b.isDateOnly(q)||b.isTimeOnly(q)?q.toString():b.isTimestampOffset(q)?q.toSQLValue():b.isDateTime(q)?0===q.millisecond?q.toFormat("yyyy-LL-dd HH:mm:ss"):q.toSQL({includeOffset:!1}):b.isDate(q)?B(f.DateTime.fromJSDate(q)):q.toString()}function D(q){if(b.isDate(q))return z.DateOnly.fromDateJS(q);if(b.isDateTime(q))return z.DateOnly.fromParts(q.year,q.month,q.day);if(b.isDateOnly(q))return q;if(b.isTimeOnly(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
if(b.isTimestampOffset(q)&&null===z.DateOnly.fromParts(q.year,q.month,q.day))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(v(q)&&(q=z.DateOnly.fromReader(q),null!==q&&q.isValid))return q;throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function p(q,c,l){if(b.isDate(q))return b.convertToExecutingTimeZone(q,c);if(b.isDateTime(q))return q;if(b.isDateOnly(q))return q.toDateTimeLuxon("unknown");if(b.isTimeOnly(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(b.isTimestampOffset(q))return q;
if(v(q))return b.parseTimestamp(q,"unknown",l);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}function A(q){if(b.isDate(q))return m.TimeOnly.fromDateJS(q);if(b.isDateTime(q))return m.TimeOnly.fromDateTime(q);if(b.isDateOnly(q))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(b.isTimeOnly(q))return q;if(b.isTimestampOffset(q))return m.TimeOnly.fromSqlTimeStampOffset(q);if(v(q))return b.parseTime(q);throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);}const F={extract:{minParams:2,
maxParams:2,evaluate:([q,c])=>{if(null==c)return null;if(b.isDate(c))switch(q.toUpperCase()){case "SECOND":return c.getSeconds();case "MINUTE":return c.getMinutes();case "HOUR":return c.getHours();case "DAY":return c.getDate();case "MONTH":return c.getMonth()+1;case "YEAR":return c.getFullYear();case "TIMEZONE_HOUR":return 0;case "TIMEZONE_MINUTE":return 0}else if(b.isDateTime(c))switch(q.toUpperCase()){case "SECOND":return c.second;case "MINUTE":return c.minute;case "HOUR":return c.hour;case "DAY":return c.day;
case "MONTH":return c.month;case "YEAR":return c.year}else if(b.isDateOnly(c))switch(q.toUpperCase()){case "DAY":return c.day;case "MONTH":return c.month;case "YEAR":return c.year}else if(b.isTimeOnly(c))switch(q.toUpperCase()){case "SECOND":return c.second;case "MINUTE":return c.minute;case "HOUR":return c.hour}else if(b.isTimestampOffset(c))switch(q.toUpperCase()){case "SECOND":return c.second;case "MINUTE":return c.minute;case "HOUR":return c.hour;case "DAY":return c.day;case "MONTH":return c.month;
case "YEAR":return c.year;case "TIMEZONE_HOUR":return c.timezoneOffsetHour;case "TIMEZONE_MINUTE":return c.timezoneOffsetMinutes}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"EXTRACT"});}},substring:{minParams:2,maxParams:3,evaluate:q=>{if(2===q.length){const [c,l]=q;return null==c||null==l?null:c.toString().substring(l-1)}if(3===q.length){const [c,l,H]=q;return null==c||null==l||null==H?null:0>=H?"":c.toString().substring(l-1,l+H-1)}}},position:{minParams:2,maxParams:2,
evaluate:([q,c])=>null==q||null==c?null:c.indexOf(q)+1},trim:{minParams:2,maxParams:3,evaluate:q=>{var c=3===q.length,l=c?q[1]:" ";c=c?q[2]:q[1];if(null==l||null==c)return null;l=`(${n.escapeRegExpString(l)})`;switch(q[0]){case "BOTH":return c.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case "LEADING":return c.replaceAll(new RegExp(`^${l}*`,"g"),"");case "TRAILING":return c.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new r.SqlError(r.SqlErrorCodes.InvalidFunctionParameters,{function:"TRIM"});
}},abs:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.abs(q[0])},ceiling:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.ceil(q[0])},floor:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.floor(q[0])},log:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.log(q[0])},log10:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.log(q[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.sin(q[0])},cos:{minParams:1,maxParams:1,evaluate:q=>
null==q[0]?null:Math.cos(q[0])},tan:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.tan(q[0])},asin:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.asin(q[0])},acos:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.acos(q[0])},atan:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.atan(q[0])},sign:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:0<q[0]?1:0>q[0]?-1:0},power:{minParams:2,maxParams:2,evaluate:q=>null==q[0]||null==q[1]?null:q[0]**q[1]},mod:{minParams:2,
maxParams:2,evaluate:q=>null==q[0]||null==q[1]?null:q[0]%q[1]},round:{minParams:1,maxParams:2,evaluate:q=>{const c=q[0];q=2===q.length?10**q[1]:1;return null==c?null:Math.round(c*q)/q}},truncate:{minParams:1,maxParams:2,evaluate:q=>null==q[0]?null:1===q.length||0===q[1]?Math.trunc(q[0]):d.decimalAdjust("trunc",q[0],-Number(q[1]))},char_length:{minParams:1,maxParams:1,evaluate:q=>v(q[0])?q[0].length:0},concat:{minParams:1,maxParams:Infinity,evaluate:q=>{let c="";for(let l=0;l<q.length;l++){if(null==
q[l])return null;c+=q[l].toString()}return c}},lower:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:q[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:q[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:Infinity,evaluate:q=>{for(const c of q)if(null!==c)return c;return null}},cosh:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.cosh(q[0])},sinh:{minParams:1,maxParams:1,evaluate:q=>null==q[0]?null:Math.sinh(q[0])},tanh:{minParams:1,
maxParams:1,evaluate:q=>null==q[0]?null:Math.tanh(q[0])},nullif:{minParams:2,maxParams:2,evaluate:(q,c)=>G.sqlCompare(q[0],q[1],"\x3d")?null:q[0]},cast:{minParams:2,maxParams:2,evaluate:(q,c)=>{const l=q[0];q=q[1];if(null===l)return null;switch(q.type){case "integer":if(!x(l))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);c=parseInt(l,10);if(isNaN(c))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return c;case "smallint":if(!x(l))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
c=parseInt(l,10);if(isNaN(c))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);if(32767<c||-32767>c)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return c;case "float":case "real":if(!x(l))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);c=parseFloat(l);if(isNaN(c))throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);return c;case "time":return A(l);case "date":return D(l);case "timestamp":return p(l,c,!0===q.withtimezone);case "varchar":c=B(l);if(c.length>q.size)throw new r.SqlError(r.SqlErrorCodes.CannotCastValue);
return c;default:throw new r.SqlError(r.SqlErrorCodes.InvalidDataType);}}}};a.evaluateFunction=function(q,c,l){const H=F[q.toLowerCase()];if(null==H)throw new r.SqlError(r.SqlErrorCodes.FunctionNotRecognized);if(c.length<H.minParams||c.length>H.maxParams)throw new r.SqlError(r.SqlErrorCodes.InvalidParameterCount,{name:q.toUpperCase()});return H.evaluate(c,l)};a.isStandardized=function(q,c){q=F[q.toLowerCase()];return null!=q&&c>=q.minParams&&c<=q.maxParams};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/core/sql/sqlCompareUtils":function(){define("exports ./errorSupport ./sqlDateParsingUtils ./SqlTimestampOffset ./UnknownTimeZone ../../chunks/datetime".split(" "),function(a,d,n,z,r,G){function b(F){return n.isDateTime(F)||n.isTimestampOffset(F)?!0:!1}function m(F){return n.isDateTime(F)||n.isDateOnly(F)||n.isTimestampOffset(F)||n.isTimeOnly(F)?!0:!1}function f(F){if(n.isDateTime(F))return F.toMillis();if(n.isDateOnly(F))return F.toNumber();if(n.isTimestampOffset(F))return F.toMilliseconds();
throw new d.SqlError(d.SqlErrorCodes.InvalidDataType);}function v(F,q,c){switch(c){case "\x3c\x3e":return F!==q;case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}}function x(F,q,c){const l=parseFloat(q);if(!isNaN(l))return v(F,l,c);F=F.toString();switch(c){case "\x3c\x3e":return F!==q;case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}}function B(F,
q,c){const l=parseFloat(F);if(!isNaN(l))return v(l,q,c);q=q.toString();switch(c){case "\x3c\x3e":return F!==q;case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}}function D(F,q,c){switch(c){case "\x3c\x3e":return F!==q;case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}}function p(F,q,c){F instanceof z.SqlTimeStampOffset&&(F=F.toDateTime());q instanceof
z.SqlTimeStampOffset&&(q=q.toDateTime());F=A(F);q=A(q);switch(c){case "\x3c\x3e":return F!==q;case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}}function A(F){return 321408E5*F.year+26784E5*F.month+864E5*F.day+36E5*F.hour+6E4*F.minute+1E3*F.second+F.millisecond}a.dateValueInMilliseconds=f;a.isDateOrTimeValue=m;a.isDateTimeComparableValue=b;a.sqlCompare=function(F,q,c,l){if(null==F||null==q)return null;if(n.isNumber(F)){if(n.isNumber(q))return v(F,
q,c);if(n.isString(q))return x(F,q,c);if(m(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(n.isString(F)){if(n.isNumber(q))return B(F,q,c);if(n.isString(q))return D(F,q,c);if(n.isDateTime(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isTimestampOffset(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}else if(n.isDateTime(F)){if(b(q)){if(F instanceof G.DateTime&&r.isUnknownTimeZone(F.zone)){if(q instanceof G.DateTime&&!1===r.isUnknownTimeZone(q.zone)||q instanceof z.SqlTimeStampOffset)return p(F,q,c)}else if(q instanceof G.DateTime&&r.isUnknownTimeZone(q.zone)&&(F instanceof G.DateTime&&!1===r.isUnknownTimeZone(F.zone)||F instanceof z.SqlTimeStampOffset))return p(F,q,c);return v(f(F),f(q),c)}if(n.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isDateOnly(q))return q=q.toDateTimeLuxon(F.zone),
F=F.startOf("day"),v(F.toMillis(),q.toMillis(),c);if(n.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(n.isDateOnly(F)){if(n.isTimestampOffset(q))return F=F.toDateTimeLuxon(q.toDateTime().zone),q=q.startOfDay(),v(F.toMillis(),q.toMilliseconds(),c);if(n.isDateTime(q))return F=F.toDateTimeLuxon(q.zone),q=q.startOf("day"),v(F.toMillis(),q.toMillis(),c);if(n.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
if(n.isDateOnly(q))return v(F.toNumber(),q.toNumber(),c);if(n.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}else if(n.isTimeOnly(F)){if(n.isTimeOnly(q))return v(F.toNumber(),q.toNumber(),c);if(n.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isDateOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(b(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);
}else if(n.isTimestampOffset(F)){if(b(q))return q instanceof G.DateTime&&r.isUnknownTimeZone(q.zone)?p(F,q,c):v(f(F),f(q),c);if(n.isString(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isDateOnly(q))return q=q.toDateTimeLuxon(F.toDateTime().zone),F=F.startOfDay(),v(F.toMilliseconds(),q.toMillis(),c);if(n.isTimeOnly(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);if(n.isNumber(q))throw new d.SqlError(d.SqlErrorCodes.InvalidOperator);}switch(c){case "\x3c\x3e":return F!==q;
case "\x3d":return F===q;case "\x3e":return F>q;case "\x3c":return F<q;case "\x3e\x3d":return F>=q;case "\x3c\x3d":return F<=q}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/WhereGrammar":function(){define(["exports"],function(a){function d(b,m,f,v){b=Error.call(this,b);Object.setPrototypeOf&&Object.setPrototypeOf(b,d.prototype);b.expected=m;b.found=f;b.location=v;b.name="SyntaxError";return b}function n(b,m,f){f=f||" ";if(b.length>m)return b;m-=b.length;f+=f.repeat(m);
return b+f.slice(0,m)}function z(b,m){function f(){return p(ka,w)}function v(K,M){M=void 0!==M?M:p(ka,w);throw new d(K,null,null,M);}function x(K,M){return{type:"literal",text:K,ignoreCase:M}}function B(K,M,V){return{type:"class",parts:K,inverted:M,ignoreCase:V}}function D(K){var M=Eb[K];if(!M){if(K>=Eb.length)var V=Eb.length-1;else for(V=K;!Eb[--V];);M=Eb[V];for(M={line:M.line,column:M.column};V<K;)10===b.charCodeAt(V)?(M.line++,M.column=1):M.column++,V++;Eb[K]=M}return M}function p(K,M,V){V=D(K);
var Z=D(M);return{source:Hd,start:{offset:K,line:V.line,column:V.column},end:{offset:M,line:Z.line,column:Z.column}}}function A(K){w<hb||(w>hb&&(hb=w,jc=[]),jc.push(K))}function F(){var K=w;ha();var M=c();M!==e?(ha(),ka=K,K=M):(w=K,K=e);return K}function q(){var K;var M=w;if(Ma()!==e){ha();var V=[];for(K=c();K!==e;){V.push(K);var Z=K=w;var ta=ha();var va=Xa();va!==e?(Z=ha(),Z=ta=[ta,va,Z]):(w=Z,Z=e);Z!==e?(Z=c(),Z===e?(w=K,K=e):K=Z):K=Z}K=ha();Z=Na();Z!==e?(ka=M,M=Ia(f(),...V)):(w=M,M=e)}else w=M,
M=e;return M}function c(){var K=w;var M=l();if(M!==e){var V=[];var Z=w;ha();var ta=W();if(ta!==e){ha();var va=l();va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)}else w=Z,Z=e;for(;Z!==e;)V.push(Z),Z=w,ha(),ta=W(),ta!==e?(ha(),va=l(),va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)):(w=Z,Z=e);ka=K;K=Ib(M,V)}else w=K,K=e;return K}function l(){var K=w;var M=H();if(M!==e){var V=[];var Z=w;ha();var ta=S();if(ta!==e){ha();var va=H();va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)}else w=
Z,Z=e;for(;Z!==e;)V.push(Z),Z=w,ha(),ta=S(),ta!==e?(ha(),va=H(),va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)):(w=Z,Z=e);ka=K;K=Ib(M,V)}else w=K,K=e;return K}function H(){var K=w;var M=P();if(M===e){M=w;if(33===b.charCodeAt(w)){var V=Id;w++}else V=e,0===fa&&A(Jd);if(V!==e){var Z=w;fa++;if(61===b.charCodeAt(w)){var ta=Kd;w++}else ta=e,0===fa&&A(Ld);fa--;ta===e?Z=void 0:(w=Z,Z=e);Z!==e?M=V=[V,Z]:(w=M,M=e)}else w=M,M=e}M!==e?(V=ha(),Z=H(),Z!==e?(ka=K,K={type:"unary-expression",location:f(),
operator:"NOT",expr:Z}):(w=K,K=e)):(w=K,K=e);if(K===e){M=w;K=C();if(K!==e){V=w;ha();Z=w;ta=[];var va=w;ha();var Ga=g();if(Ga!==e){ha();var Ta=C();Ta!==e?(ka=va,va={op:Ga,expr:Ta,location:f()}):(w=va,va=e)}else w=va,va=e;if(va!==e)for(;va!==e;)ta.push(va),va=w,ha(),Ga=g(),Ga!==e?(ha(),Ta=C(),Ta!==e?(ka=va,va={op:Ga,expr:Ta,location:f()}):(w=va,va=e)):(w=va,va=e);else ta=e;ta!==e&&(ka=Z,ta={type:"arithmetic",tail:ta});Z=ta;if(Z===e&&(Z=w,ta=E(),ta!==e?(ha(),va=q(),va!==e?(ka=Z,Z={op:ta,right:va}):(w=
Z,Z=e)):(w=Z,Z=e),Z===e&&(Z=w,ta=E(),ta!==e?(ha(),va=Y(),va!==e?(ka=Z,Z={op:ta,right:va}):(w=Z,Z=e)):(w=Z,Z=e)),Z===e)){Z=w;ta=P();if(ta!==e)if(ha(),va=aa(),va!==e){var Jb=ha();Ga=w;Ta=C();if(Ta!==e){ha();var db=S();db!==e?(ha(),ta=C(),ta!==e?(ka=Ga,Ga=Ta,Ga=Ia(f(),Ga,ta)):(w=Ga,Ga=e)):(w=Ga,Ga=e)}else w=Ga,Ga=e;Ga!==e?(ka=Z,Z={op:"NOT"+va,right:Ga}):(w=Z,Z=e)}else w=Z,Z=e;else w=Z,Z=e;Z===e&&(Z=w,ta=aa(),ta!==e?(ha(),va=w,Jb=C(),Jb!==e?(Ga=ha(),Ta=S(),Ta!==e?(ha(),db=C(),db!==e?(ka=va,va=Jb,Ga=db,
va=Ia(f(),va,Ga)):(w=va,va=e)):(w=va,va=e)):(w=va,va=e),va!==e?(ka=Z,Z={op:ta,right:va}):(w=Z,Z=e)):(w=Z,Z=e));Z===e&&(Z=w,ta=ja(),ta!==e?(ha(),va=P(),va!==e?(ha(),va=C(),va!==e?(ka=Z,Z={op:ta+"NOT",right:va}):(w=Z,Z=e)):(w=Z,Z=e)):(w=Z,Z=e),Z===e&&(Z=w,ta=ja(),ta!==e?(ha(),va=C(),va!==e?(ka=Z,Z={op:ta,right:va}):(w=Z,Z=e)):(w=Z,Z=e)),Z===e&&(Z=w,ta=I(),ta!==e?(ha(),va=xa(),va!==e?(ha(),Ga=w,Ta=b.substr(w,6),Ta.toLowerCase()===Md?w+=6:(Ta=e,0===fa&&A(Nd)),Ta!==e?(Ta=w,fa++,db=h(),fa--,db===e?Ta=void 0:
(w=Ta,Ta=e),Ta!==e?(ka=Ga,Ga="ESCAPE"):(w=Ga,Ga=e)):(w=Ga,Ga=e),Ga!==e?(ha(),Ga=Da(),Ga!==e?(ka=Z,Z={op:ta,right:va,escape:Ga.value}):(w=Z,Z=e)):(w=Z,Z=e)):(w=Z,Z=e)):(w=Z,Z=e),Z===e&&(Z=w,ta=I(),ta!==e?(ha(),va=xa(),va!==e?(ka=Z,Z={op:ta,right:va,escape:""}):(w=Z,Z=e)):(w=Z,Z=e))))}Z!==e?V=Z:(w=V,V=e);V===e&&(V=null);ka=M;M=V;""==M||void 0==M||null==M?M=K:(V=null,M=V="arithmetic"==M.type?Ib(K,M.tail):Kb(M.op,K,M.right,M.escape,f()))}else w=M,M=e;K=M}return K}function g(){if(b.substr(w,2)===fd){var K=
fd;w+=2}else K=e,0===fa&&A(Od);K===e&&(62===b.charCodeAt(w)?(K=Pd,w++):(K=e,0===fa&&A(Qd)),K===e&&(b.substr(w,2)===gd?(K=gd,w+=2):(K=e,0===fa&&A(Rd)),K===e&&(b.substr(w,2)===hd?(K=hd,w+=2):(K=e,0===fa&&A(Sd)),K===e&&(K=b.charAt(w),Td.test(K)?w++:(K=e,0===fa&&A(Ud)),K===e&&(b.substr(w,2)===id?(K=id,w+=2):(K=e,0===fa&&A(Vd)))))));return K}function I(){var K;var M=K=w;var V=P();if(V!==e){var Z=ha();var ta=L();ta!==e?M=V=[V,Z,ta]:(w=M,M=e)}else w=M,M=e;M!==e&&(ka=K,M=M[0]+" "+M[2]);K=M;K===e&&(K=L());
return K}function E(){var K;var M=K=w;var V=P();if(V!==e){var Z=ha();var ta=ba();ta!==e?M=V=[V,Z,ta]:(w=M,M=e)}else w=M,M=e;M!==e&&(ka=K,M=M[0]+" "+M[2]);K=M;K===e&&(K=ba());return K}function C(){var K=w;var M=Q();if(M!==e){var V=[];var Z=w;ha();var ta=N();if(ta!==e){ha();var va=Q();va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)}else w=Z,Z=e;for(;Z!==e;)V.push(Z),Z=w,ha(),ta=N(),ta!==e?(ha(),va=Q(),va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)):(w=Z,Z=e);ka=K;K=Ib(M,V)}else w=K,K=
e;return K}function N(){var K=b.charAt(w);kc.test(K)?w++:(K=e,0===fa&&A(lc));K===e&&(b.substr(w,2)===jd?(K=jd,w+=2):(K=e,0===fa&&A(Wd)));return K}function Q(){var K=w;var M=y();if(M!==e){var V=[];var Z=w;ha();var ta=T();if(ta!==e){ha();var va=y();va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)}else w=Z,Z=e;for(;Z!==e;)V.push(Z),Z=w,ha(),ta=T(),ta!==e?(ha(),va=y(),va!==e?(ka=Z,Z={op:ta,expr:va,location:f()}):(w=Z,Z=e)):(w=Z,Z=e);ka=K;K=Ib(M,V)}else w=K,K=e;return K}function T(){var K=b.charAt(w);
Xd.test(K)?w++:(K=e,0===fa&&A(Yd));return K}function y(){var K=Da();if(K===e){var M=w;var V=w;var Z=ab();if(Z!==e){var ta=La();if(ta!==e){var va=u();va!==e?(ka=V,V=parseFloat(Z+ta+va)):(w=V,V=e)}else w=V,V=e}else w=V,V=e;V===e&&(V=w,Z=ab(),Z!==e?(ta=La(),ta!==e?(ka=V,V=parseFloat(Z+ta)):(w=V,V=e)):(w=V,V=e),V===e&&(V=w,Z=ab(),Z!==e?(ta=u(),ta!==e?(ka=V,V=parseFloat(Z+ta)):(w=V,V=e)):(w=V,V=e),V===e&&(V=w,Z=ab(),Z!==e&&(ka=V,Z=parseFloat(Z)),V=Z)));var Ga=V;if(Ga!==e){var Ta=w;fa++;var Jb=k();fa--;
Jb===e?Ta=void 0:(w=Ta,Ta=e);Ta!==e?(ka=M,M={type:"number",location:f(),value:Ga}):(w=M,M=e)}else w=M,M=e;K=M;if(K===e){var db=w;var Fb=w;var Lb=b.substr(w,4);Lb.toLowerCase()===Zd?w+=4:(Lb=e,0===fa&&A($d));if(Lb!==e){var Mb=w;fa++;var ae=h();fa--;ae===e?Mb=void 0:(w=Mb,Mb=e);Mb!==e?Fb=Lb=[Lb,Mb]:(w=Fb,Fb=e)}else w=Fb,Fb=e;var mb=Fb;mb!==e&&(ka=db,mb={type:"boolean",location:f(),value:!0});db=mb;if(db===e){db=w;var Gb=w;var Nb=b.substr(w,5);Nb.toLowerCase()===be?w+=5:(Nb=e,0===fa&&A(ce));if(Nb!==
e){var Ob=w;fa++;var de=h();fa--;de===e?Ob=void 0:(w=Ob,Ob=e);Ob!==e?Gb=Nb=[Nb,Ob]:(w=Gb,Gb=e)}else w=Gb,Gb=e;mb=Gb;mb!==e&&(ka=db,mb={type:"boolean",location:f(),value:!1});db=mb}K=db;if(K===e){var ee=w;var Hb=w;var Pb=b.substr(w,4);Pb.toLowerCase()===fe?w+=4:(Pb=e,0===fa&&A(ge));if(Pb!==e){var Qb=w;fa++;var he=h();fa--;he===e?Qb=void 0:(w=Qb,Qb=e);Qb!==e?Hb=Pb=[Pb,Qb]:(w=Hb,Hb=e)}else w=Hb,Hb=e;var Ec=Hb;Ec!==e&&(ka=ee,Ec={type:"null",location:f(),value:null});K=Ec;if(K===e){var nb=w;if(ma()!==
e){ha();var mc=xa();mc!==e?(ka=nb,"string"===mc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(mc.value)&&v("Date literal is invalid"),nb={type:"date",location:f(),value:mc.value}):(w=nb,nb=
e)}else w=nb,nb=e;K=nb;if(K===e){var ob=w;if(la()!==e){ha();var nc=xa();nc!==e?(ka=ob,"string"===nc.type&&!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(nc.value)&&v("Timestamp literal is invalid"),
ob={type:"timestamp",location:f(),value:nc.value}):(w=ob,ob=e)}else w=ob,ob=e;K=ob;if(K===e){var Ya=w;var Fc=qa();if(Fc!==e){ha();var pb=b.charAt(w);kc.test(pb)?w++:(pb=e,0===fa&&A(lc));if(pb!==e){ha();var Rb=xa();if(Rb!==e){ha();var kd=oa();if(kd!==e){ka=Ya;var ie=pb,je=Rb;Ya={type:"interval",location:f(),value:je,qualifier:kd,op:ie}}else w=Ya,Ya=e}else w=Ya,Ya=e}else w=Ya,Ya=e}else w=Ya,Ya=e;if(Ya===e)if(Ya=w,Fc=qa(),Fc!==e)if(ha(),pb=xa(),pb!==e)if(ha(),Rb=oa(),Rb!==e){ka=Ya;var ke=pb,le=Rb;Ya=
{type:"interval",location:f(),value:ke,qualifier:le,op:""}}else w=Ya,Ya=e;else w=Ya,Ya=e;else w=Ya,Ya=e;K=Ya;if(K===e){var qb=w;if(ua()!==e){ha();var oc=xa();oc!==e?(ka=qb,"string"===oc.type&&!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(oc.value)&&v("Time literal is invalid"),qb={type:"time",location:f(),value:oc.value}):(w=qb,qb=e)}else w=qb,qb=e;K=qb}}}}}}}var Ka=K;if(Ka===e){var rb=w;if(ea()!==e){ha();var Oa=w;var Gc=Ma();if(Gc!==e){ha();
var Sb=na();if(Sb!==e){ha();var Hc=ca();if(Hc!==e){ha();var Tb=c();if(Tb!==e){ha();var Ic=Na();if(Ic!==e){ka=Oa;var me=Sb,ne=Tb;Oa=Ia(f(),me,ne)}else w=Oa,Oa=e}else w=Oa,Oa=e}else w=Oa,Oa=e}else w=Oa,Oa=e}else w=Oa,Oa=e;if(Oa===e)if(Oa=w,Gc=Ma(),Gc!==e)if(ha(),Sb=na(),Sb!==e)if(ha(),Hc=Xa(),Hc!==e)if(ha(),Tb=c(),Tb!==e)if(ha(),Ic=Na(),Ic!==e){ka=Oa;var oe=Sb,pe=Tb;Oa=Ia(f(),oe,pe)}else w=Oa,Oa=e;else w=Oa,Oa=e;else w=Oa,Oa=e;else w=Oa,Oa=e;else w=Oa,Oa=e;if(Oa!==e){ka=rb;var qe=Oa;rb={type:"function",
location:f(),name:"extract",args:qe}}else w=rb,rb=e}else w=rb,rb=e;Ka=rb;if(Ka===e){var sb=w;var tb=w;var Jc=b.substr(w,9);Jc.toLowerCase()===re?w+=9:(Jc=e,0===fa&&A(se));if(Jc!==e){var pc=w;fa++;var te=h();fa--;te===e?pc=void 0:(w=pc,pc=e);pc!==e?(ka=tb,tb="SUBSTRING"):(w=tb,tb=e)}else w=tb,tb=e;if(tb!==e){ha();var Ha=w;var Kc=Ma();if(Kc!==e){ha();var Ub=c();if(Ub!==e){ha();var Lc=ca();if(Lc!==e){ha();var Vb=c();if(Vb!==e){ha();var jb=w;var ub=w;var Mc=b.substr(w,3);Mc.toLowerCase()===ue?w+=3:(Mc=
e,0===fa&&A(ve));if(Mc!==e){var qc=w;fa++;var we=h();fa--;we===e?qc=void 0:(w=qc,qc=e);qc!==e?(ka=ub,ub="FOR"):(w=ub,ub=e)}else w=ub,ub=e;var rc=ub;if(rc!==e){var Nc=ha();var sc=c();sc!==e?(ha(),jb=sc):(w=jb,jb=e)}else w=jb,jb=e;jb===e&&(jb=null);rc=Na();if(rc!==e){ka=Ha;var xe=Ub,ye=Vb,ld=jb;Ha=Ia(f(),xe,ye,...(ld?[ld]:[]))}else w=Ha,Ha=e}else w=Ha,Ha=e}else w=Ha,Ha=e}else w=Ha,Ha=e}else w=Ha,Ha=e;if(Ha===e)if(Ha=w,Kc=Ma(),Kc!==e)if(ha(),Ub=c(),Ub!==e)if(ha(),Lc=Xa(),Lc!==e)if(ha(),Vb=c(),Vb!==e)if(ha(),
jb=Xa(),jb!==e)if(rc=ha(),Nc=c(),Nc!==e)if(sc=Na(),sc!==e){ka=Ha;var ze=Ub,Ae=Vb,Be=Nc;Ha=Ia(f(),ze,Ae,Be)}else w=Ha,Ha=e;else w=Ha,Ha=e;else w=Ha,Ha=e;else w=Ha,Ha=e;else w=Ha,Ha=e;else w=Ha,Ha=e;else w=Ha,Ha=e;if(Ha!==e){ka=sb;var Ce=Ha;sb={type:"function",location:f(),name:"substring",args:Ce}}else w=sb,sb=e}else w=sb,sb=e;Ka=sb;if(Ka===e){var vb=w;var wb=w;var Oc=b.substr(w,4);Oc.toLowerCase()===De?w+=4:(Oc=e,0===fa&&A(Ee));if(Oc!==e){var tc=w;fa++;var Fe=h();fa--;Fe===e?tc=void 0:(w=tc,tc=e);
tc!==e?(ka=wb,wb="TRIM"):(w=wb,wb=e)}else w=wb,wb=e;if(wb!==e){ha();var Ua=w;var Pc=Ma();if(Pc!==e){ha();var Qc=ia();ha();var Wb=c();if(Wb!==e){ha();var Rc=ca();if(Rc!==e){ha();var md=c();if(md!==e){ha();var Ge=Na();if(Ge!==e){ka=Ua;var He=Qc,Ie=Wb;Ua=Ia(f(),He,Ie,md)}else w=Ua,Ua=e}else w=Ua,Ua=e}else w=Ua,Ua=e}else w=Ua,Ua=e}else w=Ua,Ua=e;if(Ua===e)if(Ua=w,Pc=Ma(),Pc!==e)if(ha(),Qc=ia(),ha(),Wb=c(),Wb!==e)if(ha(),Rc=Na(),Rc!==e){ka=Ua;var Je=Qc,Ke=Wb;Ua=Ia(f(),Je,Ke)}else w=Ua,Ua=e;else w=Ua,Ua=
e;else w=Ua,Ua=e;if(Ua!==e){ka=vb;var Le=Ua;vb={type:"function",location:f(),name:"trim",args:Le}}else w=vb,vb=e}else w=vb,vb=e;Ka=vb;if(Ka===e){var xb=w;var yb=w;var Sc=b.substr(w,8);Sc.toLowerCase()===Me?w+=8:(Sc=e,0===fa&&A(Ne));if(Sc!==e){var uc=w;fa++;var Oe=h();fa--;Oe===e?uc=void 0:(w=uc,uc=e);uc!==e?(ka=yb,yb="POSITION"):(w=yb,yb=e)}else w=yb,yb=e;if(yb!==e){ha();var Pa=w;var Tc=Ma();if(Tc!==e){ha();var Xb=c();if(Xb!==e){ha();var Uc=ba();if(Uc!==e){ha();var Yb=c();if(Yb!==e){ha();var Vc=Na();
if(Vc!==e){ka=Pa;var Pe=Xb,Qe=Yb;Pa=Ia(f(),Pe,Qe)}else w=Pa,Pa=e}else w=Pa,Pa=e}else w=Pa,Pa=e}else w=Pa,Pa=e}else w=Pa,Pa=e;if(Pa===e)if(Pa=w,Tc=Ma(),Tc!==e)if(ha(),Xb=c(),Xb!==e)if(ha(),Uc=Xa(),Uc!==e)if(ha(),Yb=c(),Yb!==e)if(ha(),Vc=Na(),Vc!==e){ka=Pa;var Re=Xb,Se=Yb;Pa=Ia(f(),Re,Se)}else w=Pa,Pa=e;else w=Pa,Pa=e;else w=Pa,Pa=e;else w=Pa,Pa=e;else w=Pa,Pa=e;if(Pa!==e){ka=xb;var Te=Pa;xb={type:"function",location:f(),name:"position",args:Te}}else w=xb,xb=e}else w=xb,xb=e;Ka=xb;if(Ka===e){var zb=
w;var Ab=w;var Wc=b.substr(w,4);Wc.toLowerCase()===Ue?w+=4:(Wc=e,0===fa&&A(Ve));if(Wc!==e){var vc=w;fa++;var We=h();fa--;We===e?vc=void 0:(w=vc,vc=e);vc!==e?(ka=Ab,Ab="CAST"):(w=Ab,Ab=e)}else w=Ab,Ab=e;if(Ab!==e){ha();var Qa=w;var Xc=Ma();if(Xc!==e){ha();var Zb=c();if(Zb!==e){ha();var Bb=w;var Yc=b.substr(w,2);Yc.toLowerCase()===Xe?w+=2:(Yc=e,0===fa&&A(Ye));if(Yc!==e){var wc=w;fa++;var Ze=h();fa--;Ze===e?wc=void 0:(w=wc,wc=e);wc!==e?(ka=Bb,Bb="AS"):(w=Bb,Bb=e)}else w=Bb,Bb=e;var Zc=Bb;if(Zc!==e){ha();
var $b=da();if($b!==e){ha();var $c=Na();if($c!==e){ka=Qa;var $e=Zb,af=$b;Qa=Ia(f(),$e,af)}else w=Qa,Qa=e}else w=Qa,Qa=e}else w=Qa,Qa=e}else w=Qa,Qa=e}else w=Qa,Qa=e;if(Qa===e)if(Qa=w,Xc=Ma(),Xc!==e)if(ha(),Zb=c(),Zb!==e)if(ha(),Zc=Xa(),Zc!==e)if(ha(),$b=da(),$b!==e)if(ha(),$c=Na(),$c!==e){ka=Qa;var bf=Zb,cf=$b;Qa=Ia(f(),bf,cf)}else w=Qa,Qa=e;else w=Qa,Qa=e;else w=Qa,Qa=e;else w=Qa,Qa=e;else w=Qa,Qa=e;if(Qa!==e){ka=zb;var df=Qa;zb={type:"function",location:f(),name:"cast",args:df}}else w=zb,zb=e}else w=
zb,zb=e;Ka=zb;if(Ka===e){var kb;var xc=kb=w;fa++;var yc=ea();fa--;yc===e?xc=void 0:(w=xc,xc=e);if(xc!==e){var eb=w;var ac=R();ac!==e&&(ka=eb);eb=ac;if(eb===e)if(eb=w,96===b.charCodeAt(w)?(ac=nd,w++):(ac=e,0===fa&&A(od)),ac!==e){var zc=[];var ib=b.charAt(w);pd.test(ib)?w++:(ib=e,0===fa&&A(qd));if(ib!==e)for(;ib!==e;)zc.push(ib),ib=b.charAt(w),pd.test(ib)?w++:(ib=e,0===fa&&A(qd));else zc=e;zc!==e?(96===b.charCodeAt(w)?(ib=nd,w++):(ib=e,0===fa&&A(od)),ib!==e?(ka=eb,eb=zc.join("")):(w=eb,eb=e)):(w=eb,
eb=e)}else w=eb,eb=e;yc=eb;if(yc!==e){ha();var rd=q();if(rd!==e){ka=kb;var ef=yc;kb={type:"function",location:f(),name:ef,args:rd}}else w=kb,kb=e}else w=kb,kb=e}else w=kb,kb=e;Ka=kb;if(Ka===e){var Za=w;var ad=Fa();if(ad!==e){ha();var bc=c();if(bc!==e){ha();var cc=[];var Va=w;var fb=Ja();if(fb!==e){var dc=ha();Va=fb}else w=Va,Va=e;for(;Va!==e;)cc.push(Va),Va=w,fb=Ja(),fb!==e?(dc=ha(),Va=fb):(w=Va,Va=e);Va=Ra();if(Va!==e){ka=Za;var ff=bc,gf=cc;Za={type:"case-expression",location:f(),format:"simple",
operand:ff,clauses:gf,else:null,elseLocation:null}}else w=Za,Za=e}else w=Za,Za=e}else w=Za,Za=e;if(Za===e)if(Za=w,ad=Fa(),ad!==e)if(ha(),bc=c(),bc!==e){ha();cc=[];Va=w;fb=Ja();fb!==e?(dc=ha(),Va=fb):(w=Va,Va=e);for(;Va!==e;)cc.push(Va),Va=w,fb=Ja(),fb!==e?(dc=ha(),Va=fb):(w=Va,Va=e);Va=Sa();if(Va!==e)if(fb=ha(),dc=Ra(),dc!==e){ka=Za;var hf=bc,jf=cc,sd=Va;Za={type:"case-expression",location:f(),format:"simple",operand:hf,clauses:jf,else:sd.value,elseLocation:sd.location}}else w=Za,Za=e;else w=Za,Za=
e}else w=Za,Za=e;else w=Za,Za=e;var bd=Za;if(bd===e){var $a=w;var cd=Fa();if(cd!==e){ha();var ec=[];var Wa=w;var gb=Ea();if(gb!==e){var fc=ha();Wa=gb}else w=Wa,Wa=e;for(;Wa!==e;)ec.push(Wa),Wa=w,gb=Ea(),gb!==e?(fc=ha(),Wa=gb):(w=Wa,Wa=e);Wa=Ra();if(Wa!==e){ka=$a;var kf=ec;$a={type:"case-expression",location:f(),format:"searched",clauses:kf,else:null,elseLocation:null}}else w=$a,$a=e}else w=$a,$a=e;if($a===e)if($a=w,cd=Fa(),cd!==e){ha();ec=[];Wa=w;gb=Ea();gb!==e?(fc=ha(),Wa=gb):(w=Wa,Wa=e);for(;Wa!==
e;)ec.push(Wa),Wa=w,gb=Ea(),gb!==e?(fc=ha(),Wa=gb):(w=Wa,Wa=e);Wa=Sa();if(Wa!==e)if(gb=ha(),fc=Ra(),fc!==e){ka=$a;var lf=ec,td=Wa;$a={type:"case-expression",location:f(),format:"searched",clauses:lf,else:td.value,elseLocation:td.location}}else w=$a,$a=e;else w=$a,$a=e}else w=$a,$a=e;bd=$a}Ka=bd;if(Ka===e){var Cb=w;var mf=w;var Ac;var gc=w;var ud=k();if(ud!==e){var vd=[];for(Ac=t();Ac!==e;)vd.push(Ac),Ac=t();ka=gc;gc=ud+vd.join("")}else w=gc,gc=e;var wd=gc;wd!==e&&(ka=mf);var lb=wd;if(lb!==e){ka=Cb;
var hc=lb;lb=/^CURRENT_DATE$/i.test(hc)?{type:"current-time",location:f(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(hc)?{type:"current-time",location:f(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(hc)?{type:"current-time",location:f(),mode:"time"}:/^CURRENT_USER$/i.test(hc)?{type:"current-user",location:f()}:{type:"column-reference",location:f(),table:"",column:hc}}Cb=lb;if(Cb===e){Cb=w;var Db=w;if(U()!==e){var Bc;var nf=w;var dd=[];for(Bc=J();Bc!==e;)dd.push(Bc),Bc=J();ka=nf;var of=dd=dd.join("");var pf=
U();pf!==e?(ka=Db,Db=of):(w=Db,Db=e)}else w=Db,Db=e;lb=Db;if(lb!==e){ka=Cb;var qf=lb;lb={type:"column-reference",location:f(),table:"",column:qf,delimited:!0}}Cb=lb}Ka=Cb;if(Ka===e&&(Ka=Y(),Ka===e)){Ka=w;var rf=Ma();if(rf!==e){ha();var ed=c();if(ed!==e){ha();var sf=Na();sf!==e?(ka=Ka,ed.paren=!0,Ka=ed):(w=Ka,Ka=e)}else w=Ka,Ka=e}else w=Ka,Ka=e}}}}}}}}}return Ka}function R(){var K;var M=w;var V=k();if(V!==e){var Z=[];for(K=h();K!==e;)Z.push(K),K=h();ka=M;M=V+Z.join("")}else w=M,M=e;return M}function k(){var K=
b.charAt(w);tf.test(K)?w++:(K=e,0===fa&&A(uf));return K}function h(){var K=b.charAt(w);vf.test(K)?w++:(K=e,0===fa&&A(wf));return K}function t(){var K=b.charAt(w);xd.test(K)?w++:(K=e,0===fa&&A(yd));return K}function J(){var K=b.charAt(w);xd.test(K)?w++:(K=e,0===fa&&A(yd));if(K===e)if(K=w,U()!==e){var M=U();M!==e?(ka=K,K='"'):(w=K,K=e)}else w=K,K=e;return K}function U(){var K=b.charAt(w);xf.test(K)?w++:(K=e,0===fa&&A(yf));return K}function Y(){var K;var M=K=w;if(64===b.charCodeAt(w)){var V=zf;w++}else V=
e,0===fa&&A(Af);if(V!==e){var Z=R();Z!==e?M=V=[V,Z]:(w=M,M=e)}else w=M,M=e;M!==e&&(ka=K,K=M,M={type:"parameter",location:f(),value:K[1]});return M}function da(){var K=w;var M=w;var V=b.substr(w,7);V.toLowerCase()===Bf?w+=7:(V=e,0===fa&&A(Cf));if(V!==e){V=w;fa++;var Z=h();fa--;Z===e?V=void 0:(w=V,V=e);V!==e?(ka=M,M="INTEGER"):(w=M,M=e)}else w=M,M=e;M===e&&(M=w,V=b.substr(w,3),V.toLowerCase()===Df?w+=3:(V=e,0===fa&&A(Ef)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="INT"):(w=M,
M=e)):(w=M,M=e));M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"integer"}});K=M;K===e&&(M=K=w,V=b.substr(w,8),V.toLowerCase()===Ff?w+=8:(V=e,0===fa&&A(Gf)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="SMALLINT"):(w=M,M=e)):(w=M,M=e),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"smallint"}}),K=M,K===e&&(M=K=w,V=b.substr(w,5),V.toLowerCase()===Hf?w+=5:(V=e,0===fa&&A(If)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="FLOAT"):(w=M,M=
e)):(w=M,M=e),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"float"}}),K=M,K===e&&(M=K=w,V=b.substr(w,4),V.toLowerCase()===Jf?w+=4:(V=e,0===fa&&A(Kf)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="REAL"):(w=M,M=e)):(w=M,M=e),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"real"}}),K=M,K===e&&(K=w,M=ma(),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"date"}}),K=M,K===e&&(K=w,M=la(),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"timestamp"}}),
K=M,K===e&&(K=w,M=ua(),M!==e&&(ka=K,M={type:"data-type",location:f(),value:{type:"time"}}),K=M,K===e&&(M=K=w,V=b.substr(w,7),V.toLowerCase()===Lf?w+=7:(V=e,0===fa&&A(Mf)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="VARCHAR"):(w=M,M=e)):(w=M,M=e),M!==e?(ha(),M=Ma(),M!==e?(ha(),M=O(),M!==e?(ha(),V=Na(),V!==e?(ka=K,K={type:"data-type",location:f(),value:{type:"varchar",size:parseInt(M)}}):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e))))))));return K}function ia(){var K=w;var M=w;
var V=b.substr(w,7);V.toLowerCase()===Nf?w+=7:(V=e,0===fa&&A(Of));if(V!==e){V=w;fa++;var Z=h();fa--;Z===e?V=void 0:(w=V,V=e);V!==e?(ka=M,M="LEADING"):(w=M,M=e)}else w=M,M=e;M===e&&(M=w,V=b.substr(w,8),V.toLowerCase()===Pf?w+=8:(V=e,0===fa&&A(Qf)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="TRAILING"):(w=M,M=e)):(w=M,M=e),M===e&&(M=w,V=b.substr(w,4),V.toLowerCase()===Rf?w+=4:(V=e,0===fa&&A(Sf)),V!==e?(V=w,fa++,Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="BOTH"):(w=M,M=
e)):(w=M,M=e)));M===e&&(M=null);ka=K;K=M;return M={type:"string",location:f(),value:null==K?"BOTH":K}}function na(){var K=w;var M=ra();if(M===e&&(M=Ba(),M===e&&(M=ya(),M===e&&(M=Aa(),M===e&&(M=Ca(),M===e&&(M=za(),M===e)))))){M=w;var V=b.substr(w,13);V.toLowerCase()===Tf?w+=13:(V=e,0===fa&&A(Uf));if(V!==e){V=w;fa++;var Z=h();fa--;Z===e?V=void 0:(w=V,V=e);V!==e?(ka=M,M="TIMEZONE_HOUR"):(w=M,M=e)}else w=M,M=e;M===e&&(M=w,V=b.substr(w,15),V.toLowerCase()===Vf?w+=15:(V=e,0===fa&&A(Wf)),V!==e?(V=w,fa++,
Z=h(),fa--,Z===e?V=void 0:(w=V,V=e),V!==e?(ka=M,M="TIMEZONE_MINUTE"):(w=M,M=e)):(w=M,M=e))}M!==e&&(ka=K,K=M,M={type:"string",location:f(),value:K});return M}function oa(){var K=w;var M=w;var V=pa();if(V!==e){ha();var Z=Ma();if(Z!==e)if(ha(),Z=wa(),Z!==e){ha();var ta=Na();ta!==e?(ka=M,M=V,M={type:"interval-period",location:f(),period:M.value,precision:Z,secondary:null}):(w=M,M=e)}else w=M,M=e;else w=M,M=e}else w=M,M=e;M===e&&(M=w,V=pa(),V!==e&&(ka=M,M=V,V={type:"interval-period",location:f(),period:M.value,
precision:null,secondary:null}),M=V);if(M!==e)if(ha(),V=w,Z=b.substr(w,2),Z.toLowerCase()===Xf?w+=2:(Z=e,0===fa&&A(Yf)),Z!==e?(Z=w,fa++,ta=h(),fa--,ta===e?Z=void 0:(w=Z,Z=e),Z!==e?(ka=V,V="TO"):(w=V,V=e)):(w=V,V=e),V!==e){ha();V=w;Z=pa();Z!==e&&(ka=V,V=Z,Z={type:"interval-period",location:f(),period:V.value,precision:null,secondary:null});V=Z;if(V===e){V=w;Z=za();if(Z!==e)if(ha(),Z=Ma(),Z!==e)if(ha(),Z=wa(),Z!==e)if(ha(),ta=Xa(),ta!==e)if(ha(),ta=sa(),ta!==e){ha();var va=Na();va!==e?(ka=V,V=Z,V={type:"interval-period",
location:f(),period:"second",precision:V,secondary:ta}):(w=V,V=e)}else w=V,V=e;else w=V,V=e;else w=V,V=e;else w=V,V=e;else w=V,V=e;V===e&&(V=w,Z=za(),Z!==e?(ha(),Z=Ma(),Z!==e?(ha(),Z=wa(),Z!==e?(ha(),ta=Na(),ta!==e?(ka=V,V=Z,V={type:"interval-period",location:f(),period:"second",precision:V,secondary:null}):(w=V,V=e)):(w=V,V=e)):(w=V,V=e)):(w=V,V=e),V===e&&(V=w,Z=za(),Z!==e&&(ka=V,Z={type:"interval-period",location:f(),period:"second",precision:null,secondary:null}),V=Z))}V!==e?(ka=K,K={type:"interval-qualifier",
location:f(),start:M,end:V}):(w=K,K=e)}else w=K,K=e;else w=K,K=e;K===e&&(K=w,V=pa(),V!==e?(ha(),M=Ma(),M!==e?(ha(),M=sa(),M!==e?(ha(),Z=Na(),Z!==e?(ka=K,K=V,K={type:"interval-period",location:f(),period:K.value,precision:M,secondary:null}):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e),K===e&&(K=w,V=pa(),V!==e&&(ka=K,K=V,V={type:"interval-period",location:f(),period:K.value,precision:null,secondary:null}),K=V,K===e&&(K=w,V=za(),V!==e?(ha(),M=Ma(),M!==e?(ha(),M=wa(),M!==e?(ha(),Z=Xa(),Z!==e?(ha(),V=sa(),
V!==e?(ha(),Z=Na(),Z!==e?(ka=K,K=M,K={type:"interval-period",location:f(),period:"second",precision:K,secondary:V}):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e),K===e&&(K=w,V=za(),V!==e?(ha(),M=Ma(),M!==e?(ha(),M=sa(),M!==e?(ha(),Z=Na(),Z!==e?(ka=K,K=M,K={type:"interval-period",location:f(),period:"second",precision:K,secondary:null}):(w=K,K=e)):(w=K,K=e)):(w=K,K=e)):(w=K,K=e),K===e&&(K=w,V=za(),V!==e&&(ka=K,V={type:"interval-period",location:f(),period:"second",precision:null,
secondary:null}),K=V)))));return K}function pa(){var K=w;var M=ya();M!==e&&(ka=K,M={type:"string",location:f(),value:"day"});K=M;K===e&&(K=w,M=Aa(),M!==e&&(ka=K,M={type:"string",location:f(),value:"hour"}),K=M,K===e&&(K=w,M=Ca(),M!==e&&(ka=K,M={type:"string",location:f(),value:"minute"}),K=M,K===e&&(K=w,M=Ba(),M!==e&&(ka=K,M={type:"string",location:f(),value:"month"}),K=M,K===e&&(K=w,M=ra(),M!==e&&(ka=K,M={type:"string",location:f(),value:"year"}),K=M))));return K}function sa(){var K=w;var M=O();
M!==e&&(ka=K,M=parseFloat(M));return M}function wa(){var K=w;var M=O();M!==e&&(ka=K,M=parseFloat(M));return M}function xa(){var K=Da();K===e&&(K=Y());return K}function Da(){var K=w;if(39===b.charCodeAt(w)){var M=zd;w++}else M=e,0===fa&&A(Ad);M===e&&(b.substr(w,2)===Bd?(M=Bd,w+=2):(M=e,0===fa&&A(Zf)));if(M!==e){M=[];var V=w;if(b.substr(w,2)===Cc){var Z=Cc;w+=2}else Z=e,0===fa&&A(Cd);Z!==e&&(ka=V,Z="'");V=Z;V===e&&(V=b.charAt(w),Dd.test(V)?w++:(V=e,0===fa&&A(Ed)));for(;V!==e;)M.push(V),V=w,b.substr(w,
2)===Cc?(Z=Cc,w+=2):(Z=e,0===fa&&A(Cd)),Z!==e&&(ka=V,Z="'"),V=Z,V===e&&(V=b.charAt(w),Dd.test(V)?w++:(V=e,0===fa&&A(Ed)));39===b.charCodeAt(w)?(V=zd,w++):(V=e,0===fa&&A(Ad));V!==e?(ka=K,K={type:"string",location:f(),value:M.join("")}):(w=K,K=e)}else w=K,K=e;return K}function Ea(){var K=w;if(bb()!==e){ha();var M=c();if(M!==e){ha();var V=cb();V!==e?(ha(),V=c(),V!==e?(ka=K,K={type:"when-clause",location:f(),operand:M,value:V}):(w=K,K=e)):(w=K,K=e)}else w=K,K=e}else w=K,K=e;return K}function Ja(){var K=
w;if(bb()!==e){ha();var M=c();if(M!==e){ha();var V=cb();V!==e?(ha(),V=c(),V!==e?(ka=K,K={type:"when-clause",location:f(),operand:M,value:V}):(w=K,K=e)):(w=K,K=e)}else w=K,K=e}else w=K,K=e;return K}function Sa(){var K=w;var M=w;var V=b.substr(w,4);V.toLowerCase()===$f?w+=4:(V=e,0===fa&&A(ag));if(V!==e){V=w;fa++;var Z=h();fa--;Z===e?V=void 0:(w=V,V=e);V!==e?(ka=M,M="ELSE"):(w=M,M=e)}else w=M,M=e;M!==e?(ha(),M=c(),M!==e?(ka=K,K={type:"else-clause",location:f(),value:M}):(w=K,K=e)):(w=K,K=e);return K}
function ab(){var K=O();if(K===e){K=w;var M=b.charAt(w);kc.test(M)?w++:(M=e,0===fa&&A(lc));if(M!==e){var V=O();V!==e?(ka=K,K=M[0]+V):(w=K,K=e)}else w=K,K=e}return K}function La(){var K=w;if(46===b.charCodeAt(w)){var M=bg;w++}else M=e,0===fa&&A(cg);M!==e?(M=O(),M===e&&(M=null),ka=K,K="."+(null!=M?M:"")):(w=K,K=e);return K}function u(){var K;var M=K=w;var V=b.charAt(w);dg.test(V)?w++:(V=e,0===fa&&A(eg));V!==e?(V=b.charAt(w),kc.test(V)?w++:(V=e,0===fa&&A(lc)),V===e&&(V=null),ka=M,M="e"+(null===V?"":
V)):(w=M,M=e);M!==e?(V=O(),V!==e?(ka=K,K=M+V):(w=K,K=e)):(w=K,K=e);return K}function O(){var K=w;var M=[];var V=X();if(V!==e)for(;V!==e;)M.push(V),V=X();else M=e;M!==e&&(ka=K,M=M.join(""));return M}function X(){var K=b.charAt(w);fg.test(K)?w++:(K=e,0===fa&&A(gg));return K}function ba(){var K=w;var M=b.substr(w,2);M.toLowerCase()===hg?w+=2:(M=e,0===fa&&A(ig));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="IN"):(w=K,K=e)}else w=K,K=e;return K}function ja(){var K=w;var M=b.substr(w,
2);M.toLowerCase()===jg?w+=2:(M=e,0===fa&&A(kg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="IS"):(w=K,K=e)}else w=K,K=e;return K}function L(){var K=w;var M=b.substr(w,4);M.toLowerCase()===lg?w+=4:(M=e,0===fa&&A(mg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="LIKE"):(w=K,K=e)}else w=K,K=e;return K}function P(){var K=w;var M=b.substr(w,3);M.toLowerCase()===ng?w+=3:(M=e,0===fa&&A(og));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,
M=e);M!==e?(ka=K,K="NOT"):(w=K,K=e)}else w=K,K=e;return K}function S(){var K=w;var M=b.substr(w,3);M.toLowerCase()===pg?w+=3:(M=e,0===fa&&A(qg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="AND"):(w=K,K=e)}else w=K,K=e;return K}function W(){var K=w;var M=b.substr(w,2);M.toLowerCase()===rg?w+=2:(M=e,0===fa&&A(sg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="OR"):(w=K,K=e)}else w=K,K=e;return K}function aa(){var K=w;var M=b.substr(w,7);M.toLowerCase()===
tg?w+=7:(M=e,0===fa&&A(ug));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="BETWEEN"):(w=K,K=e)}else w=K,K=e;return K}function ca(){var K=w;var M=b.substr(w,4);M.toLowerCase()===vg?w+=4:(M=e,0===fa&&A(wg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="FROM"):(w=K,K=e)}else w=K,K=e;return K}function ea(){var K=w;var M=b.substr(w,7);M.toLowerCase()===xg?w+=7:(M=e,0===fa&&A(yg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=
K,K="EXTRACT"):(w=K,K=e)}else w=K,K=e;return K}function la(){var K=w;var M=b.substr(w,9);M.toLowerCase()===zg?w+=9:(M=e,0===fa&&A(Ag));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="TIMESTAMP"):(w=K,K=e)}else w=K,K=e;return K}function ma(){var K=w;var M=b.substr(w,4);M.toLowerCase()===Bg?w+=4:(M=e,0===fa&&A(Cg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="DATE"):(w=K,K=e)}else w=K,K=e;return K}function ua(){var K=w;var M=b.substr(w,4);M.toLowerCase()===
Dg?w+=4:(M=e,0===fa&&A(Eg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="TIME"):(w=K,K=e)}else w=K,K=e;return K}function qa(){var K=w;var M=b.substr(w,8);M.toLowerCase()===Fg?w+=8:(M=e,0===fa&&A(Gg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="INTERVAL"):(w=K,K=e)}else w=K,K=e;return K}function ra(){var K=w;var M=b.substr(w,4);M.toLowerCase()===Hg?w+=4:(M=e,0===fa&&A(Ig));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=
K,K="YEAR"):(w=K,K=e)}else w=K,K=e;return K}function Ba(){var K=w;var M=b.substr(w,5);M.toLowerCase()===Jg?w+=5:(M=e,0===fa&&A(Kg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="MONTH"):(w=K,K=e)}else w=K,K=e;return K}function ya(){var K=w;var M=b.substr(w,3);M.toLowerCase()===Lg?w+=3:(M=e,0===fa&&A(Mg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="DAY"):(w=K,K=e)}else w=K,K=e;return K}function Aa(){var K=w;var M=b.substr(w,4);M.toLowerCase()===
Ng?w+=4:(M=e,0===fa&&A(Og));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="HOUR"):(w=K,K=e)}else w=K,K=e;return K}function Ca(){var K=w;var M=b.substr(w,6);M.toLowerCase()===Pg?w+=6:(M=e,0===fa&&A(Qg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="MINUTE"):(w=K,K=e)}else w=K,K=e;return K}function za(){var K=w;var M=b.substr(w,6);M.toLowerCase()===Rg?w+=6:(M=e,0===fa&&A(Sg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=
K,K="SECOND"):(w=K,K=e)}else w=K,K=e;return K}function Fa(){var K=w;var M=b.substr(w,4);M.toLowerCase()===Tg?w+=4:(M=e,0===fa&&A(Ug));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="CASE"):(w=K,K=e)}else w=K,K=e;return K}function Ra(){var K=w;var M=b.substr(w,3);M.toLowerCase()===Vg?w+=3:(M=e,0===fa&&A(Wg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="END"):(w=K,K=e)}else w=K,K=e;return K}function bb(){var K=w;var M=b.substr(w,4);M.toLowerCase()===
Xg?w+=4:(M=e,0===fa&&A(Yg));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="WHEN"):(w=K,K=e)}else w=K,K=e;return K}function cb(){var K=w;var M=b.substr(w,4);M.toLowerCase()===Zg?w+=4:(M=e,0===fa&&A($g));if(M!==e){M=w;fa++;var V=h();fa--;V===e?M=void 0:(w=M,M=e);M!==e?(ka=K,K="THEN"):(w=K,K=e)}else w=K,K=e;return K}function Xa(){if(44===b.charCodeAt(w)){var K=ah;w++}else K=e,0===fa&&A(bh);return K}function Ma(){if(40===b.charCodeAt(w)){var K=ch;w++}else K=e,0===fa&&A(dh);
return K}function Na(){if(41===b.charCodeAt(w)){var K=eh;w++}else K=e,0===fa&&A(fh);return K}function ha(){var K;var M=[];for(K=ic();K!==e;)M.push(K),K=ic();return M}function ic(){var K=b.charAt(w);gh.test(K)?w++:(K=e,0===fa&&A(hh));return K}function Kb(K,M,V,Z,ta){K={type:"binary-expression",location:ta,operator:K,left:M,right:V};void 0!==Z&&(K.escape=Z);return K}function Ia(K,...M){return{type:"expression-list",location:K,value:M}}function Ib(K,M){for(const {op:V,expr:Z,location:{end:ta}}of M)K=
Kb(V,K,Z,void 0,{...K.location,end:ta});return K}m=void 0!==m?m:{};var e={},Hd=m.grammarSource,Fd={start:F},Gd=F,Id="!",Kd="\x3d",fd="\x3e\x3d",Pd="\x3e",gd="\x3c\x3d",hd="\x3c\x3e",id="!\x3d",jd="||",zf="@",zd="'",Bd="N'",Cc="''",bg=".",fe="null",Zd="true",be="false",hg="in",jg="is",lg="like",Md="escape",ng="not",pg="and",rg="or",tg="between",vg="from",ue="for",re="substring",xg="extract",De="trim",Me="position",zg="timestamp",Bg="date",Dg="time",Nf="leading",Pf="trailing",Rf="both",Ue="cast",Xe=
"as",Bf="integer",Df="int",Ff="smallint",Hf="float",Jf="real",Lf="varchar",Xf="to",Fg="interval",Hg="year",Tf="timezone_hour",Vf="timezone_minute",Jg="month",Lg="day",Ng="hour",Pg="minute",Rg="second",Tg="case",Vg="end",Xg="when",Zg="then",$f="else",ah=",",ch="(",eh=")",nd="`",Td=/^[<-=]/,kc=/^[+\-]/,Xd=/^[*\/]/,tf=/^[A-Za-z_\x80-\uFFFF]/,vf=/^[A-Za-z0-9_]/,xd=/^[A-Za-z0-9_.\x80-\uFFFF]/,xf=/^["]/,Dd=/^[^']/,fg=/^[0-9]/,dg=/^[eE]/,gh=/^[ \t\n\r]/,pd=/^[^`]/,Jd=x("!",!1),Ld=x("\x3d",!1),Od=x("\x3e\x3d",
!1),Qd=x("\x3e",!1),Rd=x("\x3c\x3d",!1),Sd=x("\x3c\x3e",!1),Ud=B([["\x3c","\x3d"]],!1,!1),Vd=x("!\x3d",!1),lc=B(["+","-"],!1,!1),Wd=x("||",!1),Yd=B(["*","/"],!1,!1),uf=B([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),wf=B([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),yd=B([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),yf=B(['"'],!1,!1),Af=x("@",!1),Ad=x("'",!1),Zf=x("N'",!1),Cd=x("''",!1),Ed=B(["'"],!0,!1),cg=x(".",!1),gg=B([["0","9"]],!1,!1),eg=B(["e","E"],!1,!1),ge=x("NULL",
!0),$d=x("TRUE",!0),ce=x("FALSE",!0),ig=x("IN",!0),kg=x("IS",!0),mg=x("LIKE",!0),Nd=x("ESCAPE",!0),og=x("NOT",!0),qg=x("AND",!0),sg=x("OR",!0),ug=x("BETWEEN",!0),wg=x("FROM",!0),ve=x("FOR",!0),se=x("SUBSTRING",!0),yg=x("EXTRACT",!0),Ee=x("TRIM",!0),Ne=x("POSITION",!0),Ag=x("TIMESTAMP",!0),Cg=x("DATE",!0),Eg=x("TIME",!0),Of=x("LEADING",!0),Qf=x("TRAILING",!0),Sf=x("BOTH",!0),Ve=x("CAST",!0),Ye=x("AS",!0),Cf=x("INTEGER",!0),Ef=x("INT",!0),Gf=x("SMALLINT",!0),If=x("FLOAT",!0),Kf=x("REAL",!0),Mf=x("VARCHAR",
!0),Yf=x("TO",!0),Gg=x("INTERVAL",!0),Ig=x("YEAR",!0),Uf=x("TIMEZONE_HOUR",!0),Wf=x("TIMEZONE_MINUTE",!0),Kg=x("MONTH",!0),Mg=x("DAY",!0),Og=x("HOUR",!0),Qg=x("MINUTE",!0),Sg=x("SECOND",!0),Ug=x("CASE",!0),Wg=x("END",!0),Yg=x("WHEN",!0),$g=x("THEN",!0),ag=x("ELSE",!0),bh=x(",",!1),dh=x("(",!1),fh=x(")",!1),hh=B([" ","\t","\n","\r"],!1,!1),od=x("`",!1),qd=B(["`"],!0,!1),w=m.peg$currPos|0,ka=w,Eb=[{line:1,column:1}],hb=w,jc=m.peg$maxFailExpected||[],fa=m.peg$silentFails|0;if(m.startRule){if(!(m.startRule in
Fd))throw Error("Can't start parsing from rule \""+m.startRule+'".');Gd=Fd[m.startRule]}var Dc=Gd();if(m.peg$library)return{peg$result:Dc,peg$currPos:w,peg$FAILED:e,peg$maxFailExpected:jc,peg$maxFailPos:hb};if(Dc!==e&&w===b.length)return Dc;Dc!==e&&w<b.length&&A({type:"end"});throw function(K,M,V){return new d(d.buildMessage(K,M),K,M,V)}(jc,hb<b.length?b.charAt(hb):null,hb<b.length?p(hb,hb+1):p(hb,hb));}function r(b,m){if(null!=b)switch(m(b),b.type){case "when-clause":r(b.operand,m);r(b.value,m);
break;case "case-expression":for(const f of b.clauses)r(f,m);"simple"===b.format&&r(b.operand,m);null!==b.else&&r(b.else,m);break;case "expression-list":for(const f of b.value)r(f,m);break;case "unary-expression":r(b.expr,m);break;case "binary-expression":r(b.left,m);r(b.right,m);break;case "function":r(b.args,m);break;case "interval":r(b.value,m);r(b.qualifier,m);break;case "interval-qualifier":r(b.start,m),r(b.end,m)}}(function(b,m){function f(){this.constructor=b}f.prototype=m.prototype;b.prototype=
new f})(d,Error);d.prototype.format=function(b){var m="Error: "+this.message;if(this.location){var f=null,v;for(v=0;v<b.length;v++)if(b[v].source===this.location.source){f=b[v].text.split(/\r\n|\n|\r/g);break}b=this.location.start;v=this.location.source&&"function"===typeof this.location.source.offset?this.location.source.offset(b):b;var x=this.location.source+":"+v.line+":"+v.column;if(f){var B=this.location.end,D=n("",v.line.toString().length," ");f=f[b.line-1];B=(b.line===B.line?B.column:f.length+
1)-b.column||1;m+="\n --\x3e "+x+"\n"+D+" |\n"+v.line+" | "+f+"\n"+D+" | "+n("",b.column-1," ")+n("",B,"^")}else m+="\n at "+x}return m};d.buildMessage=function(b,m){function f(p){return p.charCodeAt(0).toString(16).toUpperCase()}function v(p){return p.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+f(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+f(A)})}function x(p){return p.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(A){return"\\x0"+f(A)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(A){return"\\x"+f(A)})}function B(p){return D[p.type](p)}var D={literal:function(p){return'"'+v(p.text)+'"'},class:function(p){var A=p.parts.map(function(F){return Array.isArray(F)?x(F[0])+"-"+x(F[1]):x(F)});return"["+(p.inverted?"^":"")+A.join("")+"]"},
any:function(){return"any character"},end:function(){return"end of input"},other:function(p){return p.description}};return"Expected "+function(p){p=p.map(B);var A,F;p.sort();if(0<p.length){for(F=A=1;A<p.length;A++)p[A-1]!==p[A]&&(p[F]=p[A],F++);p.length=F}switch(p.length){case 1:return p[0];case 2:return p[0]+" or "+p[1];default:return p.slice(0,-1).join(", ")+", or "+p[p.length-1]}}(b)+" but "+(m?'"'+v(m)+'"':"end of input")+" found."};class G{static parse(b){return z(b)}}a.WhereGrammar=G;a.visitAll=
r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/fieldType":function(){define(["exports","../../core/jsonMap"],function(a,d){d=new d.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",
esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});a.kebabDict=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/projectionSupport":function(){define("exports ../../../core/arrayUtils ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/geometryAdapters/json ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(a,d,n,z,r,G,b){function m(F,q){if(!q)return null;if("x"in q){var c={x:0,y:0};[c.x,c.y]=F(q.x,q.y,x);null!=q.z&&(c.z=q.z);null!=q.m&&(c.m=q.m);return c}return"xmin"in q?(c={xmin:0,ymin:0,xmax:0,ymax:0},[c.xmin,c.ymin]=F(q.xmin,q.ymin,x),[c.xmax,c.ymax]=F(q.xmax,q.ymax,x),q.hasZ&&(c.zmin=q.zmin,c.zmax=q.zmax,c.hasZ=!0),q.hasM&&(c.mmin=q.mmin,c.mmax=q.mmax,c.hasM=!0),c):"rings"in q?{rings:f(q.rings,F),hasM:q.hasM,hasZ:q.hasZ}:"paths"in q?{paths:f(q.paths,F),hasM:q.hasM,hasZ:q.hasZ}:"points"in
q?{points:v(q.points,F),hasM:q.hasM,hasZ:q.hasZ}:null}function f(F,q){const c=[];for(const l of F)c.push(v(l,q));return c}function v(F,q){const c=[];for(const l of F)F=q(l[0],l[1],[0,0]),c.push(F),2<l.length&&F.push(l[2]),3<l.length&&F.push(l[3]);return c}const x=[0,0],B=m.bind(null,b.lngLatToXY),D=m.bind(null,b.xyToLngLat);class p{constructor(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}async push(F,q,c,l){if(!F?.length||!q||!c||G.equals(q,c))return F;F={geometries:F,inSpatialReference:q,
outSpatialReference:c,geographicTransformation:l,resolve:n.createResolver()};this._jobs.push(F);this._timer??(this._timer=setTimeout(this._process,10));return F.resolve.promise}_process(){this._timer=null;const F=this._jobs.shift();if(F){var {geometries:q,inSpatialReference:c,outSpatialReference:l,resolve:H,geographicTransformation:g}=F;b.canProject(c,l)?G.isWebMercator(l)?H(q.map(B)):H(q.map(D)):H(z.projectMany(r.jsonAdapter,q,c,l,g,null));0<this._jobs.length&&(this._timer=setTimeout(this._process,
10))}}}const A=new p;a.checkProjectionSupport=async function(F,q){F&&q&&(F=Array.isArray(F)?F.map(c=>null!=c.geometry?c.geometry.spatialReference:null).filter(d.isSome):[F],await z.initializeProjection(F.map(c=>({source:c,dest:q}))))};a.project=function(F,q,c,l){if(!F)return F;c||(c=q,q=F.spatialReference);return G.isValid(q)&&G.isValid(c)&&!G.equals(q,c)?b.canProject(q,c)?(F=G.isWebMercator(c)?B(F):D(F),F.spatialReference=c,F):z.projectMany(r.jsonAdapter,[F],q,c,null,l)[0]:F};a.projectMany=function(F,
q,c,l){return A.push(F,q,c,l)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/geometryAdapters/json":function(){define(["exports"],function(a){class d{constructor(b,m,f){this.x=b;this.y=m;this.spatialReference=f;this.m=this.z=void 0}}class n{constructor(b,m,f,v){this.rings=b;this.spatialReference=m;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);v&&(this.hasM=v)}}class z{constructor(b,m,f,v){this.paths=b;this.spatialReference=m;this.hasM=this.hasZ=void 0;f&&(this.hasZ=
f);v&&(this.hasM=v)}}class r{constructor(b,m,f,v){this.points=b;this.spatialReference=m;this.hasM=this.hasZ=void 0;f&&(this.hasZ=f);v&&(this.hasM=v)}}class G{constructor(b,m,f,v,x){this.xmin=b;this.ymin=m;this.xmax=f;this.ymax=v;this.spatialReference=x;this.mmax=this.mmin=this.zmax=this.zmin=void 0}}a.jsonAdapter={convertToGEGeometry:function(b,m){return null==m?null:b.convertJSONToGeometry(m)},exportPoint:function(b,m,f){f=new d(b.getPointX(m),b.getPointY(m),f);const v=b.hasZ(m),x=b.hasM(m);v&&(f.z=
b.getPointZ(m));x&&(f.m=b.getPointM(m));return f},exportPolygon:function(b,m,f){return new n(b.exportPaths(m),f,b.hasZ(m),b.hasM(m))},exportPolyline:function(b,m,f){return new z(b.exportPaths(m),f,b.hasZ(m),b.hasM(m))},exportMultipoint:function(b,m,f){return new r(b.exportPoints(m),f,b.hasZ(m),b.hasM(m))},exportExtent:function(b,m,f){var v=b.hasZ(m);const x=b.hasM(m);f=new G(b.getXMin(m),b.getYMin(m),b.getXMax(m),b.getYMax(m),f);v&&(v=b.getZExtent(m),f.zmin=v.vmin,f.zmax=v.vmax);x&&(b=b.getMExtent(m),
f.mmin=b.vmin,f.mmax=b.vmax);return f}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCache":function(){define(["exports"],function(a){class d{constructor(){this._storage=new Map;this._purgeInterval=5;this._sweep=()=>{this._timer=void 0;if(this._storage){var r=1E3*this._purgeInterval,G=performance.now()-r;for(const [b,m]of this._storage)if(m.time<G)this._storage.delete(b);else{0<this._storage.size&&(this._timer=setTimeout(this._sweep,r));break}}}}destroy(){this._storage?.clear();
this._storage=null;clearTimeout(this._timer)}get size(){return this._storage?.size??0}put(r,G){this._storage?.set(r,new z(G));this._scheduleSweep()}get(r){if(this._storage){var G=this._storage?.get(r);if(G)return this._storage?.delete(r),G.time=performance.now(),this._storage?.set(r,G),G.items}}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??(this._timer=setTimeout(this._sweep,1E3*this._purgeInterval)))}}let n=0;class z{constructor(r){this.items=r;this.time=performance.now();
this.id=n++}}a.QueryEngineCache=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["exports"],function(a){a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,
maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/lang ../../../geometry/support/centroid ../../../geometry/support/extentUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ./AttributesBuilder ./geometryUtils ./projectionSupport ./SnappingCandidate ../../support/fieldUtils ../../../statistics/utils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D){function p(c,l,H,g){const I=g.x-H.x;g=g.y-H.y;l=Math.min(1,Math.max(0,((l.x-H.x)*I+(l.y-H.y)*g)/(I*I+g*g)));c.x=H.x+I*l;c.y=H.y+g*l}function A(c,l){return c?l?4:3:l?3:2}class F{constructor(c,l,H){this.items=c;this.query=l;this.geometryType=H.geometryType;this.hasM=H.hasM;this.hasZ=H.hasZ;this.fieldsIndex=H.fieldsIndex;this.objectIdField=H.objectIdField;this.spatialReference=H.spatialReference;this.featureAdapter=H.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const c=
new m(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return c.countDistinctValues(this.items);const {groupByFieldsForStatistics:l,having:H,outStatistics:g}=this.query;if(!l?.length)return 1;const I=new Map,E=new Map,C=new Set;for(const T of g){var {statisticType:N}=T;N="exceedslimit"!==N?T.onStatisticField:void 0;if(!E.has(N)){var Q=[];for(const y of l){const R=this._getAttributeValues(c,y,I);Q.push(R)}E.set(N,this._calculateUniqueValues(Q,c.returnDistinctValues))}N=
E.get(N);for(const y in N){const {data:R,items:k}=N[y];Q=R.join(",");H&&!c.validateItems(k,H)||C.add(Q)}}return C.size}async createQueryResponse(){let c;c=this.query.outStatistics?this.query.outStatistics.some(l=>"exceedslimit"===l.statisticType)?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const l=this.query.geometry;b.isValid(this.query.outSR)&&!b.equals(l.spatialReference,
this.query.outSR)?c.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...v.project(l,l.spatialReference,this.query.outSR)}):c.queryGeometry=f.cleanFromGeometryEngine({spatialReference:this.query.outSR,...l})}return c}createSnappingResponse(c,l){const H=this.featureAdapter,g=A(this.hasZ,this.hasM),{point:I,mode:E}=c,C="number"===typeof c.distance?c.distance:c.distance.x,N="number"===typeof c.distance?c.distance:c.distance.y,Q={candidates:[]},T="esriGeometryPolygon"===this.geometryType;
l=this._getPointCreator(E,this.spatialReference,l);const y=new q(null,0),R=new q(null,0),k={x:0,y:0,z:0};for(const ia of this.items){var h=H.getGeometry(ia);if(null==h)continue;const {coords:na,lengths:oa}=h;y.coords=na;R.coords=na;if(c.returnEdge){h=0;for(var t=0;t<oa.length;t++){var J=oa[t];for(var U=0;U<J;U++,h+=g){var Y=y;Y.coordsIndex=h;if(U!==J-1){const pa=R;pa.coordsIndex=h+g;const sa=k;p(k,I,Y,pa);var da=(I.x-sa.x)/C;const wa=(I.y-sa.y)/N;da=da*da+wa*wa;1>=da&&Q.candidates.push(x.makeEdgeCandidate(H.getObjectId(ia),
l(sa),Math.sqrt(da),l(Y),l(pa)))}}}}if("none"!==c.vertexMode)if(h=T?na.length-g:na.length,"all"===c.vertexMode)for(t=0;t<h;t+=g)J=y,J.coordsIndex=t,U=(I.x-J.x)/C,Y=(I.y-J.y)/N,U=U*U+Y*Y,1>=U&&Q.candidates.push(x.makeVertexCandidate(H.getObjectId(ia),l(J),Math.sqrt(U)));else if("ends"===c.vertexMode){h=[0];T||h.push(na.length-g);for(const pa of h)h=y,h.coordsIndex=pa,t=(I.x-h.x)/C,J=(I.y-h.y)/N,t=t*t+J*J,1>=t&&Q.candidates.push(x.makeVertexCandidate(H.getObjectId(ia),l(h),Math.sqrt(t)))}}Q.candidates.sort((ia,
na)=>ia.distance-na.distance);return Q}_getPointCreator(c,l,H){const g=null==H||b.equals(l,H)?E=>E:E=>v.project(E,l,H),{hasZ:I}=this;return"3d"===c?I?({x:E,y:C,z:N})=>g({x:E,y:C,z:N}):({x:E,y:C})=>g({x:E,y:C,z:0}):({x:E,y:C})=>g({x:E,y:C})}async createSummaryStatisticsResponse(c){const {field:l,valueExpression:H,normalizationField:g,normalizationType:I,normalizationTotal:E,minValue:C,maxValue:N,scale:Q,timeZone:T,outStatisticTypes:y}=c;var R=this.fieldsIndex.get(l);c=B.isDateField(R)||B.isDateOnlyField(R)||
B.isTimestampOffsetField(R);const k=await this._getDataValues({field:l,valueExpression:H,normalizationField:g,normalizationType:I,normalizationTotal:E,scale:Q,timeZone:T}),h=D.isNullCountSupported({normalizationType:I,normalizationField:g,minValue:C,maxValue:N}),t={value:.5,fieldType:R?.type};R=B.isStringField(R)?D.calculateStringStatistics({values:k,supportsNullCount:h,percentileParams:t,outStatisticTypes:y}):D.calculateStatistics({values:k,minValue:C,maxValue:N,useSampleStdDev:!I,supportsNullCount:h,
percentileParams:t,outStatisticTypes:y});return D.processSummaryStatisticsResult(R,y,c)}async createUniqueValuesResponse(c){const {field:l,valueExpression:H,domains:g,returnAllCodedValues:I,scale:E,timeZone:C}=c;var N=await this._getDataValues({field:l,field2:c.field2,field3:c.field3,fieldDelimiter:c.fieldDelimiter,valueExpression:H,scale:E,timeZone:C},!1);N=D.calculateUniqueValuesCount(N);return D.createUVResult(N,g,I,c.fieldDelimiter)}async createClassBreaksResponse(c){const {field:l,valueExpression:H,
normalizationField:g,normalizationType:I,normalizationTotal:E,classificationMethod:C,standardDeviationInterval:N,minValue:Q,maxValue:T,numClasses:y,scale:R,timeZone:k}=c;c=await this._getDataValues({field:l,valueExpression:H,normalizationField:g,normalizationType:I,normalizationTotal:E,scale:R,timeZone:k});c=D.calculateClassBreaks(c,{field:l,normalizationField:g,normalizationType:I,normalizationTotal:E,classificationMethod:C,standardDeviationInterval:N,minValue:Q,maxValue:T,numClasses:y});return D.resolveCBResult(c,
C)}async createHistogramResponse(c){const {field:l,valueExpression:H,normalizationField:g,normalizationType:I,normalizationTotal:E,classificationMethod:C,standardDeviationInterval:N,minValue:Q,maxValue:T,numBins:y,scale:R,timeZone:k}=c;c=await this._getDataValues({field:l,valueExpression:H,normalizationField:g,normalizationType:I,normalizationTotal:E,scale:R,timeZone:k});return D.calculateHistogram(c,{field:l,normalizationField:g,normalizationType:I,normalizationTotal:E,classificationMethod:C,standardDeviationInterval:N,
minValue:Q,maxValue:T,numBins:y})}_sortFeatures(c,l,H){if(1<c.length&&l?.length)for(const g of l.reverse()){l=g.split(" ");const I=l[0],E=this.fieldsIndex.get(I);l=l[1]?"desc"===l[1].toLowerCase():!1;const C=D.getAttributeComparator(E?.type,l);c.sort((N,Q)=>{N=H(N,I,E);Q=H(Q,I,E);return C(N,Q)})}}_createFeatureQueryResponse(c){const l=this.items,{geometryType:H,hasM:g,hasZ:I,objectIdField:E,spatialReference:C}=this,{outFields:N,outSR:Q,quantizationParameters:T,resultRecordCount:y,resultOffset:R,returnZ:k,
returnM:h}=c,t=null!=y?l.length>(R||0)+y:!1,J=N&&(N.includes("*")?[...this.fieldsIndex.fields]:N.map(U=>this.fieldsIndex.get(U)));return{exceededTransferLimit:t,features:this._createFeatures(c,l),fields:J,geometryType:H,hasM:g&&h,hasZ:I&&k,objectIdFieldName:E,spatialReference:f.cleanFromGeometryEngine(Q||C),transform:T&&G.toQuantizationTransform(T)||null}}_createFeatures(c,l){const H=new m(c,this.featureAdapter,this.fieldsIndex),{hasM:g,hasZ:I}=this,{orderByFields:E,quantizationParameters:C,returnGeometry:N,
returnCentroid:Q,maxAllowableOffset:T,resultOffset:y,resultRecordCount:R,returnZ:k=!1,returnM:h=!1}=c,t=I&&k,J=g&&h;c=[];var U=0;const Y=[...l];this._sortFeatures(Y,E,(pa,sa,wa)=>H.getFieldValue(pa,sa,wa));if(this.geometryType&&(N||Q)){var da=G.toQuantizationTransform(C)??void 0;l="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(N&&!Q)for(var ia of Y){var na=this.featureAdapter.getGeometry(ia),oa={attributes:H.getAttributes(ia),geometry:f.getGeometry(this.geometryType,
this.hasZ,this.hasM,na,T,da,t,J)};l&&na&&!oa.geometry&&(oa.centroid=f.transformCentroid(this,this.featureAdapter.getCentroid(ia,this),da));c[U++]=oa}else if(!N&&Q)for(na of Y)c[U++]={attributes:H.getAttributes(na),centroid:f.transformCentroid(this,this.featureAdapter.getCentroid(na,this),da)};else for(oa of Y)c[U++]={attributes:H.getAttributes(oa),centroid:f.transformCentroid(this,this.featureAdapter.getCentroid(oa,this),da),geometry:f.getGeometry(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(oa),
T,da,t,J)}}else for(da of Y)(ia=H.getAttributes(da))&&(c[U++]={attributes:ia});U=y||0;null!=R&&(c=c.slice(U,Math.min(c.length,U+R)));return c}_createExceedsLimitQueryResponse(c){var l=!1;let H=Number.POSITIVE_INFINITY,g=Number.POSITIVE_INFINITY;l=Number.POSITIVE_INFINITY;for(const I of c.outStatistics??[])if("exceedslimit"===I.statisticType){H=null!=I.maxPointCount?I.maxPointCount:Number.POSITIVE_INFINITY;g=null!=I.maxRecordCount?I.maxRecordCount:Number.POSITIVE_INFINITY;l=null!=I.maxVertexCount?
I.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)l=this.items.length>H;else if(this.items.length>g)l=!0;else{c=A(this.hasZ,this.hasM);const I=this.featureAdapter;l=this.items.reduce((E,C)=>{C=I.getGeometry(C);return E+(null!=C&&C.coords.length||0)},0)/c>l}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(l)}}]}}async _createStatisticsQueryResponse(c){var l=
{attributes:{}};const H=[],g=new Map,I=new Map,E=new Map,C=new Map,N=new m(c,this.featureAdapter,this.fieldsIndex);var Q=c.outStatistics;const {groupByFieldsForStatistics:T,having:y,orderByFields:R,resultRecordCount:k}=c;c=T?.length;const h=!!c,t=h?T[0]:null,J=h&&!this.fieldsIndex.get(t);for(const na of Q??[]){const {outStatisticFieldName:oa,statisticType:pa}=na;Q=na;const sa="exceedslimit"!==pa?na.onStatisticField:void 0,wa="percentile_disc"===pa||"percentile_cont"===pa;var U="EnvelopeAggregate"===
pa||"CentroidAggregate"===pa||"ConvexHullAggregate"===pa;const xa=h&&1===c&&(sa===t||J)&&"count"===pa;if(h){if(!E.has(sa)){var Y=[];for(const Da of T){var da=this._getAttributeValues(N,Da,g);Y.push(da)}E.set(sa,this._calculateUniqueValues(Y,U?!1:N.returnDistinctValues))}Y=E.get(sa);if(!Y)continue;da=Object.keys(Y);for(const Da of da){const {count:Ea,data:Ja,items:Sa,itemPositions:ab}=Y[Da];da=Ja.join(",");if(!y||N.validateItems(Sa,y)){const La=C.get(da)||{attributes:{}};if(U){La.aggregateGeometries||
(La.aggregateGeometries={});const {aggregateGeometries:O,outStatisticFieldName:X}=await this._getAggregateGeometry(Q,Sa);La.aggregateGeometries[X]=O}else{var ia=null;if(xa)ia=Ea;else{const O=this._getAttributeValues(N,sa,g);ia=ab.map(X=>O[X]);ia=wa&&"statisticParameters"in Q?this._getPercentileValue(Q,ia):this._getStatisticValue(Q,ia,null,N.returnDistinctValues)}La.attributes[oa]=ia}let u=0;T.forEach((O,X)=>La.attributes[this.fieldsIndex.get(O)?O:`EXPR_${++u}`]=Ja[X]);C.set(da,La)}}}else if(U){l.aggregateGeometries||
(l.aggregateGeometries={});const {aggregateGeometries:Da,outStatisticFieldName:Ea}=await this._getAggregateGeometry(Q,this.items);l.aggregateGeometries[Ea]=Da}else U=this._getAttributeValues(N,sa,g),l.attributes[oa]=wa&&"statisticParameters"in Q?this._getPercentileValue(Q,U):this._getStatisticValue(Q,U,I,N.returnDistinctValues);Q="min"!==pa&&"max"!==pa||!B.isStringField(this.fieldsIndex.get(sa))&&!this._isAnyDateField(sa)?null:this.fieldsIndex.get(sa)?.type;H.push({name:oa,alias:oa,type:Q||"esriFieldTypeDouble"})}l=
h?Array.from(C.values()):[l];this._sortFeatures(l,R,(na,oa)=>na.attributes[oa]);k&&(l.length=Math.min(k,l.length));return{fields:H,features:l}}_isAnyDateField(c){c=this.fieldsIndex.get(c);return B.isDateField(c)||B.isDateOnlyField(c)||B.isTimestampOffsetField(c)||B.isTimeOnlyField(c)}async _getAggregateGeometry(c,l){const {convexHull:H,union:g}=await new Promise((k,h)=>a(["../../../geometry/geometryEngineJSON"],k,h)),{statisticType:I,outStatisticFieldName:E}=c,{featureAdapter:C,spatialReference:N,
geometryType:Q,hasZ:T,hasM:y}=this;l=l.map(k=>f.getGeometry(Q,T,y,C.getGeometry(k)));const R=H(N,l,!0)[0];c={aggregateGeometries:null,outStatisticFieldName:null};"EnvelopeAggregate"===I?(l=R?r.getPolygonExtent(R):r.getGeometryExtent(g(N,l)),c.aggregateGeometries={...l,spatialReference:N},c.outStatisticFieldName=E||"extent"):"CentroidAggregate"===I?(l=R?z.polygonCentroid(R):z.extentCentroid(r.getGeometryExtent(g(N,l))),c.aggregateGeometries={x:l[0],y:l[1],spatialReference:N},c.outStatisticFieldName=
E||"centroid"):"ConvexHullAggregate"===I&&(c.aggregateGeometries=R,c.outStatisticFieldName=E||"convexHull");return c}_getStatisticValue(c,l,H,g){const {onStatisticField:I,statisticType:E}=c;c=null;c=H?.has(I)?H.get(I):B.isStringField(this.fieldsIndex.get(I))||this._isAnyDateField(I)?D.calculateStringStatistics({values:l,returnDistinct:g}):D.calculateStatistics({values:g?[...(new Set(l))]:l,minValue:null,maxValue:null,useSampleStdDev:!0});H&&H.set(I,c);return c["var"===E?"variance":E]}_getPercentileValue(c,
l){const {onStatisticField:H,statisticParameters:g,statisticType:I}=c,{value:E,orderBy:C}=g;c=this.fieldsIndex.get(H);return D.calculatePercentile(l,{value:E,orderBy:C,fieldType:c?.type,isDiscrete:"percentile_disc"===I})}_getAttributeValues(c,l,H){if(H.has(l))return H.get(l);const g=this.fieldsIndex.get(l),I=this.items.map(E=>c.getFieldValue(E,l,g));H.set(l,I);return I}_calculateUniqueValues(c,l){const H={},g=this.items,I=g.length;for(let E=0;E<I;E++){const C=g[E],N=[];for(const T of c)N.push(T[E]);
const Q=N.join(",");null==H[Q]?H[Q]={count:1,data:N,items:[C],itemPositions:[E]}:(l||H[Q].count++,H[Q].items.push(C),H[Q].itemPositions.push(E))}return H}async _getDataValues(c,l=!0){const H=new m(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:g,scale:I,timeZone:E}=c;return g?H.getExpressionValues(this.items,g,{viewingMode:"map",scale:I,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},E):H.getDataValues(this.items,
n.clone(c),l)}}class q{constructor(c,l){this.coords=c;this.coordsIndex=l}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}d.QueryEngineResult=F;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/quantizationUtils":function(){define(["exports","./jsonUtils"],function(a,d){function n(k){if("lowerLeft"===k.originPosition&&4===k.scale.length&&4===k.translate.length)return k;const {originPosition:h,
scale:t,translate:J}=k;k=t[1]??1;return{originPosition:"lowerLeft",scale:[t[0]??1,"lowerLeft"===h?k:-k,t[2]??1,t[3]??1],translate:[J[0]??0,J[1]??0,J[2]??0,J[3]??0]}}function z({scale:k,translate:h},t){return Math.round((t-h[0])/k[0])}function r({scale:k,translate:h},t){return Math.round((t-h[1])/k[1])}function G({scale:k,translate:h},t){return Math.round(((t??0)-h[2])/k[2])}function b({scale:k,translate:h},t){return t?Math.round((t-h[3])/k[3]):0}function m(k,h){return k&&h?N:k&&!h?E:!k&&h?C:I}function f({scale:k,
translate:h},t){return t*k[0]+h[0]}function v({scale:k,translate:h},t){return t*k[1]+h[1]}function x({scale:k,translate:h},t){return(t??0)*k[2]+h[2]}function B({scale:k,translate:h},t){return t?t*k[3]+h[3]:0}function D(k,h){return k&&h?R:k&&!h?T:!k&&h?y:Q}function p(k,h,t){const J=Array(t.length);for(let U=0;U<t.length;U++)J[U]=h(k,t[U]);return J}function A(k,h,t){let [J,U]=t[0],Y=Math.min(J,h[0]),da=Math.min(U,h[1]),ia=Math.max(J,h[2]);h=Math.max(U,h[3]);for(let na=1;na<t.length;na++){const [oa,
pa]=t[na];J+=oa;U+=pa;0>oa&&(Y=Math.min(Y,J));0<oa&&(ia=Math.max(ia,J));0>pa?da=Math.min(da,U):0<pa&&(h=Math.max(h,U))}k[0]=Y;k[1]=da;k[2]=ia;k[3]=h;return k}function F(k,h){if(!h.length)return null;k[0]=k[1]=Number.POSITIVE_INFINITY;k[2]=k[3]=Number.NEGATIVE_INFINITY;for(let t=0;t<h.length;t++)A(k,k,h[t]);return k}function q(k,h,t){k=n(k);h.xmin=z(k,t.xmin);h.ymin=r(k,t.ymin);h.xmax=z(k,t.xmax);h.ymax=r(k,t.ymax);t.hasZ&&(h.zmin=G(k,t.zmin),h.zmax=G(k,t.zmax));t.hasM&&(h.mmin=b(k,t.mmin),h.mmax=
b(k,t.mmax));h.hasZ=t.hasZ??!1;h.hasM=t.hasM??!1;return h}function c(k,h,t){k=n(k);h.points=m(t.hasZ,t.hasM)(k,t.points)??[];h.hasZ=t.hasZ??!1;h.hasM=t.hasM??!1;return h}function l(k,h,t){k=n(k);h.x=z(k,t.x);h.y=r(k,t.y);null!=t.z&&(h.z=G(k,t.z));null!=t.m&&(h.m=b(k,t.m));return h}function H(k,h,t){{k=n(k);var J=t.rings;const U=[],Y=m(t.hasZ,t.hasM);for(let da=0;da<J.length;da++){const ia=Y(k,J[da]);ia&&3<=ia.length&&U.push(ia)}k=U.length?U:null}if(!k)return null;h.rings=k;h.hasZ=t.hasZ??!1;h.hasM=
t.hasM??!1;return h}function g(k,h,t){{k=n(k);var J=t.paths;const U=[],Y=m(t.hasZ,t.hasM);for(let da=0;da<J.length;da++){const ia=Y(k,J[da]);ia&&2<=ia.length&&U.push(ia)}k=U.length?U:null}if(!k)return null;h.paths=k;h.hasZ=t.hasZ??!1;h.hasM=t.hasM??!1;return h}const I=(k,h)=>{const t=[];if(!h.length)return null;var J=h[0];let U=z(k,J[0]);J=r(k,J[1]);t.push([U,J]);for(let Y=1;Y<h.length;Y++){const [da,ia]=h[Y],na=z(k,da),oa=r(k,ia);na===U&&oa===J||t.push([na-U,oa-J]);U=na;J=oa}return t},E=(k,h)=>{const t=
[];if(!h.length)return null;var J=h[0];let U=z(k,J[0]),Y=r(k,J[1]);J=G(k,J[2]);t.push([U,Y,J]);for(let da=1;da<h.length;da++){const [ia,na,oa]=h[da],pa=z(k,ia),sa=r(k,na),wa=G(k,oa);pa===U&&sa===Y&&wa===J||t.push([pa-U,sa-Y,wa]);U=pa;Y=sa;J=wa}return t},C=(k,h)=>{const t=[];if(!h.length)return null;var J=h[0];let U=z(k,J[0]),Y=r(k,J[1]);J=b(k,J[2]);t.push([U,Y,J]);for(let da=1;da<h.length;da++){const [ia,na,oa]=h[da],pa=z(k,ia),sa=r(k,na),wa=b(k,oa);pa===U&&sa===Y&&wa===J||t.push([pa-U,sa-Y,wa]);
U=pa;Y=sa;J=wa}return t},N=(k,h)=>{const t=[];if(!h.length)return null;var J=h[0];let U=z(k,J[0]),Y=r(k,J[1]),da=G(k,J[2]);J=b(k,J[3]);t.push([U,Y,da,J]);for(let ia=1;ia<h.length;ia++){const [na,oa,pa,sa]=h[ia],wa=z(k,na),xa=r(k,oa),Da=G(k,pa),Ea=b(k,sa);wa===U&&xa===Y&&Da===da&&Ea===J||t.push([wa-U,xa-Y,Da,Ea]);U=wa;Y=xa;da=Da;J=Ea}return t},Q=(k,h)=>{const t=Array(h.length);if(!h.length)return t;var J=h[0];let U=f(k,J[0]);J=v(k,J[1]);t[0]=[U,J];const {scale:Y,originPosition:da}=k;k=Y[0];const ia=
"lowerLeft"===da?Y[1]:-Y[1];for(let na=1;na<h.length;na++){const [oa,pa]=h[na];U+=k*oa;J+=ia*pa;t[na]=[U,J]}return t},T=(k,h)=>{const t=Array(h.length);if(!h.length)return t;var J=h[0];let U=f(k,J[0]),Y=v(k,J[1]);t[0]=[U,Y,x(k,J[2])];const {scale:da,originPosition:ia}=k;J=da[0];const na="lowerLeft"===ia?da[1]:-da[1];for(let oa=1;oa<h.length;oa++){const [pa,sa,wa]=h[oa];U+=J*pa;Y+=na*sa;t[oa]=[U,Y,x(k,wa)]}return t},y=(k,h)=>{const t=Array(h.length);if(!h.length)return t;var J=h[0];let U=f(k,J[0]),
Y=v(k,J[1]);t[0]=[U,Y,B(k,J[2])];const {scale:da,originPosition:ia}=k;J=da[0];const na="lowerLeft"===ia?da[1]:-da[1];for(let oa=1;oa<h.length;oa++){const [pa,sa,wa]=h[oa];U+=J*pa;Y+=na*sa;t[oa]=[U,Y,B(k,wa)]}return t},R=(k,h)=>{const t=Array(h.length);if(!h.length)return t;var J=h[0];let U=f(k,J[0]),Y=v(k,J[1]);t[0]=[U,Y,x(k,J[2]),B(k,J[3])];const {scale:da,originPosition:ia}=k;J=da[0];const na="lowerLeft"===ia?da[1]:-da[1];for(let oa=1;oa<h.length;oa++){const [pa,sa,wa,xa]=h[oa];U+=J*pa;Y+=na*sa;
t[oa]=[U,Y,x(k,wa),B(k,xa)]}return t};a.getQuantizedBoundsCoordsArray=A;a.getQuantizedBoundsCoordsArrayArray=F;a.getQuantizedBoundsPaths=function(k){return F([0,0,0,0],k)};a.getQuantizedBoundsPoints=function(k){const h=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return A(h,h,k)};a.getQuantizedBoundsRings=function(k){return F([0,0,0,0],k)};a.normalizeTransform=n;a.quantizeBounds=function(k,h,t){k=n(k);h[0]=z(k,t[0]);h[3]=r(k,t[1]);h[2]=z(k,
t[2]);h[1]=r(k,t[3]);return h};a.quantizeCoordsArrayXY=I;a.quantizeCoordsArrayXYM=C;a.quantizeCoordsArrayXYZ=E;a.quantizeCoordsArrayXYZM=N;a.quantizeExtent=q;a.quantizeGeometry=function(k,h){return k&&h?d.isPoint(h)?l(k,{},h):d.isPolyline(h)?g(k,{},h):d.isPolygon(h)?H(k,{},h):d.isMultipoint(h)?c(k,{},h):d.isExtent(h)?q(k,{},h):null:null};a.quantizeM=b;a.quantizeMultipoint=c;a.quantizePoint=l;a.quantizePolygon=H;a.quantizePolyline=g;a.quantizeX=z;a.quantizeY=r;a.quantizeZ=G;a.toQuantizationTransform=
function(k){return k?{originPosition:"upper-left"===k.originPosition?"upperLeft":"lower-left"===k.originPosition?"lowerLeft":k.originPosition,scale:k.tolerance?[k.tolerance,k.tolerance,1,1]:[1,1,1,1],translate:null!=k.extent?[k.extent.xmin,k.extent.ymax,k.extent.zmin??0,k.extent.mmin??0]:[0,0,0,0]}:null};a.unquantizeBounds=function(k,h,t){k=n(k);return t?(h[0]=f(k,t[0]),h[1]=v(k,t[3]),h[2]=f(k,t[2]),h[3]=v(k,t[1]),h):[f(k,h[0]),v(k,h[3]),f(k,h[2]),v(k,h[1])]};a.unquantizeCoordsArrayArray=p;a.unquantizeCoordsArrayXY=
Q;a.unquantizeCoordsArrayXYM=y;a.unquantizeCoordsArrayXYZ=T;a.unquantizeCoordsArrayXYZM=R;a.unquantizeExtent=function(k,h,t,J=t.hasZ??!1,U=t.hasM??!1){k=n(k);h.xmin=f(k,t.xmin);h.xmax=f(k,t.xmax);h.ymin=v(k,t.ymin);h.ymax=v(k,t.ymax);J&&(h.zmin=x(k,t.zmin),h.zmax=x(k,t.zmax));U&&(h.mmin=B(k,t.mmin),h.mmax=B(k,t.mmax));h.hasZ=J;h.hasM=U;return h};a.unquantizeM=B;a.unquantizeMultipoint=function(k,h,t,J=t?.hasZ??!1,U=t?.hasM??!1){null!=t&&(k=n(k),h.points=D(J,U)(k,t.points),h.hasZ=J,h.hasM=U);return h};
a.unquantizePoint=function(k,h,t,J=null!=t?.z,U=null!=t?.m){if(null==t)return h;k=n(k);h.x=f(k,t.x);h.y=v(k,t.y);J&&(h.z=x(k,t.z));U&&(h.m=B(k,t.m));return h};a.unquantizePolygon=function(k,h,t,J=t?.hasZ??!1,U=t?.hasM??!1){null!=t&&(k=n(k),h.rings=p(k,D(J,U),t.rings),h.hasZ=J,h.hasM=U);return h};a.unquantizePolyline=function(k,h,t,J=t?.hasZ??!1,U=t?.hasM??!1){null!=t&&(k=n(k),h.paths=p(k,D(J,U),t.paths),h.hasZ=J,h.hasM=U);return h};a.unquantizeX=f;a.unquantizeY=v;a.unquantizeZ=x;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/AttributesBuilder":function(){define("./attributeSupport ./geometryUtils ../../support/fieldUtils ../../../smartMapping/statistics/support/utils ../../../statistics/utils ../../../support/arcadeOnDemand".split(" "),function(a,d,n,z,r,G){class b{constructor(m,f,v){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=m.returnDistinctValues??!1;this.fieldsIndex=v;this.featureAdapter=f;if((f=m.outFields)&&
!f.includes("*")){this.outFields=f;m=0;for(const B of f){var x=a.getExpressionFromFieldName(B);x=(f=this.fieldsIndex.get(x))?null:a.getWhereClause(x,v);f=f?f.name:a.getAliasFromFieldName(B)||`FIELD_EXP_${m++}`;this._fieldDataCache.set(B,{alias:f,clause:x})}}}countDistinctValues(m){if(!this.returnDistinctValues)return m.length;m.forEach(f=>this.getAttributes(f));return this._returnDistinctMap.size}getAttributes(m){m=this._processAttributesForOutFields(m);return this._processAttributesForDistinctValues(m)}getFieldValue(m,
f,v){const x=v?v.name:f;let B=null;this._fieldDataCache.has(x)?B=this._fieldDataCache.get(x)?.clause:v||(B=a.getWhereClause(f,this.fieldsIndex),this._fieldDataCache.set(x,{alias:x,clause:B}));return v?this.featureAdapter.getAttribute(m,x):B?.calculateValue(m,this.featureAdapter)}getDataValues(m,f,v=!0){const x=f.normalizationType,B=f.normalizationTotal,D=this.fieldsIndex.get(f.field),p=n.isDateOnlyField(D)||n.isTimestampOffsetField(D),A=n.isTimeOnlyField(D);return m.map(F=>{let q=f.field&&this.getFieldValue(F,
f.field,this.fieldsIndex.get(f.field));f.field2?(q=`${r.processNullValue(q)}${f.fieldDelimiter}${r.processNullValue(this.getFieldValue(F,f.field2,this.fieldsIndex.get(f.field2)))}`,f.field3&&(q=`${q}${f.fieldDelimiter}${r.processNullValue(this.getFieldValue(F,f.field3,this.fieldsIndex.get(f.field3)))}`)):"string"===typeof q&&v&&(p?q=q?(new Date(q)).getTime():null:A&&(q=q?z.timeOnlyToMilliseconds(q):null));x&&Number.isFinite(q)&&(F="field"===x&&f.normalizationField?this.getFieldValue(F,f.normalizationField,
this.fieldsIndex.get(f.normalizationField)):null,q=r.getNormalizedValue(q,x,F,B));return q})}async getExpressionValues(m,f,v,x,B){const {arcadeUtils:D}=await G.loadArcade(),p=D.hasGeometryOperations(f);p&&await D.enableGeometryOperations();const A=D.createFunction(f),F=D.getViewInfo(v),q={fields:this.fieldsIndex.fields};return m.map(c=>{c={attributes:this.featureAdapter.getAttributes(c),layer:q,geometry:p?{...d.getGeometry(x.geometryType,x.hasZ,x.hasM,this.featureAdapter.getGeometry(c)),spatialReference:v?.spatialReference}:
null};c=D.createExecContext(c,F,B);return D.executeFunction(A,c)})}validateItem(m,f){this._fieldDataCache.has(f)||this._fieldDataCache.set(f,{alias:f,clause:a.getWhereClause(f,this.fieldsIndex)});return this._fieldDataCache.get(f)?.clause?.testFeature(m,this.featureAdapter)??!1}validateItems(m,f){this._fieldDataCache.has(f)||this._fieldDataCache.set(f,{alias:f,clause:a.getWhereClause(f,this.fieldsIndex)});return this._fieldDataCache.get(f)?.clause?.testSet(m,this.featureAdapter)??!1}_processAttributesForOutFields(m){const f=
this.outFields;if(!f?.length)return this.featureAdapter.getAttributes(m);const v={};for(const x of f){const {alias:B,clause:D}=this._fieldDataCache.get(x);v[B]=D?D.calculateValue(m,this.featureAdapter):this.featureAdapter.getAttribute(m,B)}return v}_processAttributesForDistinctValues(m){if(null==m||!this.returnDistinctValues)return m;var f=this.outFields,v=[];if(f)for(const B of f){var {alias:x}=this._fieldDataCache.get(B);v.push(m[x])}else for(x in m)v.push(m[x]);f=`${(f||["*"]).join(",")}=${v.join(",")}`;
v=this._returnDistinctMap.get(f)||0;this._returnDistinctMap.set(f,++v);return 1<v?null:m}}return b})},"esri/smartMapping/statistics/support/utils":function(){define("exports ../../../geometry ../../../core/Error ../../../core/screenUtils ../../../core/timeUtils ../../../geometry/SpatialReference ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/support/fieldUtils ../../../renderers/support/heatmapUtils ../../support/utils ../../../statistics/utils ../../../support/arcadeOnDemand ../../../geometry/Point".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p){function A(g){g=H.exec(g);if(!g)return null;const {hh:I,mm:E,ss:C,ms:N}=g.groups;return Number(I)*r.millisecondsPerTimeUnit.hours+Number(E)*r.millisecondsPerTimeUnit.minutes+Number(C)*r.millisecondsPerTimeUnit.seconds+Number(N||0)}function F(g,I){g=null!=g?g:"";null!=I&&I&&(g=g?"("+g+") AND ("+I+")":I);return g}function q(g){const I=g.layer;return g.fields.filter(E=>!I.getField(E))}function c(g){const I=g.layer;return g.fields.filter(E=>{E=I.getFieldUsageInfo(E);
return!E||!E.supportsStatistics})}let l=null;const H=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;a.calculateHeatmapStats=function(g,I=18,E,C,N){const Q=new Float64Array(C*N);I=Math.round(z.pt2px(I));let T=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY;E=v.createValueFunction(E);for(const {geometry:h,attributes:t}of g){const {x:J,y:U}=h;g=Math.max(0,J-I);var R=Math.max(0,U-I);const Y=Math.min(N,U+I),da=Math.min(C,J+I),ia=+E(t);for(;R<Y;R++)for(let na=
g;na<da;na++){var k=R*C+na;const oa=v.evaluateDensityKernel(na-J,R-U,I)*ia;k=Q[k]+=oa;T=Math.min(T,k);y=Math.max(y,k)}}return{min:T,max:y}};a.getDataValues=async function(g,I,E=!0){if(!I)return[];const {field:C,field2:N,field3:Q,fieldDelimiter:T,fieldInfos:y,timeZone:R}=g;var k=C&&y?.find(sa=>sa.name.toLowerCase()===C.toLowerCase());const h=k?f.isTimeOnlyField(k):!1,t=k?x.isAnyDateField(k):!1,J=g.valueExpression,U=g.normalizationType,Y=g.normalizationField,da=g.normalizationTotal,ia=[];k=g.viewInfoParams;
let na=null,oa=null;if(J){if(!l){const {arcadeUtils:sa}=await D.loadArcade();l=sa}l.hasGeometryOperations(J)&&await l.enableGeometryOperations();na=l.createFunction(J);oa=k?l.getViewInfo({viewingMode:k.viewingMode,scale:k.scale,spatialReference:new G(k.spatialReference)}):null}g=g.fieldInfos;const pa=I[0]&&"declaredClass"in I[0]&&"esri.Graphic"===I[0].declaredClass||!g?null:{fields:g};I.forEach(sa=>{var wa=sa.attributes;if(J){var xa=l.createExecContext(pa?{...sa,layer:pa}:sa,oa,R);xa=l.executeFunction(na,
xa)}else wa&&(xa=wa[C],N?(xa=`${B.processNullValue(xa)}${T}${B.processNullValue(wa[N])}`,Q&&(xa=`${xa}${T}${B.processNullValue(wa[Q])}`)):"string"===typeof xa&&E&&(t?xa=xa?(new Date(xa)).getTime():null:h&&(xa=xa?A(xa):null)));U&&"number"===typeof xa&&isFinite(xa)&&(wa=wa&&parseFloat(wa[Y]),xa=B.getNormalizedValue(xa,U,wa,da));ia.push(xa)});return ia};a.getRangeExpr=function(g,I,E){I=null!=I?g+" \x3e\x3d "+I:"";g=null!=E?g+" \x3c\x3d "+E:"";E="";return(E=I&&g?F(I,g):I||g)?"("+E+")":""};a.getSQLFilterForNormalization=
function(g){const I=g.field,E=g.normalizationType;g=g.normalizationField;let C;if("field"===E)C="(NOT "+g+" \x3d 0)";else if("log"===E||"natural-log"===E||"square-root"===E)C=`(${I} > 0)`;return C};a.getSumOfAttributesExpr=function(g,I,E){const C=[],N=[],Q=[],T=[],y=[];g.forEach((k,h)=>{const t=k.field?"field":"expression",J=k.field||k.valueExpression;k.field?(y.push(J),N.push(`var ${t}${h} = Number($feature["${J}"]);`)):(C.push(`function getValueForExpr${h}() {\n  ${J} \n}`),N.push(`var ${t}${h} = Number(getValueForExpr${h}());`));
E||Q.push(`${t}${h} = IIf(${t}${h} < 0, 0, ${t}${h});`);T.push(`${t}${h}`)});g=C.length?null:y.reduce((k,h)=>`${k} + ${h}`);let R=null;I||E?I?E||g&&(R=`(( ${g} ) >= 0)`):g&&(R=`(( ${g} ) <> 0)`):g&&(R=`(( ${g} ) > 0)`);return{valueExpression:[C.length?C.join("\n"):"",N.join("\n"),Q.join("\n"),`var total = ${T.join(" + ")};`,"return total;"].filter(Boolean).join("\n\n"),sqlExpression:g,sqlWhere:R}};a.mergeWhereClauses=F;a.quantizeFeatures=function(g,I,E,C){const N=m.isWrappable(E)?m.getInfo(E):null,
Q=N?Math.round((N.valid[1]-N.valid[0])/I.scale[0]):null;return g.map(T=>{const y=new p(T.geometry);b.quantizePoint(I,y,y);if(N){var R=Q??0,k=C[0];0>y.x?y.x+=R:y.x>k&&(y.x-=R)}T.geometry=y;return T})};a.timeOnlyToMilliseconds=A;a.verifyBasicFieldValidity=function(g,I,E){const C=q({layer:g,fields:I});if(C.length)return new n(E,"Unknown fields: "+C.join(", ")+". You can only use fields defined in the layer schema");g=c({layer:g,fields:I});if(g.length)return new n(E,"Unsupported fields: "+g.join(", ")+
". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true")};a.verifyFieldType=function(g,I,E,C){let N;I?I.name!==g.objectIdField&&C.includes(I.type)||(N=new n(E,"'field' should be one of these types: "+C.join(","))):N=new n(E,"'field' is not defined in the layer schema");return N};a.verifyFilterValidity=function(g,I){if(g&&"intersects"!==g.spatialRelationship)return new n(I,"Only 'intersects' spatialRelationship is supported for featureFilter")};a.verifyNumericField=
function(g,I,E){let C;I?I.name!==g.objectIdField&&f.isNumericField(I)||(C=new n(E,"'field' should be one of these numeric types: "+f.numericTypes.join(","))):C=new n(E,"'field' is not defined in the layer schema");return C};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/screenUtils":function(){define(["exports"],function(a){function d(r){return r?72*r/96:0}function n(r=0,G=0){return{x:r,y:G}}const z=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.castRenderScreenPointArray=function(r){return r};
a.castRenderScreenPointArray3=function(r){return r};a.castScreenPointArray=function(r){return r};a.cloneScreenPoint=function(r){return r?n(r.x,r.y):null};a.createRenderScreenPoint=function(r=0,G=0){return{x:r,y:G}};a.createRenderScreenPointArray=function(r=0,G=0){return[r,G]};a.createRenderScreenPointArray3=function(r=0,G=0,b=0){return[r,G,b]};a.createScreenPoint=n;a.createScreenPointArray=function(r=0,G=0){return[r,G]};a.pt2px=function(r){return r?r/72*96:0};a.px2pt=d;a.screenPointArrayToObject=
function(r,G){return G?(G.x=r[0],G.y=r[1],G):{x:r[0],y:r[1]}};a.screenPointObjectToArray=function(r,G){return G?(G[0]=r.x,G[1]=r.y,2<G.length&&(G[2]=0),G):[r.x,r.y]};a.toPt=function(r){if("string"===typeof r){var G=r.match(z);if(G){var b=Number(G[1]);G=G[3]&&G[3].toLowerCase();r="-"===r.charAt(0);b="px"===G?d(b):b;return r?-b:b}console.warn("screenUtils.toPt: input not recognized!");return null}return r};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/timeUtils":function(){define(["exports",
"../intl/date","../time/timeZoneUtils","../chunks/datetime"],function(a,d,n,z){function r(m,f,v){return 0===m?0:m*b[f]/b[v]}function G(m){switch(m){case "milliseconds":return"millisecond";case "seconds":return"second";case "minutes":return"minute";case "hours":return"hour";case "days":return"day";case "weeks":return"week";case "months":return"month";case "years":return"year"}}const b={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,
centuries:31536E8};a.convertTime=r;a.isValidDate=function(m){return m instanceof Date&&!isNaN(m.getTime())};a.makeUTCTime=function(m,f,v="milliseconds"){f=new Date(r(f,v,"milliseconds"));f.setUTCFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate());return f};a.mergeTimeExtents=function(m,f){return m&&f?m.intersection(f):m||f};a.millisecondsPerTimeUnit=b;a.offsetDate=function(m,f,v,x=n.system){x=new z.IANAZone(d.resolveTimeZone(x));m=z.DateTime.fromJSDate(m,{zone:x});x="decades"===v||"centuries"===
v?"year":G(v);"decades"===v&&(f*=10);"centuries"===v&&(f*=100);return m.plus({[x]:f}).toJSDate()};a.offsetDateUTC=function(m,f,v="milliseconds"){m=m.getTime();f=r(f,v,"milliseconds");return new Date(m+f)};a.resetUTCDate=function(m,f){m=new Date(m.getTime());m.setUTCFullYear(f.getFullYear(),f.getMonth(),f.getDate());return m};a.timeSinceUTCMidnight=function(m,f="milliseconds"){const v=r(m.getUTCHours(),"hours","milliseconds"),x=r(m.getUTCMinutes(),"minutes","milliseconds"),B=r(m.getUTCSeconds(),"seconds",
"milliseconds");m=m.getUTCMilliseconds();return r(v+x+B+m,"milliseconds",f)};a.truncateDate=function(m,f,v=n.system){v=new z.IANAZone(d.resolveTimeZone(v));m=z.DateTime.fromJSDate(m,{zone:v});if("decades"===f||"centuries"===f)return m=m.startOf("year"),{year:v}=m,m.set({year:v-v%("decades"===f?10:100)}).toJSDate();f=G(f);return m.startOf(f).toJSDate()};a.truncateLocalTime=function(m){const f=new Date(0);f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);f.setFullYear(m.getUTCFullYear(),
m.getUTCMonth(),m.getUTCDate());return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/heatmapUtils":function(){define(["exports","../../core/mathUtils","../../core/screenUtils","../../chunks/vec42","../../core/libs/gl-matrix-2/factories/vec4f64"],function(a,d,n,z,r){function G(b,m,f,v){let {color:x,ratio:B}=m,{color:D,ratio:p}=f;p===B&&(1===p?B-=1E-6:p+=1E-6);m=d.clamp((v-B)/(p-B),0,1);z.lerp(b,x.toArray(),D.toArray(),m)}a.createValueFunction=function(b){return"function"===
typeof b?b:b?m=>+m[b]:()=>1};a.evaluateDensityKernel=function(b,m,f){b=Math.sqrt(b**2+m**2)/f;return 1<b?0:3/(Math.PI*f**2)*(1-b**2)**2};a.gaussianBlurRadiusPxToKernelDensityRadiusPt=function(b){return n.px2pt(2.4*b)};a.generateGradient=function(b){const m=new Uint8ClampedArray(2048);b=b.filter(({ratio:D})=>0<=D&&1>=D).sort((D,p)=>D.ratio-p.ratio).map(({color:D,ratio:p})=>({color:D,ratio:Math.max(p,.001)}));if(1>b.length)return m;let f=b[0],v=b[0],x=1;const B=r.create();for(let D=0;512>D;D++){const p=
(D+.5)/512;for(;p>v.ratio&&x<b.length;)f=v,v=b[x++];G(B,f,v,p);m.set(B,4*D)}return m};a.kernelDensityRadiusPtToGaussianBlurRadiusPx=function(b){return n.pt2px(b)/2.4};a.magicKernelDensityRadiusInflationFactor=2.4;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(a,d,n,z,r,G){function b(p){return String(p).padStart(2,
"0")}function m(p,A,F){if("date"===A||"number"===A){"number"===A&&(p=new Date(p));A=F?p.getFullYear():p.getUTCFullYear();const q=b((F?p.getMonth():p.getUTCMonth())+1),c=b(F?p.getDate():p.getUTCDate()),l=b(F?p.getHours():p.getUTCHours()),H=b(F?p.getMinutes():p.getUTCMinutes());p=b(F?p.getSeconds():p.getUTCSeconds());p=`TIMESTAMP'${A}-${q}-${c} ${l}:${H}:${p}'`}return p}function f(p,A){if(A instanceof Date)return"date";if("number"===typeof A)return"number";if("string"===typeof A&&(p=p.getField(A),"\x3cnow\x3e"!==
A.toLowerCase()&&n.isDateField(p)))return"field"}const v={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},x={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},B=new Set(["integer","small-integer"]);let D=null;a.castIntegerFieldToFloat=function(p){return`cast(${p} as float)`};a.dateTypes=
["date","date-only","timestamp-offset"];a.defaultBasemapGroups=v;a.defaultStatisticTypes={exclude:["median"]};a.fieldDelimiter=",";a.formatAnyDate=function(p,A){const {format:F,timeZoneOptions:q,fieldType:c}=A??{};let l;q&&({timeZone:H,timeZoneName:l}=G.getTimeZoneFormattingOptions(q.layerTimeZone,q.datesInUnknownTimezone,q.viewTimeZone,d.convertDateFormatToIntlOptions(F||"short-date-short-time"),c));if("string"===typeof p&&isNaN(Date.parse("time-only"===c?`1970-01-01T${p}Z`:p)))return p;switch(c){case "date-only":var H=
d.convertDateFormatToIntlOptions(F||"short-date");return"string"===typeof p?d.formatDateOnly(p,{...H}):d.formatDate(p,{...H,timeZone:G.utc});case "time-only":return H=d.convertDateFormatToIntlOptions(F||"short-time"),"string"===typeof p?d.formatTimeOnly(p,H):d.formatDate(p,{...H,timeZone:G.utc});case "timestamp-offset":if(!H&&"string"===typeof p&&(new Date(p)).toISOString()!==p)return p;H=(A=F||q?d.convertDateFormatToIntlOptions(F||"short-date-short-time"):void 0)?{...A,timeZone:H,timeZoneName:l}:
void 0;return"string"===typeof p?d.formatTimestamp(p,H):d.formatDate(p,H);default:return A=F||q?d.convertDateFormatToIntlOptions(F||"short-date-short-time"):void 0,d.formatDate("string"===typeof p?new Date(p):p,A?{...A,timeZone:H,timeZoneName:l}:void 0)}};a.getBasemapGroup=function(p,A=v){for(const F in A)if(A[F].includes(p))return F};a.getBasemapId=function(p,A,F=!0){let q=null;p&&("string"===typeof p?A.includes(p)&&(q=p):q=r.getWellKnownBasemapId(p));return F?q||"gray":q};a.getDateDiffSQL=function(p,
A,F,q){const {hasQueryEngine:c}=p;F=m(F,f(p,F),c);p=m(A,f(p,A),c);p=`(${F} - ${p})`;q=x[q];A="/";1>q&&(q=1/q,A="*");return{sqlExpression:1===q?p:`(${p} ${A} ${q})`,sqlWhere:null}};a.getDateType=f;a.getFieldsList=async function(p){const {field:A,field2:F,field3:q,normalizationField:c,valueExpression:l}=p;p=[];l&&(D||({arcadeUtils:p}=await z.loadArcade(),D=p),p=D.extractFieldNames(l));A&&p.push(A);F&&p.push(F);q&&p.push(q);c&&p.push(c);return p};a.getNormalizationType=function(p){let A=p.normalizationType;
A||(p.normalizationField?A="field":null!=p.normalizationTotal&&(A="percent-of-total"));return A??void 0};a.isAnyDateField=function(p){return n.isDateField(p)||n.isDateOnlyField(p)||n.isTimestampOffsetField(p)};a.isIntegerField=function(p,A){p=A&&p.getField(A);return!!p&&B.has(p.type)};a.unitValueInDays=x;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/basemapUtils":function(){define("exports ../Basemap ../config ../core/Collection ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/ensureType ../layers/effects/utils ./basemapDefinitions".split(" "),
function(a,d,n,z,r,G,b,m,f,v){function x(k,h){let t;if("string"===typeof k){const J=k in v.esriBasemapDefinitions,U=!J&&k.includes("/");if(!J&&!U)return n.apiKey?T().warn(`Unable to find basemap definition for: ${k}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`):(h=Object.entries(v.esriBasemapDefinitions).filter(([,Y])=>Y.classic||Y.is3d).map(([Y])=>`"${Y}"`).sort().join(", "),T().warn(`Unable to find basemap definition for: ${k}. Try one of these: ${h}`)),null;h&&(t=
h[k]);t||(t=J?d.fromId(k):new d({style:{id:k}}),h&&(h[k]=t))}else t=m.ensureType(d,k);t?.destroyed&&(T().warn("The provided basemap is already destroyed",{basemap:t}),t=null);return t}function B(k){if(y)return y(k);let h=null;k=F(k);const t=!k?.baseLayers.length;for(const U in v.esriBasemapDefinitions){var J=H(v.esriBasemapDefinitions[U]);J=I(k,J,{mustMatchReferences:t});if("equal"===J){h=U;break}"base-layers-equal"===J&&(h=U)}return h}function D(k,h){const t=new z;k.forEach(J=>{const U=h.find(Y=>
"scene"!==Y.type&&C(c(J),c(Y)))||J;t.includes(U)?t.push(J):t.push(U)});return t}function p(k){if(A(k.url))return!0;if("vector-tile"===k.type)for(const h in k.sourceNameToSource)if(A(k.sourceNameToSource[h]?.sourceUrl))return!0;return!1}function A(k){if(!k)return!1;k=new b.Url(b.makeAbsolute(k));return!!k.authority&&R.test(k.authority)}function F(k){return k?!k.loaded&&k.resourceInfo?H(k.resourceInfo.data):{baseLayers:q(k.baseLayers),referenceLayers:q(k.referenceLayers)}:null}function q(k){return(z.isCollection(k)?
k.toArray():k).map(c)}function c(k){return{type:k.type,effect:"effect"in k?k.effect:void 0,url:N("urlTemplate"in k&&k.urlTemplate||k.url||"styleUrl"in k&&k.styleUrl||""),minScale:"minScale"in k&&null!=k.minScale?k.minScale:0,maxScale:"maxScale"in k&&null!=k.maxScale?k.maxScale:0,opacity:null!=k.opacity?k.opacity:1,visible:null!=k.visible?!!k.visible:!0,sublayers:"map-image"!==k.type&&"wms"!==k.type||null==k.sublayers?void 0:k.sublayers?.map(h=>({id:h.id,visible:h.visible})),activeLayerId:"wmts"===
k.type?k.activeLayer?.id:void 0}}function l(k){return k.isReference||"ArcGISSceneServiceLayer"===k.layerType}function H(k){return k?{baseLayers:g((k.baseMapLayers??[]).filter(h=>!l(h))),referenceLayers:g((k.baseMapLayers??[]).filter(h=>l(h)))}:null}function g(k){return k.map(h=>{let t;switch(h.layerType){case "VectorTileLayer":t="vector-tile";break;case "ArcGISTiledMapServiceLayer":t="tile";break;case "ArcGISSceneServiceLayer":t="scene";break;default:t="unknown"}return{type:t,effect:h.effect,url:N(h.templateUrl||
h.urlTemplate||h.styleUrl||h.url),minScale:h.minScale??0,maxScale:h.maxScale??0,opacity:h.opacity??1,visible:null!=h.visibility?!!h.visibility:!0,sublayers:void 0,activeLayerId:void 0}})}function I(k,h,t){return null!=k!==(null!=h)?"not-equal":k&&h?E(k.baseLayers,h.baseLayers)?E(k.referenceLayers,h.referenceLayers)?"equal":t.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function E(k,h){if(k.length!==h.length)return!1;for(let t=0;t<k.length;t++)if(!C(k[t],h[t]))return!1;return!0}
function C(k,h){if(k.type!==h.type||k.url!==h.url||k.minScale!==h.minScale||k.maxScale!==h.maxScale||k.visible!==h.visible||k.opacity!==h.opacity||!f.effectEquals(k.effect,h.effect))return!1;if(null!=k.activeLayerId||null!=h.activeLayerId)return k.activeLayerId===h.activeLayerId;if(null!=k.sublayers||null!=h.sublayers){if(null==k.sublayers||null==h.sublayers||k.sublayers.length!==h.sublayers.length)return!1;for(let t=0;t<k.sublayers.length;t++){const J=k.sublayers.at(t),U=h.sublayers.at(t);if(J?.id!==
U?.id||J?.visible!==U?.visible)return!1}}return!0}function N(k){return k?b.normalize(k).replace(/^\s*https?:/i,"").toLowerCase():""}function Q(k){return"portalItem"in k?k.portalItem?.thumbnailUrl:void 0}const T=()=>r.getLogger("esri.support.basemapUtils");let y;const R=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;a.clonePreservingTiledLayers=function(k,h=null){k=x(k);if(!k)return null;k=k.clone();h&&(k.baseLayers=D(k.baseLayers,h.baseLayers),k.referenceLayers=D(k.referenceLayers,h.referenceLayers));
return k};a.contentEquals=function(k,h){if(k===h||null!=k?.portalItem?.id&&k.portalItem.id===h?.portalItem?.id)return!0;k=F(k);h=F(h);return"equal"===I(k,h,{mustMatchReferences:!0})};a.createCache=function(){return{}};a.destroyCache=function(k){for(const h in k)G.destroyMaybe(k[h]),delete k[h]};a.ensureType=x;a.findSpatialReference=function(k,h){if(null==h||null==k)return{spatialReference:null,updating:!1};if("not-loaded"===h.loadStatus)return h.load(),{spatialReference:null,updating:!0};if(h.spatialReference)return{spatialReference:h.spatialReference,
updating:!1};if(0===h.baseLayers.length)return{spatialReference:null,updating:!1};h=h.baseLayers.at(0);switch(h.loadStatus){case "not-loaded":h.load();case "loading":return{spatialReference:null,updating:!0};case "failed":return{spatialReference:null,updating:!1}}h=(("supportedSpatialReferences"in h?h.supportedSpatialReferences:null)||["tileInfo"in h?h.tileInfo?.spatialReference:h.spatialReference]).filter(Boolean);const t=k.spatialReference;return t?{spatialReference:h.find(J=>t.equals(J))??h[0]??
null,updating:!1}:{spatialReference:h[0],updating:!1}};a.getBasemapThumbnailUrl=function(k){if(!k)return null;var {thumbnailUrl:h}=k;return h?h:(h=B(k))?v.esriBasemapDefinitions[h].thumbnailUrl:G.mappedFind(k.baseLayers,Q)};a.getWellKnownBasemapId=B;a.hasDeveloperBasemapLayer=function(k){return!!k?.baseLayers.concat(k.referenceLayers).some(p)};a.isBasemap3D=function(k){return"Web Scene"===k.portalItem?.type||k.referenceLayers.some(h=>"scene"===h.type)};a.isBasemapInBeta=function(k){return!!k?.portalItem?.tags?.some(h=>
"beta"===h.toLowerCase())};a.isBasemapLayer=function(k,h){return k.basemap?.referenceLayers?.some(t=>t.uid===h)||k.basemap?.baseLayers?.some(t=>t.uid===h)};a.isDeveloperBasemapLayer=p;a.overrideGetWellKnownBasemapId=function(k){y=k};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/Basemap":function(){define("require ./chunks/tslib.es6 ./request ./core/Collection ./core/collectionUtils ./core/JSONSupport ./core/lang ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/promiseUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./geometry/SpatialReference ./portal/Portal ./portal/PortalItem ./support/basemapDefinitions ./support/BasemapStyle ./webdoc/support/writeUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H,g,I,E){var C;let N=0;G=C=class extends G.JSONSupportMixin(m){constructor(y){super(y);this.thumbnailUrl=this.style=this.spatialReference=this.portalItem=this.id=null;this.title="Basemap";this.id=Date.now().toString(16)+"-basemap-"+N++;this.baseLayers=new z;this.referenceLayers=new z;const R=k=>{k.parent&&k.parent!==this&&"remove"in k.parent&&k.parent.remove(k);k.parent=this;"elevation"===k.type&&v.getLogger(this).error(`Layer '${k.title}, id:${k.id}' of type '${k.type}' is not supported as a basemap layer and will therefore be ignored.`)};
this.addHandles([this.baseLayers.on("after-add",k=>R(k.item)),this.referenceLayers.on("after-add",k=>R(k.item)),this.baseLayers.on("after-remove",k=>{k.item.parent=null}),this.referenceLayers.on("after-remove",k=>{k.item.parent=null})])}initialize(){this.when().catch(y=>{v.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,y)});this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var y=this.baseLayers.toArray();for(const R of y)R.destroy();
y=this.referenceLayers.toArray();for(const R of y)R.destroy();this.baseLayers.destroy();this.referenceLayers.destroy();this.portalItem=x.destroyMaybe(this.portalItem)}normalizeCtorArgs(y){y&&"resourceInfo"in y&&(this._set("resourceInfo",y.resourceInfo),y={...y},delete y.resourceInfo);return y}set baseLayers(y){this._set("baseLayers",r.referenceSetter(y,this._get("baseLayers")))}_writeBaseLayers(y,R,k){const h=[];y&&(k={...k,layerContainerType:"basemap"},this.baseLayers.forEach(t=>{t=E.getLayerJSON(t,
k.webmap?k.webmap.getLayerJSONFromResourceInfo(t):null,k);null!=t&&h.push(t)}),this.referenceLayers.forEach(t=>{const J=E.getLayerJSON(t,k.webmap?k.webmap.getLayerJSONFromResourceInfo(t):null,k);null!=J&&("scene"!==t.type&&(J.isReference=!0),h.push(J))}));R.baseMapLayers=h}set referenceLayers(y){this._set("referenceLayers",r.referenceSetter(y,this._get("referenceLayers")))}writeTitle(y,R){R.title=y||"Basemap"}load(y){this.addResolvingPromise(this._loadFromSource(y));return Promise.resolve(this)}loadAll(){return f.loadAll(this,
y=>{y(this.baseLayers,this.referenceLayers)})}clone(){const y={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(R=>b.isClonable(R)?R.clone():R),referenceLayers:this.referenceLayers.map(R=>b.isClonable(R)?R.clone():R)};this.loaded&&(y.loadStatus="loaded");return(new C({resourceInfo:this.resourceInfo})).set(y)}read(y,R){this.resourceInfo||this._set("resourceInfo",{data:y,context:R});super.read(y,R)}write(y,R){y=y||{};R?.origin||(R={origin:"web-map",...R});super.write(y,
R);!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(y.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(k=>{k=b.clone(k);k.url&&D.isProtocolRelative(k.url)&&(k.url=`https:${k.url}`);k.templateUrl&&D.isProtocolRelative(k.templateUrl)&&(k.templateUrl=`https:${k.templateUrl}`);return k}));return y}async _loadFromSource(y){const {resourceInfo:R,portalItem:k,style:h}=this;B.throwIfAborted(y);const t=[];R?(t.push(this._loadLayersFromJSON(R.data,R.context?R.context.url:null,y)),R.data.id&&!R.data.title&&
t.push(g.getBasemapTitle(R.data.id).then(J=>{J&&this.read({title:J},R.context)}))):k?t.push(this._loadFromItem(k,y)):h&&t.push(this._loadFromStylesService(h,y));await Promise.all(t)}async _loadLayersFromJSON(y,R,k){const h=this.resourceInfo?.context,t=this.portalItem?.portal||h?.portal||null,J=T[h?.origin||""]??"web-map",{populateOperationalLayers:U}=await new Promise((da,ia)=>a(["./layers/support/layersCreator"],da,ia)),Y=[];B.throwIfAborted(k);if(y.baseMapLayers&&Array.isArray(y.baseMapLayers)){R=
{context:{...h,origin:J,url:R,portal:t,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"};const da=ia=>"web-scene"===J&&"ArcGISSceneServiceLayer"===ia.layerType||ia.isReference;k=U(this.baseLayers,y.baseMapLayers.filter(ia=>!da(ia)),R);Y.push(k);y=U(this.referenceLayers,y.baseMapLayers.filter(da),R);Y.push(y)}await Promise.allSettled(Y)}async _loadFromItem(y,R){const k=await (await y.load(R)).fetchData("json",R),h=D.urlToObject(y.itemUrl??"");this._set("resourceInfo",{data:k.baseMap??
{},context:{origin:Q[y.type||""]??"web-map",portal:y.portal||l.getDefault(),url:h}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:k.spatialReference},this.resourceInfo.context);this.read({title:y.title,thumbnailUrl:y.thumbnailUrl},{origin:"portal-item",portal:y.portal||l.getDefault(),url:h});return this._loadLayersFromJSON(this.resourceInfo.data,h,R)}async _loadFromStylesService(y,R){var k=`${y.serviceUrl}/${y.id}`;const h=(await n(k,{query:{language:y.getLanguageParamValue(),
places:y.places,worldview:y.worldview,token:y.apiKey},signal:R?.signal})).data;k=D.urlToObject(k);this._set("resourceInfo",{data:h.baseMap??{},context:{origin:"web-map",url:k}});this.read(this.resourceInfo.data,this.resourceInfo.context);this.read({spatialReference:h.spatialReference},this.resourceInfo.context);await this._loadLayersFromJSON(this.resourceInfo.data,k,R);if(y.apiKey)for(const t of[...this.baseLayers,...this.referenceLayers])"apiKey"in t&&(t.apiKey=y.apiKey)}static fromId(y){return(y=
g.esriBasemapDefinitions[y])?y.itemId?new C({portalItem:{id:y.itemId,portal:{url:"https://www.arcgis.com"}}}):C.fromJSON(y,{origin:y.is3d?"web-scene":"web-map"}):null}};d.__decorate([p.property({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(y,R,k,h){this._writeBaseLayers(y,R,h)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:z}},writer(y,R,k,h){this._writeBaseLayers(y,R,h)}}}}}})],G.prototype,"baseLayers",null);d.__decorate([p.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],
G.prototype,"id",void 0);d.__decorate([p.property({type:H})],G.prototype,"portalItem",void 0);d.__decorate([p.property()],G.prototype,"referenceLayers",null);d.__decorate([p.property({readOnly:!0})],G.prototype,"resourceInfo",void 0);d.__decorate([p.property({type:c})],G.prototype,"spatialReference",void 0);d.__decorate([p.property({type:I})],G.prototype,"style",void 0);d.__decorate([p.property()],G.prototype,"thumbnailUrl",void 0);d.__decorate([p.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],
G.prototype,"title",void 0);d.__decorate([q.writer("title")],G.prototype,"writeTitle",null);G=C=d.__decorate([F.subclass("esri.Basemap")],G);const Q={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},T={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"};return G})},"esri/core/collectionUtils":function(){define(["exports","./Collection"],function(a,d){a.castForReferenceSetter=function(n){return n};a.referenceSetter=function(n,z,r=d){z||=new r;if(z===n)return z;
z.removeAll();n&&(Array.isArray(n)||"items"in n&&Array.isArray(n.items))?z.addMany(n):n&&z.add(n);return z};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/Loadable":function(){define("../chunks/tslib.es6 ./Error ./maybe ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators/property ./accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m){const f=v=>{v=class extends v{constructor(...x){super(...x);this.loadError=this._loadController=null;this.loadStatus=
"not-loaded";this._set("loadWarnings",[]);this.addResolvingPromise(new Promise(B=>{const D=this.load.bind(this);this.load=p=>{const A=new Promise((F,q)=>{const c=r.onAbortOrThrow(p,q);this.destroyed&&q(new d("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this}));this.when(F,q).finally(()=>{c&&c.remove()})});if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const F=this._loadController=new AbortController;D({signal:F.signal})}B();
return A}}));this.when(()=>{this._set("loadStatus","loaded");this._loadController=null},B=>{this._set("loadStatus","failed");this._set("loadError",B);this._loadController=null})}destroy(){this._loadController&&(this._loadController=n.abortMaybe(this._loadController),this._promiseProps.abort());this._set("loadError",null);this._set("loadWarnings",[])}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){if(this.isFulfilled())return this;
this._set("loadError",new d("load:cancelled","Cancelled"));this._loadController?.abort();this._promiseProps.abort();return this}};a.__decorate([b.property({readOnly:!0})],v.prototype,"loaded",null);a.__decorate([b.property({readOnly:!0})],v.prototype,"loadError",void 0);a.__decorate([b.property({clonable:!1})],v.prototype,"loadStatus",void 0);a.__decorate([b.property({type:[G],readOnly:!0})],v.prototype,"loadWarnings",null);return v=a.__decorate([m.subclass("esri.core.Loadable")],v)};z=class extends f(z.EsriPromise){};
z=a.__decorate([m.subclass("esri.core.Loadable")],z);(function(v){v.LoadableMixin=f;v.isLoadable=function(x){return!(!x||!x.load)}})(z||={});return z})},"esri/core/Promise":function(){define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(a,d,n,z,r){var G;(function(f){f[f.PENDING=0]="PENDING";f[f.RESOLVED=1]="RESOLVED";f[f.REJECTED=2]="REJECTED"})(G||={});class b{constructor(){this._resolver=z.createResolver();this._status=G.PENDING;
this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=G.RESOLVED;this._cleanUp()},()=>{this._status=G.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(f){this._resolvingPromises.push(f);this._tryResolve()}isResolved(){return this._status===G.RESOLVED}isRejected(){return this._status===G.REJECTED}isFulfilled(){return this._status!==G.PENDING}abort(){this._resolver.reject(z.createAbortError())}_cleanUp(){this._resolvingPromises=
this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var f=z.createResolver(),v=[...this._resolvingPromises,f.promise],x=this._allPromise=Promise.all(v);x.then(()=>{this.isFulfilled()||this._allPromise!==x||this._resolver.resolve()},B=>{this.isFulfilled()||this._allPromise!==x||z.isAbortError(B)||this._resolver.reject(B)});f.resolve()}}}const m=f=>{f=class extends f{constructor(...v){super(...v);this._promiseProps=new b;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(v,
x){return this._promiseProps.promise.then(()=>this).then(v,x)}catch(v){return this.when(null,v)}addResolvingPromise(v){v&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in v?v.when():v)}};return f=d.__decorate([r.subclass("esri.core.Promise")],f)};a.EsriPromise=class extends m(n){};a.EsriPromise=d.__decorate([r.subclass("esri.core.Promise")],a.EsriPromise);a.EsriPromiseMixin=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/loadAll":function(){define(["exports",
"./asyncUtils","./Collection","./Loadable"],function(a,d,n,z){async function r(G,b){const m=[],f=(...x)=>{for(const B of x)null!=B&&(Array.isArray(B)?f(...B):n.isCollection(B)?B.forEach(D=>f(D)):z.isLoadable(B)&&m.push(B))};b(f);let v=null;await d.map(m,async x=>{x=await d.result("loadAll"in x&&"function"===typeof x.loadAll?x.loadAll():x.load());!1!==x.ok||v||(v=x)});if(v)throw v.error;return G}a.loadAll=async function(G,b){await G.load();return r(G,b)};a.loadAllChildren=r;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/portal/Portal":function(){define("require ../chunks/tslib.es6 ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ../intl/locale ./portalDefault ./PortalGroup ./PortalQueryParams ./PortalQueryResult ./PortalUser ../support/apiKeyUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H,g,I,E,C){function N(h){const t=z.id;return()=>{const J=h.deref();J&&t.findCredential(J.restUrl)&&J.signIn().catch(()=>{})}}const Q=h=>Object.freeze(Object.defineProperty({__proto__:null,default:h},Symbol.toStringTag,{value:"Module"}));var T;let y;const R={PortalGroup:()=>Promise.resolve({default:H}),PortalItem:()=>new Promise((h,t)=>a(["./PortalItem"],J=>h(Q(J)),t)),PortalUser:()=>Promise.resolve({default:E})};b=T=class extends b.JSONSupportMixin(m){constructor(h){super(h);
this.access=this._esriIdCredentialCreateHandle=null;this.allSSL=!1;this.authMode="auto";this.bingKey=this.basemapGalleryGroupQuery3D=this.basemapGalleryGroupQuery=this.authorizedCrossOriginDomains=null;this.canProvisionDirectPurchase=this.canListPreProvisionedItems=this.canListData=this.canListApps=!1;this.canSearchPublic=!0;this.canSignInIDP=this.canSignInArcGIS=this.canSharePublic=this.canShareBingPublic=!1;this.colorSetsGroupQuery=null;this.commentsEnabled=!1;this.livingAtlasGroupQuery=this.layoutGroupQuery=
this.galleryTemplatesGroupQuery=this.featuredItemsGroupQuery=this.featuredGroups=this.eueiEnabled=this.devBasemapGalleryGroupQuery=this.description=this.defaultVectorBasemap=this.defaultExtent=this.defaultDevBasemap=this.defaultBasemap=this.default3DBasemapQuery=this.customBaseUrl=this.culture=this.created=null;this.hasClassificationSchema=this.hasCategorySchema=!1;this.ipCntryCode=this.id=this.httpsPort=this.httpPort=this.homePageFeaturedContentCount=this.homePageFeaturedContent=this.helperServices=
null;this.isReadOnly=this.isPortal=!1;this.region=this.portalProperties=this.portalMode=this.portalHostname=this.name=this.modified=this.maxTokenExpirationMinutes=this.layerTemplatesGroupQuery=null;this.recycleBinEnabled=!1;this.rotatorPanels=null;this.showHomePageDescription=!1;this.sourceJSON=null;this.supportsHostedServices=!1;this.units=this.templatesGroupQuery=this.symbolSetsGroupQuery=null;this.url=n.portalUrl;this.user=this.urlKey=null;this.use3dBasemaps=!0;this.useVectorBasemaps=this.useStandardizedQuery=
this.useDefault3dBasemap=!1;this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(h){return"string"===typeof h?{url:h}:h}destroy(){k.unregister(this);this.defaultBasemap=f.destroyMaybe(this.defaultBasemap);this.defaultDevBasemap=f.destroyMaybe(this.defaultDevBasemap);this.defaultVectorBasemap=f.destroyMaybe(this.defaultVectorBasemap);this._esriIdCredentialCreateHandle=f.removeMaybe(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(h){if(h)for(const t of h)n.request.trustedServers.includes(t)||
n.request.trustedServers.push(t);return h}readDefaultBasemap(h){return this._readBasemap(h)}readDefaultDevBasemap(h){return this._readBasemap(h)}readDefaultVectorBasemap(h){return this._readBasemap(h)}get extraQuery(){const h=!this.user?.orgId||this.canSearchPublic;return this.id&&!h?` AND orgid:${this.id}`:null}get hasAPIKey(){return C.isApiKeyApplicable(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let h=this.url;
if(h){const t=h.indexOf("/sharing");h=0<t?h.slice(0,t):this.url.replace(/\/+$/,"");h+="/sharing/rest"}return h}get thumbnailUrl(){const h=this.restUrl,t=this.thumbnail;return h&&t?this._normalizeSSL(h+"/portals/self/resources/"+t):null}readUrlKey(h){return h?h.toLowerCase():h}readUser(h){let t=null;h&&(t=E.fromJSON(h),t.portal=this);return t}load(h){const t=(new Promise((J,U)=>a(["../Basemap"],Y=>J(Q(Y)),U))).then(({default:J})=>{v.throwIfAborted(h);y=J}).then(()=>this.sourceJSON?this.sourceJSON:
this.fetchSelf(this.authMode,!1,h)).then(J=>{if(!this.hasAPIKey&&z.id){const U=z.id;this.credential=U.findCredential(this.restUrl);this.credential||this.authMode!==T.AUTH_MODE_AUTO&&this.authMode!==T.AUTH_MODE_NO_PROMPT||(this._esriIdCredentialCreateHandle?.remove(),this._esriIdCredentialCreateHandle=U.on("credential-create",N(new WeakRef(this))),k.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=J;this.read(J)});this.addResolvingPromise(t);return Promise.resolve(this)}async createElevationLayers(){await this.load();
const h=this._getHelperService("defaultElevationLayers"),t=(await new Promise((J,U)=>a(["../layers/ElevationLayer"],Y=>J(Q(Y)),U))).default;return h?h.map(J=>new t({id:J.id,url:J.url})):[]}async fetchBasemaps(h,t){const J=await this._fetchBasemaps(h,t);!0===t?.include3d&&!1!==this.use3dBasemaps&&(h=await this._fetchBasemaps3D(h,t),J.unshift(...h));return J}async fetchDefault3DBasemap(h){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||"none"===this.default3DBasemapQuery)return null;const t=
new g;t.query=this.default3DBasemapQuery;t.disableExtraQuery=!0;return(h=(await this.queryItems(t,h)).results.find(J=>"Web Scene"===J.type))?new y({portalItem:h}):null}fetchCategorySchema(h){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",h).then(t=>t.categorySchema):v.isAborted(h)?Promise.reject(v.createAbortError()):Promise.resolve([])}fetchFeaturedGroups(h){const t=this.featuredGroups,J=new g({num:100,sortField:"title"});if(t?.length){const U=[];for(const Y of t)U.push(`(title:"${Y.title}" AND owner:${Y.owner})`);
J.query=U.join(" OR ");return this.queryGroups(J,h).then(Y=>Y.results)}return v.isAborted(h)?Promise.reject(v.createAbortError()):Promise.resolve([])}fetchRegions(h){const t=this.user?.culture||this.culture||c.getLocale();return this.request(this.restUrl+"/portals/regions",{...h,query:{culture:t}})}fetchSettings(h){const t=this.user?.culture||this.culture||c.getLocale();return this.request(this.restUrl+"/portals/self/settings",{...h,query:{culture:t}})}static getDefault(){return l.ensureDefaultPortalInstance(()=>
new T)}queryGroups(h,t){return this.queryPortal("/community/groups",h,"PortalGroup",t)}queryItems(h,t){return this.queryPortal("/search",h,"PortalItem",t)}queryUsers(h,t){h.sortField||(h.sortField="username");return this.queryPortal("/community/users",h,"PortalUser",t)}fetchSelf(h=this.authMode,t=!1,J){const U=this.restUrl+"/portals/self";h={authMode:h,query:{culture:c.getLocale().toLowerCase()},withCredentials:!0,...J};"auto"===h.authMode&&(h.authMode="no-prompt");t&&(h.query.default=!0);return this.request(U,
h)}queryPortal(h,t,J,U){const Y=B.ensureType(g,t),da=ia=>this.request(this.restUrl+h,{...Y.toRequestOptions(this),...U}).then(na=>{const oa=Y.clone();oa.start=na.nextStart;return new I({nextQueryParams:oa,queryParams:Y,total:na.total,results:T._resultsToTypedArray(ia,{portal:this},na,U)})}).then(na=>Promise.all(na.results.map(oa=>"function"===typeof oa.when?oa.when():na)).then(()=>na,oa=>{v.throwIfAbortError(oa);return na}));return J&&R[J]?R[J]().then(({default:ia})=>{v.throwIfAborted(U);return da(ia)}):
da()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new G("portal:not-authenticated","Unable to authenticate user. Portal.user is missing");});if(this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT&&!z.id)return Promise.reject(new G("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const h=t=>Promise.resolve().then(()=>{if("not-loaded"===this.loadStatus)return t||
(this.authMode="immediate"),this.load().then(()=>null);if("loading"===this.loadStatus)return this.load().then(()=>{if(this.credential)return null;this.credential=t;return this.fetchSelf("immediate")});if(this.user&&this.credential===t)return null;this.credential=t;return this.fetchSelf("immediate")}).then(J=>{J&&(this.sourceJSON=J,this.read(J))});return z.id?z.id.getCredential(this.restUrl,{prompt:this.authMode!==T.AUTH_MODE_NO_PROMPT}).then(t=>h(t)):h(this.credential)}normalizeUrl(h){const t=this.credential?.token;
return this._normalizeSSL(t?h+(h.includes("?")?"\x26":"?")+"token\x3d"+t:h)}requestToTypedArray(h,t,J){return this.request(h,t).then(U=>{const Y=T._resultsToTypedArray(J,{portal:this},U);return Promise.all(Y.map(da=>"function"===typeof da.when?da.when():U)).then(()=>Y,()=>Y)})}request(h,t={}){var J={f:"json",...t.query};const {authMode:U=this.authMode===T.AUTH_MODE_ANONYMOUS||this.authMode===T.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:Y=null,cacheBust:da=!1,method:ia="auto",responseType:na="json",
signal:oa}=t;J={authMode:U,body:Y,cacheBust:da,method:ia,query:J,responseType:na,timeout:0,signal:oa};t.withCredentials&&(J.withCredentials=!0);return r(this._normalizeSSL(h),J).then(pa=>pa.data)}toJSON(){throw new G("internal:not-yet-implemented","Portal.toJSON is not yet implemented");}static fromJSON(h){if(!h)return null;if(h.declaredClass)throw Error("JSON object is already hydrated");return new T({sourceJSON:h})}_getHelperService(h){const t=this.helperServices&&this.helperServices[h];if(!t)throw new G("portal:service-not-found",
`The \`helperServices\` do not include an entry named "${h}"`);return t}async _fetchBasemaps(h,t){const J=new g;J.query=h||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);J.disableExtraQuery=!0;h=await this.queryGroups(J,t);if(!h.total)return[];h=h.results[0];J.num=100;J.query='type:"Web Map" -type:"Web Application"';J.sortField=h.sortField||"name";J.sortOrder=h.sortOrder||"desc";t=await h.queryItems(J,t);return t.total?
t.results.filter(U=>"Web Map"===U.type).map(U=>new y({portalItem:U})):[]}async _fetchBasemaps3D(h,t){h=h||this.basemapGalleryGroupQuery3D;if(!h)return[];h=new g({query:h,disableExtraQuery:!0});var J=await this.queryGroups(h,t);if(!J.total)return[];J=J.results[0];h.num=100;h.query='type:"Web Scene"';h.sortField=J.sortField||"name";h.sortOrder=J.sortOrder||"desc";t=await J.queryItems(h,t);return t.total?t.results.filter(U=>"Web Scene"===U.type).map(U=>new y({portalItem:U})):[]}_normalizeSSL(h){return h.replace(/^http:/i,
"https:").replace(":7080",":7443")}_readBasemap(h){return h?(h=y.fromJSON(h),h.portalItem={portal:this},h):null}static _resultsToTypedArray(h,t,J,U){if(J){const Y=null!=U?U.signal:null;J=J.listings||J.notifications||J.userInvitations||J.tags||J.items||J.groups||J.comments||J.provisions||J.results||J.relatedItems||J;if(h||t)J=J.map(da=>{da=Object.assign(h?h.fromJSON(da):da,t);"function"===typeof da.load&&da.load(Y);return da})}else J=[];return J}};b.AUTH_MODE_ANONYMOUS="anonymous";b.AUTH_MODE_AUTO=
"auto";b.AUTH_MODE_IMMEDIATE="immediate";b.AUTH_MODE_NO_PROMPT="no-prompt";d.__decorate([x.property()],b.prototype,"access",void 0);d.__decorate([x.property()],b.prototype,"allSSL",void 0);d.__decorate([x.property()],b.prototype,"authMode",void 0);d.__decorate([x.property()],b.prototype,"authorizedCrossOriginDomains",void 0);d.__decorate([A.reader("authorizedCrossOriginDomains")],b.prototype,"readAuthorizedCrossOriginDomains",null);d.__decorate([x.property()],b.prototype,"basemapGalleryGroupQuery",
void 0);d.__decorate([x.property({json:{name:"3DBasemapGalleryGroupQuery"}})],b.prototype,"basemapGalleryGroupQuery3D",void 0);d.__decorate([x.property()],b.prototype,"bingKey",void 0);d.__decorate([x.property()],b.prototype,"canListApps",void 0);d.__decorate([x.property()],b.prototype,"canListData",void 0);d.__decorate([x.property()],b.prototype,"canListPreProvisionedItems",void 0);d.__decorate([x.property()],b.prototype,"canProvisionDirectPurchase",void 0);d.__decorate([x.property()],b.prototype,
"canSearchPublic",void 0);d.__decorate([x.property()],b.prototype,"canShareBingPublic",void 0);d.__decorate([x.property()],b.prototype,"canSharePublic",void 0);d.__decorate([x.property()],b.prototype,"canSignInArcGIS",void 0);d.__decorate([x.property()],b.prototype,"canSignInIDP",void 0);d.__decorate([x.property()],b.prototype,"colorSetsGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"commentsEnabled",void 0);d.__decorate([x.property({type:Date})],b.prototype,"created",void 0);d.__decorate([x.property()],
b.prototype,"credential",void 0);d.__decorate([x.property()],b.prototype,"culture",void 0);d.__decorate([x.property()],b.prototype,"currentVersion",void 0);d.__decorate([x.property()],b.prototype,"customBaseUrl",void 0);d.__decorate([x.property()],b.prototype,"default3DBasemapQuery",void 0);d.__decorate([x.property()],b.prototype,"defaultBasemap",void 0);d.__decorate([A.reader("defaultBasemap")],b.prototype,"readDefaultBasemap",null);d.__decorate([x.property()],b.prototype,"defaultDevBasemap",void 0);
d.__decorate([A.reader("defaultDevBasemap")],b.prototype,"readDefaultDevBasemap",null);d.__decorate([x.property({type:q})],b.prototype,"defaultExtent",void 0);d.__decorate([x.property()],b.prototype,"defaultVectorBasemap",void 0);d.__decorate([A.reader("defaultVectorBasemap")],b.prototype,"readDefaultVectorBasemap",null);d.__decorate([x.property()],b.prototype,"description",void 0);d.__decorate([x.property()],b.prototype,"devBasemapGalleryGroupQuery",void 0);d.__decorate([x.property()],b.prototype,
"eueiEnabled",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,"extraQuery",null);d.__decorate([x.property()],b.prototype,"featuredGroups",void 0);d.__decorate([x.property()],b.prototype,"featuredItemsGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"galleryTemplatesGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"layoutGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"livingAtlasGroupQuery",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,
"hasAPIKey",null);d.__decorate([x.property()],b.prototype,"hasCategorySchema",void 0);d.__decorate([x.property()],b.prototype,"hasClassificationSchema",void 0);d.__decorate([x.property()],b.prototype,"helpBase",void 0);d.__decorate([x.property()],b.prototype,"helperServices",void 0);d.__decorate([x.property()],b.prototype,"helpMap",void 0);d.__decorate([x.property()],b.prototype,"homePageFeaturedContent",void 0);d.__decorate([x.property()],b.prototype,"homePageFeaturedContentCount",void 0);d.__decorate([x.property()],
b.prototype,"httpPort",void 0);d.__decorate([x.property()],b.prototype,"httpsPort",void 0);d.__decorate([x.property()],b.prototype,"id",void 0);d.__decorate([x.property()],b.prototype,"ipCntryCode",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,"isOrganization",null);d.__decorate([x.property()],b.prototype,"isPortal",void 0);d.__decorate([x.property()],b.prototype,"isReadOnly",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,"itemPageUrl",null);d.__decorate([x.property()],
b.prototype,"layerTemplatesGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"maxTokenExpirationMinutes",void 0);d.__decorate([x.property({type:Date})],b.prototype,"modified",void 0);d.__decorate([x.property()],b.prototype,"name",void 0);d.__decorate([x.property()],b.prototype,"portalHostname",void 0);d.__decorate([x.property()],b.prototype,"portalMode",void 0);d.__decorate([x.property()],b.prototype,"portalProperties",void 0);d.__decorate([x.property()],b.prototype,"region",void 0);d.__decorate([x.property()],
b.prototype,"recycleBinEnabled",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,"restUrl",null);d.__decorate([x.property()],b.prototype,"rotatorPanels",void 0);d.__decorate([x.property()],b.prototype,"showHomePageDescription",void 0);d.__decorate([x.property()],b.prototype,"sourceJSON",void 0);d.__decorate([x.property()],b.prototype,"staticImagesUrl",void 0);d.__decorate([x.property({json:{name:"2DStylesGroupQuery"}})],b.prototype,"stylesGroupQuery2d",void 0);d.__decorate([x.property({json:{name:"stylesGroupQuery"}})],
b.prototype,"stylesGroupQuery3d",void 0);d.__decorate([x.property()],b.prototype,"supportsHostedServices",void 0);d.__decorate([x.property()],b.prototype,"symbolSetsGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"templatesGroupQuery",void 0);d.__decorate([x.property()],b.prototype,"thumbnail",void 0);d.__decorate([x.property({readOnly:!0})],b.prototype,"thumbnailUrl",null);d.__decorate([x.property()],b.prototype,"units",void 0);d.__decorate([x.property()],b.prototype,"url",void 0);d.__decorate([x.property()],
b.prototype,"urlKey",void 0);d.__decorate([A.reader("urlKey")],b.prototype,"readUrlKey",null);d.__decorate([x.property()],b.prototype,"user",void 0);d.__decorate([A.reader("user")],b.prototype,"readUser",null);d.__decorate([x.property()],b.prototype,"use3dBasemaps",void 0);d.__decorate([x.property()],b.prototype,"useDefault3dBasemap",void 0);d.__decorate([x.property()],b.prototype,"useStandardizedQuery",void 0);d.__decorate([x.property()],b.prototype,"useVectorBasemaps",void 0);d.__decorate([x.property()],
b.prototype,"vectorBasemapGalleryGroupQuery",void 0);d=b=T=d.__decorate([F.subclass("esri.portal.Portal")],b);const k=new FinalizationRegistry(h=>{h.remove()});return d})},"esri/portal/portalDefault":function(){define(["exports"],function(a){let d;a.clearDefaultPortalInstance=function(){d=void 0};a.ensureDefaultPortalInstance=function(n){if(!d||d.destroyed)d=n();return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/portal/PortalGroup":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./PortalQueryParams".split(" "),
function(a,d,n,z,r,G,b,m,f){var v;n=v=class extends n.JSONSupport{constructor(x){super(x);this.id=this.description=this.created=this.access=null;this.isInvitationOnly=!1;this.title=this.tags=this.sourceJSON=this.sortOrder=this.sortField=this.snippet=this.portal=this.owner=this.modified=null}get thumbnailUrl(){const x=this.url,B=this.thumbnail;return x&&B&&this.portal?this.portal?.normalizeUrl(`${x}/info/${B}?f=json`):null}get url(){const x=this.portal?.restUrl;return x?x+"/community/groups/"+this.id:
null}fetchCategorySchema(x){return this.portal.request(this.url+"/categorySchema",x).then(B=>{B=B.categorySchema||[];return B.some(D=>"contentCategorySetsGroupQuery.LivingAtlas"===D.source)?this._fetchCategorySchemaSet("LivingAtlas",x):B})}fetchMembers(x){return this.portal.request(this.url+"/users",x)}getThumbnailUrl(x){let B=this.thumbnailUrl;B&&x&&(B+=`&w=${x}`);return B}toJSON(){throw new d("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");}static fromJSON(x){if(!x)return null;
if(x.declaredClass)throw Error("JSON object is already hydrated");const B=new v({sourceJSON:x});B.read(x);return B}queryItems(x,B){x=r.ensureType(f,x);const D=this.portal;if(5<parseFloat(D.currentVersion))return x=x||new f,D.queryPortal(`/content/groups/${this.id}/search`,x,"PortalItem",B);x=x?x.clone():new f;x.query="group:"+this.id+(x.query?" "+x.query:"");return D.queryItems(x,B)}_fetchCategorySchemaSet(x,B){const D=this.portal;return D.fetchSelf(D.authMode,!0,B).then(p=>{if(p=p.contentCategorySetsGroupQuery)return p=
new f({disableExtraQuery:!0,num:1,query:p}),D.queryGroups(p,B);throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(p=>{if(p.total){p=p.results[0];const A=new f({num:1,query:`typekeywords:"${x}"`});return p.queryItems(A,B)}throw new d("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found");}).then(p=>p.total?p.results[0].fetchData("json",B).then(A=>{A=A?.categorySchema;return A?.length?A:[]}):[])}};a.__decorate([z.property()],
n.prototype,"access",void 0);a.__decorate([z.property({type:Date})],n.prototype,"created",void 0);a.__decorate([z.property()],n.prototype,"description",void 0);a.__decorate([z.property()],n.prototype,"id",void 0);a.__decorate([z.property()],n.prototype,"isInvitationOnly",void 0);a.__decorate([z.property({type:Date})],n.prototype,"modified",void 0);a.__decorate([z.property()],n.prototype,"owner",void 0);a.__decorate([z.property()],n.prototype,"portal",void 0);a.__decorate([z.property()],n.prototype,
"snippet",void 0);a.__decorate([z.property()],n.prototype,"sortField",void 0);a.__decorate([z.property()],n.prototype,"sortOrder",void 0);a.__decorate([z.property()],n.prototype,"sourceJSON",void 0);a.__decorate([z.property()],n.prototype,"tags",void 0);a.__decorate([z.property()],n.prototype,"thumbnail",void 0);a.__decorate([z.property({readOnly:!0})],n.prototype,"thumbnailUrl",null);a.__decorate([z.property()],n.prototype,"title",void 0);a.__decorate([z.property({readOnly:!0})],n.prototype,"url",
null);return n=v=a.__decorate([m.subclass("esri.portal.PortalGroup")],n)})},"esri/portal/PortalQueryParams":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(a,d,n,z,r,G,b,m,f,v,x){var B;const D=new n.JSONMap({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});d=B=class extends d{constructor(p){super(p);this.categories=null;this.disableExtraQuery=!1;this.filter=this.extent=null;this.num=10;this.sortField=this.query=null;this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(p){"asc"!==p&&"desc"!==p||this._set("sortOrder",p)}clone(){return new B({categories:this.categories?z.clone(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():
null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(p,A){let F=[];this.categories&&(F=this.categories.map(l=>Array.isArray(l)?JSON.stringify(l):l));let q="";if(this.extent){var c=x.project(this.extent,v.WGS84);null!=c&&(q=`${c.xmin},${c.ymin},${c.xmax},${c.ymax}`)}c=this.query;!this.disableExtraQuery&&p.extraQuery&&(c="("+c+")"+p.extraQuery);p={categories:F,bbox:q,q:c,filter:this.filter,num:this.num,sortField:null,
sortOrder:null,start:this.start};this.sortField&&(p.sortField=this.sortField.split(",").map(l=>D.toJSON(l.trim())).join(","),p.sortOrder=this.sortOrder);return{query:{...A,...p}}}};a.__decorate([r.property()],d.prototype,"categories",void 0);a.__decorate([r.property()],d.prototype,"disableExtraQuery",void 0);a.__decorate([r.property({type:f})],d.prototype,"extent",void 0);a.__decorate([r.property()],d.prototype,"filter",void 0);a.__decorate([r.property()],d.prototype,"num",void 0);a.__decorate([r.property()],
d.prototype,"query",void 0);a.__decorate([r.property()],d.prototype,"sortField",void 0);a.__decorate([r.property()],d.prototype,"sortOrder",null);a.__decorate([r.property()],d.prototype,"start",void 0);return d=B=a.__decorate([m.subclass("esri.portal.PortalQueryParams")],d)})},"esri/portal/PortalQueryResult":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b){d=class extends d{constructor(m){super(m);this.total=this.results=this.queryParams=this.nextQueryParams=null}};a.__decorate([n.property()],d.prototype,"nextQueryParams",void 0);a.__decorate([n.property()],d.prototype,"queryParams",void 0);a.__decorate([n.property()],d.prototype,"results",void 0);a.__decorate([n.property()],d.prototype,"total",void 0);return d=a.__decorate([b.subclass("esri.portal.PortalQueryResult")],d)})},"esri/portal/PortalUser":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./PortalFolder ./PortalGroup".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x){var B;z=B=class extends z.JSONSupport{constructor(D){super(D);this.userType=this.userLicenseTypeId=this.username=this.units=this.sourceJSON=this.roleId=this.role=this.region=this.privileges=this.preferredView=this.portal=this.orgId=this.modified=this.fullName=this.email=this.description=this.culture=this.created=this.access=null}get thumbnailUrl(){const D=this.url,p=this.thumbnail;return D&&p?this.portal.normalizeUrl(`${D}/info/${p}?f=json`):null}get userContentUrl(){const D=
this.portal?.restUrl;return D?`${D}/content/users/${this.username}`:null}get url(){const D=this.portal?.restUrl;return D?`${D}/community/users/${this.username}`:null}addItem(D){const p=D&&D.item;var A=D?.data;D=D?.folder;const F={method:"post"};p&&(F.query=p.createPostQuery(),null!=A&&("string"===typeof A?F.query.text=A:"object"===typeof A&&(F.query.text=JSON.stringify(A))));A=this.userContentUrl;D&&(A+="/"+("string"===typeof D?D:D.id));return this.portal.request(A+"/addItem",F).then(q=>{p.id=q.id;
p.portal=this.portal;return p.loaded?p.reload():p.load()})}async deleteItem(D,p=!1){let A=this.userContentUrl;D.ownerFolder&&(A+="/"+D.ownerFolder);await this.portal.request(A+`/items/${D.id}/delete`,{method:"post",query:p?{permanentDelete:!0}:{}});D.id=null;D.portal=null}async deleteItems(D,p=!1){D=D.slice();var A=this.userContentUrl+"/deleteItems";const F=[];var q=D.map(c=>c.id);if(q.length){p={method:"post",query:{items:q.join(","),permanentDelete:p}};A=await this.portal.request(A,p);for(const c of A.results)A=
D.find(l=>c.itemId===l.id),p=c.success,q=null,p?(A.id=null,A.portal=null):c.error&&(q=new n("portal:delete-item-failed",c.error.message,c.error)),F.push({item:A,success:p,error:q})}return F}fetchFolders(){return this.portal.request(this.userContentUrl??"",{query:{num:1}}).then(D=>D&&D.folders?D.folders.map(p=>{p=v.fromJSON(p);p.portal=this.portal;return p}):[])}fetchGroups(){return this.portal.request(this.url??"").then(D=>D&&D.groups?D.groups.map(p=>{p=x.fromJSON(p);p.portal=this.portal;return p}):
[])}async fetchItems(D){D??={};var p=this.userContentUrl??"";D.folder&&(p+="/"+D.folder.id);const {default:A}=await new Promise((F,q)=>a(["./PortalItem"],c=>F(Object.freeze(Object.defineProperty({__proto__:null,default:c},Symbol.toStringTag,{value:"Module"}))),q));D=await this.portal.request(p,{query:{folders:!1,inRecycleBin:D.inRecycleBin?!0:null,foldersContent:!D.folder&&D.includeSubfolderItems?!0:null,num:D.num||10,start:D.start||1,sortField:D.sortField||"created",sortOrder:D.sortOrder||"asc"}});
return D?.items?(p=D.items.map(F=>{F=A.fromJSON(F);F.portal=this.portal;return F}),await Promise.all(p.map(F=>F.load())),{items:p,nextStart:D.nextStart,total:D.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(D=>D.tags)}getThumbnailUrl(D){let p=this.thumbnailUrl;p&&D&&(p+=`&w=${D}`);return p}queryFavorites(D){return this.favGroupId?(this._favGroup||(this._favGroup=new x({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(D)):Promise.reject(new n("internal:unknown",
"Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(D,p){await this.portal.request(this.userContentUrl+`/items/${D.id}/restore`,{method:"post",query:p?{folderID:"string"===typeof p?p:p.id}:null})}toJSON(){throw new n("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented");}static fromJSON(D){if(!D)return null;if(D.declaredClass)throw Error("JSON object is already hydrated");const p=new B({sourceJSON:D});p.read(D);return p}};d.__decorate([r.property()],
z.prototype,"access",void 0);d.__decorate([r.property({type:Date})],z.prototype,"created",void 0);d.__decorate([r.property()],z.prototype,"culture",void 0);d.__decorate([r.property()],z.prototype,"description",void 0);d.__decorate([r.property()],z.prototype,"email",void 0);d.__decorate([r.property()],z.prototype,"favGroupId",void 0);d.__decorate([r.property()],z.prototype,"fullName",void 0);d.__decorate([r.property({type:Date})],z.prototype,"modified",void 0);d.__decorate([r.property()],z.prototype,
"orgId",void 0);d.__decorate([r.property()],z.prototype,"portal",void 0);d.__decorate([r.property()],z.prototype,"preferredView",void 0);d.__decorate([r.property()],z.prototype,"privileges",void 0);d.__decorate([r.property()],z.prototype,"region",void 0);d.__decorate([r.property()],z.prototype,"role",void 0);d.__decorate([r.property()],z.prototype,"roleId",void 0);d.__decorate([r.property()],z.prototype,"sourceJSON",void 0);d.__decorate([r.property()],z.prototype,"thumbnail",void 0);d.__decorate([r.property({readOnly:!0})],
z.prototype,"thumbnailUrl",null);d.__decorate([r.property()],z.prototype,"units",void 0);d.__decorate([r.property({readOnly:!0})],z.prototype,"userContentUrl",null);d.__decorate([r.property({readOnly:!0})],z.prototype,"url",null);d.__decorate([r.property()],z.prototype,"username",void 0);d.__decorate([r.property()],z.prototype,"userLicenseTypeId",void 0);d.__decorate([r.property()],z.prototype,"userType",void 0);return z=B=d.__decorate([f.subclass("esri.portal.PortalUser")],z)})},"esri/portal/PortalFolder":function(){define("../chunks/tslib.es6 ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m){n=class extends n.JSONSupport{constructor(f){super(f);this.username=this.title=this.portal=this.id=this.created=null}get url(){const f=this.portal?.restUrl;return f?`${f}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new d("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");}};a.__decorate([z.property({type:Date})],n.prototype,"created",void 0);a.__decorate([z.property()],n.prototype,"id",void 0);a.__decorate([z.property()],n.prototype,
"portal",void 0);a.__decorate([z.property()],n.prototype,"title",void 0);a.__decorate([z.property({readOnly:!0})],n.prototype,"url",null);a.__decorate([z.property()],n.prototype,"username",void 0);return n=a.__decorate([m.subclass("esri.portal.PortalFolder")],n)})},"esri/portal/PortalItem":function(){define("require ../chunks/tslib.es6 ../assets ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../geometry/Extent ./Portal ./PortalItemResource ./PortalRating ../chunks/persistableUrlUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q){var c;const l=new Set("3DTiles Service;CSV;Feature Collection;Feature Service;Feed;GeoJson;Group Layer;Image Service;KML;Map Service;Media Layer;Scene Service;Stream Service;Vector Tile Service;WFS;WMS;WMTS".split(";")),H=new Set(["KML","GeoJson","CSV"]);r=c=class extends r.JSONSupportMixin(b){static from(g){return v.ensureClass(c,g)}constructor(g){super(g);this.id=this.groupCategories=this.extent=this.description=this.culture=this.created=this.classification=
this.categories=this.avgRating=this.applicationProxies=this.apiKey=this.accessInformation=this.access=null;this.isOrgItem=!1;this.url=this.typeKeywords=this.type=this.title=this.tags=this.spatialReference=this.sourceUrl=this.sourceJSON=this.snippet=this.size=this.screenshots=this.portal=this.ownerFolder=this.owner=this.numViews=this.numRatings=this.numComments=this.name=this.modified=this.licenseInfo=this.itemControl=null}destroy(){this.portal=null}get displayName(){const g=this.type,I=this.typeKeywords||
[];let E=g;"Feature Service"===g||"Feature Collection"===g?E=I.includes("Table")?"Table":I.includes("Route Layer")?"Route Layer":I.includes("Markup")?"Markup":"Feature Layer":"Image Service"===g?E=I.includes("Elevation 3D Layer")?"Elevation Layer":I.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===g?E="Scene Layer":"Video Service"===g?E="Video Layer":"Scene Package"===g?E="Scene Layer Package":"Stream Service"===g?E="Feature Layer":"Geoprocessing Service"===g?E=I.includes("Web Tool")?
"Tool":"Geoprocessing Service":"Geoenrichment Service"===g?E="GeoEnrichment Service":"Geocoding Service"===g?E="Locator":"Microsoft Powerpoint"===g?E="Microsoft PowerPoint":"GeoJson"===g?E="GeoJSON":"Globe Service"===g?E="Globe Layer":"Vector Tile Service"===g?E="Tile Layer":"netCDF"===g?E="NetCDF":"Map Service"===g?E=I.includes("Spatiotemporal")||!I.includes("Hosted Service")&&!I.includes("Tiled")||I.includes("Relational")?"Map Image Layer":"Tile Layer":g?.toLowerCase().includes("add in")?E=g.replaceAll(/(add in)/gi,
"Add-In"):"datastore catalog service"===g?E="Big Data File Share":"Compact Tile Package"===g?E="Tile Package (tpkx)":"Raster function template"===g?E="Raster Function Template":"OGCFeatureServer"===g?E="OGC Feature Layer":"web mapping application"===g&&I.includes("configurableApp")?E="Instant App":"Insights Page"===g?E="Insights Report":"Excalibur Imagery Project"===g?E="Excalibur Project":"3DTiles Service"===g?E="3D tiles layer":"3DTiles Package"===g&&(E="3D tiles package");return E}readExtent(g){return g&&
g.length?new D(g[0][0],g[0][1],g[1][0],g[1][1]):null}get iconUrl(){var g=this.type?.toLowerCase()||"";const I=this.typeKeywords||[];var E=!1,C=!1;let N=!1,Q=!1,T=!1,y=!1;E=C=!1;0<g.indexOf("service")||"feature collection"===g||"kml"===g||"wms"===g||"wmts"===g||"wfs"===g?(E=I.includes("Hosted Service"),"feature service"===g||"feature collection"===g||"kml"===g||"wfs"===g?(C=I.includes("Table"),N=I.includes("Route Layer"),Q=I.includes("Markup"),T=I.includes("Spatiotemporal"),y=I.includes("UtilityNetwork"),
g=T&&C?"spatiotemporaltable":C?"table":N?"routelayer":Q?"markup":T?"spatiotemporal":y?"utilitynetwork":E?"featureshosted":"features"):"map service"===g||"wms"===g||"wmts"===g?(T=I.includes("Spatiotemporal"),C=I.includes("Relational"),g=T||C?"mapimages":E||I.includes("Tiled")||"wmts"===g?"maptiles":"mapimages"):g="scene service"===g?I.includes("Line")?"sceneweblayerline":I.includes("3DObject")?"sceneweblayermultipatch":I.includes("Point")?"sceneweblayerpoint":I.includes("IntegratedMesh")?"sceneweblayermesh":
I.includes("PointCloud")?"sceneweblayerpointcloud":I.includes("Polygon")?"sceneweblayerpolygon":I.includes("Building")?"sceneweblayerbuilding":I.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":"image service"===g?I.includes("Elevation 3D Layer")?"elevationlayer":I.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===g?"streamlayer":"vector tile service"===g?"vectortile":"datastore catalog service"===g?"datastorecollection":"geocoding service"===g?"geocodeservice":"video service"===
g?I.includes("Live Stream")?"livestreamvideolayer":"videolayer":"geoprocessing service"===g?I.includes("Web Tool")?"tool":"layers":"geodata service"===g?"geodataservice":"3dtiles service"===g?I.includes("3DObject")?"3dobjecttileslayer":I.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):g="web map"===g||"cityengine web scene"===g?"maps":"web scene"===g?I.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===g&&I.includes("configurableApp")?
"instantapps":"web mapping application"===g||"mobile application"===g||"application"===g||"operation view"===g||"desktop application"===g?"apps":"map document"===g||"map package"===g||"published map"===g||"scene document"===g||"globe document"===g||"basemap package"===g||"mobile basemap package"===g||"mobile map package"===g||"project package"===g||"project template"===g||"pro map"===g||"layout"===g||"layer"===g&&I.includes("ArcGIS Pro")||"explorer map"===g&&I.indexOf("Explorer Document")?"mapsgray":
"service definition"===g||"shapefile"===g||"cad drawing"===g||"geojson"===g||"netcdf"===g||"administrative report"===g?"datafiles":"360 vr experience"===g?"360vr":"explorer add in"===g||"desktop add in"===g||"windows viewer add in"===g||"windows viewer configuration"===g?"appsgray":"arcgis pro add in"===g||"arcgis pro configuration"===g?"addindesktop":"pdf"===g?"pdf":"microsoft word"===g?"word":"microsoft excel"===g?"excel":"microsoft powerpoint"===g?"ppt":"rule package"===g||"file geodatabase"===
g||"sqlite geodatabase"===g||"csv collection"===g||"kml collection"===g||"windows mobile package"===g||"map template"===g||"desktop application template"===g||"gml"===g||"arcpad package"===g||"code sample"===g||"document link"===g||"earth configuration"===g||"operations dashboard add in"===g||"rules package"===g||"workflow manager package"===g||"explorer map"===g&&I.includes("Explorer Mapping Application")||I.includes("Document")?"datafilesgray":"network analysis service"===g||"geoprocessing service"===
g||"geodata service"===g||"geometry service"===g||"geoprocessing package"===g||"locator package"===g||"geoprocessing sample"===g||"workflow manager service"===g?"toolsgray":"layer"===g||"layer package"===g||"explorer layer"===g?"layersgray":"analysis model"===g?"analysismodel":"scene package"===g?"scenepackage":"3dtiles package"===g?"3dtileslayerpackage":"3dtiles service"===g?"3dtileslayer":"mobile scene package"===g?"mobilescenepackage":"tile package"===g||"compact tile package"===g?"tilepackage":
"task file"===g?"taskfile":"report template"===g?"report-template":"statistical data collection"===g?"statisticaldatacollection":"insights workbook"===g?"workbook":"insights model"===g?"insightsmodel":"insights page"===g?"insightspage":"insights theme"===g?"insightstheme":"hub initiative"===g?"hubinitiative":"hub page"===g?"hubpage":"hub site application"===g?"hubsite":"hub event"===g?"hubevent":"hub project"===g?"hubproject":"relational database connection"===g?"relationaldatabaseconnection":"big data file share"===
g?"datastorecollection":"image collection"===g?"imagecollection":"desktop style"===g?"desktopstyle":"style"===g?I.includes("Dictionary")?"dictionarystyle":"style":"dashboard"===g?"dashboard":"raster function template"===g?"rasterprocessingtemplate":"vector tile package"===g?"vectortilepackage":"ortho mapping project"===g?"orthomappingproject":"ortho mapping template"===g?"orthomappingtemplate":"solution"===g?"solutions":"geopackage"===g?"geopackage":"deep learning package"===g?"deeplearningpackage":
"real time analytic"===g?"realtimeanalytics":"reality mapping project"===g?"realitymappingproject":"big data analytic"===g?"bigdataanalytics":"feed"===g?"feed":"excalibur imagery project"===g?"excaliburimageryproject":"notebook"===g?"notebook":"storymap"===g?"storymap":"survey123 add in"===g?"survey123addin":"mission"===g?"mission":"mission report"===g?"missionreport":"mission template"===g?"missiontemplate":"quickcapture project"===g?"quickcaptureproject":"pro report"===g?"proreport":"pro report template"===
g?"proreporttemplate":"urban model"===g?"urbanmodel":"urban project"===g?"urbanproject":"web experience"===g?"experiencebuilder":"web experience template"===g?"webexperiencetemplate":"experience builder widget"===g?"experiencebuilderwidget":"experience builder widget package"===g?"experiencebuilderwidgetpackage":"workflow"===g?"workflow":"kernel gateway connection"===g?"kernelgatewayconnection":"insights script"===g?"insightsscript":"hub initiative template"===g?"hubinitiativetemplate":"storymap theme"===
g?"storymaptheme":"knowledge graph"===g?"knowledgegraph":"knowledge graph layer"===g?"knowledgegraphlayer":"knowledge studio project"===g?"knowledgestudio":"native application"===g?"nativeapp":"native application installer"===g?"nativeappinstaller":"web link chart"===g?"linkchart":"knowledge graph web investigation"===g?"investigation":"ogcfeatureserver"===g?"features":"pro presentation"===g?"propresentation":"pro project"===g?"proproject":"insights workbook package"===g?"insightsworkbookpackage":
"apache parquet"===g?"apacheparquet":"notebook code snippet library"===g?"notebookcodesnippets":"suitability model"===g?"suitabilitymodel":"esri classifier definition"===g?"classifierdefinition":"esri classification schema"===g?"classificationschema":"insights data engineering workbook"===g?"dataengineeringworkbook":"insights data engineering model"===g?"dataengineeringmodel":"deep learning studio project"===g?"deeplearningproject":"discussion"===g?"discussion":"allsource project"===g?"allsourceproject":
"api key"===g?"apikey":"data pipeline"===g?"datapipelines":"group layer"===g?(E=I.includes("Map"))?"layergroup2d":"layergroup":"media layer"===g?"onlinemedialayer":"form"===g?I.includes("Survey123")?"survey":"datafilesgray":"csv"===g?"csv":"image"===g?"image":"maps";return g?n.getAssetUrl("esri/images/portal/"+g+"16.png"):null}get isLayer(){return null!=this.type&&l.has(this.type)}get itemCdnUrl(){return q.toCDNUrl(this.itemUrl)}get itemPageUrl(){const g=this.portal?.itemPageUrl;return g&&this.id?
`${g}?id=${this.id}`:null}get itemUrl(){const g=this.portal?.restUrl;return g&&this.id?`${g}/content/items/${this.id}`:null}get thumbnailUrl(){const g=this.itemUrl,I=this.thumbnail;return g&&I?this.portal?.normalizeUrl(`${g}/info/${I}?f=json`)??null:null}get userItemUrl(){const g=this.portal?.restUrl;if(!g)return null;const I=this.owner||this.portal?.user?.username;return I?`${g}/content/users/${this.ownerFolder?`${I}/${this.ownerFolder}`:I}/items/${this.id}`:null}load(g){const I=this.portal??(this.portal=
p.getDefault()),E=I.load(g).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?I.request(this.itemUrl,{signal:null!=g?g.signal:null,query:{token:this.apiKey}}):{}).then(C=>{this.sourceJSON=C;this.read(C)});this.addResolvingPromise(E);return Promise.resolve(this)}async addRating(g){const I={method:"post",query:{}};g instanceof F&&(g=g.rating);null==g||isNaN(g)||"number"!==typeof g||(I.query.rating=g);if(!this.portal)return null;await this.portal.request(this.itemUrl+"/addRating",I);return new F({rating:g,
created:new Date})}clone(){var g={access:this.access,accessInformation:this.accessInformation,applicationProxies:G.clone(this.applicationProxies),avgRating:this.avgRating,categories:G.clone(this.categories),classification:G.clone(this.classification),created:G.clone(this.created),culture:this.culture,description:this.description,extent:G.clone(this.extent),groupCategories:G.clone(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:G.clone(this.modified),
name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:G.clone(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:G.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:G.clone(this.typeKeywords),url:this.url};this.loaded&&(g.loadStatus="loaded");g=(new c({sourceJSON:this.sourceJSON})).set(g);
g._set("isOrgItem",this.isOrgItem);return g}createPostQuery(){const g=this.toJSON();for(var I of["tags","typeKeywords","categories"])g[I]=g[I]?.join(", ");for(const E of["extent","classification"])(I=g[E])&&(g[E]=JSON.stringify(I));return g}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(g="json",I){return this.portal.request(this.itemUrl+"/data",{responseType:g,...I,query:{token:this.apiKey}})}async fetchRating(g){g=await this.portal.request(this.itemUrl+
"/rating",{query:{token:this.apiKey},...g});return null!=g.rating?(g.created=new Date(g.created),new F(g)):null}fetchRelatedItems(g,I){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...g,token:this.apiKey},...I},c)}getThumbnailUrl(g){let I=this.thumbnailUrl;I&&g&&(I+=`&w=${g}`);return I}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(g=>{this.applicationProxies&&!Object.hasOwn(g,"appProxies")&&(this.applicationProxies=
null);this.sourceJSON=g;this.read(g);return this})}update(g){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const I=g?.data,E={method:"post"};E.query=this.createPostQuery();for(const C in E.query)null===E.query[C]&&(E.query[C]="");E.query.clearEmptyFields=!0;null!=I&&("string"===typeof I?E.query.text=I:"object"===typeof I&&(E.query.text=JSON.stringify(I)));return this.portal.request(`${this.userItemUrl}/update`,E).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist",
"The item does not exist yet and cannot be updated"))}async copy(g){if(!this.id)throw new z("portal:item-does-not-exist","The item does not exist yet");await this.load();const {portal:I,itemUrl:E}=this;await I.signIn();const {copyResources:C,folder:N,tags:Q,title:T}=g||{};g={method:"post",query:{copyPrivateResources:"all"===C,folder:"string"===typeof N?N:N?.id,includeResources:!!C,tags:Q?.join(","),title:T}};({itemId:g}=await I.request(`${E}/copy`,g));return new c({id:g,portal:I})}updateThumbnail(g){return this.id?
this.load().then(()=>this.portal.signIn()).then(()=>{const I=g.thumbnail,E=g.filename,C={method:"post"};if("string"===typeof I)m.isDataProtocol(I)?C.query={data:I}:C.query={url:m.makeAbsolute(I)},null!=E&&(C.query.filename=E);else{const N=new FormData;null!=E?N.append("file",I,E):N.append("file",I);C.body=N}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,C).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(g=
{},I){const {fetchResources:E}=await new Promise((C,N)=>a(["./support/resourceUtils"],C,N));return E(this,g,I)}async addResource(g,I,E){const {addOrUpdateResources:C}=await new Promise((N,Q)=>a(["./support/resourceUtils"],N,Q));g.portalItem=this;await C(this,[{resource:g,content:I,compress:E?.compress,access:E?.access}],"add",E);return g}async removeResource(g,I){const {removeResource:E}=await new Promise((C,N)=>a(["./support/resourceUtils"],C,N));if(g.portalItem&&g.portalItem.itemUrl!==this.itemUrl)throw new z("removeresource:portal-item-mismatch",
"The portal item associated with the provided resource does not match the item");return E(this,g,I)}async removeAllResources(g){const {removeAllResources:I}=await new Promise((E,C)=>a(["./support/resourceUtils"],E,C));return I(this,g)}resourceFromPath(g){return new A({portalItem:this,path:g})}toJSON(){var g=this.extent;g={accessInformation:this.accessInformation,categories:G.clone(this.categories),classification:G.clone(this.classification),created:this.created?.getTime(),description:this.description,
extent:g&&[[g.xmin,g.ymin],[g.xmax,g.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:G.clone(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:G.clone(this.typeKeywords),url:this.url};return G.fixJson(g)}static fromJSON(g){if(!g)return null;if(g.declaredClass)throw Error("JSON object is already hydrated");
return new c({sourceJSON:g})}_getPostQuery(){const g=this.toJSON();for(const I in g)"tags"===I&&null!==g[I]&&(g[I]=g[I].join(", ")),"typeKeywords"===I&&null!==g[I]&&(g[I]=g[I].join(", ")),"extent"===I&&g[I]&&(g[I]=JSON.stringify(g[I]));return g}};d.__decorate([f.property({type:["private","shared","org","public"]})],r.prototype,"access",void 0);d.__decorate([f.property()],r.prototype,"accessInformation",void 0);d.__decorate([f.property({type:String})],r.prototype,"apiKey",void 0);d.__decorate([f.property({json:{read:{source:"appProxies"}}})],
r.prototype,"applicationProxies",void 0);d.__decorate([f.property()],r.prototype,"avgRating",void 0);d.__decorate([f.property()],r.prototype,"categories",void 0);d.__decorate([f.property()],r.prototype,"classification",void 0);d.__decorate([f.property({type:Date})],r.prototype,"created",void 0);d.__decorate([f.property()],r.prototype,"culture",void 0);d.__decorate([f.property()],r.prototype,"description",void 0);d.__decorate([f.property({readOnly:!0})],r.prototype,"displayName",null);d.__decorate([f.property({type:D})],
r.prototype,"extent",void 0);d.__decorate([x.reader("extent")],r.prototype,"readExtent",null);d.__decorate([f.property()],r.prototype,"groupCategories",void 0);d.__decorate([f.property({readOnly:!0})],r.prototype,"iconUrl",null);d.__decorate([f.property()],r.prototype,"id",void 0);d.__decorate([f.property({readOnly:!0})],r.prototype,"isLayer",null);d.__decorate([f.property({type:Boolean,readOnly:!0})],r.prototype,"isOrgItem",void 0);d.__decorate([f.property()],r.prototype,"itemControl",void 0);d.__decorate([f.property({readOnly:!0})],
r.prototype,"itemPageUrl",null);d.__decorate([f.property({readOnly:!0})],r.prototype,"itemUrl",null);d.__decorate([f.property()],r.prototype,"licenseInfo",void 0);d.__decorate([f.property({type:Date})],r.prototype,"modified",void 0);d.__decorate([f.property()],r.prototype,"name",void 0);d.__decorate([f.property()],r.prototype,"numComments",void 0);d.__decorate([f.property()],r.prototype,"numRatings",void 0);d.__decorate([f.property()],r.prototype,"numViews",void 0);d.__decorate([f.property()],r.prototype,
"owner",void 0);d.__decorate([f.property()],r.prototype,"ownerFolder",void 0);d.__decorate([f.property({type:p})],r.prototype,"portal",void 0);d.__decorate([f.property()],r.prototype,"screenshots",void 0);d.__decorate([f.property()],r.prototype,"size",void 0);d.__decorate([f.property()],r.prototype,"snippet",void 0);d.__decorate([f.property()],r.prototype,"sourceJSON",void 0);d.__decorate([f.property({type:String})],r.prototype,"sourceUrl",void 0);d.__decorate([f.property({type:String})],r.prototype,
"spatialReference",void 0);d.__decorate([f.property()],r.prototype,"tags",void 0);d.__decorate([f.property()],r.prototype,"thumbnail",void 0);d.__decorate([f.property({readOnly:!0})],r.prototype,"thumbnailUrl",null);d.__decorate([f.property()],r.prototype,"title",void 0);d.__decorate([f.property()],r.prototype,"type",void 0);d.__decorate([f.property()],r.prototype,"typeKeywords",void 0);d.__decorate([f.property({type:String,json:{read(g,I){H.has(I.type)&&(I=this.portal?.restUrl,g||=I&&this.id?`${I}/content/items/${this.id}/data`:
null);return g}}})],r.prototype,"url",void 0);d.__decorate([f.property({readOnly:!0})],r.prototype,"userItemUrl",null);return r=c=d.__decorate([B.subclass("esri.portal.PortalItem")],r)})},"esri/portal/PortalItemResource":function(){define("require ../chunks/tslib.es6 ../core/Accessor ../core/Error ../core/Logger ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x){function B(D,p){if(null==D)return D;D=D.replace(/^\/+/,"");null!=p&&G.isAbsolute(D)&&(D=G.makeRelative(D,p.itemUrl));return D?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,"")}n=class extends n{constructor(D){super(D);this.portalItem=null}normalizeCtorArgs(D){return D?.portalItem&&D.path?{...D,path:B(D.path,D.portalItem)}:D}set path(D){null!=D&&G.isAbsolute(D)?r.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):
this._set("path",D)}_castPath(D){return B(D,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(D="json",p){const A=this.cdnUrl;if(null==A)throw new z("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");
return this.portalItem.portal.request(A,{responseType:D,query:{token:this.portalItem.apiKey,_ts:p?.cacheBust?Date.now():null},signal:p?.signal})}async update(D,p){const {addOrUpdateResources:A}=await new Promise((F,q)=>a(["./support/resourceUtils"],F,q));await A(this.portalItem,[{resource:this,content:D,compress:p?.compress,access:p?.access}],"update",p);return this}hasPath(){return null!=this.path}};d.__decorate([b.property()],n.prototype,"portalItem",void 0);d.__decorate([b.property({type:String,
value:null})],n.prototype,"path",null);d.__decorate([m.cast("path")],n.prototype,"_castPath",null);d.__decorate([b.property({type:String,readOnly:!0})],n.prototype,"url",null);d.__decorate([b.property({type:String,readOnly:!0})],n.prototype,"cdnUrl",null);d.__decorate([b.property({type:String,readOnly:!0})],n.prototype,"itemRelativeUrl",null);return n=d.__decorate([x.subclass("esri.portal.PortalItemResource")],n)})},"esri/portal/PortalRating":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b){d=class extends d{constructor(m){super(m);this.rating=this.created=null}};a.__decorate([n.property()],d.prototype,"created",void 0);a.__decorate([n.property()],d.prototype,"rating",void 0);return d=a.__decorate([b.subclass("esri.portal.PortalRating")],d)})},"esri/chunks/persistableUrlUtils":function(){define(["exports","../kernel","../core/urlUtils","../portal/support/urlUtils"],function(a,d,n,z){function r(c,l){var H=l?.url?.path;c&&H&&(c=n.makeAbsolute(c,H,{preserveProtocolRelative:!0}),
l.portalItem&&l.readResourcePaths&&(H=n.makeRelative(c,l.portalItem.itemUrl),null!=H&&F.test(H)&&l.readResourcePaths.push(l.portalItem.resourceFromPath(H).path)));return(c=B(c,l?.portal))&&A.test(c)?D(c):c}function G(c,l,H=a.MarkKeep.YES){c=c&&A.test(c)?p(c):c;if(null==c)return c;!n.isAbsolute(c)&&l?.blockedRelativeUrls&&l.blockedRelativeUrls.push(c);let g=n.makeAbsolute(c);if(l){var I=l.verifyItemRelativeUrls?.rootPath||l.url?.path;if(I){I=B(I,l.portal);const E=B(g,l.portal);g=n.makeRelative(E,I,
I);null!=g&&g!==E&&g!==c&&l.verifyItemRelativeUrls&&l.verifyItemRelativeUrls.writtenUrls.push(g)}}g=x(g,l?.portal);n.isAbsolute(g)&&(g=n.normalize(g));l?.resources&&l?.portalItem&&!n.isAbsolute(g)&&!n.isDataProtocol(g)&&H===a.MarkKeep.YES&&l.resources.toKeep.push({resource:l.portalItem.resourceFromPath(g),compress:!1});return g}function b(c,l,H){return r(c,H)}function m(c,l,H,g){c=G(c,g);void 0!==c&&(l[H]=c)}function f(c){return(c?.match(A)??null)?.[1]??null}function v(c){c=c?.match(A)??null;if(null==
c)return null;c=c[2];const l=c.lastIndexOf("/");if(-1===l){const {path:I,extension:E}=n.splitPathExtension(c);return{prefix:null,filename:I,extension:E}}const {path:H,extension:g}=n.splitPathExtension(c.slice(l+1));return{prefix:c.slice(0,l),filename:H,extension:g}}function x(c,l){return l&&!l.isPortal&&l.urlKey&&l.customBaseUrl?n.changeDomain(c,`${l.urlKey}.${l.customBaseUrl}`,l.portalHostname):c}function B(c,l){if(!l||l.isPortal||!l.urlKey||!l.customBaseUrl)return c;const H=`${l.urlKey}.${l.customBaseUrl}`,
g=n.getAppUrl();return n.hasSameOrigin(g,`${g.scheme}://${H}`)?n.changeDomain(c,l.portalHostname,H):n.changeDomain(c,H,l.portalHostname)}function D(c){if(!c)return c||null;c&&d.id&&!d.id.findCredential(c)&&(c=z.normalizeArcGISOnlineOrgDomain(c),c=c.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),c=c.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),c=c.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com"));return c}function p(c){if(!c)return c||
null;c=c.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com");c=c.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com");(c=c.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"))&&d.id&&!d.id.findCredential(c)&&(c=z.normalizeArcGISOnlineOrgDomain(c));return c}const A=/\/items\/([^/]+)\/resources\/(.*)/,F=/^\.\/resources\//;a.MarkKeep=void 0;(function(c){c[c.YES=0]="YES";c[c.NO=1]="NO"})(a.MarkKeep||(a.MarkKeep={}));const q=Object.freeze(Object.defineProperty({__proto__:null,
get MarkKeep(){return a.MarkKeep},ensureMainOnlineDomain:x,fromCDNUrl:p,fromJSON:r,itemIdFromResourceUrl:f,prefixAndFilenameFromResourceUrl:v,read:b,toCDNUrl:D,toJSON:G,write:m},Symbol.toStringTag,{value:"Module"}));a.ensureMainOnlineDomain=x;a.fromCDNUrl=p;a.fromJSON=r;a.itemIdFromResourceUrl=f;a.persistableUrlUtils=q;a.prefixAndFilenameFromResourceUrl=v;a.read=b;a.toCDNUrl=D;a.toJSON=G;a.write=m})},"esri/support/basemapDefinitions":function(){define(["exports","../assets","../intl/messages"],function(a,
d,n){a.esriBasemapDefinitions={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",
url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/terrain.jpg")},
baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",
classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",
isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get "dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/gray-vector.jpg")},
baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],
id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo-vector.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},
"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-relief.jpg")},
baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",
classic:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",
styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",
layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",
layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",
itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",
layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},
{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",
title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",
itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},
{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",
title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},
"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",
layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",
baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",
title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",
title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",
title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},
"arcgis-topographic":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return d.getAssetUrl("esri/images/basemap/oceans.jpg")},
title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",
title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},
"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",
styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},
{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},
"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",
title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",
title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",
showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",
title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",
title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}};a.getBasemapTitle=async function(z){if(z){var r=z.includes("-vector")?z.slice(0,z.indexOf("-vector")):
z.includes("-3d")?z.slice(0,z.indexOf("-3d")):z,G=await n.fetchMessageBundle("esri/t9n/basemaps");return G[z]||G[r]}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/BasemapStyle":function(){define("../chunks/tslib.es6 ../core/Accessor ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../intl/locale".split(" "),function(a,d,n,z,r,G,b,m){const f=new Set("ar bs ca hr cs da nl en et fi fr de el he hu id it ja ko lv lt nb pl ro ru sr es sv th tr uk vi".split(" "));
d=class extends d{constructor(v){super(v);this.places=this.language=this.id=this.apiKey=null;this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps";this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;var v=m.getLocale().toLowerCase();switch(v){case "pt-br":return"pt-BR";case "pt-pt":return"pt-PT";case "zh-cn":return"zh-CN";case "zh-hk":return"zh-HK";case "zh-tw":return"zh-TW"}v=m.getLanguage(v);return"pt"===v?"pt-BR":v&&f.has(v)?
v:"global"}};a.__decorate([n.property()],d.prototype,"apiKey",void 0);a.__decorate([n.property()],d.prototype,"id",void 0);a.__decorate([n.property()],d.prototype,"language",void 0);a.__decorate([n.property()],d.prototype,"places",void 0);a.__decorate([n.property()],d.prototype,"serviceUrl",void 0);a.__decorate([n.property()],d.prototype,"worldview",void 0);return d=a.__decorate([b.subclass("esri.support.BasemapStyle")],d)})},"esri/webdoc/support/writeUtils":function(){define("exports ../../core/Error ../../core/lang ../../core/object ../../core/accessorSupport/extensions/serializableProperty/writer ../../layers/support/layerUtils".split(" "),
function(a,d,n,z,r,G){function b(v,x){"maxScale"in v&&(x.maxScale=r.numberToJSON(v.maxScale)??void 0);"minScale"in v&&(x.minScale=r.numberToJSON(v.minScale)??void 0)}const m=new Set("bing-maps imagery imagery-tile map-image open-street-map tile unknown unsupported vector-tile web-tile wms wmts".split(" ")),f=new Set("catalog csv feature geo-rss geojson group imagery imagery-tile kml knowledge-graph map-image map-notes media ogc-feature oriented-imagery route stream subtype-group tile unknown unsupported vector-tile web-tile wfs wms wmts".split(" "));
a.disableRestrictedWriting=function(v){m.add(v);f.add(v)};a.enableRestrictedWriting=function(v){m.delete(v);f.delete(v)};a.getLayerJSON=function(v,x,B){if(!v.persistenceEnabled)return null;if(!("write"in v&&v.write))return B?.messages&&B.messages.push(new d("layer:unsupported",`Layers (${v.title}, ${v.id}) of type '${v.declaredClass}' cannot be persisted`,{layer:v})),null;if(G.isFeatureCollectionLayer(v)&&!v.isTable)x=v.resourceInfo;else{if(B.restrictedWebMapWriting){var D="basemap"===B.layerContainerType?
m:"operational-layers"===B.layerContainerType?f:null;D=null!=D?D.has(v.type)&&!G.isFeatureCollectionLayer(v):!0}else D=!0;if(D)return x={},v.write(x,B)?x:null}if(null!=x){x=n.clone(x);if(B=x)G.isFeatureCollectionLayer(v)?(D=z.getDeepValue("featureCollection.layers",B)?.[0]?.layerDefinition)&&b(v,D):"group"!==v.type&&b(v,B);if(B&&(B.id=v.id,"blendMode"in v&&(B.blendMode=v.blendMode,"normal"===B.blendMode&&delete B.blendMode),B.opacity=r.numberToJSON(v.opacity)??void 0,B.title=v.title||"Layer",B.visibility=
v.visible,"legendEnabled"in v&&"wmts"!==v.type))if(G.isFeatureCollectionLayer(v)){if(B=B.featureCollection)B.showLegend=v.legendEnabled}else B.showLegend=v.legendEnabled}return x};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/layerUtils":function(){define(["exports","../../kernel","../../request"],function(a,d,n){function z(b){return"scene"===b?.type}function r(b){return null!=b&&"object"===typeof b&&"type"in b&&"subtype-group"===b.type&&"sublayers"in b}function G(b){b=
b?.type;return"imagery-tile"===b||"tile"===b||"open-street-map"===b||"vector-tile"===b||"web-tile"===b||"wmts"===b}a.getEffectiveEditingEnabled=function(b){a:if("editingEnabled"in b)switch(b.type){case "csv":case "feature":case "geojson":case "oriented-imagery":case "scene":case "subtype-group":case "subtype-sublayer":var m=!0;break a;default:m=!1}else m=!1;return m?"effectiveEditingEnabled"in b?b.effectiveEditingEnabled:b.editingEnabled:!1};a.getEffectiveLayerCapabilities=function(b){a:if("capabilities"in
b)switch(b.type){case "catalog":case "catalog-footprint":case "csv":case "feature":case "geojson":case "imagery":case "knowledge-graph-sublayer":case "ogc-feature":case "oriented-imagery":case "scene":case "sublayer":case "subtype-group":case "subtype-sublayer":case "wfs":var m=!0;break a;default:m=!1}else m=!1;return m?"effectiveCapabilities"in b?b.effectiveCapabilities:b.capabilities:null};a.getOwningPortalUrl=async function(b,m){var f=d.id?.findServerInfo(b);if(null!=f?.currentVersion)return f.owningSystemUrl||
null;f=b.toLowerCase().indexOf("/rest/services");if(-1===f)return null;b=`${b.slice(0,f)}/rest/info`;({data:m}=await n(b,{query:{f:"json"},responseType:"json",signal:null!=m?m.signal:null}));return m?.owningSystemUrl||null};a.getSubtypesFromLayer=function(b){return b?("subtypes"in b?b.subtypes:r(b.parent)?b.parent.subtypes:[])??[]:[]};a.getTileMaxtrixSetFromActiveLayer=function(b){if(b.activeLayer){const m=b.activeLayer.tileMatrixSet;if(m)return m;if(b=b.activeLayer.tileMatrixSets)return b}return null};
a.isBaseLayer=function(b){return null!=b?.parent&&"declaredClass"in b.parent&&"esri.Basemap"===b.parent.declaredClass&&b.parent.baseLayers.includes(b)};a.isBasemap3DSupportedLayer=function(b){return G(b)||z(b)};a.isBasemapSupportedTiledLayer=G;a.isFeatureCollectionLayer=function(b){return"feature"===b?.type&&!b.url&&"memory"===b.source?.type};a.isFeatureLayer=function(b){return null!=b&&"object"===typeof b&&"type"in b&&"feature"===b.type};a.isFeatureServiceLayer=function(b){return"feature"===b?.type&&
"feature-layer"===b.source?.type};a.isGraphicsLayer=function(b){return null!=b&&"object"===typeof b&&"type"in b&&"graphics"===b.type};a.isGroupLayer=function(b){return null!=b&&"type"in b&&"group"===b.type};a.isImageryTileLayer=function(b){return"imagery-tile"===b?.type};a.isIntegratedMeshLayer=function(b){return"integrated-mesh"===b||"integrated-mesh-3dtiles"===b};a.isIntegratedMeshOperationalLayer=function(b){return"IntegratedMeshLayer"===b||"IntegratedMesh3DTilesLayer"===b};a.isKnowledgeGraphLayer=
function(b){return null!=b&&"object"===typeof b&&"type"in b&&"knowledge-graph"===b.type&&"layers"in b};a.isLayerWithFeatureLayerSource=function(b){const m=b?.type;return("feature"===m||"subtype-group"===m||"oriented-imagery"===m)&&"feature-layer"===b.source?.type};a.isLinkChartLayer=function(b){return null!=b&&"object"===typeof b&&"type"in b&&"link-chart"===b.type&&"layers"in b};a.isMapNotesLayer=function(b){return null!=b&&"object"===typeof b&&"type"in b&&"map-notes"===b.type&&"sublayers"in b};a.isSceneLayer=
z;a.isSceneServiceLayer=function(b){b=b?.type;return"building-scene"===b||"integrated-mesh"===b||"point-cloud"===b||"scene"===b};a.isSubtypeGroupLayer=r;a.isSubtypeSublayer=function(b){return"subtype-sublayer"===b?.type};a.isTable=function(b){return null!=b&&"object"===typeof b&&"isTable"in b&&!!b.isTable};a.isTiledLayer=function(b){b=b?.type;return"base-tile"===b||"tile"===b||"elevation"===b||"imagery-tile"===b||"base-elevation"===b||"open-street-map"===b||"wcs"===b||"web-tile"===b||"wmts"===b||
"vector-tile"===b};a.isVoxelLayer=function(b){return"voxel"===b?.type};a.sceneServiceLayerTypeToClassName={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};a.serializeLayerDefinitions=function(b){const m=/[:;]/,f=[];let v=!1;if(b&&(b.forEach((x,B)=>{f.push([B,x]);!v&&m.test(x)&&(v=!0)}),0<f.length)){if(v){const x={};f.forEach(B=>{x[B[0]]=B[1]});b=JSON.stringify(x)}else{const x=[];f.forEach(B=>{x.push(B[0]+":"+
B[1])});b=x.join(";")}return b}return null};a.serializeTimeOptions=function(b){if(b){var m=[];b.forEach((f,v)=>{m.push('"'+v+'":'+JSON.stringify(f))});if(m.length)return"{"+m.join(",")+"}"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/utils":function(){define(["exports","./effects"],function(a,d){a.canInterpolateEffects=function(n,z){const r=n.length>z.length?n:z;return(n.length>z.length?z:n).every((G,b)=>G.type===r[b].type)};a.effectEquals=function(n,z){n=
JSON.stringify(n??null);z=JSON.stringify(z??null);return n===z};a.isEffectFunctions=function(n){return(n=n[0])?"type"in n:!1};a.normalizeEffects=function(n,z){const r=n.length>z.length?n:z;n=n.length>z.length?z:n;for(z=n.length;z<r.length;z++)n.push(d.createEffectWithInitialValues(r[z]))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/effects":function(){define(["exports","../../colorUtils","../../core/screenUtils","../../core/libs/gl-matrix-2/factories/mat4f32",
"./colorMatrixFunctions"],function(a,d,n,z,r){function G(p,A,F){return p+(A-p)*F}function b(p){return Math.round(1E3*n.px2pt(p))/1E3}class m{constructor(p,A,F){this.strength=p;this.radius=A;this.threshold=F;this.type="bloom"}interpolate(p,A,F){this.strength=G(p.strength,A.strength,F);this.radius=G(p.radius,A.radius,F);this.threshold=G(p.threshold,A.threshold,F)}clone(){return new m(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:b(this.radius),strength:this.strength,
threshold:this.threshold}}}class f{constructor(p){this.radius=p;this.type="blur"}interpolate(p,A,F){this.radius=Math.round(G(p.radius,A.radius,F))}clone(){return new f(this.radius)}toJSON(){return{type:"blur",radius:b(this.radius)}}}class v{constructor(p,A){this.type=p;this.amount=A;if("invert"===this.type||"grayscale"===this.type||"sepia"===this.type)this.amount=Math.min(this.amount,1)}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(p,A,F){this.amount=
G(p.amount,A.amount,F);this._updateMatrix()}clone(){return new v(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const p=this._colorMatrix||z.create();switch(this.type){case "brightness":this._colorMatrix=r.brightness(p,this.amount);break;case "contrast":this._colorMatrix=r.contrast(p,this.amount);break;case "grayscale":this._colorMatrix=r.grayscale(p,this.amount);break;case "invert":this._colorMatrix=r.invert(p,this.amount);break;case "saturate":this._colorMatrix=
r.saturate(p,this.amount);break;case "sepia":this._colorMatrix=r.sepia(p,this.amount)}}}class x{constructor(p,A,F,q){this.offsetX=p;this.offsetY=A;this.blurRadius=F;this.color=q;this.type="drop-shadow"}interpolate(p,A,F){this.offsetX=G(p.offsetX,A.offsetX,F);this.offsetY=G(p.offsetY,A.offsetY,F);this.blurRadius=G(p.blurRadius,A.blurRadius,F);this.color[0]=Math.round(G(p.color[0],A.color[0],F));this.color[1]=Math.round(G(p.color[1],A.color[1],F));this.color[2]=Math.round(G(p.color[2],A.color[2],F));
this.color[3]=G(p.color[3],A.color[3],F)}clone(){return new x(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const p=[...this.color];p[3]*=255;return{type:"drop-shadow",xoffset:b(this.offsetX),yoffset:b(this.offsetY),blurRadius:b(this.blurRadius),color:p}}}class B{constructor(p){this.angle=p;this.type="hue-rotate"}get colorMatrix(){this._colorMatrix||this._updateMatrix();return this._colorMatrix}interpolate(p,A,F){this.angle=G(p.angle,A.angle,F);this._updateMatrix()}clone(){return new B(this.angle)}toJSON(){return{type:"hue-rotate",
angle:this.angle}}_updateMatrix(){const p=this._colorMatrix||z.create();this._colorMatrix=r.rotateHue(p,this.angle)}}class D{constructor(p){this.amount=p;this.type="opacity";this.amount=Math.min(this.amount,1)}interpolate(p,A,F){this.amount=G(p.amount,A.amount,F)}clone(){return new D(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}a.BloomEffect=m;a.BlurEffect=f;a.ColorMatrixEffect=v;a.DropShadowEffect=x;a.HueRotateEffect=B;a.OpacityEffect=D;a.createEffectWithInitialValues=function(p){switch(p.type){case "grayscale":case "sepia":case "invert":return new v(p.type,
0);case "saturate":case "brightness":case "contrast":return new v(p.type,1);case "opacity":return new D(1);case "hue-rotate":return new B(0);case "blur":return new f(0);case "drop-shadow":return new x(0,0,0,[...d.getNamedColor("transparent")]);case "bloom":return new m(0,0,1)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["exports"],function(a){function d(){const m=new Float32Array(16);m[0]=1;m[5]=1;m[10]=1;m[15]=
1;return m}function n(m){const f=new Float32Array(16);f[0]=m[0];f[1]=m[1];f[2]=m[2];f[3]=m[3];f[4]=m[4];f[5]=m[5];f[6]=m[6];f[7]=m[7];f[8]=m[8];f[9]=m[9];f[10]=m[10];f[11]=m[11];f[12]=m[12];f[13]=m[13];f[14]=m[14];f[15]=m[15];return f}function z(m,f,v,x,B,D,p,A,F,q,c,l,H,g,I,E){const C=new Float32Array(16);C[0]=m;C[1]=f;C[2]=v;C[3]=x;C[4]=B;C[5]=D;C[6]=p;C[7]=A;C[8]=F;C[9]=q;C[10]=c;C[11]=l;C[12]=H;C[13]=g;C[14]=I;C[15]=E;return C}function r(m,f){return new Float32Array(m,f,16)}const G=d(),b=Object.freeze(Object.defineProperty({__proto__:null,
IDENTITY:G,clone:n,create:d,createView:r,fromValues:z},Symbol.toStringTag,{value:"Module"}));a.IDENTITY=G;a.clone=n;a.create=d;a.createView=r;a.fromValues=z;a.mat4f32=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/effects/colorMatrixFunctions":function(){define(["exports","../../core/libs/gl-matrix-2/math/mat4"],function(a,d){a.brightness=(n,z)=>{n=d.set(n,z,0,0,0,0,z,0,0,0,0,z,0,0,0,0,1);return d.transpose(n,n)};a.contrast=(n,z)=>{n=d.set(n,z,0,0,.5-.5*z,0,z,0,.5-
.5*z,0,0,z,.5-.5*z,0,0,0,1);return d.transpose(n,n)};a.grayscale=(n,z)=>{z=1-z;n=d.set(n,.2126+.7874*z,.7152-.7152*z,.0722-.0722*z,0,.2126-.2126*z,.7152+.2848*z,.0722-.0722*z,0,.2126-.2126*z,.7152-.7152*z,.0722+.9278*z,0,0,0,0,1);return d.transpose(n,n)};a.invert=(n,z)=>{const r=1-2*z;n=d.set(n,r,0,0,z,0,r,0,z,0,0,r,z,0,0,0,1);return d.transpose(n,n)};a.rotateHue=(n,z)=>{const r=Math.sin(z*Math.PI/180);z=Math.cos(z*Math.PI/180);n=d.set(n,.213+.787*z-.213*r,.715-.715*z-.715*r,.072-.072*z+.928*r,0,
.213-.213*z+.143*r,.715+.285*z+.14*r,.072-.072*z-.283*r,0,.213-.213*z-.787*r,.715-.715*z+.715*r,.072+.928*z+.072*r,0,0,0,0,1);return d.transpose(n,n)};a.saturate=(n,z)=>{n=d.set(n,.213+.787*z,.715-.715*z,.072-.072*z,0,.213-.213*z,.715+.285*z,.072-.072*z,0,.213-.213*z,.715-.715*z,.072+.928*z,0,0,0,0,1);return d.transpose(n,n)};a.sepia=(n,z)=>{z=1-z;n=d.set(n,.393+.607*z,.769-.769*z,.189-.189*z,0,.349-.349*z,.686+.314*z,.168-.168*z,0,.272-.272*z,.534-.534*z,.131+.869*z,0,0,0,0,1);return d.transpose(n,
n)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["exports","../factories/vec3f64","./common"],function(a,d,n){function z(u,O){u[0]=O[0];u[1]=O[1];u[2]=O[2];u[3]=O[3];u[4]=O[4];u[5]=O[5];u[6]=O[6];u[7]=O[7];u[8]=O[8];u[9]=O[9];u[10]=O[10];u[11]=O[11];u[12]=O[12];u[13]=O[13];u[14]=O[14];u[15]=O[15];return u}function r(u,O,X,ba,ja,L,P,S,W,aa,ca,ea,la,ma,ua,qa,ra){u[0]=O;u[1]=X;u[2]=ba;u[3]=ja;u[4]=L;u[5]=P;u[6]=S;u[7]=W;u[8]=
aa;u[9]=ca;u[10]=ea;u[11]=la;u[12]=ma;u[13]=ua;u[14]=qa;u[15]=ra;return u}function G(u){u[0]=1;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=1;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=1;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function b(u,O){if(u===O){const X=O[1],ba=O[2],ja=O[3],L=O[6],P=O[7],S=O[11];u[1]=O[4];u[2]=O[8];u[3]=O[12];u[4]=X;u[6]=O[9];u[7]=O[13];u[8]=ba;u[9]=L;u[11]=O[14];u[12]=ja;u[13]=P;u[14]=S}else u[0]=O[0],u[1]=O[4],u[2]=O[8],u[3]=O[12],u[4]=O[1],u[5]=O[5],u[6]=O[9],u[7]=O[13],u[8]=O[2],u[9]=
O[6],u[10]=O[10],u[11]=O[14],u[12]=O[3],u[13]=O[7],u[14]=O[11],u[15]=O[15];return u}function m(u,O){f(u,O)||G(u);return u}function f(u,O){const X=O[0],ba=O[1],ja=O[2],L=O[3],P=O[4],S=O[5],W=O[6],aa=O[7],ca=O[8],ea=O[9],la=O[10],ma=O[11],ua=O[12],qa=O[13],ra=O[14];O=O[15];const Ba=X*S-ba*P,ya=X*W-ja*P,Aa=X*aa-L*P,Ca=ba*W-ja*S,za=ba*aa-L*S,Fa=ja*aa-L*W,Ra=ca*qa-ea*ua,bb=ca*ra-la*ua,cb=ca*O-ma*ua,Xa=ea*ra-la*qa,Ma=ea*O-ma*qa,Na=la*O-ma*ra;let ha=Ba*Na-ya*Ma+Aa*Xa+Ca*cb-za*bb+Fa*Ra;if(!ha)return null;
ha=1/ha;u[0]=(S*Na-W*Ma+aa*Xa)*ha;u[1]=(ja*Ma-ba*Na-L*Xa)*ha;u[2]=(qa*Fa-ra*za+O*Ca)*ha;u[3]=(la*za-ea*Fa-ma*Ca)*ha;u[4]=(W*cb-P*Na-aa*bb)*ha;u[5]=(X*Na-ja*cb+L*bb)*ha;u[6]=(ra*Aa-ua*Fa-O*ya)*ha;u[7]=(ca*Fa-la*Aa+ma*ya)*ha;u[8]=(P*Ma-S*cb+aa*Ra)*ha;u[9]=(ba*cb-X*Ma-L*Ra)*ha;u[10]=(ua*za-qa*Aa+O*Ba)*ha;u[11]=(ea*Aa-ca*za-ma*Ba)*ha;u[12]=(S*bb-P*Xa-W*Ra)*ha;u[13]=(X*Xa-ba*bb+ja*Ra)*ha;u[14]=(qa*ya-ua*Ca-ra*Ba)*ha;u[15]=(ca*Ca-ea*ya+la*Ba)*ha;return u}function v(u,O){const X=O[0],ba=O[1],ja=O[2],L=O[3],
P=O[4],S=O[5],W=O[6],aa=O[7],ca=O[8],ea=O[9],la=O[10],ma=O[11],ua=O[12],qa=O[13],ra=O[14];O=O[15];u[0]=S*(la*O-ma*ra)-ea*(W*O-aa*ra)+qa*(W*ma-aa*la);u[1]=-(ba*(la*O-ma*ra)-ea*(ja*O-L*ra)+qa*(ja*ma-L*la));u[2]=ba*(W*O-aa*ra)-S*(ja*O-L*ra)+qa*(ja*aa-L*W);u[3]=-(ba*(W*ma-aa*la)-S*(ja*ma-L*la)+ea*(ja*aa-L*W));u[4]=-(P*(la*O-ma*ra)-ca*(W*O-aa*ra)+ua*(W*ma-aa*la));u[5]=X*(la*O-ma*ra)-ca*(ja*O-L*ra)+ua*(ja*ma-L*la);u[6]=-(X*(W*O-aa*ra)-P*(ja*O-L*ra)+ua*(ja*aa-L*W));u[7]=X*(W*ma-aa*la)-P*(ja*ma-L*la)+ca*
(ja*aa-L*W);u[8]=P*(ea*O-ma*qa)-ca*(S*O-aa*qa)+ua*(S*ma-aa*ea);u[9]=-(X*(ea*O-ma*qa)-ca*(ba*O-L*qa)+ua*(ba*ma-L*ea));u[10]=X*(S*O-aa*qa)-P*(ba*O-L*qa)+ua*(ba*aa-L*S);u[11]=-(X*(S*ma-aa*ea)-P*(ba*ma-L*ea)+ca*(ba*aa-L*S));u[12]=-(P*(ea*ra-la*qa)-ca*(S*ra-W*qa)+ua*(S*la-W*ea));u[13]=X*(ea*ra-la*qa)-ca*(ba*ra-ja*qa)+ua*(ba*la-ja*ea);u[14]=-(X*(S*ra-W*qa)-P*(ba*ra-ja*qa)+ua*(ba*W-ja*S));u[15]=X*(S*la-W*ea)-P*(ba*la-ja*ea)+ca*(ba*W-ja*S);return u}function x(u){const O=u[0],X=u[1],ba=u[2],ja=u[3],L=u[4],
P=u[5],S=u[6],W=u[7],aa=u[8],ca=u[9],ea=u[10],la=u[11],ma=u[12],ua=u[13],qa=u[14];u=u[15];return(O*P-X*L)*(ea*u-la*qa)-(O*S-ba*L)*(ca*u-la*ua)+(O*W-ja*L)*(ca*qa-ea*ua)+(X*S-ba*P)*(aa*u-la*ma)-(X*W-ja*P)*(aa*qa-ea*ma)+(ba*W-ja*S)*(aa*ua-ca*ma)}function B(u,O,X){const ba=O[0],ja=O[1],L=O[2],P=O[3],S=O[4],W=O[5],aa=O[6],ca=O[7],ea=O[8],la=O[9],ma=O[10],ua=O[11],qa=O[12],ra=O[13],Ba=O[14];O=O[15];let ya=X[0],Aa=X[1],Ca=X[2],za=X[3];u[0]=ya*ba+Aa*S+Ca*ea+za*qa;u[1]=ya*ja+Aa*W+Ca*la+za*ra;u[2]=ya*L+Aa*
aa+Ca*ma+za*Ba;u[3]=ya*P+Aa*ca+Ca*ua+za*O;ya=X[4];Aa=X[5];Ca=X[6];za=X[7];u[4]=ya*ba+Aa*S+Ca*ea+za*qa;u[5]=ya*ja+Aa*W+Ca*la+za*ra;u[6]=ya*L+Aa*aa+Ca*ma+za*Ba;u[7]=ya*P+Aa*ca+Ca*ua+za*O;ya=X[8];Aa=X[9];Ca=X[10];za=X[11];u[8]=ya*ba+Aa*S+Ca*ea+za*qa;u[9]=ya*ja+Aa*W+Ca*la+za*ra;u[10]=ya*L+Aa*aa+Ca*ma+za*Ba;u[11]=ya*P+Aa*ca+Ca*ua+za*O;ya=X[12];Aa=X[13];Ca=X[14];za=X[15];u[12]=ya*ba+Aa*S+Ca*ea+za*qa;u[13]=ya*ja+Aa*W+Ca*la+za*ra;u[14]=ya*L+Aa*aa+Ca*ma+za*Ba;u[15]=ya*P+Aa*ca+Ca*ua+za*O;return u}function D(u,
O,X){const ba=X[0],ja=X[1];X=X[2];if(O===u)u[12]=O[0]*ba+O[4]*ja+O[8]*X+O[12],u[13]=O[1]*ba+O[5]*ja+O[9]*X+O[13],u[14]=O[2]*ba+O[6]*ja+O[10]*X+O[14],u[15]=O[3]*ba+O[7]*ja+O[11]*X+O[15];else{const L=O[0],P=O[1],S=O[2],W=O[3],aa=O[4],ca=O[5],ea=O[6],la=O[7],ma=O[8],ua=O[9],qa=O[10],ra=O[11];u[0]=L;u[1]=P;u[2]=S;u[3]=W;u[4]=aa;u[5]=ca;u[6]=ea;u[7]=la;u[8]=ma;u[9]=ua;u[10]=qa;u[11]=ra;u[12]=L*ba+aa*ja+ma*X+O[12];u[13]=P*ba+ca*ja+ua*X+O[13];u[14]=S*ba+ea*ja+qa*X+O[14];u[15]=W*ba+la*ja+ra*X+O[15]}return u}
function p(u,O,X){const ba=X[0],ja=X[1];X=X[2];u[0]=O[0]*ba;u[1]=O[1]*ba;u[2]=O[2]*ba;u[3]=O[3]*ba;u[4]=O[4]*ja;u[5]=O[5]*ja;u[6]=O[6]*ja;u[7]=O[7]*ja;u[8]=O[8]*X;u[9]=O[9]*X;u[10]=O[10]*X;u[11]=O[11]*X;u[12]=O[12];u[13]=O[13];u[14]=O[14];u[15]=O[15];return u}function A(u,O,X,ba){var ja=ba[0],L=ba[1];ba=ba[2];var P=Math.sqrt(ja*ja+L*L+ba*ba);if(P<=n.getEpsilon())z(u,O);else{P=1/P;ja*=P;L*=P;ba*=P;var S=Math.sin(X),W=Math.cos(X),aa=1-W;X=O[0];P=O[1];var ca=O[2],ea=O[3],la=O[4],ma=O[5],ua=O[6],qa=O[7],
ra=O[8],Ba=O[9],ya=O[10],Aa=O[11],Ca=ja*ja*aa+W,za=L*ja*aa+ba*S,Fa=ba*ja*aa-L*S,Ra=ja*L*aa-ba*S,bb=L*L*aa+W,cb=ba*L*aa+ja*S,Xa=ja*ba*aa+L*S;ja=L*ba*aa-ja*S;L=ba*ba*aa+W;u[0]=X*Ca+la*za+ra*Fa;u[1]=P*Ca+ma*za+Ba*Fa;u[2]=ca*Ca+ua*za+ya*Fa;u[3]=ea*Ca+qa*za+Aa*Fa;u[4]=X*Ra+la*bb+ra*cb;u[5]=P*Ra+ma*bb+Ba*cb;u[6]=ca*Ra+ua*bb+ya*cb;u[7]=ea*Ra+qa*bb+Aa*cb;u[8]=X*Xa+la*ja+ra*L;u[9]=P*Xa+ma*ja+Ba*L;u[10]=ca*Xa+ua*ja+ya*L;u[11]=ea*Xa+qa*ja+Aa*L;O!==u&&(u[12]=O[12],u[13]=O[13],u[14]=O[14],u[15]=O[15])}}function F(u,
O,X){const ba=Math.sin(X);X=Math.cos(X);const ja=O[4],L=O[5],P=O[6],S=O[7],W=O[8],aa=O[9],ca=O[10],ea=O[11];O!==u&&(u[0]=O[0],u[1]=O[1],u[2]=O[2],u[3]=O[3],u[12]=O[12],u[13]=O[13],u[14]=O[14],u[15]=O[15]);u[4]=ja*X+W*ba;u[5]=L*X+aa*ba;u[6]=P*X+ca*ba;u[7]=S*X+ea*ba;u[8]=W*X-ja*ba;u[9]=aa*X-L*ba;u[10]=ca*X-P*ba;u[11]=ea*X-S*ba;return u}function q(u,O,X){const ba=Math.sin(X);X=Math.cos(X);const ja=O[0],L=O[1],P=O[2],S=O[3],W=O[8],aa=O[9],ca=O[10],ea=O[11];O!==u&&(u[4]=O[4],u[5]=O[5],u[6]=O[6],u[7]=O[7],
u[12]=O[12],u[13]=O[13],u[14]=O[14],u[15]=O[15]);u[0]=ja*X-W*ba;u[1]=L*X-aa*ba;u[2]=P*X-ca*ba;u[3]=S*X-ea*ba;u[8]=ja*ba+W*X;u[9]=L*ba+aa*X;u[10]=P*ba+ca*X;u[11]=S*ba+ea*X;return u}function c(u,O,X){const ba=Math.sin(X);X=Math.cos(X);const ja=O[0],L=O[1],P=O[2],S=O[3],W=O[4],aa=O[5],ca=O[6],ea=O[7];O!==u&&(u[8]=O[8],u[9]=O[9],u[10]=O[10],u[11]=O[11],u[12]=O[12],u[13]=O[13],u[14]=O[14],u[15]=O[15]);u[0]=ja*X+W*ba;u[1]=L*X+aa*ba;u[2]=P*X+ca*ba;u[3]=S*X+ea*ba;u[4]=W*X-ja*ba;u[5]=aa*X-L*ba;u[6]=ca*X-P*
ba;u[7]=ea*X-S*ba;return u}function l(u,O){u[0]=1;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=1;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=1;u[11]=0;u[12]=O[0];u[13]=O[1];u[14]=O[2];u[15]=1;return u}function H(u,O){u[0]=O[0];u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=O[1];u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=O[2];u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function g(u,O,X){if(0===O)return G(u);let ba=X[0],ja=X[1];X=X[2];var L=Math.sqrt(ba*ba+ja*ja+X*X);if(L<=n.getEpsilon())return null;L=1/L;ba*=L;ja*=L;X*=L;L=Math.sin(O);O=
Math.cos(O);const P=1-O;u[0]=ba*ba*P+O;u[1]=ja*ba*P+X*L;u[2]=X*ba*P-ja*L;u[3]=0;u[4]=ba*ja*P-X*L;u[5]=ja*ja*P+O;u[6]=X*ja*P+ba*L;u[7]=0;u[8]=ba*X*P+ja*L;u[9]=ja*X*P-ba*L;u[10]=X*X*P+O;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function I(u,O){const X=Math.sin(O);O=Math.cos(O);u[0]=1;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=O;u[6]=X;u[7]=0;u[8]=0;u[9]=-X;u[10]=O;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function E(u,O){const X=Math.sin(O);O=Math.cos(O);u[0]=O;u[1]=0;u[2]=-X;u[3]=0;u[4]=0;u[5]=
1;u[6]=0;u[7]=0;u[8]=X;u[9]=0;u[10]=O;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function C(u,O){const X=Math.sin(O);O=Math.cos(O);u[0]=O;u[1]=X;u[2]=0;u[3]=0;u[4]=-X;u[5]=O;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=1;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function N(u,O,X){var ba=O[0],ja=O[1],L=O[2],P=O[3],S=ba+ba,W=ja+ja;const aa=L+L;O=ba*S;const ca=ba*W;ba*=aa;const ea=ja*W;ja*=aa;L*=aa;S*=P;W*=P;P*=aa;u[0]=1-(ea+L);u[1]=ca+P;u[2]=ba-W;u[3]=0;u[4]=ca-P;u[5]=1-(O+L);u[6]=ja+S;u[7]=0;u[8]=
ba+W;u[9]=ja-S;u[10]=1-(O+ea);u[11]=0;u[12]=X[0];u[13]=X[1];u[14]=X[2];u[15]=1;return u}function Q(u,O){const X=La,ba=-O[0],ja=-O[1],L=-O[2],P=O[3],S=O[4],W=O[5],aa=O[6],ca=O[7],ea=ba*ba+ja*ja+L*L+P*P;0<ea?(X[0]=2*(S*P+ca*ba+W*L-aa*ja)/ea,X[1]=2*(W*P+ca*ja+aa*ba-S*L)/ea,X[2]=2*(aa*P+ca*L+S*ja-W*ba)/ea):(X[0]=2*(S*P+ca*ba+W*L-aa*ja),X[1]=2*(W*P+ca*ja+aa*ba-S*L),X[2]=2*(aa*P+ca*L+S*ja-W*ba));N(u,O,X);return u}function T(u,O){u[0]=O[12];u[1]=O[13];u[2]=O[14];return u}function y(u,O){const X=O[0],ba=
O[1],ja=O[2],L=O[4],P=O[5],S=O[6],W=O[8],aa=O[9];O=O[10];u[0]=Math.sqrt(X*X+ba*ba+ja*ja);u[1]=Math.sqrt(L*L+P*P+S*S);u[2]=Math.sqrt(W*W+aa*aa+O*O);return u}function R(u,O){const X=O[0]+O[5]+O[10];let ba=0;0<X?(ba=2*Math.sqrt(X+1),u[3]=.25*ba,u[0]=(O[6]-O[9])/ba,u[1]=(O[8]-O[2])/ba,u[2]=(O[1]-O[4])/ba):O[0]>O[5]&&O[0]>O[10]?(ba=2*Math.sqrt(1+O[0]-O[5]-O[10]),u[3]=(O[6]-O[9])/ba,u[0]=.25*ba,u[1]=(O[1]+O[4])/ba,u[2]=(O[8]+O[2])/ba):O[5]>O[10]?(ba=2*Math.sqrt(1+O[5]-O[0]-O[10]),u[3]=(O[8]-O[2])/ba,u[0]=
(O[1]+O[4])/ba,u[1]=.25*ba,u[2]=(O[6]+O[9])/ba):(ba=2*Math.sqrt(1+O[10]-O[0]-O[5]),u[3]=(O[1]-O[4])/ba,u[0]=(O[8]+O[2])/ba,u[1]=(O[6]+O[9])/ba,u[2]=.25*ba);return u}function k(u,O,X,ba){var ja=O[0],L=O[1],P=O[2],S=O[3],W=ja+ja,aa=L+L,ca=P+P;O=ja*W;const ea=ja*aa;ja*=ca;const la=L*aa;L*=ca;P*=ca;W*=S;aa*=S;S*=ca;ca=ba[0];const ma=ba[1];ba=ba[2];u[0]=(1-(la+P))*ca;u[1]=(ea+S)*ca;u[2]=(ja-aa)*ca;u[3]=0;u[4]=(ea-S)*ma;u[5]=(1-(O+P))*ma;u[6]=(L+W)*ma;u[7]=0;u[8]=(ja+aa)*ba;u[9]=(L-W)*ba;u[10]=(1-(O+la))*
ba;u[11]=0;u[12]=X[0];u[13]=X[1];u[14]=X[2];u[15]=1;return u}function h(u,O,X,ba,ja){var L=O[0],P=O[1],S=O[2],W=O[3],aa=L+L,ca=P+P,ea=S+S;O=L*aa;var la=L*ca,ma=L*ea;L=P*ca;P*=ea;var ua=S*ea;S=W*aa;ca*=W;const qa=W*ea;var ra=ba[0],Ba=ba[1];ea=ba[2];ba=ja[0];W=ja[1];ja=ja[2];aa=(1-(L+ua))*ra;const ya=(la+qa)*ra;ra*=ma-ca;la=(la-qa)*Ba;ua=(1-(O+ua))*Ba;Ba*=P+S;ma=(ma+ca)*ea;P=(P-S)*ea;O=(1-(O+L))*ea;u[0]=aa;u[1]=ya;u[2]=ra;u[3]=0;u[4]=la;u[5]=ua;u[6]=Ba;u[7]=0;u[8]=ma;u[9]=P;u[10]=O;u[11]=0;u[12]=X[0]+
ba-(aa*ba+la*W+ma*ja);u[13]=X[1]+W-(ya*ba+ua*W+P*ja);u[14]=X[2]+ja-(ra*ba+Ba*W+O*ja);u[15]=1;return u}function t(u,O){var X=O[0],ba=O[1],ja=O[2];O=O[3];var L=X+X,P=ba+ba;const S=ja+ja;X*=L;const W=ba*L;ba*=P;const aa=ja*L,ca=ja*P;ja*=S;L*=O;P*=O;O*=S;u[0]=1-ba-ja;u[1]=W+O;u[2]=aa-P;u[3]=0;u[4]=W-O;u[5]=1-X-ja;u[6]=ca+L;u[7]=0;u[8]=aa+P;u[9]=ca-L;u[10]=1-X-ba;u[11]=0;u[12]=0;u[13]=0;u[14]=0;u[15]=1;return u}function J(u,O,X,ba,ja,L,P){const S=1/(X-O),W=1/(ja-ba),aa=1/(L-P);u[0]=2*L*S;u[1]=0;u[2]=0;
u[3]=0;u[4]=0;u[5]=2*L*W;u[6]=0;u[7]=0;u[8]=(X+O)*S;u[9]=(ja+ba)*W;u[10]=(P+L)*aa;u[11]=-1;u[12]=0;u[13]=0;u[14]=P*L*2*aa;u[15]=0;return u}function U(u,O,X,ba,ja){O=1/Math.tan(O/2);let L=void 0;u[0]=O/X;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=O;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[11]=-1;u[12]=0;u[13]=0;u[15]=0;null!=ja&&Infinity!==ja?(L=1/(ba-ja),u[10]=(ja+ba)*L,u[14]=2*ja*ba*L):(u[10]=-1,u[14]=-2*ba);return u}function Y(u,O,X,ba){const ja=Math.tan(O.upDegrees*Math.PI/180),L=Math.tan(O.downDegrees*Math.PI/180),
P=Math.tan(O.leftDegrees*Math.PI/180);O=Math.tan(O.rightDegrees*Math.PI/180);const S=2/(P+O),W=2/(ja+L);u[0]=S;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=W;u[6]=0;u[7]=0;u[8]=-((P-O)*S*.5);u[9]=(ja-L)*W*.5;u[10]=ba/(X-ba);u[11]=-1;u[12]=0;u[13]=0;u[14]=ba*X/(X-ba);u[15]=0;return u}function da(u,O,X,ba,ja,L,P){const S=1/(O-X),W=1/(ba-ja),aa=1/(L-P);u[0]=-2*S;u[1]=0;u[2]=0;u[3]=0;u[4]=0;u[5]=-2*W;u[6]=0;u[7]=0;u[8]=0;u[9]=0;u[10]=2*aa;u[11]=0;u[12]=(O+X)*S;u[13]=(ja+ba)*W;u[14]=(P+L)*aa;u[15]=1;return u}function ia(u,
O,X,ba){const ja=O[0],L=O[1];O=O[2];let P=ja-X[0],S=L-X[1];X=O-X[2];var W=n.getEpsilon();if(Math.abs(P)<W&&Math.abs(S)<W&&Math.abs(X)<W)G(u);else{var aa=1/Math.sqrt(P*P+S*S+X*X);P*=aa;S*=aa;X*=aa;aa=ba[0];var ca=ba[1];W=ba[2];ba=ca*X-W*S;W=W*P-aa*X;ca=aa*S-ca*P;(aa=Math.sqrt(ba*ba+W*W+ca*ca))?(aa=1/aa,ba*=aa,W*=aa,ca*=aa):ca=W=ba=0;var ea=S*ca-X*W,la=X*ba-P*ca,ma=P*W-S*ba;(aa=Math.sqrt(ea*ea+la*la+ma*ma))?(aa=1/aa,ea*=aa,la*=aa,ma*=aa):ma=la=ea=0;u[0]=ba;u[1]=ea;u[2]=P;u[3]=0;u[4]=W;u[5]=la;u[6]=
S;u[7]=0;u[8]=ca;u[9]=ma;u[10]=X;u[11]=0;u[12]=-(ba*ja+W*L+ca*O);u[13]=-(ea*ja+la*L+ma*O);u[14]=-(P*ja+S*L+X*O);u[15]=1}}function na(u,O,X,ba){const ja=O[0],L=O[1];O=O[2];var P=ba[0];const S=ba[1];var W=ba[2];ba=ja-X[0];let aa=L-X[1];X=O-X[2];let ca=ba*ba+aa*aa+X*X;0<ca&&(ca=1/Math.sqrt(ca),ba*=ca,aa*=ca,X*=ca);let ea=S*X-W*aa;W=W*ba-P*X;P=P*aa-S*ba;ca=ea*ea+W*W+P*P;0<ca&&(ca=1/Math.sqrt(ca),ea*=ca,W*=ca,P*=ca);u[0]=ea;u[1]=W;u[2]=P;u[3]=0;u[4]=aa*P-X*W;u[5]=X*ea-ba*P;u[6]=ba*W-aa*ea;u[7]=0;u[8]=
ba;u[9]=aa;u[10]=X;u[11]=0;u[12]=ja;u[13]=L;u[14]=O;u[15]=1;return u}function oa(u){return"mat4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+", "+u[4]+", "+u[5]+", "+u[6]+", "+u[7]+", "+u[8]+", "+u[9]+", "+u[10]+", "+u[11]+", "+u[12]+", "+u[13]+", "+u[14]+", "+u[15]+")"}function pa(u){return Math.sqrt(u[0]**2+u[1]**2+u[2]**2+u[3]**2+u[4]**2+u[5]**2+u[6]**2+u[7]**2+u[8]**2+u[9]**2+u[10]**2+u[11]**2+u[12]**2+u[13]**2+u[14]**2+u[15]**2)}function sa(u,O,X){u[0]=O[0]+X[0];u[1]=O[1]+X[1];u[2]=O[2]+X[2];u[3]=O[3]+
X[3];u[4]=O[4]+X[4];u[5]=O[5]+X[5];u[6]=O[6]+X[6];u[7]=O[7]+X[7];u[8]=O[8]+X[8];u[9]=O[9]+X[9];u[10]=O[10]+X[10];u[11]=O[11]+X[11];u[12]=O[12]+X[12];u[13]=O[13]+X[13];u[14]=O[14]+X[14];u[15]=O[15]+X[15];return u}function wa(u,O,X){u[0]=O[0]-X[0];u[1]=O[1]-X[1];u[2]=O[2]-X[2];u[3]=O[3]-X[3];u[4]=O[4]-X[4];u[5]=O[5]-X[5];u[6]=O[6]-X[6];u[7]=O[7]-X[7];u[8]=O[8]-X[8];u[9]=O[9]-X[9];u[10]=O[10]-X[10];u[11]=O[11]-X[11];u[12]=O[12]-X[12];u[13]=O[13]-X[13];u[14]=O[14]-X[14];u[15]=O[15]-X[15];return u}function xa(u,
O,X){u[0]=O[0]*X;u[1]=O[1]*X;u[2]=O[2]*X;u[3]=O[3]*X;u[4]=O[4]*X;u[5]=O[5]*X;u[6]=O[6]*X;u[7]=O[7]*X;u[8]=O[8]*X;u[9]=O[9]*X;u[10]=O[10]*X;u[11]=O[11]*X;u[12]=O[12]*X;u[13]=O[13]*X;u[14]=O[14]*X;u[15]=O[15]*X;return u}function Da(u,O,X,ba){u[0]=O[0]+X[0]*ba;u[1]=O[1]+X[1]*ba;u[2]=O[2]+X[2]*ba;u[3]=O[3]+X[3]*ba;u[4]=O[4]+X[4]*ba;u[5]=O[5]+X[5]*ba;u[6]=O[6]+X[6]*ba;u[7]=O[7]+X[7]*ba;u[8]=O[8]+X[8]*ba;u[9]=O[9]+X[9]*ba;u[10]=O[10]+X[10]*ba;u[11]=O[11]+X[11]*ba;u[12]=O[12]+X[12]*ba;u[13]=O[13]+X[13]*
ba;u[14]=O[14]+X[14]*ba;u[15]=O[15]+X[15]*ba;return u}function Ea(u,O){return u[0]===O[0]&&u[1]===O[1]&&u[2]===O[2]&&u[3]===O[3]&&u[4]===O[4]&&u[5]===O[5]&&u[6]===O[6]&&u[7]===O[7]&&u[8]===O[8]&&u[9]===O[9]&&u[10]===O[10]&&u[11]===O[11]&&u[12]===O[12]&&u[13]===O[13]&&u[14]===O[14]&&u[15]===O[15]}function Ja(u,O){if(u===O)return!0;const X=u[0],ba=u[1],ja=u[2],L=u[3],P=u[4],S=u[5],W=u[6],aa=u[7],ca=u[8],ea=u[9],la=u[10],ma=u[11],ua=u[12],qa=u[13],ra=u[14];u=u[15];const Ba=O[0],ya=O[1],Aa=O[2],Ca=O[3],
za=O[4],Fa=O[5],Ra=O[6],bb=O[7],cb=O[8],Xa=O[9],Ma=O[10],Na=O[11],ha=O[12],ic=O[13],Kb=O[14];O=O[15];const Ia=n.getEpsilon();return Math.abs(X-Ba)<=Ia*Math.max(1,Math.abs(X),Math.abs(Ba))&&Math.abs(ba-ya)<=Ia*Math.max(1,Math.abs(ba),Math.abs(ya))&&Math.abs(ja-Aa)<=Ia*Math.max(1,Math.abs(ja),Math.abs(Aa))&&Math.abs(L-Ca)<=Ia*Math.max(1,Math.abs(L),Math.abs(Ca))&&Math.abs(P-za)<=Ia*Math.max(1,Math.abs(P),Math.abs(za))&&Math.abs(S-Fa)<=Ia*Math.max(1,Math.abs(S),Math.abs(Fa))&&Math.abs(W-Ra)<=Ia*Math.max(1,
Math.abs(W),Math.abs(Ra))&&Math.abs(aa-bb)<=Ia*Math.max(1,Math.abs(aa),Math.abs(bb))&&Math.abs(ca-cb)<=Ia*Math.max(1,Math.abs(ca),Math.abs(cb))&&Math.abs(ea-Xa)<=Ia*Math.max(1,Math.abs(ea),Math.abs(Xa))&&Math.abs(la-Ma)<=Ia*Math.max(1,Math.abs(la),Math.abs(Ma))&&Math.abs(ma-Na)<=Ia*Math.max(1,Math.abs(ma),Math.abs(Na))&&Math.abs(ua-ha)<=Ia*Math.max(1,Math.abs(ua),Math.abs(ha))&&Math.abs(qa-ic)<=Ia*Math.max(1,Math.abs(qa),Math.abs(ic))&&Math.abs(ra-Kb)<=Ia*Math.max(1,Math.abs(ra),Math.abs(Kb))&&Math.abs(u-
O)<=Ia*Math.max(1,Math.abs(u),Math.abs(O))}function Sa(u){const O=n.getEpsilon(),X=u[0],ba=u[1],ja=u[2],L=u[4],P=u[5],S=u[6],W=u[8],aa=u[9];u=u[10];return Math.abs(1-(X*X+L*L+W*W))<=O&&Math.abs(1-(ba*ba+P*P+aa*aa))<=O&&Math.abs(1-(ja*ja+S*S+u*u))<=O}function ab(u){return 1===u[0]&&0===u[1]&&0===u[2]&&0===u[4]&&1===u[5]&&0===u[6]&&0===u[8]&&0===u[9]&&1===u[10]}const La=d.create();d=Object.freeze(Object.defineProperty({__proto__:null,add:sa,adjoint:v,copy:z,determinant:x,equals:Ja,exactEquals:Ea,frob:pa,
fromQuat:t,fromQuat2:Q,fromRotation:g,fromRotationTranslation:N,fromRotationTranslationScale:k,fromRotationTranslationScaleOrigin:h,fromScaling:H,fromTranslation:l,fromXRotation:I,fromYRotation:E,fromZRotation:C,frustum:J,getRotation:R,getScaling:y,getTranslation:T,hasIdentityRotation:ab,identity:G,invert:f,invertOrIdentity:m,isOrthoNormal:Sa,lookAt:ia,mul:B,multiply:B,multiplyScalar:xa,multiplyScalarAndAdd:Da,ortho:da,perspective:U,perspectiveFromFieldOfView:Y,rotate:A,rotateX:F,rotateY:q,rotateZ:c,
scale:p,set:r,str:oa,sub:wa,subtract:wa,targetTo:na,translate:D,transpose:b},Symbol.toStringTag,{value:"Module"}));a.add=sa;a.adjoint=v;a.copy=z;a.determinant=x;a.equals=Ja;a.exactEquals=Ea;a.frob=pa;a.fromQuat=t;a.fromQuat2=Q;a.fromRotation=g;a.fromRotationTranslation=N;a.fromRotationTranslationScale=k;a.fromRotationTranslationScaleOrigin=h;a.fromScaling=H;a.fromTranslation=l;a.fromXRotation=I;a.fromYRotation=E;a.fromZRotation=C;a.frustum=J;a.getRotation=R;a.getScaling=y;a.getTranslation=T;a.hasIdentityRotation=
ab;a.identity=G;a.invert=f;a.invertOrIdentity=m;a.isOrthoNormal=Sa;a.lookAt=ia;a.mat4=d;a.mul=B;a.multiply=B;a.multiplyScalar=xa;a.multiplyScalarAndAdd=Da;a.ortho=da;a.perspective=U;a.perspectiveFromFieldOfView=Y;a.rotate=A;a.rotateX=F;a.rotateY=q;a.rotateZ=c;a.scale=p;a.set=r;a.str=oa;a.sub=wa;a.subtract=wa;a.targetTo=na;a.translate=D;a.transpose=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/statistics/utils":function(){define(["exports","../rest/support/ClassBreaksDefinition",
"../rest/support/generateRendererUtils"],function(a,d,n){function z(k){return null==k||"string"===typeof k&&!k?"\x3cNull\x3e":k}function r(k){const h=null!=k.minValue||null!=k.maxValue,t=!!k.sqlExpression&&k.supportsSQLExpression;return!(null!=k.normalizationField||null!=k.normalizationType)&&!h&&!t}function G(k){const {values:h,useSampleStdDev:t,supportsNullCount:J,outStatisticTypes:U}=k;var Y=Number.POSITIVE_INFINITY;let da=Number.NEGATIVE_INFINITY,ia=null,na=null;var oa=null;let pa=null,sa=0;const wa=
null==k.minValue?-Infinity:k.minValue,xa=null==k.maxValue?Infinity:k.maxValue;for(const Da of h)Number.isFinite(Da)?Da>=wa&&Da<=xa&&(ia=null===ia?Da:ia+Da,Y=Math.min(Y,Da),da=Math.max(da,Da),sa++):"string"===typeof Da&&sa++;if(sa&&null!=ia){na=ia/sa;oa=0;for(const Da of h)Number.isFinite(Da)&&Da>=wa&&Da<=xa&&(oa+=(Da-na)**2);pa=t?1<sa?oa/(sa-1):0:0<sa?oa/sa:0;oa=Math.sqrt(pa)}else da=Y=null;Y={avg:na,count:sa,max:da,min:Y,stddev:oa,sum:ia,variance:pa};J&&(Y.nullcount=h.length-sa);!k.percentileParams||
U?.include?.length&&!U.include.includes("median")||U?.exclude?.length&&U.exclude.includes("median")||(Y.median=b(h,k.percentileParams));return Y}function b(k,h){const {fieldType:t,value:J,orderBy:U,isDiscrete:Y}=h,da=m(t,"desc"===U);k=[...k].filter(pa=>null!=pa).sort((pa,sa)=>da(pa,sa));if(0===k.length)return null;if(0>=J)return k[0];if(1<=J)return k[k.length-1];var ia=(k.length-1)*J,na=Math.floor(ia);h=na+1;ia%=1;na=k[na];const oa=k[h];return h>=k.length||Y||"string"===typeof na||"string"===typeof oa?
na:na*(1-ia)+oa*ia}function m(k,h){if(k){if(l.has(k))return h?y:R;if(H.has(k))return f(h,!1);if("esriFieldTypeTimestampOffset"===k)return h?N:C;const da=f(h,!0);if("esriFieldTypeString"===k)return da;if("esriFieldTypeGUID"===k||"esriFieldTypeGlobalID"===k)return(ia,na)=>da(v(ia),v(na))}const t=h?1:-1,J=h?y:R,U=f(h,!0),Y=h?I:E;return(da,ia)=>"number"===typeof da&&"number"===typeof ia?J(da,ia):"string"===typeof da&&"string"===typeof ia?U(da,ia):Y(da,ia)??t}function f(k,h){if(!h)return k?T:Q;const t=
k?I:E;return k?(J,U)=>{const Y=t(J,U);if(null!=Y)return Y;J=J.toUpperCase();U=U.toUpperCase();return J>U?-1:J<U?1:0}:(J,U)=>{const Y=t(J,U);if(null!=Y)return Y;J=J.toUpperCase();U=U.toUpperCase();return J<U?-1:J>U?1:0}}function v(k){return k.slice(24,36)+k.slice(19,23)+k.slice(16,18)+k.slice(14,16)+k.slice(11,13)+k.slice(9,11)+k.slice(6,8)+k.slice(4,6)+k.slice(2,4)+k.slice(0,2)}function x(k){return"coded-value"!==k?.type?[]:k.codedValues.map(h=>h.code)}function B(k,h){const t=p({field:h.field,normalizationType:h.normalizationType,
normalizationField:h.normalizationField,classificationMethod:h.classificationMethod,standardDeviationInterval:h.standardDeviationInterval,breakCount:h.numClasses||5});k=D(k,h.minValue,h.maxValue);return n.createGenerateRendererClassBreaks({definition:t,values:k,normalizationTotal:h.normalizationTotal})}function D(k,h,t){const J=null==h?-Infinity:h,U=null==t?Infinity:t;return k.filter(Y=>Number.isFinite(Y)&&Y>=J&&Y<=U)}function p(k){const {breakCount:h,field:t,normalizationField:J,normalizationType:U}=
k,Y=k.classificationMethod||"equal-interval";return new d({breakCount:h,classificationField:t,classificationMethod:Y,normalizationField:"field"===U?J:void 0,normalizationType:U,standardDeviationInterval:"standard-deviation"===Y?k.standardDeviationInterval||1:void 0,definedInterval:"defined-interval"===Y?k.definedInterval:void 0})}function A(k,h){const {field:t,classificationMethod:J,standardDeviationInterval:U,normalizationType:Y,normalizationField:da,normalizationTotal:ia,minValue:na,maxValue:oa}=
h,pa=h.numBins||10;let sa=h=null,wa=null;J&&"equal-interval"!==J||Y?({classBreaks:k}=B(k,{field:t,normalizationType:Y,normalizationField:da,normalizationTotal:ia,classificationMethod:J,standardDeviationInterval:U,minValue:na,maxValue:oa,numClasses:pa}),h=k[0].minValue,sa=k[k.length-1].maxValue,wa=k.map(xa=>[xa.minValue,xa.maxValue])):(null!=na&&null!=oa?(h=na,sa=oa):(k=G({values:k,minValue:na,maxValue:oa,useSampleStdDev:!Y,supportsNullCount:r({normalizationType:Y,normalizationField:da,minValue:na,
maxValue:oa})}),h=k.min??null,sa=k.max??null),wa=q(h??0,sa??0,pa));return{min:h,max:sa,intervals:wa}}function F(k,h){let t=-1;for(let J=k.length-1;0<=J;J--)if(h>=k[J][0]){t=J;break}return t}function q(k,h,t){const J=(h-k)/t,U=[];let Y;for(let da=1;da<=t;da++)Y=k+J,Y=Number(Y.toFixed(16)),U.push([k,da===t?h:Y]),k=Y;return U}const c=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,l=new Set("esriFieldTypeDate esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeOID esriFieldTypeBigInteger".split(" ")),
H=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),g="min max avg stddev count sum variance nullcount median".split(" "),I=(k,h)=>null==k?null==h?0:1:null==h?-1:null,E=(k,h)=>null==k?null==h?0:-1:null==h?1:null,C=(k,h)=>E(k,h)??(k===h?0:(new Date(k)).getTime()-(new Date(h)).getTime()),N=(k,h)=>I(k,h)??(k===h?0:(new Date(h)).getTime()-(new Date(k)).getTime()),Q=(k,h)=>E(k,h)??(k===h?0:k<h?-1:1),T=(k,h)=>I(k,h)??(k===h?0:k<h?1:-1),y=(k,h)=>I(k,h)??h-k,R=(k,h)=>E(k,h)??k-h;a.calculateClassBreaks=
B;a.calculateHistogram=function(k,h){var t=A(k,h);if(null==t.min&&null==t.max)return{bins:[],minValue:t.min,maxValue:t.max,normalizationTotal:h.normalizationTotal};const J=t.intervals,U=t.min??0;t=t.max??0;const Y=J.map((da,ia)=>({minValue:J[ia][0],maxValue:J[ia][1],count:0}));for(const da of k)null!=da&&da>=U&&da<=t&&(k=F(J,da),-1<k&&Y[k].count++);return{bins:Y,minValue:U,maxValue:t,normalizationTotal:h.normalizationTotal}};a.calculatePercentile=b;a.calculateStatistics=G;a.calculateStringStatistics=
function(k){const {outStatisticTypes:h}=k,t=k.returnDistinct?[...(new Set(k.values))]:k.values;var J=t.filter(Y=>null!=Y).sort();const U=J.length;J={count:U,min:J[0],max:J[U-1]};k.supportsNullCount&&(J.nullcount=t.length-U);!k.percentileParams||h?.include?.length&&!h.include.includes("median")||h?.exclude?.length&&h.exclude.includes("median")||(J.median=b(t,k.percentileParams));return J};a.calculateUniqueValuesCount=function(k){const h={};for(let t of k){if(null==t||"string"===typeof t&&""===t.trim())t=
null;null==h[t]?h[t]={count:1,data:t}:h[t].count++}return{count:h}};a.createClassBreaksDefinition=p;a.createUVResult=function(k,h,t,J){k=k.count;const U=[];if(t&&h){t=[];var Y=x(h[0]);for(const da of Y)if(h[1]){Y=x(h[1]);for(const ia of Y)if(h[2]){Y=x(h[2]);for(const na of Y)t.push(`${z(da)}${J}${z(ia)}${J}${z(na)}`)}else t.push(`${z(da)}${J}${z(ia)}`)}else t.push(da);for(const da of t)k.hasOwnProperty(da)||(k[da]={data:da,count:0})}for(const da in k)h=k[da],U.push({value:h.data,count:h.count,label:h.label});
return{uniqueValueInfos:U}};a.getAttributeComparator=m;a.getEqualIntervalBins=q;a.getNormalizedValue=function(k,h,t,J){let U=null;switch(h){case "log":0!==k&&(U=Math.log(k)*Math.LOG10E);break;case "percent-of-total":Number.isFinite(J)&&0!==J&&(U=k/J*100);break;case "field":Number.isFinite(t)&&0!==t&&(U=k/t);break;case "natural-log":0<k&&(U=Math.log(k));break;case "square-root":0<k&&(U=k**.5)}return U};a.isNullCountSupported=r;a.processNullValue=z;a.processSummaryStatisticsResult=function(k,h,t){let J;
for(J in k)h?.include?.length&&!h.include.includes(J)||h?.exclude?.length&&h.exclude.includes(J)?delete k[J]:g.includes(J)&&(Number.isFinite(k[J])||(k[J]=null));if(!t)return k;["avg","stddev","variance"].forEach(U=>{null!=k[U]&&(k[U]=Math.ceil(k[U]??0))});return k};a.resolveCBResult=function(k,h){let t=k.classBreaks;const J=t[0]?.minValue,U=t[t.length-1]?.maxValue,Y="standard-deviation"===h;t=t.map(da=>{const ia=da.label;da={minValue:da.minValue,maxValue:da.maxValue,label:ia};if(Y&&ia){const na=ia.match(c)?.map(oa=>
+oa.trim())??[];2===na.length?(da.minStdDev=na[0],da.maxStdDev=na[1],0>na[0]&&0<na[1]&&(da.hasAvg=!0)):1===na.length&&(ia.includes("\x3c")?(da.minStdDev=null,da.maxStdDev=na[0]):ia.includes("\x3e")&&(da.minStdDev=na[0],da.maxStdDev=null))}return da});return{minValue:J,maxValue:U,classBreakInfos:t,normalizationTotal:k.normalizationTotal}};a.statisticTypes=g;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ClassBreaksDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m,f){r=new d.JSONMap({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"});d=new d.JSONMap({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});n=class extends n.JSONSupport{constructor(v){super(v);this.type="class-breaks-definition";
this.normalizationType=this.normalizationField=this.classificationMethod=this.classificationField=this.breakCount=null}set standardDeviationInterval(v){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",v)}set definedInterval(v){"defined-interval"===this.classificationMethod&&this._set("definedInterval",v)}};a.__decorate([m.enumeration({classBreaksDef:"class-breaks-definition"})],n.prototype,"type",void 0);a.__decorate([z.property({json:{write:!0}})],n.prototype,
"breakCount",void 0);a.__decorate([z.property({json:{write:!0}})],n.prototype,"classificationField",void 0);a.__decorate([z.property({type:String,json:{read:r.read,write:r.write}})],n.prototype,"classificationMethod",void 0);a.__decorate([z.property({json:{write:!0}})],n.prototype,"normalizationField",void 0);a.__decorate([z.property({json:{read:d.read,write:d.write}})],n.prototype,"normalizationType",void 0);a.__decorate([z.property({value:null,json:{write:!0}})],n.prototype,"standardDeviationInterval",
null);a.__decorate([z.property({value:null,json:{write:!0}})],n.prototype,"definedInterval",null);return n=a.__decorate([f.subclass("esri.rest.support.ClassBreaksDefinition")],n)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(a,d,n){a.enumeration=function(z,r={}){z=z instanceof d.JSONMap?z:new d.JSONMap(z,r);const {alwaysWriteDefaults:G,default:b,ignoreUnknown:m=!0,name:f,nonNullable:v,readOnly:x=!1}=r;return n.property({type:m?
z.apiValues:String,json:{type:z.jsonValues,default:b,name:f,read:x?!1:{reader:z.read},write:{writer:z.write,alwaysWriteDefaults:G}},nonNullable:v,readOnly:x})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/generateRendererUtils":function(){define(["exports","../../core/Logger"],function(a,d){function n(B){var D=B.definition;const {classificationMethod:p,normalizationType:A,definedInterval:F}=D;D=D.breakCount??1;const q=[];var c=B.values;if(0===c.length)return[];
c=c.sort((C,N)=>C-N);var l=c[0],H=c[c.length-1];if("equal-interval"===p)if(c.length>=D){c=(H-l)/D;B=l;for(var g=1;g<D;g++){var I=Number((l+g*c).toFixed(6));q.push({minValue:B,maxValue:I,label:z(B,I,A)});B=I}q.push({minValue:B,maxValue:H,label:z(B,H,A)})}else c.forEach(C=>{q.push({minValue:C,maxValue:C,label:z(C,C,A)})});else if("natural-breaks"===p){c=r(c);B=G(c.uniqueValues,B.valueFrequency||c.valueFrequency,D);for(g=1;g<D;g++)c.uniqueValues.length>g&&(I=Number(c.uniqueValues[B[g]].toFixed(6)),q.push({minValue:l,
maxValue:I,label:z(l,I,A)}),l=I);q.push({minValue:l,maxValue:H,label:z(l,H,A)})}else if("quantile"===p)if(c.length>=D&&l!==H){B=Math.ceil(c.length/D);g=0;for(I=1;I<D;I++){var E=B+g-1;E>c.length&&(E=c.length-1);0>E&&(E=0);q.push({minValue:l,maxValue:c[E],label:z(l,c[E],A)});l=c[E];g+=B;B=Math.ceil((c.length-g)/(D-I))}q.push({minValue:l,maxValue:H,label:z(l,H,A)})}else for(D=-1,H=0;H<c.length;H++)l=c[H],l!==D&&(D=l,q.push({minValue:D,maxValue:l,label:z(D,l,A)}),D=l);else if("standard-deviation"===p)if(B=
f(c),g=v(c,B),0===g)q.push({minValue:c[0],maxValue:c[0],label:z(c[0],c[0],A)});else{c=m(l,H,D,B,g)*g;g=0;for(I=D;1<=I;I--)E=Number((B-(I-.5)*c).toFixed(6)),q.push({minValue:l,maxValue:E,label:z(l,E,A)}),l=E,g++;I=Number((B+.5*c).toFixed(6));q.push({minValue:l,maxValue:I,label:z(l,I,A)});l=I;g++;for(E=1;E<=D;E++)I=g===2*D?H:Number((B+(E+.5)*c).toFixed(6)),q.push({minValue:l,maxValue:I,label:z(l,I,A)}),l=I,g++}else if("defined-interval"===p){if(!F)return q;D=c[0];H=c[c.length-1];c=Math.ceil((H-D)/F);
l=D;for(B=1;B<c;B++)g=Number((D+B*F).toFixed(6)),q.push({minValue:l,maxValue:g,label:z(l,g,A)}),l=g;q.push({minValue:l,maxValue:H,label:z(l,H,A)})}return q}function z(B,D,p){let A=null;return A=B===D?p&&"percent-of-total"===p?B+"%":B.toString():p&&"percent-of-total"===p?B+"% - "+D+"%":B+" - "+D}function r(B){const D=[],p=[];let A=Number.MIN_VALUE,F=1,q=-1;for(let c=0;c<B.length;c++){const l=B[c];l===A?(F++,p[q]=F):null!==l&&(D.push(l),A=l,F=1,p.push(F),q++)}return{uniqueValues:D,valueFrequency:p}}
function G(B,D,p){var A=B.length;const F=[];p>A&&(p=A);for(var q=0;q<p;q++)F.push(Math.round(q*A/p-1));F.push(A-1);q=b(F,B,D,p);A=q.mean;q=q.sdcm;var c=p,l=0,H=0;let g=0,I=0,E=!0;for(let N=0;2>N&&E;N++){0===N&&(E=!1);for(var C=0;C<c-1;C++)for(;F[C+1]+1!==F[C+2];)if(F[C+1]+=1,l=x(C,F,B,D),g=l.sbMean,l=l.sbSdcm,H=x(C+1,F,B,D),I=H.sbMean,H=H.sbSdcm,l+H<q[C]+q[C+1])q[C]=l,q[C+1]=H,A[C]=g,A[C+1]=I,E=!0;else{--F[C+1];break}for(C=c-1;0<C;C--)for(;F[C]!==F[C-1]+1;)if(--F[C],l=x(C-1,F,B,D),g=l.sbMean,l=l.sbSdcm,
H=x(C,F,B,D),I=H.sbMean,H=H.sbSdcm,l+H<q[C-1]+q[C])q[C-1]=l,q[C]=H,A[C-1]=g,A[C]=I,E=!0;else{F[C]+=1;break}}E&&(q=b(F,B,D,p));return F}function b(B,D,p,A){let F=[];var q=[],c=[];let l=0;const H=[],g=[];for(var I=0;I<A;I++){var E=x(I,B,D,p);H.push(E.sbMean);g.push(E.sbSdcm);l+=g[I]}E=l;for(I=!0;I||l<E;){I=!1;F=[];for(q=0;q<A;q++)F.push(B[q]);for(c=0;c<A;c++)for(E=B[c]+1;E<=B[c+1];E++)if(q=D[E],0<c&&E!==B[c+1]&&Math.abs(q-H[c])>Math.abs(q-H[c-1]))B[c]=E;else if(c<A-1&&B[c]!==E-1&&Math.abs(q-H[c])>Math.abs(q-
H[c+1])){B[c+1]=E-1;break}E=l;l=0;q=[];c=[];for(let C=0;C<A;C++){q.push(H[C]);c.push(g[C]);const N=x(C,B,D,p);H[C]=N.sbMean;g[C]=N.sbSdcm;l+=g[C]}}if(l>E){for(D=0;D<A;D++)B[D]=F[D],H[D]=q[D],g[D]=c[D];l=E}return{mean:H,sdcm:g}}function m(B,D,p,A,F){B=Math.max(A-B,D-A)/F/p;return 1<=B?1:.5<=B?.5:.25}function f(B){let D=0;for(let p=0;p<B.length;p++)D+=B[p];return D/=B.length}function v(B,D){let p=0;for(let A=0;A<B.length;A++){const F=B[A];p+=(F-D)*(F-D)}p/=B.length;return Math.sqrt(p)}function x(B,
D,p,A){var F=0,q=0;for(var c=D[B]+1;c<=D[B+1];c++){const l=A[c];F+=p[c]*l;q+=l}0>=q&&d.getLogger("esri.rest.support.generateRendererUtils").warn("Exception in Natural Breaks calculation");F/=q;q=0;for(c=D[B]+1;c<=D[B+1];c++)q+=A[c]*(p[c]-F)**2;return{sbMean:F,sbSdcm:q}}a.createGenerateRendererClassBreaks=function(B){const {normalizationTotal:D}=B;return{classBreaks:n(B),normalizationTotal:D}};a.createGenerateRendererUniqueValues=function(B){B=r(B);const D=[],p=B.uniqueValues.length;for(let A=0;A<
p;A++){const F=B.uniqueValues[A];D.push({value:F,count:B.valueFrequency[A],label:F.toString()})}return{uniqueValues:D}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/SnappingCandidate":function(){define(["exports"],function(a){a.makeEdgeCandidate=function(d,n,z,r,G,b=!1){return{objectId:d,target:n,distance:z,type:"edge",start:r,end:G,draped:b}};a.makeVertexCandidate=function(d,n,z){return{objectId:d,target:n,distance:z,type:"vertex"}};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryUtils":function(){define("require exports ../../../core/jsonMap ../../../core/unitUtils ../../../geometry/projection ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ./projectionSupport".split(" "),function(a,d,n,z,r,G,b,m,f,v){async function x(q,c,l){if(!q)return null;var {where:H}=q;q.where=H=H?.trim();if(!H||/^1 *= *1$/.test(H)||
c&&c===H)q.where=null;if(!q.geometry)return q;c=await D(q);q.distance=0;q.units=null;"esriSpatialRelEnvelopeIntersects"===q.spatialRel&&({spatialReference:H}=q.geometry,c=G.getGeometryExtent(c),c.spatialReference=H);if(c){await v.checkProjectionSupport(c.spatialReference,l);H=c.spatialReference;c=B(c,l)&&b.isExtent(c)?{spatialReference:H,rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]}:c;H=(await m.normalizeCentralMeridian(b.fromJSON(c)))[0];if(null==H)throw F;
const g="quantizationParameters"in q&&q.quantizationParameters?.tolerance||"maxAllowableOffset"in q&&q.maxAllowableOffset||0;c=g&&B(c,l)?{densificationStep:8*g}:void 0;H=H.toJSON();c=v.project(H,H.spatialReference,l,c);if(!c)throw F;c.spatialReference=l;q.geometry=c}return q}function B(q,c){if(!q)return!1;const l=q.spatialReference;return(b.isExtent(q)||b.isPolygon(q)||b.isPolyline(q))&&!f.equals(l,c)&&!r.canProjectWithoutEngine(l,c)}async function D(q){const {distance:c,units:l}=q,H=q.geometry;if(null==
c||"vertexAttributes"in H)return H;var g=H.spatialReference;q=l?A.fromJSON(l):z.getUnitString(g);g=g&&(f.isGeographic(g)||f.isWebMercator(g))?H:await v.checkProjectionSupport(g,f.wgs84).then(()=>v.project(H,f.wgs84));return(await p())(g.spatialReference,g,c,q)}async function p(){return(await new Promise((q,c)=>a(["../../../geometry/geometryEngineJSON"],q,c))).geodesicBuffer}const A=new n.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",
esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),F=Object.freeze({});d.normalizeQuery=async function(q,c,l){const {outFields:H,orderByFields:g,groupByFieldsForStatistics:I,outStatistics:E}=q;if(H)for(var C=0;C<H.length;C++)H[C]=H[C].trim();if(g)for(C=0;C<g.length;C++)g[C]=g[C].trim();if(I)for(C=0;C<I.length;C++)I[C]=I[C].trim();if(E)for(C=0;C<E.length;C++)E[C].onStatisticField&&(E[C].onStatisticField=E[C].onStatisticField.trim());q.geometry&&!q.outSR&&(q.outSR=
q.geometry.spatialReference);return x(q,c,l)};d.normalizeQueryLike=x;d.queryEngineEmptyResult=F;d.unitsKebabDict=A;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/queryValidationUtils":function(){define("exports ../../../core/Error ./attributeSupport ./projectionSupport ./spatialQuerySupport ../../../support/arcadeOnDemand".split(" "),function(a,d,n,z,r,G){function b(B,D,p){const {outFields:A,orderByFields:F,returnDistinctValues:q,outStatistics:c}=p,l=c?
c.map(H=>H.outStatisticFieldName&&H.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(F&&0<F.length){const H=F.map(g=>{const I=g.toLowerCase();return I.includes(" asc")?I.split(" asc")[0]:I.includes(" desc")?I.split(" desc")[0]:g}).filter(g=>!l.includes(g));n.validateFields(B,D,H,{expressionName:"orderByFields",query:p})}if(A&&0<A.length)n.validateFields(B,D,A,{expressionName:"outFields",query:p,allowedFieldTypes:"all"});else if(q)throw new d("unsupported-query","outFields should be specified for returnDistinctValues",
{query:p});n.validateWhere(B,D,p.where,p)}function m(B,D,p){const {outStatistics:A,groupByFieldsForStatistics:F,having:q}=p;var c=F?.length,l=A?.length;if(q){if(!c||!l)throw new d("unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:p});n.validateHaving(B,D,q,A,p)}if(l&&v(A)){l=A.map(H=>H.onStatisticField).filter(Boolean);n.validateFields(B,D,l,{expressionName:"onStatisticFields",query:p});c&&n.validateFields(B,D,F,{expressionName:"groupByFieldsForStatistics",
query:p});for(const H of A){const {onStatisticField:g,statisticType:I}=H;if(("percentile_disc"===I||"percentile_cont"===I)&&"statisticParameters"in H){if({statisticParameters:c}=H,!c)throw new d("unsupported-query","statisticParameters should be set for percentile type",{definition:H,query:p});}else B.get(g)&&"count"!==I&&"min"!==I&&"max"!==I&&n.validateFields(B,D,[g],{expressionName:`outStatistics with '${I}' statistic type`,allowedFieldTypes:x,query:p})}}}async function f(B,D,p,A){var F=[];p.valueExpression&&
({arcadeUtils:F}=await G.loadArcade(),F=F.extractFieldNames(p.valueExpression));p.field&&F.push(p.field);p.field2&&F.push(p.field2);p.field3&&F.push(p.field3);p.normalizationField&&F.push(p.normalizationField);if(!F.length&&!p.valueExpression)throw new d("unsupported-query","field or valueExpression is required",{params:p});n.validateFields(B,D,F,{expressionName:"statistics",query:A})}function v(B){return null!=B&&B.every(D=>"exceedslimit"!==D.statisticType)}const x=new Set([...n.numericFieldTypes,
...n.allDateAndTimeFieldTypes]);a.validateQuery=async function(B,{fieldsIndex:D,geometryType:p,spatialReference:A,availableFields:F}){if(0>(B.distance??0)||null!=B.geometryPrecision||B.multipatchOption&&"xyFootprint"!==B.multipatchOption||B.pixelSize||B.relationParam||B.text)throw new d("unsupported-query","Unsupported query options",{query:B});b(D,F,B);m(D,F,B);return Promise.all([r.checkSpatialQuerySupport(B,p,A),z.checkProjectionSupport(A,B.outSR)]).then(()=>B)};a.validateStatisticsQuery=async function(B,
D,{fieldsIndex:p,geometryType:A,spatialReference:F,availableFields:q}){if(0>(B.distance??0)||null!=B.geometryPrecision||B.multipatchOption||B.pixelSize||B.relationParam||B.text||B.outStatistics||B.groupByFieldsForStatistics||B.having||B.orderByFields)throw new d("unsupported-query","Unsupported query options",{query:B});b(p,q,B);return Promise.all([f(p,q,D,B),r.checkSpatialQuerySupport(B,A,F),z.checkProjectionSupport(F,B.outSR)]).then(()=>B)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./geometryUtils ./projectionSupport".split(" "),function(a,d,n,z,r,G,b,m,f,v,x,B){function D(){return new Promise((c,l)=>a(["../../../geometry/geometryEngineJSON"],c,l))}const p={esriSpatialRelIntersects:"intersects",
esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null};var A={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,
esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},F={esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},q={esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};d.canQueryWithRBush=function(c){if(G.isExtent(c))return!0;if(G.isPolygon(c)){for(const l of c.rings)if(5!==l.length||l[0][0]!==l[1][0]||l[0][0]!==
l[4][0]||l[2][0]!==l[3][0]||l[0][1]!==l[3][1]||l[0][1]!==l[4][1]||l[1][1]!==l[2][1])return!1;return!0}return!1};d.checkSpatialQuerySupport=async function(c,l,H){const {spatialRel:g,geometry:I}=c;if(I){if(null==g||!0!==A[g])throw new n("unsupported-query","Unsupported query spatial relationship",{query:c});if(b.isValid(I.spatialReference)&&b.isValid(H)){if(null==I||!0!==F[G.getJsonType(I)])throw new n("unsupported-query","Unsupported query geometry type",{query:c});if(null==l||!0!==q[l])throw new n("unsupported-query",
"Unsupported layer geometry type",{query:c});if(c.outSR)return B.checkProjectionSupport(c.geometry?.spatialReference,c.outSR)}}};d.getSpatialQueryOperator=function(c,l,H,g,I){if(G.isPolygon(l)&&"esriGeometryPoint"===H&&("esriSpatialRelIntersects"===c||"esriSpatialRelContains"===c)){const E=f.convertFromPolygon(new v,l,!1,!1);return Promise.resolve(C=>m.polygonContainsPoint(E,!1,!1,C))}if(G.isPolygon(l)&&"esriGeometryMultipoint"===H){const E=f.convertFromPolygon(new v,l,!1,!1);if("esriSpatialRelContains"===
c)return Promise.resolve(C=>m.polygonContainsMultipoint(E,!1,!1,C,g,I))}if(G.isExtent(l)&&"esriGeometryPoint"===H&&("esriSpatialRelIntersects"===c||"esriSpatialRelContains"===c))return Promise.resolve(E=>z.extentContainsPoint(l,x.getGeometry(H,g,I,E)));if(G.isExtent(l)&&"esriGeometryMultipoint"===H&&"esriSpatialRelContains"===c)return Promise.resolve(E=>z.extentContainsMultipoint(l,x.getGeometry(H,g,I,E)));if(G.isExtent(l)&&"esriSpatialRelIntersects"===c){const E=r.getExtentIntersector(H);return Promise.resolve(C=>
E(l,x.getGeometry(H,g,I,C)))}return D().then(E=>{const C=E[p[c]].bind(null,l.spatialReference,l);return N=>C(x.getGeometry(H,g,I,N))})};Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/intersects":function(){define(["exports","./intersectsBase"],function(a,d){a.extentIntersectsExtent=d.extentIntersectsExtent;a.extentIntersectsMultipoint=d.extentIntersectsMultipoint;a.extentIntersectsPoint=d.extentIntersectsPoint;a.extentIntersectsPolygon=d.extentIntersectsPolygon;
a.extentIntersectsPolyline=d.extentIntersectsPolyline;a.getFeatureExtentIntersector=d.getFeatureExtentIntersector;a.isSelfIntersecting=d.isSelfIntersecting;a.segmentIntersects=d.segmentIntersects;a.getExtentIntersector=function(n){return"mesh"===n?d.extentIntersectsExtent:d.getFeatureExtentIntersector(n)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/contains":function(){define(["exports"],function(a){function d(n,z,r,G,b){if(!n)return!1;z=z?r?4:3:r?3:2;const {coords:m,
lengths:f}=n;r=!1;n=0;for(const x of f){var v=n;for(let B=n,D=n+x*z;B<D;B+=z){v=B+z;v===D&&(v=n);const p=m[B],A=m[B+1],F=m[v];v=m[v+1];(A<b&&v>=b||v<b&&A>=b)&&p+(b-A)/(v-A)*(F-p)<G&&(r=!r)}n+=x*z}return r}a.polygonContainsCoords=d;a.polygonContainsMultipoint=function(n,z,r,G,b,m){b=b?m?4:3:m?3:2;const {coords:f,lengths:v}=G;if(!v)return!1;for(let x=0,B=0;x<v.length;x++,B+=b)if(!d(n,z,r,f[B],f[B+1]))return!1;return!0};a.polygonContainsPoint=function(n,z,r,G){return d(n,z,r,G.coords[0],G.coords[1])};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/graphics/data/timeSupport":function(){define(["exports"],function(a){function d(r,G,b,m,f){if(null!=m&&null!=f)return v=>{const x=r(v,G);v=r(v,b);return(null==x||x<=f)&&(null==v||v>=m)};if(null!=m)return v=>{v=r(v,b);return null==v||v>=m};if(null!=f)return v=>{v=r(v,G);return null==v||v<=f}}function n(r,G,b,m){if(null!=b&&null!=m&&b===m)return f=>r(f,G)===b;if(null!=b&&null!=m)return f=>{f=r(f,G);return null!=f&&f>=b&&f<=
m};if(null!=b)return f=>{f=r(f,G);return null!=f&&f>=b};if(null!=m)return f=>{f=r(f,G);return null!=f&&f<=m}}function z(){return()=>!1}a.getTimeExtent=async function(r,G){if(!r)return null;const b=G.featureAdapter,{startTimeField:m,endTimeField:f}=r;let v=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;if(m&&f)await G.forEach(B=>{const D=b.getAttribute(B,m);B=b.getAttribute(B,f);null==D||isNaN(D)||(v=Math.min(v,D));null==B||isNaN(B)||(x=Math.max(x,B))});else{const B=m||f;await G.forEach(D=>{D=
b.getAttribute(D,B);null==D||isNaN(D)||(v=Math.min(v,D),x=Math.max(x,D))})}return{start:v,end:x}};a.getTimeOperator=function(r,G,b){if(!G||!r)return null;const {startTimeField:m,endTimeField:f}=r;if(!m&&!f)return null;const {start:v,end:x}=G;if(null===v&&null===x)return null;if(void 0===v&&void 0===x)return z();r=b.getAttributeAsTimestamp?.bind(b)??b.getAttribute.bind(b);return m&&f?d(r,m,f,v,x):n(r,m||f,v,x)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/FieldsIndex":function(){define("../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/MapUtils ../../core/sql/UnknownTimeZone ./fieldUtils ../../time/timeZoneUtils ../../chunks/datetime".split(" "),
function(a,d,n,z,r,G,b,m){function f(p){return p.trim().toLowerCase()}function v(p){const A=new Map;if(!p.fields)return A;const F=!0===p.datesInUnknownTimezone,{timeInfo:q,editFieldsInfo:c}=p;var l=(q?"startField"in q?q.startField:q.startTimeField:"")??"";const H=(q?"endField"in q?q.endField:q.endTimeField:"")??"",g="dateFieldsTimeZone"in p?p.dateFieldsTimeZone??null:p.dateFieldsTimeReference?b.fromTimeReference(p.dateFieldsTimeReference):null,I=c?"timeZone"in c?c.timeZone??g:c.dateFieldsTimeReference?
b.fromTimeReference(c.dateFieldsTimeReference):g??b.utc:null,E=q?"timeZone"in q?q.timeZone??g:q.timeReference?b.fromTimeReference(q.timeReference):g:null;l=new Map([[f(c?.creationDateField??""),I],[f(c?.editDateField??""),I],[f(l),E],[f(H),E]]);for(const {name:C,type:N}of p.fields)D.has(N)?A.set(C,b.unknown):"date"!==N&&"esriFieldTypeDate"!==N?A.set(C,null):F?A.set(C,b.unknown):(p=l.get(f(C??""))??g,A.set(C,p));return A}const x=new Map;class B{static fromJSON(p){return new B(p.fields,p.timeZoneByFieldName)}static fromLayer(p){return new B(p.fields??
[],v(p))}static fromLayerJSON(p){return new B(p.fields??[],v(p))}constructor(p=[],A){this._fieldsMap=new Map;this._normalizedFieldsMap=new Map;this._dateFieldsSet=new Set;this._numericFieldsSet=new Set;this._requiredFields=null;this.dateFields=[];this.numericFields=[];this.fields=p||[];this._timeZoneByFieldName=A?new Map(A):null;p=[];for(const F of this.fields){A=F?.name;const q=G.normalizeFieldName(A)?.toLowerCase()??"";if(A&&q){const c=f(A);this._fieldsMap.set(A,F);this._fieldsMap.set(c,F);this._normalizedFieldsMap.set(q,
F);p.push(`${c}:${F.type}:${this._timeZoneByFieldName?.get(A)}`);G.isDateField(F)?(this.dateFields.push(F),this._dateFieldsSet.add(F)):G.isNumericField(F)&&(this._numericFieldsSet.add(F),this.numericFields.push(F));G.isObjectIDField(F)||G.isGlobalIDField(F)||(F.editable=null==F.editable||!!F.editable,F.nullable=null==F.nullable||!!F.nullable)}}p.sort();this.uid=p.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const p of this.fields)G.isObjectIDField(p)||G.isGlobalIDField(p)||
p.nullable||void 0!==G.getFieldDefaultValue(p)||this._requiredFields.push(p)}return this._requiredFields}equals(p){return this.uid===p?.uid}has(p){return null!=this.get(p)}get(p){if(p){var A=this._fieldsMap.get(p);if(A)return A;(A=this._fieldsMap.get(f(p))??this._normalizedFieldsMap.get(G.normalizeFieldName(p)?.toLowerCase()??""))&&this._fieldsMap.set(p,A);return A}}getTimeZone(p){p=this.get(p&&"string"!==typeof p?p.name:p);return p?this._timeZoneByFieldName?this._timeZoneByFieldName.get(p.name):
"date"===p.type||"esriFieldTypeDate"===p.type?(n.getLogger("esri.layers.support.FieldsIndex").error(new a("getTimeZone:no-timezone-information",`no time zone information for field '${p.name}'`)),b.utc):D.has(p.type)?b.unknown:null:null}getLuxonTimeZone(p){const A=this.getTimeZone(p);return A?A===b.unknown?r.UnknownTimeZone.instance:A===b.utc?m.FixedOffsetZone.utcInstance:z.getOrCreateMapValue(x,A,()=>m.IANAZone.create(A)):null}isDateField(p){return this._dateFieldsSet.has(this.get(p))}isTimeOnlyField(p){return G.isTimeOnlyField(this.get(p))}isNumericField(p){return this._numericFieldsSet.has(this.get(p))}normalizeFieldName(p){return this.get(p)?.name??
void 0}toJSON(){return{fields:this.fields.map(p=>d.isSerializable(p)?p.toJSON():p),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}const D=new Set("time-only date-only timestamp-offset esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "));return B})},"esri/views/support/Scheduler":function(){define("exports ../../core/Handles ../../core/has ../../core/Logger ../../core/maybe ../../core/PerformanceSampler ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/signal ../../core/time ../../layers/support/PromiseQueue ./debugFlags ./RenderState ./Yield".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A){function F(T){return q.has(T)?q.get(T):"number"===typeof T?T:1}a.TaskPriority=void 0;(function(T){T.RESOURCE_CONTROLLER_IMMEDIATE="immediate";T.RESOURCE_CONTROLLER="schedule";T.SLIDE="slide";T.STREAM_DATA_LOADER="stream loader";T.ELEVATION_QUERY="elevation query";T.TERRAIN_SURFACE="terrain";T.SURFACE_GEOMETRY_UPDATES="surface geometry updates";T.LOD_RENDERER="LoD renderer";T.GRAPHICS_CORE="Graphics3D";T.I3S_CONTROLLER="I3S";T.POINT_CLOUD_LAYER="point cloud";
T.FEATURE_TILE_FETCHER="feature fetcher";T.OVERLAY="overlay";T.STAGE="stage";T.GRAPHICS_DECONFLICTOR="graphics deconflictor";T.FILTER_VISIBILITY="Graphics3D filter visibility";T.SCALE_VISIBILITY="Graphics3D scale visibility";T.FRUSTUM_VISIBILITY="Graphics3D frustum visibility";T.POINT_OF_INTEREST_FREQUENT="POI frequent";T.POINT_OF_INTEREST_INFREQUENT="POI infrequent";T.LABELER="labeler";T.FEATURE_QUERY_ENGINE="feature query";T.FEATURE_TILE_TREE="feature tile tree";T.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree";
T.ELEVATION_ALIGNMENT="elevation alignment";T.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene";T.TEXT_TEXTURE_ATLAS="text texture atlas";T.TEXTURE_UNLOAD="texture unload";T.LINE_OF_SIGHT_TOOL="line of sight tool";T.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool";T.ELEVATION_PROFILE="elevation profile";T.SNAPPING="snapping";T.SHADOW_ACCUMULATOR="shadow accumulator";T.CLOUDS_GENERATOR="clouds generator";T.MAPVIEW_FETCH_QUEUE="mapview fetch queue";T.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update";
T.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue";T[T.NONE=0]="NONE";T[T.TEST_PRIO=1]="TEST_PRIO"})(a.TaskPriority||(a.TaskPriority={}));const q=new Map([[a.TaskPriority.RESOURCE_CONTROLLER_IMMEDIATE,0],[a.TaskPriority.RESOURCE_CONTROLLER,4],[a.TaskPriority.SLIDE,0],[a.TaskPriority.STREAM_DATA_LOADER,0],[a.TaskPriority.ELEVATION_QUERY,0],[a.TaskPriority.TERRAIN_SURFACE,1],[a.TaskPriority.SURFACE_GEOMETRY_UPDATES,1],[a.TaskPriority.LOD_RENDERER,2],[a.TaskPriority.GRAPHICS_CORE,
2],[a.TaskPriority.I3S_CONTROLLER,2],[a.TaskPriority.POINT_CLOUD_LAYER,2],[a.TaskPriority.FEATURE_TILE_FETCHER,2],[a.TaskPriority.CLOUDS_GENERATOR,2],[a.TaskPriority.OVERLAY,4],[a.TaskPriority.STAGE,4],[a.TaskPriority.GRAPHICS_DECONFLICTOR,4],[a.TaskPriority.FILTER_VISIBILITY,4],[a.TaskPriority.SCALE_VISIBILITY,4],[a.TaskPriority.FRUSTUM_VISIBILITY,4],[a.TaskPriority.POINT_OF_INTEREST_FREQUENT,6],[a.TaskPriority.POINT_OF_INTEREST_INFREQUENT,30],[a.TaskPriority.LABELER,8],[a.TaskPriority.FEATURE_QUERY_ENGINE,
8],[a.TaskPriority.FEATURE_TILE_TREE,16],[a.TaskPriority.FEATURE_TILE_TREE_ACTIVE,0],[a.TaskPriority.ELEVATION_ALIGNMENT,12],[a.TaskPriority.ELEVATION_ALIGNMENT_SCENE,14],[a.TaskPriority.TEXT_TEXTURE_ATLAS,12],[a.TaskPriority.TEXTURE_UNLOAD,12],[a.TaskPriority.LINE_OF_SIGHT_TOOL,16],[a.TaskPriority.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[a.TaskPriority.SNAPPING,0],[a.TaskPriority.SHADOW_ACCUMULATOR,30],[a.TaskPriority.MAPVIEW_FETCH_QUEUE,0],[a.TaskPriority.MAPVIEW_LAYERVIEW_UPDATE,2],[a.TaskPriority.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,
0]]),c=x.Milliseconds(6.5),l=x.Milliseconds(1),H=x.Milliseconds(30),g=x.Milliseconds(1E3/30),I=x.Milliseconds(100);var E;(function(T){class y{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(h=>h.needsUpdate)}constructor(){this._updating=v.signal(!0);this._microTaskQueued=!1;this._frameNumber=0;this.performanceInfo={total:new G("total"),tasks:new Map};this._frameTaskTimes=new Map;this._budget=new k;this._state=p.RenderState.INTERACTING;this._tasks=
new b;this._runQueue=new b;this._load=0;this._idleStateCallbacks=new b;this._debug=this._forceTask=this._idleUpdatesStartFired=!1;this._debugHandle=f.watch(()=>D.SCHEDULER_LOG_SLOW_TASKS,h=>this._debug=h,f.initial);for(const h of Object.keys(a.TaskPriority))this.performanceInfo.tasks.set(a.TaskPriority[h],new G(a.TaskPriority[h]))}destroy(){this._tasks.toArray().forEach(h=>h.remove());this._tasks.clear();r.removeMaybe(this._debugHandle);this._microTaskQueued=!1;this._updatingChanged()}taskRunningChanged(h){this._updatingChanged();
h&&0<this._budget.remaining&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,0<this._budget.remaining&&this._schedule()&&this.frame())}))}registerTask(h,t){t=new R(this,h,t);this._tasks.push(t);this._updatingChanged();this.performanceInfo.tasks.has(h)||this.performanceInfo.tasks.set(h,new G(h));return t}registerIdleStateCallbacks(h,t){const J={idleBegin:h,idleEnd:t};this._idleStateCallbacks.push(J);this.state===p.RenderState.IDLE&&
this._idleUpdatesStartFired&&J.idleBegin();const U=this;return{remove:()=>this._removeIdleStateCallbacks(J),set idleBegin(Y){U._idleUpdatesStartFired&&(J.idleEnd(),U._state===p.RenderState.IDLE&&Y());J.idleBegin=Y},set idleEnd(Y){J.idleEnd=Y}}}get load(){return this._load}set state(h){this._state!==h&&(this._state=h,this.state!==p.RenderState.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(t=>t.idleEnd())))}get state(){return this._state}updateBudget(h){this._test&&
(this._test.usedBudget=0);++this._frameNumber;let t=c,J=h.frameDuration,U=l;switch(this.state){case p.RenderState.IDLE:t=x.Milliseconds(0);J=x.Milliseconds(Math.max(I,h.frameDuration));U=H;break;case p.RenderState.INTERACTING:J=x.Milliseconds(Math.max(g,h.frameDuration))}J=x.Milliseconds(J-h.elapsedFrameTime-t);if(this.state!==p.RenderState.IDLE&&J<l&&!this._forceTask)return this._forceTask=!0,!1;J=x.Milliseconds(Math.max(J,U));this._budget.reset(J,this.state);this._updateLoad();return this._schedule()}frame(){this._microTaskQueued=
this._forceTask=!1;switch(this.state){case p.RenderState.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(h=>h.idleBegin()));this._runIdle();break;case p.RenderState.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(x.Milliseconds(0),this._state);this._budget.madeProgress()}_removeIdleStateCallbacks(h){this._idleUpdatesStartFired&&h.idleEnd();
this._idleStateCallbacks.removeUnordered(h)}removeTask(h){this._tasks.removeUnordered(h);this._runQueue.removeUnordered(h);this._updatingChanged()}_updateTask(h){this._tasks.forAll(t=>{t.name===h&&t.setPriority(h)})}_getState(h){if(this._runQueue.some(J=>J.name===h))return a.TaskState.SCHEDULED;let t=a.TaskState.IDLE;this._tasks.forAll(J=>{J.name===h&&J.needsUpdate&&(1>=J.schedulePriority?t=a.TaskState.READY:t!==a.TaskState.READY&&(t=a.TaskState.WAITING))});return t}_getRuntime(h){let t=0;this._tasks.forAll(J=>
{J.name===h&&(t+=J.runtime)});return t}_resetRuntimes(){this._tasks.forAll(h=>h.runtime=0)}_getRunning(){const h=new Map;this._tasks.forAll(J=>{J.needsUpdate&&h.set(J.name,(h.get(J.name)||0)+1)});if(0===h.size)return null;let t="";h.forEach((J,U)=>{t=1<J?t+` ${J}x ${U}`:t+` ${U}`});return t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const h=this._tasks.reduce((t,J)=>J.needsUpdate?++t:t,0);this._load=.9*this._load+h*(1-.9)}_schedule(){this._runQueue.filterInPlace(h=>
{if(h.needsUpdate)return!0;h.schedulePriority=h.basePriority;return!1});for(this._tasks.forAll(h=>{0===h.basePriority&&h.needsUpdate&&!this._runQueue.includes(h)&&h.blockFrame!==this._frameNumber&&this._runQueue.unshift(h)});0===this._runQueue.length;){let h=!1;this._tasks.forAll(t=>{if(t.needsUpdate&&0!==t.schedulePriority&&0!==t.basePriority&&t.blockFrame!==this._frameNumber)switch(h=!0,t.schedulePriority){case 1:t.schedulePriority=0;this._runQueue.push(t);break;default:--t.schedulePriority}});
if(!h)return this._updatingChanged(),!1}this._updatingChanged();return!0}_run(){const h=this._budget.now();this._startFrameTaskTimes();do for(;0<this._runQueue.length;){var t=this._budget.now();const J=this._runQueue.pop();this._budget.resetProgress();try{J.task.runTask(this._budget)===A.Yield&&(J.blockFrame=this._frameNumber)}catch(U){z.getLogger("esri.views.support.Scheduler").error(`Exception in task "${J.name}"`,U),J.blockFrame=this._frameNumber}!this._budget.hasProgressed&&J.blockFrame!==this._frameNumber&&
J.needsUpdate&&(J.blockFrame=this._frameNumber);J.schedulePriority=J.basePriority;t=this._budget.now()-t;J.runtime+=t;this._frameTaskTimes.set(J.priority,this._frameTaskTimes.get(J.priority)+t);if(0>=this._budget.remaining){this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-h);return}}while(this._schedule());this._updatingChanged();this._recordFrameTaskTimes(this._budget.now()-h)}_startFrameTaskTimes(){for(const h of Object.keys(a.TaskPriority))this._frameTaskTimes.set(a.TaskPriority[h],
0)}_recordFrameTaskTimes(h){this._frameTaskTimes.forEach((t,J)=>this.performanceInfo.tasks.get(J).push(t));this.performanceInfo.total.push(h)}get test(){return this._test}}T.Scheduler=y;class R{get task(){return this._task.value}get updating(){return this._queue.running}constructor(h,t,J){this._scheduler=h;this.name=t;this.runtime=this.blockFrame=0;this._queue=new B.PromiseQueue;this._handles=new d;this.schedulePriority=this._basePriority=F(t);this._task=v.signal(null!=J?J:this._queue);this._handles.add(f.when(()=>
this.task.running,U=>h.taskRunningChanged(U)))}remove(){this.processQueue(C);this._scheduler.removeTask(this);this.schedule=Q.schedule;this.reschedule=Q.reschedule;this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(h){if(this.name!==h){this.name=h;h=F(h);if(0===this._basePriority||0!==this.schedulePriority)this.schedulePriority=h;this._basePriority=h}}get priority(){return this.name}set priority(h){this.setPriority(h)}get needsUpdate(){return this.updating||this.task.running}schedule(h,
t,J){return this._queue.push(h,t,J)}reschedule(h,t,J){return this._queue.unshift(h,t,J)}processQueue(h){return this._queue.runTask(h)}}class k{constructor(){this._begin="undefined"!==typeof performance?performance.now():0;this._budget=0;this._state=p.RenderState.IDLE;this._progressed=this._done=!1;this._enabled=!0}run(h){if(this.done)return!1;!0===h()&&this.madeProgress();return!0}get done(){return this._done}get budget(){return this._budget}madeProgress(){this._progressed=!0;return this._done=this.elapsed>=
this._budget&&this._enabled}get state(){return this._state}get enabled(){return this._enabled}set enabled(h){this._enabled=h}reset(h,t){this._begin=this.now();this._budget=h;this._state=t;this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._done=this._progressed=!1}get hasProgressed(){return this._progressed}}T.Budget=k})(E||={});a.TaskState=void 0;(function(T){T.SCHEDULED=
"s";T.READY="r";T.WAITING="w";T.IDLE="i"})(a.TaskState||(a.TaskState={}));const C=(()=>{const T=new E.Budget;T.enabled=!1;return T})();class N{remove(){}processQueue(){}schedule(T,y,R){try{if(m.isAborted(y)){const k=m.createAbortError();return R?Promise.resolve(R(k)):Promise.reject(k)}return m.when(T(C))}catch(k){return Promise.reject(k)}}reschedule(T,y,R){return this.schedule(T,y,R)}}const Q=new N;a.ImmediateTask=Q;a.getTaskPriority=F;a.newScheduler=function(){return new E.Scheduler};a.noBudget=
C;a.taskPriorities=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/signal":function(){define(["exports","./lang","./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(a,d,n,z){class r{constructor(G,b){this._observable=new z.SimpleObservable;this._value=G;this._equalityFunction=b}get value(){n.trackAccess(this._observable);return this._value}set value(G){this._equalityFunction(G,this._value)||(this._value=G,this._observable.notify())}mutate(G){G(this._value);
this._observable.notify()}}a.signal=function(G,b=d.equalsShallow){return new r(G,b)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/PromiseQueue":function(){define(["exports","../../core/promiseUtils","../../core/signal","../../views/support/Yield"],function(a,d,n,z){class r{constructor(){this._tasks=[];this._runningTasks=n.signal(0)}get length(){return this._tasks.length}get running(){return 0<this._runningTasks.value}destroy(){this.cancelAll()}runTask(b){if(0===
this.length)return z.Yield;for(;!b.done&&this._process(b);)b.madeProgress()}push(b,m,f){++this._runningTasks.value;return(new Promise((v,x)=>this._tasks.push(new G(v,x,b,m,f)))).finally(()=>--this._runningTasks.value)}unshift(b,m,f){++this._runningTasks.value;return(new Promise((v,x)=>this._tasks.unshift(new G(v,x,b,m,f)))).finally(()=>--this._runningTasks.value)}_process(b){if(0===this._tasks.length)return!1;const m=this._tasks.shift();try{const f=d.isAborted(m.signal);if(f&&!m.abortCallback)m.reject(d.createAbortError());
else{const v=f?m.abortCallback?.(d.createAbortError()):m.callback(b);d.isPromiseLike(v)?v.then(m.resolve,m.reject):m.resolve(v)}}catch(f){m.reject(f)}return!0}cancelAll(){const b=d.createAbortError();for(const m of this._tasks)if(m.abortCallback){const f=m.abortCallback(b);m.resolve(f)}else m.reject(b);this._tasks.length=0}}class G{constructor(b,m,f,v,x){this.resolve=b;this.reject=m;this.callback=f;this.signal=v;this.abortCallback=x}}a.PromiseQueue=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/support/Yield":function(){define(["exports"],function(a){const d=Symbol("Yield");a.Yield=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/debugFlags":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b){d=class extends d{constructor(){super(...arguments);this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=
this.SCHEDULER_LOG_SLOW_TASKS=!1}};a.__decorate([n.property()],d.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0);a.__decorate([n.property()],d.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);d=a.__decorate([b.subclass("esri.views.support.debugFlags")],d);return new d})},"esri/views/support/RenderState":function(){define(["exports"],function(a){a.RenderState=void 0;var d=a.RenderState||(a.RenderState={});d[d.ANIMATING=0]="ANIMATING";d[d.INTERACTING=1]="INTERACTING";d[d.IDLE=2]=
"IDLE";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c){var l;d=new d.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});n=l=class extends n.JSONSupport{static create(H={}){const {resolutionFactor:g=1,scales:I,size:E=256,spatialReference:C=D.WebMercator,numLODs:N=24}=H;if(!A.isValid(C)){H=[];if(I)for(var Q=0;Q<I.length;Q++){var T=
I[Q];H.push(new q({level:Q,scale:T,resolution:T}))}else for(Q=5E-4,T=N-1;0<=T;T--)H.unshift(new q({level:T,scale:Q,resolution:Q})),Q*=2;return new l({dpi:96,lods:H,origin:new B(0,0,C),size:[E,E],spatialReference:C})}Q=A.getInfo(C);H=H.origin?new B({x:H.origin.x,y:H.origin.y,spatialReference:C}):Q?new B({x:Q.origin[0],y:Q.origin[1],spatialReference:C}):new B({x:0,y:0,spatialReference:C});Q=1/(39.37*z.getMetersPerUnitForSR(C)*96);T=[];if(I)for(var y=0;y<I.length;y++){var R=I[y];T.push(new q({level:y,
scale:R,resolution:R*Q}))}else{var k=A.isGeographic(C)?512/E*5.916575275917094E8:256/E*5.91657527591555E8;y=Math.ceil(N/g);T.push(new q({level:0,scale:k,resolution:k*Q}));for(R=1;R<y;R++)k/=2**g,T.push(new q({level:R,scale:k,resolution:k*Q}))}return new l({dpi:96,lods:T,origin:H,size:[E,E],spatialReference:C})}constructor(H){super(H);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:H,origin:g}=this;if(H&&g){const I=A.getInfo(H);return H.isWrappable&&
!!I&&Math.abs(I.origin[0]-g.x)<=I.dx}return!1}readOrigin(H,g){return B.fromJSON({spatialReference:g.spatialReference,...H})}set lods(H){const g=[],I=this._levelToLOD={};H&&H.forEach(E=>{g.push(E.scale);I[E.level]=E});this._set("scales",g);this._set("lods",H);this._initializeUpsampleLevels()}readSize(H,g){return[g.cols,g.rows]}writeSize(H,g){g.cols=H[0];g.rows=H[1]}zoomToScale(H){const g=this.scales;if(0>=H)return g[0];if(H>=g.length-1)return g[g.length-1];const I=Math.floor(H);return g[I]/(g[I]/g[I+
1])**(H-I)}scaleToZoom(H){const g=this.scales,I=g.length-1;let E=0;for(;E<I;E++){const C=g[E],N=g[E+1];if(C<=H)break;if(N===H)return E+1;if(C>H&&N<H)return E+Math.log(C/H)/Math.log(C/N)}return E}tileAt(H,g,I,E){var C=this.lodAt(H);if(!C)return null;let N;if("number"===typeof g)N=g,g=I;else{if(A.equals(g.spatialReference,this.spatialReference))N=g.x,g=g.y;else{E=F.project(g,this.spatialReference);if(null==E)return null;N=E.x;g=E.y}E=I}I=C.resolution*this.size[0];C=C.resolution*this.size[1];E||=new c.TileKey(null,
0,0,0,p.create());E.level=H;E.row=Math.floor((this.origin.y-g)/C+.001);E.col=Math.floor((N-this.origin.x)/I+.001);this.updateTileInfo(E);return E}updateTileInfo(H,g=l.ExtrapolateOptions.NONE){var I=this.lodAt(H.level);I||g!==l.ExtrapolateOptions.POWER_OF_TWO||(g=this.lods[this.lods.length-1],g.level<H.level&&(I=g));if(I){var E=H.level-I.level;g=I.resolution*this.size[0]/2**E;I=I.resolution*this.size[1]/2**E;H.id=`${H.level}/${H.row}/${H.col}`;H.extent||(H.extent=p.create());H.extent[0]=this.origin.x+
H.col*g;H.extent[1]=this.origin.y-(H.row+1)*I;H.extent[2]=H.extent[0]+g;H.extent[3]=H.extent[1]+I}}upsampleTile(H){const g=this._upsampleLevels[H.level];if(!g||-1===g.parentLevel)return!1;H.level=g.parentLevel;H.row=Math.floor(H.row/g.factor+.001);H.col=Math.floor(H.col/g.factor+.001);this.updateTileInfo(H);return!0}getTileBounds(H,g){var I=this.lodAt(g.level);if(null==I)return null;var {resolution:E}=I;I=E*this.size[0];E*=this.size[1];H[0]=this.origin.x+g.col*I;H[1]=this.origin.y-(g.row+1)*E;H[2]=
H[0]+I;H[3]=H[1]+E;return H}lodAt(H){return this._levelToLOD?.[H]??null}clone(){return l.fromJSON(this.write({}))}getCompatibleForVTL(H){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===H)return null;const g=(512===this.size[0]&&256===H?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===H&&0===g)return this;const I=[],E=this.lods.length-g;for(let C=0;C<E;C++){const N=C+g,{scale:Q,resolution:T}=0<=N?this.lods[N]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};
I.push(new q({level:C,scale:Q,resolution:T}))}return new l({size:[H,H],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:I})}_initializeUpsampleLevels(){const H=this.lods;this._upsampleLevels=[];let g=null;for(let I=0;I<H.length;I++){const E=H[I];this._upsampleLevels[E.level]={parentLevel:g?g.level:-1,factor:g?g.resolution/E.resolution:0};g=E}}};a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,
"compressionQuality",void 0);a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,"dpi",void 0);a.__decorate([r.property({type:String,json:{read:d.read,write:d.write,origins:{"web-scene":{read:!1,write:!1}}}})],n.prototype,"format",void 0);a.__decorate([r.property({readOnly:!0})],n.prototype,"isWrappable",null);a.__decorate([r.property({type:B,json:{write:!0}})],n.prototype,"origin",void 0);a.__decorate([f.reader("origin")],n.prototype,"readOrigin",null);a.__decorate([r.property({type:[q],
value:null,json:{write:!0}})],n.prototype,"lods",null);a.__decorate([r.property({readOnly:!0})],n.prototype,"scales",void 0);a.__decorate([r.property({cast:H=>Array.isArray(H)?H:"number"===typeof H?[H,H]:[256,256]})],n.prototype,"size",void 0);a.__decorate([f.reader("size",["rows","cols"])],n.prototype,"readSize",null);a.__decorate([x.writer("size",{cols:{type:G.Integer},rows:{type:G.Integer}})],n.prototype,"writeSize",null);a.__decorate([r.property({type:D,json:{write:!0}})],n.prototype,"spatialReference",
void 0);n=l=a.__decorate([v.subclass("esri.layers.support.TileInfo")],n);(function(H){H=H.ExtrapolateOptions||(H.ExtrapolateOptions={});H[H.NONE=0]="NONE";H[H.POWER_OF_TWO=1]="POWER_OF_TWO"})(n||={});return n})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,
G,b){var m;d=m=class extends d.JSONSupport{constructor(f){super(f);this.cols=null;this.level=0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new m({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};a.__decorate([n.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],d.prototype,"cols",void 0);a.__decorate([n.property({type:z.Integer,
json:{write:!0}})],d.prototype,"level",void 0);a.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);a.__decorate([n.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],d.prototype,"origin",void 0);a.__decorate([n.property({type:Number,json:{write:!0}})],d.prototype,"resolution",void 0);a.__decorate([n.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],d.prototype,
"rows",void 0);a.__decorate([n.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=m=a.__decorate([b.subclass("esri.layers.support.LOD")],d)})},"esri/layers/support/TileKey":function(){define(["exports"],function(a){class d{constructor(n,z,r,G,b){this.id=n;this.level=z;this.row=r;this.col=G;this.extent=b}}a.TileKey=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/Query":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../layers/support/source/DataLayerSource ./FullTextSearch ./QuantizationParameters ./spatialRelationships ./StatisticDefinition ../../time/TimeExtent ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H){var g;n=new n.JSONMap({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let I=g=class extends z.JSONSupport{static from(E){return x.ensureClass(g,E)}constructor(E){super(E);this.aggregateIds=null;this.cacheHint=void 0;this.compactGeometryEnabled=!1;this.datumTransformation=null;this.defaultSpatialReferenceEnabled=
!1;this.dynamicDataSource=this.distance=void 0;this.geometry=this.gdbVersion=this.fullText=this.formatOf3DObjects=null;this.geometryPrecision=void 0;this.historicMoment=this.having=this.groupByFieldsForStatistics=null;this.maxAllowableOffset=void 0;this.maxRecordCountFactor=1;this.multipatchOption=null;this.num=void 0;this.resultType=this.relationParameter=this.rangeValues=this.quantizationParameters=this.pixelSize=this.parameterValues=this.outStatistics=this.outSpatialReference=this.outFields=this.orderByFields=
this.objectIds=null;this.returnDistinctValues=this.returnCentroid=!1;this.returnExceededLimitFeatures=!0;this.returnQueryGeometry=this.returnGeometry=!1;this.returnZ=this.returnM=void 0;this.sourceSpatialReference=null;this.spatialRelationship="intersects";this.start=void 0;this.timeExtent=this.text=this.sqlFormat=null;this.timeReferenceUnknownClient=!1;this.where=this.units=null}castDatumTransformation(E){return"number"===typeof E||"object"===typeof E?E:null}writeHistoricMoment(E,C){C.historicMoment=
E&&E.getTime()}writeParameterValues(E,C){if(E){const N={};for(const Q in E){const T=E[Q];Array.isArray(T)?N[Q]=T.map(y=>y instanceof Date?y.getTime():y):N[Q]=T instanceof Date?T.getTime():T}C.parameterValues=N}}writeStart(E,C){C.resultOffset=this.start;C.resultRecordCount=this.num||10;C.where="1\x3d1"}writeWhere(E,C){C.where=E||"1\x3d1"}clone(){return new g(r.clone({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,
defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,
num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,
returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};I.MAX_MAX_RECORD_COUNT_FACTOR=5;a.__decorate([G.property({json:{write:!0}})],
I.prototype,"aggregateIds",void 0);a.__decorate([G.property({type:Boolean,json:{write:!0}})],I.prototype,"cacheHint",void 0);a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"compactGeometryEnabled",void 0);a.__decorate([G.property({json:{write:!0}})],I.prototype,"datumTransformation",void 0);a.__decorate([b.cast("datumTransformation")],I.prototype,"castDatumTransformation",null);a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"defaultSpatialReferenceEnabled",
void 0);a.__decorate([G.property({type:Number,json:{write:{overridePolicy(E){return{enabled:0<E}}}}})],I.prototype,"distance",void 0);a.__decorate([G.property({type:D.DataLayerSource,json:{write:!0}})],I.prototype,"dynamicDataSource",void 0);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"formatOf3DObjects",void 0);a.__decorate([G.property({type:[p],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&0<this.fullText.length}}}}})],I.prototype,"fullText",
void 0);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"gdbVersion",void 0);a.__decorate([G.property({types:d.geometryTypes,json:{read:B.fromJSON,write:!0}})],I.prototype,"geometry",void 0);a.__decorate([G.property({type:Number,json:{write:!0}})],I.prototype,"geometryPrecision",void 0);a.__decorate([G.property({type:[String],json:{write:!0}})],I.prototype,"groupByFieldsForStatistics",void 0);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"having",void 0);
a.__decorate([G.property({type:Date})],I.prototype,"historicMoment",void 0);a.__decorate([v.writer("historicMoment")],I.prototype,"writeHistoricMoment",null);a.__decorate([G.property({type:Number,json:{write:!0}})],I.prototype,"maxAllowableOffset",void 0);a.__decorate([G.property({type:Number,cast(E){return 1>E?1:E>I.MAX_MAX_RECORD_COUNT_FACTOR?I.MAX_MAX_RECORD_COUNT_FACTOR:E},json:{write:{overridePolicy(E){return{enabled:1<E}}}}})],I.prototype,"maxRecordCountFactor",void 0);a.__decorate([G.property({type:["xyFootprint"],
json:{write:!0}})],I.prototype,"multipatchOption",void 0);a.__decorate([G.property({type:Number,json:{read:{source:"resultRecordCount"}}})],I.prototype,"num",void 0);a.__decorate([G.property({json:{write:!0}})],I.prototype,"objectIds",void 0);a.__decorate([G.property({type:[String],json:{write:!0}})],I.prototype,"orderByFields",void 0);a.__decorate([G.property({type:[String],json:{write:!0}})],I.prototype,"outFields",void 0);a.__decorate([G.property({type:l,json:{name:"outSR",write:!0}})],I.prototype,
"outSpatialReference",void 0);a.__decorate([G.property({type:[q],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&0<this.outStatistics.length}}}}})],I.prototype,"outStatistics",void 0);a.__decorate([G.property({json:{write:!0}})],I.prototype,"parameterValues",void 0);a.__decorate([v.writer("parameterValues")],I.prototype,"writeParameterValues",null);a.__decorate([G.property({type:H,json:{write:!0}})],I.prototype,"pixelSize",void 0);a.__decorate([G.property({type:A,
json:{write:!0}})],I.prototype,"quantizationParameters",void 0);a.__decorate([G.property({type:[Object],json:{write:!0}})],I.prototype,"rangeValues",void 0);a.__decorate([G.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],I.prototype,"relationParameter",void 0);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"resultType",void 0);a.__decorate([G.property({type:Boolean,
json:{default:!1,write:!0}})],I.prototype,"returnCentroid",void 0);a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnDistinctValues",void 0);a.__decorate([G.property({type:Boolean,json:{default:!0,write:!0}})],I.prototype,"returnExceededLimitFeatures",void 0);a.__decorate([G.property({type:Boolean,json:{write:!0}})],I.prototype,"returnGeometry",void 0);a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnQueryGeometry",void 0);
a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnM",void 0);a.__decorate([G.property({type:Boolean,json:{write:{overridePolicy(E){return{enabled:E}}}}})],I.prototype,"returnZ",void 0);a.__decorate([G.property({type:l,json:{write:!0}})],I.prototype,"sourceSpatialReference",void 0);a.__decorate([m.enumeration(F.spatialRelKebabDict,{ignoreUnknown:!1,name:"spatialRel"})],I.prototype,"spatialRelationship",void 0);a.__decorate([G.property({type:Number,json:{read:{source:"resultOffset"}}})],
I.prototype,"start",void 0);a.__decorate([v.writer("start"),v.writer("num")],I.prototype,"writeStart",null);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"sqlFormat",void 0);a.__decorate([G.property({type:String,json:{write:!0}})],I.prototype,"text",void 0);a.__decorate([G.property({type:c,json:{write:!0}})],I.prototype,"timeExtent",void 0);a.__decorate([G.property({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"timeReferenceUnknownClient",void 0);a.__decorate([m.enumeration(n,
{ignoreUnknown:!1}),G.property({json:{write:{overridePolicy(E){return{enabled:!!E&&null!=this.distance&&0<this.distance}}}}})],I.prototype,"units",void 0);a.__decorate([G.property({type:String,json:{write:{overridePolicy(E){return{enabled:null!=E||null!=this.start&&0<this.start}}}}})],I.prototype,"where",void 0);a.__decorate([v.writer("where")],I.prototype,"writeWhere",null);return I=g=a.__decorate([f.subclass("esri.rest.support.Query")],I)})},"esri/layers/support/source/DataLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/ensureType ../../../core/accessorSupport/extensions/serializableProperty/reader ../Field ./MapLayerSource ./QueryTableDataSource ./RasterDataSource ./TableDataSource".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F){function q(){g||=x.createTypeReader({types:c()});return g}function c(){I||={key:"type",base:null,typeMap:{"data-layer":a.DataLayerSource,"map-layer":D.MapLayerSource}};return I}var l,H;n=n.strict()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});a.JoinTableDataSource=l=class extends z.JSONSupport{constructor(E){super(E);this.type="join-table"}readLeftTableSource(E,C,N){return q()(E,C,N)}castLeftTableSource(E){return v.ensureOneOfType(c(),
E)}readRightTableSource(E,C,N){return q()(E,C,N)}castRightTableSource(E){return v.ensureOneOfType(c(),E)}clone(){const {leftTableKey:E,rightTableKey:C,leftTableSource:N,rightTableSource:Q,joinType:T}=this,y={leftTableKey:E,rightTableKey:C,leftTableSource:N?.clone()??void 0,rightTableSource:Q?.clone()??void 0,joinType:T};return new l(y)}};d.__decorate([b.enumeration({joinTable:"join-table"})],a.JoinTableDataSource.prototype,"type",void 0);d.__decorate([r.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,
"leftTableKey",void 0);d.__decorate([r.property({type:String,json:{write:!0}})],a.JoinTableDataSource.prototype,"rightTableKey",void 0);d.__decorate([r.property({json:{write:!0}})],a.JoinTableDataSource.prototype,"leftTableSource",void 0);d.__decorate([m.reader("leftTableSource")],a.JoinTableDataSource.prototype,"readLeftTableSource",null);d.__decorate([G.cast("leftTableSource")],a.JoinTableDataSource.prototype,"castLeftTableSource",null);d.__decorate([r.property({json:{write:!0}})],a.JoinTableDataSource.prototype,
"rightTableSource",void 0);d.__decorate([m.reader("rightTableSource")],a.JoinTableDataSource.prototype,"readRightTableSource",null);d.__decorate([G.cast("rightTableSource")],a.JoinTableDataSource.prototype,"castRightTableSource",null);d.__decorate([b.enumeration(n)],a.JoinTableDataSource.prototype,"joinType",void 0);a.JoinTableDataSource=l=d.__decorate([f.subclass("esri.layers.support.source.JoinTableDataSource")],a.JoinTableDataSource);let g=null,I=null;G={key:"type",base:null,typeMap:{"join-table":a.JoinTableDataSource,
"query-table":p.QueryTableDataSource,raster:A.RasterDataSource,table:F.TableDataSource}};a.DataLayerSource=H=class extends z.JSONSupport{constructor(E){super(E);this.type="data-layer"}clone(){const {fields:E,dataSource:C}=this;return new H({fields:E,dataSource:C})}};d.__decorate([b.enumeration({dataLayer:"data-layer"})],a.DataLayerSource.prototype,"type",void 0);d.__decorate([r.property({type:[B],json:{write:!0}})],a.DataLayerSource.prototype,"fields",void 0);d.__decorate([r.property({types:G,json:{write:!0}})],
a.DataLayerSource.prototype,"dataSource",void 0);a.DataLayerSource=H=d.__decorate([f.subclass("esri.layers.support.source.DataLayerSource")],a.DataLayerSource);a.DataLayerSource.from=v.ensureType(a.DataLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Field":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./domains ./fieldType".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B){var D;const p=new d.JSONMap({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});d=D=class extends n.JSONSupport{constructor(A){super(A);
this.alias=null;this.defaultValue=void 0;this.domain=this.description=null;this.editable=!0;this.length=void 0;this.name=null;this.nullable=!0;this.valueType=this.type=null;this.visible=!0}readDescription(A,{description:F}){A=null;try{A=F?JSON.parse(F):null}catch(q){}return A?.value??null}readValueType(A,{description:F}){A=null;try{A=F?JSON.parse(F):null}catch(q){}return A?p.fromJSON(A.fieldValueType):null}clone(){return new D({alias:this.alias,defaultValue:this.defaultValue,description:this.description,
domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};a.__decorate([z.property({type:String,json:{write:!0}})],d.prototype,"alias",void 0);a.__decorate([z.property({type:[String,Number],json:{write:{allowNull:!0}}})],d.prototype,"defaultValue",void 0);a.__decorate([z.property()],d.prototype,"description",void 0);a.__decorate([f.reader("description")],d.prototype,"readDescription",
null);a.__decorate([z.property({types:x.types,json:{read:{reader:x.fromJSON},write:!0}})],d.prototype,"domain",void 0);a.__decorate([z.property({type:Boolean,json:{write:!0}})],d.prototype,"editable",void 0);a.__decorate([z.property({type:r.Integer,json:{write:{overridePolicy(A){return{enabled:Number.isFinite(A)}}}}})],d.prototype,"length",void 0);a.__decorate([z.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);a.__decorate([z.property({type:Boolean,json:{write:!0}})],d.prototype,
"nullable",void 0);a.__decorate([m.enumeration(B.kebabDict)],d.prototype,"type",void 0);a.__decorate([z.property()],d.prototype,"valueType",void 0);a.__decorate([f.reader("valueType",["description"])],d.prototype,"readValueType",null);a.__decorate([z.property({type:Boolean,json:{read:!1}})],d.prototype,"visible",void 0);return d=D=a.__decorate([v.subclass("esri.layers.support.Field")],d)})},"esri/layers/support/domains":function(){define("exports ../../core/has ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),
function(a,d,n,z,r,G){d={key:"type",base:z,typeMap:{range:G,"coded-value":n,inherited:r}};a.CodedValueDomain=n;a.DomainBase=z;a.InheritedDomain=r;a.RangeDomain=G;a.fromJSON=function(b){if(!b?.type)return null;switch(b.type){case "range":return G.fromJSON(b);case "codedValue":return n.fromJSON(b);case "inherited":return r.fromJSON(b)}return null};a.types=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/CodedValueDomain":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./CodedValue ./Domain".split(" "),
function(a,d,n,z,r,G,b,m,f){var v;z=v=class extends f{constructor(x){super(x);this.codedValues=null;this.type="coded-value"}getName(x){let B=null;if(this.codedValues){const D=String(x);this.codedValues.some(p=>{String(p.code)===D&&(B=p.name);return!!B})}return B}clone(){return new v({codedValues:d.clone(this.codedValues),name:this.name})}};a.__decorate([n.property({type:[m.CodedValue],json:{write:!0}})],z.prototype,"codedValues",void 0);a.__decorate([G.enumeration({codedValue:"coded-value"})],z.prototype,
"type",void 0);return z=v=a.__decorate([b.subclass("esri.layers.support.CodedValueDomain")],z)})},"esri/layers/support/CodedValue":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m){var f;a.CodedValue=f=class extends n.JSONSupport{constructor(v){super(v);this.code=this.name=null}clone(){return new f({name:this.name,
code:this.code})}};d.__decorate([z.property({type:String,json:{write:!0}})],a.CodedValue.prototype,"name",void 0);d.__decorate([z.property({type:[String,Number],json:{write:!0}})],a.CodedValue.prototype,"code",void 0);a.CodedValue=f=d.__decorate([m.subclass("esri.layers.support.CodedValue")],a.CodedValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Domain":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m,f){d=new d.JSONMap({inherited:"inherited",codedValue:"coded-value",range:"range"});n=class extends n.JSONSupport{constructor(v){super(v);this.type=this.name=null}};a.__decorate([z.property({type:String,json:{write:!0}})],n.prototype,"name",void 0);a.__decorate([m.enumeration(d)],n.prototype,"type",void 0);return n=a.__decorate([f.subclass("esri.layers.support.Domain")],n)})},"esri/layers/support/InheritedDomain":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,d,n,z,r,G,b,m){var f;d=f=class extends m{constructor(v){super(v);this.type="inherited"}clone(){return new f}};a.__decorate([G.enumeration({inherited:"inherited"})],d.prototype,"type",void 0);return d=f=a.__decorate([b.subclass("esri.layers.support.InheritedDomain")],d)})},"esri/layers/support/RangeDomain":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./Domain".split(" "),
function(a,d,n,z,r,G,b,m){var f;n=f=class extends m{constructor(v){super(v);this.minValue=this.maxValue=null;this.type="range"}clone(){return new f({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};a.__decorate([d.property({json:{type:[Number],read:{source:"range",reader(v,x){return x.range?.[1]}},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(v,x,B){x[B]=[this.minValue||0,v]}}}})],n.prototype,"maxValue",void 0);a.__decorate([d.property({json:{type:[Number],
read:{source:"range",reader(v,x){return x.range?.[0]}},write:{target:"range",writer(v,x,B){x[B]=[v,this.maxValue||0]}}}})],n.prototype,"minValue",void 0);a.__decorate([G.enumeration({range:"range"})],n.prototype,"type",void 0);return n=f=a.__decorate([b.subclass("esri.layers.support.RangeDomain")],n)})},"esri/layers/support/source/MapLayerSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m,f){var v;a.MapLayerSource=v=class extends n.JSONSupport{constructor(x){super(x);this.type="map-layer"}clone(){const {mapLayerId:x,gdbVersion:B}=this;return new v({mapLayerId:x,gdbVersion:B})}};d.__decorate([m.enumeration({mapLayer:"map-layer"})],a.MapLayerSource.prototype,"type",void 0);d.__decorate([z.property({type:r.Integer,json:{write:!0}})],a.MapLayerSource.prototype,"mapLayerId",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],a.MapLayerSource.prototype,
"gdbVersion",void 0);a.MapLayerSource=v=d.__decorate([f.subclass("esri.layers.support.source.MapLayerSource")],a.MapLayerSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/QueryTableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../geometry ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../geometry/SpatialReference ../../../geometry/support/typeUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B){var D;a.QueryTableDataSource=D=class extends z.JSONSupport{constructor(p){super(p);this.type="query-table"}clone(){const {workspaceId:p,query:A,oidFields:F,spatialReference:q,geometryType:c}=this,l={workspaceId:p,query:A,oidFields:F,spatialReference:q?.clone()??void 0,geometryType:c};return new D(l)}};d.__decorate([f.enumeration({queryTable:"query-table"})],a.QueryTableDataSource.prototype,"type",void 0);d.__decorate([r.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,
"workspaceId",void 0);d.__decorate([r.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"query",void 0);d.__decorate([r.property({type:String,json:{write:!0}})],a.QueryTableDataSource.prototype,"oidFields",void 0);d.__decorate([r.property({type:x,json:{write:!0}})],a.QueryTableDataSource.prototype,"spatialReference",void 0);d.__decorate([f.enumeration(B.featureGeometryTypeKebabDictionary)],a.QueryTableDataSource.prototype,"geometryType",void 0);a.QueryTableDataSource=D=d.__decorate([v.subclass("esri.layers.support.source.QueryTableDataSource")],
a.QueryTableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/RasterDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m,f){var v;a.RasterDataSource=v=class extends n.JSONSupport{constructor(x){super(x);
this.type="raster"}clone(){const {workspaceId:x,dataSourceName:B}=this;return new v({workspaceId:x,dataSourceName:B})}};d.__decorate([m.enumeration({raster:"raster"})],a.RasterDataSource.prototype,"type",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"dataSourceName",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],a.RasterDataSource.prototype,"workspaceId",void 0);a.RasterDataSource=v=d.__decorate([f.subclass("esri.layers.support.source.RasterDataSource")],
a.RasterDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/source/TableDataSource":function(){define("exports ../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m,f){var v;a.TableDataSource=v=class extends n.JSONSupport{constructor(x){super(x);
this.type="table"}clone(){const {workspaceId:x,gdbVersion:B,dataSourceName:D}=this;return new v({workspaceId:x,gdbVersion:B,dataSourceName:D})}};d.__decorate([m.enumeration({table:"table"})],a.TableDataSource.prototype,"type",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"workspaceId",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],a.TableDataSource.prototype,"gdbVersion",void 0);d.__decorate([z.property({type:String,json:{write:!0}})],
a.TableDataSource.prototype,"dataSourceName",void 0);a.TableDataSource=v=d.__decorate([f.subclass("esri.layers.support.source.TableDataSource")],a.TableDataSource);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/FullTextSearch":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,d,n,z,r,G,b,m){d=class extends d.ClonableMixin(n.JSONSupport){constructor(f){super(f);this.searchType=this.searchTerm=this.operator=this.onFields=null}};a.__decorate([z.property({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&0<this.onFields.length}}}}})],d.prototype,"onFields",void 0);a.__decorate([z.property({type:String,json:{write:!0}})],d.prototype,"operator",void 0);a.__decorate([z.property({type:String,json:{write:!0}})],d.prototype,"searchTerm",
void 0);a.__decorate([z.property({type:String,json:{write:!0}})],d.prototype,"searchType",void 0);return d=a.__decorate([m.subclass("esri.rest.support.FullTextSearch")],d)})},"esri/core/Clonable":function(){define("exports ../chunks/tslib.es6 ./Accessor ./has ./lang ./Logger ./maybe ./accessorSupport/PropertyOrigin ./accessorSupport/utils ./accessorSupport/decorators/subclass".split(" "),function(a,d,n,z,r,G,b,m,f,v){z=x=>{x=class extends x{clone(){var B=f.getProperties(this);b.assertIsSome(B,"unable to clone instance of non-accessor class");
var D=B.metadata;const p=B.store,A={};B=new Map;for(var F in D){var q=D[F];const c=p?.originOf(F),l=q.clonable;if(q.readOnly||!1===l||c!==m.OriginId.USER&&c!==m.OriginId.DEFAULTS&&c!==m.OriginId.WEB_MAP&&c!==m.OriginId.WEB_SCENE)continue;q=this[F];let H=null;H="function"===typeof l?l(q):"reference"===l?q:r.tryClone(q);if(null==q||null!=H)c===m.OriginId.DEFAULTS?B.set(F,H):A[F]=H}D=new (Object.getPrototypeOf(this).constructor)(A);if(B.size&&(F=f.getProperties(D)?.store))for(const [c,l]of B)F.set(c,
l,m.OriginId.DEFAULTS);return D}};return x=d.__decorate([v.subclass("esri.core.Clonable")],x)};a.Clonable=class extends z(n){};a.Clonable=d.__decorate([v.subclass("esri.core.Clonable")],a.Clonable);a.ClonableMixin=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/QuantizationParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent".split(" "),
function(a,d,n,z,r,G,b,m,f,v){var x;d=new n.JSONMap({upperLeft:"upper-left",lowerLeft:"lower-left"});z=x=class extends z.JSONSupport{constructor(B){super(B);this.extent=null;this.mode="view";this.originPosition="upper-left";this.tolerance=1}clone(){return new x(r.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};a.__decorate([G.property({type:v,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],z.prototype,"extent",void 0);
a.__decorate([G.property({type:["view","edit"],json:{write:!0}})],z.prototype,"mode",void 0);a.__decorate([G.property({type:String,json:{read:d.read,write:d.write}})],z.prototype,"originPosition",void 0);a.__decorate([G.property({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],z.prototype,"tolerance",void 0);return z=x=a.__decorate([f.subclass("esri.rest.support.QuantizationParameters")],z)})},"esri/rest/support/spatialRelationships":function(){define(["exports",
"../../core/jsonMap"],function(a,d){d=new d.JSONMap({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});a.spatialRelKebabDict=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/support/StatisticDefinition":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(a,d,n,z,r,G,b,m,f){var v;d=new d.JSONMap({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",
percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});n=v=class extends n.JSONSupport{constructor(x){super(x);this.maxVertexCount=this.maxRecordCount=this.maxPointCount=void 0;this.statisticParameters=this.statisticType=this.outStatisticFieldName=this.onStatisticField=null}writeStatisticParameters(x,B){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)B.statisticParameters=
z.clone(x)}clone(){return new v({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:z.clone(this.statisticParameters)})}};a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,"maxPointCount",void 0);a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,"maxRecordCount",void 0);
a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,"maxVertexCount",void 0);a.__decorate([r.property({type:String,json:{write:!0}})],n.prototype,"onStatisticField",void 0);a.__decorate([r.property({type:String,json:{write:!0}})],n.prototype,"outStatisticFieldName",void 0);a.__decorate([r.property({type:String,json:{read:{source:"statisticType",reader:d.read},write:{target:"statisticType",writer:d.write}}})],n.prototype,"statisticType",void 0);a.__decorate([r.property({type:Object})],
n.prototype,"statisticParameters",void 0);a.__decorate([f.writer("statisticParameters")],n.prototype,"writeStatisticParameters",null);return n=v=a.__decorate([m.subclass("esri.rest.support.StatisticDefinition")],n)})},"esri/time/TimeExtent":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/timeUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./timeZoneUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x){var B;d=B=class extends d.JSONSupport{static get allTime(){return D}static get empty(){return p}static fromArray(A){return new B({start:null!=A[0]?new Date(A[0]):A[0],end:null!=A[1]?new Date(A[1]):A[1]})}constructor(A){super(A);this.start=this.end=null}readEnd(A,F){return null!=F.end?new Date(F.end):null}writeEnd(A,F){F.end=A?.getTime()??null}get isAllTime(){return this.equals(B.allTime)}get isEmpty(){return this.equals(B.empty)}readStart(A,F){return null!=F.start?
new Date(F.start):null}writeStart(A,F){F.start=A?.getTime()??null}clone(){return new B({end:this.end,start:this.start})}equals(A){if(!A)return!1;const F=this.start?.getTime()??this.start,q=this.end?.getTime()??this.end,c=A.start?.getTime()??A.start;A=A.end?.getTime()??A.end;return F===c&&q===A}expandTo(A,F=x.system){if(this.isEmpty||this.isAllTime)return this.clone();let q=this.start;q&&=n.truncateDate(q,A,F);let c=this.end;if(c){const l=n.truncateDate(c,A,F);c=c.getTime()===l.getTime()?l:n.offsetDate(l,
1,A,F)}return new B({start:q,end:c})}intersection(A){if(!A)return this.clone();if(this.isEmpty||A.isEmpty)return B.empty;if(this.isAllTime)return A.clone();if(A.isAllTime)return this.clone();const F=this.start?.getTime()??-Infinity,q=this.end?.getTime()??Infinity,c=A.start?.getTime()??-Infinity;A=A.end?.getTime()??Infinity;let l,H;c>=F&&c<=q?l=c:F>=c&&F<=A&&(l=F);q>=c&&q<=A?H=q:A>=F&&A<=q&&(H=A);return null==l||null==H||isNaN(l)||isNaN(H)?B.empty:new B({start:-Infinity===l?null:new Date(l),end:Infinity===
H?null:new Date(H)})}offset(A,F,q=x.system){if(this.isEmpty||this.isAllTime)return this.clone();const c=new B,{start:l,end:H}=this;null!=l&&(c.start=n.offsetDate(l,A,F,q));null!=H&&(c.end=n.offsetDate(H,A,F,q));return c}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(A){if(!A||A.isEmpty)return this.clone();if(this.isEmpty)return A.clone();if(this.isAllTime||A.isAllTime)return D.clone();const F=null!=this.start&&null!=A.start?new Date(Math.min(this.start.getTime(),
A.start.getTime())):null;A=null!=this.end&&null!=A.end?new Date(Math.max(this.end.getTime(),A.end.getTime())):null;return new B({start:F,end:A})}};a.__decorate([z.property({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0);a.__decorate([m.reader("end")],d.prototype,"readEnd",null);a.__decorate([v.writer("end")],d.prototype,"writeEnd",null);a.__decorate([z.property({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null);a.__decorate([z.property({readOnly:!0,json:{read:!1}})],
d.prototype,"isEmpty",null);a.__decorate([z.property({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0);a.__decorate([m.reader("start")],d.prototype,"readStart",null);a.__decorate([v.writer("start")],d.prototype,"writeStart",null);a=d=B=a.__decorate([f.subclass("esri.time.TimeExtent")],d);const D=new d,p=new d({start:void 0,end:void 0});return a})},"esri/symbols/support/ElevationInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./FeatureExpressionInfo ./unitConversionUtils".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D){var p;G=d.strict()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"});d=new d.JSONMap({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});n=p=class extends n.JSONSupport{constructor(A){super(A);this.offset=null}readFeatureExpressionInfo(A,F){if(null!=A)return A;if(F.featureExpression&&0===F.featureExpression.value)return{expression:"0"}}writeFeatureExpressionInfo(A,
F,q,c){F[q]=A.write({},c);"0"===A.expression&&(F.featureExpression={value:0})}get mode(){const {offset:A,featureExpressionInfo:F}=this;return this._isOverridden("mode")?this._get("mode"):null!=A||F?"relative-to-ground":"on-the-ground"}set mode(A){this._override("mode",A)}set unit(A){this._set("unit",A)}write(A,F){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(A,F):null}clone(){return new p({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?
this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(A){return this.mode===A.mode&&this.offset===A.offset&&this.unit===A.unit&&z.equalsMaybe(this.featureExpressionInfo,A.featureExpressionInfo)}};a.__decorate([r.property({type:B,json:{write:!0}})],n.prototype,"featureExpressionInfo",void 0);a.__decorate([f.reader("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],n.prototype,"readFeatureExpressionInfo",null);a.__decorate([x.writer("featureExpressionInfo",{featureExpressionInfo:{type:B},
"featureExpression.value":{type:[0]}})],n.prototype,"writeFeatureExpressionInfo",null);a.__decorate([r.property({type:G.apiValues,nonNullable:!0,json:{type:G.jsonValues,read:G.read,write:{writer:G.write,isRequired:!0}}})],n.prototype,"mode",null);a.__decorate([r.property({type:Number,json:{write:!0}})],n.prototype,"offset",void 0);a.__decorate([r.property({type:D.supportedUnits,json:{type:String,read:d.read,write:d.write}})],n.prototype,"unit",null);return n=p=a.__decorate([v.subclass("esri.symbols.support.ElevationInfo")],
n)})},"esri/symbols/support/FeatureExpressionInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldUtils".split(" "),function(a,d,n,z,r,G,b,m){var f;d=f=class extends d.JSONSupport{constructor(v){super(v)}async collectRequiredFields(v,x){return m.collectArcadeFieldNames(v,x,this.expression)}clone(){return new f({expression:this.expression,
title:this.title})}equals(v){return this.expression===v.expression&&this.title===v.title}};a.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"expression",void 0);a.__decorate([n.property({type:String,json:{write:!0}})],d.prototype,"title",void 0);return d=f=a.__decorate([b.subclass("esri.symbols.support.FeatureExpressionInfo")],d)})},"esri/symbols/support/unitConversionUtils":function(){define(["exports","../../core/arrayUtils","../../renderers/support/lengthUtils"],function(a,
d,n){const z=function(){const r=Object.keys(n.meterIn);d.remove(r,"decimal-degrees");r.sort();return r}();a.getMetersPerUnit=function(r){return 1/(n.meterIn[r]||1)};a.supportedUnits=z;a.supportsUnit=function(r){return!!r&&null!=n.meterIn[r]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/lengthUtils":function(){define(["exports","../../core/unitUtils","../../geometry/support/Ellipsoid"],function(a,d,n){d={unknown:1,inches:d.convertUnit(1,"meters","inches"),
feet:d.convertUnit(1,"meters","feet"),"us-feet":d.convertUnit(1,"meters","us-feet"),yards:d.convertUnit(1,"meters","yards"),miles:d.convertUnit(1,"meters","miles"),"nautical-miles":d.convertUnit(1,"meters","nautical-miles"),millimeters:d.convertUnit(1,"meters","millimeters"),centimeters:d.convertUnit(1,"meters","centimeters"),decimeters:d.convertUnit(1,"meters","decimeters"),meters:d.convertUnit(1,"meters","meters"),kilometers:d.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/d.lengthToDegrees(1,
"meters",n.earth.radius)};a.meterIn=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment":function(){define("exports ../../../../core/has ../../../../core/LRUCache ../../../../core/MapUtils ../../../../core/promiseUtils ../../../../core/unitUtils ../../../../symbols/support/unitConversionUtils".split(" "),function(a,d,n,z,r,G,b){function m(D,{x:p,y:A,z:F,spatialReference:q}){return`${D}-${p}-${A}-${F??
0}}-wkid:${q?.wkid}`}function f(){return[]}class v{async alignCandidates(D,p,A){return D}notifyElevationSourceChange(){}}class x{constructor(D,p){this._elevationInfo=D;this._alignPointsInFeatures=p;this._alignmentsCache=new n.LRUCache(1024);this._cacheVersion=0}async alignCandidates(D,p,A){const F=this._elevationInfo;if(null!=F&&"absolute-height"===F.mode&&!F.featureExpressionInfo){{const {offset:q,unit:c}=F;if(null!=q){p=G.getMetersPerVerticalUnitForSR(p);A=b.getMetersPerUnit(c??"meters");p=A/p*
q;for(const l of D)switch(l.type){case "edge":l.start.z+=p;l.end.z+=p;continue;case "vertex":l.target.z+=p}}}return D}return this._alignComputedElevationCandidates(D,p,A)}notifyElevationSourceChange(){this._alignmentsCache.clear();this._cacheVersion++}async _alignComputedElevationCandidates(D,p,A){var F=new Map;for(const I of D)z.getOrCreateMapValue(F,I.objectId,f).push(I);const [q,c,l]=this._prepareQuery(F,p);F=await this._alignPointsInFeatures(q,A);r.throwIfAborted(A);if(l!==this._cacheVersion)return this._alignComputedElevationCandidates(D,
p,A);this._applyCacheAndResponse(q,F,c);const {drapedObjectIds:H,failedObjectIds:g}=F;p=[];for(const I of D)({objectId:D}=I),H.has(D)&&"edge"===I.type&&(I.draped=!0),g.has(D)||p.push(I);return p}_prepareQuery(D,p){const A=[],F=[];for(const [q,c]of D){D=[];for(const l of c)this._addToQueriesOrCachedResult(q,l.target,D,F),"edge"===l.type&&(this._addToQueriesOrCachedResult(q,l.start,D,F),this._addToQueriesOrCachedResult(q,l.end,D,F));0!==D.length&&A.push({objectId:q,points:D})}return[{spatialReference:p.toJSON(),
pointsInFeatures:A},F,this._cacheVersion]}_addToQueriesOrCachedResult(D,p,A,F){D=m(D,p);D=this._alignmentsCache.get(D);null!=D?F.push(new B(p,D)):A.push(p)}_applyCacheAndResponse(D,{elevations:p,drapedObjectIds:A,failedObjectIds:F},q){for(var c of q)c.apply();q=0;c=this._alignmentsCache;for(const {objectId:l,points:H}of D.pointsInFeatures)if(F.has(l))q+=H.length;else{D=!A.has(l);for(const g of H){const I=m(l,g),E=p[q++];g.z=E;D&&c.put(I,E,1)}}}}class B{constructor(D,p){this.point=D;this.z=p}apply(){this.point.z=
this.z}}a.getSnappingCandidateElevationAligner=function(D=!1,p){if(D){const {elevationInfo:A,alignPointsInFeatures:F}=p;return new x(A,F)}return new v};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/snappingCandidateElevationFilter":function(){define(["exports","../../../../core/has"],function(a,d){function n(f){return 1>=f.distance}function z(f,v,{x,y:B,z:D}){const {start:p,end:A,target:F}=f;if(!f.draped){const l=A.x-p.x;var q=A.y-
p.y,c=A.z-p.z;const H=Math.min(1,Math.max(0,((v.x-p.x)*l+(v.y-p.y)*q+c*(v.z-p.z))/(l*l+q*q+c*c)));q=p.y+q*H;c=p.z+c*H;F.x=p.x+l*H;F.y=q;F.z=c}x=(v.x-F.x)/x;B=(v.y-F.y)/B;v=(v.z-F.z)/D;f.distance=Math.sqrt(x*x+B*B+v*v)}function r(f,v,{x,y:B,z:D}){const {target:p}=f;x=(v.x-p.x)/x;B=(v.y-p.y)/B;v=(v.z-p.z)/D;f.distance=Math.sqrt(x*x+B*B+v*v)}function G(f,v){return f.distance-v.distance}class b{filter(f,v){return v}notifyElevationSourceChange(){}}class m{filter(f,v){const {point:x,distance:B}=f;({z:f}=
x);if(null==f||0===v.length)return v;f="number"===typeof B?{x:B,y:B,z:B}:B;v=this._updateCandidatesTo3D(v,x,f).filter(n);v.sort(G);return v}_updateCandidatesTo3D(f,v,x){for(const B of f)switch(B.type){case "edge":z(B,v,x);continue;case "vertex":r(B,v,x)}return f}}a.getSnappingCandidateElevationFilter=function(f=!1){return f?new m:new b};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/symbologySnappingCandidates":function(){define("exports ../../../../core/has ../../../../core/lang ../../../../core/LRUCache ../../../../core/promiseUtils ../../../../core/string".split(" "),
function(a,d,n,z,r,G){function b(v){switch(v.type){case "vertex":const {objectId:x,target:B}=v;return G.numericHash(`${x}-vertex-${B.x}-${B.y}-${B.z??0}`).toString();case "edge":const {objectId:D,start:p,end:A}=v;return G.numericHash(`${D}-edge-${p.x}-${p.y}-${p.z??0}-to-${A.x}-${A.y}-${A.z??0}`).toString();default:return""}}class m{async fetch(){return[]}notifySymbologyChange(){}}class f{constructor(v){this._getSymbologyCandidates=v;this._candidatesCache=new z.LRUCache(1024);this._cacheVersion=0}async fetch(v,
x){if(0===v.length)return[];const B=[],D=[],p=this._candidatesCache;for(var A of v){var F=b(A),q=p.get(F);if(q)for(var c of q)D.push(n.clone(c));else B.push(A),p.put(F,[],1)}if(0===B.length)return D;A=this._cacheVersion;const {candidates:l,sourceCandidateIndices:H}=await this._getSymbologyCandidates(B,x);r.throwIfAborted(x);if(A!==this._cacheVersion)return this.fetch(v,x);v=[];({length:x}=l);for(A=0;A<x;++A)F=l[A],q=b(B[H[A]]),c=p.get(q),c.push(F),p.put(q,c,c.length),v.push(n.clone(F));return D.concat(v)}notifySymbologyChange(){this._candidatesCache.clear();
this._cacheVersion++}}a.getSymbologySnappingCandidatesFetcher=function(v=!1,x){return v?new f(x):new m};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTiledFetcher":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/asyncUtils ../../../../../core/Logger ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/SetUtils ../../../../../core/uuid ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/support/arcgisLayerUrl ../../../../../rest/query/operations/pbfOptimizedFeatureSet ../../../../../rest/query/operations/query ../../../../../rest/support/Query ./PendingFeatureTile".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H,g,I){a.FeatureServiceTiledFetcher=class extends n{get _minimumVerticesPerFeature(){switch(this.store?.featureStore.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":return 1;case "esriGeometryPolygon":return 4;case "esriGeometryPolyline":return 2}}get _mandatoryOutFields(){const E=new Set;this.objectIdField&&E.add(this.objectIdField);this.globalIdField&&E.add(this.globalIdField);return E}set outFields(E){const C=this._get("outFields");
E=f.union(E,this._mandatoryOutFields);f.equals(E,C)||(this._set("outFields",E),f.isSubsetOf(E,C)||this.refresh())}get outFields(){return this._get("outFields")??this._mandatoryOutFields}set filter(E){const C=this._get("filter");E=this._filterProperties(E);JSON.stringify(C)!==JSON.stringify(E)&&this._set("filter",E)}set customParameters(E){const C=this._get("customParameters");JSON.stringify(C)!==JSON.stringify(E)&&this._set("customParameters",E)}get _configuration(){return{filter:this.filter,customParameters:this.customParameters,
tileInfo:this.tileInfo,tileSize:this.tileSize}}set tileInfo(E){const C=this._get("tileInfo");C===E||null!=E&&null!=C&&JSON.stringify(E)===JSON.stringify(C)||(this._set("tileInfo",E),this.store.tileInfo=E)}set tileSize(E){this._get("tileSize")!==E&&this._set("tileSize",E)}get updating(){return this._updatingHandles.updating}get hasZ(){return this.store.featureStore.hasZ}constructor(E){super(E);this.suspended=!0;this._historicMoment=null;this.tilesOfInterest=[];this.availability=0;this._pendingTiles=
new Map;this._updatingHandles=new p.UpdatingHandles}initialize(){this._initializeFetchExtent();this._updatingHandles.add(()=>this._configuration,()=>this.refresh());this._updatingHandles.add(()=>this.tilesOfInterest,(E,C)=>{z.equals(E,C,({id:N},{id:Q})=>N===Q)||this._process()},m.sync);this.addHandles(m.when(()=>!this.suspended,()=>this._process()))}destroy(){this._pendingTiles.forEach(E=>this._deletePendingTile(E));this._pendingTiles.clear();this.store.destroy();this.tilesOfInterest.length=0;this._updatingHandles.destroy()}refresh(){this.store.refresh();
this._pendingTiles.forEach(E=>this._deletePendingTile(E));this._process()}async handleEdits(E){E.historicMoment&&(this._historicMoment=E.historicMoment);if(E.addedFeatures.length||E.updatedFeatures.length||E.deletedFeatures.length){for(const N of this._pendingTiles.values())N.reset();var C={...E,deletedFeatures:E.deletedFeatures.map(({objectId:N,globalId:Q})=>N&&-1!==N?N:this._lookupObjectIdByGlobalId(Q))};E=r.createTask(async N=>{try{await this.store.processEdits(C,(Q,T)=>this._queryFeaturesById(Q,
T),N),this._processPendingTiles()}catch(Q){b.throwIfAbortError(Q),G.getLogger(this).warn("Failed to apply edits",Q)}});this.addHandles(E);await this._updatingHandles.addPromise(E.promise)}}setHistoricMoment(E){E?.getTime()!==this._historicMoment?.getTime()&&(this._historicMoment=E,this.refresh())}_initializeFetchExtent(){if(this.capabilities.query.supportsExtent&&c.isHostedAgolService(this.url)){var E=r.createTask(async C=>{try{const N=await H.executeQueryForExtent(this.url,new g({where:"1\x3d1",
outSpatialReference:this.spatialReference,cacheHint:this.capabilities.query.supportsCacheHint??void 0}),{query:this._configuration.customParameters,signal:C});this.store.extent=A.fromJSON(N.data?.extent)}catch(N){b.throwIfAbortError(N),G.getLogger(this).warn("Failed to fetch data extent",N)}});this._updatingHandles.addPromise(E.promise.then(()=>this._process()));this.addHandles(E)}}get debugInfo(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this._pendingTiles.values()).map(E=>
E.debugInfo),storedTiles:this.store.debugInfo}}_process(){this._markTilesNotAlive();this._createPendingTiles();this._deletePendingTiles();this._processPendingTiles()}_markTilesNotAlive(){for(const E of this._pendingTiles.values())E.alive=!1}_createPendingTiles(){if(!this.suspended){var E=this._collectMissingTilesInfo();this._setAvailability(null==E?1:E.coveredArea/E.fullArea);if(null!=E)for(const {data:C,resolution:N}of E.missingTiles)(E=this._pendingTiles.get(C.id))?(E.resolution=N,E.alive=!0):this._createPendingTile(C,
N)}}_collectMissingTilesInfo(){let E=null;for(let C=this.tilesOfInterest.length-1;0<=C;C--){const N=this.store.process(this.tilesOfInterest[C],(Q,T)=>this._verifyTileComplexity(Q,T),this.outFields);null==E?E=N:E.prepend(N)}return E}_deletePendingTiles(){for(const E of this._pendingTiles.values())E.alive||this._deletePendingTile(E)}_processPendingTiles(){const E={fetchCount:(C,N)=>this._fetchCount(C,N),fetchFeatures:(C,N,Q)=>this._fetchFeatures(C,N,Q),finish:(C,N)=>this._finishPendingTile(C,N),resume:()=>
this._processPendingTiles()};if(this._ensureFetchAllCounts(E))for(const C of this._pendingTiles.values())this._verifyTileComplexity(this.store.getFeatureCount(C.data),C.resolution)&&this._updatingHandles.addPromise(C.process(E))}_verifyTileComplexity(E,C){return this._verifyVertexComplexity(E)&&this._verifyFeatureDensity(E,C)}_verifyVertexComplexity(E){return 1E6>E*this._minimumVerticesPerFeature}_verifyFeatureDensity(E,C){if(null==this.tileInfo)return!1;C*=this.tileSize;return 1>25/(C*C)*E}_ensureFetchAllCounts(E){let C=
!0;for(const N of this._pendingTiles.values())N.state.type<I.StateType.FETCHED_COUNT&&this._updatingHandles.addPromise(N.process(E)),N.state.type<=I.StateType.FETCH_COUNT&&(C=!1);return C}_finishPendingTile(E,C){this.store.add(E.data,C);this._deletePendingTile(E);this._updateAvailability()}_updateAvailability(){const E=this._collectMissingTilesInfo();this._setAvailability(null==E?1:E.coveredArea/E.fullArea)}_setAvailability(E){this._set("availability",E)}_createPendingTile(E,C){C=new I.PendingFeatureTile(E,
C);this._pendingTiles.set(E.id,C);return C}_deletePendingTile(E){E.reset();this._pendingTiles.delete(E.data.id)}async _fetchCount(E,C){return this.store.fetchCount(E.data,this.url,this._createCountQuery(E),{query:this.customParameters,timeout:6E5,signal:C})}async _fetchFeatures(E,C,N){let Q=0;const T=[];let y=0,R=C;for(;;){const k=this._createFeaturesQuery(E),h=this._setPagingParameters(k,Q,R),{features:t,exceededTransferLimit:J}=await this._queryFeatures(k,N);h&&(Q+=k.num);y+=t.length;for(const U of t)T.push(U);
R=C-y;if(!h||!J||0>=R)return T}}_filterProperties(E){return null==E?{where:"1\x3d1",gdbVersion:void 0,timeExtent:void 0}:{where:E.where||"1\x3d1",timeExtent:E.timeExtent,gdbVersion:E.gdbVersion}}_lookupObjectIdByGlobalId(E){const C=this.globalIdField,N=this.objectIdField;if(null==C)throw Error("Expected globalIdField to be defined");let Q=null;const T=E?v.normalizeGlobalID(E):E;this.store.featureStore.forEach(y=>{T===v.normalizeGlobalID(y.attributes[C])&&(Q=y.objectId??y.attributes[N])});if(null==
Q)throw Error(`Expected to find a feature with globalId ${E}`);return Q}_queryFeaturesById(E,C){const N=this._createFeaturesQuery();N.objectIds=E;return this._queryFeatures(N,C)}_queryFeatures(E,C){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(E,C):this._queryFeaturesJSON(E,C)}async _queryFeaturesPBF(E,C){const {sourceSpatialReference:N}=this;({data:E}=await H.executeQueryPBF(this.url,E,new l.OptimizedFeatureSetParserContext({sourceSpatialReference:N}),{query:this._configuration.customParameters,
timeout:6E5,signal:C}));return q.unquantizeOptimizedFeatureSet(E)}async _queryFeaturesJSON(E,C){const {sourceSpatialReference:N}=this;({data:E}=await H.executeQuery(this.url,E,N,{query:this._configuration.customParameters,timeout:6E5,signal:C}));return q.convertFromFeatureSet(E,this.objectIdField)}_createCountQuery(E){E=this._createBaseQuery(E);this.capabilities.query.supportsCacheHint&&(E.cacheHint=!0);return E}_createFeaturesQuery(E=null){const C=this._createBaseQuery(E);var N=null!=E?.data?this.store.getAttributesForTile(E?.data?.id):
null;N=f.union(f.difference(this.outFields,N??new Set),this._mandatoryOutFields);C.outFields=Array.from(N);C.returnGeometry=!0;null!=E&&(this.capabilities.query.supportsResultType?C.resultType="tile":this.capabilities.query.supportsCacheHint&&(C.cacheHint=!0));return C}_createBaseQuery(E){E=new g({returnZ:this.hasZ,returnM:!1,historicMoment:this._historicMoment,geometry:null!=this.tileInfo&&null!=E?F.toExtent(E.data.extent,this.tileInfo.spatialReference):void 0});const C=this._configuration.filter;
null!=C&&(E.where=C.where,E.gdbVersion=C.gdbVersion,E.timeExtent=C.timeExtent);E.outSpatialReference=this.spatialReference;return E}_setPagingParameters(E,C,N){if(!this.capabilities.query.supportsPagination)return!1;const {supportsMaxRecordCountFactor:Q,supportsCacheHint:T,tileMaxRecordCount:y,maxRecordCount:R,supportsResultType:k}=this.capabilities.query,h=Q?g.MAX_MAX_RECORD_COUNT_FACTOR:1,t=h*((k||T)&&y?y:R||2E3);E.start=C;Q?(E.maxRecordCountFactor=Math.min(h,Math.ceil(N/t)),E.num=Math.min(N,E.maxRecordCountFactor*
t)):E.num=Math.min(N,t);return!0}};d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"url",void 0);d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"objectIdField",void 0);d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"globalIdField",void 0);d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"capabilities",void 0);d.__decorate([x.property({constructOnly:!0})],
a.FeatureServiceTiledFetcher.prototype,"sourceSpatialReference",void 0);d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"spatialReference",void 0);d.__decorate([x.property({constructOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"store",void 0);d.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_minimumVerticesPerFeature",null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"_mandatoryOutFields",null);d.__decorate([x.property()],
a.FeatureServiceTiledFetcher.prototype,"outFields",null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"suspended",void 0);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"_historicMoment",void 0);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"filter",null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"customParameters",null);d.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"_configuration",
null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"tileInfo",null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"tileSize",null);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,"tilesOfInterest",void 0);d.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"updating",null);d.__decorate([x.property({readOnly:!0})],a.FeatureServiceTiledFetcher.prototype,"availability",void 0);d.__decorate([x.property()],a.FeatureServiceTiledFetcher.prototype,
"hasZ",null);a.FeatureServiceTiledFetcher=d.__decorate([D.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],a.FeatureServiceTiledFetcher);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/uuid":function(){define(["exports"],function(a){function d(){if(n)return crypto.randomUUID();const z=crypto.getRandomValues(new Uint16Array(8));z[3]=z[3]&4095|16384;z[4]=z[4]&16383|32768;const r=G=>z[G].toString(16).padStart(4,"0");
return r(0)+r(1)+"-"+r(2)+"-"+r(3)+"-"+r(4)+"-"+r(5)+r(6)+r(7)}const n="randomUUID"in crypto;a.generateBracedUUID=function(){return`{${d().toUpperCase()}}`};a.generateLowercaseBracedUUID=function(){return`{${d()}}`};a.generateUUID=d;a.normalizeGlobalID=function(z){const r=z.toUpperCase();return"{"!==z[0]?`{${r}}`:r};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/arcgisLayerUrl":function(){define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],
function(a,d,n){function z(B){if(null==B)return null;B=d.urlToObject(B);B=B?.path.match(f)||B?.path.match(v);if(!B)return null;const [,D,p,A,F]=B;B=p.indexOf("/");return{title:G(-1!==B?p.slice(B+1):p),serverType:b[A.toLowerCase()],sublayer:null!=F&&""!==F?parseInt(F,10):null,url:{path:D}}}function r(B){return(B=d.urlToObject(B).path.match(x))?{serviceUrl:B[1],sublayerId:Number(B[2])}:null}function G(B){B=B.replaceAll(/\s*[/_]+\s*/g," ");return B[0].toUpperCase()+B.slice(1)}const b={mapserver:"MapServer",
imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},m=Object.values(b),f=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${m.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),v=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${m.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),x=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;
a.cleanTitle=G;a.isArcGISUrl=function(B){return f.test(B)};a.isHostedAgolService=function(B){B=d.getOrigin(B,!0);if(!B)return!1;B=B.toLowerCase();return B.endsWith(".arcgis.com")&&(B.startsWith("services")||B.startsWith("tiles")||B.startsWith("features"))};a.isServerOrServicesAGOLUrl=function(B){if(!B)return!1;B=(new d.Url(d.makeAbsolute(B))).authority?.toLowerCase();return"server.arcgisonline.com"===B||"services.arcgisonline.com"===B};a.isWmsServer=function(B){if(!B)return!1;var D=B.toLowerCase();
B=D.includes("/services/");const p=D.includes("/mapserver/wmsserver"),A=D.includes("/imageserver/wmsserver");D=D.includes("/wmsserver");return B&&(p||A||D)};a.parse=z;a.parseNonStandardSublayerUrl=r;a.sanitizeUrl=function(B,D){return B?d.removeTrailingSlash(d.removeQueryParameters(B,D)):B};a.sanitizeUrlWithLayerId=function(B){let {url:D}=B;if(!D)return{url:D};D=d.removeQueryParameters(D,B.logger);const p=d.urlToObject(D),A=z(p.path);let F=void 0;null!=A?(null!=A.sublayer&&null==B.layer.layerId&&(F=
A.sublayer),D=A.url.path):B.nonStandardUrlAllowed&&(B=r(p.path),null!=B&&(D=B.serviceUrl,F=B.sublayerId));return{url:d.removeTrailingSlash(D),layerId:F}};a.serverTypes=m;a.titleFromUrlAndName=function(B,D){const p=[];B&&(B=z(B),null!=B&&B.title&&p.push(B.title));D&&(D=G(D),p.push(D));if(2===p.length){if(p[0].toLowerCase().includes(p[1].toLowerCase()))return p[0];if(p[1].toLowerCase().includes(p[0].toLowerCase()))return p[1]}return p.join(" - ")};a.writeUrlWithLayerId=function(B,D,p,A,F){n.write(D,
A,"url",F);A.url&&null!=B.layerId&&(A.url=d.join(A.url,p,B.layerId.toString()))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfOptimizedFeatureSet":function(){define("exports ../../../core/unitUtils ../../../geometry/support/spatialReferenceUtils ../../../layers/graphics/OptimizedFeature ../../../layers/graphics/OptimizedFeatureSet ../../../layers/graphics/OptimizedGeometry".split(" "),function(a,d,n,z,r,G){const b=["esriGeometryPoint","esriGeometryMultipoint",
"esriGeometryPolyline","esriGeometryPolygon"];class m{constructor(f){this._options=f;this.geometryTypes=b;this._vertexDimension=this._coordinatePtr=0}createFeatureResult(){return new r}prepareFeatures(f){this._vertexDimension=2;f.hasZ&&this._vertexDimension++;f.hasM&&this._vertexDimension++}finishFeatureResult(f){if(f?.features&&f.hasZ&&this._options.sourceSpatialReference&&f.spatialReference&&!n.equals(f.spatialReference,this._options.sourceSpatialReference)&&!f.spatialReference.vcsWkid){var v=d.getMetersPerVerticalUnitForSR(this._options.sourceSpatialReference),
x=d.getMetersPerVerticalUnitForSR(f.spatialReference);v/=x;if(1!==v)for(const B of f.features)if(z.hasGeometry(B))for(f=B.geometry.coords,x=2;x<f.length;x+=3)f[x]*=v}}addFeature(f,v){f.features.push(v)}createFeature(){return new z.OptimizedFeature}createSpatialReference(){return{wkid:0}}createGeometry(){return new G}addField(f,v){f.fields.push(v)}allocateCoordinates(f){f.coords.length=f.lengths.reduce((v,x)=>v+x,0)*this._vertexDimension;this._coordinatePtr=0}addCoordinate(f,v){f.coords[this._coordinatePtr++]=
v}addCoordinatePoint(f,v){f.coords.push(v)}addLength(f,v){f.lengths.push(v)}addQueryGeometry(f,v){f.queryGeometry=v.queryGeometry;f.queryGeometryType=v.queryGeometryType}createPointGeometry(){return new G}}a.OptimizedFeatureSetParserContext=m;a.optimizedGeometryTypes=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/query":function(){define("exports ../../../request ../../../core/urlUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../../operations/urlUtils ./pbfQueryUtils ./queryZScale".split(" "),
function(a,d,n,z,r,G,b,m,f){function v(p,A){if(A&&"extent"===p.type)return`${p.xmin},${p.ymin},${p.xmax},${p.ymax}`;if(A&&"point"===p.type)return`${p.x},${p.y}`;p=p.toJSON();delete p.spatialReference;return JSON.stringify(p)}function x(p,A){const F=p.geometry,q=p.toJSON();delete q.compactGeometryEnabled;delete q.defaultSpatialReferenceEnabled;let c,l,H;null!=F&&(l=F.spatialReference,H=G.srToRESTValue(l),q.geometryType=z.getJsonType(F),q.geometry=v(F,p.compactGeometryEnabled),q.inSR=H);q.groupByFieldsForStatistics&&
(q.groupByFieldsForStatistics=q.groupByFieldsForStatistics.join(","));q.objectIds&&(q.objectIds=q.objectIds.join(","));q.orderByFields&&(q.orderByFields=q.orderByFields.join(","));!q.outFields||!q.returnDistinctValues&&(A?.returnCountOnly||A?.returnExtentOnly||A?.returnIdsOnly)?delete q.outFields:q.outFields.includes("*")?q.outFields="*":q.outFields=q.outFields.join(",");q.outSR?(q.outSR=G.srToRESTValue(q.outSR),c=p.outSpatialReference):F&&(q.returnGeometry||q.returnCentroid)&&(q.outSR=q.inSR,c=l);
q.returnGeometry&&delete q.returnGeometry;q.outStatistics&&(q.outStatistics=JSON.stringify(q.outStatistics));q.fullText&&(q.fullText=JSON.stringify(q.fullText));q.pixelSize&&(q.pixelSize=JSON.stringify(q.pixelSize));q.quantizationParameters&&(p.defaultSpatialReferenceEnabled&&null!=l&&null!=p.quantizationParameters?.extent&&l.equals(p.quantizationParameters.extent.spatialReference)&&delete q.quantizationParameters.extent.spatialReference,q.quantizationParameters=JSON.stringify(q.quantizationParameters));
q.parameterValues&&(q.parameterValues=JSON.stringify(q.parameterValues));q.rangeValues&&(q.rangeValues=JSON.stringify(q.rangeValues));q.dynamicDataSource&&(q.layer=JSON.stringify({source:q.dynamicDataSource}),delete q.dynamicDataSource);if(q.timeExtent){const {start:g,end:I}=q.timeExtent;if(null!=g||null!=I)q.time=g===I?g:`${null==g?"null":g},${null==I?"null":I}`;delete q.timeExtent}p.defaultSpatialReferenceEnabled&&null!=l&&null!=c&&l.equals(c)&&(q.defaultSR=q.inSR,delete q.inSR,delete q.outSR);
return q}function B(p,A,F){return D(p,A,"pbf",F)}async function D(p,A,F,q={},c={}){p="string"===typeof p?n.urlToObject(p):p;var l=(await r.normalizeCentralMeridian(A.geometry?[A.geometry]:[],null,{signal:q.signal}))?.[0];null!=l&&(A=A.clone(),A.geometry=l);l=b.mapParameters({...p.query,f:F,...c,...x(A,c)});return d(n.join(p.path,null==A.formatOf3DObjects||c.returnCountOnly||c.returnExtentOnly||c.returnIdsOnly?"query":"query3d"),{...q,responseType:"pbf"===F?"array-buffer":"json",query:{...l,...q.query}})}
a.encodeGeometry=v;a.executeQuery=async function(p,A,F,q){p=null!=A.timeExtent&&A.timeExtent.isEmpty?{data:{features:[]}}:await D(p,A,"json",q);f.applyFeatureSetZUnitScaling(A,F,p.data);return p};a.executeQueryForCount=function(p,A,F){return null!=A.timeExtent&&A.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):D(p,A,"json",F,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=async function(p,A,F){if(null!=A.timeExtent&&A.timeExtent.isEmpty)return{data:{count:0,extent:null}};p=await D(p,
A,"json",F,{returnExtentOnly:!0,returnCountOnly:!0});A=p.data;if(A.hasOwnProperty("extent"))return p;if(A.features)throw Error("Layer does not support extent calculation.");if(A.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return p};a.executeQueryForIds=function(p,A,F){return null!=A.timeExtent&&A.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):D(p,A,"json",F,{returnIdsOnly:!0})};a.executeQueryPBF=async function(p,A,F,q){if(null!=A.timeExtent&&A.timeExtent.isEmpty)return{data:F.createFeatureResult()};
p=await B(p,A,q);p.data=m.parsePBFFeatureQuery(p.data,F);return p};a.executeQueryPBFBuffer=B;a.queryToQueryStringParameters=x;a.runQuery=D;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/operations/urlUtils":function(){define(["exports"],function(a){function d(n){const z={};for(const r in n){if("declaredClass"===r)continue;const G=n[r];if(null!=G&&"function"!==typeof G)if(Array.isArray(G)){z[r]=[];for(let b=0;b<G.length;b++)z[r][b]=d(G[b])}else"object"===typeof G?G.toJSON&&
(z[r]=JSON.stringify(G)):z[r]=G}return z}a.mapParameters=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfQueryUtils":function(){define(["exports","./pbfFeatureServiceParser"],function(a,d){a.parsePBFFeatureQuery=function(n,z){var r=d.parseFeatureQuery(n,z);n=r.queryResult.featureResult;z=r.queryResult.queryGeometry;r=r.queryResult.queryGeometryType;if(n&&n.features&&n.features.length&&n.objectIdFieldName){const G=n.objectIdFieldName;for(const b of n.features)b.attributes&&
(b.objectId=b.attributes[G])}n&&(n.queryGeometry=z,n.queryGeometryType=r);return n};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/pbfFeatureServiceParser":function(){define(["exports","../../../core/Error","../../../core/pbf","../../../layers/graphics/OptimizedGeometry","./pbfOptimizedFeatureSet"],function(a,d,n,z,r){function G(C){return C>=g.length?null:g[C]}function b(C,N,Q){C=C.asUnsafe();for(Q=N.createPointGeometry(Q);C.next();)switch(C.tag()){case 3:var T=
C.getUInt32();T=C.pos()+T;let y=0;for(;C.pos()<T;)N.addCoordinatePoint(Q,C.getSInt64(),y++);break;default:C.skip()}return Q}function m(C,N,Q){C=C.asUnsafe();const T=N.createGeometry(Q);for(Q=2+(Q.hasZ?1:0)+(Q.hasM?1:0);C.next();)switch(C.tag()){case 2:var y=C.getUInt32();y=C.pos()+y;for(var R=0;C.pos()<y;)N.addLength(T,C.getUInt32(),R++);break;case 3:y=C.getUInt32();y=C.pos()+y;R=0;for(N.allocateCoordinates(T);C.pos()<y;)N.addCoordinate(T,C.getSInt64(),R),R++,R===Q&&(R=0);break;default:C.skip()}return T}
function f(C){C=C.asUnsafe();const N=new z;let Q="esriGeometryPoint";for(;C.next();)switch(C.tag()){case 2:var T=C.getUInt32();for(T=C.pos()+T;C.pos()<T;)N.lengths.push(C.getUInt32());break;case 3:T=C.getUInt32();for(T=C.pos()+T;C.pos()<T;)N.coords.push(C.getSInt64());break;case 1:Q=r.optimizedGeometryTypes[C.getEnum()];break;default:C.skip()}return{queryGeometry:N,queryGeometryType:Q}}function v(C){for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:return C.getString();case 2:return C.getFloat();
case 3:return C.getDouble();case 4:return C.getSInt32();case 5:return C.getUInt32();case 6:return C.getInt64();case 7:return C.getUInt64();case 8:return C.getSInt64();case 9:return C.getBool();default:return C.skip(),null}return null}function x(C){C=C.asUnsafe();const N={type:G(0)};for(;C.next();)switch(C.tag()){case 1:N.name=C.getString();break;case 2:N.type=G(C.getEnum());break;case 3:N.alias=C.getString();break;case 4:var Q=C.getEnum();Q=Q>=I.length?null:I[Q];N.sqlType=Q;break;case 5:C.skip();
break;case 6:N.defaultValue=C.getString();break;default:C.skip()}return N}function B(C){const N={};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:N.name=C.getString();break;case 2:N.isSystemMaintained=C.getBool();break;default:C.skip()}return N}function D(C,N,Q,T){const y=N.createFeature(Q);let R=0;for(;C.next();)switch(C.tag()){case 1:const k=T[R++].name;y.attributes[k]=C.processMessage(v);break;case 2:y.geometry=C.processMessageWithArgs(m,N,Q);break;case 4:y.centroid=C.processMessageWithArgs(b,
N,Q);break;default:C.skip()}return y}function p(C){const N=[1,1,1,1];for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:N[0]=C.getDouble();break;case 2:N[1]=C.getDouble();break;case 4:N[2]=C.getDouble();break;case 3:N[3]=C.getDouble();break;default:C.skip()}return N}function A(C){const N=[0,0,0,0];for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:N[0]=C.getDouble();break;case 2:N[1]=C.getDouble();break;case 4:N[2]=C.getDouble();break;case 3:N[3]=C.getDouble();break;default:C.skip()}return N}function F(C){const N=
{originPosition:0>=E.length?null:E[0]};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:var Q=C.getEnum();N.originPosition=Q>=E.length?null:E[Q];break;case 2:N.scale=C.processMessage(p);break;case 3:N.translate=C.processMessage(A);break;default:C.skip()}return N}function q(C){const N={};for(C=C.asUnsafe();C.next();)switch(C.tag()){case 1:N.shapeAreaFieldName=C.getString();break;case 2:N.shapeLengthFieldName=C.getString();break;case 3:N.units=C.getString();break;default:C.skip()}return N}function c(C,
N){for(N=N.createSpatialReference();C.next();)switch(C.tag()){case 1:N.wkid=C.getUInt32();break;case 5:N.wkt=C.getString();break;case 2:N.latestWkid=C.getUInt32();break;case 3:N.vcsWkid=C.getUInt32();break;case 4:N.latestVcsWkid=C.getUInt32();break;default:C.skip()}return N}function l(C,N){const Q=N.createFeatureResult();C=C.asUnsafe();Q.geometryType=0>=N.geometryTypes.length?null:N.geometryTypes[0];let T=!1;for(;C.next();)switch(C.tag()){case 1:Q.objectIdFieldName=C.getString();break;case 3:Q.globalIdFieldName=
C.getString();break;case 4:Q.geohashFieldName=C.getString();break;case 5:Q.geometryProperties=C.processMessage(q);break;case 7:var y=C.getEnum();Q.geometryType=y>=N.geometryTypes.length?null:N.geometryTypes[y];break;case 8:Q.spatialReference=C.processMessageWithArgs(c,N);break;case 10:Q.hasZ=C.getBool();break;case 11:Q.hasM=C.getBool();break;case 12:Q.transform=C.processMessage(F);break;case 9:Q.exceededTransferLimit=C.getBool();break;case 13:N.addField(Q,C.processMessage(x));break;case 15:T||(N.prepareFeatures(Q),
T=!0);N.addFeature(Q,C.processMessageWithArgs(D,N,Q,Q.fields));break;case 2:Q.uniqueIdField=C.processMessage(B);break;default:C.skip()}N.finishFeatureResult(Q);return Q}function H(C,N){const Q={};let T=null;for(;C.next();)switch(C.tag()){case 4:T=C.processMessageWithArgs(f);break;case 1:Q.featureResult=C.processMessageWithArgs(l,N);break;default:C.skip()}null!=T&&Q.featureResult&&N.addQueryGeometry(Q,T);return Q}const g="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML esriFieldTypeBigInteger esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "),
I="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),E=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(C,N){try{const Q=new n(new Uint8Array(C),new DataView(C));
for(C={};Q.next();)switch(Q.tag()){case 2:C.queryResult=Q.processMessageWithArgs(H,N);break;default:Q.skip()}return C}catch(Q){throw new d("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:Q});}};a.parseField=x;a.parseFieldType=G;a.parseTransform=F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/query/operations/queryZScale":function(){define(["exports","../../../geometry/support/zscale"],function(a,d){a.applyFeatureSetZUnitScaling=function(n,z,r){if(r?.features&&
r.hasZ&&(n=d.getGeometryZScaler(r.geometryType,z,n.outSpatialReference),null!=n))for(const G of r.features)n(G.geometry)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/PendingFeatureTile":function(){define(["exports","../../../../../core/asyncUtils","../../../../../geometry/support/aaBoundingRect"],function(a,d,n){class z{constructor(G,b){this.data=G;this.resolution=b;this.state={type:a.StateType.CREATED};this.alive=
!0}process(G){switch(this.state.type){case a.StateType.CREATED:return this.state=this._gotoFetchCount(this.state,G),this.state.task.promise.then(G.resume,G.resume);case a.StateType.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,G),this.state.task.promise.then(G.resume,G.resume);case a.StateType.FETCHED_FEATURES:this.state=this._goToDone(this.state,G)}return null}get debugInfo(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}get _featureCount(){switch(this.state.type){case a.StateType.CREATED:case a.StateType.FETCH_COUNT:return 0;
case a.StateType.FETCHED_COUNT:return this.state.featureCount;case a.StateType.FETCH_FEATURES:return this.state.previous.featureCount;case a.StateType.FETCHED_FEATURES:return this.state.features.length;case a.StateType.DONE:return this.state.previous.features.length}}get _stateToString(){switch(this.state.type){case a.StateType.CREATED:return"created";case a.StateType.FETCH_COUNT:return"fetch-count";case a.StateType.FETCHED_COUNT:return"fetched-count";case a.StateType.FETCH_FEATURES:return"fetch-features";
case a.StateType.FETCHED_FEATURES:return"fetched-features";case a.StateType.DONE:return"done"}}_gotoFetchCount(G,b){return{type:a.StateType.FETCH_COUNT,previous:G,task:d.createTask(async m=>{m=await d.resultOrAbort(b.fetchCount(this,m));this.state.type===a.StateType.FETCH_COUNT&&(this.state={type:a.StateType.FETCHED_COUNT,featureCount:m.ok?m.value:Infinity,previous:this.state})})}}_gotoFetchFeatures(G,b){return{type:a.StateType.FETCH_FEATURES,previous:G,task:d.createTask(async m=>{m=await d.resultOrAbort(b.fetchFeatures(this,
G.featureCount,m));this.state.type===a.StateType.FETCH_FEATURES&&(this.state={type:a.StateType.FETCHED_FEATURES,previous:this.state,features:m.ok?m.value:[]})})}}_goToDone(G,b){b.finish(this,G.features);return{type:a.StateType.DONE,previous:G}}reset(){const G=this.state;this.state={type:a.StateType.CREATED};switch(G.type){case a.StateType.FETCH_COUNT:case a.StateType.FETCH_FEATURES:G.task.abort()}}intersects(G){if(null==G||!this.data.extent)return!0;n.fromExtent(G,r);return n.intersects(this.data.extent,
r)}}a.StateType=void 0;(function(G){G[G.CREATED=0]="CREATED";G[G.FETCH_COUNT=1]="FETCH_COUNT";G[G.FETCHED_COUNT=2]="FETCHED_COUNT";G[G.FETCH_FEATURES=3]="FETCH_FEATURES";G[G.FETCHED_FEATURES=4]="FETCHED_FEATURES";G[G.DONE=5]="DONE"})(a.StateType||(a.StateType={}));const r=n.create();a.PendingFeatureTile=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileStore":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/byteSizeEstimations ../../../../../core/ByteSizeUnit ../../../../../core/has ../../../../../core/SetUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../layers/graphics/featureConversionUtils ../../../../../layers/graphics/data/BoundsStore ../../../../../layers/support/TileInfo ../../../../../layers/support/TileKey ../../../../../rest/query/operations/query ./FeatureServiceTileCache".split(" "),
function(a,d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c){function l(N){return N.reduce((Q,T)=>{var y=T.geometry;if(null==y)y=0;else{var R=z.estimateFixedArraySize(y.lengths,4);y=32+z.estimateFixedArraySize(y.coords,8)+R}T=32+y+z.estimateAttributesObjectSize(T.attributes);return Q+T},0)}a.FeatureServiceTileStore=class extends n{constructor(N){super(N);this.extent=this.tileInfo=null;this.maximumByteSize=10*r.ByteSizeUnit.MEGABYTES;this._tileBounds=new p.BoundsStore;this._tiles=new c.FeatureServiceTileCache;this._refCounts=
new Map;this._tileFeatureCounts=new Map;this._tmpBoundingRect=B.create()}add(N,Q){for(var T of Q)this._referenceFeature(T.objectId);Q=this.featureStore.upsertMany(Q);T=Q.map(y=>new Set(Object.keys(y.attributes))).reduce((y,R)=>b.intersection(y,R),new Set(Object.keys(Q[0]?.attributes??[])));this._addTileStorage(N,new Set(Q.map(y=>y.objectId)),l(Q),T);this._tiles.applyByteSizeLimit(this.maximumByteSize,y=>this._removeTileStorage(y))}getAttributesForTile(N){return N?this._tiles.get(N)?.attributeKeys:
null}destroy(){this.clear();this._tileFeatureCounts.clear()}clear(){this.featureStore.clear();this._tileBounds.clear();this._tiles.clear();this._refCounts.clear()}refresh(){this.clear();this._tileFeatureCounts.clear()}processEdits(N,Q,T){this._processEditsDelete(N.deletedFeatures.concat(N.updatedFeatures));return this._processEditsRefetch(N.addedFeatures.concat(N.updatedFeatures),Q,T)}_addTileStorage(N,Q,T,y){const R=N.id;this._tiles.set(R,new H(N,Q,T,y));this._tileBounds.set(R,N.extent);this._tileFeatureCounts.set(R,
Q.size)}_remove({id:N}){(N=this._tiles.get(N))&&this._removeTileStorage(N)}_removeTileStorage(N){const Q=[];for(const T of N.objectIds)this._unreferenceFeature(T)===C.REMOVED&&Q.push(T);this.featureStore.removeManyById(Q);N=N.data.id;this._tiles.delete(N);this._tileBounds.delete(N)}_processEditsDelete(N){this.featureStore.removeManyById(N);for(const Q of this._tiles.values()){for(const T of N)Q.objectIds.delete(T);this._tileFeatureCounts.set(Q.data.id,Q.objectIds.size)}for(const Q of N)this._refCounts.delete(Q)}async _processEditsRefetch(N,
Q,T){if(N.length){N=(await Q(N,T)).features;var {hasZ:y,hasM:R}=this.featureStore;for(const k of N)N=D.getBoundsOptimizedGeometry(this._tmpBoundingRect,k.geometry,y,R),null!=N&&this._tileBounds.forEachInBounds(N,h=>{h=this._tiles.get(h);this.featureStore.add(k);const t=k.objectId;h.objectIds.has(t)||(h.objectIds.add(t),this._referenceFeature(t),this._tileFeatureCounts.set(h.data.id,h.objectIds.size))})}}process(N,Q=()=>!0,T){if(null==this.tileInfo||!N.extent||null!=this.extent&&!B.intersects(B.fromExtent(this.extent,
this._tmpBoundingRect),N.extent))return new I(N);var y=this.getAttributesForTile(N.id);if(b.isSubsetOf(T,y))return new I(N);y=this._createTileTree(N,this.tileInfo);this._simplify(y,Q,null,0,1);return this._collectMissingTiles(N,y,this.tileInfo,T)}get debugInfo(){return Array.from(this._tiles.values()).map(({data:N})=>({data:N,featureCount:this._tileFeatureCounts.get(N.id)||0}))}getFeatureCount(N){return this._tileFeatureCounts.get(N.id)??0}async fetchCount(N,Q,T,y){const R=this._tileFeatureCounts.get(N.id);
if(null!=R)return R;Q=await q.executeQueryForCount(Q,T,y);this._tileFeatureCounts.set(N.id,Q.data.count);return Q.data.count}_createTileTree(N,Q){const T=new g(N.level,N.row,N.col);Q.updateTileInfo(T,A.ExtrapolateOptions.POWER_OF_TWO);this._tileBounds.forEachInBounds(N.extent,y=>{y=this._tiles.get(y)?.data;var R;if(!(R=!y)){if(N&&y)if(N.level===y.level)R=N.row===y.row&&N.col===y.col;else{var k=N.level<y.level;R=k?N:y;k=k?y:N;var h=1<<k.level-R.level;R=Math.floor(k.row/h)===R.row&&Math.floor(k.col/
h)===R.col}else R=!1;R=!R}R||this._populateChildren(T,y,Q,this._tileFeatureCounts.get(y.id)||0)});return T}_populateChildren(N,Q,T,y){var R=Q.level-N.level-1;if(0>R)N.isLeaf=!0;else{var k=Q.row>>R,h=Q.col>>R;R=(k-(N.row<<1)<<1)+(h-(N.col<<1));var t=N.children[R];null!=t?this._populateChildren(t,Q,T,y):(k=new g(N.level+1,k,h),T.updateTileInfo(k,A.ExtrapolateOptions.POWER_OF_TWO),N.children[R]=k,this._populateChildren(k,Q,T,y))}}_simplify(N,Q,T,y,R){const k=R*R;if(N.isLeaf)return Q(this.getFeatureCount(N),
R)?0:(this._remove(N),null!=T&&(T.children[y]=null),k);R/=2;const h=R*R;let t=0;for(let J=0;J<N.children.length;J++){const U=N.children[J];t+=null!=U?this._simplify(U,Q,N,J,R):h}0===t?this._mergeChildren(N):.18751>1-t/k&&(this._purge(N),null!=T&&(T.children[y]=null),t=k);return t}_mergeChildren(N){const Q=new Set;let T=0,y;this._forEachLeaf(N,R=>{const k=this._tiles.get(R.id);if(k){y=y?b.intersection(y,k.attributeKeys):new Set(k.attributeKeys);T+=k.byteSize;for(const h of k.objectIds)Q.has(h)||(Q.add(h),
this._referenceFeature(h));this._remove(R)}});this._addTileStorage(N,Q,T,y??new Set);N.isLeaf=!0;N.children[0]=N.children[1]=N.children[2]=N.children[3]=null;this._tileFeatureCounts.set(N.id,Q.size)}_forEachLeaf(N,Q){for(const T of N.children)null!=T&&(T.isLeaf?Q(T):this._forEachLeaf(T,Q))}_purge(N){if(null!=N)if(N.isLeaf)this._remove(N);else for(let Q=0;Q<N.children.length;Q++)this._purge(N.children[Q]),N.children[Q]=null}_collectMissingTiles(N,Q,T,y){N=new E(T,N,this.extent);this._collectMissingTilesRecurse(Q,
N,1,y);return N.info}_collectMissingTilesRecurse(N,Q,T,y){var R=this.getAttributesForTile(N.id);(R=R&&!b.isSubsetOf(y,R))&&Q.addMissing(N.level,N.row,N.col,T);if(!N.isLeaf)if(N.hasChildren)for(T/=2,R=0;R<N.children.length;R++){const k=N.children[R];null==k?Q.addMissing(N.level+1,(N.row<<1)+((R&2)>>1),(N.col<<1)+(R&1),T):this._collectMissingTilesRecurse(k,Q,T,y)}else R||Q.addMissing(N.level,N.row,N.col,T)}_referenceFeature(N){const Q=(this._refCounts.get(N)||0)+1;this._refCounts.set(N,Q);return 1===
Q?C.ADDED:C.UNCHANGED}_unreferenceFeature(N){const Q=(this._refCounts.get(N)||0)-1;if(0===Q)return this._refCounts.delete(N),C.REMOVED;0<Q&&this._refCounts.set(N,Q);return C.UNCHANGED}get test(){}};d.__decorate([m.property({constructOnly:!0})],a.FeatureServiceTileStore.prototype,"featureStore",void 0);d.__decorate([m.property()],a.FeatureServiceTileStore.prototype,"tileInfo",void 0);d.__decorate([m.property()],a.FeatureServiceTileStore.prototype,"extent",void 0);d.__decorate([m.property()],a.FeatureServiceTileStore.prototype,
"maximumByteSize",void 0);a.FeatureServiceTileStore=d.__decorate([x.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],a.FeatureServiceTileStore);class H{constructor(N,Q,T,y){this.data=N;this.objectIds=Q;this.byteSize=T;this.attributeKeys=y}}class g{constructor(N,Q,T){this.level=N;this.row=Q;this.col=T;this.isLeaf=!1;this.extent=null;this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(null!=this.children[0]||null!=this.children[1]||
null!=this.children[2]||null!=this.children[3])}}class I{constructor(N,Q=[]){this.missingTiles=Q;this.coveredArea=this.fullArea=0;this.coveredArea=this.fullArea=B.area(N.extent)}prepend(N){this.missingTiles=N.missingTiles.concat(this.missingTiles);this.coveredArea+=N.coveredArea;this.fullArea+=N.fullArea}}class E{constructor(N,Q,T){this._tileInfo=N;this._extent=null;this.info=new I(Q);null!=T&&(this._extent=B.fromExtent(T))}addMissing(N,Q,T,y){N=new F.TileKey(null,N,Q,T);this._tileInfo.updateTileInfo(N,
A.ExtrapolateOptions.POWER_OF_TWO);null==N.extent||null!=this._extent&&!B.intersects(this._extent,N.extent)||(this.info.missingTiles.push({data:N,resolution:y}),this.info.coveredArea-=B.area(N.extent))}}var C;(function(N){N[N.ADDED=0]="ADDED";N[N.REMOVED=1]="REMOVED";N[N.UNCHANGED=2]="UNCHANGED"})(C||={});a.ProcessResult=I;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var d=a.ByteSizeUnit||(a.ByteSizeUnit=
{});d[d.KILOBYTES=1024]="KILOBYTES";d[d.MEGABYTES=1048576]="MEGABYTES";d[d.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileCache":function(){define(["exports"],function(a){class d{constructor(){this._store=new Map;this._byteSize=0}set(n,z){this.delete(n);this._store.set(n,z);this._byteSize+=z.byteSize}delete(n){const z=this._store.get(n);return this._store.delete(n)?
(null!=z&&(this._byteSize-=z.byteSize),!0):!1}get(n){this._used(n);return this._store.get(n)}has(n){this._used(n);return this._store.has(n)}clear(){this._store.clear()}applyByteSizeLimit(n,z){for(const [r,G]of this._store){if(this._byteSize<=n)break;this.delete(r);z(G)}}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}_used(n){const z=this._store.get(n);z&&(this._store.delete(n),this._store.set(n,z))}}a.FeatureServiceTileCache=d;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Evented ../../../../../core/promiseUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/SpatialReference ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/TileInfo ../../../../../rest/support/Query ../../../../../symbols/support/ElevationInfo ../snappingCandidateElevationAlignment ../snappingCandidateElevationFilter ../symbologySnappingCandidates ./FeatureServiceTiledFetcher ./FeatureServiceTileStore ../../../../../geometry/support/jsonUtils".split(" "),function(a,
d,n,z,r,G,b,m,f,v,x,B,D,p,A,F,q,c,l,H,g,I,E){d=class extends n.EventedAccessor{constructor(){super(...arguments);this._isInitializing=!0;this.remoteClient=null;this._whenSetup=z.createResolver();this._elevationAligner=c.getSnappingCandidateElevationAligner();this._elevationFilter=l.getSnappingCandidateElevationFilter();this._symbologyCandidatesFetcher=H.getSymbologySnappingCandidatesFetcher();this._updatingHandles=new x.UpdatingHandles;this._alignPointsInFeatures=async(N,Q)=>{N=await this.remoteClient.invoke("alignElevation",
{query:N},{signal:Q});z.throwIfAborted(Q);return N};this._getSymbologyCandidates=async(N,Q)=>{N={candidates:N,spatialReference:this._spatialReference.toJSON()};N=await this.remoteClient.invoke("getSymbologyCandidates",N,{signal:Q});z.throwIfAborted(Q);return N}}get updating(){return this._isInitializing||this._updatingHandles.updating||this._featureFetcher.updating}destroy(){this._featureFetcher?.destroy();this._queryEngine?.destroy();this._featureStore?.clear()}async setup(N){if(this.destroyed)return{result:{}};
const {geometryType:Q,objectIdField:T,timeInfo:y,fieldsIndex:R}=N.serviceInfo;var {hasZ:k}=N;const h=B.fromJSON(N.spatialReference);this._spatialReference=h;this._featureStore=new D({...N.serviceInfo,hasZ:k,hasM:!1});this._queryEngine=new p.QueryEngine({spatialReference:N.spatialReference,featureStore:this._featureStore,geometryType:Q,fieldsIndex:R,hasZ:k,hasM:!1,objectIdField:T,timeInfo:y});this._featureFetcher=new g.FeatureServiceTiledFetcher({store:new I.FeatureServiceTileStore({featureStore:this._featureStore}),
url:N.serviceInfo.url,objectIdField:N.serviceInfo.objectIdField,globalIdField:N.serviceInfo.globalIdField,capabilities:N.serviceInfo.capabilities,spatialReference:h,sourceSpatialReference:B.fromJSON(N.serviceInfo.spatialReference),customParameters:N.configuration.customParameters});k="3d"===N.configuration.viewType;this._elevationAligner=c.getSnappingCandidateElevationAligner(k,{elevationInfo:null!=N.elevationInfo?q.fromJSON(N.elevationInfo):null,alignPointsInFeatures:this._alignPointsInFeatures});
this._elevationFilter=l.getSnappingCandidateElevationFilter(k);this.addHandles([r.watch(()=>this._featureFetcher.availability,t=>this.emit("notify-availability",{availability:t}),r.sync),r.watch(()=>this.updating,()=>this._notifyUpdating())]);this._whenSetup.resolve();this._isInitializing=!1;return this.configure(N.configuration)}async configure(N){await this._updatingHandles.addPromise(this._whenSetup.promise);this._updateFeatureFetcherConfiguration(N);return C}async setSuspended(N,Q){await this._updatingHandles.addPromise(this._whenSetup.promise);
z.throwIfAborted(Q);this._featureFetcher.suspended=N;return C}async updateOutFields(N,Q){await this._updatingHandles.addPromise(this._whenSetup.promise);z.throwIfAborted(Q);this._featureFetcher.outFields=new Set(N??[]);return C}async fetchCandidates(N,Q){await this._whenSetup.promise;z.throwIfAborted(Q);if(N.filter){var {distance:T,units:y,spatialRel:R,where:k,timeExtent:h,objectIds:t}=N.filter;var J={geometry:N.filter.geometry?E.fromJSON(N.filter.geometry):void 0,distance:T,units:y,spatialRel:R,
timeExtent:h,objectIds:t,where:k??"1\x3d1"};J={...N,query:J}}else J={...N,query:{where:"1\x3d1"}};Q=Q?.signal;var U=await this._queryEngine.executeQueryForSnapping(J,Q);z.throwIfAborted(Q);N=await this._elevationAligner.alignCandidates(U.candidates,B.fromJSON(N.point.spatialReference)??B.WGS84,Q);z.throwIfAborted(Q);U=await this._symbologyCandidatesFetcher.fetch(N,Q);z.throwIfAborted(Q);N=0===U.length?N:N.concat(U);return{result:{candidates:this._elevationFilter.filter(J,N)}}}async updateTiles(N,
Q){await this._updatingHandles.addPromise(this._whenSetup.promise);z.throwIfAborted(Q);this._featureFetcher.tileSize=N.tileSize;this._featureFetcher.tilesOfInterest=N.tiles;this._featureFetcher.tileInfo=null!=N.tileInfo?A.fromJSON(N.tileInfo):null;return C}async refresh(N,Q){await this._updatingHandles.addPromise(this._whenSetup.promise);z.throwIfAborted(Q);this._featureFetcher.refresh();return C}async whenNotUpdating(N,Q){await this._updatingHandles.addPromise(this._whenSetup.promise);z.throwIfAborted(Q);
await r.whenOnce(()=>!this.updating,Q);z.throwIfAborted(Q);return C}async getDebugInfo(N,Q){z.throwIfAborted(Q);return{result:this._featureFetcher.debugInfo}}async handleEdits(N,Q){await this._updatingHandles.addPromise(this._whenSetup.promise);z.throwIfAborted(Q);await this._updatingHandles.addPromise(this._featureFetcher.handleEdits(N));z.throwIfAborted(Q);return C}async setHistoricMoment(N,Q){this._featureFetcher.setHistoricMoment(N.moment);return C}async notifyElevationSourceChange(N,Q){this._elevationAligner.notifyElevationSourceChange();
return C}async notifySymbologyChange(N,Q){this._symbologyCandidatesFetcher.notifySymbologyChange();return C}async setSymbologySnappingSupported(N){this._symbologyCandidatesFetcher=H.getSymbologySnappingCandidatesFetcher(N,this._getSymbologyCandidates);return C}_updateFeatureFetcherConfiguration(N){this._featureFetcher.filter=null!=N.filter?F.fromJSON(N.filter):null;this._featureFetcher.customParameters=N.customParameters}_notifyUpdating(){this.emit("notify-updating",{updating:this.updating})}};a.__decorate([G.property({readOnly:!0})],
d.prototype,"updating",null);a.__decorate([G.property()],d.prototype,"_isInitializing",void 0);d=a.__decorate([v.subclass("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],d);const C={result:{}};return d});