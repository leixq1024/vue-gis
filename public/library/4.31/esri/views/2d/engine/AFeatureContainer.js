// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports","./webgl/AttributeStoreView","./webgl/definitions","./webgl/TileContainer"],function(f,g,h,k){class l extends k{constructor(a){super(a);this._statisticsByLevel=new Map;this._entityIndex=new Map;this.attributeView=new g.AttributeStoreView}destroy(){this.children.forEach(a=>a.destroy());this.removeAllChildren();this.attributeView.destroy()}doRender(a){a.context.capabilities.enable("textureFloatLinear");super.doRender(a)}get hasAnimations(){for(const a of this.children)if(a.hasAnimations)return!0;
return!1}_reindexAndUpdateFeaturesIfNeeded(){if(this.hasAnimations&&(this._reindexFeatures(),0!==this.attributeView.size))for(const a of this._entityIndex.values())a.dirty&&(this.attributeView.setData(a.displayId,h.AttributeDataType.LocalTimeOrigin,0,a.firstIndexed),a.dirty=!1)}restartAnimation(a){if(a=this._entityIndex.get(a)){var b=performance.now()/1E3;a.firstIndexed=b;a.dirty=!0}}restartAllAnimations(){const a=performance.now()/1E3;for(const [,b]of this._entityIndex)b.firstIndexed=a,b.dirty=!0}_reindexFeatures(){const a=
performance.now()/1E3;for(const b of this.children)for(const d of b.entityIds){const {objectId:e}=d;let c=this._entityIndex.get(e);c||(c={objectId:e,displayId:0,firstIndexed:a,lastIndexed:0,dirty:!0},this._entityIndex.set(e,c));c.lastIndexed=a;c.displayId=d.displayId}for(const [b,d]of this._entityIndex)60<a-d.lastIndexed&&this._entityIndex.delete(b)}_updateAttributeView(){this.attributeView.update();this._reindexAndUpdateFeaturesIfNeeded()}createRenderParams(a){a=super.createRenderParams(a);a.attributeView=
this.attributeView;a.instanceStore=this._instanceStore;a.statisticsByLevel=this._statisticsByLevel;return a}}f.AFeatureContainer=l;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});