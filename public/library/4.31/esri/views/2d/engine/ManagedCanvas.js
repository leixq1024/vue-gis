// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Evented ../../../core/events ../../../core/handleUtils ../../../core/has ../../../core/mathUtils ../../../core/libs/gl-matrix-2/math/mat2d ../../../core/libs/gl-matrix-2/factories/mat2df64".split(" "),function(l,p,q,r,m,t,k,u){class v{constructor(b){this.events=new p;this._hasMajorPerformanceCaveat=!1;this._lastRenderFrameCounter=0;this._canvas=document.createElement("canvas");this._canvas.setAttribute("style","width: 100%; height:100%; display:block; willChange:transform");
const a={failIfMajorPerformanceCaveat:!0,alpha:!0,antialias:!1,depth:!0,stencil:!0,powerPreference:"high-performance"};b.appendChild(this._canvas);b=this._canvas.getContext("webgl2",a);b||(b=this._canvas.getContext("webgl2",{...a,failIfMajorPerformanceCaveat:!1}),this._hasMajorPerformanceCaveat=!0);this._gl=b;this._handles=r.handlesGroup([q.on(this._canvas,"webglcontextlost",c=>this.events.emit("webgl-context-lost",c))])}destroy(){this._canvas.parentNode?.removeChild(this._canvas);this._canvas=null;
this._handles.remove();this._gl=null}get gl(){return this._gl}render(b,a){if(this._hasMajorPerformanceCaveat||m("esri-force-performance-mode")){if(++this._lastRenderFrameCounter>=m("esri-performance-mode-frames-between-render")&&(a(),this._lastRenderViewState=b.state.clone(),this._lastRenderFrameCounter=0),this._lastRenderViewState){const [c,d,e,f,g,h]=this._computeViewTransform(this._lastRenderViewState,b.state);this._canvas.style.transform=`matrix(${c}, ${d}, ${e}, ${f}, ${g}, ${h})`}}else a()}resize(b){const a=
this._canvas,c=a.style,{state:{size:d},pixelRatio:e}=b;b=d[0];const f=d[1],g=Math.round(b*e),h=Math.round(f*e);if(a.width!==g||a.height!==h)a.width=g,a.height=h;c.width=b+"px";c.height=f+"px"}_computeViewTransform(b,a){const [c,d]=b.center,[e,f]=a.center,[g,h]=b.toScreen([0,0],e,f),[w,x]=b.toScreen([0,0],c,d),y=w-g,z=x-h,n=b.scale/a.scale;b=a.rotation-b.rotation;a=u.create();k.identity(a);k.scale(a,a,[n,n]);k.rotate(a,a,t.deg2rad(b));k.translate(a,a,[y,z]);return a}}l.ManagedCanvas=v;Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})});