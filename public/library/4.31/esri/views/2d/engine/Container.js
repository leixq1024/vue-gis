// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../core/accessorSupport/tracking ../../../core/accessorSupport/tracking/SimpleObservable ../../../core/libs/gl-matrix-2/factories/mat3f32 ../../../layers/effects/EffectView ./DisplayObject".split(" "),function(d,e,f,g,h,k){class l extends k.DisplayObject{constructor(){super(...arguments);this._childrenSet=new Set;this._needsSort=!1;this._children=[];this._childrenObservable=new f.SimpleObservable;this._highlightGradient=this._effectView=null}get blendMode(){return this._blendMode}set blendMode(a){this._blendMode=
a;this.requestRender()}get children(){e.trackAccess(this._childrenObservable);return this._children}get clips(){return this._clips}set clips(a){this._clips=a;this.children.forEach(b=>b.clips=a)}get computedEffects(){return this._effectView?.effects??null}get effect(){return this._effectView?.effect??""}set effect(a){if(this._effectView||a)this._effectView||(this._effectView=new h.EffectView,this.addTransitionable(this._effectView)),this._effectView.effect=a,this.requestRender()}get highlightGradient(){return this._highlightGradient}set highlightGradient(a){this._highlightGradient=
a;this.requestRender()}get hasBlending(){return!!this.blendMode}get hasHighlight(){return this.children.some(a=>a.hasHighlight)}get hasLabels(){return this.children.some(a=>a.hasLabels)}get requiresDedicatedFBO(){return this.children.some(a=>"blendMode"in a&&a.blendMode&&"normal"!==a.blendMode)}get isReady(){return this.children.every(a=>a.isReady)}get sortFunction(){return this._sortFunction}set sortFunction(a){if(this._sortFunction=a)this._needsSort=!0}doRender(a){a=this.createRenderParams(a);const {painter:b}=
a;b.beforeRenderLayer(a,this._clips?.length?255:0,this.computedOpacity);this.renderChildren(a);b.afterRenderLayer(a,this.computedOpacity)}addChild(a){return this.addChildAt(a,this.children.length)}addChildAt(a,b=this.children.length){if(!a||this.contains(a))return a;this._needsSort=!0;const c=a.parent;c&&c!==this&&c.removeChild(a);b>=this.children.length?this.children.push(a):this.children.splice(b,0,a);this._childrenSet.add(a);a.parent=this;a.stage=this.stage;this!==this.stage&&(a.clips=this.clips);
this.requestRender();this._childrenObservable.notify();return a}contains(a){e.trackAccess(this._childrenObservable);return this._childrenSet.has(a)}removeAllChildren(){this._childrenSet.clear();this._needsSort=!0;for(const a of this.children)this!==this.stage&&(a.clips=null),a.stage=null,a.parent=null;this.children.length=0;this._childrenObservable.notify()}removeChild(a){return this.contains(a)?this.removeChildAt(this.children.indexOf(a)):a}removeChildAt(a){if(0>a||a>=this.children.length)return null;
this._needsSort=!0;a=this.children.splice(a,1)[0];this._childrenSet.delete(a);this!==this.stage&&(a.clips=null);a.stage=null;a.parent=null;this._childrenObservable.notify();return a}beforeRender(a){super.beforeRender(a);this.sortFunction&&this._needsSort&&(this.children.sort(this.sortFunction),this._needsSort=!1,this._childrenObservable.notify());for(const b of this.children)b.beforeRender(a)}afterRender(a){super.afterRender(a);for(const b of this.children)b.afterRender(a)}_createTransforms(){return{displayViewScreenMat3:g.create()}}onAttach(){super.onAttach();
const a=this.stage;for(const b of this.children)b.stage=a}onDetach(){super.onDetach();for(const a of this.children)a.stage=null}renderChildren(a){for(const b of this.children)b.processRender(a)}createRenderParams(a){return{...a,requireFBO:this.requiresDedicatedFBO,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:a.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||a.highlightGradient}}isTransitioning(){return super.isTransitioning()||
this.children.some(a=>a.transitioning)}}d.Container=l;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});