// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../chunks/tslib.es6","../../GraphShaderModule","../../graph/glsl","./constants"],function(k,e,b,a,m){function n(c){const d=c.multiply(new a.Vec2(2)).subtract(1);return a.ifElse(a.equal(d.x,new a.Float(0)).and(a.equal(d.y,new a.Float(0))),new a.Vec2(.5),()=>{var f=a.atan(d.y,d.x);const p=a.pow(a.length(d),new a.Float(m.magnifierBarrelFactor));f=new a.Vec2(a.cos(f),a.sin(f));return p.multiply(f).multiply(new a.Vec2(.5)).add(new a.Float(.5))})}class l extends b.VertexInput{}
e.__decorate([b.location(0,a.Vec2)],l.prototype,"position",void 0);class q extends b.FragmentInput{}class g extends b.UniformGroup{}e.__decorate([b.uniform(a.Sampler2D)],g.prototype,"readbackTexture",void 0);e.__decorate([b.uniform(a.Sampler2D)],g.prototype,"maskTexture",void 0);e.__decorate([b.uniform(a.Sampler2D)],g.prototype,"overlayTexture",void 0);e.__decorate([b.uniform(a.Vec4)],g.prototype,"background",void 0);e.__decorate([b.uniform(a.Vec4)],g.prototype,"drawPos",void 0);e.__decorate([b.uniform(a.Float)],
g.prototype,"maskEnabled",void 0);e.__decorate([b.uniform(a.Float)],g.prototype,"overlayEnabled",void 0);class h extends b.GraphShaderModule{vertex(c){const d=c.position;c=c.position.subtract(new a.Vec2(.5)).multiply(this.config.drawPos.zw);c=this.config.drawPos.xy.add(c);return{glPosition:new a.Vec4(c,0,1),texCoord:d}}fragment(c){let d=a.texture2D(this.config.readbackTexture,n(c.texCoord));d=d.add((new a.Float(1)).subtract(d.a)).multiply(this.config.background);var f=a.ifElse(a.equal(this.config.maskEnabled,
new a.Float(1)),a.texture2D(this.config.maskTexture,c.texCoord).a,new a.Float(1));d=d.multiply(f);c=a.ifElse(a.equal(this.config.overlayEnabled,new a.Float(1)),a.texture2D(this.config.overlayTexture,c.texCoord),new a.Vec4(0));f=new b.FragmentOutput;f.glFragColor=c.add((new a.Float(1)).subtract(c.a).multiply(d));return f}}e.__decorate([b.uniform(g)],h.prototype,"config",void 0);e.__decorate([e.__param(0,b.input(l))],h.prototype,"vertex",null);e.__decorate([e.__param(0,b.input(q))],h.prototype,"fragment",
null);k.MagnifierShader=h;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});