// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/unitUtils","../../definitions","../../enums","../../../../../webgl/enums"],function(e,r,g,m,h){function n({pixelRatio:a,state:b,displayLevel:d,requiredLevel:f},c){return{displayMat3:b.displayMat3,displayViewMat3:b.displayViewMat3,displayViewScreenMat3:c.transforms.displayViewScreenMat3,viewMat3:b.viewMat3,tileMat3:c.transforms.tileMat3,displayZoomFactor:1/2**(d-c.key.level),requiredZoomFactor:1/2**(f-c.key.level),tileOffset:[c.x,c.y],currentScale:b.scale,
currentZoom:d,metersPerSRUnit:r.getMetersPerUnitForSR(b.spatialReference),rotation:b.rotation,pixelRatio:a}}function k(a){return"highlight"===a.passOptions?.type}function l(a){return"hittest"===a.passOptions?.type}const p={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:a=>a.stencilRef,compare:h.CompareFunction.EQUAL,mask:255,op:{fail:h.StencilOperation.KEEP,zFail:h.StencilOperation.KEEP,zPass:h.StencilOperation.REPLACE}}}},t={color:{write:[!0,!0,!0,!0],blendMode:"additive"},
depth:!1,stencil:!1},u={...p,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};e.getFeaturePipelineState=function(a){return l(a)?t:k(a)&&"clear"===a.passOptions.stepType?u:p};e.getFeatureUniforms=function(a,b){const {attributeView:d,context:f}=a;var c=d.getUniforms(f);b=n(a,b);if(l(a)){var {position:v,distance:w,smallSymbolDistance:x,smallSymbolSizeThreshold:y}=a.passOptions;var q={position:v,distance:w,smallSymbolDistance:x,smallSymbolSizeThreshold:y}}else q=null;if(k(a)){var {activeReasons:z,highlightAll:A}=
a.passOptions;a={activeReasons:z,highlightAll:A?1:0}}else a=null;return{storage:c,view:b,hittestRequest:q,highlight:a}};e.getLocalTileOffset=function(a){const {row:b,col:d}=a.key;a=d*g.tileSize;const f=b*g.tileSize;return{tileOffsetFromLocalOrigin:[a%g.maxRepresentableInt,f%g.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(a/g.maxRepresentableInt),Math.floor(f/g.maxRepresentableInt)]}};e.getSelectionDefines=function(a){return{inside:a.selection===m.FeatureSelection.InsideEffect,outside:a.selection===
m.FeatureSelection.OutsideEffect}};e.getViewUniforms=n;e.isHighlight=k;e.isHittest=l;e.resolveDynamicUniforms=function(a,b,d){const f={};for(const c in d)f[c]=d[c]instanceof Function?d[c](a,b):d[c];return f};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});