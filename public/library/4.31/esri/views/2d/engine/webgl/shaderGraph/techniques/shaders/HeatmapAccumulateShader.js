// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../../chunks/tslib.es6 ../../GraphShaderModule ../../graph/glsl ./AFeatureShader ./heatmapUtils ./hittestUtils".split(" "),function(l,d,e,a,m,r,t){class n extends m.FeatureVertexInput{}d.__decorate([e.location(5,a.Vec2)],n.prototype,"offset",void 0);class q extends m.FeatureFragmentInput{}class p extends e.UniformGroup{}d.__decorate([e.uniform(a.Float)],p.prototype,"radius",void 0);d.__decorate([e.uniform(a.Float)],p.prototype,"isFieldActive",void 0);class g extends m.AFeatureShader{constructor(){super(...arguments);
this.usesHalfFloatPrecision=!1}vertex(b){const {radius:h,isFieldActive:f}=this.kernelControls,c=b.offset,k=f.multiply(this.storage.getVVData(b.id).x).add((new a.Float(1)).subtract(f)),u=this.view.displayViewScreenMat3.multiply(new a.Vec3(b.pos,1)).add(this.view.displayViewMat3.multiply(new a.Vec3(c,0)).multiply(h)),v=this.clip(b.id);return{glPosition:new a.Vec4(u.xy,v,1),offset:c,fieldValue:k,color:new a.Vec4(0),...this.maybeRunHittest(b,{},null)}}fragment(b){const {offset:h,fieldValue:f}=b;var c=
a.length(h),k=a.step(c,new a.Float(1));c=(new a.Float(1)).subtract(c.multiply(c));c=c.multiply(c);k=k.multiply(c).multiply(f).multiply(new a.Float(r.getHeatmapCompressionFactor(this.usesHalfFloatPrecision)));return this.getFragmentOutput(new a.Vec4(k),b)}hittest(b){const {viewMat3:h,tileMat3:f}=this.view;b=h.multiply(f).multiply(new a.Vec3(b.pos,1));return t.hittestMarker(b.xy,this.kernelControls.radius,this.hittestRequest.position)}}d.__decorate([e.define],g.prototype,"usesHalfFloatPrecision",void 0);
d.__decorate([e.uniform(p)],g.prototype,"kernelControls",void 0);d.__decorate([d.__param(0,e.input(n))],g.prototype,"vertex",null);d.__decorate([d.__param(0,e.input(q))],g.prototype,"fragment",null);l.HeatmapAccumulateFragmentInput=q;l.HeatmapAccumulateShader=g;l.HeatmapAccumulateVertexInput=n;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});