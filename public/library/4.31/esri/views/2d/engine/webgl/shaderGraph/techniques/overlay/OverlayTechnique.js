// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../../core/maybe ../../../meshing/Mesh ../../utils ../Technique ../TechniqueType ../shaders/OverlayShader ../../../../../../webgl/enums".split(" "),function(e,k,l,f,m,n,p,c){class q extends m.Technique{constructor(){super(...arguments);this.type=n.TechniqueType.Overlay;this._mesh=null;this.shaders={overlay:new p.OverlayShader}}render(b,a){const {context:g,painter:d}=b;b=this._getMesh(b,a);d.setPipelineState(f.simplePipelineState);const {isWrapAround:r,wrapAroundShift:t}=
a.config,h={...a.config,wrapAroundShift:0};a={shader:this.shaders.overlay,uniforms:{transform:a.transform,config:h},defines:null,optionalAttributes:null,useComputeBuffer:!1};d.setPipelineState({...f.simplePipelineState,stencil:{write:!1,test:{compare:c.CompareFunction.EQUAL,op:{fail:c.StencilOperation.KEEP,zFail:c.StencilOperation.KEEP,zPass:c.StencilOperation.REPLACE},ref:0,mask:255}}});d.submitDrawMeshUntyped(g,a,b);r&&(h.wrapAroundShift=t,d.submitDrawMeshUntyped(g,a,b))}shutdown(){k.destroyMaybe(this._mesh)}_getMesh(b,
a){({context:b}=b);if(this._mesh){b=this._mesh.vertexBuffers.get("positions");if(!b)throw Error("Buffer not found");b.setData(a.position)}else this._mesh=new l.Mesh(b,{vertex:{positions:a.position,uvs:a.tex},index:null!=a.index?{index:a.index}:void 0,groups:[{attributes:[{name:"pos",count:2,type:c.DataType.FLOAT,location:0,vertex:"positions",stride:8,offset:0},{name:"tex",count:2,type:c.DataType.UNSIGNED_SHORT,location:1,vertex:"uvs",stride:4,offset:0}],index:null!=a.index?"index":void 0,primitive:c.PrimitiveType.TRIANGLE_STRIP}],
parts:[{group:0,start:0,count:null!=a.index?a.index.length:a.position.length/2}]});return this._mesh}}e.OverlayTechnique=q;Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});