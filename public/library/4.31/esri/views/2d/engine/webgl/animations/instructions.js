// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports"],function(c){function f(a){return[`float duration = clamp(${a.duration}, 0.05, 3600.0);`,`float startTimeOffset = ${a.startTimeOffset};`,`float repeatDelay = ${a.repeatDelay};`,`float timeOriginSelector = ${a.timeOriginSelector};`,`float repeatType = ${a.repeatType};`,`float easing = ${a.easing};`,`float playAnimation = ${a.playAnimation} * (1.0 - step(0.0, -${a.duration}));`,`float reverseAnimation = ${a.reverseAnimation};`,"float time \x3d globalTime - (timeOriginSelector \x3d\x3d 1.0 ? localTimeOrigin : 0.0);",
"time *\x3d playAnimation;","time *\x3d 1.0 - reverseAnimation * 2.0;","float period \x3d duration + repeatDelay;","time +\x3d reverseAnimation \x3d\x3d 1.0 ? (period - startTimeOffset - 0.001) : startTimeOffset + 0.001;","float omega \x3d time / period;","float oi \x3d floor(omega);","omega \x3d repeatType \x3d\x3d 1.0 || repeatType \x3d\x3d 3.0 ? omega - oi : omega;","float of \x3d omega * period;","of \x3d (clamp(of, reverseAnimation * repeatDelay, period - (1.0 - reverseAnimation) * repeatDelay) - reverseAnimation * repeatDelay) / duration;",
"of \x3d easing \x3d\x3d 2.0 ? pow(of, 3.0) : of;","of \x3d easing \x3d\x3d 3.0 ? 1.0 - pow(1.0 - of, 3.0) : of;","of \x3d easing \x3d\x3d 4.0 ? of \x3c 0.5 ? 4.0 * pow(of, 3.0) : 1.0 - pow(-2.0 * of + 2.0, 3.0) / 2.0 : of;","bool oscillate \x3d repeatType \x3d\x3d 3.0 \x26\x26 mod(oi, 2.0) \x3d\x3d 1.0;",`${a.out} = oscillate ? 1.0 - of : of;`]}function k(a){return[[a.duration,a.startTimeOffset,a.repeatDelay,m[a.timeOriginSelector]],[n[a.repeatType],p[a.easing],a.playAnimation,a.reverseAnimation]]}
function q(a){const b=[];b.push(`float globalTime = ${a.globalTime};`);b.push(`float localTimeOrigin = ${a.localTimeOrigin};`);b.push(`vec2 pointer = ${a.animationPointer};`);b.push(`vec2 size = ${a.animationTextureSize};`);b.push("int top \x3d 0;");b.push("vec4 stack[4];");b.push("for (int counter \x3d 0; counter \x3c 40; counter++) {");b.push(`vec4 atom0 = texture(${a.animationTexture}, (pointer + 0.5) / size);`);b.push("pointer.x +\x3d 1.0;");b.push(`vec2 pixelDimensions = ${a.pixelDimensions};`);
b.push("if (false) {");for(const d in l){const g=l[d];b.push(`} else if (int(atom0.x) == ${g.opcode}) {`);for(const y of g.generateSource(a))b.push(y)}b.push("} // End if-else.");b.push("} // End for.");b.push(`${a.out} = top > 0 ? stack[top - 1] : vec4(0.0);`);return b.join("\n")}c.TimeOrigin=void 0;(function(a){a.Local="Local";a.Global="Global"})(c.TimeOrigin||(c.TimeOrigin={}));class e{generateSource(a){const b=[];for(let g=1;g<this.length;g++)b.push(`vec4 atom${g} = texture(${a.animationTexture}, (pointer + 0.5) / size);`),
b.push("pointer.x +\x3d 1.0;");for(a=0;a<this.ins;a++)b.push("top--;"),b.push(`vec4 in${this.ins-a-1} = stack[top];`);for(a=0;a<this.outs;a++)b.push(`vec4 out${a};`);({microcode:a}=this);for(var d of a)b.push(d);for(d=0;d<this.outs;d++)b.push(`stack[top] = out${d};`),b.push("top++;"),b.push("if (top \x3e\x3d 4) { top \x3d 3; }");return b}}let h=128;class r extends e{constructor(){super(...arguments);this.opcode=++h;this.length=1;this.outs=this.ins=0;this.microcode=["break;"]}encode(){return[[this.opcode,
0,0,0]]}}class t extends e{constructor(){super(...arguments);this.opcode=++h;this.length=1;this.ins=0;this.outs=1;this.microcode=["out0 \x3d vec4(atom0.y, atom0.y, atom0.y, atom0.y);"]}encode(a){return[[this.opcode,a,0,0]]}}class u extends e{constructor(){super(...arguments);this.opcode=++h;this.length=1;this.ins=0;this.outs=1;this.microcode=["out0 \x3d vec4(atom0.yzw, 0.0);"]}encode(a){return[[this.opcode,a[0]||0,a[1]||0,a[2]||0]]}}class v extends e{constructor(){super(...arguments);this.opcode=
++h;this.length=2;this.ins=0;this.outs=1;this.microcode=["out0 \x3d atom1;"]}encode(a){return[[this.opcode,0,0,0],a]}}const p={Linear:1,EaseIn:2,EaseOut:3,EaseInOut:4},n={Loop:1,None:2,Oscillate:3},m={Local:1,Global:2};class w extends e{constructor(){super(...arguments);this.opcode=++h;this.length=10;this.outs=this.ins=1;this.microcode=["vec2 fromTranslation \x3d atom1.xy;","vec2 toTranslation \x3d atom1.zw;","float fromRotation \x3d atom2.x;","float toRotation \x3d atom2.y;","float fromScale \x3d atom2.z;",
"float toScale \x3d atom2.w;","bool relativeTranslation \x3d atom9.x \x3d\x3d 1.0;","bool absoluteScale \x3d atom9.y \x3d\x3d 1.0;","vec2 translationMultiplier \x3d relativeTranslation ? pixelDimensions : vec2(1.0, 1.0);","float scaleDivisor \x3d absoluteScale ? pixelDimensions.y : 1.0;","float fTranslation;","{",...f({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",
out:"fTranslation"}),"}","float fRotation;","{",...f({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fRotation"}),"}","float fScale;","{",...f({duration:"atom7.x",startTimeOffset:"atom7.y",repeatDelay:"atom7.z",timeOriginSelector:"atom7.w",repeatType:"atom8.x",easing:"atom8.y",playAnimation:"atom8.z",reverseAnimation:"atom8.w",out:"fScale"}),"}","vec2 aTranslation \x3d mix(fromTranslation, toTranslation, fTranslation);",
"float aRotation \x3d mix(fromRotation, toRotation, fRotation);","float aScale \x3d mix(fromScale, toScale, fScale);","vec2 pTranslation \x3d in0.xy;","float pRotation \x3d in0.z;","float pScale \x3d in0.w;","aTranslation *\x3d translationMultiplier;","aScale /\x3d scaleDivisor;","float rotation \x3d pRotation + aRotation;","float scale \x3d pScale * aScale;","float sin1 \x3d sin(pRotation);","float cos1 \x3d cos(pRotation);","float s1 \x3d pScale;","float x1 \x3d pTranslation.x;","float y1 \x3d pTranslation.y;",
"float x2 \x3d aTranslation.x;","float y2 \x3d aTranslation.y;","\n    vec2 translation \x3d vec2(\n      cos1 * s1 * x2 - sin1 * s1 * y2 + x1,\n      sin1 * s1 * x2 + cos1 * s1 * y2 + y1\n    );\n    ","out0 \x3d vec4(translation, rotation, scale);"]}encode(a){return[[this.opcode,0,0,0],[a.translation.from[0],a.translation.from[1],a.translation.to[0],a.translation.to[1]],[a.rotation.from,a.rotation.to,a.scale.from,a.scale.to],...k(a.translation.timing),...k(a.rotation.timing),...k(a.scale.timing),
[a.relativeTranslation?1:0,a.absoluteScale?1:0,0,0]]}}class x extends e{constructor(){super(...arguments);this.opcode=++h;this.length=7;this.outs=this.ins=1;this.microcode=["float fromOpacity \x3d atom0.y;","float toOpacity \x3d atom0.z;","vec4 fromColor \x3d atom1;","vec4 toColor \x3d atom2;","float fColor;","{",...f({duration:"atom3.x",startTimeOffset:"atom3.y",repeatDelay:"atom3.z",timeOriginSelector:"atom3.w",repeatType:"atom4.x",easing:"atom4.y",playAnimation:"atom4.z",reverseAnimation:"atom4.w",
out:"fColor"}),"}","float fOpacity;","{",...f({duration:"atom5.x",startTimeOffset:"atom5.y",repeatDelay:"atom5.z",timeOriginSelector:"atom5.w",repeatType:"atom6.x",easing:"atom6.y",playAnimation:"atom6.z",reverseAnimation:"atom6.w",out:"fOpacity"}),"}","vec4 aColor \x3d mix(fromColor, toColor, fColor);","aColor.a *\x3d mix(fromOpacity, toOpacity, fOpacity);","vec4 pColor \x3d in0;","out0 \x3d aColor * pColor;"]}encode(a){return[[this.opcode,a.opacity.from,a.opacity.to,0],[a.color.from[0],a.color.from[1],
a.color.from[2],a.color.from[3]],[a.color.to[0],a.color.to[1],a.color.to[2],a.color.to[3]],...k(a.color.timing),...k(a.opacity.timing)]}}const l={scalar:new t,vector3:new u,vector4:new v,animatedTransform:new w,animatedColor:new x,ret:new r};c.AAnimationInstruction=e;c.AnimatedColorInstruction=x;c.AnimatedTransformInstruction=w;c.RetInstruction=r;c.ScalarInstruction=t;c.Vector3Instruction=u;c.Vector4Instruction=v;c.easingCodes=p;c.generateGetValueSource=function(a,b){return`\n    vec4 ${a}(int valueIndex) {\n      vec2 thePointer = ${b.animationPointer};\n      float jump = texture(${b.animationTexture}, (0.5 + vec2(thePointer.x + float(valueIndex), thePointer.y)) / ${b.animationTextureSize}).x;\n      thePointer = vec2(thePointer.x + jump, thePointer.y);\n      vec4 theResult;\n      ${q({...b,
out:"theResult",animationPointer:"thePointer"})}\n      return theResult;\n    }\n  `};c.generateVirtualMachineSource=q;c.getTweenFactor=f;c.instructions=l;c.repeatTypeCodes=n;c.timeOriginSelectorCodes=m;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});