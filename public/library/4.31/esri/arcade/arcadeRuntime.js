// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ./arcadeEnvironment ./ArcadeModule ./ArcadeModuleLoader ./containerUtils ./Dictionary ./executionError ./Feature ./FunctionWrapper ../chunks/languageUtils ./treeAnalysis ../chunks/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../geometry/Geometry ../geometry/SpatialReference".split(" "),function(F,t,J,P,K,B,d,ba,w,f,ca,da,ea,fa,ha,ia,ja,ka,Q,R){function S(a,b){const c=[];for(let e=0;e<b.arguments.length;e++)c.push(l(a,
b.arguments[e]));return c}function v(a,b,c){try{return!0===b.preparsed?c(a,null,b.arguments):c(a,b,S(a,b))}catch(e){throw e;}}function l(a,b){try{switch(b.type){case "AssignmentExpression":if("MemberExpression"===b.left.type){const g=l(a,b.left.object);let k;if(!0===b.left.computed)k=l(a,b.left.property);else if("Identifier"===b.left.property.type)k=b.left.property.name;else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);const n=l(a,b.right);if(f.isArray(g))if(f.isNumber(k)){0>
k&&(k=g.length+k);if(0>k||k>g.length)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.OutOfBounds,b);if(k===g.length&&"\x3d"!==b.operator)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.OutOfBounds,b);g[k]=z(n,b.operator,g[k],b,a)}else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ArrayAccessorMustBeNumber,b);else if(g instanceof B){if(!1===f.isString(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.KeyAccessorMustBeString,b);if(!0===g.hasField(k))g.setField(k,
z(n,b.operator,g.field(k),b,a));else{if("\x3d"!==b.operator)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FieldNotFound,b,{key:k});g.setField(k,z(n,b.operator,null,b,a))}}else if(f.isFeature(g)){if(!1===f.isString(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.KeyAccessorMustBeString,b);if(!0===g.hasField(k))g.setField(k,z(n,b.operator,g.field(k),b,a));else{if("\x3d"!==b.operator)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FieldNotFound,b,{key:k});g.setField(k,
z(n,b.operator,null,b,a))}}else{if(f.isImmutableArray(g))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.Immutable,b);if(g instanceof C){if(!1===f.isString(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ModuleAccessorMustBeString,b);if(!0===g.hasGlobal(k))g.setGlobal(k,z(n,b.operator,g.global(k),b,a));else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ModuleExportNotFound,b);}else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);}var c=
f.voidOperation}else{var e=t.toSymbolId(b.left),h=l(a,b.right);if(null!=a.localScope&&void 0!==a.localScope[e])a.localScope[e]={value:z(h,b.operator,a.localScope[e].value,b,a),valueset:!0,node:b.right},c=f.voidOperation;else if(void 0!==a.globalScope[e])a.globalScope[e]={value:z(h,b.operator,a.globalScope[e].value,b,a),valueset:!0,node:b.right},c=f.voidOperation;else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);}return c;case "UpdateExpression":{if("CallExpression"===
b.argument.type)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NeverReach,b);let g;if("MemberExpression"===b.argument.type){const k=l(a,b.argument.object);let n;if(!0===b.argument.computed)n=l(a,b.argument.property);else if("Identifier"===b.argument.property.type)n=b.argument.property.name;else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.Unrecognized,b);if(f.isArray(k))if(f.isNumber(n)){0>n&&(n=k.length+n);if(0>n||n>=k.length)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.OutOfBounds,
b);g=f.toNumber(k[n]);k[n]="++"===b.operator?g+1:g-1}else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ArrayAccessorMustBeNumber,b);else if(k instanceof B){if(!1===f.isString(n))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.KeyAccessorMustBeString,b);if(!0===k.hasField(n))g=f.toNumber(k.field(n)),k.setField(n,"++"===b.operator?g+1:g-1);else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FieldNotFound,b);}else if(f.isFeature(k)){if(!1===f.isString(n))throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.KeyAccessorMustBeString,b);if(!0===k.hasField(n))g=f.toNumber(k.field(n)),k.setField(n,"++"===b.operator?g+1:g-1);else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FieldNotFound,b);}else{if(f.isImmutableArray(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.Immutable,b);if(k instanceof C){if(!1===f.isString(n))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ModuleAccessorMustBeString,b);if(!0===k.hasGlobal(n))g=f.toNumber(k.global(n)),k.setGlobal(n,
"++"===b.operator?g+1:g-1);else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.ModuleExportNotFound,b);}else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidParameter,b);}var m=!1===b.prefix?g:"++"===b.operator?g+1:g-1}else{var p=t.toSymbolId(b.argument);if(null!=a.localScope&&void 0!==a.localScope[p])g=f.toNumber(a.localScope[p].value),a.localScope[p]={value:"++"===b.operator?g+1:g-1,valueset:!0,node:b},m=!1===b.prefix?g:"++"===b.operator?g+1:g-1;else if(void 0!==a.globalScope[p])g=
f.toNumber(a.globalScope[p].value),a.globalScope[p]={value:"++"===b.operator?g+1:g-1,valueset:!0,node:b},m=!1===b.prefix?g:"++"===b.operator?g+1:g-1;else throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);}}return m;case "TemplateLiteral":var r="",A=0;for(const g of b.quasis)if(r+=g.value?g.value.cooked:"",!1===g.tail){if(b.expressions[A]){var G=f,x=G.toString,T=l(a,b.expressions[A]),D=a,H=b;if(f.isFunctionParameter(T))throw new d.ArcadeExecutionError(D,d.ExecutionErrorCodes.NoFunctionInTemplateLiteral,
H);var y=x.call(G,T)}else y="";r+=y;A++}return r;case "Identifier":return U(a,b);case "MemberExpression":return la(a,b);case "Literal":return b.value;case "CallExpression":a:try{if("MemberExpression"===b.callee.type){const g=l(a,b.callee.object);if(!(g instanceof C))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FunctionNotFound,b);const k=!1===b.callee.computed?b.callee.property.name:l(a,b.callee.property);if(!g.hasGlobal(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FunctionNotFound,
b);const n=g.global(k);if(!f.isFunctionParameter(n))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.CallNonFunction,b);var L=n.call(a,b)}else{if("Identifier"!==b.callee.type)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FunctionNotFound,b);var I=t.toSymbolId(b.callee);if(null!=a.localScope&&void 0!==a.localScope[I]){const g=a.localScope[I];if(f.isFunctionParameter(g.value)){L=g.value.call(a,b);break a}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.CallNonFunction,b);
}if(void 0!==a.globalScope[I]){const g=a.globalScope[I];if(f.isFunctionParameter(g.value)){L=g.value.call(a,b);break a}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.CallNonFunction,b);}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.FunctionNotFound,b);}}catch(g){throw g;}return L;case "UnaryExpression":return ma(a,b);case "BinaryExpression":return na(a,b);case "LogicalExpression":return oa(a,b);case "ArrayExpression":try{y=[];for(x=0;x<b.elements.length;x++){r=l(a,b.elements[x]);
if(f.isFunctionParameter(r))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NoFunctionInArray,b);r===f.voidOperation?y.push(null):y.push(r)}G=y}catch(g){throw g;}return G;case "ObjectExpression":y={};D=new Map;for(x=0;x<b.properties.length;x++){A=b.properties[x];const g="Identifier"===A.key.type?A.key.name:l(a,A.key),k=l(a,A.value);if(f.isFunctionParameter(k))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NoFunctionInDictionary,b);if(!1===f.isString(g))throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.KeyMustBeString,b);let n=g.toString();const M=n.toLowerCase();D.has(M)?n=D.get(M):D.set(M,n);y[n]=k===f.voidOperation?null:k}H=new B(y);H.immutable=!1;return H;default:throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.Unrecognized,b);}}catch(g){throw d.ensureArcadeExecutionError(a,b,g);}}function u(a,b){switch(b.type){case "EmptyStatement":return f.voidOperation;case "VariableDeclaration":return V(a,b);case "ImportDeclaration":var c=t.toSymbolId(b.specifiers[0].local),
e=a.libraryResolver.loadLibrary(c);if(a.libraryResolver._moduleSingletons?.has(e.uri))var h=a.libraryResolver._moduleSingletons.get(e.uri);else h=new C(e),h.loadModule(a),a.libraryResolver._moduleSingletons?.set(e.uri,h);a.globalScope[c]={value:h,valueset:!0,node:b};return f.voidOperation;case "ExportNamedDeclaration":u(a,b.declaration);if("FunctionDeclaration"===b.declaration.type)a.exports[t.toSymbolId(b.declaration.id)]="function";else if("VariableDeclaration"===b.declaration.type)for(c of b.declaration.declarations)a.exports[t.toSymbolId(c.id)]=
"variable";return f.voidOperation;case "BlockStatement":return N(a,b);case "FunctionDeclaration":return c=t.toSymbolId(b.id),a.globalScope[c]={valueset:!0,node:null,value:new pa(b,a)},f.voidOperation;case "ReturnStatement":return null===b.argument?a=new f.ReturnResult(f.voidOperation):(a=l(a,b.argument),a=new f.ReturnResult(a)),a;case "IfStatement":c=l(a,b.test);if(!0===c)a=u(a,b.consequent);else if(!1===c)a=null!==b.alternate?u(a,b.alternate):f.voidOperation;else throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.BooleanConditionRequired,b);return a;case "ExpressionStatement":return a=l(a,b.expression),a=a===f.voidOperation?f.voidOperation:new f.ImplicitResult(a),a;case "BreakStatement":return f.breakResult;case "ContinueStatement":return f.continueResult;case "ForStatement":{null!==b.init&&("VariableDeclaration"===b.init.type?u(a,b.init):l(a,b.init));const m={testResult:!0,lastAction:f.voidOperation};do b:{c=a;e=b;h=m;if(null!==e.test){h.testResult=l(c,e.test);if(!1===h.testResult)break b;
if(!0!==h.testResult)throw new d.ArcadeExecutionError(c,d.ExecutionErrorCodes.BooleanConditionRequired,e);}h.lastAction=u(c,e.body);h.lastAction===f.breakResult?h.testResult=!1:h.lastAction instanceof f.ReturnResult?h.testResult=!1:null!==e.update&&l(c,e.update)}while(!0===m.testResult);a=m.lastAction instanceof f.ReturnResult?m.lastAction:f.voidOperation}return a;case "ForInStatement":return qa(a,b);case "WhileStatement":c=!0;e=f.voidOperation;c=l(a,b.test);if(!1===c)a=f.voidOperation;else{if(!0!==
c)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.BooleanConditionRequired,b);for(;!0===c;){e=u(a,b.body);if(e===f.breakResult)break;if(e instanceof f.ReturnResult)break;c=l(a,b.test);if(!0!==c&&!1!==c)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.BooleanConditionRequired,b);}a=e instanceof f.ReturnResult?e:f.voidOperation}return a;default:throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.Unrecognized,b);}}function qa(a,b){var c=l(a,b.right);"VariableDeclaration"===b.left.type&&
V(a,b.left);var e=t.toSymbolId("VariableDeclaration"===b.left.type?b.left.declarations[0].id:b.left);let h=null;null!=a.localScope&&void 0!==a.localScope[e]&&(h=a.localScope[e]);null===h&&void 0!==a.globalScope[e]&&(h=a.globalScope[e]);if(null===h)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);if(f.isArray(c)||f.isString(c)){c=c.length;for(e=0;e<c;e++){h.value=e;var m=u(a,b.body);if(m===f.breakResult)break;if(m instanceof f.ReturnResult)return m}return f.voidOperation}if(f.isImmutableArray(c)){for(e=
0;e<c.length();e++){h.value=e;m=u(a,b.body);if(m===f.breakResult)break;if(m instanceof f.ReturnResult)return m}return f.voidOperation}if(c instanceof B||f.isFeature(c))for(c=c.keys(),e=0;e<c.length;e++){h.value=c[e];m=u(a,b.body);if(m===f.breakResult)break;if(m instanceof f.ReturnResult)return m}return f.voidOperation}function z(a,b,c,e,h){switch(b){case "\x3d":return a===f.voidOperation?null:a;case "/\x3d":return f.toNumber(c)/f.toNumber(a);case "*\x3d":return f.toNumber(c)*f.toNumber(a);case "-\x3d":return f.toNumber(c)-
f.toNumber(a);case "+\x3d":return f.isString(c)||f.isString(a)?f.toString(c)+f.toString(a):f.toNumber(c)+f.toNumber(a);case "%\x3d":return f.toNumber(c)%f.toNumber(a);default:throw new d.ArcadeExecutionError(h,d.ExecutionErrorCodes.UnsupportedOperator,e);}}function N(a,b){let c=f.voidOperation;for(let e=0;e<b.body.length&&!(c=u(a,b.body[e]),c instanceof f.ReturnResult||c===f.breakResult||c===f.continueResult);e++);return c}function V(a,b){for(let h=0;h<b.declarations.length;h++){var c=a,e=b.declarations[h];
let m=null===e.init?null:l(c,e.init);m===f.voidOperation&&(m=null);if("Identifier"!==e.id.type)throw new d.ArcadeExecutionError(c,d.ExecutionErrorCodes.InvalidIdentifier,e);const p=t.toSymbolId(e.id);null!=c.localScope?c.localScope[p]={value:m,valueset:!0,node:e.init}:c.globalScope[p]={value:m,valueset:!0,node:e.init}}return f.voidOperation}function la(a,b){try{const c=l(a,b.object);if(null===c)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.MemberOfNull,b);if(!1===b.computed){if("Identifier"===
b.property.type){if(c instanceof B||f.isFeature(c))return c.field(b.property.name);if(c instanceof Q)return K.geometryMember(c,b.property.name,a,b);if(c instanceof C){if(!c.hasGlobal(b.property.name))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidIdentifier,b);return c.global(b.property.name)}}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}let e=l(a,b.property);if(c instanceof B||f.isFeature(c)){if(f.isString(e))return c.field(e);throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}if(c instanceof C){if(f.isString(e))return c.global(e);throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}if(c instanceof Q){if(f.isString(e))return K.geometryMember(c,e,a,b);throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}if(f.isArray(c)){if(f.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=c.length+e);if(e>=c.length||0>e)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.OutOfBounds,
b);return c[e]}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}if(f.isString(c)){if(f.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=c.length+e);if(e>=c.length||0>e)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.OutOfBounds,b);return c[e]}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}if(f.isImmutableArray(c)&&f.isNumber(e)&&isFinite(e)&&Math.floor(e)===e){0>e&&(e=c.length()+e);if(e>=c.length()||0>e)throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.OutOfBounds,b);return c.get(e)}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.InvalidMemberAccessKey,b);}catch(c){throw c;}}function ma(a,b){try{const c=l(a,b.argument);if(f.isBoolean(c)){if("!"===b.operator)return!c;if("-"===b.operator)return-1*f.toNumber(c);if("+"===b.operator)return 1*f.toNumber(c);if("~"===b.operator)return~f.toNumber(c);throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.UnsupportedUnaryOperator,b);}if("~"===b.operator)return~f.toNumber(c);
if("-"===b.operator)return-1*f.toNumber(c);if("+"===b.operator)return 1*f.toNumber(c);throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.UnsupportedUnaryOperator,b);}catch(c){throw c;}}function na(a,b){try{const c=l(a,b.left),e=l(a,b.right);switch(b.operator){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return f.binaryOperator(f.toNumber(c),f.toNumber(e),b.operator);case "\x3d\x3d":return f.equalityTest(c,e);case "!\x3d":return!f.equalityTest(c,e);case "\x3c":return f.greaterThanLessThan(c,
e,b.operator);case "\x3e":return f.greaterThanLessThan(c,e,b.operator);case "\x3c\x3d":return f.greaterThanLessThan(c,e,b.operator);case "\x3e\x3d":return f.greaterThanLessThan(c,e,b.operator);case "+":return f.isString(c)||f.isString(e)?f.toString(c)+f.toString(e):f.toNumber(c)+f.toNumber(e);case "-":return f.toNumber(c)-f.toNumber(e);case "*":return f.toNumber(c)*f.toNumber(e);case "/":return f.toNumber(c)/f.toNumber(e);case "%":return f.toNumber(c)%f.toNumber(e);default:throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.UnsupportedOperator,b);}}catch(c){throw c;}}function oa(a,b){try{const c=l(a,b.left);if(f.isBoolean(c))switch(b.operator){case "||":if(!0===c)return c;const e=l(a,b.right);if(f.isBoolean(e))return e;throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.LogicExpressionOrAnd,b);case "\x26\x26":if(!1===c)return c;const h=l(a,b.right);if(f.isBoolean(h))return h;throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.LogicExpressionOrAnd,b);default:throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.LogicExpressionOrAnd,b);}throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.LogicalExpressionOnlyBoolean,b);}catch(c){throw c;}}function U(a,b){try{const c=t.toSymbolId(b);if(null!=a.localScope&&void 0!==a.localScope[c]){const e=a.localScope[c];if(!0===e.valueset)return e.value;e.value=l(a,e.node);e.valueset=!0;return e.value}if(void 0!==a.globalScope[c]){const e=a.globalScope[c];if(!0===e.valueset)return e.value;e.value=l(a,e.node);e.valueset=!0;return e.value}throw new d.ArcadeExecutionError(a,
d.ExecutionErrorCodes.InvalidIdentifier,b);}catch(c){throw c;}}function W(a,b,c,e){try{const h=b.arguments,m=l(a,h[c]);if(f.equalityTest(m,e))return l(a,h[c+1]);const p=h.length-c;return 1===p?l(a,h[c]):2===p?null:3===p?l(a,h[c+2]):W(a,b,c+2,e)}catch(h){throw h;}}function X(a,b,c,e){try{const h=b.arguments;if(!0===e)return l(a,h[c+1]);if(3===h.length-c)return l(a,h[c+2]);const m=l(a,h[c+2]);if(!1===f.isBoolean(m))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.BooleanConditionRequired,h[c+
2]);return X(a,b,c+2,m)}catch(h){throw h;}}function O(a,b,c,e){try{const h=a.body;if(c.length!==a.params.length)throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.WrongNumberOfParameters,e);if(null!=b.localScope)for(let p=0;p<c.length;p++)b.localScope[t.toSymbolId(a.params[p])]={value:c[p],valueset:!0,node:null};const m=u(b,h);if(m instanceof f.ReturnResult)return m.value;if(m===f.breakResult)throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.UnexpectedToken,e);if(m===f.continueResult)throw new d.ArcadeExecutionError(b,
d.ExecutionErrorCodes.UnexpectedToken,e);return m instanceof f.ImplicitResult?m.value:m}catch(h){throw h;}}function Y(a,b,c){const e=new E;a||={};b||={};const h=new B({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});h.immutable=!1;e.textformatting={value:h,valueset:!0,node:null};for(const m in b)e[m]={value:new w.NativeFunction(b[m]),native:!0,valueset:!0,node:null};for(const m in a)e[m]={value:f.isGraphic(a[m])?ba.createFromGraphic(a[m],c):a[m],valueset:!0,
node:null};return e}function Z(a){console.log(a)}function aa(a){const b={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:v,evaluateIdentifier:U};for(let c=0;c<a.length;c++)a[c].registerFunctions(b);for(const c in b.functions)q[c]={value:new w.NativeFunction(b.functions[c]),valueset:!0,node:null},E.prototype[c]=q[c];for(a=0;a<b.signatures.length;a++)ca.addFunctionDeclaration(b.signatures[a],"sync")}class pa extends w.ArcadeFunction{constructor(a,b){super();this.definition=a;this.context=
b}createFunction(a){return(...b)=>{const c={spatialReference:this.context.spatialReference,console:this.context.console,services:this.context.services,timeZone:this.context.timeZone??null,lrucache:this.context.lrucache,exports:this.context.exports,libraryResolver:this.context.libraryResolver,interceptor:this.context.interceptor,localScope:{},depthCounter:{depth:a.depthCounter.depth+1},globalScope:this.context.globalScope};if(64<c.depthCounter.depth)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.MaximumCallDepth,
null);return O(this.definition,c,b,null)}}call(a,b){return v(a,b,(c,e,h)=>{c={spatialReference:a.spatialReference,services:a.services,globalScope:a.globalScope,depthCounter:{depth:a.depthCounter.depth+1},libraryResolver:a.libraryResolver,exports:a.exports,timeZone:a.timeZone??null,console:a.console,lrucache:a.lrucache,interceptor:a.interceptor,localScope:{}};if(64<c.depthCounter.depth)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.MaximumCallDepth,b);return O(this.definition,c,h,b)})}marshalledCall(a,
b,c,e){return e(a,b,(h,m,p)=>{h={spatialReference:a.spatialReference,globalScope:c.globalScope,services:a.services,depthCounter:{depth:a.depthCounter.depth+1},libraryResolver:a.libraryResolver,exports:a.exports,console:a.console,timeZone:a.timeZone??null,lrucache:a.lrucache,interceptor:a.interceptor,localScope:{}};p=p.map(r=>!f.isFunctionParameter(r)||r instanceof w.ScopeMarshalledFunction?r:w.wrapModuleScopedResponse(r,a,e));return w.wrapModuleScopedResponse(O(this.definition,h,p,b),c,e)})}}class C extends J.ArcadeModule{constructor(a){super();
this.source=a}global(a){a=this.executingContext.globalScope[a.toLowerCase()];a.valueset||(a.value=l(this.executingContext,a.node),a.valueset=!0);if(f.isFunctionParameter(a.value)&&!(a.value instanceof w.ScopeMarshalledFunction)){const b=new w.ScopeMarshalledFunction;b.fn=a.value;b.parameterEvaluator=v;b.context=this.executingContext;a.value=b}return a.value}setGlobal(a,b){if(f.isFunctionParameter(b))throw new d.ArcadeExecutionError(null,d.ExecutionErrorCodes.AssignModuleFunction,null);this.executingContext.globalScope[a.toLowerCase()]=
{value:b,valueset:!0,node:null}}hasGlobal(a){void 0===this.executingContext.exports[a]&&(a=a.toLowerCase());return void 0!==this.executingContext.exports[a]?!0:!1}loadModule(a){let b=a.spatialReference;if(null===b||void 0===b)b=new R({wkid:102100});this.moduleScope=Y({},a.customfunctions,a.timeZone);this.executingContext={spatialReference:b,globalScope:this.moduleScope,localScope:null,libraryResolver:new P.ArcadeModuleLoader(a.libraryResolver._moduleSingletons,this.source.syntax.loadedModules),exports:{},
services:a.services,console:a.console??Z,timeZone:a.timeZone??null,lrucache:a.lrucache,interceptor:a.interceptor,depthCounter:{depth:1}};N(this.executingContext,this.source.syntax)}}const q={};ea.registerFunctions(q,v);ka.registerFunctions(q,v);ia.registerFunctions(q,v);fa.registerFunctions(q,v);ja.registerFunctions(q,v);ha.registerFunctions(q,v);q.iif=function(a,b){try{if(!0===b.preparsed)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NeverReach,b);const c=b.arguments;f.pcCheck(null===
c?[]:c,3,3,a,b);const e=l(a,c[0]);if(!1===f.isBoolean(e))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.BooleanConditionRequired,b);return!0===e?l(a,c[1]):l(a,c[2])}catch(c){throw c;}};q.defaultvalue=function(a,b){try{if(!0===b.preparsed)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NeverReach,b);const c=b.arguments;f.pcCheck(null===c?[]:c,2,3,a,b);const e=l(a,c[0]);if(3===c.length){const h=l(a,c[1]),m=K.getNestedOptionalValue(e,h);return null!=m&&""!==m?m:l(a,c[2])}return null===
e||""===e||void 0===e?l(a,c[1]):e}catch(c){throw c;}};q.decode=function(a,b){try{if(!0===b.preparsed)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NeverReach,b);const c=b.arguments;if(2>c.length)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.WrongNumberOfParameters,b);if(2===c.length)return l(a,c[1]);if(0===(c.length-1)%2)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.WrongNumberOfParameters,b);const e=l(a,c[0]);return W(a,b,1,e)}catch(c){throw c;}};q.when=function(a,
b){try{if(!0===b.preparsed)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.NeverReach,b);const c=b.arguments;if(3>c.length)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.WrongNumberOfParameters,b);if(0===c.length%2)throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.WrongNumberOfParameters,b);const e=l(a,c[0]);if(!1===f.isBoolean(e))throw new d.ArcadeExecutionError(a,d.ExecutionErrorCodes.BooleanConditionRequired,c[0]);return X(a,b,0,e)}catch(c){throw c;}};for(const a in q)q[a]=
{value:new w.NativeFunction(q[a]),valueset:!0,node:null};const E=function(){};E.prototype=q;E.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};E.prototype.pi={value:Math.PI,valueset:!0,node:null};J={fixSpatialReference:f.fixSpatialReference,parseArguments:S,standardFunction:v};aa([da.ArrayFunctions]);F.executeScript=function(a,b){let c=b.spatialReference;if(null===c||void 0===c)c=new R({wkid:102100});let e=null;a.usesModules&&(e=new P.ArcadeModuleLoader(new Map,a.loadedModules));
const h=Y(b.vars,b.customfunctions,b.timeZone);b={spatialReference:c,globalScope:h,localScope:null,services:b.services,exports:{},libraryResolver:e,console:b.console??Z,timeZone:b.timeZone??null,lrucache:b.lrucache,interceptor:b.interceptor,depthCounter:{depth:1}};a=N(b,a);if(a instanceof f.ReturnResult||a instanceof f.ImplicitResult){a=a.value;if(a===f.voidOperation)return null;if(f.isFunctionParameter(a))throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.IllegalResult,null);return a}if(a===
f.voidOperation)return null;if(a===f.breakResult)throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.IllegalResult,null);if(a===f.continueResult)throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.IllegalResult,null);throw new d.ArcadeExecutionError(b,d.ExecutionErrorCodes.NeverReach,null);};F.extend=aa;F.functionHelper=J;Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})});