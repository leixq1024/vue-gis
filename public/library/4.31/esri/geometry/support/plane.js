// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define("exports ../../core/mathUtils ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ./vector ./vectorStacks ../../views/3d/support/mathUtils".split(" "),function(d,J,g,t,w,A,m,K){function B(a=p){return[a[0],a[1],a[2],a[3]]}function E(a,b){return C(b[0],b[1],b[2],b[3],a)}function C(a,b,c,e,h=B()){h[0]=a;h[1]=b;h[2]=c;h[3]=e;return h}function F(a,b,c){var e=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];e=1E-5<Math.abs(e-1)&&1E-12<e?1/Math.sqrt(e):1;c[0]=b[0]*e;c[1]=b[1]*e;c[2]=
b[2]*e;c[3]=-(c[0]*a[0]+c[1]*a[1]+c[2]*a[2]);return c}function G(a,b,c,e=B()){var h=c[0]-b[0],f=c[1]-b[1],k=c[2]-b[2];c=a[0]-b[0];const l=a[1]-b[1],H=a[2]-b[2];b=f*H-k*l;k=k*c-h*H;h=h*l-f*c;f=b*b+k*k+h*h;f=1E-5<Math.abs(f-1)&&1E-12<f?1/Math.sqrt(f):1;e[0]=b*f;e[1]=k*f;e[2]=h*f;e[3]=-(e[0]*a[0]+e[1]*a[1]+e[2]*a[2]);return e}function D(a,b,c,e=0,h=Math.floor(1/3*c),f=Math.floor(2/3*c)){if(3>c)return!1;b(u,e);let k=h,l=!1;for(;k<c-1&&!l;)b(q,k),k++,l=!g.exactEquals(u,q);if(!l)return!1;k=Math.max(k,f);
for(l=!1;k<c&&!l;)b(n,k),k++,g.subtract(x,u,q),g.normalize(x,x),g.subtract(y,q,n),g.normalize(y,y),l=!g.exactEquals(u,n)&&!g.exactEquals(q,n)&&.99619469809>Math.abs(g.dot(x,y));if(!l)return 0===e&&1===h&&2===f?!1:D(a,b,c,0,1,2);G(u,q,n,a);return!0}function I(a,b,c){a=g.scale(m.sv3d.get(),a,g.dot(a,b));g.subtract(c,b,a);return c}function r(a,b){return g.dot(a,b)+a[3]}function z(a){return a===d.IntersectResult.INTERSECTS_INSIDE_OUT||a===d.IntersectResult.INTERSECTS_OUTSIDE_IN}function v(a,b,c,e,h){var f=
g.dot(a,c);a=r(a,b);if(0===f)return 0<=a?d.IntersectResult.INSIDE:d.IntersectResult.OUTSIDE;f=-a/f;e&d.IntersectFlags.CLAMP&&(f=J.clamp(f,0,1));if(!(e&d.IntersectFlags.INFINITE_MIN)&&0>f||!(e&d.IntersectFlags.INFINITE_MAX)&&1<f)return 0<=a?d.IntersectResult.INSIDE:d.IntersectResult.OUTSIDE;g.add(h,b,g.scale(h,c,f));return 0<=a?d.IntersectResult.INTERSECTS_INSIDE_OUT:d.IntersectResult.INTERSECTS_OUTSIDE_IN}const L=w.exactEquals;w=w.equals;const u=t.create(),q=t.create(),n=t.create(),x=t.create(),y=
t.create();d.IntersectResult=void 0;(function(a){a[a.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT";a[a.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN";a[a.INSIDE=2]="INSIDE";a[a.OUTSIDE=3]="OUTSIDE"})(d.IntersectResult||(d.IntersectResult={}));const p=[0,0,1,0];d.IntersectFlags=void 0;(function(a){a[a.NONE=0]="NONE";a[a.CLAMP=1]="CLAMP";a[a.INFINITE_MIN=4]="INFINITE_MIN";a[a.INFINITE_MAX=8]="INFINITE_MAX"})(d.IntersectFlags||(d.IntersectFlags={}));const M=d.IntersectFlags.INFINITE_MIN|d.IntersectFlags.INFINITE_MAX,
N=d.IntersectFlags.INFINITE_MAX;d.clip=function(a,b){const c=g.dot(a,b.ray.direction);a=-r(a,b.ray.origin);if(0>a&&0<=c)return!1;if(-1E-6<c&&1E-6>c)return 0<a;if((0>a||0>c)&&!(0>a&&0>c))return!0;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};d.clipInfinite=function(a,b){const c=g.dot(a,b.ray.direction);a=-r(a,b.ray.origin);if(-1E-6<c&&1E-6>c)return 0<a;a/=c;0<c?a<b.c1&&(b.c1=a):a>b.c0&&(b.c0=a);return b.c0<=b.c1};d.copy=E;d.create=B;d.distance=function(a,b){return Math.abs(r(a,b))};
d.equals=w;d.exactEquals=L;d.fromArray=function(a,b,c=!0){const e=b.length/3;return D(a,(h,f)=>g.set(h,b[3*f],b[3*f+1],b[3*f+2]),c?e-1:e)};d.fromManyPoints=D;d.fromNormalAndOffset=function(a,b,c){g.copy(c,a);c[3]=b;return c};d.fromPoints=G;d.fromPositionAndNormal=F;d.fromValues=C;d.fromVectorsAndPoint=function(a,b,c,e){g.cross(n,b,a);return F(c,n,e)};d.getNormal=function(a){return a};d.intersectLine=function(a,b,c,e){c=g.subtract(m.sv3d.get(),c,b);return z(v(a,b,c,M,e))};d.intersectLineOrRay=v;d.intersectLineSegment=
function(a,b,c){return z(v(a,b.origin,b.vector,d.IntersectFlags.NONE,c))};d.intersectLineSegmentClamp=function(a,b,c){return z(v(a,b.origin,b.vector,d.IntersectFlags.CLAMP,c))};d.intersectRay=function(a,b,c){return null!=b?z(v(a,b.origin,b.direction,N,c)):!1};d.isPointInside=function(a,b){return 0<=r(a,b)};d.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};d.projectPoint=function(a,b,c){const e=g.scale(m.sv3d.get(),a,-a[3]);b=g.subtract(m.sv3d.get(),b,e);a=I(a,b,m.sv3d.get());
g.add(c,a,e);return c};d.projectPointLocal=function(a,b,c,e){var h=m.sv3d.get(),f=m.sv3d.get();K.tangentFrame(a,h,f);b=g.subtract(m.sv3d.get(),c,b);h=A.projectPointSignedLength(h,b);f=A.projectPointSignedLength(f,b);a=A.projectPointSignedLength(a,b);return g.set(e,h,f,a)};d.projectVector=I;d.setOffsetFromPoint=function(a,b,c){b!==a&&E(a,b);a[3]=-g.dot(a,c);return a};d.signedDistance=r;d.up=p;d.wrap=function(a=p[0],b=p[1],c=p[2],e=p[3]){return C(a,b,c,e,m.sv4d.get())};Object.defineProperty(d,Symbol.toStringTag,
{value:"Module"})});