// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports"],function(O){function n(a){return new Date(864E5*(a+.5-2440588))}function A(a,b){return t(d(a)*f(p)-u(b)*d(p),f(a))}function v(a,b){return B(d(b)*f(p)+f(b)*d(p)*d(a))}function C(a,b,c){return t(d(a),f(a)*d(b)-u(c)*f(b))}function D(a,b,c){return B(d(b)*d(c)+f(b)*f(c)*f(a))}function E(a){return e*(1.9148*d(a)+.02*d(2*a)+3E-4*d(3*a))}function F(a,b){a=e*(357.5291+.98560028*a);var c=E(a);a=a+c+102.9372*e+l;b||={dec:0,ra:0};b.dec=v(a,0);b.ra=A(a,0);return b}function G(a,b,c){return 2451545+
a+.0053*d(b)-.0069*d(2*c)}function H(a){var b=e*(134.963+13.064993*a),c=e*(93.272+13.22935*a);a=e*(218.316+13.176396*a)+6.289*e*d(b);c=5.128*e*d(c);b=385001-20905*f(b);return{ra:A(a,c),dec:v(a,c),dist:b}}var l=Math.PI,d=Math.sin,f=Math.cos,u=Math.tan,B=Math.asin,t=Math.atan2,I=Math.acos,e=l/180,P={dec:0,ra:0},p=23.4397*e,h={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(a,b,c,g){c=e*-c;b*=e;var m=a.valueOf()/864E5-.5+2440588-2451545;a=F(m,P);c=e*(280.16+360.9856235*m)-
c-a.ra;g||={azimuth:0,altitude:0};g.azimuth=C(c,b,a.dec);g.altitude=D(c,b,a.dec);return g}},q=[[-.83,"sunrise","sunset"]];h.addTime=function(a,b,c){q.push([a,b,c])};h.getTimes=function(a,b,c){function g(k){var J=w,K=x;k=I((d(k)-d(J)*d(K))/(f(J)*f(K)));return G(9E-4+(k+m)/(2*l)+L,r,y)}var m=e*-c,w=e*b,L=Math.round(a.valueOf()/864E5-.5+2440588-2451545-9E-4-m/(2*l));a=9E-4+(0+m)/(2*l)+L;var r=e*(357.5291+.98560028*a);b=E(r);var y=r+b+102.9372*e+l,x=v(y,0);a=G(a,r,y);b={solarNoon:n(a),nadir:n(a-.5),polarException:h.PolarException.NORMAL};
var M;c=0;for(M=q.length;c<M;c+=1){var z=q[c];var N=g(z[0]*e);var Q=a-(N-a);b[z[1]]=n(Q);b[z[2]]=n(N)}b.polarException=function(k){k=(d(k)-d(w)*d(x))/(f(w)*f(x));return-1>k?h.PolarException.MIDNIGHT_SUN:1<k?h.PolarException.POLAR_NIGHT:h.PolarException.NORMAL}(q[0][0]*e);return b};h.getMoonPosition=function(a,b,c){c=e*-c;b*=e;var g=a.valueOf()/864E5-.5+2440588-2451545;a=H(g);c=e*(280.16+360.9856235*g)-c-a.ra;g=D(c,b,a.dec);g+=.017*e/u(g+10.26*e/(g+5.1*e));return{azimuth:C(c,b,a.dec),altitude:g,distance:a.dist}};
h.getMoonFraction=function(a){var b=a.valueOf()/864E5-.5+2440588-2451545;a=F(b);b=H(b);a=I(d(a.dec)*d(b.dec)+f(a.dec)*f(b.dec)*f(a.ra-b.ra));a=t(149598E3*d(a),b.dist-149598E3*f(a));return(1+f(a))/2};O.SunCalc=h});