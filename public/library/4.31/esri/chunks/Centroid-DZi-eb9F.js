// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.31/esri/copyright.txt for details.
//>>built
define(["exports","./Geometry","./Transformation2D"],function(t,n,g){function u(a,b=-1){const d=new g.KahanSummator(0),f=new g.KahanSummator(0),c=a.getImpl();let e;const k=c.hasNonLinearSegments();let h;const l=c.getXY(0);if(-1===b){h=c.calculateArea2D();if(0===h)return v(a);k&&(e=c.querySegmentIterator());for(let m=0,r=c.getPathCount();m<r;m++)w(l,c,m,d,f),k&&x(l,e,d,f)}else{h=c.calculateRingArea2D(b);if(0===h)return v(a,b);k&&(e=c.querySegmentIterator(),e.resetToPath(b));w(l,c,b,d,f);k&&x(l,e,d,
f)}a=new g.Point2D;b=new g.Point2D;a.setCoords(d.getResult(),f.getResult());b.assign(a.mul(1/h).add(l));return b}function w(a,b,d,f,c){var e=b.getPathStart(d);const k=b.getPathEnd(d);if(!(3>k-e)){var h=b.getAttributeStreamRef(0),l=h.readPoint2D(2*e),m=h.readPoint2D(2*(e+1));m.subThis(l);var r=new g.KahanSummator(0),y=b.hasNonLinearSegments(),A=1/3,p=new g.Point2D;for(e+=2;e<k;e++){h.queryPoint2D(2*e,p);p.subThis(l);var q=.5*p.crossProduct(m);y&&r.add(q);q*=A;f.add((m.x+p.x)*q);c.add((m.y+p.y)*q);
m.setCoordsPoint2D(p)}b=y?r.getResult():b.calculateRingArea2D(d);a=l.sub(a).mul(b);f.add(a.x);c.add(a.y)}}function x(a,b,d,f){var c;for(b.nextPath()||n.throwInternalErrorException("centroid");null!==(c=b.nextCurve());)c=c.calculateWeightedAreaCentroid2D(a),d.add(c.x),f.add(c.y)}function v(a,b=-1){a=a.getImpl();return z(a,b)}function z(a,b=-1){const d=-1===b?a.calculateLength2D():a.calculatePathLength2D(b);if(0===d)return B(a,b);const f=new g.KahanSummator(0),c=new g.KahanSummator(0),e=a.querySegmentIterator();
for(-1!==b&&e.resetToPath(b);e.nextPath();){var k=e.getPathIndex();const l=a.getXY(a.getPathStart(k));for(;e.hasNextSegment();){var h=e.nextSegment();const m=h.calculateLength2D();0!==m&&(h=h.calculateWeightedCentroid2D().sub(l.mul(m)),f.add(h.x),c.add(h.y))}k=l.mul(a.calculatePathLength2D(k));f.add(k.x);c.add(k.y);if(-1!==b)break}a=new g.Point2D;a.setCoords(f.getResult(),c.getResult());return a.mul(1/d)}function B(a,b=-1){if(-1!==b)return a.getXY(a.getPathStart(b));b=new g.KahanSummator(0);const d=
new g.KahanSummator(0);for(let f=0;f<a.getPathCount();++f){const c=a.getXY(a.getPathStart(f));b.add(c.x);d.add(c.y)}return g.Point2D.construct(b.getResult(),d.getResult()).mul(1/a.getPathCount())}t.calculateCentroid2D=function(a,b){if(!a.isEmpty())switch(a.getGeometryType()){case n.GeometryType.enumPolygon:return u(a);case n.GeometryType.enumPolyline:return b=a.getImpl(),z(b);case n.GeometryType.enumLine:case n.GeometryType.enumBezier:case n.GeometryType.enumEllipticArc:return b=a.calculateLength2D(),
b=0===b?a.getStartXY():a.calculateWeightedCentroid2D().mul(1/b),b;case n.GeometryType.enumMultiPoint:b=new g.KahanSummator(0);const f=new g.KahanSummator(0);var d=a.getImpl();a=d.getAttributeStreamRef(0);d=d.getPointCount();const c=new g.Point2D;for(let e=0;e<d;e++)a.queryPoint2D(2*e,c),b.add(c.x),f.add(c.y);a=new g.Point2D;a.setCoords(b.getResult(),f.getResult());return a.divThis(d);case n.GeometryType.enumEnvelope:return a.getCenterXY();case n.GeometryType.enumPoint:return a.getXY()}return g.Point2D.construct(Number.NaN,
Number.NaN)};t.calculatePolygonCentroid2D=function(a,b){return u(a,b)}});